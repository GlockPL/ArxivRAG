{"title": "Integrating remote sensing data assimilation, deep learning and large language model for interactive wheat breeding yield prediction", "authors": ["Guofeng Yang", "Nanfei Jin", "Wenjie Ai", "Zhonghua Zheng", "Yuhong He", "Yong He"], "abstract": "Yield is one of the core goals of crop breeding. By predicting the potential yield of different breeding materials, breeders can screen these materials at various growth stages to select the best performing. Based on unmanned aerial vehicle remote sensing technology, high-throughput crop phenotyping data in breeding areas is collected to provide data support for the breeding decisions of breeders. However, the accuracy of current yield predictions still requires improvement, and the usability and user-friendliness of yield forecasting tools remain suboptimal. To address these challenges, this study introduces a hybrid method and tool for crop yield prediction, designed to allow breeders to interactively and accurately predict wheat yield by chatting with a large language model (LLM). First, the newly designed data assimilation algorithm is used to assimilate the leaf area index into the WOFOST model. Then, selected outputs from the assimilation process, along with remote sensing inversion results, are used to drive the time-series temporal fusion transformer model for wheat yield prediction. Finally, based on this hybrid method and leveraging an LLM with retrieval augmented generation technology, we developed an interactive yield prediction Web tool that is user-friendly and supports sustainable data updates. This tool integrates multi-source data to assist breeding decision-making. This study aims to accelerate the identification of high-yield materials in the breeding process, enhance breeding efficiency, and enable more scientific and smart breeding decisions.", "sections": [{"title": "1. Introduction", "content": "According to the World Population Prospects 2024 report, the global population is projected to increase by 2 billion in the next 60 years, reaching a peak of approximately 10.3 billion by the mid-2080s [1]. The current rate of growth in the yields of major crops remains insufficient to meet the demand driven by this population increase [2]. While conventional breeding methods have significantly improved crop yields and quality [3], [4], the enhancement of yields in existing crops faces substantial challenges, particularly in the context of climate change. This is especially evident in staple crops such as wheat, where the gap between expected yields and future demand continues to widen [5], [6].\nUnmanned aerial vehicle (UAV) remote sensing technology, with its high spatial resolution, rapid data acquisition capabilities, and extensive coverage, in combination with multispectral, hyperspectral, and LiDAR technologies, enables precise crop yield prediction [7], [8], [9]. Existing studies on wheat yield prediction can generally be categorized into three methods: process-based model-driven, data-driven, and hybrid. Process-based model-driven methods (e.g., WOFOST [10], AquaCrop [11], APSIM [12]) construct crop growth models that offer good interpretability; however, they rely on simplified assumptions and struggle to address complex and dynamic environmental conditions. Moreover, these models may lack accuracy in predictions when data is scarce. In contrast, data-driven methods (e.g., GRU [13], LSTM [14], Transformer [15]) analyze large-scale datasets to identify complex nonlinear relationships, with prediction accuracy improving as more data becomes available. However, these methods typically suffer from poor interpretability and high data quality requirements, with missing or biased data potentially significantly affecting outcomes. While both methods have their respective strengths and weaknesses, they face limitations in addressing the complexities of agricultural environments. Recently, hybrid methods combining data assimilation with machine learning (deep learning) have gradually emerged as an effective solution to overcome these challenges, due to their exceptional accuracy and adaptability [16], [17], [18]. Data assimilation technology (e.g., EnKF, 4D-Var) can integrate observational data with model predictions to correct model errors, thus improving yield prediction accuracy [19]. When combined with deep learning methods (e.g., CNN, LSTM), they can further enhance the accuracy and stability of yield predictions by uncovering latent nonlinear relationships from large datasets [20]. Hybrid methods offer greater flexibility and robustness when dealing with dynamic agricultural environments, addressing the limitations of individual methods [21]. However, existing hybrid methods still have shortcomings in several areas. For instance, current assimilation algorithms face challenges related to computational efficiency and accuracy instability when handling high-dimensional, nonlinear, and time-varying agricultural data [22]. Moreover, deep learning algorithms often lack effective mechanisms to integrate model outputs with observational data when combined with traditional assimilation methods [23]. Therefore, there is an urgent need to develop new hybrid methods, particularly more efficient assimilation algorithms and deep learning architectures to further enhance the accuracy and adaptability in complex environments.\nExisting studies have developed integrated platforms for breeding phenotypic and genetic association, such as Crop-GPA [24], the Smart Breeding Platform [25], and GoldenSeed [26]; breeding data management systems like BreedingEIS [27] and GridScore [28]; and gene analysis and prediction tools like the SoyDNGP website [29] and PidTools [30]. These platforms provide some degree of support for breeding research. However, there remains a lack of user-friendly and"}, {"title": "2. Data", "content": "2.1. Study area and experiment design\nThe study area was set up in Huzhou and Hangzhou city, Zhejiang Province, China (Changxing Agricultural Experimental Station of Zhejiang University in Huzhou, Yuhang Agricultural Experimental Station of Zhejiang University in Hangzhou, and Zijingang Agricultural Science and Technology Innovation Experimental Center of Zhejiang University in Hangzhou) (Fig. 1, Table S1). The experiment lasts for three years (2021-2024), with 305 wheat germplasms, 351 wheat germplasms, and 60 high-generation wheat lines. The wheat germplasms come from many countries"}, {"title": "2.2. Data collection and preprocessing", "content": "2.2.1. Remote sensing, phenotypic and environmental data\nThis study used the Matrice 300 RTK (DJI, China) equipped with the Zenmuse L1 (DJI, China) LiDAR and the Phantom 4 Multispectral (DJI, China) to acquire three years of point cloud and multispectral data. The data were collected on the same day, under clear, cloudless skies, and low wind conditions, at a flight altitude of 15m (Fig. 2a). The UAV remote sensing data collection included six times from 2021 to 2022, nine times from 2022 to 2023, and seven times from 2023 to 2024 (Fig. 2b). For phenotyping data, LAI and canopy height (CH) of wheat were collected only five times in 2021-2022, and the wheat grain yield was not obtained; LAI and CH of wheat were collected a total of nine times in 2022-2023, and the wheat grain yield was obtained; LAI and CH\n2.2.2. Yield database\nThe wheat yield database has 6,253 entries, which are from the China Seed Industry Big Data Platform (202.127.42.145/bigdataNew/home/index). These data are obtained through the variety of approval trials conducted by the National Crop Variety Approval Committee of China, following the relevant provisions of the Seed Law and the Main Crop Variety Approval Measures. It is representative and authoritative, and the data is dynamically updated (Fig. 2d). Each entry in the database includes the approval number, variety name, applicant, breeder, variety source, characteristics, yield performance, key points of cultivation technique, and suitable planting area\n2.2.3. Preprocessing\nThis study utilized Pix4Dmapper software (Pix4D, Switzerland) to process multispectral data. Radiometric calibration was performed using images of a radiometric calibration board to correct spectral data across different bands, ensuring data accuracy and consistency. The calibrated data were used to generate digital orthophoto maps (DOMs), which were subsequently normalized to create reflectance images. These reflectance images were employed to calculate both conventional and novel vegetation indexes (VIs) for yield prediction. Additionally, Terra software (DJI, China) was employed to create a bare-earth digital elevation model (DEM) based on LiDAR point cloud. Using point cloud acquired at multiple times, digital surface models (DSMs) were constructed. A Python script was developed to perform pixel-by-pixel subtraction of the DEM from the DSM, enabling the calculation of CH in wheat-growing areas. To validate the feasibility of the CH calculation method, remotely sensed CH values were compared with field-measured CH values. The results demonstrated strong correlations (Changxing: R2 = 0.863, RMSE = 0.105 m; Yuhang: R2 = 0.837, RMSE = 0.136 m), confirming the accuracy and reliability of the method. Furthermore, the canopy volume (CV) of individual plots was measured using the measurement tool of Terra software. Specifically, CV was calculated based on point cloud using both the lowest point plane and the mean plane as reference baselines. The average of the two values was taken as the final CV.\nTo support breeding research using only remote sensing data without manual collection of wheat LAI measurements, this study exclusively collected remote sensing data in the Zijingang experiment. First, inversion models were constructed using manually collected LAI data and corresponding VIs derived from UAV-based remote sensing in the Changxing and Yuhang experiments. Several methods, including support vector regression (SVR), random forest regression (RFR), XGBoost, and LightGBM, were developed for this purpose. The dataset was randomly split into training set, validation set and test set in a ratio of 3:1:1. The performance of inversion of different methods is compared on the test set. Results show that XGBoost outperformed other methods in both experiments. Referring to related research [41], the LAI inversion accuracy achieved by the XGBoost method satisfies the precision requirements for assimilation with the crop growth model WOFOST and remote sensing data. Finally, a new XGBoost model was trained using the full set of LAI and VI data from both experiments. This model was applied to the Zijingang experiment, where LAI data were not manually collected, to invert LAI for different wheat breeding materials.\nAll data in this study are publicly available (https://doi.org/10.5281/zenodo.14376799)."}, {"title": "3. Method", "content": "3.1. Hybrid method\nThe hybrid method in this study integrates the WOFOST model, the WW-4VES data assimilation algorithm, and the TFT model. The inputs of the hybrid method are different data collection dates and corresponding development days (DVDs), remote sensing inversion data (VIs, CV, CH) and LAI values. Before using the hybrid method, the crop model must be calibrated and validated (Section 3.1.1). Subsequently, the newly designed WW-4VES data assimilation algorithm is employed to assimilate LAI into the WOFOST model (Section 3.1.2). Finally, the partially assimilated outputs and the remote sensing inversion results are used to drive the time series TFT model to predict wheat yield (Section 3.1.3).\n3.1.1. WOFOST model calibration and validation\nThe WOFOST (WOrld FOod STudies) model is a dynamic process model used to simulate crop growth. The WOFOST model estimates crop biomass accumulation, yield, and water requirements by simulating various physiological processes in crop growth, including photosynthesis, respiration, and transpiration. This study refers to the latest document \"A gentle introduction to WOFOST\" on the WOFOST official website and determines the range of parameters that need to be calibrated in WOFOST (Table S6). \"Free\" parameters are calibrated according to measured data; \"Additional\" parameters can be calibrated as needed, using the WOFOST model default values or related reference values; \"Static\" parameters that are unlikely to require calibration use the WOFOST model default values. The Python Crop Simulation Environment (PCSE) framework provides an environment for running the WOFOST crop growth model.\nAccording to the WOFOST parameter calibration scheme (Table S6), the parameters of the three experiments in this study are calibrated separately. After parameter calibration, the simulated LAI or yield of each experiment had a good fit with the measured LAI or yield overall (Table S7), indicating the effectiveness of the WOFOST model in predicting wheat growth. Furthermore, although the predicted LAI or yield fit well with the measured LAI or yield, there are large regional differences in the values of LAI or yield, indicating that it is necessary to use remote sensing observation data to assimilate the results of crop model prediction.\n3.1.2. WW-4VES data assimilation algorithm\nThe LAI of crops is one of the important parameters related to the growth status and development process of crops. Therefore, the LAI of crops is selected as the update state to achieve data assimilation and yield prediction. First, the driving parameters are input into the WOFOST model, including daily meteorological data, crop parameters, soil parameters, and agricultural management practice parameters. The WOFOST model is then executed to generate the predicted LAI at the corresponding time, serving as the background field LAI. Subsequently, combined with the observed field LAI (LAI measured by ground instruments or LAI obtained by remote sensing inversion during wheat growth), the WW-4VES data assimilation algorithm fused the observed LAI with the LAI predicted by the model. Since both field measurement data and remote sensing data may contain errors, quality control and estimation of observational errors are necessary. Assuming that observational errors follow a Gaussian distribution, the mean and variance of the obtained LAI are applied to the Gaussian distribution formula to optimize model uncertainty and enhance predictive accuracy. Throughout the entire growth season of wheat, the above assimilation process is repeated, with each observed LAI value assimilated into the WOFOST model. This sequentially corrects the state of the model, generating a simulated growth process that increasingly approximates the actual growth. At the end of the growth season, the WOFOST model outputs the final yield, which is represented as the TWSO. In addition, this study applies hyperparameter optimization to the WOFOST model using Optuna [67]. Specifically, the Tree-structured Parzen Estimator (TPE) sampler and the Hyperband pruner are used iteratively to minimize the cost function for the WOFOST model. The TPE sampler efficiently searches the hyperparameter space to identify the optimal combination of hyperparameters for improving model performance. Hyperband accelerates the hyperparameter optimization process by dynamically adjusting resource allocation. When the cost function reaches its minimum within the specified range, the WOFOST output based on the optimal parameter set is considered the optimal output. In this study, the WW-4VES data assimilation algorithm is implemented in Python. This study also developed the EnKF method [68] and the EnKF-4DVar method [69] to compare the performance of yield prediction, and tried to keep the variables and parameters consistent.\nThe WW-4VES data assimilation algorithm integrates adaptive weight, variable time windows, four-dimensional variational, and ensemble square root filtering. The derivation process can be summarized in the following steps: 1. State evolution and initial estimation. The initial state is estimated using the background error covariance Po and observation data. 2. Observation update. The observational increment $dy$, is computed, and the state is updated using the Kalman gain matrix K\u2081. 3. Adaptive weight adjustment. The adaptive weight $a_i$ is computed based on the background and observation errors to refine the analysis field. 4. Time window adjustment. The time window length $T_w(t+1)$ is dynamically adjusted according to the error growth rate $r(t)$ to accommodate different observational environments.\nIn the objective function $F(x_0)$, the first term represents the error of the background field, while the second term represents the error between observations and model states; these terms are combined using a weighted approach based on the error covariance matrices. The objective function $F(x_0)$ is used to evaluate the appropriateness of the current initial state $x_0$. Let $x_0$ denote the initial state of the current system (subject to optimization), and $x_b$ denote the background field (the prior estimate of the initial state). The matrix B denotes the error covariance of the background field, providing a measure of the magnitude and uncertainty of background errors. $x_i$ denotes the state of the system at the i-th time step, and $y_i$ denotes the observation data at this time step. The operator $H_i$ is the observation operator, mapping the model state to the observation space. Finally, $R_i$ denotes the observation error covariance matrix at the i-th time step, which quantifies the magnitude of observational errors.\n$F(x_0) = \\frac{1}{2} (x_0 - x_b)^T B^{-1} (x_0 - x_b) + \\frac{1}{2} \\sum_{i=0}^{N} (y_i - H_ix_i)^T R_i^{-1} (y_i - H_ix_i)$ (1)\nThe system state evolves through the model, incorporating an error term $n_i$, to produce the background state $x_{i+1}$ at the next time step. Here, $X_{i+1}$ denotes the system state at the i+1-th time step. The state evolution operator $M_i$ describes how the state at time i-th is used to calculate the state at time i+1-th. The error term $n_i$ denotes model error, capturing the uncertainty and inaccuracies in the state evolution process.\n$X_{i+1} = M(x_i) + n_i$ (2)\nThe ensemble mean $\\overline{x_0}$ denotes the average initial state across multiple sample states, while the covariance matrix $P_0$ describes the error and uncertainty associated with these initial states. Specifically, $\\overline{X}$ is the mean of the ensemble samples, providing an average of the initial states. K denotes the number of ensemble samples, and $x_0^{(k)}$ denotes the initial state of the k-th ensemble sample. The matrix $P_0$ is the error covariance matrix of the background field, reflecting the uncertainty of the background field.\n$\\overline{x_0} = \\frac{1}{K} \\sum_{k=1}^{K} x_0^{(k)}$ (3)\n$P_0 = \\frac{1}{K-1} \\sum_{k=1}^{K} (x_0^{(k)} - \\overline{x_0}) (x_0^{(k)} - \\overline{x_0})^T$ (4)\nThe observation increment $dy_i$ reflects the discrepancy between observational data and the model state, serving as a key variable in the subsequent assimilation update. Specifically, $dy$ denotes the difference between observational data and the model state in the observation space. Here, $y_i$ denotes the observational data at the i-th time step, $H_i$ is the observation operator that projects the model state $x_i$ into the observation space, and $x_i$ is the model state at the i-th time step.\n$dy_i = y_i - H_ix_i$ (5)\nThe state update formula uses the Kalman gain $K_i$ to adjust the background field $x_{b,i}$ based on the observation increment $dy_i$, yielding the updated analysis field $x_{a,i}$. Here, $X_{a, i}$ denotes the analysis state after assimilation (the updated state at the i-th time step), while $x_{b, i}$ denotes the background field at the i-th time step. The Kalman gain matrix $K_i$ determines the weighted contribution of the background field and observational data.\n$X_{a, i} = X_{b, i} + K_idy_i$ (6)\nThe Kalman gain matrix $K_i$ determines the weighting between the background field and the observational data; typically, when the observation error $R_i$ is small, the observational data are given greater weight. Specifically, $K_i$ is the Kalman gain matrix at the i-th time step, $P_i$ is the background error covariance matrix at the i-th time step, $H_i$ is the observation operator that projects the model state into the observation space, and $R_i$ is the observation error covariance matrix, which quantifies the magnitude of observation errors.\n$K_i = P_i H_i^T (H_iP_iH_i^T + R_i)^{-1}$ (7)\nThe adaptive weight $a_i$ is dynamically adjusted based on the magnitudes of the observation and background errors to better balance their respective influences. Here, $a_i$ is the adaptive weight\n$a_i = \\frac{1}{tr(R_i) + tr(P_i)}$ (8)\nWith the inclusion of the adaptive weight $a_i$, the final analysis state $x_{a, i}$ is determined by both the background field $x_{b, i}$ and the observation increment $dy_i$, adjusted by the Kalman gain $K_i$. Here, $X_{a, i}$ is the analysis state after assimilation, $a_i$ is the adaptive weight that adjusts the weighting between the background field and observational data, and $K_i$ is the Kalman gain matrix.\n$X_{a, i} = (1 - a_i)x_{b, i} + a_i K_i dy_i$ (9)\nThe dynamic adjustment of the time window is controlled by the error growth rate r(t); the window is shortened when background errors are large and extended when observation errors are large. Here, $T_w(t+1)$ denotes the time window length at the next time step, and $T_w(t)$ denotes the current time window length. r(t) is the error growth rate at the current time step, while $r_0$ is the preset threshold for the error growth rate, used to determine if an adjustment to the time window length is needed. The parameter $\u03b2$ is an adjustment coefficient that controls the sensitivity of window changes.\n$r(t) = \\frac{tr(P_i)}{tr(R_i)}$ (10)\n$T_w(t+1) = T_w(t) \\times (\\frac{r(t)}{r_0})^\u03b2$ (11)\nThe above formulas (1-11) are computed in sequence through multiple steps to finally determine the assimilation state of the system and dynamically adjust the time window length to adapt to different observation and model environments. Finally, we input the partial outputs (TAGP, TWSO, TWLV, TWST, TWRT) of the combined WOFOST and WW-4VES data assimilation algorithm, different data collection dates and corresponding LAI values into the subsequent TFT model.\n3.1.3. Time Series TFT Model\nThis study uses the TFT model [70], which is a deep learning model specifically for time series forecasting. It is designed to process multivariate time series data and provide efficient and interpretable forecasts. The data used in the TFT model include the partial outputs (TAGP, TWSO, TWLV, TWST, TWRT) after assimilated, different data collection dates and corresponding DVDs, remote sensing inversion data (VIs, CV, CH) and LAI values. The dataset was randomly split into training set, validation set and test set in a ratio of 3:1:1. This study implemented the TFT model using Python and PyTorch Forecasting package. Optuna was used to optimize the hyperparameters of the TFT model [67]. The output of the TFT model under the optimal parameters was the final predicted yield of this study. To compare the effect of yield prediction, this study used Keras (https://keras.io/) and Scikit-learn [71] to develop Long Short-Term Memory (LSTM), Gated Recurrent Unit (GRU) and Transformer networks, and tried to keep the network layers, parameters, training and prediction consistent.\n3.2. Interactive yield predict tool\nLlamaIndex (https://www.llamaindex.ai/) uses efficient information retrieval and indexing techniques to integrate external data with LLM, supporting RAG to enhance the accuracy and richness of generated results. Therefore, this study developed an application combining RAG technology and LLM based on the LlamaIndex framework, i.g., an interactive yield prediction Web tool (ChatYield). The LLM selects the open source Llama3.2-3.2-3B-Instruct (https://www.llama.com/), and the vector database selects Milvus (https://milvus.io/). Specifically, the data in the yield database are converted, and embedding vectors are generated using BGE-M3 [72], which are then stored in the Milvus vector library. Then, LlamaIndex receives user input and initiates a search request to the Milvus database based on the input, through the pipeline of hybrid search (BGE-M3) and reranking (BGE-Reranker-V2-M3). LlamaIndex merges the retrieval results with the input to form a new prompt. Afterwards, LlamaIndex inputs the new prompt into Llama3.2-3.2-3B-Instruct, and Llama3.2-3.2-3B-Instruct implements answer generation based on the new prompt.\nUnlike the typical interaction processes between users and LLMs or users and systems combining LLMs with RAG technologies , the LLM of ChatYield simultaneously processes outputs from the hybrid method and results retrieved from the yield database via RAG, generating final yield prediction responses . When predicting the yield of breeding material, the user inputs the variety name, specific data collection date, DVD, remote sensing inversion data (VIs, CV, CH), and LAI value. The hybrid method then generates a yield prediction based on these inputs, while ChatYield retrieves matching yield-related data from the database. Finally, the LLM of ChatYield integrates the output of the hybrid method with RAG-retrieved data to produce the final yield prediction response."}, {"title": "3.3. Evaluation of the accuracy of yield predict", "content": "The coefficient of determination (R2) and root mean square error (RMSE) are used as evaluation indicators to evaluate the effect of yield prediction.\n$R^2 = \\frac{\\sum_{i=1}^n (y_i - \\overline{y})^2}{\\sum_{i=1}^n (x_i - \\overline{x})^2 \\sum_{i=1}^n (y_i - \\overline{y})^2}$ (12)\nIn the formula, xi, y, x, y are the measured wheat yield, predicted yield, average measured yield and average predicted yield, respectively, and n is the number of samples. Generally, the closer R2 is to 1, the better the fit between the predicted wheat yield and the measured yield.\n$RMSE= \\sqrt{\\frac{1}{n} \\sum_{i=1}^n (y_i - x_i)^2}$ (13)\nAmong them, x\u2081 and y\u2081 are the measured and predicted wheat yields, respectively, and n is the number of samples."}, {"title": "4. Results", "content": "4.1. Impact of Data Assimilation on Predicted Yields\nTo assess the specific impact of data assimilation, the wheat yield predictions before and after data assimilation were compared (Fig. 5). We found that the predictions of the crop model without assimilation were significantly different from the measured yield. In contrast, the predicted yield of the crop model after assimilation was more consistent with the measured yield. For the Yuhang experiment, the R2 and RMSE before assimilation were 0.652 and 538.9 kg/ha, respectively (Fig. 5a). After assimilation using the WW-4VES data assimilation algorithm, the yield prediction was further improved, with the R2 increase of 0.164 and the RMSE decrease of 147.4 kg/ha (Fig. 5b). For the Zijingang experiment, the R2 and RMSE before assimilation were 0.607 and 690.6 kg/ha, respectively (Fig. 5c). After assimilation, the yield prediction was further improved, with the R2 increase of 0.075 and the RMSE decrease of 68.8 kg/ha (Fig. 5d). These results demonstrate that our WW-4VES data assimilation algorithm improves yield predictions by assimilating LAI dynamics into the WOFOST crop model.\n4.2. Yield prediction performance of hybrid method\nThis study compares process-based model-driven methods (calibrated WOFOST, calibrated WOFOST with EnKF data assimilation, calibrated WOFOST with EnKF-4DVar data assimilation, calibrated WOFOST with WW-4VES data assimilation), data-driven methods (LSTM, GRU, and Transformer), and our hybrid method. The results show that our hybrid method outperforms both process-based model-driven and data-driven methods in terms of the highest R2 (Yuhang: 0.831; Zijingang: 0.704) and the lowest RMSE (Yuhang: 372.8 kg/ha; Zijingang: 605.3 kg/ha). However, the R\u00b2 of process-based model-driven and data-driven methods are relatively lower (Yuhang: 0.652 ~ 0.816; Zijingang: 0.607 ~ 0.682), with higher RMSE (Yuhang: 391.5 ~ 538.9 kg/ha; Zijingang: 621.8 ~ 690.6 kg/ha), indicating that these methods have poor yield prediction performance. Therefore, the hybrid method is more suitable for wheat yield prediction.\nThe hybrid method was used to process data containing different numbers of times or orders and to analyze the differences between predicted and measured yields (Fig. 7). When data with fewer number of times are used, the difference between the predicted and measured yields is greater, and the difference gradually decreases as the number of growth stages increases. For each experiment, when all data were used (nine times data were collected for the Yuhang experiment and seven times data were collected for the Zijingang experiment), the predicted yield and the measured yield showed a strong linear fit, with an R2 of 0.831 and an RMSE of 372.8 kg/ha for the Yuhang experiment and an R2 of 0.704 and an RMSE of 605.3 kg/ha for the Zijingang experiment. The results show that more data can usually allow the model to better capture the relationship between features, reduce the bias of the model, and improve the accuracy of predictions. Especially when the training data is noisy or unbalanced, more data can help the model predict yield more accurately. When the total number of times the data is used is fixed, yield prediction accuracy improves when the data includes more from the middle and later stages of growth than data containing more from the early and middle stages. Specifically, when using data collected five times, the prediction results using the last five collected data increased R2 by 0.175 and RMSE by 156.6 kg/ha for the Yuhang experiment compared with the prediction results using the first five collected data. The prediction results using the last three collected data increased R2 by 0.147 and RMSE by 128.7 kg/ha for the Zijingang experiment compared with the prediction results using the first three collected data.\nThe field conditions at maturity are shown in Fig. 8a-c. We use the hybrid method and visualize the spatial distribution of wheat yield predictions for different varieties (Fig. 8g-i). For most breeding materials, the predicted yield was close to the measured yield . We compare the yield prediction results using only the data assimilation algorithm WW-4VES and the yield prediction results of the hybrid method , and find that the overall yield prediction results are similar, with large differences in the predictions of a few wheat breeding materials. In addition, we found that the average wheat yield of different germplasms from Australia, Turkey and the United States in the Changxing experiment exceeded the local average yield per hectare (Fig. 8j), and the average wheat yield of different germplasms from Japan, Italy, Turkey, Argentina and Australia in the Changxing experiment exceeded the local average yield per hectare\n4.3. ChatYield interactive yield predict\nThe user first inputs a question (query) into ChatYield, which is then processed by LlamaIndex and the hybrid method respectively. The LLM comprehensively processes the new prompt from LlamaIndex and the output of the hybrid method. Finally, the Q/A system displays the final answer (response). Before using ChatYield, the user needs to calibrate and verify the WOFOST crop model locally to ensure the correct operation of subsequent data assimilation and TFT method.\nWe show examples of different user questions using ChatYield (red box in Fig. 9), GPT-40 (yellow box in Fig. 9), and pre-trained Llama3.2-3.2-3B-Instruct (blue box in Fig. 9). More examples can be found in Table S8. Using remote sensing time series data and yield database, we can quickly predict wheat yield and obtain the yield performance of this variety of wheat in other"}, {"title": "5. Discussion", "content": "5.1. Advantages of hybrid method and tool\nCompared with process-based model-driven crop growth models, data-driven deep learning models and other hybrid methods, the hybrid method of this study has advantages in prediction accuracy. First, the hybrid method significantly outperforms the traditional calibrated WOFOST model in terms of crop yield prediction performance. This improvement is mainly attributed to the incorporation of deep learning, which can exploit the complex interrelationships between crop yield and other phenotyping (e.g., CV, CH). However, process-based models may not be able to fully describe these relationships [73]. The accuracy of simulations can be further improved by leveraging the knowledge constraints of crop models and the flexibility of deep learning [74]. At the same time, deep learning can integrate multiple data sources and effectively incorporate crop model predictions from all time alongside remote sensing data [9]. Then, the hybrid method shows superior performance than standalone deep learning models (GRU, LSTM, and Transformer) on different experiments. Unlike large-scale (global, national) deep learning models that rarely consider changes in agricultural practices [75], [76], [77], the hybrid method utilize process-based crop model that can be adapted to actual field management. This adaptability improves the accuracy of yield predictions, making this method valuable for decision-making in agricultural management practices. In addition, we incorporate remote sensing data assimilation into the hybrid method of this study to improve the performance of the crop model by providing more accurate and timely input data [19]. Furthermore, the integration of remote sensing data provides information on crop growth processes, thereby predicting yields more reliably than previous studies that used only the output variables of crop models as predictors.\nFor the yield prediction tool ChatYield, users can complete operations through natural language conversations without having to master complex menus or instructions, which reduces learning costs and improves user experience. ChatYield can simultaneously generate text and retrieve the latest information from external databases and the networks in real time, ensuring that the answers provided are accurate and timely. However, the data update cycle of static storage and display webs or desktop applications is relatively long and the information may be delayed [27], [78], [79]. ChatYield can handle information needs in multiple disciplines and fields, not limited to yield prediction and phenotyping retrieval, breaking the limitations of traditional webs or desktop applications focusing on a single function [80] and reducing the frequency of users switching between different applications. ChatYield can remember the conversation context of the user, provide personalized suggestions and continuous conversation experience, while traditional webs and desktop applications mostly require users to repeatedly enter the same type of data and cannot continuously track user needs [81]. ChatYield combines generation and retrieval functions to"}, {"title": "5.2. Key factors contributing to the hybrid method", "content": "This study used SHAP (Shapley Additive exPlanations) analysis [83", "values": "whether a positive or negative effect on prediction is related to feature values. Overall, the top three most important features in each of the three experiments were physiological parameters (TWRT, TAGP) from the crop model and VIs (MTCARI, NLI, NIRv, SIPI) from remote sensing with large feature importance scores. However, the importance scores of morphological characteristics (LAI, CV, and CH) were lower compared with physiological parameters and VI. Likewise, it is evident that the influence of many features on model predictions is mixed (with unclear"}]}