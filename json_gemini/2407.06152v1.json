{"title": "Uni-ELF: A Multi-Level Representation Learning Framework for Electrolyte Formulation Design", "authors": ["Boshen Zeng", "Sian Chen", "Xinxin Liu", "Changhong Chen", "Bin Deng", "Xiaoxu Wang", "Zhifeng Gao", "Yuzhi Zhang", "Weinan E", "Linfeng Zhang"], "abstract": "Advancements in lithium battery technology heavily rely on the design and engineering of electrolytes. However, current schemes for molecular design and recipe optimization of electrolytes lack an effective computational-experimental closed loop and often fall short in accurately predicting diverse electrolyte formulation properties. In this work, we introduce Uni-ELF, a novel multi-level representation learning framework to advance electrolyte design. Our approach involves two-stage pretraining: reconstructing three-dimensional molecular structures at the molecular level using the Uni-Mol model, and predicting statistical structural properties (e.g., radial distribution functions) from molecular dynamics simulations at the mixture level. Through this comprehensive pretraining, Uni-ELF is able to capture intricate molecular and mixture-level information, which significantly enhances its predictive capability. As a result, Uni-ELF substantially outperforms state-of-the-art methods in predicting both molecular properties (e.g., melting point, boiling point, synthesizability) and formulation properties (e.g., conductivity, Coulombic efficiency). Moreover, Uni-ELF can be seamlessly integrated into an automatic experimental design workflow. We believe this innovative framework will pave the way for automated AI-based electrolyte design and engineering.", "sections": [{"title": "1. Introduction", "content": "Lithium-based rechargeable batteries are a cornerstone of modern energy storage technologies, offering exceptional potential for high energy density, rapid charging capabilities, and longevity. Functioning as an ionic conductor and electronic insulator between electrodes while maintaining stability under extreme chemical conditions, the electrolyte, which interfaces with every other component, plays a vital role in battery operation 1-3. As we enter the era of high-energy-density batteries that place higher demands on electrolytes, especially with high-voltage cathode materials 4,5 and high-energy-density anode materials like lithium metal6,7, the design and engineering of electrolytes emerge as the main challenges. Current electrolyte systems based on ethylene carbonate (EC) are increasingly inadequate for these next-generation energy storage solutions 8,9. Consequently, breakthroughs in materials and chemistries crucial for next-generation batteries hinge on mastering electrolyte design.\nThe research and development of electrolytes present two primary challenges: innovating molecular design and manipulating electrolyte formulation. These challenges stem from the need to fine-tune the electrolyte's conductivity 10\u201312, solubility 13-15, stability 7,16, and compatibility with electrode materials 2,3 to meet stringent performance criteria. Unlike other fields, such as drug design, which mainly focus on the design and synthesis of monomeric small molecules, the design at the electrolyte formulation level is particularly crucial. This involves providing recommendations and predictions for the mixing ratio of molecules, including lithium salts, solvents, and functional additives. The interplay between these different components can significantly affect the energy density, cycle life, and overall performance of the batteries 17,18. The variety of molecular space further exacerbates the challenge for potential candidates and the abundance of mixing possibilities, especially in multi-component systems 12,13,19. We refer to Figure 1(a) for an illustration of electrolyte design at multiple levels.\nThe methodologies that heavily rely on trial-and-error lack the efficiency required for the rapid development of electrolyte systems. Over the past few decades, progress in computational approaches such as density functional theory"}, {"title": "2. Multi-Level Representation Learning", "content": "In the Uni-ELF scheme, we first acquire molecular and formulation representations through pretraining. After this phase, the model can be fine-tuned for various tasks by linking these representations to different fitting networks. For a visual overview, please refer to Figure 1(b), which illustrates representation learning at both the molecular and formulation levels."}, {"title": "2.1. Representation Learning at Molecular Level", "content": "The molecule-level representation learning approach is built upon Uni-Mol34, a three-dimensional molecular representation framework that leverages self-supervised pretraining to reconstruct molecular structures. As illustrated in Figure 1(b1), molecules, including key electrolyte components such as lithium hexafluorophosphate (LiPF6), ethylmethyl carbonate (EMC), ethylene carbonate (EC), and propylene carbonate (PC), are encoded using their three-dimensional coordinates and atom types. These encodings are refined to generate atom-pair representations and atomic representations. During pretraining, the model unmaskes atom types and denoises atom pair distances. Following pretraining on 209 million molecular conformations, we employ average pooling over all atomic representations to derive molecular representations, which are subsequently used for predicting molecular properties or serving as input for the formulation-level model.\nIn greater detail, the 3D structures of input molecules are generated using the MMFF94 force field39 from RDKit40. The Uni-Mol framework34 serves as the encoder, comprising 15 layers with an embedding dimension of 512 and a feedforward network dimension of 2048. Each encoder layer is equipped with 64 attention heads, utilizing GELU 41 for activation and tanh42 for pooler activation. The [CLS] token43, a virtual atom positioned at the center of mass of the molecule, is preserved to represent the entire structure in Uni-Mol. This design enables the model to capture long-range interactions between atoms, particularly within larger molecules. In tasks involving molecular charge distribution such as predicting the dielectric constant and refractive index-atomic representations are used to simultaneously predict Gasteiger charges44 within the molecule, thereby enhancing the model's ability to capture relevant electrostatic properties. The mean squared error (MSE) of the predicted charges is included as a loss term, with a weight of 0.1."}, {"title": "2.2. Representation Learning at Formulation Level", "content": "To enhance predictive capabilities, the formulation model should integrate specific inductive biases. Recognizing that entities are characterized not only by their intrinsic properties but also by their interactions with other entities, the model must distinguish between identical molecular species in varying contexts. Additionally, it should uphold permutation invariance for molecular input sequences, ensuring consistent output regardless of the order of inputs.\nTo achieve these goals, we designed the Uni-ELF backbone employing a transformer encoder architecture, as depicted in Figure 1(b2, c). At the formulation level, the model processes molecular representations weighted by their molar ratios, refining the representations of both individual molecular species and their interactions. These refined rep- resentations are then aggregated on the basis of their molar ratios. For tasks that involve environmental temperature, we introduce a temperature embedding block utilizing a Gaussian kernel. This block encodes temperature values through a set of evenly distributed Gaussian basis functions with specified means and standard deviations.\nThe model undergoes pre-training to predict solution structures, thereby learning formulation representations. Given the scarcity of experimental data, we supplement this with physical modeling to provide an additional source of structural data for transfer learning. Within the Uni-ELF framework, molecular dynamics simulations generate extensive data on the trajectories of solution particles. These trajectories are statistically averaged to extract the structural characteristics of the solution. Specifically, the radial distribution functions (RDFs) provide the density probability for"}, {"title": "3. Results on Downstream Tasks", "content": "We begin by leveraging the molecular representation capabilities of Uni-ELF to predict properties critical for electrolyte design. As illustrated in Figure 3, Uni-ELF demonstrates superior performance compared to state-of-the-art methods. For melting point prediction, it achieves an R2 of 0.857 and an RMSE of 34.31 \u00b0C, outperforming the previous benchmark of R2 0.830 and RMSE 36.88 \u00b0C45. In the prediction of boiling points and vapor pressures, Uni-ELF surpasses the OPERA model24, with an R2 of 0.975 and an RMSE of 13.49 \u00b0C for boiling points, and an R2 of 0.951 and an RMSE of 0.79 Log mm/Hg for vapor pressures. Additionally, it exceeds QSPR models in predicting dielectric constant, refractive index, and density, achieving R2 values of 0.966, 0.982, and 0.992, with corresponding RMSEs of 2.70, 0.082, and 0.025 g/cm\u00b3, respectively 23,25,26. These results underscore the advantage of representation learning over traditional QSPR methods in predicting molecular properties."}, {"title": "4. Applications", "content": "Although a comprehensive computational-experimental validation is deferred to future studies due to associated costs, we present the potential of Uni-ELF for molecular and formulation design via a conceptual application. In this context, we illustrate the rediscovery of fluoroacetonitrile (FAN), a high-conductivity solvent system recently reported by Lu et al. in Nature\u00b3, with minimal constraints on the molecular search space. We start by constraining the search space to molecules that are organic aprotic solvents containing cyano and fluoro groups, incorporating at least a four-membered ring if cyclic, and comprising up to eight heavy atoms. Compatibility with high-voltage cathodes is ensured by the inclusion of electron-withdrawing cyano (-C=N) groups, while anode compatibility is facilitated by fluorinated (-F) groups.\nAs shown in Figure 5(a), the conceptual experiment applies three objectives: high ionic conductivity for fast charging, wide liquid range for the solvent, and ease of synthesis, alongside four constraints mentioned above. To address these constraints, we begin by employing graph theory to enumerate potential molecules, starting with formonitrile (H-C=N). Utilizing a breadth-first search (BFS), we progressively add carbon (C), oxygen (O), or fluorine (F) atoms to the chain. Duplicates are filtered out on the basis of graph isomorphism, and the search continues until we generate chain molecules containing up to eight heavy atoms. Subsequently, we enumerate all possible configurations to form 4-6 membered rings, again eliminating duplicates. Unstable structures, such as those containing O-O bonds, or proton groups unsuitable for use as electrolytes, such as carboxyl groups, are discarded, resulting in a set of 1,165 candidate molecules. This entire search process is completed in under 30 seconds on a standard computer CPU.\nFollowing the identification of 1,165 candidate molecules, we employed Uni-ELF models to efficiently screen these compounds for their molecular and formulation properties. Molecular level properties, including melting point, boiling point, synthetic accessibility (synthesizability), and electrolyte conductivity, are predicted using Uni-ELF trained by publicly available data, with little direct information of the 1,165 candidates. At the formulation level, we generated a grid of 120 formulation points by systematically combining each molecule with LiPF6, LiTFSI, and LiFSI salts at varying concentrations. This approach enabled us to predict the room temperature conductivity for each formulation, providing a robust basis for chemists to establish evaluation criteria for subsequent experimental testing.\nWe filter and rank the molecules using the following criteria: (1) predicted melting point < 40\u00b0C and boiling point > 40\u00b0C; (2) presence in PubChem 47 or CAS, or synthetic accessibility probability \u2265 90%; (3) highest predicted room"}, {"title": "5. Conclusion and Outlook", "content": "In this work, we have introduced Uni-ELF, a multi-level representation learning framework designed to advance the formulation and optimization of electrolytes for lithium batteries. By leveraging a two-stage pretraining approach-reconstructing three-dimensional molecular structures using the Uni-Mol model and predicting statistical structural properties from molecular dynamics simulations-we have demonstrated significant improvements in predictive capabilities for both molecular and formulation properties.\nOur results show that Uni-ELF outperforms current state-of-the-art methods in predicting key properties such as melting point, boiling point, synthesizability, conductivity, and Coulombic efficiency. Notably, Uni-ELF can be seamlessly integrated into an automatic experimental design workflow, bridging the gap between computational predictions and experimental validation.\nLooking forward, the methodology presented here holds promise for broader applications beyond electrolyte design. For example, this approach could be extended to other areas requiring formulation-level prediction or generation, such as the design of pharmaceuticals and the extraction of formulation information from spectral data. We are optimistic that further refinement and validation of this framework will enhance its utility and impact across various scientific and engineering domains."}, {"title": "Data and Code Availability", "content": "Data and code used in this work will be made publicly available after the paper is published. For trial use of Uni-ELF, please refer to the Bohrium App at https: //bohrium.dp.tech/apps/uni-elf."}, {"title": "Conflict of Interests", "content": "DP Technology holds intellectual property rights pertinent to the research presented herein."}, {"title": "Supplementary Information", "content": "The Supplementary information is provided in the attached pdf."}]}