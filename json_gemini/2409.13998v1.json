{"title": "Relevance-driven Decision Making for Safer and More Efficient Human Robot Collaboration", "authors": ["Xiaotong Zhang", "Dingcheng Huang", "Kamal Youcef-Toumi"], "abstract": "Human intelligence possesses the ability to effectively focus on important environmental components, which enhances perception, learning, reasoning, and decision-making. Inspired by this cognitive mechanism, we introduced a novel concept termed relevance for Human-Robot Collaboration (HRC). Relevance is defined as the importance of the objects based on the applicability and pertinence of the objects for the human objective or other factors. In this paper, we further developed a novel two-loop framework integrating real-time and asynchronous processing to quantify relevance and apply relevance for safer and more efficient HRC. The asynchronous loop leverages the world knowledge from an LLM and quantifies relevance, and the real-time loop executes scene understanding, human intent prediction, and decision-making based on relevance. In decision making, we proposed and developed a human robot task allocation method based on relevance and a novel motion generation and collision avoidance methodology considering the prediction of human trajectory. Simulations and experiments show that our methodology for relevance quantification can accurately and robustly predict the human objective and relevance, with an average accuracy of up to 0.90 for objective prediction and up to 0.96 for relevance prediction. Moreover, our motion generation methodology reduces collision cases by 63.76% and collision frames by 44.74% when compared with a state-of-the-art (SOTA) collision avoidance method. Our framework and methodologies, with relevance, guide the robot on how to best assist humans and generate safer and more efficient actions for HRC.", "sections": [{"title": "I. INTRODUCTION", "content": "Robots and automation systems are becoming increasingly critical in enhancing productivity, efficiency, and precision in industry [1], [2], [3] and daily human life [4], [5]. However, they still struggle to match the exceptional cognitive capabilities of human beings. Among all cognitive mechanisms in human brains, humans are extraordinary at selectively focusing on important components within the environment, which guide our perception, learning, reasoning, and decision-making in daily life. It enables us to focus on relevant stimuli while filtering out irrelevant information in our environment, thus playing a crucial role in more efficient spatial perception, scene understanding, and decision-making [6], [7].\nTo empower the robot with similar capabilities, in [8], we defined a new and important concept and scene understanding approach, termed relevance, and developed methodologies for quantifying relevance with a novel event-based"}, {"title": "framework and a probabilistic methodology based on a new scene representation. Relevance is defined as the pertinence of objects in the scene based on the human objective or other factors. An example of relevance is shown in Fig. 1.", "content": "Relevance offers three key benefits in human-robot collaboration (HRC). First, accurately determined relevance enables the robot to better understand object applicability to the scene and potential interaction sequences, enhancing the efficiency, safety, and fluency of HRC. Second, focusing on relevant objects allows the robot to optimize its computational resources, improving speed and safety [9]. Third, relevance unites human, task, and scene models, facilitating more accurate predictions and reasoning by leveraging improvements from various areas.\nBuilding on the work in [8], this paper further develops and presents a framework for determining relevance and applying it to a novel real-time decision-making component that enhances safety in HRC. In this framework, two loops are running asynchronously, namely the async loop and the real-time loop. The real-time loop performs continuous real-time computation, including scene understanding, human intent prediction, and decision-making. The asynchronous"}, {"title": "loop leverages the world knowledge from Large Language Models (LLM) to predict the potential human objective and relevance. The real-time loop utilizes those results for decision-making to achieve proactive and safe HRC. Although the loop operates asynchronously, its execution rate dynamically adjusts based on the scene's conditions.", "content": "In the decision-making module, we developed a real-time methodology with human-robot task allocation and a novel motion planning methodology. With relevance, the traditional Artificial Potential Field (APF) methods for motion planning and collision avoidance are enhanced by a virtual obstacle constructed based on the future projection of the human motion and associated repulsive force formulation. In this way, the robot can behave in a proactive manner for safer and more efficient HRC. Simulation results demonstrate that our decision making module reduces the collision cases and frames by 63.76% and 44.74%, respectively.\nIn summary, the paper's contributions are as follows: (1) We proposed and developed a novel methodology to quantify relevance with human objective prediction and relevant object prediction based on LLMs. (2) We proposed and developed a novel two-loop framework to integrate LLM inference and relevance quantification into a real-time application by leveraging the asynchronous frameworks based on different inference requirements of different components. (3) We proposed and developed a novel methodology of decision making based on relevance. Simulations and experiments validate enhanced safety and lower collision probability with our Relevance-based Artificial Potential Field (RAPF)."}, {"title": "II. RELATED WORKS", "content": "This work is unique to the best of our knowledge and exceptionally contributes to the area of robotics in the following manners."}, {"title": "A. Saliency and Attention", "content": "Relevance fundamentally differs from previous works that aim to identify and underline the important regions in the scene, such as attention and saliency. Saliency focuses on identifying the visually prominent and conspicuous features in the image [10], [11], [12], while attention focuses on current short-term, reactive, and simple tasks without considering the future projection [13], [14]. Relevance fundamentally differs from those works in that relevance represents the inherent relationship between objects because of the human objective and the applicability of objects to achive the objective. Relevance considers the interconnection among environmental understanding, human models, task models, etc."}, {"title": "B. LLMs for Robotics", "content": "Large Language Models (LLMs) are revolutionizing robotics by enabling multi-modality reasoning [15], general prediction without transfer learning [16], and flexible connections between modules in robotic frameworks [17]. In this paper, we utilized LLMs for a dramatically different and novel application, i.e., relevance determination. Moreover,"}, {"title": "the current inference time of LLMs is longer than that of real-time computation requirements. Existing works with LLMS in robotics mainly apply to non-real-time policy generation in a static or pre-defined environment. Our unique two-loop design enables knowledge retrieval of LLMs in real-time applications by leveraging asynchronous computation.", "content": "C. Artificial Potential Fields\nAPF is an intuitive and efficient real-time robot motion planning method by simulating attractive forces toward goals and repulsive forces away from obstacles, enabling smooth and collision-free navigation [18]. Song et al. proposed a methodology called Predictive APF to anticipate obstacles based on the robot's velocity and the relative positions of obstacles to adjust the path before potential collisions [19]. However, their goal of incorporating prediction into APF is to smooth the path considering the dynamic constraints of the agent, which is dramatically different from ours. Moreover, their methodology is limited to environments with static obstacles. Our Relevance-based APF (RAPF) is to improve HRC safety by predicting the motion of the human and dynamically updating the path proactively in a highly dynamic environment."}, {"title": "III. PROBLEM DEFINITION AND METHODOLOGY", "content": "In this section, we introduce the problem definition and methodology for quantifying relevance and applying it to sensorimotor policy generation for safer and more efficient HRC."}, {"title": "A. Problem definition", "content": "Let $S = {C_1,C_2,...,C_n}$ be a set of class of objects in a visual scene, where each $C_i$ represents a class of objects and $n$ is the number of classes of objects in the scene. The set of relevant elements $\\Er$, which contains all the relevant elements to the human's objective and associated tasks, is predicted and determined with the available information. Based on $E_r$, the robot generates actions to assist the human to achieve the human's objective."}, {"title": "B. Framework overview", "content": "An overview of the framework is shown in Fig. 2. Our framework for relevance quantification and safer HRC consists of two loops. The first loop fulfills the function of perceiving the world, understanding the scene, and decision making based on relevance for safer HRC. The second loop is an asynchronous loop that leverages LLMs and quantifies relevance. By optimally coordinating the two loops, the world knowledge of the LLM can be incorporated into real-time operation of the robots."}, {"title": "C. Scene understanding", "content": "The input to the algorithm is the stream of observations from the robot sensors. The images are processed with scene understanding algorithms, such as YOLO [20] for object detection, MMPose [21] for human pose estimation, CLIP [22] for scene grounding, etc."}, {"title": "D. Human intention prediction", "content": "The module of human intention prediction determines current human actions and aggregates them into a history record. Here, we implement an algorithm that leverages Bayesian networks to fuse three modalities of human information: head orientation, hand orientation, and hand movement. By fusing three modalities for human intention recognition, the accuracy and precision of the prediction are dramatically increased because different modality provides valuable information in different stages of the actions."}, {"title": "E. Relevance Quantification with LLMs", "content": "In the original relevance formulation and quantification methodology, the scene is represented as classes and elements. The relevance of each class and element is determined in a sequential and hierarchical manner. In this paper, we adopted a direct prediction based on LLMs on the element level for simplicity. The goal of the LLMs in this paper is to predict the human objective and the set of relevant elements $E_r$, reflecting potential future object interactions and human motion.\nThe first step in quantifying relevance with LLM is contextualizing the scene. Currently, this is achieved with a fixed prompt $P$ designed and optimized specifically for the setup and the problem of HRC. However, in the future, automatic scene contextualization and prompt construction can be considered and developed. In the prompt $P$, the environment, the objects in the scene, and the action history of the human are automatically generated from the scene understanding and human intention prediction modules. The outputs of the LLM module are the prediction of the human objective and the set of relevant elements $E_r$. The relevance of each element is quantified to be\n\n$R(e_i)=\\begin{cases} 1 & \\text{if } e_i \\in E_r \\\\ 0 & \\text{otherwise} \\end{cases}$\nWith this method, world knowledge of an LLM can be extracted for a general environment and setup without any training and transfer learning."}, {"title": "F. Decision making - task allocation", "content": "Our framework's decision-making can be decomposed into two components: human task allocation and real-time motion generation with collision avoidance.\nFor the sake of simplicity, we assume that humans need all the relevant elements predicted for the objective. A more detailed inquiry method to derive the necessary and preferred elements can be found in [8]. The human-robot task allocation is formulated as an optimization problem and solved with an optimization solver.\nIn the problem definition, we define the subscript $j$ representing the index of elements such that $e_j \\in E_r$. We define the position vector of element $e_j$ in the world coordiante as $p_{ej}$, the position of the common destination of relevant elements as $p_d$, the initial location of the robot as $p_{ro}$, the velocity of the robot as $v_r$, the velocity of human as $v_h$, the start-up delay for the human to finish the current task as $d_h$. We consider $d_h$ because there is a temporal delay between the time the robot and the human start to fulfill the allocated tasks. We further define $T_r$ and $T_h$ as the time durations for the robot or the human to finish the assigned tasks, which can be computed as:\n\n$T_r = \\sum y_j(\\frac{||p_{ro} - p_{ej}||+||p_{ej} - p_d||}{v_r}+(1-y_j)\\frac{2||p_d - p_{ej}||}{v_r})$\n\nand\n\n$T_h = d_h+\\sum (1-x_j) (\\frac{2||p_d - p_{ej}||}{v_h})$\n\nWe define the decision variable Z as the maximum time taken to complete all tasks, and the optimization problem is formulated as:"}, {"title": "Minimize", "content": "$Z$\nSubject to:\n\n$\\sum y_j = 1,$\n\n$y_j \\le x_j \\forall j,$\n\n$Z \\ge T_r,$\n\n$Z \\ge T_h$\n\n$x_j, y_j\\in \\{0,1\\} \\forall j.$\nwhere $x_j$ is a binary decision variable where $x_j = 1$ if the robot moves $e_j$, and 0 otherwise, and $y_j$ is a binary variable where $y_j = 1$ if $e_j$ is the first task done by the robot, and 0 otherwise. (5) ensures that exactly one object is designated as the initial task performed by the robot. (6) specifies that an object can only be the first task executed by the robot if that object is assigned to the robot, as indicated by $x_j$. After the relevant objects are allocated to the robot or the human, the robot will execute the assigned tasks, generate the motion, and avoid obstacles dynamically in real time."}, {"title": "G. Decision making - motion planning", "content": "For dynamic motion planning and obstacle avoidance, our methodology is based on an APF formulation in [23]. The major contribution of our work, as shown in Fig. 3, is that we build a virtual obstacle from the current human hand based on the predicted human motion and update the repulsive force based on the virtual obstacle for proactive and safer motion generation.\nIn our APF, the attractive force $F_a$ is modeled as:\n\n$F_a=A\\cdot(\\frac{d_g}{d_a})^{1-exp(-\\frac{d_g}{\\alpha_a})}\\hat{u_a}$\n\nwhere $A$ is the magnitude of the attractive force, $d_g$ is the distance between the robot and its goal, $d_a$ is the constant that controls how the attractive force decreases with distance, and $\\hat{u_a}$ is the unit vector from the robot to the goal.\nThe repulsive force by obstacles other than the human's hand $F_{ro}$ is constructed as:\n\n$F_{ro} = \\sum_{i=1}^{m} + \\frac{R}{1 + exp((\\frac{d_{o_i}}{p}) - 1)\\alpha_r}\\hat{u_{ri}}$\nwhere $m$ is the number of elements in the scene, $R$ is the magnitude of the repulsive force, $d_{o_i}$ is the distance between the robot and the obstacle $e_i$, and $\\hat{u_{ri}}$ is the unit vector from the obstacle $e_i$ to the robot location. p, and $\\alpha_r$ are two factors defining the shape and decreasing rate of the repulsive force as the distance increases, respectively.\nTo consider the future motion of the human hand, we developed a novel methodology to construct an ellipsoid virtual obstacle as shown in Fig. 3. The two endpoints of the major axis of the ellipsoid are the current position of the human hand $p_h$ and the position of the predicted hand destination $p_t$. The semi-axes $a$, $b$, and $c$ of the ellipsoid are given by:"}, {"title": "$\\frac{||p_h-p_t||}{2}$\n$b = k_b a$\n$c = k_c a$\nwhere $k_b$ and $k_c$ are two factors controlling the shape of the ellipsoid. The repulsive force from this virtual obstacle is updated to\n\n$F_{rv}= \\frac{k_r(\\frac{d_c}{R})^{2}}{1+exp(-(\\frac{d_c}{p})-1)\\alpha_r)}\\hat{u_{rv}}$\n\nWhere $d_c$ is the distance from the robot to the closest point on the ellipsoid $p_c$, $\\hat{u_{rv}}$ represents the unit normal vector at the closest point on the ellipsoid, and $k_r$ is a new factor we proposed representing a scale factor on the force magnitude based on the proximity to the human. In this paper, $k_r$ is computed as:\n\n$k_r = 1 - \\frac{(p_c-p_h)\\hat{u_{nt}}}{(v_h+v_r)\\cdot t_s}$\nwhere $\\hat{u_{nt}}$ represents the unit vector from $p_h$ to $p_t$, and $t_s$ is a time factor we proposed in the unit of s reflecting the available safety buffer in terms of time. $k_r$ decreases as $p_c$ becomes farther away from $p_h$. Without $k_r$, $F_{rv}$ will consider the virtual obstacle too early and conservatively, which will result in unnecessary detour and a longer robot trajectory.\nThe total force acting on the robot $F_t$ is the sum of the attractive force and repulsive forces from both the physical obstacles and the virtual obstacle:\n\n$F_t = F_a + F_{ro} + F_{rv}$\nThis total force determines the direction and magnitude of the robot's motion, allowing it to avoid both physical and virtual obstacles while moving towards its goal.", "content": "IV. EVALUATION SETUP\nIn this section, we introduce the evaluation setup for our proposed methodologies on leveraging LLMs for objective and relevance prediction and relevance in decision making for safer and more efficient HRC."}, {"title": "A. Dataset", "content": "The performance of human objective prediction and relevance prediction is assessed via the Breakfast Actions Dataset [24], which comprises a variety of typical human activities performed during breakfast time (e.g., preparing coffee, cooking pancakes, and making hot chocolate, etc.). For each test, ground truth data provides the ground truth objective (GTO), and the ground truth plan (GTP), which describes the sequence of actions performed by an individual in the execution of the objective. In our evaluation, a step ratio of segments from the GTP is contextualized and input into LLM to predict the human objective and the set of relevant elements. Three distinct ratio step values: 0.25, 0.5, and 0.75 are employed. The objective prediction is evaluated through a manual assessment process. The predicted relevant objects are evaluated automatically with word matching. The metrics for the evaluation are percentages of tests with correct prediction of the objective and the relevant elements."}, {"title": "B. Simulation Development and Setup", "content": "To verify the effectiveness of relevance for safer HRC, we developed a simulator as shown in Fig. 4. In the simulator, we constructed the environment with a table (the cyan cuboid) and objects on top of the table. The height of the table is set to be 73 cm. The table size is 180 cm in the x direction, 6 cm in the z direction, and 76 cm in the y direction. The objects on the table consist of two parts: the necessary objects for the objective and randomly added objects from a list of kitchen objects. The locations for each objects on the tabletop are randomly selected from a collection of locations uniformly distributed on a half circle with a radius of 60 cm. The diameter of each object is 8 cm.\nA human's hand (the red dot) is added to the simulator to simulate the human's motion. A UR5 robot is mounted on the other end of the table, reasoning about the human objective and the relevant objects and generating safe actions to best assist the human by accomplishing the human's objective with minimum time. The initial locations of the human and the robot are shown in Fig. 4. To take the inference time of LLM into consideration, the simulation runs and progresses in real time with a frequency of 30 Hz. The velocities of the human's hand and the end gripper are set to be 0.4 m/s.\nTo test the effectiveness of relevance and our decision-making methodology, we focus on comparing two methods. The first method uses relevance and our decision-making with virtual obstacles, as described in Section III. For the comparison, we built a baseline test without virtual obstacles but with relevance. It's worth noticing that, without relevance, the robot has no idea about its tasks to assist the human. Thus, we assign the same tasks as the relevance test cases to the robot. And the robot starts to move with exactly"}, {"title": "the same frame index as the relevance cases. Without loss of generality and for simplicity, we test on the objective of making cereals, and the relevant objects are cereal, bowl, milk, and spoon.", "content": "V. EVALUATION RESULTS\nIn this section, we present the evaluation results of our proposed methodologies, demonstrating their effectiveness."}, {"title": "A. Accurate Objective and Relevance Prediction", "content": "Our evaluation results are depicted in Table. I, confirming the effectiveness of our methodology for objective and relevance prediction across various scenarios. At a step ratio of 0.75 with more human actions contextualized and fed into LLM, our methodology achieves a high objective prediction accuracy of 0.90 and a relevance prediction accuracy of 0.96.\nWe first analyze the performance of objective prediction using our methodology, upon which relevance determination depends. Upon further examination of individual objectives, certain objectives, such as the preparation of cereal, coffee, hot chocolate, juice, salad, and tea, exhibit consistently high predictive accuracy across all evaluated ratio steps. The prediction accuracy for those objectives is high even at a low step ratio of 0.25, demonstrating our methodology can accurately identify the human's objective at an early stage of the human action and motion. Consistent with expectations, an increase in the \"ratio steps\" parameter correlates positively with enhanced prediction accuracy. The contextualization of the scene with a higher step ratio will contain more indicative cues about the objectives and thus improve the objective prediction accuracy. The inaccuracy for fried eggs is attributed to the inherent similarity between the objectives involving eggs, such as omelettes and scrambled eggs. However, the relevance for those objectives are very similar.\nNext, we analyze the performance of relevance prediction using our methodology based on the predicted objective. The relevance prediction performs extraordinarily for specific objectives, including hot chocolate, juice, and salad, which achieves a 100% accuracy at the step ratio of 0.25. The prediction accuracy of all other objectives achieves at least 0.85 at the step ratio of 0.75. For the relevance prediction, the"}, {"title": "accuracy also increases with the step ratio. It's worth noting that the relevance prediction for the objectives predicted with low accuracy can still be accurate. This is attributed to the fact that similar objectives, such as omelettes and scrambled eggs, share the same relevance, which bolster the relevance prediction despite inaccuracies in objective identification.", "content": "B. Real-time and Safer Decision Making\nThrough all the test cases, our methodology of relevance determination robustly and correctly predicts the human's objective and the set of relevant elements for making cereals as bowl, spoon, milk, and cereal. Our human robot task allocation module robustly solves the optimization problem in real-time to generate the tasks for the robot. Thus, we focus on the evaluation of the virtual obstacle and collision avoidance. The test results of our real-time and safe decision making methodology are shown in Table II.\nWith our RAPF, the robot actions generated are much safer, with the rate of collided cases decreasing by 63.76% and the rate of collided frames decreasing by 44.74%. A visual comparison between the two methods is shown in Fig. 5. The frames at t = 3.37s are the frames before the collision. With the relevance and the virtual obstacle, the repulsive force (shown with a gold arrow) is more perpendicular to the hand trajectory and thus pushes the gripper further from the hand smoothly. At t = 3.67s, the gripper and the human collide in the baseline test because there is not enough duration of repulsive force to push the gripper farther away from the hand trajectory. However, with the virtual obstacle, no collision happens because of the proactive repulsive force generated by the virtual obstacle. Those results demonstrate the effectiveness of relevance and RAPF in informing the robot how to best assist humans and generate safer and more efficient actions."}, {"title": "VI. CONCLUSIONS AND FUTURE WORKS", "content": "Relevance is a novel concept inspired by the human cognitive abilities to evaluate the pertinence of objects based on the human's objective or other factors. In this paper, we developed a novel two-loop framework that robustly, efficiently, and accurately quantifies relevance and applies relevance to improve the effectiveness and safety of HRC. This framework integrates an asynchronous loop to leverage world knowledge from an LLM and quantify relevance, as well as a real-time loop to execute scene understanding, human intention prediction, and decision-making. Moreover, we proposed and developed a decision making methodology based on relevance, integrating human robot task allocation and real-time motion generation. In motion generation, we developed a methodology to construct a virtual obstacle and formulate the associated repulsive force. Simulations and experiments verify that our framework performs well for relevance quantification, with an objective prediction accuracy of 0.90 and a relevance prediction accuracy of 0.96. Simulations further verify our novel motion generation methodology dramatically decreases the cases with a collision by 63.76% and the frames with a collision by 44.74%. The robot is comprehensively informed about how to best assist the human with relevance, and our decision making module generates safe actions to achieve the assistance."}]}