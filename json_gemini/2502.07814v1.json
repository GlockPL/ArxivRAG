{"title": "Satellite Observations Guided Diffusion Model for Accurate Meteorological\nStates at Arbitrary Resolution", "authors": ["Siwei Tu", "Ben Fei", "Weidong Yang", "Fenghua Ling", "Hao Chen", "Zili Liu", "Kun Chen", "Hang Fan", "Wanli Ouyang", "Lei Bai"], "abstract": "Accurate acquisition of surface meteorological conditions\nat arbitrary locations holds significant importance for\nweather forecasting and climate simulation. Due to the fact\nthat meteorological states derived from satellite observa-\ntions are often provided in the form of low-resolution grid\nfields, the direct application of spatial interpolation to ob-\ntain meteorological states for specific locations often re-\nsults in significant discrepancies when compared to actual\nobservations. Existing downscaling methods for acquir-\ning meteorological state information at higher resolutions\ncommonly overlook the correlation with satellite observa-\ntions. To bridge the gap, we propose Satellite-observations\nGuided Diffusion Model (SGD), a conditional diffusion\nmodel pre-trained on ERA5 reanalysis data with satellite\nobservations (GridSat) as conditions, which is employed\nfor sampling downscaled meteorological states through a\nzero-shot guided sampling strategy and patch-based meth-\nods. During the training process, we propose to fuse the\ninformation from GridSat satellite observations into ERA5\nmaps via the attention mechanism, enabling SGD to gen-\nerate atmospheric states that align more accurately with\nactual conditions. In the sampling, we employed optimiz-\nable convolutional kernels to simulate the upscale process,\nthereby generating high-resolution ERA5 maps using low-\nresolution ERA5 maps as well as observations from weather\nstations as guidance. Moreover, our devised patch-based\nmethod promotes SGD to generate meteorological states at\narbitrary resolutions. Experiments demonstrate SGD ful-\nfills accurate meteorological states downscaling to 6.25km.", "sections": [{"title": "1. Introduction", "content": "Precision in acquiring meteorological variable states at a\nsmall scale is pivotal to weather forecasting, which en-\ndeavors to predict forthcoming meteorological conditions\nby correlating current weather phenomena with subsequent\natmospheric states, further aiding citizens, businesses, and\nnations in making informed decisions regarding future so-\ncietal activities [6, 24, 34]. Therefore, enhancing the ac-\ncuracy of weather forecasts holds considerable significance\nfor enterprise production and daily life, which necessitates\nextracting more accurate meteorological data on a finer\nscale [27, 29].\nDownscaling is an effective method for capturing de-\ntails meteorological data at a finer scale, which aims to\ntransform low-resolution maps from meteorological data\nsuch as ERA5 reanalysis dataset into corresponding high-\nresolution maps at a small scale to obtain more accurate\nand detailed meteorological data [1, 8, 11].\nical field data at relatively coarse resolutions and directly\nconstruct and model the downscaling process [17, 47].\nHowever, for the downscaling task of ERA5 maps, a cou-\npling relationship exists between ERA5 reanalysis data and\nsatellite observations [41, 42]. Satellite observations, such\nas brightness temperature, and humidity, are the major fac-\ntors influencing the atmospheric states [32]. Consequently,\ncompared with directly constructing a downscaling model\nof ERA5 maps, incorporating satellite observations as con-\nditional inputs via cross-attention module during the down-\nscaling process is essential to ensure that the generated\nhigh-resolution ERA5 meteorological data aligns more ac-\ncurately with actual conditions [13, 21, 37].\nTo this end, we propose the Satellite-observations\nGuided Diffusion Model (SGD) based on the conditional\ndiffusion model.\ning the sampling process, instead of directly modeling the\ndownscaling process, we leveraged its inverse to guide the\ngeneration of high-resolution ERA5 maps by incorporating\nguidance from low-resolution maps and observations from\nweather stations, which enables SGD to yield high-quality\nsmall-scale maps with faithful details. A convolutional ker-\nnel \\(D\\) with optimizable parameters \\(\\varphi\\) is utilized to sim-\nulate the upscaling process, which is updated in real-time\nacross reverse steps \\(t\\), aiming to guide the details of gen-\nerated small-scale maps closer to both the original ERA5\nmaps and station-level observations. A distance function\n\\(\\mathcal{L}\\) is proposed to measure the discrepancy between the two,\nand its gradient was used to update the mean of the sam-\nples, guiding the generation of small-scale maps with fine\ndetails based on both the low-resolution maps and station-\nlevel observations. The convolutional kernel parameters are\nupdated through the gradient with respect to the parameters\nthemselves, ensuring that the model dynamically refines its\nability to construct the resolution conversion process. Ex-\ntensive experiments have demonstrated that SGD can gen-\nerate more accurate high-resolution ERA5 maps than off-\nthe-shelf interpolation-based and diffusion-based methods.\nAblation studies further validate the effectiveness of utiliz-\ning GridSat maps as conditioned inputs. Simultaneously,\nwe have also analyzed further optimization solutions for the\nperformance and generation accuracy of SGD through com-\nprehensive experiments. Our contributions are three folds:\n\u2022 We propose SGD for ERA5 meteorological states down-\nscaling. By integrating GridSat satellite observations into\nthe conditional diffusion model to capture the coupling\nbetween satellite observations and ERA5 maps, SGD is\ncapable of generating atmospheric states that are more\naligned with real-world conditions.\n\u2022 We employ an optimizable convolutional kernel to sim-\nulate the upscaling during the sampling process. By\ndrawing upon a distance function, we incorporate guid-\nance from both low-resolution ERA5 maps and station-\nlevel observations at a scale of 25km into the generation\nof small-scale ERA5 maps, thereby enabling the model\nto produce high-quality ERA5 maps at 6.25km or even\nsmaller scale that exhibit faithful details."}, {"title": "2. Related Workds", "content": "Downscaling. Downscaling aims to transform original low-\nresolution maps into their smaller-scale counterparts to ac-\ncurately obtain surface meteorological states at minor lo-\ncations [3, 10, 45]. Based on this objective, various deep\nlearning methods [31, 33] have been employed for the\ndownscaling of meteorological maps. For instance, genera-\ntive adversarial network (GAN) based methods incorporate\na generative adversarial loss which enables the generator to\nproduce results indistinguishable from real maps by the dis-\ncriminator [7]. CliGAN [4] is a GAN-based downscaling\napproach for precipitation data derived from global climate\nmodels to regional-level gridded data by employing a con-\nvolutional encoder-dense decoder network.\nIn recent years, diffusion models have been widely uti-\nlized due to their diversity and their capability to pro-\nduce high-quality downscaling maps [12]. Recent inves-\ntigation [2] has centered on the downscaling of fluid flows\nutilizing generative models founded on diffusion maps and\nLatent Diffusion Models (LDM). Moreover, [30] integrates\ndynamical downscaling with generative methods to aug-\nment the uncertainty estimates of downscaled climate pro-\njections, thereby demonstrating the potential of diffusion\nmodels in refining downscaling methodologies. However,\nthese methods overlook the coupling relationship that exists\nbetween ERA5 reanalysis data and satellite observations.\nTherefore we aim to employ GridSat maps as conditions\nand downscale the resolution of ERA5 maps from 25km to\n6.25km based on a conditional diffusion model.\nDiffusion-based SR. Super-resolution is an image pro-\ncessing technique that aims to increase the resolution of the\nimage and enhance the clarity and intricate details within\nthe image [40]. Recent advancements in super resolu-\ntion [14, 23, 25] have seen the emergence of diffusion mod-\nels as a promising approach to address various challenges in\nthis task, such as over-smoothing, mode collapse, and com-\nputational inefficiency. [19] illustrates the efficacy of cas-\ncaded diffusion models in producing high-fidelity images,\nwith a particular emphasis on class-conditional ImageNet\ngeneration. Furthermore, [26] presented PatchScaler, a\npatch-independent diffusion-based method for single image\nsuper-resolution. Nonetheless, meteorological data owns its\ncharacteristics such as uneven spatial distributions and in-\ntricate spatial correlations compared with natural images.\nTherefore, we aim to train a meteorology-specific diffusion\nmodel that is conditioned on satellite observations, which is\nable to generate high-resolution meteorological data under\nthe guidance of current low-resolution reanalysis data and\nstation-level observations."}, {"title": "3. Methodology", "content": "The key idea of our satellite observations guided condi-\ntional diffusion model, SGD, is to employ satellite obser-\nvations (GridSat) as conditional inputs to enhance the co-\nherence of the SR maps generated by the conditional diffu-\nsion model. Satellite observations are utilized to obtain the\nreanalysis data, such as ERA5. Therefore, leveraging origi-\nnal satellite observations enables the generated SR maps to\nalign more closely with actual conditions. Additionally, LR\nERA5 maps serve as the guided maps during the sampling\nprocess, ensuring the generation of maps replete with faith-\nful details. An overview of our SGD is depicted in Fig. 2.\n3.1. Pre-trained Encoder\nThe pre-trained encoder is employed to obtain the embed-\nding feature of each channel within every GridSat map. The\nencoder extracts features through convolutional operations\nand skips connections, while the decoder reconstructs the\nfeatures of GridSat via a symmetric architecture. The de-\ntailed structure of the encoder is shown in Appendix. Fol-\nlowing the pre-training of the encoder architecture \\(f\\) with\nparameter \\(\\varphi\\), SGD is capable of more effectively integrating\nthe features of GridSat maps with those of ERA5 and sub-\nsequently inputting them into the UNet-based conditional\ndiffusion model. Further analysis of the encoder's role will\nbe conducted in Sec. 4.6.\n3.2. Satellite Conditioning Mechanisms\nTraditional unconditional DDPMs do not rely on additional\nconditions during training, resulting in generated images\nthat tend to lack specific guidance and semantic coherence.\nIn contrast, conditional DDPMs guide the generation pro-\ncess by incorporating external conditional information such\nas labels, textual descriptions, or images, allowing for effec-\ntive control over the features and attributes of the generated\nresults. For the downscaling task of ERA5 maps, consid-\nering that the ERA5 data is derived from satellite observa-\ntion, a coupling relationship exists between the two maps.\nThe brightness temperature data obtained from satellite ob-\nservations significantly influence the meteorological states\nwithin ERA5.\nTherefore, SGD employs a GridSat map conditional\nDDPM. By leveraging the GridSat map as a condition, the\ndiffusion model is transformed into a conditional generator,\neffectively utilizing the features within GridSat to generate\nhigh-resolution atmospheric states that are more consistent\nwith reality during the sampling process. After the Grid-\nSat features are extracted by the encoder into a latent-space\nrepresentation, it is then integrated with the ERA5 maps\nthrough the cross-attention mechanism to facilitate the fu-\nsion of features.\n\\(\\text{Atten}(Q, K, V) = \\text{softmax}(\\frac{W_Q(x)W_K(y')^T}{\\sqrt{d}}) \\cdot W_V(y')\\)\n(1)\nThe matrices \\(W_Q \\in \\mathbb{R}^{d \\times d_e}, W_K, W_V \\in \\mathbb{R}^{d \\times d_r}\\), which\nserve as learnable projection matrices with trainable param-\neters, are respectively utilized to amalgamate the feature in-\nformation from the ERA5 map \\(x\\) and the conditioning input\n\\(y'\\) within the same time period. We extracts features from\nERA5 maps, while \\(W_K\\) and \\(W_V\\) process features derived\nfrom GridSat maps. The parameters of cross attention mod-\nule are jointly optimized with the UNet backbone.\nBased on this foundation, the map-conditioned DDPM\ncan undergo training according to the following objective.\n\\(\\mathbb{E}_{\\epsilon \\sim \\mathcal{N}(0,1), y', t \\sim [0,T]} [||\\epsilon - \\epsilon_\\theta (x_t, y', t) ||^2]\\).\n(2)\n3.3. Downscaling ERA5 via Zero-shot Sampling\nIn this section, we employ pre-trained GridSat map condi-\ntional DDPMs to generate high-resolution ERA5 maps that\nare faithful to the real surface meteorological conditions.\nOff-the-shelf deep learning methods commonly downscale\nERA5 maps without leveraging satellite data, thereby ne-\nglecting the intricate coupling between satellite observa-\ntions and ERA5 maps. This overlook will lead to discrep-\nancies between the downscaled outcomes and actual con-\nditions. Meanwhile, the high-resolution ERA5 map with\nfaithful details contains more precise information and holds\ngreater value in practical data applications as it is more\nclosely aligned with actual observations. In pursuit of this\neffect, SGD utilizes low-resolution ERA5 maps to guide the\nreverse steps of the conditional diffusion model. A convo-\nlutional kernel with optimizable parameters is developed to\nachieve a downscaling process at arbitrary resolution. The\nsampling process is capable of downscaling the resolution\nof ERA5 maps from a scale of 25km to 6.25km with accu-\nrate details.\nSpecifically, as illustrated in Fig. 2, SGD utilizes opti-\nmizable convolutional kernels \\(D\\) with parameter \\(\\varphi\\) in the\nreverse steps of conditional DDPMs to facilitate the reso-\nlution transformation of the sampled maps \\(x_t\\). A distance\nfunction \\(\\mathcal{L}\\) is then employed to quantify the discrepancy\nbetween the convolved sampled map \\(D(x_0)\\) and the low-\nresolution ERA5 map \\(z\\). The distance function can utilize\nthe mean squared error (MSE) loss between the two maps\nas guidance from ERA5, or alternatively, integrate station-\nlevel observations to facilitate bias correction. The latter\nemploys average mean absolute error (MAE) loss across\ntwo maps for each variable at global stations, thereby en-\nsuring that SGD yields more precise numerical results at\neach station. Specific configurations and the effects of the\ndistance function are shown in Sec. 4.5. The gradients of"}, {"title": "4. Experiments", "content": "4.1. Datasets\nERA5. ERA5 [16] is a global meteorological reanaly-\nsis dataset provided by the European Centre for Medium-\nRange Weather Forecasting (ECMWF), encompassing data\nsince 1979. Its atmospheric variables are derived from at-\nmospheric data collected at 37 different altitude levels, and\nit also includes several variables that represent Earth surface\nmeteorological information. The entire grid comprises 721\nlatitude and 1440 longitude grid points. In our experiment,\nwe selected four surface-level variables for the global: U10,\nV10, T2M, and MSL. All four variables exhibit a correla-\ntion with human activities. The specific meanings and units\nof these variables are outlined in Tab. 1.\nGridSat. GridSat [38] dataset is a comprehensive series\nof satellite data products provided by the National Environ-\nmental Satellite, Data, and Information Service (NESDIS)\nof the National Oceanic and Atmospheric Administration\n(NOAA). GridSat dataset is primarily based on Earth obser-\nvation data acquired from NOAA's geostationary satellite.\nThese data within the GridSat collection are routinely em-\nployed in meteorological analyses and climatological stud-\nies for the estimation of cloud cover and surface tempera-\nture, thereby contributing to a more accurate representation\nof atmospheric variables. Among the multitude of variables\nwithin this dataset, we have selected three specific param-\neters: IrWin_CDR, Irwin_VZA_Adj, and IrWVP. The de-\ntailed information of these variables are illustrated in Tab. 1.\n4.2. Implementation Details\nWe have trained SGD on the ERA5 reanalysis dataset and\nthe GridSat satellite observation maps for approximately\n200,000 steps. The temporal intervals of the samples within\nboth the ERA5 and GridSat datasets are 6 hours. We have\nselected the data from 2010 to 2021 as the training set, the\nentirety of the 2022 data as the validation set, and the first 6\nmonths of 2023 as the test set. The ERA5 maps employed in\nthe training encompass four channels, each with a shape of\n720 x 1440, while the GridSat maps feature three channels,\neach channel have a shape of 2000 \u00d7 5143. All the train-\ning task are conducted on NVIDIA A100 80GB GPU. For\nthe training process, SGD is optimized using AdamW with\n\\(\\beta_1 = 0.9\\) and \\(\\beta_2 = 0.999\\) in 16-bit precision with loss scal-\ning, while keeping 32-bit weights, Exponential Moving Av-\nerage (EMA), and optimizer state. The pre-trained encoder\nmodule employs the mean squared error as its loss func-\ntion during training, undergoing the process for 100 epochs.\nDuring the sampling phase, we utilize the same UNet struc-\nture as in the training process of conditional DDPM and em-\nploy an identical noise schedule. The kernel size used for\nsimulating upscaling is 9 \u00d7 9 and the variance \\(\\beta_t\\) we utilize\nundergoes a linear increase from \\(\\beta_1 = 10^{-4}\\) to \\(\\beta_T = 0.02\\).\n4.3. Evaluation Metrics\nTo compare the performance disparities between the pro-\nposed SGD and other interpolation-based and diffusion-\nbased downscaling methodologies, we employ the interpo-\nlation of ERA5 reanalysis maps into station scale to vali-\ndate the efficacy of our model. These compared methods\nleverage interpolation to extract meteorological state vari-\nables from ERA5 maps at the scale of observation stations.\nSpecifically, we utilize the grid_sample function from the\nPyTorch to directly interpolate ERA5 maps with resolutions\nof 1\u00b0 and 0.25\u00b0, which is based on the absolute latitude and\nlongitude positions of global stations from the Weather5k\ndataset [15], which is a large-scale time series forecasting\ndataset containing weather data from 5,672 weather stations\nworldwide. We select MAE loss and MSE loss to quantify\nthe inherent bias between the ERA5 maps derived from var-\nious downscaling methods and station observations.\n4.4. Main Results\nIn this section, we conduct qualitative comparisons on\ndownscaled maps with other methods and quantitative com-\nparisons within the inherent bias of generated ERA5 me-\nteorological state variables at the scale of observation sta-\ntions. The interpolation-based methods encompass bilinear\nand bicubic interpolation, while the diffusion-based meth-\nods include GDP [12], and DDNM [44].\n4.5. Station Observations as Additional Guidance\nWithin the sampling process, SGD incorporates ERA5\nmaps as a guiding framework, thereby enabling the gen-\neration of downscaling results containing faithful details.\nThe guided sampling is achieved through the utilization of\na distance function to evaluate the disparity between the\nmaps upscaled by optimizable convolution kernels and the"}, {"title": "5. Conclusion", "content": "We propose SGD, a conditional diffusion model for ro-\nbust downscaling, which enables the downscaling of ERA5\nmaps to arbitrary resolutions for the extraction of intri-\ncate meteorological states. Specifically, considering that\nERA5 data is derived from satellite observation data and\nthe brightness temperature data from satellite observations\nsignificantly influences the meteorological states within\nERA5, SGD employs GridSat satellite observation maps\nas conditions to generate downscaled ERA5 maps that\nmore accurately align with actual meteorological states.\nDuring the sampling process, SGD utilizes the generative\nprior within the conditional diffusion model, thereby in-\ncorporating guidance both from low-resolution ERA5 maps\nand station-level observations through the optimizable ker-\nnel and distance functions. Experiments demonstrate that\nSGD is capable of generating atmospheric states in high-\nresolution maps with more ideal accuracy and faithful de-\ntails than various off-the-shelf methods SGD also show-\ncases its capability of producing high-quality ERA5 maps\nat a small scale of 6.25km.\nLimitations and Future Work. The training data in SGD\nconsists of ERA5 and GridSat. However, SGD serves as\na versatile framework that could incorporate more modali-\nties such as other reanalysis data, observations from polar-\norbiting satellites, sounding and radar data. Once these\nsystematic data are all integrated into SGD, more accurate\nweather conditions near the surface can be achieved."}, {"title": "6. Preliminary", "content": "Unconditional diffusion model, proposed by [18], is a pow-\nerful generative model composed of a forward process and\na reverse process. The former aims to gradually introduce\nrandom Gaussian noise into the original images over T dif-\nfusion steps, ultimately resulting in pure Gaussian noise\n\\(x_T \\sim \\mathcal{N}(0, I)\\). The latter, being the reverse of the for-\nward process, intends to denoise and sample the generated\nimages from the pure Gaussian noise through a pre-trained\nnoise estimation network.\nThe forward process is a Markov chain without learnable\nparameters. The denoising method for each step is defined\nby the following equation, where \\(\\beta_t\\) refers to the variance\nof the forward process, which is experimentally set as a hy-\nperparameter solely dependent on the diffusion steps \\(t\\).\n\\(q(x_t|x_{t-1}) = \\mathcal{N}(x_t; \\sqrt{1 - \\beta_t}x_{t-1}, \\beta_tI)\\).\n(7)\nFor each steps in the reverse process \\(p(x_{t-1}|X_t) =\\n\\mathcal{N}(x_{t-1}; \\mu_\\theta (x_t, t), \\Sigma_\\theta I)\\), the mean of the distribution is\nhard to compute directly as the forward process. Conse-\nquently, we necessitate the utilization of a neural network\nwith parameter \\(\\theta\\) to estimate the noise inherent within the\nimage \\(x_t\\). By employing Bayes theorem, we can express\nthe mean and variance of the reverse process as follows:\n\\(\\mu_\\theta (x_t, t) = \\frac{1}{\\sqrt{\\alpha_t}} (x_t - \\frac{\\beta_t}{\\sqrt{1-\\bar{\\alpha}\\_t}} \\epsilon_\\theta (x,t))\\) (8)\n\\(\\Sigma_\\theta(x) = \\frac{1 - \\bar{\\alpha}{t-1}}{1-\\bar{\\alpha}\\_t} \\beta_t,\\) (9)\nAmong them, \\(\\epsilon_\\theta(x_t,t)\\) represents the noise estima-\ntion function, which is pre-trained by utilizing the low-\nresolution ERA5 maps. It performs real-time estimation\nand simulation of the noise contained within the maps,\nthereby enabling denoising to sample \\(x_{t-1}\\). The uncondi-\ntional diffusion model is trained utilizing maximum likeli-\nhood estimation, with the objective for each training itera-\ntion defined as follows:\n\\(\\mathbb{E}*{\\epsilon \\sim \\mathcal{N}(0,1),t \\sim [0,T]} [||\\epsilon - \\epsilon*{\\theta}(x_t, t)||2]\\).\n(10)"}, {"title": "7. Patch-based Methods", "content": "The scale of the ERA5 maps used as input for SGD reaches\n25km\u00d725km. To address the downscaling task at this reso-\nlution, we employed a patch-based method during the sam-\npling process of the conditional DDPM. The detailed intro-\nduction of this method is shown in Algorithm 2, the patch-\nbased method partitions the low-resolution ERA5 maps into\nseveral sub-regions based on a fixed stride and size. For\neach individual sub-region, the gradient term of the dis-\ntance loss between the ERA5 maps obtained from convo-\nlution kernels and the corresponding low-resolution sub-\nregion map is computed separately. Subsequently, the mean\nof the Gaussian distribution and the parameters of the con-\nvolution kernels in each sub-region are updated based on\nthese gradient terms. The overall map is then updated by\naveraging the updated values across all sub-regions, each\nweighted by a binary patch mask that quantifies the regional\nscope, thereby refining the overall mean and convolution\nkernel parameters of the sampled high-resolution ERA5\nmap, resulting in smoother generated maps. By leveraging\nthis strategy, SGD is capable of downscaling ERA5 maps to\nany desired resolution, further enhancing the practicality of\nthe model."}, {"title": "8. Pre-trained Encoder", "content": "Before utilizing cross attention for feature fusion, SGD ne-\ncessitates the extraction of features from GridSat maps by\nan encoder. The pre-trained encoder aims to enhance the\nfeature extraction capabilities of SGD and its downscaling\nperformance. The pre-trained module comprises two com-\nponents: the encoder and a decoder of symmetric structure.\nThe former is utilize to extracte features from GridSat maps\ninto latent space, while the latter aims to reconstruct the\nencoder's outputs. The encoder module consists of several\nconvolutional layers, employing 3 \u00d7 3 convolutional kernels\nwith a padding of 1, elevating the GridSat maps' channel\ncount to 64. Similarly, the decoder also encompasses con-\nvolutional layers, responsible for the reconstruction of the\nextracted features, the detailed structure is shown in Fig. 6.\nThe training objective is to minimize the MSE loss between\nthe input GridSat maps and the output maps post-decoder,\nwith the total training epochs approximating 100."}, {"title": "9. Additional Visualization Results", "content": "In this section, we present the downscaling results of SGD\nfor the variables V10 and MSL. Fig. 7 shows that SGD\nexhibits more faithful details in the maps as compared to\ninterpolation-based and diffusion-based methods. Further-\nmore, SGD exhibits no discernible disparity in overall in-\ntensity when compared to ERA5 at a scale of 25km\u00d725km.\nCombining the results of the other two variables in the main\ntext, it is validated that SGD is capable of producing highly\nsatisfactory downscaling results across all four variables."}, {"title": "10. Station observation-guided downscaling\nbias with stations in Weather2K", "content": "In this section, we endeavor to integrate the MSE loss from\nERA5 LR maps and MAE loss from the observation sta-\ntions in Weather5K within the distance function utilized in\nthe sampling process. Subsequently, we evaluated the high-\nresolution ERA5 maps derived from SGD with this setting\nacross all stations within the Weather2K dataset, thereby\nfurther assessing the efficacy of the guided sampling and\nthe accuracy of the downscaling results.\nWeather2K dataset [46] is a benchmark dataset that aims\nto address the shortcomings of existing weather forecast-\ning datasets in terms of real-time relevance, reliability, and\ndiversity, as well as the critical impediment posed by data\nquality. The data is available from January 2017 to August\n2021. It encompasses the meteorological data from 2130\nground weather stations across 40896 time steps, with each\ndata incorporates 3 position variables and 20 meteorologi-\ncal variables.\nSpecifically, we incorporate the MAE loss between the\ngenerated HR ERA5 maps and station observations from\nthe Weather5K dataset [15] with equal weights into our dis-\ntance function to measure bias. Subsequently, we calcu-\nlate the biases between the downscaling results obtained\nunder this setting with the meteorological data at the sta-\ntions from the Weather2K dataset. The evaluation metrics\nwe employed are the MSE and MAE loss of the variable\nT2M.\nWe compared our results with those of interpolation-\nbased and diffusion-based methods using the same metrics.\nAs shown in Tab. 5, the discrepancy between ERA5+station\nguided SGD and Weather2K stations is smaller, indicating\nthat using ERA5 and Weather5K with equal weights as the\ndistance function yields more ideal downscaling results for\nstations beyond Weather5K.\nFig. 8 illustrates the differences in downscaling re-\nsults among various methods at parts of the stations within\nWeather2K, with darker colors indicating smaller discrep-\nancies at the stations. In terms of the bias between the\ndownscaled results at the station locations in the image and\nthe actual observations, SGD with mixed guidance down-\nscaling results has less extreme bias stations, which is sym-\nbolized as yellow-labeled stations. Moreover, the overall\nstation coloration appears deeper. This suggests that uti-\nlizing weather5k as guidance can enhance the model's per-\nformance in downscaling at the local scale, aligning more\nclosely with the real conditions."}, {"title": "11. Running Time and Resource Consumption", "content": "Tab. 6 shows the running time and resource consumption of\nSGD during the training and the sampling process. To en-\nhance the inference efficiency, we have also tested our SGD"}, {"title": "12. Ablation Studies on the Relationship of\nVariables", "content": "When only the brightness temperature variables from Grid-\nSat (IrWin_Cdr or IrWin_VZA_Adj) are employed as the\ncondition, a satisfactory performance can be obtained,\ndemonstrating that brightness temperature is an important\ncondition for ERA5 maps downscaling (Tab. 7). All vari-\nables from GridSat could guide the SGD to yield higher-\nquality HR ERA5 maps. When incorporating GridSat as\nconditions and utilizing only a single LR ERA5 variable as\nguidance to generate the single HR ERA5 variable, the in-\ntroduction of GridSat yields the most significant enhance-"}]}