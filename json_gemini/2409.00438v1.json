{"title": "Breaking Down Financial News Impact: A Novel Al Approach with Geometric Hypergraphs", "authors": ["Anoushka Harit", "Zhongtian Sun", "Jongmin Yu", "Noura Al Moubayed"], "abstract": "In the fast-paced and volatile financial markets, accurately predicting stock movements based on financial news is critical for investors and analysts. Traditional models often struggle to capture the intricate and dynamic relationships between news events and market reactions, limiting their ability to provide actionable insights. This paper introduces a novel approach leveraging Explainable Artificial Intelligence (XAI) through the development of a Geometric Hypergraph Attention Network (GHAN) to analyze the impact of financial news on market behaviours. Geometric hypergraphs extend traditional graph structures by allowing edges to connect multiple nodes, effectively modelling high-order relationships and interactions among financial entities and news events. This unique capability enables the capture of complex dependencies, such as the simultaneous impact of a single news event on multiple stocks or sectors, which traditional models frequently overlook.\nBy incorporating attention mechanisms within hypergraphs, GHAN enhances the model's ability to focus on the most relevant information, ensuring more accurate predictions and better interpretability. Additionally, we employ BERT-based embeddings to capture the semantic richness of financial news texts, providing a nuanced understanding of the content. Using a comprehensive financial news dataset, our GHAN model addresses key challenges in financial news impact analysis, including the complexity of high-order interactions, the necessity for model interpretability, and the dynamic nature of financial markets. Integrating attention mechanisms and SHAP values within GHAN ensures transparency, highlighting the most influential factors driving market predictions. Empirical validation demonstrates the superior effectiveness of our approach over traditional sentiment analysis and time-series models. Our framework not only improves prediction accuracy but also provides detailed insights into how financial news impacts different market sectors. This comprehensive analysis empowers investors and analysts with deeper, actionable insights, setting the stage for future research in applying advanced AI methodologies to financial analysis and ultimately advancing the field.", "sections": [{"title": "1. Introduction", "content": "In recent years, financial technology (FinTech) has revolutionized the stock market, making it more accessible yet increasingly complex [1]. While conventional stock analysis primarily focuses on predicting stock prices, there is a growing demand for sophisticated methods to recommend the most profitable stocks [2]. This shift reflects investors' primary interest: identifying stocks that can bring higher returns in the future [3]. Traditional approaches to stock prediction, such as Auto Regression-based methods [4] and Support Vector Regression [5], often fall short of capturing the dynamic, non-linear nature of financial markets. Deep learning methods, including Recurrent Neural Networks [6, 7, 8] and attention-based models [9, 10, 11, 12], have shown promise in learning sequential patterns from longitudinal data. However, these models typically overlook the complex, multi-dimensional relationships between stocks, sectors, and crucial external factors such as financial news. Recent advancements in graph neural networks have opened new avenues for modelling stock market dynamics [13, 2]. These approaches can capture relationships between stocks. However, they often rely on pre-defined connections and struggle to incorporate real-time news information, limiting their ability to adapt to the rapidly changing financial landscape [14]. Moreover, existing models fail to fully leverage the rich, textual data from financial news sources, which can provide valuable insights into market trends and company performance [15]. To address these challenges, we propose the Geometric Hypergraph Attention Network (GHAN), a novel deep learning model designed to capture the complex, high-order relationships in financial markets while integrating real-time news data. Our work makes several key contributions:\n1. Hypergraph Modeling with News Integration: GHAN leverages hypergraph structures to model multi-entity interactions, including stocks, sectors, and news events [14]. This allows us to capture complex interactions between multiple stocks and news items simultaneously, a significant advancement over traditional graph-based models.\n2. Real-time Financial News Processing: We incorporate data from major financial news sources like Twitter Finance news\u00b2, enabling GHAN to capture the immediate impact of news on stock performance. This real-time integration of textual data sets our model apart from existing approaches that rely solely on historical price data.\n3. Geometric Information Integration: We incorporate geometric information through positional encodings, enabling GHAN to capture implicit spatial and temporal relationships within the financial ecosystem and news landscape.\n4. Latent Relationship Learning: GHAN learns latent interactions between stocks, sectors, and news events without relying on pre-defined relationships. This approach enables the model to adapt to changing market dynamics and uncover hidden influences that may not be apparent through traditional analysis.\n5. Explainability: GHAN incorporates attention mechanisms that allow for the interpretability of the model's decisions, addressing the crucial need for transparency in financial prediction models, especially when incorporating new data.\nIn this paper, we demonstrate how GHAN effectively recommends the most profitable stocks by modelling these hierarchical correlations within the market and leveraging real-time financial news. Our experiments on real-world financial datasets and news feeds show that GHAN significantly outperforms state-of-the-art methods, offering investors a powerful tool for making informed decisions in the complex and fast-paced world of stock trading.By addressing the limitations of existing approaches and introducing novel techniques for integrating financial news into market modelling, GHAN represents a significant step forward in the field of stock recommendation and analysis."}, {"title": "2. Related Work", "content": "The analysis of financial markets and the prediction of stock movements based on news events is a complex, multifaceted problem that intersects several research domains. Our work draws inspiration from and builds upon advancements in financial market prediction, graph-based deep learning, hypergraph neural networks, explainable AI, and geometric deep learning. This section provides an overview of the key developments in these areas that form the foundation of our research. We begin by discussing traditional and modern approaches to financial market prediction, followed by the application of graph neural networks in finance. We then explore the emerging field of hypergraph neural networks and their potential for modelling complex financial ecosystems. The growing importance of model interpretability in finance leads us to review recent work in explainable AI. Finally, we examine the field of geometric deep learning and its applications in financial modelling. Our research builds upon and extends several key areas in the fields of financial technology, graph neural networks, and explainable AI."}, {"title": "3. Problem Statement", "content": "Investors often have sufficient capital but lack the insights needed to make informed decisions about which stocks are most promising for investment. To address this challenge, we aim to analyze the impact of financial news on stock market behaviours using a Geometric Hypergraph Attention Network (GHAN). Our goal is to capture the complex, multi-dimensional relationships between stocks and news events and predict their influence on stock movements.Let $S = \\{S_1, S_2, ..., S_n\\}$ be the set of n stocks, and $N = \\{n_1, n_2, ..., n_m \\}$ be the set of m news events. We represent this financial ecosystem as a hypergraph $H = (V, E)$, where $V = S \\cup N$ is the set of nodes (stocks and news events), and E is the set of hyperedges connecting multiple stocks and news events.\nFor each stock $s_i \\in S$, we define its feature vector $x_i \\in \\mathbb{R}^d$, which includes relevant financial indicators such as price-based, momentum, and sentiment indicators.\nFor each news event $n_j \\in N$, we define:\n1. Its feature vector $y_j \\in \\mathbb{R}^v$, derived from natural language processing (NLP) techniques applied to the news content, including sentiment analysis, topic modelling, and named entity recognition (NER).\n2. A positional encoding $p_j \\in \\mathbb{R}^p$, which captures the temporal and contextual information of the news event, such as publication time, source credibility, and topic relevance."}, {"title": "4. Methodology", "content": "4.1. Overview\nwe integrate S&P 500 stock data with Twitter Financial News Sentiment data to predict stock movements using a Geometric Hypergraph Attention Network (GHAN). Initially, the S&P 500 stock data is preprocessed to compute moving averages, while financial news tweets undergo preprocessing and are embedded using FinBERT to capture their contextual information. We then construct a hypergraph where nodes represent stocks and tweets, and hyperedges connect tweets to the stocks mentioned within them, effectively modelling high-order interactions between the data points. The basic framework is as follows:"}, {"title": "4.2. Hypergraph-Level Modelling", "content": "The hypergraph-level modelling is the core component of our GHAN approach, designed to capture the intricate and high-order relationships between stocks and financial news events, unlike traditional graph structures that only model pairwise relationships, hypergraphs allow us to represent complex, multi-entity interactions that are prevalent in financial markets.\n4.2.1. Hypergraph Structure and Feature Extraction\nWe represent the financial ecosystem as a hypergraph H = (V, E), where V is the set of nodes and E is the set of hyperedges. This structure is crucial for our analysis because:\n1. Nodes (V) represent stocks and news events, allowing for a unified representation of different entity types.\n2. Hyperedges (E) can connect multiple nodes, enabling us to model complex relationships such as the simultaneous impact of a single news event on multiple stocks or sectors.\nThe incidence matrix $H \\in \\mathbb{R}^{(|V|\\times|E|)}$ provides a mathematical representation of these connections, where $H (v_i, e_j) = 1$ if node $v_i$ is part of hyperedge $e_j$, and 0 otherwise. This matrix is fundamental to our subsequent attention mechanisms and information propagation processes.\nFor feature extraction, we carefully select a set of relevant attributes for both stocks and news events. Stock features include standard financial indicators, while news features are derived from advanced NLP techniques. This diverse feature set ensures that our model comprehensively views quantitative market data and qualitative news information.\n4.2.2. Geometric Embedding\nThe incorporation of geometric embeddings is a key innovation in our GHAN model. By adding positional encodings $P_y$ and $P_E$ to node and hyperedge features respectively, we imbue our model with a sense of 'spatial' relationships within the financial landscape. This is particularly important because:\n1. It allows the model to capture implicit relationships between entities based on their 'position' in the financial ecosystem.\n2. It provides a mechanism for the model to learn and utilize structural information that may not be explicitly present in the feature vectors.\nThe combination of original features with these geometric embeddings as $X \\leftarrow X + P_y$ and $E \\leftarrow E + P_E$ creates rich, context-aware representations that serve as the foundation for our attention mechanisms.\n4.2.3. BERT Embedding\nWe use the FinBERT model [21], which is specifically fine-tuned for financial text. This model leverages the capabilities of BERT while being adapted to understand the nuances of financial language. Each tweet is tokenized using the BERT tokenizer, which converts the text into a format that the FinBERT model can process. This involves breaking down the text into word pieces and adding special tokens like [CLS]. We pass the tokenized tweets through the FinBERT model to obtain embeddings. Specifically, we extract the embeddings from the last hidden layer corresponding to the [CLS] token, which represents the aggregated information of the entire tweet. Let t represent a tweet. The embedding FinBERT(t) is obtained as follows:\nFinBERT(t) = FinBERT model (Tokenize(t))[CLS]\nrepresentation of the tweet t.We combine the FinBERT-generated tweet embeddings with geometric and positional embeddings as follows:\n$e_{final} = g_e + p_e + FinBERT (t_e)$   (1)\nwhere $FinBERT (t_e)$ is the embedding of tweet $t_e$ obtained from the FinBERT model.\n4.2.4. Hypergraph Attention Network\nOur multi-level attention mechanism is designed to model the complex, hierarchical nature of inter-actions in financial markets. It operates on two levels: Node-Level Attention and Hyperedge-Level Attention.\n1. Node Level Attention: This mechanism allows the model to weigh the importance of different nodes within each hyperedge. Mathematically, for a node i and a hyperedge j, we compute the attention coefficients $a_{ij}$ as follows"}, {"title": "4.3. Information Aggregation", "content": "The final step in our hypergraph-level modelling is the aggregation of information. This process updates both node and hyperedge representations based on the learned attention weights which is mathematically formulated as\n1. Node Update : The node update ($x'$) incorporates information from connected hyperedges\n$x'_i = \\sigma\\left(\\sum_{j \\in N(i)} a_{ij} W (e_j + p_j + FinBERT (t_j))\\right)$    (2)\n2. Hyperedge Update: the hyperedge update (e') aggregates information from its constituent nodes.\n$e'_j = \\sigma\\left(\\sum_{i \\in e_j} \\beta_{ji}W (x_i + P_i + FinBERT (t_i))\\right)$   (3)\nBy leveraging the hypergraph structure and incorporating BERT embeddings, our GHAN model can effectively capture and utilize the complex, multi-dimensional relationships present in financial markets. This sophisticated approach to modelling market dynamics provides a strong foundation for subsequent tasks such as predicting the impact of news on stock movements and offering explainable insights into market behaviours. The integration of geometric embeddings, positional encodings, and contextual information from FinBERT enables our model to accurately interpret financial news and its influence on stock prices, thus enhancing prediction accuracy and interoperability."}, {"title": "4.4. SHAP for Model Explainability", "content": "To interpret the predictions made by the GHAN model, we utilize [19] SHAP (SHapley Additive exPlanations) method, which provides a unified measure of feature importance. For a given prediction, the SHAP value $\\phi_i$ for feature i is computed as:\n$\\phi_i = \\sum_{S \\subset N\\backslash \\{i\\}} \\frac{|S|!(|N| - |S| - 1)!}{|N|!} [f(S \\cup \\{i\\}) - f(S)]$\nwhere: N is the set of all features, S is a subset of features, and f (S) is the model prediction for the subset S."}, {"title": "5. Experimental Setup", "content": "In this section, we present a comprehensive evaluation of our proposed Geometric Hypergraph Attention Network (GHAN) for analyzing the impact of financial news on stock prices. Our experiments aim to demonstrate the effectiveness and limitations of GHAN compared to several state-of-the-art financial prediction methods.\n5.1. Data Collection and Processing\nOur research focuses on the developed stock market of the United States, specifically analyzing stocks of enterprises included in the S&P 500 index. We obtain historical price data for stocks in the S&P 500 Composite index from the Yahoo Finance website 1 . Our dataset includes 450 stocks from the S&P 500 index after excluding those with insufficient data or trading history.\nThe historical price dataset used in this paper is described in detail in Table 1. Instead of using raw price data, we calculate the daily price change rate as input for our model. The rate of change in the price of a stock at time t is calculated by:\n$R_i = \\frac{P_t - P_{(t-1)}}{P_{(t-1)}}$\nwhere $P_t$ and $P_{(t-1)}$ are the closing prices of stock i at time t and t 1, respectively. For financial news data, we utilize the Twitter Financial News Sentiment dataset available on Hugging Face 2. This dataset consists of 500,000 financial news tweets with sentiment labels (positive, negative, neutral), specifically designed for sentiment analysis tasks in the financial domain. Our final text dataset comprises 50,000 tweets related to the S&P 450 stocks.\n5.2. Hypergraph Constrcution\nWe define nodes as stock and news events and aim to capture the intricate relationships between stocks and news events, facilitating high-order interactions essential for financial analysis.\n1. Node Definition : Let V = S U N be the set of nodes, where\nS = {$s_1, s_2,..., s_n$} is the set of n stocks.\nN = {$n_1, n_2, ..., n_m $} is the set of m news events."}, {"title": "5.3. Mathematical Formulation for Data Integration", "content": "To integrate the Twitter financial news sentiment data with the $S&P500$ stock price data, we perform several key steps. First, we define our data sets: let T be the set of tweets, where each tweet t \u2208 T is associated with a sentiment score $s_t$ and a timestamp $T_t$ let S be the set of stocks, where each stock s \u2208 S has a corresponding closing price $P_t$ at time t.Next, we align tweets with stock data. For each stock s \u2208 S, we aggregate the tweets mentioning s regularly. Let $T_t^s$ denote the set of tweets related to stock s on day t. We then compute the aggregated sentiment scores $S_t^s$ for stock s.\n$S_t^s = \\frac{1}{|T_t^s|}\\sum_{t \\in T_t^s} s_t$  (6)\nwhere $|T_t^s|$ is the number of tweets mentioning stock s on day t. Following sentiment aggregation, we construct a feature vector $z_t^s$ for each stock s on day t, which includes the daily return $R_t^s$ :\n$R_t^s = \\frac{P_t^s - P_{t-1}^s}{P_{t-1}^s}$\nthe aggregated sentiment scores $S_t^s$, trading volume, and specific technical indicators such as the 20-day moving average (MA20), the 50-day moving average (MA50), the Relative Strength Index (RSI), and the Moving Average Convergence Divergence (MACD).\nFor hypergraph construction, we define the set of nodes $V = S \\cup T$, where S is the set of stock nodes and T is the set of tweet nodes. We then define the set of hyperedges E, where each hyperedge e \u2208 E connects a tweet node t to the corresponding stock nodes {$s \\in S | t$ mentions s}. Finally, we construct the incidence matrix $H\\in R^{|V| \\times |E|}$, where:\n$\\begin{cases}\n 1, \\text{if } v \\in e\\\\\n 0, \\text{otherwise}\n\\end{cases}$\nThis matrix encodes the hypergraph structure, indicating the connections between nodes and hyper-edqes. The integrated dataset {$z_t^s | s \\in S, t \\in T$} combines quantitative stock price data and qualitative sentiment data from tweets. This dataset serves as the input for the Geometric Hypergraph Atten-tion Network (GHAN), enabling the model to leverage both market sentiment and historical stock performance for accurate financial analysis and prediction."}, {"title": "5.4. Model Training", "content": "Our Geometric Hypergraph Attention Network (GHAN) is implemented using the PyTorch framework, leveraging its robust support for dynamic computation graphs and efficient tensor operations. The model is optimized with the Adam optimizer, featuring a learning rate of 5 \u00d7 $10^{-4}$ and a weight decay of 5 \u00d7 $10^{-5}$ to prevent overfitting. Training is conducted with a batch size of 32 over 100 epochs, incorporating a dropout rate of 0.5 at the end of each layer to mitigate overfitting.\nWe use the LeakyReLU activation function in the hidden layers to introduce nonlinearity and address the vanishing gradient problem. Our attention mechanism includes node-level attention coefficients computed as:\n$\\alpha_{ij} = softmax_j (e_{ij})$\nand hyperedge-level attention coefficients as:\n$\\beta_{ji} = softmax_i (f_{ji})$\nThe node update is performed with:\n$x'_i = \\sigma\\left(\\sum_{j \\in N(i)} a_{ij}W (e_j + P_j)\\right)$\nand the hyperedge update follows:\n$e'_j = \\sigma\\left(\\sum_{i \\in e_j} \\beta_{ji}W (x_i + P_i)\\right)$\nTo enhance the interpretability of our model, we integrate SHapley Additive exPlanations (SHAP). SHAP values help to understand the contribution of each feature to the model's predictions. SHAP values are derived from game theory and provide a unified measure of feature importance. The SHAP value i for a feature i is given by:\n$\\phi_i = \\sum_{S \\subset F\\backslash \\{i\\}} \\frac{|S|!(|F| \u2013 |S| \u2013 1)!}{|F|!}-(v(S \\cup \\{i\\}) \u2013 v(S))$\nwhere F is the set of all features, S is a subset of features, and v(S) is the model prediction given the features in subset S. This equation effectively distributes the total prediction among the features, attributing an importance value to each."}, {"title": "5.5. Basline", "content": "1. LSTM with Attention: This model uses a Long Short-Term Memory (LSTM) network combined with an attention mechanism to capture temporal dependencies in the financial news data. The attention mechanism helps the model focus on the most relevant parts of the input sequence when making predictions.\n2. Graph Convolutional Network (GCN): GCNs are designed to work directly with graph-structured data. In this baseline, we apply GCN to the financial data graph, where nodes represent stocks and edges represent relationships based on co-occurrence in news events. The GCN aggregates information from neighbouring nodes to make predictions.\n3. BERT-based Text Classification: We use a BERT-based model fine-tuned for text classification tasks. This model processes financial news text to predict stock movements, leveraging the powerful contextual embeddings generated by BERT to understand the sentiment and implications of the news content."}, {"title": "5.6. Evaluation and Analysis", "content": "To compare the performance of the proposed Geometric Hypergraph Attention Network (GHAN) with benchmark models, we use common metrics for evaluating classification and profitability. Stock trend prediction is a typical classification task, so we selected two widely used evaluation indicators: accuracy and F1-score. The calculation formulas are as follows:\n$\\text{Accuracy} = \\frac{TP + TN}{TP + TN + FP + FN}$ (7)\n$\\text{F1-score} = 2 \\times \\frac{\\text{Recall} \\cdot \\text{Precision}}{\\text{Recall} + \\text{Precision}}$\nwhere TP = True Positive, TN = True Negative, FP = False Positive, FN = False Negative; Recall =$\\frac{TP}{TP+FN}$ and Precision = $\\frac{TP}{TP+FP}$\nWe compute the macro F1-score by averaging the F1 scores in Table 2 and for each category, providing a balanced evaluation across all classes. These metrics offer a comprehensive assessment of the model's performance in stock trend prediction tasks, ensuring that both the accuracy and the quality of predictions are evaluated."}, {"title": "5.7. Profitability Evaluation", "content": "To evaluate the profitability of the proposed methods, we use the following two metrics to compare the profitability of each technique inspired by the ML-GAT method [22]. To establish a direct link between our model's predictions and profitability metrics, we propose a portfolio selection strategy based on the outputs of the GHAN model.\nLet S = {$s_1, s_2, . . ., s_n $} represent the set of all available stocks, and Nt denote the set of news events at time t. We construct a portfolio Ft at time t as follows:\n$F_t = \\{s_i \\in S | GHAN (s_i, N_t) > \\theta\\}$ (8)"}, {"title": "5.9. Conclusion", "content": "This paper demonstrates the efficacy of the Geometric Hypergraph Attention Network (GHAN) in predicting stock movements by integrating Twitter Financial News Sentiment with S&P 500 stock data.\nThe GHAN model excels in classification accuracy, precision, recall, macro F1-score, and profitability metrics such as average daily return and Sharpe ratio. This superior performance is attributed to the model's ability to capture complex, multidimensional relationships between financial news and stock prices through geometric embeddings and hypergraph structures.\nThe use of BERT-based embeddings enables the model to understand the nuanced semantics of financial news, providing richer context and improving prediction accuracy. The attention mechanisms within the hypergraph structure allow GHAN to focus on the most relevant information, ensuring both accuracy and interpretability. SHAP values are employed to provide explainability, highlighting the most influential factors driving the model's predictions and enhancing transparency. Future research can enhance GHAN's capabilities by extending the analysis to other financial markets, such as the NASDAQ or international indices, to validate the model's robustness and generalizability. Incorporating additional data sources, like economic indicators, earnings reports, and analyst forecasts, can provide a more comprehensive view of market dynamics and improve prediction accuracy. Developing real-time prediction frameworks that update continuously with incoming data will offer timely insights, which are crucial for making prompt investment decisions.\nFurther refinements in explainability techniques, including advanced SHAP value analyses, will help elucidate the decision-making process of the model, building trust among users. Experimenting with different hypergraph structures and embedding techniques could uncover new ways to model the intricate relationships within financial data, potentially leading to even better performance. Integrating GHAN's predictions into sophisticated risk management strategies will be crucial for practical financial applications, aiding in the development of more robust investment portfolios. These advancements will further improve the model's accuracy and practical utility, offering more precise and actionable insights for financial market analysis and decision-making. This study represents a significant step towards revolutionizing financial analysis with advanced AI methodologies, setting the stage for future innovations in the field."}]}