{"title": "Boosting Efficiency in Task-Agnostic Exploration through Causal Knowledge", "authors": ["Yupei Yang", "Biwei Huang", "Shikui Tu", "Lei Xu"], "abstract": "The effectiveness of model training heavily relies on the quality of available training resources. However, budget constraints often impose limitations on data collection efforts. To tackle this challenge, we introduce causal exploration in this paper, a strategy that leverages the underlying causal knowledge for both data collection and model training. We, in particular, focus on enhancing the sample efficiency and reliability of the world model learning within the domain of task-agnostic reinforcement learning. During the exploration phase, the agent actively selects actions expected to yield causal insights most beneficial for world model training. Concurrently, the causal knowledge is acquired and incrementally refined with the ongoing collection of data. We demonstrate that causal exploration aids in learning accurate world models using fewer data and provide theoretical guarantees for its convergence. Empirical experiments, on both synthetic data and real-world applications, further validate the benefits of causal exploration. The source code is available at https://github.com/CMACH508/CausalExploration.", "sections": [{"title": "1 Introduction", "content": "Deep neural networks have been incredibly successful in various domains, such as milestone achievements in Go games and control tasks [Silver et al., 2016; Tassa et al., 2018]. One key factor contributing to such remarkable performance is the availability of high-quality data for model training. However, in many practical applications, it remains data-hungry due to limited data collection efforts imposed by budget constraints [Fang et al., 2017; Yoo and Kweon, 2019; Robine et al., 2023]. This highlights the essential need to enhance both the sampling and model learning efficiency.\nIn this paper, we introduce causal exploration to tackle this challenge, a novel framework that makes use of the underlying causal knowledge to boost the data collection and model training processes. On one hand, acquiring and understanding causal knowledge unveils the fundamental mechanisms behind the data generation process, thereby reducing the exploration space. In contrast to random data collection, causal exploration allows systematic action planning based on the identified causal structures. On the other hand, causal knowledge reflects the cause-and-effect dependencies among variables. Through the incorporation of causal structural constraints into the model, we can acquire causal dynamics models that eliminate redundant dependencies, as opposed to non-causal dense models, which have shown to provide more accurate estimations [Seitzer et al., 2021; Huang et al., 2022; Wang et al., 2022].\nSpecifically, we focus on boosting the sample efficiency and reliability of the world model in the realm of task-agnostic reinforcement learning (RL). Different from methods that learn a fixed task from scratch, task-agnostic RL agent first learns a global world model that gathers information about the true environment on the data collected during exploration. Then based on the predictions of the learned model, the agent could make quick adaptations to various downstream tasks in a zero-shot manner given task-specific reward functions. This learning setup exhibits excellent generalization performance but also imposes high requirements on the accuracy of the model [Pathak et al., 2019]. However, the data collection and world model learning processes are usually expensive due to extensive environment interactions, especially in large state spaces where discovering the optimal policy can be highly challenging [Burda et al., 2018].\nTo address this problem, our causal exploration-based approach revolves around three primary aspects. First, we employ constraint-based methods to discover causal relationships among environment variables. Second, we formulate the dynamics model under causal structural constraints to enhance its reliability. Third, we propose several ways based on causal knowledge to improve the sample efficiency during exploration. In particular, for causal discovery, we present an efficient online method that selectively eliminates noisy samples and strategically gathers informative data points in an incremental way. Moreover, we learn to actively explore towards novel states that are expected to contribute most to model training. The learning process of the exploration policy is driven by intrinsic rewards, which measure both the agent's level of surprise at the outcome and the quality of the training caused by the selected data. During exploration, causal knowledge and the world model are continuously re-"}, {"title": "2 Preliminary", "content": "We consider task-agnostic RL within the framework of a Markov decision process characterized by state space S and action space A. In addition, to integrate causal information, we make the following assumptions throughout this paper.\nAssumption 1. (Causal Factorization). Both the state space and action space can be factorized. That is, $S = S_1 \\times ...x S_n \\in R$ and $A = A_1 \\times ... \\times A_c\\in R^C$.\nAssumption 2. (Causal Sufficiency). The state variables $s_t$ are fully observable without any hidden confounders.\nAssumption 3. (Faithfulness Condition). For a causal graph G and the associated probability distribution P, every true conditional independence relation in P is entailed by the Causal Markov Condition applied to G.\nGiven these commonly made assumptions for causal discovery methods, we next define transition causality over the transition variables from {$s_{t-1}, a_{t-1}$} to $s_t$.\nDefinition 1. (Transition Causality). Under the Markov condition, the causal structures are over the state-action variables $U = {\\{S_{i,t-1}\\}_{i=1}^{n}} \\cup {\\{A_{j,t-1}\\}_{j=1}^{c}}$ and $V = {\\{S_{i,t}\\}_{i=1}^{n}}$, which can be represented by a directed acyclic graph $G = (\\{U, V\\}, E)$ and its adjacency matrix $D$. Here, $E$ denotes the edge set and $D \\in {\\{0,1\\}}^{|U|\\times|V|}$.\nNote that all edges are from U to V. If $S_{i,t-1} \\in U$ has a causal edge to $s_{j,t} \\in V$, then we call $s_{i,t-1}$ a parent of $s_{j,t}$ and have $D(i, j) = 1$. Take the example in Figure 1: we have $D(1,1) = 1$ because $s_{1,t-1}$ is a parent of $s_{1,t}$, while $D(2,1) = 0$ because $s_{2,t-1}$ does not have a causal edge to $s_{1,t}$. Here, we assume that the structural constraints are invariant over time t. The causal identification theory under these appropriate definitions and assumptions has been given in existing work.\nProposition 1. Under the aforementioned assumptions, the causal adjacency matrix $D$ is identifiable (see [Huang et al., 2021; Wang et al., 2022; Ding et al., 2022])."}, {"title": "3 Related Work", "content": "Task-agnostic RL. Over recent decades, task-agnostic exploration strategies have been an active research area to attain generalization [Aubret et al., 2019]. Existing methods focus on designing appropriate forms of intrinsic rewards, which can be broadly categorized into three types: (1) the number of times a state has been visited, which helps to guide the agent towards unexplored regions [Bellemare et al., 2016; Machado et al., 2020]; (2) curiosity about the environment dynamics, which is usually formalized as prediction errors of future states [Pathak et al., 2017; Kim et al., 2018]; and (3) information gain, which aims to improve the agent's knowledge about the environment by maximizing the mutual information [Duan et al., 2016; Shyam et al., 2019]. However, existing works usually pay little attention to the support that causal structures can offer in improving exploration efficiency.\nRL with causal discovery. The intersection of causal discovery and RL has become a popular trend in recent years. [Zhu et al., 2019] uses RL to search for the causal graph with the best score. [Hu et al., 2022] proposes to learn a hierarchical causal structure for subgoal-based policy learning. [Ding et al., 2022] and [Mutti et al., 2023] focus on providing tractable formulations of systematic generalization in RL tasks by employing a causal viewpoint. [Yu et al., 2023] learns a causal world model to generate explanations for the decision-making process. Theoretical evidence about the advantages of using a causal world-model in offline RL is given in [Zhu et al., 2022]. However, most of these works focus on either extracting underlying causal graphs from given data in a particular environment or using random exploration strategies for data collection, instead of directly utilizing causal structure as guidance to improve exploration efficiency in task-agnostic RL [Kosoy et al., 2022]. Experimental comparisons with some existing works that are close to us have been conducted in Section 6."}, {"title": "4 Discovering and Utilizing Causality for Learning World Models", "content": "After establishing proper assumptions and definitions, we proceed to introduce the methodology part for causal exploration. In this section, we initially assume that the causal structures are known and show how to explicitly incorporate causal knowledge into the world model and utilize it for model training. Next, we give an estimation procedure for causal structures."}, {"title": "4.1 Causal Constraints for Forward Model", "content": "During task-agnostic exploration, the agent learns a world model $f_{w\\theta}$ with parameter $w$, serving as an abstraction of the ground truth transitions in the environment. In other words, the world model $f_{w\\theta}$ is designed to enable agents to predict future state $\\hat{s}_t$ based on current state $s_{t-1}$ and action $a_{t-1}$, represented by $\\hat{s}_t = f_{w\\theta}(S_{t-1}, a_{t-1}, e_t)$, where $e_t$ is the corresponding random noise. However, based on the understanding that causal structures within environmental variables are typically sparse rather than dense, as suggested by [Huang et al., 2022], such a framework could contain unnecessary dependencies. For instance, in the context of Figure 1, the variable $s_{2,t-1}$ does not causally affect $s_{1,t}$, and is thus identified as a non-parent node. Consequently, we only need to take a subset of $(s_{t-1}, a_{t-1})$ as inputs of the model.\nTo reflect these constraints, we explicitly consider the causal structures over state and action variables to model the one-step transition dynamics, formulated as:\n$\\hat{s}_t = f_{wc} (D_i (S_{t-1}, a_{t-1}), c_{i,t}),$ (1)\ni=1\nwhere $\\square$ denotes element-wise product, $D_i$ and $c_{i,t}$ are the i-th column of causal matrix $D$ and noise term $e_t$, respectively. However, a naive implementation requires training n world models since each factored dimension has its unique parents. It is likely to result in an explosive growth in computational complexity as the state dimension and network size increase.\nWe propose a sharing-decomposition schema to address such a problem. It is unnecessary for all of these n networks to be totally different. Instead, each of these models could share the first several layers as a common embedding. Then following the sharing module, we design predictive networks for each dimension. Suppose $w_i$ is the network parameter for the i-th dimension, it is a combination of the shared parameter $\\sigma$ and decomposed parameter $\\theta_i$, written as\n$w_i = \\sigma \\cup \\theta_i.$ (2)\nDuring the training time, each model focuses on a different aspect of the state in the decomposition part $\\theta_i$ but shares a common knowledge $\\sigma$. The number of shared layers is a hyperparameter that allows for a trade-off between the sharing and decomposition parts. By training forward models under this schema, our approach can both utilize causal information of the ground environment dynamics to generate accurate predictions and achieve a significant reduction in model"}, {"title": "4.2 Efficient Online Causal Relationship Discovery", "content": "In this section, we show how to identify the causal adjacency matrix D. According to Definition 1, this can be transformed into determining whether there exists an edge between each pair of nodes in the causal graph G. To achieve this goal, we start from a complete graph and then iteratively remove unnecessary edges using Conditional Independence Tests (CIT).\nGiven that the edges follow the temporal order without instantaneous connection, we extend the PC algorithm [Spirtes et al., 2000] to handle time-lagged causal relationships based on Kernel-based Conditional Independence (KCI) test [Zhang et al., 2012] to identify the causal adjacency matrix D.\nWhile causal discovery algorithms typically necessitate the collection of substantial causal information through data, it's important to note that accumulating more samples does not always confer an advantage: as the sample size increases, the time cost of causal algorithms also rises. Figure 9 in the appendix illustrates that the execution time of the PC algorithm based on KCI tests experiences exponential growth as sample size increases. Therefore, prioritizing the enhancement of data quality over quantity becomes paramount. In order to reduce the cost of the identification process, we design an efficient online causal relationship discovery method: instead of using all of the coming data for causal identification, we selectively collect representative data points during exploration in an incremental way. Specifically, we use the minibatch similarity and sample diversity criteria introduced in [Yoon et al., 2021] as our selection strategies, which are defined as\nSimilarity = $\\frac{\\nabla f_{wc}(b_i)\\nabla f_{wc}(B_t)}{||\\nabla f_{wc} (b_i) || \\cdot ||\\nabla f_{wc} (B_t)||}$,\nDiversity = $\\sum_{i=1}^{t-1} \\frac{\\nabla f_{wc}(b_i)^\\top\\nabla f_{wc}(b_j)}{||\\nabla f_{wc} (b_i) || \\cdot || \\nabla f_{wc}(b_j)||} ,$ (4)"}, {"title": "5 Boosting Efficiency through Causal Exploration", "content": "We now return to the fundamental question: how to enhance the data collection efficiency during causal exploration, thereby improving the performance of both causal discovery and model learning. To attain this goal, a commonly applied concept from active learning is the selection of samples that make the largest contributions to the model's training loss. These samples are typically considered as a subset that the model is least familiar with. Hence, the prediction loss is used here as the intrinsic reward to guide exploration with a scaling weight \u03b7:\n$r_{t-1} = -\\eta \\frac{\\partial \\hat{s}_t - s_t}{\\partial s_t}.$ (5)\nThis prediction loss can also be viewed as a validation of the agent's causal beliefs. The larger the prediction error, the more surprised the agent is by the actual outcome, implying a greater deviation from the estimated values based on the causal structure and the world model. The faster the error rate drops, the more learning progress signals we acquire.\nHowever, not all the novel states have a positive impact on the model. On the contrary, some noisy data may contribute significantly to prediction errors but can lead the model to an awful direction, which necessitates the agent to also pay attention to the inherent quality of the data during exploration.\nTo reflect this, we introduce active reward [Fang et al., 2017] that measures the data quality as another intrinsic motivation. Once a new sample is collected at time step t, active reward is then calculated as the change of the model's prediction ability before and after training. We use the prediction accuracy on a test set $D_h$ generated from episodes unseen before training to reflect the world model's performance and formulate active reward as\n$r_{t-1} = L_f (w_{t-2}) - L_f(w_{t-1}),$ (6)\nwhere $L_f(\\cdot)$ is the mean prediction error on $D_h$ and $w$ denotes parameters of the trained world model at time t. The value of active reward reflects beneficial or detrimental training caused by the selected data. If the reward is always positive, it indicates that the agent has been selecting beneficial samples for training the world model. We combine prediction loss and active reward with a regularization weight \u03b2:\n$r_{t-1} = r_i{t-1} + \\beta r_a{t-1}.$ (7)\nDuring causal exploration, the agent keeps searching for causal informative data by maximizing the expected rewards, which is\n$a_t = \\underset{a \\in A}{arg \\underset{\\tau \\in \\pi}{max}} E_{\\tau} \\sum_{t'} \\gamma^{t'-t}r_{t'}.$(8)\nwhere T represents the trajectory generated by the exploration policy \u03c0 and \u03b3 is the discount factor. Meanwhile, the world model minimizes the prediction loss. Since both of them contain the prediction error in equation (3) and (5), we can draw a conclusion that the learning of world models and causal exploration facilitate each other. Figure 4 shows an overview of causal exploration, details are shown in Algorithm 1."}, {"title": "5.1 Theoretical Analysis on Causal Exploration", "content": "In this subsection, we first present a mathematical criterion for evaluating the impact of causal exploration on sampling efficiency, and then we theoretically demonstrate the benefits of causal exploration in learning world models, especially when the causal graph is sparse.\nCausal efficiency ratio. Let k denote the optimization step in world model training, f represent the world model, and"}, {"title": "Algorithm 1 Task-agnostic Causal Exploration", "content": ""}, {"title": "The following theorem shows reduced error bound with causal exploration.", "content": "Theorem 1. Suppose Assumption 4 holds, and suppose the density of causal matrix D is d and the model is initialized with $w_0$. Then for every optimization step k, we have\n$L_f(w^c(k)) - L \\leq \\delta^k (L_f(w(k)) - L)$\n$ \\leq \\delta^k \\frac{M}{2} \\left[ 1 - \\frac{m}{M} \\right]^k ||w_0-w^*||^2.$(11)\nRemark. The first inequality in Equation (11) establishes an upper bound for $\\xi$ at $\\delta^k$. Given that $0 < \\delta^k < 1$, this confirms the effectiveness of causal exploration in enhancing efficiency. The subsequent inequality establishes that the training error of causal exploration gradually converges to the optimal value, exhibiting an exponential convergence rate characterized by the decay of the factor $ \\left[ \\delta (1 - \\frac{m}{M}) \\right]^k$. Moreover, this theorem implies that the advantages of causal exploration are relevant to the sparseness of causal structure. The sparser the causal structure, the faster our method learns. When the causal matrix D is a complete matrix (\u03b4 = 1), causal exploration degenerates into non-causal prediction-based exploration. The proof for Theorem 1 is provided in Appendix A."}, {"title": "6 Experiments", "content": "To evaluate the effectiveness of causal exploration in complex scenarios, we conduct a series of experiments on both synthetic datasets and real-world applications, including the traffic light control task and MuJoCo control suites [Todorov et al., 2012]. Meanwhile, we compare our proposed causal exploration with the following baseline methods:\n1. Curiosity [Burda et al., 2018] and Plan2Explore [Sekar et al., 2020]: non-causal exploration methods that learn dense models with different forms of intrinsic rewards.\n2. CID [Seitzer et al., 2021]: focusing on detecting causal influences between actions $a_{t-1}$ and future states $S_t$ with random data collection. Causal exploration extends to discover dependencies among state transitions as well.\n3. ASR [Huang et al., 2022]: a differential approach that learns the causal matrix D as free parameters together with the world model f. Instead, the identification of D is completed by causal discovery methods in our approach.\n4. CDL [Wang et al., 2022]: learning causal dynamics models to approximate conditional mutual information rather than directly implementing CIT on the observed data."}, {"title": "6.1 Synthetic Datasets", "content": "Environments. We build our simulated environment following the state space model with controls. When the agent takes an action at based on the current state, the environment provides feedback st+1 at the next time. We denote the generative environment as\n$S_1 \\sim N(0, I),$\n$S_t \\sim N(h(s_{t-1}, a_{t-1}), \\Sigma),$ (12)\nwhere $\\Sigma$ is the covariance matrix and h is the mean value as the ground truth transition function implemented by deep neural networks under causal graph G. Specifically, the linear condition consists of a single-layer network, and the nonlinear function is three-layer MLPs with sigmoid activation.\nGiven that the sparsity of the causal graph is an important factor affecting the performance of our method, we choose to demonstrate the superiority of our approach on relatively low-density causal structures. That is, G is generated by randomly connecting edges with a probability of p. Such sparse causal structures allow us to evaluate the ability of our method to accurately learn world models with limited data, which is a common scenario in many real-world applications. Below, we provide discussions on the benefits of causal exploration based on the empirical results.\nCorrectness of the identified causal structure. We compare our proposed method with different causal discovery methods. To be specific, CID and CDL apply score-based causal discovery, while ASR combines causal structure with neural networks for differentiable training. However, CID only considers causal action influence and lacks an explicit causal structure, so we do not use it for comparison. Figure 5 illustrates an example of the causal matrix discovered by different methods, where the depth of the color indicates the number of times each edge is detected as a causal connection. Figure 3 further shows the averaged F1-score of these"}, {"title": "Assumption 4.", "content": "Lf is strong convex and smooth such that\n$\\exists m > 0, M > 0$, for any $w \\in dom L_f$, we have\n$MI > \\nabla^2 L_f(w) > mI$.\nFor each exploration time t, the model undergoes several optimization steps, influenced by the data volume and batch size."}, {"title": "6.2 Real World Applications", "content": "Application to Traffic Signal Control Task. We further conduct experiments in the challenging traffic signal control task to evaluate our proposed method. Table 2 lists the performance of different learned world models on downstream policy learning. The reward here is a combination of several terms including the sum of queue length and so on, defined in Equation (3) in IntelliLight ([Wei et al., 2018]). Duration refers to averaged travel time vehicles spent on approaching lanes (in seconds). Length is the sum of the length of waiting vehicles over all approaching lanes and Vehicles is the total number of vehicles that passed the intersection. We also train an agent in the true environment to verify the reliability of the learned models through task-agnostic exploration. The performance of the policy learned on the world models trained during causal exploration is comparable to, or even in some metrics better than, that of the true environment. Appendix C provides the detailed descriptions, including the causal graph on state variables in traffic signal control task, and comparison of the prediction errors during exploration.\nApplication to MuJoCo Tasks. We also evaluate causal exploration on the challenging MuJoCo tasks, where the"}, {"title": "7 Conclusion and Future Work", "content": "In this paper, we introduce causal exploration, a methodology designed to incorporate causal information from data for the purpose of learning world models efficiently. In particular, we employ causal exploration within the domain of task-agnostic reinforcement learning and design a sharing-decomposition schema to leverage causal structural knowledge for the world model. A series of experiments in both simulated environments and real-world tasks demonstrate the superiority of causal exploration, which highlights the importance of rich causal prior knowledge for efficient data collection and model learning. We would like to point out that this study primarily focuses on scenarios where states are fully observed. Future research directions involve addressing more complex scenarios including unobserved latent state variables and developing improved fault-tolerant mechanisms to enhance robustness. This work provides a promising direction for future endeavors in efficient exploration."}, {"title": "A Proof of Theorem 1", "content": "Recall that we consider solving a linear regression problem under m strong convex and M-smooth. MSE loss function Lf(w) in the formulation $||w^\\top \\cdot (S_{t-1}, a_{t-1}) - S_t||^2$ with $S_t = w^{*\\top} \\cdot (S_{t-1}, a_{t-1})$ is minimized by gradient descent method with\nw(k) = w(k \u2212 1) \u2212 a\u2207Lf(w(k \u2212 1)) (13)\nwhere a is the corresponding step size.\nDenote $w^c(k)$ as the network parameters taking causal constraints with respect to $w(k)$ that does not gather causal information. Theorem 1 shows that causal exploration gets a prediction error bound $\\delta^k$ times lower at the k-th step, where $\\delta$ is a density measurement of the causal adjacency matrix D.\nBelow, we present a two-step proof for the convergence of causal exploration. Lemma 2 provides an upper bound for convergence without using any causal information. Lemma 3 demonstrates that utilizing causal structure information results in $w^c(k)$ being closer to the optimal value $w^*$ compared to $w(k)$ at the same optimization steps. Combining Lemma 2 and Lemma 3, we derive the convergence rate for causal exploration.\nLemma 2. Suppose Lf(w) is m-strongly convex and M-smooth. We have\n$||w(k) - w^*||^2 \\leq (1 - \\frac{m}{M})^k ||w_0 - w^*||^2.$ (14)\nProof. According to gradient descent method (13), we get\n$||w(k) - w^*||^2 = ||w(k \u2212 1) \u2212 a\u2207Lf(w(k \u2212 1)) \u2212 w^*||^2$\n$= ||w(k \u2212 1) \u2212 w^*||^2 + a^2||\u2207Lf(w(k \u2212 1))||^2$\n$- 2a\u2207Lf(w(k \u2212 1))(w(k \u2212 1) \u2212 w^*)$.\nBy strong convexity\n$VL_f(w)(w - w^*) \\geq L_f(w) - L_f(w^*) + \\frac{m}{2} ||w - w^*||^2,$ (15)\nwe further obtain\n$||w(k) - w^*||^2 \\leq ||w(k \u2212 1) \u2212 w^*||^2 \u2212 2a(L_f(w(k \u2212 1))\n$- L_f(w^*) + \\frac{m}{2} ||w(k-1) - w^*||^2) + a^2||\u2207L_f(w(k \u2212 1))||^2$\n$= ||w(k \u2212 1) \u2212 w^*||^2 \u2212 2a(L_f(w(k \u2212 1)) \u2212 L_f(w^*))$\n$- am||w(k \u2212 1) \u2212 w^*||^2 + a^2||\u2207L_f(w(k \u2212 1))||^2$\n$\\leq ||w(k \u2212 1) \u2212 w^*||^2 \u2212 2a(L_f(w(k \u2212 1)) \u2212 L_f(w^*))$\n$\u2212 am||w(k \u2212 1) \u2212 w^*||^2$\n$+ \\frac{2a^2M}{(Lf(w(k \u2212 1)) \u2212 L_f(w^*))}$\n$\\leq ||w(k \u2212 1) \u2212 w^*||^2 \u2212 am||w(k \u2212 1) \u2212 w^*||^2$\n$+ 2a(aM \u2212 1)(L_f(w(k \u2212 1)) \u2212 L_f(w^*)).$\nConsider $\\alpha = \\frac{1}{M}$ we get (16)\n$||w(k) - w^*||^2 \\leq (1 - \\frac{m}{M})||w(k-1) - w^*||^2.$ (17)\nUsing the above equation repeatedly, we obtain\n$||w(k) - w^*||^2 \\leq (1 - \\frac{m}{M})||w(k - 1) - w^* ||^2$\n$\\leq (1 - \\frac{m}{M})^2||w(k - 2) - w^* ||^2$ (18)\n$\\leq ... \\leq (1-\\frac{m}{M})^k||w_0 - w^*||^2.$\nLemma 3. Suppose $w^c(k)$ and w(k) are the network parameters with/without causal structure respectively and $w^*$ is the optimum. It holds that\n$||w^c(k) - w^* ||^2 < \\delta_k||w(k) - w^*||^2.$ (19)\nProof. According to Definition 1, we have\n$w^c(k) = D \\odot w(k),$ (20)\nwhere D is the binary causal matrix. Hence, we rewrite w(k) as\n$w(k) = D \\odot w(k) + (1 \u2212 D) \\odot w(k) = w^c(k) +w_1$. (21)\nNote that we have $w^* = D \\odot w^*$. Then we obtain\n$||w(k) - w^* ||^2 = \\sum_{i,j}(w_{ij} (k) - w_{ij}^*)^2$\n$= \\sum_{i,j} [D_{ij} \\times w_{ij} (k) - w_{ij}^* + (1 \u2212 D_{ij}) \\times w_{ij}(k)]^2$\n$= \\sum_{i,j} [(D_{ij} \\times w_{ij} (k) - w_{ij}^*)^2 + ((1 \u2212 D_{ij}) \\times w_{ij}(k))^2]$\n$= \\sum_{i,j} (D_{ij} \\times w_{ij} (k) - w_{ij}^*)^2 + \\sum_{i,j} ((1 \u2212 D_{ij}) \\times w_{ij}(k))^2$\n$= \\sum_{i,j} (w_{ij} (k) - w_{ij}^*)^2 + \\sum_{i,j} (w_{ij}(k))^2$\n$= ||w^c(k) - w^*||^2 + ||w_1||^2 \\geq (1 + p_k)||w^c(k) - w^*||^2,$ (22)\nwhere $p_k \\in [0, +\\infty)$ is the lower bound of the ratio between $||w_1||^2$ and $||w^c(k) -w^*||^2$ whose value is related to the sparsity of causal matrix D. By setting $\\delta_k = \\frac{1}{1+p_k}$, we complete the proof of Lemma 3.\nThe convexity of Lf (w) implies\n$L_f(w^c(k)) - L_f(w^*) \\leq \\frac{M}{2} ||w^c(k) \u2013 w^*||^2$. (23)\nBy applying Lemma 2 and Lemma 3 into (23) and denote\n$\\delta = max{\\{\\delta_0, \\delta_1,..., \\delta_k\\}},$ (24)\nwe can obtain Theorem 1."}, {"title": "B Synthetic environment", "content": "B.1 More experiment details\nImplementation. Double DQN [Van Hasselt et al., 2016] is used to train the exploration policy of agents, where both the evaluation network and the target network are three-layer"}, {"title": "Efficient Causal Discovery", "content": "To speed up PC algorithm with KCI-test, we design an efficient online causal discovery using selection methods. Figure 8 illustrates the corresponding ROC curves of different selection methods including Uniform Sampling, K-center Features [Nguyen et al., 2017], Hardest Sampling [Rahaf and Lucas, 2019] and the Coreset Selection method [Yoon et al., 2021] we use. Tables 3 summarizes the performance of different sampling methods in our synthetic environments. These exciting experimental results demonstrate the superiority of the Coreset Selection method we used in improving the efficiency of causal discovery."}, {"title": "Causal Exploration Experiments", "content": "The causal matrix in our synthetic environment is set as a lower triangular matrix whose elements are generated from the uniform distribution"}, {"title": "B.2 Generalization to underestimation scenarios", "content": "In some data-hungry scenarios, there may be insufficient data for causal discovery, leading to underestimation of the causal structure, which makes continuous data collection and causal structure correction important components. In other words, the causal structure inferred from causal discovery algorithms may deviate from the ground truth ones, which is particularly prone to occur under conditions of limited sample size or during the initial stages of exploration. Consequently, we conduct an evaluation of our proposed algorithm's performance"}, {"title": "B.3 Generalization to scenarios with causal structural changes", "content": "In real-world scenarios, causal structure between variables can often change due to sudden disturbance. For instance, causal relationships between economic variables like stock prices, interest rates, and inflation can be subject to rapid changes caused by market crashes or policy changes.\nTo evaluate the effectiveness of our approach in handling such mutation, we conduct experiments in a scenario where the causal structure changes randomly once. We use our simulation model to generate the data and compare our method to a non-causal approach. Figure 11(c) illustrates the advantages of our approach in tackling such a challenging task.\nOur sharing-decomposition schema enables the agents to quickly adapt to structural changes and make appropriate adjustments. This also demonstrates the robustness of our method, which allows for timely correction of errors in the causal structure. By sharing the same decomposition modules across different time steps and tasks, our method can effectively leverage previous knowledge and transfer it to new situations, while also being flexible enough to accommodate changes in the causal structure. In addition, the ability to adapt to changing causal structures can improve the generalization ability of our method, making it more applicable to a wider range of real-world tasks.\nIn our future research, we plan to expand our work to situations where changes occur within the model. In these cases, during the model learning phase, it becomes crucial to effectively detect these changes and promptly update the model. Additionally, when it comes to policy learning, a key challenge is determining the most suitable model to utilize. We may encounter entirely new models that have not been encountered before, adding an additional layer of complexity to our research."}, {"title": "C Traffic Signal Control", "content": "Traffic signal control is an important means of mitigating congestion in traffic management. Compared to using fixed-duration traffic signals, an RL agent learns a policy to determine real-time traffic signal states based on current road conditions. The state observed by the agent at each time consists of five dimensions of information, namely the number of vehicles, queue length, average waiting time in each lane plus current and next traffic signal states. Action here is to decide whether to change the traffic signal state or not. For example, suppose the traffic signal is red at time t, if the agent takes action 1, then it will change"}]}