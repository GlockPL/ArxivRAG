{"title": "AI-powered virtual tissues from spatial proteomics for clinical diagnostics and biomedical discovery", "authors": ["Johann Wenckstern", "Eeshaan Jain", "Kiril Vasilev", "Matteo Pariset", "Andreas Wicki", "Gabriele Gut", "Charlotte Bunne"], "abstract": "Spatial proteomics technologies have transformed our understanding of complex tissue architectures by enabling simultaneous analysis of multiple molecular markers and their spatial organization. The high dimensionality of these data, varying marker combinations across experiments and heterogeneous study designs pose unique challenges for computational analysis. Here, we present Virtual Tissues (VirTues), a foundation model framework for biological tissues that operates across the molecular, cellular and tissue scale. VirTues introduces innovations in transformer architecture design, including a novel tokenization scheme that captures both spatial and marker dimensions, and attention mechanisms that scale to high-dimensional multiplex data while maintaining interpretability. Trained on diverse cancer and non-cancer tissue datasets, VirTues demonstrates strong generalization capabilities without task-specific fine-tuning, enabling cross-study analysis and novel marker integration. As a generalist model, Vir Tues outperforms existing approaches across clinical diagnostics, biological discovery and patient case retrieval tasks, while providing insights into tissue function and disease mechanisms.", "sections": [{"title": "Introduction", "content": "Tissues, particularly in cancer, display pronounced heterogeneity across patients, disease stages and even within individual tumors\u2014evident in diverse cell phenotypes, states and spatial organization\u00b9. Accounting for this heterogeneity is critical: tumor development and response to therapy depend not just on cancer cells, but on their complex interactions with their surrounding environment. Different cell phenotypes may act as promoters or suppressors of tumor development and progression, depending on the biological context 2,3, with their spatial co-occurrence patterns predicting immunotherapy response 4,5, disease relapse and survival7. Understanding the spatial organization, composition and function of the tumor microenvironment (TME) has thus emerged as an important element for advancing cancer treatment.\nCapturing complex tissue structure requires advanced molecular imaging techniques that go beyond traditional methods 8.\nThe emergence of multiplexed imaging technologies\u2014including co-detection by indexing (CODEX), imaging mass cytometry (IMC) 10 and multiplex immunohistochemistry (IHC) 11\u2014has revolutionized our ability to study the TME by enabling in situ detection of multiple markers on a single slide 12. IMC, in particular, can measure up to 150 target proteins at cellular and sub-cellular scales, serving as a crucial tool for precision oncology 13 (Fig. 1a).\nAdvancement in computational tools of multiplexed tissue imaging data from patient tumors may provide three critical functions in clinical oncology: clinical diagnostics, e.g., the identification and characterization of tumors, biological discovery, e.g., understanding disease mechanisms and therapy responses, and clinical decision support through retrieval of comparable patient cases for molecular tumor boards 14 (Fig. 1a). The complexity of multiplexed data, characterized by immense scale and highly non-linear, context-dependent relationships between molecular markers, necessitates Al methods for meaningful pattern interpretation and prediction 15.\nTo achieve this, we present Virtual Tissues, an artificial intelligence (AI)-driven foundation model framework for representing biological tissues from spatial proteomics data. Trained on diverse datasets covering breast 13,17, lung 18 and melanoma 19 tissues and evaluated via zero-shot inference on diabetic pancreatic tissue 20, VirTues achieves strong performance across various clinical and biological tasks without task-specific training. Importantly, it can generate virtual tissue representations of new cancer types or diseases without fine-tuning, while maintaining robustness to dataset-specific artifacts."}, {"title": "Results", "content": "A novel vision transformer to construct AI-powered Virtual Tissues\nA pivotal characteristic of foundation models is their ability to leverage larger and more diverse training datasets in order to achieve superior performance across multiple downstream tasks. Importantly, the current state of vision transformers 16,24,25,26,31 developed for biological imaging face several limitations when applied to multiplexed biomedical data (Fig. 1e). First, the current architectures' computational complexity scales quadratically with both spatial dimensions and number of channels, making them impractical for high-dimensional spatial data. Second, their token-based representations typically treat all channels equally, failing to capture the distinct ones and filter out the potentially redundant biological information of different markers. Third, they lack explicit mechanisms for integrating differing marker combinations across experiments or for incorporating prior knowledge about protein interactions.\nWe specifically design VirTues to overcome the identified challenges and introduce a purpose-built ViT model for multiplexed imaging. By disentangling transformer's attention mechanism 32,33 into marker and spatial attention components, VirTues not only enables training on images with hundreds of channels, but also learns to distinguish between the spatial distribution and composition of cells that determine the molecular profile of a tissue as well as the relation and interaction between protein and RNA markers. Another critical innovation in VirTues is the introduction of a new tokenization scheme for spatial transcriptomics and proteomics: by combining protein language model embeddings with spatially-patched channel information and learnable cell summary tokens, we enable flexible processing of variable marker combinations while incorporating biological meaning and subcellular spatial distribution of markers (Fig. 1d, details in Methods). This multi-scale design 29,34 enables the integration of heterogeneous datasets containing different marker combinations (Fig. 1b), as demonstrated across lung cancer 18 (41 markers), melanoma 19 (38 markers) and breast cancer tissues 17,13 (35 markers each). These datasets show substantial variation in cohort sizes (2,062 total patients), cell counts (8.5 million total cells) and samples (3,470 total images) across different cancer types (Fig. 1c). We also note that VirTues' design does not provide a network architecture for biological vision foundation models simply due to its ability to scale: While modality-agnostic architectures used in previous methods do not profit from providing richer biological features, VirTues' performance scales with increasing number of markers, as demonstrated on a task on the cellular level (i.e., cell type classification) and the tissue level (i.e., cancer type) (Fig. le).\nThe Virtual Tissues framework is based on a masked autoencoder (MAE) architecture 35. The VirTues Encoder and Decoder are trained in an unsupervised fashion through reconstructing partially masked marker-space tensors (Fig. 2, details in Methods). Multiplex imaging data provide information at a subcellular resolution and thus provide the foundation for tissue understanding on the cell, niche and tissue level. To allow for downstream predictions across all biological tissue scales, VirTues generates cell, niche and tissue summary tokens that serve as hierarchical and multi-scale tissue representation used across a variety of downstream tasks (Figs. 3 and 4, details in Methods).\nVirtual Tissues understand tissue architectures and relations between markers\nTo evaluate VirTues' understanding of tissue architecture, we challenge its ability to reconstruct tissues masked in three different ways of increasing difficulty: (1) independent masking, where independently for each marker patches are masked at random spatial locations (Figs. 2a,b), (2) marker masking, where all patches of a single marker are masked (Figs. 2c,d) and (3) niche masking, where patches across all markers are masked at randomly selected spatial locations (Figs. 2e,f).\nIn the independent masking experiments, VirTues successfully reconstructs masked regions across markers, e.g., CAV1, FOXP3, H3 in Fig. 2b in lung cancer tissue 18 and KRT14, panCK, Twist in breast cancer samples 17, preserving both spatial distribution and intensity patterns (Suppl. Figs. 1, 2, 3, 4 for results on further channels of all datasets 18,19,17,13). This demonstrates the model's ability to leverage contextual information across both spatial and marker dimensions."}, {"title": "Performing biological discovery and clinical diagnostics tasks across the scales of biology", "content": "Vir Tues enables comprehensive analysis of tissues across biological scales through a unified framework (Figs. 3a-c). At the cellular level, cell summary tokens support tasks such as cell type classification. Niche summary tokens facilitate tissue structure analysis, while tissue summary tokens enable clinical diagnostics like the prediction of cancer type and grade. This unified multi-scale approach is particularly powerful as it allows predictions and queries across the inherent hierarchical organization of biological tissues, where molecular and cellular patterns inform higher-level tissue structures that ultimately contribute to clinical outcomes.\nFor biological discovery tasks at the cellular level, we employ logistic regression on the encoded cell summary tokens (Fig. 3a), a common practice referred to as linear probing, which measures discriminative performance and the representation quality of a foundation model encoder 36. For niche and tissue level tasks, we learn niche and tissue summary tokens (Fig. 1d) using attention-based multiple instance learning (ABMIL)37 on the cell summary tokens which enables addressing biological discovery and clinical diagnostic tasks on individual niches and tissue of patients (for details see Methods, Fig. 3b,c).\nVirTues consistently outperforms other pretrained encoders and vision transformers 16,24 trained unsupervised on multiplex images (Fig. 3), across all cell, niche and tissue level tasks performed on breast 13 and lung cancer tissue 18 (see Suppl. Fig. 14 for additional results on Jackson et al. 17). Specifically, we benchmark against CA-MAE 16 16 and ResNet 7 as they represent the current state-of-the-art architectures for cellular imaging data, respectively (for additional baselines, see Suppl. Fig. 15). CA-MAE16 follows the vision transformer architecture, however, it features a common encoder and separate decoders for each multiplex channel. ResNet 7 is pre-trained on ImageNet, where each channel is embedded separately and reduced to 16 dimensions with PCA. While CA-MAE16 is able to conduct predictions across different tasks on all scales (cell, niche and tissue level), ResNet7's architecture is restricted to niche and tissue level tasks, since it aggregates spatial information directly into niche-level embeddings.\nImportantly and a critical property of foundation models the performance on such downstream tasks increases when trained on a large collection of datasets, here demonstrated for an exemplary downstream task on the Danenberg et al. 13 patient cohort when comparing the VirTues platform with a VirTues Encoder/Decoder pair trained on the Danenberg et al. 13 dataset only (Fig. 3d).\nIdentifying the cell types in a tissue sample offers critical insights into its functional dynamics and cellular makeup. Moreover, it helps in dissecting the complex interactions between different cell types within a TME, which can help guiding systemic therapies geared towards the tumor environment (such as immunotherapy), treatments targeting the tumor cells themselves, and ultimately refine a broad range of systemic anti-cancer treatment regimens. For instance, we can gauge the strength of immune response through the high presence of tumor-infiltrating lymphocytes 38, or adjust treatments to target tumor- or resistance-promoting stroma 39.\nAt the cellular level (Fig. 3e), VirTues outperforms baseline methods in cell type multi-class classification for both breast cancer (distinguishing stromal, ER+, NK, ER-, B cell, myeloid and T cell populations) and lung cancer tissues (tumor, immune, fibroblast, T cell and vessel cells). The cell type classification tasks are affected by significant class imbalance (see Fig. 28 for the test set distribution). For instance, NK and B cells are severely underrepresented in the breast cancer dataset, while vessel and T cells are underrepresented in the lung cancer dataset. Despite this, the model demonstrates particular strength compared to baselines in identifying rare cell populations, maintaining robust performance across varying cell type frequencies. Additional classification results for fine-grained, highly-imbalanced cell types on Cords et al. 18 show consistent trends (see Suppl. Figs. 16 and 29 for results and support distribution).\nFor breast cancer tissue, VirTues achieves F1-scores of 0.55 for stromal cells and 0.49 for ER- cells, surpassing CA-MAE16 by 4.94% and 18.27% respectively. The performance advantage is even more pronounced for rare cell types such as NK and B cell, which cover only 1.17% and 3.27% of the test set. We first notice that VirTues is able to achieve an F1-score of 0.51 for NK, while CA-MAE16 fails to identify any NK cell. In case of B cells, VirTues achieves an F1-score of 0.41, surpassing CA-MAE 16 by 66.26%. In lung cancer analysis, VirTues maintains its superior performance, achieving F1-scores of 0.91 for tumor cells and 0.75 for immune cells, representing improvements of 4.05% and 48.83% over CA-MAE16 respectively. For the challenging and underrepresented vessel cell identification task, VirTues achieves an F1-score of 0.36, outperforming the baseline by a significant margin of 324.38%.\nAt the niche level (Fig. 3f), VirTues demonstrates robust performance in identifying multicellular tissue structures as defined by the respective authors of the studies including suppressive expansion, tertiary lymphoid structures (TLS)-like regions, PDPN+ regions. These regions reflect distinct cellular compositions and functional states: suppressive expansion regions contain regulatory T cells and PD-1-expressing cells indicating immune suppression; TLS-like regions show complex immune cell organization similar to tertiary lymphoid structures; and PDPN+ regions represent areas of active stroma. The structures present within the niches of the TME often recur across tumors 13 and identifying such structures gives insights into the functional state of the TME providing prognostic value.\nFor suppressed expansion regions, binary classification based on VirTues learned representation achieves an accuracy of 0.85, surpassing CA-MAE 16 by 4.11% (P < 0.006), and ResNet7 by 3.45% (P < 0.005). The Vir Tues-based model maintains strong performance across other tissue structures, with accuracies of 0.81 for TLS-like regions and 0.78 for PDPN+ regions, consistently outperforming CA-MAE16 by 15.01% (P <"}, {"title": "Spatial and marker attention provides explainability of algorithmic decisions", "content": "VirTues provides interpretable insights into its decision-making process through spatial and marker attention mechanisms (Fig. 3h,i). Importantly, the newly introduced attention scheme allows to disentangle the influence of spatial regions and markers that are critical for an algorithmic decision\u2014an ability no other architecture possesses.\nHere highlighted for adenocarcinoma (Fig. 3h) and squamous cell carcinoma samples (Fig. 3i), spatial attention maps reveal the influence of distinct cellular neighborhoods and the tumor architecture on the predictions of clinical properties. When classifying a patient's cancer type, for example, the spatial attention of VirTues' Encoder is high on tumor cell regions throughout the tissue.\nMarker attention analysis, on the other hand, provides insights into the relative importance of different RNAs and proteins in algorithmic decisions. This analysis can be conducted across the entire tissue or in spatial regions of interest, e.g., for tissue niches that are rich in tumor cells, a fibroblast neighborhood or the tumor immune microenvironment (TIME) (Fig. 3i). To quantify the importance of a marker for the generated representation, we showcase the importance scores perceived by VirTues, which signifies the relative marker attention scores learned by VirTues for the region of interest (see Methods for details).\nWhen analyzing an immune-cell infiltrated tumor region of squamous cell carcinoma, for example, the model assigns high importance to tumor cell markers panCK and MMP11 and immune cell markers CD45RA and CD10. panCK is a positive marker for carcinomas of epithelial origin 44. Matrix metalloproteinase-11 (MMP11) is secreted by stromal cells in the tumor microenvironment, and its overexpression correlates with tumor aggressiveness by inhibiting apoptosis and promoting the migration and invasion of cancer 45. CD45RA is expressed on naive T and B cells 46, while CD10 is primarily found on early B lymphocytes and certain T cell subsets 47, making both proteins reliable markers for identifying specific immune cell populations within the tumor and its microenvironment.\nRegions of the tissue mostly populated by fibroblasts with interspersed immune cells show high attention weights for both stromal and immune markers. Vimentin (VIM) and smooth muscle actin (SMA) are canonical markers for fibroblasts and myofibroblasts 48, while Collagen I is associated with extracellular matrix production and stromal cell activation 49. CD248 (endosialin) expression in cancer is complex and context-dependent while it is found on fibroblasts and pericytes in healthy tissue, its expression pattern and cellular localization can vary significantly between different carcinomas 50. Fittingly, its role in this region may reflect stromal components of the TIME."}, {"title": "Retrieval via the Virtual Tissues database for clinical decision support", "content": "VirTues facilitates clinical decision support through a novel retrieval system that identifies similar cases from a database of previous patients (Fig. 4a). This system could enable clinicians to make informed decisions by comparing tissue phenotypes, applied therapies, and clinical outcomes across cases. Given a VirTues representation of a patient's tissue through niche summary tokens that capture tissue composition, architecture and interactions between different cellular neighborhoods, the Virtual Tissue platform allows querying the VirTues Database for archival cases with similar molecular profiles. To achieve this, VirTues measures the structural similarity between virtual tissue embeddings using an optimal transport-based approach. Concretely, we compute the pairwise Wasserstein distance 51,52 between the respective niche summary tokens of the query tissue and samples in the VirTues Database. Top-k matches, along with the clinical records of their corresponding patients are retrieved for clinical decision support.\nQuantitative evaluation demonstrates superior performance in matching both cell type composition and molecular tissue structure compared to existing methods (i.e., ResNet7, CA-MAE16) and random retrievals. Concretely, we measure the L1 distance between normalized histograms of the cell type distributions in each patient sample. In our example of primary lung cancer tissue 18, VirTues significantly outperforms other methods 7,16,24 (Fig. 4b, left). To quantify the similarity in molecular tissue structure between query and retrieval samples, we introduce an optimal transport-based evaluation metric based on computing the sliced Wasserstein distance of the raw pixel values of the corresponding multiplex images53 (see Methods for details). Again, Vir Tues retrieves archival patient samples whose molecular tissue composition is highly similar to the query (Fig. 4b, right). So while the retrieval is based on VirTues niche summary tokens, the similarity also holds with regards to other representations of the tissues, such as cell type annotations or raw images.\nFurther, we evaluate the similarity of the retrieved archival patients not only in terms of cell type and molecular tissue composition but also their associated clinical records. Concretely, we perform a McNemar test for each clinical label to compare the number of hits among the top three results achieved by VirTues with the number of hits for random retrieval. The model achieves significant improvements in critical clinical diagnostic tasks (Fig. 4c), including cancer type classification (P = 6.5e-116), grade determination (P = 1.1e-25), lymph node metastasis prediction (P = 1.0e-06) and relapse prediction (P = 5.6e-07).\nThree case studies demonstrate VirTues' ability to retrieve relevant matches across different cancer presentations: (1) A grade 2 squamous cell carcinoma case retrieving similar cases with varying lymph node metastasis and relapse outcomes (Fig. 4d), (2) a grade 3 adenocarcinoma case matching samples with similar tissue architecture and lymph node (LN) metastasis status but different clinical trajectories (Fig. 4e) and (3) a grade 2 adenocarcinoma case with lymph node metastasis and relapse, showing previous adenocarcinoma cases with comparable grades and tissue architectures (Fig. 4f). Each retrieved case includes a visualization of the cell type distribution (tumor, immune, vessel, fibroblast, T cells) and clinical annotations, enabling direct comparison of tissue architecture and outcomes. Further case studies are exhibited in Suppl. Fig. 17.\nThe systematic evaluation of VirTues' retrieval capabilities demonstrates not only its ability to identify molecular similar tissue architectures but also the clinical relevance of these similarities, as evidenced by the concordance of retrieved cases' clinical features and outcomes. Thus, by integrating molecular profiles, tissue architecture and clinical outcomes in a unified retrieval framework, VirTues provides the foundation for a data-driven comparison of tissue phenotypes across patient cohorts."}, {"title": "Virtual Tissues represent patient samples of previously unseen cancer type or disease", "content": "The rapid advancement of precision oncology and the emergence of new molecular disease subtypes require computational methods that can immediately analyze novel cancer types without the time-consuming process of collecting large training datasets and retraining models. This is particularly critical in clinical settings, where prompt analysis of rare cancers or newly characterized disease subtypes can directly impact treatment decisions. While most approaches require model updates or fine-tuning which risks overfitting and compromising the universality of learned representations, we demonstrate that VirTues achieves true zero-shot generalization to unseen cancer types and diseases (Fig. 5). When tested on new datasets including melanoma 19 and pancreatic tissue samples 19, the model maintains robust performance without any refinement, preserving tissue representation capabilities that are apparently universal across tissue types and downstream tasks.\nTrained on primary breast 13,17 and lung cancer tissue 18, VirTues directly maps primary and metastatic melanoma cancer samples into the Virtual Tissue space (Fig. 5a). To evaluate the VirTues Encoder, we analyze its reconstruction abilities in the zero-shot setting for different previously described - masking strategies. The evaluation is conducted over the subset of markers in Hoch et al. 19 shared with the train datasets 13,17,18 Examples of different marker reconstructions are visible in Fig. 5b. Reconstruction results on further markers can be found in Suppl. Figs. 18, 19, and 20. Quantifying the average MSE over all markers shows that the reconstruction performance for independent and niche masking is relatively stable across the trained (many-shot) or zero-shot setting. When masking an entire marker and thus any information on inter-marker correlation, the performance significantly drops (Fig. 5c, Suppl. Fig. 25). In independent and niche masking, spatial attention can leverage local spatial context and marker attention dynamically picks up correlations between markers to reconstruct missing regions. However, when an entire marker is masked, reconstruction relies solely on learned relations between markers from the training data. Unsurprisingly, in zero-shot settings, these may not fully generalize to novel cancer types where marker relationships could differ from the training distribution.\nMost strikingly, quantitative evaluation shows strong performance in the biological discovery and clinical diagnostic tasks even in the zero-shot setting, i.e., cell type classification (Fig. 5d) and clinical feature prediction (Fig. 5e); for melanoma samples performance levels approach those achieved on trained datasets. At the cellular level, we compare the performance of Vir Tues (zero-shot) with VirTues (many-shot) on cell type classification (distinguishing lymphocytes, macrophages, stromal, T cell and tumor cells). VirTues (zero-shot) achieves F1-scores of 0.94 for tumor cells and 0.81 for T cells, as compared to VirTues (many-shot) achieving F1-scores of 0.94 and 0.84 respectively. Moreover, we notice that in macrophages, VirTues (zero-shot) outperforms VirTues (many-shot) achieving F1-scores of 0.51 and 0.48 respectively. At the tissue level, Vir Tues shows stronger performance than ResNet7 in general. Vir Tues (zero-shot) demonstrates superior performance, for example, in Relapse prediction (0.88 accuracy, improving performance by over 79.49% as compared to ResNet 7), and Mutation prediction (0.76 accuracy, with relative performance improvement of 32.59% over ResNet 7). Benchmarking here is reduced to ResNet7 in the tissue level as CA-MAE 16 is not designed to operate in the zero-shot setting. As mentioned before, ResNet7 is restricted to niche- and tissue-level tasks.\nBesides representing a completely new cancer type, we test VirTues' capacity to create virtual tissues of a new disease, specifically, diabetic pancreas tissue 20. This dataset comprises multiplexed IMC data from 843 images from 12 human donors, including eight with type-1 diabetes (T1D), capturing the progression of T1D through comprehensive profiling of pancreatic tissue sections with 32 markers (Fig. 24). While the overall reconstruction performance of masked regions is lower (Fig. 5f) compared to zero-shot performance on a different cancer tissue type (Fig. 5c), the overall findings hold for T1D tissues. Reconstruction results on further markers can be found in Suppl. Figs. 21, 22, and 23. MAE losses for individual markers are shown in Suppl. Fig. 25.\nFurther, across tasks on the cellular and tissue level, the zero-shot performance of VirTues is on par with the many-shot setting (Fig. 5g,h). At the cellular level, we compare the performance of VirTues (zero-shot) with VirTues (many-shot) on cell type classification (distinguishing exocrine, immune, and islet cell populations). We note that the populations are highly imbalanced, with exocrine cells occupying 84.10% of all cells, while immune and islet cells occupy 3.17% and 12.73% respectively. VirTues (zero-shot) achieves an F1-score of 0.84 for exocrine cells and 0.15 for islet cells, as compared to VirTues (many-shot), which gets 0.84 and 0.18 respectively. Importantly, the overall performance in predicting the immune and islet class is low even in the many-shot setting, likely due to the overall limited amount of training data for these tasks. At the tissue level, VirTues (zero-shot) achieves an accuracy of 0.84 surpasses ResNet7, with an accuracy of 0.83, by 0.80% in AAB status classification, while VirTues (trained) achieves an accuracy of 0.89, and has a larger improvement of 7.50%. For the stage classification task, VirTues (zero-shot) achieves an accuracy of 0.75 outperforms ResNet7, with an accuracy of 0.70, by 6.72%, with VirTues (trained) achieving an accuracy of 0.77 and demonstrating an improvement of 9.25%.\nFurthermore, the ability to reconstruct masked tissue regions and marker measurements and tackle prediction tasks across different physical scales of pancreatic tissue suggests that VirTues' learned tissue representations capture fundamental biological patterns that generalize across diseases and organs."}, {"title": "Multi-scale design enables extrapolation to new markers", "content": "The ability to analyze new protein or RNA markers without model retraining is crucial for two key reasons: First, the rapid evolution of protein biomarker discovery in oncology continually identifies new molecular targets that could serve as diagnostic markers or therapeutic targets. While traditional approaches would require complete retraining with new datasets that contain additional markers, this creates an unacceptable delay in clinical translation. Second, different research studies and clinical applications focus on distinct aspects of tumor biology, necessitating flexible combinations and possibly measurement of new markers. A framework that requires retraining for each new marker would severely limit interoperability between studies.\nA key innovation of the multi-scale design of Vir Tues is therefore its ability to incorporate new markers without retraining, enabling both rapid translation of novel biomarkers and integration of data across diverse scientific studies. A critical building block to achieve this is the integrated protein language model that operates on the molecular level of the VirTues architecture which allows zero-shot embedding of new markers. Concretely, Vir Tues leverages learned relationships between proteins captured in the embeddings of the PLM trained on millions of protein structures54 to predict the behavior of new markers based on their molecular similarities and biological contexts34. A UMAP of the PLM embedding of the different markers from the used datasets is displayed in Fig. 5i (see Suppl. Fig. 26 for UMAPs of individual datasets). As expected, proteins with similar structures (and functions) cluster together such as various cytokeratins or transcription factors in the bottom right and top of the UMAP, respectively.\nWe demonstrate VirTues' capability to perform zero-shot embedding of new unseen markers, that are present in Hoch et al. 19 but absent from VirTues' training datasets, in two different scenarios of increasing difficulty: First, we embed new proteins that are well supported by markers of highly similar PLM embeddings across training datasets. One such marker is Melan-A (MLANA), also known as melanoma antigen recognized by T cells 1 (MART-1), which contains a fragment that is bound by MHC class I complexes presented to T cells of the immune system (Fig. 5j,k). MLANA is well surrounded by markers such as PDN, cell surface receptor on T cells and B cells, or CD20 or CD38, cell surface molecules of immune cells. Second, increasing the difficulty, we test VirTues on integrating isolated markers that have only a few similar markers across the training datasets, e.g., CCL8-mRNA, the mRNA of a chemokine secreted by tumor-associated"}, {"title": "Multi-scale design enables extrapolation to new markers", "content": "macrophages 55. Besides markers such as CCL21 present in Cords et al. 18 and CXCL12, present in Danenberg et al. 13, VirTues has not seen any further marker with related PLM embedding.\nAnalyzing VirTues ability to reconstruct new markers highlights the importance of VirTues' multi-scale design: Despite not encountering MLANA (or other well-supported markers such as PD-L1, p-Rn, SLC2A12 and SOX10, see Fig. 51), the model reaches the reconstruction performance of a version of Vir Tues that includes the Hoch et al. 19 dataset in training in the independent marking setting. The marker attention is able to process the combined marker and spatial token on the fly, given access to some unmasked patches of the new marker (Fig. 5j). In the setting where the entire marker is masked, VirTues can reconstruct the overall expression of the marker, however, not its intensity (Fig. 5k).\nThe result on CCL8-mRNA demonstrates that VirTues' performance varies based on the information support available for new markers (Fig. 5j,k). While the overall trends in VirTues' reconstruction ability follow the results in Fig. 5j,k on supported markers, the quality is lower the less supported a marker is: Fig. 51 shows all markers in Hoch et al. 19 that are not present in any of the training dataset sorted by the average distance to its 5 nearest neighbors in the PLM embedding space (Fig. 5i). The average squared reconstruction error thereby increases from 0.40 in supported markers to 0.67 in isolated markers. Results on further markers highlighted in Fig. 51 can be found in Suppl. Fig. 27.\nThis systematic analysis of VirTues' ability to incorporate new markers reveals both the power and limitations of protein language model-guided marker extrapolation: While the model successfully generalizes to new markers that are molecularly similar to those in the training data, its performance decreases for more isolated markers. This behavior aligns with biological intuition-markers with similar molecular properties are more likely to exhibit related spatial distributions in tissues and suggests that future improvements in protein language models could further enhance VirTues' marker extrapolation capabilities."}, {"title": "Discussion", "content": "The development of the Virtual Tissues platform represents a new development in computational pathology, introducing a foundation model framework that addresses key challenges in analyzing multiplex imaging data while enabling new capabilities for biological discovery and clinical applications. Our results demonstrate that Vir Tues achieves three critical objectives: universal tissue representation across cancer types, diseases and organs, flexible incorporation of new molecular markers and interpretable multi-scale analysis from molecular to tissue levels.\nA fundamental innovation of VirTues is its ability to generate virtual tissue representations that generalize across cancer types, diseases and organs without requiring retraining or fine-tuning. This capability is particularly valuable for rare cancers and newly characterized disease subtypes, where collecting large training datasets is impractical. The model's robust zero-shot performance in both melanoma and pancreatic tissue analysis suggests that it captures fundamental biological patterns that transcend specific contexts. This universality is enabled by our novel transformer architecture that explicitly separates spatial and marker attention mechanisms, allowing the model to learn generalizable relationships between molecular markers while maintaining sensitivity to tissue-specific spatial patterns. The integration of protein language models at the molecular scale represents another key advancement, enabling VirTues to incorporate new markers without retraining. This capability is essential for keeping pace with rapid biomarker discovery and accommodating diverse research priorities that require different marker combinations. By leveraging learned protein relationships, Vir Tues can predict the behavior of novel markers based on their molecular similarities to known markers, as demonstrated with MLANA in melanoma tissue. The model's ability to handle varying marker combinations also facilitates cross-study comparisons and meta-analyses.\nVirTues' multi-scale design, operating from molecular to tissue levels, provides a comprehensive framework for understanding complex biological systems. This hierarchical approach enables the model to capture how molecular and cellular patterns inform higher-level tissue structures that ultimately determine clinical outcomes. The model's strong performance across cell type classification, tissue structure identification and clinical feature prediction demonstrates the value of this integrated analysis. Furthermore, the attention-based interpretability mechanisms provide biological insights by revealing critical spatial regions and marker relationships that influence predictions.\nThe potential clinical utility of VirTues is demonstrated through its retrieval system for clinical decision support. By enabling the identification of similar cases based on molecular and cellular patterns across different study designs, the system could assist in evidence-based clinical assessment. The improvements in matching tissue composition and predicting clinical outcomes suggest that VirTues captures biologically meaningful similarities between cases, though prospective clinical validation would be needed to confirm its utility in clinical decision-making or in selecting patients for clinical trials based on tissue architecture.\nDespite these advances, several important limitations of our study should be acknowledged. While VirTues shows promising zero-shot performance, its effectiveness varies depending on the biological similarity between new markers and those in the training set. Performance degradation is particularly noticeable for markers lacking close biological relationships to the"}, {"title": "Discussion", "content": "training data, as demonstrated by the CCL8 mRNA results. This suggests that the model's generalization capabilities, while robust, are not unlimited.\nAlthough our study incorporates data from five diverse cohorts spanning different cancer types and diabetes, further validation on larger and more diverse datasets is needed to fully assess VirTues' scalability and generalization capabilities. While our current results demonstrate strong performance across these initial datasets, the exponential growth in multiplexed imaging data and the emergence of new experimental protocols may reveal additional challenges or limitations in the model's architecture. This is particularly relevant for assessing the model's performance across different experimental batches, tissue preparation methods and imaging platforms not represented in our current datasets. Our current implementation focuses primarily on protein and RNA markers. The generalizability to other molecular data types such as metabolomics or disease contexts remains to be fully evaluated. Additionally, the model's performance on rare cell types or unusual tissue architectures may be limited by their underrepresentation in training data.\nWhile our attention-based interpretability mechanisms provide valuable insights, they may not capture all biologically relevant features. The model's decisions could be influenced by subtle patterns that are not easily interpretable through attention visualization alone. Furthermore, the clinical relevance of identified patterns requires validation through prospective studies.\nLooking forward, several important research directions emerge. The framework could be expanded to handle additional imaging modalities and molecular data types. Methods to improve generalization for markers, which are rarely measured, could be developed through integration of additional protein structure and function information. The incorporation of temporal information could enhance understanding of disease progression and treatment responses, while the clinical decision support system could be enriched with additional metadata and outcome data to provide more comprehensive guidance.\nVir Tues' ability to reconstruct fully masked markers through learned biological relationships opens intriguing possibilities for integration with generative Al approaches. While current virtual multiplexing methods focus on generating specific marker patterns from H&E images 56,57,58,59, VirTues' marker reconstruction capabilities could be leveraged to generate and validate synthetic multiplex data. The model's understanding of marker relationships could help constrain generative processes to biologically plausible configurations, potentially improving the fidelity of virtual staining approaches. This synergy between reconstruction and generation could enable more robust and biologically accurate virtual multiplexing, particularly for markers that are challenging to measure experimentally.\nVirTues represents a significant step toward the broader goal of creating universal computational models for biology that can seamlessly integrate diverse data types and generalize across biological contexts. As multiplex imaging technologies continue to evolve, frameworks like VirTues will become increasingly important for translating molecular insights into clinical applications."}, {"title": "Tokenization", "content": "To"}]}