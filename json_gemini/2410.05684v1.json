{"title": "Copiloting Diagnosis of Autism in Real Clinical Scenarios via LLMs", "authors": ["Yi Jiang", "Qingyang Shen", "Shuzhong Lai", "Shunyu Qi", "Qian Zheng", "Lin Yao", "Yueming Wang", "Gang Pan"], "abstract": "Autism spectrum disorder(ASD) is a pervasive developmental disorder that significantly impacts the daily functioning and social participation of individuals. Despite the abundance of research focused on supporting the clinical diagnosis of ASD, there is still a lack of systematic and comprehensive exploration in the field of methods based on Large Language Models (LLMs), particularly regarding the real-world clinical diagnostic scenarios based on Autism Diagnostic Observation Schedule, Second Edition (ADOS-2). Therefore, we have proposed a framework called ADOS-Copilot, which strikes a balance between scoring and explanation and explored the factors that influence the performance of LLMs in this task. The experimental results indicate that our proposed framework is competitive with the diagnostic results of clinicians, with a minimum MAE of 0.4643, binary classification F1-score of 81.79%, and ternary classification F1-score of 78.37%. Furthermore, we have systematically elucidated the strengths and limitations of current LLMs in this task from the perspectives of ADOS-2, LLMs' capabilities, language, and model scale aiming to inspire and guide the future application of LLMs in a broader fields of mental health disorders. We hope for more research to be transferred into real clinical practice, opening a window of kindness to the world for eccentric children.", "sections": [{"title": "1 Introduction", "content": "Autism spectrum disorder (ASD) is a pervasive neurodevelopmental disorder characterized by restricted social communication, repetitive behaviors, and specific interests. It significantly impacts the quality of life and well-being of individuals affected [27]. According to a 2021 report from the Centers for Disease Control and Prevention (CDC) in the United States, the prevalence of ASD among children under the age of eight is approximately 1 in 44 [44]. However, research indicates that the neural impairments in individuals can be early detected and timely intervention have been shown to improve language abilities and behavioral habits in children with autism, enabling them to reintegrate into society successfully. Currently, clinical diagnosis primarily relies on the Autism Diagnostic Observation Schedule, Second Edition (ADOS-2) [46], and heavily depends on the professional expertise of doctors. However, due to limitations in the number of qualified professionals and the inherent individual differences among children, diagnostic errors and missed cases are inevitable [26], causing children to miss the optimal treatment window.\nWith the advancement of computer technology, numerous computer-assisted methods for ASD diagnosis have emerged. One category involves simplifying clinical paradigms and collecting data from various modalities such as electroencephalography (EEG) [25], eye-tracking (ET) [61],"}, {"title": "2 Related work", "content": ""}, {"title": "2.1 Computer-aided ASD diagnosis", "content": "To develop automated diagnosis of ASD using computer technology, researchers have extensively investigated atypical behavioral features of ASD through methods like EEG [25, 9], fMRI [55], and ET [21, 61, 62, 20]. [25] proposed a multimodal diagnostic framework for identifying ASD by combining EEG and ET data. [16] designed a simulated interaction task that uses a standard 7-minute simulated dialog via video to assess multiple biomarkers of social interaction deficits, including gaze behavior, facial expressions, and voice characteristics. This approach specifically targets joint attention (JA) impairments, emotional disorders, and language impairments in ASD. Acoustic and text-based features have also shown relevance in assessing children's language and communicative behaviors for ASD diagnosis [49, 6]. [3] explored the semantic and pragmatic language features in children to understand their significance in diagnosing ASD. To overcome the requirement for specialized professionals and extensive resources, some studies have adopted a natural language processing approach using electronic health records [53] and even online text [34, 11]."}, {"title": "2.2 ADOS-2 with machine learning", "content": "Although these studies above have made considerable progress in ASD diagnosis, translating research findings from lab settings back into clinical practice remains challenging. To address this, researchers extended their studies to the clinical environment of ADOS-2, for more details about ADOS-2 see Appendix C, despite the difficulties in data acquisition. Various paradigms based on ADOS-2 have been proposed for feature extraction and diagnosis. For instance, [41] assessed ASD language, cognition, and attention by transforming ADOS-2 evaluation tasks into 9 social skill task scenarios, utilizing image-language pre-training models for score prediction. Based on the ADOS-2 process, [13] designed and proposed a standardized platform for stimulating, gathering, analyzing, modeling, and interpreting human behavioral data for ASD diagnosis. Additionally, [13, 43, 47, 54] directly used speech data from the ADOS-2 clinical assessment process for ASD prediction. Among these, [43] used speech data from the entire process, while [54] predicted ADOS-2 Calibrated Severity Scores (CSS)."}, {"title": "2.3 LLMs in healthcare", "content": "Although there are still some doubts regarding the application of large language models (LLMs) in the medical field, research has been extensively conducted in this area [15, 24, 29, 70, 45]. LLMs have demonstrated promising contextual understanding and zero-shot and few-shot capabilities for many medical scales and subjective descriptions. Studies [48, 19, 1, 40] used case vignettes to evaluate the differences between LLM diagnoses and expert diagnoses in areas such as depression [48, 19] and diabetes [1]. Studies [64, 35] compared the performance of various LLMs on health tasks. [56] introduced a benchmark that combines 6 existing medical question-answering datasets spanning professional medicine, research, consumer queries, and a new dataset of medical questions searched online. In the field of ASD, LLMs have effectively aided in diagnosis [28], treatment [14], and daily life management [30]. In [28], researchers used LLMs to perform binary classification on the scores of ASD adults executing the ADOS-2 A4 task, achieving an accuracy rate of 81.82%. They also used LLMs to analyze 10 social language impairment features of ASD.\nOur study utilized the complete range of ADOS-2 clinical voice data and advanced the individual scoring of ADOS-2 through In-context Enhancement, Interpretability Augmentation, and Adaptive Fusion Method to propose the framework ADOS-Copilot. Our method can reduce healthcare costs, including patient testing fees and physician training expenses, and minimize the potential for subjectivity in human diagnoses. The explainability of LLMs also contributes to the objectivity of results, aiding patients in understanding their condition and facilitating targeted treatment. However, it is important to acknowledge that the use of LLMs raises privacy and ethical concerns. Ensuring adherence to relevant ethical codes by LLM providers and further testing voice-based de-identification methods is essential. Furthermore, increased reliance on technology by doctors may lead to a higher risk of misdiagnosis."}, {"title": "3 Methodology", "content": "Our proposed framework is shown in Figure 1. In concisely, we obtained scores for the 8 items of the ADOS-2 Module 3(M3) language section using the In-context Enhancement and Adaptive Fusion method. Then, we utilized Interpretability Augmentation to generate more detailed explanations. It is worth mentioning that ADOS-2 M3 has a total of 14 clinical diagnostic items, with the excluded items being purely non-verbal assessments."}, {"title": "3.1 In-context enhancement prompt", "content": "We introduced the technique of in-context enhancement to address the challenge of current LLMs being unable to utilize generic prompt templates for solving task of ADOS-2 scoring and explanation in real clinical scenarios.\nIn-context Enhancement Prompt details are shown in Appendix D.2 with the Figure 4. We aim to design such a prompt that enables the model to focus on scoring while providing corresponding justifications simultaneously called Scoring&Explanation(zero-shot). We design such prompt based on the following assumptions: reasoning is aimed at better scoring, and scoring is aimed at better reasoning. This assumption aligns with intuition: if the task focuses solely on scoring without providing justifications, the model may resort to tricks, become lazy in thinking, and consequently yield poorer scoring results. Conversely, if the emphasis is solely on reasoning without scoring, there won't be a reasonable standard for the reasoning process, resulting in lower interpretability of the justifications provided [65]. It is worth mentioning that in Figure 4, the -(optional) prefix text can"}, {"title": "3.2 Adaptive integrating LLMs with rule-based model for enhanced ASD diagnosis", "content": "This section introduces an advanced, hybrid methodology that merges the data-driven rule-based model, aligning with ADOS-2 criteria, with the adaptability of LLMs. Our aim is to establish a more comprehensive and reliable diagnostic system for Autism Spectrum Disorder (ASD), addressing the lack of objective and quantitative tools in current ASD diagnosis.\nWe presents a data-driven rule-based model, addressing the need for objective, quantitative diagnosis tools. It extracts tailored features from child's communication and social interactions linked to ADOS-2 and clinical guidelines for quantifying [6, 47]. Subsequently, rule-based scoring is applied, translating these features into quantitative assessments for individual ADOS-2 sub-items. Readers are encouraged to refer to Appendix E, which provides supplementary information on the design frameworks underlying our rule-based scoring mechanism."}, {"title": "3.3 Interpretability augmentation via the second stage", "content": "Based on our experimental results, we find that under the prompt setting of Scoring&Explanation, all LLMs perform better in terms of scoring results, including MAE and classification evaluation metrics, in the zero-shot setting compared to the few-shot or Only-Scoring setting. This suggests that the few-shot setting may primarily provide a format guideline and allow LLMs to extract more task-related information from the format guidelines [63], thereby appearing a more professional illusion. However, we aim to provide more reasonable justifications and evidence while ensuring accurate scoring. Therefore, we need a method that can achieve a balance between the two objectives. So partially inspired by [42], we introduce a second stage to enhance the interpretability: in the first stage, we utilize the zero-shot setting to perform the initial scoring and evidence search, aiming to obtain the best scores. In the second stage, we use the scores obtained from the first stage and the original dialogue text as the user prompt. Based on this prompt, we employ a reasoning chain to guide the LLMs to directly extract the most relevant excerpts from the original dialogue text that correspond to the scores and generate the output accordingly. This two-stage approach allows us to achieve both accurate scoring and provide more relevant justifications based on the original dialogue text. The prompt's detail using for second stage is shown in Appendix D.3 with the Figure 6."}, {"title": "4 Experiments and results", "content": ""}, {"title": "4.1 Dataset", "content": "The dataset utilized in this study was recorded in a clinical context, consisting of 28 audio samples of the whole ADOS-2 assessment processes. We then transcribe the audio into text. Written informed consent was obtained from the parents or caregivers of all participants prior to the assessment. See more details in Appendix A."}, {"title": "4.2 Experimental setup", "content": "LLMS We explore a wide span of LLMs in our experiment, including GPT-4-turbo [2], Gemini1.5-Pro [52], Claude3, Llama3-8b [5], Mixtral [31, 32], Qwen1.5 [7], Glm [18], Yi-34b [66], Kimi. It is worth noting that our data is derived from a Chinese dataset. Therefore, we have opted to use more LLMs that have been trained on a larger proportion of Chinese pretraining data. Additionally, some models were not trained using Chinese word embeddings, consequently, during experimentation, we will translate both the data and prompts into English when using them, which may lead to inevitable accuracy loss. All LLMs use the default temperature set by their creators.\nMetrics We use MAE to measure the performance of each 8 items (A4,A7,A8,B4,B7,B9,B10,B11) like many previous works [13], since the magnitude of these scores reflect the degree that the item"}, {"title": "4.3 Results", "content": ""}, {"title": "Validation for in-context enhancement prompt strategy", "content": "Based on the excellent performance of the Qwen1.5 series, we conducted detailed prompt ablation experiments on the 32b model shown in Table 2. The results showed that the prompt consisting of standard ADOS-2 scoring criteria, the diagnostic procedures of ADOS-2, and prior information(C+M+S) which is described in Figure 4 yielded the best results. This prompt design effectively maximized the potential of LLMs and enabled them to successfully tackle this complex task. Compared to the concise setting, the results of the in-context enhancement prompt show a decrease of 14.61% in average MAE across the eight items. Additionally, there is an increase of 17.86% in binary classification accuracy, 19.52% in F1 score, 25.00% in ternary classification accuracy, and 23.02% in F1 score which clearly demonstrates that utilizing in-context enhancement prompts can effectively tap into the potential of LLMs in this task.\nAdditionally, we observed that different prompt settings can indirectly and significantly impact the accuracy of certain item, thereby influencing the MAE and classification. For standard criteria, it is crucial for LLMs to include it to understand more objectives and justifications of each scoring criterion, allowing for more objective and professional scoring. We can observe significant improvements in all performance metrics when switching from concise to standard criteria. For the knowledge of ADOS-2 procedure, it could help models to understand the scenario of the conversation with incorporating domain-specific knowledge into the models. For the prior statistical information, it is clearly helpful to lowering B4's MAE. The statistics of ADOS-2 scoring could guide LLMs to give more suitable scores. For example, if mean of an item is pretty low, the model will be more hesitant to give a score of 2. In this sense, the prior information could help to align models'pattern to humans'."}, {"title": "Validation for rule-based model and fusion strategy", "content": "By scrutinizing the entries within the 'rule' row of Table 3, it becomes evident that the rule-based model excels in the majority of the evaluated criteria, thereby attesting to its proficient performance. Of particular note, items A4 and B4 yield MAE scores that are less than LLM's. This notable accomplishment can be attributed to the meticulous quantification of ADOS-2 alongside the adept utilization of sentiment analysis techniques, underscoring the efficacy of these methodologies in enhancing predictive accuracy and precision.\nTable 3 showcases the efficacy of combining LLMs with rule-based systems. The Fusion model, by merging the two, achieves superior outcomes: compared to the LLMs, fusion model show a decrease of 2.38% in average MAE across the eight items. In addition, there is an increase of 5.00% in ternary classification accuracy, This evidently illustrates that employing a fusion strategy can efficiently harness the capabilities of both LLMs and rule-based models for this particular task. Thus, Fusion models improve overall performance and robustness, affirming the merit in hybrid solutions. For more detailed results of rule-based model and fusion strategy, please refer to Appendix G."}, {"title": "5 Discussion", "content": ""}, {"title": "5.1 Further experiments conducted on the LLMs baseline", "content": "To validate the effectiveness and generalizability of proposed framework, We conducted extensive comparative experiments on a wide range of LLMs. Due to limitations in handling long contexts, not all famous LLMs such as llama-2 [59] were selected. From Table 4, it can be observed that the Qwen1.5 series of models perform SOTA. The 72b model achieved an average MAE of 0.4805,"}, {"title": "5.2 What effects the evaluation made by LLMs?", "content": "In this section, we will systematically explain the factors that contribute to the biases of LLMs towards various scoring items. We have calculated the average MAE results for the eight items from all experimental models of its SOTA settings shown in Table 5. We can observe that LLMs have higher average MAE in the A4, A8, B10, and B11 items, indicating a larger deviation from the clinical diagnoses made by doctors. On the other hand, LLMs show smaller average MAE deviations in the A7, B4, B7, and B9 items, aligning more closely with the results provided by doctors. Based on the ADOS-2 criteria details for the eight items, we can conduct that LLMs demonstrate effectiveness in providing scores for certain items primarily due to two characteristics: Firstly, the ADOS scoring criteria for these items have clear descriptions, and there are evident differences between the scores. Such task descriptions serve as effective prompts to guide LLMs' performance. Secondly, these items are mainly based on objective factors that are less influenced by non-verbal elements.\nIn Figure 3, we can observe how LLMs perform scoring: in Figure 3(a), A4 involves stereotyped and idiosyncratic use of words or phrases, which typically extends beyond just the text and includes aspects of speech and intonation. LLMs may not capture the stereotyped usage solely from the text, leading to an explanation of why they give a score of 0, whereas doctors would consider other factors to cause the bias. In Figure 3(b), A7 pertains to the reporting of events, and the scoring criteria provide detailed explanations and examples. LLMs, therefore, pay particular attention to the events mentioned in the conversation and provide a relatively reliable score for the overall conversation quality. In Figure 3(c), B4 involves shared enjoyment in interaction, which is a highly subjective experience that relies on the doctor's expertise and real-time experience. It also encompasses non-verbal aspects. LLMs can only assess the child's expression of joy based on the text and may perceive it as one-sided rather than shared enjoyment with the doctor, leading to a score of 2. However, the doctor's on-site experience could be completely different and might not align with the LLM's assessment. In Figure 3(d), B9 pertains to the quality of social responsiveness, and its description is concise, impactful, and exhibits significant differences between scores. So LLMs can summarize from the conversation that \"the child's social responses are mostly peculiar and stereotyped\" and provide an example of \"frequently using the same name for multiple different things.\" Finally, LLMs give a score of 2 based on the evidence of ADOS criteria that \"the child demonstrates obvious limitations in adapting to social situations\". The explanation is logical, well-supported, and persuasive. Based on the aforementioned analysis, we suggest that the scoring criteria for each assessment item in the ADOS-2 manual should be described in a more detailed and clear manner. It would be highly beneficial to include subjective examples that can help enhance understanding. It is worth mentioning that there is significant variation in the bias of the B4 item across different LLMs. Models such as Qwen1.5 and glm4 scoring more accurately, while models like gpt-4 and Gemini1.5 perform poorly. More detailed discussion of eight item can be found in Appendix H."}, {"title": "6 Conclusion", "content": "In conclusion, this paper explores the potential of LLMs in ASD diagnosis, addressing the limitations of current methods and computer-assisted tools. We propose an evaluation framework called ADOS-Copilot, to enhance LLMs' performance in real-world diagnostic scenarios. Experimental results show that ADOS-Copilot is competitive with doctors' diagnoses, providing evidence-based assessments. Also our findings have significant implications for ASD diagnosis and the broader field of mental health disorders."}, {"title": "Limitations.", "content": "To facilitate future work, we point out several limitations of our framework. First, it can only be improved by modifying the prompts, unlike doctors who can learn and adapt from their experiences. The framework's ability to comprehend and reason with long contexts may not translate to a deep understanding of children's developmental levels, crucial for accurate ASD assessment. The quality of ASR impacts the later processing of diagnostic data, and ASR transcriptions can lose information such as tone and emotion, important for ASD diagnosis. Lastly and most importantly, the framework only uses textual data from ASR transcriptions, but ASD diagnosis is a multi-modal task, involving the assessment of a child's behavior, social interaction, and communication."}, {"title": "ALLMi", "content": "ALLMi =  exp(-MAELLMi) / (exp(-MAELLMi) + exp(-MAERulei)),"}, {"title": "Rulei", "content": "Rulei = 1 - ALLMi."}, {"title": "\u0177i", "content": "\u0177i = QLLMi\u00b7\u0192LLMi(x) + RuleifRulei(X)."}]}