{"title": "Deep Learning for THz Channel Estimation and Beamforming Prediction via Sub-6GHz Channel", "authors": ["Sagnik Bhattacharya", "Abhishek K. Gupta"], "abstract": "An efficient channel estimation is of vital importance to help THz communication systems achieve their full potential. Conventional uplink channel estimation methods, such as least square estimation, are practically inefficient for THz systems because of their large computation overhead. In this paper, we propose an efficient convolutional neural network (CNN) based THz channel estimator that estimates the THz channel factors using uplink sub-6GHz channel. Further, we use the estimated THz channel factors to predict the optimal beamformer from a pre-given codebook, using a dense neural network. We not only get rid of the overhead associated with the conventional methods, but also achieve near-optimal spectral efficiency rates using the proposed beamformer predictor. The proposed method also outperforms deep learning based beamformer predictors accepting THz channel matrices as input, thus proving the validity and efficiency of our sub-6GHz based approach.", "sections": [{"title": "I. INTRODUCTION", "content": "The ever increasing need for reliable communication with low latency and high data rates has pushed modern communication systems to utilize the mmWave spectrum [1], [2]. Despite their unfavourable propagation and blockage penetration characteristics, current developments in device and antenna technologies have made mmWave communication feasible, thus obtaining the required low latency and Gb/s data rates. As we move towards further-advanced wireless applications, e.g. augmented reality, and ultra-low latency video conferencing with even the Gb/s rates provided by the mmWaves falling short of the requirement, the use of THz spectrum (0.1THz-10THz) for communication is inevitable.\nTHz channels suffer from an exponential pathloss decay due to severe atmospheric attenuation, along with high blockage and penetration losses [1], [3]. Hence, systems operating in the THz spectrum would require highly dense base station (BS) deployments. THz channels need to be highly directional in nature to compensate for the high pathloss decay, and thus require extensive beamforming with large antenna arrays at transmitter and/or receiver side(s). For such large antenna arrays, fully digital beamforming no longer remains as option, due to its high computational complexity and high power consumption [1], [3]. Therefore, analog beamforming and hybrid beamforming are proposed as viable solutions [1], [4]. While these highly directional \u201cpencil beams\" improve the signal strength at the intended receiver, they often suffer from huge latency and overhead due to beam training. Not only is an accurate estimate of the THz channel required in real time, but an efficient method of choosing the optimal beamformer also needs to be devised.\nFor all the reasons mentioned above, it is of fundamental im-portance to have a reasonably accurate estimation of the THz channel in real time. Conventional THz channel estimation methods include applying optimization such as least squared (LS) estimation, linear minimum mean squared estimation (LMMSE), etc. with the help of uplink pilot signals. But, owing to the long antenna array lengths, these estimation methods often require a large number of pilot signals. As discussed in [5], these methods also involve several computationally expensive matrix operations, e.g. matrix inversion, eigenvalue decomposition, singular value decomposition, etc. Compres-sive sensing methods have been applied for THz channel estimation [6], [7]. Although they reduce the time complexity compared to conventional methods, they still have significant overhead, especially considering real-time applications. Sub-6GHz channel, unlike THz channel, can be estimated with relatively low overhead, and a smaller number of uplink pilot signals. This motivates us to explore the use of the estimated sub-6GHz channel to predict the THz channel. The success of deep learning in mapping intractable functions in a time efficient manner has led to their manifold applications in wireless networks [8]\u2013[10]. In [11], authors use deep learning to predict the optimal beamformer for mmWave communica-tion, from the estimated sub-6GHz channel. In [5], they use various ambient factors to predict the mmWave channel state information, via a CNN.\nIn this paper, we first show that there exists a mapping from the sub-6GHz channel to the THz channel factors (pathloss, angle of arrival, time of arrival, etc. for each of the channel paths). We then propose a CNN based algorithm to estimate the THz channel factors from uplink sub-6GHz channel in-formation. The obtained channel factors can be directly used for various applications such as optimal beamformer selection, blockage prediction, etc. In this paper, we design a deep learning algorithm to directly predict the optimal beamformer by taking the CNN estimated THz channel factors as input, eliminating the overhead of obtaining the THz channel matrix. The algorithm not only achieves near-optimal spectral effi-ciency rates in a time efficient manner, but also outperforms a"}, {"title": "II. SYSTEM MODEL", "content": "In this paper, we consider a dual band network where each BS comprises two transceivers: one operating at sub-6GHz frequency with $N_s$ antennas and the other operating at THz frequency having $N_T$ antennas (See Fig. 1). For the assumption regarding the mapping from sub-6GHz channel to THz channel factors that we make later, it is required that the two transceivers are approximately colocated. The user, as-sumed to be a mobile device, again comprises two transceivers, corresponding to the sub-6GHz and THz frequencies, having one antenna each. We consider an OFDM system having $K$ subcarriers. The number of sub-6GHz antennas $N_s$ being less in number, fully digital beamforming can be employed, allowing baseband channel estimation for sub-6GHz channel. The uplink signal data is transmitted from the user to the BS via the sub-6GHz channel. Thus, at the kth subcarrier, for $k = 1,2,..., K$, the uplink received signal is\n$y_s[k] = h_s[k] x_s[k] + n_s[k]$\nwhere $y_s[k]$ is the received uplink symbol vector, $h_s[k] \\in \\mathbb{C}^{N_s \\times 1}$ is the sub-6GHz channel vector from the user to the BS for the kth subcarrier, $x_s[k]$ is the input symbol, and $n_s[k]$ is the received noise vector at the output which follows $\\mathcal{N}_c(0, \\sigma_n^2I)$. As for the downlink THz transmission, owing to the large number of antennas which makes digital beamform-ing computationally prohibtive and power consuming, a fully analog beamforming is adopted, with a single RF chain and $N_T$ phase shifters. The phase shifters are quantized because of hardware constraints. Thus there is a finite set of possible beamformers, collected in the codebook $\\mathcal{P}$, each of whose elements is a candidate beamformer $p \\in \\mathbb{C}^{N_T \\times 1}$. Hence the downlink system model is\n$y_T = h_T^\\mathrm{H}px_T + n_T$\nwhere $y_T$ is the received output symbol at the receiver, $h_T \\in \\mathbb{C}^{N_T \\times 1}$ is the THz channel vector from the user to the BS, p is the chosen beamformer from the codebook $\\mathcal{P}$, $x_T$ is the transmit symbol, and $n_T$ is the noise at the output following $\\mathcal{N}_c(0, \\sigma_T^2I)$."}, {"title": "III. CHANNEL MODEL", "content": "While THz waves show propagation characteristics similar to mmWaves, they stand out in terms of the significant molec-ular absorption even in the free space propagation scenario [1]. Thus, as explained in [1], an additional exponential term needs to be added in the pathloss equation along with the power law term. Thus for an LOS signal,\n$P_r = P_t \\lambda'(r)$\nwhere r is the distance, $A(r)$ is the power law pathloss, and $\\delta(r)$ is the exponential term due to molecular absorption. We consider the combined pathloss $\\lambda'(r) = \\lambda(r)\\delta(r)$ as one of the THz channel factors to be estimated.\nAs in [3], considering the Doppler shifts of all the paths to be significantly small, we adopt a geometric channel model for both the sub-6GHz and the THz channels. Therefore the channel model, for sub-6GHz channel, for the kth subcarrier, is given by\n$h_s[k] = \\sum_{c=0}^{C-1} \\sum_{m=0}^{M-1} \\lambda_c e^{-j 2 \\pi k f_c \\tau_m} a_r(\\phi_r, \\theta_r) a_t(\\phi_t, \\theta_t)$\nwhere $C$ is the cyclic prefix length, $M$ is the number of paths, $\\lambda_c$ is the path gain, including the effective pathloss as explained above, $\\phi_r$ and $\\theta_r$ are the azimuth and elevation angles of arrival respectively, $\\phi_t$ and $\\theta_t$ are the azimuth and elevation angles of departure respectively, $a_r$ and $a_t$ are the receive and transmit beamsteering vectors respectively. The THz counterpart of (4) is obtained by replacing the components of the equation with their THz channel factor counterparts. For the rest of the paper, whenever we mention channel factors, we mean the pathloss, phase change on arrival, time of arrival, angles of arrival and departure of each of the channel paths between a user and a BS. Thus, as computed in (4), given these channel factors for every channel path, the channel is determined completely."}, {"title": "IV. THZ CHANNEL FACTORS ESTIMATION", "content": "Assumption 1: The mapping f from the channel factors to the channel matrix is bijective under suitable conditions.\nIn (4), it is shown that given the channel factors for every channel path, the channel matrix is determined completely. We assume that for a fixed antenna array, and surrounding environment conditions, no two set of non-identical channel factors can lead to the same channel matrix. Although this assumption depends on the environment conditions, user and BS antenna array length, array geometry, and static/dynamic characteristics, for all practical purposes, a sufficiently large number of antennas in a static environment are sufficient to ensure the bijectivity. Thus, we define the inverse function, i.e. the function from the channel matrix $h_T$ to the channel factors $S_T = [\\lambda_i, \\tau, \\theta, \\phi_r, \\theta_r, \\phi_T, \\theta_t]$, where the elements of the vector indicate the pathloss, time of arrival, phase change on arrival, azimuth and elevation angles of arrival and departure, respectively. Therefore\n$f^{-1} : h_T\\rightarrow S_T$\nwhere $h_T \\in \\mathbb{C}^{K \\times N_T}$, and $S_T \\in \\mathbb{R}^{7 \\times 1}$.\nIn [12], it was shown that under certain conditions, there exists a bijective mapping from the channel between a user and a set of antennas at a particular frequency to the channel at a different frequency. Hence, given the user and the BS antennas, for the same environment and propagation conditions, there exists a function g such that\n$g: h_s \\rightarrow h_T$\nEquations (5) and (6) combinedly show that there exists a mapping between the sub-6GHz channel and the THz channel factors under suitable conditions.\nThe above statement is exploited to derive the THz channel factors directly from the sub-6GHz channel matrix. We then use the estimated channel factors directly for a beamforming application without resorting to channel matrix computation. CNNs are extremely successful in extracting important spatial features from raw data, without requiring explicit handcrafted features. We use a CNN based network for THz channel fac-tors estimation; this not only generates highly accurate results but also gets rid of the computational overhead associated with THz uplink based channel estimation by conventional methods, and subsequent beam training. The complete CNN based algorithm is as follows:"}, {"title": "V. BEAMFORMING WITH ESTIMATED THZ CHANNEL FACTORS", "content": "We use the CNN predicted THz channel factors directly for a beamforming application. Given the sub-6GHz channel matrix information, we predict the optimal beamformer from a pre-provided codebook for downlink THz data transmission. We again use a dense neural network architecture for this classification problem (choosing the optimal beamformer from the series of available ones).\nInput and Output : The input comprises the estimated channel factors from the aforementioned CNN, i.e. the input is $S_T$. The output is a number representing the index of the beamformer to be chosen from the given codebook. This is a categorical classification problem in its essence.\nTraining Phase : During the training phase, the THz raytrac-ing data is obtained in the form of channel factors $S_T$, which is then used to compute $h_T$. Then we perform an extensive beam training by checking the gain associated with each candidate beamformer p in the codebook $\\mathcal{P}$. In particular, we choose the candidate beamformer p such that\n$p^* = arg \\max_{p\\in \\mathcal{P}} \\sum_{k=1}^{K} \\log_2 (1 + SNR \\| h_T^H[k] p \\|^2)$\nwhere SNR is the pre-specified per-subcarrier transmit signal to noise ratio. Hence, we get our neural network samples as $(S_T, p_{ind})$, where $p_{ind}$ is the categorical variable representing the index of beamformer p in codebook $\\mathcal{P}$.\nAlgorithm Deployment Phase: In the deployment phase, the estimated THz channel factors $S_T$ from the CNN are provided as input to the network, which gives the categorical variable $p_{ind}$ representing the index of the optimal beamformer from the codebook $\\mathcal{P}$."}, {"title": "VI. PERFORMANCE EVALUATION", "content": "Table II shows the parameters for the raytracing scenario generated using MATLAB raytrace command from the Com-munications Toolbox. Appropriate cloud and fog propagation models are added to the shooting and bouncing rays (sbr) ray-tracing method, to simulate the harsh atmospheric attenuation of THz waves. We choose a rectangular block of dimensions approximately (400m \u00d7 30m) in an outdoor environment, specifically the S Clarke St. of Chicago downtown area. The BS is at one of the boundaries of the rectangle and the 100,000 users are distributed randomly inside the block. The BS sub-6GHz antenna array length is taken as 4, while the THz array length is 128. We also limit the maximum number of paths from the BS to a particular user to be 8 in case of sub-6GHz case, and 4 in case of THz.\nThe input to the THz factors estimation CNN is the mod-ified sub-6GHz channel matrix $h_s \\in \\mathbb{C}^{64 \\times 4 \\times 2}$ (explained in Section IV), generated from the uplink sub-6GHz raytracing data. The output of the CNN is $S_T \\in \\mathbb{R}^{8 \\times 7}$. As examples, Fig. 3 shows our algorithm's prediction of the azimuth angle of arrival (AoA) and the time of arrival (ToA) of the first THz channel path, for all users. We see that the CNN is successful in predicting values close to the ground truth factors. Table III shows the mean and standard deviation errors of our algorithm's THz channel factors predictions. We obtain less than 6 degree mean error on our estimates of AoA and AoD, and phase angle on arrival. Our mean errors for the ToA and Pathloss predictions are $3.80 \\times 10^{-18}s$ and $5.70 \\times 10^{-19}$ respectively, making our estimator highly accurate.\nFor the beam prediction network, as shown in Fig. 2, the estimated THz channel factors are provided as input. The output is the optimal beamformer index from the codebook containing 128 \u00d7 4 \u00d7 4 = 2048 (quantization of phase angles along X, Y and Z axes respectively) candidate beamformers.\nFor comparison of our algorithm, we also obtain the predicted beamformer using the baseline algorithm, as explained in Section V. Fig. 4 shows the spectral efficiency obtained by our beamformer predictor compared to the baseline. The spectral efficiency values are derived from (7). The top-3 beams are obtained by taking the three maximum probability outputs of the softmax function at the last layer of the dense neural network as in Fig. 2. The figure contains the spectral efficiency for the top-1 predicted beam, and also the average spectral efficiency of the top-3 predicted beams. We see that our top-3 predictor achieves close to optimal (UB) rates across a wide range of SNR values (-17dB to 25dB), and our top-1 predic-tor outperforms the top-1 and top-3 baseline predictors. The baseline THz based beamformer prediction is computationally expensive because of the larger sized (64 \u00d7 128 \u00d7 2) channel matrix input. It is also underperforming than our sub-6GHz based predictor, because of the severe attenuation of THz signals which renders the estimated THz channel matrix highly noisy and not suitable for good learning."}, {"title": "VII. CONCLUSION", "content": "In this paper, we implement a CNN based algorithm to es-timate the THz channel factors from sub-6GHz channel input. We have then also designed a dense neural network to predict the optimal THz analog beamformer, using the CNN estimated THz channel factors. We show that our algorithm delivers better performance than direct THz uplink channel based deep learning approach, alongside being computationally cheaper. Our beamformer also achieves near-optimal spectral efficiency rates across a diverse range of transmit SNR values. The estimated THz factors can be directly used for a plethora of deep learning based THz applications, which form interesting topics for future research."}]}