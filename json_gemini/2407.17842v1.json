{"title": "On the Opportunities of (Re)-Exploring Atmospheric Science by Foundation Models: A Case Study", "authors": ["Lujia Zhang", "Hanzhe Cui", "Yurong Song", "Chenyue Li", "Binhang Yuan", "Mengqian Lu"], "abstract": "Most state-of-the-art AI applications in atmospheric science are based on classic deep learning approaches. However, such approaches cannot automatically integrate multiple complicated procedures to construct an intelligent agent, since each functionality is enabled by a separate model learned from independent climate datasets. The emergence of foundation models, especially multimodal foundation models, with their ability to process heterogeneous input data and execute complex tasks, offers a substantial opportunity to overcome this challenge. In this report, we want to explore a central question-how the state-of-the-art foundation model, i.e., GPT-4o, performs various atmospheric scientific tasks. Toward this end, we conduct a case study by categorizing the tasks into four main classes, including climate data processing, physical diagnosis, forecast and prediction, and adaptation and mitigation. For each task, we comprehensively evaluate the GPT-40's performance along with a concrete discussion. We hope that this report may shed new light on future AI applications and research in atmospheric science.", "sections": [{"title": "1 Introduction", "content": "The applications of artificial intelligence (AI) in atmospheric science have led to exciting and promising advances [1]. Different machine learning approaches have been applied in various tasks, including precipitation nowcasting [2], short- to medium-range weather prediction [3, 4], long-term climate pattern forecasting [5, 6], parameterization of atmospheric radiative transfer [7], and etc. Additionally, AI techniques have been instrumental in improving the accuracy of numerical modeling and enhancing the understanding of complex atmospheric processes [8, 9]. These advances illustrate the transformative potential of AI in atmospheric science, paving the way for more resilient and informed responses to climate challenges.\nMost of the current applications of AI in atmospheric science rely on classic deep learning approaches, which typically consider separated datasets for specific problems, forcing the model to learn limited explicit or implicit statistical properties from these potentially homogeneous datasets [1]. However, practical deployment of climate-related workflow often requires careful integration of multiple complicated procedures, where an ideal AI agent should be capable of processing heterogeneous input data and integrating a series of sophisticated reasoning procedures. Such requirements go beyond the scope of classic supervised or semi-supervised machine learning techniques \u2014 addressing these challenges calls for the application of more advanced AI techniques that can dynamically\n*Equal contributions as first authors. Listing order is random."}, {"title": null, "content": "adapt to diverse data types and execute complex, multi-step analytical tasks, thereby enhancing the robustness and applicability of AI in real-world atmospheric science scenarios.\nRecently, foundation models [10] such as GPT-4 [11], Gemini [12], Llama3 [13], and Mixtral [14] have essentially revolutionized the way state-of-the-art AI applications are developed and deployed. The advancement of multimodal foundation models (FMs) [15], such as GPT-40 [16], Claude [17] and Yi-VL [18] has further enhanced the ability of AI to process and understand information from diverse sources, such as text, time series, images, and videos. By integrating multiple representations of input data, these models achieve a more comprehensive understanding and generate more accurate and contextually relevant responses. This capability is particularly beneficial in fields requiring complex data interpretation, such as atmospheric science, where multi-modal FMs can seamlessly combine meteorological data, including satellite imagery, multiscale temperature or precipitation time series, and textual instructions to enable accurate weather predictions and complicated climate analysis. Thus, we tend to expect that this great technique could create substantial new opportunities in atmospheric science based on the FM's capability to integrate complex multimodal heterogeneous inputs and perform advanced reasoning. Toward this end, we want to explore how the state-of-the-art foundation model, i.e., GPT-40, performs various tasks within the field of atmospheric science.\nWe answer this question by conducting a case study that explores the potential of state-of-the-art multi-modal FM to solve various climate tasks. Specifically, we categorize the tasks into four main classes to evaluate the performance of multi-modal FM comprehensively (Figure 1):\n\u2022 Climate data processing. Efficient processing of observational and modeling data is crucial for atmospheric scientific workflows. Tasks range from simple data extraction to advanced techniques like long-term trend calculation, linear regression coefficients, empirical orthogonal function (EOF) analysis, and K-means clustering, which require proficiency in various programming languages and consume significant research time. Delegating these tasks to the FM with strong mathematical reasoning and programming skills can greatly reduce scientists' workloads, allowing them to focus more on scientific inquiries.\n\u2022 Physical diagnosis. Physical diagnosis in atmospheric science involves the analysis and interpreta-tion of data to understand weather patterns, climate systems, and atmospheric processes, which leverage observational data, theoretical knowledge, and computational models to diagnose the atmosphere's state and behavior. An AI agent with a deep understanding of atmospheric dynamics"}, {"title": null, "content": "and thermodynamics can greatly assist weather forecasters by handling extensive post-processing of weather maps, identifying potential outcomes of anomalous weather variables, and diagnosing extreme weather events. The ability of FM to handle basic statistical modeling, quantify relation-ships, predict future conditions, etc., can provide valuable support to atmospheric scientists in both research and operational tasks.\n\u2022 Forecast and prediction. Predictions of future weather and climate states on various time scales are central to atmospheric science [19]. Short-term forecasts of imminent weather hazards are crucial to preventing property loss and ensuring human safety. Longer-term forecasts, such as subseasonal-to-seasonal and beyond, provide valuable information to policymakers to manage potential droughts or floods, helping to develop agricultural and engineering strategies [20].\n\u2022 Adaptation and mitigation. Atmospheric science plays a crucial role in developing strategies to adapt and mitigate the impacts of climate change. Natural disasters such as typhoons and extreme rainfall have increased, causing significant damage. Human activities, such as carbon dioxide and air pollutant emissions, have worsened the greenhouse effect and air quality, causing further harm. Governments must formulate effective policies to mitigate natural disasters, prevent economic and population losses, ensure timely post-disaster recovery, and reduce air pollution and greenhouse gas emissions.\nIn the rest of this report, we enumerate the case study output on each of the above tasks - Section 2 on climate data processing, Section 3 on physical diagnosis, Section 4 on forecast and prediction, and Section 5 on climate adaptation and mitigation. Related works is shown in Section 6. At last, we conclude and discuss the results in Section 7."}, {"title": "2 Climate Data Processing", "content": "The rapid development of atmospheric science has greatly benefited from the acquisition of massive amounts of data derived from various observation methods, like satellites, radar, ground stations, etc. This section aims to evaluate the capability of GPT-40 in assisting with three selected data processing tasks. Specifically, the accurate extraction of data, the correct execution of common calculations, and the application of typical algorithms are assessed in the following subsections."}, {"title": "2.1 Information Extraction", "content": "We begin by testing whether the latest version of GPT, GPT-40, can read a commonly used file format in atmospheric science, netCDF4, and accurately extract the necessary information.\nTask inputs. We provide the sea surface temperature data for May 1, 2024, sourced from ERA5, along with the shapefile for the subpolar gyre (Figure 2) along with the prompt:"}, {"title": "2.2 Statistical Calculation", "content": "It is an essential procedure for researchers to rely on various statistical calculations to obtain results. In this part, we specialize this type of task for GPT-40 to calculate the trend of sea surface temperature from 2001 to 2020.\nTask inputs. Similar to the previous task, we provide GPT-40 with netCDF4 data containing annual sea surface temperature values from 2001 to 2020 and instruct it to calculate the annual trend for each grid along with the prompt:"}, {"title": "2.3 Classical Algorithm", "content": "We proceed to test whether GPT-40 could perform more advanced calculation, like the EOF analysis, which is a very classical and widely used algorithm in atmospheric science.\nTask inputs. We utilize the monthly sea level pressure from 1980 to 2019 within the region 30\u00b0N-80\u00b0N, 80\u00b0E-130\u00b0W for the EOF test along with the prompt:"}, {"title": "3 Physical Diagnosis", "content": "Physical diagnosis is an important part of understanding the underlying phenomena and mechanisms behind atmospheric data and aids in further forecasting and prediction. This section aims to evaluate the capability of GPT-4o in assisting with three selected physical diagnosis tasks. Specifically, extreme weather detection, inference from meteorological variable fields, and statistical modeling are assessed in the following subsections. Traditional manual interpretation of weather maps for judgment is labor-intensive and time-consuming, and it is prone to omissions. Considering these"}, {"title": "3.1 Extreme Weather Detection", "content": "Identifying extreme weather events, such as heavy rainfall, tropical cyclones, and heatwaves, is crucial for conducting hazard assessments, risk analysis, and tracking the rapid development of hazards. In this test, we utilize the total precipitation netCDF4 file from July 20, 2021, for the East Asia region.\nTask inputs. We provide the precipitation data for July 20, 2021, sourced from ERA5, along with the prompt:"}, {"title": "3.2 Inference from Meteorological Variable Fields", "content": "Meteorological variable fields, such as temperature, precipitation, pressure, and wind, provide critical information about the state of the atmosphere. This information can help diagnose the mechanisms leading to extreme weather events. In this section, we upload the data containing weather maps (Figure 6), including precipitation, humidity, 850 hPa horizontal wind, and geopotential height, along with the prompt to analyze the extreme precipitation detected in Section 3.1:"}, {"title": "3.3 Statistical Modeling", "content": "Multiple linear regression is a valuable tool for diagnosing sources of variability in atmospheric science. Linear regression models built with predictor variables can explain a significant portion of the variance in the target variable.\nTask inputs. We upload the time series of meteorological data to develop a regression model to predict the annual precipitation anomaly percentage along with the prompt:"}, {"title": "4 Forecast and Prediction", "content": "In this section, we evaluate the capabilities of GPT-4o in short-lead and long-lead prediction and forecasting, a task of critical importance especially in recent years. The increasing frequency of extreme weather events has resulted in significant losses for many countries and regions, highlighting the need for accurate predictions to support disaster prevention and policy development. Additionally, signals indicative of climate change, such as the prediction of El Ni\u00f1o-Southern Oscillation (ENSO), can provide insights into long-term climate variations, thus improving our understanding of their causes."}, {"title": "4.1 Short-term Temperature Prediction", "content": "To assess the capability of GPT-40 in short-lead temperature forecasting, we conducted a comprehen-sive evaluation using meteorological data from May 1, 2024.\nTask inputs. The dataset included both surface and upper-level atmospheric variables: mean sea level pressure, 2-meter temperature, 10-meter U wind component, 10-meter V wind component, and at 13 upper atmospheric levels: specific humidity, temperature, U wind component, V wind component, and geopotential height. These variables are identical to those used in the Pangu-Weather model [3]. We instructed GPT-40 to forecast global temperatures for 24, 48, 72, and 96-hour intervals along with the prompt:"}, {"title": "4.2 Subseasonal-to-Seasonal Precipitation Prediction", "content": "A forecast gap exists in the Subseasonal-to-Seasonal timescale, explicitly defined as the transitional period of 10 to 30 days between weather predictions and seasonal outlooks [21]. Accurate prediction of precipitation on this timescale is critical for decision-makers to adaptively adjust their strategies to mitigate the impacts of natural disasters [22, 23].\nTask inputs. We compile daily precipitation and meteorological variables, including zonal wind, meridional wind, temperature, specific humidity, vertical velocity, and geopotential height at 200, 500, and 850 hPa (19 variables in total), for the region 18\u00b0\u201333\u00b0N, 105\u00b0\u2013122\u00b0E at 1\u00b0 resolution as of May 1, 2024. The data is uploaded to GPT-40 to request the weekly mean precipitation for the periods 1 to 4 weeks following May 1, 2024 along with the prompt:"}, {"title": "4.3 Long-lead ENSO Forecast", "content": "Long-term forecasts are also essential for understanding impactful climate systems, such as ENSO, in advance. Current studies have successfully utilized global ocean data, including sea surface temperature and ocean heat content [5, 6], to predict ENSO events up to two years in advance.\nTask inputs. We attempted to upload sea surface temperature and ocean heat content patterns to GPT-40, but it failed to effectively utilize the information from the global maps. Consequently, we upload the monthly Nino3.4 index from 1981 to 2022 and task GPT-40 with predicting the Nino3.4 index for the twelve months of 2023 with the prompt:"}, {"title": "5 Adaptation and Mitigation", "content": "In this section, our objective is to evaluate GPT-40's capabilities in providing decision-making and planning strategies in the context of climate change. The recent increase in extreme weather events due to climate change has had significant impacts on society. It has become crucial to formulate policies to protect human health, ensure economic stability, and mitigate disaster losses in the face of climate change. Currently, our decision-making and planning processes are often led by government officials. However, they may not always have a profound understanding of the complexities and trends associated with climate change. GPT-40 offers a significant advantage in this area. Therefore, we tested the application of GPT-40 in Urban Planning and Climate Adaptation, Hazard Risk Mitigation and Strategy, and Climate Actions and Sustainable Future."}, {"title": "5.1 Urban Planning and Climate Adaption", "content": "China's Henan Province experienced severe flooding from 17 to 31 July 2021 due to heavy rainfall. Post-flood urban reconstruction and planning are critical for future resilience.\nTask inputs. We provide GPT-40 news reports of the Henan floods along with the prompt:"}, {"title": "5.2 Hazard Risk Mitigation and Strategy", "content": "In 2023, Typhoon Saola caused an estimated HK$3.92 billion (US$500 million) in damages to Hong Kong. The Hong Kong Observatory's decision to issue the No.10 hurricane signal significantly mitigated the impact, underscoring the importance of accurate disaster assessment and forecasting. Typically, the Observatory utilizes both the numerical weather models and AI models to evaluate typhoon intensity for forecasts.\nTask inputs. In this study, we simulated this process by inputting wind field maps output from the Pangu-weather model [3] (Figure 11) into GPT-40 to determine the optimal timing for issuing hurricane signals along with the prompt:"}, {"title": "5.3 Climate Actions and Sustainable Future", "content": "The COVID-19 lockdowns from 2019 to 2020 led to a significant reduction in traffic fluxes in our country, coinciding with a notable decrease in air pollutant concentrations. This raises important questions about how much reduced traffic can lower air pollution, with implications for urban sustainability and air quality policies. It also prompts consideration of whether converting all conventional vehicles to electric vehicles (EVs) in China could substantially reduce pollution.\nTask inputs. We provided GPT-40 with data on changes in traffic fluxes, PM2.5, NO2, and NO2 VCDs from 2019 to 2020 along with the prompt:"}, {"title": "6 Related Work", "content": "The remarkable success of pre-trained foundation models has inspired the research community to investigate the feasibility of developing a universal foundation model to understand weather and climate data, capable of effectively addressing a wide array of related tasks [25].\nDomain-specific FM. The climate science community has been working on developing a set of foundation models based on large-scale spatio-temporal series data to manage complex sequence information efficiently. A primary objective of these time-series FMs is climate forecasting, aiming to match or surpass the performance of traditional numerical weather prediction systems, such as the European Centre for Medium-Range Weather Forecasts' Integrated Forecasting System (ECMWF-IFS) and the high-resolution forecast (ECMWF-HRES). For example, GraphCast [26] outperforms the most accurate operational deterministic systems, including ECMWF-IFS, on 90% of 1380 verification targets, providing improved predictions for severe events such as tropical cyclones and extreme temperatures. FourCastNet [27] matches ECMWF-IFS in short-term forecasting for large-scale variables while exceeding it for small-scale variables, generating week-long forecasts in less than two seconds. Pangu-Weather [28] achieves superior deterministic forecast results across all tested variables compared to ECMWF-IFS, with better accuracy in the tracking of tropical cyclones. FengWu [29] significantly reduces the root mean square error for 10-day lead global z500 predictions and extends the skillful forecast period to 10.75 days, outperforming GraphCast in 80% of reported predictands. Lastly, FuXi [30] extends the lead time for skillful forecasts of z500 and T2M compared to ECMWF-HRES, demonstrating comparable performance to the ECMWF ensemble mean in 15-day forecasts. These advances underscore the potential of domain-specific FMs to improve the accuracy and efficiency of weather forecasting systems.\nGeneral-purpose FM. An alternative approach involves continuous pre-training or fine-tuning general-purpose FMs for climate tasks. For instance, ClimateBert [31], a transformer-based founda-tion model, achieves better performance by reducing error rates in downstream climate text analysis tasks such as text classification, sentiment analysis, and fact-checking, which showcases the versatility of text data foundation models and their potential to integrate AI agents. Another notable example is ClimaX [32], which demonstrates impressive capabilities. The pre-trained ClimaX model can be fine-tuned to address a wide range of climate and weather tasks, achieving exceptional performance on benchmarks for weather forecasting and climate projections. Unlike task-specific climate foun-dation models, ClimaX is trained using lower resolution data but utilizes heterogeneous datasets that encompass various variables, spatio-temporal coverage, and physical groundings. Although its accuracy for short- and medium-term predictions is lower than that of task-specific climate foundation models, ClimaX excels in long-term predictions (greater than 120 hours) in certain scenarios. This highlights the potential of multimodal foundation models, capable of processing heterogeneous data, to advance the application of AI in atmospheric science."}, {"title": "7 Discussion and Conclusion", "content": "In this report, we explore whether advances in foundation model(s) can help scientists address various potentially challenging problems in atmospheric science. Concretely, we evaluate GPT-40 in solving four categories of tasks: climate data processing, physical diagnosis, forecast and prediction, and adaptation and mitigation."}, {"title": null, "content": "The climate data processing task is proposed based on practical daily work and research. The standard process includes loading the input data, calculating the intermediate representation, and utilizing complex and comprehensive algorithms to obtain the final results. Therefore, we designed three corresponding sub-tasks to examine the performance of GPT-40. It is encouraging to see that GPT-40 returns the correct results when given clear prompt instructions. Notice that GPT-40 not only provides synthesized code but also executes the code on its own servers and directly returns the desired results. An issue associated with the current Web interface is the limited size of the uploaded data, which hinders calculations for large amounts of data. We believe that the foundation model(s) could potentially save scientists from writing trivial code and automatically completing the desired calculations in the future.\nThe physical diagnosis task aims to assess the domain-specific knowledge of GPT-40 to perform physical weather diagnostics. We choose one of the most hazardous weather phenomena, extreme precipitation, for detection, attribution, and statistical modeling. In July 2021, Henan province in central China experienced catastrophic flooding due to unprecedented rainfall. Given the precipitation field, the GPT-40 can successfully locate extreme precipitation events and annotate them on the map. GPT-40 also successfully attributes the cause of this precipitation event. One tropical cyclone, named In-Fa, occurred on July 20, 2021, resulting in the transport of a significant amount of moisture inland and is closely related to the Henan 721 flood event. In addition, GPT-40 can establish a regression model as a statistical tool, to link precipitation with other meteorological variables.\nThe forecast and prediction task is designed to address a central problem in atmospheric science: predicting future weather and climate. From short-term to Subseasonal-to-Seasonal and long-term forecasts, GPT-40 appears to lack the ability to independently provide a professional solution for predictions across any timescale. For example, GPT-4o provides the final result using simplistic formulas, incorrect understanding, or over-simplified statistical methods. In this task, we speculate that there is future work worthy of exploring FMs in atmospheric science, such as integrating more academic papers to provide a reasonable understanding of various predictions and forecasts or developing domain-specific LLMs in this field.\nThe adaptation and mitigation task seeks GPT-40's opinions on how one can adapt to and mitigate current and future environmental challenges on Earth. Specifically, we ask GPT-40 to provide suggestions on how cities can avoid severe flood hazards in the future, what measures governments should take to prevent the impacts of incoming tropical cyclones, and whether reduced traffic could help achieve a sustainable future. The GPT-40 output needs to be improved, where the output is too general and lacks a specialized analysis for the given case. This may be due to the lack of specific knowledge required for each type of task, resulting in only coarse understanding and the generation of generalized results. Such answers can serve as a reference but still require expert consideration for specialized insights.\nIn conclusion, we believe that GPT-40's ability to handle tasks involving language, time series, image, and spatiotemporal data provides a good opportunity for scientists to address various problems in atmospheric science. On the other hand, despite the exciting achievements enabled by GPT-40 thus far, there still remains a considerable distance towards artificial general intelligence for atmospheric science."}, {"title": null, "content": "The simplified formula used by GPT-40 is:\n$T_{t+1} = T_t - U \\cdot \\nabla T$\n(2)"}, {"title": null, "content": "Consequently, the original temperature values were adjusted by multiplying them with a specific coefficient. The formula used by GPT-40 is:\n$T_{t+1} = T_t + T_t \\times (\\frac{t}{24} \\times 0.01)$\n(3)"}, {"title": null, "content": "Specifically, the reference formula is:\n$\\frac{\\partial T}{\\partial t} = -U \\cdot \\nabla T$\n(1)"}]}