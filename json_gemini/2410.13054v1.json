{"title": "SYSTEMS WITH SWITCHING CAUSAL RELATIONS: A META-CAUSAL PERSPECTIVE", "authors": ["Moritz Willig", "Tim Nelson Tobiasch", "Florian Peter Busch", "Jonas Seng", "Devendra Singh Dhami", "Kristian Kersting"], "abstract": "Most work on causality in machine learning assumes that causal relationships are driven by a constant underlying process. However, the flexibility of agents' actions or tipping points in the environmental process can change the qualitative dynamics of the system. As a result, new causal relationships may emerge, while existing ones change or disappear, resulting in an altered causal graph. To analyze these qualitative changes on the causal graph, we propose the concept of meta-causal states, which groups classical causal models into clusters based on equivalent qualitative behavior and consolidates specific mechanism parameterizations. We demonstrate how meta-causal states can be inferred from observed agent behavior, and discuss potential methods for disentangling these states from unlabeled data. Finally, we direct our analysis towards the application of a dynamical system, showing that meta-causal states can also emerge from inherent system dynamics, and thus constitute more than a context-dependent framework in which mechanisms emerge only as a result of external factors.", "sections": [{"title": "1 INTRODUCTION", "content": "Structural Causal Models (SCM) have become the de facto formalism in causality by representing causal relations a structural equation models (Pearl (2009); Spirtes et al. (2000)). While SCM are most useful for representing the intricate mechanistic details of systems, it can be challenging to derive the general qualitative behavior that emerges from the interplay of individual equations. Talking about the general type of relation emitted by particular mechanisms generalizes above the narrow computational view and has the ability to inspect causal systems from a more general perspective. Causal graphs can be subject to change whenever novel mechanisms emerge or vanish within a system. Prominently, agents can 'break' the natural unfolding of systems dynamics by forecasting system behavior and preemptively intervening in the course of events. As inherent parts of the environment, agents commonly establish or suppress the emergence of causal connections (Zhang & Bareinboim, 2017; Lee & Bareinboim, 2018; Dasgupta et al., 2019).\nConsider the scenario shown in Fig. 1 (left), where an agent A (with position $A_x$) follows an agent B (with position $B_x$) according to its policy $A_{\\pi}$. We are interested in answering the question \u2018What is the cause of the current position of agent A?\u201d. In general, the observed system can be formalized as follows: $A_x := f_A(B_x,U_A)$ and $B_x := f_B(U_B)$. From a classical causal perspective we observe that $B \\rightarrow A$, since $A_x$ is conditioned on $B_x$ via the equation $f_A$. As a result, we infer that $B_x$ is the cause of A's position. This perspective, only attributes causes within the current state of the system. However, it disregards the causes that lead to the emergence of $f_A$. Only when we take a meta-causal stance and think about how the equation $f_A$ came to be in the first place, we can give the answer that $A$, through its policy $A_{\\pi}$, is the (meta-causal) cause for its own position."}, {"title": "Contributions and Structure", "content": "The contributions of this work are as follows:\n\u2022 To the best of our knowledge, we are the first to formally introduce typing mechanisms that generalize edges in causal graphs, and the first to provide a formalization of meta-causal models (MCM) that are capable of capturing the switching type dynamics of causal mechanisms.\n\u2022 We present an approach to discover the number of meta-causal states in the bivariate case.\n\u2022 We demonstrate that meta-causal models can be more powerful than classical SCM when it comes to expressing qualitative differences within certain system dynamics.\n\u2022 We show how meta-causal analysis can lead to a different root cause attribution than classical causal inference, and is furthermore able to identify causes of mechanistic changes even when no actual change in effect can be observed.\nWe proceed as follows: In Section 2 we describe the necessary basics of Pearlian causality, mediation processes, and typing assumptions. In Sec. 3 we introduce meta-causality by first formalizing meta-causal frames, and the role of types as a generalization to a binary edge representations. Finally we define meta-causal models that are able to capture the qualitative dynamics in SCM behavior. In Sec. 4, we showcase several examples of meta-causal applications. Finally, we discuss connections to related work in Sec. 5 and conclude our findings in Sec. 6."}, {"title": "2 BACKGROUND", "content": "Providing a higher-level perspective on meta-causality touches on a number of existing works that leverage meta-causal ideas, even if not explicitly stated. We will highlight relations of these works in the 'Related Work' of section 5. Here, we continue to provide the necessary concepts on causality, mediation processes and typing, needed for the definitions in our paper:\nCausal Models. A common formalization of causality is provided via Structural Causal Models (SCM; (Spirtes et al., 2000; Pearl, 2009)). An SCM is defined as a tuple $M := (U,V,F, P_U)$, where $U$ is the set of exogenous variables, $V$ is the set of endogenous variables, $F$ is the set of structural equations determining endogenous variables, and $P_U$ is the distribution over exogenous variables $U$. Every endogenous variable $V_i \\in V$ is determined via a structural equation $v_i := f_i(pa(v_i))$ that takes in a set of parent values $pa(v_i)$, consisting of endogenous and exogenous variables, and"}, {"title": "3 META-CAUSALITY", "content": "Meta-Causality is concerned with the general mechanisms that lead to the emergence of causal relations. Usually, the mediating process may be too fine-grained to yield interpretable models. Therefore, we consider a set of variables of interest $X$ derived via $\\phi : S \\rightarrow X$. Here, $\\phi$ could be defined as a summarization or abstraction operation over the state space (Rubenstein et al., 2017; Beckers & Halpern, 2019; Anand et al., 2022; Wahl et al., 2023; Keki\u0107 et al., 2023; Willig et al., 2023). In order to identify the type of causal relations from a mediating process, we need to be able to decide on what constitutes such a type.\nDefinition 1 (Meta-Causal Frame). For a given mediation process $E = (S, \\sigma)$ a meta-causal frame is a tuple $F = (E,X, \\tau,I)$ with:\n\u2022 a type-encoder $\\tau : X_i \\times X \\rightarrow T$ that determines the relationship between the value of a causal variable $X_i$ and the change of another causal variable $X_j = {\\psi : S \\rightarrow X_j}$ with respect to a environmental state space $S$ which we call a type $t \\in T$,\n\u2022 an identification function $I : S \\times X \\times X \\rightarrow T$ with $I(s, X_i, X_j) \\leftrightarrow t := \\tau(\\varphi(s)_i, \\varphi_j \\circ \\sigma)$ that takes a state of the environment and assigns a type for every pair of causal variables $X_i, X_j \\in X$.\nTypes generalize the role of edges in causal graphs. In most classical scenarios, the co-domain $T$ of the type encoder $\\tau$ is chosen to be Boolean, representing the existence or absence of edges. In other cases, different values $t \\in T$ can be understood as particular types of edges, like positive, negative, or the absence of influence. This will help us to distinguish meta-causal states that share the same graph adjacency. The only requirement for $T$ is that it must contain a special value 0, which indicates the total absence of an edge. Meta-causal states now generalize the idea of binary adjacency matrices."}, {"title": "Definition 2 (Meta-Causal State)", "content": "In a meta-causal frame $F = (E, X, \\tau,I)$, a meta-causal state is a matrix $T \\in T^{N\\times N}$. For a given environment state $s \\in S$, the actual meta-causal state $T_s$ has the entries $T_{s,ij} := I(s, X_i, X_j) = \\tau(\\varphi(s)_i, \\varphi_j \\circ \\sigma)$.\nA meta-causal state $T \\in T^{N\\times N}$ represents a graph containing edges $e_{ij}$ of a particular type $t \\in T$. In particular $T_{ij}$ indicates the presence ($T_{ij} \\neq 0$) or absence ($T_{ij} = 0$) of individual edges. Our goal for meta-causal models (MCM) is to capture the dynamics of the underlying model. In particular, we are interested in modeling how different meta-causal states transition into each other. This behavior allows us to model them in a finite-state machine (Moore et al., 1956):\nDefinition 3 (Meta-Causal Model). For a meta-causal frame $F = (E,X,\\sigma,I)$, a meta-causal model is a finite-state machine defined as a tuple $A = (T^{N\\times N}, S, \\delta)$, where the set of meta-causal states $T^{N\\times N}$ is the set of machine states, the set of environment states $S$ is the input alphabet, and $\\delta: T^{N\\times N} \\times S \\rightarrow T^{N\\times N}$ is a transition function.\nUsually, we have the objective to learn the transition function $\\delta$ for an unknown state transition function $\\sigma$. The state transition function $\\delta$ can be approximated as $\\delta(T, s) := I(\\sigma'(T, s), X_i, X_j) = \\tau(\\varphi(s)_i, \\varphi_j \\circ \\sigma'(T, s))$.\nAs standard causal relations emerge from the underlying mediation process, the meta-causal states emerge from different types of causal effects. The transition conditions of the finite-state machine are the configurations of the environment where the quality of some environmental dynamics represented by a type $t \\in T$ changes.\nInferring Meta-Causal States. Even if the state transition function is known, it may be unclear from a single observation which exact meta-causal state led to the generation of a particular observation $S$. This is especially the case when two different meta-causal states can fit similar environmental dynamics. Even in the presence of latent factors (e.g., an agent's internal policy), the current dynamics of a system (e.g., induced by the agent's current policy) can sometimes be inferred from a series of observed environment states. This requires knowledge of the meta-causal dynamics, and is subject to the condition that sequences of observed states uniquely characterize the meta-causal state. Since MCM are defined as finite state machines, the exact condition for identifying the meta-causal state is that observed sequences are homing sequences (Moore et al., 1956). Note that the following example of a game of tag presented below exactly satisfies this condition, where the meta-causal states produce disjunct sets of environment states (\u2018agent A faces agent B', or 'agent B faces agent A'), and thus can be inferred from either a single observation, when movement directions are observed, or two observations, when they need to be inferred from the change in position of two successive observations.\n'Game of Tag' Example. Consider an idealized game of tag between two agents, with a simple causal graph and two different meta-states. In general, we expect agent B to make arbitrary moves that increase its distance to A, while A tries to catch up to B, or vice versa. In essence, this is a cyclic causal relationship between the agents, where both states have the same binary adjacency matrix. Note, however, that the two states differ in the type of relationship that goes from A to B (and B to A). We can use an identification function that analyzes the current behavior of the agents to identify each edge. Since A can tag B, the behavior of the system changes when the directions of the typed arrows are reversed, so that the type of the edges is either 'escaping' or 'chasing'.\nWhile the underlying policy of an agent may not be apparent from observation as an endogenous variable, it can be inferred by observing the agents' actions over time. Knowing the rules of the game, one can assume that the encircling agent faces the other agent and thus moves towards it, while the fleeing agents show the opposite behavior:\n$(t_{A\\rightarrow B} = chasing) \\leftrightarrow (A_{pos} \\cdot (B_{pos} - A_{pos}) > 0)$\nwhere $A_{pos}$ is the velocity vector of agent A (possibly computed from the position of two consecutive time steps); $A_{pos}$ and $B_{pos}$ are the agent positions, and $\\cdot$ is the dot product. Once the edge types are known, the policy can be identified immediately.\nCausal and Anti-Causal Considerations of Meta-Causal States. Assigning meta-causal states to particular system observations can be understood as labeling the individual observations. However, it is generally unclear whether the meta-causal state has an observational or a controlling character"}, {"title": "Role of Contextual Independencies.", "content": "on the system under consideration. One could ask the question whether the system dynamics cause the meta-causal state, whether the meta-causal state causes the system dynamics, (or whether they are actually the same concept), similar to the well-known discussion \"On Causal and Anticausal Learning\" by Sch\u00f6lkopf et al. (2012), but from a meta-causal perspective.\nAt this point in time, we cannot give definitive conditions on how to answer this question, but we present two examples that support either one of two opposing views. First, in Sec. 4.3 we present a scenario of a dynamical system where the structural equations of both meta-causal states are the same, since the system dynamics are governed by its self-referential system dynamics. Intervening on the meta-causal state will therefore have no effect on the underlying structural equations, and thus can have no effect on the actual system dynamics. In such scenarios, the meta-causal is rather a descriptive label and cannot be considered an external conditioning factor. In the following, we discuss the opposite example, where a meta-causal state can be modeled as an external variable conditioning the structural equations.\nChanges in the causal graph are often times attributed to changes in the environment, as for example prominently leveraged in invariant causal prediction of Peters et al. (2016); Heinze-Deml et al. (2018). In general, the effects of a changing causal graph can be attributed to the change in some external factor acting on the system. Under certain circumstances, we can indeed represent meta-causal models via standard SCM conditioned on some external factor $Z \\in Z$. Suppose there is a surjective function $\\psi : Z \\rightarrow T^{N\\times N}$ that can map from the $Z$ to every meta causal state $T$. As a result, one can define a new set of structural equations $f_i := \\O_{i\\in 1..n} f_{ij}^{\\psi(z)}$ and\n$f_{ij}^Z :=\n\\begin{cases}\n\\langle * \\rangle f_{ij}^{\\psi(z)}\n& \\text{if } (\\psi(Z))_{ij} \\neq 0\n0\n& \\text{otherwise}\n\\end{cases}$\nwhere $f_{ij}^{\\psi(z)}$ are the structural equations of the edge $e_{ij}$ that are active under the MCS $T = \\psi(z)$ and (in a slight imprecision in the actual definition) $\\langle * \\rangle$ is the function that carries on the previous function of the concatenation and discards $X_j$. While the 'no-edge' type 0 could be handled like any other type, we have listed it for clarity such that individual variables $X_i$ become contextually independent whenever $(\\psi(Z))_{ij} = 0$."}, {"title": "4 APPLICATIONS", "content": "In this section, we discuss several applications of the meta-causal formalism. First, we revisit the motivational example and consider how meta-causal models can be used to attribute responsibility. Next, we identify the presence of multiple mechanisms for the bivariate case from sets of unlabeled data. Finally, we analyze the emergence of meta-causal states from a dynamical system, highlighting that meta-causal states can be more than simply conditioning the adjacency matrix of graphs on a latent variable. The code used in the experiments is available at https://anonymous.4open.science/r/metaCausal-CRL/.\n4.1 ATTRIBUTING RESPONSIBILITY\nConsider again the motivational example of Figure 1, where an agent A with position $A_x$ follows an agent B with position $B_x$ as dictated by its policy $A_{\\pi}$. Imagine a counterfactual scenario in which we replace the 'following' policy of agent A with, e.g., a 'standing still' policy and find that the $B_x \\rightarrow A_x$ edge vanishes. As a result, we infer the meta-causal mechanism $A_{\\pi} \\rightarrow (B_x \\rightarrow A_x)$ for the system and thus $A_{\\pi}$ as the root cause of for values of $A_x$. In conclusion, we find that, while A is conditioned on B on a low level, the meta-causal reason for the existence of the edge $B \\rightarrow A$ is caused by the $A_{\\pi}$. Both attributions, either tracing back causes through the structural equations $A_x := f(B_x)$ or our meta-causal approach, are valid conclusions in their own regard.\nNote that in this scenario, a classic counterfactual consideration, $A_{A_{\\pi}=standing \\thinspace still} A_{A_{\\pi}=following}$, would also infer an effect of $A_{\\pi}$ on $A_x$ using a purely value-based perspective. Attributing effects via observed changes in variable values is a valid approach, but fails to explain preventative mechanisms. For example, consider the simple scenario where two locks prevent a door from opening. Classical counterfactual analysis would attribute zero effect to the opening of either lock. A"}, {"title": "4.2 DISCOVERING META-CAUSAL STATES IN THE BIVARIATE CASE", "content": "Our goal in this experiment is to recover the number of meta-causal states $K \\in [1..4]$ from data that exists between two variables $X, Y$ that are directly connected by a linear equation with added noise. We assume that each meta-causal state gives rise to a different linear equation $f_k := \\alpha_kX + \\beta_k + \\mathcal{N}, k \\in \\mathbb{N}$, where $\\alpha_k, \\beta_k$ are the slope and intercept of the respective mechanism and $\\mathcal{N}$ is a zero-centered, symmetric, and quasiconvex noise distribution. Without loss of generality, we assume Laplacian noise, for which an L1-regression can estimate the true parameters of the linear equations (Hoyer et al., 2008). The causal direction of the mechanism is randomly chosen between different meta-causal states. The exact sampling parameters and plots of the resulting distributions are given in Sec. C and Fig. 3 in the appendix, respectively. In general, this scenario corresponds to the setting described above of inferring the values of a latent variable $Z$ (with $K = |Z|$) that indicate a particular meta-causal state of the system. Our goal is to recover the number and parameterizations of the causal mechanisms, and as a consequence to be able to reason about which points were generated by which mechanism.\nApproach. The problem we are trying to solve is twofold: first, we are initially unaware of the underlying meta-causal state $t$ that generated a particular data point $(x_i, y_i)$, which prevents us from estimating the parameterization $(\\alpha_k, \\beta_k)$ of the mechanism. Conversely, our lack of knowledge about the mechanism parameterizations $(\\alpha_k, \\beta_k)_{k\\in[1..K]}$ prevents us from assigning class probabilities to the individual data points. Since neither the state assignment nor the mechanism parameterizations are initially known, we perform an Expectation-Maximization (EM; Dempster et al. (1977)) procedure to iteratively estimate and assign the observed data points to the discovered MCS parameterizations. Due to the local convergence properties of the EM algorithm, we further embed it into a locally optimized local random sample consensus approach (LO-RANSAC; Fischler & Bolles (1981); Chum et al. (2003)). RANSAC approaches repeatedly sample initial parameter configurations to avoid local minima, and successively perform several steps of local optimization - here the EM algorithm - to regress the true parameters of the mechanism."}, {"title": "4.3 A META-STATE ANALYSIS ON STRESS-INDUCED FATIGUE", "content": "Stress is a major cause of fatigue and can lead to other long-term health problems (Maisel et al., 2021; Franklin et al., 2012; Dimsdale, 2008; Bremner, 2006). While short-term exposure may be helpful in enhancing individual performance, long-term stress is detrimental and resilience may decline over time (Wang & Saudino, 2011; Maisel et al., 2021). While actual and perceived stress levels (Cohen et al., 1983; Bremner, 2006; Schlotz et al., 2011; Giannakakis et al., 2019) may vary between individuals (Calkins, 1994; Haggerty, 1996), the overall effect remains the same. We want to model such a system as an example. For simplicity, we present an idealized system that is radically reduced to the only factors of external stress, modeling everyday environmental factors, and the self-influencing level of internal/perceived stress."}, {"title": "Role of Latent Conditioning.", "content": "We use an identification function to distinguish between two different modes of operation of a causal mechanism. In particular, we are interested whether the inherent dynamics of the internal stress level are self-reinforcing or self-suppressing. For easier analysis of the system we decompose the dynamics of the internal stress variable into a 'decayed stress' $d$ and 'resulting stress' $s$ computation. The first term are the previous stress levels decayed over time with external factors added. The resulting stress is then the output of a Sigmoidal function (Fig. 2, left) that either reinforces or suppresses the value (Fig. 2,center). The structural equations are defined as follows and we assume that all values lie in the interval of $[0, 1]$:\n$f_d := 0.95 \\operatorname{clip}_{[0,1]} (s' + 0.5 \\times externalStress)$\n$f_s := 1.01(\\frac{1}{1 + \\exp(-15x + 7.5)} - 0.5) + 0.5$\nwhere $s$ and $d$ are the resulting and decayed stress levels, and $s'$ is the previous stress level of $s$.\nWe now define the identification function to be $I := \\operatorname{sign}(f_s)$, where $f_s$ is the second order derivative of the Sigmoidal $f_s$, with either positive or negative effect on the stress level. The described system has two stable modes of dynamics. Note how the second-order inflection point at 0.5 of the Sigmoid acts as a transition point on the behavior of the mechanism. Stress values below 0.5 get suppressed, while values above 0.5 are amplified. Transitions between the two stable states can only be initiated via external stressors. Effectively this results in three possible meta-causal states which are governed via the following transition function:\n$\\sigma: (t,s) \\rightarrow \\begin{cases} [0,1] & with \\alpha := \\operatorname{sign}(f_s) = \\operatorname{sign}(s - 0.5) \\in \\{-1,0,1\\} \\end{cases}$\nWhile being rather simple in setup, this example serves as a good demonstration on how dynamical systems induce meta-causal states that exhibit qualitative different behavior although being governed by the same set of underlying structural equations.\nA key takeaway in this example is that the current meta-causal state persists due to the current stress levels and system dynamics and not due to a chance in the structural equations. As a consequence, the system can not solely be expressed via some external conditioning factors. In contrast to other examples where system dynamics where purely due to the meta-causal state, here the variable values themselves play a vital role in the overall system dynamics. As a result, the stressed state of a person would persist even when the initiating external stressors disappear. Intervening on the meta-causal state of the system is now ill-defined, as both positive and negative reinforcing effects are governed by the same equation. Thus, creating a disparity between the intervened meta-causal state and the systems' identified functional behavior."}, {"title": "5 RELATED WORK", "content": "Causal Transportability and Reinforcement Learning. Meta-causal models cover cases that reduce to conditionally dependent causal graphs due to changing environments (Peters et al., 2016; Heinze-Deml et al., 2018), but also extend beyond that for dynamical systems. In this sense, the work of Talon et al. (2024) takes a meta-causal view by transporting edges of different causal effects between environments. In general, the transportability of causal relations (Zhang & Bareinboim, 2017; Lee & Bareinboim, 2018; Correa et al., 2022) can be thought of as learning identification functions that have identified the general conditions of the underlying processes to transfer certain types of causal effects between environments Sonar et al. (2021); Yu et al. (2024); Brouillard et al. (2022). This has been studied to some extent under the name of meta-reinforcement learning, which attempts to predict causal relations from the observations of environments Sauter et al. (2023); Dasgupta et al. (2019). Generally, transferability has been considered in reinforcement learning, where the efficient use of data is omnipresent and causality provides guarantees regarding the transferability of the observed mechanisms under changing environments (S\u00e6mundsson et al., 2018; Dasgupta et al., 2019; Zeng et al., 2023).\nLarge Language Models (LLMs). Meta-causal representations are an important consideration for LLMs and other foundation models, since these models are typically limited to learning world dynamics from purely observational textual descriptions. In order to reason in a truly causal manner, LLMs need to learn meta-causal models (sometimes referred to as 'world models') that allow them to simulate the implied consequences of interventions (Lampinen et al., 2024; Li et al., 2021; 2022). To the best of our knowledge, Ze\u010devi\u0107 et al. (2023) made the first attempt to define explicit meta-causal models that integrate with the Pearlian causal framework. However, their proposed models are defined purely as adjacency matrix memorization, such that causal reasoning in LLMs is equivalent to knowledge recall: $(X \\dashv Y) \\leftrightarrow (e_{xy} \\in Mem)$. Thus, LLMs would not learn the underlying mediation process and would fail to predict the effects of novel interventions on the causal graph.\nActual Causality, Attribution and Cognition. Our MCM framework can also be used to infer and attribute responsibility (as shown in Sec. 4.1) and therefore touches on the topics of fairness, actual causation (AC) and work on counterfactual reasoning in cognitive science. (Von K\u00fcgelgen et al., 2022; Karimi et al., 2021; Halpern, 2000; 2016; Chockler & Halpern, 2004; Gerstenberg et al., 2014; Gerstenberg, 2024). The similarities extend to how MCM encourage reasoning about the dependence between actual environmental contingencies and qualitative types of causal mechanisms. In this sense, MCM allow for the direct characterization of actual causes of system dynamics types. A rigorous formalization is left open for future work. While AC in combination with classical SCM only describes relationships between causal variable configurations and observable events, there are cases where we can take an MCM and derive an SCM that encodes the meta-causal types with instrumental variables, thus allowing a similar meta-causal analysis within the AC framework."}, {"title": "6 CONCLUSION", "content": "We formally introduced meta-causal models that are able to capture the dynamics of switching causal types of causal graphs and, in many cases, can better express the qualitative behavior of a causal system under consideration. Within MCM typing mechanisms generalize the notion of specific structural equations and abstract away unnecessary details. We presented a first, motivating example of how a classical causal analysis and a meta-causal perspective can attribute different root causes to the same situation. We extended these claims by considering that MCM are still able to capture and attribute changes in the mechanistic behavior of the system, even though no actual change is apparent. As an application, we presented a first approach to recover metacausal states in the bivariate case. Although our experimental results represent only a first preliminary approach, we find that meta-causal models are a powerful tool for modeling, reasoning, and inferring system dynamics. Finally, we have shown how MCM are able to express more information about a dynamical system than a simple conditioning variable in a standard SCM can do.\nLimitations and Future Work. While we have formally introduced meta-causal models, there remain several practical open directions to pursue. First, we have been able to provide examples that illustrate the differences between standard causal, and meta-causal attribution. In particular, the"}, {"title": "APPENDIX FOR \"SYSTEMS WITH SWITCHING CAUSAL RELATIONS: A META-CAUSAL PERSPECTIVE\"", "content": "The appendix is structured as follows:\nIn Sec. A we derive the formula for the theoretical upper bound of the 95% confidence interval. Sec B discusses the sample statistics and convergence results of the applied LO-RANSAC algorithm. Finally, Sec. C discusses the exact parameters of the bivariate meta-causal mechanism data sampling."}, {"title": "A PROBABILITIES FOR SAMPLE COMPUTATION AND UPPER BOUNDS", "content": "Consider a dataset $D \\in \\mathbb{R}^{m\\times 2}$ of $m$ samples over two variables where we want to separate $n$ different functions. We assume that the data distribution contains a uniform number of samples from each function, where each class could be under- or overrepresented by an offset of $d$. Specifically, we assume that each function is represented by $\\frac{(1 \\pm d)|D|}{n}$ samples, i.e., the probability of encountering a particular class X is $\\frac{1-d}{n} < P(X) < \\frac{1+d}{n}$ and $E[P(X)] = \\frac{1}{n}$. To identify all functions between these two variables, we assume linearity and apply EM with R\u00c4NSAC on random pairs of samples (see Section 4.2). By selecting $n$ pairs, there is a chance that one pair is chosen from each function (we will refer to such a set of pairs as a \"correct\" set of samples). In this section, we derive the probability of a correct pair being chosen at random, so that we can estimate how many times pairs need to be sampled to reliably encounter a correct set of samples.\nWe denote S as the event of \"correctly\" sampling all $n$ pairs from all $n$ different functions. If all classes have the same number of samples, the chance of randomly selecting a pair from a new class is $\\frac{1}{n}$ for the first pair of samples, $\\frac{n-1}{n}$ for the second, ... and $\\frac{1}{n}$ for the last; in short:\n$E[P_n(S)] = \\prod_{i=1}^{n} \\frac{1}{n} = \\frac{n!}{n^n} = \\left(\\frac{1}{n}\\right)^n = \\frac{1}{n^n}$         (1)\nIf the data distribution is not perfectly uniform, i.e., $d \\neq 0$, we can also calculate a lower bound for the same probability. Consider two probabilities per sample: the probability of selecting a new class $P_n(S_{new}^l)$ and the probability of selecting a second sample of the same class $P_n(S_{same}^l)$ afterwards. Across all samples, these correspond to $\\prod_{i=1}^n$ and $\\left(\\frac{1}{n}\\right)^{i-1}$ in $E[P_n(S)]$, respectively.\nLet us first consider the probability of selecting a new class. When the first sample is taken, only one new class can be selected (probability of 1). If this sample was taken from the largest class first, the probability that subsequent samples will be taken from new classes decreases, since the space of \"unsampled\" classes is smaller. For this lower bound, we therefore assume that maximally large classes are sampled from as much and as early as possible. According to our assumptions, the largest classes each take up a fraction of $\\frac{1+d}{n}$ of the data. Therefore, the probability of selecting a new class for successive samples has the following probabilities $\\frac{n}{n}, \\frac{n-\\frac{1+d}{n}}{n}, \\frac{n-\\frac{1+d}{n}2}{n}$, ... First, consider the case where $n$ is even. Here, after all the $\\frac{n}{2}$ largest classes have been selected, only the small classes remain. For the last, second to last, ... classes, this probability is represented by $\\frac{n-\\frac{(1-d)}{n}}{n}, \\frac{n-\\frac{(1-d)2}{n}}{n}$. Overall, we get the probability\n$P_n(S_{new}^{l(even)}) \\geq \\prod_{i=0}^{\\frac{n}{2}-1} \\frac{n - \\frac{(1+d) \\cdot (n - i)}{n}}{n} \\cdot \\prod_{i=1}^{\\frac{n}{2}} (\\frac{1-\\frac{(1+d)}{n}}{n})$\nIf n is uneven, an average size class between the largest and smallest classes must be included:\n$P_n(S_{new}^{l(odd)}) \\geq \\left(\\prod_{i=1}^{\\frac{n-1}{2}} \\frac{n - \\frac{(1+d) \\cdot (n - i)}{n}}{n} \\right) \\cdot \\left(\\frac{n - \\frac{(1+d)}{n} \\cdot 0.5}{n} \\right) \\cdot \\left(\\prod_{i=1}^{\\frac{n-1.5}{2}} \\frac{n - \\frac{(1-d)}{n} \\cdot i}{n} \\right)$\nThe probability of selecting a second sample of the same class is easier to calculate. Instead of constant probabilities as in the expectation with $E[P(S)]$, we now have two different probabilities in the even case and three in the odd case. In the even case, we have $\\frac{n}{2}$ large batches and the same number"}, {"title": "of small batches, so the probability of choosing the right"}]}