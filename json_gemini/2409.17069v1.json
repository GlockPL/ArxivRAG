{"title": "The Effect of Perceptual Metrics on Music Representation Learning for Genre Classification", "authors": ["Tashi Namgyal", "Alexander Hepburn", "Raul Santos-Rodriguez", "Valero Laparra", "Jesus Malo"], "abstract": "The subjective quality of natural signals can be approximated with objective perceptual metrics. Designed to approximate the perceptual behaviour of human observers, perceptual metrics often reflect structures found in natural signals and neurological pathways. Models trained with perceptual metrics as loss functions can capture perceptually meaningful features from the structures held within these metrics. We demonstrate that using features extracted from autoencoders trained with perceptual losses can improve performance on music understanding tasks, i.e. genre classification, over using these metrics directly as distances when learning a classifier. This result suggests improved generalisation to novel signals when using perceptual metrics as loss functions for representation learning.", "sections": [{"title": "Introduction", "content": "Deep learning models for music generation and understanding are increasingly being used in deployed systems. Mistakes and unnatural-sounding distortions are unacceptable to consumers and so the process of reliably evaluating the quality of model outputs is important. The gold standard for measuring the quality of generative model outputs is to gather judgements on the perceived quality from a group of human participants. However, this is a slow and expensive process, which would ideally be replaced with objective metrics that correlate well with subjective human judgements. Unfortunately, traditional training objectives such as mean squared error do not correlate strongly with such ratings. Instead, metrics that better match human quality ratings can be designed, perceptual metrics, by taking into account structural information common across natural signals and/or the structure of neurological processes present in human perception. For example, in images, Structural Similarity (SSIM) [16] captures structural information in natural scenes and the Normalized Laplacian Pyramid Distance (NLPD) [7] mimics characteristics of the visual pathway. In addition to using these metrics for evaluation, they can act as loss functions during training. This has been shown to improve the reconstruction of images and audio when"}, {"title": "Perceptual Metrics", "content": "We present two perceptual image metrics, MS-SSIM and NLPD. These are examples of a reference-based paradigm where a degraded signal is compared to a high quality reference, and their distance (or similarity) can be used to measure the perceived quality of the degraded version. While MS-SSIM and NLPD were originally designed to evaluate differences between images, it has been shown that they can be used to evaluate differences in spectrograms obtaining good agreement with human ratings of audio quality [9].\nStructural Similarity (SSIM) calculates statistical features, namely luminance, contrast and structure, between local image patches. The mean and variance of these features are compared between two images to give an overall similarity score. SSIM can be calculated across multiple resolutions to calculate the Multi-Scale Structural Similarity (MS-SSIM) [15], which has a stronger correlation with perceptual judgements from humans.\nNormalized Laplacian Pyramid Distance (NLPD) is a neurologically-inspired distance based on two processes found in the early stages of the visual and auditory pathways, namely linear filtering and local normalisation [11,17]. These processes reduce the redundancy found in natural signals in agreement with the"}, {"title": "Genre Classification", "content": "In this section, we consider the relevance of perceptual features to music understanding, specifically to a genre classification task. We use the GTZAN dataset [13], which contains 1000 samples across 10 genres, with 70 duplicated or distorted signals removed as indicated in [12]. This results in unequal class sizes so we use a weighted F1 score to evaluate class predictions."}, {"title": "Results", "content": "The results for the K-Nearest Neighbours classifier indicate that MSE and 1 - MS-SSIM are more appropriate than NLPD (Table 2) for measuring the distance between samples. We also demonstrate this with confusion matrices (Fig. 3). The NLPD model heavily overpredicts the blues and classical genres while the MSE and 1 MS-SSIM models have more balanced predictions. We see improved results using the latent features obtained from the autoencoders.\nThe metrics perform worse as distances in the KNN classifiers since they rely on low level features of the signal, while the autoencoders trained with them can extract higher level features that may be more directly related to genre. The logistic regression classifiers trained with NLPD and 1-MS-SSIM give higher F1 scores than the model trained with MSE when using the autoencoder features. The classical genre is sufficiently different from the other classes to be predicted well in all cases but the perceptual models give more balanced predictions across the remaining classes (Fig. 4). 1 MS-SSIM performs relatively well in both experiments. However, these results suggest that NLPD is more appropriate"}, {"title": "Conclusion", "content": "Perceptual metrics that are used across different modalities and domains are assumed to capture information about the structure of natural signals. As shown previously, perceptual metrics can be used in lieu of natural data and still be able to reconstruct natural signals at test time [6,10]. Here, we also show that this can lead to improved representations when performing genre classification. We show that perceptual metrics transform signals in different ways and so care should be taken over the choice of metric depending on the task. These perceptual metrics"}]}