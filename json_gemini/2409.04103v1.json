{"title": "The Role of Graph Topology in the Performance of Biomedical Knowledge Graph Completion Models", "authors": ["Alberto Cattaneo", "Stephen Bonner", "Thomas Martynec", "Carlo Luschi", "Ian P. Barrett", "Daniel Justus"], "abstract": "Knowledge Graph Completion has been increasingly adopted as a useful method for several tasks in biomedical research, like drug repurposing or drug-target identification. To that end, a variety of datasets and Knowledge Graph Embedding models has been proposed over the years. However, little is known about the properties that render a dataset useful for a given task and, even though theoretical properties of Knowledge Graph Embedding models are well understood, their practical utility in this field remains controversial. We conduct a comprehensive investigation into the topological properties of publicly available biomedical Knowledge Graphs and establish links to the accuracy observed in real-world applications. By releasing all model predictions and a new suite of analysis tools we invite the community to build upon our work and continue improving the understanding of these crucial applications.", "sections": [{"title": "1. Introduction", "content": "Knowledge Graphs (KGs) have become a powerful way of integrating information about a domain into a single structured representation. KGs represent knowledge as a collection of facts in the form of triples (h,r,t), which make a statement about the relationship r between two entities h and t. In KGs from the biomedical domain, entities are genes, diseases, drugs, or pathways (among others), whilst relations represent biological interactions or associations between them (MacLean, 2021; Bonner et al., 2022a; Zeng et al., 2022). Biomedical KGs have been used to support a variety of tasks within the complex and costly drug discovery process, such as drug repurposing (Bang et al., 2023), identifying synergistic drug combinations (Zitnik et al., 2018) and target discovery (Paliwal et al., 2020). Unlike in other domains, biomedical KGs frequently comprise information from a wide range of conceptual abstraction levels. Edges representing information with a low abstraction level, such as experimentally validated protein-protein interactions (Protein A, interacts, Protein B), are found in the same KG as mid abstraction level edges, such as associations between genes and diseases taken from a genome-wide association study (Gene A, associates, Disease X), and high abstraction level edges, such as human-curated ontology hierarchies (Disease X, subclass of, Disease Y). This makes biomedical KGs uniquely interesting to consider when they are used in combination with Machine Learning algorithms, as models must learn to make predictions across these different abstraction levels simultaneously.\nSince KGs, including biomedical KGs, are typically incomplete, inferring missing triples is a key Machine Learning application - a task known as Knowledge Graph Completion in the literature. Perhaps the most common method of making predictions with KGs involves using Knowledge Graph Embedding (KGE) models, which learn low dimensional representations for all entities and relation types in a KG and combine them through a scoring function to compute the likelihood of a missing edge. In the biomedical domain, Knowledge Graph Completion has been used for a diverse set of tasks including predicting new links between genes and diseases (Paliwal et al., 2020). However, little is known about the practical ability of ML models to leverage topological patterns in the graph in order to make better predictions. An example of such a pattern is composition, where a relation between two entities is inferred by the presence of a shared third entity. In the biomedical domain, this could be the case when a drug is inferred to treat a disease because they share a common gene connection. Ideally, we would like to discover new drug repurposing opportunities by learning from such patterns in the data. Similarly, the inference pattern uses the presence of a certain relation type between an entity pair to infer the presence of a different relation between the same pair, which could be used to discover novel therapeutic gene-disease connections by aggregating multiple evidence types.\nWhile the theoretical implications of these topological pat-"}, {"title": "2. Related Work", "content": "Since the adoption of representation learning for Knowledge Graph Completion, there has been interest in linking predictive performance of models to topological structures in the underlying Knowledge Graphs (Bordes et al., 2013). These structures, taking into account the heterogeneous relation types in KGs, have been split into two categories: edge cardinalities and topological patterns (see Section 3 for the definitions used in this study). Indeed, it has become common for new models to be designed with the capacity of capturing these patterns (Cao et al., 2021; Chao et al., 2021; Sun et al., 2019), working under the assumption that better modelling them will result in improved predictive performance (Jin et al., 2023).\nEdge cardinality patterns group relations based on the cardinalities of their head and tail entity sets. Four cardinality patterns have been proposed: one-to-one, one-to-many, many-to-one, and many-to-many (Bordes et al., 2013; Wang et al., 2014; Yang et al., 2015). On the other hand, topological patterns categorise relationships based on underlying logical principles that define how entities interact. Several such patterns have been proposed, with common examples being symmetric/anti-symmetric, inverse and composition (Sun et al., 2019; Ali et al., 2021). In the literature, it is common to consider these patterns at the level of whole relation types, meaning that all triples with a given relation type must conform to a certain pattern for it to be said to be present.\nWhilst both pattern types are frequently discussed when comparing architectures, quantifying how model predictive performance correlates with them is less common. Existing work has typically been limited in scale, often only performed on a new approach when it is proposed. For example, the original TransE paper investigated the impact of cardinality patterns on model performance, finding that models could more easily predict heads in one-to-many relations and tails in many-to-one relations (Bordes et al., 2013). The DistMult model observed similar results, whilst also measuring the ability of the model to capture composition relations (Yang et al., 2015). TransH was found to be better at capturing symmetric relations (Wang et al., 2014). RotatE"}, {"title": "3. Knowledge Graph Topological Properties", "content": "For a triple (h,r,t) in a KG G we define the head out-degree as the cardinality of the set {t | \u2203r : (h,r,t) \u2208 G} and, analogously, the tail in-degree as the cardinality of {h | \u2203r : (h,r,t) \u2208 G}. We further define the head out-degree of same relation $deg_r(h)$ and the tail in-degree of same relation $deg_r(t)$ as the cardinalities of {t | (h, r,t) \u2208 G} and {\u0125 | (h, r, t) \u2208 G}, respectively.\nThe edge cardinality of a triple (h, r, t) is then defined as follows:\n\nEdge Degree\n\n$deg(h) = 1$\n$deg(h) > 1$\n\n$deg(t) = 1$\none-to-one\nmany-to-one\n\n$deg(t) > 1$\none-to-many\nmany-to-many\n\nWe also define the following edge topological patterns for triples (h, r, t) \u2208 G:\na) (h, r, t) is symmetric \u21d4 h\u2260t and (t, r, h) \u2208 G;\nb) (h,r,t) has inference \u21d4 \u2203r' \u2260 r : (h,r',t) \u2208 G;\nc) (h, r, t) has inverse \u21d4 \u2203r' \u2260 r : (t, r', h) \u2208 G;\nd) (h,r,t) has composition \u2194 \u2203r1, r2 and n \u00a2 {h,t} : (h, r1,n), (n, r2, t) \u2208 G.\nWhile the above cardinalities and topological patterns have an intuitive definition for individual triples, previous studies (Jin et al., 2023; Teneva & Hruschka, 2023; Bordes et al., 2013; Sun et al., 2019) have considered them as properties of relation types as a whole (e.g., relation r is said to be symmetric if \u2200h,t, (h,r,t) \u21d2 (t, r, h)), despite the fact that a given property might be satisfied only by a fraction of the triples of a certain relation. We find that such conceptual"}, {"title": "4. Experimental Setup", "content": "We investigate five public biomedical KGs: Hetionet (Himmelstein et al., 2017), PrimeKG2 (Chandak et al., 2023), PharmKG (Zheng et al., 2021), OpenBioLink (Breit et al., 2020), PharMeBINet (K\u00f6nigs et al., 2022) . We also include the trivia KG FB15k-237 (Toutanova & Chen, 2015) as a baseline, to detect any results unique to the biomedical domain. On all KGs we train four of the most popular KGE models: TransE (Bordes et al., 2013), DistMult (Yang et al., 2015), RotatE (Sun et al., 2019) and TripleRE (Yu et al., 2022). Whilst being all well-established among practitioners (Hu et al., 2020), these models differ in complexity and in the relational patterns they can capture . In particular, TransE and DistMult model the interaction between head entity, relation type and tail entity in quite simple terms. Nevertheless, despite missing certain topological patterns, they remain strong baselines. On the other hand, Rotate and TripleRE are more recent approaches able to capture all four investigated topological patterns. Notice however that the theoretical capability of a scoring function to model a particular edge topological pattern is not per se a guarantee of stronger predictive performance on such edges (Jin et al., 2023). Our experiments are designed to quantify this impact.\nThe training scheme and hyperparameter optimisation details are presented in Appendix B. The results reported in the following sections refer to tail predictions generated on the held out test split, by scoring each (h, r, ?) query against"}, {"title": "5. Results", "content": "We first investigate how prevalent the different topological patterns, as described in Section 3, are in the range of public biomedical KGs we consider. Analysing this, we find that many-to-many is the predominant edge cardinality in all considered KGs, with only scarce occurrence of one-to-one, one-to-many, and many-to-one triples . This is in line with the majority of triples having an head out-degree and tail in-degree larger than one .\nFurthermore, we observe that edge topological patters vary in frequency across the different KGs. While composition is the most prevalent pattern in all examined KGs, other edge topological patters occur at a high frequency in only a subset of KGs. Of note is the lack of inverse edges in all the biomedical KGs, apart from OpenBioLink, highlighting that biomedical knowledge is typically encoded in a directed manner in these graphs"}, {"title": "5.2. Effect of Topological Properties on Model Accuracy", "content": "Overall, we observe a significant variance in mean reciprocal rank (MRR) achieved between the different KGs as well as between KGE models . In an attempt to understand the root cause of this variance, we focus our analysis on the differences in edge cardinalities and topological patterns described in Section 5.1. When only considering the average occurrence of these topological properties per dataset, the data supports no conclusion about the effect on model accuracy of either edge cardinalities  or edge topological patterns. Previous work (e.g., Teneva & Hruschka (2023)) went one step further, classifying relation types based on the predominant edge topological pattern and cardinality and evaluating the model accuracy per relation type. However, this also does not result in a clear connection between topological properties and KGE model accuracy . We hypothesize that this could be due the confounding effects of covariates, such as node degrees and different topological patterns, that are too difficult to disentangle, as these properties are often not homogenous within a given relation type. Therefore, unlike prior work, we dissect the link between topological properties and model accuracy at the level of individual triples to allow for a finer-grained analysis with an improved statistical power and a reduced impact of covariates.\nIndeed, for a given triple, we observe a strong positive correlation between model accuracy and the in-degree of the tail entity as well as a strong negative correlation between model accuracy and the out-degree of the head entity . This is observed even more clearly when considering the degrees of same relation type. In fact, a high in-degree of the tail node in a tail prediction task has been linked to a higher score, therefore increasing the likelihood of the model predicting it, as confirmed in Figure C.5. On the other hand, a high out-degree of same relation of the head node in a query (h, r, ?), implies multiple correct tail entities. Due to the incompleteness of the KG, some of these correct triples might not be present in the graph and thus cannot be filtered out during inference, making the task of predicting the specific entity that is expected by the model more challenging.\nConsequently, in an attempt to adjust for entity degree, we investigate the effect of edge topological patterns within sets of triples binned by head and tail degrees. Overall, we find that the impact of edge topological patterns on model performance is more relevant if the degrees of head and tail entities are small. When this is the case, compositions are"}, {"title": "5.3. Predicting Specific Relation Types", "content": "To apply the analysis conducted in the previous sections to real-world tasks, we focus on the relations between pairs of entity types that are of particular interest to practitioners (Gene-Gene, Drug-Gene and Drug-Disease). We investigate how they are represented in different biomedical KGs, and how these differences affect the predictive performance of KGE models. Statistics for the interactions of the considered entity types are given in Figure C.8, while MRR is plotted in Figure 9.\nOne basic way of characterising the performance of a KGE model is to consider if it can rank entities of the correct type above those of other types when predicting a specific relation (for instance, gene entities when predicting drug-gene interactions) \u2013 a task we refer to as demixing. As displayed in Figure C.9, the trained models tend to consistently predict entities of the correct type, albeit with different levels of accuracy. Interestingly, DistMult often shows worse demixing capabilities than other scoring functions. As a consequence of the generally strong demixing performance, the size of the potential set of tails for a given interaction needs to be taken into consideration when comparing MRR across different datasets and relation types (the smaller the set of candidates, the higher the expected MRR achieved by random ranking).\nGene-Gene. As shown in Figure C.8a, these interactions are characterized by a large number of potential tails and a large head out-degree of same relation (with the exception of PharmKG for the latter), making predictions hard. However, a high MRR is observed for PharmKG and OpenBioLink: this is explained by the fact that, for these datasets only (Figure C.8b), most triples are symmetric (and a significant portion also have inverse/inference edges), with the counterpart likely to have been seen during training (Section 5.2). This also explains the relative ordering of scoring functions for OpenBioLink and PharmKG, with DistMult being the best and TransE the worst.\nDrug-Gene. In Hetionet, PrimeKG and OpenBioLink these, interactions are easier to predict for the models than gene-gene interactions (Figure 9). This is likely due to an overall smaller number of potential tails seen during training and, in the case of PrimeKG, a markedly smaller head out-degree. PharmKG and PharMeBINet do not satisfy either of these properties, and indeed we observe no improvements in MRR."}, {"title": "5.4. Case Study: Effect of Additional Training Data", "content": "Even when focussing on specific interactions that are represented in multiple KGs, a direct comparison of KGE predictive power across different datasets is limited by having to compare different test sets. In the case of Hetionet and PharMeBINet, however, the latter is constructed by augmenting the former with data coming from other biological databases (K\u00f6nigs et al., 2022). One can therefore often connect individual triples in Hetionet to their exact match in the larger PharMeBINet, which opens up the possibility of studying at a more fundamental level the impact of additional training data on the predictive performance of KGE models. This is important to practitioners as they construct the training KG for a specific task, which is usually done by sub-sampling relevant triples from larger (often proprietary) databases (Chandak et al., 2023).\nWe consider eight relation types where we can find a significant number of common triples between the two datasets (statistics are given in Table C.1). We extract 10% of the shared triples of the considered relation type as test set and use all other edges in each graph for training. In the case of Hetionet, in addition to the embedding size selected in Section 5.2 maximizing memory utilization, we also train models with the same embedding size chosen for PharMeBINet, which is generally strictly smaller (Hetionet_max and Hetionet_same in Figure 10; hyperparameters in Table B.1). To further ensure a fair comparison, at test time we restrict predictions to a custom set of candidate tails that is the same for the two datasets, namely the set of entities appearing as tails in shared triples of the given relation type.\nAs shown in Figures 10 and C.10, across all tested relation types there is no indication that the KGE models are able to benefit from the additional data seen when training on the larger PharMeBINet graph. On the contrary, models trained on Hetionet consistently perform better, even when using the same embedding size. Interestingly, the gap in MRR varies strongly across relation types and also across scoring functions, with DistMult showing generally little difference when comparing models trained with the same embedding size, while distance-based scoring functions experience worse degradation. From Table C.1 we notice that the relation types where the MRR gap is more significant tend to have a larger overall head out-degree (and more relation types coming out from head nodes) for triples in"}, {"title": "6. Conclusions", "content": "This paper analyses the topological properties of widely used biomedical KGs and compares the corresponding predictive performance of different KGE models, focussing in particular on link-prediction tasks relevant to practitioners. Deviating from previous studies, we justify the need to look at properties of individual edges when trying to explain results, as pooling at the relation level introduces too much noise to detect any patterns. By going beyond the coarse one/many binary classification typically used for edge cardinality, we find that considering the actual degrees of head and tail nodes gives a stronger predictor explaining model accuracy. Interestingly, similar interpretations apply to both biomedical KGs and the general-domain KG. Edge topological patterns also impact predictive accuracy, especially when entity degrees are small. For such patterns, we observe an improved accuracy when the counterpart edge (e.g., the reverse edge for symmetric triples) has been seen during training. This in turn raises the problem of inconsistent model validation schemes and topological property definitions when comparing results of previous studies on similar datasets. We address this problem by releasing all predictions from our experiments, together with a new toolbox for KG topological analysis. Finally, by performing a case study comparing predictions on common sets of edges shared by different KGs, we show that training on larger graphs, encoding more biomedical data, can unintuitively harm predictive performance. This evidence should encourage a wider discussion on the guiding principles to adopt when constructing the training KG for biomedical tasks \u2013"}]}