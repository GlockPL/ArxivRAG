{"title": "Model-Free Predictive Control: Introductory Algebraic Calculations, and a Comparison with HEOL and ANNs", "authors": ["C\u00e9dric Join", "Emmanuel Delaleau", "Michel Fliess"], "abstract": "Model predictive control (MPC) is a popular control engineering practice, but requires a sound knowledge of the model. Model-free predictive control (MFPC), a burning issue today, also related to reinforcement learning (RL) in AI, is reformulated here via a linear differential equation with constant coefficients, thanks to a new perspective on optimal control combined with recent advances in the field of model-free control. It is replacing Dynamic Programming, the Hamilton-Jacobi-Bellman equation, and Pontryagin's Maximum Principle. The computing burden is low. The implementation is straightforward. Two nonlinear examples, a chemical reactor and a two tank system, are illustrating our approach. A comparison with the HEOL setting, where some expertise of the process model is needed, shows only a slight superiority of the later. A recent identification of the two tank system via a complex ANN architecture might indicate that a full modeling and the corresponding machine learning mechanism are not always necessary neither in control, nor, more generally, in AI.", "sections": [{"title": "1. INTRODUCTION", "content": "Recent advances, with a strong algebraic flavor, in signal processing and time series analysis, have been applied to energy forecasting by Fliess et al. (2018) and Wang et al. (2025). Those forecasts are easier to implement than the current machine-learning approaches which are prominent now in AI. A similar goal is pursued here with model-free predictive control (MFPC), which is a natural extension of model predictive control (MPC), one of the most popular control engineering practice, where the mathematical modeling should be well known (see, e.g., Rawlings et al. (2022)). Our approach to this hot topic may be summarized as follows:\n(1) We use model-free control (MFC) and especially the corresponding ultra-local model in the sense of Fliess and Join (2013, 2022). Those tools have already been exploited several times in investigations about MFPC: Feng et al. (2024), Hegendus et al. (2023), Huo and Li (2025), Khalilzadeh et al. (2021), Lammouchi et al. (2024), Liu et al. (2024), Long et al. (2023), Sun et al. (2023a), Sun et al. (2023b), Xu et al. (2021), Xu et al. (2024), Wang and Wang (2020), Yin et al. (2024b), Yuan et al. (2024), Zhang et al. (2020a), Zhang et al. (2020b), Zhang et al. (2025), Zhou et al. (2022).\n(2) Thanks to a new understanding of optimal control (Join et al. (2024b)) via an algebraic interpretation of controllability (Fliess (1990), Fliess et al. (1995)), we greatly simplify the connection between predictive control and optimization techniques:\n\u2022 On a small time lapse, where a time-varying quantity may be approximated by a constant, the Euler-Lagrange equation, i.e., the fundamental equation of the calculus of variations (see, e.g., Gelfand and Fomin (1963)), becomes an elementary linear ordinary differential equation of order 2, with constant coefficients.\n\u2022 The computing burden is low. The computer implementation is straightforward. It might lead to a dramatic simplification of the connection between predictive control and reinforcement learning (RL), which is today a mainstay (see, e.g., Recht (2019), Adhau et al. (2024), Bertsekas (2024)). It confirms the viewpoint expressed by LeCun (2024): I do favor MPC over RL. I've been making that point since at least 2016. RL requires ridiculously large numbers of trials to learn any new task.\nIf the key condition of a good model knowledge is not met, many studies use various artificial neural network (ANN) architectures to apply efficiently MPC techniques, without the need for MFPC. See, e.g., \u00c5kesson and Toivonen (2006), Nubert et al. (2020), Ren et al. (2022), Salzmann et al. (2023), Adhau et al. (2024), and references therein. The same two tank example used by Adhau et al. (2024) via a recurrent neural network (see, e.g., Aggarwal (2018)) for its modeling is treated here with our ultra-local model of order 1 (Fliess and Join (2013)), and yields, therefore, a trivial implementation. Is this an indication that ANNs do not always provide the best solution?\nThe other example studied is a chemical reactor (Pannochia and Rawlings (2003), Rawlings et al. (2022)), which was introduced in order to study the robustness of MPC with respect to disturbances. In those references, a time-invariant linearized modeling around a setpoint is used. It is therefore assumed that the reactor is always near the setpoint. This most stringent condition is lifted in our approach.\nIn both cases, we are comparing our results with the HEOL approach (Join et al. (2024a)), already used by Delaleau et al. (2025), which is combining flatness-based and model-free controls. Although HEOL requires more process knowledge, its performance is not really superior.\nOur paper is organized as follows. MFPC is introduced in Sect. 2 and HEOL in Sect. 3. Sect. 4.1 considers the chemical reactor. Sect. 4.2 depicts the two tank system. See some concluding remarks in Sect. 5 and some reflections on modeling in AI. The mathematical modelings of the chemical reactor and of the two tank system are given in Appendices A and B for digital simulation purposes."}, {"title": "2. MODEL-FREE PREDICTIVE CONTROL", "content": ""}, {"title": "2.1 Ultra-local model", "content": "With Fliess and Join (2013) consider for simplicity's sake the SISO (single-input single output) ultra-local model or order 1, which is replacing the poorly known plant and disturbance description\n$\\dot{y} = F + \\alpha u$ (1)\nThe control and output variables are respectively u and y. The derivation order of y is 1 like in many concrete situations. $F$ subsumes not only the unknown structure of the system, which most of the time is nonlinear, but also any external disturbance. The constant $\\alpha \\in \\mathbb{R}$ is chosen by the practitioner such that $\\alpha u$ and $\\dot{y}$ are of the same magnitude. Therefore $\\alpha$ does not need to be precisely estimated.\nA data-driven estimation of $F$ in Eq. (1), which is obtained via algebraic manipulations (Fliess and Sira-Ram\u00edrez (2008b)), reads according to Fliess and Join (2013):\n$F_{est}(t) = \\frac{6}{T^3} \\int_{0}^{T} ((T - 2\\sigma)\\dot{y}(t - T + \\sigma) +\\alpha(T - \\sigma)\\sigma u(t - T + \\sigma)) d\\sigma$ (2)"}, {"title": "2.2 Optimization via the Euler-Lagrange equation", "content": "Preliminary calculations. Assume that $F = a$ is a constant in Eq. (1), which corresponds now to an elementary flat system, where y is a flat output. Introduce the Lagrangian, or cost function,\n$L = (y - y_{setpoint})^2 + \\alpha u^2$ (3)\nwhere $y_{setpoint}$ denotes a given setpoint. Eq. (1) yields\n$L = (y - y_{setpoint})^2 + (\\dot{y} - a)^2 \\alpha^{-2}$\nFor the criterion $J = \\int_{t_i}^{t_f} L dt$ the Euler-Lagrange equation (see, e.g., Gelfand and Fomin (1963)) $\\frac{\\partial L}{\\partial y} - \\frac{d}{dt}\\frac{\\partial L}{\\partial \\dot{y}} = 0$ corresponds to a non-homogeneous linear ordinary diffrential equation of 2nd order\n$\\ddot{y} - a^2 y = a^2 y_{setpoint}$ (4)\nAny solution reads\n$y^*(t) = y_{setpoint} + c_1 e^{at} + c_2 e^{-at}, c_1, c_2 \\in \\mathbb{R}$ (5)\nof Eq. (4), which is independent of $\\alpha$, is said to be optimal. The constants $c_1, c_2$ are obtained via the two-point boundary conditions $y(t_i) = y_i, y(t_f) = y_{setpoint}$:\n$c_1 = \\frac{y_i e^{-at_f} - y_{setpoint} e^{-at_f}}{e^{at_i} e^{-at_f} - e^{-at_i} e^{at_f}}$\n$c_2 = \\frac{e^{at_f}(y_i - y_{setpoint})}{e^{at_i} e^{-at_f} - e^{-at_i} e^{at_f}}$\nRemark 2.2. If $\\alpha > 0$, and $t_f = +\\infty$ (infinite time horizon), Eq. (5) becomes $y^*(t) = y_{setpoint} + c_2 e^{-at}$.\nApplication to MFPC. Consider the subdivision $0 < ... < t_k < t_{k+1} < ... < t_f$. On each time lapse $[t_k, t_{k+1}]$ replace $F$ in Eq. (1) by the constant $F_{est}(t_k)$. Start the above optimization procedure again on the time horizon $[t_{k+1}, t_f]$. The criterion and the horizon may be modified if necessary."}, {"title": "3. THE HEOL SETTING", "content": ""}, {"title": "3.1 Tangent linear system", "content": "The calculations may be summarized as follows\n$A_i(u_i, y_1, ..., y^{(\\nu_{i,1})}_1, y_2, ..., y^{\\nu_{i,2}}_2) = 0, i=1,2$\nwhere $A_i$ is an an analytic function of its arguments; $y_1, y_2$ are flat outputs of a flat system (Fliess et al. (1995)) with control variables $u_1, u_2$. Differentiate $A_i$:\n$\\frac{\\partial A_i}{\\partial u_i} du_i + \\sum_{l=1,2} \\frac{\\partial A_i}{\\partial y_l} dy_l + ... + \\frac{\\partial A_i}{\\partial y^{(\\nu_l)}_l} dy^{(\\nu_l)}_l = 0$\nwhere $dy^{(\\nu)} = \\frac{d^{\\nu}}{dt^{\\nu}} dy$. Associate to it the tangent, or variational, linear system, which is time-varying in general,\n$\\frac{\\partial A_i}{\\partial u_i} \\Delta u_i + \\sum_{l=1,2} (\\frac{\\partial A_i}{\\partial y_l} \\Delta y_l + ... + \\frac{\\partial A_i}{\\partial y^{(\\nu_l)}_l} \\frac{d^{\\nu_l}}{dt^{\\nu_l}} \\Delta y_l) = 0$ (6)\n$\\Delta u_i$, (resp. $\\Delta y_i$) is a control (resp. output) variable."}, {"title": "3.2 Homeostat", "content": "Assume that $\\frac{\\partial A_i}{\\partial u_i} \\neq 0$, $i = 1, 2$, in Eq. (6). Then write with Join et al. (2024a) the homeostat\n$\\frac{d}{dt}(\\Delta y_i) = F_i + \\alpha_i \\Delta u_i, i=1,2$ (7)\nwhere\n$\\alpha_i = \\frac{\\frac{\\partial A_i}{\\partial y_i}}{\\frac{\\partial A_i}{\\partial u_i}}$ is not constant in general;\n$F_i$ is not given by the missing terms in Eq. (6), but is data-driven, i.e., it corresponds to model mismatches and disturbances."}, {"title": "3.3 iP controller", "content": "Mimicking Fliess and Join (2013), associate, with Join et al. (2024a), to the homeostat (7) the intelligent proportional (iP) controller\n$\\Delta u_i = - \\frac{F_{i,est} + K_{i,p}\\Delta y_i}{\\alpha_i}, i = 1,2$ (9)\nwhere $K_{i,p} \\in \\mathbb{R}$ is the gain. Combine Eqs. (7) and (9):\n$\\frac{d}{dt}(\\Delta y_i + \\frac{K_{i,p}}{\\alpha_i}) \\Delta y_i = 0$\nThus $\\lim_{t \\rightarrow \\infty} \\Delta y_i \\approx 0$ if, and only if, $K_{i,p} > 0$."}, {"title": "4. COMPUTER EXPERIMENTS", "content": ""}, {"title": "4.1 Chemical reactor", "content": "Ultra-local model There are two control variables in the chemical reactor of Appendix A. We are therefore using twice Eq. (1). For the first (resp. second) ultra-local model, $u = T_c$ (resp. $u = F$), $y = c$ (resp. $y = h$).\nHomeostat for HEOL Eqs. (7) and (A.1) yield\n$\\frac{d}{dt} \\Delta c = F_c - \\frac{2EU k_0 exp(-\\frac{E}{RT}) c}{RC_p \\rho T^2} \\Delta T_c$\nand\n$\\frac{d}{dt} \\Delta h = F_h - \\frac{1}{\\pi r^2} \\Delta u_F$\nSimulations We follow Pannochia and Rawlings (2003) and Rawlings et al. (2022). For the initial operating point, $c(0) = 0.878 kmol/m^3$, $T(0) = 324.5K$, $h(0) = 0.659 m$, $T_c(0) = 300K$, $F(0) = 0.1 m^3/min$. The sampling time for the control variables is 1 min. The total duration is 50 min. On the other hand, to implement Formulae (2) and (8), the sampling time for measurements 0.1 min.\nFor MFPC, set for the first (resp. second) ultra-local model (1) $\\alpha = -0.05$ (resp. $\\alpha = -5$). Following Sect. 2.2, a new optimal trajectory is calculated every minute.\nFor HEOL, set $K = 1$ for the gain in the iP (9). Reference trajectories are deduced from classic B\u00e9zier curves (see, e.g., Rogers (2001)). These curves ensure continuity up to the third order derivative.\nIntroduce the following disturbance: An unmeasured increase of the flow $F$ of 10%. We seek to to maintain the initial operating point for $c$ and $h$:\nThe figures above show a certain superiority of HEOL over MFPC. It should be added, however, that MFPC's results are satisfactory and, above all, require no knowledge of the model or theoretical understanding of its structural properties."}, {"title": "4.2 Two tank system", "content": "Ultra-local system Use Eq. (1), where, according to Appendix B, $y = h_2$.\nHomeostat Eq. (B.1) yields by differentiation:\n$\\dot{h}_2 = \\frac{1}{s_2} (\\frac{k_1}{2\\sqrt{h_1}} \\dot{h}_1 - \\frac{k_2}{2\\sqrt{h_2}} \\dot{h}_2 + \\dot{u})$\nThe corresponding homeostat reads:\n$\\frac{d}{dt} \\Delta h_2 = F + \\frac{1}{s_2} \\Delta u$\nThus $\\alpha = \\frac{1}{s_2}$ is constant."}, {"title": "5. CONCLUSION", "content": "Although the above results on MFPC look promising, most important issues on constraints and stability are missing in this preliminary conference communication. They are now being investigated.\nThe remarkable advances in modern AI often rely on models striving for comprehensiveness, along with their associated machine learning mechanisms. While outside the realm of control theory, the term large language model (LLM) exemplifies this trend towards comprehensive modeling, reflecting the significant energy resources required for their development (see, e.g., Xu and Poo (2023)). The results presented here suggest a complementary perspective to this view, and may open the way for exploring more resource-efficient techniques. Why not starting with systematic investigations in control engineering?"}]}