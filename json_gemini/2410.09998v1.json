{"title": "SlimSeiz: Efficient Channel-Adaptive Seizure Prediction Using a Mamba-Enhanced Network", "authors": ["Guorui Lu", "Jing Peng", "Bingyuan Huang", "Chang Gao", "Todor Stefanov", "Yong Hao", "Qinyu Chen"], "abstract": "Epileptic seizures cause abnormal brain activity, and their unpredictability can lead to accidents, underscoring the need for long-term seizure prediction. Although seizures can be predicted by analyzing electroencephalogram (EEG) signals, existing methods often require too many electrode channels or larger models, limiting mobile usability. This paper introduces a SlimSeiz framework that utilizes adaptive channel selection with a lightweight neural network model. SlimSeiz operates in two states: the first stage selects the optimal channel set for seizure prediction using machine learning algorithms, and the second stage employs a lightweight neural network based on convolution and Mamba for prediction. On the Children's Hospital Boston-MIT (CHB-MIT) EEG dataset, SlimSeiz can reduce channels from 22 to 8 while claiming a satisfactory result of 94.8% accuracy, 95.5% sensitivity, and 94.0% specificity with only 21.2 K model parameters, matching or outperforming larger models' performance. We also validate SlimSeiz on a new EEG dataset, SRH-LEI, collected from Shanghai Renji Hospital, demonstrating its effectiveness across different patients. The code and SRH-LEI dataset are available at https://github.com/guoruilu/SlimSeiz.", "sections": [{"title": "I. INTRODUCTION", "content": "Epileptic seizure affects more than 50 million patients around the world according to the World Health Organization (WHO) [1]. Its accompanying symptoms can cause sudden and unforeseen accidents, making patients vulnerable to injury [2]. Therefore, continuous patient monitoring and accurate seizure prediction are essential for improving safety and quality of life. Electroencephalogram (EEG), an electrical recording of brain activity, is a key diagnostic tool for clinicians assessing epilepsy. Seizure prediction aims at identifying the pre-ictal state. However, due to the complexity of EEG signals and the prolonged nature of seizures, manual identification is impractical, requiring algorithms for automatic identification.\nDuring the past decade, many deep learning techniques have been explored to build seizure prediction systems [3]\u2013[11]. However, most existing methods rely on more than 20-electrode EEG channels to achieve this [3]-[7]. Although effective, using over 20 channels limits patient mobility, increases discomfort, and complicates hardware device design, making these methods unsuitable for mobile and long-term monitoring. Several studies [8]\u2013[11] have explored using fewer channels for seizure prediction. However, some of these works [8], [9] have struggled to achieve 80% prediction accuracy. While other methods [10], [11] have surpassed 90% prediction accuracy using neural network models, they require over 100 K model parameters, making such large models less suitable for long-term use on mobile devices.\nTo address the aforementioned issues, we propose a framework, called SlimSeiz, for efficient seizure prediction using a lightweight Mamba-enhanced neural network with adaptive EEG channel selection. Our main novel contributions are:\n1) A machine learning-based adaptive channel selection method that reduces the number of EEG channels from 22 to 8 while maintaining satisfactory accuracy.\n2) A lightweight neural network model with only 21.2 K parameters, consisting of one-dimensional convolutions and the Mamba [12] block.\n3) new dataset called the Shanghai Renji Hospital-LEI (SRH-LEI) EEG dataset.\n4) An experimental evaluation of SlimSeiz on the Children's Hospital Boston-MIT (CHB-MIT) EEG dataset and the SRH-LEI EEG dataset. SlimSeiz achieves 94.8% accuracy, 95.5% sensitivity, and 94.0% specificity on the CHB-MIT dataset, and 92.7% accuracy, 94.7% sensitivity, and 90.7% specificity on the SRH-LEI dataset."}, {"title": "II. THE SLIMSEIZ FRAMEWORK", "content": "In this section, we start by explaining how the EEG data is pre-processed (Section II-A). Then, we describe the two main parts of SlimSeiz: the channel selection method (Section II-B) and the network model (Section II-C). The channel selection module picks the top k channels that are most important for predictions. The neural network model then makes predictions based on those selected channels."}, {"title": "A. EEG Data Pre-processing", "content": "In this work, we use the CHB-MIT and the newly collected SRH-LEI EEG datasets (details are described in Section III-A). Due to the imbalanced nature of the recorded EEG data, where the duration of seizure events is significantly shorter than inter-ictal and post-ictal events, necessary data pre-processing operations can have a considerable impact on the model training and its predictive accuracy. Some previous work [3], [10], [11], [13] discarded the majority of the data to achieve a balanced dataset. In this work, we choose to use overlapping sliding windows with adjustable step sizes to increase the number of pre-ictal segments, similar to the approach used in [5].\nThe goal of seizure prediction is to identify pre-ictal states. Therefore, ictal segments are discarded because the seizure has already begun. The remaining segments, except pre-ictal, are grouped into a single category for simplicity. We set the pre-ictal segment length to 30 minutes, as prior work indicates this period contains important EEG information for pre-ictal/inter-ictal recognition [14]. If the gap between two seizures is less than 30 minutes, we combine them due to difficulties in distinguishing post-ictal and pre-ictal states. Each EEG recording is split into 4-second segments given as input to the neural network model within SlimSeiz."}, {"title": "B. Channel Selection Method", "content": "Long-term monitoring requires selecting a smaller subset of channels to reduce the computational load on the seizure predicting device and to enhance the patient mobility and comfort. However, the challenge lies in identifying which channels contribute most to the seizure prediction. In our work, we use the prediction accuracy achieved by each individual channel as an indicator of its contribution, based on the assumption that channels with higher prediction accuracy contain more useful information. Although the channel selection is a one-time effort for each patient, we aim to minimize the channel selection time as much as possible. Thus, we propose a channel selection method based on traditional machine learning that can yield results more quickly compared to neural networks.\nThe channel selection method is illustrated in the top part of Fig. 2 as a workflow. First, we split each channel data into training and testing segments. Given the fact that traditional machine learning (ML) methods have limited feature extraction capabilities, we use longer 5-second data segments to provide the ML model with more information. Then, we apply Principal Component Analysis (PCA) [15] to reduce the dimension for the training and testing segments separately while preserving key information, thereby reducing subsequent computational overhead. The Synthetic Minority Over-sampling Technique (SMOTE) [16] is employed to balance the dimension-reduced training set, which occupies less memory compared to using overlapping sliding windows. Next, we train and test a decision tree on the processed dataset to obtain the prediction accuracy for the current channel. By executing the aforementioned procedure for each channel, we generate a list of accuracy numbers and select the top k channels based on these accuracy numbers to form a channel subset. To mitigate the influence of random factors, such as the channel data splitting into training and testing segments, on the results, we repeat this procedure m times to obtain m channel subsets.\nFinally, we count the occurrences of each channel across all subsets and select the k channels that appear most frequently as the final result. The subset size k and the number of iterations m are two hyperparameters. In this study, we set m to 30 to balance the channel selection time and elimination of random factors. The optimal value of k is determined through relevant experiments to achieve a balance between reducing the number of channels and maintaining high accuracy of the"}, {"title": "C. Neural Network Model Architecture", "content": "As shown in the bottom part of Fig. 2, our lightweight model for seizure prediction consists of convolutional feature extraction, Mamba, and classification head.\n1) Convolutional Feature Extraction: We implement the feature extraction from the EEG input data by stacking one-dimensional (1D) convolutional layers that form the main body of our neural network model for seizure prediction. As shown in Fig. 2, a larger convolution kernel of size 21 is applied on the EEG input data in the first convolutional layer. This is followed by two residual connections, each consisting of three convolutional layers with different smaller kernel sizes. Different kernel sizes help the network extract features at various temporal resolutions. Max pooling and global average pooling are employed to reduce the feature dimensions and computational load. It is worth mentioning that previous work [5], [13], [17]-[19] primarily uses over 20 channels for seizure prediction, treating channels and time as the height and width of an image, respectively, and thus tend to use 2D convolutional neural network to extract spatial and temporal features. In our work, however, we use fewer channels, thereby reducing the complexity of spatial features and eliminating the need for parameter- and compute-intensive 2D convolutional networks.\n2) Mamba: The Mamba block is based on the State Space Model (SSM). Its structure, as shown in Fig. 2, uses a fully connected (FC) layer at the input to increase the channel count for capturing more complex features. The subsequent convolutional layer and SSM establish short-term and long-term sequential dependencies, respectively. The FC layer at the output reduces the channel count to maintain consistent input and output dimensions. This structure enables the Mamba block to efficiently capture dependencies within the sequence [20]. Mamba is proposed as an alternative to Transformer to reduce the computational load in the multi-head self-attention mechanism [21] and has shown promising potential in processing physical signals, such as audio signals [22], [23]. Mamba's abilities to capture dependencies in sequential data and reduce computation complexity match our goal to design a lightweight model for processing of EEG signals. To enhance the model's ability to capture temporal dependencies without increasing the model parameters, we add the Mamba block after the convolutional layers. This choice is due to the limited semantic information of sensor signals at a single time point, making it difficult to establish correlations [24]. Therefore, extracting features through convolutional layers and increasing channel count enriches the semantic information at each time point, allowing the Mamba block to work more effectively.\n3) Classification Head: A fully connected layer is used for classification. Cross-entropy loss and supervised contrastive loss are used to supervise the model's training."}, {"title": "III. EXPERIMENTAL EVALUATION AND RESULTS", "content": "In this section, we evaluate our proposed SlimSeiz framework to demonstrate its potential and efficiency."}, {"title": "A. Experimental Setup and Datasets", "content": "We evaluate SlimSeiz using two datasets. First, we utilize the CHB-MIT scalp long-term EEG dataset. This dataset comprises recordings from 23 children with intractable seizures at the Children's Hospital Boston, resulting in 24 cases (with two cases derived from a single patient). The duration of EEG recordings for each patient ranges from 19 to 165 hours, totaling approximately 983 hours. The sampling frequency for signal collection is 256 Hz. Second, we introduce and utilize the new SRH-LEI EEG dataset, which we have collected at Shanghai Renji Hospital, Shanghai Jiao Tong University. This dataset includes data from 8 patients, consisting of 4 males and 4 females, aged between 14 and 77 years old. The data collection duration ranges from 17 to 24 hours, with a sampling frequency of 128 Hz. Detailed information about the dateset features is provided in Table I.\nWe use accuracy (ACC), sensitivity (SENS), and specificity (SPEC) as evaluation metrics. SENS measures the model's ability to correctly identify actual pre-ictal segments, higher sensitivity means fewer missed pre-ictal cases. SPEC indicates how well the model identifies actual inter-ictal segments, higher specificity reflects fewer false alarms for pre-ictal states."}, {"title": "B. Optimal Number of Channels", "content": "To determine the optimal channel counts, we evaluated the model's performance using channel counts of 4, 6, 8, and 10. In this experiment, we randomly split the data into 80% for training and 20% for testing to assess the effectiveness of each channel configuration.\nAs shown in Fig. 3, our experimental results indicate that increasing the number of channels beyond 8 does not lead to significant performance improvements. More importantly, for most cases (patients), an accuracy of over 90% can be achieved using just 4 channels, and for some patients (e.g., case 01 and 07), the accuracy even exceeds 95%. Therefore, increasing the number of channels offers little benefit for most patients. Only for a few patients (e.g., case 15 and 21) with an accuracy below 90% using 4 channels, increasing the number of channels results in a noticeable performance enhancement (up to 10%). Considering both performance gains and the associated complexity of the device with the number of channels, we conclude that 8 is the optimal number of channels and we use this result in subsequent experiments."}, {"title": "C. Performance and Comparison Results", "content": "To validate the effectiveness of the Mamba block, we replace it with a convolutional block of a similar parameter scale. The total parameters for the network with the Mamba block and the network with the replaced convolutional block are 21.2K and 22.2K, respectively. While having a slightly smaller model size, the network with the Mamba block achieves an average accuracy that is 0.1% higher than the network with the replaced convolutional block in 10-fold cross validation (CV), indicating the effectiveness of the Mamba block in lightweight seizure prediction neural networks.\nWe also conduct experiments on the SRH-LEI EEG dataset. The results when utilizing 8 selected channels are shown in Table III. SlimSeiz achieves an average of over 90% for each metric, demonstrating its generalization on adult patients.\nFinally, we compare our framework with state-of-the-art seizure prediction methods on the CHB-MIT dataset. As shown in Table II, our framework using only 8 channels and a small model (21.2K parameters) achieves comparable average accuracy to methods using over 18 channels and larger models, highlighting its suitability for long-term wearable monitoring."}, {"title": "IV. CONCLUSION AND FUTURE WORK", "content": "We present SlimSeiz, a lightweight framework for efficient seizure prediction, using only 21.2K model parameters and reducing EEG channels from 22 to 8 while matching state-of-the-art performance on the CHB-MIT dataset. Additionally, SlimSeiz is validated on the newly collected SRH-LEI EEG dataset, which will be released soon. We found that Channels P3-O1, P8-O2, C3-P3, C4-P4, FZ-CZ, and P4-O2 are selected in over 17 patients, paving the way for future patient-independent systems with fewer channels."}]}