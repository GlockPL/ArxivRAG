{"title": "Research on Adverse Drug Reaction Prediction Model Combining Knowledge Graph Embedding and Deep Learning", "authors": ["Yufeng Li", "Wenchao Zhao", "Bo Dang", "Xu Yan", "Weimin Wang", "Min Gao", "Mingxuan Xiao"], "abstract": "In clinical treatment, identifying potential adverse reactions of drugs can help assist doctors in making medication decisions. In response to the problems in previous studies that features are high-dimensional and sparse, independent prediction models need to be constructed for each adverse reaction of drugs, and the prediction accuracy is low, this paper develops an adverse drug reaction prediction model based on knowledge graph embedding and deep learning, which can predict experimental results. Unified prediction of adverse drug reactions covered. Knowledge graph embedding technology can fuse the associated information between drugs and alleviate the shortcomings of high-dimensional sparsity in feature matrices, and the efficient training capabilities of deep learning can improve the prediction accuracy of the model. This article builds an adverse drug reaction knowledge graph based on drug feature data; by analyzing the embedding effect of the knowledge graph under different embedding strategies, the best embedding strategy is selected to obtain sample vectors; and then a convolutional neural network model is constructed to predict adverse reactions. The results show that under the DistMult embedding model and 400-dimensional embedding strategy, the convolutional neural network model has the best prediction effect; the average accuracy, F\u2081 score, recall rate and area under the curve of repeated experiments are better than the methods reported in the literature. The obtained prediction model has good prediction accuracy and stability, and can provide an effective reference for later safe medication guidance.", "sections": [{"title": "1. INTRODUCTION", "content": "Adverse Drug Reaction (ADR) is an important global public health problem and one of the major causes of death [1]. The World Health Organization vigibase database records approximately 23 million ADRs, of which 43,685 are fatal ADRs."}, {"title": "2. RELATED RESEARCH WORK", "content": "According to the definition of the World Health Organization, adverse drug reactions refer to harmful and unexpected reactions that occur during the use of normal doses of drugs for the prevention, diagnosis, treatment of diseases or the regulation of physiological functions and are unrelated to the purpose of medication[5]; and ADRs may It is the result of the reaction between pharmaceutical chemicals and proteins [6]. Early research on ADRs was mainly based on clinical case data from Spontaneous Reporting Systems (SRSs), using methods such as proportional imbalance analysis to evaluate the correlation and causality between drugs and ADRs to mine relevant adverse drug reaction signals. However, the data of SRSs are often incomplete or inaccurate, which may lead to biased research results. In addition, the limited amount of data and the lack of in-depth data mining make early research conclusions based on simple statistical methods unconvincing[7]. As artificial intelligence technology continues to develop and the amount of medical data continues to grow, on the one hand, researchers are mining potential adverse reactions of drugs based on text data such as literature and ADR reports, combined with natural language processing technology[8]; on the other hand, based on the chemistry and biology of drugs, and phenotypic characteristics, and use machine learning or deep learning methods to conduct ADR prediction research[9]. Research based on text mining is often used to identify and monitor relevant ADRs, which assumes that relevant ADRs have appeared, but cannot predict potential ADRs of drugs; while ADR prediction research based on drug features and machine learning helps to explore unknown ADRs of drugs, which it is also the research topic of this project. Machine learning related methods can improve the ADR prediction effect, but there are still key points that can be improved in these studies: (1) the correlation between drugs is not considered, which may lead to the loss of useful information; (2) the use of a large amount of one-hot encoded feature data, However, it is difficult to reduce the dimensionality of high-dimensional sparse feature matrices, and the model calculation efficiency is low; (3) Most of them need to build separate classifiers for each ADR. Knowledge Graph (KG), a special network structure composed of nodes and relationships and its embedding technology, captures the unstructured semantic relationships between feature entities by embedding entities into a continuous low-dimensional feature space. Fusion and calculation between information can effectively alleviate the computational inefficiency problem caused by high-dimensional sparse feature"}, {"title": "3. DATA AND METHODOLOGY", "content": "In the method proposed in this paper, referring to existing literature[11][12], the side effects of drugs are regarded as ADRs. In view of the fact that combining the biological characteristics and phenotypic characteristics of drugs can improve the performance of the ADR prediction model, biological characteristics and indications such as target, transporter, and enzyme were selected from the DrugBank (v5.18)[16] and SIDER (v4.1)[17] databases respectively, and adverse reactions (ADR) and other phenotypic characteristics, and drugs (drug) as knowledge graph entity nodes. Then, in order to avoid the heavy workload of building a separate classifier for each ADR, ADR prediction is treated as a unified two-classification problem, and the \"Drug-ADR\" combination and the \"Drug-Indication\" combination are used as the positive components of the classification model respectively. For samples and negative samples, the sample labels are recorded as \"1\" and \"0\" respectively. From this, an ADR prediction model based on knowledge graph embedding and deep learning was developed, and the stability of the Convolutional Neural Networks (CNN) model was tested through five repeated experiments. Finally, drug-induced renal function injury was used as an example to predict, and the validity of the model prediction was verified through real-world data. The specific research ideas are shown in Figure 1."}, {"title": "3.1 Data Sources and Knowledge Graph Construction", "content": "The DrugBank database covers a wealth of biological and chemical informatics resources, and the SIDER database includes 1,500 drugs and more than 6,100 side effects. By downloading the xml data file in DrugBank and the tsv file in SIDER, use the Python program to parse and obtain the relevant characteristic data of the drug. Integrate relevant data from two databases according to the Anatomical Therapeutic Chemical (ATC) code and filter drug records with at least one drug feature. Finally, five types of triples are constructed: <drug, hasTransporter, Transporter>, <drug, hasADR, ADR>, <drug, hasEmzyme, Emzyme>, <drug, hasTarget, Target>, <drug, hasIndication, Indication>; The tuples are stored in the Neo4j graph database to obtain a visual knowledge graph, as shown in Figure 2. The map contains a total of 8001 drugs, 5453 ADRs and 158133 triples, as shown in Table 2."}, {"title": "3.2 Knowledge graph embedding model", "content": "Knowledge graph embedding technology is gradually used in prediction research[18], among which the DistMult[19] model and HolE[20] model based on tensor decomposition are the most widely used. The DistMult model describes the semantic correlation between entities through bilinear transformation between entities, where the head entity and tail entity are represented by vectors h and t respectively, and the relationship is represented by vector r; the relationship matrix M, = diag(r) pair Pairwise interactions between latent factors are modeled using fr(h,t) = h M\u2081t as the scoring function. The HolE model is based on the DistMult model and introduces circular correlation operations between entities to capture the compositional representation of pairs of entities. It uses fr(h, t) = r\u00b2 (h * t) as the scoring function, where * is the circular correlation. Operation. Both of above two embedding models take minimizing the scoring function as the goal to obtain effective embedding vectors of entities and relationships."}, {"title": "3.3 CNN classification model", "content": "A CNN model with 2 convolutional layers and 4 fully connected layers is researched and designed, as shown in Figure 3. Since the calculation efficiency and convergence speed of the ReLU activation function are much higher than those of sigmoid, Tanh and other functions; therefore, both the convolutional layer and the fully connected layer use the ReLU activation function. At the same time, in order to maintain the same distribution of inputs of each layer of neural network and improve network optimization efficiency, the convolutional layers all use batch normalization. The specific parameters of the model are shown in Table 3. This paper uses the binary cross entropy shown in Equation (1) as the loss function for model training, where n is the total number of training samples, y; is the true label of sample i, and y\u2081is the probability that sample i is predicted to be category \"1\" value; through model training, obtain the optimal values of parameters W and b.\nJ(W,b) = \u2212[yilogy + (1 \u2212 y\u2081)log (1 \u2013 \u00ce\u00ee\u0177)]  (1)"}, {"title": "4. EXPERIMENT AND RESULT ANALYSIS", "content": "This project uses the confusion matrix to calculate the recall rate (Recall), accuracy rate (ACC), precision rate (Precision, P), F\u2081 value (F\u2081- Score, F1) and area under the curve (AUC) as a model evaluation indicators."}, {"title": "4.1 Model evaluation indicators", "content": "This project uses the confusion matrix to calculate the recall rate (Recall), accuracy rate (ACC), precision rate (Precision, P), F\u2081 value (F\u2081- Score, F1) and area under the curve (AUC) as a model evaluation indicators."}, {"title": "4.2 Knowledge graph embedding and sample vector representation", "content": "The embedding operation is based on the Python language and is implemented by calling the AmpliGraph tool library. Before the embedding operation, it is necessary to determine the training set and test set of the ADR prediction model; the training set is used for the knowledge graph embedding operation and ADR prediction model training, and the test set is used to evaluate the prediction performance of the ADR prediction model. There are 119,131 positive samples and 12,435 negative samples in the knowledge graph (see Table 4). Since the number of positive and negative samples differs"}, {"title": "4.3 Comparative analysis of embedded dimensions", "content": "This paper explores the impact of different embedding strategies on the prediction performance of the benchmark ADR classification model on the test set by combining different embedding models and different embedding dimensions (10 to 800). As shown in Figure 4, under different embedding models, as the embedding dimension increases, the AUC values of each benchmark model on the test set gradually increase; and the ACC and F1 index values also fluctuate to varying degrees; Recall The value does not increase significantly and is relatively stable. However, when the embedding dimension is greater than 400, the AUC, ACC, and F1 index values of each benchmark model tend to be stable. Through comprehensive analysis, appropriately increasing the embedding dimension can improve the prediction performance of"}, {"title": "4.4 Comparative analysis of classification models", "content": "Based on the Python language, scikit-learn and the deep learning framework Tensorflow2.0 are used to develop the ADR classification model. The six benchmark models will use default parameters. The fixed embedding dimension is 400 dimensions. The representation vector of the sample is obtained through the embedding model and input into the ADR classification model for training and prediction. The prediction results of each classification model on the test set are shown in Table 6. Comprehensive analysis found that under the DistMult embedding model, the AUC value of the CNN classification model on the test set was 0.942, which was better than all benchmark models."}, {"title": "4.5 Model stability assessment", "content": "The study used 5 repeated experiments to evaluate the stability of the CNN model. Specific steps: (1) Set random seeds and construct training sets and test sets; (2) Use the \"DistMult model + 400 dimensions\" combination strategy for embedding operations; (3) Use the obtained sample representation vectors for CNN classification model training and predict. The results are shown in Table 7. The average AUC of the CNN model in this article is 0.957; the average F\u2081 value is 0.891, and the average Recall value is 0.914, each indicator value fluctuates less. At the same time, the ROC curve (shown in Figure 5) is also stable, indicating that the CNN model developed in this article has high stability."}, {"title": "4.6 Prediction model verification", "content": "This project uses real-world data to test the effectiveness of the CNN model. Using \"kidney injury\" or \"kidney injury\" as keywords, we randomly searched for relevant ADR studies in literature databases such as PubMed, and obtained 3 \"Drug-ADR\" combinations that were not included in the SIDER database; these were used as Input, use CNN model to make predictions. The results show (shown in Table 8) that the average probability of a real sample being predicted as \"positive\" is 0.967, indicating that the CNN model in this article can effectively predict samples outside the experimental sample set."}, {"title": "4.7 Comparative analysis with advanced research", "content": "Due to the current lack of standard data sets for testing the performance of ADR prediction models, this article will compare it with related typical studies in terms of the drugs covered, the number of ADR types, and the AUC value of the prediction model (see Table 9). Through comparative analysis, the AUC of the CNN model developed in this article is higher than the results provided by related research, and the prediction performance is better. At the same time, the experimental data set of this article contains 7920 drugs and 5454 ADRs, covering more drug information than most similar studies. In addition, most previous studies need to build a separate prediction model for each ADR, which increases the workload of the ADR prediction task. In contrast, this paper builds a drug knowledge graph and uses knowledge graph embedding technology to encode entities such as drugs and ADRs into Feature vector; Finally, a unified CNN model is used to predict each \"\" combination to evaluate the probability that the combination has the \"hasADR\" relationship, which greatly reduces the number of models. The study by Zhang et al. [12] used a similar method for ADR prediction, but it covered only 3,632 drugs and showed a relatively low AUC value; the study by Joshi et al. [11]was reported in the literature[12] added drug pathway (Pathways) and gene (Gene) features, but the average AUC of its ADR prediction model is only 0.912, and there is still room for improvement. This paper develops a higher-performance ADR prediction model by selecting more representative drug features."}, {"title": "5. CONCLUSION", "content": "In view of the problems of previous ADR prediction model research, such as low prediction accuracy and heavy workload due to the need to build separate classifiers for each ADR, this project simplifies the prediction of different types of ADR into a binary classification problem and develops a model based on knowledge graph embedding and depth. Learned CNN prediction model. By comparison, the prediction model in this article is more accurate than the"}, {"title": "", "content": "predictions of existing studies. In addition, the validity and feasibility of the model prediction results are verified through real-world data, and it is expected to play a core auxiliary role in clinical safe medication in the future. The next step of research will consider using similar methods to study the potential adverse reactions of different drug interactions; or be patient-centered, assess potential risk factors that lead to ADRs in clinical patients, and predict patients' specific drug use situations. The risk level of ADR; or explore ADR prediction models under different scenarios. In the future, the relationship between drug morphology and potential side effects can be further studied based on existing reinforcement learning algorithms[25] and image segmentation[29]."}]}