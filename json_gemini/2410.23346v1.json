{"title": "ASURA-FDPS-ML: Star-by-star Galaxy Simulations Accelerated by Surrogate Modeling for Supernova Feedback", "authors": ["KEIYA HIRASHIMA", "KANA MORIWAKI", "MICHIKO S. FUJII", "YUTAKA HIRAI", "TAKAYUKI R. SAITOH", "JUNICHIRO MAKINO", "ULRICH P. STEINWANDEL", "SHIRLEY HO"], "abstract": "We introduce new high-resolution galaxy simulations accelerated by a surrogate model that reduces the computation cost by approximately 75 percent. Massive stars with a Zero Age Main Sequence mass of about 8 M and above explode as core-collapse supernovae (CCSNe), which play a critical role in galaxy formation. The energy released by CCSNe is essential for regulating star formation and driving feedback processes in the interstellar medium (ISM). However, the short integration timesteps required for SNe feedback present significant bottlenecks in star-by-star galaxy simulations, which aim to capture the individual stellar dynamics and the inhomogeneous shell expansion of SNe within the turbulent ISM. Our new framework combines direct numerical simulations and surrogate modeling, including machine learning and Gibbs sampling. The star formation history and the time evolution of outflow rates in the galaxy match those obtained from resolved direct numerical simulations. Our new approach achieves high-resolution fidelity while reducing computational costs, effectively bridging the physical scale gap and enabling multi-scale simulations.", "sections": [{"title": "1. INTRODUCTION", "content": "Supernovae (SNe) are powerful events that release an immense amount of energy into the ambient ISM (~ 1051 erg). This energy release results in immediate heating, and delayed momentum input into the ambient ISM drives turbulence and aids star formation regulation in the turbulent ISM (e.g., Somerville & Dav\u00e9 2015; Naab & Ostriker 2017, for reviews). Thus, SNe significantly impact galaxy evolution, incorporating processes like gravity, hydrodynamics, radiation, star formation, and chemical reactions. Given the complicated interplay among these processes, numerical methods have been commonly employed to study galaxy formation and evolution.\nRecently, numerical simulations have reached the resolution requirements to resolve three of the four phases of SN-remnant evolution from first principles with a typical mass resolution of around ~ 1 M (e.g., Andersson et al. 2023, 2024; Deng et al. 2024; Emerick et al. 2018, 2019; Fujii et al. 2021; Fujii et al. 2021, 2022b, a, 2024; Gutcke et al. 2021, 2022; Hirai et al. 2021; Hu et al. 2016, 2017; Hu 2019; Lah\u00e9n et al. 2020; Lah\u00e9n et al. 2023; Smith et al. 2021; Steinwandel et al. 2020; Steinwandel & Goldberg 2023; Steinwandel et al. 2023; Lah\u00e9n et al. 2024; Steinwandel et al. 2024a,b). The three phases that can be resolved in these first principle simulations are the energy-conserving Sedov-Taylor phase, the pressure-driven snowplow phase, and the momentum-conserving snowplow phase (e.g., Sedov 1959; Taylor 1950; Blondin et al. 1998; von Neumann 1942). These simulations resolve every phase of SN-remnant evolution apart from the phase of free expansion that is terminated when the swept-up mass becomes equal to the ejecta mass of the remnant of a few solar masses (e.g., Reynolds et al. 2008). This stage is when the reverse shock decouples from the forward shock, propagating backward into the vacuum generated by the forward shock. The reverse shock heats the gas inside the cavity generated by the forward shock to temperatures of ~ 107 K. This is why the injection of the SN-energy has been generally handled as a single thermal injection event so far, which can effectively be seen as a \"subgrid model.\"\nTo resolve this phase more accurately, one would need to have at least 10 to 100 times higher mass resolution than the ejecta mass, which requires switching from a thermal to a kinetic injection scheme. The resolved reverse shock would then ultimately heat the cavity generated by the forward shock and generate the SN-bubble that resolves the remnant into the well-studied energy conserving Sedov-Taylor-von-Neumann-solution (e.g., Kim & Ostriker 2015; Steinwandel et al. 2020). Such a kinetic injection scheme has been applied in many successful simulation endeavors of the ISM (e.g., Hu et al. 2016), but this scheme does require not only a high mass resolution but also a sufficient temporal resolution.\nThe timestep constraint of these simulations comes at a significant computational expense. Longer timesteps than the time-scale of cooling or adiabatic expansion can fail to estimate the internal energy of the gas. This is demonstrated in, e.g., Saitoh & Makino (2009) that longer time steps, which cannot properly resolve the evolution of expanding regions, lead to catastrophic results. Capturing the initial state of the energy injection requires a timescale of hundreds of years, which is three orders of magnitude shorter than the typical ISM in galaxy simulations. Proper timestep limiters are typically employed to preserve thermal energy injection by limiting the timestep with the signal velocity of a fluid tracer (Monaghan 1997; Durier & Dalla Vecchia 2012; Saitoh & Makino 2009). Even colder particles should have a smaller timestep to prevent vastly different time steps between neighboring gas particles (e.g., Chaikin et al. 2023; Nobels et al. 2023). Hence, it might be desirable to speed up the injection scheme in a physically motivated manner.\nMachine learning (ML) may help to extend the range of physical scales in computationally expensive simulations (e.g., Kochkov et al. 2021). In cosmological simulations, ML has been used to predict the gravitational dynamics, allowing to avoid the computation of the physical states of > 10\u00ba particles over the periods of the universe's age (He et al. 2019; Jamieson et al. 2023, 2024). ML has also been incorporated into hydrodynamical simulations to reconstruct the physical states of fluid tracer particles undergoing complex astrophysical interactions in realistic systems (Hirashima et al. 2023a,b; Chan et al. 2024).\nRecent surrogate models for hydrodynamical simulations include two different approaches: physics-informed neural networks (PINNS; Raissi et al. 2019) and data-driven approaches. PINNs explicitly use the governing equations for the loss function. They can be used for both Eulerian-frame and Lagrangian-frame dataset (e.g., Woodward et al. 2023), so in principle, they can be applied to simulation data in a Lagrangian frame like galaxy formation simulation. However, simulations of galaxy formation involve several equations for complex physics problems (gravity + hydrodynamics) that couple non-linear to other complex aspects of the astrophysical thermo chemistry and feedback physics, which in turn makes it quite hard to capture the physical state by analytic considerations alone and different model setups are needed to marginalize over all of the involved model parameters. Furthermore, the rollout prediction in PINNs still requires small timesteps, which is a clear drawback for galaxy formation and evolution applications as we try to work around the dynamic range problem of astrophysical simulations. Nevertheless, there are successful PINNs for hydrodynamics under self-gravity, as demonstrated by Auddy et al. (2024).\nAn alternative is the data-driven approach, which studies spatial and temporal correlations in the distribution of physical data without prior knowledge. This approach has been applied for non-linear and multi-scale physical simulations in astrophysics in recent work (He et al. 2019; Bernardini et al. 2022; Hirashima et al. 2023a,b; Jamieson et al. 2023, 2024; Chan et al. 2024; Legin et al. 2024). In this paper, we present the first surrogate modeling using ML to accelerate galaxy formation simulations by mitigating the bottlenecks caused by small timesteps.\nThe paper is structured as follows. In Sec. 2, we discuss the numerical methods used. In Sec. 3, we test our network prediction against a resolved SN-blastwave in a turbulent molecular cloud. In Sec. 4, we apply this network in a resolved dwarf galaxy simulation with explicit, star-by-star stellar feedback and compare our network"}, {"title": "2. METHODS", "content": "2.1. Simulation code\nThis study executes three types of runs: high-resolution simulations of SN feedback in isolated molecular clouds, a fiducial run of an isolated dwarf galaxy, and a run of the same galaxy enhanced using the surrogate model for SN feedback. The simulation data of isolated molecular clouds are used to train the surrogate model. The isolated SN simulations and the fiducial run of the galaxy are carried out with our N-body/density-independent smoothed particle hydrodynamics (DISPH; Saitoh & Makino 2013, 2016) code, ASURA-FDPS (Saitoh et al. 2008; Iwasawa et al. 2016; Hirashima et al. 2023a). Hydrodynamic interactions are computed by the DISPH method (Saitoh & Makino 2013, 2016), which can properly handle the contact discontinuity. The gas properties are smoothed using the Wendland C4 kernel (Dehnen & Aly 2012). The kernel size is determined to maintain the number of neighbor particles at 125\u00b11. We adopt the shared variable timesteps with the Courant-like hydrodynamical timestep (Courant et al. 1928) based on the signal velocity (Monaghan 1997; Springel 2005). Following the leapfrog (Velocity Verlet) scheme, we adopt a second-order symplectic integrator in its Kick-Drift-Kick (KDK) configuration. As for the simulations of SN feedback with a high-mass resolution, the timestep of a SPH particle i is determined as\n$\\Delta t_{i}=C_{C F L} \\frac{2 h_{i}}{\\max _{j}\\left[c_{i}+c_{j}-3 w_{i j}\\right]}$\nwhere CCFL = 0.3, hi and ci are the SPH smoothing length and sound speed of a particle i, and\n$w_{i j}=\\mathbf{v}_{i j} \\cdot \\mathbf{r}_{i j} / r_{i j}$\nwhere rij and vij are the relative position and velocity between particles i and j, respectively.\nOur new presenting framework ASURA-FDPS-ML consists of ASURA-FDPS and the surrogate modeling for SN feedback, which will be described in Sec. 2.6. As for dwarf galaxy simulations with surrogate modeling, timesteps are fixed to 2000 years by avoiding direct calculations of the initial state of SN feedback, which significantly requires smaller timesteps."}, {"title": "2.2. Initial Condition", "content": "The initial condition (IC) for the isolated galaxy simulations are originally described in Hu et al. (2016, 2017) (\"cmp\"). This IC has been used to investigate the properties of the dwarf galaxy and treatment of stellar feedback (e.g., Smith et al. 2021; Hislop et al. 2022; Steinwandel & Goldberg 2023; Hu et al. 2023). The ICs were generated with the method proposed in Springel (2005). The dark matter halo follows a Hernquist profile with an NFW-equivalent (Navarro et al. 1997) concentration parameter CNFW = 10 and has a virial radius of Rvir = 44 kpc and a virial mass of Mvir = 2 \u00d7 1010 M. The initial gas mass of the system is 4 \u00d7 107 Mo, and the stellar background potential has a mass of 2 \u00d7 107 M. The initial disk consists of 4 million dark matter particles, 10 million gas particles, and 5 million star particles, setting a dark matter particle mass resolution of MDM = 6.8 \u00d7 103 M. and a baryonic particle mass resolution of mbaryon = 4 M. The gravitational softening parameter of the simulations is set to 62 pc for dark matter and 0.5 pc for gas and stars. Unlike some previous studies, the IC used in this paper has evolved in advance for 500 Myr with the code P-Gadget3 in the MFM version of Steinwandel et al. (2020) with 32 neighbors for the density computation. Fluid fluxes up to that point have been computed with the Harten-Lax-van-Leer contact (HLLC) Riemann solver. After this initial 500 Myr period, we completely switch to the ASURA-FDPS (or ASURA-FDPS-ML) framework based on the DISPH method outlined in Sec. 2.1."}, {"title": "2.3. Star formation model", "content": "Gas particles stochastically form stars if they satisfy several physical conditions such as high number density of hydrogen atoms (\u043f\u043d \u2265 100 cm\u00b3), low temperature (T\u2264 100 K), and convergence of the flows (\u2207\u00b7 \u03c5 < 0), following Hirai et al. (2021). To avoid star formation in hot regions, which have a large Jeans mass, the threshold temperature 100 K is chosen following Hu et al. (2016). The masses are sampled by the initial mass function (IMF), following Chabrier (2003) with an upper limit of 40 M and a fixed star formation efficiency of 2 percent per free-fall time. When a gas particle meets the physical conditions, it is converted into a star with a probability (p*) in a given timestep (\u2206t):\n$P_{*}=\\left\\{1-\\exp \\left(-c_{*} \\frac{m_{\\text {gas }}}{\\langle m_{*}\\rangle} \\frac{\\Delta t}{t_{\\mathrm{dyn}}}\\right)\\right.$\nwhere mgas, (m*), tdyn, and c* are the mass of one gas particle, the average value of stellar mass in the assumed IMF, the dynamical time of the star-forming region, and a dimensionless star-formation efficiency."}, {"title": "2.4. Stellar feedback", "content": "We used the yields from Nomoto et al. (2013), which covers core-collapse SNe from 13 M to 40 Mo, where the nucleosynthesis yields is given as functions of the stellar mass, metallicity, and explosion energy of 1051 erg. These are compiled in the Chemical Evolution Library (CELIB, Saitoh 2017)."}, {"title": "2.5. Required timestep for SN feedback", "content": "The timestep in ASURA-FDPS-ML is fixed with a reasonably short time for a simple implementation described in Section 2.6. We estimate the required timestep using a time scale for discrete SN feedback shown in Saitoh & Makino (2010). Here, the size of an SPH particle, \u5165, is assumed to be\n$\\lambda=\\left(\\frac{3 \\, M_{\\mathrm{SPH}}}{4 \\pi \\rho}\\right)^{1 / 3}$\nwhere p is the density of a SPH particle. Let NNB be the number of the neighboring particles that receive the energy from a SN. The internal energy for a SPH particle due to the SN of a single star, Usn, is defined as\n$\\mathrm{U}_{S N}:=\\frac{E_{S N}}{N_{N B} \\, M_{S P H}}=\\frac{10^{51}}{N_{N B} \\, M_{S P H}}\n=\\frac{5.0 \\times 10^{17}}{N_{N B}}\\left(\\frac{1 M_{\\odot}}{M_{S P H}}\\right)\\left[\\operatorname{erg} \\, g^{-1}\\right]$\nwhere the original internal energy is ignored since it is low in comparison to the SN-ejecta. With Equation (5), the sound speed, CSN, of the heated gas is derived as\n$\\mathbf{c}_{s n}:=\\sqrt{\\gamma(\\gamma-1) U_{S N}}$\n$\\approx \\frac{7.5 \\times 10^{3}}{N_{N B}^{1 / 2}}\\left(\\frac{1 M_{\\odot}}{M_{S P H}}\\right)^{1 / 2}\\left[\\mathrm{km} \\, s^{-1}\\right]$\nBy substituting Equations (4) and (6) and NNB = 128 into the sound crossing time, tsn = \u03bb/csn,\n$t_{S N} \\approx 1.3 \\times 10^{3}\\left(\\frac{M_{S P H}}{1 M_{\\odot}}\\right)^{5 / 6}\\left(\\frac{n}{100[\\mathrm{cm}^{-3}]}\\right)^{-1 / 3}[\\mathrm{yr}]$\nTo avoid overcooling of SN feedback in star-forming regions, we replace the direct computation of SN feedback in denser regions than a hydrogen number density of \u043f\u043d = 1 cm-3 with our surrogate model including ML. Using Equation (7), the timescale for SN feedback is calculated as tsn ~ 2 \u00d7 104 years at a mean density of \u043f\u043d = 1 cm-3 when the mass resolution MSPH = 4 M is applied. Given the typical Courant time-step in the"}, {"title": "2.6. Hybrid on-the-fly ML-driven simulations", "content": "Figure 1 shows the schematic diagram of our presenting framework, ASURA-FDPS-ML. It has two kinds of MPI communicators: \"Main\" and \"Pool\" hereafter. A whole galaxy, including N-body and SPH, is directly computed in main processes using hundreds of MPI processes (\"Main\"), while SN feedback in dense regions (> 1 cm-3) is handled by a surrogate model in \u201cPool\" processes. As SNe in the less dense ambient gas are more kinetically resolved (Kim & Ostriker 2015; Steinwandel et al. 2020; Gutcke et al. 2021), when SNe explode in the environments at a hydrogen number density of < 1cm-3, the energy of SNe (1051 erg) is injected into the neighboring 100 SPH particles weighted using the Wendland C4 kernel (Dehnen & Aly 2012). Every timestep, \"Main\" checks if any SN occurs in dense regions (> 1 cm-3) or not. If SNe occur, the ambient gas particles are sent to a \"Pool\" process. The surrogate model in the \"Pool\" process reconstructs the distribution of gas particles after a time window T from the SN explosion. Once the \"Main\" processes are advanced for T, the predicted gas particles are returned to \"Main\" from \"Pool\".\nTo prevent the evolution in the replaced regions from being violated by gravity, we restrict the time window using the local free-fall time tr at SF regions, where the density could potentially reach ~ 103 cm-3 in the simulations. As the typical gravitational timestep is the one-tenth of the local free-fall time, by using tff ~ 1 Myr at nH = 103 cm-3, we set T = 0.1 tff ~ 0.1 Myr. By this definition, the number of MPI processes in \"Pool\" is set to N = \u03c4/\u2206t = 50 while \u201cMain\" can have an arbitrary number of MPI processes."}, {"title": "2.7. Dataset for Our Surrogate Modeling", "content": "To avoid direct computation of the regions that require small timesteps, i.e., the SN explosions at a hydrogen number density of > 1 cm-3, we used the simulations of SN feedback in such environments as the training dataset for our ML model (Hirashima et al. 2023a,b). The simulations are designed as a SN explosion in a high-density star-forming molecular cloud with a large density contrast. We assume an adiabatic compression of a monoatomic ideal gas, which follows the equation of state with the specific heat ratio y = 5/3:\n$P=(\\gamma-1) \\rho u$\nwhere P, p, and u are the pressure, smoothed density, and specific internal energy, respectively. The adiabatic compressible gas clouds follow the following equations:\n$\\frac{d \\rho}{d t}=-\\rho \\nabla \\cdot \\mathbf{v}$\n$\\frac{d^{2} \\mathbf{r}}{d t^{2}}=-\\frac{\\nabla P}{\\rho}+\\mathbf{a}_{v i s c}-\\nabla \\Phi$\n$\\frac{d u}{d t}=-\\frac{P}{\\rho} \\nabla \\cdot \\mathbf{v}+\\frac{\\Gamma-\\Lambda}{\\rho}$\nwhere r is the position, avisc is the acceleration generated by the viscosity, is the gravitational potential, \u0393 is the radiative cooling rate per unit volume, and A is the radiative heating rate per unit volume.\nInitially, uniform and virialized gas spheres with a homogeneous isotropic turbulent velocity field that follows x v-4 are constructed using the ASTROPHYSICAL MULTI-PURPOSE SOFTWARE ENVIRONMENT (AMUSE; Pelupessy et al. 2013; Portegies Zwart et al. 2013; Portegies Zwart & McMillan 2018). These initial gas spheres have a total mass of 106 M. and a radius of 60 pc. All of the simulations are performed with a mass resolution of 1 Mo, which is a higher resolution than the target resolution of 4 Mo for one of our galaxy simulations in this paper. The gas sphere is evolved for one initial free-fall\ntime $t_{r}=\\left(\\frac{3 \\pi}{32 G \\rho_{0}}\\right)^{\\frac{1}{2}}$ to mimic star-forming regions and\nsupports the build-up of filamentary structures by decaying (supersonic) turbulence. We inject the thermal energy of 1051 erg into 100 neighboring SPH particles of the center of mass of the turbulent gas clouds. The pairs of the snapshots at t = 0 and t = \u03c4 = 0.1 Myr are"}, {"title": "3. TEST FOR OUR SURROGATE MODEL OF SN FEEDBACK", "content": "Our surrogate model is designed to incorporate a ML model and Gibbs sampling and reconstruct the distribution of gas particles with temperature and 3D velocity. Our ML model is based on U-Net (Ronneberger et al. 2015), which is a supervised ML model originally developed for computer vision and consists of convolutional neural networks. The model learns gas dynamics of SN feedback in 3D from simulations. As described in Section 2.7, the ML model was trained with 300 simulations of an isolated SN in a molecular cloud with a total mass of 106 Mo with a mass resolution of 1 M (Hirashima et al. 2023b). The ML model takes the 3D distribution (643 voxels with one side of 60 pc and a spatial resolution of ~1 pc) of density, temperature, and 3D velocities as an input and predicts those fields after the SN explosion by the time window \u03c4 = 0.1 Myr as an output, completed in Section 2.6. Since the time window is short enough compared to the local free fall time, we assume the cold gas particles in the voxels barely move, and the number of particles (the total mass) inside is preserved over the time window T. The model Mis trained to learn the relation between input X and output y, where X and y represent the distribution of physical quantities before and after the SN explosion in simulations, respectively, over the time window of 0.1 Myr. Suppose the trainable parameter 0 and the predicted distribution \u0177, we summarize the procedure of the surrogate model as the following:\n1. Make the input voxel X"}, {"title": "4. RESULTS FOR AN ISOLATED DWARF GALAXY SIMULATION", "content": "In this section, we present the results of a simulation of an isolated dwarf galaxy using the surrogate model for SN feedback. The surrogate model is applied for only SNe in environments denser than 1 cm-3 as discussed in Section 2.6. When SNe explode in the environments at a hydrogen number density of < 1cm-\u00b3, the energy of SNe (1051 erg) is injected into the neighboring 100 SPH particles weighted using the Wendland C4 kernel (Dehnen & Aly 2012)."}, {"title": "4.1. Morphology Comparison", "content": "Figure 3 shows the face-on surface density of the gas for two models summarized in Table 1, the fiducial run (SN-DT) on the left and the run with ML (SN-ML) on the right. We find little difference between the two runs when it comes to the morphological structure of the galactic disc. While the morphological structures that emerge on both simulations are supper bubbles driven by clustered feedback, we note that these volume-filling structures are not identical in the two reference runs we carried out. The reason for this is twofold. First of all, the binary executables of the code are not identical, which will lead to small-scale differences in execution. Second, some of the physics modules, such as the IMF sampling for star formation, introduce some randomness in the exact stellar population that is obtained, which in turn influences the feedback cycle due to the different lifetimes of massive stars of a given mass.\nThe ISM structures in our simulations are visually similar to other recent simulations of similar isolated dwarf galaxies (e.g., Smith et al. 2021; Deng et al. 2024; Gutcke et al. 2021; Hu 2019). Fine mass and time resolution are generally required for accurately resolving such superbubbles; otherwise, the hot gas within the bubble cools too quickly, a problem typically referred to as over-cooling. In our new scheme ASURA-FDPS-ML, however, despite the longer timesteps, several distinct superbubbles emerged."}, {"title": "4.2. Star Formation History", "content": "Figure 4 shows the star formation history (SFH), representing the SFRs averaged with an interval of 40 Myr as a function of time. For reference, the red dashed line shows the SFR obtained from the MFM simulation in Steinwandel & Goldberg (2023) as in their WLM-fid simulation. Since the IC of a disk dwarf galaxy does not have steller feedback initially, the galaxies have a high SFR from 0 to 80 Myr.\nThe simulations, SN-DT and SN-ML, have a similar SFR trend, they marginally differ; SN-DT shows an excess of star formation activity in the early stages of evolution, while SN-ML shows an excess of star formation activity in the late stages of the evolution. However, the agreement in the integrated star formation history (total stellar mass formed) is within a few percent between the two simulations, which is within so-called run-to-run variations that have been reported in previous studies of similar simulations (e.g., Steinwandel et al. 2023)."}, {"title": "4.3. Multi-phase structures in ISM", "content": "Figure 5 shows the gas phase structures for the model SN-DT on the left and SN-ML on the right. This is the two-dimensional distribution of mass in the density-temperature plane. These are averaged over 300 Myr with a spacing of 20 Myr (i.e., over 15 snapshots). The two simulations agree remarkably well on the obtained ISM phase structure, having a three-phase SN-driven medium with a diffuse hot phase at low densities, a stable warm neutral (WNM) phase at intermediate densities, and a stable cold phase at high densities. Visually, the model SN-ML has a more extended unstable ISM phase between 0.01 and 100 cm-3, but we note that the difference in absolute mass is negligible."}, {"title": "4.4. Definition of Outflow Rates and Loading Factors", "content": "We follow the definition of the discrete outflow rates for mass and energy proposed in literature (Hu et al. 2017; Hu 2019; Steinwandel & Goldberg 2023) with the net total flow rates defined as M = Mout - Min and E = Eout - Ein. Outflows are computed as the sum of all gas with a positive or negative vertical velocity (uz) in the slab located above or below the disc, respectively. Mass and energy outflow rates are defined as:\n$M_{\\text {out }}=\\sum_{i, v_{z, i}>0} \\frac{m_{i} v_{z, i}}{\\Delta z}$\n$\\dot{E}_{\\text {out }}=\\sum_{i, v_{z, i}>0} \\frac{m_{i}\\left(v_{i}^{2} / 2+u_{i}\\right) v_{z, i}}{\\Delta z}$\nwhere mi and ui are the mass and specific internal energy of SPH gas element, and y = 5/3. We measure the outflow rates and loading factors at two different heights of 1 kpc and 10 kpc in slabs with radii of 5 kpc and thicknesses Az of 0.1 kpc and 1 kpc, respectively. Normalizing these outflows by reference quantities such as the global averaged SFR and SN rate can be useful. Such a normalized quantity is called the loading factor.\n$\\eta_{\\text {out }}^{m}=\\dot{M}_{\\text {out }} / \\mathrm{SFR}$\n$\\eta_{\\text {out }}^{e}=\\dot{E}_{\\text {out }} /\\left(E_{S N} R_{S N}\\right)$\nwhere we adopt Esn = 1051 erg. The mean star formation rate SFR and the mean SN rate Rsn are derived from the simulations. We also define Bernoulli velocity as\n$v_{B}=\\sqrt{\\frac{v^{2}}{2}+\\frac{c_{s}^{2}}{\\gamma-1}}$\nwhere cs := \u221ay(y \u2212 1)u is the sound speed. The Bernoulli velocity can be interpreted as the terminal velocity that an adiabatic wind would reach under the assumption of vs \u226b Vesc where vesc is an escape velocity. We note that we find generally very good agreement with other studies in this field (Hu 2019; Gutcke et al. 2021; Hislop et al. 2022; Steinwandel et al. 2023; Steinwandel & Goldberg 2023; Steinwandel et al. 2024a; Porter et al. 2024) and we will discuss this in greater detail in Section 5."}, {"title": "4.5. Time Evolution and Phase Structure of the Outflows", "content": "Figure 6 shows the mass (top) and energy (bottom) outflow rates (left) and loading factors (right). The yellow lines represent the model SN-ML, and the blue lines represent the model SN-DT. The red dashed lines are the mean values obtained in the MFM simulation (Steinwandel & Goldberg 2023) as in their WLM-fid simulation. We measure these flow rates and loading factors at two different heights, at 1 kpc (solid) and 10 kpc (dashed).\nOne important feature is that while mass outflow and loading factor at 10 kpc are sometimes smaller than those at 1 kpc by as much as one dex, for the energy outflow rates and loading factors, there is only a factor of about 2 differences between 1 kpc and 10 kpc. This indicates that the hot wind transports most of the energy while the cool wind transports most of the mass, which is in very good agreement with other studies of multiphase galactic outflows. We find that such an important feature, as well as other trends, is reproduced in SN-ML."}, {"title": "4.6. Transition of Sub-sonic-Supersonic in the Outflows", "content": "Figure 7 shows 2D joint probability distribution functions (PDFs) of sound speed cs and outflow velocity vout weighted by the mass outflow rate (flux), and Figure 8 shows the same 2D PDFs weighted by energy outflow rate (flux). The top row measures these at a height of 1 kpc, while the bottom row measures these at 10 kpc. The left-hand side of the plots shows the results for SN-DT, and the right-hand side shows those for SN-ML. We note that they generally follow the expected trend of a fully developed phase structure at low altitude (1 kpc), where the outflow can be subdivided into three parts, a cool slow outflow (the fountain with cs ~ 10 km s-1 and yout\u2264 10 km s\u00af\u00b9), the cool fast outflow (the entrained cold material in the hot wind, with cs ~ 10 km s-\u00b9 and vout > 30 km s\u00af\u00b9) and the hot wind with Cs ~ 100 km s-1 and vout ~ 100 km s\u00af\u00b9. In this picture, the cool parts of the outflow carry most of the mass, while the hot parts of the outflow carry most of its energy. At higher altitudes, we find that the cool, slow part of the wind (i.e., the fountain) drops out in both cases, while the cool, fast outflow is mixed into the hot wind. The hot wind itself cools via adiabatic expansion and by mixing in the cool fast part of the wind, which reduces the average sound speed of the hot wind from Cs ~ 100 km s\u00af\u00b9 at 1 kpc height to about cs ~ 30 km s-1 at 10 kpc height. With these PDFs, it becomes clear why the mass outflow rate and mass loading in the time evolution drop by a dex in Figure 6 while the energy outflow rate and energy loading drop by a factor of two when we compare the results at 1 kpc and 10 kpc. We find that the hot wind carries most of the energy while there is almost no mass transport in the hot wind. Since the bulk of the mass transport at 1 kpc is in the fountain, which carries very little energy, this explains the increase in the offset of mass and energy outflow (loading factors) at 10 kpc compared to the results obtained at 1 kpc.\nThese results are in general agreement with similar studies such as Steinwandel et al. (2024a), Kim et al. (2020) and Rey et al. (2024). However, in our model, the hot wind at low altitude appears to be trans-sonic to mildly super-sonic, while in the other mentioned studies, the hot wind is mildly sub-sonic at 1 kpc. At higher altitudes, the hot wind transits, in agreement with these earlier studies, to the strongly super-sonic regime with Mach numbers of up to 30. This is happening in both models SN-DT and SN-ML. The reason for this shift in the sonic point of the wind as a function of altitude is likely related to the details in the cooling and heating physics implemented in each code. A detailed study of the physical conditions of the crossing in the sonic point as a function of altitude between different resolved feedback treatments is beyond the scope of this work.\nFinally, we note that the phase structure in mass and energy at 10 kpc somewhat differs between the runs SN-DT and SN-ML. In SN-DT, we find a similar phase"}, {"title": "4.7. Gas Density Distribution for SN Explosions", "content": "ure 5, it is not unreasonable to assume that a much greater number of massive stars form and explode in dense clouds in SN-DT"}]}