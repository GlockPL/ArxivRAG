{"title": "STContext: A Multifaceted Dataset for Developing Context-aware\nSpatio-temporal Crowd Mobility Prediction Models", "authors": ["LIYUE CHEN", "JIANGYI FANG", "TENGFEI LIU", "FANGYUAN GAO", "LEYE WANG"], "abstract": "In smart cities, context-aware spatio-temporal crowd flow prediction (STCFP) models leverage contextual features (e.g.,\nweather) to identify unusual crowd mobility patterns and enhance prediction accuracy. However, the best practice for\nincorporating contextual features remains unclear due to inconsistent usage of contextual features in different papers.\nDeveloping a multifaceted dataset with rich types of contextual features and STCFP scenarios is crucial for establishing a\nprincipled context modeling paradigm. Existing open crowd flow datasets lack an adequate range of contextual features, which\nposes an urgent requirement to build a multifaceted dataset to fill these research gaps. To this end, we create STContext, a\nmultifaceted dataset for developing context-aware STCFP models. Specifically, STContext provides nine spatio-temporal\ndatasets across five STCFP scenarios and includes ten contextual features, including weather, air quality index, holidays,\npoints of interest, road networks, etc. Besides, we propose a unified workflow for incorporating contextual features into\ndeep STCFP methods, with steps including feature transformation, dependency modeling, representation fusion, and training\nstrategies. Through extensive experiments, we have obtained several useful guidelines for effective context modeling and\ninsights for future research. The STContext is open-sourced at https://github.com/Liyue-Chen/STContext.", "sections": [{"title": "1 INTRODUCTION", "content": "With rapid urbanization, ubiquitous smart devices are collecting massive data with timestamps and location\ninformation. Accurately predicting these spatio-temporal (ST) data is the basis for enterprises and governments\nto make informed decisions for many real-world applications, like bike-sharing [22, 51, 52, 96] and ride-hailing\n[44, 74, 79, 83]. In the realm of ST prediction, contextual features (e.g., weather) have proven to be beneficial\nin a wide variety of applications for distinguishing unusual crowd mobility patterns [37, 87, 98, 109, 125]. For"}, {"title": "2 RELATED WORK", "content": "Spatio-temporal Prediction Datasets\nJust as ImageNet has significantly advanced computer vision research [32], spatio-temporal datasets from\ntraffic sensors, GPS trajectories, and remote sensing have sparked breakthroughs in urban computing, traffic\nmanagement, and intelligent transportation systems. For instance, crowd flow datasets like METR-LA and PeMS\nhave been instrumental in advancing deep learning techniques for traffic prediction [34, 50, 75]. Similarly, datasets\nlike TaxiBJ and BikeNYC have enabled researchers to explore the patterns and anomalies in urban mobility [109].\nQ-Traffic provides publicly available datasets that include diverse auxiliary information, such as road structure\nand public holidays [57]. Recently, LargeST provided a large-scale benchmark with 8,600 sensors across California,\noffering a more realistic scale representation of traffic networks compared to existing datasets [65].\nAlthough existing spatio-temporal crowd flow datasets have made significant progress in data scale and task\ndiversity, they lack comprehensive contextual features. As shown in Table 1, even though open datasets like\nLargeST [65] and UUKG [69] include POI and road data, they still are missing other contextual features such as\nweather. Moreover, most datasets lack any contextual features, highlighting the urgent need for a multifaceted\ndataset with rich context. In contrast, STContext offers a comprehensive collection of contextual data, including\nweather conditions, holidays, POI, AQI, road network details, and demographic data across five STCFP scenarios.\nTo our knowledge, it is the most extensive dataset for developing context-aware STCFP models to date."}, {"title": "2.2 Context-aware Spatio-temporal Prediction Models", "content": "Recent advances in deep learning have significantly improved spatio-temporal crowd flow prediction. From\nthe temporal perspective, various neural network architectures have been introduced to capture dependencies,"}, {"title": "3 THE STCONTEXT DATASET CONSTRUCTION", "content": "Selection of Contextual Features\nTo determine which types of context should be collected, we conducted a comprehensive review of spatio-temporal\nprediction papers presented at over ten renowned venues, including IEEE TMC, UbiComp, KDD, ICDE, WWW,\nWSDM, CIKM, NeurIPS, AAAI, and IJCAI. From over 500 spatio-temporal prediction papers, we identified more\nthan 80 papers that used contextual features to improve crowd mobility prediction accuracy. Based on this\nliterature review, with attention to the public availability of contextual data, we select ten vital types of contextual\nfeatures: historical weather, weather forecast, air quality index (AQI), holidays, temporal position, points of\ninterest (POI), road network information, demographic data, administrative division, and spatial position. Table 2\nlists representative studies and the contextual features they utilized."}, {"title": "3.2 Taxonomy of Contextual Features", "content": "To better understand the characteristics of different types of context, we propose an extensible context\ntaxonomy. The primary challenge in crowd flow prediction stems from complex temporal dynamics and spatial\nheterogeneity [19], where context can provide extra information for temporal or spatial modeling. Based on\nthis insight, we highlight the spatio-temporal properties of the context and classify contextual features into\nthree categories: temporal context, spatial context, and spatio-temporal context, as shown in Figure 1. Temporal\ncontextual features, such as holidays, are dynamic in time and homogeneous in space, which implies that they\nremain consistent across various locations during the same period. We refer to these features as $T = \\{T_1, T_2, ...\\}$.\nEach element in T includes a timestamp and observation value (e.g., 2014-11-27, Thanksgiving Day). Spatial\ncontextual features are static in time and heterogeneous in space, while spatio-temporal contextual features vary\nover both time and space. These are represented as $S = \\{S_1, S_2, . . .\\}$ and $ST = \\{e_1, e_2, . . . \\}$, respectively. Each S\nelement includes a location and observation value, while each ST element includes a timestamp, location, and\nobservation value.\nWeather and AQI are categorized as spatio-temporal contextual features in our taxonomy. Historical weather\nand AQI data are typically collected from meteorological stations equipped with multiple sensors [28, 33]. For\ninstance, in New York City, there are three weather monitoring stations and over ten pollutant monitoring\nstations. Taking the weather station named LGA as an example, the LGA station reports 20+ variables at around\nthe 51st minute every hour. Forecast weather data is generated by numerical prediction models that operate at\nspecific intervals with a fixed spatio-temporal granularity. For instance, the Global Forecast System (GFS) runs its"}, {"title": "3.3 Data Source Investigation", "content": "To comprehensively collect the reliable context data selected in Section 3.1, we investigate various data sources\nthrough previous research and online resources. Table 3 summarizes the sources of different contextual features,\ntheir spatio-temporal ranges and granularity, and their accessibility (whether real-time or historical data is\navailable). Note that we define the spatial granularity of historical weather and AQI based on the entire city area\nrelative to the number of meteorological stations, ensuring it approximately represents the monitoring range. For\ninstance, as shown in Table 3, an ASOS meteorological station typically monitors weather states over 1000 km\u00b2.\nFor weather forecasts, we record the size of the basic grid used in the numerical weather forecasting model [6, 8].\nWe also report the average area covered by spatial contextual features, represented as geographic polygons (e.g.,\nadministrative divisions or census tracts for demographic statistics).\nWhen collecting context from these resources, we filtered out some data sources that did not meet specific\ncriteria. For historical weather and forecasts, we excluded Accuweather and Open Weather due to their lack of\nhistorical archives (i.e., only providing real-time data) and the additional fees required, respectively. We also chose\nnot to use GFS because of its shorter temporal range (i.e., accessible from 2015 onward) and coarser temporal\ngranularity (i.e., 3 hours) compared to ECMWF. For AQI, we selected EPA as it is the only source with accessible\nhistorical records. Additionally, we excluded POI and Road Network sources that required extra fees, such as\nFoursquare and GoogleMap. No exclusions were made for demographics and administrative division sources.\nAs we exclude certain resources for building STContext, we encourage users to carefully consider task\nrequirements and select appropriate data sources. For instance, if accurate and comprehensive commercial POI\ndata is needed, GoogleMap may be a better choice than OpenStreetMap. We believe the table of investigated data\nsources will benefit a wide range of researchers."}, {"title": "3.4 Multi-Source Data Fusion Procedure", "content": "After investigating data from various sources, we found multiple qualified options for historical weather (e.g.,\nASOS and NOAA). Unlike most previous work that relied on a single source [104, 109], we argue that collecting\nand fusing data from multiple sources can enhance dataset quality and propose a multi-source data fusion\nprocedure."}, {"title": "4 STCONTEXT DATASET", "content": "Basic Statistics\nAs shown in Table 4, the STContext comprises 9 crowd flow datasets spanning 4 months (e.g., Vehicle Speed\ndataset in BAY) to 7 years (e.g., Ride-sharing in NYC) across 5 tasks and 6 cities, ensuring a rich diversity in both\ncity coverage and time span. We collected 10 contextual features matched to each crowd flow dataset's spatio-\ntemporal range, except for the pedestrian dataset in Melbourne (due to data source limitations shown in Table 3).\nTable 4 provides details on the crowd flow datasets and their associated contextual features (excluding spatial\nand temporal positions that can be generated). For researchers' convenience, we summarize the dimensionality,\nmissing rate, and number of spatial units for spatio-temporal context, the number of events for temporal context,\nas well as the number of classes and records for spatial context."}, {"title": "Variations in time and space", "content": "Modeling context features is complex due to inherent temporal dynamics and\nspatial heterogeneity, as discussed below:"}, {"title": "Temporal Dynamics", "content": "The temporal dynamics of contextual features are complex, often displaying long-term\ntrends and short-term periodicity due to natural laws [39]. For example, as shown in Figure 3 in New York City\ntemperature data from May to August 2014, the temperature rises gradually with seasonal change and fluctuates\ndaily due to day-night cycles. These patterns result from the Earth's revolution, driving seasonal shifts, and its\nrotation, producing daily cycles."}, {"title": "Spatial Heterogeneity", "content": "At the city scale, contextual features demonstrate spatial heterogeneity. As illustrated\nin Figure 4, data from 43 AQI monitoring stations in New York City over one year shows that the average relative\nconcentration of SO2 is lowest in Long Island, followed by Queens, while Manhattan and the Bronx exhibit higher\nSO2 concentrations. This spatial heterogeneity may stem from the more developed economy and the greater\nnumber of factories in the city center, contributing to higher SO2 emissions compared to the suburbs."}, {"title": "Imbalanced distribution of contextual features", "content": "Contextual features are often unevenly distributed across\ntime and space. For instance, as shown in Figure 5, snowfall in NYC primarily occurs from November to December,\nwhile rain occurs mainly from March to January and October to November, both representing a relatively low\nproportion of the total period. Similarly, as illustrated in Figure 6, NYC's POI density is higher in central areas\n(e.g., Manhattan) and lower in surrounding suburbs (e.g., Brooklyn, Queens). These imbalanced distributions\nabove suggest a need for more fine-grained evaluation scenarios from both temporal and spatial dimensions\nbeyond overall metrics, as later discussed in empirical studies (see Section 6.2.1)."}, {"title": "4.2.3 Correlations between contextual features and crowd flow", "content": "The influence of contextual features on crowd\nflow varies by both context type and flow type. Figure 7 and Figure 8 illustrate crowd flows during specific\nweather conditions or severe air pollution events (PM 2.5 above 40\u00b5g/m\u00b3 per hour [31]) compared to flows from\nprevious weeks, showing a clear correlation due to high weekly periodicity [86, 109]. When weather or air quality\naffects mobility, the flow curve steepens or flattens. These figures reveal that rain significantly impacts bike\nflow but has less effect on taxi flow. In contrast, air pollution has minimal influence on both bike and taxi crowd\nflows. Moreover, Figure 9 shows the correlation between spatial contextual features (POI and demographics) and\nbike flow. We find a moderate positive correlation between POI and bike flow (Pearson coefficient: 0.55), while\ndemographics show a weak correlation (Pearson coefficient: 0.18). Figure 10 shows the relationship between POI\nand crowd flow (bike and traffic speed flow). POI exhibits a moderate positive correlation with bike flow (Pearson\ncoefficient: 0.55) but shows no significant association with traffic speed flow (Pearson coefficient: 0.09)."}, {"title": "5 A UNIFIED PARADIGM FOR CONTEXTUAL FEATURE INCORPORATION", "content": "Overview\nWe decompose the STCFP context incorporation process into four components (Figure 11 and Figure 12): (a)\nfeature transformation, (b) dependency modeling, (c) representation fusion, and (d) training strategies. First,"}, {"title": "5.2 Key Components and Design Choices", "content": "We discuss the basic assumptions of four key components, including feature transformation, dependency modeling,\nfusion techniques, and training strategies, along with several representative options for each."}, {"title": "5.2.1 Feature Transformation", "content": "The purpose of feature transformation is to retrieve useful contextual features for\npredicting crowd mobility, typically as part of data pre-processing [24, 101]. Most existing studies, as discussed\nlater, adopt a similar transformation hypothesis (i.e., closeness or proximity). While they are reasonable, we\nbelieve that feature transformation has been somewhat overlooked and warrants more careful consideration. We\nhere elaborate on three types of transformations and their underlying hypotheses."}, {"title": "Spatial transformation", "content": "Most methods focus on the idea that things closer together are more related (i.e.,\nproximity), as suggested by Waldo R. Tobler in 1969: 'Everything is related to everything else, but near\nthings are more related than distant things.' Accordingly, nearby context can be treated as spatial properties\nof the predicted crowd flow stations [56, 101]. In practice, we first identify a spatial area where the contexts\nare assumed to influence the predicted crowd flow. Then, we convert the context within this area into\nspatial features using techniques like summation [22] or distance-based decay [56, 101]. Figure 13 shows an\nexample of spatial transformation, where the inner and outer circles represent different regions affecting\ncrowd mobility. Finally, we aggregate four types of contextual features by counting."}, {"title": "Temporal transformation", "content": "Contextual features from nearby times exhibit temporal autocorrelation [19, 109], so\nthe hypothesis of temporal closeness is often used in temporal transformations. Figure 14 shows an example\nof temporal transformation. A meteorological station recorded weather observations at 9:33 AM, 10:20 AM,\n11:08 AM, and 11:53 AM. To estimate the weather at 12:00 PM, we may use the 11:53 AM observation, as it\nis closest to the target time."}, {"title": "Spatio-temporal transformation", "content": "Spatio-temporal transformations can be regarded as an integration of\ntemporal and spatial transformations, thus adopting the hypothesis of both spatial proximity and temporal\ncloseness."}, {"title": "Dependency Modeling", "content": "Considering that contextual features have their distinct characteristics (e.g., tempo-\nral dynamic for temporal context), dependency modeling aims to learn more effective compressed representations\nusing deep learning techniques (e.g., GNNs for spatial representation [112]). As shown in Figure 15, the depen-\ndency modeling can be reviewed by answering the following three research questions from temporal and spatial\nviews, respectively."}, {"title": "From the temporal view, we have two research questions to answer", "content": "RQ1) Are temporal contextual features\nconsidered? RQ2) Do forecasted contextual features impact crowd flow? If the answer to RQ1 is yes, the temporal\ndynamic hypothesis suggests that the impact of contextual features changes over time, which helps model\nthe temporal heterogeneity (e.g., daily patterns differ between weekdays and weekends [66, 100]) of crowd\nflow [88]. If temporal contextual features are considered, the second research question (RQ2) then examines\nwhether forecasted context is included, leading to two hypotheses: i) The known hypothesis suggests that\nonly known contexts (e.g., historical weather, scheduled public holidays) affect crowd mobility. ii) The\nknown & forecast hypothesis argues that both known and forecasted contexts influence crowd mobility.\nThis hypothesis is based on the idea that forecasted weather, such as increased wind speed, can lead to\nbetter pollutant dispersion compared to previous calm conditions, thus improving air quality. Consequently,\nforecasted weather is crucial for air quality forecasting [101] and may further affect crowd mobility."}, {"title": "From the spatial view, we have another research question to answer", "content": "RQ3) Do the same contextual features\nhave a similar effect on crowd flow at different locations? The space-invariant hypothesis suggests that context\neffects are similar across different locations, while the space-varying hypothesis indicates that context effects\nvary by location [120]. The space-invariant hypothesis suggests that context affects all locations similarly\n[55], as heavy rain may affect different city regions equally. This hypothesis can be implemented by sharing\nlearnable parameters across locations. Conversely, the space-varying hypothesis posits that context affects\nlocations unevenly, as rain impacts commercial and residential areas in varying degrees."}, {"title": "5.2.3 Fusion Techniques", "content": "In recent years, various feature fusion techniques have been developed to integrate\ncontext and crowd flow representations for learning more comprehensive representations [61, 121, 126]. Among\nthem, feature concatenation is widely used to fuse features, assuming a low correlation between them to avoid\nredundancy [24]. In contrast, addition-based methods assume that crowd flow representations and contextual"}, {"title": "5.2.4 Training Strategies", "content": "The goal of training strategies is to optimize three networks: the spatio-temporal\ncrowd flow backbone network for learning mobility data patterns, the context network for capturing context\ndependencies, and their fusion network. A straightforward training approach is to combine these networks (as\nshown in Figure 12) and train them together in an end2end manner, where all three networks are optimized from\nscratch using back-propagation. Alternatively, the pretrain and finetune strategy first trains the traffic backbone\nnetwork for prediction tasks, then freezes it while finetuning the context and fusion networks [22]. This approach\nmay be more effective because traffic patterns are typically more complex than context patterns, resulting in\nthe context network having fewer parameters and requiring less gradient propagation [48, 78]. Additionally,\npretraining and freezing the traffic backbone may help prevent overfitting, as it allows the traffic network to\nfocus solely on learning the traffic patterns, potentially improving generalizability."}, {"title": "6 EMPIRICAL STUDIES", "content": "In this section, we elaborate on further explorations enabled by the STContext dataset and the proposed context\nincorporation paradigm. We first detail the evaluation settings in Section 6.1. Next, we explore the components\nof our proposed context incorporation paradigm. While previous studies have examined representation fusion\ncomponents, such as late and early fusion techniques [59, 110], and recent research has evaluated existing fusion\nmethods through extensive benchmarks [24], our study focuses primarily on the modeling hypothesis and training\nstrategies components in Sections 6.2 and 6.3, respectively. Then, we comprehensively evaluate all the contexts\nwe have gathered in Section 6.4. Based on these results, we conclude several important findings."}, {"title": "Evaluation Configurations", "content": "Datasets. STContext includes nine datasets across five typical STCFP tasks. We selected five datasets from\ndifferent tasks for benchmark experiments to ensure the generalizability of our conclusions. Each dataset covers\nsix months with a time granularity of 60 minutes. We divided the dataset into training, validation, and test sets in\nchronological order, using the last 20% of the duration for testing and the 10% prior to that for validation. Table 6\npresents the statistics for the datasets used in our benchmark experiment."}, {"title": "Evaluation Metrics", "content": "We employ RMSE (Root Mean Square Error) and SMAPE (Symmetric Mean Absolute\nPercentage Error) as our evaluation metrics as in previous studies [23, 43, 109, 120]. Previous methods evaluate\ncontext-aware STCFP models using a single metric for the entire dataset (e.g., overall RMSE) [95, 109]. However,\nwe argue that contexts like rain, strong winds, and dense fog are less common than clouds or haze, and relying on"}, {"title": "6.2 Analysis of Modeling Hypotheses", "content": "According to our paradigm (see Section 6.2), we can adopt known or known & forecast hypotheses to model\ntemporal dependencies, while space-invariant and space-varying model spatial dependencies. To evaluate the\neffectiveness of these modeling hypotheses, we conduct experiments using spatial context (i.e., POI), temporal\ncontext (i.e., temporal position), and spatio-temporal context (i.e., weather). We selected these contextual features\nbased on their proven effectiveness in previous studies [51, 79, 104]. Table 7 displays the results of incorporating\nweather (spatio-temporal context) across four modeling hypotheses, while Table 8 shows the results for POI"}, {"title": "6.2.1 Scenario-specific metrics are better suited than overall metrics for evaluating context-aware STCFP models", "content": "As\nshown in Table 7, the known and forecast & space-invariant variant in the Bike_NYC dataset, while significantly\noutperforming No Context, shows minimal overall improvement (less than 0.3% in RMSE), suggesting that weather\nfeatures may have limited impact on crowd mobility. However, in specific scenarios (e.g., rain, wind, and fog), it\nachieves over a 2.7% improvement compared to No Context. This discrepancy arises because samples associated\nwith significant rain, wind, and fog represent only around 8%, 10%, and 5% of the total samples, causing overall\nindicators to dilute the model's impact on these instances. Therefore, to comprehensively and accurately assess\nthe performance of context-aware STCFP models, it is essential to construct appropriate evaluation scenarios. We\nappeal to design scenario-specific evaluations based on the context characteristic itself. For example, considering\nthat the aim of taking weather into STCFP models is to enhance the prediction under extreme weather, which is\nrare in real-world scenarios, evaluating models in such atypical weather states is a reasonable way."}, {"title": "6.2.2 The space-varying modeling hypothesis, while taking more parameters, does not outperform the space-invariant hypothesis", "content": "As shown in Table 7 and Table 8, space-varying variants, which assume that context affects\neach location differently (e.g., heavy rain impacting commercial and residential areas unequally), generally do not\noutperform space-invariant variants across most tasks. Even in both central and non-central areas, space-invariant\nvariants perform similarly to space-varying variants, indicating that both hypotheses may learn comparable\ncontext representations. This outcome is somewhat surprising, as space-varying variants have more parameters\nand were expected to perform better [120]. The inconsistent result may stem from two issues. First, the space-\ninvariant hypothesis may be inherently more robust, suggesting that contextual features like weather and POI\noften exert similar effects across urban areas. Second, the added complexity of the space-varying hypothesis\nmakes it harder to optimize, increasing the risk of overfitting."}, {"title": "6.2.3 Combining effective spatial and temporal dependency modeling leads to better predictions than using either alone", "content": "Table 8 shows that applying the space-invariant and known hypotheses to POI and temporal position,\nrespectively, significantly outperforms the No Context baseline, confirming their effectiveness and aligning with\nprior studies [55, 99]. We observe that integrating temporal position with the known hypothesis produces a greater\nimprovement (e.g., over 9% RMSE reduction in Taxi_NYC) than incorporating POI through the space-invariant\nhypothesis, which is also consistent with past findings [24]. As these hypotheses independently learn context from\ntime and space, the known & space-invariant combination merges them through concatenation, forming a spatio-\ntemporal context that varies across time and space. This combined variant generally surpasses the performance"}, {"title": "6.2.4 The spatial modeling hypothesis applied to POI generally performs better in central areas than in non-central areas", "content": "As shown in Table 8, the spatial modeling hypotheses (i.e., space-invariant (POI) and space-varying (POI))\ngenerally outperform No Context, achieving over 1.8% RMSE improvement in Bike_NYC. This demonstrates the\neffectiveness of both POI and the space-invariant modeling hypothesis. More specifically, prediction improvement\nis generally greater in central areas than in non-central areas, indicating that the modeling hypothesis learns\nmore effective POI representations in locations with much greater crowd flow. This phenomenon may stem\nfrom data quality bias, as central areas represent urban cores with high density and diversity of facilities (e.g.,\nbusiness centers, transportation hubs) and increased crowd flow. These regions often display greater diversity in\nspatial data, with a higher number and variety of points of interest [105]. In contrast, non-central areas, such\nas suburbs, have more dispersed data points and a narrower variety of POI types. The data richness in central\nareas likely enhances model accuracy by providing more robust samples and distinctive features, which helps\nin distinguishing regions with different functions. Hence, it is of great importance to verify spatial data quality\nwhen applying spatial modeling hypotheses."}, {"title": "6.2.5 Accurate forecast data helps enhance prediction performance", "content": "As shown in Table 7, the known and forecast\nvariants outperform the known variants in Bike_NYC, indicating that forecast information is beneficial for bike\nflow prediction. However, forecast data can often be inaccurate (e.g., weather forecasts could vary from actual\nconditions). To explore the impact of more accurate forecast data, we introduce a new variant, known and forecast\n(oracle), which replaces forecasted weather with actual data collected later. The experimental results in Figure 17\n(with the vertical axis showing improvement over No Context) reveal that the forecast (oracle) variant significantly\nimproves performance in the overall, rain, and fog scenarios. It suggests that forecast accuracy is likely a crucial\nfactor in limiting the forecast hypothesis for further enhancing prediction performance."}, {"title": "6.3 Analysis of Training Strategies", "content": "To evaluate the effectiveness of different training strategies, we conduct experiments comparing end2end training\nwith pretrain and finetune (PT&FT) across five datasets, with results shown in Table 9. We utilize the combination\nof temporal position and POI, which proved effective in the previous experiments (see Table 8). From the results,\nwe make the following observations."}, {"title": "6.3.1 Both end2end training and PT&FT are effective strategies for learning context representations", "content": "Table 9 shows\nthat both end2end and PT & FT significantly outperform No Context (p < 0.05), indicating that both strategies\neffectively learn crowd flow and context representations for prediction. This aligns with prior research findings\n[55, 99, 120] showing strong results with end2end training. Furthermore, while PT & FT generally outperforms\nend2end, as later discussed, their RMSE and SMAPE metrics differ by less than 1%. Thus, compared to decisions\naround contextual feature selection or modeling hypotheses, the impact of choosing between these training\nstrategies is relatively minor."}, {"title": "PT&FT is generally better than end2end training in learning context representations", "content": "As shown in Table 9,\nPT&FT and end2end training perform similarly across all datasets in RMSE and SMAPE, although small differences\nexist. Specifically, PT&FT generally outperforms end2end in most datasets, with improvements of up to 0.66% in\nterms of RMSE, suggesting it learns slightly better representation for predictions. This aligns with our expectations,\nas crowd flow patterns are often more complex than context patterns, resulting in crowd flow backbone networks\nhaving more parameters [55, 111]. In end2end training, we simultaneously optimize context and crowd flow\nnetworks through gradient backpropagation. However, context networks may converge before crowd flow\nnetworks do, causing ongoing gradients from end2end training to update context networks, which increases the\nrisk of overfitting and may degrade generalizability [48, 78]."}, {"title": "6.4 Analysis of Contextual Features", "content": "AQI is less effective for enhancing crowd mobility prediction, likely due to people's high tolerance for air\npollution in their mobility patterns. To explore the impact of different types of spatio-temporal context on crowd\nflow prediction, we conducted experiments using AQI in the Bike_NYC, Taxi_NYC, and Metro_NYC datasets.\nSince forecast AQI data is unavailable, we model context dependencies using known variants. The results in\nTable 10 show that AQI contributes minimally across all tasks (yielding less than a 0.1% improvement compared"}, {"title": "6.4.2 Spatial contextual features can enhance crowd mobility prediction, but their effectiveness varies by task", "content": "To\ncompare the effectiveness of various spatial contexts, we conducted experiments on five datasets using different\nspatial context types (POI, Administrative Division, Demographics, and Road) combined with temporal position."}, {"title": "Fast food, restaurants, and cafes are beneficial POI types with good generalizability for crowd mobility prediction", "content": "To evaluate the impact of various types of POI on crowd flow prediction, we conducted ablation\nexperiments on the Taxi_NYC, Metro_NYC, and Pedestrian_MEL datasets. We first trained a baseline model\nincluding all POI types, and we set each POI feature input to zero individually to observe performance changes.\nGreater performance degradation indicates higher importance of that POI type. Table 12 lists the top five most\nimportant POI types across all datasets. Notably, fast food, restaurants, and cafes enhance prediction performance\nacross tasks, showing their effectiveness and generalizability. As revealed in previous research [118], regional\nattributes have a strong causal relationship with human mobility, with dining areas attracting people at mealtimes.\nThese findings can guide POI selection for crowd flow prediction and support the potential transferability of\nmodels across diverse tasks."}, {"title": "7 DISCUSSION", "content": "Potential Research and Applications of the STContext Dataset\nWe argue that the STContext dataset opens up diverse research directions for machine learning scientists and\nurban transportation researchers. Machine learning scientists may leverage this dataset to develop robust crowd\nflow prediction models by integrating various contextual factors. That is, building powerful general models that\nfully utilize diverse contextual features, which help improve the accuracy of crowd mobility predictions. By\ntraining models on this comprehensive dataset, researchers may create context-aware one-for-all foundation\nmodels for crowd flow prediction in diverse spatio-temporal tasks. Additionally, the STContext dataset presents\na challenging setting for machine learning techniques such as few-shot learning [89] where extreme weather\nconditions, despite their rarity, significantly impact crowd mobility.\nFor urban transportation researchers, the STContext dataset aids in understanding how different contextual\nfactors influence mobility patterns. For example, analyzing the effects of holidays or extreme weather on crowd\nflow can inform infrastructure development and policy decisions. Insights gained from these relationships can\nenhance crowd mobility simulations, leading to the formulation of improved urban policies aimed at enhancing\npublic transit and reducing traffic accidents [71, 76]."}, {"title": "7.2 Limitations & Future Work", "content": "We primarily collect publicly available data due to licensing constraints, which may result\nin lower quality compared to commercial sources. For instance, our POI data from OpenStreetMap has several\nlimitations: some areas lack sufficient POI coverage, user tagging can be inconsistent, updates may be delayed,\nand geographic accuracy can be questionable. Many POIs also lack detailed information, such as operating\nhours or contact details. In contrast, Google Maps, which charges based on API calls, offers more comprehensive\ncoverage by leveraging user-generated content, business partnerships, and proprietary data, resulting in higher\naccuracy and quality. We recommend that the research community select data sources tailored to their specific\ntasks. Besides, our selection of contextual features is primarily influenced by research in the past few years, which\nmay introduce feature selection bias. For instance, if a contextual feature significantly impacts crowd mobility\nbut hasn't been well studied, it might be overlooked in STContext. To address this issue, we plan to continuously\nmaintain and update STContext, ensuring it remains beneficial for the research community over the long term."}, {"title": "Future Work", "content": "While we conduct experiments on five typical STCFP tasks, expanding our scope to include\na wider range of datasets and tasks may enhance the comprehensiveness of our findings. Moreover, we select\nMTGNN [90", "43": "."}]}