{"title": "Equivariant Blurring Diffusion\nfor Hierarchical Molecular Conformer Generation", "authors": ["Jiwoong Park", "Yang Shen"], "abstract": "How can diffusion models process 3D geometries in a coarse-to-fine manner,\nakin to our multiscale view of the world? In this paper, we address the question\nby focusing on a fundamental biochemical problem of generating 3D molecular\nconformers conditioned on molecular graphs in a multiscale manner. Our approach\nconsists of two hierarchical stages: i) generation of coarse-grained fragment-level\n3D structure from the molecular graph, and ii) generation of fine atomic details from\nthe coarse-grained approximated structure while allowing the latter to be adjusted\nsimultaneously. For the challenging second stage, which demands preserving\ncoarse-grained information while ensuring SE(3) equivariance, we introduce a\nnovel generative model termed Equivariant Blurring Diffusion (EBD), which\ndefines a forward process that moves towards the fragment-level coarse-grained\nstructure by blurring the fine atomic details of conformers, and a reverse process\nthat performs the opposite operation using equivariant networks. We demonstrate\nthe effectiveness of EBD by geometric and chemical comparison to state-of-the-\nart denoising diffusion models on a benchmark of drug-like molecules. Ablation\nstudies draw insights on the design of EBD by thoroughly analyzing its architecture,\nwhich includes the design of the loss function and the data corruption process.\nCodes are released at https://github.com/Shen-Lab/EBD.", "sections": [{"title": "1 Introduction", "content": "The advancement of generative models to understand the multiscale properties of objects facilitates their application across a range of granularity levels, transcending individual scales. To enable generative models in processing multiscale structures, there has been a surge in hierarchical design methodologies across multiple domains, spanning from images [35, 40] to speech [20, 17]. These methods initially capture coarse-grained structures and subsequently generate finer details.\nIn the field of computer vision, recent efforts [16, 42, 2, 7] have yielded successful designs of coarse-to-fine generative frameworks for 2D pixels of images, leveraging denoising diffusion models that corrupt and restore the data by adding and removing noises [49, 50, 52, 15, 27]. Notably, [42] generates images from blurred prior distributions (average of pixel intensities) motivated from the heat equation of partial differential equations as Fig. 1."}, {"title": "2 Background", "content": "In the field of biochemistry and drug discovery, however, denoising diffusion models for 3D conformers of stable molecular structures have not yet taken advantage of coarse-to-fine multiscale frameworks. Current methods either disregard the scale hierarchy [46, 59, 19, 23, 60] or consider that in very limited ways [38, 41]. For instance, within the recent hierarchical method of unconditional conformer generation [38], a denoising diffusion model [19] is solely applied to generation of coarse-grained structure, without extending to coarse-to-fine generation.\nThe primary bottleneck in extending denoising diffusion models for molecular conformers to hierarchical designs is that random noise corrupts not only fine atomic details but also structural information of coarse-grained structures indiscriminately. To tackle this challenging problem, we exploit fragments that are frequently occurring substructures or functional groups in 2D molecular graphs. These fragments can be a promising candidate for the coarse-grained structural information in 3D geometry. Introducing fragments divides the generation process into two stages: i) generating coarse-grained structures represented by fragments, and ii) restoring fine atomic details from fragment structures. In the first stage of generating fragment coordinates from molecular graphs, we efficiently generate approximations of fragment structures comprising the center of mass and attributes of each fragment from a cheminformatics tool.\nFor the challenging second step of coarse-to-fine generation, we propose a novel diffusion model, Equivariant Blurring Diffusion (EBD) detailed as follows. Motivated from the blurring corruption of the heat equation [42], we design EBD to generate 3D molecular conformers from coarse-grained fragment approximated structures as Fig. 1, rather than from random noise. In our design of EBD, the forward process moves atom positions of conformers towards the center of mass of their respective fragments, while the reverse process restores full-atom details from the prior distribution of the 3D fragment structure. The blurring schedule we designed for EBD allows the diffusion model to focus on restoring fine atomic details while retaining coarse-grained information throughout the entire generative process. We validated our coarse-to-fine EBD model using a benchmark of drug-like molecules. We obtained superior results in conformer generation compared to the denoising diffusion model, even with 100 times fewer diffusion time steps.\nThe major contribution of this paper can be summarized as follows:\n\u2022 We design EBD which generates atomic details from coarse-grained estimation of fragment structures using equivariant networks, motivated by the blurring corruption of heat equation.\n\u2022 We propose a novel blurring scheduler and a revised loss function that significantly impacts performance, instead of directly applying those of existing image blurring diffusion model.\n\u2022 We conduct a thorough analysis of the effects of fragment granularity, data corruption methods, and loss reformulation. We obtained geometrically and chemically more plausible conformers compared to state-of-the-art denoising diffusion models."}, {"title": "2.1 Blurring diffusion", "content": "The denoising diffusion models [49, 50, 52, 15, 27], which corrupt data by adding random noise and generate data through denoising, have significantly advanced across diverse domains [55, 54, 44]. Recently, a few works [2, 42, 7, 18] have introduced data corruption into the design space of diffusion models [26], going beyond random noise corruption in the vision domain.\nInverse Heat Dissipation Model (IHDM) [42] proposed a coarse-to-fine generation in the pixel space. Their forward process follows a partial differential equation of heat dissipation on grids:\n$\\frac{\\partial}{\\partial t} x(i, j, t) = \\Delta x(i, j, t),$\nwhere x represents the data on the grid and \u0394 is the Laplacian operator. IHDM derived the solution of this equation at time step t, xt, using eigendecomposition of \u0394 as:\nxt = B_t x_0 = V \\text{exp}(-A t) V^T x_0,$\nwhere VT and \u039b are discrete cosine transform and a diagonal matrix whose elements are eigenvalues of \u0394, respectively. As t \u2192 T, the eigenbasis of eigenvalue 0 only remains and this leads to the"}, {"title": "2.2 Equivariance", "content": "In this work, we consider the SE(3) group to address the roto-translational equivariance of molecular conformers [28, 19, 59]. A function f is equivariant to a group G if Tg(f(x)) = f(Sg(x)) holds for all g \u2208 G, where Tg, Sg are transformations of the group element g. In our coarse-to-fine generative framework, the invariant prior distribution of coarse-grained structure represents the coordinates of fragments. Therefore, the design of the transition distribution and the loss function in our diffusion model need to ensure that the generated likelihood is invariant, so that the generated conformers are not affected by rotation or translation."}, {"title": "3 Methods", "content": ""}, {"title": "3.1 Problem definition", "content": "Suppose that we have a molecular graph G whose nodes V are n atoms with SE(3)-invariant features ha \u2208 Rnxd and edges & are inter-atomic bonds. Our objective is to generate an ensemble of 3D molecular conformers xa \u2208 Rn\u00d73 given G. Our hierarchical approach is in two stages. i) p(xf|G):\ngenerating a coarse-grained 3D structure of fragment coordinates xf \u2208 Rm\u00d73 from G which was decomposed into m fragments, and ii) p(xa|xf, G): the diffusion model generating fine atomic details xa \u2208 Rn\u00d73 conditioned on the generated fragment structure xf. To map between atoms and their respective fragments, we defined a mapping matrix M \u2208 Rn\u00d7m with Mik = 1 if the i-th atom\nbelongs to the k-th fragment and 0 otherwise. Mxf makes each atom located at its respective fragment.\nOn the other hand, M\u2020xa results in fragment coordinates being the average of the coordinates of its\nconstituent atoms, where M\u2020 is a pseudoinverse matrix of M (M\u2020M = I)."}, {"title": "3.2 Fragmentation and 3D fragment structures", "content": "We decompose a molecule G = (V, E) into m non-overlapping fragments {Sk}m\nk=1, where Sk =\n(Vk, Ek) and V = Uk=1 Vk, E = Uk=1 Ek using Principal Subgraph (PS) [29]. Starting from all\nunique atoms in the fragment vocabulary S, PS iteratively merges neighboring fragments. The most\nfrequent fragment among the newly merged fragments was added to the vocabulary at each iteration,\nwhich was repeated until the desired size of the vocabulary was reached. The smaller the size of\nfragment vocabulary, the finer fragments and detailed coarse-grained structures can be obtained. After\nfragmentation was finished, from the relation between {Vk}m\nk=1 and V, the mapping matrix M can\nbe constructed.\nTo generate the initial coordinates of fragments, we utilize RDKit distance geometry [5, 31], an\nefficient cheminformatics tool, instead of training an additional deep generative model. After\ngenerating initial atom coordinates xa \u223c PRDKit(xa), we define the initial fragment coordinates xf\nas averages of their constituent atom coordinates, M\u2020xa. Since the atom coordinates generated by"}, {"title": "3.3 Equivariant blurring diffusion", "content": "In this subsection, we elaborate on the design of our diffusion model, Equivariant Blurring Diffusion\n(EBD), drawing inspiration from the principles of the heat equation. This model is designed to\ngenerate fine details of conformers xa, starting from a coarse-grained, approximate structure xf and a\nmolecular graph G. We introduce a forward process and a data corruption function of blurring process\nin Sec. 3.3.1, a reverse process and a deblurring network to reach an SE(3)-invariant likelihood in\nSec. 3.3.2, and a definition and reparameterization of an SE(3)-invariant loss function in Sec. 3.3.3.\nThe overall scheme of EBD is illustrated in the step 2 of Fig. 2."}, {"title": "3.3.1 Forward process and blurring schedule", "content": "We define the data corruption of the forward process as a blurring operation that gradually shifts\nground truth atom positions xa \u223c q(xa) to their corresponding fragment coordinates:\nq(xqt|x0, xf) = N(xqt|fB(xa, xf, t), \u03c32I),\nwhere fB is a deterministic blurring operator. Consequently, every atom will be positioned according\nto its fragment coordinates Mxf in the prior fragment structure distribution.\nWhen defining fB for the forward process, we cannot directly adopt the spectral blurring operator\nBt = Vexp(\u2212\u039bt)VT of IHDM [42] in Eq. (2) for the two reasons: i) For a single molecule, we\nneed to calculate and decompose the fragment graph Laplacian {Vk\u039bkVkT}m\nk=1 for each fragment\nSk = (Vk, Ek), unlike a single Laplacian operator per image in IHDM. Given the varying sizes and\nstructures across fragments, it becomes challenging to uniformly adjust the movement of atoms\nacross all fragments using a function of {\u039bk}m\nk=1 in spectral space. ii) As t \u2192 T, the ground truth\natom coordinates xa will converge to the ground truth scaffold structure xf = Btx by spectral"}, {"title": "3.3.2 Reverse process and deblurring networks", "content": "The aim of the reverse process is to generate fine details at the atom-level from a prior distribution\nof 3D fragment structure p(x0|xf) = N(x0|Mxf, \u03b42I) that is roto-translational invariant to the group.\nDrawing upon proofs regarding the conditions for an invariant likelihood [28, 59], we develop the\ndeblurring process on the zero center-of-mass subspace using equivariant transition distributions:\np\u03b8(x0t\u22121|x0t, xf, G) = N(x0t\u22121|\u00b5\u03b8(x0t, xf, G, t), \u03b42I),\nwhere \u00b5\u03b8 is a parameterized mean function consisting of a deblurring network. To ensure equivariance\nin the transition distribution, we devise \u00b5\u03b8 inspired by equivariant networks [45]. Our equivariant\ndeblurring network updates invariant features of fragments and atoms hf, ha, (Eqs. (9, 10)), and the\nequivariant coordinates of atoms xa (Eq. (11)) by leveraging the hierarchical relationship between\natoms and fragments. Let the i-th atom xa belongs to the k-th fragment xf, then the l-th layer of\nequivariant deblurring networks for fragment- and atom-level message passing and feature updates is\ndefined as follows:\nmf,l+1ij = \u03c6(mf(hf, ha, ||xai \u2212 xfj||)),\nhf,l+1i = \u03c6(hl(hi, \u2211j\u2208N(xi) maf,l+1ij , hal)),\nma,l+1ij = \u03c6(ma(ha, hlj, ||xai \u2212 xaj||)),\nha,l+1i = \u03c6(ha(hai, \u2211j\u2208N(xi) maa,l+1ij , hal)),\nxla+1\n= xal + \u2211j\u2208N(xi)\nxjal \u2212 xail\ndal+1ij\n\u03c6(\u03c7(hal+1i , hal+1j , ||xal \u2212 xalj ||)),\n+ xfal \u2212 xal\n\u03c6(\u03b7(hal+1i , hf,l+1k , ||xal \u2212 xflk ||)),\n||xal \u2212 xflk || + 1\nwhere xflk is the k-th row of M\u2020xa, eij are multilayer perceptrons, eij are inter-atomic bond types, and\ndaij = ||xai \u2212 xaj|| are inter-atomic distances. We consider a complete graph for fragment-level\ninteractions and expand the edge set by incorporating multi-hop and radius neighbors for atom-level\ninteractions. The details of the deblurring networks are provided in the Appendix A."}, {"title": "3.3.3 Training", "content": "Following Eq. (5) of IHDM [42], our loss of previous deblurred state estimation can be defined as:\nLt\u22121 = Et,x0,xf,xa [||fB(xa, xf, t \u2212 1) \u2212 \u03c1(\u00b5\u03b8(xa, xf, G, t))||2],\nwhere \u03c1 is the Kabsch algorithm [25] to obtain the optimal rotation matrix for alignment. Through\nalignment \u03c1 between the prediction from \u00b5\u03b8 and less blurred state fB(xa, xf, t \u2212 1) after translating\nboth terms to the zero center-of-mass subspace, the loss function becomes invariant to the SE(3)-\ntransformation of the prediction.\nHowever, we empirically observed that this previous state estimator generates unsatisfactory\nconformers, similar to the unsatisfactory FID scores observed in image generation of IHDM\n[42]. We conjectured the reason as the model limited to learn the locally small steps towards\nthe ground truth distribution at each time step [7]. Thus, we reparameterize \u00b5\u03b8(xa, xf, G, t) as"}, {"title": "4 Related work", "content": "Hierarchical generation. A hierarchical design of generative models is evident across multiple domains, including image generation [35, 40, 16, 42] and speech synthesis [20, 17], aimed at enhancing the interpretability and quality of samples derived from coarse-grained information.\nIn the field of computational biology, recent studies on molecular graph generation [21, 22, 12], backmapping of protein structure [61] and conformer generation [56] conditioned on the given ground truth coarse-grained information have reported the effectiveness of the hierarchical design. In recent unconditional conformer generation [38], a denoising diffusion model [19] was exclusively used in the fragment structure generation step and not designed for coarse-to-fine generation.\nData corruption in diffusion models. The choice of data corruption can be considered a crucial aspect of the design space of diffusion models [26], depending on the characteristics of the data domain and the specific problem definition. Recently, several studies on diffusion models have revealed that the choice of data corruption can be extended beyond random noise [49, 15, 50, 36, 43] to methods such as masking [2, 7, 8], blurring [42, 2, 7, 18], and varying data dimension [3]. We designed the data corruption process as a blurring operation in Euclidean space, transitioning from atom-level fine details to fragment-level coarse structures. This approach is more effective for multi-scale frameworks compared to random noise, which corrupts both fragment and atom geometries."}, {"title": "5 Experiments", "content": "In this section, we evaluate our hierarchical molecular conformer generation framework via Equivariant Blurring Diffusion (EBD) on molecular conformer generation task. We conducted experiments to answer the following questions: i) Ablation studies (Sec. 5.2): What are the effects of granularity of the fragment vocabulary, loss reparameterization, and data corruption processes of diffusion models? ii) Geometric evaluation (Sec. 5.3): Can EBD generate more diverse and accurate molecular conformers in Euclidean space than previous deep generative approaches? iii) Property prediction (Sec. 5.4): Can EBD generate low-energy, stable conformers?"}, {"title": "5.1 Experiment setup", "content": "Dataset. We use GEOM-QM9 (QM9) [39] and GEOM-Drugs (Drugs) [1] which are small molecules and drug-like molecules, respectively. Each dataset comprises 40,000 molecules for the training set and 5,000 molecules for the validation set, with each molecule containing 5 conformers following data split of [46]. For the test set, we selected 200 molecules for each dataset, resulting in 22,408 and 14,324 conformers existing in QM9 and Drugs, respectively."}, {"title": "5.2 Ablation studies", "content": "We conducted ablation studies to validate our model design, encompassing the size of the fragment vocabulary, the reparameterization of loss, and the blurring data corruption. For each ablation study, we calculated the mean and median of matching scores MAT-R and MAT-P on Drugs test set. Note that lower values of MAT-R and MAT-P indicate better results.\nEffects of fragment granularity. We assessed the performance variation as fragment structure became more detailed and informative by measuring the generation performances across different fragment vocabulary sizes |S| \u2208 {50, 200, 1000}. Since PS [29], the fragmentation method we used, initializes the vocabulary from unique single atoms, reducing the size S results in obtaining finer fragments xf."}, {"title": "5.3 Geometric evaluation", "content": "We compared our hierarchical framework to the baseline RDKit and machine learning models for molecular conformer generation on Drugs, and the results are reported in Table 3. EBD achieves superior performance across all metrics by generating diverse and accurate molecular conformers. In comparison to RDKit, which was used to generate fragment structures xf, EBD achieved a significant improvement in the generation of diverse fine atomic details, as evidenced by higher COV-R and MAT-R scores. We also observed that, due to the informative fragment structure prior distribution and the proposed blurring schedule, EBD produces more diverse and higher-quality conformers with statistical significance (see Appendix D), even with 100 times fewer T compared to GeoDiff."}, {"title": "5.4 Chemical evaluation", "content": "In addition to geometric evaluation, we assessed\nthe quality of generated conformers by their\nchemical properties. After training EBD on\nQM9, following [46], we generated 50 samples\nfor each of the 30 molecules, which constitute a\nsubset of QM9. Using PSI4 [48], we calculated\nproperties of each conformer including the en-\nergy E, the lowest energy Emin, HOMO-LUMO\ngap e, the average gap \u2206e, the minimum gap\n\u2206emin and the maximum gap \u2206emax. Then, we\nmeasured the mean absolute errors between the\nproperties of generated and ground truth (Table.\n4). We observed that EBD can generate the most\nstable conformers compared to other methods, as\nevidenced by lower energy and HOMO-LUMO gap."}, {"title": "6 Conclusion", "content": "We introduced a novel hierarchical generative model for molecular conformers via Equivariant\nBlurring Diffusion (EBD), a diffusion model designed for coarse-to-fine generative scheme. After\ngenerating the initial distribution of fragment coordinates from a cheminformatics tool, EBD gen-\nerated fine atomic details from coarse-grained structures through equivariant networks. We also\nproposed a simple and effective linear blurring scheduler and ground truth state estimator to enhance\nthe model's ability to produce diverse and accurate conformers. Through extensive analysis of the\nproposed model and comparison between competitive denoising diffusion models, we substantiated\nthe validity of the model design."}, {"title": "A Deblurring network architectures", "content": "In SE(3)-equivariant deblurring networks, there are update functions of SE(3)-invariant fragment\nand atom features hf, ha, as well as an update function of SE(3)-equivariant atom coordinates xa\nmotivated from equivariant graph neural networks [45]. For the fragments, we constructed a complete\ngraph to account for dense interactions among them. In the case of atoms, we expanded the neighbor\nset of each atom by including multi-hop neighbors derived from the powers of the adjacency matrix\nand a radius graph, which includes atoms within a specified cutoff distance. The benefits of dense\ninteractions for accurate conformers estimation have been confirmed in several studies [47, 59, 19].\nThe architecture of the SE(3)-invariant message passing and feature update functions at the fragment-\nand atom-level is as follows:\nmf,l+1ij = \u03c6m(hf, ha, ||xai \u2212 xfj||),\nhf,l+1i = \u03c6h(hi, \u2211j\u2208N(xi) maf,l+1ij , hal),\nma,l+1ij = \u03c6m(ha, hlj, ||xai \u2212 xaj||),\nha,l+1i = \u03c6h(hai, \u2211j\u2208N(xi) maa,l+1ij , hal),\nwhere mij \u2208 Rd is the message for each interactions, and h \u2208 Rd is the feature vector from the\naggregated messages and features from different hierarchy level. For every invariant update functions\n\u03a6m, \u03a6h, \u03a6m, \u03a6h, we used multilayer perceptrons. For initial features h0i of fragments, we defined a\n3-dimensional vector as a frequency histogram of its constituent atom types based on their chemical\nproperties, including hydrophobicity, hydrogen bond center, and negative charge center following\n[38]. For initial atom features\nha,0i \u2208 Rd and bond features eij \u2208 Rd, we used embeddings from atom types and bond types,\nrespectively.\nFor the i-th atom xa belongs to the k-th fragment xf, the architecture of the equivariant atom\ncoordinate update function is as follows:\nxla+1\n= xal + \u2211j\u2208N(xi)\nxjal \u2212 xail\ndal+1ij\n\u03c6\u03c7(hal+1i , hal+1j , ||xal \u2212 xalj ||),\n+ xfal \u2212 xal\n\u03c6\u03b7(hal+1i , hf,l+1k , ||xal \u2212 xflk ||),\n||xal \u2212 xflk || + 1\nwhere xflk is the k-th row of M\u2020xa, and daij = ||xai \u2212 xaj|| are inter-atomic distances. For every\nequivariant update functions \u03c6\u03c7, \u03c6\u03b7, we used multilayer perceptrons. For three terms in right-hand\nside of Eq. (A.3), the first term is the coordinate from the previous layer, the second term is\nan equivariant update function that accounts for atom-level interactions, and the third term is an\nequivariant update function that considers the deviation of the current atom coordinate from its\nrespective fragment's coordinate."}, {"title": "B Derivation of loss function", "content": "In this section, we explain the derivation of the loss function for the ground truth state estimator from\nthe previous state estimator. The loss function of previous state estimation is defined as:\nLt\u22121 = Et,x0,xf,xa [||fB(xa, xf, t \u2212 1) \u2212 \u03c1(\u00b5\u03b8(xa, xf, G, t))||2],\nwhere \u03c1 is the Kabsch algorithm [25] to obtain the optimal rotation matrix for alignment. Through\nalignment \u03c1 of the prediction from \u00b5\u03b8 to the less blurred state fB(xa, xf, t \u2212 1) after translating both\nterms to the zero center-of-mass subspace, the loss function becomes invariant to the translation and\nrotation of the prediction."}, {"title": "C Implementation details", "content": ""}, {"title": "C.1 Datasets", "content": "We used GEOM-QM9 (QM9) [39] and GEOM-Drugs (Drugs) [1] for analysis and comparison\nbetween molecular conformer generation models. Each dataset comprises 40,000 molecules for the\ntraining set and 5,000 molecules for the validation set, with each molecule containing 5 conformers\nfollowing data split of [46]. For the test set, we selected 200 molecules\nfor each dataset, resulting in 22,408 and 14,324 conformers existing in QM9 and Drugs, respectively.\nFor fragmentation of the molecular graphs G = (V,E) in Drugs and QM9, we used Principal\nSubgraph (PS) which can construct a fragment\nvocabulary S whose elements are the largest and frequent repetitive subgraphs of molecules. Starting\nfrom all unique atoms in S at initial stage, PS iteratively merges neighboring fragments. The most\nfrequent fragment among the newly merged fragments was added to the vocabulary at each iteration,\nand this operation was repeated until the desired size of the vocabulary was reached. Thus, the smaller\nthe fragment vocabulary, the finer fragments can be obtained."}, {"title": "D Further results on geometric evaluation", "content": "GEOM-QM9. We compared our EBD to the baseline RDKit and machine learning models on small molecules GEOM-QM9, and the results are reported in Table 8. Compared to the most of machine learning models, EBD achieved superior performances especially on the precision score."}, {"title": "F Limitations", "content": "Although our Equivariant Blurring Diffusion achieves significant performance on coarse-to-fine generative problems in a hierarchical molecular conformer generation scheme, there are still several limitations.\nDue to the change of the estimation target from the previous state (Eq. (12)) to the ground truth state (Eq. (14)) during sampling (Algorithm 2), the next step x0t\u22121 cannot be directly computed from the current state x0t and requires an additional step of the deterministic blurring function fB. This additional step in the sampling process can make the entire process slower compared to the previous state estimator.\nAs the size of molecule increases, the discrepancy between the ground truth xf and the approximate\nxf \u223c PRDKit(xf) of fragment structures becomes more severe. This increased discrepancy can make it\nmore challenging for the model to learn the trajectory from the coarse fragment structures to the fine\natomic details. To circumvent this issue, increasing the time step T to more than 50 can be applied.\nAlso, for a more accurate deblurring network than equivariant graph neural networks [45] we used,\nmore powerful geometric graph neural networks [24] can be applied such as local complete frames\n[10] and higher-order tensors from spherical harmonics [53]."}, {"title": "G Broader impacts", "content": "We presented a deep generative model for the coarse-to-fine generation of molecular conformers. Our proposed model can be applied to problems in fragment-based drug discovery, such as scaffold hopping and linker generation, to achieve improved performance. In drug discovery applications, potential negative societal impacts may arise if the training set is contaminated and includes toxins. In such cases, the generated samples could potentially be harmful to humans. From a more general perspective, the generative models to which our model belongs can be misused to create false information that appears authentic. Therefore, users must be aware of the potential risks associated with generative models before using them."}]}