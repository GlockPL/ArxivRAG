{"title": "Multi-Channel Masked Autoencoder and Comprehensive\nEvaluations for Reconstructing 12-Lead ECG from Arbitrary\nSingle-Lead ECG", "authors": ["Jiarong Chen", "Wanqing Wu", "Tong Liu", "Shenda Hong"], "abstract": "In the context of cardiovascular diseases (CVD) that exhibit an elevated prevalence and mortality, the\nelectrocardiogram (ECG) is a popular and standard diagnostic tool for doctors, commonly utilizing\na 12-lead configuration in clinical practice. However, the 10 electrodes placed on the surface would\ncause a lot of inconvenience and discomfort, while the rapidly advancing wearable devices adopt the\nreduced-lead or single-lead ECG to reduce discomfort as a solution in long-term monitoring. Since the\nsingle-lead ECG is a subset of 12-lead ECG, it provides insufficient cardiac health information and\nplays a substandard role in real-world healthcare applications. Hence, it is necessary to utilize signal\ngeneration technologies to reduce their clinical importance gap by reconstructing 12-lead ECG from the\nreal single-lead ECG. Specifically, this study proposes a multi-channel masked autoencoder (MCMA)\nfor this goal. In the experimental results, the visualized results between the generated and real signals\ncan demonstrate the effectiveness of the proposed framework. At the same time, this study introduces\na comprehensive evaluation benchmark named ECGGenEval, encompassing the signal-level, feature-\nlevel, and diagnostic-level evaluations, providing a holistic assessment of 12-lead ECG signals and\ngenerative model. Further, the quantitative experimental results are as follows, the mean square\nerrors of 0.0178 and 0.0658, correlation coefficients of 0.7698 and 0.7237 in the signal-level evaluation,\nthe average Fl-score with two generated 12-lead ECG is 0.8319 and 0.7824 in the diagnostic-level\nevaluation, achieving the state-of-the-art performance. The open-source code is publicly available at\nhttps://github.com/CHENJIAR3/MCMA.", "sections": [{"title": "1 Introduction", "content": "The cardiovascular disease (CVD) [1, 2] con-\ntributes the leading mortality all around the\nworld. Moreover, the prevalence rate continues to\nshow an upward trend in the developing areas in\nthe past decades[3], posing a great challenge for\nresearchers and cardiologists to address. In clinical\npractice, clinicians need to adopt some character-\nization tools[4] to diagnose cardiovascular disease,\nand one of the most popular tools is the standard\n12-lead electrocardiogram (ECG). With the great\ndevelopment in deep learning, some researchers\nhave trained a cardiologist-level model with the\n12-lead ECG, like Ribeiro et al[5]. In conclusion,\nthe 12-lead ECG could provide comprehensive car-\ndiac information from various views for doctors\nand classification models, playing an essential role\nin cardiac healthcare.\nHowever, the 12-lead ECG signal collection\nprocess will put at least 10 electrodes on the user's\nsurface, which would cause a lot of inconvenience\nand discomfort for users, and make long-term\ncardiac health monitoring difficult. Up to now,\nthe standard 12-lead ECG is traditionally used\nin the hospital for short-term diagnosis, lasting\nabout 1 minute, while the cardiac abnormality\nwill need long-term monitoring[6] to capture the\nparoxysmal event. As a consequence, researchers\nand markets are trying their best to explore some\nuser-friendly devices for ECG signals collecting\nin the real-world application, including patch[6-\n8], smartwatch[9-11], and armband[12-14]. These\nwearable devices can be used to obtain single-\nlead ECG from the surface, effectively improving\nthe users' usage comfort. However, in comparison\nwith the standard 12-lead ECG, the ambula-\ntory signals could not provide sufficient cardiac\nhealth-related information, since it only observes\nthe heart's electrical activity from some limited\nangles. Although the single-lead ECG can be used\nfor cardiac abnormality classification, like the lead\nI for the Atrial Fibrillation [15], the lead V1 for\nthe Brugada Syndrome [16], and the lead aVR\nfor the Sinus Bradycardia [17], the full 12-lead\nECG is necessary to provide comprehensive infor-\nmation, matching the knowledge and needs of\nclinical physicians, a limited or reduced number\nof leads ECG from wearable devices will not work\neffectively for doctors.\nBased on the mentioned above, it is of\ngreat importance to strike a harmonious balance\nbetween clinical effectiveness and application fea-\nsibility. On the one hand, the clinical standard 12-\nlead electrocardiogram to comprehensively mea-\nsure heart health[5]. However, it is challenging to\ncollect the standard 12-lead ECG to complete var-\nious health-related tasks, since it will cause some-\nwhat inconvenience and discomfort with these\nsurface electrodes. On the other hand, wearable\ndevices have been a popular choice for users, but\nthey can only collect reduced-lead or single-lead\nECG, largely limiting their clinical importance.\nThen, many researchers try to reduce the gap\nbetween the reduced-lead and 12-lead ECG, like\nthe challenge proposed by Reyna et al [18]. The\nchallenge asks to access the diagnostic potential of\nthe reduced-lead ECG, including 6-lead, 4-lead, 3-\nlead, and 2-lead ECG, which would be compared\nwith the 12-lead ECG. Nejedly et al[19] adopt the\nensemble learning, residual network, and attention\nmechanism to finish this task, and they success-\nfully achieve state-of-the-art performance in this\nchallenge. To this end, some similar researches[20-\n23] propose various deep learning technologies\ninto the varied-lead ECG signals. It is effective\nfrom the arrhythmia classification task, but these"}, {"title": "2 Study Subjects", "content": "The standard 12-lead ECG is one of the most\npopular schemes in clinical practice, which could\nprovide enough cardiac health information. As\nmentioned, it is difficult to collect the long-term\n12-lead ECG, since it causes a lot of inconve-\nnience. This section will present the definition of\n12-lead ECG, including time-domain and space-\ndomain definitions. Firstly, a normal ECG should\ninclude P-wave, QRS-complex, and T-wave, rep-\nresenting the corresponding cardiac activity. For\nexample, the P-wave means the atrial depolariza-\ntion, if the abnormal atrial depolarization process\nexists, there is a change in P-wave-based ECG.\nSecondly, the 12-lead ECG needs 10 electrodes\non the surface, and each electrode position in the\n12-lead ECG is seen in Table 1."}, {"title": "3 Data Source", "content": "To reconstruct the 12-lead ECG with single-lead\nECG in the clinical practice, this study conducts\na large-scale 12-lead ECG datasets, consisting of\n28,833 recordings from three public 12-lead ECG\ndatasets, i.e., PTB-XL[45, 46], CPSC2018[35], and\nCODE-test[5]. The proposed framework will be\ntrained and validated with PTB-XL initially, and\nusing two external datasets to further prove its\nfeasibility.\n3.1 \u0420\u0422\u0412-XL\nIn this study, PTB-XL [45, 46] will be used for\nmodel training, validating, and testing. As a\nlarge dataset, PTB-XL involves 21,799 clinical 10-\nsecond 12-lead ECG signals, and the sampling\nfrequency is 500Hz. Based on the clinical standard,\nthis dataset includes 71 kinds of ECG statements.\nAs recommended, this study will adopt the cross-\nvalidation folds, in which the folds from the 1st\nfold to the 8th fold will be the training set, the"}, {"title": "4 Method", "content": "This section will introduce the details of the\nproposed framework, model architecture, ECG\ndataset, and evaluation metric.\n4.1 \u041c\u0421\u041c\u0410 Input & Output\nThe proposed framework will be named as Multi-\nChannel Masked Autoencoder (MCMA), which\ncould mask different 11 leads and remain only\na single-lead ECG to generate the entire 12-lead\nECG. The input of MCMA is single-lead ECG,\nwhile the output of MCMA is 12-lead ECG. The\nsignal length is 1024 for MCMA. In this study,\nno preprocessing step is used to avoid influencing\nECG signals, like filtering or scaling.\n4.2 Multi-Channel Configuration\nIn this study, MCMA, the proposed framework,\nneeds to convert arbitrary single-lead ECG into\nthe standard 12-lead ECG, and the multi-channel\nconfiguration will be used to reduce training and\ninference costs. On the one hand, with the multi-\nchannel configuration, only one model is necessary\nto reconstruct 12-lead ECG from arbitrary single-\nlead ECG, distinguished from related works, like\ngarg et al[30] focus on utilizing lead II to recon-\nstruct 12-lead ECG, making it difficult for their\nmodel to work with other single-lead ECG as\ninput. On the other hand, unlike Electrocardio\npanorama [39], the input ECG is one of the stan-\ndard 12-lead ECG, and the output is the stan-\ndard 12-lead ECG. Therefore, the input shape for"}, {"title": "4.3 Model Architecture", "content": "For this framework, it is necessary to design a\nproper model for 12-lead reconstruction, aiming\nto learn the effective representation. Firstly, it\nis necessary to take into account the locality\nand uncertainty of features within the ECG sig-\nnals and there is no feature alignment in signal\npreprocessing. Therefore, the convolutional neu-\nral network can largely extract the local feature,\nwhich can play a key module in this 12-lead\nECG reconstruction task. The designed model in\nMCMA is shown in Fig.2.\nThe designed model is mainly motivated by\nResNet [40] and UNet[41]. The whole model can\nbe subdivided into two modules, namely, the\ndownsampling and upsampling modules, which\nare composed of the multi-convolution block\n(MCBlock) and multi-convolution-transpose block\n(MCTBlock), respectively. The kernel size is 13\nand the window size is 2. The activation function\nis GELU. To improve the gradient stability, layer\nnormalization (LN) and instance normalization\n(IN) are used in each block. The skip connec-\ntions could speed up the convergence rate of the\nmodel and improve the representation ability. At\nthe same time, the basic training recipe is pro-\nvided in Table 4, including some hyperparamaters\nsettings, like batch size and learning rate.\nTable 4 will be mainly used in model training\nprocess, further for reconstructing 12-lead ECG\nwith single-lead ECG."}, {"title": "4.4 Training MCMA", "content": "4.4.1 Padding Strategy\nSince the proposed framework will be used to\nreconstruct 12-lead ECG with arbitrary single-\nlead ECG, and it is necessary to adopt a channel\npadding strategy in this study. To retain the space\ninformation for each single-lead ECG, the zero-\npadding strategy is proposed in this study. When\nthe single-channel ECG will be processed into the\n12-channel format, while the other channels will\nbe set as zeros, as seen in Eq.1.\n\\(P(ecg_{12}, i) = I_z \\times ecg_{12}[i]\\)\n(1)\nIn Eq.1, the shape of index matrix for zero-\npadding is 12 \u00d7 1, \\(I_z(i) = 1\\) with other elements\nbeing zeros. Specifically, the output shape equals\nthe input shape, and the shape of \\(ecg_{12}\\) is 12 \u00d7 N,\nthen the shape of \\(ecg_{12}[i]\\) is 1 \u00d7 N, so the out-\nput shape also is 12 \u00d7 N. With zero-padding,\nMCMA could adaptively solve different inputs.\nTo highlight its advantages, the 12 copies for the\nsingle-lead ECG will be as a comparison, named\nas the copy-padding strategy. The index matrix\nfor copy-padding strategy, \\(I_c\\), all elements are 1.\nAt the same time, the arbitrary input lead and the\nfixed lead (lead I) will be compared. In addition,\nthe 12-lead ECG is provided in model training,\nand the padding strategy aims to mask the orig-\ninal 11-lead ECG with zeros or the remaining\nsingle-lead ECG in the standard 12-lead ECG.\nMeanwhile, only the single-lead ECG exists in the\nreal-world application process, it should be with\nthe padding strategy for the proposed framework.\n4.4.2 Loss Function\nThe\ngenerative models mainly involve\nautoencoder(AE) [42], generative adversarial\nnetwork(GAN)[38], diffusion model[43]. Although\nthe diffusion model has shown its great poten-\ntial and ability in various tasks, the sampling\nspeed [44] is challenging. GAN[32, 33] and AE[30]"}, {"title": "4.5 Inferencing MCMA", "content": "After the training process, MCMA would be used\nin real-world applications, i.e., the inferencing\n(testing) process. Firstly, the single-lead ECG\nshould be provided as the input of MCMA. Sec-\nondly, the zeros-padding strategy will be used in\nthis process, like Eq.1, but only the single-lead\nECG inputs. Thirdly, the trained autoencoder\ncould generate the reconstucted 12-lead ECG,\nwhich could be used to evaluation or downstream\ntasks. Then, the application process for MCMA\ncould be seen in Eq.3.\n\\(g_{ecg} = AE(I_z \\times ecg_1)\\)\n(3)\nIn Eq.3, \\(g_{ecg}\\) is the generated 12-lead ECG\nwith MCMA, \\(ecg_1\\) is the single-lead ECG collected\nby wearable devices, \\(I_z\\) could convert \\(ecg_1\\) into the\ninput of AE."}, {"title": "4.6 Comprehensive Evaluations", "content": "As mentioned, to fill the evaluation gap in\nthis research field, this study will introduce a\ncomprehensive evaluation benchmark, named as\nECGGenEval. Specifically, this benchmark will\ncontain 3 kinds of evaluation metrics, that is,\nsignal-level, feature-level and diagnostic-level. The\nfollowing contents will introduce the detailed eval-\nuation metrics respectively.\n4.6.1 Signal-Level\nThis study adopt the Pearson correlation coeffi-\ncient (PCC) and mean square error (MSE) in the\nsignal-level evaluation. It is necessary to define the\nreal and generated ECG signal as \\(r_{ecg}\\) and \\(g_{ecg}\\).\nThen, the definitions for PCC and MSE are shown\nin Eq.4 and Eq.5.\n\\(PCC(r_{ecg}, g_{ecg}) = \\frac{\\mu(r_{ecg} \\times g_{ecg}) \u2013 \\mu(r_{ecg})\\mu(g_{ecg})}{\\sigma(r_{ecg})\\sigma(g_{ecg})}\\)\n(4)\n\\(MSE(r_{ecg}, g_{ecg}) = \\frac{1}{N}\\sum (r_{ecg} \u2013 g_{ecg})^2\\)\n(5)\nIn these equations, as Eq.4 and Eq.5, \\(\\mu(*)\\)\nand \\(\\sigma(*)\\) denotes the mean value and standard\ndeviation, respectively. The PCC varies from\n1 to 1, and the MSE is at least bigger than\n0. The relationship between MSE and genera-\ntion performance is positively related, while the\nrelationship between MSE and generation per-\nformance is negatively related. Therefore, based\non the signal-level evaluation, a better generative\nmodel should be with a higher PCC and lower\nMSE from two different aspects.\n4.6.2 Feature-Level\nAlthough the signal-level evaluation is established,\nsince the original ECG signals may be subject to\nvarying degrees of influence from ambient noise,\nsome metrics in other levels are needed for objec-\ntively evaluating the reconstruction performance.\nThis section will introduce the heart rate for the\nfeature-level evaluation. It is known that R-waves\nin real 12-lead ECG signals will theoretically occur\nsimultaneously, and the generated signals should\nmeet this requirement. Firstly, the mean heart rate\n(MHR) at the jth lead could be calculated, as\nshown in Eq.6.\n\\(MHR(j) = \\frac{60 \\times (n - 1)}{\\sum_{i=1}^{n-1} (R(i + 1, j) \u2013 R(i, j))}\\)\n(6)\nIn Eq.6, the ith detected R-wave in jth lead\nwill be denoted as R(i,j), and it is expressed\nin seconds. Therefore, MHR could represent the\nheartbeat per minute. Since the 12 heart rates\nare obtained, it is time to measure the heart rate"}, {"title": "4.6.3 Diagnostic-Level", "content": "Further, this study also adopts the diagnostic-level\nevaluation for this 12-lead ECG reconstruction\ntask. In the real-world application, there are some\ntrained classifiers with 12-lead ECG as input,\nwhich are difficult to address some limited-lead\nECG. The proposed framework could convert the\nlimit-lead (even single-lead) ECG into 12-lead\nECG, which bridges the limited-lead ECG to the\ntrained classifiers. Therefore, it is necessary to\nevaluate the classification performance with the\ngenerated 12-lead ECG. The representative clas-\nsification metric will be used in this study, mainly\nincluding the precision (Pre), recall (Rec), speci-\nficity (Spe) and F1 score, as shown in literature[5].\nThe classification metric will be related to the\nTrue Positive (TP), True Negative (TN), False\nPositive (FP) and False Negative (FN) for a spe-\ncial class, as seen in Eq.11, Eq.12, Eq.13 and\nEq.14.\n\\(Pre = \\frac{TP}{TP + FP}\\)\n(11)\n\\(Rec = \\frac{TP}{TP + FN}\\)\n(12)\n\\(Spe = \\frac{TN}{TN + FP}\\)\n(13)\n\\(F1 = \\frac{2 \\times TP}{2 \\times TP+FN + FP}\\)\n(14)\nAt the same time, the original classification\nperformance with the real 12-lead ECG will be set\nas the standard reference, and the generated 12-\nlead ECG with other methods will be used in the\nresult comparison."}, {"title": "5 Results and Discussion", "content": "This study adopts a novel generative model to\nreconstruct 12-lead ECG with the single-lead\nECG, using an autoencoder for 12-lead ECG\nreconstruction. Firstly, the training process details\ncan be illustrated as seen in Fig.3."}, {"title": "5.1 Case Study", "content": "Further, to show the advantages of the proposed\nframework, the generated and real 12-lead ECG\nshould be clearly shown, in Fig.4, in which the\ngenerated and the real signals are colored blue and\nred.\nFig.4 demonstrates the great generation ability\nof the proposed framework. For example, the aver-\nage MSE and PCC between the generated and\nreal 12-lead ECG is 0.0032 and 0.9560, and it is\nconcluded that the generator can generate 12-lead\nECG with single-lead ECG. Besides the inter-\nnal testing dataset (i.e., PTB-XL), the external\ntesting dataset's (i.e., CPSC2018) reconstruction\nperformance will demonstrate the proposed frame-\nwork's advantages from another aspect, as seen in\nFig.5.\nBased on the experimental result provided\nin Fig.4 and Fig.5, it is shown that the multi-\nchannel masked autoencoder (MCMA) could be\nused to reconstruct the 12-lead ECG with single-\nlead ECG. In the clinical practice, the ECG\ncollected by wearable devices could be with dif-\nferent signal length, instead of the fixed length. It\nis necessary to demonstrate the proposed frame-\nwork cloud also works with the variable-duration\nECG signals, and the signal reconstruction result\nwith 10-second ECG is seen in Fig.6. In this case,\nthe 5000 points should be filled with the extra 120\npoints, and it could be as the 5 individual sam-\nples for MCMA to reconstruct 12-lead ECG with\nsingle-lead ECG as input.\nTo evaluate the 12-lead ECG reconstruction\nperformance for the proposed framework, a com-\nprehensive evaluation benchmark is built in the\nmentioned content, named ECGGenEval. There-\nfore, the experimental results for MCMA are\ncalculated in this section with the proposed bench-\nmark, ECGGenEval, including the signal-level,\nfeature-level, and diagnostic-level evaluation."}, {"title": "5.2 Signal-Level", "content": "First of all, the signal-level evaluation is the pri-\nmary evaluation metric, such as MSE and PCC.\nUnlike the traditional methods, this scheme has\nthe advantage that arbitary single-lead ECG can\nbe output to 12-lead ECG without training mul-\ntiple generative models, effectively reducing the\nmodel training cost. The experimental results of\nMSE and PCC are shown in Table 5, where the"}, {"title": "5.3 Feature-Level", "content": "To avoid the noise influence, and meet the clinical\nrequirement, this study proposes the feature-level\nevaluation metric, including the standard devia-\ntion MHRSD, Range MHRRange and coefficient\nof variation MHRCV. The feature-level evalua-\ntion results in the internal testing set PTB-XL and\nexternal testing set CPSC2018 are shown in Table\n7 and Table 8, respectively. Since the proposed\nmethod can convert arbitary single-lead ECG into\n12-lead ECG, these tables will involve 13 groups\nof experimental results, the first group will be the\nreference value as the original 12-lead ECG input.\nTable 7 demonstrates that the heart rate esti-\nmation in different leads is similar in the generated\n12-lead ECG and better than the original 12-lead\nECG. Normally, the estimated heart rate from\nthe real 12-lead ECG might be different, for the\nchannel-special noise existing, while the estimated\nvalue should be the same theoretically. At the\nsame time, the optimal result is from the gen-\nerated 12-lead ECG by lead V4 ECG. In this\nexperiment, the R-peak recognition algorithm [47]\nmight influence the experimental result.\nBased on the experimental result on Table 7\nand Table 8, the conclusion can be drawn as fol-\nlowing. For CPSC2018, the optimal result is from\nthe generated 12-lead ECG by lead II ECG. The\ngenerated 12-lead ECG from arbitary single-lead"}, {"title": "5.4 Diagnostic-Level", "content": "The downstream task can demonstrate the clini-\ncal importance of the generated 12-lead ECG, and\nthe classifier is trained and validated by Ribeiro\net al[5]. The proposed framework could generate\n12-lead ECG with single-lead ECG, and the single-\nlead ECG could not be processed by a classifier"}, {"title": "5.5 Comparison", "content": "MCMA will be compared with other research\nworks, including Grag et al[30], Seo et al[32], and\nJoo et al[33]. As known, Grag et al [30] adopts\nthe lead II, while Seo et al [32] and Joo et al[33]\nutilizes the lead I. Moreover, MCMA could con-\nvert arbitary single-lead ECG into the standard"}, {"title": "5.6 Ablation Study", "content": "MCMA utilizes two key modules, one for arbitary\nsingle-lead ECG reconstruction, and another for\nzero-padding strategy. Then, it is necessary to\ncompare with different settings, including fixed-\nchannel(lead I as an example) and copy-padding\nstrategy. The signal-level evaluation metric, mean\nsquare error (MSE) and Pearson correlation coeffi-\ncient (PCC) will be used. The experimental results\ncomparison with different settings could be shown\nin Table 15, including the lead I and the average\nvalue for 12 single-lead ECG. In the most cases,\nMCMA has achieved excellent result in 12-lead\nECG reconstruction task."}, {"title": "5.7 Discussion", "content": "Therefore, based on the experimental results, it is\nconcluded that MCMA could generate the stan-\ndard 12-lead ECG with arbitary single-lead ECG\nas input. At the same time, this study estab-\nlishes a comprehensive evaluation benchmark,\nECGGenEval, including the signal-level evalua-\ntion, feature-level evaluation, and diagnostic-level\nevaluation. The experimental results prove that\nMCMA can work well in ECGGenEval, which\ncould be a baseline for the future work. In the\ninternal testing set, MCMA could perform a MSE\nof 0.0178 and a PCC of 0.7698, and the lowest\nMSE is 0.0156 in the lead V4 while the highest\nPCC is 0.8055 in the lead aVF. In the external\ntesting set, MCMA could perform a MSE of 0.0658\nand a PCC of 0.7237, and the lowest MSE is 0.062\nin the lead V3, while the highest PCC is 0.7616 in\nthe lead II.\nAt the same time, for the feature-level evalu-\nation, MCMA could get a MHRSD of 1.4529, a\nMHRcy of 2.10%, and a MHRRange of 4.4099\nin the internal testing set, while the results are\n1.1578, 1.56%, and 3.6522 in the external testing\nset. In the classification task, the highest F\u2081 is\n0.8319, bridging the gap between the single-lead\nECG and 12-lead ECG."}, {"title": "6 Conclusion", "content": "In conclusion, this study proposes a novel gen-\nerative framework to reconstruct 12-lead ECG\nwith single-lead ECG, as multi-channel masked\nautoencoder (MCMA), and it involves two main\ncontributions. Firstly, unlike other methods, the\nproposed framework could convert arbitary single-\nlead ECG into the standard 12-lead ECG. The\nexperimental results showed that the proposed\nframework had excellent performance, achiev-\ning state-of-the-art performance on the proposed"}]}