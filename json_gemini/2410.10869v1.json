{"title": "Application of NotebookLM, a Large Language Model with Retrieval-Augmented Generation, for Lung Cancer Staging", "authors": ["RYOTA TOZUKA", "HISASHI JOHNO", "AKITOMO AMAKAWA", "JUNICHI SATO", "MIZUKI MUTO", "SHOICHIRO SEKI", "ATSUSHI KOMABA", "HIROSHI ONISHI"], "abstract": "In radiology, large language models (LLMs), including ChatGPT, have recently gained attention, and their utility is being rapidly evaluated. However, concerns have emerged regarding their reliability in clinical applications due to limitations such as hallucinations and insufficient referencing. To address these issues, we focus on the latest technology, retrieval-augmented generation (RAG), which enables LLMs to reference reliable external knowledge (REK). Specifically, this study examines the utility and reliability of a recently released RAG-equipped LLM (RAG-LLM), NotebookLM, for staging lung cancer.", "sections": [{"title": "Purpose", "content": "In radiology, large language models (LLMs), including ChatGPT, have recently gained attention, and their utility is being rapidly evaluated. However, concerns have emerged regarding their reliability in clinical applications due to limitations such as hallucinations and insufficient referencing. To address these issues, we focus on the latest technology, retrieval-augmented generation (RAG), which enables LLMs to reference reliable external knowledge (REK). Specifically, this study examines the utility and reliability of a recently released RAG-equipped LLM (RAG-LLM), NotebookLM, for staging lung cancer."}, {"title": "Materials and methods", "content": "We summarized the current lung cancer staging guideline in Japan and provided this as REK to NotebookLM. We then tasked NotebookLM with staging 100 fictional lung cancer cases based on CT findings and evaluated its accuracy. For comparison, we performed the same task using a gold-standard LLM, GPT-4 Omni (GPT-40), both with and without the REK."}, {"title": "Results", "content": "NotebookLM achieved 86 % diagnostic accuracy in the lung cancer staging experiment, outperform-ing GPT-40, which recorded 39 % accuracy with the REK and 25 % without it. Moreover, NotebookLM demonstrated 95% accuracy in searching reference locations within the REK."}, {"title": "Conclusion", "content": "NotebookLM successfully performed lung cancer staging by utilizing the REK, demonstrating superior performance compared to GPT-40. Additionally, it provided highly accurate reference lo-cations within the REK, allowing radiologists to efficiently evaluate the reliability of NotebookLM's responses and detect possible hallucinations. Overall, this study highlights the potential of Note-bookLM, a RAG-LLM, in image diagnosis."}, {"title": "Keywords", "content": "Large language model (LLM), Retrieval-augmented generation (RAG), Reliable external knowledge (REK), NotebookLM, GPT-4 Omni (GPT-40), Lung cancer staging"}, {"title": "1 Introduction", "content": "Large language models (LLMs) are artificial intelligence (AI) models designed to understand natu-ral language and generate human-like responses, achieving considerable success in a variety of domains [1]. In radiology, the potential of LLMs has recently been explored in areas such as image diagnostic support, radiology education, and medical physics [2-4]. While these studies emphasize the promising role of LLMs in the field, it has been observed that their responses sometimes deviate from user expectations or fail to align with established clinical consensus. LLMs often process information indiscriminately from diverse references, occasionally generating answers based on unreliable or outdated references. This phenomenon, referred to as LLM hallucinations, can gener-ate seemingly plausible but factually incorrect information, making it difficult to rely on LLMs for clinical diagnoses [2, 5, 6].\nRetrieval-augmented generation (RAG) is an emerging technology designed to reduce halluci-nations in LLMs by enabling them to reference reliable external knowledge (REK) [7, 8]. A key feature of RAG is its ability to link LLM responses to specific sources within REK, allowing users to easily verify the reliability of those responses. Research on RAG-equipped LLMs (RAG-LLMs) in the medical field is still in its early stages [9-13], and their effectiveness, particularly in image diagnosis, remains largely unexplored.\nNotebookLM (https://notebooklm.google) is a web-based RAG-LLM, experimentally released by Google Inc. in June 2024. It generates responses by clearly citing sources from user-provided REK, utilizing the advanced language model, Gemini 1.5 Pro [14]. NotebookLM is designed to be user-friendly, requiring no specialized knowledge of AI-users simply need to prepare and provide REK.\nIn this study, we focus on the utility of NotebookLM for lung cancer staging. Specifically, we provided NotebookLM with a lung cancer staging guideline as REK and tasked it with diagnosing TNM classifications based on fictional lung cancer CT findings. Its accuracy was then compared to that of GPT-4 Omni (GPT-40; OpenAI Inc., San Francisco, CA, USA), a widely used LLM."}, {"title": "2 Materials and methods", "content": "An overview of the experimental process is schematically summarized in Fig. 1.\nData preparation\nTwo radiologists from our team generated CT findings for 100 fictional lung cancer patients, along with TNM classifications based on the latest lung cancer staging guideline in Japan, i.e., the 8th edition of the General Rule for Clinical and Pathological Record of Lung Cancer [15]. The CT findings and TNM classifications were subsequently reviewed and confirmed by two additional radiologists. The entire process was verified by a senior radiologist. The breakdown of TNM classifications for the 100 fictional lung cancer patients is listed in Table 1. All the fictional CT findings with TNM classifications are available in Online Resource 1\u2020, with the first of the 100 cases provided below as an example:\nCase 1 CT findings: A 4.9 cm tumor with invasion of the great vessels is identified in the left lower lobe. Enlarged lymph nodes are seen in the contralateral hilum. No distant metastasis.\nCase 1 TNM classification: T4 N3 M0."}, {"title": "Preparation of REK and prompt texts", "content": "As REK for NotebookLM and GPT-40, we summarized the current lung cancer staging guideline in Japan. This REK is available in Online Resource 2\u2020. NotebookLM was provided with the REK along with the following prompt ([file name] is the file provided to NotebookLM as REK):\nAccording to [file name], identify the TNM classification corresponding to the following CT findings. Note that, for T1 and T2, specify the appropriate subclass (the subclasses for T1 are T1mi, T1a, T1b, T1c; and for T2, T2a and T2b). In addition, the tongue ward refers to a segment of the left upper lobe of the lung. For a primary tumor in the left lung, \u2018ipsilateral' refers to the left side and 'contralateral' refers to the right side, whereas for a primary tumor in the right lung, \u2018ipsilateral' refers to the right side and 'contralateral' refers to the left side. If a tumor nodule is found in the contralateral lung from the primary lung cancer, it meets the criteria for M1a. If the solid component diameter is less than or equal to 1cm and the overall lesion (ground-glass nodule) diameter is greater than 3 cm, then it meets the criteria for Tla. The right upper lobe, right middle lobe, right lower lobe, left upper lobe, and left lower lobe are distinct from one another.\nWe used almost the same prompt when providing GPT-40 with the REK. Note that the REK for GPT-40 was supplied directly within the prompt, rather than through RAG. For GPT-40 without REK, the prompt only instructed it to classify the lung cancer stages based on the latest lung cancer staging guideline in Japan."}, {"title": "Evaluation", "content": "Diagnostic accuracy for each LLM setting (i.e., NotebookLM with REK, GPT-40 with REK, or GPT-40 without REK) was calculated as the percentage of correctly diagnosed TNM classifications across the 100 lung cancer cases. Note that a TNM classification was considered correct when all the T, N, and M factors were correctly diagnosed. Additionally, diagnostic accuracies of the LLMs for each of the T, N, and M factors were also calculated.\nFor NotebookLM with REK, search accuracy was also calculated as the percentage of lung cancer cases, out of 100, in which NotebookLM referenced the appropriate locations within the REK. The correctness of these referenced locations was evaluated by radiologists from our team. In contrast, for GPT-40 with and without REK, the reference points were generally unclear, making it impossible to calculate search accuracy."}, {"title": "3 Results", "content": "In the experiment using 100 fictional lung cancer cases, NotebookLM with REK diagnosed TNM classifications with a high accuracy of 86%, whereas GPT-40 with REK showed a lower diagnostic accuracy of 39 %, and without REK, it dropped further to 25 % (Fig. 2). In contrast to GPT-40 with and without REK, NotebookLM explicitly presented the reference locations it searched within the"}, {"title": "4 Discussion", "content": "There have been several previous studies on lung cancer stage classification using traditional LLMs, including GPT-40, but their diagnostic accuracy is not considered high enough for clinical application [16-18]. Similarly, in our experiment, the accuracy of lung cancer staging by GPT-40 was found to be insufficient (Figs. 2 and 4). As the guidelines for lung cancer TNM classification in various countries are frequently updated, the difficulty in determining which standards to reference from the vast amount of online information may be one reason for the low diagnostic accuracy of traditional LLMs.\nTo improve the diagnostic accuracy of LLMs, we provided the latest lung cancer staging guideline in Japan as REK to the LLMs. As seen in Figs. 2 and 4, providing GPT-40 with the REK in its prompt resulted in slightly better performance compared to when the REK was not provided, but the diagnostic accuracy was still not sufficient. On the other hand, NotebookLM with REK demonstrated remarkably high diagnostic accuracy. This is likely because NotebookLM is designed to generate responses exclusively based on the provided REK through RAG, avoiding irrelevant information.\nIn our experiment, unlike GPT-40, NotebookLM was able to clearly indicate the reference locations it found within the REK (see Fig. 3 for an example), and its search accuracy was notably high (Fig. 2). Although the search accuracy was slightly short of 100 %, at 95 %, the explicit indication of reference locations allows radiologists to easily verify the correctness of NotebookLM's responses as needed, making it a promising tool for providing reliable assistance in clinical diagnosis.\nAmong the cases where the reference locations identified within the REK by NotebookLM were appropriate, there were a few instances of diagnostic errors, primarily caused by numerical comparison mistakes (see Fig. 5 for an example). Such numerical reasoning errors were observed in GPT-40 as well and are recognized as a common issue with LLMs in general [19]. This is not an issue that can be resolved by RAG, and we hope that future advancements in LLMs will provide a solution.\nThis study has several limitations. First, unlike in actual clinical settings, we validated the diagnostic accuracy of LLMs using fictional lung cancer CT findings and Japan's lung cancer staging guideline in English (instead of Japanese). To rigorously assess their usefulness in real clinical practice, actual clinical data should be used. Additionally, while this study demonstrated the usefulness of NotebookLM as a diagnostic support tool, it is not appropriate to generalize the results to all RAG-LLMs, and further validation using other RAG-LLMs is necessary for the generalization. Moreover, NotebookLM is currently a free online system in trial release by Google, available for easy use by anyone, but how it will evolve in the future remains uncertain. Furthermore, using online LLMs like GPT-40 and NotebookLM in clinical practice poses substantial challenges regarding hospital information security and copyright issues surrounding REK. To address this concern, it is likely that LLM systems for clinical use will need to be implemented offline or on-premises. Despite these limitations, we hope that this study will serve as a first step toward applying RAG-LLMs in image diagnosis."}, {"title": "5 Conclusion", "content": "NotebookLM, a recently released RAG-LLM from Google, demonstrated superior accuracy in a lung cancer staging experiment compared to GPT-40, a widely recognized LLM. Additionally, NotebookLM explicitly provided accurate reference points from the given REK, allowing radiologists to efficiently assess the reliability of its responses and identify possible hallucinations. Overall, this study highlights the potential of NotebookLM in assisting radiologists with image diagnosis."}, {"title": "6 Declarations", "content": "Funding\nThis study was partially supported by JSPS KAKENHI Grant Number JP21K15762.\nCompeting interests\nThere is no conflict of interest with regard to this manuscript.\nEthics approval\nSince the study used only fictional patient data, ethical approval was not required.\nInformed consent\nNot applicable.\nData availability statement\nThe data that support the findings of this study are available from the corresponding author, upon reasonable request."}]}