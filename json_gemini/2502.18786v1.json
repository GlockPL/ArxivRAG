{"title": "NeuroTree: Hierarchical Functional Brain Pathway Decoding for Mental Health Disorders", "authors": ["Jun-En Ding", "Dongsheng Luo", "Anna Zilverstand", "Feng Liu"], "abstract": "Analyzing functional brain networks using functional magnetic resonance imaging (fMRI) is crucial for understanding psychiatric disorders and addictive behaviors. While existing fMRI-based graph convolutional networks (GCNs) show considerable promise for feature extraction, they often fall short in characterizing complex relationships between brain regions and demographic factors and accounting for interpretable variables linked to psychiatric conditions. We propose NeuroTree to overcome these limitations, integrating a k-hop AGE-GCN with neural ordinary differential equations (ODEs). This framework leverages an attention mechanism to optimize functional connectivity (FC), thereby enhancing dynamic FC feature learning for brain disease classification. Furthermore, NeuroTree effectively decodes fMRI network features into tree structures, which improves the capture of high-order brain regional pathway features and enables the identification of hierarchical neural behavioral patterns essential for understanding disease-related brain subnetworks. Our empirical evaluations demonstrate that NeuroTree achieves state-of-the-art performance across two distinct mental disorder datasets and provides valuable insights into age-related deterioration patterns. These findings underscore the model's efficacy in predicting psychiatric disorders and elucidating their underlying neural mechanisms.", "sections": [{"title": "I. INTRODUCTION", "content": "In recent years, neuropsychiatric disorders and addiction have emerged as substantial public health challenges, with their impact on brain function becoming a critical research focus in neuroscience [1]\u2013[3]. Substance use disorder (SUD) is widely studied in the field of mental disorders, enabling the investigation of structural brain alterations among SUD users across various factors (e.g., age or gender) [4], [5]. The development of functional magnetic resonance imaging (fMRI), which measures blood oxygen level-dependent (BOLD) signals, has provided unprecedented opportunities to analyze patterns of brain network activity in mental disorders [4], [6], [7].\nMoreover, research on the clustering of connectivity in brain regions using fMRI has demonstrated that the brain does not operate statically but instead exhibits a dynamic, multi-level hierarchical organization [8], [9]. In particular, hierarchical network analysis has been shown to effectively distinguish these abnormal patterns and identify brain regions associated with specific pathological mechanisms in psychiatric disorders [10], [11].\nCurrently, traditional brain network analysis has successfully represented regions of interest (ROIs) as nodes with functional connectivity (FC) as edges [12]\u2013[14]. Recent research on graph neural networks (GNNs) has shown promising results, demonstrating strong predictive capabilities for neuropsychiatric disorders by learning patterns across brain networks [15], [16].\nDifferential equations can capture the dynamic processes underlying changes in brain activity over time. Several studies have employed conventional network-based and dynamic causal modeling (DCM) approaches to capture neural-hemodynamic relationships [17], [18]. CortexODE further advances these approaches by combining ordinary differential equations (ODEs) with deep learning methods to model MRI images as point trajectories, thereby enabling the reconstruction of complex cortical surfaces [19]. Moreover, STE-ODE [20] combines the advantages of ODEs with continuous-time fMRI to model dynamic brain networks while leveraging GNN architectures for embedding learning. However, these approaches have several limitations. First, although graph convolutional networks (GCNs) demonstrate excellent node feature learning capabilities in graph structures, they are generally constrained by limited interpretability\u2014particularly regarding the explicability of auxiliary factors in mental disorders. Second, graph-based networks for human brain functional connectivity are restricted to feature learning from dynamic graph sequences, overlooking the brain's hierarchical clustering of network activity. Consequently, there is a lack of effective methodologies for predicting functional brain alterations across different age stages in psychiatric disorders.\nTo address these limitations, we leverage the properties of ODEs for fMRI modeling like STE-ODE's continuous-time dynamics methods. In this study, we propose NeuroTree, a framework designed to characterize brain network patterns through hierarchical, tree-structured pathways. Drawing from neuroscience research indicating that psychiatric disorders affect brain regions in hierarchical patterns, we represent the fMRI network as tree structures. This approach decodes brain network features and facilitates visualization of disorder propagation through brain pathways. Additionally, we develop a k-hop ODE-GCN to capture complex interactions between adjacent and distant brain regions and to measure the convergence of various mental disorder subtypes. We incorporate demographic features like age into node representations and message passing to enhance interpretability. Moreover, we implement contrastive masking optimization to identify key functional connectivity patterns. Our main contributions are as follows:\n\u2022\tWe integrate interpretable variables into static and dynamic causal graph convolutional modeling through k-hop convolution.\n\u2022\tWe investigate two types of brain disorder datasets using fMRI brain networks, constructing disease-specific brain trees while employing trainable k-hop graph convolutions to identify optimal high-order tree paths.\n\u2022\tOur research not only achieves state-of-the-art graph classification performance but also effectively predicts and interprets FC brain age change patterns associated with addiction and mental disorders."}, {"title": "II. RELATED WORK", "content": "A. High-Order GCNs for Brain Disease Classification.\nIn the auxiliary diagnosis of brain diseases, feature extraction and classification methods based on functional connectivity networks (FCNs) have received widespread attention. Early research primarily focused on low-order functional connectivity (LOFC), constructing networks by calculating temporal correlations between brain regions [21], [22]. However, considering only pairwise connections between nodes may overlook information about higher-level interactions among brain regions. Therefore, researchers introduced high-order functional connectivity networks (HOFC), which capture more complex brain network characteristics by calculating correlations between functional connectivity distribution sequences [23], [24]. Moreover, recent work has shown that traditional first-order GCNs rely on direct neighbor information but struggle to model the long-range dependencies critical for understanding brain functional networks. For instance, one study proposed a multi-channel fusion GCN (MFGCN) that integrates both topographical and high-order functional connectivity for depressive disorder (MDD) classification [25].\nThe design of higher-order neighbor matrices\u2014exemplified by HWGCN\u2014defines k-hop neighbor matrices based on shortest path distances to learn weighted matrices, effectively integrating first-order and higher-order neighborhood information [26]. In fMRI studies of brain disorders, learned masks have been utilized to construct hyperedges and compute weights for each hyperedge in hypergraph construction, revealing maximum information minimum redundancy (MIMR) higher-order relationships among brain regions [27].\nB. Hierarchical and Path-Aware Learning in GNNs.\nSome studies have found that noise connectivity issues in brain networks and the difficulty of stacking deep layers in traditional GCN models lead to over-smoothing problems. Researchers have proposed hierarchical GCNs to capture richer feature representations [28]. For example, HFBN-GCN designed a coarse-to-fine hierarchical brain feature extraction process with two branches: one focusing on local information transmission within the brain's hierarchical structure and another processing the entire brain network to preserve the original information flow [29].\nUnlike hierarchical GCN approaches, GCKN computes node distances using kernel functions along vertex-connected paths [30]. Additionally, PathNNs propose an end-to-end approach for extracting multiple types of paths and updating node representations by encoding paths originating from nodes into fixed-dimensional vectors through LSTM-based path aggregation [31]. The HEmoN model [31] has provided preliminary insights into human emotions through tree path analysis; however, it lacks interpretable representations of higher-order brain pathways. In this study, we propose a weighted higher-order brain tree in a hierarchical pathway framework that enhances pathway representation and effectively explains the predictions of age-related changes in FC networks associated with mental disorders across different age groups."}, {"title": "III. PRELIMINARIES", "content": "A. Problem Formulation and Notations.\nIn this section, we formulate the mental disorder classification problem as a graph classification task, using fMRI networks constructed for each patient. We introduce the temporal brain activity measurements by giving N patients with fMRI data. Let \\(X^{(i)}(t) \\in \\mathbb{R}^{v}\\) denote the blood oxygen level-dependent (BOLD) signals at time point t for subject i, where v represents the number of regions of interest (ROIs). The complete time series for each subject can be represented as \\(X^{(i)} \\in \\mathbb{R}^{v \times T}\\), where T is the length of the time series. The foundation of brain network analysis lies in representing these temporal patterns through graph structures. For each subject, we construct a functional connectivity (FC) graph G(V,E), where V represents the set of vertices (i.e., brain regions) and E denotes the set of edges (i.e., functional connections). The functional connectivity between regions is typically computed using Pearson or partial correlation methods. Based on these temporal correlation patterns, we derive both a static adjacency matrix \\(A_s\\) from the complete time sequence and time-varying dynamic FC matrices \\(A_d(t)\\). The static matrices capture averaged temporal dependencies, while the dynamic matrices preserve the temporal evolution of neural interactions [6], [7].\nB. Graph Convolutional Networks.\nTraditional GCNs operate through neighborhood aggregation, whereby each node's representation is updated by aggregating features from its adjacent nodes. The classical GCN layer is formulated as\n\\(H^{(l)} = \\sigma(D^{-\\frac{1}{2}} A D^{-\\frac{1}{2}} H^{(l-1)}W^{(l-1)}).\\)\t(1)\nwhere A is the adjacency matrix, D is the degree matrix, \\(H^{(l)}\\) represents the node features at layer l, and \\(W^{(l)}\\) contains learnable parameters. However, this formulation is limited to first-order neighborhoods and may not effectively capture the complex interactions among brain region [32]."}, {"title": "C. Neural ODEs for Brain Dynamics.", "content": "Recent work has demonstrated the effectiveness of ordinary differential equations (ODEs) in modeling continuous-time neural dynamics [20]. The evolution of brain states can be described by the equation \\(\\frac{dX(t)}{dt} = f(X(t),t)\\), where X(t) represents the brain state at time t and f(\u00b7) is a neural network that learns the rules governing state transitions. This framework provides a natural way to model the continuous nature of brain dynamics while maintaining biological plausibility [17]."}, {"title": "IV. THE PROPOSED NEUROTREE", "content": "The proposed NeuroTree framework, illustrated in Fig. 1, constructs dynamic FC graphs from subjects' time-series data. It encodes dynamic graph fMRI features using a k-hop ODE-GCN for graph embedding and FC strength computation. Subsequently, a CMFS optimization is performed to adjust the FC strength between similar and dissimilar brain regions, followed by tree pruning to create anatomically meaningful hierarchical brain network structures. The resulting brain tree structures are then employed to interpret differences between healthy controls and disease cohorts. Finally, NeuroTree predicts functional age-related changes and compares these with chronological age.\nA. K-hop ODE-Based Graph Embedding\nThe ODE effectively describes the dynamic changes in effective connectivity between different ROI [33]. Inspired by existing studies [20], [34], [35] that utilize ODEs to model blood-oxygen-level-dependent signals or biomarkers in Alzheimer's disease (AD) research, we extend the ODE modeling framework by incorporating a scalar parameter, \\(\\theta \\in \\mathbb{R}^+\\), representing the chronological age of subjects. This enhancement aims to improve the prediction and interpretability of mental disorders in fMRI analysis.\n\\(\\dot{X} = f(X(t), u(t), \\theta)\\)\t(2)\nwhere u(t) denotes the external experimental stimuli. We consider the influence of an external parameter, \\(\\theta\\), on FC across the entire temporal time series X(t), which is represented by adjacency matrix \\(A_d\\). The following ODE models this relationship:\n\\(\\frac{dX(t)}{dt} = \\eta A_d(t)X(t) + \\rho \\cdot \\theta X(t) + Cu(t),\\)\t(3)\nwhere the matrix C encodes the reception of external stimuli u(t) and parameters \\(\\eta\\) and \\(\\rho\\). To simplify the analysis, we assume that Cu(t) = 0, indicating the absence of additional external stimuli. By discretizing Eq. 3, we derive the effective connectivity matrix \\(A_d(t)\\). Its discrete representation is given by:\n\\(A_d(t) = \\frac{1}{\\Delta t} (\\frac{dX(t)}{X(t)}) = \\frac{1}{\\Delta t} (\\frac{X(t+\\Delta t) - X(t)}{X(t)}) = \\frac{\\eta - \\rho \\cdot \\theta}{\\frac{1}{\\Delta t} - \\rho \\cdot \\theta}\\)\t(4)\nwhere \\(\\frac{\\eta}{\\frac{1}{\\Delta t} - \\rho \\cdot \\theta} = \\varphi\\) and \\(\\rho\\) are scaling factors ranging from 0 to 1. To address the limitations of first-order feature convolution filters in traditional GCNs, we propose an extended spatial feature filter that operates over a k-hop connectivity operator. This approach enables the spatial k-order brain network representation to be learned via a generalized graph convolution.\n\\(H^{(l+1)}(t) = \\sigma (\\sum_{k=0}^{K-1} \\Phi_k(t)H^{(l)}(t)W_k^{(l)})\\)\t(6)\nwhere \u03c3 denotes the ReLU function, and \\(\\Phi_k(t) = \\hat{D}^{-\\frac{1}{2}} \\hat{A}_k(t) \\hat{D}^{-\\frac{1}{2}}\\) represents the normalized k-hop connectivity adjacency operator. The adjacency operator can be defined as:\n\\(\\hat{A}_k(t) = \\Gamma \\odot A^s \\odot [\\lambda A_d(t) + (1 - \\lambda)(A_d(t))^T]^k.\\)\t(7)\nk-hop connectivity\nwhere is a learnable parameter, the k-hop connectivity operator retains directional information, as evidenced by the fact that \\(\\hat{A}_k(t) \\ne (\\hat{A}_k(t))^T\\) when \\(\\lambda \\ne \\frac{1}{2}\\). This result is derived using the binomial theorem, as detailed in Appendix I.\nTheorem I. Suppose the \\(l_2\\)-norm of the k-hop connectivity adjacency operator \\(\\left \\|\\hat{A}_k(t)\\right \\|_2\\) can be derived from Eq. (7). Then, as the k-hop approaches infinity (k \u2192 \u221e ), the \\(\\left \\|\\hat{A}_k(t)\\right \\|_2\\) is bounded by the following inequality:\n\\(\\lim_{k \\to \\infty} \\|\\hat{A}_k(t)\\|_2 \\le \\|\\Gamma\\|_2 \\cdot \\| A^s \\|_2 \\cdot max(\\lambda, 1 - \\lambda)^k\\)\t(8)\nThe detailed proof of Eq. 8 is provided in Appendix II. To ensure numerical stability when computing powers of \\(A_k (t)\\), we establish the bounded condition: \\(\\left \\| A^s \\right \\|_2 \\le 1\\), which holds for all values of k and t. In proposition I, we demonstrate that \\(\\Phi_k(t)\\) exhibits smooth temporal evolution of the graph structure while maintaining a well-defined upper bound.\nProposition I. Let \\(\\Phi_k(t)\\) be the normalized adjacency operator that satisfies the Lipschitz condition [36] \\(\\left \\|\\Phi_k(t_1) - \\Phi_k(t_2)\\right \\|_2 \\le L\\|t_1 - t_2\\|_2\\) for some constant L \u2265 0. Then, for a Lipschitz, continuous activation function \u03c3 and bounded weights W, the k-hop ODE-GCN admits a unique solution. The proof from Picard's existence theorem can be found in Appendix III.\nTheorem II. [20] Consider a series of brain networks \\(\\left \\{G(t;\\theta)\\right \\}_{t=0}^T\\) parameterized by an age variable \\(\\theta\\). Let Z(t) denote the embedding (or feature representation) of the STE-ODE network at time t. The continuous temporal evolution of the brain network can be expressed through the following age-modulated ODE-based graph convolution representation:\n\\(Z(t + \\Delta t) \\approx Z(t) + \\Delta t \\cdot F_{\\theta}(Z(t))\\)\t(9)\nwhere F(\u00b7) is the graph embedding function that captures the spatiotemporal and age-related information within the network.\nSpecifically, the temporal evolution function is defined as:\n\\(F(Z(t), t, \\theta) = \\sum_{l=1}^{L} H^{(l)}(t, \\theta),\\)\t(10)\nwith \\(H^{(l)}(t, \\theta)\\) representing the age-modulated layer-wise transformation at time t. Using a first-order approximation, the temporal dynamics described in Eq. 6 and theorem theorem II can be discretized into the following form:\n\\(Z(t + \\Delta t) \\approx Z(t) + \\Delta t \\cdot F_{\\theta}(Z(t))\\)\n\\(= Z(t) + \\Delta t \\cdot \\sum_{l=1}^{L} \\sum_{k=0}^{K-1} \\sigma(\\Phi_k(t)X_k^{(l)}(t)W_k^{(l)}).\\)\t(11)\nHere, \\(X_k^{(l)}(t) = \\Lambda^{\\Theta}H^{(l)}(t)\\) denotes the age-modulated features at layer l, where A is a trainable parameter. In this context, \\(\\Phi_k(t)\\) represents the polynomial filter coefficients at time t, \\(H^{(l)}(t)\\) is the feature matrix at layer l, and \\(W_k^{(l)}\\) are the learnable weights associated with the k-th hop filter at layer l.\nFor t\u2265 1, the temporal graph embedding update is expressed as:\n\\(Z(t+1) = Z(t) + AGE\text{-}GCN_k(G_f (t + 1), \\theta)\\)\n\\(= Z(t) + \\sigma(\\sum_{k=0}^{K-1} \\Phi_k(t+1)X_k^{(l)}(t+1)W_k^{(l)}).\\)\t(12)\nwhere AGE-GCNk\\((G_f (t + 1),\\theta\\)) denotes the age-modulated k-hop graph convolution applied to the graph Gf (t+1) at the final layer L.\nB. Attention-Based FC Strength Enhancing\nTo enhance the FC between neighborhood nodes representations, we further implement an attention mechanism that computes attention for each timestamp \\(t \\in \\{1,2,...,T\\}\\) in the temporal networks \\(A_d(t)\\) for each node i. Specifically, we encode the tth adjacency matrix \\(A_d\\) into a features matrix: \\(A_d W^Q\\), and then map it into three embeddings: the query \\(H W^Q\\), key \\(H W^K\\), and value \\(H W^V\\) matrices, where \\(W^Q\\), \\(W^K\\), and \\(W^V \\in \\mathbb{R}^{d \\times d_k}\\) are learnable matrices. A single attention head is computed as:\n\\(\\text{head} = \\text{softmax}(\\frac{(HW^Q)(HW^K)^T}{\\sqrt{d_k}})HW^V\\)\t(13)\nwhere \\(d_k\\) represents the dimensionality of each attention head. Next, we concatenate the outputs of all h heads to form the multi-head attention (MHA):\n\\(H^{\\text{MHA}} = \\text{Concat}(\\text{head}_1, ..., \\text{head}_h)W^O\\)\t(14)\nwhere \\(W^O \\in \\mathbb{R}^{h d_k \\times d}\\) is the projection matrix. For simplicity, we use feature-wise averaging over the d-dimensional FC output:\n\\(C_i(t) = \\frac{1}{d} \\sum_{k=1}^{d} H_{i,k}^{\\text{MHA}}\\)\t(15)\nwhere \\(H_{i,k}^{\\text{MHA}}\\) denotes the k-th dimension of the i-th node's representation in \\(H^{\\text{MHA}}\\)."}, {"title": "C. Optimization of Objective Function", "content": "This section introduces a node-wise contrastive masked FC (CMF) loss function to enhance inter-FC and intra-FC strength distances. For each node i at time t, the mean connectivity value is defined as \\(\\mu_i(t) = \\sum_{i=1}^{|V|} C_i(t)\\). Subsequently, we generate positive and negative masks for connectivity pairs according to \\(M(t) = I ((C_i(t) \\ge \\mu_i^c(t)) \\land (C_i(t) \\le \\mu_i^c(t)))\\), where I(\u00b7) is the indicator function. The positive and negative sample sets are then defined as \\(A^{\\pm}(t) = \\{(i, j) | M(t) = 1\\}\\) and the CMFS Finally, the CMF loss is expressed as:\n\\(L_{pos} = \\frac{1}{|A^+|} \\sum_{(i,j) \\in A^+} \\text{log}(\\frac{\\text{exp}(S_{ij}(t))}{\\sum_{k \\in V} \\text{exp}(S_{ik}(t)) + \\epsilon}),\\)\n\\(L_{neg} = \\frac{1}{|A^-|} \\sum_{(i,j) \\in A^-} \\text{log}(1 - \\frac{\\text{exp}(S_{ij}(t))}{\\sum_{k \\in V} \\text{exp}(S_{ik}(t)) + \\epsilon}),\\)\t(16)\nwhere \\(S_{ij}(t) = \\frac{\\sum_{k=1}^{T} C_i(t)C_j(t)}{\\sqrt{\\sum_{k=1}^{T} C_i(t)^2\\sum_{k=1}^{T} C_j(t)^2}}\\) computes the cosine similarity of FC between nodes i and jat time t and \\(\\epsilon = 10^{-6}\\) is added to prevent division by zero. To optimize the model, the final AGE-GCN output Z was fed into simple multilayer perceptron (MLP) layers for our final two tasks: graph classification \\(\\hat{y} = MLP(Z)\\) and chronological age prediction \\(\\hat{y}_{age} = MLP(Z)\\). We minimized the CMF loss with positive \\(L_{pos}\\) and negative \\(L_{neg}\\) loss:\n\\(L_{CMF} = L_{pos} + L_{neg},\\)\t(17)\nAnd combine the cross-entropy loss for overall optimizations:\n\\(L = L_{CMF} + L_b\\)\t(18)\nD. Node Score Predictor\nRegarding FC, distinct brain regions exhibit characteristic patterns that reflect their specialized roles. To enhance intrinsic functional brain networks, we leverage FC strength distances between brain regions while incorporating age-modulated parameters \\(\\theta = \\{1,0, W\\}\\). Specifically, using the dynamic FC matrices \\(A_d(t)\\), we compute the multi-timestep average node weight \\(\\bar{C} = \\frac{1}{T} \\sum_{t=1}^{T} C(t) \\in \\mathbb{R}^{|V|}\\) and combine it with the final age-aware k-hop graph embedding to generate predictive node scores for individual regions. The score for the ith node is expressed as follows:\n\\(S_i = \\bar{C} - (\\sum_{j \\in V} \\xi(\\phi_i)Z(\\Theta))\\), i \\in \\{1,2,...,|V|\\}\t(19)\nwhere \\(\\xi(\\cdot)\\) denotes a non-linear transformation function and \\(Z(\\Theta) \\in \\mathbb{R}^{|V| \\times d}\\) represents the node embeddings learned by AGE-GCN with the parameter set \\(\\Theta\\).\nE. Minimum Spanning Tree\nGiven a weighted undirected graph \\(G_u = (V, E, w^u)\\), where \\(w^u(e_{ij})\\) assigns a weight to the edge \\(e_{ij} \\in E\\) between vertices i and j, we define the pruned weighted graph T(Gu) = (\u03bd, ET, w\"), where \\(E_T \\subseteq E\\), \\(\\left \\|E_T\\right \\| < \\left \\|E\\right \\|\\) represents the set of edges retained in the minimum spanning tree (MST) after pruning. Our goal is to find the minimum spanning tree minimum spanning tree by solving\n\\(\\min_{T \\in T(G_u)} \\sum_{e_{ij} \\in E_T} w^u(e_{ij}).\\)\t(20)\nwhere T is a spanning tree with edges ET & that satisfies the diameter upper bound diam(T) < (\\(|V|-1\\))(\\(|V|-2\\)) as shown in [37]. In practice, Kruskal's algorithm [38] can be applied to compute the minimum spanning tree efficiently.\""}, {"title": "V. HIERARCHICAL BRAIN TREE CONSTRUCTION", "content": "To characterize the hierarchical structure of FC in brain networks associated with mental illness, we construct a weighted undirected graph Gu from fMRI signals. The edge weights wu(eij) are derived from the FC strength measured for each ROI connectomee. Following Definition IV-E, the pruning process ensures that the set Et retains only the significant edges that satisfy the optimization criterion. This approach constructs a hierarchical representation of brain connectivity that emphasizes the structural and functional relationships pertinent to mental illness.\nA. Optimal Weighted Tree Path\nGiven the pruned graph T(G), we examine paths that integrate node importance and high-order FC across multiple tree depths. Let P = {\u03c51, \u03c52,...,\u03c5k} represent a path of length k - 1 in T(G), where each node v \u2208 P is associated with a scalar score S(\u03c5; \u0398) \u2208 R, computed from Eq. 19. The edge set of P is denoted by E(P) = {ei,j | \u2200i, \u2200j \u2208 P(vi, vj) \u2208 T(G)}, where each edge eij \u2208 E(P) represent the path of neighbor connectivity. Let a single learnable node weight be defined:\n\\(F_{i,j} = \\frac{1}{T} \\sum_{t=1}^{T} \\sigma(\\sum_{u_j \\in P} Adj_j(t) w_j(t))\\),\t(21)\nwhere Adj (t) represents the adjacency relationship between nodes \u03c5i and \u03c5j at time t, and wj(t) is the learnable weight for node \u03c5j. The composite path weight W(P) is expressed as:\n\\(W(P) = \\alpha \\sum_{i,j} S(v; \\Theta) + (1 - \\alpha) \\sum_{s=1}^{S} \\sum_{(v_i,v_j)\\in E(P)}F_{i,j}^{(s)},\\)\t(22)\nHere, \\(F_{i,j}^{(s)}\\) represents the s-th order FC between nodes \u03c5i and \u03c5j along the path and balance parameter \u03b1 \u2208 [0,1]. To solve Eq. 22, we identify the path that minimizes W(P) by adjusting the parameter \u03b1 to balance the contributions of the scoring function S(\u03c5; \u0398) and the connectivity strengths along the path. Additional experimental results can be found in Fig. 5. According to theorem IV in the Appendix, the optimal path can be determined when \u03b1* exist in the interval [\u03b1L, \u03b1U] [39].\nB. High-Order Tree Path Aggregation\nIn high-order tree path traversal, our objective is to aggregate information about the connectivity of tree paths within the pruned graph T(G). In practice, we aggregate connectivity information from neighboring edges at each node, forming a weighted tree path. We define the second term in Eq. 22, which represents the high-order FC contribution for an s-order connectivity along the p-th path, as follows:\n\\(F_{i,j} = F_{i,j} + \\sum_{P \\in P_s(i,j)} F_v^{(s(p))}\\)\t(23)\nwhere \\(F_v^{(0)}\\) = Ad represents the direct average FC of a 0-th order path, and Ps(i, j) denotes the set of all possible s-order paths between nodes i and j in T(G). For each s-order path p = (i,k1,k2, ..., ks, j), where all intermediate nodes are distinct (km \u2260 kn \u2200m = n), its contribution is calculated as \\(P_s(p) = \\sum_{v \\in p} F_v\\). For a path of order s, its extended connectivity at order s + 1-th through the neighboring node k can be computed as \\(F_{ik}^{(s+1)} = \\sum_{k \\in N(i,j)} (\\frac{F_{ik}^{(+)} + F_k^{(+)}}{2})\\), where N(i, j) represents the set of common neighbors between nodes i i and j, and \\(F_v^{(s+1)}\\) denotes the s-th order path connectivity from node i to node k. This formulation allows us to capture direct connections and higher-order structural relationships within the brain network, as illustrated in Fig. 2.\nC. Fine-Grained Tree Trunk\nWe aim to construct a hierarchical tree structure comprising a trunk and branches distributed across different levels in T(G). Our method groups nodes with similar scores into the same hierarchical level integrates the most relevant paths into the l-th trunk Tl and excludes unrelated paths. For the l-th level connected component Gl = (Vl, El), the numbers of nodes and edges decrease monotonically as the level increases\u2014that is, Vl \u2286 Vl\u22121 and El \u2264 El\u22121. Following Section V-A, we identify the shortest path set P(Vstart, Vend) = {Vstart, V2,..., Vend} that incorporates the weighted tree path and the optimal trunk set T' = {T1, T2, . . ., Th}, as presented in algorithm 16."}, {"title": "VI. EXPERIMENTS", "content": "In this section, we first evaluate the proposed NeuroTree performance in disease classification (section VI-C) and its application to predicting chronological age (section IX). In section VII-B, we analyze the convergence of the spectral norm for k-hop connectivity. Finally, we examine how hierarchical brain trees interpret FC patterns between brain regions and their corresponding seven subnetworks in section VIII.\nA. Datasets\nWe validated two publicly available fMRI datasets -one focusing on cannabis use disorder and the other on schizophrenia."}, {"title": "VII. ABLATION STUDY", "content": "A. The Impact of Objective Function and Demographics\nIn this section, we evaluate the efficacy of CMF loss integration within our proposed NeuroTree. The quantitative analysis in Table I demonstrates that without LCMF, the model only achieves an AUC of 0.74 on the cannabis dataset and 0.63 on the COBRE dataset. Notably, even without the CMF loss component, our approach still exhibited performance comparable to MixHop across other metrics, particularly in characterizing mental disorder feature classification. With CMF loss integration, NeuroTree achieves superior results with AUC values of 0.77 and 0.71, respectively. This enhancement stems from combining the loss function with an attention mechanism optimization framework that simultaneously suppresses connectivity between dissimilar regions while amplifying patterns among similar neurological areas. Furthermore, our ablation experiments demonstrate that age serves as a critical modulator in AGE-GCN by adapting parameter \u03b8, substantially influencing the classification of changes in brain connectivity.\nB. Convergence Analysis\nTo further examine the convergence speed of k-hop FC in various brain disorders, we analyze the spectral norm under the \u03bb = 1 setting in the convergence of \\(\\Phi_k(t)\\). Although the COBRE dataset initially exhibits slower convergence, particularly with the boundary defined around order 15, the overall convergence in the cannabis dataset is faster than in COBRE across different k-hop values. Furthermore, when analyzing the convergence of \\(\\Phi_k(t)\\) under varying \u03bb values, as shown in Fig. 3 (middle) and (right), the \u03bb values for cannabis are more concentrated and stable. In contrast, COBRE requires larger \u03bb values to achieve convergence. The empirical results effectively capture the relationship between dynamic and static FC of \\(\\hat{A}_k(t)\\). This indicates that addiction may lead to stronger brain connectivity signals compared to psychiatric disorders, as reflected in the affected brain regions."}, {"title": "VIII. BRAIN TREE ANALYSIS", "content": "This section investigates brain disorders by analyzing hierarchical brain networks using decoded fMRI-derived connectomes. NeuroTree deconstructs the brain network into a tree-structured component graph consisting of a main trunk and radial branches. We identify key regions associated with brain disorders within each trunk by analyzing optimal weighted high-order tree paths. Our analysis highlights the most relevant functional network regions determining critical pathways within the brain connectome tree.\nA. Exploring Hierarchical Regional Patterns in Brain Disorders\nTo better understand how embedded brain features vary across different hierarchical levels of brain subnetworks, NeuroTree predicts each ROI score and performs reranking, as illustrated in Fig. 1. Higher levels represent trunk pathways of high-scoring nodes, strongly connected edges, and their associated brain ROIs. We mapped the atlas parcellations of both datasets (i.e., 90 ROIs and 118 ROIs) to Yeo's seven-network parcellation [47], which includes the visual network (VN), somatomotor network (SMN), dorsal attention network (DAN), ventral attention network (VAN), limbic network (LIM), frontoparietal network (FPN), and default mode network (DMN). Atlas regions not belonging to these networks were classified as 'Others.\nNext, we discuss the addiction brain tree illustrated in Figs. 4 (a-1) and (a-2), which features three trunk levels. At the primary trunk level (red pathway), the addiction brain tree predominantly exhibits connectivity among DMN (red), FPN (purple), and partial VAN (sky blue) nodes, similarly, in Figs. 4 (b-1) and (b-2), the schizophrenia brain tree at the main trunk level primarily involves VN (light blue) node, VAN, and partial SMN (green) nodes. At the second hierarchical level (pink pathways), the addiction cohort exhibits predominant connections within DMN and FPN nodes. In contrast, the schizophrenia group at this level demonstrates connectivity primarily among VAN and some DMN nodes. Finally, at the third hierarchical level (light purple pathways), the addiction group's terminal branches show minimal connections with FPN, VAN, and DMN nodes. In contrast, the schizophrenia cohort displays connections among VN nodes. A key observation is that the addiction brain tree exhibits more distinct communities at different levels, characterized by groups of highly interconnected brain regions. In contrast, the schizophrenia brain tree has a more disordered topological structure, where different networks appear on the same main trunk, leading to a less structured node sequence."}, {"title": "IX. CHRONOLOGICAL BRAIN AGE PREDICTION", "content": "In this section, we employed NeuroTree to predict mental health disorders and analyze their effects on brain FC changes across different age groups. Participants were stratified into three age-based cohorts, and brain age was predicted in the testing set. First, NeuroTree predicted FC values across age groups. The results indicate that as age increases, the addiction and mental disorders cohorts exhibit substantial age-related changes in FC, indicating that cannabis use and schizophrenia have similar impacts on the brain FC, as illustrated in Fig. 7. Second, we present Table III, validating NeuroTree predictions of brain age compared to chronological age.\nOverall, in NeuroTree age prediction, the cannabis cohort exhibited a lower MSE than the COBRE cohort. Additionally, we calculated the Pearson correlation coefficient (r) between predicted and actual ages, achieving values exceeding 0.95. Notably, for psychiatric disorder predictions, the MSE for the 18-25"}]}