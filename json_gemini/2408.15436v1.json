{"title": "Online Event-Triggered Switching for Frequency Control in Power Grids with Variable Inertia", "authors": ["Jie Feng", "Wenqi Cui", "Jorge Cort\u00e9s", "Yuanyuan Shi"], "abstract": "The increasing integration of renewable energy resources into power grids has led to time-varying system inertia and consequent degradation in frequency dynamics. A promising solution to alleviate performance degradation is using power electronics interfaced energy resources, such as renewable generators and battery energy storage for primary frequency control, by adjusting their power output set-points in response to frequency deviations. However, designing a frequency controller under time-varying inertia is challenging. Specifically, the stability or optimality of controllers designed for time-invariant systems can be compromised once applied to a time-varying system. We model the frequency dynamics under time-varying inertia as a nonlinear switching system, where the frequency dynamics under each mode are described by the nonlinear swing equations and different modes represent different inertia levels. We identify a key controller structure, named Neural Proportional-Integral (Neural-PI) controller, that guarantees exponential input-to-state stability for each mode. To further improve performance, we present an online event-triggered switching algorithm to select the most suitable controller from a set of Neural-PI controllers, each optimized for specific inertia levels. Simulations on the IEEE 39-bus system validate the effectiveness of the proposed online switching control method with stability guarantees and optimized performance for frequency control under time-varying inertia.", "sections": [{"title": "I. INTRODUCTION", "content": "Frequency stability is vital for the security and operation of power systems, the goal of which is to balance power generation and demand to maintain the system frequency near its nominal value (i.e., 60 Hz in the US). This paper mainly focuses on primary frequency control, which corrects immediate power imbalances within seconds [1]. The surge in integrating renewable energy sources like wind and solar, while marking significant progress towards sustainability, introduces larger fluctuations in net loads due to their unpredictable power outputs, thus requiring more advanced controllers [2]. Moreover, many of these new technologies are interfaced with the grid through power electronic interfaces (i.e., inverters), which have no rotational inertia. At the same time, the grid still has a large number of synchronous components, creating a system that is a mixture of conventional machines and inverter-connected resources. The amount of inertia depends on the amount of online synchronous generators. At different times of the day, renewable generations will displace a different amount of power generation from synchronous machines, leading to different numbers of online synchronous generators. As a result, the grid can present a reduced and switching system inertia, where switching means the inertia is a right continuous piecewise constant function of time [3]. The resulting complexity has been linked to a noticeable degradation in system frequency dynamics [4]-[6], risking load shedding and blackouts. Despite significant efforts for handling reduced inertia [2], [7], [8], two facts motivate further research considering the time-varying systems: (1) even if each sub-system is exponentially stable, the switching system can be unstable [9]; (2) the optimal controller for a specific inertia can be suboptimal for another. For example, as system inertia increases, frequency dynamics slow down, potentially causing prolonged frequency deviations with the controller optimized for low inertia [10].\nTo tackle the challenge of frequency control under time- varying inertia, we model the system as a nonlinear switching system between different inertia levels, where the switching signal is unknown to the controller beforehand. Our objectives are first to guarantee stability for the time-varying system and then to improve the performance of controllers designed for time-invariant systems. We first identify a key controller structure, named Neural Proportional-Integral (Neural-PI) control, that guarantees exponential input-to-state stability (Exp- ISS) of the nonlinear frequency dynamics under an arbitrary, fixed inertia mode, through Lyapunov analysis. The Neural-PI structure is first introduced in [11] for frequency control under time-invariant inertia with asymptotic stability guarantees. In this work, we first improve the analysis of [11] to show the Neural-PI controller guarantees Exp-ISS for the time-invariant"}, {"title": "A. Related Work", "content": "Significant progress has been made in frequency control for systems with reduced and time-invariant inertia, with growing interest in approaches for time-varying inertia. This section reviews recent advancements in frequency control for both constant and time-varying inertia.\n1) Frequency control under time-invariant inertia: Most existing frequency control methods are designed for systems with constant inertia, including classical droop control [1], [12]\u2013[14], model predictive control (MPC) [8], [15] and data- driven control [2], [11], [16]\u2013[19]. The most popular method for primary frequency control using synchronous generators is droop control, which is typically a linear function of the frequency deviation (possibly with deadbands and saturation) [1], [12]. Droop control is also adopted in inverter-connected resources to provide primary frequency control, to mimic the behavior of synchronous generators [13], [14]. However, linear controllers can be sub-optimal since the frequency dynamics are nonlinear [15]. Facing this challenge, MPC-based approaches [8], [15] synthesize nonlinear controllers through optimization, which can lead to computational challenges for real-time control. Considering the nonlinear nature of frequency dynamics and the requirement for fast computation, recently, reinforcement learning (RL) approaches have been proposed [16], [17]. See [2] for a recent review. The basic idea of RL lies in finding a policy that computes the optimal action based on observed states, aiming to maximize cumulative rewards through interaction with the environment. The key challenge with those learning-based methods is ensuring stability, which is critical for power system applications. To this end, recent studies have integrated RL with stability guarantees [11], [18], [19], for frequency control under constant inertia.\n2) Frequency control under variable inertia: There is growing interest in frequency control under variable inertia, due to the increasing penetration of renewable generation. [20] firstly proposed to use a switched-affine system model with the linear approximated frequency dynamics for each inertia model. Building on this model, [21] developed a stable, time-invariant linear controller learned from datasets of optimal time-varying LQR controllers. Additionally, [22] validated the feasibility of solutions within the switched- affine system framework, leveraging the specific structure of linearized frequency dynamics. Building on this, [23] introduces a nonlinear residual in addition to a stable linear controller to improve performance, with stability ensured through projection. [24] proposes a robust controller that optimizes the worst- case system performance via a $H_\\infty$ loop shaping controller that adapts to time-varying inertia. [25] considers the variable inertia by modeling the dynamics as a linearized stochastic swing equation, where inertia is modeled as multiplicative noise. [10] proposes a PI-based load frequency controller that is robust to inertia change, and where stability is validated by small-signal analysis. Despite these advancements, a common limitation persists: the models rely on a linear swing equation for modeling the frequency dynamics and therefore are unable to accurately capture the nonlinear behavior, which might compromise control performance. There is also work on system inertia estimation for frequency control under variable inertia [26], employing real-time inertia estimation to determine minimum PV power reserve requirements. However, this approach does not provide stability guarantees for the switching system, and as noted in a recent survey [27], fast and robust inertia estimation is challenging.\nNotation. We use bold symbols to represent vectors. $sp(A) := \\frac{1}{2}(A+A^T)$ denotes the symmetric part of a square matrix A. diag(c) represents the diagonal matrix with diagonal equal to the vector c. Vectors of all ones and zeros are denoted by $1_n,0_n \\in R^n$, respectively. We use the superscript * to denote the equilibrium points of the variables."}, {"title": "II. MODEL AND PROBLEM FORMULATION", "content": "Consider a n-bus power network represented as a connected graph $(\\mathcal{V},\\mathcal{E})$, where buses are indexed by $i, j \\in \\mathcal{V} := [n] := \\{1, ..., n\\}$ and the connecting lines are denoted by unordered pairs $\\{i, j\\} \\in \\mathcal{E}$. State variables are phase angles $\\theta := (\\theta_i, i \\in [n]) \\in \\mathbb{R}^n$ and frequency deviations from the nominal frequency $\\omega := (\\omega_i, i \\in [n]) \\in \\mathbb{R}^n$. Since the frequency dynamics only depend on the phase angle differences, we define a change of coordinates $\\delta \\theta := \\theta - \\frac{1}{n} \\sum_{j=1}^n \\theta_j$, where $\\delta := (\\delta_i, i \\in [n]) \\in \\mathbb{R}^n$ can be understood as phase angles in the center-of-inertia coordinates. This change of coordinates is only for analysis purposes. Denoting a bounded disturbance of power injection"}, {"title": "A. Power System Model", "content": "from the nominal set-point $p_i$ as $\\Delta d_i$ (e.g., renewable and load fluctuations), the system dynamics can be written as:\n$$\n\\begin{aligned}\n\\dot{\\delta}_i &= \\omega_i \\\\\nM_i\\dot{\\omega}_i &= \\frac{1}{n} \\sum_{j=1}^n \\omega_j, \\\\\nM_i\\dot{\\omega}_i &= p_i - D_i \\omega_i + u_i - \\sum_{j=1}^n B_{ij} \\sin(\\delta_i - \\delta_j) + \\Delta d_i,\n\\end{aligned}\n$$\nwhere $M := \\text{diag}(M_i, i \\in [n]) \\in \\mathbb{R}^{n \\times n}$ are the generator inertia, $D := \\text{diag}(D_i, i \\in [n]) \\in \\mathbb{R}^{n \\times n}$ are the combined frequency response coefficients from synchronous generators and frequency sensitive loads, $p := (p_i, i \\in [n]) \\in \\mathbb{R}^n$ are the net power injections, $B := [B_{ij}] \\in \\mathbb{R}^{n \\times n}$ is the susceptance matrix with $B_{ij} = 0, \\forall \\{i, j\\} \\notin \\mathcal{E}$, and $u := (u_i, i\\in [n]) \\in \\mathbb{R}^n$ are the control actions, denoting the active power injection to regulate the frequency. Note that the time index $t$ for all the state and action variables $\\delta_i(t), \\omega_i(t), u_i(t)$, and the disturbance $\\Delta d_i(t)$ in (1) are omitted for brevity.\nFollowing the recent NREL report [3, Fig. 13 & Fig. 14], the amount of inertia is piece-wise constant because it only depends on the on/off status of synchronous generators. Thus, the frequency dynamics with time-varying inertia can be modeled as a switching system, with a predetermined set of values of equivalent inertia at each \u201cmode\u201d. The evolution of the inertia in the system depends on the current mixture of conventional generators and inverter-connected resources, and the switches happen hourly (when a large renewable generation is available, some synchronous generators will be offline). Considering m different inertia modes, the inertia follows a piece-wise continuous switching signal $q(t) : [0,\\infty) \\rightarrow \\{1,...,m\\}$ that remains unknown to the controller. Thus the frequency dynamics in (1b) under time-varying inertia can be written as,\n$$\nM_{i,q(t)}\\dot{\\omega}_i = p_i - D_i \\omega_i + u_i - \\sum_{j=1}^n B_{ij} \\sin(\\delta_i - \\delta_j) + \\Delta d_i.\n$$\nThis dynamics model in (2) makes the following assumptions that are commonly adopted in the literature, cf. [28]:\n\u2022 Lossless lines: the line resistance is zero for all $\\{i, j\\} \\in \\mathcal{E}$;\n\u2022 Constant voltage profile: the bus voltage magnitudes for all buses are constant and equal to 1 p.u. Reactive power flows are not considered;\n\u2022 Bounded angle difference: the equilibrium bus phase angle difference is within $\\pm \\frac{\\pi}{2}$ for all $\\{i, j\\} \\in \\mathcal{E}$.\nFurther, we assume that the bounded disturbances $\\Delta d$ do not depend on the history of states and actions. The assump-"}, {"title": "B. Control System Architecture", "content": "We present the control system architecture in Figure 2. The controller of inverter i infers the frequency deviation $\\omega_{\\text{pll},i}$ from the phase-locked-loop (PLL) block. Considering the much faster time response of PLLs on inverters (they lock around 1 AC cycle [29], [30]), we assume that the measured frequency deviation $\\omega_{\\text{pll},i}$ accurately approximates $\\omega_i$. To guarantee convergence to the nominal frequency and improve economic efficiency, we consider distributed communication allowing for bidirectional information exchange between neighboring buses, defined by the incidence matrix $\\mathcal{E}$. The elements of matrix $\\mathcal{E}$ can be +1, -1, or 0, and their values indicate the orientation of the edges relative to the buses. The control action at bus i is defined as $u_i$, which is the real power injection at bus i calculated with real-time local frequency measurements $\\omega_i$ and communication. We assume real-time communication and timescale separation between the inverter dynamics and frequency control."}, {"title": "III. PROBLEM FORMULATION", "content": "This paper focuses on frequency control with variable inertia. The switching dynamics for inertia are unknown to the control algorithm. Our objective is to minimize the frequency deviation of the system while maintaining moderate control costs."}, {"title": "IV. EXPONENTIALLY STABLE CONTROLLER DESIGN UNDER ALL MODES", "content": "In this section, we design a controller structure that satisfies the Exp-ISS property in Definition 1 under all modes and provide a theoretical analysis. Our goal is to develop a uniform stabilizing controller for all inertia modes in the switching system that simultaneously achieves two key objectives. Firstly, restore the system to its nominal frequency, where $\\omega^* = 0_n$. Secondly, optimize the control cost for maintaining system operation at the equilibrium, expressed as $c(u) = \\sum_{i=1}^n C(u_i)^2$."}, {"title": "A. Controller Structure", "content": "The steady-state optimization problem can be written as the optimal steady-state economic dispatch problem:\n$$\n\\begin{aligned}\n\\min_{u^*} \\quad c(u^*) &= \\frac{1}{2} \\sum_{i=1}^n (u_i^*)^2 \\\\\n\\text{s.t.} \\quad \\sum_i (p_i + u_i^*) &= 0.\n\\end{aligned}\n$$\nTo meet the requirement of nominal frequency restoration and steady-state optimality, Distributed Averaging-based Integral (DAI) [32] is an established choice for frequency control. Based on this idea, we propose to use the following neural proportional-integral (Neural-PI) controller structure,\n$$\n\\begin{aligned}\n\\pi_i(\\omega_i, s_i, \\{s_j, j\\in\\mathcal{N}_i\\}) &= -\\overline{\\pi}_i(\\omega_i) + ks_i \\\\\ns_i &= -c_i\\omega_i - \\sum_{j \\in \\mathcal{N}_i} (c_i k s_i - c_j ks_j).\n\\end{aligned}\n$$\nWe name it neural because the proportional term $\\overline{\\pi}_i(\\cdot)$ is a monotonically increasing function of the instantaneous frequency deviation $\\omega_i$ parameterized as a monotone neural network with $\\overline{\\pi}_i(0) = 0$. We name it integral because it is a linear function of $s_i$, the integral of frequency deviations and the difference in the gradients of the control cost $c(ks)$ between its neighbors. $k > 0$ is a learnable control gain defined as a scalar. The linear integral control is deployed instead of a neural network to achieve exponential stability guarantees."}, {"title": "B. Theoretical Results", "content": "Combining the frequency dynamics and the proposed Neural- PI controller in (6), the overall closed-loop system can be modeled in vector form as follows,\n$$\n\\begin{aligned}\n\\dot{\\delta} &= (I_n - \\frac{1}{n} 1_n 1_n^T) \\omega, \\\\\nM_{q(t)}\\dot{\\omega} &= p + \\pi(\\omega, s) - D \\omega - E B \\sin(E^T \\delta) + \\Delta d.\n\\end{aligned}\n$$\nOur first result characterizes the equilibrium points of the closed-loop system (7) with $\\Delta d = 0_n$.\nAssume $\\forall\\{i,j\\} \\in \\mathcal{E} |\\delta_i - \\delta_j| < \\frac{\\pi}{2}$, the power flow equation (3c) is feasible, and proportional term equals to zero when the frequency deviation is zero, i.e., $\\pi(0_n) = 0_n$. Then the equilibrium $(\\delta^*,\\omega^*,ks^*)$ of the closed-loop system (7) with $\\Delta d = 0_n$ is the unique point satisfying\n$$\n\\begin{aligned}\n\\omega^* &= 0_n, \\\\\nE B \\sin(E^T \\delta^*) &= p + k s^*, \\\\\nk s^* &= \\gamma C^{-1} 1_n,\n\\end{aligned}\n$$\nwhere $\\gamma$ is determined by\n$$\n\\gamma = \\frac{-\\sum_{i=1}^n p_i}{\\sum_{i=1}^n c_i^{-1}}.\n$$\nEquation (8a) indicates that the proposed controller effectively reduces frequency deviations to zero at the steady state. Given that $1^T E = 0$, and upon premultiplying equation (8b), it follows that $\\sum_i (p_i + ks_i) = 0$. By (8c), the final control action, $ks$, is distributed proportionally to $\\gamma e^{-1} 1_n$. This allocation strategy facilitates higher real power injection from lower-cost buses, thereby restoring generation balance in an economically efficient manner. Moreover, the equilibrium point remains the same regardless of the inertia mode change and switching of controllers.\nFor each fixed inertia mode, the following result provides an exponential ISS guarantee for the closed-loop system.\nLet $\\pi(0_n) = 0_n$ and $\\overline{\\pi}_i(\\omega_i)$ be monotonically increasing with respect to $\\omega_i$. Consider $\\mathcal{D} := \\{x \\in \\mathbb{R}^{3n},\\forall\\{i, j\\} \\in \\mathcal{E}, |\\delta_i - \\delta_j| < \\frac{\\pi}{2}\\}$. If a Neural-PI controller defined by (6) is deployed, then for any $x_0 \\in \\mathcal{D}$, the closed-loop system (1) is exponentially input-to-state stable (Exp-ISS), i.e., there exists positive scalars $\\kappa, \\beta$ and $0 < \\rho < 1$ such that for all $t \\ge 0$,\n$$\n||x(t)||_2 < \\kappa \\rho^t ||x_0||_2 + \\beta ||\\Delta d(t)||_{L_\\infty}.\n$$\n guarantees Exp-ISS for the closed-loop (1) with the Neural-PI controller under any timer-invariant inertia, ensuring stability despite disturbances and supporting the generalization of stability to the switching system (7). We prove this using Lyapunov stability analysis by identifying a well-defined Lyapunov function that exponentially converges along the system's trajectories (1) with bounded disturbance errors."}, {"title": "C. Monotone Neural Network", "content": "The monotonically increasing function $\\overline{\\pi}_i(\\cdot)$ is constructed as a stacked ReLU function as follows.\nThe stacked ReLU function with $d$ hidden units constructed by\n$$\n\\overline{\\pi}^+(\\mathbf{x}; \\mathbf{w}^+,\\mathbf{b}^+) = (\\mathbf{w}^+)^T \\text{ReLU}(l \\mathbf{x} + \\mathbf{b}^+) \\\\\n$$\n$$\n\\sum_{l=1}^{d'} w_l^+ > 0, \\forall d' = 1, ..., d, b_1^+ = 0, b_l^+ \\le b_{l-1}^+, \\forall l = 2, ..., d\n$$\nis monotonically increasing for $x > 0$ and zero when $x < 0$. In addition, the stacked ReLU function with $d$ hidden units constructed by\n$$\n\\overline{\\pi}^-(\\mathbf{x}; \\mathbf{w}^-,\\mathbf{b}^-) = (\\mathbf{w}^-)^T \\text{ReLU}(-l \\mathbf{x} + \\mathbf{b}^-) \\\\\n$$\n$$\n\\sum_{l=1}^{d'} w_l^- < 0, \\forall d' = 1, ..., d, b_1^- = 0, b_l^- \\le b_{l-1}^-, \\forall l = 2, ..., d\n$$\nis monotonically increasing for $x < 0$ and zero when $x \\ge 0$.\nIn this way, the stacked ReLU function is a piece-wise linear function. The slope for each piece of $\\overline{\\pi}^+(\\mathbf{x}; \\mathbf{w}^+,\\mathbf{b}^+) = \\sum_{l=1}^d w_l^+$, which is always positive by construction and thus satisfies the monotonic property. A similar argument holds for $\\overline{\\pi}^-(\\mathbf{x}; \\mathbf{w}^-,\\mathbf{b}^-)$. As a result, let $\\pi(\\cdot) = \\overline{\\pi}^+(\\cdot;\\mathbf{w}^+,\\mathbf{b}^+) + \\overline{\\pi}^-(\\cdot; \\mathbf{w}^-,\\mathbf{b}^-)$, $\\pi(x)$ is monotonically increasing."}, {"title": "V. ONLINE SWITCHING ALGORITHM", "content": "In this section, we introduce an online event-triggered switching algorithm with stability guarantees for frequency control under time-varying inertia. The proposed algorithm dynamically chooses from a set of pre-trained Neural-PI controllers that are optimized for different uni-inertia modes, to improve the controller performance while maintaining stability. For implementation purposes, the algorithm is presented in a discrete-time manner."}, {"title": "A. Online Event-triggered Switching Algorithm", "content": "Based on the previous discussion, the Neural-PI controller is capable of maintaining frequency stability under any inertia level. However, controllers optimized for high-inertia systems may underperform when inertia is low due to faster frequency dynamics [4]. Consequently, a uniform Neural-PI controller, even trained for all modes, compromises between different inertia modes and can result in suboptimal performance. Instead, here we propose an innovative switching algorithm to select the most appropriate controller based on the current system state from a set of Neural-PI controllers, each trained for a specific inertia level, while guaranteeing stability. The switching algorithm can improve control performance compared to base controllers trained for each specific mode."}, {"title": "B. Stability Guarantees for the Switching System", "content": "With the online event-triggered switching algorithm in Algorithm 1, we now proceed to provide stability guarantees for the switching system. Let $N_q(T, t)$ be the number of mode switches in the interval $[t,T)$. The switching signal $q(t)$ has an average dwell-time $\\tau_a$ if there exists $N_0, T_a > 0$ such that $N_q(T, t) \\le N_0 + \\frac{T-t}{T_a}, \\forall T > t > 0$. The following result states that, if inertia switches sufficiently slow (with a sufficiently large $\\tau_a$), as compared to the time scale of the control, the switching system with both inertia switching and controller switching is still guaranteed to be Exp-ISS.\nConsider a finite number of inertia modes $\\{1,..., m\\}$, with each candidate controller in the pool $P$ being a Neural- PI controller as defined by (6) deployed over $\\mathcal{D} := \\{x \\in \\mathbb{R}^{3n}, \\forall\\{i, j\\} \\in \\mathcal{E}, |\\delta_i-\\delta_j| < \\frac{\\pi}{2}\\}$. There exist constants $T_a, \\kappa^* > 0, \\rho^* \\in (0,1)$, and $\\beta^* > 0$ such that, if the average dwell time $T_a > T_a$, then with the online event-triggered switching Algorithm 1,\n$$\n\\begin{aligned}\n\\text{the switching system satisfies} \\\\n||x(t)||_2 \\le \\kappa^* (\\rho^*)^t ||x_0||_2 + \\beta^* ||\\Delta d(t)||_{L_\\infty}.\n\\end{aligned}\n$$\nWe provide the proof sketch for . Consider first the case of inertia changes only. In this case, is a direct consequence of [9, Theorem 3.1]. When switching of controllers is considered, the Lyapunov function (19) is invariant to controller changes. Thus the Lyapunov function for the current controller is a common Lyapunov function for all base Neural-PI controllers, and switching of controllers retains Exp-ISS.\nNote that the average dwell time $\\tau_a$ is sufficiently large in frequency control. A long average dwell time $\\tau_a$ of inertia implies slow inertia switching. In scenarios where synchronous generators provide inertia, such switches occur on an hourly basis, whereas control actions are executed in second and sub-second scale [3]. Therefore, the average dwell time $T_a$ is sufficiently large for the controllers, and Exp-ISS for the system with switching inertia is preserved with rates $\\kappa^*, \\rho^*$ and $\\beta^*$. Theorem 3 also generalizes the stability guarantees of the batched MAB algorithm [33] from an unknown time-invariant system to unknown time-varying systems. When the switching of inertia is sufficiently slow, the online event-triggered control"}, {"title": "VI. EXPERIMENTS", "content": "This section first introduces the experiment setup and model training details. Then, we evaluate the performance of the base Neural-PI controllers and the proposed online switching algorithm. Finally, we study the impact of hyperparameters in the online switching algorithm through sensitivity analysis."}, {"title": "A. Experiment Setup", "content": "We evaluate the performance of different controllers using the IEEE New England 10-machine 39-bus (NE39) network [34]. There are three inertia modes, where the inertia constants $M$ are set at 30%, 100%, and 500% of the standard values [34]. These correspond to a low inertia scenario with prevalent renewable generation (denoted as 0.3), a standard scenario (denoted as 1.0), and a scenario dominated by synchronous generators (denoted as 5.0), respectively. Three base Neural- PI controllers are trained under specific inertia levels and denoted as 'Neural-PI-0.3', 'Neural-PI-1', and 'Neural-PI-5'. The Neural-PI controller structure is defined in (6), where the proportional term $\\pi(\\cdot)$ is parameterized as a monotone neural network defined in Corollary 1 with 1 hidden layer and 20 hidden units. To comply with the operational constraints, we threshold our control policy with action bounds, i.e. $[\\pi_i(\\omega_i, \\{s_j, j\\in\\mathcal{N}_i\\})]=[\\underline{u}_i, \\overline{u}_i]$, where $[\\,]$ represents a projection onto $[\\,\\underline{u}_i, \\overline{u}_i]$. These constraints are not considered in our theoretical analysis.\n1) Training Algorithm: To optimize the Neural-PI controller for each given inertia model, we adopt the Physics-informed Reinforcement Learning with RNN structure from [18], where RNN is a class of neural networks designed for modeling temporal sequences. Given that all states are time-coupled, we integrate the state transition dynamics (3b)-(3c) of the power system to the RNN framework following the training algorithm in [11] to train the base Neural-PI policies."}, {"title": "B. Performance of the Online Switching Control", "content": "1) Evaluation Metrics: We consider the transient period as the 3-second time interval after a disturbance and define the transient performance as the cumulative cost during this period. Three metrics are used to evaluate the controller performance:\n\u2022 Frequency deviation: is defined as $\\sum_{t=1}^T (||\\omega(t)||_2 + ||\\omega(t)||_\\infty)$ denoting the average frequency deviation during the transient period $T=300$;\n\u2022 Control cost: is defined as $\\sum_{t=1}^T c(u(t))$ measuring the average control cost during the transient period $T=300$;\n\u2022 Total cost: sum of frequency deviation and control cost.\n2) Statistical Results: We first present the performance of the base Neural-PI controllers at different fixed inertia modes to illustrate the sub-optimality when a controller is trained under one inertia level but then used for a different inertia. Table II summarizes the average total cost along 100 test trajectories.\nWe now evaluate the performance of known switching, the proposed online switching control in Algorithm 1, base Neural- PI controllers, and other baselines for frequency control under variable inertia. Known switching refers to the ideal scenario where, as soon as the inertia mode changes, the corresponding controller is deployed instantly. However, real-time mode detection poses significant challenges, as highlighted by [27], and is thus considered an ideal performance benchmark. This experiment uses a 20-second trajectory with mode transitions occurring every five seconds. Results from 100 test trajectories are summarized in"}, {"title": "C. Sensitivity Analysis", "content": "Last, we examine the impact of hyperparameters $\\xi$ (learning rate) and $\\tau$ (batch length) in the proposed online switching"}, {"title": "VII. CONCLUSIONS", "content": "In this work, we have considered the problem of primary frequency control under time-varying system inertia. To address it, we have modeled it as a switching system, where the frequency dynamics under each mode are described by the nonlinear swing equation, and different modes represent different system inertia levels determined by the ratios of inverter-connected resources and synchronous generators. We"}, {"title": "APPENDICES", "content": ""}, {"title": "A. Proof of Theorem 1", "content": "Proof. At steady state, the dynamics (7) yields\n$$\n\\begin{aligned}\n\\omega^* &= 1_n \\omega^*, \\\\\n0_n &= p + u(\\omega^*, s^*) \u2013 D \\omega^* \u2013 EB \\sin(E^T \\delta^*), \\\\\nC^{-1} \\omega^* &= \u2013 EE^T C k s^*,\n\\end{aligned}\n$$\nwhere $\\omega^*$ is a scalar. Premultiplying (16c) by $1^T$ yields\n$$\n1^T C^{-1} 1_n \\omega^* = \u2013 1^T E E^T C k s^* = 0,\n$$\nwhich implies that $\\omega^* = 0$. As a result, the right-hand side of (16c) also equals the zero vector. Following [11, Lemma 5], $E E^T C k s^* = 0_n$ if and only if $Cks \\in \\text{range}(1_n)$, which indicates that $C k s^* = \\gamma 1_n$, implying that $k s^* = \\gamma C^{-1} 1_n$. In this case, $u^* = k s^*$ is the unique minimizer of the optimal steady-state economic dispatch problem following [32]. Applying these results to (16b) yields\n$$\nE B \\sin(E^T \\delta^*) = p + k s^* = p + \\gamma C^{-1} 1_n.\n$$\nBy premultiplying the above equation with $1^T$ and the fact that $1^T E B \\sin(E^T \\delta^*) = 0$, we can reach to (9). This result is similar to the analysis in [32, Theorem 1]. Given that the inertia does not show up in the equilibrium analysis, the switching system has a unique equilibrium point."}, {"title": "B. Proof of Theorem 2", "content": "We use the Lyapunov stability theory. The proof is structured as follows. We first present the Lyapunov function for the closed-loop system", "3.4": "we arrive at Exp-ISS. Lyapunov Function: Define the function $R(s)$ as\n$$\nR(s) := \\sum_{i=1"}, "n c_i \\int_0^{s_i} k z dz = \\sum_{i=1}^n \\frac{c_i k^2}{2} s_i^2.\n$$\nThen, the Bregman distance is defined as $BV(s, s^*)$, i.e.,\n$$\nBV(s, s^*) := R(s) \u2013 R(s^*) \u2013 \\nabla R(s^*) (s-s^*)\n$$\nNotably, the Bregman distance here simplified as $BV(s, s^*) = \\sum_i c_i (s_i \u2013 s_i^*)^2$. We consider the following Lyapunov function candidate for a fixed inertia $M$:\n$$\nV(\\delta, \\omega, s) = \\frac{1}{2} \\sum_{i=1}^n M_i (\\omega_i \u2013 \\omega_i^*)^2 + W_p(\\delta) + BV(s, s^*) \u2013 \\epsilon_2 (s \u2013 s^*)^T 1_n 1_n^T M \\omega,\n$$\nwhere\n$$\nW_p(\\delta) := \\frac{1}{2} \\sum_{i=1}^n \\sum_{j=1}^n B_{ij} (\\cos(\\delta_{ij}) \u2013 \\cos(\\delta_{ij}^*))\\\\\n\\qquad - \\sum_{i=1}^n \\sum_{j=1}^n B_{ij} \\sin(\\delta_{ij}) (\\delta_i \u2013 \\delta_j),\n$$\n$$\nW_c(\\delta, \\omega) := \\sum_{i=1}^n \\sum_{j=1}^n B_{ij} (\\sin(\\delta_{ij}) \u2013 \\sin(\\delta_{ij}^*)) c_i M_i (\\omega_i \u2013 \\omega_i^*),\n$$\nand $\\delta_{ij} := \\delta_i \u2013 \\delta_j$. Here, $\\epsilon_1, \\epsilon_2 > 0$ are tunable parameters. The last cross-term in (19) is inspired by [42"]}