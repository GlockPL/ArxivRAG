{"title": "A Multi-agent Market Model Can Explain the Impact of AI Traders in Financial Markets - A New Microfoundations of GARCH model", "authors": ["Kei Nakagawa", "Masanori Hirano", "Kentaro Minami", "Takanobu Mizuta"], "abstract": "The AI traders in financial markets have sparked significant interest in their effects on price formation mechanisms and market volatility, raising important questions for market stability and regulation. Despite this interest, a comprehensive model to quantitatively assess the specific impacts of AI traders remains undeveloped. This study aims to address this gap by modeling the influence of AI traders on market price formation and volatility within a multi-agent framework, leveraging the concept of microfoundations. Microfoundations involve understanding macroeconomic phenomena, such as market price formation, through the decision-making and interactions of individual economic agents. While widely acknowledged in macroeconomics, microfoundational approaches remain unexplored in empirical finance, particularly for models like the GARCH model, which captures key financial statistical properties such as volatility clustering and fat tails. This study proposes a multi-agent market model to derive the microfoundations of the GARCH model, incorporating three types of agents: noise traders, fundamental traders, and AI traders. By mathematically aggregating the micro-structure of these agents, we establish the microfoundations of the GARCH model. We validate this model through multi-agent simulations, confirming its ability to reproduce the stylized facts of financial markets. Finally, we analyze the impact of AI traders using parameters derived from these microfoundations, contributing to a deeper understanding of their role in market dynamics.", "sections": [{"title": "1 Introduction", "content": "The advancement of various machine learning algorithms has markedly increased the presence of AI traders in financial markets, drawing significant attention to\nThis paper does not reflect the view of the organizations the authors belong to. All\nerrors in this paper are the responsibility of the authors."}, {"title": "2 Related Work", "content": "Research on the impact of traders on financial markets has increased significantly with the rapid expansion of new technologies such as algorithmic trading and AI. Various approaches have been employed to evaluate the influence of traders on the market. We review key prior studies on the impact of traders, their analysis using multi-agent models, and the perspective of microfoundations, highlighting the positioning of this study.\nThis study aims to bridge the gap in understanding the impacts of AI traders on market price formation and volatility by leveraging a multi-agent modeling approach grounded in microfoundations. Previous research has extensively explored high-frequency trading and various trader types, but the specific quantitative impacts of AI traders remain underexplored. Our work addresses this gap by developing a novel multi-agent market model that includes noise traders, fundamental traders, and AI traders, capturing their decision-making processes and interactions to analyze their collective influence on financial markets.\nWe develop the concept of microfoundations to the GARCH(1,1) model, demonstrating how its parameters can arise from the micro-level behaviors of different traders. This bridges a crucial gap in empirical finance, where the microfoundations of the GARCH model have been underexplored. By providing new insights into how AI traders affect market volatility and price formation, our research offers valuable information for market stability and regulatory frameworks. This study advances the theoretical understanding of AI traders' impact and addresses the existing gap in empirical finance, offering practical implications for market participants and policymakers."}, {"title": "2.1 Impact of Traders on the Market", "content": "The initial research on the impact of traders primarily focused on high-frequency trading (HFT). Hendershott et al. [12] demonstrated that HFT improves market liquidity and reduces trading costs. However, it has also been suggested that HFT could increase market volatility [3]. These studies imply that the impact of traders on the market is not straightforward.\nOther research has explored the broader impact of various types of traders. For instance, Kirilenko et al. [15] analyzed the role of different trader types in the flash crash of 2010, showing how their interactions contributed to extreme market events. These studies highlight the complex dynamics and potential systemic risks posed by different trading strategies."}, {"title": "2.2 Multi-Agent Models for Market Analysis", "content": "To analyze the impact of traders, multi-agent models have been widely used. Lebaron et al. [16] studied the effect of interactions among agents with different trading strategies on market dynamics using an artificial market. This research demonstrated the utility of agent-based models in capturing the emergent properties of financial markets. Chen et al. [4] employed an agent-based model to evaluate the influence of algorithmic traders on market price formation and volatility. Their work showed how the inclusion of algorithmic traders can lead to different market behaviors and identified key factors that influence these outcomes. These studies provide a foundational understanding of how agent-based modeling can be applied to financial markets to assess the impact of traders."}, {"title": "2.3 Microfoundations Perspective", "content": "Farmer et al. [10] provided a microfoundational approach to price formation by modeling the behavior of heterogeneous agents and their impact on market prices. Similarly, Lux et al. [19] developed a model that captured the scaling laws observed in financial markets by incorporating the interactions of traders with different strategies. They argued that heterogeneous agents and their interactions are necessary to replicate stylized facts through a multi-agent simulation study. Because they utilized simulation rather than mathematical analysis, their methods are a bit different from those of the microfoundation, but their motivation is very similar. These studies illustrate the potential of microfoundations to explain observed market phenomena through the lens of individual agent behavior."}, {"title": "3 Multi-agent Market Model", "content": "In this section, we define the decision-making model for each trader and the price determination process used in our multi-agent market model."}, {"title": "3.1 Return Model", "content": "The return model rt we use in this study is GARCH(1,1) [2], which is widely used in financial markets analysis and defined as:\n$r_t = f(x_{t-1}, I_{t-1}) + U_t$ (1)\n$U_t = \\sigma_t \\epsilon_t, \\epsilon_t ~ N(0,1)$ (2)\n$\\sigma_t^2 = \\omega + \\alpha u_{t-1}^2 + \\beta \\sigma_{t-1}^2$ (3)\nwhere rt is the return at time t, xt-1 and It-1 are the fundamental variable and the set of information (e.g., historical return, sentiment indicators) available for prediction up to time t - 1.\nf is an appropriate function for explaining future returns based on fundamental values and exogenous information."}, {"title": "3.2 Trader Model", "content": "We assume the existence of three types of traders in our market model:\n1. Noise traders who provide liquidity,\n2. Fundamental traders who make decisions based on fundamental variables,\n3. AI traders who make decisions based on the model predictions learned from past market time series.\nNoise Traders Noise traders are based on the existence of traders who generate orders probabilistically due to exogenous reasons [24]. These exogenous reasons include investment adjustments over individual traders' life cycles, portfolio re-balancing for hedging purposes, and passive investment strategies that follow indices, such as indices weighted by market capitalization.\nWe assume that noise traders place orders uniformly, irrespective of the fundamental prices. Consequently, noise traders play the role of providing liquidity.\nFundamental Traders Next, we assume the existence of risk-averse fundamental traders who make decisions based on the fundamental variable xt-1 at the previous time step t \u2013 1. Specifically, we assume the utility function U(\u00b7) of the returns for the fundamental traders rft at the time step t. These traders are risk-averse investors, meaning that their utility function satisfies U' > 0 and U\" < 0.\nHere, we employ the utility function U depending on the mean and standard deviation (not variance) of their returns rFt. Furthermore, we assume that:\n$E_{t-1}[r_{F,t}] = g(x_{t-1})$ (6)\n$V_{t-1}[r_{F,t}] = \\sigma_{t-1}^2$ (7)\nwhere gis a monotonic function and $\\sigma_{t-1}^2$ is defined previous section. That means, when fundamental traders obtain information at time t-1, they generally"}, {"title": "3.3 Pricing Model", "content": "Our model employs a simple price model based on the order imbalance, which is proposed in a previous work [22].\nIn the price model, the price return rt based on the order imbalance is calculated as:\n$r_t = \\rho \\frac{A^+ - A^-}{A^+ + A^-}$ (15)\nwhere $A^+$ is the total buy orders, $A^-$ is the total sell orders, and \u03c1 is the constant coefficient of the order imbalance.\nMoreover, $A^+, A^-$ are defined as:\n$A^+ = \\frac{S}{2}(1 + \\rho_1E_{t-1}[U(r_{F,t})] + \\rho_2E_{t-1}[M(r_{A,t})]) + \\frac{1}{2}kS(1+\\rho_1E_{t-1}[U(r_{F,t})] + \\rho_2E_{t-1}[M(r_{A,t})])\\epsilon_t$ (16)\n$A^- = \\frac{S}{2}(1 - \\rho_1E_{t-1}[U(r_{F,t})] - \\rho_2E_{t-1}[M(r_{A,t})]) + \\frac{1}{2}kS(1+\\rho_1E_{t-1}[U(r_{F,t})] + \\rho_2E_{t-1}[M(r_{A,t})])\\epsilon_t$ (17)\nwhere S, k are constant variables representing the liquidity, $\u03c1_1$ and $\u03c1_2$ are the ratios of fundamental and AI traders over noise traders, respectively. $\u03c1_1 + \u03c1_2$ indicates the ratio of investors who take liquidity from the market to those who provide liquidity (noise traders). Additionally, $E_{t-1} [U(r_{F,t})]$ and $E_{t-1}[M(r_{A,t})]$ are the utility functions of fundamental and AI traders defined by equations (8)"}, {"title": "4 Theoretical Analysis: The Microfoundations of GARCH", "content": "In this section, we derive the microfoundations of GARCH based on the multi-agent market model explained in the previous section. The final goal of this section is to derive the GARCH parameters (f, w, \u03b1, \u03b2) in equation (3) using the parameters defined in the previous section.\nFirst, $E_{t-1}[h(\u00b7)] = f(\u00b7)$ is reasonably assumed because the effort to find well-predictable model h is the same as the finding the ground truth function f. Thus, equation (13) can be re-formulated as:\n$E_{t-1}[M(r_{A,t})] = h(x_{t-1}, I_{t-1}) \u2013 E_{t-1} |r_{t-1} - E_{t-1}[h(x_{t-2}, I_{t-2})]|$ (18)\n$= h(x_{t-1}, I_{t-1}) - \\gamma |r_{t-1} - f (x_{t-2}, I_{t-2})|$ (19)\n$= h(x_{t-1}, I_{t-1}) - \\gamma |U_{t-1}|$ (20)\nSince the total volume of buy and sell orders is given by the equations (16) and (17), substituting them into the equation (15) in the pricing model as:\n$r_t = \\rho(\\rho_1E_{t-1}[U(r_{F,t})] + \\rho_2E_{t-1}[M(r_{A,t})])$ (21)\n$+ \\rho k \\{1 + \\rho_1E_{t-1}[U(r_{F,t})] + \\rho_2E_{t-1}[M(r_{A,t})]\\} \\epsilon_t$\n$= \\rho(\\rho_1(g(x_{t-1}) \u2013 \\lambda \\sigma_{t-1}) + \\rho_2(h(x_{t-1}, I_{t-1}) - \\gamma |U_{t-1}|))$ (22)\n$+ \\rho k\\{1+\\rho_1(g(x_{t-1}) \u2013 \\lambda \\sigma_{t-1}) + \\rho_2(h(x_{t-1}) - \\gamma |U_{t-1}|)\\}\\epsilon_t$.\nTherefore, $E_{t-1}[r_t]$ and $V_{t-1}[r_t]$ can be derived as:\n$E_{t-1}[r_t] = \\rho(\\rho_1(g(x_{t-1}) \u2013 \\lambda \\sigma_{t-1}) + \\rho_2(h(x_{t-1}) - \\gamma |U_{t-1}|)),$ (23)\n$V_{t-1}[r_t] = \\rho^2k^2(1 + \\rho_1g(x_{t-1})^2 + \\rho_2h(x_{t-1})^2) + \\rho^2k^2\\rho_2\\gamma^2u_{t-1}^2 + \\rho^2k^2\\rho_1\\lambda^2\\sigma_{t-1}.$ (24)\nCompared with equations (4) and (5) in the GARCH(1,1) model, we can prove the following theorem."}, {"title": "Theorem 1 (Microfoundation of GARCH Model)", "content": "The parameters of the equation (3) are given by the microfoundation as:\n$\\omega = \\rho^2k^2\\{1 + \\rho_1g(x_{t-1})^2 + \\rho_2h(x_{t-1}, I_{t-1})^2\\},$ (25)\n$f = \\rho\\{\\rho_1(g(x_{t-1}) \u2013 \\lambda \\sigma_{t-1}) + \\rho_2(h(x_{t-1}, I_{t-1}) \u2013 \\gamma |U_{t-1}|)\\},$ (26)\n$\\alpha = \\rho^2k^2\\rho_2\\gamma^2, \\beta = \\rho^2k^2\\rho_1\\lambda^2$ (27)"}, {"title": "Proposition 1 (Microfoundation of the GARCH model in a market with only noise traders)", "content": "When only the noise traders exist in markets (p1 = 0, p2 = 0), there are\nConstant volatility($\\omega \\neq 0$): The volatility w depends on the variance of the order imbalance ($\\rho$) and liquidity (k).\nExclusion of information(f = 0): The parameter f being zero indicates that information has no impact on market prices when only noise traders are present. This contrasts with markets where fundamental and AI traders are active, suggesting that the presence of noise traders alone does not incorporate information into asset pricing."}, {"title": "Proposition 2 (Microfoundation of the GARCH model in a market with the noise and fundamental traders)", "content": "When the noise and fundamental traders exist in markets (P1 > 0, p2 = 0), the following are satisfied:\n$E_{t-1}[U(r_{F,t})] = E_{t-1}[r_{F,t}] - AV_{t-1}[r_{F,t}] = g(x_{t\u22121}) \u2013 \u03bb\u03c3\u03c4\u22121$ (8)\nConstant volatility (w \u2260 0): The parameter w is influenced by the order imbalance (p) and liquidity (k), as well as the trading activities of fundamental traders.\nIncorporation of Fundamental Information(f \u2260 0): The presence of fundamental traders ensures that fundamental variables are reflected in market prices. This is crucial for market efficiency.\nNo Response to Past Shocks(a = 0): The absence of AI traders means that the market does not exhibit sensitivity to past price shocks.\nVolatility Clustering(\u03b2 \u2260 0): The parameter \u03b2 being non-zero indicates that volatility clustering occurs in markets with noise and fundamental traders. The presence of fundamental traders, who react to fundamental variables, contributes to this persistent volatility pattern."}, {"title": "Proposition 3 (Microfoundation of the GARCH model in a market with the noise and AI traders)", "content": "When the noise and AI traders exist in markets (P1 0,P2 > 0), the following are satisfied:\nConstant volatility (w \u2260 0): The parameter w is influenced by the order imbalance (p) and liquidity (k), as well as the presence of AI traders.\nIncorporation of Information (f \u2260 0): The parameter f being non-zero indicates that the information processed by AI traders is incorporated into market prices. This suggests that the trading strategies of AI traders ensure that their predictive information is reflected in asset pricing.\nResponse to Past Shocks (a \u2260 0): The parameter a being non-zero signifies that the market exhibits sensitivity to past price shocks due to the presence of AI traders. This shows the role of AI traders in amplifying market responses to historical price movements.\nNo Volatility Clustering (\u03b2 = 0): The parameter \u00df being zero indicates the absence of volatility clustering in a market with only noise and AI traders because their actions do not create persistent volatility patterns."}, {"title": "5 Simulation Experiment", "content": "5.1 Experimental Settings\nIn the previous section, we discuss the mathematical structure without a specific definition for gandh for fundamental and AI traders. In this section, we temporarily define those functions and other parameters and check how the numerical simulation works well by checking stylized facts, which are well-known phenomena in financial markets.\nFor the parameters, we employed p = 4, k = 0.4, p\u2081 = 0.2, p2 = 0.4, \u03bb = 1.2, \u03b3 = 1.2. Those parameters are empirically decided, and p\u2081 and p2 are set to satisfy the situation that enough liquidity traders exist in the simulation. The fundamental variable xt was generated by a random variable following a standard normal distribution. The log utility function is employed for g:\n$g(x_{t-1}) = log(1 + max(-0.99, x_{t-1})).$ (36)\nFor h, the auto-regressive (AR) process is assumed:\n$h(x_{t-1}, I_{t-1}) = 0.1x_{t-1}.$ (37)\nWe simulate the return series \u00eet based on equation (15). We evaluate the validity of the multi-agent market model based on whether it can reproduce stylized facts [4].\nWe evaluate several stylized facts using \u00eet: negative skewness, higher kurtosis than the normal distribution (leptokurtic), non-normality (Kolmogorov-Smirnov; KS test), and positive autocorrelation of the square of returns (volatility clustering). The generated time series length is denoted by T = 1000.\nThe skewness is defined as:\nSkewness = $\\frac{\\frac{1}{T} \\sum_{t=1}^{T} (r_t - \\bar{r})^3}{(\\sqrt{\\frac{1}{T} \\sum_{t=1}^{T} (r_t - \\bar{r})^2})^{3/2}}$ (38)"}, {"title": "5.2 Simulation Results", "content": "where is the mean of the return series. A negative skewness value indicates a distribution with a long tail on the left side (the loss side), suggesting that small losses occur frequently along with occasional large losses.\nThe kurtosis is defined as:\nKurtosis = $\\frac{\\frac{1}{T} \\sum_{t=1}^{T} (r_t - \\bar{r})^4}{(\\frac{1}{T} \\sum_{t=1}^{T} (r_t - \\bar{r})^2)^2}$ (39)\nA high kurtosis value means that the distribution of returns is sharper than a normal distribution, indicating that values near the center (mean) are concentrated, and extreme values (very high returns or very large losses) occur more frequently than expected.\nThe KS test evaluates whether the return series follows a normal distribution. The KS test statistic is defined as:\nKS statistics = sup | $F_r(x)$ - $F_{normal}(x)$| (40)\nwhere Fr(x) is the empirical cumulative distribution function (CDF) of \u00eet and Fnormal(x) is the CDF of the normal distribution with the same mean and variance as \u00eet. The KS test would reject the null hypothesis if the returns exhibit non-normal characteristics.\nThe T-order autocorrelation of the square of returns is defined as:\nAutocorrelation($\\tau$) = $\\frac{\\sum_{t=\\tau+1}^{T} (\\hat{r}^2_{t} - \\bar{\\hat{r}^2})(\\hat{r}^2_{t-\\tau} - \\bar{\\hat{r}^2})}{\\sum_{t=1}^{T} (\\hat{r}^2_{t} - \\bar{\\hat{r}^2})^2}$ (41)\nfor lag tau. This measure indicates the presence of volatility clustering, where large price changes are likely to be followed by other large price changes. The 1st-order autocorrelation is defined by T = 1.\nThese stylized facts are derived from previous works, such as [7], and provide a comprehensive evaluation of the multi-agent market model's ability to reproduce real market behaviors."}, {"title": "6 Discussion", "content": "Firstly, the new multi-agent market model proposed in this study is consistent with some previous studies. Our model covers a wide range of models, including some previous works, because the functions of each trader are not defined specifically, especially in AI traders. For example, Chiarella et al. [5] proposed a model based on fundamental trends and noise traders. Because AI traders' definition can cover the trend predicting traders, it also can be covered by our theory. Therefore, our microfoundations could be applicable to a wide range of models.\nSecond, this study newly achieves the microfoundation of the GARCH model, and our proposed model has been proven valid through theoretical analysis and"}, {"title": "7 Conclusion", "content": "In this study, we proposed a novel multi-agent market model incorporating fundamental traders, noise traders, and AI traders. Our model, rooted in market micro-structure, reveals new microfoundations of the GARCH(1,1) model. Through both mathematical analysis and extensive simulation studies, we demonstrated that our multi-agent model can derive the GARCH formula and replicate key stylized facts observed in financial markets, such as volatility clustering and fat tails.\nOur findings highlight the ability of the new microfoundations to describe market structures and the dynamics resulting from different proportions of trader types, including AI traders and their decision-making. Our model offers insights into how various trader interactions contribute to market behavior and volatility.\nFuture research directions include extending this framework to multivariate GARCH models[1] to capture more complex market dynamics. Moreover, this study employs a very simple and basic pricing model based on order imbalance as equation 15. Therefore, we should also consider the other pricing models such as the double auction market mechanism as the same as the actual markets. Finally, estimating the actual proportions of different types of traders in real-world markets remains a critical area for further investigation. These efforts will enhance our understanding of the impact of AI traders and other market participants, ultimately contributing to more stable and efficient financial markets."}, {"title": "A Proof of lemma 1", "content": "Proof. Refer to [25]. Since \u03c6(e) does not depend on \u03bc and \u03c3, the expected utility can be expressed as a function of \u03bcand \u03c3:\n$E[U] = E_{\\mu,\\sigma} [U] = \\int_{-\\infty}^{\\infty} U(\\mu + \\sigma \\epsilon)\\phi(\\epsilon)d\\epsilon$ (42)\nBy differentiating this with respect to and showing that the derivative is non-positive:\n$\\frac{\\Theta E_{\\mu,\\sigma} [U]}{\\theta \\sigma} = \\int_{-\\infty}^{\\infty} U'(\\mu + \\sigma \\epsilon)\\epsilon \\phi(\\epsilon)d\\epsilon \\leq 0$ (43)\nTo prove this, let U'(\u03bc) = c. Since U is risk-averse, U' is a decreasing function. Therefore, in the region where \u0454 < 0, c < U'(\u03bc + \u03c3\u03b5), and in the region where \u20ac \u2265 0, c > U'(\u03bc+\u03c3\u03b5). Thus, the integral in (43) is not greater than \u222b ce\u0444(e)de = 0, proving the lemma."}]}