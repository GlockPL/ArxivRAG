{"title": "Comprehensive Metapath-based Heterogeneous Graph Transformer for Gene-Disease Association Prediction", "authors": ["Wentao Cui", "Shoubo Li", "Chen Fang", "Qingqing Long", "Chengrui Wang", "Xuezhi Wang", "Yuanchun Zhou"], "abstract": "Discovering gene-disease associations is crucial for understanding disease mechanisms, yet identifying these associations remains challenging due to the time and cost of biological experiments. Computational methods are increasingly vital for efficient and scalable gene-disease association prediction. Graph-based learning models, which leverage node features and network relationships, are commonly employed for biomolecular predictions. However, existing methods often struggle to effectively integrate node features, heterogeneous structures, and semantic information. To address these challenges, we propose Comprehensive MEtapath-based heterogeneous graph Transformer(COMET) for predicting gene-disease associations. COMET integrates diverse datasets to construct comprehensive heterogeneous networks, initializing node features with BioGPT. We define seven Metapaths and utilize a transformer framework to aggregate Metapath instances, capturing global contexts and long-distance dependencies. Through intra- and inter-metapath aggregation using attention mechanisms, COMET fuses latent vectors from multiple Metapaths to enhance GDA prediction accuracy. Our method demonstrates superior robustness compared to state-of-the-art approaches. Ablation studies and visualizations validate COMET's effectiveness, providing valuable insights for advancing human health research.", "sections": [{"title": "I. INTRODUCTION", "content": "Identifying gene-disease associations (GDAs) is crucial in biomedicine for understanding disease mechanisms [2]. Traditional methods like genetic linkage analysis [14] and genome-wide association studies (GWAS) [12] are valuable but can be costly and time-consuming. To expedite the discovery of disease-related genes, new computational models are needed to predict pathogenic genes from existing data [3]. Current approaches for predicting GDAs fall into three main categories: machine learning-based methods, deep learning-based methods, and graph representation learning-based methods.\nMachine learning-based methods use algorithms like support vector machines (SVM) and random forests to predict GDAs. Xu et al. [24] employed SVM to rank prostate cancer genes, while Chen et al. [4] introduced RFMDA, a random forest-based model. However, these approaches often require manual feature extraction, which can be time-consuming and potentially biased. In contrast, deep learning-based methods automatically extract high-level features from raw data, enhancing GDA prediction accuracy and robustness. For instance, RENET [22] uses text mining to analyze sentence correlations for GDAs, and PheSeq [26] applies Bayesian deep learning to integrate phenotype data. Despite their potential, these methods require substantial training data and often lack interpretability due to their black-box nature.\nWith the rapid growth of modern biotechnology, extensive biological network data has driven the development of network biology and network medicine [13]. Researchers are integrating diverse datasets to build heterogeneous biological networks for predicting GDA using graph representation learning based-methods. It is formulated as a link prediction task, where relationships between diseases and genes can be learned from different dimensions of heterogeneous networks. Graph representation learning methods can be categorized into three types based on how they obtain node representations. The first type is random walk-based algorithms on graphs. Valdeolivas et al. [19] constructed gene-protein and disease-disease networks, using a restart random walk method to predict disease-related candidate genes. However, the node sequences generated by random walks start locally and do not directly leverage the constructed graph's global structural information. As a result, they may fail to capture global consistency patterns and features comprehensively, thereby limiting their ability to fully express complex relationships between nodes. In contrast, the second type involves GNN-based methods that leverage global consistency to model complex relationships within the graph. Rao et al. [16] incorporated pathway and phenotype data into disease gene networks using graph convolution methods to identify potential disease genes. Xiang et al. [23] utilized phenotype and gene ontology (GO) information to build a heterogeneous network, applying fast network embedding to predict disease-related genes. However, these methods do not effectively leverage prior biological knowledge about known GDA. The third type involves metapath-based methods, which construct metap-aths based on prior knowledge to obtain node representations. Renet utilized five meta paths in the heterogeneous disease-gene network, employing singular value decomposition to create low-dimensional feature matrices for diseases and genes, facilitating disease-gene association prediction [22]. Despite recent advances in gene-disease association prediction, several limitations persist:\n\u2022 Limited exploration in GDA mining. Current methods [10], [25] do not fully capture complex relationships in bioinformatics networks, potentially overlooking important gene-disease associations critical for understanding diseases and developing treatments.\n\u2022 Ignoring long-distance structural correlations. Most approaches use mean pooling, which smooths out differences among distant yet functionally similar genes. This can hide important interactions, reducing the accuracy and reliability of predictions.\n\u2022 Neglect of characteristic node information. Many methods initialize gene and disease nodes with random or generic values, missing key characteristics that shape biological context and impact disease association predictions.\nTo tackle the aforementioned limitations, we proposed a Comprehensive MEtapath-based heterogeneous graph Transformer (COMET) for GDAs. Firstly, we construct heterogeneous networks for diseases and genes using diverse types of data including diseases, genes, ontologies, and phenotypes. We initialize node vectors in the graph using BioGPT [11], a domain-specific language representation model pre-trained on large-scale biomedical corpora. Next, we define seven Metapaths and employ transformer [19] to aggregate Metapath instances, capturing global contexts to model long-distance dependencies. Finally, we conduct intra-metapath aggregation and inter-metapath using the attention mechanism to fuse latent vectors obtained from multiple metapaths into final node embeddings for gene-disease association prediction.\nOverall, our contributions to this work can be summarized as follows:\n\u2022 We propose COMET, a framework designed to capture comprehensive structural and semantic information across diseases, genes, ontologies, and phenotypes for GDA prediction.\n\u2022 To the best of our knowledge, we are the first to explore the pre-trained language models for predicting GDA.\n\u2022 COMET introduces a transformer to message passing between the nodes of different types, and adopts a two-level attention mechanism to uncover crucial biological relationships, which outperforms various state-of-the-art gene-disease prediction methods."}, {"title": "II. MATERIALS AND METHODS", "content": "In this section, we will introduce the proposed COMET. The overall model consists of three parts: heterogeneous network construction, gene and disease representation learning and GDA prediction. More information can be found in Figure. 1.\nA. Preliminary\nIn this section, we give formal definitions of some important terminologies related to heterogeneous graphs.\nDefinition 1 (Heterogeneous Graph). A heterogeneous graph G = (V, E) is defined as a graph associated with a node type mapping function $\\phi: V \\rightarrow A$ and an edge type mapping function $\\varphi: E \\rightarrow B$. A and B denote the predefined sets of node types and edge types, respectively, with |A| + |B| > 2.\nDefinition 2 (Metapath). A metapath R is defined as a path in the form of\n$C_1 \\stackrel{A_1}{\\longrightarrow} C_2 \\stackrel{A_2}{\\longrightarrow} C_3... \\stackrel{A_l}{\\longrightarrow} C_{l+1}$\n(abbreviated as $C_1C_2......C_{l+1}$), which describes a composite relation $C=C_1 \\circ C_2 \\circ \\cdots \\circ C_l$ between node types $A_1$ and $A_{l+1}$, where $circ$ denotes the composition operator on relations.\nDefinition 3 (Metapath Instance). Given a metapath P of a heterogeneous graph, a metapath instance $R(i,j)$ of Ris defined as a node sequence in the graph G following the schema defined by R with start node i and end node j.\nDefinition 4 (Metapath-based Neighbors). Given a metapath R of a heterogeneous graph, the metapath-based neighbors $N_R$ of a node v is defined as the set of nodes that connect with node v via metapath instances of R. A neighbor connected by two different metapath instances is regarded as two different nodes in $N_R$. Note that $N_R$ includes v itself if R is symmetric.\nB. Heterogeneous network construction\nThe pathogenesis of diseases is influenced by factors like environment and genetics [9]. To understand the complex relationships between genes and diseases, we integrate diverse data sources-phenotype, protein, and RNA-into a heterogeneous network model using five resources: HumanNet [5], Human Phenotype Ontology (HPO) [17], Gene Ontology (GO) [1], Disease Ontology (DO) [18], and DisGeNet [15].\nGene Heterogeneous Network. We construct a gene het-erogeneous network by combining gene-gene, gene-GO, and gene-HPO associations. Gene-gene interactions, derived from HumanNet, are represented by a similarity score $S(g_i, g_j)$:\n$S_{gene-gene}[i][j]=\\begin{cases}\n1, & \\text{if } e_{i,j} \\text{ exists in HumanNet} \\\\\n0, & \\text{otherwise}\n\\end{cases}$\nThe gene-GO and gene\u2013HPO networks are similarly con-structed using data from GO and HPO, respectively, result-ing in a network with five interaction types: gene-gene, gene-HPO, gene-GO, HPO-gene, and GO-gene.\nDisease Heterogeneous Network. We use gene-disease associations from DisGeNet and disease-disease associations from Disease Ontology to form a disease network with three types of interactions: disease-disease, disease-gene, and gene-disease.\nNode Feature Initialization. Node features for genes and diseases are initialized with BioGPT [11], which provides contextual representations based on gene and disease names. This initialization improves the model's ability to capture complex relationships and enhance predictions of gene-disease associations.\nC. Gene and disease representation learning\nMetapath instance transformer. We construct seven types of metapath instances: gene-gene (g-g), gene-HPO-gene(g-h-g), gene-Go-gene (g-o-g), gene-disease (g-d), disease-disease(d-d), gene-disease-gene (g-d-g) and disease-gene-disease (d-g-d). In bioinformatics, heterogeneous networks pose a challenge as different node types have distinct feature spaces. To address this, we transform features of various node types into a unified latent vector space, obtaining the initial embedding h\u2081 for each node i. Capturing a node's hidden features involves modeling its context through metapath instances. A metapath instance-level transformer maps these sequences into continuous representations and averages them to obtain the metapath instance embedding. Specifically, the transformer converts each metapath instance sequence Rk (i, j) into the metapath instance embedding $Z_{R_k(i,j)}$ as follows:\n$Z_{R_k(i,j)} = Transformer (|| (h_t | \\forall t \\in R_k (i,j))), (1)$\nThe metapath transformer encoder features multi-head atten-tion and a feed-forward network. It processes queries, keys, and values in parallel, incorporating residual connections, normalization, and ReLU activation. Node positions within metapaths offer key information for predicting gene-disease associations, particularly distant nodes with pharmacological relevance. By combining multi-head self-attention with positional embeddings, it captures long-range dependencies and improves gene-disease prediction performance significantly.\nIntra-metapath aggregation The target node i possesses multiple instances of certain types of metapaths. The idea of semantic aggregation for single-pathway semantics is to aggregate the semantic information of multiple instances of the same metapath type into the corresponding target node. Inspired by the work of Wang et al. [20], we adopt a self-attention mechanism to aggregate the metapath instance information of the target node. In a heterogeneous network, the target node i has multiple instances of certain types of metapaths, but the importance of different metapath instances varies. Therefore, we introduce the weight $\\alpha_{ij}^{R_k}$ for the target node i, which measures the importance of the target node i. The weight $w_{ij}^{R_k}$ of metapath instance $R_k(i, j)$ and the weight $w_{ii}^{R_k}$ of the target node i can be described as follows:\n$\\alpha_{ij}^{R_k} = Attention(h'_i; Z_{R_k(i,j)}; R_k), (2)$\n$\\alpha_{ii}^{R_k} = Attention(h'_i; R_k), (3)$"}, {"title": null, "content": "in this paper, we use the softmax function to normalize the here, R represents the set of all metapaths.\nweight coefficients. For $i \\in N_R$, the normalized weight\ncoefficients $\\alpha_{ij}^{R_k}$ and $\\alpha_{ii}^{R_k}$ can be uniformly calculated:\n$\\alpha_{im}^{R_k} = \\frac{exp(w_{ij}^{R_k})}{\\sum_{j\\in N_{R_i}} exp(w_{ij}^{R_k}))}, (4)$\nthis process ensures that the weights of different metapath\ninstances and the target node are properly weighted for sub-\nsequent aggregation.\nTo address the high variance issue in network data, we ex-tends single-semantic attention to multi-head single-semantic\nattention to achieve stable model training. Given a metapath\ntype $R_k$ and a target node i, the embedding $Z_i^{R_k}$ of the target\nnode under specific metapath $R_k$ semantics can be learned\nby repeating H attention calculations and concatenating the\nembedding results, as shown in:\n$Z_i^{R_k} = ||_{h=1}^{H} \\sigma(\\sum_{j \\in N_{R_k}-i} A_{ij}^{R_k}[h'_i]^{\\top}[Z_{R_k(i,j)}^{R_k}] [h'_i]^{\\top} A_{ii}^{R_k}), (5)$\nhere, $\\sigma(\\cdot)$ denotes the activation function, $A_{ij}^{R_k}[h]$ represents\nthe normalized importance of node j for metapath instance\n$R_k(i,j)$ at attention head H, and $A_{ii}^{R_k}[h]$ represents the\nnormalized importance of central node i at attention head H.\nInter-metapath aggregation. Different metapath types\nhave distinct bioinformatics meanings. To learn the semantic\nrepresentation of a target node across multiple metapath types,\nsemantic aggregation of multiple metapath types is required.\nSimilar to intra-metapath aggregation, different metapath types\nalso have varying importance for the central node. For exam-\nple, different metapath types, such as d-d and d-g-d, exhibit\nsignificant differences in the importance of embedding for\ndisease nodes. The differences in metapath types need to be\ndistinguished and reflected in the multi-metapath semantic\naggregation of the target node. Therefore, after aggregating\nnode and edge information for each metapath type, this paper\nemploys a multi-metapath semantic attention layer to combine\nsemantic information from all metapath types. This paper\nintroduces the weight $\\beta^{R_k}$ for each metapath type $R_k$ to\ndescribe the differences in importance for the target node i:\n$\\beta^{R_k} = Attention(Z_i^{R_k}), (6)$\nthen, the normalized weight coefficients $\\beta^{R_k}$ are obtained\nthrough the softmax function.\n$\\beta^{R_k} = \\frac{exp(W^{R_k})}{\\sum_{R_{t}\\in R} exp(W^{R_t})}, (7)$\ngiven the target node i, its final representation vector $Z_i$ can\nbe obtained using the aggregated representation vectors $Z_i^{R_k}$\nand normalized weight coefficients $\\beta^{R_k}$:\n$Z_i = \\sum_{R_k \\in R} \\beta^{R_k} Z_i^{R_k}, (8)$"}, {"title": "D. GDA prediction", "content": "After obtaining the low-dimensional multi-semantic rep-resentations of genes and diseases, we project the node embeddings into a space with node similarity measures for the downstream gene-disease prediction task. Given the gene embedding $z_g$ and the disease embedding $z_d$, we optimize the model weights by minimizing the following loss function through negative sampling:\n$L= - \\sum_{(d,g) \\in D} log\\sigma (z_d^{\\top} z_g)- \\sum_{(d',g') \\in D^-} log\\sigma (-z_{d'}^{\\top} z_{g'}), (9)$\nwhere $\\sigma(\\cdot)$ is the sigmoid function, $\\sigma(z_d^{\\top} z_g)$ is the probability that gene g interacts with disease d, D is the set of observed node pairs, and $D^-$ (the complement of D) is the set of non-existing gene-disease pairs sampled from all unobserved gene-disease pairs."}, {"title": "III. EXPERIMENT", "content": "A. Datasets\nIn this section, we detail our dataset, constructed from five public sources: HumanNet, GO, HPO, DO, and Dis-GeNet, as outlined in Table I. HumanNet provides a human gene network, including 18,462 genes and their functional associations through protein-protein interactions, mRNA co-expression, and genomic context. GO (Gene Ontology) describes gene functions with unique identifiers, linking genes to multiple terms, aiding in reconstructing the gene heteroge-neous network. HPO (Human Phenotype Ontology) outlines relationships between phenotypic abnormalities in diseases, offering insights into gene functions and genetic networks. Disease Ontology (DO) provides a standardized classification and clear definitions for diseases, which we use to calculate disease similarities. DisGeNet compiles information on genes and mutations associated with diseases from various sources, supporting research on disease genes and validation of predic-tions."}, {"title": "B. Baselines", "content": "To evaluate the efficacy of our approach, we benchmark it against two random walk-based approaches including HerGePred [25], dgn2vec [10], two GCN-based methods including GCN [6], HOGCN [7], and two metapath-based methods including HNEEM [21], DGP-PGTN [8]. The detailed introduction to each method can be found as follows.\n\u2022 HerGePred uses random walks for low-dimensional representations of diseases and genes in heterogeneous networks, facilitating association predictions.\n\u2022 dgn2vec employs a random walk algorithm to generate node embeddings, focusing on disease-gene association prediction.\n\u2022 GCN applies a semi-supervised Graph Convolutional Network (GCN) directly to disease and gene heterogeneous networks using the original adjacency matrix.\n\u2022 HOGCN collects neighbor nodes at varying distances to capture informative representations for disease-gene association predictions.\n\u2022 HNEEM extracts node features from multiple heterogeneous networks, concatenating disease and gene vectors for disease-gene pair representations, and uses random forests for classification.\n\u2022 DGP-PGTN integrates diverse data sources and utilizes a parallel graph transformer network to predict GDAs, focusing on capturing latent interactions.\nFor all the baselines mentioned above, we conduct experiments on the same dataset with the same parameters as their experimental settings. We compare COMET with baselines using evaluation measures including AUC, AUPR, precision, recall, and F1-measure, with AUC and AUPR as primary metrics for overall performance evaluation, while employing Youden's index to determine the optimal threshold for calculating accuracy, precision, recall, and F1-score."}, {"title": "IV. RESULTS", "content": "A. The results of gene-disease prediction\nIn our experimental evaluation, we conducted a comprehensive comparison of several state-of-the-art models, aiming to assess their effectiveness in predicting GDAs. As shown in table II, Metapath2vec and HerGePred, based on random walk methods, achieved the poorest performance because they cannot effectively capture the complex relationships present in heterogeneous networks. HNEEM and DGP-PGTN performed better due to the use of pre-defined Metapaths based on prior knowledge, which helps in obtaining better node representations. Our method, COMET, achieved the best performance. This is primarily because we extracted more Metapath information based on biological prior knowledge and used transformers to capture more comprehensive and context-aware associations. This enhanced semantic aggregation capability allows COMET to outperform other models across various evaluation metrics. Overall, these results affirm the effectiveness of our proposed approach, showcasing its ability to provide more accurate and reliable predictions for gene-disease associations compared to existing state-of-the-art methods.\nB. Ablation Study\nCOMET's strong performance stems from three key innovations: heterogeneous graph node initialization, metapath design based on prior knowledge, and a metapath-based hierarchical transformer and attention network. We performed ablation studies to assess how these components contribute to overall performance.\nEffects of different node feature. To assess the impact of different node feature initialization methods on COMET'S performance, we compared random initialization with BioGPT. As shown in Table III, initializing node features with BioBERT significantly enhances performance across all metrics com-pared to random initialization. BioGPT captures relevant semantic information from the biomedical domain, aiding more accurate GDA predictions. Therefore, using BioBERT for node feature initialization improves the model's ability to learn meaningful representations, leading to better GDA prediction performance.\nEffects of different metapath type. To assess the im-portance of different metapath types in semantic information aggregation, we conducted an ablation study on the disease-gene heterogeneous network. The COMET model was trained using metapaths g-g, g-d-g, g-o-g, d-g-d, g-d, g-h-g, and d-d. As shown in Table III, using all metapaths significantly improved performance. Removing the G-D-G and D-G-D metapaths resulted in the largest decline in AUROC and AUPR, as these paths contain essential association information between diseases and genes. The removal of G-O-G and D-S-D also caused a 1% to 2% performance drop, indicating that including GO and disease nodes enhances the model's semantic aggregation capability.\nEffects of different metapath instance encoders. In COMET, we use a transformer encoder as a metapath instance aggregator. To evaluate its impact, we conducted ablation experiments with Average pooling, Max-Pooling, Bi-LSTM, Bi-GRU, and the Transformer aggregator. As shown in Table III, the transformer aggregator achieved the best performance. Bi-LSTM and Bi-GRU also performed well, as they capture sequential features effectively. In contrast, Average and Max-Pooling led to information loss due to their simple pooling approach.\nC. Conclusion\nIn this paper, we propose COMET, a comprehensive metapath-based heterogeneous graph transformer for GDAS prediction. We leverage diverse sources of gene and disease-related information to construct a heterogeneous bioinformatics network. Node features in this network are initialized using pretrained models from the biomedical domain. To capture rich structural and semantic information, we employ a transformer encoder and a two-level attention mechanism. This approach enables us to derive low-dimensional vector representations of genes and diseases for association prediction. We validate COMET's effectiveness and robustness by comparing it against six state-of-the-art methods using a constructed meta-path dataset for gene-disease prediction. Results show significant performance improvements with COMET. Ablation studies analyze the contributions of different meta-path types and components within COMET to prediction performance. COMET offers a powerful and robust tool for advancing gene-disease association prediction in life sciences. Future work will focus on expanding COMET by integrating additional heterogeneous attribute information and validating prediction results through wet-lab experiments."}]}