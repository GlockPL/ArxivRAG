{"title": "Synesthesia of Machines (SoM)-Enhanced ISAC Precoding for Vehicular Networks with Double Dynamics", "authors": ["Zonghui Yang", "Shijian Gao", "Xiang Cheng", "Liuqing Yang"], "abstract": "Integrated sensing and communication (ISAC) technology plays a crucial role in vehicular networks. However, the communication channel within this context exhibits time-varying characteristics, and potential targets may move rapidly, resulting in double dynamics. These presents significant challenges for real-time ISAC precoding design that have not been thoroughly explored. While optimization-based precoding methods have been extensively studied, they are computationally complex and heavily rely on perfect prior information that is rarely available in situations with double dynamics. In this paper, we propose a synesthesia of machine (SoM)-enhanced precoding paradigm, where the base station leverages various modalities such as positioning and channel information to adapt to double dynamics, and effectively utilizes environmental information to stretch ISAC performance boundaries through a deep reinforcement learning framework. Additionally, a parameter-shared actor-critic architecture is tailored to expedite training in complex state and action spaces. Extensive experimental validation has demonstrated the multifaceted superiority of our method over existing approaches.", "sections": [{"title": "I. INTRODUCTION", "content": "The Internet of vehicles (IoV) plays a critical role in facilitating an efficient and reliable intelligent transportation system, where high-speed communication and high-precision sensing serve as fundamental pillars [2]. In contrast to conventional separated systems, integrated sensing and communication (ISAC) holds the promise of mutual enhancement, thus garnering significant attention in recent research endeavors within the realm of vehicular networks [3].\nTo achieve ISAC, waveform design serves as one of the core techniques. Existing dual-functional waveform designs are typically categorized into three types: communication-centric, radar-centric, and joint design. Communication-centric designs focus on enhancing sensing based on existing communication waveforms [4, 5]. However, the sensing capability is inherently limited due to the unregulated auto-correlation properties of communication symbols. In radar-centric designs, information is embedded into radar waveform parameters such as carrier frequency and antenna assignment [6, 7]. Nevertheless, these designs are constrained by radar pulse repetition rate, failing to satisfy the high-rate requirements in practical communications. To improve the sensing accuracy while guaranteeing communications, joint precoding designs by shaping the beam into desired patterns have been widely researched [8-10]. For instance [8] achieved the desired pattern by optimizing the precoding, satisfying the signal-to-noise ratio (SNR) constraint at the user. [10] achieved a higher sensing SNR while guaranteeing signal-to-interference-plus-noise ratio (SINR) at users by jointly optimizing the precoding for communication and radar signal.\nHowever, the dynamic nature of the road environment introduces both time-varying characteristics in the wireless channel and rapid movement of the targets, presenting a doubly-dynamic challenge for ISAC. To deal with the time-varying channels, [11] proposed a compressive sensing (CS)-based framework with specialized pilot, reducing the time overhead in channel state information (CSI) acquisition. [12, 13] designed pre-compensators to combat the Doppler effect, mitigating the inter-carrier interference (ICI) in wideband systems. [14] further decoupled the Doppler shifts in angle domain by precoding to effectively suppress the time-variation of communications. In terms of sensing the fast-moving targets, [15] utilized CSI to estimate the target's velocities, and [16] designed Space-Delay-Doppler precoding by leveraging ICI to enhance the sensing accuracy. Meanwhile, to address the carrier frequency offset resulting from the sensing dynamics, [17] designed a Kalman filter (KF)-based sensing scheme using the estimated Doppler as a prior to filter out time-varying noise and enhance sensing accuracy.\nNevertheless, implementing ISAC under double dynamics remains unexplored and presents unique challenges. Firstly, the complex correlation between the dynamics of communications and sensing can lead to degraded spectrum efficiency (SE) and sensing accuracy. Secondly, existing optimization-based methods are complex and result in high latency, while the need for perfect environmental information such as instantaneous CSI and real-time target positions can be difficult to acquire in double dynamics.\nIn an effort to lower the dependence on instantaneous state information and mitigate the complexity issue, [18, 19] predicted the real-time environmental prior according to the historical positions, via particle filter (PF) and message passing (MP) respectively. The operating protocol have also been modified for facilitating the predictive precoding. However, these solutions still struggle to address the doubly-dynamic challenge, as they lack robustness in managing the mutual interference between communication and sensing. Moreover, their complexity escalates drastically with a growing number of users, thereby reducing the timeliness of ISAC systems. Additionally, these solutions assume perfect alignment between communication users and sensing targets, which may not be a realistic assumption in real-world doubly-dynamic scenarios. Although obtaining perfect channel-related parameters in double dynamics is challenging, other observable environmental information correlates with channel information, as demonstrated in synesthesia of machine (SoM) [20]. For instance, [21] integrated multi-modal sensing information to boost beamforming for communications. Inspired by this concept, data from diverse modalities has the potential in enhancing the performance of real-time ISAC precoding. However, research from this perspective is still in its early stages, and specific SoM operational modes for ISAC remain undefined.\nReinforcement learning (RL) has gained attention in communication systems design thanks to its adaptability to dynamics without prior assumptions. Existing research has employed RL for precoding design [22, 23]. For instance, deep deterministic policy gradient (DDPG) was utilized for the hybrid precoding transceivers design in [22]. However, these studies primarily focus on enhancing communications and overlook sensing tasks. Regarding sensing applications, [24] employed SARSA algorithm to jointly optimize precoders and array segmentation for balancing communications and sensing. [25] focused on flexible alternation between communication and sensing modes. Despite these efforts, the level of integration remains limited. Furthermore, applying RL to the consid- ered problem encounters three main challenges: the high- dimensional and structurally complex action space, the significant difficulties in feature extraction and action selection due to diverse environmental state observations, and the challenges in updating policies due to the varying number of users.\nTo overcome the aforementioned barriers, we devise an efficient deep-RL (DRL)-aided framework to facilitate real- time wideband ISAC precoding design, in the absence of instantaneous CSI or target angle information. Inspired by SoM, this framework leverages various observations from the base station (BS), such as historical position estimates and initial CSI, as adaptable inputs to accommodate the double dynamics. We begin by formulating a partially observed Markov decision process (POMDP) for this scenario, defining the observed state space and reward function. To navigate the intricate decision space in hybrid precoding, we customize a hybrid action space for efficient precoding updates. Furthermore, we employ a parameter-shared actor-critic (PSAC) architecture to extract features from the state, reducing network parameters and speeding up training. To optimize model training, we tailor the updating procedure for both the actor and critic components. Our proposed algorithm incorporates two carefully crafted precoding update schemes: update across the user dimension and update across the antenna dimension. It is noteworthy that the proposed scheme also exemplifies SoM-Enhance in [20], wherein channel information for both communication and sensing is enriched through observations from various modalities. Numerical experiments validate the effectiveness of our approach in improving both communications and sensing performance in a doubly dynamic environment.\nOur contributions can be summarized as follows:\n\u2022 We present an alternating optimization-based algorithm for ISAC hybrid precoding with complete environmental state information, designed to adapt to ICI caused by Doppler shift in wideband multi-user systems.\n\u2022 To tackle the doubly-dynamic ISAC precoding challenge, we introduce a DRL-aided algorithm. We carefully craft the network architecture and training process to address the complex decision space issue. The dynamic update schemes proposed are compatible with existing hybrid precoding architectures.\n\u2022 Through extensive simulation experiments, we demonstrate that our approach outperforms existing benchmarks, pushing the performance boundaries for ISAC in doubly- dynamic scenarios. This is achieved with reduced computational complexity and improved timeliness.\nThe remainder of this work is structured as follows. Section II introduces the system model. The proposed optimization- based wideband ISAC precoding design is illustrated in Section III as preliminary. Section IV includes the ISAC frame structure designed for doubly-dynamic scenarios, and the detailed DRL-aided algorithms for doubly-dynamic ISAC precoding is introduced in Section V. Section VI contains our simulation findings, and Section VII concludes our work.\nNotation: a, a and A represent a scalar, a vector and a matrix respectively. $(\u00b7)^T$, $(\u00b7)^H$, $Tr(\u00b7)$, $rank(\u00b7)$, $||\u00b7||_2$ and $||\u00b7||_F$ denote transpose, conjugate transpose, trace, rank, 2-norm and Frobenius norm, respectively. $E(\u00b7)$ denotes the expectation. $P(\u00b7)$ denotes the probability. $CN(m, \u03c3^2)$ represents the complex Gaussian distribution whose mean is m and covariance is $\\sigma^2$. R and C denote the set of real numbers and complex numbers respectively. $|z|$ and $\\angle z$ denote the modulus and the phase of a complex number z respectively. $\u2229$ and $\u222a$ denote the intersection and the union, and $\u00d8$ denotes an empty set."}, {"title": "II. SYSTEM MODEL", "content": "We consider an ISAC system with wideband massive MIMO at the base station (BS) serving U downlink users, each with a single antenna, while simultaneously tracking a single moving target in the low-altitude environment. The BS is equipped with a uniform linear array (ULA) comprising $N_t$ elements for transmission and $N_r$ elements for echo reception. The ISAC signal is transmitted via orthogonal frequency division multiplexing (OFDM) with M subcarriers. The number of data streams at each subcarrier is $N_s$, satisfying $U \\leq N_s$ and $N_s \\leq N_{RF}$, (m = 1,\u2026\u2026, M). The sensing and communication functionalities are operated simultaneously enabled by an ISAC transmitter. Without loss of generality, we set $N_s = N_{RF} = U$."}, {"title": "A. Transmitting Signal", "content": "At the l-th symbol duration in the n-th subframe (l = 1,..., L, n = 1,\u2026,T), the communication symbols for the U users at the m-th subcarrier is denoted as $\\mathbf{s}_{m}^{(n,l)} = [s_{m,1}^{(n,l)},..., s_{m,U}^{(n,l)}]^T$, with $E[\\mathbf{s}_{m}\\mathbf{s}_{m}^H] = \\mathbf{I}_U$. Specifically, $\\mathbf{s} = [\\mathbf{s}_1,..., \\mathbf{s}_M]$ is processed by M frequency-dependent digital precoders $\\mathbf{F}_{BB,m} \\in \\mathbb{C}^{N_{RF}\\times U}$ (m = 1,2,\u2026\u2026, M) respectively, followed by $N_{RF}$ M-point inverse fast Fourier transforms (IFFT). The the $L_{cp}$-length cyclic prefix (CP) is then added on the time-domain signal, before the time-domain analog precoder $\\mathbf{F}_{RF} \\in \\mathbb{C}^{N_t\\times N_{RF}}$, which is shared among all the subcarriers. Thus the discrete-time transmitted signal at the m-th subcarrier from the array in the n-th subframe can be expressed as\n$\\mathbf{x}_{m}^{(n,l)} = \\frac{\\sqrt{P_t}}{M}\\mathbf{F}_{RF}\\mathbf{F}_{BB,m}^{(n)} \\mathbf{s}_m^{(n,l)} = \\frac{\\sqrt{P_t}}{M}\\mathbf{F}_m^{(n)} \\mathbf{s}_m^{(n,l)}$,\nwhere $P_t$ denotes the total transmitting power. The digital precoder $\\mathbf{F}_{BB,m}$ is set as $diag([p_{m,1},\u00b7\u00b7\u00b7, p_{m,U}])$, used for power allocation among users. Since the analog precoder $\\mathbf{F}_{RF}$ is realized by the analog phase shifters (APS), it is constant-modulus. Specifically, when the B-bit APS is adopted, we have\n$\\angle[\\mathbf{F}_{RF}]_{i,j} \\in \\mathcal{B} \\triangleq {\\frac{2\\pi q}{2^B} | q = 0,1,2,..., 2^B -1}$.\n$\\mathcal{F}$ denotes the feasible set for all the $\\mathbf{F}_{RF}$ satisfying the B-bit finite-resolution constant-modulus constraint."}, {"title": "B. Communication Model", "content": "A doubly-selective channel similar to [26] is adopted, with $N_d$ delay taps. At the d-th tap (0 \u2264 d \u2264 $N_d$ \u2212 1), the channel response for user-u during symbol-l is expressed as\n$h_{u,d}(l) = \\sum_{p=1}^{P_u} \\beta_{u,p}g_{rp}(dT_s - \\tau_{u,p})e^{jw_{u,p}lT_s}[a_t(\\theta_{u,p})]_i$,\nwhere $P_u$ denotes the number of resolvable paths, $T_s$ is the sampling period, $\\beta_{u,p} \\sim CN(0, \\sigma_{\\beta}^2)$ is the path's complex gain varying across symbols and $\u03b8_{u,p}$ is the angle of departure (AoD) of the p-th path for the u-th user, and $[a_t(\\theta)]_i = e^{-j(i-1) \\sin \\theta}$ (i = 1,\u2026\u2026, $N_t$). $g_{rp}(\u00b7)$ is the pulse shaping filter; $\\tau_{u,p} \\sim U(0, (N_a \u2212 1)T_s)$ is the propagation delay. Denote the carrier frequency as $f_c$, the velocity of light as $c_v$, and the relative velocity of each path as $v_{u,p}$, then the normalized Doppler shift is $w_{u,p} = 2\\pi \\frac{f_c|v_{u,p}|}{c_v}T_s \\sin \\theta_{u,p}$. Consequently the multi-user channel in time domain is\n$\\mathbf{H}_a(l) = [\\mathbf{h}_u^1(l), \\mathbf{h}_u^2(l), ..., \\mathbf{h}_u^U(l)] \\in \\mathbb{C}^{U\\times N}$.\nAccordingly, the inter-subcarrier channel response is computed by\n$\\mathbf{H}_m[k] = \\sum_{i=0}^{M-1} \\sum_{d=0}^{N_a-1} \\mathbf{H}_a(i+L_{cp})e^{-j2\\pi kd/N_a}e^{-j\\frac{2\\pi(m-k)i}{M}}$.\nBy stacking the received signals at all subcarriers, we get\n$\\mathbf{y} = \\begin{bmatrix}\\mathbf{H}_1[1] & ... & \\mathbf{H}_1[M]\\\\ & : & \\\\ \\mathbf{H}_M[1] & ... & \\mathbf{H}_M[M]\\end{bmatrix} \\begin{bmatrix}\\mathbf{F}_1\\\\ :\\\\ \\mathbf{F}_M\\end{bmatrix} \\begin{bmatrix}\\mathbf{s}_1\\\\ :\\\\ \\mathbf{s}_M\\end{bmatrix} + \\mathbf{n}_c$", "latex": ["h_{u,d}(l) = \\sum_{p=1}^{P_u} \\beta_{u,p}g_{rp}(dT_s - \\tau_{u,p})e^{jw_{u,p}lT_s}[a_t(\\theta_{u,p})]_i", "\\mathbf{H}_a(l) = [\\mathbf{h}_u^1(l), \\mathbf{h}_u^2(l), ..., \\mathbf{h}_u^U(l)] \\in \\mathbb{C}^{U\\times N}", "\\mathbf{H}_m[k] = \\sum_{i=0}^{M-1} \\sum_{d=0}^{N_a-1} \\mathbf{H}_a(i+L_{cp})e^{-j2\\pi kd/N_a}e^{-j\\frac{2\\pi(m-k)i}{M}}", "\\mathbf{y} = \\begin{bmatrix}\\mathbf{H}_1[1] & ... & \\mathbf{H}_1[M]\\\\ & : & \\\\ \\mathbf{H}_M[1] & ... & \\mathbf{H}_M[M]\\end{bmatrix} \\begin{bmatrix}\\mathbf{F}_1\\\\ :\\\\ \\mathbf{F}_M\\end{bmatrix} \\begin{bmatrix}\\mathbf{s}_1\\\\ :\\\\ \\mathbf{s}_M\\end{bmatrix} + \\mathbf{n}_c"]}, {"title": "C. Sensing Model", "content": "In the ISAC system, the transmitted signal can serve for target sensing. The variations in the echo carry valuable information about the targets. A dedicated echo processing module can be incorporated to extract target information at the transmitter, akin to a mono-static MIMO radar system.\nWe model the target's trajectory as a unidirectional curve with an orientation offset. $[\\theta_s^{(n)}, d_s^{(n)}]$ denotes the target's position in polar domain. The target response matrix at the m-th subcarrier $G_m^{(n)} = \\alpha_m a_r(\\theta_s^{(n)}) a_t^H(\\theta_s^{(n)})$, where $\\theta_s^{(n)}$ is the azimuth of the target relative to the BS and $\\alpha_m$ denotes the complex reflection coefficient incorporating the round-trip path loss, the radar cross-section and the Doppler of the target. Accordingly the received echo becomes\n$\\mathbf{y}^{(n,l)} = \\mathbf{G}^{(n)} \\mathbf{x}^{(n,l)} + \\mathbf{z}^{(n,l)}$,\nwith $\\mathbf{z}_{m}^{(n,l)} \\sim CN(0, \\sigma_n^2\\mathbf{I}_N)$ being the ISAC receiver noise. Note that BS also receives clutter reflected by objects unrelated to the target in the environment. We consider whitening the received noise to ensure that the noise obeys the complex Gaussian distribution.\nThe sensing accuracy is characterized by Fisher information in Eq. (10), with $\\mathbf{R}_{\\mathbf{x}_{m}}^{(n)} = [\\mathbf{F}_{BB,m}^{(n)}]^H \\mathbf{F}_{RF}^H \\mathbf{F}_{RF} \\mathbf{F}_{BB,m}^{(n)}$, being the covariance matrix of $\\mathbf{x}_m$, and $\\mathbf{A}(\\theta_s) = \\mathbf{a}(\\theta_s)\\mathbf{a}(\\theta_s)^H$ with $\\mathbf{A}(\\theta_s) = \\frac{\\partial}{\\partial \\theta_s} \\mathbf{A}(\\theta_s)$ The Fisher information for $\\theta_s$ at t is the summation of all the Fisher information across subcarriers, as analyzed in [27]. Consequently, the Cram\u00e9r-Rao lower bound (CRLB) of the target's azimuth is the expectation of the inverse of Fisher information given $\\mathbf{y}_r$.\n$CRLB(\\theta_s^{(n)}) = E[\\frac{1}{I_m(\\theta_s^{(n)})}] = E[\\frac{1}{J(\\theta_s^{(n)})}]$.\nAccordingly, the averaged CRLB over time, i.e., CRLB = $\\frac{1}{T}\\sum_{n=1}^T CRLB(\\theta_s^{(n)})$, is established as the performance metric for sensing."}, {"title": "III. OPTIMIZATION-BASED ISAC PRECODING WITH INSTANTANEOUS STATE", "content": "In this section, we propose an optimization-based algorithm for hybrid precoding to implement ISAC in wideband multi- user system, assuming that full state information for sensing and communications can be obtained at the BS."}, {"title": "A. Related Works", "content": "Extensive research has been conducted on precoding optimization for rate maximization [28] or CRLB optimization [29]. However, ISAC precoding presents a greater challenge due to its non-convex constraints. Recent studies, such as [30], have focused on digital precoding optimization for CRLB minimization while ensuring communication Quality of Service (QoS) through the use of the semi-definite relaxation (SDR) method. Furthermore, [31] delved deeper into CRLB optimization under SINR constraints from a subspace perspective, providing additional insights for digital precoding design. Addressing the non-convex constraint introduced by the hybrid structure, [32] conducted the data rate maximization under CRLB constraints by the block coordinate descent (BCD) algorithm. However, these studies do not take into account wideband time-varying channels, which is challenging to address due to the significant ICI resulting from Doppler."}, {"title": "B. Alternating-based Optimization", "content": "The goal of the hybrid precoding in this doubly-dynamic scenario is to maximize ISAC utility throughout the trajectory, considering the power budget and constant-modulus constraint of the analog precoder. The utility is defined as the weighted sum of the averaged spectrum efficiency $\\bar{R} = \\frac{1}{T}\\sum_{n=1}^T R^{(n)*}$ and the averaged Fisher information for angle estimation $\\bar{J} = \\frac{1}{T}\\sum_{n=1}^T J^{(n)*}$. Both indicators are normalized by the ideal performance boundaries $\\bar{R}^* = \\frac{1}{T}\\sum_{n=1}^T R^{(n)*}$ and $\\bar{J}^* = \\frac{1}{T}\\sum_{n=1}^T J^{(n)*}$ respectively, with $R^{(n)*}$ and $J^{(n)*}$ being the performance boundaries in the t-th subframe, obtained by individual maximization of SE without sensing constraints, and individual minimization of CRLB without communication requirements, respectively. Consequently, the problem can be formulated as\n$\\max_{\\{\\mathbf{F}_{BB,m}^{(n)}, \\mathbf{F}_{RF}\\}_{n=1}^T} \\psi \\frac{\\bar{R}}{\\bar{R}^*} + (1-\\psi) \\frac{\\bar{J}}{\\bar{J}^*}$,\ns.t. $\\sum_{m=1}^{M} |[\\mathbf{F}_{RF}^H \\mathbf{F}_{RF} \\mathbf{F}_{BB,m}^{(n)}]_i|^2 = 1$,\n$\\mathbf{F}_{BB,m}^{(n)} \\succeq \\mathbf{0}$,\n$\\mathbf{F}_{RF} \\in \\mathcal{F}$,\ngiven the perfect $\\mathbf{H}$ and perfect $G_m$ in each subframe. $\\psi$ denotes the weighting coefficient between the sensing and communication performances. (12a) and (12b) denote the power constraint and the constant-modulus constraint respectively. The problem (12) is non-convex due to the complex objective function and constant-modulus constraints. Note that the time-averaged objective can be maximized when the utility at each single subframe is maximized. We first transform the sequential optimization on a subframe-by-subframe basis as\n$\\max_{\\{\\mathbf{F}_{BB,m}^{(n)}, \\mathbf{F}_{RF}\\}} \\psi \\frac{R^{(n)}}{R^{(n)*}} + (1-\\psi) \\frac{J^{(n)}}{J^{(n)*}}$,\ns.t. $\\sum_{m=1}^{M} |[\\mathbf{F}_{RF}^H \\mathbf{F}_{RF} \\mathbf{F}_{BB,m}^{(n)}]_i|^2 = 1$,\n$\\mathbf{F}_{BB,m}^{(n)} \\succeq \\mathbf{0}$.\nTo tackle the coupled variables and non-convex constraints, we adopt an alternating-based optimization procedure. We first optimize the equivalent fully-digital precoding matrices $\\mathbf{F}_m^{(n)} = \\mathbf{F}_{RF} \\mathbf{F}_{BB,m}^{(n)}$ for ISAC utility maximization, then optimize $\\mathbf{F}_{RF}$ and $\\mathbf{F}_{BB,m}^{(n)}$ by decomposing $\\mathbf{F}_m^{(n)}$ in an alternating manner. Specifically, in each alternating iteration, the phases in $\\mathbf{F}_{RF}$ are updated with fixed $\\mathbf{F}_{BB,m}^{(n)}$, followed by updating $\\mathbf{F}_{BB,m}^{(n)}$ with $\\mathbf{F}_{RF}$ held constant."}, {"title": "Stage I: Optimizing Fm", "content": "The problem with respect to $\\mathbf{F}_m$ can be transformed as\n$\\max_{\\mathbf{F}_m} \\psi \\frac{R}{R^*} + (1-\\psi) \\frac{I}{I^*}$,\ns.t. $\\sum_{m=1}^{M} ||\\mathbf{F}_m||^2 = 1$.\nLet $\\Im_m(\\theta_s) \\geq \\zeta$ and $\\Upsilon_{mu} \\geq \\tau$, $\\forall$ m, u. Denote $W_{m,u} = f_{RF,u}^H \\mathbf{f}_{RF,u}$, $W_m = \\sum_{u=1}^U W_{m,u}$ and $Q_{m,k,u} = \\mathbf{h}_{m,k,u}^H\\mathbf{h}_{m,k,u}$. Then the problem (14) can be transformed into\n$\\max_{\\mathbf{w}} \\sum_{m=1}^U W_{m,u}$,\ns.t. $W_{m,u} \\geq 0$, rank($W_{m,u}$) = 1,\n$\\frac{\\sum_{m=1}^U \\log(1 + \\tau)}{\\frac{M\\zeta}{R^*}} \\geq \\omega \\psi + (1-\\psi)$,\n$\\frac{Tr(A^H A W_m)}{\\sqrt{Tr(A^H A)Tr(A^H A W_m W_m)} } \\geq \\sqrt{\\zeta}$,\n$Tr(Q_{m,m,u}W_{m,u}) - \\tau \\sum_{i=1,i\\neq u}^U Tr(Q_{m,m,u}W_{m,i})$,\n$\\sum_{k=1,k\\neq m}^U Q_{m,k,u}W_{k,u} \\leq \\tau \\zeta^2$,\nwhere (15c) represents for the sensing constraint by applying Schur-complement theorem, (15b) represents for the SINR constraint, and \u03c9 serves as the lower bound for the ISAC utility per subframe. Subsequently, we employ the classical SDR technique by eliminating the rank-1 constraints in (15a). This problem is then transformed into a standard semi-definite programming (SDP) and can be solved by the off-the-shelf toolbox like CVX. As a result, the rank-1 constraint is restored as elaborated in [10] and the equivalent fully-digital precoding matrix $\\mathbf{F}_m$ is obtained."}, {"title": "Stage II: Decomposing Fm", "content": "Upon obtaining $\\mathbf{F}_m$, the remaining task is to optimize $\\mathbf{F}_{BB,m}$ and $\\mathbf{F}_{RF}$ to approximate $\\mathbf{F}_m$ as\n$\\min_{\\mathbf{F}_{BB,m}, \\mathbf{F}_{RF}} \\sum_{m=1}^{M} ||\\mathbf{F}_m - \\mathbf{F}_{RF}\\mathbf{F}_{BB,m}||^2$,\ns.t. $\\sum_{m=1}^{M} || \\mathbf{F}_{RF}\\mathbf{F}_{BB,m}||_F^2 = 1$,\n$\\mathbf{F}_{RF} \\in \\mathcal{F}$.\n1) Optimizing $\\mathbf{F}_{RF}$: With fixed $\\mathbf{F}_{BB,m}$, the objective is upper-bounded by\n$\\sum_{m=1}^{M} ||\\mathbf{F}_m - \\mathbf{F}_{RF}\\mathbf{F}_{BB,m}||^2 = \\sum_{m=1}^{M} ||(\\mathbf{F}_m\\mathbf{F}_{BB.m} - \\mathbf{F}_{RF})\\mathbf{F}_{BB,m}|| = \\sum_{m=1}^{M} ||\\mathbf{F}_m\\mathbf{F}_{BB.m} - \\mathbf{F}_{RF}|| ||\\mathbf{F}_{BB,m}||,$\naccording to Cauchy-Schwarz inequality. Then $\\mathbf{F}_{RF}$ and $\\mathbf{F}_{BB,m}$ are decoupled. The design problem in terms of $\\mathbf{F}_{RF}$ can be transformed into\n$\\min_{\\mathbf{F}_{RF}} \\sum_{m=1}^{M} ||\\mathbf{F}_m\\mathbf{F}_{BB} - \\mathbf{F}_{RF}|| ||\\mathbf{F}_{BB,m}||$,\ns.t. $|[\\mathbf{F}_{RF}]_{i,j}| = 1$."}, {"title": "C. Remark on optimization-based schemes", "content": "The proposed optimization-based algorithm can serve as a candidate solution for the wideband ISAC precoding. However, it is far away from optimal in practical double dynamics, due to the following reasons:\n\u2022 Huge complexity: The iteration in the solution introduces significant computational complexity, scaling up to $O(M(N^{3.5}\\log(1/\\epsilon) + 2N_{iter}U^2N_t))$ given a solution accuracy $\\epsilon$ and $N_{iter}$ alternating iterations. This results in an unacceptable delay, especially with large antenna arrays in studied scenarios.\n\u2022 Heavy reliance on perfect prior: The doubly-dynamic scenarios impose significant challenges on instantaneous channel estimation and targets' position acquisition, rendering the optimization-based method, which heavily rely on perfect state information, no longer effective.\n\u2022 Mediocre performance: The obtained solutions may incur potentially significant suboptimality for two main"}, {"title": "IV. FRAME STRUCTURE FOR ISAC PROCESSING IN DOUBLE DYNAMICS", "content": "In this section, we introduce a dedicated frame structure to facilitate ISAC operations in double dynamics. Instead of relying solely on instantaneous environmental prior information, the dual-functional waveform possesses inherent sensing capabilities. Taking inspiration from this, the update of hybrid precoding is performed in advance based on historical observations from BS itself. The ISAC frame structure is illustrated in Fig. 2, where each frame begins with a frame preamble, followed by T subframes containing L OFDM symbols.\nIn the frame preamble, initial CSI can be obtained using existing channel estimation techniques. Simultaneously, an approximate prior on the target's angle can be estimated through omni-directional angle scanning. Utilizing this initial state, the optimization-based hybrid precoding procedure outlined in Algorithm 1 is implemented in the frame preamble for data transmission. In the subsequent subframes, multi-user communication occurs alongside mono-static target sensing conducted by the BS. To elaborate further, each subframe consists of two stages: Precoding update and data transmission.\n1) Stage I: Precoding update: In this stage, historical estimates from the ISAC BS are utilized instead of acquiring real-time environmental state. Using the proactively-obtained estimates, the BS updates the observed state, enabling the hybrid precoders to be updated according to the current strategy.\n2) Stage II: Data transmission: With $\\mathbf{F}_{RF}$ and $\\mathbf{F}_{BB}$ updated at the beginning of each subframe, the data signal is precoded and then transmitted to both users and the target. The echo is processed at BS for target estimation via existing algorithms, We assume that the transmitted signal does not interfere with the reception antennas, as this issue can be mitigated through various full-duplex radio techniques [33]. These target estimates are then utilized for state update in the following subframes, creating a closed loop of sensing information.\nVarious frame structures that might be utilized in doubly- dynamic ISAC scenarios are compared, as depicted in Fig. 2. The operation in [34] conducts the precoding design based on the real-time channel estimation and target detection through downlink pilots and uplink feedback in each subframe. This leads to a decrease in SE due to high time overhead and is not suitable for double dynamics. In contrast, the frame structure in [19, 35] aims to predict CSI and the target's position proactively to reduce prior acquisition overhead. However, real-time optimization of precoding remains essential. The proposed ISAC frame structure mitigates the reliance on the real-time prior, greatly reducing the signal overhead. Moreover, precoding is updated without optimization from scratch, lowering the computational complexity."}, {"title": "V. DRL-AIDED ISAC PRECODING IN DOUBLE DYNAMICS", "content": "Based on the ISAC frame structure for doubly-dynamic scenarios in Section IV, we propose a DRL-aided approach for ISAC precoding with hybrid precoding structure in this section. We first formulate the problem as a POMDP, where the ISAC BS acts as an agent and explores the environment to gain experiences for refining its precoding strategies.\nWhen the environment state is partially observed at subframe t, BS takes an action according to its strategy. Subsequently, the agent receives a reward and the environment evolves to the next state. This process continues, with the new state being observed at each step, and new actions are taken accordingly. The key components are detailed in this section."}, {"title": "A. Environmental State Spa\u0441\u0435", "content": "The environmental state is expressed as\n$S^{(n)} = {\\mathbf{H}^{(n)}, \\mathbf{U}^{(n)}, \\mathbf{T}^{(n)}} \\in S$,\nwhere $\\mathbf{H}^{(n)}$, $\\mathbf{U}^{(n)}$ and $\\mathbf{T}^{(n)}$ denote the instantaneous state of channel information, users' positions and the target's position, respectively. $\\mathbf{H}^{(n)} = [\\mathbf{h}^{(n)},..., \\mathbf{h}^{(n)}]^{N_d-1}$ contains the time- domain channel in $N_d$ delay taps. $\\mathbf{U}^{(n)} = {(\\theta_u^{(n)}, d_u^{(n)})^{U}_{u=1}}$ and $\\mathbf{T}^{(n)} = {(\\theta_s^{(n)}, d_s^{(n)})}$ contain the polar coordinates of the users and of the target in the n-th subframe, respectively."}, {"title": "BS-End Observation:", "content": "In doubly-dynamic scenarios", "Observation": "Considering that the instantaneous CSI at each subframe is prohibitive in fast-fading channels, only the initial CSI is estimated at each frame preamble. The initial CSI is pre-processed as\n$\\mathbf{S}_h^{(n)} = [[vec(\\mathbf{H}_0^{(0)} \\mathbf{D}_1)\\,\\, \\, \\vec(\\mathbf{H}_0^{(0)} \\mathbf{D}_1)\\,...,\\,\\vec(\\mathbf{H}_0^{(0)} \\mathbf{D}_1)|"}]}