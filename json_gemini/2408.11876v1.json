{"title": "From Glucose Patterns to Health Outcomes: A Generalizable Foundation Model for Continuous Glucose Monitor Data Analysis", "authors": ["Guy Lutsker", "Gal Sapir", "Anastasia Godneva", "Smadar Shilo", "Jerry R Greenfield", "Dorit Samocha-Bonet", "Shie Mannor", "Eli Meirom", "Gal Chechik", "Hagai Rossman", "Eran Segal"], "abstract": "Recent advances in self-supervised learning enabled novel medical AI models, known as foundation models (FMs) that offer great potential for characterizing health from diverse biomedical data. Continuous glucose monitoring (CGM) provides rich, temporal data on glycemic patterns, but its full potential for predicting broader health outcomes remains underutilized. Here, we present GluFormer, a generative foundation model on biomedical temporal data based on a transformer architecture, and trained on over 10 million CGM measurements from 10,812 non-diabetic individuals. We tokenized the CGM training data and trained GluFormer using next token prediction in a generative, autoregressive manner. We demonstrate that GluFormer generalizes effectively to 15 different external datasets, including 4936 individuals across 5 different geographical regions, 6 different CGM devices, and several metabolic disorders, including normoglycemic, prediabetic, and diabetic populations, as well as those with gestational diabetes and obesity. GluFormer produces embeddings which outperform traditional CGM analysis tools, and achieves high Pearson correlations in predicting clinical parameters such as HbA1c, liver-related parameters, blood lipids, and sleep-related indices. Notably, GluFormer can also predict onset of future health outcomes even 4 years in advance. We also show that CGM embeddings from pre-intervention periods in Randomized Clinical Trials (RCTs) outperform other methods in predicting primary and secondary outcomes. When integrating dietary data into GluFormer, we show that the enhanced model can accurately generate CGM data based only on dietary intake data, simulate outcomes of dietary interventions, and predict individual responses to specific foods. Overall, we show that GluFormer accurately predicts future health outcomes based on CGM data in a manner that generalizes across different populations and metabolic conditions, paving the way to utilizing CGM data in chronic disease management.", "sections": [{"title": "Introduction", "content": "The emergence of self-supervised learning (SSL) in healthcare marks a shift in medical AI, enabling the creation of foundation models (FMs) capable of processing and analyzing vast amounts of unlabelled data 12 and application of diverse downstream tasks. Examples include FMs for retinal images \u00b3, which improved detection rates of ophthalmic diseases in community setting 4, FM from wearable data has demonstrated the potential of SSL in analyzing continuous physiological signals from wearable devices 5, and FMs for sleep analysis have improved detection of sleep disorders 6. Furthermore, FM in pathology have shown remarkable accuracy in diagnosing complex diseases from histopathological images 7. SSL facilitates efficient training of AI systems without extensive annotated datasets, accelerating their integration into clinical practice 8. This convergence of AI advancements and the availability of high-quality datasets producing opportunities for major improvements in healthcare delivery and outcomes, particularly in managing chronic conditions like diabetes, which remains one of the leading causes of death and disability worldwide 9.\nDiabetes affects individuals across age groups and geographical regions. The prevalence of diabetes is increasing, with >500 million patients as of 2021, with the global expenditure estimated at over $900 billion per annum 9. Type 2 diabetes (T2DM) is largely driven by preventable risk factors, such as poor diet, and lack of appropriate physical activity 9. Diabetes is a major risk factor for numerous comorbidities, including cardiovascular disorders (such as ischemic heart disease and stroke), liver disease, lung diseases, cancer conditions, chronic kidney disease, and mental health issues, many of which are leading causes of global morbidity and mortality10 11 12 13\u201317. As the impact of diabetes continues to grow, Continuous Glucose Monitoring (CGM) has emerged as a crucial tool in both managing the disease and enhancing overall patient care.\nCGM has shown several advantages over traditional self-monitoring of blood glucose (SMBG) in individuals with diabetes. These include improving glycemic control in adults\u00b98 and in children 19, reducing hypoglycemic events\u00b98, and improving overall quality of life18. Recently, in an important consensus statement endorsed by the American Diabetes Association (ADA) and the European Association for the Study of Diabetes (EASD), clinicians and researchers recommended that CGM-derived metrics be incorporated in clinical trials for diabetes 20, paving the way for wider adoption. The usage of CGM devices has also been studied in the non-diabetic population. It may assist in detecting early signs of glucose dysregulation 21, sports related performance enhancement21, and receiving personalized advice on diet 22. Additionally, recent research using CGM in non-diabetic adults has revealed substantial day-to-day variability in fasting glucose levels, suggesting the potential for CGM to refine glycemic status assessment 23. Importantly, the Food and Drug Administration (FDA) recently approved the first over-the-counter CGM device24, representing a significant shift towards widespread accessibility and glucose monitoring for the non-diabetic population.\nHere, we present GluFormer, a generative model for CGM data based on the transformer architecture 25, which efficiently learns over long sequences. It is trained in a self-supervised way using CGM data from the Human Phenotype Project (https://humanphenotypeproject.org/home) dataset, a large-scale,"}, {"title": "Results", "content": "Figure 1 provides a schematic overview of the GluFormer model developed in this study. Initially, the model was trained on data from 10,812 non-diabetic participants in the HPP cohort, with >10,000,000 glucose measurements in total. To facilitate efficient training, CGM data is tokenized such that each measurement within each sample is a discrete token (See Methods). GluFormer was trained using next token prediction, and thus is capable of generating, or continuing CGM time series. In addition the model is capable of embedding CGM samples to a 1,024 dimensional space (see Methods), which"}, {"title": "GluFormer Latent Representation Space Encodes Physiological Parameters and Generates Reliable CGM Signals", "content": "To evaluate the ability of GluFormer to capture clinically relevant information from continuous glucose monitoring (CGM) data, we analyzed the model's output representations using uniform manifold approximation and projection (UMAP) 33. We processed CGM time series through GluFormer to generate embedding vectors. These vectors were then aggregated using max-pooling to extract features34 (see Methods). We applied UMAP to visualize these embeddings in a two-dimensional space, with each point corresponding to a CGM sample from the HPP. When we colored the UMAP by fasting plasma glucose (FPG), we found clear clustering patterns related to glycemic control. Similarly, when we colored the UMAP by postprandial glucose response (PPGR), we observed distinct gradients indicating varying levels of glucose tolerance. These results demonstrate that GluFormer encodes clinically relevant information, effectively capturing glycemic profiles with related yet distinct characteristics (Figure 2A and 2B).\nTo further evaluate GluFormer's embeddings within and between participants, we compared the cosine distances 35 between embeddings. We measured intra-participant distances using embeddings from the same participant on different days, and inter-participant distances using embeddings from different participants. Our results show that inter-participant distances are significantly higher than intra-participant distances (p-value < 0.001), indicating that GluFormer captures individual-specific glycemic patterns (Figure 2C).\nTo assess GluFormer's ability to predict clinically relevant outcomes, we examined its performance in predicting HbAlc values. We compared GluFormer's predictions to those of other model types, including convolutional neural networks 36,37 (CNNs) and multilayer perceptrons (MLPs), as well as to predictions based on iglu parameters 38, which are validated clinical measures. iglu is a widely used open-source tool that implements a comprehensive set of CGM-derived metrics for assessing glucose control and variability. Our analysis reveals that pre-training through self-supervised learning 39 (SSL) enhances GluFormer's predictive accuracy for HbAlc. Notably, transformer architectures outperform CNNs and MLPs in capturing complex CGM patterns. Furthermore, frozen embeddings from the"}, {"title": "The GluFormer model generates CGM signal and captures innate characteristics of glycemic dynamics, and generalizes well to different populations", "content": "To evaluate GluFormer's ability to generate realistic CGM time series, we compared observed and generated CGM data using both visual inspection and quantitative metrics. We generated CGM signals for individuals and compared them to their actual recordings using iglu measures. These results show that the model captures glucose dynamics and generates signals that align with individuals' glycemic characteristics. The radar plots demonstrate the model's ability to reproduce clinically important variables, though some discrepancies occur due to unmodeled personal actions such as diet (Fig. 3A).\nTo assess the accuracy of generated signals across multiple glycemic metrics, we compared key iglu measurements from real signals to the average of three generated signals. Our analysis reveals significant correlations between the iglu metrics of generated and original CGM curves. For instance, we observed correlations of r=0.98 (p<0.001) for mean glucose, r=0.98 (p<0.001) for glucose management indicator (GMI), and r=0.89 (p<0.001) for glucose below 70 mg/dL, indicating the model's ability to reproduce essential glycemic features (Fig. 3B).\nTo test the model's generalizability, we evaluated its performance on out-of-distribution (OOD) data from cohorts in new geographical areas not included in the training set. We generated time-series for participants with diverse glycemic characteristics, including those with type 2 diabetes mellitus (T2DM) or gestational diabetes mellitus (GDM), across different continents (Middle East, Australia, North America). The results show that the model generates time-series with correlated glycemic metrics for these diverse populations. For the T2D cohort, all correlations were above 0.8 (p<0.001), demonstrating the model's adaptability to different populations (Fig. 3C)."}, {"title": "The GluFormer model encodes a wide range of clinical information and predicts clinical parameters, even years into the future", "content": "To test the ability of GluFormer embeddings to predict a wide range of clinical parameters both at baseline and in the future, we compared their performance against traditional iglu measures using ridge regression models. We assessed predictions at the time of CGM recording and for future time points up to 4 years to evaluate the model's capability for both immediate and long-term health assessments. Our results demonstrate that GluFormer embeddings consistently outperform iglu measures across multiple clinical parameters (Fig. 4). At baseline (Fig. 4A), GluFormer shows superior predictive performance for visceral adipose tissue (VAT) (r = 0.41 vs. 0.28 for iglu, p < 0.001), liver attenuation (r = 0.19 vs. 0.09, p < 0.001).\nThe model also effectively predicts sleep-related apnea-hypopnea index (AHI) (r = 0.22 vs. 0.17, p < 0.001) and systolic blood pressure (SBP) (r = 0.26 vs. 0.17, p < 0.001). Importantly, GluFormer's predictive capabilities from CGM at baseline, extend to clinical parameters 2 and 4 years following the baseline measurements. At a 2-year horizon (Fig. 4B), the model maintains its superior performance, particularly for VAT (r = 0.41 vs. 0.35, p < 0.001) and fasting glucose levels (r = 0.52 vs. 0.37, p < 0.001). Even at a 4-year horizon (Fig. 4C), GluFormer continues to outperform iglu measures in predicting fasting glucose levels (r = 0.47 vs. 0.28, p < 0.001) and maintains significant predictive power for VAT (r = 0.21 vs. 0.14, p < 0.001), although the overall correlation strength decreases over time. These findings demonstrate GluFormer's robust ability to extract meaningful health insights from CGM data, surpassing traditional metrics in both immediate and long-term health assessments. The model's capacity to predict a wide range of clinical measures up to four years in advance underscores its potential for long-term health monitoring and risk assessment."}, {"title": "GluFormer embeddings predict glycemic and other clinically relevant outcomes for OOD data, across geographical areas", "content": "To test whether GluFormer generalizes across diverse cohorts, geographies, devices, and diseases, we applied its embeddings to predict outcomes using CGM data from external research cohorts. We evaluated the model's performance on varied populations, including patients with type 2 diabetes mellitus (T2DM), breast cancer survivors, and pregnant women with gestational diabetes.\nOur results show that GluFormer successfully created embeddings reflecting aspects of personal clinical pictures and predicted outcomes more accurately than iglu metrics, consistently across these diverse populations (Figure 5). The embeddings demonstrated strong correlations with disease-specific features. In T2DM patients, GluFormer predicted creatinine levels (r = 0.27, p < 0.001), a key indicator of kidney function. For breast cancer survivors, the model effectively estimated albumin (r =0.19, p < 0.001) and creatinine levels (r = 0.12, p < 0.001), which reflect the impact of treatments on renal function and overall health. In pregnant women with gestational diabetes, GluFormer accurately predicted hemoglobin (r = 0.42, p < 0.001) and platelet counts (r = 0.35, p < 0.001), important markers for maternal and fetal health.\nThese findings indicate that GluFormer's latent space encompasses a broad spectrum of health indicators beyond glycemic metrics, reflecting overall health status and disease-specific characteristics. Clinically, this means GluFormer has the potential to not only predict glycemic outcomes but also provide valuable insights into a patient's broader health profile, making it a powerful tool for personalized health prediction and management across various medical conditions and demographic groups."}, {"title": "GluFormer CGM embeddings predict outcomes of clinical trials", "content": "To test whether GluFormer embeddings could predict clinical trial outcomes from baseline data, potentially enabling personalized treatment decisions and improved patient care, we used pre-intervention CGM data from completed clinical trials. We embedded this data using GluFormer and predicted the studies' clinical outcomes, comparing our results to traditional iglu measures.\nOur results show that GluFormer embeddings consistently outperform iglu measures in forecasting clinical outcomes across diverse studies (Figure 6A). In the PREDICT cohort, GluFormer showed superior predictive power relative to iglu metrics for HbA1c, creatinine, and waist circumference (p < 0.001). In the BREACP study, the model significantly improved predictions for HbAlc, body fat percentage (p < 0.001), lymphocyte levels and creatinine. For the PNP3 diet intervention study, GluFormer achieved improvements in predicting changes in HbA1c, LDL, and glucose levels (p < 0.001). These predictions used only pre-intervention CGM data and a binary variable indicating the intervention arm. GluFormer also outperformed iglu in predicting primary outcomes for open access clinical trials with CGM data (Figure 6B). These results demonstrate the model's robust ability to predict medical intervention effects across various measures and studies. This suggests that CGM-derived embeddings could substantially benefit precision health and clinical trial design by providing insights into patient-specific treatment responses based on pre-intervention metabolic states."}, {"title": "Temporal encoding increases generation performance", "content": "To improve GluFormer's ability to capture temporal information we added date and time into the architecture of GluFormer through learned embeddings for minute, hour, day of the week, and month (see Methods). We then trained two versions of the model using a pre-processed HPP dataset (see Methods) and evaluated their performance in generating CGM data for test participants (See Fig. S5). The temporal informed model achieved a correlation of 0.22 (p < 0.001) with the observed participant CGM data, outperforming the original GluFormer, which had a correlation of 0.15 (p < 0.001)."}, {"title": "Diet encoding to create a multimodal GluFormer model on HPP", "content": "To test whether incorporating dietary information could improve glucose prediction accuracy, we developed a multimodal version of GluFormer that includes macronutrient content alongside glucose data. We tokenized both glucose measurements and diet macronutrients, creating a synchronized sequence for training. The model was trained using a next-token prediction strategy, learning to predict subsequent glucose tokens based on the combined sequence of glucose and diet tokens, with diet tokens masked out of the loss function to focus on glucose response prediction (See Methods).\nWe then evaluated the impact of dietary data inclusion by comparing two versions of the model: one learned with diet tokens and one without. These models were tested on a generation task using data from test participants. Our results show that incorporating dietary information significantly enhances prediction accuracy (Fig. 7). The multimodal GluFormer achieved an average correlation of 0.5 with observed CGM data across test participants, surpassing the original GluFormer's correlation of 0.22 (p-value < 0.001). In addition we show that 91% of test participants showed better correlation (Fig. 7.A.1), and 92% exhibited improved mean absolute error (MAE) when diet information was included (Fig. 7.A.2). These findings are further supported by a qualitative inspection of generated CGM time series plots, which demonstrate that glucose predictions incorporating dietary data more closely track the original glucose curves, particularly around meal times (Fig. 7.C.1, Fig. 7.C.2). To ensure robustness, we conducted tests across different random seeds, with consistent outcomes (Fig. S8). This enhancement suggests a significant advancement in our ability to model and predict glucose responses, potentially leading to improved management strategies for diverse populations."}, {"title": "Discussion", "content": "This work introduces GluFormer, a novel foundation model trained on continuous glucose monitoring (CGM) data from 10,812 non-diabetic individuals. GluFormer demonstrates versatility and predictive power across diverse applications. The model's latent space encodes physiological parameters, enabling accurate generation of CGM signals that capture individual glycemic dynamics. GluFormer outperforms traditional CGM metrics in predicting a wide range of clinical outcomes from diverse modalities, including HbA1c, liver function, blood lipids, and sleep indices, using only baseline CGM measurements to forecast these outcomes up to four years in advance. Notably, the model generalizes well to other populations, CGM devices, and diseases, predicting clinical outcomes across various geographical regions and metabolic disorders. GluFormer's embeddings also show promise in forecasting clinical trial outcomes based on baseline CGM data. Furthermore, the integration of dietary information into the model significantly enhances its predictive accuracy, allowing the model to simulate dietary interventions, and predict postprandial glucose response. These results collectively demonstrate GluFormer's potential to enhance metabolic health management and clinical research through comprehensive analysis of CGM data.\nThe latent space represented in Figure 2 by model embeddings reveals its capacity to capture nuanced aspects of glucose metabolism. While increased PPGR is associated with beta cell dysfunction 40 and elevated fasting glucose correlates with insulin resistance 41, these metrics are interconnected in the pathophysiology of diabetes. The ability of GluFormer to distinguish these related but temporally distinct aspects of glucose dysregulation suggests its potential in capturing the nuanced progression of metabolic dysfunction. This aligns with our understanding that overproduction of endogenous glucose in the basal state and impaired suppression of postprandial glucose production are both markers of insulin resistance, with clinical hyperglycemia emerging when insulin secretion can no longer compensate for the degree of insulin resistance. Typically, postprandial hyperglycemia develops before fasting hyperglycemia in the natural progression of the disease. The model's capacity to encode these differences may prove valuable in early detection and monitoring of diabetes progression. Future studies could explore how GluFormer's embeddings correlate with different stages of diabetes development, potentially offering new insights into the prognosis of the transition from prediabetes to clinical diabetes.\nThe choice of next token prediction as our pretraining strategy has proven to be highly effective. This approach, inspired by the success of models like GPT 25,42, compels the model to utilize past knowledge to predict future events. By focusing on the task of predicting subsequent glucose measurements based on previous readings, the model learns intricate patterns and dependencies within the data. This strategy not only enhances the model's ability to generate realistic glucose signals but also prepares it for diverse downstream tasks, as evidenced by its performance across various clinical predictions. The results demonstrate the versatility of this pretraining method, making it a powerful approach for self-supervised learning in the biomedical domain.\nGluFormer represents a significant advancement over existing methods for analyzing CGM data. While current approaches provide valuable validated metrics and summary statistics, they are primarily focused on diabetes-specific outcomes. Previous innovations like glucodensities 43 have shown some predictive power but remain limited to the diabetes domain. In contrast, GluFormer's foundation model approach extends beyond traditional glycemic analysis, demonstrating predictive capabilities for a broad spectrum of health outcomes across metabolic states and geographical regions.\nOur analysis reveals that CGM data contains a wealth of information beyond traditional glycemic metrics, offering insights into a broad spectrum of health parameters. The latent space encoded by GluFormer demonstrates an ability to capture and distinguish different aspects of metabolic health. For instance, we observed distinct representations of insulin resistance and glucose response within this latent space, suggesting a nuanced understanding of different aspects of glycemic health. The richness of this latent representation extends to a wide array of phenotypes, indicating that CGM data may serve as a window into diverse physiological processes. This comprehensive encoding likely reflects metabolic health in the context of various bodily systems, from chronic stress responses to inflammatory processes and even aging markers.\nOur findings demonstrate that pretraining significantly enhances the predictive capabilities of our model, as illustrated in Figure 2D. By utilizing embeddings generated from the pretrained model without any finetuning, we achieved superior predictions of clinical measures compared to traditional CGM-based metrics. Interestingly, in some scenarios, our model struggled to significantly outperform traditional metrics, which are closely related to diabetes diagnosis and management. This is a well-documented phenomenon in self-supervised learning (SSL), given that traditional CGM-based statistics were specifically designed to proxy measures like HbA1c.\nHowever, GluFormer demonstrated superior performance in predicting outcomes not directly tied to these conventional metrics. Notably, it outperforms traditional CGM-based metrics on measures less directly related to glycemic health, such as creatinine and hemoglobin levels. These metrics are critical for assessing kidney function in T2DM, the impact of chemotherapy in cancer survivors, and maternal health in gestational diabetes. GluFormer's superior performance across this broader range of clinical parameters stems from its general self-supervised task of next token prediction, encouraging the model to learn general patterns without bias towards specific medical aspects. Currently, clinicians typically rely on limited metrics such as fasting glucose and HbAlc for prediabetes and general health assessments. Even for individuals with CGM, clinical focus is often restricted to time in range, hypo/hyperglycemic events, GMI/eHBA1C, and coefficient of variation 44. In contrast, GluFormer's unbiased analysis of CGM data potentially uncovers subtle patterns and predictors currently underutilized in diabetes care.\nThe model's generative capabilities further validate its deep representation of glycemic dynamics, successfully producing CGM signals that closely match clinical parameters of original data, even for out-of-distribution populations. Intriguingly, when applied to external cohorts, GluFormer's latent space reveals cohort-specific information. We observed strong correlations with disease-specific features, such as creatinine levels in T2DM patients, albumin and creatinine in cancer survivors, and hemoglobin and platelet counts in pregnancy. This suggests that the model captures not just glycemic health, but also broader indicators of overall health status for different health and disease states.\nThese findings point to a profound implication: CGM data may contain an intrinsic representation of general health, aligning with previous research showing relationships between inflammatory markers like IL-6 and CGM parameters 45. The ability of GluFormer to extract and utilize this hidden layer of health-related information opens new avenues for comprehensive health assessment and monitoring, potentially revolutionizing our approach to personalized medicine and early disease detection.\nIncorporating temporal information into GluFormer has led to notable improvements in model performance, notably in improved correlations between generated and observed data. This finding highlights the importance of temporal dynamics in modeling physiological processes and the potential for further enhancing predictive accuracy by integrating additional time-based data (e.g. sleep stages and physical activity logging).\nGluFormer's integration of CGM and dietary data offers promising potential for enhancing clinical trial design and execution in metabolic health research. While traditional trials often rely on average treatment effects, GluFormer's approach could potentially enable more nuanced, individual-level simulations of treatment responses. This capability may allow for more precise participant selection and stratification, potentially reducing sample size requirements and associated costs. However, it's crucial to note that while GluFormer shows promising results in predicting glucose responses to dietary inputs, we have yet to demonstrate true counterfactual or causal inference capabilities. Future research should focus on validating these potential applications. If successful, GluFormer could revolutionize trial design by enabling pre-trial simulations of dietary interventions, potentially identifying responders and non-responders. This could lead to more efficient, cost-effective trials and accelerate the development of personalized dietary interventions. Nonetheless, challenges such as participant compliance and data reliability remain important considerations in realizing these potential benefits.\nThe use of nutrient-based dietary data rather than specific food items offers significant advantages in terms of generalizability. By focusing on the macronutrient content of meals, our model can theoretically predict responses to new foods not seen during training. This abstraction allows the model to generalize across various dietary patterns and cultural food practices, enhancing its applicability to diverse populations. While we have not explicitly tested this capability, the underlying principle suggests that GluFormer can potentially extend its predictive power to novel food items, paving the way for broader applications in personalized nutrition and metabolic health research.\nThe convergence of increasing CGM data availability, in light of recent FDA clearance of over-the-counter devices for non-diabetic use 46, and advancements in AI technology presents an unprecedented opportunity for metabolic health research. GluFormer represents a significant step towards utilizing this wealth of information. As demonstrated, the model's ability to incorporate additional modalities, such as dietary data, suggests potential for further expansion to include sleep patterns, continuous photoplethysmogram (PPG) signals, exercise logs, and medication data. This points towards the development of a comprehensive multimodal health model based on continuous signals and tracking. As CGM devices become more affordable and accessible, applications in the wellness realm, such as personalized diet planning for weight loss, are likely to proliferate. The model's generalizability across diverse geographical regions and disease states demonstrates its potential for wide-ranging applications, with exciting possibilities for personalized health management and clinical research that extend beyond our current expectations.\nThe recent global initiative to deliver precision health in diabetes 47, emphasizes the need for a paradigm shift in understanding diabetes heterogeneity. This initiative calls for redefinition of diabetes subtypes 48, integration of multiple data sources, and development of novel biomarkers. GluFormer aligns closely with these objectives, offering a powerful tool for capturing diabetes heterogeneity across diverse populations. Trained on the HPP dataset, which includes a diverse population encompassing various ethnicities and nationalities, GluFormer is designed to be applicable to all demographics. By leveraging large-scale CGM data and demonstrating strong predictive capabilities for various clinical outcomes, GluFormer represents a significant step towards the precision diabetology envisioned by this global initiative, potentially revolutionizing diabetes classification, prevention, and management strategies worldwide.\nDespite the robust performance and broad applicability of GluFormer, several limitations must be acknowledged. First, the dataset predominantly comprises healthy, non-diabetic individuals, which may limit the model's generalizability to populations with more rare metabolic conditions. The dietary data integrated into the model relies on self-reported logs, which are prone to inaccuracies and omissions, potentially affecting predictions related to dietary interventions. Additionally, the integration of dietary data required extensive engineering efforts to quantify the nutrient content of each food item. This process is both expensive and time-consuming, creating a barrier to scalability and widespread implementation.\nThe complexity and interpretability of transformer models, including GluFormer, also pose significant challenges. These models are often regarded as \u201cblack boxes\", making it difficult to understand the reasoning behind their predictions. Currently, clinical practice primarily relies on simpler metrics such as HbAlc and fasting glucose levels, and even metrics like iglu have not yet been widely adopted. Consequently, the advanced architecture of GluFormer, while offering greater predictive power for complex tasks, remains far from clinical adoption. Additionally, the model may inherit biases present in the training data, which need to be meticulously managed to ensure accurate and fair predictions. Also, GluFormer, similarly to many advanced analytical methods, produces a distribution of possible scenarios rather than a single prediction can complicate decision-making processes, as users must interpret a range of potential outcomes, which can be less straightforward than dealing with a singular prediction.\nIn conclusion, GluFormer demonstrates impressive capabilities in metabolic health analysis. It outperforms traditional metrics in predicting diverse clinical outcomes across geographical regions and metabolic disorders. The model's latent space encodes rich physiological information, suggesting CGM data contains intrinsic representations of general health. GluFormer aligns with global initiatives for precision diabetes care and shows potential for enhancing clinical trial design. This work represents a significant advancement towards comprehensive, personalized metabolic health management and research, opening new avenues for early disease detection and intervention.\""}, {"title": "Methods", "content": "The training dataset comprises Continuous Glucose Monitoring (CGM) records from 10", "sizes": "train set: 80% of participants", "set": 10}, {"set": 10, "parameters": "embedding dimension of 1024", "methods": "nCalculates the mean of the 1200 vectors, assuming equal contribution from all time points.\nSelects the maximum value for each of the 1024 dimensions across the 1200 vectors, highlighting the most prominent features in the sequence.\nSelects the minimum value for each dimension, capturing the lowest bounds of the glucose measurements.\nNote, we removed the <MASK> token before doing any of the pooling methods, to remove any non-informative data from the representation.\nThese methods were evaluated based on their ability to predict clinical outcomes using embeddings generated from the validation set. Max-pooling emerged as the most effective method, consistently providing better performance in predicting key clinical measures like HbAlc.\nTo extract meaningful clinical insights from Continuous Glucose Monitoring (CGM) data, we utilized the R package iglu 38,50) . Iglu is designed to derive a comprehensive set of metrics from CGM data, which are pivotal in assessing glucose control and variability across individuals.\nIglu integrates advanced computational algorithms to process CGM data, providing more than just basic reading and organizing functionalities. Unlike other tools which may offer limited analysis capabilities, iglu supports a full spectrum of CGM-derived metrics. This tool facilitates an in-depth evaluation of glucose dynamics, enabling the categorization of glucose management into several clinically relevant aspects 51.\nMetrics such as Mean Glucose Levels and estimated A1C (eA1C) are calculated to evaluate glycemic control.\nMeasures like Standard Deviation (SD) and Mean Amplitude of Glycemic Excursions (MAGE) assess responses to meal intake.\nThis includes Time in Range (TIR) and the J-Index, which provide insights into overall glucose exposure and variability.\nAll iglu measurements used in this study are detailed in ref, see Table S2.1.\nTo evaluate the predictive power of GluFormer embeddings for future health outcomes, we conducted a series of analyses targeting a broad range of clinical metrics. These metrics included blood tests, body measurements, anthropometric data, and body composition parameters such as muscle and fat mass. The primary goal was to assess the ability of GluFormer embeddings to forecast these health metrics over different time horizons, thereby validating their clinical applicability.\nFor each health metric, we trained a ridge regression model using either iglu measures and GluFormer output embeddings as input features. The embeddings, representing the CGM data for each participant, were used to predict various clinical metrics recorded for those individuals. Specifically, we used a KFold cross-validation approach, dividing the data into 5 folds and iteratively using each fold as the test set while aggregating results across all folds. We used this aggregated result to compute a Pearson correlation between observed and predicted values for all samples in the set. This process was repeated 10 times with different random seeds to ensure robustness, and the results were averaged, with standard deviations calculated. We evaluated the significance of our predictions using a permutation test across 100 different seeds, considering results as significant when random performance did not exceed the model performance more than 5 times (P-value < 0.05).\nTo evaluate the generalizability of our model to out-of-distribution (OOD) data, we focused on assessing performance using all datasets that have CGM data, including the Human Phenotype Project (HPP), PNP1, PNP3, BREACPNT, PREDICT, T1DM, GDM"}]}