{"title": "Towards Synergistic Deep Learning Models for Volumetric\nCirrhotic Liver Segmentation in MRIS", "authors": ["Vandan Gorade", "Onkar Susladkar", "Gorkem Durak", "Elif Keles", "Ertugrul Aktas", "Timurhan Cebeci", "Alpay Medetalibeyoglu", "Daniela Ladner", "Debesh Jha", "and Ulas Bagci"], "abstract": "Liver cirrhosis, a leading cause of global mortality, requires precise segmentation of ROIs for effective disease\nmonitoring and treatment planning. Existing segmentation models often fail to capture complex feature interactions\nand generalize across diverse datasets. To address these limitations, we propose a novel synergistic theory that\nleverages complementary latent spaces for enhanced feature interaction modeling. Our proposed architecture,\nnnSynergyNet3D, integrates continuous and discrete latent spaces for 3D volumes and features auto-configured\ntraining. This approach captures both fine-grained and coarse features, enabling effective modeling of intricate\nfeature interactions. We empirically validated nnSynergyNet3D on a private dataset of 628 high-resolution T1\nabdominal MRI scans from 339 patients. Our model outperformed the baseline nnUNet3D by approximately 2%.\nAdditionally, zero-shot testing on healthy liver CT scans from the public LiTS dataset demonstrated superior\ncross-modal generalization capabilities. These results highlight the potential of synergistic latent space models to\nimprove segmentation accuracy and robustness, thereby enhancing clinical workflows by ensuring consistency\nacross CT and MRI modalities.", "sections": [{"title": "1. INTRODUCTION", "content": "Clinical Motivation. Liver cirrhosis, the final stage of chronic liver disease (CLD), represents a significant global\nhealth issue. In 2019, it ranked as the 11th leading cause of death, contributing to 2.4% of deaths worldwide. 1, 2\nWhile viral hepatitis remains the primary cause of end-stage liver disease, metabolic dysfunction-associated\nsteatotic liver disease (MASLD) is projected to surpass it as the leading cause, driven by the rising prevalence of\nobesity and metabolic syndrome globally.2 Additionally, conditions such as alcoholic liver disease, autoimmune\nhepatitis, and genetic disorders also play substantial roles.2 Cirrhosis involves the development of bridging fibrosis\nand regenerative nodules, which compromise liver function and can lead to liver failure.3 Accurate segmentation\nof cirrhotic livers in radiology images is essential for monitoring the disease's progression, assessing severity, and\nevaluating treatment responses. Precise segmentation helps determine the extent and location of liver damage,\nwhich is vital for planning treatments like liver transplantation and other targeted therapies.\nTheoretical Shortcomings. Existing segmentation models often face significant theoretical shortcomings,\nprimarily due to their limited ability to capture complex feature interactions and their fixed hypothesis spaces.\nTraditional models5-7 treat features in isolation or use simplistic integration methods, failing to exploit intricate,\nnon-linear dependencies between different feature sets. This results in suboptimal representation of complex\npatterns, such as subtle tissue variations in MRI scans. Additionally, the fixed nature of these models' hypothesis\nspaces restricts their generalization capacity to new, diverse datasets, limiting their robustness across varying\nimaging conditions. Thus, these limitations can impede the accuracy and adaptability of conventional segmentation\napproaches in challenging scenarios like cirrhotic liver segmentation.\nSynergistic Theory and Practical Architecture Design.To address these limitations, we propose a novel\nsynergistic theory that enhances feature interaction modeling by incorporating features from diverse latent spaces\nthat complement each other. This theory posits that leveraging synergistic representations 8,9 where different\ntypes of latent features interact and complement each other can more effectively capture complex, non-linear\nrelationships within the data. Based on this synergistic theory, we introduce the nnSynergyNet3D architecture,\nwhich integrates both continuous and discrete latent spaces for 3D volumes and enjoys auto-configured training.\nThe continuous latent space captures fine-grained details, while the discrete latent space addresses broader, coarse\nfeatures. This dual approach allows nnSynergyNet3D to model intricate feature interactions more effectively."}, {"title": "2. METHODOLOGY", "content": "2.1 Problem Statement\nGiven a set of MRI scans X C Rd, our goal is to segment cirrhotic liver tissues accurately. Let x \u2208 X be an\ninput scan and y \u2208 Y be the corresponding segmentation map. Traditional segmentation methods often struggle\nwith the complex variations present in MRI images. We address this by proposing a deep learning model that\nleverages synergistic feature spaces.\n2.2 Synergistic Latent Space Theory\nWe introduce two feature sets, F1 and F2, derived from the MRI scans. These feature sets are combined to form\na synergistic space S = F1 \u00d7 F2. For the segmentation function f: S \u2192 R, we aim to prove that our model can\napproximate f accurately and generalize well to unseen data. To establish this, we first need to demonstrate that\na neural network can effectively approximate any function within this synergistic feature space.\nTheorem 1: Synergistic Latent Approximation Theorem. Let f: SR be a continuous function on a compact\nset SCRd1+d2. If N is an algebra of functions on Rd1+d2 that separates points and contains constant functions,\nthen for any e > 0, there exists g\u2208 N such that:\n$|| f - 9||_\\infty < \\epsilon$."}, {"title": "2.3 Practical Architecture Design", "content": "Based on the synergistic latent space theory, we propose a deep learning architecture that leverages interactions\nbetween complementary spaces, named nnSynergyNet3D. Unlike the traditional 2D SynergyNet,& our design\nemploys a 3D cascade U-Net. Initially, a 3D U-Net processes low-resolution images, followed by a second\nhigh-resolution 3D U-Net that refines the predictions of the former. At the bottleneck, we use F\u2081 and F2 as\ncontinuous and discrete features, respectively, to capture fine and coarse information in cirrhotic liver MRI scans.\nDiscrete features are learned using volumetric vector quantization, which dynamically discretizes continuous 3D\nfeatures. Finally, F\u2081 and F2 are combined using volumetric multi-head cross-attention to capture synergistic\ninformation. The SynergyNet3D bottleneck integrates three-dimensional continuous and discrete latent spaces to\ncapture intricate, non-linear feature interactions effectively. Inspired by nnU-Net,6 nnSynergyNet3D employs\nrule-based parameters to adapt network topology, patch size, and batch size based on the dataset fingerprint and\nGPU memory constraints using hard-coded heuristic rules. Empirical parameters, determined through trial and\nerror, are used to select the best U-Net configuration (e.g. 3D full resolution, 3D low resolution, 3D cascade) and\noptimize the postprocessing strategy. This combination of automatic configuration and synergistic information\nallows for more effective modeling of complex patterns, enhancing the accuracy and robustness of segmentation,\nparticularly in challenging scenarios like cirrhotic liver segmentation."}, {"title": "3. EXPERIMENTAL SETUP", "content": "We carefully selected several baseline methods such as nnUNet3D, 6 nnFormer3D, 16 and TransUNet3D5 etc.\nDatasets. We leveraged our private data cirrhotic liver MRI data and LiTS10 datasets to demonstrate the\neffectiveness of our proposed method. Our private data includes 628 high-resolution abdominal MRI scans,\nconsisting of 310 T1-weighted (T1W) and 318 T2-weighted (T2W) volumetric scans from 339 patients. It\nencompasses both contrast-enhanced and non-enhanced MRI scans, along with segmentation masks annotated by\nphysicians. This is a comprehensive single-center dataset that is multivendor, multiplanar, and multiphase. The\ndataset was split with an 80:10:10 ratio, resulting in 248 cases for training, 31 cases for validation, and 31 cases\nfor testing for T1W. Similarly, for T2W, we allocated 256 cases for training, and 31 cases each for validation and\ntesting. While the T2W split was not exactly 80:10:10, we maintained the distribution as close to the target ratio"}, {"title": "4. EMPIRICAL ANALYSIS", "content": "Quantitative analysis on T1W modality. Table 1 provides a comparison between our proposed nnSynerg-\nyNet3D and five state-of-the-art (SOTA) segmentation networks on the T1W dataset. Our nnSynergyNet3D\noutperforms all comparison methods across all metrics. Among the transformer-based methods, nnFormer3D\nshowed comparable performance in capturing cirrhotic liver tissue and its boundaries, highlighting the significance\nof long-range dependencies. However, models such as SwinUNeTr and TransUNet3D did not significantly\nsurpass CNN-based models like nnUNet, emphasizing the necessity of more advanced configurations. Moving to\ntransformer-based models with auto-configuration, nnFormer3D and our nnSynergyNet3D demonstrated superior\nperformance due to their ability to adapt to the liver's varying shapes and complex boundaries. The auto-\nconfigured continuous and discrete representation enabled these models to capture fine and coarse features more\neffectively. Our proposed nnSynergyNet3D achieved the highest overall performance, with a mean Intersection\nover Union (mIoU) of 84.51, Dice Similarity Coefficient (DSC) of 87.89%, Hausdorff Distance at 95th percentile\n(HD95) of 21.04 mm, and precision of 88.72%. This superior performance can be attributed to the synergistic\nintegration of continuous and discrete representations, which allowed the model to capture both fine details and\nlong-range dependencies due to its Transformer-inspired design. This demonstrates the critical role of combining\ntransformer-based architectures with auto-configuration for enhancing segmentation performance in complex\ntasks like cirrhotic liver segmentation.\nQuantitative analysis on T2w modality Table 2 presents an evaluation of state-of-the-art (SOTA) 3D\nsegmentation networks on the T2W dataset scans. The results closely mirror those observed in the T1W\nsegmentation results. Among the evaluated models, our nnSynergyNet3D stands out with a superior Dice\nSimilarity Coefficient (DSC) value of 86.51%, the lowest Hausdorff Distance (HD) of 24.19 mm, and the lowest\nAverage Surface Distance (ASD) value of 3.96 mm. These metrics underscore the effectiveness of our approach,\nparticularly in handling the T2-weighted (T2W) MRI characteristics, which typically provide enhanced contrast\nbetween different soft tissues and are crucial for identifying cirrhotic liver tissues. nnFormer3D and nnUNet3D\nalso demonstrated competitive performance, reinforcing the importance of transformer-based designs for capturing"}, {"title": "5. CONCLUSION", "content": "In this study, we introduced a novel synergistic theory and the nnSynergyNet3D architecture to address the\nlimitations of existing segmentation models in capturing complex feature interactions and generalizing across\ndiverse datasets. By integrating continuous and discrete latent spaces, nnSynergyNet3D effectively models\nintricate feature interactions, enhancing segmentation accuracy and robustness. Our empirical validation on a\ncomprehensive dataset of T1 abdominal MRI scans demonstrated that nnSynergyNet3D outperforms the state-of-\nthe-art nnUNet3D by approximately 2%. Furthermore, our model exhibited superior cross-modal generalization\ncapabilities in zero-shot testing on healthy liver CT scans. These findings underscore the potential of synergistic\nlatent space models to significantly benefit clinical workflows, particularly in challenging scenarios like cirrhotic\nliver segmentation, by improving segmentation consistency across both CT and MRI modalities. Future work will\nexplore further optimization and extension of synergistic representations to other medical imaging tasks."}, {"title": "6. APPENDIX", "content": "6.1 Detailed Proofs\nTheorem 1: Synergistic Latent Approximation Theorem. Let f:S \u2192 R be a continuous function on a compact\nset SCRd1+d2. If N is an algebra of functions on Rd1+d2 that separates points and contains constant functions,\nthen for any e > 0, there exists g\u2208 N such that:\n$||f - 9||_\\infty < \\epsilon$.\nDetailed Proof. Following Stone-Weierstrass Theorem, which states that if A is an algebra of continuous\nfunctions on a compact set SC Rd and A satisfies two conditions-point separation and inclusion of constant\nfunctions then the closure of A in the supremum norm ||\u00b7 ||\u221e equals C(S), the space of all continuous functions\non S. Formally,\n$A = C(S)$,\nwhere A denotes the closure of A in || ||\u221e. To apply this theorem to our context, let N represent the algebra of\nfunctions computed by neural networks with continuous and non-constant activation functions. This algebra\nN separates points and contains constant functions, fulfilling the criteria stipulated by the Stone-Weierstrass\nTheorem. Consequently,\n$N = C(S)$.\nThis implies that N is dense in C(S) with respect to the supremum norm || . ||\u221e. Hence, for any continuous\nfunction f defined on S and for any \u20ac > 0, there exists a function g\u2208 N such that:\n$||f - 9 ||_\\infty < \\epsilon$.\nThe significance of this result lies in the ability of neural networks to approximate any continuous function f on\nS with arbitrary precision. The neural network's algebra N, which incorporates interactions between features,\nenhances the expressiveness of the function class, allowing it to capture complex dependencies between feature\nsets. This approximation capability is crucial in practical scenarios where modeling intricate relationships between"}]}