{"title": "Root Cause Attribution of Delivery Risks via Causal Discovery with Reinforcement Learning", "authors": ["Shi Bo", "Minheng Xiao"], "abstract": "This paper presents a novel approach to root cause attribution of delivery risks within supply chains by integrating causal discovery with reinforcement learning. As supply chains become increasingly complex, traditional methods of root cause analysis struggle to capture the intricate interrelationships between various factors, often leading to spurious correlations and suboptimal decision-making. Our approach addresses these challenges by leveraging causal discovery to identify the true causal relationships between operational variables, and reinforcement learning to iteratively refine the causal graph. This method enables the accurate identification of key drivers of late deliveries, such as shipping mode and delivery status, and provides actionable insights for optimizing supply chain performance. We apply our approach to a real-world supply chain dataset, demonstrating its effectiveness in uncovering the underlying causes of delivery delays and offering strategies for mitigating these risks. The findings have significant implications for improving operational efficiency, customer satisfaction, and overall profitability within supply chains.", "sections": [{"title": "1 Introduction", "content": "In today's increasingly complex and interconnected global economy, supply chain management has emerged as a critical factor in ensuring the success and competitiveness of businesses (Ketchen Jr et al., 2008). Effective management of supply chains is essential for improving customer satisfaction, optimizing productivity, and maintaining a competitive edge in the market. As businesses navigate the challenges of globalization and evolving geopolitical landscapes, they must prioritize the monitoring and analysis of customer delivery performance. By closely tracking delivery processes and analyzing relevant metrics, companies can gain valuable insights into their operations, identify areas for improvement, and proactively address issues before they escalate into significant disruptions (Christopher and Peck, 2004).\nSupply chain disruptions can have profound economic impacts, leading to delays in delivery and production as well as increased costs (Chopra and Sodhi, 2004). Understanding the root causes of these disruptions is"}, {"title": "1.1 Existing Works in Supply Chain on Delivery Risk", "content": "Most of the existing studies on delayed delivery risk have concentrated on the countermeasures implemented after the risk has materialized. For example, some approaches focus on ensuring delivery by optimizing production processes (Bi\u00e7er and Seifert, 2017; Chen et al., 2017) or by enhancing delivery strategies (Bushuev and Filatova, 2018; Shao and Tang, 2018). Nevertheless, these studies often overlook the factors that lead to the emergence of these risks in the first place.\nOther studies have employed machine learning and deep learning techniques to predict delivery risks and optimize supply chain operations. For instance, some researchers have applied machine learning algorithms"}, {"title": "2 Mothedology", "content": "We adopt the data-generating model as proposed by (Hoyer et al., 2008; Peters et al., 2014), where each variable xi corresponds to a node i in a d-node directed acyclic graph (DAG) G. The observed value of xi is modeled as a function of its parent variables in the graph, plus an independent additive noise ni. Specifically,\n\\(X_i := f_i(x_{pa(i)}) + n_i, i = 1, 2, ..., d,\\)\nwhere \\(f_i(x_{pa(i)})\\) represents the set of parent variables xj that have directed edges towards xi in the graph, and the noise terms ni are assumed to be jointly independent. We also assume causal minimality, which in this context implies that each function fi is non-constant in any of its arguments, as noted by (Peters et al., 2014).\nAs illustrated in Fig.(1), our proposed model consists of two parts: causal discovery via reinforcement learning and the calculation of inverse information entropy (IIE) causal strength (Mu et al., 2022). The model takes as input the observed dataset X = {X1,X2, ..., Xi}, where xi denotes the dimensions of the input observations, and produces as output a causal structure comprising a causal graph G and causal strengths. Fig. (2) presents"}, {"title": "2.1 The proposed method", "content": "To prevent self-loops, the diagonal elements (i, i) of the adjacency matrix are set to zero. By iteratively inputting the encoder outputs of all variables, a complete directed graph's adjacency matrix is obtained. The scoring function uses the Bayesian Information Criterion (BIC), which is decomposable and allows for adjusting the penalty term. The BIC score for a graph G is given by:\n\\(S_{BIC}(G) = -2 log p(X; L; G) + d_1 log m,\\)\nwhere \u00ce is the maximum likelihood estimate, d1 is the number of parameters in L, and m is the size of the dataset X. To ensure that the generated graph is a DAG, the score function includes both a reward and a penalty term, incorporating two acyclic constraints:\n\\(reward [S_{BIC}(G) + \\lambda_1I(G \\notin DAGs) + \\lambda_2h(A)],\\)\nwhere I(.) is an indicator function, \\(\u03bb_1, \u03bb_2 > 0\\) are hyperparameters, A \u2208 {0,1}d\u00d7d, and h(A) is a function introduced by Zheng et al. (2018), which is non-negative and small for cyclic graphs. The binary adjacency matrix of a directed graph G is acyclic if and only if:\n\\(h(A) = trace (e^A) \u2212 d = 0,\\)\nwhere eA is the matrix exponential of A. It is evident that larger values of \u03bb1 and \u03bb2 increase the likelihood that a graph with a high reward is acyclic. Our goal is to maximize the reward across all possible directed graphs, which is equivalent to solving:\n\\(\\underset{G}{min} [S_{BIC}(G) + \\lambda_1I(G \\notin DAGs) + \\lambda_2h(A)] .\\)\nThe expected return during training can be expressed as:\n\\(J(\\varphi | s) = E_{A\\sim\\pi(\\cdot|s)} {\u2212 [S_{BIC}(G) + \\lambda_1I(G \\notin DAGs) + \\lambda_2h(A)]},\\)\nwhere \u03c0(\u00b7 | s) is the strategy and \u03c6 represents the neural network parameters for graph generation. During training, random samples are drawn from the observed dataset X. The encoder output is fed into the critic, which is a simple two-layer feedforward neural network with a tanh activation function. The critic minimizes the mean squared error between predicted and actual rewards and penalties, and is trained using the Adam optimizer. Moving on to the IIE, building on Mu et al. (2022), the causal strength is defined as:\n\\(T = \\frac{1}{\\|S (p_{x_2}) - S (p_{x_1})\\|},\\)\nwhere S(px1) and S(px2) represent the information entropies of variables x1 and x2, respectively. For a finite dataset, the entropy of the probability distribution for risk factors can be estimated using the entropy estimator as described in (Daniusis et al., 2012; Kraskov et al., 2004):\n\\(\\hat{S}(X) = \\psi(n) \u2013 \\psi(1) + \\frac{1}{n-1} \\sum_{i}^{n-1}log \\| x_{i+1} - x_{i}\\|,\\)\nwhere \u03c8(n) is the digamma function, and n represents the dimensionality of the dataset X. Based on Eq. (10), the IIE causal strength is computed using raw data. However, due to potential differences in dimensionality among variables in the raw data, the calculated causal strength might deviate from the actual value. Thus, the IIE causal strength for normalized data is given by:\n\\(T_N = \\frac{1}{\\|S (p_{X_{2,N}}) - S (p_{X_{1,N}})|\\}\nEventually, We applied log transformation to the computed causal strengths to normalize their distribution and stabilize variance.. This transformation enhances the interpretability of the results, making it easier to compare the relative impact of different factors on delivery risks.\nCausal Strength = log(TN)"}, {"title": "Algorithm:", "content": "Next, we propose the algorithm for our causal discovery via RL for root cause attribution on late delivery. As can be seen in Algorithm 1, the proposed approach is as following:\nAlgorithm 1 Causal Discovery with RL for Late Delivery Risk\n1: Input: Data pertaining to late delivery risk.\n2: Step 1: Preprocess the observed data and set hyperparameters, including the number of epochs, learning rate, and scoring function.\n3: Step 2: Feed the preprocessed data into the encoder, and pass the encoder outputs along with those from the critic to the decoder. The decoder performs calculations using Eq. (3) and samples according to Eq. (4).\n4: Step 3: Rate the generated directed graph using Eq. (4), and return rewards and penalties to the critic. Track the maximum reward using Eq. (8).\n5: Step 4: Check if the preset number of iterations has been reached. If not, return to Step 2; otherwise, output the directed graph with the maximum score.\n6: Step 5: From the final directed graph, calculate causal strengths with log transformation (13), remove edges with a strength less than 0.1, and output the refined causal graph with the associated strengths.\n7: Step 6: Generate an explainable delivery risk report from the output graph, tailored for business stakeholders."}, {"title": "3 Experiments", "content": "We use a dataset of supply chains by the company DataCo Global for the analysis. This dataset is designed for analyzing and modeling various aspects of supply chain management provided by Kaggle. The dataset have 180520 samples and 53 features. Our aim is to find out the root cause of late delivery risk by analyzing the dataset by our causal discovery via reinforcement learning with strength caculation.\nFor the preprocessing of our dataset, we decided to begin by manually filtering out some variables that are less relevant to our specific problem, such as \"Order Date\", \"Order City\", and similar attributes. This step helps us focus on the most pertinent data, reducing noise and simplifying our analysis. After the initial manual filtering, we proceeded to check for multicollinearity among the remaining features. Multicollinearity can distort our model's predictions, as highly correlated features may carry redundant information. To address this, we removed features that exhibited high correlations with others, ensuring that each remaining feature contributes unique information to the model. Next, we transformed the categorical variables into numerical formats by encoding them as integers. This step was crucial for enabling the effective use of these variables in machine learning models, which typically require numerical input. Finally, after these preprocessing steps, we selected 16 key features that we identified as most relevant to our problem. These features will serve as the input for our models, providing a balanced and optimized dataset for analysis and predictive modeling. The remaining features are listed in Table 1 and description of variables to use is recorded in Appendix A."}, {"title": "3.1 Experimental data", "content": "In the next subsection, we will conduct a comprehensive exploratory data analysis (EDA) on the dataset. This analysis will involve examining the data in detail to uncover underlying patterns, relationships, and trends that may be present. Through visualization techniques and statistical summaries, we will identify key insights that can inform our modeling approach and enhance our understanding of the factors driving the outcomes within the dataset."}, {"title": "3.1.1 DataCo Global", "content": "Fig. (3) is an initial overview of the \"Late_delivery_risk\" (X7) variable within the dataset, which is critical for our exploratory data analysis (EDA) before delving into causal discovery with reinforcement learning for root cause attribution. The first chart displays a countplot of late delivery risks, showing that instances of late deliveries ('1') slightly outnumber on-time deliveries ('0'), suggesting that delays are a common issue in this dataset. The second chart, a scatter plot, explores the relationship between the actual days for shipping and the scheduled days for shipment, with different colors indicating the presence or absence of late delivery"}, {"title": "3.1.2 Explanatory Data Analysis", "content": "Fig. (4) further contribute to our exploratory data analysis (EDA) by offering insights into delivery perfor- mance and customer segmentation, which are crucial for understanding the factors influencing late delivery risks. The bar chart on the left (a) illustrates the distribution of delivery statuses across the dataset. Notably, \"Late delivery\" is the most common outcome, significantly outnumbering \"Advance shipping,\" \"Shipping on time,\" and \"Shipping canceled.\" This highlights a pervasive issue with delays, making it a key area of focus for our causal analysis. The prevalence of late deliveries suggests systemic issues that could be explored in greater depth, possibly linked to other variables in the dataset. We believe that Delivery Status (X6) might cause the late delivery."}, {"title": "3.2 Experimental analysis", "content": "The final causal graph in Fig. (6) illustrates the intricate relationships between various features and their impact on 'Late_delivery_risk' (X7), providing a detailed map of how different variables contribute to the likelihood of a late delivery. The shipping mode (X16) emerges as a pivotal factor, exerting a strong direct influence on 'Days for shipping (real)' (X2) with a causal strength of 9.24. This, in turn, significantly affects both the 'Days for shipment (scheduled) (X3) and directly influences the 'Late_delivery_risk' (X7), with strengths of 8.92 and 10.25, respectively. This indicates that the choice of shipping mode sets off a chain of effects that ultimately determine whether a delivery will be late.\nMoreover, the \u2018Delivery Status\u2018 (X6) has a direct impact on \u2018Late_delivery_risk\u2018, reflected by a causal strength of 10.66, highlighting that certain statuses during the delivery process are strong indicators of potential delays. The interconnectedness of these nodes suggests that delays in actual shipping time not only directly heighten the risk of late delivery but also indirectly influence other variables, such as scheduled shipping times, thereby compounding the delay.\nOn a more moderate level, \u2018Sales per customer' (X5) and \u2018Order Item Product Price\u02bb (X12) both influence 'Late_delivery_risk' indirectly, with causal strengths of 1.10 and 1.12, respectively. These variables, while less impactful, suggest that the value of orders and customer segments might influence the priority or efficiency of deliveries, thereby affecting the overall risk of late deliveries. The combination of direct and indirect effects across these variables highlights a complex network of interactions where both logistical decisions and customer-related factors converge to influence delivery outcomes."}, {"title": "4 Discussion and Business Impact", "content": "We conclude that the application of causal discovery with reinforcement learning in the context of supply chain management, specifically for identifying the root causes of late delivery risks, yields several potential business insights and actionable strategies:\n\u2022 (Improving Shipping Strategies) Our analysis has revealed that the choice of shipping mode (X16) has a direct and substantial impact on the actual days for shipping (X2), which in turn significantly in- fluences the risk of late deliveries (X7). The causal strength of 9.24 between shipping mode and actual shipping days underscores the critical importance of selecting the appropriate shipping method to min- imize delays. By implementing our causal discovery approach, businesses could optimize their shipping strategies by prioritizing modes that reduce delivery times, thus mitigating the risk of late deliveries. This optimization can lead to improved customer satisfaction and potentially lower operational costs.\n\u2022 (Enhancing Delivery Status Monitoring) The direct relationship between delivery status (X6) and"}, {"title": "5 Conclusions and Future work", "content": "In conclusion, the integration of causal discovery with reinforcement learning offers a powerful tool for root cause attribution in complex supply chain environments. Our approach successfully identifies the primary factors contributing to late delivery risks, such as shipping mode and delivery status, and provides a framework for implementing targeted interventions to mitigate these risks. The ability to accurately map and understand the causal relationships within supply chains enables businesses to make informed decisions that enhance operational efficiency and customer satisfaction.\nFor future work, there are several avenues for future research and improvement. First, the uncertainty of calculation of causal strength can be further considered to ask questions, such as, how confident we are sure that there is a strong causal relationship between Xi and Xj. Then, the model could be fine-tuned to handle different types of data or to adjust for varying supply chain conditions, increasing its robustness across different industries such as economics, healthcare, or manufacturing. Additionally, experimenting with different scoring functions and hyperparameters in the reinforcement learning process could further enhance the accuracy of causal discovery. The methodology could also be extended to include multi-modal data inputs or adapted to real-time data streams, providing dynamic and responsive insights that evolve with changing conditions in the supply chain. Such advancements would broaden the applicability of our approach, making it a versatile tool for optimizing performance in various domains."}]}