{"title": "Multi-hop Upstream Preemptive Traffic Signal Control with Deep Reinforcement Learning", "authors": ["Xiaocan Li", "Xiaoyu Wang", "Ilia Smirnov", "Scott Sanner", "Baher Abdulhai"], "abstract": "Traffic signal control is crucial for managing congestion in urban networks. Existing myopic pressure-based control methods focus only on immediate upstream links, leading to suboptimal green time allocation and increased network delays. Effective signal control, however, inherently requires a broader spatial scope, as traffic conditions further upstream can significantly impact traffic at the current location. This paper introduces a novel concept based on the Markov chain theory, namely multi-hop upstream pressure, that generalizes the conventional pressure to account for traffic conditions beyond the immediate upstream links. This farsighted and compact metric informs the deep reinforcement learning agent to preemptively clear the present queues, guiding the agent to optimize signal timings with a broader spatial awareness. Simulations on synthetic and realistic (Toronto) scenarios demonstrate controllers utilizing multi-hop upstream pressure significantly reduce overall network delay by prioritizing traffic movements based on a broader understanding of upstream congestion.", "sections": [{"title": "INTRODUCTION", "content": "Traffic signal control (TSC) is a critical component of intelligent transportation systems, aimed at optimizing the traffic flow through intersections to minimize overall delay, reduce congestion, and improve travel times. Traditional TSC methods, such as fixed-time control, have been extensively used but are often inadequate in responding to dynamic and complex traffic conditions [1, 2, 3]. To capture the dynamic local traffic conditions around an intersection, the concept of traffic pressure, which quantifies the imbalance between traffic demand and the available capacity at an intersection [4, 5], has gained significant attention in the development of more adaptive signal control strategies [6, 7, 8].\nHowever, existing approaches to pressure-based traffic signal control often suffer from myopic decision-making, focusing solely on the immediate links at individual intersections without considering the broader network context. This is particularly evident in scenarios where traffic flows from multiple directions converge at an intersection. Such issue is illustrated with a minimal motivating example in Figure 1. At the right intersection, a myopic controller perceives equal pressures from the immediate eastbound and immediate southbound links, leading to an equal allocation of green time to competing flows, disregarding the longer queues and congestion that may be developing eastbound upstream. This oversight can exacerbate delays and hinder overall network performance.\nTo address this limitation, it is essential to generalize the concept of traffic pressure to incorporate upstream conditions, thus enabling a more comprehensive understanding of traffic dynamics. By adopting"}, {"title": null, "content": "a farsighted pressure approach, traffic signal controllers can consider not only the immediate queues but also the conditions further upstream, allowing for a more effective allocation of green time to directions experiencing accumulating congestion. This broader perspective is crucial for mitigating network delays and enhancing the overall efficiency of traffic signal control systems.\nThe primary objective of this work is to develop a generalized concept of traffic pressure that extends to multi-hop upstream, and evaluate the effectiveness of traffic signal control based on the novel metrics. By incorporating information from a broader scope of the traffic network, the proposed approach aims to provide a more informed and farsighted control strategy that mitigates network delays more effectively. The generalization of traffic pressure to multi-hop conditions allows for the prioritization of traffic movements that can most significantly reduce overall congestion, thereby improving the efficiency of the traffic network as a whole.\nThe contribution of this work are two folds:\n1. Based on the Markov chain theory, we generalized the concept of traffic pressure to multi-hop upstream traffic, making it more farsighted and capable of addressing the limitations of traditional myopic approaches.\n2. We validate the proposed multi-hop pressure concept through simulations in both synthetic and realistic scenarios, demonstrating its effectiveness in reducing network delays."}, {"title": "LITERATURE REVIEW", "content": "Multi-intersection Traffic Signal Coordination\nMethods for traffic signal coordination has developed over decades. In this part, we cover three types of control in an increasing order of adaptiveness: Pre-timed Control, Actuated Control, and Adaptive Control.\nPre-timed Control: The pre-timed control sets a fixed traffic signal cycle, regardless of the fluctuation of the traffic demand. The pre-timed signal includes fixed cycle-based phase sequence, and phase split.\nThe Webster method [1] is used to calculate the optimal cycle length and phase split for an individual intersection. The Webster method is fully decentralized as it does not consider neighbor intersection information. As a result, high efficiency on individual intersection may cause failure in global traffic optimization.\nGreenWave method [3] considers multiple intersections coordination. Its goal is to reduce the number of vehicle stops in one direction by finding the optimal start time lags between contiguous intersections, a.k.a. offsets. However, GreenWave method only considers traffic optimization along one single direction.\nMaxband method's [2] goal is to reduce the number of vehicle stops in two opposite directions by finding a maximal bandwidth on an individual intersection's signal plan. The bandwidth is defined as the duration of synchronous green waves in a cycle length. The larger the bandwidth, the more vehicles can travel along one direction without stopping. The bi-directional bandwidths optimization is formulated as a mixed-integer linear programming (MILP).\nPre-timed control methods are summarized in Table 1. However, these methods do not consider the time-varying pattern of traffic demand. To better adjust the traffic signals, the actuated control and adaptive control are invented.\nActuated Control: In contrast to pre-timed control, the actuated control can make a flexible control strategy that suits the dynamic change of the traffic demand. The controller can change the cycle length and the green time for each phase based on current demand detected by equipments such as loop detectors and surveillance cameras. Besides, the phase orders and sequences can be modified as well. Pedestrians can influence priorities in actuated control by pushing a button. Besides, actuated control supports Transit Signal Priority (TSP),"}, {"title": null, "content": "improving public transit operations [9]. However, actuated control only focuses on current traffic state only, hence cannot be used for long-term optimization [10].\nAdaptive Control: Adaptive traffic signal control (ATSC) makes the traffic signals adaptive to real-time traffic states and can coordinate traffic signals in different locations.\nSCATS (Sydney Coordinated Adaptive Traffic System) [11] is a hierarchical control system implemented in the 1970s in Australia. Its upper-level controller finds the optimal cycle length and phase splits based on current traffic states, whereas the lower-level controller determines the exact phases of each intersection.\nSCOOT (Split, Cycle, and Offset Optimization Technique) [12] is a centralized control system implemented in the 1970s in the United Kingdom. Instead of optimizing each intersection's traffic signal individually, SCOOT provides a region-level traffic signal control.\nMaxPressure control [4] is designed to eliminate the risk of congestion by balancing the queue length between immediate upstream and downstream links. It is proved that minimization of the press of phases for individual intersection is equivalent to the maximization of the throughput of the entire network. However, when the demand exceeds the intersection capacity, the throughput is at its maximum, while the queue time can still be optimized. Additionally, as stated in previous section, the pressure definition is myopic without considering traffic conditions beyond immediate intersections.\nReinforcement learning (RL) based adaptive control: Categorized by the controller structure, RL approaches can be either centralized control, hierarchical control, and fully decentralized control. Centralized control requires one monolithic agent to observe every intersection's traffic condition to control all intersections simultaneously [13]. While centralized control may theoretically achieve network-level coordination, it suffers from the issue of scalability when the traffic network is large. While centralized control has solely one agent, hierarchical control has at least two levels of agents, the upper-level agent provide macroscopic instruction that lower-level agents receive to take finer actions [14, 15, 16]. In contrast, decentralized control is more scalable since one agent only controls one intersection, yet no guarantee for coordination. The coordination issue can be mitigated by centralized training with decentralized execution (CTDE) technique, and communications between agents [17, 18, 19]. In our work, we enhance the decentralized control with farsighted observations in reinforcement learning agent design."}, {"title": "Traffic Pressure and Its Variations", "content": "At the intersection level, traffic pressure quantifies the traffic statistics difference (such as vehicle count or density) between upstream and downstream links [20], which is inspired by works [21, 22, 23] that tackle resources reallocation in wireless communication networks. The application of traffic pressure mainly focuses the MaxPressure control policy which determines phase activation [24, 4, 5, 25, 26] or green time assignment [27, 28, 6, 29] for the next control period in a decentralized structure, and the MaxPressure control is incorporated in perimeter control strategies [6, 8]. [28, 30] pointed out that phase activation are likely to produce confusing ordering of phrases that brings frustration to drivers, resulting in dangerous actions. Hence,"}, {"title": null, "content": "a fixed [28] or variable [30] cycle time and fixed phase ordering are combined with the MaxPressure control along with the stability proof. [25] combines vehicle rerouting with MaxPressure to improve the performance.\nDepending on the traffic statistics used in pressure calculation, there are many variations of definition for traffic pressure. The link lengths are taken into account [27] so that the pressure of a short link with queued vehicles is higher than the pressure of a longer link with the same number of queued vehicles, i.e., the queue density is used instead of the queue length in pressure calculation. Such definition of traffic pressure is leveraged in the reward design within deep reinforcement learning for signal control [31]. To prioritize some phases, the phase weights are proposed by [32, 33] in pressure definition, along with the dynamic estimation of turning ratios and saturated flows are also proposed to be adaptive to temporal changes. To improve fairness in waiting time, [26] incorporates traffic delay into the pressure definition, with controllable relative importance between delay and queues. To avoid the practical difficulty in queue measurement, [29] proposed using travel times instead of queues to define the pressure, and are tested in both simulated and real traffic environments. To keep the large moving platoon seamlessly travel through an intersection, C-MP [7] integrated the space mean speed into pressure definition to prioritize platoon movements. OCC-MP [34] prioritizes transit and other high occupancy vehicles on the MP framework to improve passenger-based efficiency. PQ-MP [35] integrates pedestrian queues into the MP framework to address the existence of pedestrian traffic.\nTo address the myopia of 1-hop traffic pressure, [36] formalized the multi-hop downstream pressure for heterogeneous perimeter control. Such generalization is to prevent future congestion in the downstream links. However, to preemptively clear queues for upstream links, one needs to address the potential traffic flow from upstream traffic. N-MP [8] combines MaxPressure with heterogeneous perimeter control by considering multi-hop downstream links' traffic conditions beyond perimeter intersections. When the average density of the protected region exceeds the critical density, N-MP deprioritizes inflows from those perimeter intersections having higher aggregated congestion level at multi-hop downstream links.\nIn terms of capturing the potential of upstream traffic, existing works only consider the immediate upstream links without extending its scope to further upstream conditions. Different from N-MP and multi-hop downstream pressure, our work highlights the mathematical formalization of multi-hop upstream pressure grounded on the Markov chain theory, and incorporates the multi-hop upstream pressure into the deep reinforcement learning agent design for urban traffic signal control. To be specific, the novel metric informs the observation space and reward function to enable preemptive signal timing optimization.\nThe primary objective of this work is to generalize the existing traffic pressure definition to consider the multi-hop upstream traffic. Informed by the multi-hop pressure, a traffic signal controller is expected to coordinate traffic signals at different intersections."}, {"title": "PROBLEM STATEMENT", "content": "Traffic Signal Control as Markov Decision Processes\nIn this work, traffic signal control is modeled as a Markov Decision Process (MDP), which is defined by the tuple (O, A, T,R, y):\n\u2022 Observation space O: For each intersection i controlled by agent i, the observation space consists of the pressure associated with each traffic phase. For instance, if an intersection has an eastbound phase and a southbound phase, the observation space is two-dimensional, representing the pressure for the eastbound and southbound phases, respectively. The pressure is defined in later section.\n\u2022 Action space A: For each intersection i controlled by agent i, the action is defined as the cycle splits, which represent the proportion of time allocated to each phase at the intersection.\n\u2022 Transition probability T: The transition probability $T(o'|o, a)$ represents the probability of transitioning from current observation o to a new observation o' after taking action a. This probability"}, {"title": null, "content": "models the dynamics of traffic flow in response to changes in signal timing. In our setting, T is handled by the traffic simulator and remains unknown to the agent.\n\u2022 Reward R: For each intersection i controlled by agent i, the reward is calculated as the negative sum of phase potentials over multiple hops at the intersection. This reward design encourages each agent to clear upstream traffic as quickly as possible. It is important to note that a purely pressure-based reward may lead to undesirable behavior, such as holding vehicles upstream to minimize immediate pressure. The potential is defined in later section.\n\u2022 Discount factor y: The discount factor $\\gamma \\in [0, 1]$ determines the relative importance of future rewards compared to immediate rewards.\nIn this work, the definitions of observation space and reward are informed by the concept of multi-hop traffic pressure and multi-hop traffic potential, which are detailed in the following sections.\nReinforcement learning is employed to solve this MDP by training each agent i to learn an optimal policy $\\pi_i(a|o)$, which maximizes the expected discounted cumulative reward $E_{a \\sim \\pi_i(a\\o)} [\\Sigma_{k=0}^{\\infty} \\gamma^kR(O_{t+k}, a_{t+k})]$. Through repeated interactions with the environment, each agent observes the traffic conditions, selects actions, receives rewards, and updates its policy to improve long-term traffic efficiency.\nIn this study, we utilize the Proximal Policy Optimization (PPO) algorithm [37], a widely used RL algorithm known for its stability and efficiency."}, {"title": "METHODOLOGY", "content": "This section outlines the framework for implementing a generalized multi-hop pressure model in traffic signal control. We first clearly define the mathematical notations that are used throughout this work. Then, we introduce the concept of a supersink to simplify the traffic network representation, followed by the use of graph theory to model the traffic network structure. Finally, we define and illustrate the multi-hop pressure and multi-hop potential metric, both in its scalar and vectorized forms, and demonstrate its calculation through a simplified example."}, {"title": "Mathematical notations", "content": "The mathematical notations are primarily introduced in this section, where we establish the essential concepts. Notations related to specific methodologies or experimental setups are introduced in later sections to maintain relevance and coherence for better readability."}, {"title": "Graph representations of traffic networks", "content": "The traffic network is modeled as a graph defined in Definition 1. In this definition, to simplify the graph representation, a supersink \u03a9 is introduced to merge all destinations into a single abstract node. Another advantage of integrating the supersink is to achieve an adjacency matrix with the property of Markov chain transition matrix, such that the interpretations of mathematical operations towards the adjacency matrix can be based on the Markov chain theory. The supersink has the following properties:\n\u2022 Zero Queue Density: The supersink has infinite capacity, thus its queue density is zero.\n\u2022 Absorption: Any link connected to the supersink is fully absorbed, making downstream neighbors of \u03a9 still \u03a9 itself. Such property marks the vehicle movement on graph as an Absorbing Markov chain.\n\u2022 Binary Turning Ratio: The turning ratio from any immediate upstream link to the supersink, or from the supersink to itself, is 1, and 0 otherwise."}, {"title": "Definition 1 (Graph representation).", "content": "The graph representation $G^e = (V^e, E^e)$, where:\n\u2022 The extended link set $V^e = V \\cup {\\Omega}$ additionally includes a supersink vertex \u03a9.\n\u2022 The extended edge set $E^e$ additionally includes those edges from exit links to the supersink, and supersink to itself.\n\u2022 Edge weight $T_{uv}$ represents the turning ratio from link u to link v. These weights are derived from real empirical data or traffic simulations, encapsulating the probability of traffic flow transitions between links.\nTo assist understanding of graph representations, an example is provided with a simplistic traffic network with 8 links in Figure 2a, and is mapped onto its graph representation depicted in Figure 2b, where the turning ratios are labelled on edges."}, {"title": null, "content": "A vehicle traveling in a traffic network according to certain turning ratios can be formalized as a time-homogeneous absorbing Markov chain by treating a vehicle presenting on a link I as a random variable with probability $Pr(X = 1)$. The state space of this Markov chain is a finite set with size $|V^e|$. The transition matrix P is exactly the adjacency matrix of graph $G^e$, and is defined as follows:\nP =\\begin{bmatrix}\nT_{11} & T_{11} & \\cdots & T_{1|V|} & l_1 = \\begin{cases}\n1 & \\text{if } N_a(1, 1) = {\\Omega} \\\\\n0 & \\text{if } N_a(1, 1) \\neq {\\Omega}\n\\end{cases}\\\\\n\\vdots & \\vdots & \\ddots & \\vdots & \\vdots\\\\n0 & 0 & \\cdots & 1 & 1\n\\end{bmatrix}\n\\tag{1}"}, {"title": "Multi-hop pressure: a customizable metric for long distance traffic condition", "content": "Congestion from immediate upstream links has a more direct and significant impact than congestion several blocks further upstream. Therefore, the multi-hop pressure definition needs to capture the diminishing influence of distant congestion while still accounting for its cumulative effect on the current traffic link.\nTo understand the upstream links at higher hops, we provide an example of upstream links for link 7."}, {"title": null, "content": "Mathematically, they are written as:\n$N_u(7,0) = {7}$ \\tag{2}\n$N_u (7, 1) = {3,6}$ \\tag{3}\n$N_u(7,2) = {1,4}$ \\tag{4}\n$N_u(7,3) = {0}$ \\tag{5}\n$N_u(7,h) = \\phi, h\\geq 4, h \\in N^+$ \\tag{6}\nIn the following content, we first derive multi-hop pressure for a single link, and then we vectorize the pressure to achieve simultaneous and efficient computation for all traffic links. Since this work focuses on preemptively clearing the upstream traffic, the scope of downstream traffic is immediate."}, {"title": "Scalar version: multi-hop pressure for a single link", "content": "To gently guide the reader step-by-step, we first review the vanilla version of traffic pressure, then demonstrate how to extend it to higher-hop upstream versions."}, {"title": "Pressure with 0-hop Upstream:", "content": "Adopted from physics, the existing standard traffic pressure [4] is defined as the difference between immediate upstream queue length and the summation of immediate downstream queue lengths weighted by turning ratios. Mathematically, for a link l, its pressure with 0-hop upstream is:\n$p(l, 0) = Q(l) - \\Sigma_{j \\in N_a(l,1)} T_{lj}Q(j)$ \\tag{7}\nApparently, 0-hop upstream is myopic in terms of knowing the traffic conditions beyond the link of interest. When considering further neighborhoods, the concept of 0-hop upstream can be extended to multi-hop upstream to account for a wider range of traffic networks, capturing the cumulative effect of traffic congestion in neighboring areas."}, {"title": "Pressure with 1-hop Upstream:", "content": "Compared to pressure with 0-hop upstream, extra traffic information from 1-hop upstream links is integrated. The influence of 1-hop upstream links on the current link I is naturally weighted by the turning ratio from 1-hop upstream links to link 1:\n$p(l, 1) = p(l,0) + \\Sigma_{i_1 \\in N_u (l,1)} T_{i_1l}Q(i_1)$ \\tag{8}\n$= p(l,0) + (P:,l)^T Q$ \\tag{9}"}, {"title": "Pressure with 2-hop Upstream:", "content": "Similarly, the impact of 2-hop upstream links is added upon pressure with 1-hop upstream. The congestion at 2-hop upstream links has less influence than 1-hop upstream links on the current link 1, and is naturally discounted by the turning ratio from 2-hop upstream links to link 1:\n$p(l,2) = p(l,1) + \\Sigma_{i_1 \\in N_u (l,1)} \\Sigma_{i_2 \\in N_u (i_1,1)} T_{i_2i_1} T_{i_1l}Q(i_2)$ \\tag{10}\n= p(l, 1) + [(P^2):,l]Q \\tag{11}"}, {"title": "Pressure with h-hop Upstream:", "content": "To generalize, the impact of h-hop upstream links is added upon pressure with (h - 1)-hop upstream. The decay of influence from h-hop upstream links to link l is captured by the turning ratio from h-hop upstream links to link 1:\n$p(h, l) = p(l, h - 1) + \\Sigma_{i_1 \\in N_u (l,1)} \\Sigma_{i_2 \\in N_u (i_1,1)} \\dots \\Sigma_{i_h \\in N_u (i_{h-1},1)} T_{i_hi_{h-1}}... T_{i_2i_1}T_{i_1l}Q(i_h)$ \\tag{12}\n$= p(l, h - 1) + [(P^h):,l]Q$ \\tag{13}"}, {"title": "Vectorized version: multi-hop pressure for all links", "content": "Unlike the scalar version can only compute pressure for one link at a time, the vectorized version can compute pressures for all links in the traffic network simultaneously. The vectorized form leverages the same recursive principle but in a compact, holistic manner. In addition, the vectorized form accelerates the computation upon implementation compared to iterating over each link in the traffic network:\n$\\mathbf{p(0)} = \\mathbf{Q - PQ}$ \\tag{14}\n$\\mathbf{p(h) = p(h - 1) + (P^h)Q}, h \\in N^+$ \\tag{15}\n$\\mathbf{p(h) = \\Sigma_{h'=0}^h (P^{h'})^T Q - PQ}, h \\in N^+$ \\tag{16}\nFor the proof of the unrolled form in Eq. (16), please refer to the Appendix."}, {"title": "Interpretations of $\\mathbf{P^h}$", "content": "It is noteworthy to articulate the term $\\mathbf{P^h}$ in Eq. (15). Generally speaking, in Markov chain, the entry (i, j) in the h-power of transition matrix $\\mathbf{P^h}$, denoted as $(\\mathbf{P^h})_{ij}$, represents the probability of starting from vertex i and reaching vertex j after h steps of transitions. In the context of a traffic network where entries represent turning ratios, $(\\mathbf{P^h})_{ij}$ represents the probability of a vehicle moving from link i to link j considering all possible paths of h links. That is, link i is one of the h-hop upstream links from link j, i.e., $i \\in N_u (j, h)$.\nh-hop influence: The (i, j) entry, $(\\mathbf{P^h})_{ij}$, is a scalar value that captures the influence that the traffic state of link i has on link j after h-step transitions. It embodies the idea that traffic pressure is not local but can propagate through the network from distant links. This concept is formalized as h-hop upstream link importance in Definition 2.\nDecay of influence over hop: Since $\\mathbf{P^h}$ involves higher powers of P as h increases, the influence on pressure generally diminishes with hop due to the range of turning ratios being [0,1]. This reflects the realistic attenuation of congestion effects over distance in a traffic network.\nPressure contribution: Multiplying $(\\mathbf{P^h})_{ij}$ by $Q_i$ incorporates the current traffic metrics (e.g., queue length) of link i into the pressure calculation at link j. If $Q_i$ is high (indicating congestion), and $(\\mathbf{P^h})_{ij}$ is significant, then link i will contribute substantially to the pressure at link j. The summation of $(\\mathbf{P^h})_{ij}Q_i$ over all h-hop upstream links i is formalized as h-hop upstream potential in Definition 3.\nIndependent contribution: Furthermore, $(\\mathbf{P^h})^T \\mathbf{Q}$ represents the additional pressure exerted on the link of interest due to queues at h-hop upstream that was not accounted for in $\\mathbf{p(h \u2013 1)}$. By adding $(\\mathbf{P^h})^T \\mathbf{Q}$, we isolate the pressure that is specifically due to the h-hop, distinguishing it from the pressure calculated up to h \u2013 1 hops. This distinction is critical in understanding how congestion propagate through the network spatially and temporally, and for designing controllers that can effectively mitigate traffic congestion by considering multi-hop pressures."}, {"title": "Equivalent definition of multi-hop pressure using potentials", "content": "Adopted from physics, another perspective for the pressure is the difference of upstream potential and downstream potential. Before providing definition of potential, we first define h-hop upstream link importance, then using this link importance concept to define potentials."}, {"title": "Definition 2 (h-hop Upstream Link Importance).", "content": "The importance of a h-hop upstream link j to link l, noted as $w_{jl}(h)$, describes how the traffic condition on upstream link j impact link l. We define the importance to be the probability of a vehicle released from upstream link j being present on link l after traveling h links, which is exactly the (j,l) entry of $\\mathbf{P^h}$:\n$w_{jl}(h) = (\\mathbf{P^h})_{jl}$ \\tag{17}"}, {"title": "Definition 3 (h-hop Upstream Potential).", "content": "Given a network graph $G^e = (V^e, E^e)$ of a traffic network, and a link l, its h-hop upstream potential $\\Phi(l, h)$ is a sum over the queue length of link l's h-hop upstream links weighted by the h-hop upstream link importance:\n$\\Phi^{up} (l, h) = \\Sigma_{j \\in N_a (l,h)} w_{jl}(h)Q(j)$ \\tag{18}\n$= \\Sigma_{j \\in N_a (l,h)} (\\mathbf{P^h})_{j l}Q(j)$ \\tag{19}\n= [($\\mathbf{P^h}$):,l]Q, $h \\in N$  (Scalar form) \\tag{20}\n$\\mathbf{\\Phi^{up} (h)} = (\\mathbf{P^h})^T Q, h \\in N$ (Vectorized form) \\tag{21}"}, {"title": null, "content": "Following the introduction of potentials, the equivalent definition of h-hop pressure to Eq. (15) is the difference between cumulative upstream potentials and cumulative downstream potentials from 1-hop to h-hop:"}, {"title": "Definition 4 (Pressure with h-hop Upstream).", "content": "Given a graph $G^e = (V^e, E^e)$, and a link l, its pressure with h-hop upstream p(l, h) is a difference between cumulative h-hop upstream potentials and immediate downstream potentials:\n$p(l, h) = \\Sigma_{h'=0}^h \\Phi^{up} (l, h') - \\Sigma_{j \\in N_a (l,1)} T_{lj}Q(j), h \\in N^+$ (Scalar form) \\tag{22}\n$\\mathbf{p(h)} = \\Sigma_{h'=0}^h \\mathbf{\\Phi^{up} (h')} - \\mathbf{PQ}$ \\tag{23}\n= $\\Sigma_{h'=0}^h (\\mathbf{P^{h'}})^T \\mathbf{Q} - \\mathbf{PQ}, h \\in N^+$ (Vectorized form) \\tag{24}"}, {"title": "Definition 5 (Phase Pressure).", "content": "Given a control plan for an intersection, the phase pressure is defined as the summation of link pressure over all incoming links in the phase \u03b7.\n$p(\\eta) = \\Sigma_{l \\in \\eta} p (l, h)$ \\tag{25}"}, {"title": "Example: pressure with multi-hop upstream calculation on a simplistic traffic network", "content": "In this part, we provide an example of how to calculate pressure with multi-hop upstream for all links simultaneously."}, {"title": null, "content": "To compute the pressure with multi-hop upstream, first, we need to write down the adjacency matrix P for the graph shown in Figure 2b, where the order arrangement of rows and columns corresponds to the link index in ascending order:\nP=\\begin{bmatrix}\n0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & \\frac{1}{3} & 0 & \\frac{2}{3} & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 0 & 0 & 0 & \\frac{3}{4} & 0 & \\frac{1}{4} \\\\\n0 & 0 & 0 & 0 & 0 & \\frac{3}{4} & 0 & 0 & \\frac{1}{4} \\\\\n0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 \\\\\n0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 \\\\\n0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 \\\\\n0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1\n\\end{bmatrix} \\in R^{9x9} \\tag{26}\nThen, we define the vector of normalized queue lengths Q by assuming full congestion at link 0, 1, 2, 3, 4, 6, while the other links do not have queued vehicles. An additional zero value is appended as the last entry for the super sink. Hence, the queue lengths of all traffic links are:\nQ=[1 1 1 1 1 0 1 0 0] $\\in R^9$ \\tag{27}\nTo compute the pressure with multi-hop upstream for all links simultaneously, we leverage Eq. (15) to recursively calculate the pressure:\n$\\mathbf{p(0)} = \\mathbf{Q - PQ} = \\begin{bmatrix} 0 & 0 & 0 & 1 & 0 & 1 & 0 & 0 & 0 \\end{bmatrix} \\in R^9$ \\tag{28}\n$\\mathbf{p(1)} = \\mathbf{p(0)} + (\\mathbf{P^1})^T \\mathbf{Q} = \\begin{bmatrix} 0 & 0 & \\frac{1}{3} & \\frac{2}{3} & \\frac{1}{3} & 2 & 0 & 0 \\end{bmatrix} \\in R^9$ \\tag{29}\n$\\mathbf{p(2)} = \\mathbf{p(1)} + (\\mathbf{P^2})^T \\mathbf{Q} = \\begin{bmatrix} 0 & 0 & \\frac{5}{12} & \\frac{5}{12} & \\frac{11}{12} & \\frac{17}{12} & 1 & 0 & 0 \\end{bmatrix} \\in R^9$ \\tag{30}\n$\\mathbf{p(3)} = \\mathbf{p(2)} + (\\mathbf{P^3})^T \\mathbf{Q} = \\begin{bmatrix} 0 & 0 & \\frac{3}{5} & \\frac{3}{5} & \\frac{7}{12} & \\frac{7}{8} & \\frac{11}{8} & 1 & 0 & 0 \\end{bmatrix} \\in R^9$ \\tag{31}\n$\\mathbf{p(4)} = \\mathbf{p(3)} + (\\mathbf{P^4})^T \\mathbf{Q} = \\begin{bmatrix} 0 & 0 & \\frac{1}{4} & \\frac{1}{4} & \\frac{3}{16} & \\frac{5}{16} & \\frac{7}{16} & 1 & 0 & 0 \\end{bmatrix} \\in R^9$ \\tag{32}\n$\\mathbf{p(h)} = \\mathbf{p(4)}, h \\geq 4, h \\in N$ \\tag{33}"}, {"title": "EXPERIMENTAL SETUP", "content": "The proposed traffic signal control scheme is evaluated using the traffic simulator AIMSUN [38]. Detailed description of the experimental setup in traffic network architecture and the traffic demand are provided in this section."}, {"title": "Tested Scenarios", "content": "Both synthetic and realistic scenarios are tested. When designing scenarios, we provide a wide range of complexity from the simplest scenario to a very complicated one, to verify that our approach works on diverse scenarios.\nThe tested scenarios are designed based on the following research questions:\nRQ1: Does pressure with multi-hop upstream guide agents to allocate longer green times to phases with higher pressure?"}, {"title": "Synthetic Scenarios", "content": "The scenario design breaks down into two parts: traffic network and traffic demand. We designed two (2) traffic networks and three (3) traffic demand saturation levels", "question": "n\u2022 Network 1x2: The simplest network to verify whether the pressure with multi-hop upstream works as expected", "1x3": "Similar to Network 1x2, but this network has three intersections on the arterial road.\nTraffic demands"}]}