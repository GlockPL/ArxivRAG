{"title": "An Explainable Disease Surveillance System for Early Prediction of Multiple Chronic Diseases", "authors": ["Shaheer Ahmad Khan", "Muhammad Usamah Shahid", "Ahmad Abdullah", "Ibrahim Hashmat", "Muddassar Farooq"], "abstract": "This study addresses a critical gap in the healthcare system by developing a clinically meaningful, practical, and explainable disease surveillance system for multiple chronic diseases, utilizing routine EHR data from multiple U.S. practices integrated with CureMD's EMR/EHR system. Unlike traditional systems - using AI Models that use features from patients labs our approach focuses on routinely available data \u2013 like medical history, vitals, diagnoses, and medications - to preemptively assess the risks of chronic diseases in the next year. We trained three distinct models for each chronic disease: prediction models that forecast the risk of a disease 3, 6, and 12 months before a potential diagnosis. We have developed Random Forest models, which were internally validated using the F1 scores and AUROC as the performance metrics, and were further evaluated by a panel of expert physicians for clinical relevance based on the inference grounded in the medical knowledge. Additionally, we discuss our implementation of integrating these models into a practical EMR system. Beyond using Shapely attributes and surrogate models for explainability, we also introduce a new rule engineering framework to enhance the intrinsic explainability of Random Forests.", "sections": [{"title": "1 Introduction", "content": ""}, {"title": "1.1 Background", "content": "Chronic Diseases as defined by the NCI are conditions that last for more than 3 months and can typically be only controlled but not cured. According to the CDC, 60% of adults in the US have at least one chronic disease and 40% have two or more. Chronic Diseases are the leading cause of mortality and disability in the US. 90% of $4.1 trillion of US healthcare expenditures are spent on people with Chronic Diseases and Mental health conditions.\nIn this paper, we use Electronic Health Records (EHR), which hold a large amount of patients' healthcare data including demographics, vitals, diagnoses, and medications. This data is routinely collected during periodic clinical encounters. Consequently, AI models that only use these types of information elements to do an early prediction of the risk of chronic diseases, have a significant intrinsic value and utility."}, {"title": "1.2 Objectives", "content": "As mentioned above, lab investigations are typically conducted when symptoms of chronic diseases are evident and physicians prescribe them to confirm a diagnosis. Consequently, it gets too late for preventive measures; thus, the cost of healthcare increases exponentially.\nIn this study, we utilize routine EHR data from multiple U.S. practices integrated with CureMD's EMR/EHR system to develop a clinically useful, practical, and explainable predictor for multiple chronic diseases, aiming to predict risks one year in advance."}, {"title": "2 Data Overview", "content": "Anonymized and de-identified EHR/EMR data of patients, in compliance with HIPAA, were provided by the provider practices of CureMD for this research. Since this is a retrospective study, we could either consider a single time window for each patient which would have limited the number of patients; or a dynamic window for each patient [18], picking the appropriate encounter given an X-month window to make our feature vector, where X can be 3, 6 or 12 months.\nFor all diseases, adults greater than or equal to 18 years of age were considered for creating training datasets. The patients' count for each disease before splitting are shown in table 1\nExtensive pre-processing was done owing to the noise in the raw EMR data. The pre-processing and model development workflows are summarized in Figure 1. Clinical validation and evaluations were carried out on the validation set, after which only the feature and modeling configurations would be updated. Three different datasets were prepared for each chronic disease corresponding to the timing windows of 3, 6, and 12 months respectively. Each training dataset was prepared by the following method: the"}, {"title": "3 Methodology", "content": "The study size of each disease was limited by the available data in CureMD's EHR system. Subsequently, the pre-processing of data also removed some patients. The final sample sizes for each of the eight diseases before splitting are shown in table 1.\nThe choice of risk predictors (features) started with a literature review which included identification of risk factors, symptoms, and features used in the previous models. After this, all predictors were used to train the risk surveillance models. We then conducted an investigative study with the panel of clinicians to identify the features that are considered \"dependent or derivative\" of some \"independent\" features. The clinicians were of the opinion that the \"independent features\" provide a more plausible explanation; therefore, \u201cdependent features\" should be removed from the feature set. Subsequently, we only used the feature sets that were validated by the panel of physicians.\nThe risk surveillance models use features like vitals (such as BMI, MAP etc), demographics (such as age, and race), previous diagnosis, Elixhauser comorbidity groups, social history (such as smoking history), family history, and medications. All features"}, {"title": "3.1 Analytical Methods", "content": "Since we have had a good number of patients for all selected chronic diseases, therefore, the dataset was split into training, validation, and test sets in a 70:10:20 split. The validation set was used for model selection, feature selection, hyper-parameter tuning, and model evaluation.\nWe trained different types of models (with various combinations of hyperparame- ters) such as Random Forest, Ada Boosted Models, Light Boosted Machine (LGBM), and Extreme Gradient Boosted Machine (XGBM). Finally, the best classifier was cho- sen based on the performance metrics on the validation set. The performance was evalu- ated primarily based on the F1 Score, which is a harmonic mean of Precision and Recall as recommended for the binary classifiers [7].\nSince not-diagnosed/normal patients are present in relatively larger proportions than the diagnosed patients in EHR systems, therefore, under-sampling of normal patients was done, as it increases the prediction accuracy compared to the oversampling that increases the variance [2]. Under-sampling was done such that a 1:1 ratio between di- agnosed and normal patients was ensured (before and after splitting). Apart from the sample size, training and evaluation (validation + test) datasets were created using the same method.\nEach risk surveillance model outputs the probability for diagnosis of an individual chronic disease at a given time point i.e. in summary 24 total predictions are made by our system. We chose this outcome because it represents the risk of developing the disease at that time point. Each model outputs the probability whether a patient might develop the risk of an individual chronic disease."}, {"title": "4 Results", "content": "The risk surveillance models are packaged into an AI system that was integrated with CureMD's application. The system helps clinicians to get real-time risk evaluations of chronic diseases for a patient. The best models were selected based on the results obtained on the validation datasets. The performance metrics for 3, 6 and 12 months are tabulated in tables 2, 3, and 4 respectively."}, {"title": "5 Discussion", "content": "If we take the average of each metric for all eight diseases, across all metrics, the 3 months model shows a superior performance followed by 6 months and 12 months models. This is understandable, as once a patient moves in their disease journey closer to a disease diagnosis, the greater the chances that their feature vector will capture patterns that indicate the onset of the disease. However, the intrinsic value of the 12- month model is the largest, as this helps physicians to consider preventive treatment options, leading to higher value-based care for patients and the healthcare system.\nExcept for the 12-month hypertension and hyperlipidemia models, the F1 score for all other chronic diseases is greater than 75% across 3 models (3, 6, and 12 months), which not only highlights the utility of these risk models, but also underlines the dif- ficulty of predicting hypertension and hyperlipidemia 12 months in advance. Note that the AUROC is greater than 80% across all chronic diseases and for all 3 time points which makes these models valuable tools in decision support assistance, as confirmed by the panel of physicians."}, {"title": "6 Deploying the models", "content": "Integration with EMR system. Figure 2 illustrates the architecture of our current de- ployment \u2013 an API that is hosted locally with the EMR system to enhance security and data privacy. The secure API retrieves patient's information including diagnoses, vitals, and medications from the EMR system. This data is processed to replicate the steps that are used in the model development, creating disease-specific feature vectors according to the configuration."}, {"title": "Explainability", "content": "The interpretability of risk surveillance models, particularly in the healthcare domain, is an important requirement. Clinicians' trust in these models de- pends on how much they trust the reasons for their inferences. Random forests are typically regarded as black-box models; however, we use the tree structure and model- agnostic methods to better explain inferences made for individual patients.\nFigure 3 demonstrates the four types of explanations shown to a physician from within an EMR system that has integrated our risk surveillance models. First, using the Shap library, we determine the important features and present them in a pie chart, showing their relevance in a decision. Second, the risk factors - a subset of the important features that specifically increase the risk of a chronic disease (have a positive contribu- tion) are highlighted in a bar graph. Consequently, a doctor can devise a patient-centered mitigation plan to reduce the risk of each factor, if possible.\nThird, we offer two types of rules for a detailed explanation of how our models ar- rive at their decisions. Initially, we use a surrogate decision tree, an interpretable model trained to approximate the behavior of the random forest. Our surrogate decision trees are limited to a maximum depth of 10, and trained on a subset of the most important"}, {"title": "7 Conclusion", "content": "Our study introduces a clinically useful risk surveillance system capable of predicting multiple chronic diseases 3, 6, and 12 months in advance. Currently, the models have been evaluated using datasets exclusively from CureMD partner practices. For broader"}, {"title": "Algorithm 1 Extract Simplified Explanation Rules from Random Forest", "content": "applicability, further evaluation with diverse electronic health record (EHR) datasets is essential to verify the models' generalizability.\nMoving forward, we aim to broaden the scope of diseases covered and extend the prediction timeline, enhancing the system's utility for real-world applications. We also plan to enlarge our panel of clinicians to strengthen the validation process, ensuring more robust and comprehensive model assessments.\nIn summary, we have developed a practical, explainable, and clinically useful dis- ease risk surveillance system for the early prediction of eight chronic diseases. This system addresses a significant gap in healthcare by enabling clinicians to implement preventive measures, thus offering quality-based care that potentially reduces the need for treatments with significant side effects. An emphasis on lifestyle and dietary mod- ifications, inspired by the predictions and explanations from our system would miti- gate healthcare costs and allow savings to be reallocated. Additionally, large healthcare entities like the NHS could utilize the identified risk factors to generate Real-World Evidence (RWE) of chronic disease onset, aiding in strategic healthcare planning and budget allocation. These eight chronic diseases represent more than 80% of the patient population suffering from chronic conditions, underscoring the substantial impact of our study."}]}