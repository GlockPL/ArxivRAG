{"title": "SCIsegV2: A Universal Tool for Segmentation of Intramedullary Lesions in Spinal Cord Injury", "authors": ["Enamundram Naga Karthik", "Jan Valo\u0161ek", "Lynn Farner", "Dario Pfyffer", "Simon Schading-Sassenhausen", "Anna Lebret", "Gergely David", "Andrew C. Smith", "Kenneth A. Weber II", "Maryam Seif", "RHSCIR Network Imaging Group", "Patrick Freund", "Julien Cohen-Adad"], "abstract": "Spinal cord injury (SCI) is a devastating incidence leading to permanent paralysis and loss of sensory-motor functions potentially resulting in the formation of lesions within the spinal cord. Imaging biomarkers obtained from magnetic resonance imaging (MRI) scans can predict the functional recovery of individuals with SCI and help choose the optimal treatment strategy. Currently, most studies employ manual quantification of these MRI-derived biomarkers, which is a subjective and tedious task. In this work, we propose (i) a universal tool for the automatic segmentation of intramedullary SCI lesions, dubbed SCIsegV2, and (ii) a method to automatically compute the width of the tissue bridges from the segmented lesion. Tissue bridges represent the spared spinal tissue adjacent to the lesion, which is associated with functional recovery in SCI patients. The tool was trained and validated on a heterogeneous dataset from 7 sites comprising patients from different SCI phases (acute, sub-acute, and chronic) and etiologies (traumatic SCI, ischemic SCI, and degenerative cervical myelopathy). Tissue bridges quantified automatically did not significantly differ from those computed manually, suggesting that the proposed automatic tool can be used to derive relevant MRI biomarkers. SCIsegV2 and the automatic tissue bridges computation are open-source and available in Spinal Cord Toolbox (v6.4 and above) via the sct_deepseg -task seg_sc_lesion_t2w_sci and sct_analyze_lesion functions, respectively.", "sections": [{"title": "1 Introduction", "content": "Traumatic and non-traumatic spinal cord injuries (SCI) represent damage to the spinal cord (SC) with severe consequences, including weakness and paralysis in patients [4]. Traumatic SCI arises from sudden physical impacts, such as car accidents or falls, while non-traumatic SCI can be caused by ischemia (ischemic SCI) or chronic mechanical compression of the SC (degenerative cervical myelopathy, DCM) [4,1]. Both traumatic and non-traumatic SCI commonly involve intramedullary lesions, which are critical areas of tissue damage within the SC. Magnetic resonance imaging (MRI) is routinely used to provide information on the extent and the location of these intramedullary lesions [4,5,22]. Importantly, MRI scans can also be used to compute quantitative biomarkers, such as midsagittal tissue bridges [8]. These help in quantifying the amount of preserved SC neural tissue (carrying motor and sensory information to and from the brain) and have been found to predict functional recovery in patients with traumatic and non-traumatic SCI [8,16,17,20,23,18]."}, {"title": "2 Materials and Methods", "content": null}, {"title": "2.1 Dataset", "content": "We used T2-weighted (T2w) MRI images with heterogeneous image resolutions (isotropic, sagittal, and axial) and magnetic field strengths (1.0T, 1.5T, and 3.0T) from seven sites. The number of patients from each site is as follows: {site 1: (n = 154), site 2: (n = 80), site 3: (n = 14), site 4: (n = 11), site 5: (n = 23), site 6: (n = 4), site 7: (n = 5)}. Site 1 contained patients with both traumatic (n = 97) and non-traumatic SCI (mainly, DCM) (n = 57). Sites 2 & 3 included both preoperative and postoperative traumatic SCI, while sites 4 to 7 included only acute preoperative traumatic SCI. The timing of the MRI examination in relation to injury for traumatic SCI patients from sites 1, 2, and 3 is detailed in Table 1 of [14]. Eight patients from site 1 were followed up with additional MRI examinations, and 40 patients from site 1 had both sagittal and axial T2w images. Patients from sites 1 & 2 were split according to 80-20% train/test ratio. Due to the relatively small size of some datasets, we decided to use sites 3, 5 & 6 entirely for training and kept the patients from sites 4 & 7 as held-out (unseen) test sets to evaluate the model's generalization performance. The model was trained on a total of 281 T2w images and tested on 75 images. The ground truth masks of intramedullary lesions appearing as T2w signal abnormalities were manually annotated by expert raters at individual sites [14]. The SC masks were automatically segmented using the sct_deepseg_sc [6] algorithm and manually corrected when necessary."}, {"title": "2.2 SCIsegV2", "content": "We used nnUNet [10] as the backbone architecture for the SCI lesion segmentation model. The continuing dominance of nnUNet [10,9] across several open-source challenges has shown that a well-tuned convolutional neural network (CNN) architecture is robust and continues to achieve state-of-the-art results over novel (and more sophisticated) transformer-based architectures in dense pixel prediction tasks such as image segmentation.\nSimilar to the recent work building upon the nnUNet framework [21,11], we experimented with its easy-to-tweak trainers for developing SCIsegV2. Specifically, we used: (i) nnUNetTrainer, the default model, and (ii) nnUNetTrainerDA5, the model applying aggressive data augmentation. The augmentation methods in"}, {"title": "2.3 Automatic Quantification of Tissue Bridges", "content": "The manual measurement of tissue bridges is performed on a single midsagittal slice of a volumetric (3D) T2w MRI image [8,24,17,19,20,16,23,18] (Figure 2A). The midsagittal slice is defined as the middle slice of all slices where the SC is visible (Figure 2B). Ventral and dorsal tissue bridges are quantified as the width of spared tissue at the minimum distance from the intramedullary lesion edge to the boundary between the SC and cerebrospinal fluid (Figure 2C).\nTo automate the measurement of tissue bridges, we propose a method that computes ventral and dorsal tissue bridges utilizing the lesion and SC segmentation masks. To compensate for different neck positions and, consequently, different SC curvatures, we use angle correction, which adjusts the tissue bridge widths with respect to the SC centerline [7]. The method computes tissue bridges from all sagittal slices containing the lesion, allowing quantification of not only midsagittal but parasagittal tissue bridges as well. For the purpose of this study (and to compare against existing manual measurements based on midsagittal tissue bridges), we considered only the midsagittal slice for the automatic measurement of the tissue bridges."}, {"title": "2.4 Experiments", "content": "We divided our experiments into 3 categories to investigate the effects of input types, data augmentation strategies and SCI etiology-specific models. All images"}, {"title": "4 Discussion", "content": "In this work, we proposed SCIsegV2, a DL-based universal tool for the segmentation of intramedullary lesions across different SCI etiologies and phases. We also automated the calculation of midsagittal tissue bridges, a metric representing spared spinal tissue adjacent to the lesion. This metric is relevant as it is associated with functional recovery in individuals with SCI. Both SCIsegV2 and the automatic tissue bridges computation are open-source and available in Spinal Cord Toolbox (v6.4 and above) via the sct_deepseg -task seg_sc_lesion_t2w_sci and sct_analyze_lesion functions, respectively.\nThe heterogeneity in the appearance of intramedullary lesions across different SCI phases (acute, sub-acute, chronic) and etiologies (traumatic SCI, ischemic SCI, DCM) makes lesion segmentation extremely challenging, even for trained radiologists. Relatively low prevalence of traumatic SCI and the need for early surgical intervention [1] result in a low number of preoperative MRI scans, which adds to the difficulty in training a robust automatic segmentation model, that performs well on \"real world\" clinical data across multiple sites. Moreover, MRI scans of individuals with chronic SCI frequently exhibit image distortions caused by metallic implants, further complicating the segmentation process.\nAs a way of simplifying the lesion segmentation problem, using the SC mask to explicitly guide the model towards the cord showed improved results on certain etiologies. However, it introduced a dependency on the SC mask to be concatenated to the input image, preventing a smooth transition from the model's automatic predictions to the computation of tissue bridges, which requires both the cord and lesion masks. In contrast, the SCIsegV2_single model capable of segmenting both SC and lesions has a higher utility as it is also applicable in scenarios where SC masks are unavailable. Lastly, as the lesion appearance"}, {"title": "Limitations and Future Work", "content": "One limitation of the model is its higher sensitivity to traumatic SCI lesions, as approximately (~ 70%) of our dataset consists of this population. This skew is due to the relatively low availability of acute preoperative SCI scans. Acquiring additional data in SCI is generally challenging, but is possible with the help of ongoing clinical trials and consortiums for creating large databases for SCI research [15,3]. While this work used a relatively small and unbalanced cohort, we presented a preliminary proof-of-concept toward a universal tool for SCI lesion segmentation. The current literature only quantifies tissue bridges manually, from a single midsagittal slice. However, as lesions are 3D blob-like objects, the midsagittal slice might not necessarily contain the largest portions of the lesion and does not consider parasagittally running fiber tracts. Therefore, combining both parasagittal and midsagittal slices could provide a comprehensive evaluation of the width of the spared tissue bridges."}, {"title": "Prospect of application", "content": "Automatic segmentation of the lesions and spinal cord could mitigate the bottleneck and inter-rater variability associated with manual annotations. Automating the measurements of tissue bridges could provide an objective, unbiased way in guiding rehabilitation decision making and stratifying patients into homogeneous subgroups of recovery in clinical trials."}]}