{"title": "DiReCT: Diagnostic Reasoning for Clinical Notes via Large Language Models", "authors": ["Bowen Wang", "Jiuyang Chang", "Yiming Qian", "Guoxin Chen", "Junhao Chen", "Zhouqiang Jiang", "Jiahao Zhang", "Yuta Nakashima", "Hajime Nagahara"], "abstract": "Large language models (LLMs) have recently showcased remarkable capabilities, spanning a wide range of tasks and applications, including those in the medical domain. Models like GPT-4 excel in medical question answering but may face challenges in the lack of interpretability when handling complex tasks in real clinical settings. We thus introduce the diagnostic reasoning dataset for clinical notes (DiReCT), aiming at evaluating the reasoning ability and interpretability of LLMs compared to human doctors. It contains 511 clinical notes, each meticulously annotated by physicians, detailing the diagnostic reasoning process from observations in a clinical note to the final diagnosis. Additionally, a diagnostic knowledge graph is provided to offer essential knowledge for reasoning, which may not be covered in the training data of existing LLMs. Evaluations of leading LLMs on DiReCT bring out a significant gap between their reasoning ability and that of human doctors, highlighting the critical need for models that can reason effectively in real-world clinical scenarios *.", "sections": [{"title": "1 Introduction", "content": "Recent advancements of large language models (LLMs) [Zhao et al., 2023] have ushered in new possibilities and challenges for a wide range of natural language processing (NLP) tasks [Min et al., 2023]. In the medical domain, these models have demonstrated remarkable prowess [Anil et al., 2023, Han et al., 2023], particularly in medical question answering (QA) [Jin et al., 2021]. Leading-edge models, such as GPT-4 [OpenAI, 2023a], exhibit profound proficiency in understanding and generating text [Bubeck et al., 2023], even achieved high scores on the United States Medical Licensing Examination (USMLE) questions [Nori et al., 2023].\nDespite the advancements, interpretability is critical, particularly in medical NLP tasks [Li\u00e9vin et al., 2024]. Some studies assess this capability over medical QA [Pal et al., 2022, Li et al., 2023, Chen et al., 2024] or natural language inference (NLI) [Jullien et al., 2023]. Putting more attention on interpretability, they use relatively simple tasks as testbeds, taking short text as input. However,\ntasks in real clinical settings can be more complex [Gao et al., 2023a]. As shown in Figure 1, a typical diagnosis requires comprehending and combining various information, such as health records, physical examinations, and laboratory tests, for further reasoning of possible diseases in a step-by-step manner following the established guidelines. This observation suggests that both perception, or reading, (e.g., finding necessary information in medical record) and reasoning (determining the disease based on the observations) should be counted when evaluating interpretability in LLM-based medical NLP tasks.\nFor a more comprehensive evaluation of LLMs for supporting diagnosis in a more realistic setting, we propose a Diagnostic Reasoning dataset for Clinical noTes (DiReCT). The task basically is predicting the diagnosis from a clinical note of a patient, which is a collection of various medical records, written in natural language. Our dataset contains 511 clinical notes spanning 25 disease categories, sampled from a publicly available database, MIMIC-IV [Johnson et al., 2023]. Each clinical note undergoes fine-grained annotation by professional physicians. The annotators (i.e., the physicians) are responsible for identifying the text, or the observation, in the note that leads to a certain diagnosis, as well as the explanation. The dataset also provides a diagnostic knowledge graph based on existing diagnostic guidelines to facilitate more consistent annotations and to supply a model with essential knowledge for reasoning that might not be encompassed in its training data.\nTo underscore the challenge offered by our dataset, we evaluate a simple AI-agent based baseline [Xi et al., 2023, Tang et al., 2023] that utilizes the knowledge graph to decompose the diagnosis into a sequence of diagnoses from a smaller number of observations. Our experimental findings indicate that current state-of-the-art LLMs still fall short of aligning well with human doctors.\nContribution. DiReCT offers a new challenge in diagnosis from a complex clinical note with explicit knowledge of established guidelines. This challenge aligns with a realistic medical scenario that doctors are experiencing. In the application aspect, the dataset facilitates the development of a model to support doctors in diagnosis, which is error-prone [Middleton et al., 2013, Liu et al., 2022]. From the technical aspect, the dataset can benchmark models' ability to read long text and find necessary observations for multi-evidence entailment tree reasoning. As shown in Figure 3, this is not trivial because of the variations in writing; superficial matching does not help, and medical knowledge is vital. Meanwhile, reasoning itself is facilitated by the knowledge graph. The model does not necessarily have the knowledge of diagnostic guidelines. With this choice, the knowledge graph explains the reasoning process, which is also beneficial when deploying such a diagnosis assistant system in practical uses."}, {"title": "2 Related Works", "content": "Natural language explanation. Recent advancements in NLP have led to significant achieve-ments [Min et al., 2023]. However, existing models often lack explainability, posing potential risks [Danilevsky et al., 2020, Gurrapu et al., 2023]. Numerous efforts have been made to address this challenge. One effective approach is to provide a human-understandable plain text explanation alongside the model's output [Camburu et al., 2018, Rajani et al., 2019]. Another strategy involves identifying evidence within the input that serves as a rationale for the model's decisions, aligning with human reasoning [DeYoung et al., 2020]. Expanding on this concept, [Jhamtani and Clark, 2020] introduces chain-structured explanations, given that a diagnosis can demand multi-hop reasoning. This idea is further refined by ProofWriter [Tafjord et al., 2021] through a proof stage for explanations,"}, {"title": "3 A benchmark for Clinical Notes Diagnosis", "content": "This section first detail clinical notes (Section 3.1). We also describes the knowledge graph that encodes existing guidelines (Section 3.2). Our task definition, which tasks a clinical note and the knowledge graph as input is given in Section 3.4. We then present our annotation process for clinical notes (Section 3.3) and the evaluation metrics (Section 3.5)."}, {"title": "3.1 Clinical Notes", "content": "Clinical notes used in DiReCT are stored in the SOAP format [Weed, 1970]. A clinical note comprises four components: In the subjective section, the physician records the patient's chief complaint, the history of present illness, and other subjective experiences reported by the patient. The objective section contains structural data obtained through examinations (inspection, auscultation, etc.) and other measurable means. The assessment section involves the physician's analysis and evaluation of the patient's condition. This may include a summary of current status, etc. Finally, the plan section outlines the physician's proposed treatment and management plan. This may include prescribed medications, recommended therapies, and further investigations. A clinical note also includes a primary discharge diagnosis (PDD) in the assessment section.\nDiReCT's clinical notes are sourced from the MIMIC-IV dataset [Johnson et al., 2023] (PhysioNet Credentialed Health Data License 1.5.0), which encompasses over 40,000 patients admitted to the intensive care units. Each note contains clinical data for a patient. To construct DiReCT, we curated a subset of 511 notes whose PDDs fell within one of 25 disease categories i in 5 medical domains.\nIn our task, a note $R = \\{r\\}$ is an excerpt of 6 clinical data in the subjective and objective sections (i.e.,"}, {"title": "3.2 Diagnostic Knowledge Graph", "content": "Existing knowledge graphs for the medical domain, e.g., UMLS KG [Bodenreider, 2004], lack the ability to provide specific clinical decision support (e.g., diagnostic threshold, context-specific data, dosage information, etc.), which are critical for accurate diagnosis.\nOur knowledge graphs $K = \\{K_i\\}_i$ is a collection of graph $K_i$ for disease category i. $K_i$ is based on the diagnosis criteria in existing guidelines (refer to supplementary material for details). $K_i$'s nodes are either premise $p \\in P_i$ (medical statement, e.g., Headache is a symptom of) and diagnoses $d \\in D_i$ (e.g., Suspected Stroke). $K_i$ consists of two different types of edges. One is premise-to-diagnosis edges $S_i = \\{(p,d)\\}$, where $p \\in P_i$ and $d \\in D_i$; an edge is from p to d. This edge represents the necessary premise p to make a diagnosis d. We refer to them as supporting edges. The other is diagnosis-to-diagnosis edges $F_i = \\{(d,d')\\}$, where $d, d' \\in D_i$ and the edge is from d to d', which represents the diagnostic flow. These edges are referred to as procedural edges.\nA disease category is defined according to an existing guideline, which starts from a certain diagnosis; therefore, a procedural graph $G_i = (D_i, F_i)$ has only one root node and arbitrarily branches toward multiple leaf nodes that represent PDDs (i.e., the clinical notes in DiReCT are chosen to cover all leaf nodes of $G_i$). Thus, $G_i$ is a tree. We denote the set of the leaf nodes (or PDDs) as $D'_i \\subset D_i$. The knowledge graph is denoted by $K_i = (D_i, P_i, S_i, F_i)$."}, {"title": "3.3 Data Annotation", "content": "Let $d^* \\in D$ denote the PDD of disease category i associated with R. We can find a subgraph $K_i(d^*)$ of $K_i$ that contains all ancestors of $d^*$, including premises in $P_i$. We also denote the set of supporting edges in $K_i(d^*)$ as $S_i(d^*)$. Our annotation process is, for each supporting edge $(p, d) \\in S_i(d^*)$, to extract observation $o \\in O$ in R (highlighted text in the clinical note in Figure 3) and provide rationalization z of this deduction why o is a support for d or corresponds to p. They form the explanation $E = \\{(o, z,d)\\}$ for $(R, d^*)$. This annotation process was carried out by 9 clinical physicians and subsequently verified for accuracy and completeness by three senior medical experts."}, {"title": "3.4 Task Definition", "content": "We propose two tasks with different levels of supplied external knowledge. The first task is, given R and G, to predict the associated PDD $d^*$ and generate an explanation $\u00ca$ that explains the model's diagnostic procedure from R to $d^*$, i.e., letting M denote a model:\n$\\hat{d}^*, \u00ca = M(R,G), \\qquad (1)$\nwhere $\\hat{d}^* \\in \\cup_i D$ and $\u00ca$ are predictions for the PDD and explanation, respectively. With this task, the knowledge of specific diagnostic procedures in existing guidelines can be used for prediction, facilitating interpretability. The second task takes K as input instead of G, i.e.,:\n$\\hat{d}^*, \u00ca = M(R,K). \\qquad (2)$\nThis task allows for the use of broader knowledge of premises for prediction. One may also try a task without any external knowledge."}, {"title": "3.5 Evaluation Metrics", "content": "We designed three metrics to quantify the predictive performance over our benchmark.\n(1) Accuracy of diagnosis $Acc_{diag}$ evaluates if a model can correctly identify the diagnosis. $Acc_{diag}= 1$ if $d^* = d$, and $Acc_{diag} = 0$ otherwise. The average is reported.\n(2) Completeness of observations $Obs_{comp}$ evaluates whether a model extracts all and only necessary observations for the prediction. Let O and \u00d4 denote the sets of observations in E and \u00ca, respectively. The metric is defined as $Obs_{comp} = |O \\cap \u00d4|/|O \\cup \u00d4|$, where the numerator is the number of observations that are common in both O and \u00d4. This metric simultaneously evaluates the correctness of each observation and the coverage. To supplement it, we also report the precision $Obs_{pre}$ and recall $Obs_{rec}$, given by $Obs_{pre} = |O \\cap \u00d4|/|\u00d4|$ and $Obs_{rec} = |O \\cap \u00d4|/|O|$.\n(3) Faithfulness of explanations Faith evaluates if the diagnostic flow toward the PDD is fully supported by observations with faithful rationalizations. This involves establishing a one-to-one cor-respondence between deductions in the prediction and the ground truth. We use the correspondences established for computing $Obs_{comp}$. Let $o \\in O$ and $\\hat{o} \\in \\hat{O}$ denote corresponding observations."}, {"title": "4 Baseline", "content": "Figure 4 shows an overview of our baseline with three LLM-based modules narrowing-down, perception, and reasoning (refer to the supplementary material for more details). The narrowing-down module U takes R as input to make a prediction i of the disease category, i.e., $i = U(R)$.\nLet $d_t \\in D$ be the diagnosis that has been reached with t iterations over $K_i$, where t corresponds to the depth of node $d_t$ and so is less than or equal to the depth of $K_i$. $d_0$ is the root node of $K_i$. For $d_0$, we apply the perception module to extract all observations in R and explanation $\u00ca_0$ to support $d_0$ as\n$\\hat{O}, \u00ca_0 = W(d_0, K_i). \\qquad (3)$\nK is supplied to facilitate the model to extract all observations for the following reasoning process.\nDiagnosis $d_t$ identifies the set $\\{d_n\\}_n$ of its children and so the set $P_i(\\{d_n\\}_n) = \\{p \\in P_i|(p, d_n) \\in S_i, d_n \\in \\{d_n\\}\\}$ of premises that support $d_n$. Therefore, our reasoning module V iteratively and greedily identifies the next step's diagnosis (i.e., $d_{t+1}$) from $\\{d_n\\}_n$, making a rationalization for each deduction. That is, V verifies whether there exist o's in \u00d4 that supports one $d_n$. If $d_n$ is fully supported, $d_n$ is identified as $d_{t+1}$ for the (t + 1)-th iteration, i.e.,\n$d_{t+1}, \u00ca_{t+1} = V(\\hat{O}, \\{d_n\\}, P_i(\\ {d_n\\}_n)). \\qquad (4)$\nOtherwise, the reasoning module fails. V is repeated until $d_1$ in D is found or it fails. In our annotation, each observation contributes to deducing only one $d_t$. Therefore, if an observation in $\u00ca_{t+1}$ is included in the preceding sets of explanations $\u0109_0$ to $\u00ca_t$, the corresponding explanation in the preceding sets is removed."}, {"title": "5 Experiments", "content": "5.1 Experimental Setup\nWe assess the reasoning capabilities of 7 recent LLMs from diverse families and model sizes, including 5 instruction-tuned models that are openly accessible: LLama3 8B and 70B [AI@Meta, 2024], Zephyr 7B [Tunstall et al., 2023], Mistral 7B [Jiang et al., 2023], and Mixtral 8\u00d77B [Jiang et al., 2023]. We have also obtained access to private versions of the GPT-3.5 turbo [OpenAI, 2023b]"}, {"title": "5.2 Results", "content": "Comparison among LLMs. Table 3 shows the performance of our baseline built on top of various LLMs. We first evaluate a variant of our task that takes graph G = {G} consisting of only procedural flow as external knowledge instead of K. Comparison between G and K demonstrates the importance of supplying premises with the model and LLMs' capability to make use of extensive external knowledge that may be superficially different from statements in R. Subsequently, some models are evaluated with our task using K. In addition to the metrics in Section 3.5, we also adopt the accuracy of disease category $Acc_{cat}$, which gives 1 when \u00ec = i, as our baseline's performance depends on it.\nWith G, we can see that GPT-4 achieves the best performance in most metrics, especially related to observations and explanations, surpassing LLama3 70B by a large margin. In terms of accuracy (in both category and diagnosis levels), LLama3 70B is comparable to GPT-4. LLama3 70B also has a higher $Obs_{rec}$ but low $Obs_{pre}$ and $Obs_{comp}$, which means that this model tends to extract many observations. Models with high diagnostic accuracy are not necessarily excel in finding essential information in long text (i.e., observations) and generating reasons (i.e., explanations).\nWhen K is given, all models show better diagnostic accuracy (except GPT-3.5) and explanations, while observations are slightly degraded. GPT-4 with K enhances $Acc_{diag}$, $Exp_{com}$, and $Exp_{all}$ scores. This suggests that premises and supporting edges are beneficial for diagnosis and explanation. Lower observational performance may indicate that the models lack the ability to associate premises and text in R, which are often superficially different though semantically consistent.\nLLMs may undergo inherent challenges for evaluation when no external knowledge is supplied. They may have the knowledge to diagnose but cannot make consistent observations and explanations that our task expects through K. To explore this, we evaluate two settings: (1) giving $D^*$ and (2) no knowledge is supplied to a model (shown in Table 4). The prompts used for this setup are detailed in the supplementary material. We do not evaluate the accuracy of disease category prediction as it is basically the same as Table 3. We can clearly see that with $D^*$, GPT-4's diagnostic and observational scores are comparable to those of the task with K, though explanatory performance is much worse. Without any external knowledge, the diagnostic accuracy is also inferior. The deteriorated performance can be attributed to inconsistent wording of diagnosis names, which makes evaluation tough. High observational scores imply that observations in R can be identified without relying on external knowledge. There can be some cues to spot them.\nPerformance in individual domains. Figure 5 summarizes the performance of LLama3 70B, GPT-3.5, and GPT-4 across different medical domains, evaluated using $Acc_{cat}$, $Obs_{comp}$, and $Exp_{all}$. Neurology gives the best diagnostic accuracy, where GPT-4 achieved an accuracy of 0.806. LLama3 also performed well (0.786). In terms of $Obs_{comp}$ and $Exp_{all}$, GPT-4's results were 0.458 and 0.340, respectively, with the smallest difference between the two scores among all domains. This smaller gap indicates that in Neurology, the common observations in prediction and ground truth lead to the correct diagnoses with faithful rationalizations. However, GPT-4 yields a higher diagnostic accuracy score while a lower explanatory score, suggesting that the observations captured by the model or their rationalizations differ from human doctors.\nFor Cardiology and Endocrinology, the diagnostic accuracy of the models is relatively low (GPT-4 achieved 0.458 and 0.468, respectively). Nevertheless, $Obs_{comp}$ and $Exp_{all}$ are relatively high. Endocrinology results in lower diagnostic accuracy and higher explanatory performance. A smaller gap may imply that in these two domains, successful predictions are associated with observations similar to those of human doctors, and the reasoning process may be analogous. Conversely, in Gastroenterology, higher $Acc_{cat}$ is accompanied by lower $Obs_{comp}$ and $Exp_{all}$ (especially for LLama3), potentially indicating a significant divergence in the reasoning process from human doctors. Overall, DiReCT demonstrates that the degree of alignment between the model's diagnostic reasoning ability and that of human doctors varies across different medical domains.\nReliability of automatic evaluation. We randomly pick out 100 samples from DiReCT and their prediction by GPT-4 over the task with G to assess the consistency of our automated metrics to evaluate the observational and explanatory performance in Section 3.3 to human judgments. Three physicians joined this experiment. For each predic-tion \u00f4 \u2208 \u00d4, they are asked to find a similar observation in ground truth O. For explanatory metrics, they verify if each prediction z \u2208 \u00ca for \u00f4 \u2208 \u00d4 align with ground-truth z \u2208 E corresponding to o. A prediction and a ground truth are deemed aligned for both assessments if at least two specialists agree. We compare LLama3's and GPT-4's judgments to explore if there is a gap between these LLMs. As summarized in Table 5, GPT-4 achieves the best results, with LLama3 8B also displaying a similar performance. From these results, we argue that our automated evaluation"}, {"title": "6 Conclusion and Limitations", "content": "We proposed DiReCT as the first benchmark for evaluating the diagnostic reasoning ability of LLMs with interpretability by supplying external knowledge as a graph. Our evaluations reveal a notable disparity between current leading-edge LLMs and human experts, underscoring the urgent need for AI models that can perform reliable and interpretable reasoning in clinical environments. DiReCT can be easily extended to more challenging settings by removing the knowledge graph from the input, facilitating evaluations of future LLMs.\nLimitations. DiReCT encompasses only a subset of disease categories and considers only one PDD, omitting the inter-diagnostic relationships due to their complexity\u2014a significant challenge even for human doctors. Additionally, our baseline may not use optimal prompts, chain-of-thought reasoning, or address issues related to hallucinations in task responses. Our dataset is solely intended for model evaluation but not for use in clinical environments. The use of the diagnostic knowledge graph is also limited to serving merely as a part of input. Future work will focus on constructing a more comprehensive disease dataset and developing an extensive diagnostic knowledge graph."}, {"title": "A Details of DiReCT", "content": "A.1 Data Statistics\nTable 6: Disease statistics of DiReCT.\nDomains\nCategories\n#samples\nDi\nD\nReferences\nAcute Coronary Syndromes\n65\n6\n3\n\nAortic Dissection\n14\n3\n2\n\nAtrial Fibrillation\n10\n3\n2\n\nCardiology\nCardiomyopathy\n9\n5\n4\n\nHeart Failure\n52\n6\n3\n\nHyperlipidemia\n2\n2\n1\n\nHypertension\n32\n2\n1\n\nGastritis\n27\n5\n3\n\nGastroenterology\nGastroesophageal Reflux Disease\n41\n2\n1\n\nPeptic Ulcer Disease\n28\n3\n2\n\nUpper Gastrointestinal Bleeding\n7\n2\n1\n\nAlzheimer\n10\n2\n1\n\nEpilepsy\n8\n3\n2\n\nNeurology\nMigraine\n4\n3\n2\n\nMultiple Sclerosis\n27\n6\n4\n\nStroke\n28\n3\n2\n\nAsthma\n13\n7\n5\n\nCOPD\n19\n6\n4\n\nPulmonology\nPneumonia\n20\n4\n2\n\nPulmonary Embolism\n35\n5\n3\n\nTuberculosis\n5\n3\n2\n\nAdrenal Insufficiency\n20\n4\n3\n\nDiabetes\n13\n4\n2\n\nEndocrinology\nPituitary\n12\n4\n3\n\nThyroid Disease\n10\n6\n4\n\nTable 6 provides a detailed breakdown of the disease categories included in DiReCT. The column labeled # samples indicates the number of data points. The symbols |Di and |D| denote the total number of diagnoses (diseases) and PDDs, respectively. Existing guidelines for diagnosing diseases were used as References, forming the foundation for constructing the diagnostic knowledge graphs. As some premise may not included in the referred guidelines. During annotation, physicians will incorporate their own knowledge to complete the knowledge graph."}, {"title": "A.2 Structure of Knowledge Graph", "content": "The entire knowledge graph, denoted as K, is stored in separate JSON files, each corresponding to a specific disease category i as Ki. Each Ki comprises a procedural graph Gi and the corresponding premise p for each disease. As illustrated in Figure 7, the procedural graph Gi is stored under the key \"Diagnostic\" in a dictionary structure. A key with an empty list as its value indicates a leaf diagnostic node as d*. The premise for each disease is saved under the key of \"Knowledge\" with the corresponding disease name as an index. For all the root nodes (e.g., Suspected Heart Failure), we further divide the premise into \"Risk Factors\", \"Symptoms\", and \"Signs\". Note that each premise is separated by \";\"."}, {"title": "A.3 Annotation and Tools", "content": "We have developed proprietary software for annotation purposes. As depicted in Figure 8, annotators are presented with the original text as observations o and are required to provide rationales (z) to explain why a particular observation o supports a disease d. The left section of the figure, labeled Input1 to Input6, corresponds to different parts of the clinical note, specifically the chief complaint, history of present illness, past medical history, family history, physical exam, and pertinent results, respectively. Annotators will add the raw text into the first layer by left-clicking and dragging to select the original text, then right-clicking to add it. After each observation, a white box will be used to record the rationales. Finally, a connection will be made from each rationale to a disease,"}, {"title": "A.4 Access to DiReCT", "content": "Implementation code and annotation tool are available through https://github.com/wbw520/DiReCT. Data will be released through PhysioNet due to safety issues according to the license of MIMIC-IV (PhysioNet Credentialed Health Data License 1.5.0). We will use the same license for DiReCT. The download link will be accessible via GitHub. We confirm that this GitHub link and data link are always accessible. We confirm that we will bear all responsibility in case of violation of rights."}, {"title": "B Implementation of Baseline Method", "content": "B.1 Prompt Settings\nIn this section, we demonstrate the prompt we used for each module (From Table 7-9 for narrowing-down, perception, and reasoning module, respectively).\nIn Table 7, {disease_option} is the name for all disease categories, and {note} is the content for the whole clinical note. The response for the model is the name of a possible disease \u00ee.\nIn Table 8, {disease} is the disease category name predicted in narrowing-down. The content marked blue is the premise, which is only provided during the || setting. In this module, {premise} is offered with all information in the knowledge graph. Different to narrowing-down, {note} is implemented for each clinical data R = {r} and the outputs are combined together for \u00d4 and \u00ca.\nIn Table 9, {disease} is the disease category name and {disease_option} is consisted by the children nodes {dn}n. Similarly, the premise on the blue is only available for the || setting. It provides the premise that are criteria for the diagnosis of each children node. {observation} is the extracted \u00d4 in previous step. We provide all the prompts and the complete implementation code on GitHub."}, {"title": "B.2 Details of Automatic Evaluation", "content": "The automatic evaluation is realized by LLama3 8B. We demonstrate the prompt for this implement in Table 10 (for observation) and Table 11 (for rationalization). Note that we do not use few-shot samples for the evaluation of observation. In Table 10, {gt_observation} and {pred_observation} are from model prediction and ground-truth. As this is a simple similarity comparison task to discriminate whether the model finds similar observations to humans, LLama3 itself have such ability. We do not strict to exactly match due to the difference in length of extracted raw text (as long as the observation expresses the same description). In Table 11, {gt_reasoning} and {pred_reasoning} are from model prediction and ground-truth. We require the rationale to be complete (content of the expression can be understood from the rationale alone) and meaningful; therefore, we provide five samples for this evaluation. We also provide all the prompts and the complete implementation code on GitHub."}, {"title": "B.3 Prediction Samples", "content": "Figure 9 and 10 shows two sample generated by GPT-4. The ground-truth PDD of the input clinical note is Gastroesophageal Reflux Disease (GERD) and Heart Failure (HF). In these figure, purple, orange, and red indicate explanations only in the ground truth, only in prediction, and common in both, respectively; therefore, red is a successful prediction of an explanation, while purple and orange are a false negative and false positive."}, {"title": "B.4 Experiments for No Extra Knowledge", "content": "We demonstrate the prompt used for D* and no knowledge settings in Table 12 and Table 13, respectively. {note} is the text of whole clinical note and {note} in Table 12 is the name of all leaf node D*."}, {"title": "B.5 Experimental Settings", "content": "All experiments are implemented with a temperature value of 0. All close sourced models are implemented in a local server with 4 NVIDIA A100 GPU."}, {"title": "C Failed Attempts on DiReCT", "content": "In this section, we discuss some unsuccessful attempts during the experiments.\nExtract observation from the whole clinical note. We try to diagnose the disease and extract observation, and the corresponding rationale using the prompt shown in Table 14. The {note} is"}, {"title": "D Ethical Considerations", "content": "Utilizing real-world EHRs, even in a de-identified form, poses inherent risks to patient privacy. Therefore, it is essential to implement rigorous data protection and privacy measures to safeguard sensitive information, in accordance with regulations such as HIPAA. We strictly adhere to the Data Use Agreement of the MIMIC dataset, ensuring that the data is not shared with any third parties. All experiments are implement on a private server. The access to GPT is also a private version.\nAl models are susceptible to replicating and even intensifying the biases inherent in their training data. These biases, if not addressed, can have profound implications, particularly in sensitive domains such as healthcare. Unconscious biases in healthcare systems can result in significant disparities in the quality of care and health outcomes among different demographic groups. Therefore, it is imperative to rigorously examine AI models for potential biases and implement robust mechanisms for ongoing monitoring and evaluation. This involves analyzing the model's performance across various demographic groups, identifying any disparities, and making necessary adjustments to ensure equitable treatment for all. Continual vigilance and proactive measures are essential to mitigate the risk of biased decision-making and to uphold the principles of fairness and justice in AI-driven healthcare solutions."}]}