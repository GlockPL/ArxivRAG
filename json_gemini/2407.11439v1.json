{"title": "Repurformer: Transformers for Repurposing-Aware Molecule Generation", "authors": ["Changhun Lee", "Gyumin Lee"], "abstract": "Generating as diverse molecules as possible\nwith desired properties is crucial for drug\ndiscovery research, which invokes many ap-\nproaches based on deep generative models\ntoday. Despite recent advancements in these\nmodels, particularly in variational autoen-\ncoders (VAEs), generative adversarial networks\n(GANs), Transformers, and diffusion models,\na significant challenge known as the sample\nbias problem remains. This problem occurs\nwhen generated molecules targeting the same\nprotein tend to be structurally similar, reduc-\ning the diversity of generation. To address this,\nwe propose leveraging multi-hop relationships\namong proteins and compounds. Our model,\nRepurformer, integrates bi-directional pretrain-\ning with Fast Fourier Transform (FFT) and low-\npass filtering (LPF) to capture complex interac-\ntions and generate diverse molecules. A series\nof experiments on BindingDB dataset confirm\nthat Repurformer successfully creates substi-\ntutes for anchor compounds that resemble posi-\ntive compounds, increasing diversity between\nthe anchor and generated compounds.", "sections": [{"title": "Introduction", "content": "The design of valid and novel molecules with\ndesired biological properties, known as de novo\nmolecule generation, is vital to modern drug discov-\nery. Recent advancements in deep generative mod-\nels, particularly variational autoencoders (VAEs)\n(Kingma and Welling, 2022), generative adversar-\nial networks (GANs) (Goodfellow et al., 2014),\nTransformers (Vaswani et al., 2017), and diffusion\nmodels (Ho et al., 2020), have significantly en-\nhanced our ability to generate chemically valid and\nnovel molecules. However, these models need to be\nfurther refined to generate molecules that interact\nwith specific target proteins.\nTarget-specific molecule generation addresses\nthis challenge by producing drug-like molecules\nthat are more likely to bind with specific target\nproteins (Grechishnikova, 2021; Qian et al., 2022;\nTan et al., 2022). Nonetheless, there remains a\nsignificant issue known as the sample bias prob-\nlem, where reliance on existing protein-compound\npairs results in the generation of structurally similar\nmolecules. This phenomenon limits the diversity\nof generated molecules and hinders the discovery\nof novel compounds.\nTo address this, we propose leveraging multi-hop\nrelationships among proteins and compounds to\nexpand the generative space and increase the diver-\nsity of the generated molecules. Our method intro-\nduces the concept of repurposing-aware molecule\ngeneration, designed to identify and utilize latent\nmulti-hop relations within the protein-compound\ninteraction network.\nIn this paper, we present Repurformer, a novel\nmodel that integrates bi-directional pretraining and\nadvanced signal processing techniques to overcome\nthe limitations of existing models. Repurformer\ncaptures complex relationships between proteins\nand compounds by pretraining encoders in both\nprotein-to-compound and compound-to-protein di-\nrections and applying Fast Fourier Transform (FFT)\nwith low-pass filtering (LPF) to the latent space.\nThis approach allows the model to distinguish the\ndifferent scales of interactions. By focusing on low-\nfrequency components, which correspond to the\nlonger propagation through the multi-hop protein-\ncompound interaction network, Repurformer gener-\nates as diverse compounds as possible with desired\nproperties. In summary, the contributions of our\nwork are threefold:\n\u2022 We introduce a framework for repurposing-\naware molecule generation to address the sam-\nple bias problem by leveraging multi-hop re-\nlations between proteins and compounds.\n\u2022 We develop Repurformer, a model that inte-\ngrates a bi-directional pretraining and an FFT-\nbased approach to capture and utilize latent"}, {"title": "Preliminaries", "content": "2.1 De novo Molecule Generation\nDe novo molecule generation is the process of ex-\nploring vast chemical space and producing novel\nmolecules with desired biological properties. With\nthe rapid advancement of artificial intelligence, re-\ncent deep generative models have been widely used\nin molecule generation tasks.\nFor example, several VAE variants have been\nintroduced thanks to its manipulable latent space,\nsuch as charVAE (G\u00f3mez-Bombarelli et al., 2018),\nSD-VAE (Dai et al., 2018), and JT-VAE (Jin\net al., 2018). GAN has been adopted due to their\ncapability to generate new molecules that are\nhighly similar in structure to existing ones, in-\ncluding ORGAN (Guimaraes et al., 2018), OR-\nGANIC (Sanchez-Lengeling et al., 2017), and Mol-\nCycleGAN (Maziarka et al., 2020). More recently,\nTransformers and diffusion models have been uti-\nlized, based on their success in language model-\ning and image generation, respectively, such as\nMolGPT (Bagal et al., 2022), MDM (Huang et al.,\n2023), and GeoLDM (Xu et al., 2023).\n2.2 Target-specific Molecule Generation\nIn drug discovery, identifying drug-target interac-\ntions (DTI) is crucial for understanding the bioac-\ntivity and therapeutic effects of drugs for specific\ndiseases. Although the deep generative models\nhave proved useful in generating novel and chem-\nically valid molecules, further screening is neces-\nsary to evaluate their potential to bind with specific\nprotein targets. Building on this notion, several re-\nsearchers have developed target-specific molecule\ngeneration models to produce novel, drug-like\nmolecules that are highly likely to interact with spe-\ncific target proteins, including Transformer-based\ngeneration (Grechishnikova, 2021), AlphaDrug\n(Qian et al., 2022), SiamFlow (Tan et al., 2022)\nand POLYGON (Munson et al., 2024).\n2.3 Repurposing-Aware Molecule Generation\nDrug repurposing is a strategy that identifies new\ntherapeutic uses for approved drugs beyond their"}, {"title": "Problem Statement", "content": "The discovery of new compounds often relies on ex-\nisting protein-compound pairs. This results in that\nthe compounds targeting the same protein exhibit\nsimilar structures. In other words, the generative\nspace of models tends to be bounded in limited\nregions, reducing the diversity of the generation.\nWe refer to this as a sample bias problem.\nTo address this problem, we leverage multi-hop\nrelations among proteins and compounds. Specif-\nically, given a pair of protein p and compound\nc that are known to interact, we assume that the\ncompound relates to p within a 3-hop relation,\ni.e., a positive compound c\u207a, has a potential in-\nteraction with p. Definitions from 3.1 to 3.3 de-\nscribe the key concepts of our approach, and Fig-\nure 1 visually represents the rationale. Note that\nboth protein and compound are represented by"}, {"title": "Repurformer", "content": "In this section, we propose Repurformer, a novel\nmethod designed to address the sample bias prob-\nlem by leveraging multi-hop relations among pro-\nteins and compounds. Figure 2 illustrates how Re-\npurformer seamlessly integrates the concepts of\ndrug discovery and repurposing.\nBi-directional Pretraining To capture the many-\nto-many relationships between proteins and com-\npounds, we employed bi-directional pretraining for\nthe protein and compound encoders. Specifically,\nwe built two Transformers with identical encoder-\ndecoder structures but opposite training directions:\none was trained in the protein-to-compound direc-\ntion, and the other in the compound-to-protein di-\nrection (see Figure 2a). By doing so, we expect the\nprotein encoder fp(c|p) and the compound encoder\nfc(pic) to extract latent relations, zp and z\u00ba, that en-\ncompass both cases where proteins and compounds\nare the head and tail of an edge, and vice versa, i.e.,\nfp : c|p \u2192 zp and fc : p|c \u2192 z\u00ba. For example,\ngiven a pair of p(2) and c(1) as shown in Figure\n2b, zp and ze will represent the edges from p(2) to\nc(1) (i.e., p(2) \u2192 c(1)) and from c(1) to p(1) (i.e.,\nc(1) \u2192 p(1)), respectively.\nTransformer with Bi-directional Encoders The\npretrained bi-encoders are then used as feature ex-\ntractors; they are frozen and followed by a new\ncompound decoder. The compound decoder \u03c0(\u00b7),\nparameterized by 0, receives a sum of the encoding\nvectors h = zp + z\u00ba and a positive compound c+\nas inputs:\nc+1 = \u03c0\u03bf(\u00b7ct, ht) where ht = z + z\u0142.\nHere, ht \u2208 Rld represents a |d|-dimensional la-\ntent vector of 2-hop relation, e.g., p(2) p(2) 1-hop 1-0 (1) (=\u0107) 2-hop p(1) (see Figure 2b), from a t-th token\nperspective. Accordingly, feeding the compound\ndecoder with a positive compound as a label en-\nables it to learn potential repurposing relationships\nthat emerge from an additional third-hop edge, e.g.,\n2-hop c(1) 3-hop c(2) (= c+). Putting it all to-"}, {"title": "Experiments", "content": "Experiment Setup We collected data from Bind-\ningDB (Gilson et al., 2016) which contains over 2.8\nmillion measured binding affinities of interactions\nbetween proteins and drug-like molecules. The col-\nlected dataset was then preprocessed to filter out\nmissing values, duplicates, and proteins and com-\npounds with excessively long or short sequences.\nIn particular, given the many-to-many nature of\nprotein-compound relationships, we selected com-\npounds that interact with a reasonable number of\nindividual proteins between 10 and 100, to en-\nable our model to learn various compound struc-\ntures reacting with different proteins. The resulting\ndataset comprised 60,719 protein-compound pairs\nderived from 3,006 proteins and 7,803 compounds.\nWe split this dataset into train and test datasets\nwith 8:2 ratio, ensuring that the proteins interacting\nwith each compound did not overlap between the\ntwo sets. Our model was then trained on protein-\ncompound pairs from the train set, representing pro-\nteins with amino acid sequences and compounds\nwith canonicalized SMILES strings. We tokenized\nindividual characters from amino acid sequences\nand SMILES strings, resulting in vocabularies con-\ntaining 30 characters for proteins and 46 characters\nfor compounds."}, {"title": "Results", "content": "Main Results To evaluate Repurformer, we con-\nducted a comparative analysis of 11 configurations,\nfocusing on generative performance, physicochem-\nical properties, and drug-likeness."}, {"title": "Limitations", "content": "This study has some limitations. First, due to in-\nconsistencies between the tokens in our dataset\nand those we borrowed from previous research,\nsome generated outputs contained  tokens,\nwhich had to be excluded. Second, the study lacks\nexperiments on binding affinity, which are neces-\nsary to evaluate how strongly the generated com-\npounds bind to proteins. These limitations must be\naddressed in future research."}, {"title": "Concluding Remarks", "content": "In this study, we introduced Repurformer, a novel\nmodel designed to address the sample bias prob-\nlem in de novo molecule generation by leveraging\nmulti-hop relationships. Repurformer integrates bi-\ndirectional pretraining with Fast Fourier Transform\nand low-pass filtering, to capture complex interac-\ntions between proteins and compounds. This ap-\nproach focuses on low-frequency components, cor-\nresponding to longer propagation through multi-\nhop protein-compound interactions. The results\nshow that Repurformer successfully generates valid\nand diverse molecules.\nBuilding on these positive results, there are sev-\neral promising directions for future improvement.\nEnhancing the backbone architecture by incorpo-\nrating advanced models like diffusion or graph neu-\nral networks and techniques such as contrastive\nlearning could further improve Repurformer's abil-\nity to capture multi-hop protein-compound interac-\ntions. The results from Figures 5 and 6 also suggest\npromising directions to improve Repurformer such\nas leveraging reinforcement learning to maximize\ndiversity rewards or introducing Wasserstein loss\nto address mode collapse. Additionally, while our\ncurrent experiments have shown the potential of\nRepurformer, it is critical to validate its applica-\nbility in real-world scenarios. Therefore, we need\nto verify the performance of Repurformer on ex-\nisting drug repurposing cases. Considering these\naspects will strengthen the practical implications\nand utilities of Repurformer."}]}