{"title": "Enhancing Coronary Artery Calcium Scoring via Multi-Organ Segmentation on Non-Contrast Cardiac Computed Tomography", "authors": ["Jakub Nalepa", "Tomasz Bartczak", "Mariusz Bujny", "Jaros\u0142aw Go\u015bli\u0144ski", "Katarzyna Jesionek", "Wojciech Malara", "Filip Malawski", "Karol Miszalski-Jamka", "Patrycja Rewa", "Marcin Kostur"], "abstract": "Despite coronary artery calcium scoring being considered a largely solved problem within the realm of medical artificial intelligence, this paper argues that significant improvements can still be made. By shifting the focus from pathology detection to a deeper understanding of anatomy, the novel algorithm proposed in the paper both achieves high accuracy in coronary artery calcium scoring and offers enhanced interpretability of the results. This approach not only aids in the precise quantification of calcifications in coronary arteries, but also provides valuable insights into the underlying anatomical structures. Through this anatomically-informed methodology, the paper shows how a nuanced understanding of the heart's anatomy can lead to more accurate and interpretable results in the field of cardiovascular health. We demonstrate the superior accuracy of the proposed method by evaluating it on an open-source multi-vendor dataset, where we obtain results at the inter-observer level, surpassing the current state of the art. Finally, the qualitative analyses show the practical value of the algorithm in such tasks as labeling coronary artery calcifications, identifying aortic calcifications, and filtering out false positive detections due to noise.", "sections": [{"title": "1. Introduction", "content": "Coronary artery disease (CAD) is one of the leading causes of death worldwide (Kwiendacz et al., 2023). The adopted predictive measurement for assessing the CAD risk is coronary artery calcium (CAC) scoring (Obisesan et al., 2021). Here, non-contrast (NC) computed tomography (CT) scans are used to evaluate the patient condition in terms of calcifications in coronary arteries (CA). However, manual analysis of 3D CT images is time-consuming and prone to human bias, thus automatic analysis is crucial for providing reproducible and objective diagnosis on a large scale. There are three main CAC scoring methods, including the Agatston, volume, and mass scores (Blaha et al., 2017). All of them rely on voxel-level recognition of calcifications in the CT scans, which is a semantic segmentation problem. The current medical standard states that only objects with value > 130HU should be considered as calcifications (Hou et al., 2020). This threshold very well distinguishes calcifications and soft tissues. However, hard tissues (such as bones) and image acquisition noise may have high HU values too (Teague et al., 2012). Thus, it is pivotal to distinguish between such true and false positive detections which would affect the extracted scores. Although the total CAC score for the CA is a relevant risk indicator, a more precise diagnosis can be obtained by identifying calcifications in four different regions of the CA tree. Two main vessels stem from the aorta\u2014the left coronary artery (LCA) and the right coronary artery (RCA). RCA is considered as a single region, while LCA includes three ones: the left main coronary artery (LM), left circumflex artery (LCx), and the left anterior descending artery (LAD). Both RCA and LM areas are adjacent to the aorta, and therefore an important challenge is to distinguish which calcifications, or parts of calcifications, belong to the aorta and which to those regions. Hence, we also address this problem in the approach proposed in this paper."}, {"title": "1.1. Related Work", "content": "Since the introduction of the orCaScore challenge at the MICCAI 2014 (Wolterink et al., 2016), there has been a notable surge in interest toward employing machine learning (ML) for the task of CAC scoring. However, two primary issues persist: (i) distinguishing coronary from non-coronary calcifications and image artifacts, and (ii) analyzing each coronary calcifications on a per-vessel basis, by attributing each calcification to a specific coronary artery. In calcification identification, a range of heuristics (Gonz\u00e1lez et al., 2016), classic methods (Yang et al., 2016), and deep learning were used (Cano-Espinosa et al., 2018; Gogin et al., 2021; Zhang et al., 2021). Moreover, to eliminate the confusion with non-coronary calcifications, a predefined region of interest around the heart is employed to prune false positives (Yang et al., 2016). Calcification localization is often approached through the use of black-box models that produce multi-class calcification segmentation maps (Zhang et al., 2021; Hong et al., 2022; Yu et al., 2022), where the assignment of the calcification to a vessel cannot be explained to the clinician. Alternatively, accurate segmentation of coronary arteries is deemed essential, yet, delineating coronary arteries in NC CTs is challenging. Some techniques offer to produce a total Agatston score, limiting their explainability (Gogin et al., 2021; Ihdayhid et al., 2023). There are methodologies leveraging both contrast-enhanced and NC CTs, where the former assist in organ segmentation (Yang et al., 2016). Another perspective emphasizes the estimation of CAC using non-ECG-gated CTs (Yu et al., 2022; Suh et al., 2023). A more recent work by Takahashi et al. (2023), which relies on the segmentation of anatomical regions rather than on end-to-end identification of calcifications based on the image, stresses the need to build and employ ML models for accurate localization of coronary arteries in NC CT during the calcium scoring process. According to the authors, such an approach would make ML-based calcium scoring explainable, and therefore, would be an ideal method, but it is challenging due to poor visibility of coronary arteries in NC CT. Precise localization of coronary arteries would most probably also help to eliminate false positive detections present in their approach, associated with calcifications of, e.g., pericardium, pulmonary trunk, mediastinal lymph node, and mitral annulus."}, {"title": "1.2. Contribution", "content": "We propose an interpretable method for the segmentation and labeling of calcifications, which takes advantage of the novel framework for segmentation of CA in NC CT scans, despite their poor visibility. With our approach, we are able to provide the clinicians with reasonable estimation of CA vessel tree, which allows for instantaneous visual evaluation and interpretation of the segmented calcifications. We argue that even though CA segmentations are often fragmented, they provide sufficient information for medical experts to improve the diagnosis process, particularly for difficult cases. Thus, our contributions are multi-fold:\n\u2022 We propose an end-to-end anatomically-informed approach for the automatic segmentation and classification of calcifications (according to their anatomical locations), and for extracting the CAC score (Section 2.2).\n\u2022 We show that our pipeline extracts interpretable maps of calcifications labeled with their anatomical location which may enhance the analysis.\n\u2022 We rigorously verify our methodology over more than 500 heterogeneous non-contrast ECG-gated cardiac CT scans acquired using multiple CT scanner models, and show that the obtained results are at the inter-observer accuracy level (Section 3).\n\u2022 We demonstrate the superior accuracy of the method by competing in the orCaScore Grand Challenge, where our approach is currently the best (Section 3)."}, {"title": "2. Materials and Methods", "content": "In Section 2.1, the dataset used in this study is presented. Section 2.2 discusses our approach for extracting more interpretable calcium score information thanks to the calcifications' segmentation and their localization within the heart's anatomy."}, {"title": "2.1. Dataset and Ground-Truth Generation", "content": "We use a dataset of 534 NC CTs, of which 71 came from the orCaScore challenge (Wolterink et al., 2016), and the remaining CTs were acquired in three clinical centers from two European countries. It was split into training (T) and test (\u03a8) subsets, with T of 412 scans (16 from orCaScore) and \u03a8 of 122 scans (55 from orCaScore). To capture similar patient distributions in T and \u03a8, we stratified these sets according to five risk categories of total calcium scores (<1, 1\u201310, 11\u2013100, 101-400, >400). Of note, \u03a8 covered a range of scanner manufacturers: GE (18 scans), Philips (17), Siemens (68), and Cannon (19), to capture real-world data heterogeneity.\nAs we develop an approach for precise calcium scoring in CA with the assignment of scores to four CA territories (RCA, LM, LAD, LCx), the ground truth (GT) with labeled calcifications was meticulously prepared. First, calcification proposals were obtained using automated thresholding (130 HU) and the distance to CA. Then, 4 qualified medical experts (2-4 years of experience, YOE) reviewed the results and manually annotated calcifications which were missed in the previous step using the K3D-jupyter (v. 2.15.2) and Blender (v. 2.91.0) tools. Next, the calcifications were labeled as belonging to one of the four regions of the CA tree. The main difficulty here was concerned with the division of calcifications that were single components extending to multiple areas. To prepare precise GT for CA, calcifications located in coronary ostia were split into aortic and CA parts, and only the latter were included in the final GT. Each GT delineation was reviewed by an experienced cardiologist (17 YOE)."}, {"title": "2.2. Interpretable Calcification Segmentation Enhances Calcium Scoring", "content": "Our approach includes several pivotal steps: (i) segmentation of the scans, (ii) localization of calcifications and coronary ostia, (iii) their filtering and (iv) labeling, and ultimately (v) extracting quantifiable calcification scores. A detailed summary of the proposed method is provided in Fig. 1, while Fig. 2 shows a graphical overview of the main steps of the algorithm. The input 3D CT scan is processed to extract calcification candidates via thresholding, as defined by medical standards. Here, we also elaborate segmentation masks of pericardium, CA and aorta, using deep learning models. Next, calcification candidates and CA are filtered by removing objects positioned outside the dilated pericardium segmentation mask, which removes significant part of false positive detections. Meanwhile, the aorta segmentation is used for localization of the aortic valve center, which is used, along with the aorta segmentation mask and the filtered CA segmentation mask, as input to ostia localization. Vessel tree labeling is performed using both filtered CA mask and ostia points. Calcification candidates are filtered using the information on the distance to the filtered CA mask, and then labeled based on the vessel tree labeling and coronary ostia localization. Finally, the quantifiable measures are extracted from the resulting calcifications. The next sections present these steps in more detail, and Fig. 3 renders a visual summary of our method."}, {"title": "2.2.1. Segmentation of Cardiovascular Structures", "content": "Obtaining segmentation masks for relevant cardiovascular structures allows for precise and interpretable detection of calcifications. For the pericardium, aorta (Bujny et al., 2024a) and CA segmentation, we exploit the training procedure and nnU-Net models, as suggested by Bujny et al. (2024b), using a semi-manually labeled CTs. Since CA are poorly visible in NC CTS, creating manual GT would be very challenging, even for experienced experts, as it would require the corresponding reference from contrast-enhanced images. Thus, we employed registration of high-resolution coronary tree models obtained in contrast CT with NC CTS."}, {"title": "2.2.2. Localization of Calcifications", "content": "Locating calcifications within the regions of the CA tree is of high clinical relevance. An important step of this process is identifying the CA inflows (medically called ostia), being the locations in which the aorta turns into arteries. Since the CA segmentations in NC are usually fragmented, relying on the closest points between CA and aorta masks is not sufficient. Instead, we start with a rough localization of the aortic valve center, by using a convolutional neural network (CNN) with an additional dense layer as a regressor, which operates solely on downsampled (2\u00d7) aorta mask. Then, we refine this localization with another CNN, operating on a limited area (67\u00d767\u00d767 mm) around the initially estimated point, but using the original aorta segmentation rather than the downsampled one. According to our preliminary experiments, the two-step process is both more precise and faster (due to downsampling) than using a single stage network. The third CNN determines the locations of both LCA and RCA ostia in an area around the estimation of the aortic valve center, using both aorta and CA segmentation masks. The architecture of the employed CNNs corresponds to the encoder of the U-Net (Ronneberger et al., 2015), only with an additional dense layer of 6 neurons (one for each of the three coordinates of the two ostia)."}, {"title": "2.2.3. Filtering of False Positive Calcification Candidates", "content": "By medical definition, calcifications are considered only in voxels with HU\u2265 130. Thus, calcification candidates are obtained using simple thresholding. However, it results in a significant number of false positives. We use a dilated pericardium mask (with the experimentally fine-tuned dilation size of 1 mm) to remove all detections positioned outside the heart. Similarly, this step is applied to CA. Finally, calcifications are filtered by investigating their distance to the coronary vessels. This is consistent with the medical perspective, as clinicians evaluate calcifications in each coronary vessel. The CA mask is first dilated by 3 mm to compensate for segmentation inaccuracy, and then all candidates not intersecting with the dilated CA are removed."}, {"title": "2.2.4. Labeling of Calcifications", "content": "The calcification labeling includes: (i) identifying which calcifications, or parts of calcifications, belong to the aorta, and (ii) assigning the remaining calcifications to specific branches of the vessel tree. It is common for the calcifications to be located in the coronary ostia region, either as lesions in the CA and aorta, or as a single lesion extending to both regions. To split such calcifications, we need to find the boundary between aorta and CA. While this is not a well-defined anatomical structure, we estimate it based on the medical suggestions. We process the left and right coronary artery separately, using the determined ostia center points. For each point, we consider the surrounding patch of size 25 \u00d7 25 \u00d7 25 mm, and compute the Euclidean distance transform (EDT) for both aorta and CA. Then, we create a separation plane by maximizing distance to both masks.\nCalcifications (or their parts) on either side of the separation plane are assigned to respective regions\u2014the aorta or CA. CA calcifications are assigned to one of four regions: RCA, LM, LAD, LCx, based on the distance to the vessel tree regions, which are determined as follows. The inflows of the LCA and RCA branches are identified using the located ostia center points. Then, LCA and RCA masks are processed by connecting disjoined components corresponding to the RCA and LCA branches. RCA is considered as a separate region, hence it requires no further processing. LCA is skeletonized (Lee et al., 1994), and converted to a directed acyclic graph, in which a node is a n-furcation of the vessel tree, and the edge represents a part of the vessel between consecutive n-furcations. The vessel morphology, such as its diameter, is represented as graph's edge attributes. The logistic regression classifier is trained on manually engineered features, including the relative angle between edges, thickness and segment's length, to recognize subregions of LCA at each node of the graph. Starting from the inflow, the graph is traversed until all subregions are identified. The RCA and LCA trees are finally used to label calcifications by the closest distance."}, {"title": "3. Experimental Study", "content": "The objectives of our experiments are two-fold: (i) to verify the calcification segmentation performance, and (ii) to investigate the agreement between the Agatston score (AS) extracted manually and automatically for all CA areas. The segmentation quality is quantified using DICE, sensitivity (Sen) and specificity (Spe) \u2014all metrics should be maximized (\u2191) and range from 0 to 1. The Intraclass Correlation Coefficient (ICC) was calculated on a single measurement, absolute-agreement, two-way random-effects model to verify the agreement between expert and automatic AS. We conducted two types of evaluations the first was performed using our test set (Sect. 2.1), including expert GT annotations for four labels: LM, LAD, LCx, and RCA. Here, the mean and the mean weighted by both the total number and volume of lesions were calculated. To confront our approach with the state of the art, we conducted another analysis using data from the orCaScore Grand Challenge (GC). This analysis was carried out in two different ways: (i) for a subset of the orCaScore cases from our test set, we calculated all relevant metrics and their distributions based on the GT calcification segmentations by our medical imaging experts; (ii) for the 40 test cases used in the orCaScore GC for evaluating the algorithms, we performed an automated analysis with the method proposed in the paper, and made an official submission in the system to compute the metrics. In both cases, to compare with the published results, we applied a minor modification of the model's predictions the calcifications labeled as LM were changed to LAD. The experiments were run on an NVIDIA A100 40 GB GPU, and our pipeline offers fast operation, with the average end-to-end inference time of 6 min."}, {"title": "4. Conclusions", "content": "Coronary artery calcium scoring using NC ECG-gated cardiac CT scans is key for assessing the cardiovascular disease risk. Manual analysis of of multi-vendor CTs is, however, time-consuming and prone to human bias. We tackled this issue and proposed an end-to-end approach for locating calcifications, assigning them to specific anatomical parts of the coronary artery tree, and quantifying calcium scores across different anatomical areas of the heart. Our method provides interpretable segmentation masks for convenient calcification investigation and score calculation, and offers fast operation. While our technique shows high segmentation performance and nearly perfect agreement with human experts, and it was verified over the significantly larger dataset of CTs than orCaScore, we still aim for multi-center validation and invite the community to assess our approach across a broad range of CT studies, covering multiple scanner models and representing diverse patient populations.\nhighlighting the importance of semantic understanding and explainability in the process."}]}