{"title": "Evaluating the Impact of Different Quantum Kernels on the Classification Performance of Support Vector Machine Algorithm: A Medical Dataset Application", "authors": ["Emine AKPINAR", "Sardar M. N. ISLAM", "Murat ODUNCUOGLU"], "abstract": "The support vector machine algorithm with a quantum kernel estimator (QSVM-Kernel), as a leading example of a quantum machine learning technique, has undergone significant advancements. Nevertheless, its integration with classical data presents unique challenges. While quantum computers primarily interact with data in quantum states, embedding classical data into quantum states using feature mapping techniques is essential for leveraging quantum algorithms Despite the recognized importance of feature mapping, its specific impact on data classification outcomes remains largely unexplored. This study addresses this gap by comprehensively assessing the effects of various feature mapping methods on classification results, taking medical data analysis as a case study. In this study, the QSVM-Kernel method was applied to classification problems in two different and publicly available medical datasets, namely, the Wisconsin Breast Cancer (original) and The Cancer Genome Atlas (TCGA) Glioma datasets. In the QSVM-Kernel algorithm, quantum kernel matrices obtained from 9 different quantum feature maps were used. Thus, the effects of these quantum feature maps on the classification results of the QSVM-Kernel algorithm were examined in terms of both classifier performance and total execution time. As a result, in the Wisconsin Breast Cancer (original) and TCGA Glioma datasets, when Rx and Ry rotational gates were used, respectively, as feature maps in the QSVM-Kernel algorithm, the best classification performances were achieved both in terms of classification performance and total execution time. The contributions of this study are that (1) it highlights the significant impact of feature mapping techniques on medical data classification outcomes using the QSVM-Kernel algorithm, and (2) it also guides undertaking research for improved QSVM classification performance.", "sections": [{"title": "I. INTRODUCTION", "content": "Quantum machine learning (QML) is a rapidly evolving research field where the power of quantum computing is applied to machine learning (ML) tasks to pursue computational advantages over data that, in the current context, is becoming increasingly difficult to manage, process and draw meaningful conclusions from [1,2]. Quantum computers possess parallel processing power due to the superposition and entanglement properties of quantum particles. In this case, the primary objective in QML research is to utilize quantum mechanical concepts such as superposition and quantum entanglement to enhance the performance of ML techniques. Nevertheless, despite the great potential of quantum computing, current noisy intermediate-scale quantum (NISQ) computers have limited qubits and low circuit depths [3]. Furthermore, these computers are highly susceptible to their ambient surroundings and are at risk of losing their quantum state because of quantum decoherence [4]. Despite these hardware limitations, there are already quantum versions of some ML models in the literature, such as quantum principal component analysis [5], a popular approach for dimensionality reduction, quantum Gaussian mixture models [6], another renowned approach for estimating clustering and density, and a support-vector machine algorithm with a quantum kernel estimator (QSVM-Kernel), which is basically applied for linear and classification problems [7].\n\nThe QSVM-Kernel algorithm is a quantum adaptation of the classical support vector machine (SVM) algorithm that leverages the capabilities of quantum mechanics, such as superposition and entanglement, to augment the kernel calculation process [7-9]. The motivation for using quantum kernels is based on their ability to partition the data/input space more discriminatively than classical calculations can.\nThe quantum kernel method (k(xx) = |<U\u2084(x)|U\u2084(x)}|\u00b2 = [{(x)\\(x)}\u00b2) employs the inner product of quantum feature maps to encode data from classical data space to corresponding qubit states in an exponentially large target space, namely, the Hilbert space [10]. In other words, the data are nonlinearly mapped to a high-dimensional feature space, where a hyperplane is constructed to separate the labeled samples. To outperform classical approaches, quantum feature maps should be complex enough to be difficult to simulate on classical computers and at the same time ideally suited for implementation on noisy intermediate-scale quantum (NISQ) computers. [7, 11].\n\nFeature mapping techniques in kernel methods are pivotal for pattern recognition and feature detection, as they aid in identifying labeled patterns in datasets where they may be difficult to distinguish in their original space [12]. However, as the feature space grows and the computational cost of estimating kernel functions increases, traditional methods face limitations in successfully addressing such classification problems. To overcome this challenge, data are mapped to quantum state in the high-dimensional Hilbert space using quantum feature mapping methods, rather than the classical data space. In other words, this process entails nonlinearly mapping classical data (x) to a quantum state (x\u2192|(\u03a6(X)|\u03a6())|). In QML, several different encoding (embedding) procedures have been proposed for encoding data quantum mechanically, such as angle embedding [10, 13], amplitude embedding [14, 15], Pauli feature maps [7, 9, 16], parametrized quantum circuits [17-19].\n\nHere, we report an experimental implementation of the QSVM-Kernel algorithm on the classification performance of two different medical datasets as case studies.\n\nIn recent years, with the proliferation of comprehensive medical public databases integrating electronic health records, billing data, disease registries, medical imaging, biomarker data, wearable technologies, and health applications, new strategies and methods have been designed and developed to expedite complex data analyses, manage large datasets, and derive meaningful insights [20, 21]. Furthermore, with these open databases, numerous powerful artificial intelligence (AI) decision support systems, notably machine learning (ML) models, have been developed to address significant problems in medical data, including tumor classification [22-28], noninvasive determination of genomic biomarkers for diseases [29], prediction of patient survival outcomes [30], and prediction of the onset of various pathological conditions [31]. In particular, medical data classification is a crucial application of ML in the healthcare domain. Indeed, some of these techniques have demonstrated applicability in computer-aided detection systems.\n\nHowever, as highlighted in many studies in the literature, classical ML techniques have limitations in learning correlations and in the most complex patterns in medical datasets [32]. The noise in the data, feature dimensionality, and limited nature of the classical vector space are some of the challenges encountered [33]. Moreover, the need for higher computational power increases as the size of medical datasets grows, posing another significant problem [34]. Recent research has shown that in addition to classical ML techniques in healthcare, the utilization of quantum machine learning (QML) technologies not only addresses these challenges but also accelerates complex data analyses and enables more efficient processing of large datasets [35].\n\nThis study provides a comprehensive analysis by employing the Scikit-learn SVM on two distinct medical datasets, namely, the Wisconsin Breast Cancer (original) and The Cancer Genome Atlas (TCGA) Glioma datasets, for binary classification tasks. The SVM leverages quantum kernel methods obtained through quantum feature mapping techniques implemented in the PennyLane software framework. These quantum kernels are used as hyperparameters, and the transformed training set is accepted as input data. The SVM subsequently trains on these data in a classical manner, ultimately yielding a separating hyperplane as a result.\n\nThe main objective of the article is to investigate the impact of nine different quantum feature mapping techniques, namely, angle encoding (Rx, Ry, and Rz), amplitude encoding, Pauli feature maps (ZFeatureMap, ZZFeatureMap), and parametrized quantum circuits (Rx and CX, Ry and CY, R\u2082 and CZ), created using the PennyLane software framework, on the classification results of two different medical datasets as case studies.\n\nContributions of the Study: This study shows the impact of different quantum kernels on the classification performance of the QSVM. The significance of kernels on the outcome of classification and execution time of the QSVM algorithm has been highlighted. Therefore, this study has made the following contributions: it shows that quantum kernels can improve the performance of SVMs, and (2) it guides undertaking research for improved QSVM classification performance, especially in medical data analysis.\n\nThe remainder of this work is structured as follows.\n\nSection 2 provides detailed information on the medical datasets used in our study, the preprocessing steps, and the QSVM-Kernel algorithm. Section 3 presents the results of the impact of different quantum feature maps on the classification outcomes of the QSVM-Kernel algorithm, evaluated in terms of both classifier performance and overall execution time. Section 4 summarizes the main findings of our study and underscores its contribution to the literature."}, {"title": "II. MATERIALS AND METHODS", "content": "A. Data and Preprocessing\n\nIn this study, two different widely used and publicly available medical datasets were utilized for empirical analysis. Both datasets contain multiple variables and present a classification problem that aims to classify examples into different classes using these variables. The first dataset is the Wisconsin Breast Cancer (original) dataset from the UCI Machine Learning Repository, and the second dataset is The Cancer Genome Atlas (TCGA) dataset, which includes molecular features (or markers) for low-grade gliomas (LGGs) and high-grade gliomas (HGGs) and clinical information for patients. The Wisconsin Breast Cancer dataset has 699 patients (Benign: 458, Malignant: 241), and the dataset comprises 9 integer-valued attributes related to benign and malignant tumors. The Wisconsin Breast Cancer (original) dataset can be accessed at [36]. The original TCGA dataset contains molecular features and clinical information for LGGs and HGGs and consisted of 862 patients and 23 features. Of the 862 patients, 23 patients with missing clinical information were excluded from the dataset. The remaining dataset contain information for a total of 839 patients, with 487 belonging to LGGs and the remaining 352 belonging to HGGs. Additionally, out of the 23 features, 3 pertained to the clinical characteristics of the patients, while the remaining 20 represent the most frequently mutated molecular features. Among these 23 features, one of them is an integer-valued attribute, and the others are categorical. The TCGA research network dataset can be accessed at [37]. In the TCGA dataset, these values were converted into numerical values using the one-hot encoding method after identifying the categorical values.\n\nIn the data preprocessing step, the following procedures were applied separately to both datasets:\n\na) Normalization of the data\n\nIn QML studies, standardizing the data to a common range is important for maintaining the coherence of quantum states and reducing the impact of quantum noise. This study employed the min-max normalization technique to rescale the numerical data features to a specific range after converting categorical values into numerical ones. Min-max normalization performs a linear transformation on the original data while preserving the relationships between the data values. Min-max normalization assigns data features to a certain minimum and maximum range. This method is usually applied using the following formula:\n\nXnormalize =$\\frac{(x - \\text{min} (x))}{(\\text{max}(x) - \\text{min}(x))}$ $\n\nHere, Xnormalize represents the normalized value, x represents the original value, min(x), is the minimum value, and max(x) is the maximum value of the data feature.\n\nb) Dimension reduction with principal component analysis (PCA):\n\nDue to the limited number of qubits and low circuit depths inherent in NISQ computers, it is necessary to reduce the number of features to a certain extent before they are mapped to quantum space. This necessity is crucial for enhancing computational efficiency because minimizing the feature set assists in better management of the constraints associated with quantum computing power. This process can essentially be achieved in two different ways. The first approach entails the utilization of feature selection techniques aimed at identifying input variables with the strongest correlations to the output variables, thus selecting the most important features within the dataset. The second approach, known as dimensionality reduction, aims to create a lower-dimensional subspace that captures relationships among features rather than directly selecting features. In our study, we employed the dimensionality reduction method principal component analysis (PCA) to mitigate computational costs in both medical datasets. PCA is employed to extract principal components and project input data onto lower dimensions. The objective is to identify new orthogonal sets of principal components representing directions of maximum variance in the data [38]. The input data are obtained from the principal component with the highest variance. While this method reduces computational costs and expedites the classification process, it does not guarantee the selection of the most discriminative components. In our study, we compressed both datasets using PCA and utilized the first 5 dimensions to represent the raw data.\n\nB. Support Vector Machine Algorithm with a Quantum Kernel Estimator (QSVM-Kernel)\n\nThis section provides a detailed explanation of the Quantum Support Vector Machine (QSVM-Kernel), the quantum version of the classical SVM model with a quantum kernel estimator.\n\na) Support Vector Machine (SVM)\n\nSVM is a supervised machine learning algorithm with a robust theoretical foundation based on statistical learning theory. Supervised learning is the process of determining a relationship f(x) by using a training dataset S = {(X1,Y1), ..., (X2,Y2), ..., (xn, yn)}, which contains n inputs of d-dimensionality, x\u2081\u2208Rd, and their class labels yi. In the case of binary classification, y\u00a1 \u2208 {+1, -1}, where +1 and -1 are two classes of labels. In our study, x\u012f represents the input parameters encompassing features characterizing both benign and malignant tumors in the Wisconsin Breast Cancer dataset, as well as molecular and clinical attributes pertaining to LGGs (Low-grade Gliomas) and HGGs (High- grade Gliomas) in the TCGA Glioma dataset. In addition, yi denotes the classes in both datasets, such as benign and malignant for the breast cancer dataset and LGGs and HGGs for the glioma dataset. In SVM, a hyperplane defined by the normal vector w and offset b is determined based on the training data. Consequently, the following expression can be formulated for any data point x\u2081 and its associated class yi .\n\nyi (w.xi + b) \u2265 1\n\nThe main objective of SVM is to find the maximum separation between two classes or the maximum margin $\\frac{(2/||w||2)}{}$ between them. In other words, it aims to determine a hyperplane that separates the two classes so that all points belonging to class -1 are on one side and all points belonging to class +1 are on the other. The hyperplane with the widest margin is referred to as the optimal separating hyperplane. The equation described above leads to a hard-margin SVM, which does not allow any points to lie within the margin, making it impossible to train the classifier, especially on linearly inseparable data [39]. Soft-margin SVMs, on the other hand, allow for some errors in classification by permitting some points to lie within the margin [39]. An appropriate separator is found while minimizing errors by allowing for some misclassification of data points. However, a soft-margin SVM can be introduced by allowing each data xi to deviate \u03be; from satisfying the conditions in (2), obtaining a new set of conditions:\n\nyi (w\u2022xi + b) \u2265 1-\u03be\u03af\n\nThe variable defined here, \u03be\u2081, is referred to as the slack variable and allows for a certain amount of misclassification. For an N-element nonseparable dataset, the dual optimization equation is given by:\n\nmaximize, \n\n$\\sum_{i=1}^{N} Ai - \\sum_{i,j=1}^{N} aaji y; (xi, xj)$\n\nsubject to\n\n$\\sum_{i} yi a\u2081 = 0,0 \u2264 a \u2264 C$"}, {"title": "III. RESULTS AND DISCUSSION", "content": "In this study, the QSVM-Kernel algorithm was employed for the classification of malignant and benign tumors in the Wisconsin Breast Cancer (original) dataset and for distinguishing LGGs and HGGs tumors in the TCGA Glioma dataset. Quantum simulations provided by the PennyLane 0.35.1 framework were utilized for computing special quantum kernel matrices formed by nine different quantum feature maps within the QSVM-Kernel algorithm. The quantum simulators provided by PennyLane are the default.qubit and lightning.qubit state-vector qubit simulators. In addition, leveraging the plugin framework, an external Python package providing additional quantum devices to PennyLane, the ibmq qasm simulator in the IBM Quantum Experience platform, was utilized alongside the other mentioned simulators. The pseudocode for the study is presented in the Appendix.\n\nFollowing the determination of training and test kernels, the training kernel was employed to train the Scikit-learn SVM model on a classical computer, whereas the test kernel was utilized to make predictions by transitioning to the model's prediction method. The classification performance results of the QSVM-Kernel model for both medical datasets are presented in Table 1. The QSVM algorithms with ZFeatureMap and ZZFeatureMap were executed with a repetition of 2 using the lightning.qubit PennyLane simulator. On the other hand, QSVMs with other feature maps were run with a repetition of 1 using the default.qubit simulator. Moreover, in this study, to evaluate the classification performance of the QSVM-Kernel model, commonly used evaluation metrics in the literature were employed, including the area under the receiver operating characteristic curve (AUROC), accuracy, precision, recall, and F1 score measurements. The AUROC curve assists in assessing the balance between the true positive rate and the false positive rate. Other evaluation metrics were derived from the confusion matrix.\n\nAccording to Table 1, when the QSVM-Kernel algorithm utilizes the Rx rotational gate and the Rx and CX parametrized quantum circuit as feature maps on the Wisconsin Breast Cancer (original) dataset, it achieves equal and optimal performance with accuracy and AUROC score values of 0.98 in distinguishing malignant and benign tumors. The total execution time for training and classification within the QSVM-Kernel algorithm is 19.25 min when employing the Rx feature map and 44.1 min when utilizing Rx and CX parametrized quantum circuits.\n\nAdditionally, when the R\u2082 rotational gate and the R\u2082 and CZ parametrized circuit are used as feature maps, they yield equal and worst classification results with an accuracy of 0.65 and AUROC score of 0.5.\n\nThe total execution times for these feature maps within the QSVM-Kernel algorithm are 15.38 min and 47.1 min, respectively.\n\nFurthermore, considering all feature maps, the precision, recall, and F1 score values for the malignant cohort range from 0.40 to 0.95, 0.43 to 0.99, and 0.5 to 0.97, respectively, while for the benign cohort, they vary between 0.65 to 0.99, 0.97 to 1.0, and 0.78 to 0.98, respectively.\n\nSimilarly, in the QSVM-Kernel algorithm, when kernels consisting of 9 different feature maps are used, the performance of this algorithm for discriminating between LGGs and HGGs is also presented in Table 1 under the TCGA Glioma dataset section.\n\nAccording to the table, utilizing the Ry rotational gate as a feature map in the QSVM-Kernel algorithm yields the best classification performance, with an accuracy value of 0.86 and an AUROC of 0.87. Following this, when the Rx rotation gate is used as a feature map in the QSVM, an accuracy of 0.85 and an AUROC value of 0.87 are achieved.\n\nAdditionally, employing the R\u2082 rotational gate as a feature map results in the lowest classification performance, with an accuracy of 0.40 and an AUROC of 0.5.\n\nThe total execution times for the QSVM-Kernel algorithm with these three feature maps are 38.83 min, 37.78 min, and 33.97 min, respectively.\n\nMoreover, considering the 9 feature maps, the precision, recall, and F1 score values for LGGs range from 0.60 to 0.97, 0.78 to 1.0, and 0.75 to 0.87, respectively. For HGGs, these values vary between 0.40 to 0.76, 0.91 to 1.0, and 0.57 to 0.85, respectively.\n\nThe confusion matrices of the model obtained when using the Rx rotational gate as the feature map in the QSVM-Kernel algorithm on the Wisconsin Breast Cancer (original) dataset and when using the Ry rotational gate as the feature map in the QSVM-Kernel algorithm on the TCGA Glioma dataset are illustrated in Figure 1."}, {"title": "IV. FINDINGS AND IMPLICATIONS", "content": "The general findings obtained in this study are as follows:\n\n\u2022 In datasets composed entirely of numeric data, such as the Wisconsin dataset, when mapping data from the classical vector space to the quantum Hilbert space, using the Rx rotational gate yields better results in terms of both classification accuracy and execution time compared to other gates.\n\n\u2022 For datasets consisting mostly of categorical data, such as the TCGA Glioma dataset, after converting data to numerical values through encoding, mapping from the classical vector space to the quantum Hilbert space using both the Ry rotational gate and, in addition, the Rx rotational gate proves to be more advantageous both in terms of classification accuracy and execution time.\n\n\u2022 Using two-qubit quantum gates in a parametrized quantum circuit during the data mapping process significantly increases the total execution time, reducing efficiency.\n\n\u2022 In medical data mapping processes, the utilization of R\u2082 rotational and CZ two-qubit quantum gates negatively affects both the classification outcome and execution time.\n\nThe results of the significant implications for the impact of different quantum kernels on the performance of the QSVM for classification, especially for complex medical data. The choice of quantum future maps significantly influences the outcome of classification and execution time of the QSVM algorithm. This study thus shows the importance of the right future maps in maximizing the accuracy and efficiency of QSVM-Kernel algorithms, especially in complex medical machine learning applications.\n\nTherefore, this study has made the following two contributions:\n\n1. shows the potential of quantum kernels for improving the performance of SVMs,\n\n2. provide guidance for undertaking research and applications of quantum machine learning for improved classification performance, especially in medical data analysis."}, {"title": "V. CONCLUSION", "content": "In recent years, with a significant increase in the volume of medical data, many classical machine learning models have been developed to expedite data analysis, manage datasets, and derive meaningful insights from these data. However, as the volume of data has grown, these advanced models have increasingly required more computational power, surpassing the capabilities of traditional computers equipped with CPUs and GPUs. As a result, quantum computing technology has been applied in the medical field despite the limitations of NISQ (Noisy Intermediate-Scale Quantum) computers, leading to many successful outcomes. Revolutionary progress has been made in data analysis and problem solving in the healthcare domain with quantum machine learning (QML) models, where the power of quantum computers is applied to machine learning tasks.\n\nIn this study, the QSVM-Kernel was applied as a QML model to classify 2 different and well-known Wisconsin Breast Cancer (original) and TCGA Glioma datasets. The QSVM-Kernel algorithm uses quantum kernel matrices generated by 9 different feature maps, namely, angle encoding (Rx, Ry, and Rz), amplitude encoding, Pauli feature maps (ZFeatureMap, ZZFeatureMap), and parametrized quantum circuits (Rx and CX, Ry and CY, R\u2082 and CZ). Thus, the classification performance of the QSVM-Kernel algorithm was analyzed according to the feature map chosen.\n\nConsidering the limitations of the NISQ computers in both datasets, the PCA value was set to 5. Accordingly, in the Wisconsin Breast Cancer (original) dataset, the QSVM Kernel algorithm achieves equal classification performance when Rx rotational gate and Rx and CX parametrized quantum circuit are used as feature map to distinguish malignant and benign tumors. However, since the total execution time is about 2 times higher for the parametrized quantum circuit (Rx and CX) and to ensure energy efficiency in quantum circuits, it is more advantageous to use only the Rx rotational gate. Moreover, in the TCGA Glioma dataset, the best classification performance was obtained when the Ry rotational gate was used as a feature map in the QSVM- Kernel algorithm. In this dataset, although the R\u2082 rotational gate gives better results in terms of total processing time, the classification performance value is too low to be generalized when it is used as a feature map.\n\nIn the future, we aim to develop efficient feature mapping techniques, especially for medical datasets, that will positively affect both the classification result and execution time and use them in the QSVM-Kernel algorithm."}]}