{"title": "Graph convolutional networks enable fast hemorrhagic stroke monitoring with electrical impedance tomography", "authors": ["J. Toivanen", "V. Kolehmainen", "A. Paldanius", "A. H\u00e4nninen", "A. Hauptmann", "S. J. Hamilton"], "abstract": "Objective: To develop a fast image reconstruction method for stroke monitoring with electrical impedance tomography with image quality comparable to computationally expensive nonlinear model-based methods. Methods: A post-processing approach with graph convolutional networks is employed. Utilizing the flexibility of the graph setting, a graph U-net is trained on linear difference reconstructions from 2D simulated stroke data and applied to fully 3D images from realistic simulated and experimental data. An additional network, trained on 3D vs. 2D images, is also considered for comparison. Results: Post-processing the linear difference reconstructions through the graph U-net significantly improved the image quality, resulting in images comparable to, or better than, the time-intensive nonlinear reconstruction method (a few minutes vs. several hours). Conclusion: Pairing a fast reconstruction method, such as linear difference imaging, with post-processing through a graph U-net provided significant improvements, at a negligible computational cost. Training in the graph framework vs classic pixel-based setting (CNN) allowed the ability to train on 2D cross-sectional images and process 3D volumes providing a nearly 50x savings in data simulation costs with no noticeable loss in quality. Significance: The proposed approach of post-processing a linear difference reconstruction with the graph U-net could be a feasible approach for on-line monitoring of hemorrhagic stroke.", "sections": [{"title": "I. INTRODUCTION", "content": "The focus of this work is the use of electrical impedance tomography (EIT) for the challenging task of stroke monitoring. Here we propose the use of graph U-nets to drastically improve the quality of fast, linearized, stroke monitoring imaging, at negligible cost, to result in improved images of quality comparable to computationally expensive reconstruction methods. The learning is performed on the underlying graph structure of the image to allow for training on 2D cross-sectional brain images and subsequent processing of 3D volumes, exploiting the dimension-free nature of graph networks in contrast to classic CNN U-nets. This results in a 50x computational savings in data simulation alone.\nWorldwide, strokes are a leading cause of death and disability [1]. Approximately 70% of strokes are ischemic, resulting from a clot or blockage of blood-flow in the brain, and 30% hemorrhagic (bleeds). The most common type of hemorrhagic stroke is an intracerebral hemorrhage (ICH), which is usually caused by disruption of cerebral arteries leading to bleeding into the brain tissues. In the early stage of ICH, within 1-2 days from the onset, possible expansion of the hematoma and re-bleeding form a formidable risk to the patient [2]. Additionally, patients with thrombolysis treated acute ischemic stroke are prone to a secondary cerebral hemorrhage [3]. Such secondary hemorrhage in ischemic stroke patients as well as hematoma expansion or re-bleeding in ICH patients should be detected immediately.\nThe follow-up of ICH in the intensive care facility is mainly based on monitoring of clinical signs and symptoms [2]. However, vigilant observation of subtle neurological signs of the patient can be challenging, particularly in intubated and sedated patients. Currently the most reliable way to monitor ICH is through repeated computerized tomography (CT) scanning [2]. However, deciding the timing of the control CT imaging is itself already a difficult problem, and CT provides only snapshots of the bleeding at the times of the control imaging. Further, transporting a patient from intensive"}, {"title": "II. METHODS", "content": "This section gives an overview of the forward model of EIT and the setup for the stroke monitoring application. We briefly review the linearized reconstruction approach, which we post process with the graph U-net, and the non-linear difference imaging algorithm [15], [16] which we use as reference for assessing the quality across images."}, {"title": "1) Forward model:", "content": "As we consider both 2D and 3D recon- structions, we consider the domain \u03a9 \u2282 Rd (d = 2,3) and model the L electrodes attached to the boundary as subsets (segments/patches) of the exterior boundary, denoted el C D\u03a9, l = 1,2,..., L. In the EIT measurement, P current patterns I(i) \u2208 RL, j = 1, 2, . . ., P, are consecutively applied through the electrodes, and the corresponding voltages U(i) \u2208 RL are measured on all electrodes. Here I) and U) denote the applied current and measured voltage from the jth current pattern on the (th electrode for l = 1, 2, . . ., L. Based on the conservation of charge, and our choice of electric potential ground, we have\n$\\sum_{l=1}^{L} I_l^{(j)}=0 \\qquad \\sum_{l=1}^{L} U_l^{(j)} = 0.$\n\nThe voltages Us) are boundary measurements of the interior electromagnetic potential $u^{(i)}(x)$ that is modeled with the conductivity equation\n$\\nabla \\cdot (\\sigma(x)\\nabla u^{(i)} (x)) = 0, x \\in \\Omega,$\n\nwhere (x) is the the conductivity and the boundary conditions of the complete electrode model (CEM) [28], [29] for j = 1,..., P and l = 1, ..., L, are given by\n$ \\sigma(x) \\frac{\\partial u^{(j)} (x)}{\\partial n} = 0, \\quad x \\in \\partial\\Omega \\setminus \\bigcup_{l=1}^{L}e_l,$"}, {"title": "2) Monitoring of hemorrhagic stroke using EIT:", "content": "The growth of an ICH, or occurrence of a secondary hemorrhage, is expected to present as a localized change in the brain conductivity due to an increased volume of highly conducting blood at the hemorrhage location. Thus, the aim in EIT monitoring is to monitor the status of the hemorrhage by reconstructing changes of the conductivity,\n$\\delta\\sigma = \\sigma_2 - \\sigma_1,$\n\nbased on EIT measurements V\u2081 and V2 taken at times t\u2081 and t2, roughly 2-10 minutes apart. The acquisition of a single EIT measurement is very fast, typically multiple frames per second. The acquisition of the single frame is short compared to the changes in the hemorrhage status and the measurement is also fast compared to the time between consecutive measure-ments, implying that it is feasible to model the measurements separately with the stationary model\n$V_k = U(\\sigma_k) + e_k, k = 1,2.$"}, {"title": "3) Linear difference imaging algorithm:", "content": "The linear differ- ence (LD) imaging algorithm, see e.g. [32], [33], is based on a linearization of the forward model (8) and aims to reconstruct the change in conductivity do between V\u2081 and V2 by solving the regularized linear least-squares problem\n$\\delta\\hat{\\sigma} = arg\\underset{\\delta\\sigma}{min}\\{|| L_{se} (\\delta V - J\\delta\\sigma)||^2 + ||R\\delta\\sigma||^2\\},$\n\nwhere dV = V2 - V\u2081, \u0431\u0435 = e2 - e1, Lse is the Cholesky factor of the noise precision matrix of de so that LeLse = F = (\u0413\u0435\u2081 + \u0413\u0435\u2082)-1, the Jacobian matrix J of U(\u2642) is evaluated at a linearization point \u03c3\u03bf, and R is a regularization matrix.\nIn this paper, as in [15], [16], the linearization point \u03c3\u03bf was obtained by solving a non-linear least squares fitting problem for the best fitting spatially constant conductivity using the measurement data V\u2081. The regularization matrix R was constructed utilizing a distance-based correlation model [34] resulting in regularization that promotes spatially smooth conductivity changes. For implementation details, see [15], [16]. Figure 1 (column 2) shows a sample reconstruction produced using this LD method in 49 seconds."}, {"title": "4) Nonlinear stroke monitoring algorithm:", "content": "The nonlinear stroke monitoring (MO) algorithm [15] is used as reference for evaluating the image quality of the learning-based post processing of LD images. The MO method utilizes non-linear difference imaging [35], parallel level sets regularization [36] and a priorconditioned least squares algorithm [37], [38]."}, {"title": "The algorithm utilizes prior information from the patient CT,", "content": "which is taken for diagnosis of the stroke at the time of patient admission to the hospital, for the construction of the patient specific 3D mesh and parallel level set regularization, favoring similar alignment of level-set lines in the CT and EIT reconstruction of the baseline conductivity 01 at time t1.\nThe algorithm also allows utilization of a region of interest (ROI) constraint for the conductivity change\n$supp(\\delta\\sigma) = \\Omega_{ROI} \\subseteq \\Omega.$\n\nThe ROI can be chosen based on the patient CT image and, for ICH monitoring, a natural catch-all choice is to use the full brain volume. Given the selected ROI, the conductivity at the later measurement time t2 is modeled as\n$\\sigma_2 = \\sigma_1 + K\\delta\\sigma,$\n\nwhere K is an extension mapping that zero-extends the conductivity change from the ROI to the whole domain. In case no ROI is used, K equals the identity matrix with the same dimension as 01.\nThe change in conductivity do between the two measure-ments V\u2081 and V2 is estimated by the non-linear optimization problem\n$\\hat{\\sigma} = arg \\underset{\\sigma}{min} \\{||L_e(\\hat{V} - \\bar{U}(\\hat{\\sigma}))||^2 + \\rho(\\hat{\\sigma})\\},$\n\nwhere the diagonal blocks of Le contain the Cholesky factors of the noise precision matrices of measurements V\u2081 and V2,\n$\\bar{V} = \\begin{bmatrix} \\bar{V}_1 \\\\ \\bar{V}_2 \\end{bmatrix},\\qquad \\sigma = \\begin{bmatrix} \\sigma_1 \\\\ \\delta\\sigma \\end{bmatrix}, \\qquad \\bar{U} = \\begin{bmatrix} U(\\sigma_1) \\\\ U(\\sigma_1 + K \\delta\\sigma) \\end{bmatrix},\\qquad \\tilde{e} = \\begin{bmatrix} e_1 \\\\ e_2 \\end{bmatrix},$ and the regularization functional\n$\\rho(\\sigma) = \\rho_{\\delta\\sigma}(\\delta\\sigma) + \\rho_{\\sigma_1}(\\sigma_1)$ allows independent regularization models for do and 01.\nThe regularization model for do is chosen to be the smoothed total variation regularizer [39]\n$\\beta_{\\delta\\sigma}(\\delta\\sigma) = TV (\\delta\\sigma) = \\alpha_{\\delta\\sigma} \\int (||\\nabla \\delta\\sigma||^2 + \\beta^2)^{1/2} dx,$\n\nwhere \u03b18\u03c3 > 0 is the regularization weight coefficient, \u2207do is the gradient of the conductivity change, and \u1e9e > 0 is a small smoothing parameter that ensures differentiability. This is a reasonable choice since the conductivity change caused by stroke expansion is due to a localized change of blood volume.\nThe conductivity 01, the baseline conductivity at mea-surement time t1, is expected to correlate well with the structure of the patient CT. This information is utilized via the parallel level sets based, spatially and directionally weighted, smoothed TV regularization that promotes similar alignment of level sets in o\u2081 and the CT based reference image [36], giving\n$\\rho_{\\sigma_1}(\\sigma_1) = WTV(\\sigma_1) = \\alpha_{\\sigma_1} \\int (||\\nabla \\sigma_1||B(x) + \\beta^2)^{1/2} dx,$"}, {"title": "B. Graph convolutional networks (GCNs)", "content": "Following the work of [25], we chose to work with graph convolutional neural networks instead of the typical convolu-tional neural networks (CNNs). We opted for the graph setting as our reconstructed quantity, the internal conductivity change, is recovered over an irregular finite element mesh. While we could interpolate our result to a classic pixel/voxel grid, per-form the learning with CNNs, and interpolate back to the finite element mesh, the natural setting for our work is the irregular mesh. Furthermore, performing the learning on graphs allows even greater flexibility to process reconstructions coming from different dimensions, i.e. 3D data vs 2D, a feat not naturally possible for the CNN setting where the learned filters are specific to the dimension of the data. Additionally, the number of learned parameters can be significantly lower in the graph setting requiring approximately 327 thousand parameters, whereas a classic CNN U-Net has around 30 million parameters in 2D, and 90 million in 3D.\nFollowing [25], three kMax pooling layers, each with a 7/8 reduction in the number of nodes, were used and three graph convolutions [40] performed per layer with 32 channels employed at the top layer and 256 at the bottom layer. The clone-cluster unpooling was used for the decoder side of the network and skip-connections utilized. The output of the network is defined over the input graph, determined by the given adjacency matrix A, with no change in dimension. As the (sparse) adjacency matrix and graph structure are sent into the trained network as inputs, this allows the network to be dimension-independent. The interested reader is referred to [25], [41] for additional details."}, {"title": "C. Improving reconstructions with post-processing", "content": "In this work we are adapting the post-processing approach to learned image reconstruction. Specifically, here we are given the computationally cheap reconstruction from the linear"}, {"title": "III. SAMPLES AND METRICS", "content": null}, {"title": "A. Learning samples", "content": "The 2D and 3D linear difference imaging samples for the networks were obtained as follows. First, a large number of computational head phantoms with initial and expanded hemorrhages were created and subsequently used to simulate EIT measurement datasets by solving the EIT forward problem (1)-(5). The voltage datasets were then used with the linear difference (LD) imaging algorithm described in Section II-A3.\nLinear difference imaging estimates were computed using the simulated data by solving the minimization problem (9): 2000 in 2D, 6000 in 3D."}, {"title": "B. Independent testing samples", "content": "The proposed approach, processing noisy/blurry LD images with a graph U-net, was tested with simulated data from a realistic 3D six-layer head model [27], as well as experimental data from a laboratory experiment with a 3D-printed head tank and skull."}, {"title": "C. Metrics", "content": "The quality of the input reconstructions, the network pro-cessed reconstructions, and the reference reconstructions from the stroke monitoring algorithm were evaluated using the following metrics."}, {"title": "IV. RESULTS", "content": "We will explore how well our 2D and 3D trained graph U-nets generalize to unseen 3D data, and compare them to a reliable, but computationally costly, nonlinear reconstruction method (MO), but first we verify that the networks perform well on data similar to the training data."}, {"title": "V. DISCUSSION", "content": "The results suggest that the proposed gUnet post-processing of the LD reconstruction leads to a similar performance in hemorrhage growth detection as the non-linear stroke moni-toring algorithm (MO), but in a tiny fraction of computational time ,making it a potential candidate to a clinical on-line monitoring setup where fast reconstruction is needed.\nA surprising result in this project was the ability to train the 2D gUnets on very few samples. By contrast, even 800 training, and 180 validation samples in 3D proved inadequate."}, {"title": "A. Computational Cost", "content": "1) Creating training data: The average combined computa-tion time for the creation of a single head phantom pair and the corresponding data simulation with both head phantoms was 0.30 s in 2D and 26.60 s in 3D.\n2) Network training times:\n3) Test data reconstruction times:"}, {"title": "VI. CONCLUSIONS", "content": "In this study, we demonstrate the ability to use graph U-nets to post-process relatively fast, standard, linear difference (LD) reconstructions for EIT to produce improved images of comparable quality to a time-intensive nonlinear stroke-monitoring (MO) reconstruction method, at a tremendous savings in computational cost. By training in the graph setting, instead of the classic CNN framework, we were able to perform the training on 2D images and then test on 3D data."}]}