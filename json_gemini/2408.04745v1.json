{"title": "AI for operational methane emitter monitoring from space", "authors": ["Anna Vaughan", "Gonzalo Mateo-Garcia", "Itziar Irakulis-Loitxate", "Marc Watine", "Pablo Fernandez-Poblaciones", "Richard E. Turner", "James Requeima", "Javier Gorro\u00f1o", "Cynthia Randles", "Manfredi Caltagirone", "Claudio Cifarelli"], "abstract": "Mitigating methane emissions is the fastest way to stop global warming in the short-term and buy humanity time to decarbonise. Despite the demonstrated ability of remote sensing instruments to detect methane plumes, no system has been available to routinely monitor and act on these events. We present MARS-S2L, an automated AI-driven methane emitter monitoring system for Sentinel-2 and Landsat satellite imagery deployed operationally at the United Nations Environment Programme's International Methane Emissions Observatory. We compile a global dataset of thousands of emission events for training and evaluation, demonstrating that MARS-S2L can skillfully monitor emissions in a diverse range of regions globally, providing a 216% improvement in mean average precision over a current state-of-the-art detection method. Running this system operationally for six months has yielded 457 near-real-time detections in 22 different countries of which 62 have already been used to provide formal notifications to governments and stakeholders.", "sections": [{"title": "Introduction", "content": "Hundreds of miles offshore in the Gulf of Thailand, a malfunctioning flare on an oil platform is emitting vast amounts of methane into the atmosphere. A potent greenhouse gas, methane is responsible for more than 25% of global warming to date (1-3) and mitigating emissions is the fastest way to reduce the worst effects of climate change in the short-term and buy humanity time to decarbonize. Discovered in 2023 (4), a time-series analysis of satellite images recently revealed that this platform has been frequently emitting methane at a rate of several tonnes every hour for over a decade without detection or intervention (5) (see Figure S5 materials and methods).\nThis site and many others like it around the world are examples of methane emitters. Unlike other greenhouse gasses such as carbon dioxide, a relatively small number of these point sources make up a significant percentage of total emissions, presenting a crucial opportunity for rapid mitigation (6). Remarkably, despite their climate impact and increasing public awareness after events such as the Nordstream pipeline leak (7, 8) or the record-breaking Kazakhstan blowout (9), systematic documentation of and regular monitoring of these sites has not been available due to challenges detecting methane in satellite images in an automated manner.\nAlthough a wide variety of satellites are suitable for detecting methane, currently the only platforms with sufficiently high revisit time and spatial resolution for regular monitoring and attribution of emissions are Sentinel-2 and Landsat. Together, these satellites provide publicly available imagery of all land surface every 2.3 days on average at 20-30 meters spatial resolution and are capable of detecting emissions at a rate of as little as 1000 kg/hour (10, 11) in favourable conditions. Unfortunately, the spectral resolution of these instruments is low, making detecting the methane signal a challenging task. Early work in this area utilised simple image thresholding techniques (2, 11, 12), requiring time-consuming manual checking and achieving limited accuracy. In recent years, there has been significant interest in using machine learning to detect and monitor methane emissions (13\u201321). For multispectral imagery, CH4Net (22) provided the first AI model for fully automated monitoring of methane emission events at a set of locations in Turkmenistan using Sentinel-2 images, providing orders of magnitude improvement over previous techniques when evaluated on several hundred real emission events.\nThese promising early results have led several authors to suggest that these methods could be used to build a global, fully automated operational monitoring system for methane emissions (13, 21, 22). Despite the urgency involved in addressing these issues, implementation of such a system has not yet been realised due to the significant challenges involved. The lack of a large global dataset of real, verified methane plumes in multispectral data, machine learning challenges in detecting weak signals in multispectral images, developing operational infrastructure for analysis of results, and facilitating engagement with governments and asset owners are all major roadblocks to developing such a system. Here, we report that this objective has now been accomplished. We present MARS-S2L, an automated AI driven methane emitter monitoring system developed"}, {"title": "MARS-S2L", "content": "as part of the Methane Alert and Response System (MARS) at the United Nations Environment Programme's International Methane Emissions Observatory. Launched at COP27, MARS is the first global satellite detection and notification system for methane emissions, for which MARS-S2L is a key element. By compiling a large hand-annotated global dataset of methane emission events, training a novel AI model, and building a quality-assurance and quality control (QA/QC) tool to easily interpret and act on alerts, we create a system capable of automatically monitoring methane emitters globally. We report results for the first six months of operation, demonstrating skillful detection of 457 emissions and the creation of 62 formal notifications."}, {"title": "Dataset", "content": "The first step in using AI for methane emitter detection is building a large dataset of events for training and evaluation, which we name the MARS-S2L dataset. As methane emission events are localised and relatively rare, this presents a significant challenge, with many previous studies forced to examine only limited areas (22), and rely on synthetic data (16, 17,21), or data taken days before a ground truth plume detection (21). To ensure the trustworthiness and suitability for operational usage of a global monitoring system, it is necessary to have a large dataset of real plumes in multispectral imagery verified by experts. The MARS-S2L dataset utilises observations from four sensors: the Multispectral Imager (MSI) aboard Sentinel-2 A and B (23) and the Operational Land Imager (OLI) aboard Landsat 8 and 9 (24). Together these platforms have a mean revisit time of 2.3 days (25).\nBy manually inspecting known emission sites identified by IMEO analysts from scarce but highly accurate hyperspectral imagery, we compile a large dataset of 53,309 images, including 4,230 emissions over 707 distinct emitter sites in a diverse range of regions globally between January 2018 and June 2024 (Figure 1 (b)). For each image, a multi-band multi-pass image (12) is created using the most similar previous overpass in the non-methane bands and manually checked for methane plumes. If a emission is present a mask is hand annotated on the image, a challenging task as the plume is frequently weak and poorly defined (Figure 1 (a)). We note that the resulting dataset is heterogeneous as not every image is labelled for every site. For a detailed exposition of the dataset see materials and methods."}, {"title": "Al model", "content": "MARS-S2L is implemented as a convolutional conditional neural process (26) with film layers for parameter-efficient finetuning (27, 28). Neural processes are a class of models ideally suited to probabilistic data fusion tasks such as methane detection as they are capable of handling missing data and providing probabilistic output, and have been applied extensively to environmental"}, {"title": "The Plume Viewer", "content": "For MARS-S2L to be useful in an operational setting, results need to be displayed in a manner that analysts can easily obtain, explore, and interpret new predictions and use these to engage directly with governments and operators. To facilitate this process we developed the PlumeViewer, a QA/QC tool that displays model outputs and past predictions over the same location. Each morning at 6:30 GMT, any new Sentinel-2 and Landsat image covering a location in monitoring is ingested in the system and processed by the MARS-S2L model. When analysts log into the PlumeViewer, the alert screen with the latest positive model predictions are shown with filters in the probability score, fluxrate, satellite or country (Figure 2 (b)). The analyst can then click on any of these alerts to inspect and validate the predicted plume, get the emission flux quantification and error estimation, and cross-reference the prediction with different infrastructure and proprietary databases, as well as possible previous detections from these or other satellites to which IMEO has access. As many images as possible are processed each day depending on analyst availability and the time taken on each case, hence there is no hard probability cutoff for an image to be inspected. If the source of the emission and asset owner is identified, the information collected from the satellites will be shared with the government and the company contact, through the MARS regional case manager. For detailed images of the analyst process in the PlumeViewer see materials and methods."}, {"title": "Results", "content": "We conduct two analyses of results. The first is to present the results of running MARS-S2L operationally in near real-time over a period of six months. As analysts do not manually verify every image available, checking only those with high probabilities assigned, it is only possible to report the number of true positives not true negatives and false positive rates. We therefore conduct a rigorous systematic evaluation of performance over all labelled data in the next section."}, {"title": "Near real time deployment results", "content": "In its current operational configuration MARS-S2L provides daily monitoring of a set of 707 longitude-latitude locations where methane emissions have been verified to occur by IMEO analysts. This list of locations is frequently updated as further sites are identified. We report results from running MARS-S2L for a six-month trial period from the 1st of January 2024 to the 30th of June 2024. During this phase, the model produced 457 detections from 110 unique sites globally in 22 different countries. Already during this time 62 emissions detected at 41 unique sites in 15 different countries were notified to government and corporate stakeholders. Examples of three notified plumes are shown in Figure 3 (c-e). As notifications can only be issued for locations where IMEO has established a point of contact, the percentage of notified detections is expected to rapidly increase as engagement with governments and operators deepens in the second half of 2024."}, {"title": "Global evaluation of performance", "content": "We conduct a detailed evaluation of the performance of MARS-S2L on the held out test set. These sites primarily consist of oil and gas production facilities, together with several coal facilities and landfill sites. We compare two models: the previous state-of-the art AI model for methane monitoring, CH4Net (14), and MARS-S2L. Figure 4 (a) compares the performance of CH4Net and MARS-S2L for plumes stratified by flux rate. MARS-S2L substantially outperforms CH4Net, especially for the large emissions of most interest for mitigation work. MARS-S2L is also able to successfully identify several very small emissions in the range of 0.5-1 tonnes/hour. An example of a MARS-S2L prediction for an event in Algeria is shown in Figure 4 (b-e). For further examples of model predictions see materials and methods. MARS-S2L achieves a mean average precision of 0.67 compared with 0.31 for CH4Net, a 216% improvement over the previous state-of-the-art. Taking a threshold of 0.5 for binary classification, MARS-S2L achieves an accuracy of 0.90, recall of 0.77, precision of 0.37, and 9% false positive rate, compared to 0.91, 0.42, 0.32 and 6% for CH4Net. We note that these binary classification results are provided only to give an overview of model performance on these metrics, in practice, there is no hard probability cutoff for operational inspection with analysts processing as many images as they have time for each day. Evaluation"}, {"title": "Case studies", "content": "We next evaluate performance in different regions by conducting three case studies of areas with different background characteristics. These are Turkmenistan, a desert area ideally suited to methane detection with multispectral imagery, the Permian Basin, an oil and gas production region in the South Western United States with more challenging background surfaces and offshore platforms. This explores the ability of MARS-S2L to identify plumes in regions with a diverse range of background characteristics.\nMARS-S2L achieves excellent performance over Turkmenistan with accuracy over all images of 0.88, mean average precision of 0.74 and false positive rate of 10% (Figure 5 (b)). Spatial predictions for a time-series of emission events provide accurate predictions of plume morphology and extent across a range of different events. The Permian Basin is a substantially more challenging region, with MARS-S2L providing predictions with a mean average precision of 0.54, accuracy of 0.95 and false positive rate of 5% (Figure 5 (a)). For the offshore platforms, the model achieves a mean average precision of 0.68, accuracy of 0.76 and false positive rate of 26%, indicating skillful performance in a region with very different background characteristics from the majority of the training data (Figure 5 (c)). We note that these binary classification results could likely be improved by setting a separate probability threshold on a per-site or per-region basis. Taken together, these three case studies indicate that MARS-S2L is capable of skillfully detecting emissions in a variety of regions globally with different background types."}, {"title": "Discussion", "content": "We have presented MARS-S2L, the first AI-driven operational methane emitter monitoring system. By compiling a large, expert-verified global dataset of methane emission events we train a novel machine learning model that outperforms a previous state-of-the-art system by large margins and automatically detects plumes globally in very diverse regions. Running this model operationally for six months, hundreds of emission events were successfully detected in near-real-time in 22 different countries of which 62 have been utilised to send notifications to parties with the power to act on and mitigate these emissions.\nMARS-S2L is having significant and immediate impacts on the methane emitter mitigation work, allowing a small group of analysts at IMEO to operationally exploit the wealth of data from Sentinel-2 and Landsat-8/9 to notify and engage with relevant stakeholders when methane leaks are detected, and drive diplomatic and policy efforts to stop these damaging events. All detected"}, {"title": "Data and code availability", "content": "Model weights, code, and data will be made publicly available under a Creative Commons license CC BY-NC-SA 4.0 DEED (Attribution-NonCommercial-ShareAlike 4.0 International) on completion of the peer review process. This will be provided in a machine learning ready format to drive coherent research in this field."}, {"title": "Materials and methods", "content": "Sentinel-2A and Sentinel-2B are two Earth observation satellites that are part of the Copernicus program, coordinated by the European Commission in partnership with the European Space Agency (ESA). Launched in June 2015 (Sentinel-2A) and March 2017 (Sentinel-2B), these platforms capture high-resolution images in 13 spectral bands using the Multispectral Imager (MSI) instrument. Landsat 8 and Landsat 9 are part of the Landsat program, a joint initiative by NASA and the United States Geological Survey (USGS) that has been observing Earth's landmasses since 1972. Launched in February 2013 and September 2021, respectively, these satellites are equipped with advanced sensors, including the Operational Land Imager (OLI) and the Thermal Infrared Sensor (TIRS), which collect imagery in multiple spectral bands.\nMARS-S2L is trained using the following common bands of OLI and MSI: blue (MSI: 490 nm, OLI: 482 nm), green (MSI: 560 nm, OLI: 561 nm), red (MSI: 665 nm, OLI: 655 nm), NIR (MSI: 842 nm, OLI: 865 nm) and both SWIR bands at wavelengths 1610 nm and 2190 nm. We exclude aerosol and cirrus bands of both sensors as they have significantly different spatial resolution. Bands of both sensors with spatial resolution higher than 10m are interpolated to 10m using bicubic interpolation. Although there are slight differences in central wavelength, band width and resolution between both sensors, these differences are not sufficient to impact model performance.\nSeveral auxiliary data channels are provided. For each image cloud and cloud shadow masks were computed using the CloudSEN12 model (34). Wind vectors are obtained from the ERA5-Land reanalysis (35) and NASA GEOS-FP (36) for offshore locations."}, {"title": "Image processing, labelling and quantification", "content": "To train and evaluate MARS-S2L we create a comprehensive database of methane plumes building on a list of known locations with past detected emissions provided by the International Methane Emission Observatory (IMEO) analysts. For each of these locations Sentinel-2 and Landsat images are downloaded for a 2\u00d72 km\u00b2 square around the source. Each image is processed with CloudSEN12 and discarded if it contains more than 50% cloud, cloud shadow or missing pixels. For clear images, the retrieval is computed using the multi-band multi-pass (MBMP) ratio (12) using the most similar cloud-free image. We measure similarity in the visible and SWIR1 band and restrict to images acquired over the last 4 months. For offshore platforms, we use the multi-band single-pass ratio (MBSP) (42). From the retrieval image, plumes are manually annotated for each image using the Computer Vision Annotation Tool (43) and labelling functionality within PlumeViewer. For positive examples we estimate the per-pixel concentration of methane and the flux rate in kilograms per hour (kg/h) following Gorro\u00f1o et al. (11)."}, {"title": "Dataset", "content": "In total, the MARS-S2L dataset compiled as part of this work comprises images over 707 emitters in 33 countries. A large percentage of total images and observed plumes are from known oil and gas producing hotspots in Algeria, Turkmenistan, Iraq, Kazakhstan and Libya, with smaller numbers in other locations. Table S2 and Table S3 show the numbers of locations, images and plumes per country for the complete dataset and test dataset respectively. The number of images, locations and plumes analysed over each country per month for 2023 and 2024 is shown in Figures S6 and S7. Total numbers of images and plumes stratified by training split and satellite are shown in Figure S4."}, {"title": "Model design and architecture", "content": "The model is implemented as a convolutional conditional neural process (26) with FiLM layers for finetuning inspired by (27), with the density channel giving locations of invalid pixels provided by Cloud SEN12. MARS-S2L is trained to maximise the log likelihood of a Bernoulli distribution at each pixel with positive pixels upweighted by a factor of 10 to account for the pixel-wise class imbalance. The backbone decoder is implemented as a simple and flexible UNet architecture (44) consisting of four encoder blocks (2D convolution layer, batch norm, ReLU activation, max pool) followed by four decoder blocks (transposed 2D convolution layer, 2D convolution layer, batch norm, ReLU activation, 2D convolution layer, batch norm ReLU activation) with skip connections between blocks of corresponding scale. Channel output dimensions for each of these blocks are with kernel sizes of 3 for all convolution layers and 2 for the max pooling layers.\nFor each site with at least five positive images available we learn a set of parameters specific to each location. Feature-wise Linear Modulation layers (FiLM layers) are a lightweight method for finetuning convolutional architectures (28). FiLM layers dynamically adjust the activations of convolutional feature maps by modulating them with learned parameters. Mathematically, this is expressed as $\\gamma \\times x + \\beta$ where $\\gamma$ and $\\beta$ are learned parameters of an affine transformation for each convolutional filter and $x$ is the input feature map. By applying theses transformations independently to each channel of the feature maps, FiLM layers allow the network to selectively amplify or attenuate specific features depending on scene-specific characteristics."}, {"title": "Model training procedure", "content": "Training is performed using stratified sampling and a novel physics-based simulation scheme (Figure S2) designed to compensate for the dataset imbalance of plumes and images across locations. For each call to the dataloader we randomly sample a location, and a binary indicator denoting whether we are sampling an image with or without a plume. As it is desirable to train on real images where possible, plumes are simulated depending on the number of real plumes available at each location. For locations with no real plumes, we randomly sample a negative image and"}, {"title": "Comparison to CH4Net", "content": "For comparison to CH4Net, we retrain the model developed in (22) on the same training dataset utilised for MARS-S2L. As CH4Net was originally developed for Sentinel-2 only and utilised all 13 bands, we opt to retrain with only the five bands overlapping with Landsat to allow for application to this instrument and fair comparison with MARS-S2L on all images. CH4Net is trained for 200 epochs using the simulation scheme described above with Adam optimisation (47), a learning rate of 5e-4, weight regularisation of le-6 and early stopping."}, {"title": "Controlled release experiments", "content": "As images are hand-labelled based on the MBMP images, we do not have a ground truth value for the total emission rate. To test the ability of MARS-S2L to detect small emissions, we run the model on all images from the Stanford controlled releases of 2021 and 2022 (37, 38). In these experiments, methane was periodically released coinciding with Sentinel-2 and Landsat overpasses to test the detection capabilities of different satellites.\nReleases for both experiments were made at two different sites in Arizona: Ehrenberg (37) and near Casa Grande (38). For the first set of releases (37), we evaluated on the eight data points of the experiment (six from Sentinel-2 and two from Landsat), removing the Sentinel-2 acquisition from 24th October 2021 due to cloud cover. In total, the first experiment consisted of 7 positive and 1 negative images with releases up to 7.5 t/h. The second set of releases (38), were significantly more challenging, with 10 positive and 5 negative samples and release rates between 0.75 to 1.5 t/h. Figure S4 left shows the model output probability over all images in the experiment. We see that the model is able to detect all large emissions (\u2265 3 t/h) and produced only one false positive with medium probability (0.6). For small emissions (between 0.75 and 2 t/h) 4 are false negatives, 9 true positives and 4 are given medium probabilities (between 0.2 and 0.8). Results by satellite show higher disagreements in Landsat: 3 out of 4 false positives and 1 false negative. This is hypothesized to be due to the lower number of Landsat images in the training dataset (see Table S4) and lower spatial resolution of this sensor.\nOn the right of Figure S4 we show the estimated vs real emissions for the positive detections. For the estimation of the flux rate we use integrated mass enhancement method (2, 11) with the plume mask produced by the model and the concentration image obtained from the quantification of the MBMP ratio (11). Overall we see a good agreement similar to those obtained with manual delineations in the controlled release articles (37, 38)."}, {"title": "Thailand platform timeseries", "content": "A longitudinal timeseries of observed emissions from the offshore platform in the Gulf of Thailand discussed in the introduction is shown in Figure S5. This work was generated as part of an IMEO"}]}