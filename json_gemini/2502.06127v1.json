{"title": "Improved YOLOv5s model for key components detection of power transmission lines", "authors": ["Chen Chen", "Guowu Yuan", "Hao Zhou", "Yi Ma"], "abstract": "High-voltage transmission lines are located far from the road, resulting in inconvenient\ninspection work and rising maintenance costs. Intelligent inspection of power transmission lines has\nbecome increasingly important. However, subsequent intelligent inspection relies on accurately\ndetecting various key components. Due to the low detection accuracy of key components in\ntransmission line image inspection, this paper proposed an improved object detection model based on\nthe YOLOv5s (You Only Look Once Version 5 Small) model to improve the detection accuracy of\nkey components of transmission lines. According to the characteristics of the power grid inspection\nimage, we first modify the distance measurement in the k-means clustering to improve the anchor\nmatching of the YOLOv5s model. Then, we add the convolutional block attention module (CBAM)\nattention mechanism to the backbone network to improve accuracy. Finally, we apply the focal loss\nfunction to reduce the impact of class imbalance. Our improved method's mAP (mean average\nprecision) reached 98.1%, the precision reached 97.5%, the recall reached 94.4% and the detection\nrate reached 84.8 FPS (frames per second). The experimental results show that our improved model\nimproves the detection accuracy and has advantages over other models in performance.", "sections": [{"title": "1. Introduction", "content": "Inspecting power transmission lines is a daily task in power grid companies. There are\nincreasingly long-distance transmission lines in China. Patrol inspection is very heavy, and operation\nand maintenance costs are high. Long-distance transmission lines are located in complex terrain and\ncover a wide range. Manual inspection of key components has been unable to meet the actual needs,\nand more intelligent detection methods are urgently needed. A large number of transmission line\nimages were taken by cameras installed on transmission lines or unmanned aerial vehicles. These\nimages are used for power transmission line inspection based on computer vision. With the\nadvantages of high efficiency, accuracy and security, the inspection based on images has gradually\nbecome an important way of transmission line inspection [1]. For the automatic inspection based on\nimages, it is important to detect the key components of transmission lines accurately. The results of\nthis work are good foundations for detecting key component defects and abnormal events."}, {"title": "2. Dataset and its statistics", "content": "Our dataset is from Yunnan Limited Company of China Southern Power Grid. The images are\ncaptured by the surveillance cameras installed on transmission towers or unmanned aerial vehicles\n(UAV) for transmission line inspection. Currently, the power grid monitoring system is relatively\ncomplete, and the primary image data comes from the surveillance camera. UAVs are only used in a\nfew places where the surveillance camera cannot cover. Therefore, most of the images in the dataset\nare captured by surveillance cameras, and UAVs capture very few. The dataset contains 4290 images\nwith a resolution of 1920*1080 pixels. The background of these images is complex, including hills,\nland, and streets.\nWe have defined and annotated five types of detected targets according to the application needs\nof power grid companies, and they are screws, poles, insulators, transmission towers, and vehicles. The\nfirst four are key components of transmission lines. As huge trucks or engineering vehicles easily\ndamage transmission lines, power grid companies especially require that vehicles are detected objects.\nThe five categories of labeled targets are shown in Figure 1.\nAfter labeling the dataset, we counted the number and size of various targets, and the results are\nshown in Figure 2.\nFigure 2(a) shows that the width and height of most detected targets only are less than 10% of\nthe image size, and they are small targets. In Figure 2(b), the number of samples in the dataset is not\nbalanced, among which there are fewer vehicles. The dataset shows a large gap between the height\nand width of the electric pole and the transmission tower.\nIn response to this dataset's application requirements and characteristics, we will use the\nYOLOv5s network and improve it for object detection of critical components of power grid\ntransmission lines."}, {"title": "3. Methods", "content": "In practical applications, in the key areas (substations and abnormal monitoring key areas), we\nconsider integrating the detection module into the cameras for real-time detection. In non-key areas\n(field transmission lines), we capture an image every 30 minutes, transmit it to the data center\nthrough 4G network, and the data center will detect it. As the object detection method for key\ncomponents of transmission lines needs to be integrated into outdoor surveillance equipment, this\nmethod should be faster in low hardware configuration. YOLO5 is a rapid object detection model\nthat can be applied to the actual working environment. In our application, we chose YOLOv5 as the\nbasic model. According to our application characteristics, we improved the distance measurement in\nthe K-means clustering, added an attention mechanism, and upgraded the loss function."}, {"title": "3.1. YOLOv5s model", "content": "YOLO families are regression-based algorithms for object detection [22]. YOLOv5 is the fifth\nversion of the YOLO series. YOLOv5 series contains four object detection versions: YOLOv5s,\nYOLOv5m (You Only Look Once Version 5 Middle), YOLOv51 (You Only Look Once Version 5"}, {"title": "3.2. Modify distance measurement in the K-means clustering", "content": "In the YOLOv5s model, the K-means algorithm used Euclidean distance to measure sample\ndistance. Since the poles and transmission towers are tall but narrow, the height-to-width ratio is\nlarge. Using the Euclidean distance to measure the distance between the predicted box and the real\nbox of electric poles and transmission towers will lead to a significant error in the clustering results.\nTo avoid this error, we considered replacing Euclidean distance with 1-IoU (Intersection over Union)\ndistance. The 1-IoU distance can reduce this error caused by the large ratio of height to width of\ndetected objects [26,27].\nThe 1-IoU distance $D_{IoU}$ based on IoU is calculated as follows:\n$DIoU =1-IoU =1- \\frac{A\\cap B}{A\\cup B}$"}, {"title": "3.3. Adding attention mechanism", "content": "Attention module has been proven to effectively enhance the representation ability of\nconvolutional neural networks [28]. Many images have complex backgrounds and dense targets in\nthe dataset of key components in the transmission line. It is necessary to improve its saliency to\nenhance the feature expression ability of the detected target in the complex background. Therefore,\nwe introduce an attention mechanism to enhance features, mainly capturing the various iconic\nappearances of key components of transmission lines.\nAttention mechanisms can be divided into two types: channel attention and spatial attention.\nChannel attention mainly explores the feature mapping relationship between different feature\nchannels. Spatial attention uses multi-channel features in different spatial locations to build the"}, {"title": "3.4. Focal loss", "content": "The class imbalance problem typically occurs the instances of some classes are many more than\nothers. The class imbalance usually affects the effectiveness of classification. In the dataset of\ntransmission line key components, vehicles' samples are much smaller than other categories.\nFocal loss is a loss function that can reduce the impact of class imbalance [29]. It was originally\nused to solve model performance caused by image class imbalance. It adds weights to positive and\nnegative samples through a weight factora,, and adds weights to the corresponding loss of samples\naccording to the difficulty of sample discrimination by adding a modulating factor (1-p)y. That is,\nadd a smaller weight to the samples that are easy to discriminate, and add a larger weight to the\nsamples that are difficult to discriminate.\nThe focal loss is calculated as follows:\n$FL(p_t) = -\\alpha_t (1-p_t)^\\gamma log(p_t)$\nwhere\n$p_t =\\begin{cases}\np, & y=1\\\\\n1-p, & otherwise\n\\end{cases}$\nwhere $p_t$ is the closeness to the ground truth (the class y). A large $p_t$ indicates that the closer to the\nclass y, and a large $p_t$ means a high classification accurate. $y$ is a controllable parameter, and $y > 0$.\n$\\alpha_t$ is the shared weight of controlling the total loss of positive and negative samples."}, {"title": "4. Experiments", "content": "We gave the experimental results and analysis from several aspects of our model improvement,\nsuch as the distance measurement in K-means clustering, attention mechanism, and focal loss\nfunction. After that, we conducted ablation experiments and comparative experiments with other\nmethods. Finally, we also performed detection experiments on another public insulator image dataset."}, {"title": "4.1. Data augmentation", "content": "Due to the insufficient sample images, we used a data enhancement tool library (ImgAug) to\naugment our dataset. Data augmentation can expand training sets, improve the model's\ngeneralization ability, and effectively improve the robustness of the model.\nThe ImgAug library provides many image processing functions, which can efficiently realize\nthe rotation, flipping, affine, brightness enhancement, contrast enhancement, color enhancement and\nother operations of the original image. The data augmentation effect of transmission line key\ncomponents images using ImgAug is shown in Figure 7."}, {"title": "4.2. Experiment configuration and evaluation index", "content": "We used Microsoft Windows 10 as the operating system, one NVIDIA GeForce GTX 2080Ti as\nthe GPU and PyTorch 1.10.0 as the deep learning framework.\nThe learning rate momentum was set to 0.937, the batch size was 16, the initial learning rate\nwas 0.01, the weight decay was 0.0005, and the training round was 300 to prevent overfitting.\nThe evaluation index used in the experiments were precision, recall and mean average precision\n(mAP). The precision (P) and recall (R) are as follows:\n$P = \\frac{TP}{TP + FP}$\n$R = \\frac{TP}{TP + FN}$\nwhere, TP is the number of samples that were positive and also correctly classified as positive; FP\nis the number of samples that were negative but incorrectly classified as positive. FN is the number\nof samples that were positive but classified as negative.\nAfter obtaining the P and R of each category, a precision-recall (P-R) curve can be shown. AP is\nrepresented by the area surrounded by the P-R curve and coordinates, and mAP is the average of the\nAP values of all categories. The AP and mAP are calculated as follows:\n$AP = \\int_0^1 PdR$\n$MAP = \\frac{1}{N} \\sum_{k=1}^N AP(k)$"}, {"title": "4.3. Experimental results and analysis", "content": "4.3.1. Experimental results of the distance measurement in K-means clustering\nIn Section 3.2, we modified the distance measurement in K-means clustering. We replaced the\nEuclidean distance with the 1-IoU distance. Our improvement can make the anchor boxes generated\nbetter adapted to the transmission line key components image datasets. There are three sets of preset\nanchors in YOLOv5s, each containing three anchors of different dimensions and shapes. The three\nsets of anchors are used to detect small objects in an 80 \u00d7 80 feature map, medium-sized objects in a\n40 \u00d7 40 feature map, and large objects in a 20 \u00d7 20 feature map. Table 2 shows the anchor box sizes\nobtained by two distance measurement methods."}, {"title": "4.3.2. Experimental results for adding the CBAM attention mechanism", "content": "To solve the low recall of the model, we added the attention mechanism module to the\nYOLOv5s model to improve the model's attention to essential features. We tried several standard"}, {"title": "4.3.3. Experimental results for the focal loss function", "content": "Although the class imbalance has been improved after our dataset augmentation, the number of\nscrews and vehicles is still small in Section 4.1. In Table 4, the recall needs to be improved. After\nanalyzing the experimental results, we found that the recall of screws and vehicles was too low. It is\nmost likely due to the small sample images of these two categories.\nTherefore, we used the focal loss function to reduce the impact of class imbalance."}, {"title": "4.3.4. Ablation experiment", "content": "We conducted more detailed ablation experiments to verify our improvements' effectiveness\nfurther. Table 6 shows the results of all ablation experiments."}, {"title": "4.3.5. Overall detection results", "content": "The comparison between our improved model and the original YOLOv5s model is shown in\nFigure 11."}, {"title": "4.3.6. Comparison for model training", "content": "Figure 12 shows the loss change during the training for our improved model and the original\nYOLOv5s model."}, {"title": "4.3.7. Experimental comparisons with other models", "content": "We compared our improved model with the Faster R-CNN, SSD, CenterNet, YOLOv3,\nYOLOv4 and YOLOv5s models. We trained all object detection models using the same datasets with\nthe same division and parameters, and the comparison experiment results are shown in Figure 14."}, {"title": "4.3.8. Experimental comparison on other public insulator image dataset", "content": "The reference [30] provided an available insulator image dataset and proposed a novel deep\nconvolutional neural network (CNN) cascading architecture for localization and detecting defects in\ninsulators. The dataset is 840 composite insulator aerial images collected by UAV, and each image"}, {"title": "5. Conclusions", "content": "In this paper, we proposed an improved YOLOv5s model to meet the requirements of detecting\nkey components of power transmission lines. Our model can automatically detect the key\ncomponents of the transmission line, which is the preliminary work of the automatic transmission\nline inspection. The research work can reduce the workload and cost of transmission line inspection.\nWe modified the distance measurement in the K-means clustering, added the CBAM attention\nmechanism, and used the focal loss function. Our model improved the detection accuracy of key\ncomponents of power transmission lines. The experimental results show that our improved model\nachieves 98.1% mAP@0.5, 97.5% precision, and 94.4% recall. However, the speed of our improved\nmodel is slightly slower than the YOLOv5s model.\nNext, we will use fine-grained identification to detect the key components' defects and\nanomalies. We will refer to the references [36-38] for defect detection and abnormal detection of key\ncomponents of power transmission lines to improve intelligent detection of power transmission lines."}, {"title": "Conflict of interest", "content": "The authors declare there is no conflict of interest."}]}