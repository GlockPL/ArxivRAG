{"title": "Graph Neural Networks for Gut Microbiome Metaomic data: A preliminary work", "authors": ["Christopher Irwin", "Flavio Mignone", "Stefania Montani", "Luigi Portinale"], "abstract": "The gut microbiome, crucial for human health, presents challenges in analyzing its complex metaomic data due to high\ndimensionality and sparsity. Traditional methods struggle to capture its intricate relationships. We investigate graph neural\nnetworks (GNNs) for this task, aiming to derive meaningful representations of individual gut microbiomes. Unlike methods\nrelying solely on taxa abundance, we directly leverage phylogenetic relationships, in order to obtain a generalized encoder\nfor taxa networks. The representation learnt from the encoder are then used to train a model for phenotype prediction such\nas Inflammatory Bowel Disease (IBD).", "sections": [{"title": "1. Introduction", "content": "The gut microbiome, a community of microorganisms\nresiding within the human gut, plays a significant role in\nhealth and disease. Advancements in sequencing have\nyielded vast amounts of metaomic data, detailing the\ngut microbiome's composition and function. However\neffectively analyzing this high-dimensional data remains\na challenge. Traditional methods often fail to capture\nthe intricate relationships between the diverse microbial\nspecies within the microbiome.\nThis work explores the potential of graph neural net-\nworks (GNNs) for analyzing gut microbiome metaomic\ndata. GNNs, a powerful class of deep learning models\nadept at handling graph-structured data, hold promise for\nunraveling the complex relationships within the micro-\nbiome. Our primary objective is to develop a method that\nutilizes metaomic data to obtain a meaningful representa-\ntion of a patient's gut microbiome. In particular, we begin\nby constructing a network that captures the relationships\nbetween genes, species, and genus. This network is built\nusing the gene expression levels obtained from all pa-\ntient samples. By leveraging GNN techniques, we then\nlearn latent representations (embeddings) for each entity\nwithin the network. These embeddings capture the un-\nderlying functional relationships between genes, species,\nand genus. Finally, we aggregate these embeddings based\non a patient's specific gene expression profile to obtain\na global representation of their unique gut microbiome.\nThis patient-specific microbiome representation can then\nbe used by a classifier to predict a particular phenotype\nsuch as the presence or absence of Inflammatory Bowel\nDisease (IBD) as done in the present work.\nRecently, a wide rage of methods have been proposed\nto analyse microbiome data and use it to obtain predictive\nmodels for biomarkers discovery and classifying patients\nbased on some phenotype. Some of these methods rely\non the use of the microbiome features like the relative\nabundance of taxa. However, such approaches can be\nlimited by the inherent nature of microbiome datasets:\nsparsity and high dimensionality (e.g., the presence of\nmany features). This may lead to overfitting, with models\nfailing to generalize to other datasets [1].\nIn order to address these kind of limitations, many\nworks try to leverage the intrinsic phylogenetic infor-\nmation between taxa [2]. For example PopPhy-CNN [3]\nuses a CNN-based model that works on the 2D matrix\nderived from the phylogenetic tree representation.\nMIOSTONE [1] uses a gated phylogenetic encoded\nneural network. TaxoNN [4] leverages an ensemble of\nCNNs each specializing to particular taxonomic phylum.\nOur method directly builds upon the concept of lever-\naging phylogenetic relationships to create a meaningful\nrepresentation of the microbiome. We achieve this by\nemploying a GNN-based method to learn a generalized\nencoder specifically for the network of taxa. This encoder"}, {"title": "2. Dataset", "content": "The dataset in use is the IBDMDB which is described in\n[5] related to a IBD cohort of patients. The database con-\ntains observations coming from 2 different omic levels:\nmicrobiome metagenomics (MGX) and metatranscrip-\ntomics (MTX) gene expression levels (expressed in count\nper milion - CPMs) along with some other information\nrelated to the patient state and the presence of absence\nof IBD.\nDifferent omic levels have different number of samples\nand different number of features, and in particular:\n\u2022 Metagenomics: 1635 samples with 108433 fea-\ntures.\n\u2022 Metatranscriptomics: 736 samples with 70711\nfeatures.\nRegarding the patient labels, these are related to the\npresence of absence of IDB (binary). Notably, there are\n1594 patients with labels. The dataset has a quite substan-\ntial skew, since there are 83% negative and 17% positive\nsamples.\nThe dataset has a large dimensionality and a different\nrate of missing samples. To this end, our approach is\nto use methods which can deal with missing samples\nfor a particular omic-level and a different number of\nfeatures. Moreover, as already expressed in the previous\nsection, when dealing with metaomics, it can potentially\nbe useful to being able to model an interaction between\nthe different microorganisms."}, {"title": "3. Proposed Method", "content": "The main task we want to carry out is to obtain a mean-\ningful representation of a patient using the meta-omic\ndata coming from the analysis of gut microbiome samples.\nTo do this, the idea is to establish relationships among\nthe various microorganisms present in the microbiome,\nwhose presence is determined by the abundance of en-\nzymes/genes that characterize them, using the relational\ninformation of species and genus encoded within a graph.\nMoreover, since it is common to have incomplete datasets\n(either patients may have different gene expression or\nmissing data may come from a particular omic level), we\nmodel our task and the way of treating the data in a way\nthat allows transparency from this point of view. Figure 1\ngives an overview of the proposed pipeline.\nThe following subsections will describe how to get\nthe representation of a patient starting from the metage-\nnomic level. The same technique can be applied in the\nsame way to other omic levels and seamlessly integrated\nin this pipeline."}, {"title": "3.1. Graph Construction", "content": "Given a set of patients with gene expression levels of\ngut microbiome microorganisms, and associated data on\nenzymes, species, and genus (phylogenetic information)\nfor each microorganism, our aim is to construct a graph\n$G = (U, V)$ where:\n\u2022 $U$ denotes the set of nodes, encompassing en-\nzymes, species, and genus.\n\u2022 $V$ represents the set of edges, categorized\ninto two types: (enzyme, species) and\n(species, genus).\nOnce the phylogenetic graph is constructed, we can\nrepresent each patient $P_i$ as a subset of nodes $U_i \\subset U$,\nwhere the patient exhibits a gene expression level greater\nthan 0."}, {"title": "3.2. Graph Representation Learning\nModule", "content": "Given a graph $G$ that encodes the relationships between\ngenes, we aim to learn a representation (embedding) of\nthe nodes that reflects their connectivity within the net-\nwork. To achieve this, we leverage established methods\nfrom the field of graph representation learning, specifi-\ncally: Graph Laplacian Eigenvector Positional Encoding\nRandom Walk Positional Encoding, and Node2Vec.\nHere, we provide a concise description of each method.\nGraph Laplacian Eigenvector Positional Encoding\n(LPE): this technique relies on the factorization of the\ngraph's Laplacian matrix. The embedding for a node\nis defined by the k-smallest, non-trivial eigenvectors\nassociated with that node [6].\nRandom Walk Positional Encoding (RWPE): This\napproach, as described in [6], utilizes the random walk\nmatrix to generate node embeddings.\nNode2Vec (N2V): This method, presented in [7], is a\nsemi-supervised algorithm that leverages random walks\non the graph to learn meaningful features for the nodes."}, {"title": "3.3. Aggregation Function", "content": "Having obtained embeddings for all the nodes in the\ngraph, we now require a methodology to aggregate a\nsubset of these embeddings into a single vector that rep-\nresents a patient. Two aggregation levels are employed\nfor this purpose."}, {"title": "3.4. Different Omic Levels Integration", "content": "Previous sections have outlined the methodology for\ntransforming gene abundance data (obtained from a\nmetagenomic analysis) of a patient's microbiome into\na single patient representation. However, incorporating\nmetatranscriptomic features is straightforward. We sim-\nply include genes identified at the transcript level during\nthe construction of the phylogenetic graph, these addi-\ntional nodes are then considered when generating the\npatient representation."}, {"title": "4. Experimental results", "content": "To evaluate the performance of our proposed method,\nwe conducted preliminary experiments using the IBD\ndataset described in Section 2. These experiments aimed\nto investigate the method's effectiveness in predicting\nthe presence or absence of IBD under various parameter\nsettings. We addressed the following key questions:\nQ1. Node Embedding Comparison: which node\nembedding technique (LPE, RWPE, N2V) yields\nthe best performance?\nQ2. Impact of Multi-Omics Integration: how does\nthe model's performance vary when using dif-\nferent omic levels as input: metagenomics only\nversus metagenomics combined with metatran-\nscriptomics?\nQ3. Gene Selection Strategy: how does the number\nof genes considered during patient representation\ngeneration impact the final model performance?\nFor the final classification task utilizing patient rep-\nresentations as input features, we employed a Support\nVector Machine (SVM) classifier using a Radial Basis Func-\ntion (RBF). Our choice of a relatively simple model reflects\nour primary focus on evaluating the efficacy of the graph\nrepresentation techniques."}, {"title": "4.1. Evaluation of Node Embedding\nTechniques (Q1)", "content": "To assess the performance of different node embedding\ntechniques (LPE, RWPE, N2V), we employed an 80/10/10"}, {"title": "4.2. Impact of Omic Levels (Q2)", "content": "To assess the influence of data derived from different\nomic levels on model performance (Q2), we trained two\ndistinct models. The first model used only data from the\nMGX level, while the second incorporated data from both\nmetagenomics (MGX) and metatrascriptomics (MTX) lev-\nels. Importantly, the evaluation for Q2 employed the\nsame experimental setup established for Q1 (detailed in\nthe previous section). The corresponding results for both\nmodels are presented in Table 1. From the results it is\npossible to notice that the model trained using only MGX\ndata sligthly underperforms with respect to the model\nthat includes MTX data."}, {"title": "4.3. Gene Selection Strategy (Q3)", "content": "Relatively to Q3, we focused on the model trained us-\ning the LPE encoding for the phylogenetic graph. To\nobtain the representation of a patient, we trained the\nmodel using as features a different number k of genes.\nIn particular, we considered the top-k most expressed\ngenes. Moreover, we also compared the results between\nthe two datasets (MGX-only, MGX+MTX). As shown in\nFigure 2, the model's ROC-AUC initially increases with\nthe number of features, peaking at a certain point before\na slight decrease and stabilization. This likely reflects\nthe importance of highly expressed genes for class sep-\naration. Genes with lower expression levels are likely\nto carry less information. Interestingly, despite a small\ndifference, the optimal number of genes differs between\nthe datasets. The MGX-only model achieves its peak\nROC-AUC with 3568 genes, while the MGX+MTX model\npeaks at 3366. This might suggest that the MTX data pro-\nvides additional useful information, resulting in a smaller\nnumber of necessary genes."}, {"title": "5. Conclusion and future work", "content": "This paper proposes a method leveraging Graph Neural\nNetworks (GNNs) to extract phylogenetic information\nfrom microbiome metagenomics data. The method aims\nto create a generalizable encoder for the microbiome, en-\nabling its application to phenotype classification tasks.\nThe approach achieves good performance on real-world\ndatasets even with simple classification models, although\nit falls short of models specifically designed for classifi-\ncation tasks [9]. Future work will involve:\n\u2022 Expanding comparisons with other methods.\n\u2022 Evaluating performance on additional datasets."}]}