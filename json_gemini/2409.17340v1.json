{"title": "Koopman-driven grip force prediction through EMG sensing", "authors": ["Tomislav Bazina", "Ervin Kamenar", "Maria Fonoberova", "Igor Mezi\u0107", "Fellow, IEEE"], "abstract": "Abstract\u2014Loss of hand function due to conditions like stroke or multiple sclerosis significantly impacts daily ac- tivities. Robotic rehabilitation provides tools to restore hand function, while novel methods based on surface elec- tromyography (sEMG) enable the adaptation of the device's force output according to the user's condition, thereby im- proving rehabilitation outcomes. This study aims to achieve accurate force estimations during medium wrap grasps us- ing a single sEMG sensor pair, thereby addressing the chal- lenge of escalating sensor requirements for precise predic- tions. We conducted SEMG measurements on 13 subjects at two forearm positions, validating results with a hand dynamometer. We established flexible signal-processing steps, yielding high peak cross-correlations between the processed SEMG signal (representing meaningful muscle activity) and grip force. Influential parameters were sub- sequently identified through sensitivity analysis. Leverag- ing a novel data-driven Koopman operator theory-based approach and problem-specific data lifting techniques, we devised a methodology for the estimation and short-term prediction of grip force from processed SEMG signals. A weighted mean absolute percentage error (wMAPE) of ~5.5% was achieved for the estimated grip force, whereas predictions with a 0.5-second prediction horizon resulted in a wMAPE of ~17.9%. The methodology proved robust regarding precise electrode positioning, as the effect of sensing position on error metrics was non-significant. The algorithm executes exceptionally fast, processing, estimat- ing, and predicting a 0.5-second sEMG signal batch in just ~30 ms, facilitating real-time implementation.", "sections": [{"title": "I. INTRODUCTION", "content": "THE concept of sensing gripping force from muscle ac- tivity through the non-invasive surface electromyography (SEMG) method is based on a group of muscle fibers called motor units (MU), which are activated by brain motor neurons.\nThe EMG signal is obtained as an interference of firing signals from each MU, known as motor unit activation potential (MUAP). Factors such as electrode placement, size, and inter- electrode distance, as well as tissue characteristics (such as fat layers and skin conductivity), temporal and spectral character- istics of the firing patterns, and cross-talk from neighboring muscles, all influence the variability of the EMG signal [1].\nIn [2], the authors predicted pinching force using a 6- channel SEMG sleeve, focusing on the RMS feature of the signal. They employed the gene expression programming algorithm and reported RMSE errors of 7.5-8.5% and cross-correlation coefficients up to 95%. The study examined four MVC levels (20%, 40%, 60%, and 80%) but did not test predictions near the transient states between these levels. In [3], the authors used sEMG with four bipolar electrodes on the forearm and finger force signals to predict grip force. They employed five EMG features and eleven finger force features, achieving a mean accuracy of 90% for grip force prediction in the transient phase. The study found that optimal sensing stabilized at three positions with 2\u20134 features. Elec- trode positioning on the forearm for grip force sensing was also explored in [4]. The study identified the brachioradialis muscle as optimal based on EMG signal strength. In [5], EMG signals were acquired using an eight-channel Myo's armband, and an LSTM network predicted normalized pinching force 1, 3, and 5 seconds ahead directly from the EMG data. Based on [6], which used eight sEMG sensors and 24 healthy subjects, extrinsic muscle coordination reliably predicted grip and pinch force levels due to its greater sensitivity to force changes compared to intrinsic muscles. Some studies, including [7] and [8], have focused on predicting gripping force from the transient phase of EMG signal, which is the initial burst when the muscle begins exerting force. In [7], a high-density 192- channel SEMG sensor setup was employed on 12 subjects to predict grasp force. This prediction utilized ten features and regularized linear regression, achieving absolute errors as low as 2.5% of MVC. Additionally, in [8], online predictions of gripping force were obtained from 8 SEMG sensors placed on the forearms of 16 participants. The model included ten features extracted from the EMG signal. Predictions were made 330 ms ahead using the elastic net regression algorithm, resulting in errors of 2% of MVC.\nIt is evident from the above analysis, as well as the findings highlighted in [9], that while the majority of the research has achieved favorable results in terms of accuracy, it relies on a high-and constantly increasing number of necessary"}, {"title": "II. MATERIALS AND METHODS", "content": "This study involves obtaining time-series data on human muscle activity through sEMG and measuring hand grip force with a manual dynamometer. The dynamometer's shape neces- sitated a medium wrap type of grasp, following the taxonomy developed by [11] and further refined by [12]. This approach contrasts with some studies, such as [4], which use the strength of the EMG signal as a criterion for predicting grip force.\nTo minimize prediction errors, we considered SEMG po- sitioning on the forearm to maximize signal measurement. Advanced signal processing techniques were employed to extract relevant features from the EMG signals and establish a robust correlation with grip force. Offline optimization of decision variables was also conducted.\nA crucial aspect of the research involves the signal filtering step, essential for proper inferences using EMG signals, which are often largely affected by noise and cross-talk between muscles. The signals are typically processed using notch filtering at 50 Hz to eliminate ground noise [3], bandpass filtering between approximately 10 and 500 Hz to remove wire movement artifacts [6]\u2013[9], bandpass filtering between 100 and 500 Hz [4], and bandpass filtering that captures only power spectrum peaks between 20 and 60 Hz [5]. In contrast to such \"general\" filtering approaches, we focused on signal process- ing aimed at extracting only meaningful features (comparable to observables in KOT) from the sEMG signal\u2014those highly correlated with grip force\u2014that can later be applied within the KOT framework for accurate modeling and prediction. This strategy reflects elements of the structural approach to SEMG modeling in [1], which states that recruiting MUs is fundamental for generating muscle force. When more MUs are recruited, the muscle produces greater force, and the firing rate of each MU further amplifies this force. Generally, MU firing rates increase almost linearly with the muscle's force output. These firing patterns and the interference between the active MUs influence the characteristics of the measured sEMG. We aim to isolate the difficult-to-identify signal components, specifically the recruited MUs, their interference patterns, and firing rates that predominantly contribute to measured grip force during a medium wrap. This approach helps separate the meaningful signal from unwanted noise. We utilized Fast Fourier Transformation (FFT) and sensitivity analysis (SA) to develop a spectral mask that selectively targets specific spectral components to achieve this. The aim is to develop a fully integrated module for EMG signal preprocessing, including calibration and normalization. Additionally, the module will incorporate grip force prediction using the KOT.\nIn Section II-A, we describe the hardware components and their calibration. Section II-B explains the composition of EMG signal processing steps and describes the SA and optimization methods. Finally, Section II-C delves into the details of the Koopman methodology used for predicting and estimating hand grip force from EMG signals."}, {"title": "A. Experimental Setup & Design", "content": "Two different sensing devices were used during the ex- perimental phase: Shimmer3 EMG Unit\u00b9 for muscle activity sensing and Vernier Go Direct\u00ae Hand Dynamometer\u00b2 for grip force measuring. Both devices are wireless and connect to PC through Bluetooth. The EMG sensing unit records the electrical activity on the skin surface associated with muscle contractions. It can capture response signals from entire muscle groups but is commonly prone to noise. In the performed experiments, the EMG sampling rate was set to 1 kHz. A maximum internal gain of 12 was used, and an internal calibration procedure was followed. The dynamometer, with a force range of 0 to 550 N, a resolution of 0.05 N, and an uncertainty of 1.96 standard deviations (95% confidence interval), was used at a sample rate of 200 Hz.\nBefore performing experiments, the reference dynamometer was calibrated in-house according to ASTM E74: Standard Practices for Calibration and Verification for Force-Measuring Instruments norm. Calibration weights of OIML classes F1, M1, and M3 were used, and the laboratory temperature was maintained at approximately 23\u00b0C. Calibration forces ranged from 0 to 550 N in steps of 5, 20, 50, 100, 150, 200, 250, 300, 350, 400, 450, 500, and 550 N. The instrument was first preloaded from minimum to maximum force to establish hysteresis. Each measurement was preceded by reducing the instrument to zero between successive loadings, and the entire process was repeated three times. For measured forces greater than 50 N, the uncertainty as a percentage of the measured force is less than 4%, while for forces below 50 N, the percentage can be as high as 10%. The obtained calibration equation that relates the raw dynamometer signal \\(g_r\\) to the reported grip force \\(g\\) is:\n\\[\u011d = 1.0629g_r - 2.5880 \\times 10^{-4}g_r^2 \u2013 9.0028 \\times 10^{-8}g_r^3 + 7.6152 \\times 10^{-10}g_r^4.\\]"}, {"title": "B. Multi-step sensitivity analysis and procedural parameter optimization", "content": "The optimization procedure aims to maximize the peak cross-correlation between the processed EMG signal and the synchronously collected grip force. We performed multi-step SA to identify the most influential spectral components and narrow the optimal bounds for decision variables. Narrowing was achieved by examining scatterplot projections of individ- ual decision variables with smoothed trends and means using Latin hypercube (LH) sampling. Simultaneous optimization and SA ensure that cross-correlations remain near their op- timal values, even when small variations are introduced. This approach enhances local robustness, helping to avoid unstable maxima and maintain consistent performance.\nFirst, data is processed in batches of approximately 0.5 seconds (496 data points) with a sampling rate of 992.97 Hz for EMG signals. Each batch is transformed into the frequency domain using FFT, achieving a resolution of 2.002 Hz. A spectral mask, obtained through an optimization process, is then applied to attenuate or amplify frequency components selectively. After modifying the amplitudes, an inverse FFT reverts the signal to the time domain. Signal rectification is performed by taking the absolute value, followed by windowed exponential moving average (MA) smoothing. The smoothing window is applied within each batch, except for the first (window size - 1) points, where data from the previous batch is utilized. In addition to the spectral mask, the optimization also targets finding the optimal window size and decay factor for exponential smoothing. The entire process for obtaining optimal processed EMG signal is schematically outlined in Fig. 2. The high-dimensional optimization problem was for- mulated to maximize the mean peak cross-correlation across all measurements using a decision vector comprised of 250"}, {"title": "C. Koopman-driven estimation and prediction of hand grip force", "content": "The first part of this subsection briefly introduces the KOT and relevant literature, while the second and third detail its application to grip force estimation and prediction, respec- tively. The entire framework is designed so that the subject first performs a one-time, 20\u201330-second calibrating experiment simultaneously using sEMG sensors and a dynamometer, with grip force levels approximating those in Table I. Then, the meaningful processed EMG signal is obtained, and the estimation model is trained on the entire calibrating dataset. The estimation model is then used in batch processing to approximate grip force from the processed EMG, using only the data under the window. The obtained approximation is finally used to forecast grip force over a 0.5-second horizon or for the next batch.\nThe state-space representation of a dynamical system in- volves defining an n-dimensional state space manifold, de- noted by M. The states x belong to M, and the discrete-time evolution of the system is given by:\n\\[X_{i+1} = F(x_i),\\]\nHere, F is the potentially nonlinear state transition function F : M \u2192 M, and \\(x_{i+1}\\) represents the time-shifted state. Modeling a system in state space generally requires capturing nonlinearities, which are essential for accurately describing dynamical behavior but can be highly complex or even impos- sible. To address this challenge, we adopt an operator-theoretic perspective on the dynamics of observables [10]. The behavior of the nonlinear system (2) is thus mapped onto the dynamics of observables of x defined as \\(\\phi(x)\\). Please note that, due to the nature of the system in question, this work focuses specifically on real-valued observables, \\(\\phi : M \\rightarrow R\\).\nCollecting all possible observables constitutes a vector space that is generally infinite-dimensional. The Koopman operator, K, that describes the evolution of observables over a discrete time interval \\(\\Delta t\\), is defined as [16]:\n\\[\\phi(x_{i+1}) = K\\phi(x_i) = \\phi[F(x_i)].\\]\nRemarkably, even if the underlying state space system is non- linear, K remains linear [10]. This linearity holds regardless of the specifics of the dynamics of the observables.\nIn contrast to the dynamical systems, the Koopman operator can also describe \"static\" nonlinear maps between different spaces [17] M \u2192 N, a property that we use in this work for estimating grip force from processed EMG signals. Through lifting and proper choice of observables, we can describe nonlinear maps using spaces of observables and a linear mapping operator K : OM \u2192 ON. To apply the theory to the problem under consideration, the processed EMG signal (e) is lifted using the vector of functions \\(\\phi\\), and the measured grip strength (gi) is lifted using the vector of functions \\(\\psi\\). The input and output matrices with N realizations of the lifted variables (ei, gi) can then be written as:\n\\[E = [\\phi(e_1), ..., \\phi(e_n)], \\quad G = [\\psi(g_1), ..., \\psi(g_n)].\\]\nThe approximation of the static Koopman operator is obtained by minimizing the Frobenius norm [17]:\n\\[\\min_{K} ||G - KE||_F \\quad K = GE^{\\dagger},\\]"}, {"title": "IV. CONCLUSION", "content": "This research focuses on developing real-time procedures for sensing hand muscle activity and estimating the exerted force by a subject, with potential applications in controlling rehabilitation devices and tracking patient recovery between rehabilitation sessions. The methodology involves sensing muscle activity (physiological signals) using non-invasive surface electromyography (sEMG) sensors. The signals are cross-correlated with synchronously collected hand grip force, determined using a force-calibrated hand dynamometer as part of a properly designed experiment. We devise the composition of the SEMG signal processing steps to achieve a strong peak cross-correlation (~96%) between meaningful muscle activity and grip force. We optimized decision variables to maximize cross-correlation: spectral mask, smoothing window size, and decay rate. Finally, we employed a data-driven approach using only the processed EMG signal acquired from a single sensing location. The static Koopman operator was utilized for accurate force estimation, while the Koopman operator for dynamic systems was used for short-term grip force prediction. The algorithm follows these steps within the framework: processing raw EMG data, transforming and lifting the data for estimation, applying the estimation model, smoothing the estimates and lifting them for prediction, train- ing the prediction model online, and generating forecasts.\nThe Koopman-based methodology proved efficient, with an average weighted mean absolute percentage error of approxi- mately 5.5% for estimations and 17.9% for predictions. Addi- tionally, the method proved robust to varying sensing locations, as its effectiveness was evaluated at two different measurement points. It requires less than 30 seconds to perform a one- time, patient-specific calibrating experiment using both sEMG sensors and a hand dynamometer, followed by 1.5 seconds for estimation model training. The experimental assessment demonstrated rapid execution, requiring only 30 ms to generate 0.5-second predictions once the last 0.5-second data batch is received. Consequently, the developed framework is ready for real-time implementation.\nFuture work will integrate the developed Robot Operating System (ROS) modules for interacting with sensors, data acquisition, and signal processing with a real-time Koopman- driven hand grip force estimation and prediction module, based on the methods presented in Section II-C. Additionally, the advancements in simplifying hand kinematics presented in [23] will be incorporated to develop a comprehensive system, including a human agent model with various grasp modalities. This holistic approach aims to accelerate the development of sophisticated robotic rehabilitation devices, enhancing their effectiveness and adaptability to individual patient needs."}]}