{"title": "GRAPH NEURAL NETWORK FOR CEREBRAL BLOOD FLOW PREDICTION WITH CLINICAL DATASETS", "authors": ["Seungyeon Kim", "Wheesung Lee", "Sung-Ho Ahn", "Do-Eun Lee", "Tae-Rin Lee"], "abstract": "Accurate prediction of cerebral blood flow is essential for the diagnosis and treatment of cerebrovascular diseases. Traditional computational methods, however, often incur significant computational costs, limiting their practicality in real-time clinical applications. This paper proposes a graph neural network (GNN) to predict blood flow and pressure in previously unseen cerebral vascular network structures that were not included in training data. The GNN was developed using clinical datasets from patients with stenosis, featuring complex and abnormal vascular geometries. Additionally, the GNN model was trained on data incorporating a wide range of inflow conditions, vessel topologies, and network connectivities to enhance its generalization capability. The approach achieved Pearson's correlation coefficients of 0.727 for pressure and 0.824 for flow rate, with sufficient training data. These findings demonstrate the potential of the GNN for real-time cerebrovascular diagnostics, particularly in handling intricate and pathological vascular networks.", "sections": [{"title": "1. INTRODUCTION", "content": "Various simulation models have been developed to predict cerebral blood flow (CBF) in the brain. For example, Moore et al. [1] developed a 1D flow model for the circle of Willis (CoW) and compared the simulation results with 3D computational fluid dynamics simulation. Alastruey et al. [2] assessed the effect of CoW geometry variations on cerebral flow. In 2009, Grinberg et al. [3] simulated the human intracranial arterial tree using an unsteady 3D flow model with one billion degrees of freedom. Perdikaris et al. [4] proposed a multiscale model for brain blood flow. Pegolotti et al. [5] suggested a reduced-order model for cardiovascular system based on graph neural network (GNN). Nevertheless, current simulation models are complex and based on 3D vascular structures, which would be challenging in clinical studies.\nIn this study, we propose a development process of GNN to predict blood flow in the cerebrovascular system. Specifically, the patient group is focused on stenosis cases on the middle cranial artery (MCA). The reference datasets of patients are based on MR angiography-Time of Flight (MRA-TOF). A mathematical model for blood flow prediction is engaged to amplify training and testing datasets for GNN. The datasets for GNN are consist of various flow input conditions, geometry and connectivity to test the performance."}, {"title": "2. METHOD", "content": ""}, {"title": "2.1. Vessel Segmentation and Refinement", "content": "Segmentation of blood vessels is performed after importing magnetic resonance angiography (MRA) images in NIfTI format. The images are preprocessed by smoothing with Gaussian filters, followed by hysteresis thresholding to remove noise and detect vessel voxels [6]. The coordinates of points above the threshold are extracted to form a point cloud. This point cloud data is further refined using DBSCAN [7] clustering to remove noise and filter out non-vessel points. Based on these results, the indices of points identified as vessel voxels are set to 1, reconstructing a 3D array."}, {"title": "2.2. Link Prediction and Network Construction", "content": "To create a NetworkX graph [8], each voxel in the array is examined to determine its neighbors, and the voxels are classified as either branch nodes or non-branch nodes. As the neighbors of each voxel are checked, edges are created by connecting to branch node voxels that share a cluster number."}, {"title": "2.3. Mathematical Model for Blood Flow Prediction", "content": "The movement of blood through a vessel segment can be assumed as a Poiseuille flow model:\n$Q = \\frac{\\pi d^4}{128\\mu L} \\Delta P$ (1)\nwhere $Q$ is the flow rate in the blood vessel, $d$ is the vessel diameter, $L$ is the vessel length, $\\Delta P$ is the pressure drop between the i-th and j-th nodes and $\\mu$ is the blood viscosity. In addition, if the two diameters at the i-th and j-th nodes ($d_i$ and $d_j$) are different, the average value, i.e. $d = (d_i + d_j)/2$, is used to calculate Eq. (1). The pressure values at the nodes of the vascular geometry were the unknown we wanted to solve. To solve the unknown pressure values, the conservation law of flow rates at a bifurcation can be defined as:\n$\\Sigma Q_i = 0$ (2)\nwhere $Q_i$ is the flow rates at the i-th bifurcation junction. More details are given in [9]."}, {"title": "2.4. GNN Model", "content": "MeshGraphNets MeshGraphNets [10] is structured with an Encoder, Processor, and Decoder. The Encoder converts the physical properties of nodes and geometric information of edges into latent representations. In the Processor, nodes exchange information through a message-passing mechanism across edges, allowing physical and geometric data to propagate throughout the mesh. Finally, the Decoder infers changes in the physical quantities from the latent node vectors, predicting the system's dynamics for the next time step.\ngROM The gROM (Reduced-Order Models with GNNs) [5] is inspired by MeshGraphNets, adapting its core principles for real-time simulations of blood flow in cardiovascular systems. While MeshGraphNets are designed to simulate high-fidelity physical dynamics, gROM focuses on improving efficiency by simplifying the model for real-time simulations."}, {"title": "3. EXPERIMENTS", "content": ""}, {"title": "3.1. Experimental Setup", "content": "Dataset Acquisition In this study, we utilized MRA datasets, comprising a total of 35 cases. The dataset includes 25 patients diagnosed with cerebral infarction, 3 with transient ischemic attacks, 2 with basilar artery stenosis, and 5 with other cerebrovascular conditions, such as paresthesia, vascular dementia, and seizures. The patients ranged in age from 42 to 84 years (mean age: 65.8 years), with a gender distribution of 21 males and 14 females. MRA-TOF scans were performed using 3T MRI systems (Verio or Skyra, Siemens Healthineers, Germany). The imaging parameters for MRA-TOF included an echo time of 3.7 ms, repetition time of 21 ms, flip angle of 18\u00b0, a field of view of 167 x 260 mm, slice thickness of 0.5 mm, and an inter-slice spacing of 20 mm.\nDataset Preprocessing The original dataset of 35 individuals was processed into graph structures containing information on graph directionality, multigraph status, node attributes, edge attributes, inlet node IDs, and outlet node IDs. These graph representations were then augmented to create 25 datasets per individual, resulting in a total of 875 datasets. During the augmentation process, inlet pressure was randomly set between 12,000 Pa and 18,000 Pa, and the vessel radius was randomly adjusted between 0.8 and 1.2 times its original size. The augmentation aimed to enhance the model's generalizability by introducing variability within the dataset. Given that the dataset included stenosis cases, the adjustments in vessel radius were made to reflect realistic pathological ranges [11].\nImplementation Details For training the GNN, the initial learning rate was set to 0.001, with a gradual decrease following a cosine annealing schedule. The minimum learning rate was set to 10-6, and training was conducted over a total of 500 epochs. The Mean Absolute Error (MAE) was used as the loss function, and the Adam optimizer was employed to optimize the model.\nEvaluation Methods To ensure a robust evaluation of the GNN's performance, 5-fold cross-validation was employed. During each fold, the GNN was trained using data from 28 distinct network structures and tested on 7 completely different network structures, with each network expanded to 25 datasets. The version selected for evaluation in each fold was the one that achieved the best performance, as measured every 100 epochs. Performance evaluation was conducted by comparing the GNN's predictions of blood flow and pressure values with the results generated by the mathematical model.\nThe accuracy (R) was calculated based on the difference between the predicted values (both blood flow and pressure) from gROM and the actual values derived from the mathematical model. Specifically, accuracy was measured by counting the number of nodes where the error margin between the predicted and actual values was within 10%. The formula used to compute this accuracy is given as follow:\n$R = \\frac{1}{n}\\Sigma(H \\times \\frac{\\mid v_{pred}-v_{true}\\mid}{max(v_{true})} \\times 100(\\%))$ (3)\nIn this equation, $v_{pred}$ represents the predicted values, while $v_{true}$ refers to the actual values obtained from the cerebral vascular model. The term $max(v_{true})$ is the maximum value of $v_{true}$, used to normalize the error. The function $H(x)$, defined as:\n$H(x) = \\begin{cases} 1, & \\text{if } x < 0.1 \\\\ 0, & \\text{otherwise} \\end{cases}$ (4)\nreturns 1 if the normalized error between the predicted and actual values is less than 10%, and 0 otherwise. The overall accuracy (R) is the percentage of nodes where the error falls within this threshold.\nAdditionally, to analyze the correlation between the predicted and actual values of flow rate and pressure, the Pearson's correlation coefficient was employed as a metric for accuracy evaluation."}, {"title": "4. DISCUSSION", "content": "This paper applied a gROM to predict blood flow and pressure in human cerebral vasculature, utilizing MRA datasets from 35 individuals, augmented to 875 datasets. The study demonstrated the feasibility of adapting a model originally developed for cardiovascular and pulmonary vessels to cerebral arteries. While the gROM approach showed promise, it exhibited reduced accuracy when applied to previously unseen network configurations. The model particularly struggled with complex topologies due to stenosis in all datasets, underscoring the challenges in modeling pathological vascular networks. In conclusion, gROM shows significant potential for cerebral blood flow prediction but requires further refinement for complex vascular structures. Future work should focus on expanding datasets and improving augmentation techniques to enhance the model's generalizability and performance in pathological cases."}, {"title": "5. COMPLIANCE WITH ETHICAL STANDARDS", "content": "This study was approved by the Institutional Review Board of Pusan National University Yangsan Hospital, with approval number 55-2024-044. Informed consent was obtained from all individual participants included in the study."}]}