{"title": "Fuzzy Granule Density-Based Outlier Detection with Multi-Scale Granular Balls", "authors": ["Can Gao", "Xiaofeng Tan", "Jie Zhou", "Weiping Ding", "Witold Pedrycz"], "abstract": "Outlier detection refers to the identification of anomalous samples that deviate significantly from the distribution of normal data and has been extensively studied and used in a variety of practical tasks. However, most unsupervised outlier detection methods are carefully designed to detect specified outliers, while real-world data may be entangled with different types of outliers. In this study, we propose a fuzzy rough sets-based multi-scale outlier detection method to identify various types of outliers. Specifically, a novel fuzzy rough sets-based method that integrates relative fuzzy granule density is first introduced to improve the capability of detecting local outliers. Then, a multi-scale view generation method based on granular-ball computing is proposed to collaboratively identify group outliers at different levels of granularity. Moreover, reliable outliers and inliers determined by the three-way decision are used to train a weighted support vector machine to further improve the performance of outlier detection. The proposed method innovatively transforms unsupervised outlier detection into a semi-supervised classification problem and for the first time explores the fuzzy rough sets-based outlier detection from the perspective of multi-scale granular balls, allowing for high adaptability to different types of outliers. Extensive experiments carried out on both artificial and UCI datasets demonstrate that the proposed outlier detection method significantly outperforms the state-of-the-art methods, improving the results by at least 8.48% in terms of the Area Under the ROC Curve (AUROC) index. The source codes are released at https://github.com/Xiaofeng-Tan/MGBOD.", "sections": [{"title": "1 INTRODUCTION", "content": "DETECTING samples or patterns that deviate from the majority of data are both meaningful and practical, and helps to monitor risky behaviors, rare events, and abnormal observations in real-world tasks. Outlier detection [1], [2], [3], also known as anomaly detection, is an effective method that aims to find anomalous samples from the data. Due to its practicality and effectiveness, outlier detection has become an important research topic in the fields of data mining and machine learning, and has been extensively used in a variety of domains such as intrusion detection [4], financial fraud [5], and video surveillance [6]. Existing outlier detection methods [1] can be categorized into supervised, semi-supervised, and unsupervised methods in terms of the availability of labeled data. Among them, unsupervised methods have attracted increasing attention and play a crucial role in outlier detection. Generally speaking, unsupervised outlier detection methods [1] can be divided into: statistical-based methods [7], distance-based methods [8], density-based methods [9], clustering-based methods [10], ensemble-based methods [11], and others [12]. Owing to the lack of label information, these unsupervised outlier detection methods have been carefully designed with specific assumptions. For example, statistic-based methods generally assume that normal samples follow a prior distribution, allowing the identification of outliers by using statistical information. Distance-based methods suppose that outliers are far from inliers, and thus the distance between a sample to its neighbors can be used as an effective measure of outlierness. Density-based methods postulate that normal samples are aggregated in regions with high density, and a sample with low density can be considered an outlier. While clustering-based methods are performed with the assumption that samples can be grouped into clusters, and outliers are either difficult to cluster or located in small clusters. Obviously, the performance of these methods highly relies on the conformity of the assumptions with underlying outliers. Moreover, most of these methods are developed to deal with numerical data and may be ineffective in detecting outliers from data with categorical attributes. Rough set theory (RST) [13], [14], as an effective soft computing method for knowledge representation and approximate reasoning, is effective in handling categorical data entangled with vagueness, imprecision, and uncertainty. Rough sets have also been used for outlier detection because of the superiority of representing the relationship of samples with categorical attributes [15]. Jiang et al. [16]"}, {"title": "2 PRELIMINARIES", "content": "This section presents some related concepts in fuzzy rough sets and granular ball-based learning, whose detailed information can be referred to [35], [36]."}, {"title": "2.1 Fuzzy rough sets", "content": "In fuzzy rough sets, the available data consist of a set of samples U described by a finite attribute set A. On each attribute \\( a \\in A \\), a mapping function \\( f \\) associates each sample \\( x \\in U \\) with a value from the domain of the attribute a, i.e., \\( f(x, a) \\in V_a \\). If there is no decision attribute in A, the data is also referred as to a fuzzy information system and formally represented as FIS = (\u00da, A, V, f), with \\( V = \\bigcup_{a \\in A} V_a \\)\nDefinition 1 (fuzzy relation) A fuzzy relation R on U is defined as \\( R: U \\times U \\leftrightarrow [0,1] \\) and satisfies the following properties: [35]\n(1)\nReflexivity: R(x, x) = 1;\n(2)\nSymmetry: R(x, y) = R(y, x);\n(3)\nTransitivity: \\( R(x, z) \\ge \\bigvee_{y \\in U} (R(x, y) \\land R(y, z)) \\),\nwhere R(x, y) denotes the degree of fuzzy similarity between the samples x and y given the fuzzy relation R.\nDefinition 2 (fuzzy granule) Let FIS = (U,A,V, f) be a fuzzy information system. For any attribute subset B C A, it determines a fuzzy relation \\( R_B \\) that forms a family of fuzzy granules on U, which is defined as [35]\n\\( U/R_B = {[X_1]_B, [X_2]_B,..., [X_i]_B,..., [I_n]_B} \\), (1)\nwhere \\( [x_i]_B \\) denotes the fuzzy granule of the sample \\( x_i \\), which is defined as \\( [x_i]_B = (R_B(x_i,X_1), R_B(x_i, x_2), ..., R_B(x_i,x_n)) \\), and the cardinality of the fuzzy granule \\( [X_i]_B \\) is calculated as \\( [x_i]_B = \\sum_{j=1}^{n} R_B(x_i, x_j) \\), with \\( 1 \\le |[x_i]_B| \\le n \\)."}, {"title": "2.2 Granular ball-based learning", "content": "Granular computing [37] is known as a philosophy and methodology that simulates human thinking to solve complex problems, which encompasses all the theories, methods, and techniques related to information granularity. It solves complex problems by granulating and abstracting them into simpler sub-problems under different levels of granularity and has been widely applied in fields such as intelligent information processing, decision-making with uncertainty, and knowledge discovery. Inspired by the cognitive mechanism of the human brain, Xia, et al [38] proposed the method of granular ball computing, which represents data with granular balls to perform clustering and classification tasks."}, {"title": "3 THE PROPOSED METHOD", "content": "In this section, we first outline the overall framework of the proposed multi-scale outlier detection method. Then, we elaborate on the improved fuzzy granule density-based outlier detection method as well as multi-scale granular ball computing. Finally, we present the multi-scale outlier detection method using a weighted support vector machine."}, {"title": "3.1 Overall framework", "content": "FRS is an effective method for outlier detection, which utilizes the fuzzy similarity relation to granulate samples and further employs the concept of fuzzy granules to compute the outlier score of each sample. Intrinsically, FRS-based outlier detection is a distance-based method that excels at identifying global outliers. However, practical data may contain different types of outliers, such as local, global, and group outliers, which poses a substantial challenge to FRS- based outlier detection methods. In fact, density information plays a crucial role in identifying local outliers. By estimating the sample density in the local region, some outliers located in low-density regions can be detected efficiently. On the other hand, multi-scale views are inherently beneficial for detecting different types of outliers. For instance, in the"}, {"title": "3.2 Fuzzy rough sets with relative granule density for outlier detection", "content": "To overcome the drawback that RST can not efficiently handle numerical data, FRS has been introduced for outlier detection [30], [31]. In fact, the FRS-based methods are good at detecting global outliers but ineffective in identifying local outliers since the fuzzy similarity relation is used to measure the distance of samples. On the contrary, density- based outlier detection methods are effective in detecting local outliers. Intuitively, introducing density information into FRS is beneficial to improve the performance of outlier detection. In this study, the relative density information is integrated into FRS-based outlier detection methods to recognize both global and local outliers."}, {"title": "3.3 Multi-scale granular ball computing", "content": "FRS-based outlier detection is an effective distance-based method. Nevertheless, distance-based outlier detection methods encounter challenges when dealing with group outliers. Multi-view learning that leverages information from different views has been shown to be a useful technique for improving model performance. To effectively identify different types of outliers, we employ the technique of granular-ball computing to generate multi-scale views of data.\nDefinition 14 (center and radius of granular ball) Let \\( GBS = {GB_1,GB_2,...,GB_n} \\) be a set of granular balls over all samples U. For any granular ball \\( GB_i \\in GBS \\), the center and radius of GB are defined as [36]\n\\( C_i = \\frac{1}{|GB_i|} \\sum_{x\\in GB_i} x \\), (18)\n\\( r_i = \\max_{x\\in GB_i} ||x - C_i||_2 \\).\nDefinition 15 (fuzzy similarity degree between granular balls) Let \\( GBS = {GB_1,GB_2, ..., GB_n} \\) be a set of granular balls generated from fuzzy information system FIS = (U, A, V, f). For any two granular balls \\( GB_i, GB_j \\in GBS \\), the fuzzy similarity degree with respect to an attribute a \u2208 A is defined as\n\notherwise,\n(19)\nwhere"}, {"content": "For nominal attributes, the degree of fuzzy similarity between the samples is equal to 1 when their values are identical; otherwise, their fuzzy similarity is 0. For numerical attributes, if the absolute difference in their values is lower than the threshold parameter, their fuzzy similarity is determined by their absolute difference; otherwise, they are considered completely dissimilar.\nDefinition 4 (fuzzy upper and lower approximations) Let FIS = (U, A, V, f) be a fuzzy information system and B be an attribute subset of A. For a sample subset X C U, the fuzzy upper and lower approximations of a sample x to X with respect to B are defined as [35]\n\\( \\overline{R_BX} = \\sup_{y \\in U}T{R_B(x,y), X(y)}, \\)\n\\( \\underline{R_BX} = \\inf_{y \\in U}S{N(R_B(x,y)), X(y)}, \\)\n(4)\nwhere T and S denote the fuzzy triangular norm (T-norm) and conorm (S-norm), respectively, and N is a negator, i.e., N(x) = 1-x. In this study, the standard min and max fuzzy operators are used, i.e., T = min and S = max."}, {"title": "4.2 Performance on detecting various types of outliers", "content": "To examine the effectiveness of the proposed FRS-based method in detecting different types of outliers, we synthesized three datasets by injecting local, global, and group outliers, respectively, which are generated from the dataset \"Hepat\" using the method presented in [33]. Fig. 4 visualizes the synthesized datasets and outlier detection results in 3-dimensional PCA space.\nFrom table 2, it can be seen that the proposed method outperforms the FRS-based method in identifying different types of outliers. The traditional FRS-based method obtained good performance on detecting global outliers, but unsatisfactory results on detecting local and group outliers. Essentially, the traditional FRS-based method relies on the fuzzy similarity between samples to detect outliers, which is a typical distance-based outlier detection method that is good at identifying global outliers. In contrast, the proposed method takes into consideration sample similarity, density information, and multi-scale views such that local outliers"}, {"title": "4.3 Comparison with other state-of-the-art methods", "content": "To evaluate the performance of the proposed method, we compared it to other state-of-the-art methods, including statistical-based methods such as Gaussian Mixture Models (GMM) [7], learning-based methods such as One-Class Support Vector Machines (OCSVM) [45], distance-based methods such as k-Nearest Neighbors (kNN) [12], density-based methods such as Local Outlier Factor (LOF) [9], clusteringbased methods such as Cluster-Based Local Outlier Factor (CBLOF) [10], ensemble-based methods such as Isolation Forests (IF) [46], Feature Bagging (FB) [11], Locally Selective Combination in Parallel Outlier Ensembles (LSCP) [47], and Lightweight Online Detector of Anomalies (LODA) [48], and FRS-based methods such as Weighted Fuzzy-Rough Density-based Anomaly detection (WFRDA) [31] and MultiFuzzy Granules Anomaly Detection (MFGAD) [32]. Each method has its own parameters that need to be tuned for better results. To make a fair comparison, we followed the settings in the work [33] and utilized grid search to determine the parameter values for all selected methods. The best parameters for each method are shown in Table 3."}, {"title": "4.4 Statistical significance analysis", "content": "Statistical significance analysis was conducted to further compare the proposed method with other selected methods. The Friedman test was first used to examine whether there is a statistically significant difference in performance among all methods. In the Friedman test, the statistical variable TF is defined as [49]\n\\( T_F = \\frac{12N}{M(M + 1)} \\sum_{i=1}^{M} r_i^2 - 3N(M + 1) = \\frac{(N-1)T_x^2}{N(M - 1) - T_x^2} \\), (34)\nwith\n\\( T_x^2 = \\frac{12N}{M(M + 1)} \\sum_{i=1}^{M} r_i^2 - \\frac{3N(M + 1)^2}{4} \\), (35)\nwhere N and M denote the number of datasets and methods, respectively, and ri stands for the average rank value of the i-th method on all datasets.\nThe variable TF follows an F-distribution with degrees of freedom M - 1 and (M \u2013 1)(N \u2212 1). In our experiments, there are M = 12 methods and N = 20 datasets, and the critical value of F(11,209) at the significance level of\n\u03a6 = 0.05 is 1.8346. According to the performance rank"}, {"title": "4.5 Ablation experiments", "content": "To evaluate the impact of the density information, multiscale granular balls, and weighted SVM on the performance of the proposed method, we conducted ablation experiments on all selected datasets, and the results are shown in Table 5, where each column represents the AUROC values of a corresponding method on different datasets, and the row of \u201cAvg.\u201d denotes the average performance over all datasets.\nFrom Table 5, the following observations can be made:\nEach component of the proposed method has a positive effect on the performance of the FRS-based method. Among the three components, the strategy of multi-scale granular balls greatly enhances the detection of group outliers and brings the greatest improvement in performance, with an increase of 16.11% over the FRS-based method.\nA good fusion strategy can significantly improve the performance of the multi-scale outlier detection method. The weight SVM is trained on reliable outliers and inliers determined by the three-way decision and can be used to refine outlier detection results fused from different views. The multi-scale"}, {"title": "4.6 Effect of the number of views on performance", "content": "To examine the impact of the number of views on the performance, the proposed method with different number of views is performed, and the results are shown in Fig. 6.\nAs shown in Fig. 6, the number of views varies across different datasets, and the performance of the proposed method increases when more views are added. Additionally, the performance tends to be stable when the number of views is approaching the maximum value. These results demonstrate that the introduction of multi-scale views is very beneficial for outlier detection."}, {"title": "4.7 Analysis of time complexity", "content": "To examine the efficiency of the proposed method, we performed a comparative analysis of the computational complexity, and the results are shown in Table 6, where T denotes the number of iterations, and ki represents the number of base models used in the ensemble-based method."}, {"title": "5 CONCLUSIONS", "content": "In real-world applications, available data may contain different types of outliers, including local outliers, global outliers, and group outliers, posing a great challenge to outlier detection methods. In this study, we introduced the concept of relative fuzzy granule density to improve the ability of fuzzy rough sets-based methods for identifying local outliers and developed a multi-scale granular ball generation method to enhance the separability of group outliers. To effectively fuse the results obtained from multiscale views, a weight SVM is trained on the reliable outliers and inliers acquired by the three-way decision to generate an accurate outlier probability vector. Extensive comparative experiments and their statistical significance analysis demonstrated that the proposed method outperforms other state-of-the-art methods in identifying different types of outliers. Exploring a more effective fuse strategy for multiscale outlier detection is worthy of further investigation, and fuzzy rough sets-based outlier detection for semisupervised data will be our future research work."}]}