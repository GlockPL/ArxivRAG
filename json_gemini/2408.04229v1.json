{"title": "Probabilistic Circuits for Cumulative Distribution Functions", "authors": ["Oliver Broadrick", "William Cao", "Benjie Wang", "Martin Trapp", "Guy Van den Broeck"], "abstract": "A probabilistic circuit (PC) succinctly expresses a\nfunction that represents a multivariate probability\ndistribution and, given sufficient structural prop-\nerties of the circuit, supports efficient probabilis-\ntic inference. Typically a PC computes the prob-\nability mass (or density) function (PMF or PDF)\nof the distribution. We consider PCs instead com-\nputing the cumulative distribution function (CDF).\nWe show that for distributions over binary random\nvariables these representations (PMF and CDF)\nare essentially equivalent, in the sense that one can\nbe transformed to the other in polynomial time.\nWe then show how a similar equivalence holds\nfor distributions over finite discrete variables us-\ning a modification of the standard encoding with\nbinary variables that aligns with the CDF seman-\ntics. Finally we show that for continuous variables,\nsmooth, decomposable PCs computing PDFs and\nCDFs can be efficiently transformed to each other\nby modifying only the leaves of the circuit.", "sections": [{"title": "1 INTRODUCTION", "content": "Modeling multivariate probability distributions in a way\nthat is both expressive and allows efficient probabilistic rea-\nsoning is a fundamental problem in the field of artificial in-\ntelligence. Probabilistic circuits (PCs) provide a unifying\nframework for a myriad of tractable probabilistic models\nand reduce tractability to syntactic properties of the under-\nlying circuit [Darwiche, 2003, Poon and Domingos, 2011,\nChoi et al., 2020]. In general, a PC computes a multilin-\near polynomial in its inputs, most commonly computing a\nprobability mass (or density) function (PMF/PDF). How-\never, other polynomials can be used to encode probability\ndistributions and have been studied as alternative seman-\ntics for PCs, including generating functions [Zhang et al.,"}, {"title": "3 CUMULATIVE DISTRIBUTION\nFUNCTIONS", "content": "For real-valued random variables $X_1,..., X_n$ the cumula-\ntive distribution function (CDF) $F : R\u2033 \u2192 [0, 1]$ is\n$F(x_1,...,x_n) = P[X_1 \\le x_1, ..., X_n \\le X_n]$.\nThis is a general notion; the CDF exists, e.g., regardless of\nwhether the variables are discrete, continuous, or otherwise.\nIf the random variables are all discrete, meaning that they\ntake values in some countable subset of the reals $D\\subset\\mathbb{R}$,\nthen the distribution can also be specified by a probability\nmass function (PMF) $f : D\u2033 \u2192 [0, 1]$ given by\n$f(x_1,...,x_n) = P[X\u2081 = x_1, ..., Xn = Xn]$.\nIf instead all the random variables are absolutely continu-\nous, then there exists a probability density function (PDF)\n$f : R^n \u2192 R_{\\ge0}$ given by\n$f(x_1,...,x_n) = \\frac{\\partial^n}{\\partial x_1... \\partial x_n}F(x_1,...,x_n)$.\nIn the following sections we consider three cases. The first\ntwo concern discrete distributions: those over binary ran-\ndom variables in Section 4, and those over finite discrete\nvariables in Section 5. We then consider continuous vari-\nables in Section 6."}, {"title": "4 BINARY VARIABLES", "content": "We first consider the simplest setting: probability distribu-\ntions over binary random variables. Let $X_1, . . ., X_n$ be ran-\ndom variables taking values in ${0, 1} \\subset \\mathbb{R}$. Then there ex-\nists a PMF $f : {0,1}\u2033 \u2192 [0,1]$ with $f(x_1,...,x_n) =\nP[X_1 = x_1,..., Xn = Xn]$. Moreover, there is a unique\nmultilinear polynomial $p\\in R[x_1,..., x_n]$ that computes $f$\n(in the sense that it agrees with f on all inputs in ${0,1}^n$)\nwhich we will call the PMF polynomial:\n$p(x_1,...,x_n) = \\sum_{S\\subset[n]} f(v_S) \\prod_{i\\in S}x_i \\prod_{i\\notin S}(1 - x_i)$   (1)"}, {"title": "5 FINITE DISCRETE VARIABLES", "content": "We now consider distributions over finite discrete random\nvariables, those taking values in some finite set of re-\nals, $K\\subset\\mathbb{R}$. In particular, we focus on the case $K =\n{0,1,..., k-1}$ for some $k \\in \\mathbb{N}$. We note that any other\nfinite set of reals of size k may be bijected with this set, as\nwell as other categorical or ordinal random variables.\nThe standard approach in the probabilistic circuits literature\nfor handling such finite discrete variables is to encode them"}, {"title": "6 CONTINUOUS VARIABLES", "content": "Lastly we consider the case where all of the variables are\ncontinuous with the distribution admitting a joint density\nfunction. Let $X_1, ..., X_n$ be real-valued random variables\nwith CDF $F : R\u2033 \u2192 [0,1]$ and PDF $f : R^n \u2192 R_{\\ge0}$. In\nthis setting, we show that it is straightforward to efficiently\ntransform between circuits computing the PDF and CDF\nwhen the circuits are smooth and decomposable. Smooth-\nness and decomposability are standard structural properties\nof PCs that enable efficient inference [Darwiche and Mar-\nquis, 2002, Choi et al., 2020]. In order to define them, we\nuse the notion of the scope of a node $v$ denoted scope(v)\nwhich is the set of all variables appearing in the sub-PC\nrooted at $v$."}, {"title": "7 CONCLUSION", "content": "We study a basic question: what if a tractable PC computes\na CDF instead of a PMF or PDF? We show that in three\nimportant cases the two models are roughly equivalent. For\ndistributions over binary random variables, we observe that\nthe CDF polynomial is exactly the probability generating\nfunction (PGF) of the distribution. This observation allows\nus to conclude that PCs computing a PMF polynomial or\nCDF polynomial can be transformed to each other in poly-\nnomial time, and we were able to give a new explanation\nfor how a circuit computing the PGF can be transformed\nto a circuit computing the PMF. We then showed how to\nreduce the finite discrete case to the binary case with a\nslight modification to the standard encoding with binary\nindicators that respects the less-than-or-equal-to relation\nneeded to compute the CDF. Finally, we showed how the\nstandard structural properties of smoothness and decompos-\nability suffice in the continuous case to make transforma-\ntions between PDFs and CDFs simplify to modifications\nof the leaves. We leave open the question of whether sim-\nilar results hold for circuit models handling discrete vari-\nables over infinite domains, mixed distributions, or finite\ndiscrete variables with more efficient encodings into binary\nvariables, e.g. like those used by Cao et al. [2023] for finite\ndiscrete variables or those obtained by Garg et al. [2023]\nfor discretizations of continuous densities."}]}