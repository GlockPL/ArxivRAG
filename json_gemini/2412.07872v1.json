{"title": "Evaluating the Potential of Federated Learning for Maize Leaf Disease Prediction", "authors": ["Thalita Mendon\u00e7a Antico", "Larissa F. Rodrigues Moreira", "Rodrigo Moreira"], "abstract": "The diagnosis of diseases in food crops based on machine learning seemed satisfactory and suitable for use on a large scale. The Convolutional Neural Networks (CNNs) perform accurately in the disease prediction consid- ering the image capture of the crop leaf, being extensively enhanced in the lit- erature. These machine learning techniques fall short in data privacy, as they require sharing the data in the training process with a central server, disregard- ing competitive or regulatory concerns. Thus, Federated Learning (FL) aims to support distributed training to address recognized gaps in centralized training. As far as we know, this paper inaugurates the use and evaluation of FL applied in maize leaf diseases. We evaluated the performance of five CNNs trained un- der the distributed paradigm and measured their training time compared to the classification performance. In addition, we consider the suitability of distributed training considering the volume of network traffic and the number of parameters of each CNN. Our results indicate that FL potentially enhances data privacy in heterogeneous domains.", "sections": [{"title": "1. Introduction", "content": "The rapid evolution of technologies in parallel with the increasingly sophisticated de- mands of users has generated unprecedented amounts of data. This large amount of data contains strategic information and knowledge whose extraction requires sophisticated computational methods. The extraction of dataset features can enable the construction of machine learning models to work in domains such as health, economics, and agricul- ture [Naeem et al. 2022]. Primarily, agriculture represents one of the main economic activities in the world, maize being the crop most produced in the world, leading Brazil to be the second largest exporter [Arag\u00e3o and Contini 2021]. However, the maize crops are susceptible to certain leave diseases, affecting production and reducing quality and productivity [Roese et al. 2020]. To overcome this limitation, Artificial Intelligence (AI) techniques allow building intelligent applications to support crop disease diagno- sis [Ayoub Shaikh et al. 2022]. Machine learning paradigms, mainly supervised learning, require data to be cen- trally and locally available in the training phase. However, computing and storage re- sources are widely spread over multiple regions, and organizations require distributed training strategies to employ these resources [Li et al. 2020b]."}, {"title": "2. Related Work", "content": "Maize leaf disease identification based on the image is a research field with many ap- proaches developed over the years [Sharma et al. 2021]. [DeChant et al. 2017] proposed the automatic identification of northern maize leaf blight using a pipeline of CNNs. [Lin et al. 2018] designed a multichannel CNN with cross-connection, pooling, and nor- malization schemes. They evaluated five types of images collected from maize planting in China. [Zhang et al. 2018] enhanced the Cifar10 and GoogLeNet CNNs tuning parame- ters, modifying the pooling combinations, adding dropout operations, and rectified linear unit functions to speed the training step. [Alehegn 2019] proposed an approach based on color, texture, and morphological features to classify the Ethiopian maize diseases dataset using Support Vector Machine (SVM). [Ahila Priyadharshini et al. 2019] proposed modifications in the LeNet architec- ture and applied a preprocessing step in the images using Principal Components Analy- sis (PCA) whitening. [Panigrahi et al. 2020] extracted color, shape, and textures features and evaluated several supervised classifiers to identify maize leaf disease, including Na\u00efve Bayes, Decisoin Tree, K-Nearest Neighbors (KNN), SVM, and Random Forest. [Waheed et al. 2020] applied a hyperparameter tuning based on grid search to improve the classification performance of DenseNet. [da Rocha et al. 2020] proposed the hyperparameter optimization based on the Bayesian method and evaluated AlexNet, ResNet50, and SqueezeNet CNNs trained with data augmentation and transfer learn- ing. Similarly, [Subramanian et al. 2022a] and [Subramanian et al. 2022b] also applied Bayesian optimization and tested a dataset of images obtained from different sources. [Haque et al. 2022] evaluated three CNN architecture inspired by InceptionV3 to identify maize leaf diseases in images collected in India. They used pre-trained mod- els and applied data augmentation using rotation and brightness enhancement methods. [Amin et al. 2022] proposed a fusion of CNNs, considering EfficientB0 and DenseNet121 models to discover the complex feature of the infected maize leaf images. [Moreira et al. 2022] proposed a low-cost and green-friendly architecture called AgroLens to support Smart Farm applications in environments with poor connectivity. They compared the classification performance of CNNs to handle maize leaf disease di- agnosing supported by edge-compute devices. In Table 1 we compared the recent contributions available in the literature in the scope of solutions to support maize leaf diagnosis based on images. The \u201cApproach\u201d col- umn refers to the state-of-the-art proposals. The \u201cDataset\u201d column indicates the dataset image considered. The \u201cML Algorithms\u201d column indicates the algorithm utilized. The \"Training Place\" column characterizes if the solution was trained centralized or dis- tributed. The \u201cEvaluation Metric\u201d indicates the classification performance considered. We observed in our short survey that all approaches considered accuracy evaluation met- rics, and the accuracy obtained for each approach is indicated in the \u201cAccuracy\u201d column. Finally, the \u201cPrivacy Support\u201d column characterizes the solution's ability to support data privacy. Classification performance is the main strength of previous studies based on ma- chine learning algorithms. However, these studies do not investigate distributed training. Thus, to overcome this gap, we propose an approach based on FL. Also, our method is more robust in addressing critical issues such as data privacy and security."}, {"title": "3. Proposed Method", "content": "Traditional machine learning requires the dataset to be locally available to feed the model in the training process. Some datasets require access control and privacy, such as sensitive data from hospitals, governments, businesses, banks, and others [Mugunthan et al. 2020]. FL is a machine learning approach that does not require the data used in the supervised training process to be on the central server, leveraging data privacy as it can be processed locally [Truex et al. 2019, Zhang et al. 2021]. Figure 1 depicts the distribution of the training workload among clients that could join the hierarchy asynchronously. In this machine learning paradigm, the client locally trains the model with its data, protecting it in terms of privacy, and submits only the weights of the parameters of the used machine learning model to the central server. This learning paradigm supports heterogeneous client's hardware capacity making FL a dy- namic approach. When receiving the weights from the trained machine learning model, the Server performs a mathematical merge operation on the weights of each model reported by the clients who trained locally on the dataset. Thus, the Server maintains a single machine learning model containing weights referring to local training, not requiring the Server to access specific data for each location, protecting the principles of pri- vacy on sensitive data. There are several mathematical operations in the community to merge the weights that the central server can adopt, some known approaches are: Fe- dAvg [McMahan et al. 2017], P-FedAvg [Zhong et al. 2021], FedProx [Li et al. 2020c], EdgeFed [Ye et al. 2020], SimFL [Li et al. 2020a] and others [Li et al. 2021]. This paper presents a performance evaluation of CNNs trained under the dis- tributed paradigm. Thus, using FL we consider one (1) central server and K clients that connect to the server via the Institute of Electrical and Electronics Engineers (IEEE) 802.3 protocol [Brooks 2001]. Each customer receives a percentage proportional to the number of customers in the PlantVillage\u00b9 dataset, specifically from the maize culture, categorized into four classes included common rust (1192 images), gray leaf (513 images), northern leaf blight (985 images), and healthy leaves (1162 images) [Mohanty et al. 2016]. Thus, these clients using CNNs start the local training process, where each client trains CNN according to their learning rate, epochs, and others."}, {"title": "4. Performance Evaluation", "content": "We built an experimental scenario to validate the suitability of FL training for different CNNs. The experimental scenario consists of a machine with a 3.00 GHz Intel Processor i5 processor, 32 GB of RAM, an NVIDIA GeForce GTX 1080 Ti GPU, and Ubuntu 16.04.7 LTS operating system. We used the PyTorch framework (version 1.6) for the deep learning modules and CUDA version 8.0 and cuDNN 6.0. The FL framework used in the performance evaluation was FedLab [Zeng et al. 2021]."}, {"title": "5. Results and Discussion", "content": "We carried out experiments validating the performance of each CNN trained with the FL paradigm. For each CNN, we run ten (10) executions with a random seed to assess the maximum performance that CNN can achieve. Thus, according to Table 3, we found that the CNNs with the highest accuracy were VGG-11 following AlexNet, with 97.29% and 96.87%, respectively. In addition, our results demonstrate that AlexNet was CNN that required the least time for training. Although the VGG-11 reached a high accuracy, this model demanded the most significant time in the training process, being unsuitable in FL scenarios where the training time is essential. We measured the standard deviation of the ten (10) experiments for each CNN, recording it in Table 3 after the \u00b1 symbol. These experiments were run without seed locking to measure the variability of the results. We consider in our experiments the training time of CNNs considering the parameters of Table 2. Our achieved accuracy is comparable to that found in the state of the art using the same parameters and dataset. Furthermore, our experiments suggest that ShuffleNet had the lowest accuracy when trained under the FL paradigm, about 75.65%.", "equations": ["Accuracy = \\frac{TP + TN}{TP+TN+FP + FN}", "Precision = \\frac{Tp}{TP + FP}", "Recall = \\frac{Tp}{TP + FN}", "F1-Score = 2 \\times \\frac{Recall \\times Precision}{Recall + Precision}"]}, {"title": "6. Concluding Remarks", "content": "Machine learning techniques have proved suitable for several tasks, such as disease pre- diction based on image of agricultural crops. In this paper, we evaluate the potential of FL to mitigate the data privacy gap that centralized machine learning techniques have. Thus, we evaluated the applicability of the FL method through five CNNs using maize leaf dis- ease classification. For this, we built a short state-of-the-art survey. We found that the application of CNNs to predict diseases in maize leaves predominantly did not consider the distributed paradigm and, consequently, did not support privacy. Our numerical results suggest that AlexNet, due to its structure, lower training time, and high accuracy, is suitable to operate in the FL model. Furthermore, it was worth noticing a weak negative correlation between accuracy and training time, leading us to conclude that for most of the models considered, in the distributed training approach, the training time is inversely proportional to the accuracy of the models. Also, through numerical results, we measured and concluded that the number of CNN parameters in the distributed learning paradigm strongly correlates with the volume of data exchanged in the training process. Also, our numerical and practical evaluation indicated that FL could potentially enhance data privacy in heterogeneous domains. For future work, urges to evaluate al- ternatives weight aggregation techniques of CNNs in addition to verifying the impact of network failures on the model convergence time."}]}