{"title": "Proposing and solving olympiad geometry with guided tree search", "authors": ["Chi Zhang", "Jiajun Song", "Siyu Li", "Yitao Liang", "Yuxi Ma", "Wei Wang", "Yixin Zhu", "Song-Chun Zhu"], "abstract": "Mathematics olympiads are prestigious competitions, with problem proposing and solving highly honored. Building artificial intelligence that proposes and solves olympiads presents an unresolved challenge in automated theorem discovery and proving (1), especially in geometry for its combination of numerical and spatial elements. We introduce TongGeometry, a Euclidean geometry system supporting tree-search-based guided problem proposing and solving. The efficient geometry system establishes the most extensive repository of geometry theorems to date: within the same computational budget as the existing state-of-the-art (2), TongGeometry discovers 6.7 billion geometry theorems requiring auxiliary constructions, including 4.1 billion exhibiting geometric symmetry. Among them, 10 theorems were proposed to regional mathematical olympiads with 3 of TongGeometry's proposals selected in real competitions, earning spots in a national team qualifying exam or a top civil olympiad in China and the US. Guided by fine-tuned large language models, TongGeometry solved all International Mathematical Olympiad geometry in IMO-AG-30, outperforming gold medalists for the first time. It also surpasses the existing state-of-the-art across a broader spectrum of olympiad-level", "sections": [{"title": "Significance", "content": "This research presents TongGeometry, a system for Euclidean geometry problem proposing and solving, bridging numerical and spatial reasoning. TongGeometry surpasses state- of-the-art methods by autonomously discovering 6.7 billion theorems requiring auxiliary construc- tions, including 4.1 billion exhibiting geometric symmetry. Its real-world impact is demonstrated by its proposed problems being featured in prestigious math olympiads and outperforming top human competitors in solving International Mathematical Olympiad geometry problems. This achievement represents a step towards both automated theorem discovery and problem-solving, akin to transi- tioning from a \u201cstudent\u201d system to a \u201ccoach\u201d capable of both generating and solving advanced problems. Importantly, its efficiency and accessibility on consumer-grade machines democratize high-level geometric problem-solving, enabling broader educational and research applications."}, {"title": null, "content": "problems. The full capabilities of the system can be utilized on a consumer-grade machine, making the model more accessible and fostering widespread democratization of its use. By analogy, unlike existing systems that merely solve problems like students, TongGeometry acts like a geometry coach, discovering, presenting, and proving theorems."}, {"title": null, "content": "Theorem proving, the journey to navigate from the initial state to the goal by connecting poten- tially missing intermediate conditions, demonstrates exceptional problem-solving skills. For any individual, winning a prize in the International Mathematical Olympiad (IMO) is a distinct honor and a testament to his / her problem-solving abilities. Since the inception, IMO has become the premier platform for identifying the world's best mathematical talents. It has also, inadvertently, become the target for Artificial Intelligence (AI) researchers striving to develop theorem-proving models that can match or surpass human competitors in the most prestigious mathematical compe- tition in the world (1, 3\u20136)."}, {"title": null, "content": "Proposing olympiad problems is held in high regard within the mathematics community as well, yet few computational methods have been able to accomplish autonomous problem proposing and rigorous proposal verification. Olympiad problems are often founded on years of intermedi- ate theorems discovered and come with stringent criteria. The most exemplary problems appear deceptively simple and are comprehensible with a basic level of mathematical knowledge but re-"}, {"title": null, "content": "quire exceptional ingenuity to solve completely. Additionally, elegance, such as various forms of symmetry, is typically essential."}, {"title": null, "content": "Proposing or solving olympiad problems poses considerable challenges for computational meth- ods due to the vast number of branching points and the limited pool of past problems available for heuristics development. Geometry, in particular, stands out among olympiad topics because it involves both numerical and spatial reasoning, unlike other subjects that are text-based and can be more easily adapted with pretrained Large Language Models (LLMs) (7, 8). Besides, contentious axiomatization in Euclidean geometry invalidates either completeness (9) or human-readability of interactive proof assistants applicable in other domains (10, 11). Although specific languages tailored for geometry have been created (2, 12\u201314), their design limitations leave the space of olympiad problems inadequately explored."}, {"title": null, "content": "In this work, we introduce TongGeometry\u00b9, a tree-based system for synthetic Euclidean planar geometry that facilitates human-readable problem proposing via backward tracing and theorem proving through forward chaining. Utilizing this scalable and efficient system and 196 olympiad problems as guiding statistics, we collected 4.1 billion symmetric geometry problems with proofs, among 6.7 billion that all necessitate auxiliary constructions for a complete proof. By analogy, compared to existing \u201cstudent\u201d systems that only solve problems (2, 13, 14), TongGeometry serves as a \"coach\" that characterizes the space of geometry using a finite tree and enables guided problem proposing and proving. We also established scoring rubrics for the difficulty and suitability of problems for olympiad competitions and selected a few as proposals. One was selected in 2024 National High School Mathematics League (Beijing), a qualifying competition for Chinese National Team2, and two made the shortlist of the 2024 US Ersatz Math Olympiad, a top civil mathematics olympiad in the US3."}, {"title": null, "content": "The generated data contains abundant auxiliary constructions for solving geometry problems. Filling in these auxiliary constructions is crucial for successful geometry theorem proving; these exogenous objects enable a proving system to bridge the gap between the initial state and the goal. We therefore leveraged the data to guide TongGeometry tree search when it is presented a problem to solve. Specifically, we fine-tuned two LLMs (15, 16): one dedicated to suggesting possible search"}, {"title": "Assessing TongGeometry", "content": ""}, {"title": "Evaluating generated problems for olympiads", "content": "Using 196 existing olympiad problems as guiding statistics, we performed massive parallel problem search using 10,368 parallel CPU cores. In 30 days of search, TongGeometry traverses 143,379,886 unique paths (170,883,417 in total) in the defined space of geometry, inferring over 1,851,166,755 unique states. On each unique path, TongGeometry finds on average 0.7613 configuration requiring auxiliaries, resulting in 109,157,477 configurations (pairs of context and auxiliaries). Among them, 70,703,508 are unique. After filtering, we ended up with a dataset of 6,688,310,403 problems (triplets of context, goal and auxiliaries), of which 4,096,680,574 are symmetric. See Figure 1(B) for comparison of search efficiency with AlphaGeometry."}, {"title": null, "content": "With billions of problems available, the challenge of selectively retrieving suitable ones for olympiad proposals remains unresolved due to the absence of an automatic assessment scheme. Inspired by GeoGen's methodology (14), we developed a set of rubrics for problem selection. Before the problem proposal deadlines for the 2024 National High School Mathematics League (Beijing) and the 2024 US Ersatz Math Olympiad, we enlisted the expertise of a 2023 IMO gold medalist and a student member of Chinese National Team to manually examine a batch of proposals during the initial phase of problem search. 4 proposals were submitted to the 2024 National High School Mathematics League (Beijing), with 1 selected as the only geometry problem in the final competition. Additionally, 6 proposals were submitted to the 2024 US Ersatz Math Olympiad, with 2 making it to the shortlist (Figure 1(E) and Supplementary Text). Of note, AlphaGeometry solved 3 of our 10 proposals."}, {"title": "Search discovers known lemmas and base configurations", "content": "Among the proposed problems, we discover well-known lemmas. Figure 1(D) shows an rotationally symmetric lemma known in the community, where the three green lines are concurrent at the Nine- point center (17, 18). See Supplementary Text for explanation."}, {"title": null, "content": "To facilitate problem exploration, we implemented a replay buffer that allowed tree search to restart from cached promising intermediate states. These states include foundational configurations well-known in the community, which serve as scaffolds for constructing more complex problem scenarios. Figure 1(F) illustrates a symmetric example featuring the Mixtilinear Incircle (19) and the Incenter/Excenter Lemma (20). This configuration has been acclaimed as the \u201crichest configuration\" by a coach of the USA team (19). See Supplementary Text for explanation."}, {"title": "Performance on benchmarks", "content": "We performed quantitative analysis of TongGeometry on two benchmarks, the IMO-AG-30 dataset that was curated in AlphaGeometry and the newly curated dataset in the development of TongGeometry coined MO-TG-225. The IMO-AG-30 dataset comprises 30 problems, derived by translating 23 years of IMO problems into the domain-specific language of AlphaGeometry. In contrast, the MO-TG-225 dataset includes 225 mathematical olympiad problems selected from our pool of 196 examples used to calculate search statistics. Problems in MO-TG-225 have been translated into the domain-specific language of TongGeometry, and none of these problems appear in TongGeometry's training dataset."}, {"title": null, "content": "In experiments, we compared TongGeometry with AlphaGeometry, GPT-4 (7) and its o1 variant. Given that TongGeometry and AlphaGeometry employed distinct domain-specific languages, we translated each problem's original representation into the respective language required by each model. For evaluating GPT-4 and o1, we used the natural language format in which each problem was presented in the competition. All models were assessed with a standardized 90-minute time limit per problem."}, {"title": null, "content": "Table 1(left) shows the performance of different models and human averages on IMO-AG- 30. While the latest reasoning-enhanced language model of o1 achieved impressive results on a range of tasks, we observed that large language models still struggle with rigorous mathematical"}, {"title": null, "content": "reasoning in geometry, often generating proofs with erroneous logics and hallucinated intermediate results. AlphaGeometry's DD+AR approach notably improved upon Wu's method (10 solves), yet its symbolic reasoning engine remains both redundant and suboptimal. By redesigning and optimizing the deductive database method, TongGeometry's reasoning backend, using only DD, successfully solved 18 problems \u2013 outperforming average IMO contestants. With a learned value heuristics, TongGeometry became the first method to surpass IMO gold medalists, successfully proving all 30 problems in the benchmark. A closer examination revealed that the value model was instrumental in solving the benchmark's two most challenging problems: IMO 2000 P6 and IMO 2008 P6. Compared to AlphaGeometry, TongGeometry achieved these results on a consumer-grade machine with 32 CPU cores and a single NVIDIA RTX 4090 GPU in a maximum of 38 minutes, whereas AlphaGeometry required 246 CPU cores and 4 NVIDIA V100 GPUs to reduce solve time to under 90 minutes a resource-intensive setup inaccessible to most users."}, {"title": null, "content": "Table 1(right) displays the performance of various models on the MO-TG-225 dataset. Unlike the IMO dataset, MO-TG-225 includes problems from diverse sources, making rigorous human evaluation benchmarks unavailable. During the evaluation of GPT-4 and 01, we observed that when prompted to prove a known theorem, such as the Euler line theorem, LLMs frequently assumed the theorem as established and applied it directly without the requested proof. We considered these responses as correct, accounting for a few solves reported in the table. Consistent with results on IMO-AG-30, TongGeometry's DD backend demonstrated improved problem-solving capability over AlphaGeometry's DD+AR, reaching a performance level close to AlphaGeometry overall. We noted that AlphaGeometry's success largely stemmed from its backend engine, with 72.5% of its total solves achieved by DD+AR. In contrast, TongGeometry not only solved a greater proportion of problems (81.3% vs. 45.3%) but also leveraged its neural models to address auxiliary construction effectively, with only 55.2% solved by DD."}, {"title": null, "content": "Ablation study on the value heuristics suggests that under a resource-constrained environment of 32 cores and 1 graphics card, the value model could squeeze out the last bit of performance, reaching 7.1% (IMO-AG-30) and 3.4% (MO-TG-225) improvement over a policy-only model."}, {"title": "Expert evaluation on TongGeometry results", "content": "Figure 2 shows IMO 2024 P4, the geometry problem in the latest IMO competition, a relatively new problem without many documented solutions at the time of TongGeometry training. TongGeometry generated two equivalent solutions. In retrospect, we observed that the two solutions introduced an auxiliary point identical to what's presented in the official solution (21). We invited an 2024 IMO gold medalist to evaluate TongGeometry's solutions, and both were deemed correct."}, {"title": "Conclusion", "content": "In this work, we introduce TongGeometry, a neuro-symbolic system designed to discover, present, and prove IMO-level geometry problems through guided tree search. We implemented evaluation rubrics for assessing the quality of TongGeometry-proposed problems. Notably, one proposed problem was selected in 2024 National High School Mathematics League (Beijing), a Team China qualifying competition, and two others shortlisted in 2024 US Ersatz Math Olympiad, a top civil math competition in the US. TongGeometry employs actor-critic style inference, where a policy model is learned to complete auxiliaries and a value model to estimate the number of remaining steps until problem solved. This style of problem solving leads to super-gold-medalist performance for the first time on IMO problems, surpasses the previous state-of-the-art, and demonstrates more effective use of neural models for auxiliary construction."}, {"title": null, "content": "By analogy, TongGeometry functions more like a coach rather than a student merely solving problems \u2013 a distinction that opens avenues for future study to further advance the field of geometry and mathematics."}]}