{"title": "Physics-Informed LLM-Agent for Automated Modulation Design in Power Electronics Systems", "authors": ["Junhua Liu", "Fanfan Lin", "Xinze Li", "Kwan Hui Lim", "Shuai Zhao"], "abstract": "LLM-based autonomous agents have demonstrated outstanding performance in solving complex industrial tasks. However, in the pursuit of carbon neutrality and high-performance renewable energy systems, existing AI-assisted design automation faces significant limitations in explainability, scalability, and usability. To address these challenges, we propose LP-COMDA, an LLM-based, physics-informed autonomous agent that automates the modulation design of power converters in Power Electronics Systems with minimal human supervision. Unlike traditional AI-assisted approaches, LP-COMDA contains an LLM-based planner that gathers and validates design specifications through a user-friendly chat interface. The planner then coordinates with physics-informed design and optimization tools to iteratively generate and refine modulation designs autonomously. Through the chat interface, LP-COMDA provides an explainable design process, presenting explanations and charts. Experiments show that LP-COMDA outperforms all baseline methods, achieving a 63.2% reduction in error compared to the second-best benchmark method in terms of standard mean absolute error. Furthermore, empirical studies with 20 experts conclude that design time with LP-COMDA is over 33 times faster than conventional methods, showing its significant improvement on design efficiency over the current processes.", "sections": [{"title": "1 INTRODUCTION", "content": "As temperature rises year on year due to the effect of Global Warming, there is an urgent need to reorient our economies towards carbon neutrality, especially in power generation. A significant penetration of renewable energy resources (RES) in power generation is crucial. Power Electronics Systems (PES) are indispensable for integrating RES into the contemporary power grid for three primary reasons [22]. Firstly, power converters within PES transform the direct current (DC) output from solar panels or wind turbines to alternating current (AC), facilitating the seamless integration of RES into the AC grid. Secondly, PES manages power during peak and off-peak periods, guiding the charge and discharge processes of energy storage units. Lastly, it upholds grid stability through functions like voltage regulation and reactive power compensation. Achieving the desired outcomes necessitates meticulous modulation of power converters in PES, which involves controlling their switching to manage output voltage or current.\nThe escalating adoption of RES and the burgeoning scale of multi-resource power systems complicate the modulation design for power converters within PES. The diversity of energy sources linked to the power grid intensifies system complexity. As more converter subsystems interlink, the modulation design problem's dimensionality surges. Consequently, identifying an optimized design solution through manual computation becomes infeasible given this complexity. As cities worldwide embrace multi-resource power systems, modulation designs must be customized, catering to particular geographies and application objectives. Sometimes, these objectives can conflict, further complicating matters.\nThe recent advancements in artificial intelligence (AI) and Large Language Models (LLMs) offer a potential resolution to these modulation design challenges through automation. Emerging research has introduced AI-centric modulation design techniques. For instance, recent works explore the use of an LLM with in-context learning for modulation design [23]. Extreme gradient boosting algorithm (XGBoost) was utilised to construct the surrogate model for the triple phase shift modulation strategy for the dual active bridge (DAB) converter using training data sourced from simulation tools or hardware prototypes [25]. Subsequently, a differential evolution algorithm collaborates iteratively with XGBoost until optimal modulation parameters are identified. Likewise, the Q-learning algorithm, a conventional reinforcement learning technique, can be trained offline to derive optimized modulation parameters [42]. Nevertheless, these methodologies exhibit several drawbacks:\n(1) The training of AI models is often data-intensive, with significant demands for an extended and tedious data collection through simulations or hardware experiments.\n(2) For complex tasks, training or finetuning large models are also computationally intensive and consume a large amount of energy to train and serve.\n(3) Deploying Al models as unexplainable black boxes severely restricts their industrial adoption.\n(4) The current techniques focuses on specific modulation strategies or pre-established design goals, which limits the scalability of such automation.\n(5) Existing methods require extensive human involvement in the whole design process which makes the design process inefficient.\nIn recent years, large language models, such as GPT-4 [33], Palm [2] and LLaMa [43] demonstrates superior performance in natural language understanding and generation. Furthermore, recent works introduce LLM-based autonomous agents which extend LLM's capacity from simply performing reasoning and generating content to actions and control [45].\nIn our work, we investigate the potential of using LLM-based autonomous agents for downstream task automation in Power Electronics Systems. Specifically, we introduce LP-COMDA, a LLM-based Physics-Informed Power Converter Modulation Design Automation System, for users to produce high quality modulation design with minimal human supervision.\nLP-COMDA first uses a LLM-based planner to process user requirements and generate a set of design specifications. Subsequently, the agent invokes a set of system design tools that consist of physics-informed surrogate models and optimization algorithms. In the design process, the tools iteratively derives optimal modulation parameters tailored to users' design specifications. Finally, the optimal design parameters and performance metrics will be returned to and visualised for the users to achieve an explainable design process.\nThe contributions of this paper are summarized as follows:\n\u2022 We propose LP-COMDA, a LLM-based physics-informed autonomous agent that streamlines the power converter modulation design process. Comprehensive experiments shows strong performance of LP-COMDA, statistically out-performing the best baseline model with 63.2% lower error for low-data scenario, and 23.7% lower error for high-data scenario.\n\u2022 We propose a hierarchical physics-informed surrogate model as a design automation tool for power converter modulation, which outperforms benchmarks in accurately predicting power converter performance even in extreme scenarios where the data is sparse.\n\u2022 Our user study with 20 experts demonstrates that the design time with LP-COMDA is over 33 times faster than conventional methods, showing superior efficiency in empirical practice with minimal human supervision."}, {"title": "2 PROBLEM STATEMENTS", "content": ""}, {"title": "2.1 Power Converter Phase Shift Modulation", "content": "Within the renewable energy systems sector, power converters need to work in harmony with other components to ensure optimal functionality. Figure 1 depicts a classic application of a particular power converter, the dual active bridge (DAB) converter. This converter functions as a DC transformer, connecting various DC buses to facilitate the utilization or storage of power produced by RES [24]. The phase shift modulation technique is employed to regulate the current flow and guarantee efficient power transmission. This is done by adjusting the timing of different power switch sets, represented as S\u2081 to S8 in Figure 1. Table 1 details the distinct phase shift modulation strategies associated with the DAB converter, highlighting their respective degrees of freedom (DoF) and modifiable parameters [11]. It is worth noting that the adjustable parameter for < S1, S5 > indicates the phase difference between S\u2081 and S5.\nFor designing the parameters of the modulation strategy, users are required to define three essential pieces of specification consistent with the application prerequisites:\n(1) Expected operating conditions for the converter: This involves specifying the rated power, rated input voltage (current) and rated output voltage (current), as well as their actual operating values.\n(2) Selected modulation strategy: The modulation strategy selection should factor in both the acceptable level of control complexity and the feasibility of achieving the desired performance for the specific strategy.\n(3) Performance objectives: Various application scenarios have different priorities for performance objectives, which directly affect the modulation design. Common objectives in practical applications encompass power efficiency, power density, zero voltage switching, zero current switching, current stress, dynamic response, electromagnetic interference, stability, and compatibility with other subsystems, etc."}, {"title": "2.2 Problem Statements", "content": "Given a set of operating conditions of the power converter (rated power $P_r$, actual power $P_a$, rated input voltage $V_{1r}$, rated output voltage $V_{2r}$, actual operating output voltage $V_{2a}$), chosen modulation strategy S and prioritized performance objectives O, the aim is to design modulation parameters for the chosen modulation strategy S to achieve optimal performance for O. This design system is expected to have the following features:\n\u2022 Automatic design outcome generation, eliminating the need for users to perform complex analysis or computations.\n\u2022 Precise design outcomes that translate into exceptional operational performance in real-world scenarios.\n\u2022 Good usability and explainability to accelerate engineering design and scientific discovery.\n\u2022 Simple setup for the design system, minimizing the demand for extensive data resources."}, {"title": "3 RELATED WORK", "content": ""}, {"title": "3.1 LLM-based Autonomous Agents", "content": "The evolution of Large Language Models (LLMs) has unlocked immense potential for automating various processes in engineering and natural sciences through simple, plain-language queries. Numerous studies have explored LLM capability in reasoning and formal system applications, such as programming co-pilots [30, 36], multi-lingual tasks [28, 49], and mathematical problem-solving [37, 39].\nTo address more complex industrial tasks, recent work proposed the use of LLM-based autonomous agents (LLM-agents), which extends the capability of LLMs [45]. LLMs are deployed as the planning backbone to understand user request and invoke suitable tools to perform actions [51]. Besides the planning module, LLM-agents also include other components, such as memory and tools. With advanced techniques such as Retrieval Augmented Generation (RAG) [28, 49], LLM-agents become powerful tools for solving complex tasks with little to no human instruction.\nRecent works reported outstanding performance of LLM-agents in industrial applications. For instance, Cao and Lee harnessed LLMs and Phase-Step prompts for cross-domain robot task generation [5]. Li et al. introduced an agentic framework to for strategic and interactive decision-making [20]. LLM-based agents are found effective in other domain-specific tasks, such as spatial-temporal strategic planning [21, 27, 46], financial trading [8, 17, 17, 53, 54], and daily routine with computers and smart phones [18, 48]."}, {"title": "3.2 Physics-Informed Neural Networks", "content": "Conventional neural networks are commonly data-hungry and not explainable. By integrate physics principles into neural networks [35], studies on Physics-Informed Neural Networks (PINNs) show promising results in overcoming such challenges.\nPINN encompasses various approaches to incorporate physics-informed (PI) components into the deep learning pipeline, such as loss functions, parameter initializations and the neural network architectures [13]. As a result, the neural networks are able to learn latent features that are governed by physical laws.\nRecent studies also enhance PINN's convergence, stability, and accuracy, yielding improvements [16, 44, 50]. PINN has found success in a wide range of applications. Some examples include predicting traffic conditions and modeling traffic flow [14, 38], determining circuit parameters for power converter health monitoring [55], computing power flow in electrical systems [12], modeling temperature dynamics in lakes [15], managing real-time reservoir gas production [31], designing quantum circuits [9, 29], and simulating turbulent flows in urban environments [47]. These applications highlight PINNs' promising performance across many domains by infusing physics knowledge into deep learning."}, {"title": "4 METHODOLOGY", "content": ""}, {"title": "4.1 Agentic AI System", "content": "Figure 2 presents the architecture of the proposed LP-COMDA agentic Al system. The front-end consists of a chat interface and API interaction with GPT-4 as reasoning engine, whereas the back-end consists of the agent's tooling, i.e., an optimization algorithm and the PINN-based surrogate model. In terms of workflow, LP-COMDA first collects design specifications from the user and pass to an LLM-based reasoning engine (GPT-4) for planning. Subsequently, the agent invokes the back-end tooling, where the surrogate model produces the performance metrics and passes to the optimization algorithm searches for the optimal modulation parameters. The back-end will respond with a set of optimal design parameters to the front-end to display and visualise as charts for explainability and readability."}, {"title": "4.2 Physics-Informed Power Electronics Modeling", "content": "Power electronics systems are highly nonlinear induced by the complex switching behaviors of semiconductor devices and the coupling of energy storage components. The generic representation of a power electronics system formulated by the nonlinear time-variant state-space equations is given in Eq. 1, where $\\theta$ are the circuit parameters, $u(t)$ and $x(t)$ are the state variables and the input variables, $g(.)$ are general nonlinear functions governing state transition behaviors, and $h(.)$ denotes the input physical laws.\nOverall, the proposed surrogate model consists of two hierarchical PINNs, one ModNet for switch-level modeling to learn the switching behaviors and another one CirNet for the system-level modeling to learn the circuit physics. ModNet is trained to learn the intermediate waveforms $v_p$ and $v_s$ and CirNet infers key characteristic waveforms in the circuit including $i_L, V_{C1}, V_{C2}$, with which the operating performance such as the current stress, soft switching range, and efficiency can be evaluated. As shown in Figure 1, $v_p$ and $v_s$ denote the ac terminal voltages of the primary and secondary full bridges, respectively, and $i_L, V_{C1}$, and $V_{C2}$ represent the inductor current, input capacitor voltage, and output capacitor voltage, respectively.\n$\\frac{du(t)}{dt} = g(x(t); \\theta)u(t) + h(x(t); \\theta)$ (1)\nModNet for Switch-level Modeling of Switching Behaviors: In the modeling of semiconductor switches, the non-ideal equivalent circuit considers the parasitic inductances, capacitances, and resistances. The complicated interactions within circuit components result in nontrivial oscillations and overshoots, which will affect the overall operating performance of the power converter. To address this, the switching behaviors is proposed to be modeled by a physics-informed network, ModNet. ModNet is composed of several layers of gated recurrent units with layer normalization (LN-GRU). The temporal feature of LN-GRU accords well with the task of modulation waveform prediction. As shown in Figure 3 Part (1) and Eq. 2, ModNet infers $\\hat{v}_p(t_k)$ and $\\hat{v}_s(t_k)$ based on the information of the previous timestamp $t_{k-1}$ and the hidden states, and all the intermediate predictions within a switching cycle are stored for training. The training of ModNet utilizes two kinds of losses: (1) the loss based on physics information which helps with switching synchronization; (2) the loss based on experimental data captured by oscilloscope, which helps the model to capture oscillations and overshoots in practical operations.\n$(\\hat{v}_p(t_k), \\hat{v}_s(t_k)) = ModNet(\\hat{v}_p(t_{k-1}), \\hat{v}_s(t_{k-1}); \\theta_{mod})$ (2)\nwhere $\\hat{v}_p(t_k)$ and $\\hat{v}_s(t_k)$ denote the ModNet predictions for $v_p$ and $v_s$ at time $t_k$ given the previous voltages $\\hat{v}_p(t_{k-1})$ and $\\hat{v}_s(t_{k-1})$.\n$\\frac{di_L(t)}{Ldt} = -R_Li_L(t) + v_p(t) - nv_s(t)$ (3)\nwhere L, $R_L$, and n denote features of magnetic components: leakage inductance, equivalent inductor resistance, and turn ratio of transformer, respectively. $i_L(t)$ is the key waveform characterizing main circuit performances such as power transfer, efficiency, thermal behavior, soft switching, electromagnetic interference, etc.\n$\\frac{2C1(t)}{Cu(t)} = -(\\frac{\\partial Spri(t)}{\\partial t} i_L(t) + \\frac{Spri(t) Ri}{C1}) i_L(t) + \\frac{\\partial i_L(t)}{\\partial t} \\frac{Spri(t)}{L} (v_p(t) - nv_s(t))$ (4)\n$\\frac{2C2(t) dSsec(t) Ssec(t) RL}{a^2t} = n\\frac{i_L(t) - \\frac{\\partial i_L(t)}{\\partial t} \\frac{nssec(t)}{L}(v_p(t) - nv_s(t))$ (5)\nwhere $C_1$ and $C_2$ represent input and output capacitors, and $spri(t)$ and $ssec(t)$ are functions describing circuit switching behaviors. $V_{C1}$ and $V_{C2}$ govern the stability, robustness, and power quality when interfacing other power conversion circuits.\nCirNet for System-level Modeling of Circuit Physics: Subsequently, the system-level modeling is attained with the physics-informed circuit net, CirNet. CirNet retrofits a recurrent LN-GRU net to encode circuit physical laws in its inherent feature space. Taking non-resonant DAB converter as an example, main state waveforms are $i_L, V_{C1}$ and $V_{C2}$. By leveraging the Kirchhoff's, Faraday's, and Gauss's laws, the system-level dynamic equations are derived in Eqs. 3 to 5, where the electrical notations are given in Figure 1. Eq. 3 describes the dynamics of high-frequency ac current $i_L(t)$, and Eq. 4 and Eq. 5 present the electrical behaviors of input and output capacitors, which follow second-order differential equations.\nTo predict the key state waveforms, CirNet takes the outputs of ModNet as its inputs and iteratively infers the next state based on the predictions of previous states, as the structure in Figure 3 Part (3) and Eq. 7 shown.\nIn terms of the training for CirNet, similar to ModNet, the loss based on physics information $l_p$ and the loss based on experimental data $l_a$ are both deployed, as shown in Eq. 7, in which $\\lambda_d$ and $\\lambda_p$ are their loss factors. In $l_p$, the circuit physical dynamics expressed in differential equations 3 to 5 are embedded in the loss functions for physics learning.\nIn $l_a$, several data points of the inductor currents $i_L$ in the hardware experiments are taken as the ground truth, where the datapoints are denoted as ${i_L,j(t_1)..... i_L,j(t_T)}$. The waveform predictions are saved for a switching period for the performance evaluation.\n$\\hat{i}_L(t_{k+1}) = CirNet(i_L(t_k), ModNet(\\hat{v}_p(t_k), \\hat{v}_s(t_k); \\theta_{mod}); \\theta_{cir})$ (6)\n$l_{Cir} = \\lambda_al_a + \\lambda_pl_p$\n$\\lambda_a=\\frac{\\lambda}{\\sum_j\\sum_k[\\hat{i}_{L,j}(t_{k+1}) - i_{L,j}^*(t_{k+1})]^2 +\\frac{1}{\\sum_j\\sum_k(\\frac{\\partial \\hat{i}_{L,j}(t_{k+1})}{\\partial t} - \\frac{v_p(k+1) - nv_s(k+1) - R_Li_{Lj}^*(t_k)}{\\Delta t_k})^2}$\n(7)\nCircuit Performance Evaluation Based on CirNet: With the output of the two hierarchical PINNs, ModNet and CirNet, the power converter performance can be evaluated. With the key waveform inference results from the previous CirNet, a variety of electrical performance metrics can be measured, aiming to provide critical and comprehensive assessments for power electronics systems. As shown in Figure 3 Part (3), the difference of the maximum and minimum values of $i_L(t)$ gives the peak-to-peak current stress. The numerical integration of $[s_1(t)i_f(t)]^2$ provides the conduction loss evaluation for semiconductor switches. Soft switching performance, which is especially important for high-frequency scenarios like the electric vehicle charging, is analyzed by imposing"}, {"title": "5 EXPERIMENTS", "content": ""}, {"title": "5.1 Experiments Setup", "content": "We primarily aim to ascertain the accuracy of the ModNet and CirNet surrogate models, where heightened model accuracy in the core engine translates to superior system design performance. Therefore, we carried out several experiments to validate LP-COMDA's model performance in a low-resource setting, i.e., using a tiny dataset with only 200 samples.\nData Preparation: In this work, we focus on a modeling task of time-series forecasting for the inductor current $i_f(t)$ of DAB converters under triple phase-shift (TPS) modulation as a representative example. Using a hardware experimental prototype, we acquired waveform data spanning 200 sequences. The configuration of the hardware prototype and the methodology employed for data acquisition are elucidated in reference [26].\nOne of the advantages of PINN models is that it requires very few samples to learn as compared to other machine learning models. To demonstrate this advantage, we conduct our experiments with two different data splitting ratios. For the first set, we split the data into 5% training (10 samples), 10% validation (20 samples) and 85% test (170 samples). The second set is split into 50%, 10% and 40% for training, validation and test, respectively.\nBaseline: To evaluate LP-COMDA's design outcomes we use the following baselines: (1) the Bayesian Network (BN) [34], (2) Support Vector Regression (SVR) [40], (3) XGBoost [6], (4) Random Forest (RF) [4], (5) Long-Short-Term-Memory (LSTM) [10], (6) GRU net [7], (7) LN-GRU net [3], (8) Temporal Convolutional Net (TCN) [19], (9) GRU-Based Variational Autoencoder (GRU-VAE) [1], (10) Time-Series Transformer (TST) [52], (11) Time-Series Net Adapted from Vision Transformer (TSiT-Plus) [32], and (12) MiniRocket [41].\nHyperparameter Search: For fair comparison, we conduct hyperparameter search on the validation set for LP-COMDA and constraints on $i_f (t)$ at the device commutation moment, where $s_{pri}(t)$ and $s_{sec}(t)$ are needed for synchronization. Other electrical performances can be gauged with the domain expertise in power electronics.\nAs described in Figure 2, in the core engine, optimization algorithms are deployed to cooperate with ModNet and CirNet to find the optimal modulation parameters. The optimization procedure is an iterative cycle, in which the optimization algorithm passes the operating conditions and modulation parameters to the physics-informed surrogate models ModNet and CirNet, and these models provide evaluated performance metrics to steer the optimization process.\nBy incorporating physics information within the neural networks, the model's interpretability is heightened, concurrently leading to a reduction in the necessary training data points. Furthermore, the entire design automation system exhibits seamless scalability through the integration of surrogate models for additional functions into the core engine. Importantly, users can access these functionalities without any alterations to their experience."}, {"title": "5.2 Experimental Results", "content": "Table 3 and 4 summarise the experimental results for LP-COMDA and baseline for two different splits. Each algorithm with the respective optimal hyperparameters was ran for ten times. The average MAE for training, validation and test sets are reported. The reported P-values are the results of T-tests at a significance level of 0.02.\nFor both splits, experimental results show that LP-COMDA outperforms conventional machine learning approaches, such as BN, SVR, XGBoost and RF, and exhibits superior performance over deep learning predictive models, such as LSTM, GRU, LN-GRU and TCN, and predictive models such as GRU-VAE. When compared to state-of-the-art models like TST, TSiTPlus, and MiniRocket, LP-COMDA again demonstrates notably enhanced forecasting accuracy. To further affirm the hierarchical PINNs structure, we contrasted CirNet with LP-COMDA. Noticeably, LP-COMDA with 10 training samples outperforms most benchmarks with 100 training samples, and align with CirNet-Only model.\nTo visualize the modeling performance, Figure 5 presents the modeled $i_L$ waveform for both LP-COMDA and benchmark models. Notably, the LP-COMDA modeling outcomes align more congruently with the measurements than any of the other models, demonstrating its outstanding modeling precision.\nOverall, we conclude that the proposed LP-COMDA statistically achieves better modeling results than other baseline models for power electronics modeling, even with extremely low-data scenario."}, {"title": "6 USER STUDY", "content": "To assess LP-COMDA's empirical performance in improving engineering efficiency, we design a practical use case for the modulation strategy of the DAB converter and conduct an empirical experiment with 20 industrial practitioners.\nThe user requirements for this design process include:\n\u2022 Guidance in defining design specifications.\n\u2022 Optimal design outcomes for the tailored scenario.\n\u2022 Analysis on the design outcomes.\nBased on the use case, we conduct a user study with 20 industrial practitioners recruited via research labs and collaborating external companies on a voluntary basis. The participants consist of 10 junior engineers with less than three years of experience, and 10 senior engineers with over five years of relevant experience. All participants declared to have no prior experience in using LLM to assist engineering design works.\nAll participants are given two independent variants of the same task, namely to design the TPS modulation strategy for a Dual Active Bridge (DAB) converter to serve as a DC transformer of the DC-DC power grid, as shown in Fig. 1. We ask the participant to first use LP-COMDA's chat interface to address task variant one. After completion, they then use standard practice (i.e. analytical and manual design) based on the given design requirements and data to address task variant two. To assess the effectiveness, the effective working hours are measured in 30-minute time blocks while tackling the tasks."}, {"title": "7 CONCLUSION", "content": "Modulation strategy design of power converters is pivotal for the optimal functioning of renewable energy power systems. However, numerous AI-centric modulation design automation systems today grapple with challenges tied to explainability, usability, scalability, and data intensity. In our research, we introduced LP-COMDA, a LLM-based Physics-informed autonomous agent to perform effective power converter modulation design automation. Experiments demonstrate LP-COMDA's proficiency in accurate power converter modeling, even with a data-constrained environment. Our user study shows that using LP-COMDA helps engineers improve efficiency by over 33 times in practice."}]}