{"title": "Fiber neural networks for the intelligent optical fiber communication signal processing", "authors": ["YUBIN ZANG", "ZUXING ZHANG", "SIMIN LI", "FANGZHENG ZHANG", "HONGWEI CHEN"], "abstract": "Optical neural networks have long cast attention nowadays. Like other optical structured neural networks, fiber neural networks which utilize the mechanism of light transmission to compute can take great advantages in both computing efficiency and power cost. Though the potential ability of optical fiber was demonstrated via the establishing of fiber neural networks, it will be of great significance of combining both fiber transmission and computing functions so as to cater the needs of future beyond 5G intelligent communication signal processing. Thus, in this letter, the fiber neural networks and their related optical signal processing methods will be both developed. In this way, information derived from the transmitted signals can be directly processed in the optical domain rather than being converted to the electronic domain. As a result, both prominent gains in processing efficiency and power cost can be further obtained. The fidelity of the whole structure and related methods is demonstrated by the task of modulation format recognition which plays important role in fiber optical communications without losing the generality.", "sections": [{"title": "Introduction.", "content": "The surge of artificial intelligence (AI) has deeply and broadly changed the way of scientific researches including fields of photonics and optics. On one hand, various types of optical neural networks which designing photonic structures toward AI has been proposed to further increase computing speed and power efficiency. On the other, the neural network itself can be applied to establish fast and accuracy photonic or optic models in return.\nAs is listed in Fig.1, in fields of optical and photonic neural networks, several mile-of-stone structures like Mach-Zehnder Interferometer (MZI) structured photonic neural network [1], deep diffractive neural network [2] and etc have been put forward since 2017 [3-7]. In fields of Al-based optical or photonic models, rather more diverse cases can be found. Not only has Al permeates into the researches like optical membrane design, photonic waveguide optimizing, but also the fields of optical communications. Particularly, important Al-based fiber models including BiLSTM [8], GAN [9], multi-head attention [10, 11], Fourier operator models [12] and etc [13-16] have been proposed in recent years.\nThough both branches of Al optics as illustrated above have developed profoundly and rapidly, seldom has optics neural networks and Al-based optics models deeply integrated into each other. As in the disciplinary fields between Al and fiber communications, though optical neural networks and Al-aided fiber models have been both proposed at the early age, rarely has optical neural networks been applied into addressing optical fiber transmission problem. Therefore, in this letter, the fiber neural network and its related signal processing method towards addressing fiber communication signal processing problems is proposed. Once adopted, the fiber can not only realize signal transmission but also signal computation. It shred the hope that transmitted signals inside the core of fiber can be automatically processed all through optical domain instead of being converted into electronic domain and then processed. The fiber system will become the distributed computational transmission media from this point of view and will thus posses both high computing"}, {"title": "Network's structure and dataset.", "content": "The fiber optical neural network structure contains one input branch, one output branch and an optical computing ring. Components mainly include laser source, single mode fiber (SMF), erbium-doped fiber amplifier (EDFA), amplitude modulators (AM), dispersion compensation fiber (DCF), photodetector (PD) and etc all construct the whole structure as is shown in Fig.2. The function of input branch is to generate stretched light pulses to be modulated and the function of output branch is to convert the signals from optical domain into electronic domain for further processing and analyzing.\nThe computing ring in the model is to implement the configurations of the theoretic neural network model. The total mechanism lays down on the implementation of linear computations and nonlinear activation since most theoretic neural network models such as fully-connected networks, convolution networks or long-short term memory networks contain these two types of calculation.\nWhen it comes to linear computation, it can firstly be viewed as matrix multiplication. Then, this multiplication can be further viewed as several multiplications between the row vector of the left-sided matrix with the column vector of the right-sided matrix. Under this circumstance, matrix multiplications can be realized by successively conducting vector multiplications in order. As for the computing ring, AMs, EDFA, SMF, DCF can implement this vector multiplication operation. When light travels into each loop of the ring, two vectors which are prepared to conduct the multiplication will firstly be modulated onto the peaks of light pulses, then DCF will take use the dispersion effect to compress the pulses so as to implement the vector multiplication. Later, matrix multiplications (linear computations) can be obtained by implementing each vector multiplication via loop in order.\nNonlinear activation can be realized via reconfigurable optical attenuation device which also exists in the optical computing ring structure. This device can realize different transmission ratio for different energy of light so as to implement the any types of nonlinear activation functions. Without losing the generality in this task, the activation function to be implemented is chosen to be 'Purelin' which has been broadly used in today's most theoretic neural networks.\nThe task for demonstrating this optical neural network's ability to process optical fiber communication signals is MFR since it has been one of the most frequently occurred problems in optical fiber communications. More specifically, MFR essentially requires the intelligent system to categorize different modulation formats according to the provided statistical information originated from the transmitted modulated signals. In this letter, three different modulation formats-OOK, PAM and PSK, each with four types of statistical attributes-algebraic mean, variance, variation and geometric mean are adopted to discern. Under this circumstance, the dataset of MFR consists of the four statistical attributes as the input and the classification of modulation formats which utilizes the 'one-hot' encoding as the label. In total 150 samples exist in the hole dataset and were separated into training dataset and testing dataset at the ratio 8:2.\nIn order to maintain the best activation states of each neuron, raw data need to conduct normalization before entering. As for this task, the normalization is determined to be Minmax normalization which maps the raw data into the ranges between - 1 and 1. This normalization method has also been commonly used in other theoretic neural networks and has been one of the standard normalization types among all."}, {"title": "Simulation setups and procedures.", "content": "For the establishment of optical fiber neural networks, in total three steps need to be done. First, the theoretic neural network model should be chosen. Second, hyper-parameters like loss function, learning rate, drop out ration need to be determined and then the network model needs to be appropriately trained to bridge the connection between the attributions input and the categorization labeled. At last, neurons' weights from the optimized theoretic neural network model should be transferred into modulated signals in the optical fiber neural network frame.\nAs for the chosen of theoretic neural network model, in order to alleviate the load of fiber optical neural networks, it is determined to be a three-layer fully-connected neural network, with 3, 6 and 4 neurons in each layer. The nonlinear function for the network is chosen to be 'Purelin' at the end of each layer.\nWhen it comes to the training and optimizing the theoretic fully- connected neural network, hyper-parameters such as the loss function, optimization algorithm, learning rate and etc should be determined in advance. For this type of task, either normalized mean square error (NMSE) or cross entropy (CE) can be utilized as the loss function. For learning rate, it is chosen to be $10^{-3}$. The optimization algorithm is chosen to be adaptive momentum stochastic gradient descend method (ADAM) which has been frequently taken into use in the training of neural networks. In total 120 samples from the training dataset are injected into the fully-connected neuron network to let it establish the relations between statistical attributes with the correct modulate format category.\nThe final step for establishing the optical neural network is to map the neurons' weights from the optimized fully-connected neural network model to the optical fiber neural network frame. As for the theoretic fully-connected model, it can be concluded that"}, {"title": "", "content": "both linear computations and nonlinear activation need to conduct between each layer. If the matrix W and b represents the neurons' weights and biases between each layer, f() represents the nonlinear activation function between each layer, x and y represent the network's inputs and outputs respectively, then the theoretic fully-connected neural networks can be described mathematically as\n$y = f(W_{23}f (W_{12}x)+b_{23}),$\nwhere the scale of $W_{12}$, $W_{23}$, $b_{12}$, $b_{23}$ is 6x3, 4x6, 6\u00d71, 4\u00d71 respectively while the scale of x and y equals 3\u00d71 and 4\u00d71 which are in consist with the scale of the attributes input and the category output respectively.\nFor the processing convenience, if $b_{12}$ is positioned at the last column of the weight matrix $W_{12}$ and 1 is add at the bottom of the input vector x, then Eq.(1) can be simplified as\n$y = f(W_{23}f (W_{\\text{\\textcircled{12}}}x)+b_{23}),$\nin which $W_{\\text{\\textcircled{12}}}=[W_{12}, b_{12}]$ and $x=[x, 1]^{T}$. The same simplification can be conducted for the computations between the hidden layer and output layer. At last, Eq.(2) can be further simplified as\n$y = f(W_{\\text{\\textcircled{23}}}f (W_{\\text{\\textcircled{12}}}x)),$\nwhere $W_{\\text{\\textcircled{23}}}=[W_{23}, b_{23}]$ and $f(W_{\\text{\\textcircled{12}}}x)=[f(W_{\\text{\\textcircled{12}}}x), 1]$.\nSince the optical fiber neural network takes 'Purelin' as its nonlinear activation function, modified weight matrices $W_{\\text{\\textcircled{12}}}$ and $W_{\\text{\\textcircled{23}}}$ can be further combined as $W_{\\text{\\textcircled{e}}} = W_{\\text{\\textcircled{12}}}W_{\\text{\\textcircled{23}}}$. Under this circumstance, Eq.(3) can be expressed as\n$y = W_{\\text{\\textcircled{e}}}x,$\nThe following and the most important work is to map both $W_{\\text{\\textcircled{e}}}$ and x into modulated signals in optical fiber neural network. Since optical fiber neural network utilizes intensity modulator which can not directly modulate negative weights onto the light while both $W_{\\text{\\textcircled{e}}}$ and xe contain negative values due to the training process and normalization operations, extra actions need to be taken to help the fiber optical neural network deal with negative values. Here, the matrix symbol separation method that divides both $W_{\\text{\\textcircled{e}}}$ and x into positive components $W_{\\text{\\textcircled{e}}}^{+}, x_{\\text{\\textcircled{e}}}^{+}$ and negative components $W_{\\text{\\textcircled{e}}}^{-}, x_{\\text{\\textcircled{e}}}^{-}$ was adopted. In this case, Eq.(4) can be rewritten as\n$y=(W_{\\text{\\textcircled{e}}}^{+}-W_{\\text{\\textcircled{e}}}^{-})(x_{\\text{\\textcircled{e}}}^{+}-x_{\\text{\\textcircled{e}}}^{-})=(W_{\\text{\\textcircled{e}}}^{+}x_{\\text{\\textcircled{e}}}^{+}+W_{\\text{\\textcircled{e}}}^{-}x_{\\text{\\textcircled{e}}}^{-})-(W_{\\text{\\textcircled{e}}}^{+}x_{\\text{\\textcircled{e}}}^{-}+W_{\\text{\\textcircled{e}}}^{-}x_{\\text{\\textcircled{e}}}^{+}),$\nAs can be observed from Eq.(5), Positive components keep positive values of the original matrices or vectors while taking 0 for negative values. Negative components take the opposite numbers of the negative values of the original matrices or vectors while taking 0 for positive values. When compared Eq.(5) with Eq.(4), it can be indicated that four matrix multiplication computations need to be done by the fiber optical neural network in order to implement the original one matrix multiplication in the theoretic full-connected neuron network.\nModulated signals mapping follows the transmission rules of the fiber optical frame. For each flattened-peaked light pulse, if $E_{s}(\u00b7)$ and $E(\u00b7)$ represent the waveform of electric field of the light pulse after and before the modulation and $s(\u00b7)$ represents the modulated signal, then modulation operation can be mathematically expressed as [17, 18]\n$E_{s} = s(T)E = E \\sum_{i=1}^{N} w_{i} x_{i} \\text{Rect}\\left(\\frac{T-(2 i-1-N)}{\\Omega \\beta_{2} l / N}\\right)$\nwhere the index i marks either the order of the element w in weight matrix or x in the input vector. \u03a9 describes the angular bandwidth of the light pulse. $\u03b2_{2}$ and I represents the second-order propagation constant which is related with chronic dispersion and the length of SMF. T is the time-latent coordinate and Rect() represents the rectangular shaped function whose value equals one at the maxima and width is marked at its footnote. Under this circumstance, the results can be obtained at the end of each optical loop in the optical fiber neural network as\n$\\varphi = \\sum_{i=1}^{n} w_{i} x_{i}$\nwhere \u03c6 represents the compressed pulse energy and y is the coefficient."}, {"title": "Results and analysis.", "content": "After the establishing of the fiber optical neural network, 30 samples, with 10 samples from each modulation format category that the neural network has never seen forms test dataset to test the real ability of discern.\nDifferences in outputs from the theoretic model and fiber neural network can be found from Fig.4. They are mainly caused by the unflatness of stretched pulses, the pulse compression process and the mapping between pulses' energy into final results. The unflatness of stretched pulses which can be observed from Fig.3(b) causes the inaccurate of modulating. For pulse compression process, the ideal addition are hard to reach since there exists no perfect DCF which can completely compress the width of the stretch pulse into 0. In this case, the error may inevitably occur. The convert of pulses' energy into final results can also cause the error. It is because the compression results are closely related with pulses' shapes which are different since different pulses carry different weights or inputs. In conclusion, though errors exist, the results are acceptable as long as they does not deviate too far from the ideal ones.\nNoise caused by EDFA and PD in the fiber optical neural network can have influence on final discern results as well. In order to test how noise affect the fiber neural network's performance, noise figure of EDFA is set to be 4dB, different noise like thermal noise, shot noise from PD are also added as well. Error bars are adopted to describe the results affected by the noise in Fig.5. It can be concluded that though errors exist, they does not exceed the boundary that can cause the mis-classification. This indicates that the fiber optical neural network can posses the relatively strong ability of resisting noise. Several possible reason for it can be obtained after carefully analysis. First, though signals are computed and propagated under the interference of noise from EDFA, the accumulation of noise can not affect much since pulses are compressed by DCF in each loop. The DCF performs as a low-pass filter which can cancel out portions of noise. Then, at the output branch of the fiber neural network, though noise from PD can not be neglected when turning optical signals into electronic signals, addition and subtraction between each pulses groups are conducted which is described by Eq.(5). These operations perform as non-interference accumulations which can filter out relatively large portions of noise as well according to the theory of probability and stochastic process."}, {"title": "Conclusions and discussions.", "content": "In this letter, the fiber optical neural network and its related signal processing methods for the future fiber optical communication signal processing are proposed. Once being adopted, this neural network can further propel the deep integration between Al and optics. Through the demonstration of MFR, the fiber neural network can not only posses the ability of accurate predicting but also noise resisting.\nFuture research will focus on adopting this optical neural network to directly process the communication signals instead of the pre-extracted statistical information of the signals."}]}