{"title": "DYffCast: Regional Precipitation Nowcasting Using IMERG Satellite Data. A case study over South America", "authors": ["Daniel Seal", "Rossella Arcucci", "Salva R\u00fchling-Cachay", "C\u00e9sar Quilodr\u00e1n-Casas"], "abstract": "Climate change is increasing the frequency of extreme precipitation events, making weather disasters such as flooding and landslides more likely. The ability to accurately nowcast precipitation is therefore becoming more critical for safeguarding society by providing immediate, accurate information to decision makers. Motivated by the recent success of generative models at precipitation nowcasting, this paper: extends the DYffusion framework to this task and evaluates its performance at forecasting IMERG satellite precipitation data up to a 4-hour horizon; modifies the DYffusion framework to improve its ability to model rainfall data; and introduces a novel loss function that combines MSE, MAE and the LPIPS perceptual score. In a quantitative evaluation of forecasts up to a 4-hour horizon, the modified DYffusion framework trained with the novel loss outperforms four competitor models. It has the highest CSI scores for weak, moderate, and heavy rain thresholds and retains an LPIPS score < 0.2 for the entire roll-out, degrading the least as lead-time increases. The proposed nowcasting model demonstrates visually stable and sharp forecasts up to a 2-hour horizon on a heavy rain case study.", "sections": [{"title": "Introduction", "content": "The ability to accurately nowcast (predict up to 6 hours in advance [1]) precipitation, is a vital task that can help mitigate hazards such as flooding or landslides [2]. Globally, heavy precipitation events are becoming more common due to climate change [3, 4, 5, 6, 7], causing large human displacement, human fatalities [8], and economic cost. Accurate precipitation forecasts are therefore becoming more instrumental in providing critical information required for weather-dependent decision making that can safeguard society. The absence of effective precipitation models especially impacts countries that lack access to freely available ground-based radar systems and experience vulnerability in resource management, agriculture, disaster preparedness, and climate adaptation.\nThis work evaluates the applicability of a novel probabilistic, spatio-temporal forecasting framework, DYffusion [9], to precipitation nowcasting. This research is motivated by the recent success of generative modelling at this task and, DYffusion's skilful forecasts over long horizons on Navier-Stokes flows and sea surface temperatures (SST); two systems that exhibit complex dynamics comparable to that of precipitation. In this study, the focus is on how well DYffusion can forecast up"}, {"title": "Methods", "content": ""}, {"title": "Data", "content": "This research uses the publicly available satellite precipitation product, IMERG. In particular, it uses the latest version (V07B [10]) of the half-hourly, Early Run product with a 0.1\u00b0 spatial resolution and precipitation rates in mm \u00b7 h\u207b\u00b9. The dataset is created from four 128\u00d7128 grid boxes that cover the South American countries: Colombia, Ecuador and Per\u00fa. These are regions that are susceptible to increased flooding and have limited availability of weather radar. The four 128\u00d7128 grid boxes are stacked into dimensions: (N, S, C, H, W) where N is the number of samples, S is the sequence length (input and target) and C is the number of channels (1 for IMERG). The data is preprocessed to [0, 1] using linear normalisation, log(1 + X) transform and min-max normalisation. For this research, a 4-hour horizon or 8\u00d71\u00d7128\u00d7128 images, was chosen to match the latency of the Early-Run IMERG product and avoid any discontinuity of real-time data."}, {"title": "Modelling", "content": ""}, {"title": "DYffusion Framework", "content": "The DYffusion framework is outlined in Figure 1. It consists of an Interpolator network, If and a Forecastor network, Fo.\nTraining. If is trained to interpolate any timestep of the sequence $x_{t+in}$, given the initial and final states, $x_0$ and $x_{t+h}$, respectively. Fo is trained to forecast the horizon $x_{t+h}$ given the initial condition $x_0$ and an intermediate state $x_{t+in}$. This two-stage training has a constant memory footprint as a function of h, only requiring $x_0$ and $x_{t+h}$ (plus $x_{t+in}$ during the Interpolator training).\nInference. Given an initial condition, $x_0$, the entire sequence $x = [x_{t+in}]_{n=1}^{n=h}$ is generated over N (or h) auto-regressive steps. At step s = 0 (n = s + 1), Fo predicts the horizon $x_{t+h}^{ms=0}$ using only $x_0$. If then interpolates $x_{t+i_1}$ using $x_0$ and $x_{t+h}^{ms=0}$. At the next step (s = 1), Fo predicts the horizon again $x_{t+h}^{ms=1}$, using $x_0$ and $x_{t+i_1}$. $x_{t+h}^{ms=1}$ and $x_0$ are then used to interpolate, $x_{t+i_2}$. This process is repeated until Fo predicts $x_{t+h}^{ms=N-1}$ (N times), using the nearest intermediate value, $x_{t+in-1}$. This iterative process is analogous to the iterative denoising in standard diffusion models and underpins the time-coupled, Dynamics informed nature of the DYffusion framework. The final forecast is the mean of an ensemble of $X^N$ members.\nThe probabilistic nature of DYffusion occurs through Monte Carlo dropout. If is trained with dropout rates that are enabled during the training (and inference) of Fo. Enabling dropout during training is analogous to I interpolating $x_{t+in}$ by sampling it from the conditional probability distribution $P(x_{t+in} | x_0, x_{t+h})$."}, {"title": "DYffusion Key Modifications", "content": "For the IMERG dataset, the SST U-Net backbone from DYffusion and parts of the training framework were modified to model the rainfall data. The following key modifications were made:"}, {"title": "Baselines", "content": "We compare DYffusion to auto-regressive implementations of both deterministic and statistical methods to align more closely with DYffusion's roll-out inference:"}, {"title": "Conclusion", "content": "In this study, DYffusion has been extended to the task of precipitation nowcasting. The task was to forecast IMERG precipitation data at 30-minute intervals up to a 4-hour horizon, generating a total of 8\u00d71\u00d7128\u00d7128 images. By applying key modifications to the DYffusion framework and introducing a novel loss function, the modified framework outperforms both deterministic (ConvLSTM) and statistical (STEPS) baselines. Overall, the initial results of DYffusionLCB suggest that with some improvements, the DYffusion framework is a potential candidate for operational precipitation nowcasting. The constant memory footprint associated with the forecast-interpolate process makes it an attractive alternative to single-pass generative networks.\nLimitations. Nowcasting precipitation is more challenging than SST or Navier-Stokes. The initial task of forecasting the 4-hour horizon from a single timestep is difficult. The implemented U-Net backbone struggles to not forecast $x_{t+h}$ as an expansion or reduction of the initial condition $x_0$. This ultimately constrains the problem to the spatial domain of $x_0$, contributing to the limited variability in the ensemble forecasts.\nFuture Work. The results of [19] demonstrate the importance of high SSR scores for more skilful precipitation nowcasts. Conditioning the initial forecast $r_{initial}$ with atmospheric information, such as divergence at 925 hPa and wind speed, is an interesting avenue to explore. The additional physical context should help the model capture the non-linear chaotic evolution of the rainfall, especially at earlier timesteps, similar to the motion field in STEPS. This should improve $r_{initial}^{x_{t+h}}$ and, therefore, the overall stochasticity by allowing the framework to sufficiently explore $P(x_{t+i_1:t+h}|x_0)$."}]}