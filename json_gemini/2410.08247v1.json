{"title": "Forecasting mortality associated emergency department crowding", "authors": ["Jalmari Nevanlinna", "Anna Eidst\u00f81,2", "Jari Yl\u00e4-Mattila1,2", "Teemu Koivistoinen", "Niku Oksala1,3", "Juho Kanniainen", "Ari Palom\u00e4ki1,4", "Antti Roine1"], "abstract": "Emergency department (ED) crowding is a global public health issue that has been repeatedly associated with increased mortality. Predicting future service demand would enable preventative measures aiming to eliminate crowding along with it's detrimental effects. Recent findings in our ED indicate that occupancy ratios exceeding 90% are associated with increased 10-day mortality. In this paper, we aim to predict these crisis periods using retrospective data from a large Nordic ED with a LightGBM model. We provide predictions for the whole ED and individually for it's different operational sections. We demonstrate that afternoon crowding can be predicted at 11 a.m. with an AUC of 0.82 (95% CI 0.78-0.86) and at 8 a.m. with an AUC up to 0.79 (95% CI 0.75-0.83). Consequently we show that forecasting mortality-associated crowding using anonymous administrative data is feasible.", "sections": [{"title": "Introduction", "content": "Emergency department crowding remains a persistent problem worldwide, the adverse effects of which include increased number of medication errors [19], delays in onset of medication such as antibiotics [1], analgesics [27] or thrombolysis [30], prolonged length of stay [23] and dissatisfaction of the patients [5, 33]. Most importantly, however, crowding has been repeatedly associated with increased"}, {"title": "Materials and Methods", "content": "Tampere University Hospital is an academic teaching hospital located in Tampere, Finland. Tampere University Hospital serves as a secondary care provider for over 500,000 residents within the Wellbeing Service County of Pirkanmaa and is the sole facility in the region equipped to handle all severe emergencies. Additionally, it functions as a tertiary care unit for a broader area encompassing more than 900,000 residents. With approximately 90,000 annual visits, its ED ranks among the largest in the Nordic European countries. The ED features"}, {"title": "2.1 Data sets and data splitting", "content": "Tampere University Hospital is an academic teaching hospital located in Tam- pere, Finland. Tampere University Hospital serves as a secondary care provider for over 500,000 residents within the Wellbeing Service County of Pirkanmaa and is the sole facility in the region equipped to handle all severe emergencies. Additionally, it functions as a tertiary care unit for a broader area encompassing more than 900,000 residents. With approximately 90,000 annual visits, its ED ranks among the largest in the Nordic European countries. The ED features"}, {"title": "2.1.1 Target variables", "content": "In our previous work, we associated EDOR levels higher than 90% with increased 10-day mortality [9]. Here, we will consider every day during of which three or more hours exceed this threshold to be crowded. In our testing protocol we simulate passing of time during a morning shift from 8 a.m. to 1 p.m. and aim to forecast whether the rest of the day will be crowded or not. This idea is presented graphically in Figure 1. Classification results for each forecast origin are reported independently."}, {"title": "2.1.2 Explanatory variables", "content": "The explanatory variables are listed in Table 1. For each day, six different forecast origins were considered from 8 a.m. to 1 p.m. and the origins were used as an indicator variable along with subgroup indicator variables. For each origin, both EDOR and crowding history of each subgroup for the last 168 hours were included. Five weather variables were included: precipitation, snow depth and air temperature maximum, minimum and mean. This resulted in 24 \u00d7 1365 matrix for each day in the dataset. This data handling protocol allows us to train a single model at each re-training iteration which enables faster training and allows cross-learning across different subsections."}, {"title": "2.2 Feature importance analysis", "content": "Relative importance of the used explanatory variables (features) were calculated using Shapley additive explanations (SHAP) [20]. Shapley importance, derived from cooperative game theory, is a method used to fairly distribute the total gains (or importance) among features based on their contributions. For a given model, the Shapley value for a feature represents its average marginal contribu-"}, {"title": "2.3 Performance metrics", "content": "The performance of the model is evaluated using an exhaustive set of binary performance metrics. Some of them are shortly defined below and the rest of them a provided in Appendix A.\nThe F1 score is the harmonic mean of precision and recall. It provides a balance between the precision and the recall, making it useful for situations where both false positives and false negatives are important.\n$F1=2 \\cdot \\frac{\\text { Precision } \\cdot \\text { Recall }}{\\text { Precision }+\\text { Recall }}$\nAccuracy measures the overall correctness of the model by calculating the proportion of true results (both true positives and true negatives) among the total number of cases examined.\n$\\text { Accuracy }=\\frac{\\text { TP }+\\text { TN }}{\\text { TP }+\\text { TN }+\\text { FP }+\\text { FN }}$\nArea under the receiver operating characteristics curve (AUROC) provides a single metric to evaluate the performance of a binary classifier. It represents the probability that a randomly chosen positive instance is ranked higher than a randomly chosen negative instance.\n$\\text { AUROC }=\\int_{0}^{1} \\text { TPR }\\left(\\text { FPR }^{-1}(x)\\right) d x$\nArea under the precision-recall curve (AUPRC) measures the trade-off between precision and recall for different threshold values, offering a summary of the model's performance when dealing with imbalanced datasets.\n$\\text { AUPRC }=\\int_{0}^{1} \\text { Precision }\\left(\\text { Recall }^{-1}(x)\\right) d x$\nStatistical significance 95% confidence intervals of the AUROC values were calculated using bootstrapping. Bootstrapping involves drawing a large number B of bootstrap samples X* = {x1, x2,...,x} by sampling with replacement"}, {"title": "2.4 Model", "content": "LightGBM (Light Gradient Boosting Machine) is a machine learning framework for gradient boosting developed Ke et al. [18]. It is designed to be highly efficient and scalable, particularly for handling large datasets and high-dimensional data. LightGBM is the state-of-the art model in time series in general [22] and we have previously demonstrated it's excellent performance with ED as well [35].\nLightGBM uses a histogram-based learning method that buckets continuous feature values into discrete bins, reducing computational cost and memory us- age. It grows trees leaf-wise, splitting the leaf with the highest loss reduction, which allows for deeper and more accurate trees compared to traditional level- wise growth. To handle high-dimensional data, LightGBM employs Exclusive Feature Bundling (EFB), which bundles mutually exclusive features to reduce the number of effective features. This results in faster training without sacrific- ing accuracy. Additionally, Gradient-based One-Side Sampling (GOSS) focuses on instances with large gradient values, enhancing both training speed and model accuracy by prioritizing harder-to-fit instances. It also directly handles categorical features using a specialized algorithm for decision splitting, avoid- ing the need for one-hot encoding. This improves efficiency and simplifies the preprocessing pipeline."}, {"title": "Results", "content": "Out of the 791 days in the sample, 218 (28%) days were crowded among the bedocuppying patients, 288 (36%) in the medical section and 199 (25%) in the surgical section. Temporal distribution of these days is provided in Figure 2. The hourly pattern of crowding incidence is provided in Figures 3 and an example on their distribution over several weeks in Figure 4. Between 8 a.m. and 11 a.m. crowding was nonexistent or extremely rare 0-1% of hours being crowded. Crowding starts to increase with prevalence of 2%, 6% and 2% among bedoccupying, medical and surgical sections. After this the prevalence increases following a normal distribution and peaks at 4 p.m. among bedoccupying patients (28%), 3 p.m. among medical patients (38%) and 5 p.m. among surgical patients (22%) before becoming increasingly rare towards the end of the day."}, {"title": "3.1 Descriptive statistics", "content": "Out of the 791 days in the sample, 218 (28%) days were crowded among the bedocuppying patients, 288 (36%) in the medical section and 199 (25%) in the surgical section. Temporal distribution of these days is provided in Figure 2. The hourly pattern of crowding incidence is provided in Figures 3 and an example on their distribution over several weeks in Figure 4. Between 8 a.m. and 11 a.m. crowding was nonexistent or extremely rare 0-1% of hours being crowded. Crowding starts to increase with prevalence of 2%, 6% and 2% among bedoccupying, medical and surgical sections. After this the prevalence increases following a normal distribution and peaks at 4 p.m. among bedoccupying patients (28%), 3 p.m. among medical patients (38%) and 5 p.m. among surgical patients (22%) before becoming increasingly rare towards the end of the day."}, {"title": "3.2 Model performance", "content": "Performance metrics of the model among different sections and forecast origins are provided in Table 2. Additionally, AUROC and PRAUC figures at 11 a.m. are provided in Figure 5. Calendar map of the model performance at 11 a.m. among different days on the test set is provided in Figure 2. At 8 a.m. the respective AUC values among bedoccupying, medical and surgical patients were 0.79 (95% CI 0.75-0.83), 0.77 (95% CI 0.73-0.80) and 0.74 (95% CI 0.69-0.78) respectively. The discriminatory ability increased throughout the day so that at 11 a.m. the model reached an AUC of 0.82 (95% CI 0.78-0.85) among both bedoccupying, 0.80 (95% CI 0.76-0.84) among medical patients, and 0.73 (95% CI 0.68-0.77) among surgical patients. At 1 p.m. the respective AUC values were 0.87 (95% CI 0.84-0.90), 0.86 (95% 0.83-0.89) and 0.78 (95% 0.74-0.83) for bedoccupying, medical and surgical patients respectively."}, {"title": "Discussion", "content": "This study had three main findings. Each of them are discussed separately below.\nForecasting is possible First, we showed that forecasting mortality associ- ated crowding using very simple administrative data is possible with sufficient temporal margin for action. The discriminatory power of the model reached an excellent level in terms of AUC at 11 a.m. and demonstrated fair performance from 8 a.m. to 11 a.m. In fact, the model matches or exceeds the performance of many clinicial decision support algorithms that are widely used in everyday clinical practice. For example, National early warning score (NEWS) that is widely used to predict in-hospital mortality has been documented to reach an AUC of 0.73 [8]. At the default threshold, the negative predictive value of the model was good at the expense of positive predictive value.\nSections differ from one another The model performed better in predict- ing future crowding among medical and bedoccuping patients compared to sur- gical patients. The underlying cause remains elusive with the current dataset. We hypothesize that lower prevalence of crowding among surgical section might play a role. Additionally, medical patients include a sizeable segment of frail patients for whose ability to cope at home is compromised by relatively small disturbances. The presentation of these patients at the ED is likely more cor- related with the state of primary care, which may lead to more predictable patterns.\nCalendar variables are important Weekday was the most important fea- ture which is not surprising because the weekly seasonality of occupancy is well known based on clinical experience and repeatedly documented academically. Coincidentally, Petsis et al. [25] recently also used Shapley values in their work"}, {"title": "4.1 Limitations", "content": "There were some limitations in this study. First, the definition of crowding does not account for different durations of the event although the implications can differ significantly between three hours and eight hours of consecutive crowding. Second, both training and testings set were relatively small which might result in understating the performance of the model but these kind of problems are inevitable if the system would be implemented in practice. Third, it is impor- tant to remember that forecasts alone do not help anyone. In order to extract their benefits, they have to be coupled with effective interventions, the most important of which is ensuring the availability of follow-up care beds as recently highlighted by Stewart et al. [32]. Fourth, this study was limited by design to work with anonymous administrative data and avoided using personal health data to comply with current regulation. It is possible that the performance can be further improved by incorporating more nuanced information about the status of the ED."}, {"title": "Conclusions", "content": "In this study, we were set out to investigate whether mortality associated ED crowding can be predicted with sufficient margin for action. Our results suggest that 1) forecasting mortality-associated crowding is feasible using anonymous administrative data, 2) LightGBM model demonstrates high predictive accu- racy, particularly for medical and bedoccupying patients and achieves an AUC of 0.80 by 11 a.m, 3) sections differ from one another in terms of both preva- lence of crowding and predictability and 4) predicting is possible without access to patient level data which makes the model implementable regardless of the current privacy regulation. The study highlights the need for integrating these forecasts with actionable interventions to enhance patient safety and optimize ED operations. Future research should explore the benefit of including more granular data and involve clinical stakeholders in moving the model from in silico to in vivo."}, {"title": "Appendix", "content": "True positive rate (TPR), also known as recall, measures the proportion of actual positives that are correctly identified by the model.\n$\\text { TPR }=\\frac{\\text { TP }}{\\text { TP }+\\text { FN }}$\nTrue negative rate (TNR), also known as specificity, measures the proportion of actual negatives that are correctly identified by the model.\n$\\text { TNR }=\\frac{\\text { TN }}{\\text { TN }+\\text { FP }}$\nPositive predictive value (PPV), also known as precision, measures the pro- portion of positive results that are true positives.\n$\\text { PPV }=\\frac{\\text { TP }}{\\text { TP }+\\text { FP }}$\nNegative predictive value (NPV) measures the proportion of negative results that are true negatives:\n$\\text { NPV }=\\frac{\\text { TN }}{\\text { TN }+\\text { FN }}$\nFalse positive rate (FPR) measures the proportion of actual negatives that are incorrectly identified as positives by the model:\n$\\text { FPR }=\\frac{\\text { FP }}{\\text { FP }+\\text { TN }}$\nFalse negative rate (FNR) measures the proportion of actual positives that are incorrectly identified as negatives by the model.\n$\\text { FNR }=\\frac{\\text { FN }}{\\text { FN }+\\text { TP }}$"}]}