{"title": "Material Property Prediction with Element Attribute Knowledge Graphs and Multimodal Representation Learning", "authors": ["Chao Huang", "Chunyan Chen", "Ling Shi", "Chen Chen"], "abstract": "Machine learning has become a crucial tool for predicting the properties of crystalline materials. However, existing methods primarily represent material information by constructing multi-edge graphs of crystal structures, often overlooking the chemical and physical properties of elements (such as atomic radius, electronegativity, melting point, and ionization energy), which have a significant impact on material performance. To address this limitation, we first constructed an element property knowledge graph and utilized an embedding model to encode the element attributes within the knowledge graph. Furthermore, we propose a multimodal fusion framework, ESNet, which integrates element property features with crystal structure features to generate joint multimodal representations. This provides a more comprehensive perspective for predicting the performance of crystalline materials, enabling the model to consider both microstructural composition and chemical characteristics of the materials. We conducted experiments on the Materials Project benchmark dataset, which showed leading performance in the bandgap prediction task and achieved results on a par with existing benchmarks in the formation energy prediction task.", "sections": [{"title": "1 Introduction", "content": "The prediction of material properties is an important aspect of materials engineering applications, such as the discovery of novel materialsHamilton et al. (2024) with"}, {"title": "2 Background And Related Works", "content": ""}, {"title": "2.1 Crystal Structures", "content": "The crystal structure of a material consists of a basic crystal cell and a set of atomic primitives associated with that cell, and its uniqueness is reflected in its periodicity and infinity. In three dimensions, the crystal structure is represented by the periodic translation of the crystal cell through a specific lattice matrix, which at the same time embodies infinite repeatability. This property of the crystal structure determines its physical properties, such as the symmetry and mechanical properties of the crystal, etc. Different crystal structures lead to different interactions between atoms, which in turn affect different physicochemical properties of the crystal.\nIn the mathematical representation of crystal structures, a common method is described by M=(A,P,L) Yan et al. (2022b), where A contains the eigenvectors of the n atoms in the crystal cell, P denotes the three-dimensional Euclidean positions of the atoms in the crystal cell, and L describes the repetitive pattern of the crystal cell in three-dimensional space. This representation is capable of accurately depicting the basic elements of the crystal structure and provides a fundamental framework for subsequent studies of crystal properties."}, {"title": "2.2 Crystal property prediction", "content": "The use of deep learning for crystal property prediction has become increasingly popular in recent years, as it offers computationally efficient alternatives to classical simulation methods. In the current research frontier of crystal property prediction, the results mainly focus on the relevant variants of the Transformer structure, which fully take into account the unique physical properties of the crystal structure, such as periodicity, SE(3) invariance, SO(3) isotropy, and other key attributes. ComformerYan et al. (2024b), by capturing the periodicity feature of the crystal structure, proposes a graph-based Transformer model, as well as SE(3)-invariant and SO(3)-isotropic crystal graph representations for geometrical integrity and effective prediction of crystals. Efficient message passing with iComFormer and eComFormer is used to ensure the computational complexity while fully taking into account the geometrical information to achieve accurate prediction of crystal material properties. MatFormerYan et al. (2022b) focuses on solving the problem of encoding the periodicity of the crystal structure by designing a fully connected graph construction method, which ensures that the model is unaffected by the periodic boundary variations. At the same time, self-connected edges are used to encode periodic patterns, and a special message-passing scheme is proposed to effectively update the node characteristics to improve the accuracy of crystal material property prediction."}, {"title": "2.3 Knowledge Graph construction", "content": "A knowledge graph, as an efficient knowledge organization model, is represented as a semantic network consisting of nodes and edges, where nodes represent entities in the physical world and edges represent properties or relationships of entities. Knowledge graphs were first proposed to improve search. With the development of artificial"}, {"title": "3 Methodology", "content": "In this section, we propose a multi-feature fusion model architecture, ESNet, which integrates elemental properties and crystal structures through a cascaded approach to enhance the accuracy of material property prediction. The ESNet architecture primarily consists of three modules (e.g. Figure 1): an element KG encoder M(E), which captures the elemental property features $H_e \\in \\mathbb{R}^{d1}$, a crystal graph encoder M(G), which extracts the crystal structure features $H_g \\in \\mathbb{R}^{d2}$. After features extraction, a fusion encoder M(F), which generates the final joint representation $H_f = \\alpha H_e + \\beta H_g$\nfor predicting the target material properties. Next, we provide a detailed description of each component of the ESNet framework."}, {"title": "3.1 Element Knowledge Graph Encoder", "content": "Following the ideas of KANO and KCL, we use a similar strategy to construct a knowledge graph and extract elementary feature vectors from the encoded knowledge graph. In the process of implementation, we have made some targeted adjustments and changes. We focus only on the attribute features of the elements covered in the atlas, and further use these filtered attribute features as the features of the crystal structure atoms to achieve the effective enhancement of the features of the crystal structure atoms, thus making the whole chemical element knowledge map more relevant and practical under the new construction."}, {"title": "3.1.1 Element Knowledge Graph Construction", "content": "In our work, all chemical elements and attributes are obtained from the periodic table (https://ptable.com), each element contains at least 15 attributes(e.g. Figure 2). Ternary groups are then constructed based on the obtained elements and corresponding attributes to show the association between elements and attributes. However, for some continuous attributes, it is difficult to perform relationship extraction in the knowledge graph, so we adopt a method to discretise the continuous values, i.e. by dividing the continuous values into different intervals and converting them into discrete labels for effective management in the knowledge graph."}, {"title": "3.1.2 Element Knowledge Graph Embedding", "content": "During the in-depth study of chemical element knowledge graphs, in order to comprehensively and deeply explore all elemental entities, relationships and semantic information, we adopt a knowledge graph embedding approach based on OWL2VecChen et al. (2021), a semantic embedding framework specifically designed for the OWL ontology, which encodes the semantics of the ontology through the techniques of random walks on the ontology graph structure and word embedding. OWL2Vec uses Word2VecGrohe (2020) to train the model to obtain the embedding vectors, but unlike Word2Vec, which focuses on capturing the contextual semantic information of words, OWL2Vec focuses on the OWL ontology, aiming to capture the structural relationships as well as the logical connections of entities and attributes in the ontology, thereby generating low-dimensional vector representations that can be used for machine learning and statistical analysis tasks.\nIn this paper, an overview of the construction and embedding of chemical element knowledge graphs is shown in Figure 3. We collect basic element knowledge from the periodic table to generate triples, similar to (Density2, isDensityOf, Na). Considering the topological information, semantics and correspondence between entities in the knowledge graph, OWL2Vec converts the OWL ontology into an RDF graph, on which structural, lexical and combinatorial documents are derived, after which the three documents mentioned above are merged, and the merged documents are used to train the word embedding model, Word2Vec, which is finally used to compute the embedding vectors for each target entity.\nSince the distribution characteristics of elements in a crystal structure can reflect the physical and chemical properties of the crystal to a certain extent, we have adopted"}, {"title": "3.2 Crystal Graph Encoder", "content": "ESNet utilizes the crystal transformer iComFormer, which is based on Com-Former(Yan et al. (2024b)), as a graph encoder to capture the node and edge features of crystal graphs. The iComFormer employs SE(3)-invariant crystal graphs for representation learning of crystal structures. Each node i is embedded as an initial node feature $f^0_i$ using CGCNN (Xie and Grossman (2018b)). An edge is constructed between nodes j and i if the Euclidean distance $||e_{ji}||$, between them is less than a predefined cutoff radius. Each edge feature is initially mapped as $c/||e_{ji}||^2$. Then embedded as the initial edge feature $f^e_{ji}$ via an RBF kernel. Additionally, the three angles {$\\theta_{ji,ii1}$, $\\theta_{ji,ii2}$, $\\theta_{ji,iiz}$ } between $e_{ji}$ and the lattice representations {$l_{ii_1}$, $l_{ii_2}$, $l_{ii_z}$ } are mapped to {$f^{ang}_{ji_{1}}$, $f^{ang}_{ji_{2}}$, $f^{ang}_{ji_{3}}$}. The iComFormer pipeline is illustrated in Figure 4. In this model, the Node-Wise Transformer layer first passes message from a neighboring node j to the center node i using the node features $f^l_i$, $f^l_j$ and edge feature $f^l_{ji}$ where l indicates the layer number, and then aggregates all neighboring messages to update $f^{l+1}_i$. The Edge-Wise Transformer layer updates edge feature $f^{l+1}_{ji}$ using angle feature $f^{ang}_{ji_{1}}, f^{ang}_{ji_{2}}$\nand $f^{ang}_{ji_{3}}$, and edge features of lattice vectors $f^{latt}_{ii1}, f^{latt}_{ii2}$ and $f^{latt}_{ii3}$. The final graph feature $H_g$\nis obtained by aggregating the updated node and edge features after passing through the iComFormer.\nSpecifically, we redesigned the atomic encoding in the crystal graph, reducing the original 92-dimensional feature vector encoded by CGCNN(Xie and Grossman (2018b)) to 70 dimensions. The motivation behind this redesign is that during the graph construction of the crystal structure, we found that atomic numbers greater than 100 were incorrectly encoded. Additionally, the encoding of other atoms also showed some ambiguities. For example, for the hydrogen atom, the calculated Electronegativity"}, {"title": "3.3 Multi-feature Fusion Encoder", "content": "To effectively integrate feature information from different sources, we introduce a multi-feature fusion encoder composed of n Transformer layers. In the fusion encoder, we concatenate the elemental property features $H_e$ (Element Knowledge Graph Encoder output) and the geometric features of the crystal structure $H_g$ (Crystal Graph Encoder output) to create a joint representation:\n$H_f = \\alpha H_e + \\beta H_g$ (1)\nHere, \u03b1 and \u03b2 are weight coefficients used to adjust the contribution of each feature to the final representation across different downstream tasks."}, {"title": "4 Experiments", "content": "We evaluate the performance of ESNet on the widely-used Materials Project(Chen et al. (2019)) crystal materials benchmark dataset. Through experiments, our proposed ESNet demonstrates excellent performance in predicting material properties such as band gap and formation energy, validating the necessity of incorporating elemental attributes. We follow the experimental setting of ComFormer(Yan et al. (2024b)) and use Mean Absolute Error (MAE) as the evaluation metric. Benchmark methods include CGCNN(Xie and Grossman (2018b)), schNet(Sch\u00fctt et al. (2017)), MEGNET(Chen et al. (2019)), GATGNN(Louis et al. (2020)), ALIGNN(Choudhary K (2021)), Matformer(Yan et al. (2022a)), PotNet(Lin et al. (2023)), CrysMMNet(Das et al. (2023)), iComFormer(Yan et al. (2024b)). The the best experimental results highlighted in bold."}, {"title": "4.1 Experimental results", "content": "The Materials Project-2018.6.1 was first proposed and used by MEGNET(Chen et al. (2019)) collected from The Materials Project(Persson (2013)), but the methods are compared by using different random seeds and dataset sizes. To make a fair"}, {"title": "4.2 Ablation Study", "content": "In this section, we demonstrate the importance of the element knowledge graph encoder in the ESNet framework. Specifically, through ablation experiments, we attempt to directly embed elemental attributes into the crystal structure graph as initial node features. This approach allows us to use iComFormer for predictions without utilizing the element knowledge graph encoder.We conducted experiments on the band gap performance using the MP dataset, and the experimental results are shown in the table. Without using the encoder, the prediction result increased from 0.177 to 0.182."}, {"title": "5 Conclusion and Future Work", "content": "This study presents an innovative material property prediction method by integrating knowledge graph technology with machine learning models. The proposed ESNet framework combines an element knowledge graph encoder with a crystal structure encoder, and leverages a multimodal fusion encoder to capture the intrinsic complex relationships and properties of materials. Compared to existing methods, our model demonstrates a significant improvement in accuracy for predicting band gaps. The performance of our model proves that this approach can effectively enhance prediction accuracy.\nThe success of ESNet lies in its ability to simultaneously leverage structural and chemical information, thus overcoming the limitations of traditional data-driven models and addressing the lack of chemical prior knowledge. This hybrid approach not only enhances the interpretability of the predictions but also extends the applicability of the model, allowing it to provide effective predictions across a broader chemical space. Our ablation studies further validate the importance of the Element Knowledge Graph Encoder in the ESNet framework and reveal the negative impact on prediction accuracy when this component is absent.\nDespite the positive results of our study, several research directions warrant further exploration based on the current findings:\n\u2022 In the future, we plan to perform more extensive cross-validation on various datasets to assess the generalization ability and robustness of the ESNet model. This work will help us better understand how the model performs across different types of and unknown crystal structures.\n\u2022 Currently, the ESNet framework has not been fully tested for predicting shear modulus and bulk modulus. Moving forward, we will focus on predicting these properties, analyzing the key factors affecting their accuracy, improving feature extraction and fusion strategies, and adjusting the model architecture accordingly. Additionally, we plan to collect more samples with precise shear modulus and bulk modulus data to enhance the diversity of the training dataset, thereby improving the model's accuracy and reliability for these properties.\nIn summary, this study achieves an important breakthrough in the field of material property prediction, successfully integrating knowledge graphs with machine learning and building a promising and powerful tool for materials scientists and engineers."}]}