{"title": "Using Structural Similarity and Kolmogorov-Arnold Networks for Anatomical Embedding of 3-hinge Gyrus", "authors": ["Minheng Chen", "Chao Cao", "Tong Chen", "Yan Zhuang", "Jing Zhang", "Yanjun Lyu", "Xiaowei Yu", "Lu Zhang", "Tianming Liu", "Dajiang Zhu"], "abstract": "The 3-hinge gyrus (3HG) is a newly defined folding pattern, which is the conjunction of gyri coming from three directions in cortical folding. Many studies demonstrated that 3HGs can be reliable nodes when constructing brain networks or connectome since they simultaneously possess commonality and individuality across different individual brains and populations. However, 3HGs are identified and validated within individual spaces, making it difficult to directly serve as the brain network nodes due to the absence of cross-subject correspondence. The 3HG correspondences represent the intrinsic regulation of brain organizational architecture, traditional image-based registration methods tend to fail because individual anatomical properties need to be fully respected. To address this challenge, we propose a novel self-supervised framework for anatomical feature embedding of the 3HGs to build the correspondences among different brains. The core component of this framework is to construct a structural similarity-enhanced multi-hop feature encoding strategy based on the recently developed Kolmogorov-Arnold network (KAN) for anatomical feature embedding. Extensive experiments suggest that our approach can effectively establish robust cross-subject correspondences when no one-to-one mapping exists.", "sections": [{"title": "1 Introduction", "content": "The cortical folding patterns contain underlying mechanisms of brain organization. While the major cortical regions are largely consistent across individuals, the local shapes and patterns within these regions vary significantly, posing challenges for the quantitative and efficient characterization of cortical folding. Recently, a finer scale cortical folding pattern, known as the 3-hinge gyrus (3HG) [2,4], has been identified and defined as the junction where three gyri converge from different directions. Notably, the 3HG is evolutionarily conserved across multiple primate species and remains stable in the human brain [5,16], regardless of population differences or brain conditions. This cortical folding pattern exhibits strong consistency within species while varying among individuals, with unique features such as the thickest corteces [4], higher DTI-derived fibers density [3], and greater connectivity diversity across structural and functional domains compared with other gyral regions [18]. This suggests that 3HGs are more like hubs in the cortical-cortical connection network and play a vital role in the global structural and functional networks of humans [6]. And a recent study [8] revealed that a finer-scale brain connectome based on 3HG can better capture the intricate patterns of Alzheimer's Disease.\n3HG-based brain networks analysis shows great potential in advancing our understanding of human brain and brain diseases. However, 3HGs are identified in individual space and there is no natural cross-subject correspondences. Therefore, identifying cross-subject correspondences of 3HGs is a key step for constructing 3HG networks and conducting population-wide analysis [1,17,14]. However, this process is highly challenging due to substantial individual variability. In our previous work, cortex2vector [15], we introduced a learning-based embedding framework to encode individual cortical folding patterns as a series of anatomically meaningful embedding vectors. The similarities of the embedding vectors can effectively measure the correspondence between corresponding 3HGs. This method is capable of establishing anatomical correspondences across individuals, as well as between different brains at various stages of neurodevelopment [14]. However, the existing framework has several shortcomings: 1) the adopted multi-hop feature encoding strategy fails to fully capture the topological information of the folding patterns, as it only considers node proximity [12] without accounting for the structural similarity of the nodes themselves; 2) it remains uncertain whether the simple 4-layer multi-layer perceptron network can adequately learn the features sufficient to identify correspondences between different 3-hinge nodes with similar topological structures; 3) the sparsity of the topological feature network increases the likelihood that our framework may reconstruct insignificant zero elements within the features, thereby diminishing its representational capacity.\nIn this paper, to address the aforementioned limitations, we propose a self-supervised framework for anatomical feature embedding of the 3HG based on our initial study [15]. We introduce structural similarity between independent nodes to enhance the hierarchical multi-hop encoding strategy. To further improve the representation ability of the network while keeping it lightweight, we adopt Kolmogorov-Arnold Networks (KAN) [7], a recently proposed neural network inspired by the Kolmogorov-Arnold representation theorem, for anatomical feature encoding of 3HGs. In addition, we propose a new loss function \u2013 selective reconstruction loss, which penalizes reconstruction errors in non-zero elements, thereby enhancing the representational capacity of the embedding vector. Our experimental results show that the learned embeddings can accurately establish"}, {"title": "2 method", "content": null}, {"title": "2.1 Data acquisition and preprocessing", "content": "In this study, we use structural MRI (T1-weighted) of 1064 subjects from Human Connectome Project (HCP) S1200 release [11]. And we applied the same pre-processing procedures as [13] for T1 imaging data. In brief, the pre-processing steps involved brain skull removal, tissue segmentation, and cortical surface reconstruction using the FreeSurfer package. The Destrieux Atlas was then applied"}, {"title": "2.2 Hierarchical Multi-hop Encoding with Structural Similarity", "content": "Let G = (V, E) denote the undirected, unweighted graph (GyralNet) with the vertex set V and edges set E, where n = |V| denotes the number of nodes (3HGs) in the graph. According to [10], the structural similarity between two nodes is determined by comparing the topological structure of the nodes and their neighbors, i.e. the degree of the nodes and their neighbors. When only considering the local topological structure formed by a node and its directly connected neighbors, the feature representation is limited. To improve its expressive power, we adopt a hierarchical representation format to integrate the features and information of multi-hop neighboring nodes. The structural similarity enhanced hierarchical l-hop (l > 0) feature of i-th 3HG node can be expressed as:\n$X_i = \\begin{pmatrix}\n(S_0 \\cdot A_0 F)_i \\\\\n(S_1 \\cdot A_1 F)_i \\\\\n... \\\\\n(S_l \\cdot A_l F)_i\n\\end{pmatrix} \\in \\mathbb{R}^{(l+1) \\times 75}$ (1)\nwhere F\u2208 Rnx75 is the one-hot ROI label of each 3HGs obtained from Destrieux altas, Ak represents the k-hop adjacency matrix of GyralNet,  (\u00b7); denotes the i-row of the matrix and indicates the Hadamard product. Sk represents k-hop structural similarity, which is used to measure the similarity between two 3HGs, e.g., u and v:\n$S_k(u, v) = e^{-w_k(u,v)}$ (2)\n$w_k(u, v) = D(p(g_k(u)), p(g_k(v)))$ (3)\nwhere gk(u) is the k-hop neighborhood set of u, p(\u00b7) operator denotes generate a ordered degree sequence of a set of nodes and D(\u00b7) measures the similarity between these two ordered degree. Note that since the number of k-hop nodes for u and v may not be equal, thus directly calculating the Euclidean distance between sequences cannot accurately reflect their similarity. Instead, Dynamic Time Warping algorithm (DTW) [9], commonly used in time series analysis to find the optimal alignment between two sequences M and N, is employed to measure similarity between neighborhoods of two 3HGs. For each element a \u2208 M and b\u2208 N, the cost function we use for DTW in this work is shown in Eq. 4. For DTW, we construct a cumulative distance matrix C\u2208 R|M|\u00d7|N|, where C(i, j) represents the minimum cumulative distance to (i, j). The recursive process of C is shown in Eq. 5, where C(1,1) = d(1,1) and the minimal cumulative distance between the sequences A and B is given by C'(I, J). This minimum cumulative distance is used to represent the similarity between the two sequences.\n$d(a, b) = \\frac{\\text{max}(a, b)}{\\text{min}(a, b)} - 1 \\in [0, n - 1]$ (4)"}, {"title": null, "content": "C(i, j) = d(i, j) + min(C(i \u2013 1, j), C(i \u2013 1, j \u2212 1), C(i, j \u2212 1)) (5)"}, {"title": "2.3 Self-supervised Embedding Framework", "content": "As shown in Fig. 1, the self-supervised framework for anatomical feature embedding in the 3HG employs a two-stage encoding process that hierarchically maps structural-similarity-enhanced multi-hop features to a latent representation & and a two-stage decoding process, which hierarchically reconstructs the original input from this latent representation. Each encoding and decoding process is implemented by a KAN layer, and the self-supervised framework f is a combination of four layers using the projection operator 0:\n$X_i = f(X_i) = (P_{ROI} \\circ \\Phi_{MH} \\circ \\Phi_{MH} \\circ P_{ROI})X_i$ (6)\nwhere PROI is the first stage of encoding, which maps the one-hot ROI encoding into a low-dimensional embedding 0, while \u0424MH fuses multi-hop embeddings into a single embedding vector yi. The decoding process is symmetrical with the encoding process, and consists of two steps: multi-hop feature recovery \u0424\u043c\u043d and ROI feature recovery PROI\nLoss function. In cortex2vec [15], we directly use Mean Square Error (MSE) as the objective function for self-supervised training process:\n$L_{mse} = ||X_i - \\hat{X}_i||_2 + ||\\Theta_i \u2013 \\hat{\\Theta}_i||_2$ (7)\nHowever, as discussed in [12], due to the sparsity of GyralNet structure, using MSE as the loss function would make it easier to reconstruct the zero elements in matrix, which is not our intention. Therefore, we need to increase the penalty for reconstruction errors on the non-zero elements within the loss function.\n$L = || (X_i - \\hat{X}_i) \\odot (1_x + \\lambda X_i)||_2 + ||(\\Theta_i \u2013 \\hat{\\Theta}_i) \\odot (1_\\Theta + \\lambda \\Theta_i) ||_2$ (8)\nThe revised loss function named as the selective reconstruction loss is shown in Eq. 8, where 1x and 10 are matrices with all elements equal to 1 and Ais a hyperparameter."}, {"title": "3 Experiments", "content": null}, {"title": "3.1 Experiment Settings", "content": "Dataset. Using GyralNet [2], 338,555 3HG points are identified from 1064 subjects in the HCP dataset. Following the settings in [15], we randomly selected 864 individuals for training, 78 individuals for validation, and 122 individuals for testing. Each 3HG is treated as a data sample. For the structural similarity enhanced multi-hop features Xi, we generated 1-hop features (l = 1 in Eq. 1), 2-hop features (l = 2) and 3-hop features (l = 3). For each type of feature, we trained the model to learn the corresponding ROI embeddings."}, {"title": "3.2 Results", "content": "As shown in Fig. 2, we calculated the Pearson correlation coefficient (PCC) between the learned parameters PROI for each individual ROI embedding and listed the Top-5 with the strongest connectivity. Compared with the results reported in [15], the strength of the gyrus-sulcus connection in our method is relatively high, which is mainly because the structural similarity enhanced multi-hop features are more sensitive to the connections at the peripheral areas of GyralNet,"}, {"title": "4 Conclusion", "content": "In this paper, we propose a self-supervised auto-encoding framework to embed a finer-scale brain folding pattern - the 3HG. The framework leverages structural similarity enhanced-multi-hop features to capture the topological information of anatomical folding patterns and introduces selective reconstruction loss to recover detailed features. Additionally, KAN is employed to improve representation learning capability of the framework. Extensive experimental results demonstrate that our framework can effectively identify cross-subject correspondences of the 3HGs. Future work will focus on incorporating additional features from other modalities to enhance cross-subject correspondences and assign adaptive weights to the encoded features during multi-hop feature encoding."}]}