{"title": "Synergistic Development of Perovskite\nMemristors and Algorithms for Robust\nAnalog Computing", "authors": ["Nanyang Ye", "Qiao Sun", "Yifei Wang", "Liujia Yang", "Jundong Zhou", "Lei Wang", "Guang-Zhong Yang", "Xinbing Wang", "Chenghu Zhou", "Huaqiang Wu", "Qinying Gu"], "abstract": "Analog computing using non-volatile memristors has emerged as a promising\nsolution for energy-efficient deep learning. New materials, like perovskites-\nbased memristors are recently attractive due to their cost-effectiveness, energy\nefficiency and flexibility. Yet, challenges in material diversity and immature fab-\nrications require extensive experimentation for device development. Moreover,\nsignificant non-idealities in these memristors often impede them for computing.\nHere, we propose a synergistic methodology to concurrently optimize perovskite\nmemristor fabrication and develop robust analog DNNs that effectively address\nthe inherent non-idealities of these memristors. Employing Bayesian optimiza-\ntion (BO) with a focus on usability, we efficiently identify optimal materials", "sections": [{"title": "Introduction", "content": "The emerging field of artificial intelligence (AI), with applications like autonomous\ndriving, policy optimization, and complex large vision language models\n(LVLMs), demands high-bandwidth data transfer and substantial computational\nresources, challenging the capacity of traditional computing systems. The separation\nof memory and processor in current digital computers, known as the von Neumann\narchitecture, creates a \u201cmemory wall\" bottleneck. In-memory computing, lever-\naging nonvolatile resistive random-access memory (memristor or ReRAM), presents\nan effective solution by enabling direct computation within memory arrays, thus\neliminating the energy-intensive and time-consuming data movement of traditional\nsetups. Employing this method, memristive crossbar arrays compute vector-\nmatrix products\u2014a cornerstone operation in deep neural networks (DNNs)\u2014by\nencoding matrix values into memristor conductances and vector values into applied\nvoltages. The computational outputs are efficiently derived from the currents,\nin accordance with Ohm's law and Kirchhoff's current law , leading to analog\nin-memory computing characterized by significantly enhanced speed and energy\nefficiency.\nMemristors, stemming from the fusion of \u201cmemory\u201d and \u201cresistor\", are two-\nterminal passive devices capable of precise resistance modulation through electrical\nstimulation. They have been considered as critical components for neuromorphic\ncomputation due to their advantages of high-density integration in a cross-point array,\nmulti-level memory, and good scalability. Memristors typically consist of\na three-layered structure, with a switching layer sandwiched between two metallic\nelectrodes. While this layer has primarily been constructed from inorganic materi-\nals like metal oxides, amorphous silicon, and chalcogenides,\nthere has been a recent surge of interest in employing organic-inorganic hybrid per-\novskites (OHPs) for neuromorphic devices. OHPs are notable for their mixed\nionic-electronic conduction, enabling low-energy halide counterion movement under\nelectric fields, making them ideal for energy-efficient neuromorphic computing that"}, {"title": null, "content": "mimics synaptic functions. Additionally, in contrast to inorganic memristors,\nOHPs offer cost benefits, superior optical and charge-transport characteristics, and\nmechanical flexibility, positioning perovskite memristors as a promising option for\nfuture neuromorphic computing advancements.\nAlthough memristors share remarkable similarities with biological components\nlike synapses and neurons in both their physical mechanisms and functional behav-\nior, it is imperative to understand that these resemblances do not inherently ensure\nefficient computation. This is primarily because contemporary state-of-the-art\nDNNs rely on digitalized values for connection weights. In contrast, representing\nthese weights using analog memristive conductance encounters challenges character-\nized by non-ideal behaviors, including nonlinear conductance responses, stochastic\nconductance changes, device-to-device variability, programming errors, etc. DNNs built on memristors (denoted as analog DNNs) are particularly susceptible\nto these non-idealities due to the absence of a potential gap between high and low\nvoltages for noise resistance. Consequently, the parameters of analog DNNs,\nrepresented by the conductances, can be easily distorted, potentially compromising\nthe effectiveness of analog deep-learning systems. Many dedicated efforts have been\nmade to address this issue, with device-algorithm co-design emerging as a promising\nstrategy for achieving efficient analog computing.\nWhile extensive co-optimization has been explored in mature inorganic mem-\nristors, research on perovskite counterparts remains limited. Unlike inorganic\nelectronics, which benefit from established manufacturing processes and seamless\nintegration with existing semiconductor technologies, perovskite memristors entail\ndiverse material options and various fabrication methods, presenting challenges in\ndeveloping optimal devices and integrating suitable DNNs. Furthermore,\nthese memristors often suffer from substantial non-idealities arising from imma-\nture fabrication processes, limited material durability, and environmental sensitivity,\nhindering efficient DNN implementations and impeding their application in analog\ncomputing. Most efforts have concentrated on hardware modifications, such as mate-\nrial engineering and fabrication optimization, to address non-idealities.\nHowever, this approach is labor-intensive and time-consuming. It is worth noting that\nthe mismatch between devices and algorithms can also be addressed from an algorith-\nmic perspective. This involves either mitigating device non-idealities or leveraging\nunexpected properties as valuable features for novel computing paradigms, an area\nthat has received relatively less attention."}, {"title": "Results", "content": "DNNs that are adaptable to complex computational tasks. We introduce the concept\nof \"usability\u201d, derived from basic current-voltage (I-V) characteristics of perovskite\nmemristors, to evaluate their suitability for analog computing under specific fabri-\ncation conditions. Leveraging Bayesian optimization (BO) with \u201cusability\" as the\ntarget, we efficiently identify optimal material selection and fabrication conditions\nwithin a vast search space, significantly reducing time consumption compared to\nhuman-driven approaches. Concurrently, we develop a noise injection approach,\nnamed \"BayesMulti\", also guided by BO to optimize the characteristic of the\ninjected noises with multinomial distributions, thereby enhancing the robustness of\nanalog DNNs built upon these memristors. We further provide theoretical proof\nthat BayesMulti ensures consistent prediction outcomes within a specified parame-\nter perturbation range due to memristor non-idealities. Our algorithmic framework\noutperforms state-of-the-art methods across various tasks, from object detection to\nLVLMs, and various hardware non-idealities. With optimized device and algorithms\nin hand, we further conducted a classification task in a 10\u00d710 perovskite memristor\ncrossbar, achieving high accuracy and reduced performance decline compared to dig-\nital DNNs. This underscores the fault-tolerant, noise-robust, and generalizable nature\nof our analog neural networks to complex models and tasks."}, {"title": "Bayesian Fabrication Optimization for Perovskite Memristors", "content": "The perovskite nanowire (NW)-based memristor structure is depicted in Figure la.\nLead halide perovskites (APbX3; A=methylammonium, formamidinium, cesium;\nX=I, Br, Cl) are grown inside nanoengineered porous alumina membrane (PAM)\npores through a bottom-up chemical vapor-solid-solid reaction (VSSR), resulting in\nthree-dimensionally integrated perovskite NWs (Figure 1b). As shown in Figure 1c\nof the cross-sectional SEM image, these NWs are embedded within the PAM, serving\nas the switching layer and positioned between the active electrode (Ag) and counter\nelectrode (Al or Au). Figure 1d displays a typical I-V characteristic of a perovskite\nNW-based memristor. A DC voltage sweep from 0 \u2192 + 6 V \u21920V \u2192 -6 V \u2192 0\nV was applied with compliance current of 2 \u00d7 10-5 A to prevent breakdown. The\ndevice demonstrated distinct SET and RESET events at threshold switching volt-\nages of 3 V and -2.2 V respectively. The resistive switching behavior arises from\nthe electrochemical metallization (ECM) of Ag, leading to the formation of inhomo-\ngeneous filaments. The fundamental structure and switching mechanism have been\npreviously reported. These works have also presented that perovskite NW-\nbased memristors can achieve multilevel resistance states and excellent data fidelity.\nAdditionally, the unique NW array structure, coupled with lateral passivation of the\nPAM, has improved both material and electrical stability in the devices, leading to\nenhanced cycle endurance and retention capability. Figure 1f presents a 10\u00d710\nmemristor crossbar fabricated from the perovskite NW array. The scalability and ease\nof fabrication of these devices underscore their potential for significant applications\nin data storage and neuromorphic computing."}, {"title": null, "content": "The switching performance of perovskite NW-based memristors can be influ-\nenced by various factors, including perovskite types, PAM morphology, electrodes,\netc. While previous research focused on understanding memristor mechanisms,\nachieving minimal non-idealities is crucial for neuromorphic computing applica-\ntions in this work. However, this optimization is multidimensional, making manual\nevaluation impractical due to resource constraints. Therefore, we employ Bayesian\noptimization (BO), an effective method for optimizing expensive functions, which\nhas demonstrated superiority over other approaches, to tackle this issue. BO\nefficiently balances uncertainty exploration and information exploitation, to high-\nquality configurations with fewer evaluations. Notably, BO is versatile and applicable\nto diverse search spaces.\nTo establish an efficient and precise BO framework, we have to first define the\nsearch space and optimization objectives. Based on prior research and our expertise,\nwe have identified five influential factors as variables for memristor optimization: (1)\nperovskite types, (2) NW length, (3) NW diameter, (4) lead electrodeposition (Pb\nED) time, and (5) Ag thickness. These collectively constitute the final search space,\nencompassing 8400 possible experimental configurations. Additional information on\nsearch space selection is available in Supplementary Note 2. The optimization target\nis to assess a typical perovskite memristor's suitability for analog computing. Hence,\nour primary aim is to determine how to quantify this \u201csuitability\".\nConsidering an analog DNN as a series of nonlinear functions, the goal is to min-\nimize the loss \\(l (f_{\\theta} (x), y)\\) for input data \\(x \\in \\mathbb{R}^d\\) and its corresponding label y, where\nl represents the loss function and \\(f_{\\theta}\\) is the neural network parameterized by weights\n\u03b8. Device imperfections, such as conductance instability, variations across cycles/de-\nvices, and programming errors, can cause weight parameters \u03b8 to drift, affecting the\nDNN's robustness and accuracy. Therefore, assessing these non-idealities based on\nmemristor characteristics is vital in determining a memristor's aptness for analog\ncomputing. We categorize these non-idealities into two types: non-monotonic non-\nideality and stochastic non-ideality.\nNon-monotonic Non-ideality Ideally, the conductance of a memristor would exhibit\na proportional relationship with input electric charge, allowing for straightforward\nconductance control through charge modulation without the requirement for complex\ncircuitry. However, in practice, even with a forward charge, the conductance may not\nexhibit a strictly ascending trend. This therefore induces non-monotonic non-ideality\nto the neural network parameters.\nStochastic Non-ideality In practice, variations in conductance between measure-\nments are inevitable due to environmental disturbances and inherent non-idealities,\nsuch as cycle and device variations, and thermal and electrical noises within the\ndevice. This introduces stochastic non-ideality to the neural network.\nTo emulate the two types of non-idealities, we conducted simulations based on\na memristor's electrical characteristics, as detailed in the Methods section. This\napproach offers a straightforward and fundamental means of assessing the perfor-\nmance of a typical device, making it widely applicable across different material\nsystems and accessible to researchers lacking advanced experimental facilities. Based\""}, {"title": null, "content": "on the simulations, we introduce the concept of \u201cusability\u201d to assess a typical mem-\nristor's suitability for analog computing. \u201cUsability\u201d is employed as the optimization\nobjective for the subsequent BO process, serving as an indicator for the prosper-\nity of a specific perovskite manufacturing design. Additionally, by extracting device\nnon-idealities, we developed PerovskiteMemSim, detailed in Supplementary Note\n4, for further evaluation of analog computing systems, including both devices and\nalgorithms, across various applications."}, {"title": "Bayesian Fabrication Optimization Process", "content": "For a given search space, Bayesian optimization begins by gathering initial out-\ncome data from experiments or existing literature. These data are then used to train\na probabilistic surrogate model, which is constructed by combining previous obser-\nvations with prior functions that allow for inference of globally optimal locations.\nAfter training the surrogate model, new experiments in the search space are selected\nsequentially by optimizing an acquisition function that maximizes the observed\nmetric scores of candidate experiments for the next evaluation. Subsequently, the\nproposed experiments are conducted, their results are added to the record, and the\nposterior of the surrogate model is updated. This process of surrogate modeling and\nacquisition function maximization iterates, as shown in Figure le, effectively guiding\nnavigation through the search space and ultimately leading to convergence towards\noptimal or near-optimal configurations."}, {"title": null, "content": "Having established the BO architecture, our focus shifts to optimizing its per-\nformance through critical algorithmic component designs. These include encoding\nmethods, surrogate model types, and acquisition function selections, which play a\npivotal role in maximizing usability in optimization. The aim of BO in this study\nis to optimize the usability of memristors across a combinatorial set of thousands of\npossible fabrication and characterization conditions. We employ numerical encoders\nto convert text variables (e.g., material selections) into structured representations for\nprocessing by BO. The surrogate model's primary requirement is to make predictions\nand estimate variance. Inspired by prior successful applications in Bayesian reac-\ntion optimization, we opt for the Gaussian Process (GP) as the surrogate model.\nThe GP model is characterized by the mean function and the covariance function,\nwhich guide the acquisition function derivation. Once the surrogate model is trained,\nnew experiments in the search space are selected sequentially through acquisition\nfunction optimization. To strike a balance between exploration and exploitation, we\nemploy Expected Improvement (EI) as the acquisition function. Maximizing EI leads\nto the selection of candidate configurations expected to outperform the current best\nresults significantly. The selected experiment is then conducted, and its correspond-\ning usability is calculated and integrated into the BO process to update the surrogate\nmodel's posterior. This process continues iteratively until usability is maximized,\nresources are depleted, or further improvements are improbable. Further details on\nthe BO process for memristor fabrication optimization are outlined in Supplementary\nNote 2.\nIn our study, we commenced the BO process with an initial experiment guided by\nprior research findings and the capabilities of our laboratory. This initial setup, featur-\ning methylammonium lead tribromide (MAPbBr3) as the perovskite-type, 1 \u00b5m NW\nlength, 250 nm NW diameter, a 10-minute lead electrodeposition (Pb ED) period,\nand an Ag thickness of 100 nm, achieved a usability score of 0.36. We numerically\nencoded the perovskite type, a discrete variable, and treated others as continuous vari-\nab"}]}