{"title": "Web Phishing Net (WPN): A scalable machine learning approach for real-time phishing campaign detection", "authors": ["Muhammad Fahad Zia", "Sri Harish Kalidass"], "abstract": "Phishing is the most prevalent type of cyber-attack today and is recognized as the leading source of data breaches with significant consequences for both individuals and corporations. Web-based phishing attacks are the most frequent with vectors such as social media posts and emails containing links to phishing URLs that once clicked on render host systems vulnerable to more sinister attacks. Research efforts to detect phishing URLs have involved the use of supervised learning techniques that use large amounts of data to train models and have high computational requirements. They also involve analysis of features derived from vectors including email contents thus affecting user privacy. Additionally, they suffer from a lack of resilience against evolution of threats especially with the advent of generative AI techniques to bypass these systems as with AI-generated phishing URLs. Unsupervised methods such as clustering techniques have also been used in phishing detection in the past, however, they are at times unscalable due to the use of pair-wise comparisons. They also lack high detection rates while detecting phishing campaigns. In this paper, we propose an unsupervised learning approach that is not only fast but scalable, as it does not involve pair-wise comparisons. It is able to detect entire campaigns at a time with a high detection rate while preserving user privacy; this includes the recent surge of campaigns with targeted phishing URLs generated by malicious entities using generative AI techniques.", "sections": [{"title": "I. INTRODUCTION", "content": "Phishing is a type of cyber-attack in which the attacker mimics a legitimate website to extract sensitive information from victims; information such usernames, emails, passwords and details of bank or credit cards. It is the most common form of cyber-crime, with an estimated 3.4 billion instances of attack every day [1]. Over 48% of emails sent in 2022 were classified as spam with an average cost of a resulting data breach against organisations being \u00a34 million [1]. The phishing vectors were initially web-based communications such as emails, however, there has been a change in the trend where texts, phone call and social media applications are being used as well. Nevertheless, web-based phishing remains the biggest threat in the cyber-crime domain.\nSince phishing became popular in the late 2000s, there have been different techniques and methods evolved. Email phishing, spear phishing and whaling accounted for most of the phishing attacks. The key difference between these types of attacks is that email phishing scammers try to trick users into giving away personal information, whereas in spear phishing, scammers use specific information about users to make the attack seem more legitimate and trick them into an action leading to data breaches. Whaling is a also a targeted attack, however it involves high-ranking individuals as victims CEOs or directors of corporations with access to company's sensitive information. Business email compromise [2] and social media phishing [3] have specifically increased over the last several years. The former type of phishing targets businesses; scammers impersonate executives or employees in emails, aiming to defraud the company or its partners. The latter involves fraudsters who create fake profiles on social media or imitate seemingly legitimate posts to trick users into giving away personal information.\nMajority of all of these phishing attacks attempt to take victims to a website through phishing URLs via emails where they are tricked into giving away sensitive information. Surprisingly, only 9% of all phishing emails are attempting to infect the victim with malware [4].\nMost of these web-based phishing attempts have a de- tectable pattern such as a mismatch in the sender's email address and domain name, grammatical errors and an unusual sense of urgency or time limit. Email security solutions are designed to detect these patterns; text analysis is used to read the email header and the email itself to identify poor grammar and patterns commonly associated with phishing attacks. These patterns include use of suspicious keywords, phrases, or links that may be indicators of a phishing attempt. To detect these, top phishing detectors widely used around the globe thus employ (in addition to header filters and blacklist filters) content filtering algorithms that analyse email content to identify keywords or patterns associated with phishing emails. However, these phishing detectors breach user privacy as they sift through sensitive and private email content to"}, {"title": "II. RELATED WORK", "content": "Phishing detection systems generally employ a number of common techniques in combination to enable reliable protection against the attacks; this includes URL scanning, email content scanning, network metadata analysis (DNS blacklisting), rule-based methods and more recently AI-based phishing detection tools which use large amounts of data to train machine learning (ML) models to extract features from email contents, web-site characteristics, user interac- tions and other associated metadata [7]. Broadly categorizing these systems, there are primarily two types - traditional and non-traditional methods. The traditional methods primarily incorporate legal protection, user education and awareness, blacklist/whitelist, visual similarity, and search engines. The non-traditional methods fundamentally include content-based, heuristics-based, AI, fuzzy logic, rule-based and data mining methods. The proposed work falls under the latter category of AI-enabled phishing detection systems.\nIn the latest research involving the aforementioned category, there has been greater focus on supervised learning based machine learning techniques. A phishing URL classification using recurrent neural networks is proposed by [8], where an LSTM model is trained on 2 million URLs containing legitimate and phishing URLs and each character of a URL input is translated to 128-dimensional embedding for training the model. This model trained on URLs was bench-marked against a random forest model trained on lexical and statistical features associated with URLs and although the Random Forest model yielded an overall accuracy of 94%, the LSTM outperformed it by using just one feature, the URL string,\nyielding 99% overall accuracy. This highlights the importance of analysing URL text in phishing detection.\nThe Deep Neural Network-based approach taken by [9] is another method where a large dataset consisting of malicious and benign URLs was used; in this case, to train 3 different types of Convolutional Neural Networks (CNNs). The first CNN model utilises character-level URL embeddings, the sec- ond model uses word-level embedding of the same URL and the third (and most effective) model used a hybrid approach where the embeddings used for training the CNN model uses word and character-level embeddings together.\nThe supervised learning approach has proven quite effective for detecting traditional phishing URLs, however, supervised machine learning are not generalizable in the face of the ever- evolving phishing URLs especially with the need for large amounts of labelled data and feature engineering processes, which are prone to human error [10]. Additionally, classical machine learning techniques still suffer from a lack of ef- ficiency in detecting zero-day phishing attacks [11]. Conse- quently, supervised machine learning methods fail to detect unknown or newly evolved phishing attacks. Deep learning algorithms such as CNNs can detect zero-day attacks more efficiently [12]. However, although these approaches are still dependent on large amounts of historical labelled data for training, and are thus not as effective against the evolving techniques of attack and not resilient to generative AI-based techniques. Prior to [13], most of the phishing URL detection research was focused on supervised classification techniques, and there is very limited work done on adapting clustering for efficient phishing URL detection.\nThe work published in [13] emphasises on the importance of using unsupervised methods such as clustering, in contrast to previously cited works which employ supervised algorithms requiring computation resources and large amounts of data to train models. It explores clustering methods such as K-Means and DBSCAN for detecting phishing URLs. The workflow starts with the browser analytics segment which monitors the user's activity and any domain searched is matched with white and blacklists. If there is a match with blacklist the domain is blocked and vice-versa. If there are no matches, then certain features from the website are derived, such as website protocol, IP address subdomains, the amount of web traffic and Google Page-rank index etc. Based on the extracted features clustering is carried out using K-Means clustering algorithm to output two clusters (benign and malicious). Unlike the above supervised methods, here the analysis for classifying a URL is done by analysing the external features in addition to the URL itself. A shortcoming of these particular unsupervised approaches is their high computation requirements as data volumes increase and thus lack of scalability in addition to lack of accuracy with high-dimensional data such as text [14].\nThere is a need for further research into evolving web- based phishing detection approaches; more specifically into the unsupervised clustering techniques that hold the potential for detection of evolved threats (without the need for historical training data). The proposed method in this paper aims to fill"}, {"title": "III. WEB PHISHING NET (WPN)", "content": "WPN is an unsupervised phishing detection system that uses an efficient 3-stage pipeline with unsupervised hash- based clustering of data to detect and classify entire campaigns containing URLs associated with phishing.\nThe system leverages the key property of phishing URLs in that they tend to mimic known legitimate domains to entrap victims. This allows the system to detecting phishing URLs by clustering new observations of URLs together with both known legitimate domains as well as known phishing domains/URLs. If a new observation is clustered with either known legitimate domain or a known phishing URLs, due to its similarity to them, it is classified as a phishing URL and following verification fed back into the pool of known phishing URLs to ensure the system uses the feedback loop to improve overtime.\nThe flowchart in Fig. 1 illustrates this approach. It comprises of the 3 stages: pre-processing, hash-based clustering, and dual metric refinement.\nInput data, comprising unlabelled domains, known legit- imate domains and known phishing URLs, pass through the first pre-processing phase; this cleans up the strings in preparation for clustering which requires tokenized inputs as numerical embedding vectors. The second clustering phase then uses a hashing-based clustering algorithm to efficiently bin or cluster similar domains/URLs together; this clusters the unlabelled URLs that are to be detected with known legitimate domains and known phishing URLs, allowing the system to detect entire phishing campaigns without the need for pair- wise comparisons. Unlabelled inputs that are part of clusters with known legitimate domains or known phishing URLs based on their similarity to them are thus marked as phishing URLs. The final phase then post-processes the clusters to ensure false positives are removed by using a combination of similarity measures and thresholding to remove non-phishing URLs from the final result set. Below are the details of the 3 stages in detail."}, {"title": "A. Pre-processing", "content": "The pre-processing step takes URLs strings as input, and outputs vector representations that capture the lexical features of these URLs. The procedure is illustrated in Fig. 2 and involves three steps. The first is removing the top-level domain (TLD); this is done to be able to capture the similarity between domains, regardless of the difference in their TLDs.\nAdditionally, given that TLDs are a finite set, it is not useful to boost the detected similarity between domains/URLs simply because their TLDs match. Once TLDs have been removed, the next step is to break up the string into individual tokens (words); this is the tokenization process. All tokens extracted from the input dataset are collected together into a set to form a \"vocabulary\". Each input string can thus be represented as a vector with dimension equal to the size of the vocabulary, where all tokens present in the URL have a non-zero entry in the vector. This numerical representation in the form of vectors is then passed to the following step."}, {"title": "B. Hash-based Clustering", "content": "This step essentially groups a set of items such that items in the same cluster (group) are more similar to each other than to items in another cluster. Through this step, we cluster input (unlabelled) URLs with known legitimate URLs and known phishing ones, such that items that are grouped together in the same cluster are similar enough for the input URLs in the cluster to be classified as phishing. This similarity is generally calculated using on the vector representations from the pre- processing step using geometrical measures such as Euclidean distance or cosine similarity.\nThere are several clustering algorithms that can be deployed to achieve this purpose. A popular clustering algorithm, K- means [15], is designed to group items in one of k (k>1) clusters based on the proximity of the items to k centroids (or anchor points). K-means algorithm is not selected for our approach we aim for URLs/domains to be put in the same cluster only if they are highly similar i.e., similarity between the domains is above a threshold at which they can be judged as being similar enough to be likely part of the same campaign. This is opposed to the K-Means algorithm whether clustering is done based on a pre-decided number of clusters. In our application of phishing, we are not able to determine the number of clusters, k, in advance. Additionally, unlike in K- Means, if no subset of domains is similar enough, we want no clusters to be returned by the algorithm. In a real-world setting, we expect only a small subset of URLs out of all the scanned inputs to be above the similarity threshold (and thus be potentially phishing URLs); most input URLs will therefore not belong in any cluster.\nDBSCAN [16], another popular clustering algorithm, iden- tifies clusters based on the notion that a cluster in feature space is a contiguous region of high item density. For our application, as mentioned previously high density of URLs per clusters is not a requirement; rather in detecting phish- ing URLs, highly similar items inside clusters is a stronger objective.\nBIRCH is a scalable hierarchical option in clustering algo- rithms; however it is limited by its operation in the Euclidean space and lack of complexity in cluster shapes. Hierarchical Agglomerative Clustering (HAC), another popular hierarchical clustering technique, starts off by treating each item as belong- ing to its own individual cluster and proceeds to merge most similar pairs of clusters, until all clusters have been merged into one or until a similarity threshold has been reached. The approach of HAC is quite suitable for this application as it only forms clusters from smaller clusters whose similarity is above a threshold, however, the exhaustive pairwise similarity computation between all domains makes HAC very slow and computationally expensive for our application.\nWe therefore adopt a clustering approach based on Locality Sensitive Hashing (LSH) [17]. LSH is an algorithm for as- signing items into buckets using a hashing function, such that highly similar items have a high probability of being assigned to the same bucket. In other words, LSH assigns similar items to the same bucket and dissimilar items to different buckets. Although LSH was not traditionally designed for clustering, and is widely used in approximate nearest neighbour search, the buckets of similar items generated by LSH are essentially clusters of similar items. Additionally, the efficiency of this approach makes it suitable for our application as it is de- signed to scale to larger datasets especially those with high dimensionality [14], as is the case with text-based inputs in our phishing scenario.\nWe adopt one particular variant of LSH [18] in the proposed WPN system. Given N items (URLs) to cluster with LSH, where each item is a vector in d dimensional space, we create k random d dimensional vectors called projection vectors. The value of the parameter k needs to be chosen and controls the"}, {"title": "C. Dual Metric Refinement", "content": "Once all URLs have been clustered, we apply a set of rules to refine the clusters to produce the final set of detections. Recall that the goal of this application is to find clusters of URLs that are highly similar to known legitimate domains or known phishing URLs (for them to be classified as phishing). Therefore, the following refinement steps are designed to ensure the output meets this goal.\nFirstly, we ensure each cluster that is shortlisted contains input phishing URLs mixed with either known legitimate domains or known phishing URLs. Clusters that contain either only known domains/URLs or only the new input URLs are inconclusive and thus dropped from the final output as they cannot be deemed as phishing URLs with sufficient evidence. We then ensure all input URLs in a cluster have very high similarity to the known legitimate domains or known phishing URLs in their cluster. The previous LSH step puts similar URLs in the same cluster, however there is no strict similarity threshold imposed. At this stage, we have a chance to apply more fine-grained similarity metrics. More computationally expensive metrics are possible at this stage because the number of domains under consideration would have dropped significantly after clustering and shortlisting of clusters. Also, only URLs/domains within the same cluster are compared, thus significantly reducing the number of pair- wise comparison required. We consider two metrics (dual metric), Levenstein distance [19] and Dice distance [20] to"}, {"title": "IV. EVALUATION", "content": "To evaluate our approach, we conducted a series of ex- periments to compare each property of WPN against other popular phishing URL detection methods. As mentioned in section II, phishing detection has seen a shift towards unsuper- vised detection due to its specific advantages over supervised methods which are limited by data availability and lack of generalization to evolving attacks. For the scope of this paper, therefore, we evaluated WPN against popular unsupervised detection techniques such as those discussed in [13] which proved more favourable in phishing URL detection compared to supervised methods."}, {"title": "A. PhishStorm Dataset", "content": "For the first experiment, the dataset used for evaluation is the popular PhishStorm data [21] which combines a malicious URL list from PhishTank and a benign URLs list sourced from the Open Directory Project - DMOZ. The approach to curate the data leverages search engine query data in order to extract 12 features from URLs characterizing its intra relatedness and its popularity. The aim was to introduce a URL rating system, PhishStorm, to dynamically compute a risk score for URLs to classify them as phishing or legitimate.\nFrom the PhishStorm dataset, we extract a \"blacklist\" of 1000 URLs to be labelled as phishing URLs. We use only URL strings without lexical features of contents/URLs to test our privacy-preserving approach against other clustering methods. We then combine this blacklist with a \u201cwhitelist\" of legitimate domains/URLs from the popular most visited sites by Amazon Alexa. This combined dataset of 2000 URLs is then used to\""}, {"title": "B. Detection Rate", "content": "In the first experiment, we run our approach on the afore- mentioned dataset and compare to popular clustering methods which were initially considered for this system as explained in Section 3 - K-Means, Hierarchical Agglomerative Clustering (HAC) and BIRCH. The results are calculated after from all output clusters except for those containing only white list or only black list URLs as these are inconclusive clusters; clusters containing blacklist URLs with whitelist URLs show that the blacklist URLs are sufficiently similar to the whitelist URLs to claim that they are phishing URLs. The final results are captured as a percentage of phishing domains from our initial blacklist that are captured in the result set by the three algorithms. These are presented in Fig. 4.\nEven though K-Means and HAC are able to capture more than 80% of phishing URLs, the proposed system outperforms both the other unsupervised techniques including K-Means and HAC methods with a 93% detection rate. We also compare the computation time of these algorithms against WPN and as expected, the proposed system outperforms both other methods in time to process the data and arrive at detection decision; the results are captured in Fig. 5 are collected after running the three algorithms on a local machine with Intel i5 chip (8 CPUs) and 16GB RAM."}, {"title": "C. Campaign Detection", "content": "Due to the way data is processed in WPN without pair-wise comparisons, as explained in section 3, the system outputs a set of clusters that enables detection of entire campaign at a time. A sample output of WPN from the previous PhishStorm evaluation is shown in Table II, highlighting a campaign targeting the popular video game distribution service Steam. The phishing URLs are detected together using the hash-based binning of inputs and grouped together in the same cluster."}, {"title": "D. Resilience to AI-based Phishing", "content": "Lastly, we tested the WPN system on its ability to deal with evolved phishing attempts using AI-generated phishing domains/URLs. A dataset was constructed using a GPT -3 based open-source large language model (LLM). The GPT-3 is a generative transformer-based LLM trained on 175 billion parameters [22]. The model was prompted to produce 714 phishing URLs mimicking multiple organizations that are common targets for phishing attempts including those in the banking, retail and health sectors. The results from the model formed the blacklist in this experiment and was combined with 800 whitelist URLs to form the evaluation dataset shown in Table III. The results are outlined in Table IV below.\nUnsupervised techniques are generally better able to deal with evolution of threat as they do not depend on learned signatures from historical data as in the case of supervised methods. This is reflective in the results with all three ap- proaches being able to capture a vast majority of these unseen phishing URLs. WPN, however, outperforms both K-Means and HAC with a 97.9% of phishing URLs detected. This"}, {"title": "V. CONCLUSION", "content": "In this paper, we presented a proactive and scalable ap- proach to phishing detection using hash-based clustering that can accurately detect phishing URLs in a privacy-preserving manner with resilience to evolved phishing techniques such as AI-generated domains.\nThe approach, WPN, addresses the gaps in current detection systems which have significant historical data requirements for training, as in supervised approaches, or high computational requirements affecting system scalability; requirements such as those resulting from the use of pair-wise comparisons in some unsupervised methods. WPN uses URL strings to detect phishing without the need for additional data such as traffic on these URLs; this enables it to detect URLs proactively as soon as they are registered.\nIn addition to this, phishing detection systems deployed today typically use features such as those derived from analysis of email content which affects the privacy of end users. WPN is able to detect phishing URLs using only the URL strings without the need to sift through content of phishing vectors such as emails, thereby enabling privacy-preservation.\nThrough use of the efficient and scalable hash-based clus-tering and subsequent refinement using independent similarity measures, WPN is able to detect accurately entire campaigns of phishing URLs at a time as opposed to each individual URL as done in other popularly used techniques through pair-wise comparisons.\nThe results presented in the paper show the high detection rates of the proposed approach on widely used open-source data. We also present results to show resilience against AI- generated phishing URLs, a practice that has become preva- lent amongst attackers with the recent gain in popularity of generative AI techniques and LLMs such as Chat GPT.\nFuture work will focus on experimenting with a variety of datasets and benchmark against supervised learning-based approaches and with larger volumes of data to capture the temporal analysis of our approach for broader comparison."}]}