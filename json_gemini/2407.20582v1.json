{"title": "Image-based Detection of Segment Misalignment in Multi-mirror Satellites using Transfer Learning", "authors": ["C. Tanner Fredieu", "Jonathan Tesch", "Andrew Kee", "David Redding"], "abstract": "In this paper, we introduce a system based on transfer learning for detecting segment misalignment in multi-mirror satellites, such as future CubeSat designs and the James Webb Space Telescope (JWST), using image-based methods. When a mirror segment becomes misaligned due to various environmental factors, such as space debris, the images can become distorted with a shifted copy of itself called a \"ghost image\u201d. To detect whether segments are misaligned, we use pre-trained, large-scale image models trained on the Fast Fourier Transform (FFT) of patches of satellite images in grayscale. Multi-mirror designs can use any arbitrary number of mirrors. For our purposes, the tests were performed on simulated CubeSats with 4, 6, and 8 segments. For system design, we took this into account when we want to know when a satellite has a misaligned segment and how many segments are misaligned. The intensity of the ghost image is directly proportional to the number of segments misaligned. Models trained for intensity classification attempted to classify N-1 segments. Across eight classes, binary models were able to achieve a classification accuracy of 98.75%, and models for intensity classification were able to achieve an accuracy of 98.05%.", "sections": [{"title": "1. Introduction", "content": "On 25 December 2021, the James Webb Space Telescope (JWST) was launched into space by the United States National Aeronautics and Space Administration (NASA). One of the key features of JWST was its 18-hexagonal mirror design to act as one 6.5 meter mirror. The use of smaller, segmented mirrors to act as one larger mirror has been in use in ground-based telescopes, such as the Keck and Hobby-Eberly telescopes, but JWST is the first space-based telescope to use this configuration. Due to its resounding success, segmented mirrors are being investigated for use in other different types of satellites such as CubeSats for Low-Earth orbit (LEO) operations. This type of satellite is seen as affordable and low-cost options with a wide range of applications, such as image classification, [8], [5], [28]. With this being a recent development in space technologies, research and development is new in the area. One of the primary concerns of such satellites is how to maintenance them once deployed in orbit. For those that reside in space beyond Earth's orbit, such as JWST, maintenance is currently impossible due to the vast distances and costs of any such maintenance-based missions. This is why development of the JWST was prolonged as all the instruments had to be guaranteed to be completely operational once launched. For satellites such as CubeSats in orbit, maintenance could be possible in the future but is difficult in the immediate without the need for additional launches. For now, any maintenance of the satellite must be able to be performed by the satellite's systems either remotely or autonomously.\nThe ability to provide this on-board analysis of image systems is the primary motivation behind this work, and our contributions are summarized below:\n\u2022 We examine the use of transfer learning and pre-trained models to perform anomaly detection using only ground images from satellites to check mirror alignment.\n\u2022 We provide a solution for detection of ghost components in images that is not hardware-based but software and image-based.\n\u2022 To our knowledge, we are the first to use a novel method using deep learning and satellite ground images to monitor satellite/telescope operational status."}, {"title": "2. Related Work", "content": "Aforementioned, work directly related to the application of computer vision models to these types of multi-mirror satellites is limited since the only active one in service from any space agency is the JWST operated by NASA. However, much work has been done in the field of image clas-"}, {"title": "2.1. Non-machine Learning Methods", "content": "The two most notable and popular methods of computer vision for the detection of irregularities, especially for the detection of blur in grayscale images, are to take a Fast Fourier Transform (FFT) of an image and to use the Laplacian kernel.\nBoth methods were initially tried individually in our experimentation without success before deep learning techniques were implemented. The primary reason for the failure of these methods was finding a suitable threshold value to detect low-intensity ghosting in the images."}, {"title": "2.1.1 Laplacian Kernel Method", "content": "The first method discussed is using the Laplacian kernel which is a 3x3 matrix shown below along with the derivation of the discrete Laplacian using finite approximation:\n$\\nabla^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2}$\n$f'(x) = \\lim_{h\\rightarrow 0} \\frac{f(x + h) - f(x)}{h}$\n$\\frac{\\partial}{\\partial x^2} = f(x + 1) \u2013 2f(x) + f(x \u2212 1)$\n$\\frac{\\partial}{\\partial y^2} = f(y +1) \u2013 2f(y) + f(y \u2212 1)$\n$\\begin{bmatrix} 0 & 1 & 0 \\\\ 1 & -4 & 1 \\\\ 0 & 1 & 0 \\end{bmatrix} = \\begin{bmatrix} 0 & 0 & 0\\\\ 1 & -2 & 1\\\\ 0 & -2 & 0\\\\ 0 & 0 & 0 \\end{bmatrix}$\nThe variance of the image after the Laplacian kernel was applied in [6] and [13] to assess image quality and applied in [4] and [7] to detect blur. Determining if an image is blurry using this method depends on the variance outputted. If a high variance is detected from the image, then the image quality is high. If the variance is low, the quality is low, suggesting possible problems with the camera or other hardware. The benefit of this method is that it is fast and efficient. The drawback is the need to find a threshold value as well as not being as effective as other more computationally costly methods such as FFT."}, {"title": "2.1.2 Fast Fourier Transform Method", "content": "The second method discussed uses the FFT of an image to determine whether irregularities have occurred. By taking the FFT of an image along with its magnitude, the distribution of frequencies can be found.\n$F(m,n) = \\sum_{m=0}^{M-1}\\sum_{n=0}^{N-1} f(x,y)e^{-j2\\pi(\\frac{mx}{M}+\\frac{ny}{N})}$\nThis method has the advantage of being able to accurately detect a wider range of variance in the magnitude of the image compared to other methods such as using a Laplacian kernel. The use of FFT has been used successfully in image quality assessment applications [12], [17]. However, it suffers from the same initial problem as the Laplacian method, where a threshold is needed to be manually calculated and it can miss small image distortions such as the ghost component."}, {"title": "2.2. Machine Learning Methods", "content": "Deep learning has proven effective for a wide range of applications in computer vision, language processing, generative models, etc. These techniques have also been widely utilized in the fields of astronomy, space and planetary exploration, and satellite imaging. Such applications range from target tracking [25], weather monitoring [14], [2], satellite communications [11], [16], imaging of Earth's and other planetary surfaces [15], and analysis of deep space data such as solar data [1].\nTo address the problem of determining an optimal threshold manually, as with Laplacian and FFT methods to distinguish blurred images from non-blurred ones, deep learning methods have been used to great effect. This can be achieved in a few ways. The simplest way is to use a deep neural network by itself as in [26], [3], [27], and [20]. More complex and effective methods involve combining deep neural networks with others, such as Laplacian and FFT methods, to increase performance. [22], [19] and"}, {"title": "3. Implementation", "content": "As stated previously, the detection of ghost components in images does not have the depth of literature as other tasks in the fields of computer vision and image processing. So to create a baseline performance for our model, we added Gaussian blur to the images, the specifics will be detailed later, in the first experimentation then tested our model against other models used for blur detection. This initial experimentation focused on binary classification to examine if the model was able to determine whether an image contained blur or not before moving on to the primary experimentation.\nFor implementation of our model in the blur detection experimentation, we focused on three different approaches for our preprocessing of the images. First, we implemented a straightforward method to input the 2448x2448 images directly into the model. No preprocessing was performed on the images to test the effect this had on performance. Second, we took the first approach and apply FFT to all the images then take the magnitude of each before sending them to the model. Third, each image from the second approach was cut into patches of individual 266x266 images before the FFT was applied and then sent to the model. This method was inspired by [20]."}, {"title": "3.1. Experimental Setup", "content": "For the primary experimentation, we took the best performing approach from the initial experimentation then applied it to this one. The only difference is the use of ghosting components added to the images instead of a Gaussian blur kernel. This part of the experimentation also attempted to expand the classification ability by classifying whether a misalignment has occurred, and if so, how many mirrors are misaligned from a simulated segmented mirror instead of only the binary classification from the first experimentation.\nFor our CubeSat design, we simulated three different mirror configurations outlined in Figure 2. These configurations are purely arbitrary, but they are meant to illustrate how a multimirror design can be presented on a satellite."}, {"title": "3.2. Datasets", "content": "Since there is no common, benchmark dataset for images with ghost components, our team took a satellite dataset from Kaggle and added the desired effects for our purposes. The dataset chosen was the DeepGlobe Land Cover Classification Dataset [10]. Due to the images in the DeepGlobe dataset containing three channels of RGB, the entire dataset is first converted to grayscale.\nFor the initial experimentation with blur detection, Gaussian blur with sigma values from the set 1,2,3,4,5 was added to the grayscale images of the dataset. For the primary experimentation, we added ghosting to each image using the following preprocessing steps.\n1. A copy of the image is first made\n2. A translation matrix, below, containing $t_x$ and $t_y$ is used to provide a pixel offset on the copy. $t_x, t_y \\in [0,15]$. In the first experiment, the values of $t_x$ and $t_y$ are randomized while, in the second, the values are $x \\cdot I$.\n$T=\\begin{bmatrix} 1 & 0 & t_x \\\\ 0 & 1 & t_y \\\\ 0 & 0 & 1 \\end{bmatrix}$\n3. Mirror offset in I \u2208 [0, 1], where N is the number of mirror segments on the satellite.\n4. The copy is then added to the original with the intensity of the original being (1-I), and the intensity of the copy being I."}, {"title": "3.3. Model Architecture and System Design", "content": "For our model architecture, we make use of pre-trained models as our primary component. We chose three models because of their availability and commonality. These models are VGG-19, ResNet-50, and ResNet-101. VGG-19 was chosen specifically to test a system that. ResNet-50 was chosen to test the effect of residual connections on the"}, {"title": "4. Experimental Results", "content": "For the first part of our experimentation, we test the three different approaches outlined in the Implementation section with the DeepGlobe dataset with Gaussian blur. shows less than optimal performance for the three models. The most optimal of them was only able to achieve slightly above the accuracy of 70%. Incorporation of FFT in image pre-"}, {"title": "5. Future Work", "content": "For our future work in this area, we plan to further investigate the possible environmental effects that can occur in ground images for better detection. We will also investigate different methods for preprocessing. Currently, we do all preprocessing manually by adding the ghost effects to images one by one. In the future, we will look at using a point-spread function to estimate the ghost component's intensity and offset. It would also be beneficial to evaluate the computation resources used by each model and to compare the trade-off in accuracy to efficiency in resource use."}, {"title": "6. Conclusions", "content": "In conclusion, we have proposed a deep learning system based on pre-trained image models that is able to not only detect that a mirror misalignment has occurred, but also the intensity at which it has in multi-mirror satellites. By taking the FFT of patches of a ground image from satellites, we are able to achieve an accuracy of 98.75% in detecting a general misalignment regardless of the mirrors affected and an accuracy of 98.05% for the intensity of the misalignment. Also, we were able to use these patches to perform a confidence metric on the image to determine with a better degree of accuracy whether a ghost component was present in the image or not."}]}