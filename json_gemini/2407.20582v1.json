{"title": "Image-based Detection of Segment Misalignment\nin Multi-mirror Satellites using Transfer Learning", "authors": ["C. Tanner Fredieu", "Jonathan Tesch", "Andrew Kee", "David Redding"], "abstract": "In this paper, we introduce a system based on transfer\nlearning for detecting segment misalignment in multimir-\nror satellites, such as future CubeSat designs and the James\nWebb Space Telescope (JWST), using image-based methods.\nWhen a mirror segment becomes misaligned due to vari-\nous environmental factors, such as space debris, the images\ncan become distorted with a shifted copy of itself called a\n\u201cghost image\u201d. To detect whether segments are misaligned,\nwe use pre-trained, large-scale image models trained on the\nFast Fourier Transform (FFT) of patches of satellite images\nin grayscale. Multi-mirror designs can use any arbitrary\nnumber of mirrors. For our purposes, the tests were per-\nformed on simulated CubeSats with 4, 6, and 8 segments.\nFor system design, we took this into account when we want\nto know when a satellite has a misaligned segment and how\nmany segments are misaligned. The intensity of the ghost\nimage is directly proportional to the number of segments\nmisaligned. Models trained for intensity classification at-\ntempted to classify N-1 segments. Across eight classes, bi-\nnary models were able to achieve a classification accuracy\nof 98.75%, and models for intensity classification were able\nto achieve an accuracy of 98.05%.", "sections": [{"title": "1. Introduction", "content": "On 25 December 2021, the James Webb Space Telescope\n(JWST) was launched into space by the United States Na-\ntional Aeronautics and Space Administration (NASA). One\nof the key features of JWST was its 18-hexagonal mirror de-\nsign to act as one 6.5 meter mirror. The use of smaller, seg-\nmented mirrors to act as one larger mirror has been in use\nin ground-based telescopes, such as the Keck and Hobby-\nEberly telescopes, but JWST is the first space-based tele-\nscope to use this configuration. Due to its resounding suc-\ncess, segmented mirrors are being investigated for use in\nother different types of satellites such as CubeSats for Low-\nEarth orbit (LEO) operations. This type of satellite is seen\nas affordable and low-cost options with a wide range of ap-\nplications, such as image classification, [8], [5], [28]. With\nthis being a recent development in space technologies, re-\nsearch and development is new in the area. One of the pri-\nmary concerns of such satellites is how to maintenance them\nonce deployed in orbit. For those that reside in space be-\nyond Earth's orbit, such as JWST, maintenance is currently\nimpossible due to the vast distances and costs of any such\nmaintenance-based missions. This is why development of\nthe JWST was prolonged as all the instruments had to be\nguaranteed to be completely operational once launched. For\nsatellites such as CubeSats in orbit, maintenance could be\npossible in the future but is difficult in the immediate with-\nout the need for additional launches. For now, any mainte-\nnance of the satellite must be able to be performed by the\nsatellite's systems either remotely or autonomously.\nThe ability to provide this on-board analysis of image\nsystems is the primary motivation behind this work, and our\ncontributions are summarized below:\n\u2022 We examine the use of transfer learning and pre-trained\nmodels to perform anomaly detection using only ground\nimages from satellites to check mirror alignment.\n\u2022 We provide a solution for detection of ghost components\nin images that is not hardware-based but software and\nimage-based.\n\u2022 To our knowledge, we are the first to use a novel method\nusing deep learning and satellite ground images to moni-\ntor satellite/telescope operational status."}, {"title": "2. Related Work", "content": "Aforementioned, work directly related to the application\nof computer vision models to these types of multi-mirror\nsatellites is limited since the only active one in service from\nany space agency is the JWST operated by NASA. How-\never, much work has been done in the field of image clas-"}, {"title": "2.1. Non-machine Learning Methods", "content": "The two most notable and popular methods of computer\nvision for the detection of irregularities, especially for the\ndetection of blur in grayscale images, are to take a Fast\nFourier Transform (FFT) of an image and to use the Lapla-\ncian kernel.\nBoth methods were initially tried individually in our ex-\nperimentation without success before deep learning tech-\nniques were implemented. The primary reason for the fail-\nure of these methods was finding a suitable threshold value\nto detect low-intensity ghosting in the images."}, {"title": "2.1.1 Laplacian Kernel Method", "content": "The first method discussed is using the Laplacian kernel\nwhich is a 3x3 matrix shown below along with the deriva-\ntion of the discrete Laplacian using finite approximation:\n$\\nabla^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2}$ (1)\n$f'(x) = \\lim_{h\\rightarrow0} \\frac{f(x + h) - f(x)}{h}$ (2)\n$\\frac{\\partial}{\\partial x^2} = f(x + 1) \u2013 2f(x) + f(x - 1)$ (3)\n$\\frac{\\partial}{\\partial y^2} = f(y + 1) \u2013 2f(y) + f(y - 1)$ (4)\n$\\begin{pmatrix}\n0 & 1 & 0\\\\\n1 & -4 & 1\\\\\n0 & 1 & 0\n\\end{pmatrix} = \n\\begin{pmatrix}\n0 & 0 & 0\\\\\n1 & -2 & 1\\\\\n0 & 0 & 0\n\\end{pmatrix} + \n\\begin{pmatrix}\n0 & 1 & 0\\\\\n0 & -2 & 0\\\\\n0 & 1 & 0\n\\end{pmatrix}$ (5)\nThe variance of the image after the Laplacian kernel was\napplied in [6] and [13] to assess image quality and applied\nin [4] and [7] to detect blur. Determining if an image is\nblurry using this method depends on the variance outputted.\nIf a high variance is detected from the image, then the im-\nage quality is high. If the variance is low, the quality is\nlow, suggesting possible problems with the camera or other\nhardware. The benefit of this method is that it is fast and ef-\nficient. The drawback is the need to find a threshold value as\nwell as not being as effective as other more computationally\ncostly methods such as FFT."}, {"title": "2.1.2 Fast Fourier Transform Method", "content": "The second method discussed uses the FFT of an im-\nage to determine whether irregularities have occurred. By\ntaking the FFT of an image along with its magnitude, the\ndistribution of frequencies can be found.\n$F(m,n) = \\sum_{m=0}^{M-1}\\sum_{n=0}^{N-1} f(x,y)e^{-j2\\pi(\\frac{mx}{M} + \\frac{ny}{N})}$ (6)\nThis method has the advantage of being able to accu-\nrately detect a wider range of variance in the magnitude of\nthe image compared to other methods such as using a Lapla-\ncian kernel. The use of FFT has been used successfully in\nimage quality assessment applications [12], [17]. However,\nit suffers from the same initial problem as the Laplacian\nmethod, where a threshold is needed to be manually cal-\nculated and it can miss small image distortions such as the\nghost component. An example of the FFT performed on an\nimage from the dataset used is illustrated in Figure 1."}, {"title": "2.2. Machine Learning Methods", "content": "Deep learning has proven effective for a wide range of\napplications in computer vision, language processing, gen-\nerative models, etc. These techniques have also been widely\nutilized in the fields of astronomy, space and planetary ex-\nploration, and satellite imaging. Such applications range\nfrom target tracking [25], weather monitoring [14], [2],\nsatellite communications [11], [16], imaging of Earth's and\nother planetary surfaces [15], and analysis of deep space\ndata such as solar data [1].\nTo address the problem of determining an optimal\nthreshold manually, as with Laplacian and FFT methods\nto distinguish blurred images from non-blurred ones, deep\nlearning methods have been used to great effect. This can\nbe achieved in a few ways. The simplest way is to use\na deep neural network by itself as in [26], [3], [27], and\n[20]. More complex and effective methods involve com-\nbining deep neural networks with others, such as Laplacian\nand FFT methods, to increase performance. [22], [19] and"}, {"title": "3. Implementation", "content": "As stated previously, the detection of ghost components\nin images does not have the depth of literature as other\ntasks in the fields of computer vision and image process-\ning. So to create a baseline performance for our model,\nwe added Gaussian blur to the images, the specifics will be\ndetailed later, in the first experimentation then tested our\nmodel against other models used for blur detection. This\ninitial experimentation focused on binary classification to\nexamine if the model was able to determine whether an im-\nage contained blur or not before moving on to the primary\nexperimentation.\nFor implementation of our model in the blur detection\nexperimentation, we focused on three different approaches\nfor our preprocessing of the images. First, we implemented\na straightforward method to input the 2448x2448 images\ndirectly into the model. No preprocessing was performed\non the images to test the effect this had on performance.\nSecond, we took the first approach and apply FFT to all\nthe images then take the magnitude of each before sending\nthem to the model. Third, each image from the second ap-\nproach was cut into patches of individual 266x266 images\nbefore the FFT was applied and then sent to the model. This"}, {"title": "3.1. Experimental Setup", "content": "As stated previously, the detection of ghost components\nin images does not have the depth of literature as other\ntasks in the fields of computer vision and image process-\ning. So to create a baseline performance for our model,\nwe added Gaussian blur to the images, the specifics will be\ndetailed later, in the first experimentation then tested our\nmodel against other models used for blur detection. This\ninitial experimentation focused on binary classification to\nexamine if the model was able to determine whether an im-\nage contained blur or not before moving on to the primary\nexperimentation.\nFor implementation of our model in the blur detection\nexperimentation, we focused on three different approaches\nfor our preprocessing of the images. First, we implemented\na straightforward method to input the 2448x2448 images\ndirectly into the model. No preprocessing was performed\non the images to test the effect this had on performance.\nSecond, we took the first approach and apply FFT to all\nthe images then take the magnitude of each before sending\nthem to the model. Third, each image from the second ap-\nproach was cut into patches of individual 266x266 images\nbefore the FFT was applied and then sent to the model. This\nmethod was inspired by [20].\nFor the primary experimentation, we took the best per-\nforming approach from the initial experimentation then ap-\nplied it to this one. The only difference is the use of ghost-\ning components added to the images instead of a Gaussian\nblur kernel. This part of the experimentation also attempted\nto expand the classification ability by classifying whether\na misalignment has occurred, and if so, how many mirrors\nare misaligned from a simulated segmented mirror instead\nof only the binary classification from the first experimenta-\ntion.\nFor our CubeSat design, we simulated three different\nmirror configurations outlined in Figure 2. These config-\nurations are purely arbitrary, but they are meant to illustrate\nhow a multimirror design can be presented on a satellite."}, {"title": "3.2. Datasets", "content": "Since there is no common, benchmark dataset for images\nwith ghost components, our team took a satellite dataset\nfrom Kaggle and added the desired effects for our purposes.\nThe dataset chosen was the DeepGlobe Land Cover Classi-\nfication Dataset [10]. Due to the images in the DeepGlobe\ndataset containing three channels of RGB, the entire dataset\nis first converted to grayscale.\nFor the initial experimentation with blur detection, Gaus-\nsian blur with sigma values from the set 1,2,3,4,5 was added\nto the grayscale images of the dataset. For the primary ex-\nperimentation, we added ghosting to each image using the\nfollowing preprocessing steps.\n1. A copy of the image is first made\n2. A translation matrix, below, containing $t_x$ and $t_y$ is used\nto provide a pixel offset on the copy. $t_x, t_y \\in [0,15]$. In\nthe first experiment, the values of $t_x$ and $t_y$ are random-\nized while, in the second, the values are x I.\n$T=\\begin{pmatrix}\n1 & 0 & t_x\\\\\n0 & 1 & t_y\\\\\n0 & 0 & 1\n\\end{pmatrix}$ (7)\n3. Mirror offset in I \u2208 [0, 1]$, where N is the number\nof mirror segments on the satellite.\n4. The copy is then added to the original with the intensity\nof the original being (1-I), and the intensity of the copy\nbeing I.\nAn example of an image with the ghost component\nadded is illustrated in Figure 3."}, {"title": "3.3. Model Architecture and System Design", "content": "For our model architecture, we make use of pre-trained\nmodels as our primary component. We chose three mod-\nels because of their availability and commonality. These\nmodels are VGG-19, ResNet-50, and ResNet-101. VGG-\n19 was chosen specifically to test a system that. ResNet-50\nwas chosen to test the effect of residual connections on the"}, {"title": "4. Experimental Results", "content": "For the first part of our experimentation, we test the three\ndifferent approaches outlined in the Implementation section\nwith the DeepGlobe dataset with Gaussian blur. Table 1\nillustrates the performance of the three models for each ap-\nproach. The initial results of the first approach show less\nthan optimal performance for the three models. The most\noptimal of them was only able to achieve slightly above\nthe accuracy of 70%. Incorporation of FFT in image pre-"}, {"title": "5. Future Work", "content": "For our future work in this area, we plan to further in-\nvestigate the possible environmental effects that can occur\nin ground images for better detection. We will also investi-\ngate different methods for preprocessing. Currently, we do\nall preprocessing manually by adding the ghost effects to\nimages one by one. In the future, we will look at using a\npoint-spread function to estimate the ghost component's in-\ntensity and offset. It would also be beneficial to evaluate the\ncomputation resources used by each model and to compare\nthe trade-off in accuracy to efficiency in resource use."}, {"title": "6. Conclusions", "content": "In conclusion, we have proposed a deep learning system\nbased on pre-trained image models that is able to not only\ndetect that a mirror misalignment has occurred, but also the\nintensity at which it has in multi-mirror satellites. By taking\nthe FFT of patches of a ground image from satellites, we are\nable to achieve an accuracy of 98.75% in detecting a gen-\neral misalignment regardless of the mirrors affected and an\naccuracy of 98.05% for the intensity of the misalignment.\nAlso, we were able to use these patches to perform a confi-\ndence metric on the image to determine with a better degree\nof accuracy whether a ghost component was present in the\nimage or not."}]}