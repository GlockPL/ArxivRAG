{"title": "Fuzzy Model Identification and Self Learning with Smooth Compositions", "authors": ["Ebrahim Navid Sadjadi", "Jesus Garcia", "Jose Manuel Molina Lopez", "Akbar Hashemi Borzabadi", "Monireh Asadi Abchouyeh"], "abstract": "This paper develops a smooth model identification and self-learning strategy for dynamic systems taking into account possible parameter variations and uncertainties. We have tried to solve the problem such that the model follows the changes and variations in the system on a continuous and smooth surface. Running the model to adaptively gain the optimum values of the parameters on a smooth surface would facilitate further improvements in the application of other derivative based optimization control algorithms such as MPC or robust control algorithms to achieve a combined modeling-control scheme. Compared to the earlier works on the smooth fuzzy modeling structures, we could reach a desired trade-off between the model optimality and the computational load. The proposed method has been evaluated on a test problem as well as the non-linear dynamic of a chemical process.", "sections": [{"title": "1 Introduction", "content": "Soft computing methods are being used for identification of non-linear and complex systems based on the input-output data collected from the original system [1]. There are many applications of Artificial Neural Network and Fuzzy modeling framework for identification purposes in the industry and academia [2]. Such methods have quite interesting abilities in modeling the industrial processes with different types of data. The advantage of fuzzy models is that they can also include the operator's knowledge and information for dealing with the concept of uncertainty and handling the probabilistic logics [3]. The inclusion of information about the process in the generation of the mathematical model makes the model very useful for coping with the various non-linear behaviors such as limit cycles, or where large changes in the operating conditions can be anticipated during the routine operation, such as the systems with the time varying parameters, in batch processes or during the start-up and shutdown of the continuous processes.\nAnother difference of neural networks and fuzzy models is that the neural networks can approximate the process and its derivative based on the so called back propagation training, while standard fuzzy models cannot guarantee the accuracy in approximation of the derivatives [4, 5].\nThe universal approximation properties of the fuzzy models are well recognized and it is widely accepted that the fuzzy models can approximate any non-linear function to any degree of accuracy in a convex compact region [6]. However, in many applications it is desired to go beyond that and have a model to approximate the non-linear function on a smooth surface to get better performance and stability properties. Especially in the region around the steady states, when both error and change in error are approaching zero, it is much desired to avoid abrupt changes or discontinuity in the input-output mapping [4, 7]. The continuity of not only the function, but also its derivatives, based on the literature, is defined as the smoothness property [8].\nAfter introduction of topological structures [9], different researchers have studied the concept of smooth fuzzy topological spaces [10] and their properties and characterizations in different compact, disconnected and bi-topological spaces [11-14].\nRecently some new smooth compositions have been presented that are able to approximate the derivative of the plant process with accuracy [15]. Many of the contributions in the field for smooth modeling purpose of the dynamical systems have employed the fuzzy relational modeling framework (see [15\u201317] and the references therein). They have been employed for different purposes including modeling static input-output mapping of dynamical systems and for data clustering.\nThe identification process then will be consisting of the estimation of the unknown relational matrix from the input-output data [18, 19]. Even though the fuzzy relational matrix can be quite easily developed and modified online, this advantage must be viewed in the context of their limitations. Firstly, their use is normally limited to the processes with a small number of variables due to the potential large size of the matrix and the computation requirements. The relational fuzzy modeling approaches generally require significant computational effort, especially if the number of variables and number of reference fuzzy sets used are great. The first-order relational model of a system consisting of 2-inputs and 1-output, where 7 reference sets are used by each variable, will generate the matrix consisting of 2401 elements- each element shows the degree of membership of a variable in the fuzzy matrix [6]. Another difficulty of the fuzzy relational modeling framework is that there exist no simple approach for deriving the controller output analytically, making it necessary to resort to the numerical approaches, which adds difficulty to the already mentioned large computational requirements of the model. The controller transparency problems that can arise as a result of the incomplete rule bases are also important. It is to say, the fuzzy relational approach does not provide rules that can be expressed linguistically. As such, it may be criticized that this technique would be difficult to use interactively with the human in loop, making it difficult to update and modify the matrix using the heuristic knowledge [20].\nIt also worth reminding the slight alteration of the definition of a smooth fuzzy topology built from the employment of the smooth fuzzy norms by fuzzy relations which is associated to the concept of composition of binary numbers and relations in the earlier works, rather than the topology built from the employment of the same norms in the IF-THEN model, which more relates to the concept of fuzzy numbers as introduced by Zadeh [21]. The main difference of two approaches of the relational smooth fuzzy models and IF-THEN smooth fuzzy models is that whether or not it is more practical that the functions be presented through fuzzy numbers of the fuzzy topology or one should restrain to only the constant zero and one fuzzy sets 0 and 1 of the smooth fuzzy relations; we think the first one is preferable and will contribute on development of the IF-THEN smooth fuzzy modeling and self-adjusting scheme in this contribution.\nTaking into account the previous drawbacks, the motivation of the present work is to present a smooth adaptive fuzzy IF-THEN based identification approach. The application of the algorithm to the non-linear dynamic of a continuous-stirred tank reactor (CSTR) [22, 23] is analyzed to overcome the computational barriers and widen the application of the smooth compositions. Indeed, the non-linearities, uncertainties, or the environmental parametric changes in the dynamic of the non-linear systems may make the control process to fail. Hence, the originality of the contributions is that we have demonstrated the application of the smooth fuzzy compositions with the varying parameters and with the uncertain parameters can assist in accomplishment of a precise and effective modeling task without direct intervention of the operator through the theoretical studies and examples. According to [14], smooth fuzzy continuity is equivalent to fuzzy continuity on all the cuts that together form the decomposition of the smooth fuzzy topology. Therefore, it is expected that smooth fuzzy model will show more robustness to the parametric changes and uncertainties rather than the classical fuzzy model by structure. This claim has been verified by simulation results of the CSTR system which could show that the proposed adaptive identification algorithm is able to handle all the difficult types of such non-linear system's behavior during the manipulation.\nHence, the rest of this manuscript is as follows. First we review fuzzy IF-THEN structures for process modeling and introduce the smooth compositions based on the literature. Then, we employ them for generation of the adaptive fuzzy modeling scheme. Subsequent to that, we introduce the self-learning structure for smooth fuzzy models, to make them sensitive to the parameter variations of the process. After that, we apply the developed structure for a benchmark example and then on a practical example of CSTR, in two different working modes, and also with uncertainty in the parameters. Then, we conclude the manuscript."}, {"title": "2 Fuzzy Structures for Process Modeling", "content": "In many practical engineering problems we face with little information on the system along the non-linear system behavior, which makes the problem so complex. In many cases, the problems come with a high degree of uncertainties. To deal with such problems, fuzzy logic assigns an interval, on which the system variables have the most probability of existence. Then, the interval is divided to say, N + 1 regions and then for every region it defines a degree of membership of the variables, which are collected in a fuzzy set. Hence, the elements of a fuzzy set can be elements of other fuzzy sets, upon their degrees of membership. Hence, the membership functions characterize all the information of a fuzzy set. In this study, we incorporate Gaussian membership functions for the system input, as\n$\\mu(x) = \\exp(-\\frac{1}{2} [\\frac{x_i - c_i}{d_i}]^2)$ (1)\nwhere $x_i$ is the ith input variable, $c_i$ is the ith center of the membership function, and $d_i$ is the constant showing the spread of the ith membership function."}, {"title": "2.1 Fuzzy Set Operation", "content": "The next step in formation of the fuzzy models is to make the operations on the sets, which mainly are the intersection and the union operations, usually called fuzzy t-norms and s-norms. The mainly used t-norm operator is the min operation and the widely used s-norm is the max operation. We will study the fuzzy operators furthermore in the subsequent."}, {"title": "2.2 Fuzzy Modeling", "content": "The basis of fuzzy IF-THEN model is a set of rules that presents our knowledge of the process. To make up this model, we go through the fuzzification, inference, and defuzzification stages.\nThe fuzzification stage converts numeric inputs into fuzzy sets in order to involve them in the fuzzy modeling methodology. This transformation as stated above is through the use of the membership functions.\nThe inference mechanism is normally known by an expression of the following type,\nIF premise (antecedent) THEN conclusion (consequent).\nThis IF-THEN form presents a cause and effect relationship, and for every given condition provides a corresponding planned action.\nThe defuzzification stage, converse to the fuzzification stage, converts the fuzzy results into the crisp results. This transformation provides a means to choose a crisp single value quantity for employment in the real applications, (e.g., to set the gauge level), based on the results of the fuzzy calculations.\nHence, the model of fuzzy rules for a given input-output data set, corresponding to a process with two inputs x1 and x2, and output y, can be written as,\nIF x1 is M1 and x2 is M2 THEN y = f(x1, x2).\nwhere X\u2081 and X2 are fuzzy sets (membership functions) of X1 and x2, respectively, and y = f(x1,x2) is a crisp conclusion of the system states.\nA generalization of the fuzzy model building process for a system with n input variables defined as,\nf:R\" \u2192 R y = f(x1, x2,...,xn)\nwill be\nRi : if x\u2081 is M\u2081 and x2 is M and\u00b7\u00b7\u00b7xn is M then\nf(x1,...,xn) is d\u2081 under the possibility \u03bc\u2081, i = 1, . . ., r.\n(2)\n(3)\nwhere R; is the i-th fuzzy rule that describes the fuzzy model. For a given input, the output of the fuzzy model employing the widely used centroid defuzzification formula is,\ny(k) =$\\frac{\\sum_{i=1}^r d_i\\mu_i(k)}{\\sum_{i=1}^r\\mu_i(k)}$ (4)\nwhere y\u2081 is considered to be at the center of the region D\u00b9 at every time instant of the dynamics of the system and r is the total number of fuzzy rules in the defined fuzzy model. Therefore, we see that there are three factors to make up a fuzzy model: (1) definition of fuzzy regions, (2) the specific form of the membership functions and (3) the assigned fuzzy rules.\nThe aim of the present manuscript is to study the second factor and we want to see how a different design in the membership functions using smooth fuzzy compositions can better the overall performance and effectiveness of the fuzzy model. The validation stage will be done through the test data.\""}, {"title": "3 Preliminaries on Smooth Fuzzy Compositions", "content": "As stated above, the mostly used fuzzy composition (sometimes called s-t composition) is max-min. However, other fuzzy compositions also have been introduced in the literature, which will be reviewed in this section. Let's start with basic definitions in fuzzy compositions: t-norm and s-norm [15, 24].\nTriangular norms (t-norms), are functions defined by their properties:\nT(a, b) = T(b,a) (5)\nT(a,b,c) = T(a, T(b, c)) (6)\nT(a, b) \u2264T(c, d), if a\u2264c,b<d (7)\nT(a, 1) = a, \u2200a \u2208 (0, 1) (8)\nLikewise, Triangular conorms (s-norms) are also defined by their properties:\nS(a,b) = S(b,a) (9)\nS(a, b, c) = S(a, S(b, c)) (10)\nS(a, b) \u2264S(c, d), if a \u2264c, b\u2264d (11)\nS(a, 0) = a, \u2200a \u2208 (0, 1) (12)\nTheorem 1 If T is a norm then,\nS(a, b) = 1 \u2013 T(1 \u2013 a, 1 \u2013 b). (13)\nDifferent t-norm and t-conorm have been introduced in the literature [5, 24, 25] and some has been collected in Table 1. We would refer the smooth composition II as \"atan\" composition and the smooth composition III as \"acos\" composition, according to the mathematical definition, in the rest of the paper.\nEmploying the different t-norms and s-norms from the above list to make different compositions can give rise to various levels of accuracy in modeling of the dynamical systems upon the context. This matter has been studied in the literature [2]. From them, the smooth fuzzy compositions can make the fuzzy model such that the output be a differentiable function of the input variables. Hence, the different schemes of gradient based methods can be used later for the adaptive tuning of the fuzzy model parameters for time variant plants and capturing the uncertainties. This idea has been developed before for designing fuzzy relational dynamic systems and here we want to employ them for rule-based fuzzy model identification and gaining self-learning dynamics, in the following."}, {"title": "4 Generation of Smooth Rules-Based Fuzzy Models", "content": "The aim of this section is to find the optimum parameters for the membership functions to shape it up correspondingly, such that the fuzzy model can make the best approximation of the non-linear system using the smooth fuzzy compositions. For this aim, first we define the error function as,\ne(k) = y(k) - y(k) (14)\n$\\tilde{E}(k) = \\frac{1}{2T} \\sum_{t=0}^{T}(e(k+1))^2$(15)\nwhere T is the horizon of training, y(k) is target value of the fuzzy model and y(k) is the output of the fuzzy model. The goal is to use this error function to find the optimal shape of the membership functions. Hence, the variables to find are the centers and the widths of the input and output membership functions in the model definition. To simplify the procedure, we consider the normal membership functions with the variables update algorithm, as\nc_{ij}(k + 1) = c_{ij}(k) \u2013 \u03b1c $\\frac{\\partial \\tilde{E}(k)}{\\partial c_{ij}}$ (16)\nd_{ij}(k + 1) = d_{ij}(k) \u2013 \u03b1d $\\frac{\\partial \\tilde{E}(k)}{\\partial d_{ij}}$ (17)\n$\\tilde{d}(k + 1) = d_{i}(k) \u2013 a_b \\frac{\\partial \\tilde{E}(k)}{\\partial d_{i}}$ (18)\nwhere Oij = [Cij, dij] are the parameters of the normal membership functions that give shape to the membership functions, \u03b1\u03c2, \u03b1s and as are the step lengths in the gradient based optimization and i = 1. . ., r, j = 1,...,n are the numbers of the system rules and the system inputs, and di are the parameters to be used in the defuzzification formula, respectively. In order to derive the error derivatives we study the estimation process in more details. To begin with, we write the gradient descent method formula as follows,\n$\\frac{\\partial \\tilde{E}}{\\partial O_{ij}} = \\frac{\\partial \\tilde{E}}{\\partial y} \\frac{\\partial y}{\\partial y_i} \\frac{\\partial y_{ij}}{\\partial x_{ij}} \\frac{\\partial \\mu_{ij}}{\\partial O_{ij}}$ (19)\nIn order to complete the formulation we need to take the partial derivative of each variable separately.\n1. We define the fuzzy variables {x\u00ed,...,x,} at every time instant as\nXi = [Xi1, Xi2,...Xin] = [\u03bc\u20811(x1), \u03bc\u20812(x2), ..., Min (xn)], i = 1..., r\nwhere pij(\u00b7) is the value of i-th membership function for j-th input fuzzy set, presented in Eq. (1).\nFor making gradient descent method formula, can be written as,\n$\\frac{\\partial \\mu_{ij}(.)}{\\partial c_{ij}}$ = \u2212(xi\u2212cij2) exp(\u221212(xi\u2212cij\u03b4ij)2 (20)\n$\\frac{\\partial \\mu_{ij}(.)}{\\partial d_{ij}}$ = \u2212(xi\u2212cij\u03b4ij3 exp(\u221212(xi\u2212cij\u03b4ij)2 (21)\n2. The estimation of the system output based on the compositional rule inference can be written as,\ny\u2081 = s-norm(t-norm(xi, R\u2081(x, y)))\nfor the i-th rule R\u2081, i = 1,...,r. We will use the abbreviation S: s-norm and T: t-norm in the followings.\nIn order to simplify the explanation of the procedure of taking the derivation of , we assume a system with j =dxij2, and put, x\u2081 = [xi1,xi2] and c = R\u2081(x, y). Then, based on the properties of t-norms, stated in Eq. (6), we have,\nyi = S(T(T(xi1, x\u00ed2), c)) = S(T(x\u00ed, c), T(x\u00ed2, c)) (22)\nWe define: 11 = T(x\u00ed1, c) and A2 = T(x\u00ed2, c), then,\nyi = S(A1, A2)\n$\\frac{\\partial y}{\\partial x_{ij}}$dxijds dij (23)\n$\\frac{\\partial y}{\\partial x_{ij}} \u015an\u22121\u00fdn\u22121 ... \u015a\u00b9\u00cd\u00b9, j = 1, . . ., n.$ (25)\nHence, to derive the gradient descent based training formulation, the derivative of the error will be,\n$\\frac{\\partial \\tilde{E}}{\\partial c_{ij}}$$\\frac{\\partial \\tilde{E}}{\\partial y}$ddij (26)\nProposition 1 The error function constructed based on the Eq. (14) is a smooth function."}, {"title": "5 Self-Learning of the Fuzzy Model", "content": "Until now, we have developed the algorithm to make a model from the system's input and output data. However, for the time varying systems, after making up the initial model of the system, the system parameters changes and the basic model will not remain useful. Therefore, after that the initial fuzzy model comes available, a modification in the abovementioned algorithm can be useful to improve the system performance in an adaptive self-learning scheme. We make this improvement as indicated in Table 2.\nThe overall scheme of the self-learning algorithm is shown in Fig. 1 and demonstrated in Table 3. In the next section, we demonstrate the application of the algorithm in a practical example of chemical processes."}, {"title": "6 Case Studies", "content": "Two highly non-linear systems are selected for studying the proposed modeling approach. The first system is an example of chaotic time series. We have added parametric uncertainty to demonstrate the effectiveness of the proposed method to the classical modeling scheme.\nThe second example is about modeling of a continuous-stirred tank reactor (CSTR) [18, 23]. Different fuzzy models are tested and compared in the uncertain working conditions.\nExample 1 Model evaluation by prediction of chaotic time series\nIn this study, we have employed Mackey-Glass chaotic time series to assess the prediction performance of the proposed smooth fuzzy model. Chaos is a common dynamical phenomenon in the various fields and can be represented in different forms including the time series.\nChaotic time series are inherently non-linear, very sensitive to the initial conditions, and hence, difficult to be predicted. Therefore, it is a practical technique to evaluate the accuracy of different types of non-linear models based on their performance in prediction of the chaotic time series.\nWe have employed the Mackey-Glass time series as,\nax(t - \u03c4)\nx = - bx(t), (30)\n1 + x(t \u2212 \u03c4)C\nwith the following parameters: a = 0.2; b = 0.1; C = 10; initial conditions \u00d7 0=1.2 and \u03c4 = 17 s. Four different fuzzy models have been trained to predict accurately the generated time series. The error convergence can be seen in Fig. 3. We do not place much emphasis on the min-max error convergence comparison, because the fuzzy min-max model is not differentiable to be solved softly with the gradient descent we applied to the other compositions.\nTo study the disturbance rejection performance of the different fuzzy models, we have evaluated the models through simulation with the parametric change in the chaotic system set to b = 0.15. The sequences computed by different fuzzy norms is demonstrated in Fig. 4, which shows that the smooth fuzzy models provide better performance with quicker convergence rather than the models with the non-smooth compositions. Also, we note that the range of errors in all the fuzzy compositions is very narrow, as can be seen in Figs. 5 and 6."}, {"title": "Example 2 Evaluation of the proposed smooth fuzzy model with a chemical process", "content": "We want to study the dynamic of a highly non-linear continuous-stirred tank reactor (CSTR) process, as a second benchmark example, which is very common in chemical and petrochemical plants. The modeling problem is selected here for test and comparison of different fuzzy compositions. In the process, an irreversible, exothermic reaction occurs in a constant volume reactor to generate a compound A with concentration Ca(t) with the temperature of the mixture T(t) that is cooled by a single coolant stream with the flow rate qc(t). The following equations describe the process model [22]:\nda(t)\ndt = (Cao - Ca(t)) - koCa(t) x exp(-ERT(t1)\ndT(t)\ndt = qVt(To - T(t)) +k1Ca(t) x exp(-ERT(t)) +k2qct(1-exp(-k3kVqc(t (Tco-T(t))(32)\nwhere the value of inlet feed concentration Cao, the process flow rate q, and the inlet feed and coolant temperatures To and Tco, all are assumed to be constant. In the same way, ko,k, V,k1,k2 and k3 are constants. The nominal values of the process parameters appear in Table 5.\nk1 = \u03c1ccpc\u0394Hko,k2 = \u03c1CpHak3 = pcVpcpc(33)\nThe nominal conditions for the product concentration Ca = 0.1 mol/l are:\nT = 438.5K, qc = 103.4111/min (34)\nThe objective in the chemical process is to control the measured concentration of A, CA(t) by manipulating coolant flow rate qc(t).\nFuzzy modeling: in our study, the above rigorous model is used to generate a series of input-output time series data. The data are then used to develop fuzzy model employing different compositions. The structure of the model is:\n\u0108a(k+1) = f(\u0108a(k), \u0108a(k \u2013 1), \u0108a(k \u2013 2), qc(k \u2212 1)) \u2212 (35)\nThe fuzzy model has 3 Gaussian membership functions and the number of rules is 3 \u00d7 3 \u00d7 3 \u00d7 3 = 81.\nThe model performance on a validation data set is illustrated in Fig. 8. Four different fuzzy compositions are shown."}, {"title": "7 Conclusions", "content": "The overall achievement of the paper is twofold. From theoretical side, one seeks to extend the operational range of applications of smooth fuzzy compositions to make up fuzzy IF-THEN models, which comprises lower computational complexities in comparison to the earlier works on the relational fuzzy models, and then, to contribute to the state of smooth fuzzy self-learning algorithm for modeling task of the time variant structures. The other achievement is the applications of the developed approach to the chemical non-linear processes, where their effectiveness in the system modeling in the presence of parametric uncertainties has been illustrated.\nWe have proposed a novel optimization based method for fuzzy smooth model construction and compared its performance to the classical fuzzy models. Four different compositions for extracting fuzzy models in the presence of uncertainty have been investigated. Two simulation benchmark examples were presented to show the advantages and the drawbacks of the methods. For the First benchmark, a detailed comparison of performance of the fuzzy compositions for a commonly used Mackey-Glass chaotic time series has been done. We have investigated the case of parametric uncertainty and a comparison of the speed of convergence has been carried out. The performance achieved by the proposed smooth fuzzy models is superior to the performance attained through the classical fuzzy models; however, the computational load is slightly higher. The second benchmark shows an application to a chemical process and comparisons with the alternative fuzzy models have been done. We have proposed and validated by simulation the smooth fuzzy model and compared it to the classical implementation, on equal conditions, for a CSTR system. We believe that the adopted smooth modeling approach is a promising solution for designing different adaptive identification-controller schemes."}, {"title": "8 Future Works", "content": "We believe that the paper represents the initial steps in a direction that appears to be promising in the smooth fuzzy modeling of the complex systems. The transparency of the IF-THEN smooth fuzzy models is much better than the matrix of relational fuzzy models. Hence, the interpretation of the linguistic variable can be useful for better modeling and the subsequent control purpose during the operator interaction. The achievements can be extended for the time varying smooth fuzzy systems [26] in the future works.\nAlso, since the smooth fuzzy model is differentiable and the use of derivative based iterative optimization techniques become possible for better connectivist identification-control approaches [27], hence, the other future work can focus on the development of a detailed error mapping of the smooth fuzzy models for characterization of high speed stages used in the noisy environments for precise measurement and manipulation.\nWhen the smooth compositions are employed in the fuzzy models, derivative of the model and error mapping can be obtained analytically. Therefore, the IF-THEN smooth model structure is susceptible for theoretical analysis on the robustness and stability properties rather than matrix based relational smooth fuzzy model.\nIn fact, the success in robust modeling will empower to predict the experimental results accurately in the face of environmental conditions and parametric variations. We believe that the proposers shall give priority to the experimental verification of the benefits of the proposed algorithm and work on it to meet the industrial needs and take measures for the transfer of it into industry.\nOther works could focus on the applications of different control theories to the smooth models to improve the calibration accuracy of systems and decrease the number of interactions between the systems/tools/equipments and changes in the measurement configurations during the manipulation, validation, and calibration phases."}]}