{"title": "Identifying Influential nodes in Brain Networks via Self-Supervised Graph-Transformer", "authors": ["Yanqing Kang", "Di Zhu", "Haiyang Zhang", "Enze Shi", "Sigang Yu", "Jinru Wu", "Xuhui Wang", "Xuan Liu", "Geng Chen", "Xi Jiang", "Tuo Zhang", "Shu Zhang"], "abstract": "Studying influential nodes (I-nodes) in brain networks is of great significance in the field of brain imaging. Most existing studies consider brain connectivity hubs as I-nodes such as the regions of high centrality or rich-club organization. However, this approach relies heavily on prior knowledge from graph theory, which may overlook the intrinsic characteristics of the brain network, especially when its architecture is not fully understood. In contrast, self-supervised deep learning dispenses with manual features, allowing it to learn meaningful representations directly from the data. This approach enables the exploration of I-nodes for brain networks, which is also lacking in current studies. This paper proposes a Self-Supervised Graph Reconstruction framework based on Graph-Transformer (SSGR-GT) to identify I-nodes, which has three main characteristics. First, as a self-supervised model, SSGR-GT extracts the importance of brain nodes to the reconstruction. Second, SSGR-GT uses Graph-Transformer, which is well-suited for extracting features from brain graphs, combining both local and global characteristics. Third, multimodal analysis of I-nodes uses graph-based fusion technology, combining functional and structural brain information. The I-nodes we obtained are distributed in critical areas such as the superior frontal lobe, lateral parietal lobe, and lateral occipital lobe, with a total of 56 identified across different experiments. These I-nodes are involved in more brain networks than other regions, have longer fiber connections, and occupy more central positions in structural connectivity. They also exhibit strong connectivity and high node efficiency in both functional and structural networks. Furthermore, there is a significant overlap between the I-nodes and both the structural and functional rich-club. Experimental results verify the effectiveness of the proposed method, and I-nodes are obtained and discussed. These findings enhance our understanding of the I-nodes within the brain network, and provide new insights for future research in further understanding the brain working mechanisms.", "sections": [{"title": "1 INTRODUCTION", "content": "The human brain is an extremely complex system that coordinates human cognition, behavior, etc. 1,2,3. It involves a lot of connections between neurons. Studies have shown for a long time that the brain can be represented as a network, with different regions of the brain connected to each other in specific patterns4. It is generally believed that there is a group of influential regions in the brain network that play an important role. For example, the highly connected regions in the brain network are called brain network hubs. These hub regions are highly connected to the rest of the brain and take a central position in neural information processing, facilitating communication between different parts of the brain5. Understanding the functions of these influential regions is crucial for unraveling the intricate workings of the brain, shedding light on mechanisms underlying cognition, learning, and memory. Moreover, the identification and study of these regions hold significant implications for the investigation of neurological disorders, as disruptions in these influential regions may contribute to the manifestation of conditions such as schizophrenia, depression, and other cognitive impairments."}, {"title": "2 METHOD", "content": null}, {"title": "2.1 Overview", "content": "The pipeline of the SSGR-GT framework proposed in this paper is shown in Fig. 1. The method analyzes I-nodes with the joint analysis of brain functional and structural profiles. The brain is represented as a graph, and through the self-supervised model we can ultimately obtain a reconstructed graph and contribution scores of nodes. Nodes with high scores are more important for reconstruction tasks and are considered as I-nodes of brain networks.\nThe framework consists of graph generation and Graph Reconstruction based on Graph-Transformer (GR-GT) module. In the graph generation part, we initialize the brain surface into 148 ROIs based on Destrieux Atlas 36 and use them as nodes of the graph. Some studies have integrated structural and functional brain information in a graph representation 37,38. Inspired by their approach, we use functional and structural information of the brain to generate node features and edge features of the graph, respectively. The GR-GT module consists of three main components, namely Encoder, MScore Pool and Decoder. The Encoder module is used to extract the node representation of the brain graph, and the Decoder module is used to reconstruct the nodes' features of the brain graph. To extract the contribution scores of nodes, we design the MScore Pool, which comes after the Encoder module. In order to improve the learning ability and stability of the model, we add a mask mechanism to the MScore Pool. The node representations of the low-score nodes are replaced by the mask embedding, which together with the node representations of the high-score nodes are used as the input to the Decoder module. Finally, we extract the scores of nodes from the MScore Pool, and the high-score nodes are considered as I-nodes."}, {"title": "2.2 Data and Preprocessing", "content": "We use the HCP 900 dataset39 and randomly select 98 subjects from it. The participants in the HCP 900 dataset consist of healthy adults with ages ranging from 22 to 36 years old. Among the 98 subjects selected, 55 are female and 43 are male. T1-weighted magnetic resonance imaging (MRI) data is used to reconstruct the brain cortical surface, diffusion-weighted MRI (dMRI) is utilized to reconstruct the fiber bundles from white matter, functional MRI (fMRI), including resting state fMRI (rs-fMRI) and task fMRI, shows the functional changes of the brain. Among them, task fMRI contains a total of seven tasks, which are EMOTION, GAMBLING, LANGUAGE, MOTOR, RELATION, SOCIAL, and Working Memory (WM). Briefly, the EMOTION cognition task involves making judgments about facial expressions, including negative (fearful and angry) and"}, {"title": "2.3 Self-supervised Graph Reconstruct Framework based on Graph-Transformer (SSGR-GT Framework)", "content": null}, {"title": "2.3.1 Graph Generation", "content": "We define the brain as an undirected graph $G = {V, E, X}$. $V = {v_i|i \\in 1, 2, ..., N}$represents the set of $N$ nodes of the graph. $X \\in \\mathbb{R}^{N \\times D}$ represents the feature matrix of graph nodes, where $D$ denotes the length of the node feature. $E \\in \\mathbb{R}^{N \\times N}$ represents the adjacency matrix of the graph."}, {"title": "1) Graph Nodes with Generated Features", "content": "The brain surface is divided into 148 ROIs and used as nodes of the graph. fMRI signals are selected to express node features. First, we obtain the fMRI signals of each ROI by averaging the fMRI signals of all vertices within the ROI. Then, the Pearson correlation coefficient of the signals between each pair of ROI is calculated to obtain the functional similarity matrix. The functional similarity matrix is used as the feature matrix of $X$ the graph nodes. The length of each node feature vector $D$ is 148."}, {"title": "2) Graph Edge", "content": "For each pair of ROIs, we calculate the total number of fibers directly connected to them and then divide it by the geometric mean of their areas, thus obtaining the structural connectivity matrix $S$. We set the threshold $t_s$ for $S$ to make it sparse and do the binarization to obtain the adjacency matrix $E$ of the graph. $E_{ij} = 1$ means that nodes $i$ and $j$ are connected, otherwise $E_{ij} = 0$.\nFinally, we obtained 98 \u00d7 8 = 784 brain graphs. 98 represents the number of individuals, and 8 represents eight fMRI data. For different individuals, the adjacency matrices between the brain graphs are different. For the same individual, the adjacency matrices between the brain graphs are the same and the node features are different."}, {"title": "2.3.2 GR-GT Module", "content": "In the GR-GT module, we adopt the Encoder-Decoder structure to implement the graph reconstruction task, as shown in Fig. 2. The Encoder module is applied to extract node representations of the graph, then the MScore Pool is used to obtain the contribution scores of nodes, and finally the Decoder module is used to reconstruct the node features of the graph."}, {"title": "1) Encoder Module", "content": "The Encoder module is applied to extract node representations of the graph, as shown in Fig. 2 (A). And the Encoder module in this paper is based on UGformer46. It combines GCN, which establishes a close relationship between neighbor nodes, and Transformer, which applies a self-attention mechanism to all nodes so that the model can focus on both local and global information. For each layer of the Encoder module, it first adopts the Transformer network and applies the"}, {"title": "2) MScore Pool", "content": "Inspired by the pooling operation of the Graph U-Nets47, we design the MScore Pool to get the contribution score of each node in the graph for the reconstruction task. In the reconstruction task, in order to improve the learning ability of the model, the data is usually processed with noise or mask. Similar to the mask mechanism in MAE48, we add a mask mechanism to MScore Pool. Low-score nodes are masked according to a certain mask ratio, and their node representations are replaced by the mask embedding that indicates the node features to be reconstructed. The mask embedding and the unmasked node representations are used together as inputs to the Decoder. The output of the Encoder module is the graph nodes' representations$Z \\in \\mathbb{R}^{N*d}$, which is used as the input of the MScore Pool. After an MLP layer and softmax, $Z$ is mapped to $p \\in \\mathbb{R}^{N*1}$. $p$is seen as the contribution scores of the graph nodes. According to a certain ratio $k$, the nodes with low scores are masked. That is to use mask embedding, a shared learning vector $q$, to represent masked nodes. And the representations of nodes with high scores is retained. We concatenate the retained nodes and the masked nodes in the original order, and do the element-wise product operation with the score $p$ as the input to the Decoder module. It is calculated as Eq. (6).\n$p = softmax(MLP(Z))$\n$idx = TopK(p, 1 \u2013 k)$\n$Z = cat(Z_{(idx, :)}, q)$\n$Z' = Z \\odot p$"}, {"title": "3) Decoder Module", "content": "The input to the Decoder module is the graph node representations with mask embedding, and the output is reconstructed node features of the original brain graph. The Decoder module has the same architecture as the Encoder module, both of which are based on the UGformer module. Our GR-GT module reconstructs the graph by predicting the node features of the graph, and the loss function is mean square error (MSE) between the feature matrix $Y$ of reconstructed graph nodesand feature matrix $X$ of input graph nodes."}, {"title": "2.4 Ranking ROIs via MScore Pool", "content": "Our goal is to design a self-supervised graph reconstruction model and get the contribution score of each ROI to graph reconstruction. In Section 2.3, we design the MScore Pool to extract the contribution scores of the ROIs. Since the model provides scores of ROIs for each of individual, and what we need is scores of ROI at the group-level, in Section 3.2, we conduct statistical analysis on the scores of all individuals to obtain scores of ROI at the group-level. After getting the group-level scores, we divide the brain ROIs into three different scales according to the score rankings. ROIs in Scale-1, with the higher scores, are considered as I-nodes of brain networks. In the following sections, we will verify the rationality of the selected ROIs through experiments, that is, the ROIs with high scores are the I-nodes."}, {"title": "2.5 Evaluating the Hub Attributes of the High-Score ROIs", "content": "As shown in Section 2.4, we treat Scale-1 ROIs as I-nodes. In Section 3.3 and 3.4, we conduct experiments to see if Scale-1 ROIs are I-nodes in the brain. On the one hand, we analyze the characteristics of the brain functional network and structural"}, {"title": "2.6 Analyzing Foundational Elements for Coordinated Structure and Multi-tasks", "content": "In Section 3.1, we treat the fusion of structure and each kind of brain functional MRI data as a separate experiment, and different experiments obtain different I-nodes. In Section 3.5, we conduct a joint analysis of the I-nodes in all the experiments and hypothesize that some I-nodes and connections remain common across multiple experiments, coordinating the fundamental architecture of the brain with its various functions. These common I-nodes and connections likely support the fundamental integrative capacities that shape higher cognition. Identifying and characterizing these I-nodes and connections that remain coordinated amid changing functions provides key insight into how brain structure and function are linked in a way that maintains stability."}, {"title": "2.7 Evaluating Reproducibility of I-nodes on New Brain Atlas", "content": "This paper proposes a framework to explore the scores of different brain ROIs and to get the I-nodes. Therefore, the stability and repeatability of model results are very important. In Section 3.6, we use the new atlas to verify the stability of the results. Specifically, we use a new partitioned atlas (Atlas_2)51 on the same data set and regenerate the brain graphs for the experiment. The Atlas_2 is based on functional-structural multimodal partitioning, which divides each hemisphere into 180 ROIs (removing the corpus callosum), which is more refined than the partition of Atlas_1 (Destrieux Atlas). The experimental results of the two atlases are compared, and the stability of the experiment is verified by the overlap of I-nodes."}, {"title": "3 EXPERIMENTS AND RESULTS", "content": null}, {"title": "3.1 Experimental Setup and Performance", "content": null}, {"title": "3.1.1 Experimental Setup", "content": "A total of 98 individuals is evaluated by the proposed method. Each of individual has eight brain graphs, which have the same topology corresponding to the structural information and different node features corresponding to eight kinds of functional information. We set up eight sets of experiments, each of which is trained independently. Each set of experiments use one of the brain graphs from 98 individuals, which corresponded to the same kind of functional information. These eight sets of experiments are called Resting State-Structure (RS), EMOTION-Structure (E), GAMBLING-Structure (G), LANGUAGE-Structure (L), MOTOR-Structure (M), RELATION-Structure (R), SOCIAL-Structure (S), and WM-Structure (W). For the Encoder and Decoder modules, we set the number of layers (L) to 1 and the number of heads in self-attention to 4. The model is trained for 200 epochs using the Adam optimizer to update parameters. The mask ratio k of nodes is 0.5."}, {"title": "3.1.2 Model Performance", "content": "Taking the RS experiment as an example, we show the model performance in Fig. 3."}, {"title": "3.2 Distribution of High-Score ROIS", "content": "Through the experiments in Section 3.1, for each of the eight sets of experiments, we obtain the contribution scores of brain ROIs of 98 individuals. According to Section 2.4, we need to obtain group-level scores. Through Pearson correlation analysis of inter-individual scores, we discover that scores of ROIs among individuals are similar for each set of experiment, as shown in Fig. 5 (A). That is, from a statistical point of view, the scores are very similar between individuals. Therefore, we can obtain a"}, {"title": "3.3 High Hub Attributes of I-nodes", "content": "According to Section 2.5, we analyze the significance of reconstructing important nodes in the brain network. In terms of function, we take RS as an example to analyze the participation degree of high-score ROIs in the functional network. We conduct dictionary learning on functional signals of rs-fMRI and divide functional signals of the whole brain into multiple meaningful brain functional networks. And then count the number of brain ROIs in different Scales participating in the brain functional networks, as shown at the top of Fig. 7 (A). It shows that the brain high-score ROIs involve more brain networks than other ROIs, which means that the high-score ROIs have greater functional significance and play a key role in the functional integration of the brain. We list some brain functional networks involved in high-score ROIs, such as visual networks, as shown at the bottom of Fig. 7 (A). In terms of structure, we count the length of fibers passing through all brain ROIs, as Fig. 7 (B). It shows that in all sets of experiments, long fiber connections are more concentrated in the high-score ROIs rather than other ROIs, indicating that the high-scale ROIs occupy central positions in the structural connectivity and are critical for the propagation of information. This is similar to the pattern of connections found in brain hubs in previous studies55.\nWe also verify whether Scale-1 ROIs are important nodes in the brain network through graph theory attributes. First, we need to build brain functional and structural connectivity networks. For functional networks, we average the functional correlation matrix of all individuals under the same experiment, and then take a threshold value to retain 7% edges. For the structural network, we average the structural connectivity matrix of all individuals, and then take a threshold value to retain 7% edges, too. In the end, we have one structural connectivity network and eight functional connectivity networks. The network connections are visualized as a heat map, where ROIs are ranked from lowest to highest score, as shown in Fig. 8.\nThe results in Fig. 8 show that for functional networks (blue), the distribution of connections varies from dense and strong to sparse and weak from top left to bottom right. This indicates that high-score ROIs have strong connections in the network, while low-score ROIs have weak connections in the network. Structural networks (green) have distributed representations similar to functional ones, but not as strong as functional networks. The functional and structural connectivity strength is relatively similar overall, with decreasing strength of connections in the Scale-1, Scale-2, and Scale-3.\nFor the measure of network centrality and efficiency, we calculate the metrics of all ROIs in functional networks (blue) and structural networks (green) respectively, as shown in Fig. 9. We utilize three centrality metrics, namely degree centrality, closeness centrality and PageRank centrality. It shows that the metrics are positively correlated with scores of ROIs. We also analyze the global efficiency of ROIs, which is still positively correlated with scores of ROIs. In the functional network and structural network, high-score ROIs have high node efficiency. Therefore, we consider the Scale-1 ROIs as I-nodes, and the network they form assumes the main information transfer function in the functional and structural network."}, {"title": "3.4 Comparison with Rich-Club", "content": "We compare the obtained brain I-nodes obtained by the proposed method with brain rich-club7. The functional network and structural network of the brain obtained in Section 3.3 are binarized, and then $\\phi(k)$ in different networks are calculated separately7. The selection principle of the rich-club is (1) $\\Phi(k) > 1$ and as high as possible; (2) The number of nodes in the rich-club is close to the number of I-nodes. Thus, we obtained the structure rich-club and eight sets of functional rich-clubs. We calculated the overlap ratio between I-nodes and rich-club, as shown in Fig. 10 (B). For each set of experiments, the three bars from left to right (light, medium, and dark blue) indicate the proportion of structural rich-club, functional rich-club, and structural or functional rich-club in our I-nodes, respectively. The proportion of overlap between the I-nodes and the structural rich-club is smaller than that between the functional rich-club, indicating that although our multimodal approach combines structure and function, it is more influenced by function. This may indicate that the I-nodes of the human brain are more composed of regions that represent brain function.\nThe proportion of structural rich-club or functional rich-club in the I-nodes is between 0.57 and 0.84, indicating that the I-nodes we obtained are partially consistent with rich-club, and reveal some new important brain regions. Taking RS as an example, we visualize the I-nodes and rich-club on the brain surface, as shown in Fig. 10 (A). The frontal (frontal_sup, frontal_middle), parietal (parietal_sup, parietal_inf-Supramar, parietal_inf-Angular), occipital (occipital_sup, occipital_middle), temporal (temporal_middle), and precuneus form the structural rich-club. While some overlap exists between the structural and the functional rich-club, the latter is more concentrated in the occipital (occipito-temporal gyrus) and central ROIs (postcentral gyrus). It is worth noting that the precuneus and frontal ROIs are not in the functional rich-club, and they are also absent from our RS I-nodes (the top 20%, the precuneus (R) ranking 35, 24% in RS I-nodes), perhaps related to the fact that multimodal results are more functionally influenced. Most of our RS I-nodes coincide with resting state functional rich-club, and some new ROIs are revealed, which are mainly concentrated in the parieto-occipital sulcus and central (subcentral) ROIS.\nIn addition, in order to compare the importance of rich-club and I-nodes to the brain network, we removed rich-club and I-nodes respectively, and compared the global properties of the resulting 2-group networks, as shown in Fig. 10 (C) We also added a control group, that is, the network obtained by removing random regions. The three bars in Fig. 10 (C) from left to right (light, medium, and dark green) show the elimination of random regions, rich-club, and I-nodes, respectively. Compared with the random regions, the elimination of rich-club and I-nodes results in lower clustering coefficients and higher characteristic path lengths. This suggests that the elimination of rich-club and I-nodes has more serious damage to the brain network. For the elimination of rich-club and I-nodes respectively, the elimination of rich-club shows low clustering coefficient and characteristic feature path length, while the elimination of I-nodes shows high clustering coefficient and high characteristic path length. This shows that the two have different effects on the brain network. rich-club may favor the local features of the network, while I-nodes may favor the global features of the network."}, {"title": "3.5 The Foundational Elements Coordinated Structure and Multi-tasks", "content": "As shown in Section 3.2, there is a certain overlap among the Scale-1 ROIs in the eight sets of experiments. We list the specific ROIs of Scale-1 of all experiments, which involved 56 ROIs in total, as shown in supplementary Fig. 2. We visualize some of these ROIs of the brain, as shown in Fig. 11. Blue represents the ROIs where all experiments are activated, purple represents the ROIs where seven sets of experiments are activated. It can be observed that the superior frontal, central sulcus, superior parietal, and middle occipital are activated in most sets of experiments, indicating that they play a very important role in both the rs-fMRI and task fMRI. In addition, we also calculate the Intersection over Union (IoU) of Scale-1 in different experiments, as shown in Fig. 11 (A). The value between E and G is the highest, indicating that the functional activation of the two tasks is similar.\nBased on the 56 ROIs that included Scale-1 ROIs of all experiments, we obtain common connections for the structure and multi-functions, as shown in Fig. 11 (C). Specifically, the functional connections of each task in the common ROIs are counted first, then the connections that occur more than 5 times in all tasks are counted, and finally, the intersection of the structural connections is taken. It shows that these connections are more evenly distributed throughout the brain, rather than being concentrated in some particular regions. It can be concluded from Fig. 11 (D) that the intra-occipital and intra-central connections are the most numerous, while the frontal and parietal connections are more evenly distributed. This indicates that the occipital region plays an important role in the common connections. The I-nodes we have identified are useful for exploring important regions that coordinate brain structure and various functions, providing new insights into how brain structure and function are linked together.\nIn addition, we analyze the implications of the I-nodes in terms of cognitive neuroscience. The I-nodes are decoded by meta-analysis and the terms related to mental function are obtained. As shown in Fig. 11 (B), both blue and purple ROIs exist in most of experiments, which called Common nodes. In each group of experiments, the I-nodes outside the Common nodes are called Special nodes. The Special nodes corresponding to experiment RS, E, G, L, M, R, S and W are called as Spe_RS, Spe_E,"}, {"title": "3.6 Stability of I-nodes on New Brain Atlas", "content": "In order to verify the stability of our proposed model, we use a new atlas on the original data set for experiments. As same as Atlas_1, we still select the top 20% ROIs with high scores as Scale-1, as shown in Fig. 12. Overall, the Scale-1 ROIs for Atlas_1 and Atlas_2 are similar. For example, Scale-1 ROIs for Atlas_2 are also concentrated in the central gyrus, superior parietal, and"}, {"title": "4 DISCUSSION AND CONCLUSION", "content": "We propose a self-supervised graph reconstruct framework based on Graph-Transformer to identify I-nodes by fusing multimodal neuroimaging data. It includes: (1) Through self-supervised modeling, the regions that contribute the most to reconstructing the brain graph are considered influential; (2) The model established on the Graph-Transformer can extract features well from the brain graph by combining local and global connectivity information; and (3) Fusing graph-based brain structure and function"}]}