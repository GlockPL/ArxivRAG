{"title": "MRI Radiomics for IDH Genotype\nPrediction in Glioblastoma Diagnosis", "authors": ["Stanislav Koz\u00e1k"], "abstract": "Radiomics is a relatively new field which utilises\nautomatically identified features from radiological scans. It has\nfound a widespread application, particularly in oncology because\nmany of the important oncological biomarkers are not visible to\nthe naked eye. The recent advent of big data, including in medical\nimaging, and the development of new ML techniques brought the\npossibility of faster and more accurate oncological diagnosis. Fur-\nthermore, standardised mathematical feature extraction based on\nradiomics helps to eliminate possible radiologist bias.\nThis paper reviews the recent development in the oncological\nuse of MRI radiomic features. It focuses on the identification of\nthe isocitrate dehydrogenase (IDH) mutation status, which is an\nimportant biomarker for the diagnosis of glioblastoma and grade\nIV astrocytoma.", "sections": [{"title": "I. INTRODUCTION", "content": "Glioblastoma is the most common and aggressive type of\nprimary brain tumour (grade IV glioma), presumably arising\nfrom neural progenitor cells. Its appearance and internal\ngenotype are highly heterogeneous, so that biopsies taken\nfrom different parts of the tumour can be very different. [2]\nNon-invasive diagnosis of glioblastoma through conventional\nradiological methods can therefore be very difficult.\nGlioblastoma stem cells are prone to epithelial-\nmesenchymal transition, making them more flexible and\ninvasive. It also contains non-malignant cells that are\nimmunosuppressive and create a supporting microenvironment\nfor the tumour growth [2]. These factors make the treatment\nvery challenging, resulting in a median patient survival of\nless than 2 years. Recent improvements in treatment, which\ncan include surgery, radiotherapy, chemotherapy and targeted\ntherapy, have improved short-term survival. However, 5-year\nsurvival has remained relatively constant at 5.8%, due to the\nrecurrent nature of glioblastoma in most cases. As the causes\nare not yet well understood, there is no known way to prevent\nit [3]."}, {"title": "A. Genotype Alterations in Grade IV Gliomas", "content": "Grade IV gliomas can undergo different mutations and\nmolecular alterations. In about 60% of cases, mutations of the\nepidermal growth factor receptor (EGFR) have been identified,\nleading to a more aggressive tumour behaviour. Another\nimportant predictor of patient survival is the methylation\nstatus of 06-methylguanine DNA methyltransferase (MGMT).\nMethylation inhibits the production of this enzyme and slows\ndown its DNA repair function. This may lead to a better\nprognosis and response to alkylating chemotherapy (usually\ndone with temozolomide). [2, 3]"}, {"title": "B. IDH Mutation", "content": "Isocitrate dehydrogenase (IDH) mutation on the chromo-\nsome 2 is one of the most important biomarkers of high-grade\nglioma as it significantly changes the tumour behaviour and\ntherefore affects the survival prediction. [3]\nA reliable method for predicting the mutation status of\nIDH is crucial for differentiating glioblastoma from grade\nIV astrocytoma and for subsequent treatment planning. [4]\nIDH-wildtype (glioblastoma) is the more common and more\naggressive variant, occuring predominantly in older population\n(median age 62 years). It develops mostly de novo, without\nany identifiable precursor lesion [3]. It is more prone to EGFR\namplification (making the tumour more aggressive), but also\nto MGMT promoter methylation (leading to a more favourable\nprognosis). Subsequently, astrocytoma with IDH1 or IDH2\nmutation (affecting between 5 to 13% patients [5]) has overall\na better prognosis and is more common in younger patients.\n[3]\nCurrently, the mutation status is usually determined by\nimmunohistochemical staining with the R132H mutant IDH\nantibody based on tumour resection or biopsy. Non-invasive\ndiagnosis methods based on MRI sequences continue to be\nexplored as demonstrated in the following sections. [6]"}, {"title": "II. MRI RADIOMICS WORKFLOW", "content": "In this section, the commonly used radiomic pipeline for\nfeature extraction from MRI images is introduced. This includes specific examples of radiomic features\nwhich are the essential components of the pipeline."}, {"title": "A. Image Acquisition", "content": "Although image acquisition itself is not a direct part of the\nradiomics pipeline, it has a major impact on the quality of\nthe input data. The starting point is the output of magnetic\nresonance imaging (MRI). The images are produced by an\nMRI scanner emitting and measuring magnetic fields. MRI\ntakes longer than computed tomography (CT) or positron\nemission tomography (PET) and is usually more expensive, but\nit does not require patients to be exposed to ionising radiation"}, {"title": "B. Image Segmentation", "content": "Segmentation is the process of delineating the region of\ninterest (ROI) or volume of interest (VOI) from 2D or 3D\nimages. This can be done manually, semi-automatically or\nautomatically. Manual segmentation is the most commonly\nused method, but it can be time consuming, resource intensive\nand it can subject to observer bias. Semi-automatic methods\ninlude computer algorithms (e.g. region growing, tresholding)\nwhose results are manually corrected. [1]\nAutomatic image segmentation uses deep learning models,\nmostly based on the U-Net or nnU-Net architecture (for\nexample HD-GLIO). This approach is faster and does not\nneed expert supervision but it needs large datasets for training.\nThe path of fully automatic segmentation seems promising but\nits generalisability to different datasets is still under intensive\nresearch. [1]"}, {"title": "C. Image Pre-processing", "content": "Through image pre-processing, segmented images are ho-\nmogenised to provide input for feature extraction that is\nconsistent in its characteristics. General image pre-processing\nincludes the following procedures:\n\u2022 interpolation to isotropic voxel spacing (resampling)\nensures the same voxel size for each sequence in the three\ndimensions. Because MRI yields multiple outputs, one\nsequence is often used as a reference scale for the rest.\n\u2022 intensity outlier filtering \u2013 filters out grey values outside\nof a predefined range.\n\u2022 discretisation \u2013 the scale of image intensities is divided\ninto bins to reduce the number of possible values. [1]\nFor MRI, image pre-processing also includes skull stripping\n(brain extraction) to remove non-brain tissue which is not"}, {"title": "D. Feature Extraction", "content": "Feature extraction uses various mathematical calculations\nand algorithms to quantitatively analyse the greyscale images.\nPyRadiomics divides extracted features into following cate-\ngories: [8]\n\u2022 first order (histogram based) statistics describe the inten-\nsity distribution, for example through mean, percentiles,\nentropy or skewness. Entropy is calculated by the formula\nshown in equation 1, with Ng being the number of non-\nzero intensity bins, p(i) the normalized histogram of\nintensities and e an arbitrary small number:\n\u2022\n\\[\n  entropy = \\sum_{i=1}^{N_g} p(i) * log_2(p(i) + \\epsilon)\n\\]\n\u2022 3D shape features are morphology descriptors, indepen-\ndent on the grey level intensities, computed only from\na derived 3D mesh. (compactness, sphericity or surface\narea to volume ratio).\n\u2022 2D shape features are derived from a circumference mesh\n(perimeter, surface, elongation).\nFurthermore, PyRadiomics uses following helping matrices\nto extract texture-based features: [8]\n\u2022 grey level co-occurrence matrix (GLCM) quantifies, how\noften each combination of grey values appears together\n(within a specified distance and angle).\nGLCM is by default symmetrical and can be used to\nderive contrast, autocorrelation, joint average, difference\nentropy, etc. Contrast is computed by the formula 2,\niterating over the normalised GLCM entries p(i,j) for\neach grey level combination (i and j). The contrast is\nlow, when the highest values of the GLCM are close to\nthe main diagonal (i and j are similar):\n\\[\n  contrast = \\sum_{i=1}^{N_g} \\sum_{j=1}^{N_g} (i \u2013 j)^2 * p(i, j)\n\\]\n\u2022 grey level dependence matrix (GLDM) counts for each\ngrey value, how often it appears with a given number of\nsimilar or equal neighbours. It is therefore used to identify\nclusters of similar intensities.\nGLDM can be used to calculate grey level variance,\nhigh and low grey level emphasis, etc. Small and large\ndependence emphasis (SDE and LDE) are calculated by\nequations 3 and 4, respectively. Here, Na is the number of\nneighbours and p(i, j) is the normalised GLDM matrix.\nSDE is small if the image has small clusters (high values"}, {"title": null, "content": "on the left side of the GLCM, with low number of neigh-bours j) and therefore low homogeneity. Conversely,LDE identifies large clusters and high homogeneity.\n\\[\n  SDE = \\sum_{i=1}^{N_g} \\sum_{j=1}^{N_d} \\frac{p(i, j)}{j^2}\n\\]\n\\[\n  LDE = \\sum_{i=1}^{N_g} \\sum_{j=1}^{N_d} p(i, j) * j^2\n\\]\n\u2022 grey level size zone matrix (GLSZM) quantifying zone\nsizes of voxels with the same grey values (directionally\nindependent).\n\u2022 grey level run length matrix (GLRLM) describing length\nof equal consecutive pixels along a given angle.\n\u2022 neighbouring gray tone difference matrix (NGTDM) rep-resents the differences between grey value of a pixel and\nits neighbours withing a given distance.\nFurther categories, such as model-based (e.g. texture reg-ularity analysis using autoregressive models) or transform-based (e.g. obtained by discrete Haar wavelet transform) arealso sometimes referenced. [9]\nTo address the lack of reproducibility and validation offeature extraction methods in radiomic studies, the ImageBiomarker Standardization Initiative (IBSI) has publishedguidelines and definitions for the acquisition of radiomicbiomarkers [10]. PyRadiomics also follows those guidelines."}, {"title": "E. Feature Selection and Dimension Reduction", "content": "Feature selection follows directly after feature extraction, as\nthis can produce from hundred to several thousands of different\nfeatures for each patient. The excessive amount of training\nfeatures contains noise and can lead to overfitting of the\nclassification model if not enough data points are available. If\nknown, the non-reproducible features (with high intra- or inter-\nobserver variability) should be excluded. The importance of\nthe remaining features can be evaluated by multiple methods.\nThe correlation between features can be calculated to iden-\ntify and remove highly correlated features. Using statistical\ntests, the distribution of a given feature is analysed for each\nclass to eliminate features that are similar in all classes.\nLeast Absolute Shrinkage and Selection Operator (LASSO)\ncan also be trained on normalised input features to predict\nthe target class. It uses L1 regularisation to penalise large\ncoefficient values, which also reduces overfitting. After fitting\nthe model, the features with the largest respective coefficients\n(in absolute terms) are selected as they contribute the most to\nthe selection.\nRecursive feature elimination with cross-validation\n(RFECV) also identifies the important features by performing\nthe classification itself and iteratively discarding features\nwhich do not significantly improve the accuracy.\nIn traditional ML research, dimension reduction (e.g.\nthrough linear discriminant analysis, principal component\nanalysis or t-SNE) is also utilised. But because it combines"}, {"title": "F. Classification Models", "content": "Classification or regression can be performed after the\nprevious steps have been completed. Common classification\ntasks using radiomic features are prediction of the survival rate\nand treatment response or risk assessment, presence or stage of\na particular tumour type or prediction of the tumour recurrence\ntime. Several machine learning model types are widely used,\nincluding support vector machines, random forests, logistic\nregression or neural networks. Deep neural networks can only\nbe used when larger datasets are available."}, {"title": "III. METHODOLOGY", "content": "This section provides a detailed review of the radiomic\nprocesses presented by three recent studies that focused on\npredicting IDH mutation status through radiomics from MRI\nsequences. Due to hypothesised associations between glioblas-\ntoma genotypes, the studies trained models to predict several\ndifferent genetic biomarkers. These studies were selected\nin particular because they used different approaches to the\nprediction task while achieving comparable results. They all\nutilised Scikit-learn for the data preparation and prediction\ntask, which is a standard Python library for traditional machine\nlearning.\nIn 2020, Calabrese et al. used a radiomic approach to\npredict nine different genetic biomarkers in patients with\nglioblastoma. From a total cohort size of 199, 195 patients\nwere tested for the presence of IDH mutation and 190 on the\nMGMT promoter methylation. [5]\nA similar study was performed by Sohn et al. in 2021.\nThis study focused solely on predicting EGFR, IDH mutation,\nMGMT methylation and ATRX loss status based on a cohort\nof 418 patients. [4]\nFinally, Cui et al. investigated in 2023 predictive models for\nIDH mutation, histological phenotype (differentiation between\nlow-grade and high-grade glioma) and Ki-67 expression level\nwith a contrast analysis. The dataset used included 150 patients\nwith glioblastoma and other types of glioma. [6]"}, {"title": "A. Image Acquisition", "content": "Most of the preoperative MRI scans were performed on\npatients diagnosed between 2015 and 2020. All three research\ngroups used only patient cohorts from their respective medical\ninstitutions, based on the 2016 WHO classification. Therefore,\nthe datasets are rather small and may possibly lead to model\noverfitting."}, {"title": "B. Image Segmentation", "content": "The group of Cui et al. chose the traditional method of\nmanual tumour segmentation. Two radiologists, blinded to the\nhistological and immunohistochemical results, performed the\nsegmentation using 3D-slicer. Each 2D slice from the T2WI\nsequence was segmented and then assembled to reconstruct a\n3D model. [6]\nThe other two research groups performed automatic tumour\nsegmentation using pre-trained deep convolutional neural net-\nworks in order to automate the entire pipeline. Segmentation\nwas carried out using 2D T1WI (pre and post-contrast), T2WI\nand T2WI/FLAIR sequences. The segmentation results were\nthen manually examined but not corrected. [5, 4]\nSohn et al. used the HD-GLIO algorithm, which separates\ncontrast-enhancing tumour from non-enhancing T2/FLAIR\nsignal abnormalities. The model used by Calabrese et al. con-\nsisted of three binary sub-models and segmented the images\ninto enhancing tumour, non-enhancing tumour, surrounding\ntumour-related edema and background. They used Adam op-\ntimiser with learning rate decay and binary softmax cross-\nentropy loss for the training. [5, 4]"}, {"title": "C. Image Pre-processing Techniques", "content": "After segmentation, brain extraction was performed, for\nexample with BET (Brain Extraction Tool) from the FMRIB\nSoftware Library (FSL) [6]. To ensure the same dimension of\neach sequence, the resulting images were co-registered (based\non T1C or T2WI sequences) and resampled to isotropic voxel\nspacing (with 1x1x1 mm voxel size).\nN4 bias correction with advanced normalisation tool was\nthen applied to remove low frequency intensities caused by\nmagnetic field inhomogeneity. Finally, the image intensities\nacross all sequences were normalised (with \u03bc = 0 and \u03c3\u00b2 =\n1). [4]\nCalabrese et al. computed four additional diffusivity maps\nfrom the HARDI data: mean, axial and radial diffusivity, and\nfractional anisotropy, giving a total of 11 inputs for the feature\nextraction.\nCui et al. applied 14 filters and transformations supported\nby PyRadiomics to derive wavelet-filtered, Gaussian-filtered,\netc. images."}, {"title": "D. Feature Extraction", "content": "All studies used PyRadiomics to extract radiomic features\nfrom the segmented and normalised sequences. The respective\nnumber of features in each study is listed in table II. The\n2D and 3D shape features were extracted independent of the\nsequences. First order and higher order features were extracted\neither for each sequence [4], each combination of sequence and\nfilter [6] or for each combination of sequence and segmented\nregion (whole tumour, tumour core, 3 tumour compartments;\n5]). This resulted in very different output sizes (660 for Sohn\net al., 5300 for Calabrese et al., 6580 for Cui et al.).\nCalabrese et al. extracted all the features provided by the\nPyRadiomics library. The filtering criteria for shape and first-order features by Cui et al. and Sohn et al. is unknown. Thislack of transparency is unfortunate as it makes the results moredifficult to reproduce."}, {"title": "E. Feature Selection", "content": "Sohn et al. and Cui et al. used LASSO regression to discard\nfeatures with a low predictive value.\nCui et al. also performed Mann-Whitney U test for each\nclass, selecting only input features whose distributions varied.\nThey then calculated the Pearson correlation coefficient be-tween the remaining features and removed highly correlatedfeatures.\nCalabrese et al. and Cui et al. used RFECV to select thefinal features. In each iteration step, RFECV trained a simpleclassification model to quantify their importance. The leastimportant features were then removed and the process wasrepeated several times for different dataset splits to avoidoverfitting."}, {"title": "F. Classification Models", "content": "The low natural prevalence of the IDH mutation makes the\ndata set unbalanced. To prevent the model from underper-forming on the minority class, Calabrese et al. used 10-foldstratified cross validation (with 60/40 train-test split), whichensures the same class distribution in each set. Cui et al.trained the classifier for the data set with all gliomas whichwas not imbalanced (40.8% patients with IDH mutation). Theyused repeated k-fold cross validation (80/20 split repeated 30times).\nAnother method is synthetic data generation which was usedby Sohn et al. They run the Multi-Label SMOTE algorithm togenerate new data points of minority classes while maintainingthe associations between the labels. They used a 70/30 ratiofor the train test split. [4]\nThere are two main approaches to multi-label classification:binary relevance (BR) and classifier chain (CC). BR usesseparate independent binary classifiers trained on each label."}, {"title": null, "content": "In CC, each label is also predicted by a binary model, but\nit can use the result of previous labels and therefore takes\ninto account the correlation between different labels. When\nthe optimal order of classification is not known, an ensemble\nclassifier chain (ECC) can be used, which iterates over chains\nwith different classifier orders. Calabrese et al. and Cui et\nal. chose the binary relevance approach, while Sohn et al.\ncompared both approaches. [4]\nThe choice of model and loss function can have a significant\nimpact on the training time and on the accuracy. Linear models\nare usually faster to train but they learn less representative\ndecision boundary than non-linear models.\nCalabrese et al. treated each label prediction as a binary re-\ngression task, predicting the probabilities for both the negative\nand positive class. They used a random forest regressor and\nrandomised search for hyperparameter tuning. [5]\nSohn et al. used a linear kernel support vector machine\ntrained by SGD with manual hyperparameter tuning. They also\ntried out 10 different classifier orders for the ECC approach,\nevaluated by the mean absolute Shapley values. The optimal\nclassifier order found was IDH-ATRX-MGMT-EGFR.\nCui et al. built independent classifiers for each MRI se-\nquence. They applied support vector machines and logistic\nregression with 9 different loss functions, including hinge, log-\narithmic, Huber or epsilon insensitive. They also tried L1 and\nL2-regularisation and their combination (Elastic Net). Based\non the results of the single sequence classification, they built\nfinal classifiers combining T1C and ADC sequences because\nthose two sequences reached the most accurate predictions. [6]"}, {"title": "IV. EVALUATION AND DISCUSSION", "content": "In this chapter, a comparison and discussion of the results\nand conclusions of the three studies under review will be pre-sented. This includes a comparison of the model performance,\nthe optimal radiomic features found, and the associations\nbetween the biomarkers themselves.\nThe following sections conclude the paper by describing\nthe potential and limitations of predicting IDH mutation status\nbased on radiomic features in clinical practice."}, {"title": "A. Result Comparison", "content": "Table III compares the results obtained by the final classifi-cation and regression models for the IDH mutation prediction.It is important to note that Cui et al. predicted the IDHmutation status for all gliomas, not just grade IV. Based on theROC curve, they probably also considered IDH-wild-type as apositive class, unlike the other studies. This discrepancy maybe due to the fact that the positive class usually indicates morerare and dangerous cases at the same time. In other words, Cuiet al. chose the more dangerous class as positive, whereasthe other studies chose the more rare class as positive. To makeit easier to compare the results between studies, the metricsthan AUC is more useful if one wants to differentiate, but it is less accurate.Using the IDH mutation as a positive class were also included(shown in brackets).\nThe high recall values indicate the ability of the model todetect most cases of IDH mutation (minimising false negativesand the type II error). This is offset by more false positives andtherefore lower precision (and higher type I error). Optimisingfor recall (type II error) is helpful for the clinical practicebecause it avoids higher costs and exposing patients to riskiertreatment, as the diagnosis is rarely overestimated. However,it results in more cases being underestimated.\nLabelling the minority class as positive also validates theusage of precision, recall and their harmonic mean (F1-Score)as metrics. However, MCC and AUC are often more preferablemetrics for imbalanced data sets as they are symmetric underclass labelling.\nVery good predictive performance for distinguishingglioblastoma from IDH-mutated astrocytoma was achieved byCalabrese et al. (MCC 0.62). Cui et al. achieved an even betterperformance (MCC 0.68) for classifying IDH mutation andIDH wild-type, but this could be caused by including lowergrade gliomas in the data set. [5, 6]"}, {"title": "B. Found Features and Biomarker Associations", "content": "Surprisingly, the features with the highest predictive valuediffered significantly between the three studies. There waslittle to no overlap in the imaging sequences (except for T1C),\nsegmented regions (tumour core, contrast enhancing tumour,etc.) or the feature groups (first order, shape features, etc.) inthe top selected features.\nFeatures extracted from T1C sequences were among themost efficient. Calabrese et al. identified variance on the wholetumour segmented region, Sohn et al. identified coarseness(NGTDM feature), surface area to volume ratio (shape fea-ture) and maximum correlation coefficient (GLCM feature)on contrast-enhancing segmented regions as important. Cui etal. did not rank the features by the predictive performance,\nbut only listed the 21 features selected for the final classifier.They identified several first-order features and features fromGLRLM, GLSZM or GLCM on logarithmic or wavelet-filteredimages from both T1C and ADC sequences.\nFor Calabrese et al, diffusivity metrics had also a highpredictive value. One of those was high grey level emphasis,\na feature based on GLDM that quantifies the diffusivity of\nthe non-enhancing tumour produced by the DWI sequence.Another was the kurtosis of tumour-related edema from the\nmean diffusivity mask.\nThe optimal classifier order found by Sohn et al. highlightsa significant effect of IDH prediction on ATRX and MGMT"}, {"title": "C. Potential and Limitations of Radiomics for IDH Genotype\nPrediction", "content": "The presented radiomic approach may contribute to a non-invasive and faster diagnosis when differentiation between\nglioblastoma and IDH-mutated astrocytoma is required forfurther treatment planning. The development of a highlyaccurate classification model could validate or replace biopsyor radiologist diagnosis.\nFurther research is needed to address several issues. Mostimportantly, the procedures and techniques used in the ra-diomic pipeline should be standardised and consistently docu-mented. The efforts of the IBSI to standardise feature extrac-tion have been effective as there were only small differencesbetween the reviewed studies in the extracted features (all haveused standard features by PyRadiomics).\nThe second issue is the generalisability of the classificationmodel. Larger datasets with different patient demographics,\nhealth conditions and scanner types are needed to developa reliable classifier. Furthermore, IDH2 mutation could beincluded as it is also a indicator of grade IV astrocytoma (albeitwith a lower prevalence).\nThis also raises the question of the overall suitability ofthe radiomic approach. When larger datasets are available, thetraditional machine learning classifiers could be replaced bya deep learning network. The whole pipeline could also bereplaced by an end-to-end framework, for example using aconvolutinal neural network for classification. In this case,\nthe interpretability of the model's diagnosis would suffer.However, as has been shown, the optimal radiomics featuresfound also convey characteristics that are not visible to humansand they vary significantly between studies, so there is nounlimate feature combination that could unambiguously solvethe classification task while being fully interpretable."}]}