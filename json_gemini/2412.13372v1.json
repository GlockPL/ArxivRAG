{"title": "Sum-of-Squares Programming for Ma-Trudinger-Wang Regularity of Optimal Transport Maps", "authors": ["Sachin Shivakumar", "Georgiy A. Bondar", "Gabriel Khan", "Abhishek Halder"], "abstract": "For a given ground cost, approximating the Monge optimal transport map that pushes forward a given probability measure onto another has become a staple in several modern machine learning algorithms. The fourth-order Ma-Trudinger-Wang (MTW) tensor associated with this ground cost function provides a notion of curvature in optimal transport. The non-negativity of this tensor plays a crucial role for establishing continuity for the Monge optimal transport map. It is, however, generally difficult to analytically verify this condition for any given ground cost. To expand the class of cost functions for which MTW non-negativity can be verified, we propose a provably correct computational approach which provides certificates of non-negativity for the MTW tensor using Sum-of-Squares (SOS) programming. We further show that our SOS technique can also be used to compute an inner approximation of the region where MTW non-negativity holds. We apply our proposed SOS programming method to several practical ground cost functions to approximate the regions of regularity of their corresponding optimal transport maps.", "sections": [{"title": "Introduction", "content": "Optimal transport (OT) (Villani, 2021, 2009; Santambrogio, 2015), originally considered by Gaspard Monge in 1781 (Monge, 1781), has become a key tool in modern machine learning with applications in generative modeling (Montavon et al., 2016; Bousquet et al., 2017; Balaji et al., 2020; Rout et al., 2021; Lipman et al., 2022; Houdard et al., 2023), adversarial training (Sanjabi et al., 2018; Bhagoji et al., 2019), control (Chen et al., 2016b, 2021; Teter et al., 2024), and data science (Peyr\u00e9 et al., 2019; Flamary et al., 2021). In many applications, it is of interest (Seguy et al., 2018; Makkuva et al., 2020; Bunne et al., 2022; Pooladian et al., 2023; Manole et al., 2024) to numerically approximate the Monge OT map \u05d3 : X \u2192 Y where X, Y \u2286 M, and M is a smooth, compact, connected n-dimensional manifold.\n\nThe Monge OT formulation is as follows: given two probability measures \u03bc,\u03bd supported on X and Y, respectively, let c : X \u00d7 Y \u2192 R>0 be a C4 smooth function that encodes the cost of transporting unit amount of mass from x \u2208 X to y \u2208 Y. The function c is referred to as the ground cost. The problem seeks to find the Borel map Topt, referred to as the Monge OT map, which minimizes the total transportation cost, namely the functional fx c(x, \u03c4(x))du(x), subject to the constraint that for all Borel sets U \u2286 Y, \u03bc (\u03c4\u00af\u00b9(U)) = v(U), or equivalently that the pushforward \u03c4#\u03bc = \u03bd. So,\n\n\nTopt = arg inf fx c(x, \u03c4(x))d\u03bc(x)\n\u03c4:\u03a7\u2192\u03a5\nsubject to \u03c4#\u03bc = \u03bd.\n\nFor a general class of costs and measures, the existence-uniqueness of the Monge OT map Topt was estab-lished by (Brenier, 1991) and (Gangbo & McCann, 1996). Building on these results, it is natural to study the"}, {"title": "Notations and Background", "content": "Notations. A summary of notations is listed in Table 1. Except in the case of ground cost functions c(x, y), we use the subscripts to denote components. For example, xi denotes the ith component of the vector x, and [F]i,j denotes the (i, j)th component of the matrix F.\n\nIn the case of cost functions, subscripts such as cij,kl(x, y) denote the corresponding partial derivative: \n\u22024\n\u2202xi\u2202xj\u2202yk\u2202l c(x, y). In this case, the comma in the subscript ij, kl, is used to separate indices corresponding to components of variable x and components of variable y. The superscripts such as ci (x, y) stand for (i, j)th element of the inverse of the mixed-Hessian of c, i.e., c\u00b2\u00b4i (x, y) = [H(x, y)]i,j where\n\nH := ((\u2207x\u2207y)c)-1."}, {"title": "2.1 The regularity problem of optimal transport", "content": "Kantorovich (1942) proved the existence of solution for a broad class of OT problems where the optimal trans-port plan is given by a coupling of the measures \u03bc and v. This relaxation is known as the Kantorovich problem of OT. However, the existence theory for the Monge OT problem is considerably more subtle. The condi-tions for existence and \u00b5-a.e. uniqueness of the Monge OT map Topt were established by Brenier (1991) for c(x, y) = ||x-y||3 in Euclidean space, and by Gangbo & McCann (1996) for more general ground costs c(x, y). Roughly speaking, these results state that if the ground cost e is sufficiently smooth and non-degenerate, and the measures \u03bc, \u03bd are sufficiently regular (for instance, compactly supported and Lebesgue absolutely continuous), then the solution to the Kantorovich problem will also be a solution to the Monge problem. Furthermore, the measurable mapping Topt is then the c-subdifferential of a potential function $, which is the weak solution of the Jacobian equation\n\ndet (\u2207\u00b2 \u2013 A(x, \u2207\u00a2)) = f(x, \u00a2, \u2207\u00a2), \u03a7 \u0395 \u03a7.\n\nHere, A is a matrix-valued function derived from the ground cost c, and f is a positive function which depends on c, \u03bc, and v. Since this equation involves the determinant of the Hessian \u22072, it is a Monge-Amp\u00e9re-type partial differential equation (Benamou et al., 2014)."}, {"title": "2.2 Sum-of-Squares programming", "content": "Our proposed computational framework for solving the forward and inverse problems related to OT regularity, are built on SOS programming ideas outlined below. We refer the readers to Appendix A for additional details and examples. In Sec. 3, we will apply these ideas to a ground cost c for which S, as defined in Def. 1, is a rational function in variables (x, y, \u03b7,\u03be) \u2208 X \u00d7 Y \u00d7 TX \u00d7 TY.\n\nSOS programming is a special class of polynomial optimization problems. Generic polynomial optimiza-tion problems take the form\n\nmin f(x)\nxERn\nsubject to x \u2208 C := {x \u2208 R\u2033 | g\u00bf(x) \u2264 0 \u2200 i \u2208 [ng]},\n\nwhere f and gi are given multivariate polynomials in vector variable x. Problems of the form (6), in general, are computationally intractable because verifying the non-negativity of a multivariate polynomial is NP-hard (Parrilo, 2003, page 4, Ch. 1). The set C is semialgebraic, as defined next.\n\nDefinition 4 (Semialgebraic set). (Bochnak et al., 2013, Ch. 2) A set of the form\n\n{x \u2208 Rn | g(x) \u2264 0, g \u2208 Rdg[x], dg \u2208 N}\n\nis called basic semialgebraic. A semialgebraic set is defined as the finite union of basic semialgebraic sets."}, {"title": "3 Problem Formulation", "content": "We now apply the SOS programming discussed in Sec. 2.2 to the following two problems.\n\nForward problem. Given c, X, Y as per Assumption A1 in Sec. 1, verify if the ground cost c : X \u00d7 Y \u2192 R\u22650 satisfies either MTW(0) or MTW(\u043a) (Definition 2) or NNCC (Definition 3) condition.\n\nInverse problem. Given c, X, Y as per Assumption A1 in Sec. 1, find semialgebraic U \u00d7 V \u2264 X \u00d7 Y such that the ground cost c : U \u00d7 V \u2192 R>0 satisfies either MTW(0) or MTW(\u03ba) (Definition 2) or NNCC (Definition 3) condition.\n\nThe SOS formulations for the aforesaid problems detailed next rely on F in (4)-(5), and hence S, being rational function in (x, y) \u2208 X \u00d7 Y. For this to hold, the ground cost e being rational as in Assumption A1 is sufficient (see Proposition 14 in Appendix B) but not necessary. Indeed, Examples 2 and 4 in Sec. 4 consider non-rational ground cost e for which the proposed SOS method can still be used."}, {"title": "3.1 Forward problem", "content": "Per Assumption A1, let the X \u00d7 Y be as follows for some dm, l \u2208 N.\n\nX \u00d7 Y = {(x, y) \u2208 R\u2033 \u00d7 Rn | mi(x,y) \u2264 0, mi(x, y) \u2208 Rdm[x, y] Vi \u2208 [l]}.\n\nThen, the optimization formulation of the NNCC condition (Definition 3) on the semialgebraic set X \u00d7 Y, can be written as a feasibility problem:\n\nmin\n0\nsubject to S(x,y) (\u03be, \u03b7) \u2265 0, \u2200(x, y) \u2208 X \u00d7 Y, \u00a7 \u2208 \u03a4\u03a7, \u03b7 \u2208 TY.\n\nIf (11) has a solution, then the NNCC condition is satisfied for all (x, y) \u2208 X \u00d7 \u0423.\n\nTo verify the MTW(K) condition (Definition 2) for some \u043a \u2265 0, we need an additional constraint on the pair (\u03be, \u03b7), namely \u03b7(\u03be) = 0. The resulting formulation is\n\nmin 0\nsubject to S(x,y) (\u03be, \u03b7) \u2265 \u03ba||\u00a7||2||\u03b7||2, \u2200(x, y) \u2208 X \u00d7 Y, \u00a7 \u2208 \u03a4\u03a7, \u03b7 \u2208 Ty such that \u03b7(\u03be) 0.\n\nVerifying the MTW(0) condition is then the special case (\u043a = 0) of (12).\n\nIf F in (4)-(5) is a rational function, i.e., F = F = \u2208 RN,D[x, y], then problems (11)-(12) are of the form (7). In particular, the NNCC feasibility problem (11) can be tightened to an SOS program as follows.\n\nTheorem 5 (NNCC forward problem). Given the semialgebraic set (10) with a ground cost function c:X\u00d7 Y \u2192 R>0, let F in (5) be of the form F = \u2208 RN,D[x, y], N, D \u2208 N. If there exist S0, S1, ..., se \u2208 \u2211[x, y] such that\n\n(FNN(x,y) + FD(x,y)) - so(x, y) FFD(x, y) + \u2211 si(x, y)mi(x, y) \u2208 \u2211[x, y],\n\ni\u2208 [l]\n\nthen c satisfies the NNCC condition on X \u00d7 \u0423.\n\nProof. Suppose such si exist. Then, we have that FNN(x, y) + F(x, y) \u2265 0 for all x, y such that FD(x, y) \u2265 0, mi(x, y) \u2264 0. Thus, F = FNN/FD is non-negative on X \u00d7 Y and hence, the ground cost e satisfies the NNCC condition.\n\nA modified version of Theorem 5 can be used to verify the MTW(\u043a) condition for \u043a \u2265 0.\n\nTheorem 6 (MTW(k) forward problem). Given the semialgebraic set (10) with a ground cost function c : Xx Y \u2192 R\u22650, let F in (5) be of the form F = \u2208 RN,D[x, y], N, D \u2208 N. If there exist 81, ..., se \u2208 \u2211[x,y,\u03be, \u03b7] and t \u2208 Rd\u2081 [x, y, \u03be, \u03b7], d\u2081 \u2208 N, such that\n\n(\u00a7\u00ae\u03b7) (FNN(x,y) + F(x,y)) (\u03be & \u03b7) \u2013 KFD(x, y)||\u096c||2||7||2\n+ \u2211 si(x, y, \u03be,\u03b7)mi(x, y) + t(x, y, \u03be, \u03b7)\u03b7\u03be\u2208 \u2211[x, y, \u03be, \u03b7],\n\ni\u2208[l]\n\nthen c satisfies the MTW(\u043a) condition on X \u00d7 Y for some \u043a \u2265 0.\n\nProof. We proceed similar to the proof of Theorem 5. Suppose such si and t exist. Then, (\u03be\u03b7) (FNN(x, y) +\nF(x,y))(\u03be\u03b7) \u2265 \u03baFp(x,y) ||\u00a7||2||n||2 for all (x, y, \u03be, \u03b7) such that mi (x, y) < 0 and \u03b7\u03be = 0.\n\nTheorems 5 and 6 allow us to replace the constraints in the feasibility problems (11) and (12) with their SOS counterparts (13) and (14), respectively. As a result, both feasibility problems admit an SDP formulation as in (9). In Sec. 4.1, we will illustrate the solutions for these problems via SOSTOOLS and YALMIP. In Appendix C, we analyze the runtime complexity of the SDP computation for the feasibility problems (13) and (14)."}, {"title": "3.2 Inverse problem", "content": "If the constraints in the forward problems (11) or (12) are infeasible, i.e., the NNCC or the MTW(K) conditions are falsified for some (x, y) \u2208 X \u00d7 Y, \u03be \u2208 TX, \u03b7 \u2208 TY, then one may still be interested to know if such conditions hold locally. Indeed, the NNCC or the MTW(K) conditions are not globally satisfied in many OT problems. Nevertheless, if we have smooth measures supported on relatively c-convex domains (e.g., small balls) within some set U \u00d7 V \u2286 X \u00d7 Y where local regularity holds, then the associated Monge OT map Topt will be continuous. This motivates the inverse problems of finding semialgebraic U \u00d7 V \u2286 X \u00d7 Y where NNCC or MTW(K) holds.\n\nLet X x Y be as in (10), and let vol denote the volume measure. Then, a natural formulation of the NNCC inverse problem is\n\narg max vol(U \u00d7 V)\nUxVCXXY\nsubject to S(u,v) (\u03be, \u03b7) \u2265 0, \u2200(u, v) \u2208 U \u00d7 V, \u00a7 \u2208 T\u300fU, \u03b7 \u2208 TV.\n\nLikewise, the MTW(\u043a), \u043a \u2265 0, inverse problem is\n\narg max vol(U \u00d7 V)\nUxVCXXY\nsubject to S(x,y) (\u03be, \u03b7) \u2265 \u03ba||5||2||n||2, \u2200(u, v) \u2208 U \u00d7 V, \u03be \u2208 TU, \u03b7 \u2208 TV such that \u03b7(\u03be) = 0.\n\nThe volume maximization objectives in problems (15)-(16) are motivated by our desire to compute \"largest\" set under-approximators of X \u00d7 Y where the desired OT regularity conditions hold locally.\n\nTo parameterize the decision variable U \u00d7 V using polynomials, we define U \u00d7 V as the zero sublevel set of some measurable V, i.e., U \u00d7 V = {(x, y) \u2208 X \u00d7 Y | V(x, y) \u2264 0} where V \u2208 Ra[x, y]. If F in (4)-(5) is a rational function, i.e., F = = \u2208 RN,D[x, y], then problem (19) and its MTW(\u03ba) counterpart can be recast in the form (7) by imposing the constraint -V(x,y) \u2264 f(x,y) for all principal minors f of FN. Then, the problem (15) becomes\n\nmax vol (U \u00d7 V)\nVERd [x,y]\n\nsubject to mi (x, y) \u2264 V(x, y) \u2200 (x, y) \u2208 X \u00d7 Y, i \u2208 [l].\nV(x, y) + f(x,y) \u2265 0, \u2200(x, y) \u2208 X \u00d7 Y, f \u2208 pminor(FN).\n\nLikewise, the problem (16) can be rewritten as\n\nmax vol (U \u00d7 V)\nVERd [x,y]\n\nsubject to mi(x,y)||\u00a7||2||n||2 < V(x,y,\u03be,\u03b7) \u2200 (x,y) \u2208 X \u00d7 Y, i \u2208 [l],\nV(x, y, \u03be, \u03b7) + (\u03be & \u03b7)FN(x,y)(\u03be & \u03b7) \u2265 \u03baFp(x,y)||5||2||n||2,\n\u2200(x, y) \u2208 X \u00d7 Y,\u03be \u2208 TX, \u03b7 \u2208 TV such that (g) = 0.\n\nTo remove the implicit dependence of the objective vol (U \u00d7 V) on V, we note that maximizing vol (U \u00d7 V) is equivalent to minimizing vol ((X \u00d7 Y) \\ (U \u00d7 V)). Furthermore, utilizing the heuristic used in Theorem 2 of Jones (2024) to solve such sublevel set volume minimization problems, we replace vol ((X \u00d7 Y) \\ (U \u00d7 V)) with the expression\n\n\u222bV(x, y) - maxmi (x, y)\ndzdy = \u222bV(x, y)dzdy - \u222bmaxmi(x,y)dzdy.\n\nSince the latter term in the above expression is a constant, minimizing the above is equivalent to minimizing \u222bAV(x, y)dxdy. Although the best choice for the domain of integration is A = X \u00d7 Y, that choice may not"}, {"title": "4 Numerical Results", "content": "Now we solve the SOS formulations for the forward (Sec. 3.1) and the inverse (Sec. 3.2) problems for ground costs c from the literature. A visual comparison of the contours for the costs considered in this Section, can be found in Appendix D. All numerical results reported next were obtained by solving the corresponding SOS programs via SOSTOOLS (Papachristodoulou et al., 2013) and YALMIP (Lofberg, 2004) on a HP Spectre laptop with Intel i7-7500U CPU @2.70GHz (4 CPUs) with 16GB RAM. Our SOS implementations leverage the representation of F in Appendix B, Proposition 14, part (iii). Appendix E lists more examples of non-Euclidean OT costs that appeared in the machine learning literature, and are amenable to the proposed method."}, {"title": "4.1 Forward problem", "content": "Example 1 (Perturbed Euclidean cost). In this example, we consider the perturbed Euclidean cost c(x, y) =\n||x \u2212 y||2 \u2013 \u03b5||x \u2212 y||4, x,y \u2208 R, \u03b5 > 0. Lee & Li (2009) analytically showed that for \u025b small enough, the MTW(0) condition is satisfied on the semialgebraic set X \u00d7 Y := {(x, y) \u2208 Rn \u00d7 Rn : ||x \u2212 y|| \u2264 0.5}."}, {"title": "5 Conclusions", "content": "We propose a provably correct computational approach to the forward and inverse problems of determining reg-ularity for a cost function based on the sum-of-squares (SOS) programming. The forward problem verifies that a given ground cost globally satisfies non-negative cost curvature (NNCC) or the Ma-Trudinger-Wang (MTW) condition. The inverse problem concerns with finding a region in which the NNCC or the MTW condition holds. The proposed computational approach generalizes for a large class of costs including but not limited to rational functions, and is the first computational work on OT regularity. Our contributions here significantly advance the current state-of-the-art where the NNCC and the MTW conditions have been analytically verified for a limited number of problems. Since the desired conditions require checking the non-negativity of biquadratic forms, analytical approaches have remained unwieldy. We demonstrate that the proposed SOS programming approach can leverage existing solvers, can recover known results in the literature, and can help discover new results on OT regularity."}, {"title": "A Nonnegative Polynomials and Sum-of-Squares Programming", "content": "In this section, we clarify the connections between the nonnegative and the SOS polynomials. For the benefit of readers not already familiar with this topic, we outline the theoretical rudiments with pedagogical examples."}, {"title": "A.1 SOS polynomial", "content": "Definition 9 (SOS polynomial). A polynomial poly in variable x \u2208 Rn is SOS, if there exist finitely many (say m) polynomials poly1, poly2,...,polym \u2208 R[x] such that\n\npoly(x) = (poly1(x))2 + (poly2(x))2 + ... + (polym(x))2.\n\nWe denote the set of all SOS polynomials in x \u2208 Rn as \u2211[x].\n\nA weaker notion of SOS is nonnegative polynomial. Specifically, a polynomial poly \u2208 R[x] is called nonnegative if poly(x) \u2265 0 for all x \u2208 Rn. We note that\n\n\u2211 [x] C nonnegative polynomials in x < R[x].\n\nThe following example highlights that the first inclusion is strict.\n\nExample. (A polynomial that is nonnegative but not SOS) The Motzkin polynomial (Motzkin, 1967)\n\npolyMotzkin(x1, x2) := x1x2 + x1x2 \u2013 3x3x3 + 1,\n\nis nonnegative for all (x1, x2) \u2208 R\u00b2, as immediate from the AM-GM inequality\n\nx1x2 + x1x2 + 1 > (xxxx.1)1/3\n3\n= x1x2.\n\nSee Fig. 3. However, polyMotzkin is not an SOS polynomial but instead a ratio of SOS polynomials. The latter follows from that\n\n(1+x1 + x2) polyMotzkin (x1,x2)\n=2x1x2 - x1x2 + (x1x2 - x2)\u00b2 + (x1x2 - x1) 2\n(xx2 - X1X2)2 + (x3x3 \u2013 1)\u00b2. \nThat polyMotzkin does not admit a SOS rep-resentation, which can be proven by contradiction.\nSpecifically, suppose that\n\nm\npolyMotzkin(x1,x2) = \u2211 (polyi (x1,x2))2\n\ni=1\nwhere poly1, poly2,...,polym \u2208 R[x1,x2] for some m\u2208 N. Comparing the terms of same to-tal degree from both sides, we find the degree of"}, {"title": "A.2 Matrix-valued SOS polynomial", "content": "A generalization of our interest is M \u00d7 M matrix-valued SOS polynomials POLY(x) where x \u2208 Rn. To this end, we first generalize the notion of nonnegative polynomials to semidefinite matrix-valued polynomials as follows.\n\nDefinition 10 (Semidefinite matrix-valued polynomial). A mapping\n\nF: RSM\n\nsuch that all entries of F(x) are in R[x], is called positive semidefinite matrix-valued polynomial.\n\nDefinition 11 (Matrix-valued SOS polynomial). An M \u00d7 M positive semidefinite matrix-valued polynomial POLY in variable x \u2208 R\", is called matrix-valued SOS polynomial if it admits a decomposition\n\nPOLY(x) = (IM zd(x)) Q (IM \u00ae zd(x)), Q\u2265 0.\n\nWe denote the set of all M \u00d7 M matrix-valued SOS polynomials in x \u2208 R as \u2211 [x].\n\nThe matrix-valued SOS decomposition (24) generalizes the scalar-valued SOS decomposition (23). Exam-ple. (Matrix-valued SOS decomposition) Consider the matrix-valued polynomial\n\nPOLY(X1,X2) = x1x2\n2xx\nx1x2x1x2 - 2x1x2+4x2\n]"}, {"title": "A.3 SOS polynomials and Archimedean semialgebraic sets", "content": "Consider the set of all nonnegative polynomials of degree m in n variables. Hilbert (Reznick, 2000) showed that for n \u2265 3,m \u2265 6 or n \u2265 4,m \u2265 4, there exist nonnegative polynomials that are not SOS. No general bound on this gap is known, although there exist related literature for nonnegative polynomials with additional structures (Chesi, 2007; Ahmadi & Parrilo, 2013).\n\nHowever, the situation is much better in the case of non-negative polynomials over the so-called Archimedean semialgebraic sets (Nie & Schweighofer, 2007a; Prestel & Delzell, 2013; Jacobi & Prestel, 2001).\n\nDefinition 12 (Archimedean semialgebraic set). A compact semialgebraic set C := {x \u2208 R\u2033 : 0 \u2264 mi(x) \u2208 R[x], i \u2208 [l]} is called Archimedean if there exists h \u2208 R[x] nonnegative over C, and si \u2208 \u2211[x] such that\n\nh(x) - \u03a3 Si(x)mi(x) \u0395\u03a3[x].\n\ni=1\n\nThe reason why the Archimedean property comes in handy in SOS context is as follows. Any polynomial f that is strictly positive on C := {x \u2208 Rn : 0 \u2264 m\u2081(x) \u2208 R[x], i \u2208 [l]} Archimedean, admits representation\n\nf(x) = 80(x) + \u03a3 Si(x)mi(x), where si \u2208\u03a3[x].\n\ni=1\n\nThis is equivalent to say that for any f > 0 on C Archimedean, we have\n\nf(x) - \u03a3si(x)mi(x)\u2208\u03a3[x]\n\nsince f(x) \u2013 \u03a3\u00a1 si(x)mi(x) = so(x) \u2208\u03a3[x].\n\nWe remark here that Definition 12 is non-constructive. In practice, a useful fact is that any compact semi-algebraic set C can be made Archimedean by adding an additional constraint 0 \u2264 me+1(x) = r\u00b2 \u2013 xx for large enough r\u2208 R. In other words, the positivity of a polynomial on C semialgebraic, can be verified on {x: cn r2 - xx > 0} via SOS programming.\n\nIn summary, SOS programming formulations are less conservative on compact semialgebraic sets, and not conservative on Archimedean sets. Hence the equivalence between (7) and (8) on Archimedean sets."}, {"title": "B Supporting mathematical results", "content": "Here, we collect several mathematical results supporting the developments in the main text.\n\nFor a suitably smooth ground cost c, let the mixed-Hessian H' := (\u2207x \u2297 \u2207y)c. Following (1), we then have\n\nH = (H')\u00af\u00b9 = C1,1 C1,2 C1,n\nC2,1 C2,2 C2,n\n \u0441\n, where Ci,j = \u2202xi\u2202yj \nC\u043f,1 \u0421\u043f,2 Cn,n\n\nThe Lemma 13 next characterizes det(H') and the entries of H as rational functions, provided the ground cost c is rational. This will come in handy for establishing Proposition 14 that follows.\n\nLemma 13 (Properties of rational cost function). Let c \u2208 Ra[x, y] where x,y \u2208 R\" and d \u2208 N. Let d\u2081 := n(d - 2). Then\n\n(i) det(H') \u2208 Rd\u2081 [x, y],\n\n(ii) [H]i,j \u2208 Rd1-d+2,d\u2081 [x, y] \u2200(i, j) \u2208 [n] \u00d7 [n].\n\nSimilarly, let CN/CD = c\u2208RN,D[x, y] where x, y \u2208 R\" and N, D \u2208 N. Let d2 := 3D + N \u2212 2. Then\n\n(iii) det(H') \u2208 Rnd2,n4D[x, y],\n\n(iv) [H]i,j \u2208 R4D+(n-1)d2,nd2 [x, y] \u2200(i, j) \u2208 [n] \u00d7 [n].\n\nProof. Proof of (i). For any n \u2208 N, we have\n\ndet (H') = \u03a3 Ck,1Ck,1 = \u03a3(-1)k+ck, Mk,l\n\nwhere C's and Ms represent the cofactors and minors of H', respectively. Clearly, Ci,j \u2208 Rd\u22122[x, y] \u2200(i, j) \u2208 [n] \u00d7 [n].\n\nBy induction, we next show that Mk,l \u2208 Rd1-d+2 [x,y]. Specifically, for n = 1, we have M1,1 = 1 \u2208 Ro[x, y]. As inductive hypothesis, suppose for n = N, we have Mk,\u03b9 \u2208 R(N\u22121)(d\u22122)[x, y] \u2200(k, l) \u2208 [N] \u00d7 [N]. Now, for the case n = N + 1, we get\n\n\u039c\u03ba\u03b9 = \u03a3(-1)+1Ck,1Mk,l \u2208 R(N+1\u22121)(d\u22122) [x, y],\n\nbecause ck,l \u2208 R(d-2) [x, y], and the degree of a sum of polynomials is no greater than the maximum de-gree of the summands. Thus, the inductive hypothesis must hold for any n \u2208 N. Consequently, det(H') =\n\u03a3\u03ba=1(-1)k+lck, Mk,1 \u2208 Rd\u2081 [x, y].\n\nProof of (ii). For n = 1,\n\nc1,1 = [H]1,1 = [[C1,1]\u00af\u00b9]1,1 = 1/c1,1 \u2208 Ro,(d\u22122) [x, y],\n\nsince C1,1 \u2208 Rd\u22122[x, y]. Now proceeding by induction, for n \u2265 2 we have\n\nH det(H') adj(H') 1 cof(H'),\n= det(H') ,\n\nwhere adj, cof denote the adjugate and the cofactor matrix, respectively."}, {"title": "C Computational Complexity", "content": "Recall that xd denotes a monomial vector in components of x \u2208 Rn of degree d, and za(x) := (1,x,x2,...,xd)T. If a nonnegative (scalar) polynomial poly of degree 2d in variable x \u2208 R, admits an SOS representation\n\npoly = (zd(x)) Qzd(x), Q\u2265 0,\n\nthen zd(x) \u2208 R(d+n); see e.g., Seiler et al. (2013). This can be generalized to matrix-valued SOS polynomials as follows.\n\nConsider an M \u00d7 M matrix POLY with (not necessarily nonnegative) polynomial entries. If POLY admits an SOS representation\n\nPOLY = (Zd(x)) QZd(x), Zd(x) := IM \u00ae zd(x), Q \u2265 0,\n\nthen the matrix Q has size M (d+n) x (d+n). This will be useful in the sequel."}, {"title": "C.1 Complexity analysis for the forward problem: NNCC", "content": "In Theorem 5, to verify the SOS condition (13), we need to find matrices Q \u2265 0, So \u2265 0, S; \u2265 0 for all i \u2208 [l", "y)).\n\ni\u2208[l": "n\nThis feasibility problem has (l + 2) positive semidefinite matrices as decision variables. Next, we upper bound the degree of the matrix-valued polynomial in (13), which will allow us to estimate the size of the underlying SDP for complexity analysis. To this end, we will find the number of constraints in the SDP, and the number of decision variables in the same.\n\nNumber of constraints. Let mi \u2208 RM[x, y", "l": ".", "F": "i,j \u2208 R(n-1)dp+dn,n4dDp [x, y"}]}