{"title": "OrganiQ: Mitigating Classical Resource Bottlenecks of Quantum Generative Adversarial Networks on NISQ-Era Machines", "authors": ["Daniel Silver", "Tirthak Patel", "Aditya Ranjan", "William Cutler", "Devesh Tiwari"], "abstract": "Driven by swift progress in hardware capabilities, quantum machine learning has emerged as a research area of interest. Recently, quantum image generation has produced promising results. However, prior quantum image generation techniques rely on classical neural networks, limiting their quantum potential and image quality. To overcome this, we introduce OrganiQ, the first quantum GAN capable of producing high-quality images without using classical neural networks.", "sections": [{"title": "Introduction", "content": "Quantum machine learning has seen rapid development, with advancements spawning the field of quantum image generation (Florian et al. 2022; Tsang et al. 2023). Quantum image generation has been developing in part due to potential speedups over similar classical algorithms (Kao et al. 2023; Lloyd and Weedbrook 2018a; Tian et al. 2023).\nQuantum generative adversarial networks (GAN) have been particularly of interest for quantum image generation due to the classical success of GANs (Silver et al. 2023a). Quantum GANs are essentially quantum equivalents of classical generative adversarial networks. GANs consist of a competing generative network known as a generator and a rival network to assess the produced quality of the generator, known as the discriminator. Classical GANs are widely used, generating high-quality data spanning domains such as image generation, audio generation, and generation of novel pharmaceuticals (Blanchard, Stanley, and Bhowmik 2021; Karras et al. 2018; Marafioti et al. 2019). Motivated by classical success, Quantum GANs are being increasingly explored for quantum image generation with early promising results (Dallaire-Demers and Killoran 2018; Hu et al. 2019; Huang et al. 2021b; Tsang et al. 2023).\nIn particular, prior efforts have demonstrated the generation of human-recognizable hand-written digits in simulation and on real machines, albeit as expected, while achieving only limited image quality. However, we discover that these encouraging results come with significant limitations due to fundamental design choices in prior Quantum GAN works (Dallaire-Demers and Killoran 2018; Hu et al. 2019; Huang et al. 2021b; Tsang et al. 2023). Below, we describe these limitations and the scope for enhancement."}, {"title": "Limitations of Prior Quantum GANS", "content": "The fundamental design limitation of prior Quantum GANs is the use of a hybrid structure \u2013 quantum in some parts, and classical in others. A representative and specific example is, QCPatch, which leverages a patch-based hybrid model, where multiple quantum generators combine to form an image which is then passed through a classical discriminator, and uses a quantum generator to generate images from quantum noise (Hu et al. 2019). While a reasonable early design with promising results as a classical discriminator is useful to achieve stability in training, this approach suffers from a fundamental bottleneck \u2013 running into classical resource bottleneck because the power of a quantum discriminator is ultimately \"held back\" by the classical discriminator during training.\nA second limitation is that a hybrid GAN design cannot natively process quantum data on a classical discriminator, and hence, the potential for hybrid QGANs are limited (Lloyd and Weedbrook 2018b). Finally, the hybrid network structure creates imbalance issues which can be difficult to tune and mitigate (Zoufal, Lucchi, and Woerner 2019). Driven by mitigating the limitations of hybrid networks, we introduce OrganiQ, a Quantum GAN consisting of a quantum generator and a quantum discriminator."}, {"title": "Contributions of OrganiQ", "content": "I. To the best of our knowledge, OrganiQ \u00b9 is the first image-scale quantum GAN that is both effective and free from classical resource bottlenecks - because it proposes to use a quantum generator and a quantum discriminator and is inherently suited for processing quantum data.\nII. OrganiQ's design demonstrates how the a use of a novel amplitude encoding technique can enable the generation of high-quality images for a quantum GAN by providing a method to reliably decode amplitudes. OrganiQ also provides a novel technique, Unitary Injection, to improve image generation quality on quantum GANs by improving how data is expressed on the circuit.\nIII. Our experiments in simulation and using a real quantum machine (IBM Lagos) demonstrate that OrganiQ produces higher-quality images than state-of-the-art models without"}, {"title": "Background and Related Work", "content": "In this section, we present the relevant background for OrganiQ in addition to the limitations of the state-of-the-art QGANS.\nThe qubit is the building block of quantum computing, analogous to the classical bit, but providing advantages by leveraging quantum properties. While a bit stores a piece of information that is binary, represented as a 0 ora 1, qubits can store information in a probabilistic state between 0 and 1 known as a superposition. Measuring a qubit collapses the quantum state, $ \\ket{\\psi} $, to one of two basis states, 0 or 1 probabilistically with the probability of measuring 0 as $ |\\alpha|^2 $ and measuring 1 as $ |\\beta|^2 $ where $ |\\alpha|^2 + |\\beta|^2 = 1 $, where \u03b1 and \u03b2 can be complex (Nielsen and Chuang 2001). Quantum logic gates are unitary operations, U, which can act on multiple qubits at once to create an interdependent system in a process known as entanglement, where none of the qubits can be described independently of each other. While qubits can be very powerful, the current NISQ-era of quantum computing is defined by small machines with high levels of noise (Patel et al. 2023).\nVariational quantum circuits (VQCs) are a type of parameterized quantum circuits that have been widely used for NISQ-era quantum machine learning tasks including classification, natural language processing, and reinforcement learning (Chen et al. 2020; Di Sipio et al. 2022; Patel, Silver, and Tiwari 2022; Ranjan et al. 2024; Silver et al. 2023b; Silver, Patel, and Tiwari 2022). VQCs are a system comprised of fixed gates X and tunable gates $ \\theta $ such that $ \\ket{\\psi} = U(X, \\theta) $. Objective functions can be setup on the VQCs whose minima correspond to the desired solution. Similar to classical neural networks, we can calculate gradients with respect to a specified loss function, which help in tuning the gates to find the optimal solution. VQCs are functionally similar to neural networks, however, they present unique challenges. As VQCs become larger, they become increasingly difficult to simulate on classical computers (Chen et al. 2020), making training difficult. Additionally, while VQCs are one of the most likely candidates for providing quantum advantage, they possess many well known issues such as poor accuracy and training inefficiency (Cerezo et al. 2021).\nGenerative Adversarial Networks\nGenerative Adversarial Networks (GANs) are neural network systems designed to transform Gaussian noise into"}, {"title": "Related Work and its Limitations", "content": "There has been considerable research in quantum GANs, due to proposed theoretical advantages over classical GANS (Dallaire-Demers and Killoran 2018; Hu et al. 2019; Lloyd and Weedbrook 2018a; Zoufal, Lucchi, and Woerner 2019). Most of related research into quantum GANs has focused on small-scale implementations of theoretical quantum GANs that perform simple tasks quite well. While these designs provide theoretical designs and, in some cases, small implementations, they do not provide an implementation on the scale of image generation, which sets OrganiQ apart.\nThe most relevant technique to OrganiQ is a patch-based quantum GAN, comprised of quantum generators and a single classical generation which we refer to as QCPatch (Huang et al. 2021a). This technique is capable of generating human-recognizable images, demonstrating effectiveness on the MNIST dataset. Typically, these classical discriminators provide stability to an otherwise, hard-to-train quantum model. However, while this model provides high-quality images, it is ultimately limited by the classical discriminator. Given a sufficiently powerful quantum generator, the classical discriminator will not be able to keep up in an adversarial game. In Figure 1 we demonstrate this effect as we compare the efficacy of adversarial training with a quantum generator and classical discriminator of varying size. We find the training of the generator and discriminator produces the highest quality image of parameters tested, when the classical discriminator is 10,000 times as large as the quantum generator in one architecture and 1,000 in another architecture. The different optimal points point to a non trivial tuning procedure required to balance quantum and classical components"}, {"title": "Design Elements", "content": "In this section, we discuss the design and implementation of OrganiQ and the procedure for training and inference.\nBaseline Design. We propose a baseline design, which OrganiQ is built up from. The Baseline consists of an implementation using a Quantum Generator and a Quantum Discriminator of equal size. The Baseline trains the generator and discriminator simultaneously. We use PCA to scale to full sized images with fewer qubits. The Baseline serves to demonstrate what a simpler implementation of a quantum GAN (both discriminator and generator being quantum) would be and the relative inefficacy of using such an approach. Additionally, since none of the prior works have built a quantum image GAN composed of a quantum generator and a quantum discriminator, we include the Baseline as a reasonable comparison point for OrganiQ. We show a graphic of the Baseline in Figure 2.\nMitigating Challenges of Hybrid Quantum GANs Recall, hybrid quantum GANs comprised of a quantum generator and a classical discriminator have several shortcomings with both scalability and trainability. A classical discriminator adds a scalability bottleneck in training as it will not be able to keep up with a sufficiently large quantum generator. Additionally, a classical discriminator is not natively"}, {"title": "Combining the Generator and Discriminator", "content": "A key design element of OrganiQ is the placement of the generator and discriminator on the same quantum circuit. While previous image-based Quantum GAN approaches have typically had an architecture containing a quantum generator and a classical discriminator (Huang et al. 2021a), OrganiQ proposes a new approach that leverages the quantum properties more organically by making both generator and discriminator quantum. Keeping the discriminator and generator on the same circuit facilitates smooth training where the quantum state from the generator is unperturbed throughout the training pipeline. If the network was not connected (as is the case with prior hybrid designs), the quantum state would collapse between the generator and discriminator, causing a phase collapse to the real axis, potentially removing information stored in the complex plane.\nTraining the Discriminator on Real Images is the first step in training. This step infers the Real Loss Loss from the discriminator D output of the real images R. In place of the generator, we use the amplitude embedding mechanism to encode the data on the discriminator. Amplitude embedding is an encoding strategy that places $2^n$ classical features on n qubits by encoding the features into real-valued amplitudes, maintaining the constraint in quantum systems that the sum of all amplitudes squared must sum to 1 (Schuld and Killoran 2019). Following amplitude embedding, the remaining elements of the circuit are the basic entanglement gates and tunable weights that comprise the discriminator. We show this pass of Real data in A of Figure 3. Note, as we use binary cross entropy as our loss function, which requires non-negative labels; in our implementation, we normalize the discriminator output which ranges from [-1, 1], to [0, 1].\nTraining the Discriminator on Generated Images In the case of training the discriminator on the generated images, we maintain the same discriminator weights and entanglements from the previous training step. The difference between this training step and the previous step lies with the image embedding portion of the circuit. In this case, instead of using amplitude embedding to place the images on the circuit, the generator circuit is used instead in order to train the discriminator on the generator's outputs. This involves passing the noise onto the generator using angle embedding, using the weights of the generator, and directly interpreting the output on the discriminator circuit. The noise is a randomized tensor uniformly distributed from [0, 2\u03c0] of size (batch_size, n), where n is the number of qubits on the circuit. The circuit transforms the noise into the discriminator's classification decision. In order to only train the discriminator in this step, the generator's weights are excluded from"}, {"title": "Amplitude Regularization", "content": "In the hybrid implementation of quantum GANs, encoding of the real images is normalized before being amplitude embedded and passed through the discriminator. For example, given a feature vector [1/\u221a2,0,1/\u221a2,0], the state of the 2-qubit quantum circuit would be 1/\u221a2|00) + 0|01) + 1/\u221a2|10) + 0|11). In this case, the data has been normalized, so we can directly obtain the encoded features by measuring the probability of each computational basis state and taking their square root. However, most real-world data is not in a quantum-normalized form. Consider another case where we would like to encode [1/\u221a2,1/\u221a2,1/\u221a2,0] on a quantum circuit. The encoded amplitudes must be normalized and therefore becomes 1/\u221a3|00) + 1/\u221a3|00) + 1/\u221a3|10) + 0|11). Note that the feature vectors differ only in one value, but the encoding of other features within the vector has changed as well. Moreover, the data can not be retrieved in the exact form as reversing becomes intractable. This encoding inconsistency which also leads to a decoding inconsistency, impedes the training of the GAN and hampers"}, {"title": "the gradient of images from the output of the generator.", "content": "To mitigate this inconsistency, we introduce an amplitude regularization technique. Amplitude regularization is designed to provide a uniform encoding for each feature independent of the values of other features. To do this, we reserve one state whose amplitude works as a regularization variable. Given n qubits, we normalize $2^n - 1$ features $f_i$ as:\n$ \\ket{\\psi} = \\sum_{i=0}^{2^n-1} {\\frac{f_i}{\\sqrt{\\sum_m ||f_i||^2}} |i> + r |2^n>} $ (2)\nWhere $ \\ket{i} $ represents the quantum state after the embedding and r represents the amplitude of the reserved state, which we denote here as $ |2^n> $. Now, the probability of all the states must add up to one, which is mathematically given by\n$ \\sum_{i=0}^{2^n-1} {||f_i||^2} + ||r||^2 = 1 $ (3)\nFrom this equation, one can obtain the value of the regularization value and encode the features into the circuit. This ensures that any feature $f_i$ in features f will be encoded invariably regardless of the other features $f_j$ where $j \\neq i$.\nAlthough the regularization technique uniformizes the encoding scheme, it limits the space encoded states can occupy. Note that these limitations are only applicable while encoding a large amount of classical data over a small number of qubits. The effect of these limitations can be minimized by allocating more reserved states for regularization and amplitude embedding over partitions of the larger circuit. Here, Amplitude regularization is applied to the real-imaged inputs to the discriminator, which forces the generator to adapt to produce outputs that mimic data in this form. Amplitude regularization works to encode real classical data, however given quantum states can assume complex values, we would like to ensure our generator gains access to this space. Improving the expressibility of our generator to generate complex values is the reason for Unitary injection."}, {"title": "Unitary Injection", "content": "Recall amplitude embedding embeds classical data on quantum circuits as real-valued amplitudes. While this is an efficient scheme for encoding data, we would like our generator to mimic a richer space that encompasses the complex"}, {"title": "Experimental Parameters", "content": "Our experiments are all trained for 500 training iterations, using a batch size of 20. We use a generator learning rate of 0.05 and a discriminator learning rate of 0.05. For training, we employ PyTorch's BinaryCrossEntropyLoss function to calculate loss and PyTorch's StandardGradientDescent optimizer. Our circuits use five qubits, each with three repeated layers, and measure the probabilities on the first three qubits, leading to 8 variables being read out, one for each PCA feature with the final readout corresponding to the regularization factor which is ignored. The best model during training is selected for inference in all experiments. Following training, we generate 100 images per model and compute the FID score across the images to their respective datasets. The FID score computed in this step is what is reported in our results.\n$ FID = ||\\mu_1 - \\mu_2||^2 + tr(C_1 + C_2 - 2(C_2C_1)^{1/2}) $ (4)\nCompeting Techniques. We compare OrganiQ to two competing techniques. We compare a hybrid design with a quantum generator and a classical discriminator, which we refer to as QCPatch (Huang et al. 2021a). As the size of the model"}, {"title": "Results and Evaluation", "content": "OrganiQ effectively generated images across the MNIST and Fashion MNIST datasets, despite not using a classical neural network to train. OrganiQ outperforms competing hybrid techniques in all cases in the MNIST dataset as shown in Figure 6. Additionally, OrganiQ significantly outperforms the Baseline approach that maintains a quantum generator and quantum discriminator in every MNIST"}, {"title": "Ablation Analysis", "content": "We perform an ablation analysis and find each of OrganiQ's techniques provide benefits to image quality We compare the image quality results of OrganiQ with the Baseline and with QCPatch to analyze how our techniques each contribute to the overall improvements in image quality. We show the corresponding FID scores without the three main techniques of connected architecture, amplitude regularization, and unitary injection over the MNIST and Fashion MNIST datasets respectfully in Figure 9 and Figure"}, {"title": "Results on Real Quantum Machines", "content": "We evaluate OrganiQ on a real quantum machine and find it is able to produce high quality images. We test the feasibility on today's NISQ-era quantum machines by evaluating OrganiQ, Baseline, and QCPatch on IBM Lagos quantum computer on the MNIST dataset. We provide the MNIST images generated by Lagos in Figure 11. We find that OrganiQ outperforms the other methods visually on the MNIST dataset, particularly performing well even in cases where QCPatch and Baseline struggle such as the digit 3. Additionally, we simulate image generation, using a noisy simulation model that models IBM Lagos machine and visualize the results in Figure 12. We find slight decreases in FID score across all three methods, with OrganiQ continuing to outperform other methods on the MNIST dataset.\nWe evaluate OrganiQ on Fashion MNIST using IBMs Lagos quantum computer. We provide the generated images in Figure 13 and find that OrganiQ consistently produces high quality images over most classes in the Fashion MNIST dataset. We find the difficult cases (class 5 and class 8) which"}, {"title": "Concluding Discussion", "content": "In this work, we introduce OrganiQ, the first quantum GAN consisting of both a quantum generator and quantum discriminator that generates high-quality images. We demonstrate the advantages of using a connected model, amplitude regularization, and unitary injection, and training a combined model for a quantum GAN. OrganiQ produces higher quality images on a real quantum machine over the state-of-the-art, in certain cases outperforming by over 100 points improvement in FID score."}]}