{"title": "Zero-X: A Blockchain-Enabled Open-Set Federated Learning Framework for Zero-Day Attack Detection in IoV", "authors": ["Abdelaziz Amara korba", "Abdelwahab Boualouache", "Yacine Ghamri-Doudane"], "abstract": "The Internet of Vehicles (IoV) is a crucial technology for Intelligent Transportation Systems (ITS) that integrates vehicles with the Internet and other entities. The emergence of 5G and the forthcoming 6G networks presents an enormous potential to transform the IoV by enabling ultra-reliable, low-latency, and high-bandwidth communications. Nevertheless, as connectivity expands, cybersecurity threats have become a significant concern. The issue has been further exacerbated by the rising number of zero-day (0-day) attacks, which can exploit unknown vulnerabilities and bypass existing Intrusion Detection Systems (IDSs). In this paper, we propose Zero-X, an innovative security framework that effectively detects both 0-day and N-day attacks. The framework achieves this by combining deep neural networks with Open-Set Recognition (OSR). Our approach introduces a novel scheme that uses blockchain technology to facilitate trusted and decentralized federated learning (FL) of the Zero-X framework. This scheme also prioritizes privacy preservation, enabling both CAVs and Security Operation Centers (SOCs) to contribute their unique knowledge while protecting the privacy of their sensitive data. To the best of our knowledge, this is the first work to leverage OSR in combination with privacy-preserving FL to identify both 0-day and N-day attacks in the realm of IoV. The in-depth experiments on two recent network traffic datasets show that the proposed framework achieved a high detection rate while minimizing the false positive rate. Comparison with related work showed that the Zero-X framework outperforms existing solutions.", "sections": [{"title": "I. INTRODUCTION", "content": "With the rapid development of computing and communication technologies, we are witnessing a growing prevalence of Connected and Automated Vehicles (CAVs) in our modern world. Internet of Vehicles (IoV) technology provides a crucial communication framework for CAVs, facilitating reliable communication between CAVs and other IoV entities, such as infrastructure, pedestrians, and smart devices. The fifth generation (5G) and the forthcoming sixth generation (6G) networks promise to revolutionize the IoV by enabling ultra-reliability with ultra-low latency and high bandwidth communications.\nWith the growing level of connectivity and complexity in the IoV, cybersecurity risks have become a major concern. Among these risks, Zero-day cyberattacks stand out as a significant threat. A zero-day attack refers to a new type of cyber attack that is unknown to both the general public and the cybersecurity experts [1]. This kind of attack exploits unknown vulnerabilities or uses innovative methods to evade detection by security mechanisms. Upstream [2], a cybersecurity and data management platform for CAVs has analyzed over 900 publicly reported cyberattacks on cars in the last decade. Examples of real-world cyberattacks can be found in [2], including instances where hackers could disable the brakes and kill a car's engine traveling at 65 mph using a laptop and custom-written software plugged into the OBD II port. In another case, hackers remotely controlled a Jeep's engine while driving on a highway. These incidents highlight the significant cybersecurity risks associated with IoV and the urgent need for robust cybersecurity measures to ensure the safety of vehicle occupants and other road users.\nTo mitigate cyberattacks in the context of the IoV, Artificial Intelligence (AI) has emerged as a crucial tool for cybersecurity. Machine Learning (ML) and Deep Learning (DL) based IDSs have been proposed to protect vehicular networks from cyber-attacks [3]. In ML, classification involves assigning data to predefined categories based on their features, using a trained model. This model, developed with a labeled dataset, learns to recognize patterns indicative of each class for predicting unlabeled data. In a real IoV environment, zero-day attacks will inevitably occur frequently. However, existing IDSs [4]\u2013[6] are typically designed for static and closed-set scenarios. Assuming that all possible attack types an intrusion can belong to are known and predefined during the training phase of the IDS. However, this assumption is unrealistic as new types of attacks are constantly emerging. The majority of current IDSS rely on Supervised Learning (SL), a method that can prove to be inefficient in effectively identifying unknown attacks characterized by patterns substantially divergent from those observed during the training phase.\nTo enable the detection of zero-day attacks, anomaly and novelty detection techniques have been used [7]\u2013[9]. Although the solutions based on these techniques yield promising results in detecting unseen/ zero-day attacks, they can unfortunately not recognize the type of detected attacks. This poses a substantial challenge in the development of a security mechanism capable of identifying known (N-day) attacks while also"}, {"title": "II. RELATED WORK", "content": "The development of IDS for IoV has gained significant attention in recent years due to its criticality in ensuring the security and privacy of these connected systems. A security framework [5] is proposed for efficient cyber-attack detection in the intravehicle networks (IVN) and External Vehicular Networks (EVNs). To differentiate cyberattack patterns more easily, Anbalagan et al.'s [21] IDS framework transforms vehicle network data into images, enhancing attack identification. However, both approaches rely on centralized learning, which raises privacy concerns within the broader context of the IoV, as data collection could potentially infringe on user privacy.\nUprety et al. [16] introduced a FL-based collaborative IDS, enabling CAVs to train Deep Learning (DL) models on locally labeled datasets and share model parameters with a central FL server for global model aggregation. Similarly, Hbaieb et al. [18] proposed an IDS for CAVs combining Software-Defined Networking (SDN) and FL, where SDN controllers train local models using data from CAVs, and global model aggregation is performed on a central cloud server. Both approaches [16], [18] rely on a central server, presenting risks as potential attack targets and single points of failure. There is also the risk of attackers intercepting and observing model updates during network transmission. Differently, Boualouache et al. [6] proposed an FL-based privacy-preserving IDS using multiple FL\nservers for global model aggregation. However, this solution, along with the previous ones [16], [18], do not consider the risk of a compromised FL client poisoning the model during training. To address these challenges, Zero-X employs differential privacy and blockchain technology, facilitating decentralized and privacy-enhanced federated training of the framework. Additionally, it incorporates a Byzantine Fault Tolerance consensus mechanism, named Proof-of-Accuracy (PoA), to ensure secure dissemination and aggregation of FL model updates.\nLiu et al. [17] introduced an FL-based IDS that incorporates a blockchain-based incentive mechanism to mitigate adversarial attacks. In this system, CAVs function as FL clients, building models from their locally labeled datasets, with Roadside Units (RSUs) aggregating the global models. However, this approach's reliance on a simple MLP (Multi-Layer Perceptron) network for the classification task in intrusion detection may not be sufficiently effective in detecting new attack patterns. To classify various attack types, Abdel-Basset et al. [4] presented FED-IDS, a Blockchain-enabled FL IDS utilizing a transformer network, capable of understanding the spatial and temporal patterns of traffic flows in vehicles. However, the authors acknowledge practical challenges with their consensus mechanism, such as divergence, limited efficiency, and high computational demands. Lai et al. [22] introduced a FL and Edge Cloud communication architecture (FL-EC) and a Feature Select Transformer (FSFormer) model for robust intrusion detection in the IoV. Yet, they recognize that this model comes with the drawback of high computational costs.\nThe aforementioned FL-based IDSs operate under the assumption that CAVs possess labeled datasets for FL rounds, an assumption that might be unrealistic due to the general absence of pre-labeled malicious traffic data. Additionally, these systems often assume an IID (Independent and Identically Distributed) configuration for classifier training, which may not reflect the significant imbalances in real-world training data, a known factor adversely affecting collaborative detection performance. Moreover, their dependence on closed-set and supervised learning methods limits the detection of unseen and zero-day attacks. In contrast, our framework employs a more realistic configuration, recognizing that CAVs typically do not have traffic labeling functions and considering the case of non-IID training data. Additionally, Zero-X enhances attack detection, including zero-day attacks, by integrating deep neural networks with Open-Set Recognition (OSR) capabilities.\nTo detect zero-day attacks in the IoV, Khan et al. [23] introduced an IDS using state-based Bloom filters and a bidirectional LSTM classifier for detecting cyber-attacks in both In-Vehicle and external networks. This approach, however, necessitates a considerable number of observations for high detection accuracy, and its detection rate for certain attack types is lower compared to other methods. Other recent studies [8], [24], [25] have focused on detecting zero-day attacks in Intra-Vehicular Networks. Jeong et al. [8] utilized autoencoders to process live streams in CAN (Controller Area Network) message payloads. However, X-CANIDS [8] might face limitations in effectively detecting suspension attacks, which are typically identified by time-interval or sequence-based IDSs. In their respective works, Agrawal et al. [24] and Yang et al. [25] employed unsupervised learning and anomaly-based IDS for CAN message analysis. While the approaches [8], [23], [24] enable zero-day attack detection, they fall short in identifying the types of N-day attacks. Their effectiveness is further constrained by the lack of shared CAN databases among carmakers. Moreover, their dependence on centralized learning poses privacy concerns, where data collection could infringe on user privacy. In contrast, Zero-X, with its OSR detection model, enables the detection of zero-day attacks and the identification of N-day attacks. Additionally, it respects user privacy through federated learning, eliminating the need for data collection."}, {"title": "III. SYSTEM DESIGN", "content": "This section introduces the system model, seamlessly putting in collaboration different CAVs with SOCs. It illustrates the synergy operation between them through the Blockchain-enabled collaborative training of the Zero-X Framework. Furthermore, an exploration of the system's addressed threat model will also be presented.\nOur framework enables privacy-preserving collaboration among multiple CAVs and Security Operation Centers (SOC) that may be owned by different stakeholders within the ITS ecosystem, as illustrated in figure 1. To participate in the federated training process, the SOCs deploy MEC servers on strategically placed Base Stations (BSs). The system model is composed of three main elements with different roles which can be summarized as follows:\n1) CAVs: are tasked with training the Attack detector (AD) model using their own local dataset, which exclusively consists of benign traffic, as CAVs typically lack traffic labeling functions. When a CAV drives near a BS, it can download and read the last block of the blockchain to get the latest global AD model. Acting as FL workers, each CAV conducts the learning process using its own On Board Unit. The CAV trains the global model on its local data and adds a specific amount of Gaussian noise to the trained parameters before sending them back to the BS. This technique, known as differential privacy, protects the privacy of CAV's native data from honest-but-curious MEC nodes.\n2) MECs: play a crucial role in validating and aggregating AD model updates that are received from CAVs. During the training of the Attack Classifier (AC) model, each MEC is assigned one of three roles: worker, validator, or miner. As a worker, the MEC trains the AC model using its local dataset, which includes labeled malicious network flows. Given that SOCs are equipped with cyber threat intelligence tools, it is reasonable to assume that they possess labeled samples of malicious network traffic. As a validator, the MEC ensures the accuracy of transactions and validates blocks that are proposed by miners. Finally, as a miner, the MEC is responsible for creating new blocks during the consensus process.\n3) Blockchain: to ensure secure and transparent FL model updates, the framework uses blockchain technology for AD"}, {"title": "IV. PROPOSED ZERO-X FRAMEWORK", "content": "This section details the Zero-X framework. It begins with a presentation of the framework overview. Following this, the flow extraction and feature engineering processes are described. Then, the attack detection process and subsequent attack classification phase are explained. Finally, we will present the proposed blockchain-enabled FL scheme to ensure secure sharing and aggregation of model updates.\nDuring the development phase, the AD and AC models are trained independently on the network flows using a decentralized FL approach, as illustrated in Figure 2. First, network flows are extracted from collected raw network traffic, and then a set of features is calculated for each flow. The AD model is designed as a deep auto-encoder (DAE) trained exclusively on benign traffic data. On the other hand, the AC model is a deep multi-class data descriptor [30] trained on the MEC's local dataset, which includes labeled malicious network flows. During the deployment phase,as illustrated in Figure 2, the flow collector monitors incoming and outgoing packets. The preprocessing module extracts network flows from the raw traffic data, according to a specific Time Window (TW), and generates a vector of features. This features vector is then sent to the AD module, which evaluates the flow as benign or malicious. The framework's attack classifier module further examines any malicious flows detected by the AD to determine if they correspond to a new (0-day) or existing (N-day) attack."}, {"title": "B. Flow extraction & features engineering", "content": "First, we use a combination of five properties from the packet header, including the network and transport layer headers of the TCP/IP protocol stack, to identify a traffic flow. These include the source IP address, the destination IP address, the source port number, and the destination port number, as well as the protocol. For each flow extracted, a set of features are calculated according to a given time window (ex. 10 seconds). Flow features include mainly packet header characteristics and statistics computed based on header information of network and transport layers. This set of features is then used as a features vector."}, {"title": "C. Attack Detector", "content": "As a CAV runs a set of well-known applications such as those related to safety, convenience, and commercial use, its communication pattern should exhibit a high degree of regularity as long as it is not under attack or experiencing any faults. Conversely, any attack on the CAV's system would inevitably alter its communication pattern. Hence, we use a Deep Auto-Encoder (DAE) to model the expected communication pattern of the CAV and detect any attacks as anomalous occurrences. The DAE model [31] is an unsupervised model that compresses input vectors as code vectors using a set of recognition weights and then converts back to m (m < d) number of neurons reconstructed input vectors using a set of generative weights. An AE architecture has two major parts: the encoder and the decoder. The encoder reduces the dimension of the input vectors $(x_i \\in R^d)$ to numbers of neurons that form the hidden layer. The activation of the neuron i in the hidden layer is given by:\n$h_i = f_\\theta(x) = s(\\sum_{j=1}^n W_{ij}^{input} x_j + b_i^{input})$\nwhere X is the input vector, $\\theta$ is the parameters ${W^{input}, b^{input}}$, W is an encoder weight matrix of dimension"}, {"title": "D. Attack Classifier", "content": "To identify the type of the detected attack (N-day), or eventually determine if it is an unseen or 0-day attack, we leverage the potential of OSR through FL. In this paper, we use deep multi-class data description method, called Deep-MCDD [30], as it can accurately classify in-distribution (ID) samples into known classes and detect out-of-distribution (OOD) samples as well. This method seeks to identify, for each class, a spherical decision boundary that determines whether a test sample belongs to the class or not. Deep-MCDD integrates K hypersphere-modeled one-class classifiers into a single network. The objective of learning a single hypersphere is to assess whether or not a test sample belongs to the target class; hence, training it for each class is useful for recognizing OOD samples that do not belong to any given class. Each sample from a K-th class-conditional distribution can be considered as an isotropic Gaussian distribution with class mean $\\mu_k$ and standard deviation $\\sigma_k$ within the latent space, denoted by $\\mathcal{N}(\\mu_k, \\sigma_k I)$. Using the resulting distributions, the class-conditional probabilities are calculated. This reflects the likelihood that an input sample is drawn from each distribution, and this probability can serve as a good confidence measure [30]. Based on the K-th class conditional distribution, the distance function D can be defined in Equation 5:\n$D_k(x) \\approx \\frac{||f(x; W) \u2013 \\mu_k ||^2}{2 \\sigma_k^2} + \\log \\sigma_k^d$\nThe Deep MCDD loss is defined as a Maximum A Posteriori (MAP) loss estimation of the generative classifier as defined"}, {"title": "E. Blockchain-enabled Federated Training", "content": "To ensure the secure and decentralized federated training of both AD and AC models, we use blockchain technology. In our framework, updates of both models are recorded on the same blockchain, while their training is performed independently. Integrating blockchain with FL requires careful selection of the blockchain type and consensus protocol, as they significantly impact scalability, latency, complexity, and cost. Public blockchains face issues like scalability limitations and high latency. Private blockchains improve scalability and latency but may reduce decentralization and privacy. Consortium blockchains, which Zero-X employs, strike a balance, making them well-suited for our system. Zero-X utilizes"}, {"title": "V. PERFORMANCE EVALUATION", "content": "In this section, we will assess the effectiveness of the Zero-X framework by conducting a thorough evaluation on two recent datasets. The first dataset, 5G-NIDD [19], consists of 5G network traffic traces of attacks that target the MEC infrastructure. The second dataset, VDoS [20], contains network traffic originating from inter-vehicle attacks. After briefly introducing the datasets and the experimental setting, we analyze the detection performance in detail. We also test various time-window (TW) sizes as it directly impacts the detection delay. Further, we will comprehensively analyze the identification performance of N-day and 0-day attacks. We then evaluate the performance of the blockchain system, and present the incentive mechanism's performance. Next, we present a security analysis of the Zero-X framework. Finally, we compare our approach with existing solutions in the literature."}, {"title": "D. Detection delay", "content": "The time-window (TW) size is a critical parameter that has a direct impact on detection delay. While a smaller TW can reduce detection delay, it may not capture certain traffic properties that require a longer time interval to become"}, {"title": "E. Attack identification performance", "content": "The framework's attack classifier module further examines any malicious flows detected by the AD to determine if they correspond to a new (0-day) or existing (N-day) attack. We evaluate the accuracy of the global AC model on the two datasets, considering both IID and non-IID configurations. Additionally, we conduct a comprehensive analysis of the model's performance in detecting both N-day and 0-day attacks.\n1) N-day attack identification performances: Overall, the AC model successfully detects various types of attacks, even when confronted with different data distributions, as illustrated in Table V. For the 5G-NIDD dataset, the AC model achieved high performance, with precision and TPR scores of 100% in most cases. The FPR was also low, indicating that the model did not classify benign traffic as malicious. However, for SlowrateDoS and TCPConnectScan attacks with Non-IID data distribution, the F1-score was slightly lower compared to other cases. The slow nature of traffic makes it challenging to detect the Slowrate DoS attack, which differs from other DoS attacks in terms of speed and packet volume sent. In a TCPConnectScan attack, the three-way handshake process is successfully established, mimicking a legitimate connection and making the attack challenging to detect. However, it is worth noting that the detection rate for this type of attacks remains very high, with a detection rate of over 95%. For the VDoS dataset, the AC model achieved a perfect score in all cases with both IID and Non-IID data distributions.\n2) 0-day attack identification performances: As previously mentioned, to create a realistic testing scenario, we designate one type of attack as the '0-day' attack, while classifying the remaining attack types as 'N-day' attacks. For each dataset, we repeat this process with different 0-day attacks, resulting in K"}, {"title": "G. Security Analysis", "content": "This section provides a comprehensive security analysis of our proposed framework, addressing the mitigation of three critical threat vectors (discussed in section III-B): Inter-vehicular attacks, attacks targeting MEC infrastructure, and adversarial attacks against the Zero-X framework.\n\u2022 Inter-Vehicular and MEC Infrastructure attacks: Single or multiple colluding malicious CAVs can launch flooding attacks on a target CAV, a scenario known as Inter-Vehicular Attacks. These attacks impair the target CAV's ability to process legitimate traffic. For a greater impact, these malicious CAVs, including compromised CAVs part of an IoV botnet, may also target the MEC infrastructure. In this case, the CAVs begin their attack by scanning the MEC server, followed by executing flood-type DDoS attacks through open ports. For both these attack vectors, Zero-X's 'Attack Detector' plays a pivotal role. It employs reconstruction error as an anomaly score to identify malicious traffic flows, whether in inter-CAV communications or targeting the MEC system. Our study conducted tests on three types of DoS attacks in inter-vehicular scenarios and five types in the context of MEC"}, {"title": "H. Discussion and comparison", "content": "In the current state-of-the-art, only a few studies [7], [23]\u2013[25] have addressed the detection of zero-day attacks in the IoV. Agrawal et al. [24] primarily focused on intra-vehicular networks, whereas Khan et al. [23], [25] extended their research to both intra and inter-vehicular networks. Only Yang et al. [25] conducted experiments specifically focused on zero-day scenarios. We conducted a comparative analysis with their work using the CIC-IDS-2017 dataset [37]. As demonstrated in Figure 8a, the performance difference between MTH-IDS and Zero-X in detecting N-Day attacks is relatively small, with MTH-IDS achieving a 99.8% detection rate, compared to 93.39% for Zero-X. In the context of 0-Day attacks, however, Zero-X significantly outperforms MTH-IDS, achieving a 98.36% detection rate versus 75.943% for MTH-IDS. Notably, MTH-IDS employs centralized learning, which raises privacy concerns in the IoV due to the necessity of data centralization. We further compared Zero-X with three recent studies that utilized the same datasets [19], [20] as those used in our experimentation. Figure 8b shows Zero-X outperforming Schan et al.'s method [19] in DDoS attack detection, except for SlowrateDoS. As demonstrated in Figure 8c, Zero-X also excels in detecting Scan-type attacks. Figure 8d reveals Zero-X's superiority over Rahal et al. [20] and [7] in inter-vehicular attack detection. Zero-X addresses the limitations of [20]'s inability to detect zero-day attacks and [7]'s inability to recognize N-day attacks.\nThe practicality and real-world potential of the Zero-X framework are demonstrated through evaluations conducted on both a realistic vehicular traffic testbed [20] and real traffic attacks on MEC infrastructure [19]. Both datasets contain diverse attacks mainly categorized as DoS and Scan. Their similar characteristics lead to resembling network behaviors, complicating the detection of zero-day attacks. These new patterns may mimic known attacks, challenging the classification model's ability to differentiate them. Table VIII compares the features of the Zero-X framework with other recent studies in various key aspects. Notably, Zero-X stands out by effectively detecting 0-day and recognizing N-day attacks, a capability shared with MTH-IDS [25]. However, it goes further by prioritizing data privacy through federated learning. Additionally, Zero-X leverages blockchain technology to decentralize and distribute the coordination of federated training. This not"}, {"title": "VI. CONCLUSION", "content": "This paper proposed Zero-X, a novel security framework designed to detect both 0-day and N-day attacks in the realm of the IoV. The framework uses a blockchain-enabled federated training approach to build detection and identification models that enable secure collaboration and trust between CAV and MEC nodes. We empirically evaluate the proposed framework and compare its performance with existing IDS using recent publicly available datasets. The results show that the Zero-X framework outperforms existing IDS, demonstrating its superiority in detecting a wide range of cyberattacks. For our future work, we plan to develop a security framework with the ability to detect zero-day attacks, as well as evolve its detection capabilities. This system will incrementally update the detection model to convert newly discovered \"unknown\" attacks into \"known\" attacks. Another direction to extend this work is to integrate an intrusion response mechanism where multiple reinforcement learning agents are running on a set of vehicular edge nodes and learn to mitigate newly discovered attacks."}]}