{"title": "A Generalized Model for Multidimensional\nIntransitivity", "authors": ["Jiuding Duan", "Jiyi Li", "Yukino Baba", "Hisashi Kashima"], "abstract": "Intransitivity is a critical issue in pairwise preference modeling. It\nrefers to the intransitive pairwise preferences between a group of players or ob-\njects that potentially form a cyclic preference chain, and has been long discussed\nin social choice theory in the context of the dominance relationship. However,\nsuch multifaceted intransitivity between players and the corresponding player\nrepresentations in high dimension are difficult to capture. In this paper, we pro-\npose a probabilistic model that joint learns the d-dimensional representation (d >\n1) for each player and a dataset-specific metric space that systematically captures\nthe distance metric in Rd over the embedding space. Interestingly, by imposing\nadditional constraints in the metric space, our proposed model degenerates to for-\nmer models used in intransitive representation learning. Moreover, we present an\nextensive quantitative investigation of the wide existence of intransitive relation-\nships between objects in various real-world benchmark datasets. To the best of\nour knowledge, this investigation is the first of this type. The predictive perfor-\nmance of our proposed method on various real-world datasets, including social\nchoice, election, and online game datasets, shows that our proposed method out-\nperforms several competing methods in terms of prediction accuracy.", "sections": [{"title": "1 Introduction", "content": "The transitivity of pairwise comparison and matchup between individual objects is a\nfundamental principle in both social choice theory [26,25] and preference data model-\ning [24].\nIn pairwise comparison, two participants in a single round are evaluated by a third-\nparty judge or an objective rule that judges the discriminative win/lose result for each\nplayer. Examples of applications of such a comparison include recommender systems\n[17], social choice systems [14,19,26], and so on. In pairwise matchup, two participants\nare each other's competitive opponents, and therefore the discriminative win/lose result\nis a reflection of their strength in the game. Examples of such matchup applications are\nsports tournaments [4] and online games [6]. In both cases, the hidden winning ability of\neach individual object can be quantitatively profiled by parametric probabilistic models\n[25,2].\nHowever, in addition to the thorough theoretical justifications of these parametric\nprobabilistic models that assume certain levels of transitivity, the existence of intransi-\ntivity, which overrides the transitivity of preference in the real world, has been argued in\necometrics, behavior economics, and social choice theory for decades [21,26]. Intran-\nsitivity refers to the property of binary relations (i.e., win/loss or like/dislike) that are\nnot transitive. For instance, in a rock-paper-scissors game, the pairwise matchup result\nis judged by three rules: {$\\O_{paper} > \\O_{rock}$, $\\O_{rock} > \\O_{scissors}$, and $\\O_{scissors} > \\O_{paper}$\n}. A transitive model results in a transitive dominance $\\O_{paper} \\succ \\O_{scissors}$, that violates\nthe third rule $\\O_{scissors} > \\O_{paper}$. In other words, the binary relations in the rock-paper-\nscissors game are not transitive. Such intransitivity in the real world exists in the form\nof cyclic dominance that implies the non-existence of a local dominant winner in the\nlocal preference loop. In many applications, the presence of a nested local intransitive\npreference loop results in systematically intransitive comparisons and matchups, and\ntherefore predictive modeling is challenging. Intuitively, this situation occurs when ob-\njects have multiple features or views of judgment and each of these views dominates a\ncorresponding pairwise comparison. The underestimation of such cyclic dominance is\nsubtle in the numerical testing scores in terms of prediction accuracy, but critical for the\ncost-sensitive decision making based on the prediction results, as illustrated in the toy\nmodel in Figure 1 and Table 1."}, {"title": "2 Related Work", "content": "Existing work on parametric models for pairwise matchups data, which originate from\nseminal work performed decades ago and include the Thurstone model [25] and the\nBradley-Terry-Luce model [2], were surveyed extensively. The BT model [2] is based\non maximum likelihood estimation and was further generalized to multiparty matchups\n[16] and adapted to comparisons involving a tie [10]. The first BT model general-\nized to multi-dimensional representation was limited to the 2-dimensional case with a\nnon-linear logistic function, inspired by classical multidimensional scaling [5]. In real-\nworld matchups, the ranking of the players' ability is an issue that is closely related to\nour parametric modeling for pairwise matchup data. Especially in sports tournaments\n[20,3,15] and online games [13], the Elo ratings system [11] and the TrueSkill ratings\nsystem [13,9] are noteworthy. In addition, instead of modeling the matchups between\nindividual players, some methods concentrate on group matchup [20,15], rating indi-\nvidual players from the group matchup records [22], or alternatively model the belief\nof each collected record [8]. These methods are different from ours in that they were all\ndeveloped according to the principles of transitivity."}, {"title": "3 Proposed model", "content": "Assume a given set of candidate players P with |P| = M. The dataset D contains N\npairwise matchup records $x_i(a_i, b_i) \\in {0,1}$, i = [1:N], where the players $a_i$ and $b_i$\n$\\in$ P. An ordinal matchup record $o_a > O_b$ is the matchup record between player a and\nplayer b, meaning a beats b, and $O_a\\n be represented in a 4-tuple: either $x(a, b) = (a, b, 1,0)$ meaning $o_a > o_b$ or $x(a, b) =$\n$(a, b, 0, 1)$ meaning $O_a \\prec Ob$. The identical deterministic events can be aggregated,\nresulting in a collapsed dataset $D^{collapse}$. The data entry $X^{aggregate(a, b)} \\in D^{collapse}$\nis given by 4-tuples in $X^{aggregate(a,b)} = (a, b, n_a, n_b)$, where $n_a$ is the total count of\nobserved event $o_a > O_b$, and $n_b$ of $o_a\\prec o_b$, accordingly.\nThe goal is to predict the result of matchups by learning the interpretable multidi-\nmensional representation of the players, that reflects their ability in multiple views."}, {"title": "3.1 Bradley-Terry Model and Blade-Chest Model", "content": "In the BT model, each player $p \\in P$ is parameterized by a scalar $\\gamma_p \\in R$ as the indicator\nof his/her ability to win. Following the probability axiom, the probability of the event\nis modeled as\n$Pr(o_a > O_b) = \\frac{exp(\\gamma_a)}{exp(\\gamma_a) + exp(\\gamma_b)} \\newline$\n$Pr(o_a > O_b) = \\frac{1}{1+ exp(-M_{ab})}$\nwhere $M_{ab}$ = $\\gamma_a - \\gamma_b$ is the symmetric matchup function for player a and player b,\nwith property\n$M_{ab} = -M_{ba} \\newline$\nand\n$Pr(o_a0_b)$\\nThe scalar-valued ability indicator of players $\\gamma_p$ is not intransitivity-aware and this\nhas been shown in various datasets [21,6]. The parameter estimation of the BT model\ncan be conducted by applying an EM algorithm for maximum likelihood or more gen-\neralized techniques [16]. Note that the matchup function $M_{ab}$, a, b $\\in$ P is the learning\noracle that accesses the latent metric of players' ability, and therefore, it can be fur-\nther extended to a multidimensional setting, named the BC model [6]. Intransitivity is\nthen embraced by the BC model, where blade and chest vectors imitate the offense and\ndefense, respectively.\nFormally, in the BC model, the ability of player $p \\in P$ is parameterized by $a_{blade}$\nand $a_{chest} \\in R^d$ and the corresponding matchup function is formulated by\n- the Blade-Chest-Inner (BCI) embedding $M^{BCI}$(a, b)\n$M^{BCI}(a, b) = a^{blade} b^{chest} - b^{blade} a^{chest} \\newline$\n- the Blade-Chest-Distance (BCD) embedding $M^{BCD}$(a, b)\n$M^{BCD}(a, b) = ||b^{blade} - a^{chest}||_2 - ||a^{blade} \u2013 b^{chest}||_2 \\newline$\nThese formulations of the matchup function naturally ensure the symmetry property\ndenoted in Condition (3), and therefore are compatible with the scalar-valued represen-\ntation of the players' strength in the BT model. The connection between these two\nformulations can also be evidenced under a mild condition [6]. Assembled by this mul-\ntidimensional formulation, the BC model is state-of-the-art in both predictive modeling\nand representation learning for the players' intransitivity."}, {"title": "3.2 Generalized Intransitivity Model", "content": "We propose a generic formulation of the matchup function that jointly captures a d-\ndimensional representation (d > 1) for each player and a dataset-specific distance met-\nric for the learned representation in $R^d$ over the embedded dimensions. Let us assume\nwe have a d-dimensional representation $a \\in R^d$ for player a $\\in$ P; then, we formulate\nthe generalized intransitivity embedding $M^{G}$(a, b) as,\n$M^{G}(a,b) = a^T \\Sigma b + a^T \\Gamma a \u2013 b^T \\Gamma b \\newline$\nwhere a and b are the d-dimensional representation for player a and player b, respec-\ntively, and $\\Sigma, \\Gamma \\in R^{d\\times d}$ are the transitive matrices. The model parameters we attempt\nto learn are $\\Theta^G := {a, b, \\Sigma, \\Gamma}$. In the proposed formulation, the first term $a^T \\Sigma b$ re-\nflects the interaction between players, and the latter term $a^T \\Gamma a \u2013 b^T \\Gamma b$ reflects the\nintrinsic strength of each individual. The embedding is proposed to model the pairwise\npreference, in which two properties should be preserved, i.e., preference symmetry and\nexpressiveness."}, {"title": "3.3 Properties", "content": "We characterize the detailed properties of the proposed formulation in terms of symme-\ntry and expressiveness in comparison with the BC model, and show that the BC model\nis a specialized formulation in a family of our generalized formulation.\nSymmetry Since we discuss the matchup result between two players, the symmetry\nmust be preserved [25]. This is different from other problems, such as link prediction in\nsocial networks, where the directed preference between items is naturally asymmetric\n[23].\nObviously, the two numerical computations of the first term $a^T \\Sigma b$ and the latter\nterm $a^T \\Gamma a \u2013 b^T \\Gamma b$ are independent given randomized d-dimensional embeddings a\nand b. Without intuition of the specific design of a and b, a.k.a. random initialization,\nthe sufficient condition to preserve the symmetry of the first term is\n$\\Sigma = \u2212\\Sigma^T\\newline$\nwhich is difficult to regularize given the gradient $\\nabla_{\\Sigma}M^G(a,b)$:\n$\\nabla_{\\Sigma}M^G(a,b) = ab^T \\newline$\nHowever, if we introduce it as a constraint in the optimization, the induced con-\nstrained optimization problem is difficult to solve. Alternatively, we devise an efficient\nsolution which transforms the constrained optimization problem into an unconstrained\noptimization by reparameterizing $\\Sigma$ with $\\Sigma'$ by\n$\\Sigma = \\Sigma' \u2013 {\\Sigma'}^T\\newline$\nwhere $\\Sigma'$ is a free matrix having the same shape as $\\Sigma$. To this end, it is trivial to show\nthat the symmetry of $a^T \\Sigma b$ is preserved. Together with the fact that the symmetry of\nthe self-regulation term $a^T \\Gamma a \u2013 b^T \\Gamma b$ in $M^G$ holds constantly, we conclude that the\nsymmetry of the proposed matchup function formulation is guaranteed.\nExpressiveness We further characterize the superior expressiveness of our proposed\nintransitive representation learning technique. Interestingly, we show that the BC model\nis a specialized formulation within a family of our proposed formulation.\nSuppose that we have blade and chest vectors for player a, $a_{blade}$ and $a_{chest} \\in R^{d'}$,\nwhere $d' = 3$; then, we integrate them into a generalized vector $a_{general} \\in R^{2d'}$ defined\nby\n$\\a_{general} = \n\\begin{bmatrix}\na_{blade}\na_{chest}\n\\end{bmatrix} \n\\newline$\nThis metaphorical definition is derived from the BC model, and therefore the 2d'-\ndimensional generalized $a_{general}$ has two distinct subspaces $a_{blade}$ and $a_{chest}$, which\nexplicitly indicate the physical strength and weakness of player a, respectively."}, {"title": "3.4 Training", "content": "Without loss of generality, given a set of players P and a collapsed training dataset\n$D^{collapse}$ with pairwise matchup between players in 4-tuple $(a, b, n_a, n_b)$, as exempli-\nfied previously, our goal is to estimate the intransitivity parameters $\\Theta^G := {a, b, \\Sigma, \\Gamma}$\nso that the predictive model can better predict unseen matchups. Following Equation\n(7), we reparameterize the transitive matrix $\\Sigma$ as $\\Sigma'$ and optimize ${\\Theta^G}' := {a, b, {\\Sigma'}, \\Gamma}$\ninstead. In line with the BT model, we train the model by maximum likelihood. The\noverall likelihood is given by\n$L(D|\\Theta') = \\prod Pr(o_a > o_b)^{n_a}. Pr(O_a\\$\\Theta') = L(D|\\Theta') \u2013 \\sum \\lambda_iR_i(\\Theta) \\newline$\nwhere ${\\Theta^G}' := {a, b, {\\Sigma'}, \\Gamma}$ denotes the model parameters and $\\lambda$ controls the regular-\nization."}, {"title": "4 Experiments", "content": "In this section, we first summarize the datasets with a quantitative investigation of the\nexistence of intransitivity. Then, we report the experimental results of our proposed\nmethod on several challenging real-world benchmark datasets that consist of pairwise\ncomparisons in social choice and matchups between individual players.\nWe used cross validation for parameter tuning in the experiments. Given the dataset\nin 4-tuple format, we first split the dataset randomly into three folds for cross validation\nand then identified the unique pairwise interactions and aggregated them. The hyperpa-\nrameters were the dimensionality of the embedding d and the regularization coefficient\n$\\lambda$. The performance was measured by the average test accuracy A(Dtest|$\\Theta$), defined by\n$A(D_{test}|\\Theta) = \\frac{1}{|D_{test}|}\\sum_{(a,b,n_a,n_b) \\in D_{test}} n_a\\cdot 1(\\hat o_a > \\hat o_b) + n_b\\cdot 1(\\hat o_a < \\hat o_b) \\newline$\nwhere 1(\u00b7) is the indicator function of an event.\nWe compared our proposed method with three competitive methods, namely the\nna\u00efve method, BT model, and BC model. The na\u00efve method estimates the winning\nprobability of each player based on the empirical observations, with $Pr(o_a > o_b) = \\frac{n_a+1}{(n_a+1)+(n_b+1)}$. If $n_a$ = $n_b$, one player is randomly assigned as the winner. The BT\nmodel estimates player ability with a scalar representation. The BC model estimates\nplayer ability with two multidimensional vectors that are independent of each other."}, {"title": "4.1 Datasets", "content": "We investigated several challenging benchmark datasets from diversified areas. The\ndatasets are commonly grounded on pairwise comparisons or matchups between ob-\njects or players. SushiA and SushiB [19] are food preference datasets. Jester [12] and\nMovieLens100K [14] are collective preference datasets in an online recommender sys-\ntem. ElectionA5 [26] is an election dataset for collective decision making. Within the\narea of online games, SF45000 [6] is a dataset collected from professional players and is\nused to profile the characters in the virtual world. Dota [6] is a dataset of game records\nproduced by a large number of players on an online RPG game platform.\nIntransitivity in datasets Quantitative statistics of intransitive relationships in these\ndatasets are presented in Table 2. isIntrans indicates the existence of the intransitivity\nrelationships. Intrans@3 indicates the percentage of intransitive loops that are analo-\ngous to the rock-paper-scissors game, where the number of involved players equals 3.\nIn Intrans@3, the denominator is the total number of directed length-3 loops given by\n2($\\binom {N}{3}$) for a fully observed pairwise dataset. PlayerIntrans@3 is the number of play-\ners who are involved in a rock-paper-scissors-like relationship. Both Intrans@3 and\nPlayerIntrans@3 characterize the intensity of intransitivity, and a higher score indi-\ncates more intensive intransitivity in the dataset. In the majority of the seven datasets\nwe investigated, an intransitive relationship exists. Moreover, in five out of the seven\ndatasets, more than half of the players are involved in local intransitive relationships.\nTo this end, we highlight the necessity of modeling the intransitivity, and to the best\nof our knowledge, this is the first quantitative exploration of the existing intransitive\nrelationships in these prevalent benchmark datasets."}, {"title": "4.2 Experiments on Real Datasets", "content": "Table 3 shows the experimental results of our proposed method. For all of the four\ntransitivity-rich datasets, SushiB, Jester, ElectionA5, and SF45000, we observe improve-\nment in terms of the average test accuracy. In addition to the predictive performance,\ntwo practical facts are noteworthy. (a) The observed pairwise interactions in all these\ndatasets are rich, and a K-fold cross validation procedure with no data augmentation\nresults in a set of data bins, each of which contains identical players. Therefore, it is\nguaranteed that the representation of each player in the validation and test bin will be\nlearned by a training set with a size of K 2 bins. However, as the number of players\ngrows, the number of records required to accommodate such a cross validation proce-\ndure grows quickly. For instance, in the case of the SushiB dataset with 100 players,\n25000 pairwise records, Intrans@3 = 26.87%, and PlayerIntrans@3 = 92/100, the\nempirical down sampling for 3-fold cross validation is sufficient to perform a fully-\nevidenced prediction of the dominance for all possible player pairs, instead of a random\nguess caused by the existence of non-observed players in the validation and test bins. (b)\nGiven a sampling scheme that is sufficiently stable to allow the model to give a fully ev-\nidenced prediction, a K-fold cross validation results in sparser interactions in the bins,\nwhich can be indicated by the connectivity of the matchup network, i.e., Borda count\nor Copeland count for directed graphs. However, in the challenging MovieLens100K\nand Dota datasets, the resultant heterogeneous interactions between players prevent us\nfrom providing evidenced dominance prediction from the observed sparse networks. A\ntrivial solution for such a case is a random guess, which is meaningless for intransitivity\nrecovery. The above two facts hold for all the competitive methods."}, {"title": "5 Conclusion", "content": "In this paper, we focused on the issue of modeling intransitivity and representation\nlearning for players involved in pairwise interactions. We proposed a generalized em-\nbedding formulation for learning the intransitivity-compatible representation from pair-\nwise matchup data, and provided a theoretical characterization of the properties of the\nproposed formulation in terms of symmetry and expressiveness. We also tailored an ef-\nficient solution to the constraint optimization problem and verified the expressiveness of\nthe proposed model by bridging it to former models. A thorough quantitative statistics\nanalysis of the existing intransitivity in various real-world datasets was presented. To\nthe best of our knowledge, it is the first of this kind in the data mining community. The\nresults of the experiments based on real-world datasets show that our method achieves\na better performance than the competitive models, i.e., the state-of-the-art BC model."}]}