{"title": "NEST: A Neuromodulated Small-world Hypergraph Trajectory Prediction Model for Autonomous Driving", "authors": ["Chengyue Wang", "Haicheng Liao", "Bonan Wang", "Yanchen Guan", "Bin Rao", "Ziyuan Pu", "Zhiyong Cui", "Chengzhong Xu", "Zhenning Li"], "abstract": "Accurate trajectory prediction is essential for the safety and efficiency of autonomous driving. Traditional models often struggle with real-time processing, capturing non-linearity and uncertainty in traffic environments, efficiency in dense traffic, and modeling temporal dynamics of interactions. We introduce NEST (Neuromodulated Small-world Hypergraph Trajectory Prediction), a novel framework that integrates Small-world Networks and hypergraphs for superior interaction modeling and prediction accuracy. This integration enables the capture of both local and extended vehicle interactions, while the Neuromodulator component adapts dynamically to changing traffic conditions. We validate the NEST model on several real-world datasets, including nuScenes, MoCAD, and HighD. The results consistently demonstrate that NEST outperforms existing methods in various traffic scenarios, showcasing its exceptional generalization capability, efficiency, and temporal foresight. Our comprehensive evaluation illustrates that NEST significantly improves the reliability and operational efficiency of autonomous driving systems, making it a robust solution for trajectory prediction in complex traffic environments.", "sections": [{"title": "Introduction", "content": "The ability to predict the future paths of surrounding vehicles with precision is not just an academic pursuit-it's a life-saving technology at the heart of autonomous driving (AD). In the bustling dance of traffic, where vehicles, pedestrians, and cyclists move in a complex choreography, even a moment's hesitation can lead to disaster (Pourkeshavarz, Sabokrou, and Rasouli 2024). Thus, the quest for an efficient model that can foresee these movements with high fidelity is more than a goal; it's a necessity for the next leap in vehicular autonomy (Duan et al. 2022).\nTraditional trajectory prediction models have paved the way, yet they falter under the unpredictable and multifaceted nature of real-world traffic (Wong et al. 2024). One of the significant limitations of current trajectory prediction models is their inability to effectively capture the temporal dynamics of interactions (Chen et al. 2022). Traffic behavior is inherently dynamic, with interactions evolving over time in complex, often unpredictable ways. For instance, a vehicle's maneuver can trigger a cascade of reactions from surrounding vehicles, each adjusting its trajectory based on the observed behavior. Traditional models (Letter and Elefteriadou 2017; Liu et al. 2020), however, often rely on static snapshots of traffic, failing to account for how these interactions unfold over time. This leads to suboptimal predictions that do not accurately reflect the real-world progression of traffic scenarios, ultimately compromising the safety and efficiency of AD systems.\nMoreover, these models frequently struggle with the inherent non-linearity and uncertainty of traffic environments (Wang et al. 2022). Traffic dynamics are influenced by a myriad of variables, including sudden stops, erratic driving patterns, and the unpredictable behavior of pedestrians and cyclists. The non-linear nature of these interactions introduces chaos that many current models cannot adequately address. For example, a pedestrian suddenly crossing the road or a cyclist weaving through traffic can dramatically alter the flow of vehicles, creating a highly unpredictable environment. Traditional models often oversimplify these interactions, leading to inaccurate predictions during unforeseen events (Wong et al. 2024).\nEfficiency represents another significant challenge, especially in heterogeneous urban environments where traffic density is extremely high. In such scenarios, various heterogeneous traffic agents-vehicles, pedestrians, and cyclists-interact, resulting in an exponential increase in the types of interaction relationships (Ramezani, Haddad, and Geroliminis 2015). Each agent may be involved in multiple interaction groups, with each group comprising different numbers of agents. Traditional methods of modeling interactions are often confined to predefined relationships (Lv et al. 2023; Xu et al. 2023), limiting their efficiency in capturing diverse and dynamic interactions. This underscores the necessity for an efficient paradigm that can accommodate diverse interaction relationships in real time.\nTo address these challenges, we propose the NEST (Neuromodulated Small-world Hypergraph Trajectory Prediction) model for autonomous driving. This framework combines the intricate structure of Small-world Networks (Watts and Strogatz 1998) with the expansive reach of hypergraphs (Gao et al. 2022) to enhance interaction modeling and trajectory prediction. Small-world Networks, characterized by high clustering and short path lengths, effectively capture both local and long-range interactions among vehicles, leading to a more accurate representation of traffic dynamics (as illustrated in Figure 1), where even distant vehicles can influence each other's trajectories.\nThe Neuromodulator component adapts this structure to reflect the dynamic and diverse nature of real-world traffic (Grossman and Cohen 2022), ensuring that the model remains robust and responsive to changing conditions. Hypergraphs extend beyond traditional graph structures by allowing hyperedges to connect multiple nodes simultaneously, which is crucial for modeling the collective behavior of traffic agents (Xu et al. 2022), such as groups of pedestrians or a convoy of vehicles merging into a lane. By integrating Small-world Networks and hypergraphs, our model not only predicts trajectories but also provides a comprehensive understanding of vehicular interactions. This fusion addresses the limitations of existing models, offering enhanced efficiency to handle dense traffic, temporal foresight to capture evolving interactions, and contextual integration to consider relevant external factors. Moreover, the dynamic adaptability of our model ensures it can generalize beyond its training datasets, making it suitable for a wide range of scenarios.\nTo sum up, our contributions are threefold:\n\u2022 We introduce a Small-world Network that effectively captures both local and long-range interactions among traffic agents. The Neuromodulator within the NEST model dynamically adjusts the network to contextual information, enhancing adaptability in diverse and dynamic traffic scenarios.\n\u2022 We propose a novel Hypergraph Neural Network (HGNN) for interaction learning. Our unique hyperedge set structure combines hyperedges of different relationship types, providing an efficient framework for modeling complex and diverse interaction dynamics.\n\u2022 We conduct extensive validation of the NEST model using multiple real-world datasets, including nuScenes, MoCAD, and HighD. The results consistently demonstrate that the NEST model outperforms existing methods in various traffic scenarios, showcasing its exceptional generalization capabilities and reliability."}, {"title": "Related Work", "content": "With the significant advancements in deep learning technologies across various domains of autonomous driving (AD), it is natural that researchers have increasingly applied these techniques to the field of trajectory prediction. Initially, trajectory prediction was approached as a time-series forecasting problem, leading to the use of neural networks designed for handling sequential data, such as Recurrent Neural Networks (RNNs) and Long Short-Term Memory (LSTM) networks, as encoders and decoders in these models (Lan et al. 2024; Liao et al. 2024h). A pivotal development in this area was the introduction of Social LSTM by Alahi et al. (Alahi et al. 2016), which first brought the concept of social forces into trajectory prediction, highlighting the importance of understanding interactions between agents.\nBuilding on this foundation, researchers shifted their focus towards modeling interactions from both spatial and temporal dimensions (Liao et al. 2024b,c; Xu et al. 2022; Chen et al. 2024). The use of attention mechanisms further advanced the field, enabling models to capture complex interactions among agents (Liao et al. 2024e; Lan et al. 2024; Liao et al. 2024a). For instance, the Nettraj model (Liang and Zhao 2021) introduced Spatiotemporal Attention Mechanisms with a sliding context window to capture both short- and long-term interactions. However, these attention-based methods often rely on grid-based approaches (Liao et al. 2024g,f), segmenting the scene into fixed grids, which limits their applicability to structured road topologies.\nTo address the limitations of grid-based methods, Graph Neural Networks (GNNs) have emerged as a promising approach, particularly suited for modeling interactions in unstructured and complex urban environments. GNNs excel at representing interactions between vehicles in scenarios where road structures are not strictly defined. For example, the SFEM-GCN model proposed by Du et al. (Du et al. 2024) incorporates three types of graph structures to capture semantic, positional, and velocity information of traffic agents, thereby offering a more comprehensive interaction model. Similarly, the MTP-GO model (Westny et al. 2023)"}, {"title": "Methodology", "content": "Problem Formulation\nThe objective is to predict the future trajectories of surrounding traffic agents within a defined perception range over a specific period. Each agent to be predicted is referred to as the target agent, while all other agents within the perception range are considered as surrounding agents.\nThe NEST model takes two inputs: historical data X spanning the past th time steps, and a high-definition (HD) map M. The historical data $X = [X_0, X_1, ..., X_n]$ includes coordinates, velocity, and acceleration for the target agent $X_0$ and the surrounding agents $X_{i \\in [1,n]}$. n denotes the number of agents. The HD map M records the road topology. The output is the future trajectory Y of the target agent over the prediction horizon $t_f$. Predicting the future trajectories of traffic agents involves addressing various uncertainties rooted in the diversity of driving intentions and the unpredictability of motion. The NEST model addresses these uncertainties by generating multiple predicted trajectories, $Y = [Y_1, Y_2, ..., Y_K]$, where each $Y_i$ corresponds to a distinct intention mode with an associated probability $P_i$. Here, K denotes the number of intention modes. To capture the unpredictable nature of motion within each intention mode, predictions at each time step t in $Y_i$ are represented by parameters of the Laplace distribution: $Y = [x, y, b_x, b_y]$, where x and y are the coordinates, and $b_x$ and $b_y$ are scale parameters reflecting unpredictability of motion.\nModel Overview\nThe proposed NEST model is illustrated in Figure 2. The Hypergraph Forming module forms the interaction hypergraph $G$ with the Neuromodulator and Small-world Network. Then, the Hypergraph Pooling module captures interaction features $F_i$ based on the interaction hypergraph G. Next, the Context Fusion module combines lane features $F_l$ from HD maps M with the interaction feature $F_i$, resulting in a consolidated context feature $F_c$. Finally, the Multi-"}, {"title": "Hypergraph Forming", "content": "The hypergraph is distinguished by its unique structure where a single hyperedge can link multiple vertices. This unique structure makes it particularly well-suited for modeling group-wise interaction relationships among traffic agents. Each hyperedge defines an interaction group, with each vertex connected by the hyperedge representing an agent within that interaction group.\nForming an appropriate interaction hypergraph $G$ is fundamental for efficiently capturing interactions among agents. We define the interaction hypergraph $G = (V,E)$, where V is the set of vertex features, and E is the set of hyperedges. To represent traffic agents as vertices, we define the vertex feature set as $V = F_a \\in R^{(n+1)\\times d}$, where the agent features $F_a$ are obtained through a transformer-based encoder, and d is the hidden dimension of the feature. Specifically, $V = [V_0, V_1, ..., V_n]$, where the feature $V_i$ of vertex i corresponds to the feature $F_{a,i}$ of agent i, with $F_{a,0}$ corresponding to the target agent."}, {"title": "Small-world Network", "content": "In traffic scenarios, agents can be influenced not only by nearby agents but also by distant ones through interactions mediated by intermediate agents. For example, in a car-following scenario, the braking of a leading vehicle can trigger a chain reaction among following vehicles. This reflects the small-world property of traffic, where agents are connected through short interaction chains, similar to social networks. A Small-world Network, characterized by this property, is therefore ideal for modeling interaction relationships among traffic agents.\nTo robustly capture these dynamic interactions, we design a Small-world Network module inspired by the Newman-Watts (NW) model (Newman and Watts 1999) to generate hyperedges. We determine each agent's membership in interaction groups using the clustering coefficient C, which measures the tendency of a vertex to cluster with its neighbors. The clustering coefficient $C_{i,j}$ for each vertex-hyperedge pair is defined as:\n$C_{i,j} = \\begin{cases} 1 & \\text{if } C'_{i,j} \\geq \\alpha \\\\ 0 & \\text{otherwise} \\end{cases}$\nwhere $C'_{i,j}$ = 1 indicates a definite connection between vertex i and hyperedge j, while $C'_{i,j}$ = 0 suggests a potential connection that is less certain.\nThe constructed clustering coefficient matrix C is analogous to the basic regular network in the NW model. To refine the connections between vertices and hyperedges, we re-evaluate the relationships where $C_{i,j}$ is uncertain, applying a connection probability $\\beta$. The final hyperedges are determined as follows:\n$E_{i,j} = \\begin{cases} 1 & \\text{if } C'_{i,j} = 1 \\text{ or } (C'_{i,j} = 0 \\text{ and } \\eta \\leq \\beta) \\\\ 0 & \\text{otherwise} \\end{cases}$\nwhere $E_{i,j}$ = 1 indicates that vertex i is connected to hyperedge j, and \u03b7 is a randomly distributed value in [0, 1].\nIn summary, the process of generating the hyperedge set can be formulated as follows:\n$\\varepsilon = \\Omega(\\nu, \\alpha, \\beta)$\nwhere $\\Omega$ is the Small-world Network."}, {"title": "Neuromodulator", "content": "Human drivers adapt their behavior to ever-changing driving environments based on external stimuli. Inspired by this adaptability, rooted in cellular neuroregulation mechanisms (Vecoven et al. 2020), we developed the Neuromodulator to dynamically adjust the Small-world Network, enhancing its responsiveness to traffic conditions. As shown in Equation 3, the hyperedge set is modulated by two parameters: threshold \u03b1 and connection probability \u03b2, derived from the agent feature $F_a$.\nThe threshold \u03b1 determines which agents are included in an interaction group. To set this threshold, we analyze the distribution of the clustering coefficient matrix C. The threshold neuromodulator $\\Pi_\\alpha$ projects $C \\in R^{(n+1) \\times s}$ into a threshold feature space of $R^{(n+1) \\times 1}$ using two MLP layers, where s is the predefined number of hyperedges. The final threshold $\\alpha \\in [0, 1]$ is obtained using a sigmoid function:\n$\\alpha = \\Pi_\\alpha (C)$\nwhere $\\Pi_\\alpha$ denotes the threshold neuromodulator.\nThe connection probability \u03b2 represents the likelihood of involving additional agents in interaction groups, particularly in high-density traffic. The agent feature $F_a$ encapsulates traffic density, from which the connection probability $\\beta \\in [0, 1]$ is derived using the connection probability neuromodulator $\\Pi_\\beta$, similar to the threshold neuromodulator:\n$\\beta = \\Pi_\\beta(F_\\alpha)$\nwhere $\\Pi_\\beta$ is the connection probability neuromodulator."}, {"title": "Hypergraph Pooling", "content": "The interaction hypergraph explicitly defines the traffic agents in each interaction group, with vertices connected by hyperedges. Unlike traditional graphs, which limit information aggregation to pairs of agents, hypergraphs capture interaction features more efficiently through iterative Vertex-to-Hyperedge and Hyperedge-to-Vertex pooling (Xu et al. 2022). This approach provides a more comprehensive representation of interactions in a traffic scene, leading to more accurate trajectory predictions.\nVertex-to-Hyperedge In this process, the hyperedge serves as a platform for information exchange among vertices in the same interaction group. The Vertex-to-Hyperedge step aggregates features from all connected vertices to form a group feature $F_g$. To align with the requirements for drivers during interactions, $F_g$ should include three types of information: the personality of each traffic agent, their intentions, and the possibility of these intentions. Traffic agents in the same group often adjust their behavior based on others, such as drivers yielding to aggressive counterparts. The agent feature $F_a$ reflects these personalities. We aggregate the features of all vertices connected to the same hyperedge j, denoted as $V = V_i | E_{ij} = 1$, using a"}, {"title": "Hyperedge-to-Vertex", "content": "weighted sum. This sum is then processed by a Multi-Layer Perceptron (MLP) based personality encoder $M_p$ to extract personality information $Z_p$:\n$I_p = M_p(\\sum_V i \\in V \\lambda_i V_i)$\nwhere $\\lambda_i$ is the learnable weight.\nObtaining the various intentions of agent i, along with the degree of willingness to execute each intention, aids the model in predicting future motion. We define the intention information $Z_i = [L_{i,1}, L_{i,2},..., L_{i,k}]$, each $I_{i,j}$ denotes a specific intention. We formulate intention information $Z_i$ as:\n$I_i = \\sigma ((M_i (I_a) + \\xi) /\\tau)$\nwhere \u03c3 is the softmax function, and aggregated information $I_a = \\sum_V i \\in E_j \\lambda_i V_i$. $M_i$ denotes the intention encoder. And following (Xu et al. 2022), we introduce Gumbel distribution $\u03be$ and temperature parameter \u03c4.\nThe degree of willingness for each intention is measured by $I_w = M_w(I_a)$, where $M_w$ is the willingness encoder. After obtaining personality information $I_p$, intention information $Z_i$, and willingness information $I_w$, the group feature $F_g$ if formulated as following:\n$F_g = I_p \\sum_j=1 ^ K L_{i,j}L_{w,j}$\nwhere $I_{i,j}$ and $I_{w,j}$ are the pairs of intention mode j and its associated willingness. K is the number of intentions.\nTo enable traffic agents to obtain relevant information from the hyperedges, we employ the Hyperedge-to-Vertex approach. This method updates each vertex feature $V_i$ based on the group features $F_g$ of the connected hyperedges. During this update process, we consider the group features of all hyperedges linked to the vertex i, denoted as $\\varepsilon = E_j | E_{ij} = 1$. The update process is described as follows:\n$V_i M_V (\\sum_j \\in \\varepsilon \\frac{F_g,j}{\\sum_k \\in \\varepsilon exp (Fg,k)})$\nwhere $F_{g,j}$ is the group feature for hyperedge j, and $M_v$ denotes an MLP-based vertex encoder. After undergoing H iterations of updates, we obtain the refined features for all vertices. To ensure comprehensive consideration of all agents"}, {"title": "Context Fusion", "content": "The environmental context, especially the topology of the lane network, is essential for accurate trajectory prediction. To incorporate this, we employ a context fusion module that integrates lane features $F_l$ with interaction features $F_i$. A Lane Encoder first processes HD maps to generate lane features $F_l$. Then, an attention module combines these with the interaction features to produce the final context feature $F_c$, as defined by:\n$F_c = Attn(Q = F_i, K = F_l, V = F_l)$\nThis approach allows the model to account for the critical influence of lane topology on agent trajectories, enhancing the accuracy and reliability of trajectory predictions by integrating interaction and contextual information."}, {"title": "Multi-modal Predictor", "content": "Driving behavior is inherently uncertain due to both the diversity of intentions at the macro level and the unpredictability of actions at the micro level. To capture this range of behavior, we use a Multi-modal Predictor, where each generator represents a distinct human intention mode. The micro-level unpredictability within each mode is modeled using a Laplace distribution. We employ K generators, each combining the context feature $F_c$ with the agent feature $F_a$ to predict a trajectory $Y_i$, characterized by a Laplace distribution and its associated probability $P_i$."}, {"title": "Experiment", "content": "Experimental Setup\nWe conducted experiments on real-world traffic datasets (nuScenes, MoCAD, and HighD) to showcase the superior-"}, {"title": "Quantitative Results", "content": "The quantitative comparison results for different datasets are detailed in Tables 1, 2, and 3, respectively. Table 1 shows that our NEST model consistently achieves SOTA performance across all metrics on the nuScenes dataset. Notably, it improves the $minADE_5$ metric by 14.5% compared to the best existing model (Zhang et al. 2024), indicating superior trajectory prediction accuracy. Our model also shows significant enhancements in both the $minADE_1$ and $minFDE_1$ metrics, demonstrating comprehensive improvements in predictive capability. Furthermore, as the value of k decreases, the superiority of our model becomes more evident, showcasing its ability to accurately capture the true intentions of agents.\nTo validate the effectiveness of our Neuromodulated Small-world Hypergraph in modeling agent interactions, we tested its performance on the MoCAD and HighD datasets without relying on HD maps. As detailed in Table 2, our NEST model outperforms all competitors across various prediction horizons in the MoCAD dataset, particularly improving accuracy by 16% in the 5-second prediction horizon over the previous best model. Although our model slightly trails the best in short-term (2-second) predictions by just 0.01 meter, it still shows strong performance. Table 3 illustrates our model's superiority on the HighD dataset, focused on highway scenarios. Here, the NEST model achieves significant improvements of 27.3% and 22.6% over the BAT model (Liao et al. 2024d) in the 4-second and 5-second prediction windows, respectively. These results across diverse scenarios highlight the exceptional generalization and predictive capabilities of our NEST model in the real world."}, {"title": "Inference Time Comparison", "content": "To demonstrate the efficiency of our proposed NEST model, we conducted a comparative experiment on inference times on nuScenes dataset. Table 4 presents the inference times of various models, including baseline figures sourced from"}, {"title": "Ablation Studies", "content": "The NEST model is composed of multiple components that collectively yield impressive performance. However, it remains to be seen whether each component significantly contributes to the model's predictive capability. To quantify the impact of each component on the model's performance, we conducted a series of ablation studies. We present detailed ablation variants of the NEST model on the nuScenes dataset in Table 5 and 6. Method F represents the complete NEST model, which achieves the SOTA performance across all metrics, demonstrating the synergistic effect of its components. Method C, which employs a conventional graph neural network to replace hypergraph learning, exhibits the poorest performance across most metrics, highlighting the significance of the Neuromodulated Small-world Hypergraph in accurately learning agent interactions. Method B, which discards the Neuromodulated Small-world Network approach for constructing the interaction hypergraph, exhibits significantly poorer performance across all metrics. Method D, which lacks the context fusion module, also shows degraded performance, indicating the importance of contextual information in driving scenarios for precise trajectory prediction. The results of Method A, and Method E show varying degrees of performance degradation, further confirming the necessity of each component within the NEST model."}, {"title": "Qualitative Results", "content": "In addition to the quantitative analysis, we present the qualitative results from the nuScenes dataset to provide an intuitive understanding of the interaction comprehension capabilities and predictive accuracy of our NEST model. Figure 3 provides a summary of the predictive results across various scenarios for the others model (Chen et al. 2024), ours (NEST model, and its ablated variants\u2014method B and method C). Panels (a) and (b) illustrate the small-world phenomenon in traffic scenarios, where the distant leading vehicle could influence the target agent's behavior. The comparison of various models demonstrates the efficacy of Small-world Networks on interaction modeling within these scenarios. Modeling the inherent uncertainty in driving behavior is crucial for accurate prediction. To demonstrate the NEST model's capability in modeling uncertainty, we present the multimodal prediction results from various models in panel (c). Panel (c) elucidates the proficiency of our NEST in capturing the intention of drivers."}, {"title": "Conclusion", "content": "In this paper, we introduce the NEST model, an innovative framework designed to address critical challenges in trajectory prediction for autonomous driving. By integrating the strengths of Small-world Networks and hypergraphs, NEST captures both local and long-range interactions among heterogeneous traffic agents in an efficient manner. The Neuromodulator component further enhances the model's adaptability to dynamic traffic conditions, ensuring accurate and reliable predictions. Extensive validation across multiple real-world datasets, including nuScenes, MoCAD, and HighD, consistently demonstrates the NEST model's superior performance and generalization capabilities in various traffic scenarios."}]}