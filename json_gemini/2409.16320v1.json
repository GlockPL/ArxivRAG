{"title": "Developing a Thailand solar irradiance map using Himawari-8 satellite imageries and deep learning models", "authors": ["Suwichaya Suwanwimolkul", "Natanon Tongamrak", "Nuttamon Thungka", "Naebboon Hoonchareon", "Jitkomut Songsiri"], "abstract": "This paper presents an online platform showing Thailand solar irradiance map every 30 minutes available at https://www.cusolarforecast.com. The methodology for estimating global horizontal irradiance (GHI) across Thailand relies on cloud index extracted from Himawari-8 satellite imagery, Ineichen clear-sky model with locally-tuned Linke turbidity, and machine learning models. The methods take clear-sky irradiance, cloud index, re-analyzed GHI and temperature data from the MERRA-2 database, and date-time as inputs for GHI estimation models, including LightGBM, LSTM, Informer, and Transformer. These are benchmarked with the estimate from the SolCast service by evaluation of 15-minute ground GHI data from 53 ground stations over 1.5 years during 2022-2023. The results show that the four models have competitive performances and outperform the SolCast service. The best model is LightGBM with an MAE of 78.58 W/m\u00b2 and RMSE of 118.97 W/m\u00b2. Obtaining re-analyzed MERRA-2 data for the whole Thailand region is not economically feasible for deployment. When removing these features, the Informer model has a winning performance in MAE of 78.67 W/m\u00b2. The obtained performance aligns with existing literature by taking the climate zone and time granularity of data into consideration. As the map shows an estimate of GHI over 93,000 grids with a frequent update, the paper also describes a computational framework for displaying the entire map. It tests the runtime performance of deep learning models in the GHI estimation process.", "sections": [{"title": "1 Introduction", "content": "Thailand has targeted to achieve carbon neutrality by 2050 when the power grid will need to accommodate 50% share of renewable electricity generation capacity; see [Ene21]. The most recent draft of Power Development Plan 2024 (PDP2024) for 2024 - 2037 from [Ene24] proposes to add a new solar generation capacity of approximately 24,400 MWp (more than 4 times the amount issued in the previous Alternative Energy Development Plan 2015\u20132036 (AEDP2015) at 6,000 MWp, shown in [Dep15, p.9]. This amount does not yet include behind-the-meter, self-generation solar installed capacities of the prosumers, which is expected to increase at an accelerating rate. Solar integration into the power grid with such a sharp-rising amount will pose technical challenges to the operation and control of the transmission and distribution networks, carried out by the transmission system operator (TSO) and distribution system operator (DSO), as presented in [OB16]. Hence, TSO in Thailand will need an effective means to estimate the solar power generation across the entire transmission network, on an hourly basis, or even finer time resolution, to provide economic hour-to-hour generation dispatch for load following the total net load of the transmission, and to prepare sufficient system flexibility (i.e., ramp-rate capability of the thermal and hydropower plants, or energy storage systems) to cope with the net load fluctuation due to solar generation intermittency for maintaining system frequency stability, concurrently, in its operation. For DSO, a significant amount of reverse power flow when self-generation from solar exceeds self-consumption can lead to technical concerns of voltage regulation and equipment overloading problems. The near real-time estimation of solar generation in each distribution area will enable DSO to activate proper network switching or reconfiguring to mitigate such fundamental concerns to ensure its reliable operation.\nWhile solar energy offers a clean and virtually infinite alternative to fossil fuels, its dependence on sunshine makes it susceptible to fluctuations in weather patterns. This variability, potentially exacerbated by climate change, necessitates the development of accurate solar forecasting technology. The reliability of these forecasts directly impacts the planning (pipeline) of solar photovoltaic (PV) systems, ensuring they are integrated efficiently into the power grid, and also influences the operational settings required for various energy applications.\nGlobal horizontal irradiance (GHI) estimation services provide crucial information in the solar energy industry. These services often provide estimated GHI for a desired location by using a combination of weather models, satellite imagery, and measurements from ground stations. These GHI databases can be divided into i) satellite-derived databases where GHI data were estimated from satellite imagery products, ii) ground-based measurements containing GHI recorded from available monitoring stations, and iii) reanalysis datasets that fuse weather estimates from atmospheric models with historical observations, including GHI data. According to [PWRA+16], Table 6 in the Appendix lists some satellite-derived solar irradiance services that differ from the methods they use and service coverage, dependent on the satellite. Some of the leading services that provide estimates of solar irradiance and power forecasts with global coverage can be described as follows.\nSolarAnywhere provides a core technique called the SUNY model developed in the works from [PH13, PIM+02, PSH+15, PSK+18] that uses satellite imagery and numerical weather predictions to better calculate irradiance under cloudy conditions. SolarGIS by [SC10] uses a semi-empirical solar radiation model with data from satellites for explaining cloud properties. The service also provides site adaptation of Solargis data to improve the quality using ground measurements. PVWatts by NREL;see [Dob13], has an interactive page where the user can input a desired location and PV panel's parameters to calculate monthly solar irradiance and PV power. [ So24] offers solar radiation maps in 15-min resolution. The method relies on HelioClim-3 persistence forecast of a clear-sky index and the use of the Meteosat satellite. SolCast service, detailed in [Bri19], provides solar irradiance forecasts and historical data in several time resolutions. It uses GOES-17, which covers the continental US, and Himawari-8 satellite, which covers Asia and the Pacific, to gather information about cloud opacity and weather conditions. The methodology consists of the REST2v5 clear-sky model, the clear-sky detection model (the BRIGHT-SUN), satellite image processing (cloud repositioning, removing artifacts), and computing a polynomial relationship between k and cloud pixel brightness. The validation of Solcast was presented in all climate conditions (equatorial, arid, temperate, and cold) and sky conditions (clear, cloudy, overall), where the equatorial condition had the widest spread of GHI estimates (RMSE = 115 W/m\u00b2 in clouded-sky condition) due to towering cumulonimbus cloud during storms that make it hardest to find the relationship of k and cloud pixel brightness. The service also estimates PV power when users provide PV metadata such as location, capacity, and panel tilt angle.\nWhile these aforementioned companies provide a wide range of services and use advanced algorithms with several sources of input data, it boils down to the cost of acquiring these solar data for a regional application as the cost often varies with the number of sites. As of March 2024, Thailand has 552 on-grid solar power plants with total capacity of 2,640 MW, shown in Figure 1 (a). Among these solar sites, Figure 1 (b) shows 53 solar sites fully equipped with groud measurements that participates in our study. To accommodate solar energy applications in Thailand in an operational setting, we aim to develop our own solar map that frequently estimates satellite-derived GHI across the country using satellite imagery and local ground measurement. The cost of acquiring irradiance estimates across Thailand (93,061 grids) through commercial services in an operational setting (every 30-minute) is high as compared to a cost of developing our own platform. For this reason, we study literature of satellite-derived GHI estimation techniques in the following sections."}, {"title": "1.1 Physic-based and empirical methods", "content": "Traditionally, physical models use satellite information to solve the radiative transfer model, which simulates how radiation moves through absorption and scatter processes in the Earth's atmosphere. Empirical techniques rely on the statistical relationship between atmospheric parameters and ground observations. The two approaches have been merged into semi-empirical models, which analytically describe a relationship between solar radiation and aerosols in the atmosphere while using satellite information to empirically retrieve the cloud index.\nMethods in this group quantify how much clouds and other particles in the atmosphere are affecting the incoming solar radiation by compensating with a clear-sky scenario. This relationship is often parametrized in physical parameters such as aerosol optical depth (AOD), reflectance, surface albedo, which can be derived from satellite imagery. The Heliosat model is a semi-empirical method with a core principle that combines a clear-sky model with a cloud index through a piecewise-polynomial relationship. [Dag05] used Heliosat algorithm and calculated a new cloud index from reflectivity derived from the Meteosat satellite where a modification was made on computing the ground reflectivity to save computing time. [KBSH18] extracted the brightness temperature difference from various bands of INSAT-3-D satellite to calculate all-day index as information of cloud, dust, and fog. The GHI estimation relied on the Heliosat-2 model and validated on ground measurements in India. The RMSE ranged from 48 to 128 W/m\u00b2 under sky conditions with dust and fog. [VPN+23] presented an improvement over the MAGIC-Heliosat method on calculating apparent reflectance to compute the cloud index. The results were validated with ground stations from the baseline surface radiation network (BSRN) in Australia and Japan regions. The method's performance varied according to evaluation on hourly, daily, and monthly averaged data with RMSE of 161, 80, and 70 W/m\u00b2, respectively.\nWhile the Heliosat model is a well-known method, there are several other semi-empirical approaches for GHI estimation. [QWL+18] showed that Yang's hybrid model (YHM) performed best with RMSE of 27.94 W/m\u00b2 when comparing to ANN on datasets in China. The physical method YHM relies on the radiation-damping processes, e.g., Rayleigh scattering, aerosol extinction, absorption by ozone, water vaport and permanent gas. These atmospheric variables were derived from MODIS satellite. [QHM+19] presented a mathematical formula of GHI as a function of irradiance with zero surface albedo, global reflectance function of atmosphere and surface albebo, which can be derived from Himawari-8 satellite. The results were validated on 3-year ground station data in Australia with MAE of 55.8 W/m\u00b2 and RMSE of 91.7 W/m\u00b2. The GHI model with explicit surface albedo was later used in [QHM+21] but all irradiance components were calculated by pre-computing Look Up Table and using radiative transfer model (RTM). The GHI estimation results were validated on data in Australia with an MAE of 54.7 W/m\u00b2 and an RMSE of 90.3 W/m\u00b2. [BS21] computed the cloud indices using the surface albedo extracted from eight-band imagery of Himawari-8. These cloud indices were converted to clear-sky indices (for all eight bands), and the eight-band clear-sky indices were optimally weighted. The results were validated using data in Singapore, where the scatter plot between the ground-observed clear-sky index and the satellite-estimated values was improved.\nThe accuracy of semi-empirical methods varies during cloudy periods when models might not differentiate clouds' impact on irradiance. However, the methods typically require less computational demand than physical models, so they can be applied to a wide region where calibration might be needed."}, {"title": "1.2 Site-adaptation techniques", "content": "The site-adaption technique adjusts satellite-derived GHI by incorporating available ground measurements to provide estimates at a target location. The correction techniques involve linear multiple regression, distribution mapping (quantile or kernel density distribution), adjusting atmospheric parameters used in the satellite retrieval process, and machine learning techniques; more details in [PWRA+16, PFPS+20].\n[HV22] acquired Himawari-8 satellite images from JAXA and historical data of MERRA-2 product as inputs for REST-2 clear-sky model. The GHI estimation improvement relied on adjusting polynomial coefficients in the Heliosat algorithm, cloud albedo selection and linear bias removal as the site adaptation technique. The results were tested with hourly-averaged ground GHI in Taiwan with MAE of 38.74 W/m\u00b2 and RMSE of 57.42 W/m\u00b2.\nSite adaptation techniques using nonlinear models from machine learning approaches can be found in [STAK22]. The estimated GHI from the Copernicus atmospheric monitoring service (CAM-Rad) service and then corrected the value by calculating a perturbation from ML methods using solar zenith angle, AOD, water vapor, ozone, and cloud information as inputs. Overall, the two best performances were obtained by tree-based models (XG boost and random forest), which yielded an RMSE of 56-57 W/m\u00b2. [VSDL+23] used estimated GHI from HelioClim3, clear-sky index, and zenith angle as inputs for gradient boosting model to correct in both spatial and temporal domain.\nNeural network techniques, which will be presented in the next section, can capture a complex relationship between the satellite data and the corresponding ground-based GHI measurements."}, {"title": "1.3 Neural network techniques", "content": "Deep learning (DL) has become a leading trend in solar energy estimation due to its data-driven nature. It enables the parameters in an artificial neural network (ANN) to be fine-tuned according to the collected data; resulting in less manual customization of input features compared to the previous approaches that rely on the physical and meteorological information.\nSatellite data is the key to extending the coverage of solar forecasting to entire countries. However, the database stations used as the reference for implementing and evaluating solar forecasting are often relatively sparse (e.g., [AMOG14] use only five stations), and the operation and installation can be costly. [SL18] address this limitation by using satellite-based GHI measurements in training, which offer the global irradiance information in Europe and USA; and this work shows that LSTM has the best performance among ANNs but is at a similar level to gradient boosting regression (GBR). Similarly, [YCZ19] tested LSTM on the NSRDB database (USA). Nevertheless, [QWL+18] found that an ANN can still be outperformed by a physics-based model with high-quality inputs, e.g., Yang hybrid model with meteorological and MODIS satellite data, while cloud fraction and solar zenith angle were found the parameters that highly includes the model accuracy.\nSubsequent works further utilize the spatial information from satellite data as the reference to improve the model learning, e.g., solar radiation images in [YDA+20] and satellite-derived GHI in [NIK21]. The ground measurements are discontinuous and sparse, which can be inadequate to represent the regional characteristic of the estimated GHI; see [JLQ+19]. Utilizing the spatial information, e.g., cloud mask [NIK21], spectral images [JLQ+19, YDA+20], infrared images [AMR21], and satellite images [GCM+22], as inputs can promote the continuity. To process the spatial information, these works [JLQ+19, YDA+20, AMR21] attach convolution neural networks (CNN) for image feature encoding. Advanced CNN architectures are used as the IrradianceNet [NIK21] and as the STUNet [GCM+22] that employed ConvLSTMs and 3D-CNNs as image encoders, respectively. The time-series dynamics between satellite images are used in addition to the spatial information as an additional set of inputs. In such cases, LSTM-based models are often used to derive the forecast irradiance in the future timestamp [AMR21, NIK21]. Fusing sky and satellite images can improve forecasting accuracy [PAL23], which outperforms other methods that use only sky or satellite images. However, the sky-image based methods [FZ20, PAL21, PHAL22, LZC+23, ZWSW23, PAL23] focus on single-site forecasting only, which is not suitable for providing the GHI estimates at national level.\nAlthough these satellite-based methods [QWL+18, SL18, JLQ+19, YDA+20, AMR21, NIK21, GCM+22] are promising, they are not applicable in our settings. Specifically, our system promises near real-time solar forecasting for 93,061 grids across Thailand, in which the system first acquires the satellite images from Himawari-8 provided at 10 minutes resolution, and then the satellite-derived GHI estimates are calculated and used to generate the solar map for every 30 minutes. As such, the target data-driven model has to offer a good trade-off between accuracy and efficiency. Thus, our work departs from the previous methods in the following aspects:\n\u2022 Input data and parameters. Unlike previous studies [QWL+18, JLQ+19] that rely on a number of terrain and atmospheric parameters, our model relies primarily on cloud data, with time-based features and the altitude parameter.\n\u2022 Learning reference. Satellite-derived GHI from a physical-based method is used as the reference in model learning such as [SL18, YDA+20, NIK21], but these references are rather indirect compared to the ground GHI measurements. Our setting tunes the model towards the GHI ground measurements.\n\u2022 Runtime requirement. Unlike the CNN-based methods [JLQ+19, YDA+20, AMR21, NIK21, GCM+22] whose CNN operation performs window sliding in each grid, we try to avoid such operation, not only because of the runtime requirement, but also to retain the details of each grid area that is roughly the size of a sub-district in Thailand (\u2248 4km\u00b2).\nOur key contributions are as follows.\n1. A clear-sky model for Thailand's weather condition. We improve the Ineichen & Perez clear-sky mode by re-estimating the Linke Turbidity using nonlinear regression. This is achieved by fitting clear-sky irradiance curve where $T_{L}$ is parameter using the collected ground measurements of GHI from 53-station data.\n2. A methodology that exploits deep-learning or tree-based models to capture a complex relationship between satellite cloud and GHI. To find the best model, we benchmark LSTM, Informer, Transformer, and LightGBM (LGBM) for GHI estimation. Additionally, we improved Informer and Transformer particularly for this application. For LSTM and LGBM, we study the impact of input features. The results show that all these models provide more accurate GHI estimates than the one from a commercial service, SolCast. Our implementation are provided at https://github.com/energyCUEE/solarmap-DL-2024.\n3. A framework that operates in almost real-time implementation (30 minutes) and displays the estimated results across Thailand. Additionally, we provide the real-time solar energy map from the estimated irradiance map at hourly, monthly, and yearly resolution. This solar map can be useful for planning and operating solar energy production."}, {"title": "2 Thailand solar map", "content": "Our Thailand solar map platform is currently running at https://cusolarforecast.com/, where the methodology is a machine learning model that takes input of cloud index, geographical location, and clear-sky irradiance to produce the GHI estimate. The random forest model had been implemented during 2022 to June 2024. Our continuing plan of updating the model has been discussed in [SWH+24], and the goal of this paper is to improve the model, considering other tree-based and deep-learning models. The service is currently running under the deep learning model, the Informer, as to be presented subsequently in Section 4.3. This section describes the map requirement and the available input data resources for developing the GHI estimation model."}, {"title": "2.1 Specification", "content": "Thailand solar map is required to provide the following features to support the service displayed in Figure 2.\n1. The map displays at 2.4\u00d72.4 km\u00b2 resolution within Thailand boundary, and contains 93,061 grids. The map intensity shows the estimated GHI that accounted for cloud information across Thailand and updates every 30 minutes.\n2. The PV icons mark the locations of installed solar power plants, while the CUEE icon is our solar rooftop 8 kW at our research institution (Faculty of Engineering, Chulalongkorn University). The system shows estimated solar power and the cloud index amount extracted from Himawari-8 satellite images at the grids with solar sites installed.\nIn this solar map, we use the information on solar power installed capacities and locations, published on the website of the Office of Energy Regulatory Commission (ERC) at https://www.erc.or.th/en, together with the estimated GHI from our models being updated every 30 minutes by using the cloud images received from Himawari-8 satellite, to estimate solar generated power across Thailand. The current updating frequency of 30-minute intervals is chosen to be consistent with the time resolution of the Unit Commitment program run by TSO. The solar map will also be designed to give convenience to aggregate estimated solar energy within a specified region, for example, in each control region, sub-region of TSO, or substation service area of DSO, employing spatial ensemble techniques thereafter."}, {"title": "2.2 Data resources", "content": "Ground GHI solar sites There are 576 solar sites registered to the Energy Regulatory Commission of Thailand (ERC), where information on locations and installed capacity are provided. Ground measurements of GHI and satellite cloud data are required for model training and validation among these sites. Figure 1 (b), shows 53 sites that record solar irradiance, solar power, ambient and PV module temperature measurements, every 15 minutes from October 2020 to June 2023.\nHimawari-8 The 8th Himawari geostationary weather satellite operated by the Japan Meteorological Agency (JMA) provides 16-channel multispectral images that capture visible light and infrared images of the Asia-Pacific region. A C-band satellite dish and receiving station have been installed at our research institution, CUEE, since February 2022; see Figure 3. There are three types of cloud products: composite images, cloud masks, and colorized images available at https://himawari.optemis.space/archives. We employ cloud mask images and the R-channel of the composite image that has been processed for sun zenith correction and enhanced for smoothness. The R, G, and B channels correspond to 0.6, 0.8, and 10.8 \u00b5m wavelength, respectively. Both the cloud mask and R-channel images have 1670 \u00d7 1725 pixels with the resolution of 2 \u00d7 2 km\u00b2 covering Thailand area (approx. 20.6-5.4\u00b0N, 97.1-106\u00b0E), and are released every 10 minutes. These images in TIFF format contain geographical information. Given an inquired latitude and longitude, we can extract the cloud intensity at the corresponding pixel and convert it to cloud index as $CIM$ (from cloud mask) and $CIR$ (from R-channel) as follows."}, {"title": "Cloud index extraction", "content": "In [PPGB13], the cloud index is calculated by\n$CI = \\frac{X - LB}{UB - LB},$                                                     (1)\nwhere $X$ is the pixel intensity of interest (0-255); UB and LB are the upper and lower bound of the dynamic range at a given point in time and space. In our experiment, LB is zero, and UB is 255. The cloud indices computed from cloud mask, $CIM$, and R channel, $CIR$, were plotted versus the clear-sky index $k(t) = I(t)/I_{clr}(t)$ shown in Figure 4, suggesting that $CIR$ has a stronger anti-correlation with $k(t)$ than $CIM$.\nTo train and infer a GHI estimation model, we must extract CI at a pixel of cloud images that best represents the desired location using GeoTIFF data to find the nearest pixel whose coordinate (latitude /longitude) is closest to the coordinate of interest.\nRe-analysis weather data from NWP (numerical weather prediction) model We currently subscribe to the Meteo Monitoring and the Meteo historical services from https://www.soda-pro.com/. The Meteo monitoring service provides day-ahead GFS weather forecasts by the National Centers of Environmental Prediction (NCEP). At the same time, the Meteo historical contains reanalysis data of solar irradiance and temperature estimates (denoted as $I_{nwp}$ and $T_{nwp}$) with a resolution of 15 minutes retrieved from the MERRA-2 model (Modern-Era Retrospective analysis for Research and Applications). For training, we incorporate the MERRA-2 GHI and temperature as part of the features for GHI estimation models at 53 solar locations.\nCloud data, NWP data, and GHI measurements overlapped from April 2022 to June 2023, resulting in our dataset of 22,906 days or 1,195,257 samples."}, {"title": "3 Methodology", "content": ""}, {"title": "3.1 Ineichen clear-sky model", "content": "A clear-sky model provides a GHI value at a given time and location under a clear-sky assumption. It typically takes date-time to estimate the solar zenith angle or the sun position and uses the location's coordinate to acquire the altitude and other atmospheric parameters. Benchmarking of 75 clear-sky models can be found from [GBL+19, YB20, SBG+21, BBZ+20], where it was reported that the REST2 model is among the best-performing models in the equatorial zone. At the same time, it requires several atmospheric parameters such as aerosol optical depth, total ozone, nitrogen dioxide amounts, or aerosol single-scattering coefficient. Among these 75 models, simplified-Solis model[Ine08a], Kasten, and Ineicen & Perez models require fewer numbers of physical input parameters.\nIn this paper, we consider the Ineichen & Perez clear-sky model [IP02] due to its simplicity in acquiring only one atmospheric parameter, the Linke turbidity. The model is described by\n$I_{clr}(t) = a_{1}I_{0} cos \\theta(t)e^{-a_{2}AM(t)}(f_{h1}+f_{h2} (T_{L}-1)).$ (2)\nThe extraterrestrial irradiance constant, $I_{o}$ = 1366.1W/m\u00b2 is the theoretical value of irradiance on the Earth's surface if the Earth were not surrounded by an atmosphere. The altitude of a desired location, h, is used for computing the constants:\n$f_{h1} = e^{-h/8000}, f_{h2} = e^{-h/1250}, a_{1} = 5.09 \\times 10^{-5}h + 0.868, a_{2} = 3.92 \\times 10^{-5}h + 0.0387,$\nwhere h is retrieved from STRM30 dataset [MC00]. We follow the model of airmass coefficient, AM(t), from [PPGB13] given by\n$AM(t) = \\frac{1}{cos \\theta(t) + 0.50572(96.07995 - \\theta(t))^{-1.6364}}.$                                               (3)\nThe Linke turbidity parameter $T_{L}$ represents the amount of atmospheric absorption by water vapor and aerosol particles that attenuate extraterrestrial radiation. This factor can be obtained via experiments on clear-sky days. Still, it is more common to be empirically estimated [ERA+12], where $T_{L}$ is empirically estimated to best match with local ground measurement of clear-sky irradiance in Thailand.\nWe have set up an experiment to adjust the Linke turbidity coefficients based on ground measurements of GHI from 53-station data. The clear-sky GHI portions are extracted from PVlib clear-sky detection implementation [AHH+23] and split into train:test at ratio 90:10. The training set is divided into 12 months and monthly $T_{L}$ coefficients are estimated separately since the value $T_{L}$ is known to vary seasonally [Ine08b, GL23]. The estimation technique is nonlinear regression to fit the clear-sky GHI curves.\nOther guidelines of $T_{L}$ estimation in Thailand can be found in [JKL03, CC04]."}, {"title": "3.2 Satellite-derived GHI estimation", "content": "The estimation of GHI based on satellite-derived information has two schemes explained in Section 1. The physics-based and semi-empirical methods are typically based on the top diagram in Figure 6. The cloud index extracted from satellite images is an input for an irradiance attenuation model that produces an estimate of clear-sky index. Examples in literature are Heliosat algorithms [RLW04, QOB+17], piece-wise polynomial and rational functions [SWH+24]. The estimated $k$ is then used for compensating a reduction in irradiance through the relationship $\\hat{I} = k \\cdot I_{clr}$.\nInstead of expressing the effect of the cloud on the clear-sky index directly, we propose to use a nonlinear mapping as GHI estimation model to associate cloud index, clear-sky GHI, and other features with the estimate GHI, as shown in the bottom diagram of Figure 6. The non-linear map can better capture complex cloud effects on solar irradiance, and various choices of GHI estimation model can be considered, e.g., tree-based models were validated with a good MAE/RMSE performance in [SWH+24]. Note that the input features for the non-linear mapping are all meteorological variables, especially the cloud index, but not GHI measurements as they are not available spatially across Thailand when deploying the model in practice. The list of features we used in this paper are\nCIM, CIR, $I_{clr}$, $I_{nwp}$, $T_{nwp}$, lat, long, hour, day\nLet x(t) := {CIM, CIR, $I_{clr}$, $I_{nwp}$, $T_{nwp}$, lat, long, hour, day} denotes a vector collecting these input features at time t. Then, the input sequence X is the collection of the input x(t) and its lags, i.e.,\nX = [x(t), x(t \u2212 1), . . ., x(t \u2212 p)]\nwhere p is the length of input sequence. Suppose that $f_{\\Theta}()$ is a GHI estimation model that is data-driven with tuned parameters \u0398. The GHI estimate at time t can be obtained by performing the model inference: $\\hat{I}(t) = f(X; \\Theta)$.\nWhen training a model, it is natural to enforce the similarity between the prediction $\\hat{I}(t)$ and the ground truth I(t). In this study, we benchmark the following methods: LightGBM (LGBM), LSTM, Informer, Transformer, and SolCast service. For SolCast predictions, we have downloaded GHI estimates at 53 stations during the time period of this study. We modified Transformer and Informer to acquire time-series data for solar irradiance forecasting, while building upon existing LSTMs with additional linear layers. The hyper-parameters of these models were tuned and set with the values shown in Table 1."}, {"title": "3.2.1 LightGBM", "content": "LightGBM [KMF+17] (light gradient boosted machine) builds on the concept of gradient boosting decision trees. Light-GBM uses the leaf-wise approach that prioritizes growing trees in informative areas, leading to more accurate models with fewer trees. Also, it has a process to select important features and remove less impactful features from the data. In our case, we provide the following features as the input to the LightGBM:\n$\u0421\u0406\u043c (t \u2212 \u0440), ..., CIM(t), CIR(t \u2212 p), ..., CIR(t), Iclr, Inwp, Tnwp, lat, long, hour, day$\nThe parameter setting of LightGBM is provided in Table 1."}, {"title": "3.2.2 LSTM", "content": "Our LSTM (long short-term memory) neural network is enhanced from that of [SL18] to include L layers of LSTM cells, an activation, a dropout, and a linear layer, as shown in Figure 7a, where X \u2208 $R^{p\u00d7d}$ is fed as the input, and the predicted irradiance $\\hat{I}(t) \u2208 R$ is the output. The LSTM cell is provided in Figure 7b. Its cell state and hidden state are initialized at zero. The LSTM cell recursively processes each input lag from X. For an input x(t - p), the long-term memory $c_{l}(t \u2212 p)$ is updated from the previous $c(t - p - 1)$ and the forget gate $f(t \u2212 p)$. The short-term memory $c(t - p)$ is updated with the input gate $i(t - p)$ and $g(t - p)$. The output gate provides the output $o(t - p)$ and is used to update next hidden state h(t - p). After each recursion, the output is collected as a latent sequence $o(t \u2212 p), ..., o(t)$, fed to Relu activation, dropout layer, and linear layer. The linear layer maps the output sequence into a sequence of GHI estimates $\\hat{I}(t \u2212 p), ..., \\hat{I}(t)$, where the last element is the prediction $\\hat{I}(t)$."}, {"title": "3.2.3 Transformer", "content": "We modify the Transformer [VSP+17] by, first, applying the attention mechanism to capture the dependencies within a time-series sequence and between the pairs of such sequences. Second, the architecture is modified for the shorter sequence, resulting in the encoder-decoder pairs shown in Figure 8a, which is similar to [ZZP+20], except that our input features and target priors are not the target itself. At first, the encoder receives the input sequence X, which calculates the self-attention to capture the dependencies within the sequence itself. Three linear layers (Linear) encode X as Q, K, and V in $R^{pxd}$. The self-attention mechanism can be expressed as follows (and in Figure 8b):\nAtten (Q, K, V) = Softmax $\\Big( \\frac{Q K^{T}}{\\sqrt{d}} \\Big)V$ (4)"}, {"title": "3.2.4 Informer", "content": "The architecture of Informer [ZZP+20] is similar to that of Transformer, except that the generic attention mechanism is replaced with the sparse attention mechanism [LZC+23, ZZP+20]. We further modify Informer for predicting the solar irradiance $\\hat{I}(t)$ by adding the target priors as $T_{prior}$. At first, the score of the queries' sparsity is calculated, and then only the top-u queries with the highest scores are selected to construct a sparse query matrix. Thus, we can construct a sparse query matrix (denoted as $\\bar{Q}$) that contains only the top-u highest sparsity scores. The sparse attention mechanism can be formulated by replacing Q with $\\bar{Q}$ in Equation (4), i.e.,\nSparseAtten ($\\bar{Q}$, K, V) = Softmax $\\Big( \\frac{\\bar{Q} K^{T}}{\\sqrt{d_{k}}} \\Big) V$ (6)"}, {"title": "4 Results and discussion", "content": ""}, {"title": "4.1 Data preparation", "content": "Since cloud cover can vary greatly throughout the day, traditional seasonal patterns become less reliable. It is important to ensure that the data samples in the training, validation"}]}