{"title": "Optimizing Vital Sign Monitoring in Resource-Constrained Maternal Care: An RL-Based Restless Bandit Approach", "authors": ["Niclas Boehmer", "Yunfan Zhao", "Guojun Xiong", "Paula Rodriguez-Diaz", "Paola Del Cueto Cibrian", "Joseph Ngonzi", "Adeline Boatin", "Milind Tambe"], "abstract": "Maternal mortality remains a significant global public health\nchallenge. One promising approach to reducing maternal\ndeaths occurring during facility-based childbirth is through\nearly warning systems, which require the consistent monitor-\ning of mothers' vital signs after giving birth. Wireless vital\nsign monitoring devices offer a labor-efficient solution for\ncontinuous monitoring, but their scarcity raises the critical\nquestion of how to allocate them most effectively. We devise\nan allocation algorithm for this problem by modeling it as a\nvariant of the popular Restless Multi-Armed Bandit (RMAB)\nparadigm. In doing so, we identify and address novel, pre-\nviously unstudied constraints unique to this domain, which\nrender previous approaches for RMABs unsuitable and sig-\nnificantly increase the complexity of the learning and plan-\nning problem. To overcome these challenges, we adopt the\npopular Proximal Policy Optimization (PPO) algorithm from\nreinforcement learning to learn an allocation policy by train-\ning a policy and value function network. We demonstrate in\nsimulations that our approach outperforms the best heuristic\nbaseline by up to a factor of 4.", "sections": [{"title": "1 Introduction", "content": "Each year, more than 250,000 women lose their lives dur-\ning and following pregnancy and childbirth (World Health\nOrganization 2024), with the first 24 hours post-delivery be-\ning particularly perilous (Li et al. 1996; Dol et al. 2022).\nA significant contributing factor to this tragic statistic is the\npoor quality of care available in under-resourced communi-\nties (Crear-Perry et al. 2021). Consequently, there is grow-\ning interest in different ways of improving peripartum care\nto prevent life-threatening complications such as hemor-\nrhage, hypertensive disorders, and sepsis. One key approach\nis through the monitoring of maternal vital signs, which can\nbe used to identify complications early on via early warn-\ning systems that provide an opportunity for timely clinical\nintervention (Vousden et al. 2019).\nIn fact, the World Health Organization (2016) recom-\nmends close monitoring of maternal vital signs in the first 24\nhours after birth, thereby highlighting the importance of ma-\nternal vital signs in high-quality maternal care. Traditionally,\nthis monitoring is conducted by healthcare providers who\nmanually measure vital signs at regular intervals. However,\neven in well-resourced settings, the recommended monitor-"}, {"title": "2 Application, Modeling, and Challenges", "content": "We outline the characteristics of the problem encountered\nin our application domain. Our setting is the maternity unit\nof the Mbarara Regional Referral Hospital (Boatin et al.\n2021, 2023): Mothers arrive at the maternity unit and de-\nliver throughout the day. After delivery, mothers remain in\nthe maternity unit for some time before being redirected to\nother care measures or discharged. Mothers will wear a mon-\nitoring device during some time they spend in the unit.\nWearing a monitoring device has no direct impact on the\nmother's vital signs or health. However, there is a clear in-\ndirect impact: If a monitored vital sign deviates from the\npreset normal range, an alert is sent to the responsible clin-\nician's phone. While some alerts may be disregarded due to\ncapacity constraints or other factors, in most cases, the clin-\nician will visit the patient, manually assess any abnormal\nvital signs, and initiate appropriate clinical interventions if\nneeded. These interventions are expected to positively influ-\nence the mother's health and stabilize her vital signs.\nThere are several external constraints imposed on the al-\nlocation of monitoring devices. First, every mother should\nwear the device for a minimum duration, for instance, the\ninitial two hours after birth, which are particularly high-risk.\nSecond, once a device is removed from a mother, it cannot be\n(easily) reassigned to her, as she will transition to a different\nset of care protocols. Third, each mother is only eligible to\nwear the device for the first 24 hours after birth, as this is the\ntargeted monitoring period for the program. No feature in-\nformation about the mother-such as demographic details or\nhistorical medical data is available to the algorithm, con-\nstituting a safeguard for data privacy.\u00b9 Consequently, the de-\ncision when to remove the device from a mother after her"}, {"title": "2.2 Formal Modeling & Challenges", "content": "We model the problem of allocating monitoring devices us-\ning the popular RMAB framework. An instance of our prob-\nlem consists of a planning horizon $T$, a budget $B$ (the num-\nber of available devices), a discount factor $\\gamma$, a minimum\n$t_{min}$ and maximum $t_{max}$ number of steps a mother should\nbe monitored, and a set $N$ of mothers (from now on called\narms). Each arm $i \\in N$ follows a Markov Decision Process\n$(S_i, A_i = \\{0,1\\}, \\Gamma_i, R_i)$. $S_i$ represents the possible states\nof arm $i$. In our application, states are multidimensional and\ncontinuous and include the current values of the vital signs,\nalong with potentially aggregated statistics like the variabil-\nity of each vital sign over recent time steps. $A_i = \\{0,1\\}$\nrepresents the actions, where 0 denotes the passive action\nand 1 denotes the active action, i.e., allocate a device to the\nmother. $\\Gamma_i$ describes the parameters characterizing how arm\n$i$'s state evolves from one step to the next conditioned on the\ntaken action.\u00b2 $R_i: S_i \\rightarrow R$ is the reward function of arm $i$,\npenalizing states where vital signs fall significantly outside\nthe normal range, indicating potential complications. Addi-\ntionally, each mother has an arrival $\\alpha_i \\in [T]$ and departure\ntime $\\beta_i \\in [T]$. We assume that the state space $S$ and reward\nfunction $R$ are the same for each arm and are known. In con-\ntrast, $\\Gamma_i$ is arm-specific and unknown. Additionally, $\\alpha_i$ and\n$\\beta_i$ are also arm-specific and are revealed at the correspond-\ning timestep. At each timestep $t \\in [T]$, an arm $i$ is present\nif $t \\in [\\alpha_i, \\beta_i]$. Let $N_t$ be the set of arms present at time $t$.\nThe goal is to learn a policy $\\pi$ that maps the set of currently\npresent arms and their current states $s \\in S^{|N_t|}$ to an action\nvector $a \\in \\{0,1\\}^{|N_t|}$, such that for each $t \\in [T]$ and $i \\in N_t$:\n1. $\\Sigma_{j\\in N_t} a_j \\leq B$,\n2. $a_i = 1$ if $t \\in [\\alpha_i, \\alpha_i + t_{min} - 1]$,\n3. $a_i = 0$ if $t > \\beta_i$ or $t > \\alpha_i + t_{max}$, and\n4. $a_i = 0$ if there is some step $t' \\in [\\alpha_i, t]$ in which $i$ was\nassigned the passive action.\nThe goal is to find such a policy that max-\nimizes the accumulated discounted reward:\n$\\Sigma_{t\\in[T]} \\gamma^{t-1}E_{s\\sim \\Gamma(N_t,\\pi)} \\Sigma_{i\\in N_t} R(s_i)$. Note that due to\nthe allocation constraints, allocation decisions only need\nto be made when a new arm arrives. At that moment, the\nalgorithm must assign the active action to the new arm (due\nto the minimum monitoring period). The \"only\" decision\nthe algorithm needs to make is which arm should be flipped\nfrom the active to the passive action, i.e., from which mother\nwe take the monitoring device needed for the new mother.\nOur problem introduces three novel as-\npects that set it apart from existing work in restless bandits:"}, {"title": "3 Methodology", "content": "To address the novel challenges arising in our application\ndomain, we employ an actor-critic approach using Proxi-\nmal Policy Optimization (PPO) for policy updates, which\nis widely used in reinforcement learning. Our algorithm re-\nquires access to a simulator \u201cSimulate(i, si, ai)\u201d of the envi-\nronment that takes as input an arm, its current state, and its\naction and outputs the new state of the arm. The idea is to\ntrain a policy using Algorithm 1 which has access to the sim-\nulator and then deploy the learned policy in the real-world,\nwhich ensures the required high-quality decision-making\nfrom the start (Zhao et al. 2024).\nThe actor is a policy neural network that takes as input\nthe current state of an arm and outputs the action probability\nfor both possible actions. We let $\\theta(a | s)$ denote the action\nprobability for action $a \\in \\{0,1\\}$ returned by the network\non input $s \\in S$. We act on the arms with the highest proba-\nbility for the active action. Thus, the output of this network\ndetermines which arms are assigned the active action. The\ncritic is another neural network that takes as input the state\n$s \\in S$ of an arm and outputs the baseline estimate $V(s)$,\nwhich is the expected total discounted reward generated by\nthis arm starting from state $s$ assuming that actions are taken\nfollowing the action probabilities returned by the policy net-\nwork. The critic network is used for updating the policy net-\nwork via the PPO algorithm. Importantly, both networks are\nshared among all arms, enabling arms to learn from each\nother this is crucial because each arm remains in the sys-\ntem for only a limited time.\nAlgorithm 1 proceeds in multiple epochs. For training\npurposes, each epoch deals with a separate set of arms."}, {"title": "4 Experiments", "content": "We present our experiments using data from a publicly ac-\ncessible de-identified vital sign database, which offers rich\nand high-quality data for conducting comprehensive experi-"}, {"title": "4.1 Setup", "content": "The experiments in this section are based on data\nfrom the widely used MIMIC-III (Johnson et al. 2016) and\nMIMIC-IV (Johnson et al. 2023) datasets, which have be-\ncome popular and influential in computer science research.\nBoth datasets contain de-identified clinical data from thou-\nsands of patients who stayed in critical care units at Beth Is-\nrael Deaconess Medical Center in Boston over different pe-\nriods, including vital sign measurements typically recorded\nat one-hour intervals. In our experiments, each arriving arm\ncorresponds to a new patient entering the critical care unit.\nFor MIMIC-III, we use the vital signs (i) heart rate, (ii) speed\nof breathing (respiratory rate), and (iii) blood oxygen satu-\nration (SPO2), while for MIMIC-IV, we use (i) heart rate,\n(ii) respiratory rate, and (iii) skin temperature. We normalize\neach vital sign between 0 and 1 using min-max normaliza-\ntion. For each patient, we take the median vital sign value at\neach hour. Thus, one timestep corresponds to one hour. We\nexclude patients with fewer than 10 data points.\nThe state representation of patients includes,\nfor each vital sign, its current value and the variance of the\nvalue over the last five timesteps. The reward function as-\nsigns a reward of 0 if all vital sign values fall within the\nnormal range. For each abnormal vital sign, we incur a neg-\native reward that shrinks exponentially with the extent of the\ndeviation from the normal range.\u00b3 The exponential penalties\nmodel the increasing severity associated with larger devia-\ntions from the normal range.\nThe patient's behavior is governed by a multivariate Gaus-\nsian distribution defined over the vital sign values in the cur-\nrent step and in the next step. We sample the initial state of\na patient from this distribution by taking a sample and using\nonly the sampled vital sign values in the current step. Under\nthe passive action, the next state is sampled from the con-\nditional distribution of the Gaussian, given the current state.\nUnder the active action, we make a case distinction. If all vi-\ntal signs are within the normal range, the state transitions as\nunder the passive action since no alert is triggered, and the\ndevice does not influence the patient's trajectory. If any vital\nsign is abnormal, with a probability of 30%, the state tran-\nsitions as under the passive action (modeling cases where\nclinicians do not respond to the alert, which occur approxi-\nmately 30% of the time in the study by Boatin et al. (2021,\n2023)). Otherwise, the abnormal vital signs are probabilisti-\ncally adjusted towards the normal range before sampling the"}, {"title": "4.2 Results", "content": "We set $T = 100$, $t_{min} = 3$, $t_{max} = 25$, and\nassume that patients leave 50 steps after they join. We vary\nthe budget $B$. Initially, there are $B$ patients, and every five\nsteps new patients join. We report the number of patients $N$,\nwhich describes the \u201ctypical\u201d number of patients in the sys-\ntem. The inner workings of our instances are best understood\nby looking at a concrete example: Let us consider $B = 3$ and\n$N = 20$. Initially, there are $B = 3$ patients, and every five\ntimesteps, two (i.e., $N/10$) new patients arrive. Since each pa-\ntient leaves 50 steps after they join and every five steps two\npatients arrive, the number of patients in the system gradu-\nally grows to 20 and stabilizes at 20. Importantly, at every\npoint at which the algorithm makes an allocation decision,\nthere are only few patients to pick from. In this instance,\nthere are five: two (i.e., $N/10$) newly arriving patients and\nthree (i.e., $B$) existing patients who currently hold a device.\nIt remains to describe how we sample patients' transition\nparameters. For this, we fit a weighted mixture of five\nmultivariate Gaussians (i.e. five components) on the dataset,\nwhere we partition all trajectories into tuples that include\nthe vital signs in the current and next step. When we sample\na patient, we first select a component from the Gaussian\nmixture based on the component's weights. This determines\nthe initial mean and covariance of the patient. To introduce\nvariability, we linearly combine this mean and covariance\nwith those of another randomly selected component, using\na weight uniformly sampled between 0 and 0.15.\nWe refer to NoAction as the policy that does\nnot allocate any monitoring devices. All other baselines re-\nspect the allocation constraints. Recall that this means that\nthey only need to make a decision if a new patient appears.\nThen, the algorithm needs to decide from which patient cur-\nrently holding a device and having already been monitored\nfor $t_{min}$ steps, we remove the device.\nSelects the patient with the least ab-\nnormal vital signs, i.e., the patient with the lowest\nsummed normalized vital sign values (where SPO2 is in-\nverted, as lower values indicate abnormality).\nSelects the least stable patient,\ni.e., the patient with the highest summed variance of vital\nsigns over the past five steps.\nis particularly intuitive, as it allocates the\ndevices to the patients generating the lowest reward.\nFor each considered setting, we\naverage our results over 100 seeds. For each seed, we do the\nfollowing: We train our algorithm for $n_{epoch} = 50$ epochs.\nAt the beginning of each epoch, we create a new instance by\nsampling a fresh set of $N$ arms. Subsequently, we evaluate\nthe trained policy along with various baselines on 50 newly\ngenerated instances and compute the average rewards. Both\nin testing and evaluation, patients transition according to the\nsimulator as described in Section 4.1."}, {"title": "5 Maternal Care in Mbarara: Initial Results", "content": "We revisit the specific application of maternal care in\nMbarara discussed in Section 2.1. We have access to con-\ntinuous vital sign measurements from 100 patients collected\nusing monitoring devices at the Mbarara Regional Referral\nHospital.4 As in Section 4, we discretize the trajectories into\n60-minute intervals by taking the median value of each vital\nsign recorded during the interval. The vital signs we consider\nare: (i) heart rate, (ii) respiratory rate, (iii) and blood oxygen\nsaturation (SPO2). The rest of the setup is as in Section 4.\nNote that we can only fit the simulator on the 100 patients'\ntraces available to us (we are working closely together with\nMbarara University of Science and Technology to collect\nmore data and build a more powerful simulator). As a result,\nthe patients' behaviors captured by the simulator are quite\nsimple and less stable compared to the much larger MIMIC\ndatasets. In the absence of complex patterns and interactions\nin the vital signs generated by the simulator, simpler algo-\nrithms (e.g., the random strategy) are expected to show im-\nproved behavior. A key question we wish to address in this\nsection is whether the limited dataset already provides ev-\nidence that a purely random strategy is insufficient and a"}, {"title": "6 Path to Deployment", "content": "While our experiments demonstrate the potential of using\nRL-based algorithms for allocating monitoring devices, sev-\neral important steps remain before real-world deployment.\nWe are currently planning to collect additional vital sign tra-\njectories in the Mbarara Regional Referral Hospital based\non which we want to refine our model, especially regard-\ning the impact of wearing a device. Once the simulator is\ntrained on a larger and more diverse dataset, we will conduct\na rigorous evaluation of the simulator and the learned pol-\nicy, including assessing potential biases, verifying robust-\nness to distribution shifts in patient populations, and making\nnecessary adjustments. Once the policy's decision-making is\nthoroughly validated, we will proceed with obtaining ethics\nand regulatory approval to test the policy in a real-world set-\nting. Recall that, as a safeguard for data privacy, no feature"}, {"title": "7 Conclusion", "content": "We identified the problem of distributing wireless vital sign\nmonitoring devices-particularly relevant in peripartum ma-\nternal care-as a novel resource allocation challenge. We in-\ntroduced an RMAB-style model for this problem, which dif-\nfers from previously studied models in several key aspects.\nOur experiments demonstrate that our RL-based allocation\nalgorithm enables more efficient use of limited monitoring\ndevices. There are several promising directions for future\nresearch. The first is the path outlined in Section 6. Be-\nyond this, the unique characteristics of our setting motivate\nthe study of new variants of RMAB models. For instance,\nit would be interesting to develop algorithms with per-\nformance guarantees for traditional RMAB settings where\narms' MDPs are discrete and known but some of our allo-\ncation constraints must be respected. Our application also\nraises additional algorithmic questions. One notable chal-\nlenge is optimizing the design of alerts sent by monitoring\ndevices: While sending more alerts increases the likelihood\nof an alert being sent before or during a complication, it also\nincreases the burden on clinicians and reduces their respon-\nsiveness to each individual alert. An intricate challenge for\nfuture work is determining optimal thresholds for vital sign\nalerts that strike the right balance between timely detection\nof complications and minimizing alert fatigue."}, {"title": "A Simulator Details", "content": "To define the normal range, we primarily follow the thresholds used for alerts signaling abnormal\nvital sings in the study on vital sign monitoring devices for maternal health in Mbarara (Boatin et al. 2021) featured earlier:\nA heart rate above 120, a temperature above 38C, a respiratory rate above 30, and an SPO2 rate below 90 are considered\nabnormal. Unlike (Boatin et al. 2021), we only use one-sided thresholds here, as our current pipeline is limited to monotonic\nreward functions.\nFor a heart rate h, the penalty is $exp (-|h-120|/17)$. For a temperature t, the penalty is $exp (-|t-38.0|/2)$.\nFor a respiratory rate r, the penalty is $-exp (|r-30|/5)$. For an SPO2 s, the penalty is $- exp (|s-90|/4)$.\nThe following describes what happens to each abnormal vital sing of a patient currently wearing a\ndevice that is examined by a doctor (70% probability). For skin temperature, we reduce it by a sample from a normal distribution\nwith mean 1.5 and standard deviation 0.5; for pulse rate, we sample from a distribution with mean 15 and standard deviation 5;\nfor respiratory rate, we sample from a distribution with mean 10 and standard deviation 3.33. For SPO2, we increase the value\nby a sample from a normal distribution with mean 3 and standard deviation 1."}, {"title": "B Additional Experimental Results", "content": "In this section, we provide additional experimental results."}, {"title": "B.1 Implementation Details of Algorithm 1", "content": ""}, {"title": "B.2 Results for MIMIC Dataset", "content": ""}, {"title": "B.3 Additional Results for Our Method", "content": "Figure 4 demonstrates the Cumulative Distribution Function (CDF) of arm numbers in relation to the number of times they\nwere active (Action 1) within the Minic dataset. The step-like nature of the CDF reflects the probability distribution across the\nrange of active times, showing a gradual increase in cumulative probability as the number of active times grows, ultimately\nreaching 1.0. Notably, all arms have an active action duration larger than the minimum threshold (t_min = 3), and 83.7% of the\narms exhibit an active action duration of less than the maximum threshold (t_max = 25).\nThe analysis in Figure 5 reveals the impact of different state dimensions on the decision to reassign devices from patients who\nalready have them for the MIMIC dataset. Specifically, the first three dimensions, i.e., PULSE_RATE, RESPIRATORY_RATE,\nand COVERED_SKIN_TEMPERATURE, show that a medium value of these three vital signs significantly increases the likeli-\nhood of device reassignment. In contrast, the last three dimensions, representing the variation in vital signs, indicate that lower\nvariability is more likely to lead to a transition from active to passive action, thus triggering the device reassignment.\nNotice that we observe a very similar behavior of our proposed algorithm in Uganda dataset as shown in Figures 6 and\n7. Nevertheless, since Uganda data set has a different vital sign of SPO2, rather than COVERED_SKIN_TEMPERATURE as\nin MIMIC dataset, the analysis in Figure 5 reveals a slightly different result. Specifically, the first dimension, SPO2, shows\nthat a higher SPO2 value significantly increases the likelihood of device reassignment. For the second and third dimensions,\nPULSE_RATE and RESPIRATORY_RATE, medium values are more likely to trigger reassignment. Similarly, the last three\ndimensions, representing the variation in vital signs, indicate that lower variability is more likely to lead to a transition from\nactive to passive action, thus triggering the device reassignment."}]}