{"title": "A DATA-DRIVEN APPROACH TO MODELING BRAIN ACTIVITY\nUSING DIFFERENTIAL EQUATIONS", "authors": ["Kuratov A."], "abstract": "This research focuses on an innovative task of extracting equations from incomplete data, moving\naway from traditional methods used for complete solutions. The study addresses the challenge of\nextracting equations from data, particularly in the study of brain activity using electrophysiological\ndata, which is often limited by insufficient information. The study provides a brief review of existing\nopen-source equation derivation approaches in the context of modeling brain activity. The section\nbelow introduces a novel algorithm that employs incomplete data and prior domain knowledge to\nrecover differential equations. The algorithm's practicality in real-world scenarios is demonstrated\nthrough its application on both synthetic and real datasets.", "sections": [{"title": "Introduction", "content": "One area of focus in machine learning development is the recovery or extraction of differential equations that govern\nthe observed data. This process bridges the gap between fundamental and applied scientific disciplines. The availability\nof extensive data describing complex models in fields such as biology, medicine, physics, economics, and sociology\nfacilitates the improvement of existing models, the development of new ones, and their subsequent verification. This is\ndue to the advancement of methods for recovering governing equations.\nTraditionally, methods have focused on extracting equations from fully resolved data using a variety of libraries and\nprograms for recovering ordinary and partial differential equations. Section 2 provides a classification of these tools,\nhighlighting notable open-source libraries and their applications in equation recovery.\nHowever, this rapidly evolving landscape presents challenges when data is incomplete or when the underlying model\nexceeds the scope of observed variables. This paper aims to address this issue, specifically in the context of brain\nmodelling, with a focus on reconstructing alpha-wave generation models from limited data. By tackling the problem\nlocally, the research seeks to bridge the gap between incomplete data and the desired equation representation."}, {"title": "Related works", "content": "In methods for extracting governing equations from data, we can distinguish two large classes. The first class includes\nalgorithms based on sparse regression and the second class includes algorithms based on neural networks. There are\nalso other methods."}, {"title": "Methods based on sparse regression", "content": "Algorithms in this class use the sparse regression method to recover various types of differential equations. However,\nthe dependencies in these equations are strictly taken from a priori given sets of functions. These sets can be large,\nwhich speeds up calculations. The algorithm requires noise filtering and noise- and emission-resistant methods for\nderiving derivatives from the sets of functions used."}, {"title": "Methods based on neural networks", "content": "A next class of algorithms reconstruct only certain types of equations and are weakly noise and emission tolerant, so\nthe data must be well prepared. The best known, in terms of number of citations, is the PDE-Net-1 [13, 14] algorithm,\nwhich is based on the coupling of ultra-precise neural layers with differential operators. It recovers only parabolic\nequations and requires a considerable amount of data for good recovery. The PDE-Net-2 [15, 16] code is a logical\nextension of the previous one, with the addition of a symbolic multilayer neural network to recover governing equations\nThe HPM algorithm [17, 18] utilises the coupling of neural networks with numerical Gaussian processes to recover the\nmodel. The NeuraDiff [19, 20] code uses two neural networks: one network is used to extract values of physical model\nvariables from experimental data, and the other neural network finds the temporal evolution of the physical model. By\ncomparing the results of the neural networks, the desired model is reconstructed. DeepXDE library [21, 22] is oriented\non physics-informed learning and allows to reconstruct some classes of differential equations."}, {"title": "Other methods", "content": "There are also other methods for obtaining governing equations, e.g. [23] uses symbolic regression based on the graph\nof calculations, [24, 25] first extracts the characteristics of the data and then makes equations based on them. The library\n[26, 27] allows to find Green's functions, which can be useful in certain cases\nThe libraries described above allow to recover governing equations if the full solution of these equations is known.\nHowever, as mentioned above, there are cases when the value observed in the experiment describes only a part of the\nsolutions of the system or a combination of these solutions, and the remaining solutions are unknown. Such a situation\noccurs, quite often in complex systems. For example, brain activity is described by a system of differential equations.\nThe parameters that are visible by measuring devices are electrophysiological data obtained by electroencephalography\n(EEG) or electrocorticography. Such data describe an incomplete combination of solutions of the model system. This\nleads to the problem of how to reconstruct the complete model having only a certain part of the solutions. Obviously,\nthe problem is non-trivial and it is impossible to solve it without a priori knowledge due to the complexity of the system\nand ambiguity of possible results. In 3 the full problem formulation was described."}, {"title": "Problem definition", "content": "In the brain's intricate neural communication, electrical impulses and chemical transmitters play vital roles. Non-\ninvasive yet cost-effective techniques for investigating brain function include electroencephalography (EEG), which\ncaptures electrical potential from the scalp, and electrocorticography (ECOG), involving electrodes implanted directly\ninto the brain for more detailed recordings.\nThe fundamental principle of EEG signals suggests that the captured electrical activity closely reflects the collective\ndynamics of pyramidal neurons, particularly their average firing rate over time. The classical resting-state model,\nexemplified by \u03b1-waves, is based on a single-column model of pyramidal cells, as described by [28]. This model\ninvolves two interneuron-driven feedback loops: one boosts the signal within the pyramidal cells (green circle), while\nthe other dampens it (red circle)."}, {"title": "Our approch", "content": "The main problem of the problem is that the number of visible (measurable) variables is less than the number of unknown\nequations. In general, it is impossible to solve such a problem or it is possible to obtain many solutions. Consequently,\nwe assume that part of the equations or/and some basic characteristics are known a priori. This information can be\nobtained either from reference books and articles[28], or by investigating solutions as in the [24]. For example, to\nunderstand the fundamental frequencies present in an equation one can study the Fourier image of the solution and\nconstruct and study spectrograms.\nSuppose that it is only possible to measure the value y1 - y2 and hence its dependence on time is known. In the problem\nof building a model of the EEG signal, this value is obtained by measurement using microelectrodes. The general form\nof the model equations is also known:\n\\begin{equation}\n\\begin{cases}\n(y_0)\" + \\gamma_0 (y_0)' + \\omega_0^2 y_0 = g_0(y_1 - y_2)\\\\\n(y_1)\" + \\gamma_1 (y_1)' + \\omega_1^2 y_1 = g_1(y_0)\\\\\n(y_2)\" + \\gamma_2 (y_2)' + \\omega_2^2 y_2 + f_2(t) = g_2(y_0)\n\\end{cases}\n\\tag{2}\n\\end{equation}"}, {"title": "Experiments", "content": "Two types of data were used in the experiments. The first type includes synthetic data. These are data obtained by solving\na system describing a model of pyramidal cell population behaviour, from which a signal visible by microelectrodes\ncan be obtained. For simplicity, attenuation was not considered in the model."}, {"title": "Data description", "content": "Two types of data were used in the experiments. The first type includes synthetic data. These are data obtained by solving\na system describing a model of pyramidal cell population behaviour, from which a signal visible by microelectrodes\ncan be obtained. For simplicity, attenuation was not considered in the model.\nThe model equations were as follows:\n\\begin{equation}\n\\begin{cases}\n(y_0)\" + \\omega_0^2 y_0 + f_0(t) = g_0(y_1 - y_2)\\\\\n(y_1)\" + \\omega_1^2 y_1 + f_1(t) = g_1(y_0)\\\\\n(y_2)\" + \\omega_2^2 y_2 + f_2(t) = g_2(y_0)\n\\end{cases}\n\\tag{3}\n\\end{equation}\nwhere $g_i(y) = \\frac{C_i}{1 + \\exp(v_i - \\alpha_i y)}$ [28], the signal measured by the microelectrodes is y1(t) \u2013 y1(t). The synthetic data\nallow us to trace the reconstruction algorithm when the whole system is known, which will allow us to find the strengths\nand weaknesses of the algorithm, as well as to determine the selection criteria for the reconstructed governing equations.\nFigure 2 shows a description of the synthetic dataset and the model that generates it. The left column of graphs shows\nthe model variables yi that are hidden from measurement. The right graphs show the measured variable (y1 \u2013 y2)\nand the functions fi(t), gi(t). In the process of conducting the experiments, a lot of synthetic data corresponding to\ndifferent models were used, the parameters of the used models are presented in tables 1 and 2 of Appendix A. The main\nprinciple of model selection was as follows: many models (~ 103..104) with random parameters from the ranges close\nto real parameter values were generated, and then the signal (y1 \u2013 y2), which resembles typical repeating patterns in\nreal signals, was selected.\nThe second dataset was a set of electrophysiological recordings [30] obtained from implanted electrodes in the primate\nvisual cortex. The data describe the signal of the microelectrodes in the primate resting state. In the resting state,\n\u03b1-waves are generated, a model of which is described in [28]. Data are obtained from 16 implanted arrays of The Utah\nmicroelectrodes of dimension 8 \u00d7 8. Figure 3 (a) and (b) show the location of the microelectrode arrays; inset (c) shows\nthe postprocessing of the microelectrode signal, including filtering and downsampling)."}, {"title": "System of equations without impact", "content": "The first series of experiments is the reconstruction of the system of equations describing the model when the parameters\nof two equations are known. For this case, the general system is as follows:\n\\begin{equation}\n\\begin{cases}\n(y_0)\" + \\omega_0^2 y_0 = \\frac{C_{g0}}{1 + \\exp(\\nu_0 - \\alpha_0 (y_1 - y_2))}\\\\\n(y_1)\" + \\omega_1^2 y_1 = \\frac{C_{g1}}{1 + \\exp(\\nu_1 - \\alpha_1 y_0)}\\\\\n(y_2)\" + \\omega_2^2 y_2 = \\frac{C_{g2}}{1 + \\exp(\\nu_2 - \\alpha_2 y_0)}\n\\end{cases}\n\\tag{4}\n\\end{equation}\nin this equation the values \u03c90, Ci, vi, \u03b1i are known, the unknown quantity is \u03c92.\nFigure 4 shows the graphs describing the given behaviour of the model, the left shows the behaviour of the hidden\nvariables of the model yi, the upper right graph shows the visible signal, the other graphs on the right show the values of\nthe functions fi(t) and gi(y) (see the system (4). This model is characterised by two frequencies \u03c9 = 7 and \u03c92 = 20.\nThe other parameters of the model are presented in the caption to the figure.\nLet us consider the steps of the algorithm in sequence. First, using the known first equation of the system, the known\nfunction g0 (y1 - y2) and the known measured signal (y1 \u2013 y2), we construct, using the explicit Runge-Kutta method\nof order 5, the solutions Yom of this equation for different initial conditions (we assume that the interval of initial\nconditions captures the desired initial conditions). Figure 5 shows the solutions of the equation for different initial\nconditions, with the blue dashed line showing the desired behaviour of y0.\nThe next step is to solve the second equation for the set of initial conditions and for each obtained y0, m. These solutions\ny1, m k (index m corresponds to the initial conditions for y0 and index k for y1) are shown in Figure 6. As in the\nprevious case, the initial conditions are chosen to capture the desired initial conditions."}, {"title": "System of equations with impact", "content": "Let us consider the recovery of a system of differential equations describing models with influence. Such models may\narise in situations where the model itself is underdetermined a priori with accuracy up to a function of time, or if the\nmodel is not closed and has an external connection, i.e. the system receives some external signal (influence).\n\\begin{equation}\n\\begin{cases}\n(y_0)\" + \\omega_0^2 y_0 + f_0(t) = \\frac{C_{g0}}{1 + \\exp(\\nu_0 - \\alpha_0 (y_1 - y_2))}\\\\\n(y_1)\" + \\omega_1^2 y_1 + f_1(t) = \\frac{C_{g1}}{1 + \\exp(\\nu_1 - \\alpha_1 y_0)}\\\\\n(y_2)\" + \\omega_2^2 y_2 + f_2(t) = \\frac{C_{g2}}{1 + \\exp(\\nu_2 - \\alpha_2 y_0)}\n\\end{cases}\n\\tag{6}\n\\end{equation}\nIn the context of the model describing the population of pyramidal cells, the functions fi(t) can describe the effect\non this population of other types of cells that are located in deeper regions of the brain. In the experiments we will\nassume that the values \u03c90, \u03c91, Cgi, vi, \u03b1i are known, f0(t) = 0 and f1(t) = 0, the unknown function is f2(t), and it is\nknown that it has the form Cf sin(\u03c9f t), it is necessary to find its parameters. The choice of the appropriate function is\ndue to the fact that the signal observed in the EEG has an oscillatory nature and probably the difficulty in restoring the\ngoverning equations will be in identifying and separating the various oscillatory terms. It is much easier to identify and\ndescribe trends (if they are present) in such a signal. In the process of conducting experiments, it turned out that for true\nvalues of the functions the system recovery is faster and the convergence criterion reaches small values faster, so this\ncriterion is used to guide the determination of the true governing equation.\nLet us consider a few experiments that will show the general approach to determining the governing equations. The\nsystem sought will be of the form:\n\\begin{equation}\n\\begin{cases}\n(y_0)\" + \\omega_0^2 y_0 = \\frac{C_{g0}}{1 + \\exp(\\nu_0 - \\alpha_0 (y_1 - y_2))}\\\\\n(y_1)\" + \\omega_1^2 y_1 = \\frac{C_{g1}}{1 + \\exp(\\nu_1 - \\alpha_1 y_0)}\\\\\n(y_2)\" + \\omega_2^2 y_2 + C_f \\sin(\\omega_f t) = \\frac{C_{g2}}{1 + \\exp(\\nu_2 - \\alpha_2 y_0)}\n\\end{cases}\n\\tag{7}\n\\end{equation}\nThe last step of the algorithm will search for a differential equation of the form:\n\\begin{equation}\n(y_2)\" + \\omega_2^2 y_2 + C_{f1} \\sin(\\omega_{f1} t) + C_{f2} \\sin(\\omega_{f2} t) +\\\\+ C_{f3} \\sin(\\omega_{f3} t) = \\frac{C_{g2}}{1 + \\exp(\\nu_2 - \\alpha_2 y_0)}\n\\tag{8}\n\\end{equation}\nwhere one of the frequencies \u03c9fi coincides with the desired frequency \u03c9f, the remaining two are different. The expected\ncorrect result of the reconstruction should be: Cfj = Cf if \u03c9fj = \u03c9f and Cfj = 0 if \u03c9fj \u2260 \u03c9f. A description of the\nfirst model is shown in Figure 10."}, {"title": "Equation extraction from real data", "content": "Electrophysiological data acquired by microelectrode in a resting monkey, which was at rest with eyes closed, were\nused to reconstruct the equation describing the model. Articles were used to obtain a priori information and the\nmicroelectrode data were examined. Information from [28] was used to obtain information about the gi(y) functions,\nand Fourier transforms and spectrum studies were used to obtain the characteristic frequencies of the model. Figure\n12 shows the signal obtained from the microelectrode. Orange shows the true signal, green shows the low-frequency\npart of the signal (see figure caption for details), and blue shows the high-frequency part. The signals are shown in\nthe time and frequency domains. The dotted lines show the highlighted frequencies. The low-frequency part of the\nsignal (\"5x200\") is obtained sequentially by 5 running averages with a window of 200 elements. The high-frequency\npart of the signal is obtained as the difference of two parts. The reduced (\"5x10\") is the signal to which the running\naverage with a window of 10 elements was applied 5 times in series, and the subtracted (\"5x50\") is the signal to which\nthe running average with a window of 50 elements was applied 5 times in series\nIn the low-frequency signal it is 0.25 Hz, and in the high-frequency signal it is 4, 6, 7.5 and 17 Hz. Obviously, the overall\nsignal is not a consequence of the model (2), which has only two frequencies, so let us consider the low-frequency and\nhigh-frequency parts separately. The low-frequency part is dominated by the frequency 0.25 Hz, which we will take as\n\u03c90. In the low-frequency spectrum reaches a maximum at frequencies 4 Hz - 7 Hz, but there is one more frequency in\nthe spectrum, at which the maximum is reached on one side, and on the other side it corresponds to the frequency from\nthe model [28] it is ~ 17 Hz, we will take it as \u03c90 to restore the parameters of the model.\nThe low-frequency part of the signal corresponds to the model described by the system (4), for the frequency \u03c90 we take\nthe frequency 2\u03c0 \u00d7 0.25, shown in Figure 12 (green dashed line) and corresponding to the maximum of the spectrum of\nthe low-frequency component.\nFigure 13(a) shows the time-dependent low-frequency component x of the signal, and 13(b) shows the result of the\nalgorithm - the distribution \u03c92 m k. The boundary frequency is \u03c92 = 3.05. For frequencies \u03c90 = 1.5 and \u03c92 = 3.0, the\nsolution of the system (4) was plotted, comparing it with the low-frequency component shown in Figure 14(a). The"}, {"title": "Conclusion", "content": "The result of this research is an innovative algorithm that successfully tackles the difficult task of reconstructing the\nsystem of equations governing EEG signal generation from data. The algorithm overcomes inherent complexity and\nambiguity by integrating a priori knowledge and numerical analysis. Key criteria for equation identification were\nuncovered through its application on synthetic data, along with the significant impact of initial conditions on the\nalgorithm's results. The algorithm demonstrates efficacy on real data by uncovering discernible patterns, suggesting its\npotential effectiveness in modeling brain electrophysiological activity."}]}