{"title": "SPATIAL-VARIANT CAUSAL BAYESIAN INFERENCE FOR RAPID SEISMIC GROUND FAILURES AND IMPACTS ESTIMATION", "authors": ["Xuechun Li", "Susu Xu"], "abstract": "Rapid and accurate estimation of post-earthquake ground failures and building damage is critical for effective post-disaster responses. Progression in remote sensing technologies has paved the way for the rapid acquisition of detailed, localized data, enabling swift hazard estimation through the analysis of correlation deviations between pre- and post-quake satellite imagery. However, discerning seismic hazards and their impacts is challenged by overlapping satellite signals from ground failures, building damage, and environmental noise. Previous advancements introduced a novel causal graph-based Bayesian network that continually refines seismic ground failure and building damage estimates derived from satellite imagery, accounting for the intricate interplay among geospatial elements, seismic activity, ground failures, building structures, damages, and satellite data. However, a notable shortcoming of this model is its neglect of spatial heterogeneity across different locations in a seismic region, which might curtail its precision in encapsulating the spatial diversity of seismic effects and repercussions.\nIn this study, we acknowledge the significance of spatial relationships in estimating post-earthquake scenarios and pioneer an approach that accounts for these spatial intricacies. Instead of relying solely on localized data for each hazard at a specific site, we introduce a spatial variable influenced by the bilateral filter - to encapsulate the spatial relationships from surrounding hazards. The bilateral filter, an advanced computational tool, considers the spatial proximity of neighboring hazards, such as ground failures and building damage, and their ground shaking intensity values, ensuring refined modeling of spatial relationships. This integration captures a nuanced balance between individual site-specific hazard characteristics and overarching spatial tendencies, offering a comprehensive representation of the post-disaster landscape. Our model, tested across multiple earthquake events, underscores the significance of embracing spatial heterogeneity in seismic hazard and damage estimation. The results highlight a marked enhancement in post-earthquake large-scale multi- impact estimation accuracy and efficiency to effectively inform rapid disaster responses.", "sections": [{"title": "1. Introduction", "content": "Due to their destructive nature, earthquakes not only cause direct building damage from ground shaking but also can trigger cascading ground failures like landslides and liquefaction. Along with ground shaking, these ground failures can have significant consequences, including building damage and loss of life. For example, the 2021 Haiti earthquake triggered 7,091 landslides over more than 80 km2 of land, which damaged or destroyed more than 130,000 buildings and led to 2,248 deaths with over 12,200 injured (Havenith et al., 2022; Web, 2021). Rapid assessment of the locations and severity of ground failures and building damage after an earthquake is crucial for the timely rescue of victims during the critical \"Golden 72 Hour\" period, as well as for subsequent disaster recovery strategies (Jang et al., 2009; Li et al., 2023).\nOver the years, researchers have developed various approaches for estimating the location and intensity of earthquake-induced ground failures and building damage. Traditional methods encompass both physical models (Jibson, 2000; Marc et al., 2009; Newmark, 2023) and statistical counterparts (Jessee et al., 2016; Nowicki et al., 2014; Seed and Idriss, 1971; Zhu et al., 2015). Fundamental physical processes form the basis of physical models, exemplified by the Newmark displacement-centric landslide model (Jibson, 2000; Newmark, 2023) and the liquefaction potential index (Zhu et al., 2016). However, their application is limited when geotechnical data are absent. Despite their foundation in primary physical processes, these models can be prone to errors, often from oversimplified representations of intricate physical dynamics. Building fragility curve, a log-normal function that estimates the probability of different damage states from given seismic shaking and building types, is a traditional approach to estimate building damage. However, detailed building- type datasets are often unavailable in large-scale disaster zones, making fragility curves not scalable for rapid disaster impact estimation (FEMA, 2020; Li et al., 2023).\nAlternatively, statistical models are calibrated by leveraging historical data from prior ground failures. They estimate potential failures using geospatial susceptibility indicators, such as slope and lithology, paired with approximated ground motion data that previously triggered similar failures (Jessee et al., 2016; Nowicki et al., 2014). The precision and granularity of these models, however, face restrictions due to constrained access to geospatial attributes and inherent modeling ambiguities. Furthermore, the intricate interplay between geospatial proxies, ground shaking, moisture conditions, and their combined influence on the likelihood of landslides and liquefaction is riddled with spatial relationships and significant uncertainties. An ongoing challenge lies in tailoring and extrapolating such models grounded in historical data to novel events. This is primarily because ground failures can be influenced by nuanced environmental elements that differ with each event.\nRecent advances in remote sensing technologies also play a significant role in earthquake damage assessments. The NASA Advanced Rapid Imaging and Analysis (ARIA) team of researchers developed novel remote sensing methods that allow for rapid ground failure and damage estimates (Harp and Jibson, 2002; Lee, 2005; Zhao and Lu, 2018). Most notably, damage proxy maps (DPMs) harness multi-temporal variations between pre- and post-earthquake satellite imagery to pinpoint changes on the ground surface induced by earthquakes (Yun et al., 2015). DPMs are generated from synthetic aperture radar (SAR) data captured before and after radar reflection-changing events, such as earthquakes or landslides (Loos et al., 2020; Yun et al., 2015). Differences in satellite distance indicate variations in the ground surface, while shifts in spatial correlation suggest alterations in other surface elements, whether natural or anthropogenic (Burrows et al., 2021; Li et al., 2021; Zimmaro et al., 2020). However, imaging-based assessments face difficulties in distinguishing among specific types of changes, such as ground failures, building damages, and noise from vegetation growth and human-made alterations, especially when these alterations have spatial overlap (Kongar et al., 2017).\nRecognizing the complexity of these challenges, researchers have turned to more advanced statistical methodologies, such as the causal graph-based Bayesian network (Xu et al., 2022; Xu et al., 2022; Li et al., 2023). This innovative approach employs a unique structure that perpetually refines the estimates of seismic ground failure and building damage using satellite images by considering the intertwined physical relationships between geospatial attributes, ground movements, structural damage, and satellite imagery. The limitation of this approach, however, is that it did not account for spatial heterogeneity across the different locations. Spatial heterogeneity refers to the variations in the patterns of earthquake-induced hazards or damage across different locations. For example, one area might experience a dense cluster of landslides due to its specific soil and geological attributes, while another region may remain largely unaffected because of its rocky terrain or"}, {"title": "", "content": "because it is shielded by natural barriers such as a hill. The presence of such heterogeneity is also influenced by factors like local topography, land use, and subsurface conditions, which have been reported to play significant roles in determining ground response during earthquakes (Fan et al., 2019). The latest approach (Xu et al., 2022; Xu et al., 2022; Li et al., 2023) primarily focuses on direct causal relations and does not account for the complex nature of these spatial variables and their relationships. As a result, it tends to overlook the nuanced interplay of spatial relationships, leaving room for improvements in both accuracy and comprehensiveness. Recognizing these spatial relationships among neighboring areas is crucial for a more reliable estimation of post-earthquake damages.\nTo address the challenge of spatial heterogeneity in post-earthquake seismic hazard estimation, we have developed a new method to explore the spatial relationships among different locations. Instead of assuming each location to be independent, we studied how these locations may be related to their neighbors in terms of hazard probability and spatial distance. Specifically, we assumed that a location will have a higher chance of having similar hazard probabilities to its neighboring locations as opposed to locations that are far away. For example, if one location has sustained high landslide damage, the nearby areas will have higher probabilities of having experienced landslides compared to locations with greater distance. By integrating such spatial relationships into our model, we can provide a more comprehensive depiction of the seismic landscape, allowing our model to not only integrate data related to ground shaking, seismic ground failures, and impacts that are visible through satellite imagery but also factor in the complicated relationships of nearby locations in a causal graph.\nTo be able to integrate spatial relationships into our seismic hazard estimation model, we employ a method that allows for precise delineation of the boundaries of each location. Bilateral filter is an edge preserving tool used in image-processing whose purpose is to maintain sharp boundaries while reducing noise (Tomasi and Manduchi, 1998; Paris et al., 2009). The significance of the bilateral filter in seismic data analysis lies in its capacity to differentiate and preserve sharp intensity shifts, ensuring that the intricate patterns and nuances of seismic activity are accurately represented. By utilizing the strengths of bilateral filters, we enhance our model's ability to capture and represent spatial relationships more effectively.\nIn light of the evident spatial relationships among neighboring locations and their inherent dependencies, we have initiated research to harness the abilities of the bilateral filter in a novel approach. We aim to approximate seismic ground failures and impacts utilizing the Bayesian network, which has shown to be a powerful tool for deciphering complex casualties among multiple variables from a group of data (Jensen and Nielsen, 2007; Koller and Friedman, 2009; Wasserman, 2004), while paying special attention to spatial relationships in neighboring locations. Our new spatial-variant Bayesian network allows us to encode causal dependencies among ground shaking, seismic ground failures and impacts like building damage, ground surface changes captured by satellite images, as well as the spatial relationships between neighboring locations in a causal graph. Nodes in the Bayesian network symbolize the random variables, and their causal connections are depicted as directed edges. Through Bayesian updating, we can derive the posterior distributions of these random variables by understanding their conditional dependencies. Furthermore, we introduce a spatial variable for each hazard at each location to capture the spatial relationships among adjacent locations, allowing us to represent the patterns and extent of seismic ground failures and impacts more accurately.\nThis work has four main contributions: (1) Introducing a spatial variable for each hazard at every site, thereby capturing the spatial relationships of proximate hazards. (2) Implementing the bilateral filter to calculate a weighted average that is the inverse of the distance to adjacent hazards, thereby representing the more pronounced influence of hazards that are in closer proximity. (3) The holistic integration of individual hazard data with overarching spatial patterns, providing a balanced perspective that combines granular detail with macro trends. (4) A thorough assessment of our revamped methodology across various earthquake events to validate its adaptability and efficacy.\nBy infusing the attributes of the bilateral filter and the Bayesian network, this paper aspires to enhance the reliability and accuracy of earthquake-induced ground failures and building damage assessment on a large scale using InSAR imageries, presenting an avant-garde approach for optimizing post-disaster interventions and support. The structure of this paper unfolds as follows: Section 2 delves into the intricate details of our novel approach, elucidating the introduction of spatial variables, their integration within the causal graph-based Bayesian network, and the specifics of the stochastic variational inference, culminating in the refined algorithm"}, {"title": "2. Methodologies", "content": "In this section, we delve into our spatially variant causal Bayesian method specifically for joint seismic ground failures and impact estimation. Central to our approach is a causal Bayesian network that integrates ground failures, building damage, and remote sensing observations and places a pronounced emphasis on spatial interdependencies among neighboring locations. Following this, we outline a stochastic variational inference technique to derive the posteriors of ground failure and building damage, harnessing the strengths of remote sensing observations and pre-existing geospatial models. Eventually, we present the outline of our optimization framework designed to determine the optimal weights, which encapsulate the statistical relationships among various predictors, ground failure, building damage, and both environmental and anthropogenic noise, as well as remote sensing observations. In subsequent sections, the DPMs previously mentioned are used to represent our remote sensing observations."}, {"title": "2.1. Spatial-Variant Causal Bayesian Network for Jointly Estimating Ground Failures and Impacts", "content": "To jointly estimate ground failures and building damage, we first build a generalized causal graph in Figure 1 to represent the causal relationships among ground failures, building damage, sensing observations, and the spatial relations among the neighboring locations. In our work, we utilize DPMs as our sensing observations.\nIn a location with coordinate, (i,j), we utilize use $y_{i,j}$, which is bounded by [0,1], to refer to our sensing observation. We denote $x_{i,j}^h$ to be the latent variable for ground failures and building damage, and $s_{i,j}^h$ to be the spatial variable, where we employ a bilateral filter to gauge the influence of neighboring hazards on a specific location, adjusting for both proximity and intensity to encapsulate spatial patterns in seismic data, where h\u2208 {Landslide (LS), Liquefaction (LF), Building Damage (BD)}. We assume the latent variable x is a binary variable with a Bernoulli distribution. We also define $\u03b5_{x_{i,j}}^h$ to represent the term of environmental noises for node $x_{i,j}^h$, and $\u03b5_{y_{i,j}}$ the noise for node $y_{i,j}$.\nGiven sensing observations, $y_{i,j}$, we utilize $P(y_{i,j})$ to define the parents of y. We denote $\u03c9_{k,i}$ and $\u03c9_{k,y}$ to quantify the causal effects from a parent node k to a child node i, where k is any parent node of i. All weight nodes $\u03c9_{k,i}$ are defined as deterministic variables. We assume transformations from the parent nodes of sensing observations to y are often modeled as a log-normal (LN) distribution (Xu et al., 2022; Li et al., 2023):\n$y_{i,j}|P(y_{i,j}), \u03b5_{y_{i,j}} \\sim LN (\u03a3_{k\u2208P(y_{i,j})} \u03c9_{k,y}x_k + \u03c9_\u03b5\u03b5_y + \u03c9_0y, \u03c9_{0y} + \u03c9_\u03b5 \u03b5_{y_{i,j}})$  (1)"}, {"title": "", "content": "For ground failures and building damage, we assume the latent variables, $x_{i,j}^h$, have values {0,1}.When LS, LF, or BD happens in location (i, j), $x_{i,j}^h$ = 1, otherwise, $x_{i,j}^h$ = 0. We define a leak node, with index 0, that is always active. It allows its child nodes to be active even when other parent nodes are inactive. We use P($h_{i,j}$) to represent the parents of node $x_{i,j}^h$. The node activation probabilities are defined as follows:\n$p(x_{i,j}^h|P(x_{i,j}^h), \u03b5_{x_{i,j}}^h) = [p(x_{i,j}^h = 1|P(x_{i,j}^h), \u03b5_{x_{i,j}}^h)]^{x_{i,j}^h} [1 - p(x_{i,j}^h = 1|P(x_{i,j}^h), \u03b5_{x_{i,j}}^h)]^{1-x_{i,j}^h}$\n$p(x_{i,j}^h = 1|P(x_{i,j}^h), \u03b5_{x_{i,j}}^h) = \\frac{1}{1+exp(-\u03a3_{k\u2208p(h_{i,j})} \u03c9_{k,h}x_k - \u03c9_{\u03b5_h} \u03b5_{h_{i,j}} - \u03c9_{0h} - \u03c9_{sh}s_{i,j}^h)}$  (2)\nFor each hazard h at each location (i,j), we introduce a spatial variable $s_{i,j}^h$. This variable will represent the spatial effect of hazard h at location (i,j). We define $s_{i,j}^h$ to be influenced by the hazard h at neighboring locations with coordinates {(i \u2212 1, j \u2212 1), (i, j \u2212 1), (i + 1, j \u2212 1), (i \u2212 1, j), (i + 1, j), (i \u2212 1, j + 1), (i, j + 1), (i + 1, j + 1)}. To capture the spatial relations among neighboring locations, we employ a bilateral filter to measure the impact of nearby hazards on a given location, considering both distance and intensity to capture the spatial intricacies within seismic data. The spatial variable is defined to be:\n$s_{i,j}^h = \\frac{1}{M_i} \u03a3_{(i',j')\u2208\u03a9(i,j)} x_{i',j'}^h \u00d7 f_r(\u2206x_{i',j',i,j}) \u00d7 g_s(||(i',j') \u2013 (i,j)||)$  (3)\nwhere $x_{i',j'}^h$ denotes the neighboring locations in the local neighborhood $\u03a9_{i,j}$ around $x_{i,j}^h$. For each $x_{i',j'}^h$ in $\u03a9_{i,j}$, we consider its intensity value $I(x_{i',j'}^h)$, its spatial distance from (i, j), and the intensity difference between $I(x_{i',j'}^h)$ and $I(x_{i,j}^h)$ to compute the filter response. $f_r(\u2206x_{i',j',i,j})$ is the range kernel, which measures the similarity in intensities between the central location $I(x_{i,j}^h)$ and the neighboring location $I(x_{i',j'}^h)$. It is modeled as a Gaussian function, $f_r(\u2206x_{i',j',i,j}) = e^{\\frac{(\u2206x_{i,j} - \u2206x_{i',j'})^2}{2\u03c3^2}}$ , where large intensity differences result in small weights.\nSimilarly, $g_s(||(i', j') \u2013 (i,j)||) = e^{\\frac{((i',j')-(i,j))^2}{2\u03c3^2}}$ is the spatial kernel, which measures the spatial closeness between the central pixel location (i, j) and the neighboring location (i', j'). It is also modeled as a Gaussian function. $M_i$ is a normalization term to ensure the sum of the weights to 1. It is computed as the sum of all the weights given by the product of the range and spatial kernels for all $x_{i',j'}^h$ in $\u03a9_{(i,j)}$.\nUtilizing the above distributions and conditional distribution assumptions, we develop a Bayesian network rooted in the causal graph, adeptly representing the interdependencies among ground failures, building damage, remote sensing observations, and spatial relations. However, the intricate statistical dependencies make the posterior of unobserved variables for ground failures and building damage intractable. To address this, we introduce a stochastic variational inference framework designed to approximate the otherwise elusive posterior concerning unobserved ground failure and building damage."}, {"title": "2.2. Variational Inference for Posteriors Approximation", "content": "With the causal spatial-variant Bayesian network constructed in Section 2.1, we further develop a variational inference algorithm to factorize the Bayesian network and jointly estimate the posterior distributions of latent variables and causal dependencies. We aim to jointly infer the posteriors of the latent variables in the Bayesian network, which represents the target ground failures, building damage, and spatial variables, considering the spatial relations among neighboring locations with unknown parameters of causal dependencies. For each location with coordinate (i,j), we define $q_{i,j}^h$ to be the approximate posterior probability that hazard h at location (i, j) is active. Then, the variational distribution q($X_{i,j}$) that factorizes over hidden nodes is defined to be:\n$q(X_{i,j}) = \u03a0_h (q_{i,j}^h)^{x_{i,j}^h} (1 - q_{i,j}^h)^{1-x_{i,j}^h}$  (4)"}, {"title": "", "content": "We can then derive a tight lower bound on the marginal likelihood of the observed variable y as (Jordan et al., 1999):\n$log p(Y) = \u03a3_{(i,j)} log \u222b p(y_{i,j}, s_{i,j}, X_{i,j}, \u03b5_{i,j}) d(X_{i,j}, \u03b5_{i,j})$\n$\u2265 E_{q(X_{i,j},\u03b5_{i,j})}[log p(y_{i,j}, s_{i,j}, X_{i,j}, \u03b5_{i,j})] \u2013 E_{q(X_{i,j},\u03b5_{i,j})} [log q(X_{i,j}, \u03b5_{i,j})]$  (5)\nTo obtain the final lower bound, we can further derive the first term, $E_{q(X_{i,j},\u03b5_{i,j})}[log p(y_{i,j}, s_{i,j}, X_{i,j}, \u03b5_{i,j})]$, in Equation 5 as:\n$E_{q(X_{i,j},\u03b5_{i,j})}[log p(y_{i,j}, s_{i,j}, X_{i,j}, \u03b5_{i,j})]$ \n$= E[log p(y_{i,j}|P(y_{i,j}), \u03b5_{y_{i,j}})] + \u03a3_h (log p(x_{i,j}^h|P(x_{i,j}^h), \u03b5_{x_{i,j}}^h)) + \u03a3_h E(logp(s_{i,j}^h))$\n$+ \u03a3_h E(log p(\u03b5_{x_{i,j}}^h)) + E(log p(\u03b5_{y_{i,j}}))$  (6)\nwhere:\n$E[p(y_{i,j}|P(y_{i,j}), \u03b5_{y_{i,j}})]$\n$= - log y_{i,j} \u2013 log |\u03c9_{ey}| - \\frac{\u03a3_{m\u2208\u03c9} \u03c9_{m,y} \u03c9_{n,y} a_{m,n} (log y_{i,j})^2 + \u03c9_{0y}^2 + \u03a3_{k\u2208p(y_{i,j})} \u03c9_{k,y} q_k}{2\u03c9_{ey}^2}$\n$- \\frac{(\u03c9_{0y} \u2013 log y_{i,j}) \u03a3_{k\u2208p(y_{i,j})} \u03c9_{k,y} q_k \u2013 \u03c9_{0y} log y_{i,j}}{\u03c9_{ey}}$  (7)\nAccording to Equation 2, for each hidden node $x_{i,j}^h$, where h \u2208 {LS, LF, BD}, we can derive the expectation of the log-likelihood, $E(log p(x_{i,j}^h|P(x_{i,j}^h), \u03b5_{x_{i,j}}^h))$, as:\n$E(log p(x_{i,j}^h|P(x_{i,j}^h), \u03b5_{x_{i,j}}^h)) = q_{i,j}^h E[- log (1 + exp (\u03a3_{k\u2208p(h_{i,j})} \u03c9_{k,h} x_k - \u03c9_{\u03b5_h} \u03b5_{h_{i,j}} - \u03c9_{0h} - \u03c9_{sh}s_{i,j}^h))]$\n$+ (1 - q_{i,j}^h) E[- log (1 + exp (\u03a3_{k\u2208p(h_{i,j})} \u03c9_{k,h} x_k + \u03c9_{\u03b5_h} \u03b5_{h_{i,j}} + \u03c9_{0h} + \u03c9_{sh}s_{i,j}^h))]$  (8)\nwhere the distribution of log-sum-exp term in Equation 8 is intractable. Therefore, we need to get a tight lower bound of the expectation. By Jensen's inequality and Taylor's theorem, we obtain:\n$E(-log(1 + exp t)) \u2265 \u2212 log(1 + E(exp t))$  (9)\nThe lower bound of $E(log p(x_{i,j}^h|P(x_{i,j}^h), \u03b5_{x_{i,j}}^h))$ in Equation 6 is derived as:\n$E(log p(x_{i,j}^h|P(x_{i,j}^h), \u03b5_{x_{i,j}}^h))$\n$\u2265 -q_{i,j}^h log (1 + exp (-\u03c9_{0h} + \\frac{\u03c9_{\u03b5_h}^2}{2} \u2013 \u03c9_{sh}s_{i,j}^h)) (exp (- \\frac{\u03c9_{\u03b5_h}^2}{2}) (\u03a3_{k\u2208p(h_{i,j})} \u03c9_{kh}) q_k + (1 - q_k))$\n$-(1 - q_{i,j}^h) log (1 + exp (\u03c9_{0h} + \\frac{\u03c9_{\u03b5_h}^2}{2} + \u03c9_{sh}s_{i,j}^h)) (exp (\u03a3_{k\u2208p(h_{i,j})} \u03c9_{kh}) q_k + (1 - q_k))$  (10)\nWe employ Monte Carlo estimates to evaluate E(logp($s_{i,j}^h$)), where $s_{i,j}^h$ derived from neighboring values of $x_{i',j'}^h$, a characteristic of the bilateral filter. Given the dependency of $s_{i,j}^h$ on its neighbors, our first step is to sample from p($x_{i,j}^h$). To do this, we draw N samples, denoted as xn, from p(xn), where n represents the sample number, and xn signifies the complete spatial field for the nth sample. For each spatial sample xn, we calculate the value of $s_{i,j}^h$ using the bilateral, factoring in the defined neighboring values at each (i,j) location. Subsequently, we derive log p($s_{i,j}^h$) from the empirical distribution. As x is a binary discrete variable, we tally the occurrence frequency of each distinct value of $s_{i,j}^h$ within the dataset. The probability p($s_{i,j}^h$) is then the"}, {"title": "", "content": "frequency of a specific value divided by the total number of data points N. The Monte Carlo estimate is then computed as the average of the log probabilities, that is, E(log p($s_{i,j}^h$)) =  \u03a3_{n=1}^{N} p($s_{i,j}^h$).\nGiven a map containing a set of locations with coordinates (i,j), we can therefore derive a tight variational lower bound as follows:\n$L(q, w) = \u03a3_{(i,j)} {\u2212 log y_{i,j} \u2013 log |\u03c9_{ey}| - \\frac{\u03a3_{m\u2208\u03c9} \u03c9_{m,y} \u03c9_{n,y} a_{m,n} (log y_{i,j})^2 + \u03c9_{0y}^2 + \u03a3_{k\u2208p(y_{i,j})} \u03c9_{k,y} q_k}{2\u03c9_{ey}^2}  -\\frac{(\u03c9_{0y} \u2013 log y_{i,j}) \u03a3_{k\u2208p(y_{i,j})} \u03c9_{k,y} q_k \u2013 \u03c9_{0y} log y_{i,j}}{\u03c9_{ey}}$\n$+ \u03a3_{h\u2208{LS,LF,BD}} { -q_{i,j}^h log (1 + exp (-\u03c9_{0h} + \\frac{\u03c9_{\u03b5_h}^2}{2} \u2013 \u03c9_{sh}s_{i,j}^h)) (exp (- \\frac{\u03c9_{\u03b5_h}^2}{2}) (\u03a3_{k\u2208p(h_{i,j})} \u03c9_{kh}) q_k + (1 - q_k))}$  + $(1 - q_{i,j}^h) log (1 + exp (\u03c9_{0h} + \\frac{\u03c9_{\u03b5_h}^2}{2} + \u03c9_{sh}s_{i,j}^h)) (exp (\u03a3_{k\u2208p(h_{i,j})} \u03c9_{kh}) q_k + (1 - q_k))} + \u03a3_{h\u2208{LS,LF,BD}} [q_{i,j}^h log q_{i,j}^h + (1 - q_{i,j}^h) log(1 \u2013 q_{i,j}^h)]}$  (11)"}, {"title": "2.3. Stochastic Optimization", "content": "We aim to minimize the loss function, targeting the optimal melding of posteriors and the parameters governing causal dependencies. To achieve this, we employ an expectation-maximization (E-M) algorithm designed to iteratively optimize both the posteriors and causal parameters. Each iteration begins with the selection of a mini-batch of locations, after which the expectation and maximization steps are alternated. The expectation and maximization steps are executed to refine the posterior estimates and adjust the global weight parameters. Upon convergence of the model, we derive the optimal posteriors for landslide, liquefaction, and building damage at every specified location. As for the maximization step, we use stochastic gradient updates on the weights, leveraging the data from the sampled mini-batch. The weight updates for iteration t+1 are computed as follows:\n$w^{t+1} = w^t + \u03c1 A \u2207L(w)$  (12)\nwhere we utilize a positive definite preconditioner, denoted as A, along with a specific learning rate \u03c1, we update the model based on the gradient scheme. The gradients \u2207L(w) correspond to the loss function with respect to the weights. Under certain conditions detailed in (Robbins and Monro, 1951), this gradient update approach ensures convergence to a local maximum of L. Upon model convergence, we secure the optimal posteriors for LS, LF, and BD at every location."}, {"title": "3. Evaluations", "content": "In this section, we evaluate our spatial-variant causal Bayesian inference method for rapid seismic ground failures, which are landslides and liquefaction in our case, and building damage estimation using two events: the 2020 Puerto Rico and the 2021 Haiti earthquakes. We utilize the current USGS ground failure products for landslides and liquefaction, providing individual seismic hazard estimations as our prior ground failure models (Allstadt et al., 2017; Nowicki et al., 2018; Zhu et al., 2015). We also use building fragility curves, which are log-normal functions that estimate the probability of different damage states, given seismic shaking and building types, as the prior model for building damage (FEMA, 2020). We benchmark against the prior models and, as well as the VCBI model detailed in (Xu et al., 2022).\nWe utilize the receiver operating characteristics (ROC) curve and the area under the ROC curve (AUC) as the evaluation metrics. The ROC curve is a graphical representation that illustrates the diagnostic ability of a binary"}, {"title": "", "content": "classifier system as its discrimination threshold varies. It plots the True Positive Rate (sensitivity) against the False Positive Rate (1-specificity) for different threshold values. The Area Under the Curve (AUC) represents the degree or measure of separability, indicating how well the model distinguishes between positive and negative classes. A higher AUC value suggests better classifier performance, with a value of 1 indicating perfect classification and a value of 0.5 denoting no discrimination capability."}, {"title": "3.1. The evaluation results of the 2020 Puerto Rico earthquake", "content": "On January 7, 2020, the southwest region of Puerto Rico experienced an earthquake with a magnitude of Mw 6.4. Following this seismic event, reports indicated that the epicenter's vicinity triggered at least 300 landslides (Allstadt et al., 2022). In response to the earthquake, the ARIA team generated DPMs utilizing SAR images from the Sentinel-1 satellite (ARIA, 2020). Subsequently, a comprehensive field reconnaissance was carried out by specialists from USGS, University of Puerto Rico Mayag\u00fcez, the GEER team, and the StEER team to gather ground truth observations (G\u00fcnay et al., 2020; Miranda et al., 2020).\nEvaluation findings indicate that the posterior liquefaction model, depicted in Figure 2c, aligns more closely with the spatial distribution of ground truth observations shown in Figure 2d compared to the prior models illustrated in Figure 2a. By incorporating the DPM, prior models, and the spatial interconnections of neighboring locations, our model successfully detects a more significant number of liquefaction occurrences that align with ground truth observations, outperforming the existing USGS models. The ROC curves of our model and the baseline models are shown in Figure 4a. The AUC value of our posterior liquefaction model, which is 0.9451, demonstrates that our model outperforms the baseline USGS liquefaction model (AUC: 0.8662) and the VCBI posterior liquefaction model (AUC: 0.9121).\nFigure 3 illustrates the performance of our model in estimating building damage in the quake-affected region, juxtaposed with building footprints and actual ground truth observations. The regions with confirmed building damage as per ground truth observations correspond closely with areas where our model predicts a high likelihood of damage. The AUC metrics highlight the superior performance of our posterior building damage models compared the baseline prior building damage model and the VCBI model. We present the ROC curves for the two baseline models and our model in Figure 4b. With an AUC value of 0.9720, our model exhibits a 13.7% enhancement over the baseline prior building damage model, which stands at 0.8550 and outperforms the baseline VCBI model with an AUC of 0.9309."}, {"title": "3.2. The evaluation results of the 2021 Haiti earthquake.", "content": "On August 14, 2021, a significant earthquake measuring Magnitude 7.2 struck the southern peninsula of Haiti. Subsequent post-disaster evaluations revealed that this seismic event destroyed 53,815 buildings and damaged an additional 83,770 in Grand Anse, Nippes, and Sud regions. The tragedy also resulted in at least 2,248 fatalities (USGS, 2021; Web, 2021). Both the StEER and GEER teams undertook dedicated efforts to gather ground truth data on landslides (LS) and building damage (BD) (GEER, 2021; Kijewski-Correa et al., 2021; Zhao et al, 2021).\nOur evaluation results highlight the enhanced accuracy of our posterior model, as visualized in Figure 5c, especially when juxtaposed against the ground truth observations in Figure 5d. Compared to the prior models in Figure 5a, our higher-resolution landslide model exhibits a more faithful representation of observed landslide occurrences. This precision is underscored by its performance against existing USGS models. Furthermore, the ROC curves for the three models are shown in Figure 4c. When gauged via the AUC metric, our posterior landslide model boasts a value of 0.9373, which is significantly superior to both the baseline USGS landslide model (with an AUC of 0.8951) and the VCBI posterior landslide model (AUC at 0.9032).\nIn the context of the 2021 Haiti earthquake, Figure 6 compares our model's proficiency in estimating building damage against DPMs, building footprints, and actual ground truth observations. A deeper dive into the visualization reveals our posterior model's tendency to assign a heightened probability to locations registering high values on the DPM. As per ground truth data, a congruence"}]}