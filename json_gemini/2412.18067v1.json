{"title": "Automated Materials Discovery Platform Realized: Scanning Probe Microscopy of Combinatorial Libraries", "authors": ["Yu Liu", "Rohit Pant", "Ichiro Takeuchi", "R. Jackson Spurling", "Jon-Paul Maria", "Maxim Ziatdinov", "Sergei V. Kalinin"], "abstract": "Combinatorial libraries are a powerful approach for exploring the evolution of physical properties across binary and ternary cross-sections in multicomponent phase diagrams. Although the synthesis of these libraries has been developed since the 1960s and expedited with advanced laboratory automation, the broader application of combinatorial libraries relies on fast, reliable measurements of concentration-dependent structures and functionalities. Scanning Probe Microscopies (SPM), including piezoresponse force microscopy (PFM), offer significant potential for quantitative, functionally relevant combi-library readouts. Here we demonstrate the implementation of fully automated SPM to explore the evolution of ferroelectric properties in combinatorial libraries, focusing on Sm-doped BiFeO3 and ZnxMg1-xO systems. We also present and compare Gaussian Process-based Bayesian Optimization models for fully automated exploration, emphasizing local reproducibility (effective noise) as an essential factor in optimal experiment workflows. Automated SPM, when coupled with upstream synthesis controls, plays a pivotal role in bridging materials synthesis and characterization.", "sections": [{"title": "I. Introduction", "content": "Combinatorial spread libraries are powerful tools for materials discovery. These libraries typically contain binary or ternary isothermal cross-sections of multicomponent phase diagrams, and more advanced synthesis methods can generate spatially encoded 4D and 5D compositional spaces [1]. This versatility makes them well-suited for both optimizing materials through direct exploration of compositional spaces and advancing physics discovery by exploring property and microstructure evolution [2-10]. Additionally, temperature gradients during synthesis can help reveal the effects of synthesis variables, while localized ion- or laser-based annealing enables broader exploration of the processing and chemical spaces within the selected material systems [8, 11, 12].\nThe first experiments in combinatorial research date back to the 1960s [13, 14], with renewed interest in the 1990s following the discovery of high-temperature superconductors [3, 4, 11, 15-17]. However, it quickly became apparent that successful combinatorial research requires not only synthesis but also detailed characterization, along with the ability to derive insights from characterization results and use these for subsequent experiment planning or transition towards different fabrication routes. Without the capacity to quantify a material's structural and functional properties as a function of composition, progress in materials discovery remains limited [18, 19]. While advances have been made in discovering materials with easily measurable optical properties [20, 21], progress in other material classes has been slower, leading to \u201ccombinatorial winters\u201d similar to the \u201cAI winters\u201d in computing. Additionally, although various compositions across a selected compositional space can be generated, these often correspond to uniform synthesis conditions, while optimal synthesis parameters may vary across compositions. Furthermore, questions persist regarding the relationship between the properties observed in combinatorial libraries and those in corresponding bulk phases. Despite these challenges, multiple strategies are emerging to address these limitations, with characterization remaining the primary bottleneck.\nScanning probe microscopy (SPM) methods are exceptionally well-suited to address the challenges of characterization. Several classes of SPM techniques are intrinsically quantitative and yield information that directly correlates with functional properties of interest [22-25]. For example, piezoresponse force microscopy (PFM) allows for quantitative measurements of electromechanical responses, directly relating to piezoelectric tensor coefficients and hysteresis loop probing [26-28]. Similarly, light-induced Kelvin probe force microscopy (KPFM) can detect photovoltage\u2014a critical aspect of photovoltaic materials functionality [29, 30]. In many cases, current- and microwave-based SPM techniques also yield quantitative data since conductivity variations in materials often exceed tip-surface contact variability and related topographic cross-talks.\nSeveral other SPM techniques offer composition-dependent proxy signals that are closely connected to core functionalities, even if the underlying mechanisms are not fully understood. For example, electrochemical strain microscopy detects bias-induced strain, providing insights into ion concentration, molar volume, and mobility in electrochemically active materials [31-33]. Additionally, ferroelectric and ferromagnetic domain patterns serve as proxies for phase symmetry and material disorder strength, while even simple topographic measurements can indicate growth mechanisms, phase separation, and other structural characteristics [34, 35].\nHowever, SPM measurements are sequential and can be time intensive. Standard SPM imaging typically requires around 10 minutes per location, although faster SPM techniques are available. Spectroscopy measurements across sufficiently large grids, necessary for statistical averaging, further lengthen the process. This presents a baseline for SPM exploration of combinatorial samples. For large-scale samples, additional factors, such as instrument tuning and tip condition monitoring, can significantly increase experiment duration. Given these constraints, grid-based exploration of combinatorial libraries can take 20-30 hours even for binary cases [36], making ternary and more complex compositional spaces prohibitively time-consuming. These challenges underscore the need for machine learning (ML) algorithms to assist in controlling the microscope, tuning parameters, and selecting optimal measurement regions based on optical signals [37, 38]. Developing algorithms capable of efficiently exploring compositional spaces, especially beyond traditional grid-based searches, is particularly important.\nPreviously, we have demonstrated the ML algorithms for physics-based exploration of combinatorial libraries [38-41]; however, in that case selection of location was performed by human operators. More recently, we have demonstrated the automated microscopy exploration of polarization switching at single locations and grid exploration of combi libraries [36, 42]. Here, we for the first time fully operationalize the ML-controlled automated experiment in the SPM including the spectroscopy optimization and combinatorial space exploration. We demonstrate the effect of several possible Gaussian Process engines, and suggest possible benchmarking strategies for the automated SPM."}, {"title": "II. Decision making in automated experiment", "content": "A key aspect of autonomous exploration workflows is the transition from static ML models to active decision-making and execution on the experimental platform. In ferroelectric combinatorial library exploration, the ML agent must initiate operations such as selection of measurement location and large scale stage motion, instrument optimization in the imaging and spectroscopic modes, topographic and PFM imaging, and PFM spectroscopy at specific locations. This involves defining appropriate hyperparameters, including scan size, modulation voltage, setpoints, and spectroscopic parameters. For effective exploration across combinatorial spaces, the ML agent also requires control over probe engagement and retraction as necessary for the large-scale sample stage movement. Although not implemented here, it is worth noting that access to optical data from the instrument camera and the ability to optimize spectroscopic parameters would be essential components. For the instrument used in this study, the connections enabling these functions are described in AESPM (automated experiment on SPM) [43]."}, {"title": "III. Autonomous exploration of Sm-BFO library", "content": "As a first model case, we explored the Sm-doped BiFeO3 (SmBFO) combinatorial library. Here, the BFO side is ferroelectric rhombohedral material, whereas the 20% Sm-doped BFO is orthorhombic non-ferroelectric material. The intermediate concentrations are associated with the formation of the morphotropic phase boundary between crystallographically incompatible materials, often associated with enhanced piezoelectric properties. Previously we have used similar samples for a set of the electron and scanning probe microscopy studies. In particular, we used it for human-executed exploration and grid-based exploration via autonomous microscopy [36], thus providing a natural benchmark for this study.\nNote that the dependence of the hysteresis loop area on concentration exhibits a non-trivial trend that went unnoticed in previous studies [36]. While we expect the simple maximum of the ferroelectric behavior at the morphotropic phase boundary, here we observe the clear two peaks. We attribute this behavior to the ease of switching of materials close to MPB, that leads to the narrowing of the hysteresis loop due to the switching effect of the Vac probing voltage [48, 49]."}, {"title": "IV. Comparison between vBO and nBO on a grid", "content": "We first compare the performance of vBO and nBO based on grid-search data from the SmBFO library, collected at 20 locations with 10 DART spectra at each location. The 10 DART spectra are distributed over 5 spots within a 2 \u00b5m area, as shown in Figure 2-c1, providing a statistical distribution of loop areas. The main characteristics of the average loop area across the composition space shown in Figure 3a align with expected SmBFO behavior: a gradual increase in loop area from 0 to 7-8% Sm, marking the morphotropic phase boundary (MPB) location, followed by a decline toward the non-ferroelectric composition. To establish a baseline for nBO, we use a Gaussian process (GP) model to fit loop area variations based on position, as seen in Figure 3b. More grid-search results can be found in Figure S1.\nIn vanilla Bayesian Optimization (vBO), a single GP is used to fit loop areas (Figure 3c), with uncertainty or confidence intervals derived from the GP model by assuming noise as a constant distribution based on the variability of measured reward functions across locations. In contrast, measured noise Bayesian Optimization (nBO) incorporates an internal GP to fit the experimentally measured variation in reward functions alongside a GP that models the reward functions themselves as shown in Figure 3b. This approach enables nBO in Figure 3ds to make more detailed and precise predictions, as it captures a richer variation profile compared to vBO.\nConsequently, nBO exhibits lower uncertainty in predictions than vBO due to its more accurate handling of measurement variability.\nHowever, it is important to note that nBO is more susceptible to measurement outliers because it places greater trust in individual measurements compared to vBO. For instance, if an experimental outlier occurs due to contamination or topographic interference, nBO may make inaccurate predictions based on that outlier. In contrast, vBO can smooth out the impact of outliers, capturing broader trends by maintaining a larger kernel length and allowing for increased noise tolerance. While nBO generally provides more accurate predictions and captures finer details in the data, it is also more vulnerable to occasional outliers."}, {"title": "V. Implementation of automated exploration workflow", "content": "We implemented fully automated exploration of ferroelectric combinatorial library workflow on an Oxford Instrument Asylum Research Jupiter SPM with a fully motorized large-scale sample stage. Because the probe needs to travel large distances above the sample surface, we map out the sample height on a grid and then interpolate to get the estimated sample height across the library before the automated experiment. This sample height information is used to determine the pre-engage height before landing at a new location to avoid tip crashing.\nEach new exploration step starts with withdrawing the probe to a constant safe height (here we choose 500 \u00b5m) above the sample surface to avoid tip crashing during sample movement. The next sample position to measure is determined by finding the position corresponding to the maximum in acquisition function based on GP fitting of all previously explored positions. After the sample is navigated to the next position to measure by the motorized sample stage, we first zero the cantilever deflection as the free-air deflection can change at different positions. Then the probe is moved to the pre-engage height of 100 \u00b5m above the expected sample surface according to the interpolated sample height \u2013 position relation. After the probe is engaged on the sample surface with a setpoint deflection of 0.5 V, the probe will be positioned to the center of a 2 \u00b5m scan frame to tune the probe in contact, followed by a 2 \u00b5m dual amplitude resonance tracking (DART) PFM [50] map.\n10 DART switching spectroscopy will be performed on a five-point grid in the same area as the DART PFM map, as shown in Figure2-c1. At each point on the grid, the contact tuning is repeated twice before the spectroscopy to make sure the DART can reliably track the contact resonance despite possible variations of sample topography and surface quality. Each DART spectroscopy consists of 5 full sweeping cycles, and we average the extracted reward functions of the last 4 sweeping cycles to get rid of the large resonance frequency drift effect in the first sweeping cycle. The reward at each step is calculated as the average of the rewards extracted from these 10 spectra with the minimum and maximum rewards excluded as outliers. Similarly, the standard deviation of these 10 rewards is calculated as the reward variation. Based on the rewards and their variations measured at different sample positions, we can either fit a vanilla GP or a measured noise GP to predict the distribution and uncertainty of the rewards across the whole library, and make decisions on where to measure in the next exploration step.\nAll the operations described above are controlled by Python script through AESPM interface with Jupiter SPM controller to ensure that the whole exploration is fully automated [43]. To make the automated exploration workflow smooth and efficient, it is critical to allocate appropriate wait time for each operation. For operations that require approximately fixed amount of time, like withdrawing the probe, stage movement, probe approaching and tuning, we tested the timing of them repeatedly and used the maximum required duration with a few extra seconds added for safety. For the operations that produce data files, such as DART PFM scans and spectroscopy, we kept monitoring the data saving folder. The next operation is triggered once a new measurement data file is saved to the disk."}, {"title": "VI. Compare the performance of vBO and nBO in the automated exploration of SmBFO", "content": "In our automated exploration workflow for ferroelectric combinatorial libraries, we aim to identify compositions that maximize loop area while minimizing uncertainty in the loop area-to-composition relationship across the entire library. To achieve this, we define loop area as the area enclosed by the piezoresponse amplitude-bias curves, as shown in Figure 1. The grid-search of the loop area on SmBFO is shown in Figure 2b and has been previously reported in [36].\nThe exploration process starts with five initial seeding measurements, randomly selected on the library. At each seeding position, we measure ten piezo response hysteresis loop spectra using DART PFM, with two measurements at each of five specified spots (red dots in Figure 2-c1). From these ten spectra, we extract ten loop areas, using the average loop area as the scalarizer and the standard deviation as the measured variation of scalarizer.\nIn automated exploration using vanilla Bayesian optimization (vBO), a GP model is constructed to map scalarizers to their corresponding measurement positions. Subsequently, an acquisition function based on the upper confidence bound (UCB) is computed from the GP mean and uncertainty. The next measurement position is determined by maximizing this UCB acquisition function, followed by moving the probe to the selected position. This iterative process continues with a new GP model and acquisition function trained on all acquired data. The exploration stops once the desired uncertainty level is reached or the maximum number of steps is completed.\nIn the measured noise Bayesian optimization (nBO) experiment, we continue to use a GP model to fit scalarizers to positions. However, instead of assuming a constant noise distribution, we add an internal GP to capture the variation of the scalarizer. This internal GP provides a noise prediction for each location. Compared to vBO, nBO incorporates experimentally measured variation as model noise, resulting in more precise predictions and improved decisions for subsequent measurement locations.\nIn the vanilla Bayesian optimization (vBO) approach, the simple GP model captures the loop area-to-composition relationship with near-ideal accuracy, enabling rapid convergence. With proper seeding, the system's essential features are identified within five steps, as evidenced by the stable predictions of loop areas after step 5 in Figure 4a. In contrast, the noise-GP model demonstrates significantly slower convergence, characterized by a rapid reduction in kernel length. Here, each local variation in the response is treated as independent of neighboring measurements, leading the algorithm to lose its ability to generalize across locations. We attribute this outcome to non-material-related factors, including surface topography variations visible in Figure 1. In this scenario, the noise signal primarily reflects surface inhomogeneity; while the simple GP smooths these variations through its kernel function, the noise GP is more susceptible to instability due to noise spikes. Although these issues can, in principle, be mitigated by adjusting kernel priors or the GP process's mean function, the focus here is on operationalizing and benchmarking specific algorithmic approaches."}, {"title": "VII. Autonomous exploration of ZMO library", "content": "After we tested our auto-exploration workflow on SmBFO, we further employed our workflow to explore the ferroelectric combinatorial library ZnxMg1-xO (ZMO), a recently discovered wurtzite ferroelectric material [51]. Here instead of exploring the loop area as a function of composition, we extracted the loop height, defined as the amplitude difference at zero bias in the piezoresponse amplitude\u2013bias curves (the red arrow in Figure 5b), as the reward. As shown in the grid-search of loop height in Figure 5c, the measured loop height shows little difference across the library.\nIn the automated exploration workflow, we used 5 seeding steps plus 20 exploration steps. At each step, 10 DART spectra were measured at 5 grid points in a 2 \u00b5m area. Because ZMO has a higher coercive field compared to SmBFO, we swept the sample bias between +/- 60 V here. As shown in Figure 5d, although there were a few outliers in the beginning of the exploration, vBO was able to predict a loop height \u2013 composition relation well aligned with the grid-search results."}, {"title": "VIII. Autonomous exploration of turn-on bias in ZMO library", "content": "As another example, we explored the turn-on bias in the ZMO library with our automated exploration experiment. As shown in Figure 6a-b, ZMO exhibits different loop sizes and shapes at different sweeping bias. Between 40 V and 50 V sweeping bias, there is a qualitative change of the phase loop as there starts showing 180-degree full phase flip. This loop opening in the phase is also accompanied by an opening in the amplitude curve in Figure 6a.\nTo locate the turn-on voltage precisely, we designed a binary search experiment: at each exploration step, we performed 6 DART spectra. As shown in Figure 6c, we started with an initial sweeping bias of 40 V and an initial voltage step size of 20 V. At the i-th step, the voltage step size is reduced to 20/2i-1 V, and the sign of the voltage step size is determined by whether there is a 180-degree full phase flip observed at the previous step. If we observed a 180-degree phase flip, it means that we already exceeded the turn-on voltage, so we need to reduce the sweeping bias for the next search (a \u201c\u2014\u201d sign). If there is no 180-degree phase flip observed, then we will increase the sweeping bias for the next search. After 6 searching steps, the turn-on voltage can be found with a precision of 0.625 V.\nIn this experiment, we used vBO as the ML agent. We started with 5 seeding points and 25 exploration steps. At each step, we performed 6-step binary search at 5 locations on a grid in 2 \u00b5m area, similar to Figure 2-c1. The averaged turn-on voltage of these 5 binary search experiments is used as the reward function. We excluded the rewards greater than 75 V from the vBO fitting as this indicates that either the sample is not switchable or it requires too-high voltage to switch at that location, which is dangerous to the probe.\nAs shown in Figure 6d, the automated exploration experiment gives consistent turn-on voltage between 50 V and 60 V across the library."}, {"title": "Conclusion", "content": "PFM and, more broadly, SPM offer invaluable capabilities for exploring combinatorial material libraries. By directly detecting material functionalities and leveraging proxy signals, SPM techniques allow detailed characterization across compositional spaces. PFM, in particular, enables precise measurement of electromechanical properties, making it ideal for studying materials like ferroelectrics and piezoelectrics. These tools bridge the gap in high-resolution, quantitative data acquisition, essential for optimizing material properties in combinatorial research.\nHere, we investigated multiple BO algorithms that approach noise handling and scalarization differently, showcasing the importance of tailoring these factors to enhance accuracy and efficiency. The vBO approach uses a straightforward GP model with constant noise assumptions, allowing it to generalize effectively but with limited sensitivity to local variations. In contrast, the nBO incorporates an internal GP model to capture position-dependent noise, providing finer detail in predictions but also making it more sensitive to outliers. These algorithmic comparisons underscore the impact of noise interpretation and scalarizer choice on the reliability and precision of automated SPM-based explorations.\nThe methodologies presented here extend beyond PFM, offering potential applications with other types of probes, such as conductive, electrochemical, and magnetic SPM. By adapting BO algorithms to different types of signals and scalarizers, this approach can be tailored to analyze various material functionalities. This flexibility is essential for advancing autonomous materials exploration across diverse combinatorial libraries and expanding the toolkit available for high-throughput characterization of complex materials. By integrating advanced SPM techniques with machine learning algorithms, this framework offers a path toward a faster materials discovery process. Automation reduces the time and labor involved in exploring vast compositional spaces, minimizing resource consumption while accelerating insights into optimal material properties. As this approach continues to develop, it has the potential to transform combinatorial materials research, driving innovation in areas like energy materials, electronic devices, and beyond."}, {"title": "Methods", "content": "The Sm-doped BiFeO3 (SmBFO) thin film used in this paper was grown on SrTiO3 substrate, with 10% Bi replaced by Sm doping. The detailed growth conditions and characterization can be found in previous publications [40, 52, 53].\nThe ZMO film used in this study was grown by magnetron co-sputtering at room temperature onto a platinized Si substrate. The Pt layer is 50 nm thick with a 5 nm Ti adhesion layer, both deposited by magnetron sputtering at 300 \u00b0C. The ZMO sputtering conditions are 3 mTorr total pressure with gas flows of 18 sccm Ar and 3 sccm 10%O3/90%O2 mix. The ZMO film thickness is 220 nm, grown at a deposition rate of 11 nm/min. The Mg/Zn ratio in the film center is approximately 30/70. Details of ZMO depositions are available in previous publications [51, 54]. Under normal deposition conditions the composition is homogeneous because of a rotating substrate with two sputter guns opposed at 180\u00b0. In the present case, the substrate rotation is turned off thus producing a linear variation in Mg:Zn ratio. EDS analysis estimates the composition variation from Mg:Zn=0.198 to Mg:Zn=0.306 across the measurement zone."}]}