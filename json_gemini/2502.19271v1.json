{"title": "Multiview graph dual-attention deep learning and contrastive learning for multi-criteria recommender systems", "authors": ["Saman Forouzandeh", "Pavel N. Krivitsky", "Rohitash Chandra"], "abstract": "Recommender systems leveraging deep learning models have been crucial for assisting users in selecting items aligned with their preferences and interests. However, a significant challenge persists in single-criteria recommender systems, which often overlook the diverse attributes of items that have been addressed by Multi-Criteria Recommender Systems (MCRS). Shared embedding vector for multi-criteria item ratings but have struggled to capture the nuanced relationships between users and items based on specific criteria. In this study, we present a novel representation for Multi-Criteria Recommender Systems (MCRS) based on a multi-edge bipartite graph, where each edge represents one criterion rating of items by users, and Multiview Dual Graph Attention Networks (MDGAT). Employing MDGAT is beneficial and important for adequately considering all relations between users and items, given the presence of both local (criterion-based) and global (multi-criteria) relations. Additionally, we define anchor points in each view based on similarity and employ local and global contrastive learning to distinguish between positive and negative samples across each view and the entire graph. We evaluate our method on two real-world datasets and assess its performance based on item rating predictions. The results demonstrate that our method achieves higher accuracy compared to the baseline method for predicting item ratings on the same datasets. MDGAT effectively capture the local and global impact of neighbours and the similarity between nodes.", "sections": [{"title": "1. Introduction", "content": "The exponential growth of data across diverse domains, such as e-commerce and social media has elevated recommender systems to the forefront of technology-driven user experiences [1]. Despite their widespread adoption, traditional recommender systems face a significant limitation since they often concentrate on a singular aspect of user preferences [2]. This limitation becomes particularly evident when users evaluate items based on multiple criteria, a common occurrence in domains such as hospitality and entertainment, where items possess diverse features. The emergence of Multi-Criteria Recommender Systems (MCRS) [3] has been prominent in addressing the limitations. MCRS incorporates diverse criteria such as price, quality, and brand to enhance the precision and comprehensiveness of recommendations[4, 5, 6]. These systems not only provide more precise and comprehensive recommendations but also offer enhanced decision-making and flexibility in handling diverse user preferences. They effectively address the limitations of single-criterion recommender systems when evaluating items with multiple features. In recent years, the adoption of deep learning models [7] and graph neural networks (GNNs) [8] in recommender systems has gained substantial attention. These approaches demonstrate significant potential in augmenting recommender systems by capturing intricate relationships among users, items, and attributes and representing them as a graph structure [2, 9]. The embeddings generated by these methods generally exhibit acceptable accuracy in various applications.\nIn the landscape of MCRS, several challenges have been identified, and we discuss them as follows. Firstly, there has been scrutiny on the interpretability of deep learning models, particularly autoencoders [10, 11, 3], and the perceived lack of interpretability poses a hurdle that limits the model's capacity for their meaningful explanation for the recommendations [12]. This issue is compounded by the broader challenges faced by recommender systems, especially those employing deep learning techniques, such as coping with data sparsity where not all users provide substantial ratings for a diverse set of items [13]. Furthermore, ongoing research delves into understanding the relationship between users based on various criteria within MCRS for deep learning models [10, 11, 3, 14, 15, 16]. However, accurately predicting ratings or generating recommendations is challenging due to the necessity of considering user relationships based on specific criteria, incorporating user interests, and structuring a multi-criteria recommender system around a graph [13]. The adoption of graph neural networks (GNN) captures intricate relationships in data and enhances the predictive performance of MCRS in tasks related to rating predictions and recommendation generation [17]. However, GNNS for MCRS introduce challenges in terms of capturing the nature of relationships between nonuniform nodes in the graph, with each node holding a distinct level of importance [18, 19, 20]. Therefore, the adoption of a multiview approach has taken into"}, {"title": "account local and global relationships", "content": "[21, 22]. Locally, the significance of a node lies in its connections within each specified view, while globally, it derives from relationships across all views on the graph [23, 24]. This dual consideration is crucial for a comprehensive understanding of the intricate connections within the multiview structure.\nMultiview learning [25] has attracted growing interest and has been proven to be highly effective in practical applications by using complementary information from multiple features or modalities. The objective of multiview learning is to discover shared patterns or common feature spaces by integrating various distinct features or data sources [26]. Among the prominent approaches in multiview learning is the mapping of multiview data in a unified feature space, with the aim of maximizing the consensus among multiple views [27, 28]. Therefore, we can define MCRS based on the use of multiview learning, which uses information from multiple distinct perspectives or views of the data to generate recommendations. In this approach, each criterion is depicted within its own view, showcasing relationships between users and items. Within each view of multiview learning, users and items are associated with relevant relations, and users rate items based on the information presented in that particular view.\nWe need to employ two types of attention mechanisms when using multiview learning that various recommender systems have defined based on previous work. Graph Attention Networks (GAT) [29] and multiview Graph Attention Networks (MGAT) [20] are both variants of Graph Neural Networks (GNNs) that have gained significant attention in recent years for their effectiveness in modelling relational data [30]. GAT extends traditional GNNs by introducing attention mechanisms, enabling nodes to weigh the importance of their neighbours during message passing [29]. GAT enables more effective and flexible information propagation throughout the graph by allowing nodes in the graph to selectively attend to their neighbours' features [31, 32]. This capability allows GAT to capture complex relationships in the graph more effectively [33]. On the other hand, MGAT extends the GAT architecture to handle multiview graph-structured data, incorporating multiple views of the graph, each representing a different type of relationship or modality [20]. This enables MGAT to capture richer and more diverse information from the data. MGAT allows nodes in each view of the graph to selectively attend to their neighbours' features across multiple views by utilising attention mechanisms, facilitating comprehensive information aggregation and propagation [20, 22]. Each view in MGAT unveils distinct relationships marked by sparsity and bias, necessitating a tailored approach to capture these specific characteristics. For example, Zhang et al. [34] introduced a method for Point of Interest (POI) recommendation, leveraging a structural graph attention network. Sun et al. [35] introduced a recurrent knowledge-aware recommendation algorithm that utilises a graph attention network. Liu et al. [36] introduced the Heterogeneous Graph Enhanced Category-aware Attention Network as a solution model to address both the tasks of estimating a user's category intent and predicting items for recommendation. In RS based on MGAT, Chen et al. [37] demonstrated the effective-"}, {"title": "ness of MGAT in capturing MCRS", "content": "achieving state-of-the-art performance in travel recommendation tasks. Wang et al. [38] utilised MGAT in music recommendations and enhanced recommendation based on its usage. Hu et al. [39] used MGAT to capture user preferences and views that do not like, respectively.\nAn attention mechanism in deep learning models [40] allows to focus on specific parts of the input data that are more relevant to the task at hand, effectively mimicking the human ability to pay selective attention. The attention mechanism dynamically highlights important features, thereby improving learning efficiency and prediction accuracy [41, 40, 29]. Local attention directs focus towards specific subsets or regions of the data within each view, emphasising relationships within individual views [42, 43]. It allows the model to prioritise and weigh the importance of features or nodes within a particular view, capturing fine-grained patterns and local dependencies present within the data [36]. This localised focus enhances the model's ability to extract relevant information from each view, thereby facilitating accurate recommendations based on the unique characteristics of the data within that view. On the other hand, global attention [36] enables a comprehensive evaluation of relationships across all views, providing a nuanced representation of the underlying data [44, 45, 46]. According to these definitions of local and global attention, model training follows a two-fold approach: firstly, identifying similar nodes within each view; and secondly, training on nodes that exhibit similarity across all views. Therefore, the utilisation of MDGAT in the MCRS depends on analysing nodes and dependencies locally within each view and globally across all views, incorporating each criterion.\nInspired by the success of contrastive learning in language modelling and visual representation learning, researchers have increasingly incorporated contrastive learning into recommender systems [47]. Contrastive learning is a self-supervised learning technique that focuses on distinguishing between similar and dissimilar pairs of data points [48]. The core idea is to learn an embedding space where similar data points are closer together, and dissimilar ones are farther apart. This is achieved by maximising the agreement between positive pairs (similar data points) while minimising the agreement between negative pairs (dissimilar data points) [49, 50]. Contrastive learning-based recommendation systems help handle sparse data by generating robust embeddings that leverage the similarity between data points, thus mitigating the effects of sparsity [51]. Contrastive learning enhances the quality of the learned representations by focusing on the similarity and dissimilarity between data points, [52]. Moreover, it improves the generalisation ability of the model by ensuring that the learned embeddings are meaningful and discriminative, which is essential for making accurate recommendations [53].\nIn this study, we introduce a novel framework for MCRS that utilises Multiview and Dual Graph Attention and Contrastive Learning (D-MGAC). Our framework in the initial step utilises a multiview structure on the multi-edges bipartite graph. We generate for each criterion of item one graph-based user and items based relation of them and based special criterion. We use prominent MCRS benchmark datasets to demonstrate the"}, {"title": "effectiveness of our framework", "content": "including Yahoo! Movies and BeerAdvocate. Furthermore, we extracted and curated a MCRS dataset from TripAdvisor website. The key contributions of our work are as follows:\n1. The D-MGAC model employs Multiview Dual Graph Attention (MDGAT), integrating local attention to capture dependencies within each criterion and global attention for a comprehensive evaluation across all criteria.\n2. We include local and global attention for each view and the entire graph to generate embedding using the dual attention mechanism. The dual contrastive learning model integrates both local and global similarity measures by defining anchor points in each view. In the next stage, we use contrastive learning based on one loss function including two terms to calculate it based on local and global contrastive learning. It generates recommendations based on the local and global similarity between embedding vectors through contrastive learning.\nThe paper is structured as follows. In Section 2, we provide a comprehensive review of related works. Section 3 outlines our methodology, and results are given in Section 4. Section 5 provides a discussion and finally, Section 6 concludes the study with future research directions."}, {"title": "2. Related Works", "content": "2.1. Multi-criteria Recommender Systems\nAdopting MCRS is crucial for platforms seeking to enhance user satisfaction, engagement, and retention. Unlike traditional Recommender Systems that rely on single criteria like ratings or item popularity, MCRS consider diverse factors such as user demographics, item attributes, temporal dynamics, and contextual information [54, 55] allowing them to deliver more personalised and contextually relevant recommendations, catering to the varied and evolving preferences of users. The rating data in a MCRS can be represented as a three-dimensional (3D) tensor, allowing factorisation of the tensor and higher order decomposition [56, 57, 58, 59]. The user similarity in recommender systems has advanced from single-criterion to multi-criteria approaches with the aid of fuzzy methods [60, 61] which seeks to improve predictive accuracy and tackle the challenge of personalised recommendations amidst information overload. Multi-criteria collaborative filtering systems [11], such as those incorporating Adaptive Neural Fuzzy Inference Systems (ANFIS) [62] and Self-Organising Maps (SOMs) [63], aim to provide accurate recommendations by integrating user preferences across multiple dimensions. ANFIS combines fuzzy logic with neural networks to adaptively learn from user interactions and refine recommendations based on evolving preferences and contextual cues. ANFIS is primarily used for prediction tasks rather than classification. It combines the adaptive learning capabilities of neural networks with the interpretability of fuzzy logic to model complex relationships and make predictions based on input data [64, 65]. SOMs, on the other hand, leverage unsupervised learning to cluster items based on their similarity and user"}, {"title": "interactions", "content": "facilitating personalized recommendations within each cluster [60]. Together, these methods enable MCRS to effectively handle the complexity of multidimensional data and enhance recommendation accuracy.\nMCRS often employ two-stage methods to enhance recommendation accuracy by estimating target item ratings and learning sub-score weights [66, 67, 68, 11, 69]. These methods are designed to handle the complexity of multiple criteria involved in decision-making processes, ensuring that recommendations are tailored to diverse user preferences and requirements. Subsequently, deep learning models have been pivotal in advancing MCRS. Models like sparse autoencoders, which are tailored to balance criteria [70], and deep neural networks applied to matrix factorization [71] have proven highly effective in enhancing recommendation accuracy. These approaches leverage the capacity of deep learning to handle complex interactions among multiple criteria, thereby improving the precision and relevance of recommendations. These methods leverage contextual information to improve relevance [72, 73] and consider multiple stakeholder preferences to boost overall performance [74]. For instance, Shambour et al. [3] introduced a deep learning algorithm for multi-criteria recommenders, employing deep autoencoders to uncover intricate user preferences. Nassar et al. [10, 11] integrated multi-criteria recommendation with deep learning, extracting features and utilising neural networks for correlation learning. These advancements underscore the potential of deep learning approaches in enhancing the capabilities of multi-criteria recommendation systems. Hong et al. [75] introduced two single tensor models that incorporate users (or countries), items, multi-criteria ratings, and cultural groups to simultaneously account for the inherent structure and interrelationships of these elements in recommendation systems. Zhang et al. [54] developed methods to improve the precision and scalability of multi-criteria recommendation systems by utilising both social connections and criteria preferences. They present a hybrid social recommendation algorithm and broaden its effectiveness with an implicit technique for inferring social relationships. Rismala et al. [76] presented a collaborative filtering approach based on a personalised neural network that takes multiple criteria to extract individual details from the user's rating history and to represent it as rating tendencies and user experiences. Singh et al. [17], examined the performance of traditional collaborative filtering, matrix factorisation, and deep matrix factorisation techniques in recommender systems using multi-criteria datasets.\n2.2. Recommender Systems based on GNNs\nGNNs have gained significant attention and are increasingly being applied in recommendation systems [77]. GNNs offer a powerful framework to model interaction between user items and capture complex relationships within the data using the inherent graph structures present in the recommendation scenarios, [78]. These models have demonstrated effectiveness in various recommender systems, including item recommendation, user preference modelling, and explanation of recommendations [79]. Wang et al. [79] employed GNNs to propagate"}, {"title": "embeddings in the user-item bipartite graph", "content": "explicitly capturing higher-order connections and injecting collaborative signals into the recommender system. GNNs for social recommender systems [80] considered the varying strengths of social relationships among users, modelling graph information to capture interactions and opinions within the user item graph. He et al. [81] used a Multilayer feedback neural network for user-item assessment modelling, while their study [82] proposed a CF and convolutional neural network approach that employed dyadic product for more meaningful connections. Zheng et al. [83] integrated user comments and items using a convolutional neural network, and Liu et al. [84] utilised a multilayer perceptron (MLP) in a note-based coder. Berkani et al. [85] proposed a hybrid recommendation approach that integrates collaborative filtering (CF) and content-based filtering (CBF) within an architecture featuring two models: generalised matrix factorization (GMF) and hybrid multilayer perceptron (HybMLP). The primary aim of their model is to mitigate challenges encountered during cold start situations in recommendation systems.\n2.3. Recommender Systems based on Multiview learning\nMultiview learning in recommender systems integrates diverse data sources to enhance recommendation accuracy and robustness [86]. Unlike traditional systems that rely on single sources like user-item interactions or item attributes, Multiview learning incorporates additional perspectives such as social network data, textual descriptions, temporal dynamics, and user demographics [87].By combining these varied sources, Multiview learning mitigates data sparsity, improves prediction accuracy, and delivers personalized recommendations tailored to individual preferences and contexts [88, 89]. This approach also captures intricate relationships across different data modalities, thereby enhancing the overall quality and relevance of recommendations [86]. Barkan et al. [90] introduced CB2CF, a deep neural multiview model that connects item content to their collaborative filtering representations. Designed for Microsoft Store services, which serve approximately a billion users globally, CB2CF is a real-world algorithm. The model is applied to movie and app recommendations, demonstrating superior performance over an alternative content-based model, particularly for completely new items. In paper [91] introduced a multiview graph collaborative filtering network for recommendations by leveraging both homogeneous and heterogeneous signals from attribute and neighbor views. The MVGCF model combines the co-occurrence features of different attribute values with the collaborative preferences of various neighbors to learn the embedding representation of nodes. The research [92], introduced a deep graph collaborative signal aggregation module designed to learn latent intention similarity representations for effective collaborative signal propagation within a few layers. Additionally, they propose a novel multiview contrastive learning module, which leverages both local and global contrastive learning views derived from the collaborative signal aggregation module. Zhou et al. [93] proposed a multiview social recommendation framework called MsRec, which utilizes information from various perspectives for item recommendations. Specifically, MsRec aims to explore complex inner relationships within social networks and conduct user-level preference learning uniquely for each user. Additionally, MsRec incorporates available side information, such as contextual data, demographic characteristics, and item attributes, to enhance the representation vector learning for items. Yuan et al. [94] proposed a model called Attribute Mining Multiview Contrastive Learning Network. It enhances the initially sparse embedding representation by extracting potential information from the native data and constructing four distinct views. The model performs cross-view contrastive learning at both local and global levels, combining the collaborative information from each view with the global structural information in a self-supervised manner, thereby eliminating reliance on supervised signals.\n2.4. Recommender Systems based on GAT\nAttention mechanisms have become increasingly important in recommender systems due to their ability to capture feature importance and enhance interpretability. Utilising attention allows models to focus on the most relevant parts of the input data, which is crucial for providing accurate and personalized recommendations [95]. The application of attention mechanisms in recommender systems offers significant benefits, including improved performance in capturing user preferences, better handling of sparse data, and enhanced interpretability of the model's decisions [34].\nWang et al [38] introduced the Multiview Graph Attention Network for session-based music recommendation. MEGAN employs graph neural networks and attention mechanisms to generate meaningful representations (embeddings) of music tracks and users using heterogeneous data sources. This approach enables MEGAN to capture users' mixed preferences from their listening behaviors and recommend music pieces that align with users' real-time needs. Hu et al. [39] proposed a Collaborative Recommendation Model based on Multi-modal multiview Attention Network to represent users using both preference and dislike perspectives. Specifically, users' past interactions are categorized into positive and negative interactions, which inform the preference and dislike views, respectively. Additionally, semantic and structural details extracted from the context are incorporated to enhance the representation of items. He et al. [96] categorised fundamental feature interactions into sum-interactions and product-interactions, advancing existing methods for explicit feature interactions. Building on these theoretical insights, they introduce the Attentional Aggregative Interaction Network (AAIN), a novel model that incorporates cyclic explicit modules to capture higher-order features. Their approach employs attention mechanisms to reorganise individual features, followed by product-interactions and compression of higher-order features for output. Several advancements in modelling techniques incorporating attention mechanisms have been proposed in recent literature. For example, Xiao et al. [97] introduced attentional mechanisms, Zhou et al. [98] explored attentive activation mechanisms, and Song et al. [99] innovated with self-attentive neural networks. These studies represent diverse approaches aimed at enhancing model performance through attention-based methodologies. Sequential recommendation techniques include hybrid encoders from"}, {"title": "Li et al.", "content": "[100] and dynamic interest capture by Zhou et al. [101]. Wang et al. [18] introduced HGATE for unsupervised representation learning on heterogeneous graph-structured data. Chen et al [37], the MV-GAN (Multiview Graph Attention Network) model tailored for travel recommendation that enhanced semantic understanding of users and travel products by aggregating neighbours guided by meta-paths and fusing multiple views within a heterogeneous recommendation graph. The node-level and path-level attention networks were designed to capture user and product representations from each view independently. To integrate diverse relationship types across views, they propose a view-level attention mechanism that aggregates node representations to derive comprehensive global representations of users and products. Lin et al. [102] introduced a Mixed Attention Network that integrates local and global attention modules for extracting domain-specific and cross-domain information. They first proposed a local/global encoding layer to capture sequential patterns specific to each domain and across domains. Finally, they proposed a local/global prediction layer to further refine and integrate domain-specific and cross-domain interests. Wang et al. [103] introduced a sequence recommendation model to strike a balance between users' long-term and short-term benefits, ultimately combining them into a hybrid representation for recommendation purposes. Wang et al.[104] introduced to enhance recommender system for image active recommendation that harnesssed multi-modal information and high-order collaborative signals to aid in representation learning, while also capturing personalized user preferences in images. Li et al. [105] introduced multiview social recommendation for item recommendation from various perspectives to take advantage of the complex relationships within social networks. It performs user-level preference learning for each user independently, without overlap. Chen et al. [106] constructed an authentic global graph derived from a multiview representation of items and sessions based on a knowledge graph to extract global item-item relationships within the knowledge view for session-based recommendation.\n2.5. Recommender Systems based on Contrastive Learning\nContrastive learning [49] is a powerful paradigm in machine learning that aims to learn representations by contrasting positive pairs (similar samples) and negative pairs (dissimilar samples) in a latent space. This approach leverages the idea that similar samples should be closer together while dissimilar ones should be farther apart, thereby facilitating the discovery of meaningful patterns and representations from data. The use of contrastive learning in recommender systems has increased, with various versions being implemented. By leveraging the strengths of contrastive learning, these systems aim to learn more robust and discriminative representations of user-item interactions [47]. Contrastive learning helps in distinguishing between positive and negative samples more effectively, thereby enhancing the quality of recommendations [48].\nWei et al. [107] reframed the learning of cold-start item representations from an information-theoretic perspective, aiming to maximize the mutual dependencies between item content and collaborative signals. They introduce a new objective function"}, {"title": "based on contrastive learning and develop a straightforward yet effective framework for cold-start recommendations", "content": "Chen et al. [108] introduced Intent Contrastive Learning to integrate a latent intent variable into sequential recommendation that involves learning distribution functions of users' intents from unlabeled sequences of user behaviour through contrastive self-supervised learning.\nYang et al. [51] introduced Knowledge-Adaptive Contrastive Learning that involves data augmentation independently from the user-item interaction view and the knowledge graph view, and applying contrastive learning across these two perspectives. The algorithm ensures that item representations encode information that is common across both views by incorporating a contrastive loss. Zhang et al. [109] developed a dual contrastive learning recommendation framework. Zhang et al. [109] introduced a dual contrastive learning recommendation framework. The first contrastive learning step promotes uniform distributions across users and items, while the second step aims to generate contrastive embeddings from output vectors. Qin et al. [52] introduced Intent Contrastive Learning for Sequential Recommendation designed to capture users' latent intentions by segmenting a user's sequential behaviour into multiple subsequences using a dynamic sliding operation. These subsequences are then processed through an encoder to generate representations that capture the user's intentions.\nIn this paper [110], proposed a learning paradigm called supervised contrastive learning based on graph convolutional neural networks. Initially, during data preprocessing, they calculate the similarity between different nodes on both the user side and the item side. When applying contrastive learning, they consider not only the augmented samples as positive samples but also a certain number of augmented samples of similar nodes as positive samples. Wei et al. [111] proposed a recommendation framework called Multi-level Cross-modal Contrastive Learning. This framework aims to construct multi-level contrastive learning to fully exploit both intra-modal and inter-modal semantic information in a self-supervised manner. They consider user interaction and semantic review as two distinct semantic modalities and devise two modal-specific contrastive learning strategies to enhance intra-modal learning.\nThe comparison of various methodologies using single and multi-criteria recommender systems is presented in Appendix A."}, {"title": "3. Methodology", "content": "3.1. Definitions\nIn this section, we provide some definitions for the main concepts used in the proposed method.\nDefinition 1 (Multi-Criteria Recommender System). In a MCRS, the rating function is adapted to handle different ratings [112], resulting in the following representation. Let U be the set of N users, V the set of M items, and let C the number"}, {"title": "of criteria", "content": "indexed from 1 to C. Then, ratings are represented as a function\n$R: U \\times V \\rightarrow C$  (1a)\nor\n$R: U \\times V \\rightarrow R \\times R^{C}$  (1b)\nif an overall rating (often the average of ratings over all criteria, but sometimes a separate measurement) is also present. We will use $R_{u,v,c}$  to denote the rating given by the user $u \\in U$  for the item $v \\in V$  according to the criterion $c \\in {1,..., C}$  or $c \\in {0,..., C}$  if an overall rating is observed.\nDefinition 2 (Bipartite graph). Let $G = (U, V, E)$  be a bipartite graph, where $U$  and $V$  represent the two sets of vertices. For notational convenience, we will index them as $U = {1,...,N}$  and $V = {1,..., M}$ . Then, $E \\subseteq U \\times V$  the set of edges in the graph, representing whether user-item pairs in which the user has rated the item. In the present contaxt of multicriteria ratings, we define $G = (U, V, E_1, . . ., E_c)$ , with $(u, v) \\in E_c$  corresponding to the user u' rating of the item v according to criterion c, with an analogous formulation if an overall rating is observed.\nThe incidence matrix for this graph is denoted as $B \\in {0,1}^{N \\times M}$ , such that $B_{uv} = 1$  if and only if $(u, v) \\in E$ . We may, analogously, use $B_c$  to denote the incidence matrix for criterion c. Where the graph is weighted, $B \\in R^{N \\times M}$ , can represent the weights as well.\nDefinition 3 (L-BGNN Adjacency Matrix). He et al. [113] introduced layerwise-trained Bipartite Graph Neural Networks (L-BGNN) for learning node representations in bipartite graphs, where nodes are divided into two distinct sets, typically"}, {"title": "representing users and items", "content": "They propose a new format for the adjacency matrix to enhance node representation learning:\n$B' = \\begin{bmatrix} 0 & B \\\\ B^T & 0 \\end{bmatrix} \\in R^{(N+M) \\times (M+N)}$  (2)\nIn this matrix, $B$  represents the connections between nodes from the two sets. A feature matrix is used to capture the relationships between these nodes, incorporating edge weights that indicate the scores assigned by users to corresponding items based on specific criteria. To improve stability during learning, we normalize B' as follows:\n$B' \\leftrightarrow (D^{-1}B' + B'D^{-1})/2,$  (3)\nwhere D is a diagonal matrix defined by $D_{ii} = \\sum_{j=1}^{N+M} B_{ij}'$ . This normalization helps ensure balanced propagation of information across the network, thereby enhancing the overall performance of the L-BGNN.\nDefinition 4 (Multiview Network Embedding). In the context of network embedding, we consider both single-view and multiview information networks. In a single-view network denoted $G = (U, V, E)$ , network embedding techniques are applied to learn low-dimensional vector representations $h_i \\in R^d$  for each node $i \\in U \\cup V$ . The dimensionality of the embeddings, $d$ , captures the essential information of the network, preserving its structural and semantic properties. Moving on to multiview networks, denoted as $G = (U, V, E_1, E_2, ..., E_c)$ , the edge sets in each view, denoted as $E_1, E_2, ..., E_c$ , capture the relationships between nodes based on specific criteria. For each view $c \\in {1, ..., C}$ , the set of edges $E_c \\subseteq U \\times V$  characterises the relationships between the source nodes and the target nodes"}, {"title": "in that particular view", "content": "Our objective in multiview network embedding is to learn global node embedding representations $h_i \\in R^d$ , with $d$  being much smaller than the total number of nodes, $|U| + |V|$ . By leveraging the information from multiple views, we can obtain comprehensive and informative node embeddings that capture the underlying structure and interactions within the network.\n3.2. Recent studies\nWe provide an overview of related recent studies on recommendation systems based on deep learning and GNNs. These studies focus on single-criteria recommendation systems. Forouzandeh et al. [114] introduced a recommender system based on heterogeneous network embedding. They utilized spectral clustering within the framework of a Heterogeneous Information Network (HIN) to generate recommendations. In two papers [115, 116], Forouzandeh et al. presented recommendations for healthy food and user-interest-based foods. The study [115] introduced a health-aware recipe recommendation system based on a heterogeneous attention network, employing node-level and semantic-level attention to identify popular and healthy recipe nodes for user recommendations. In [116], they introduced a user-interest-aware food recommender system using dual heterogeneous attention, utilising node-level attention to train meta-path-based users' food interests and semantic-level attention to uncover paths with heightened semantic significance based on node relations in the graph.\nIn [117], a novel measure is presented to calculate the popularity of a user within a group, defined based on both trust networks and user centrality. This measure is used to aggregate the preferences of different users in the group. Additionally, a time-aware similarity measure is defined and utilized in deep community detection, which is employed in single-user rating prediction. In their paper, Rostmai et al. [118] propose a food recommendation system that utilizes deep learning-based food image clustering and user community detection. This system includes components for estimating user community-food group tendencies and an explainability module based on associative rule mining.\nHowever, we encountered a common issue across all of them: they focused solely on item-based ratings based on a single criterion, which only indicates how interested a user is in a particular item overall. This approach cannot fully capture the perspectives, opinions, and aspects of users who are interested in multiple features of an item. If two users are interested in an item based on Criteria 1, we should construct a graph and consider the neighboring nodes for them. By analysing their relationships based on the graph structure and using GNN, we can better understand their interests in the specific criteria. This approach offers advantages over traditional matrix-based analyses in accurately capturing users' interests based on special criteria.\nTherefore, for this research, we opted to utilize a GNN structure with multiview and attention mechanisms, including dual attention and contrastive learning for each view and the entire graph. The proposed method aims to address the weaknesses identified in previous research by incorporating multiple views of user-item interactions. By leveraging the proposed structure introduced in the next section, our framework can learn enhanced representations, integrate diverse information sources, and effectively weigh the importance of different criteria or features. This leads to more robust and meaningful embeddings for generating recommendations."}, {"title": "3.4. Our Framework: Dual Multiview and Graph Attention and Contrastive Learning", "content": "As noted earlier, Dual-MGAT refers to the dual attention mechanism in MGAT [20] which lays the foundation of our proposed framework known as Dual Multiview and Graph Attention and Contrastive Learning (D-MGAC).\nWe utilise a bipartite graph structure and dual MGAT, where each criterion is treated as a distinct view. We need to represent the relationships between users and items as separate subgraphs. We construct an adjacency matrix using the L-BGNN to capture the proximity between nodes within each view. In addition, we consider the number of criteria rated by users for each item, resulting in the creation of an L-BGNN matrix. These matrices serve as the input for a GAT which generates embedding vectors that incorporate user and item nodes. GAT features a dual attention mechanism that includes local and global attention. In stage 3 of our framework (Figure 2), we calculate the importance of node neighbors and perform local aggregation within each view, while simultaneously executing global aggregation across the entire graph. This results in the generation of embeddings based on the dual attention mechanism, facilitating a nuanced understanding of relationships within each view and across the entire graph. This enhances the model's capacity to capture local and global dependencies and enables the incorporation of user preferences based on multiple criteria. The local and global aggregation of attention mechanisms contribute to a comprehensive representation of the data, resulting in more accurate embeddings and improved predictive performance. In Stage 4, we employ dual contrastive learning based on local and global loss functions. Initially, for each view, we define anchor points based on similarity to determine positive and negative samples. Local contrastive learning focuses on relationships within individual views, capturing fine-grained patterns and dependencies specific to each criterion. Subsequently, global contrastive learning evaluates relationships across all views, capturing broader patterns and dependencies that span multiple criteria. Furthermore, the modular structure of our framework al-"}, {"title": "lows for flexibility and adaptability to various recommendation scenarios", "content": "making it a versatile solution for MCRS.\n3.4.1. Dual-MGAT\nWe present the graph attention layer used in our multiview network", "inputs": "a feature matrix X with dimensions $|V| \\times F$  and an adjacency matrix A with dimensions $|V| \\times |V|$  for each view. Here, $F$  represents the dimension of the input features for each node, and A encodes relationships based on item ratings by users for each criterion. Node representations are defined as $X = {X_1, X_2, ..., x_{|v|}}$ , where $x_i \\in R^F$ . The graph attention layer employs a shared linear transformation with a learnable weight matrix $W \\in R^{F' \\times F}$  applied to"}]}