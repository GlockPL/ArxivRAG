{"title": "Water QualityNeT: Prediction of Seasonal Water Quality of\nNepal Using Hybrid Deep Learning Models", "authors": ["Biplov Paneru", "Bishwash Paneru"], "abstract": "Ensuring a safe and uncontaminated water supply is contingent upon the monitoring of water quality, especially in\ndeveloping countries such as Nepal, where water sources are susceptible to pollution. This paper presents a hybrid\ndeep learning model for predicting Nepal's seasonal water quality using a small dataset with many water quality\nparameters. The model integrates convolutional neural networks (CNN) and recurrent neural networks (RNN) to\nexploit temporal and spatial patterns in the data. The results demonstrate significant improvements in forecast accuracy\nover traditional methods, providing a reliable tool for proactive control of water quality. The model that used WQI\nparameters to classify people into good, poor, and average groups performed 92% of the time in testing. Similarly, the\nR2 score was 0.97 and the root mean square error was 2.87 when predicting WQI values using regression analysis.\nAdditionally, a multifunctional application that uses both a regression and a classification approach is built to predict\nWQI values.", "sections": [{"title": "1. Introduction", "content": "Due to the serious health and environmental risks posed by water contamination, an immediate assessment and\nremediation are required. Regular monitoring of essential water quality parameters, such as pH, dissolved oxygen,\ntemperature, turbidity, etc., provide crucial information on pollution levels and the general health of rivers [1].\nAdditionally, in order to lessen water pollution, regular maintenance should be done on ponds and other water sources.\nPotable water must be devoid of harmful organisms and have minimal amounts of substances that are very poisonous\nto humans or animals. Along with ponds and rivers, the responsible organizations should create a plan to protect and\nlessen water pollution in various water sources [9]. Monitoring water quality is vital to ensuring a clean and safe water\nsupply, especially in developing countries like Nepal, where water sources are susceptible to pollution. Effective water\nquality management is essential to address this challenge, and it relies on accurate and timely predictions of water\nquality indices (WQI). Water is one of the most essential natural resources for all life on Earth. Having access to clean\nwater is a basic human requirement. The past few decades have seen a significant drop in water quality due to pollution\nand a host of other issues [14]. Since most living things get their physical health from the water they drink, maintaining\nthe water's purity and cleanliness is crucial since contaminated water can have harmful effects on human health as\nwell as the environment. This makes measuring, regulating, and keeping an eye on the water quality absolutely\nnecessary [15]."}, {"title": "1.1. Literature Review", "content": "Previous studies on water quality prediction have employed various machine learning approaches, including support\nvector machines (SVM), decision trees, and neural networks. These models typically focus on specific parameters or\nregions, limiting their generalizability. Recent advancements in deep learning have shown promise in capturing\nintricate patterns in environmental data. CNNs are effective for spatial data analysis, while RNNs excel in handling\ntemporal sequences. A hybrid approach can harness the strengths of both architectures, offering improved predictive\nperformance for water quality monitoring.\n\nThe purpose of this work was to use machine learning time series models, namely ARIMA and LSTM, to forecast the\nwater quality indicators of the Bagmati River. To divide the output into temporal slices, the LSTM model was created\nwith one input layer, one encoder layer, one repeat layer, one decoder layer, and one output dense layer.\nIn addition, a DNN model with two input layers for latitude and longitude and seven output layers for the seven water\nquality parameters under consideration for analysis was used for location-based prediction. Although the models"}, {"title": "2. Methodology", "content": ""}, {"title": "2.1 Data Collection", "content": "The dataset used in this study was collected from various water sources across Kathmandu southern part [10], covering\ndifferent seasons. It includes 4 water quality parameters: Temperature, PH, Conductivity, Turbidity, Total Hardness,\nChloride Content, Iron Content, Arsenic Content, Ammonia, Nitrate, and Total Coliform Count. The data was\npreprocessed to handle missing values, normalize scales, and encode categorical variables.\n\nEC: The ability of water to transmit electricity is measured by its electrical conductivity, which is affected by ions,\nminerals, and dissolved salts. It serves as a crucial gauge of the salinity and total dissolved solids content of water.\nElevated EC values may suggest elevated mineral content or pollution.\n\npH: Water's acidity or alkalinity is determined by pH, which runs from 0 to 14. Seven is the neutral pH, seven is acidic,\nand seven is alkaline. The health of aquatic creatures and the solubility of minerals and compounds in water are both\nimpacted by pH. The pH range of natural water bodies is typically 6.5 to 8.5.\n\nDO: The quantity of oxygen dissolved in water, which is essential for aquatic life, is referred to as dissolved oxygen.\nTemperature, pressure, and water velocity all affect DO levels. In order to sustain aquatic species like fish and other\nwildlife, higher DO levels are necessary.\n\nTemperature: The physical and chemical characteristics of water, such as its capacity to contain dissolved gasses like\noxygen, are influenced by its temperature. The solubility of substances, the metabolic rates of organisms, and aquatic\nlife are all impacted by temperature. Water quality and the health of ecosystems can be impacted by temperature\nfluctuations."}, {"title": "2.2 Preprocessing and handling data imbalance with SMOTE", "content": "A useful technique for handling data imbalance is the Synthetic Minority Over-sampling Technique (SMOTE). By\ncreating artificial samples for the minority class, SMOTE balances the distribution of classes without merely copying\nalready-existing samples. For every minority class sample, it finds its closest neighbors and interpolates fresh samples\nbetween these spots to function. In situations where class imbalance could ordinarily bias the model towards the\ndominant class, this helps create a more balanced dataset, which can lead to higher model performance and more\ndependable predictions. The imbalanced classes distribution in our dataset was a barrier for models performance and\nto handle it SMOTE was applied."}, {"title": "2.3 Hybrid Deep Learning Model", "content": "The proposed model integrates CNN and RNN layers to capture both spatial and temporal dependencies in the water\nquality data.\n\n\u2022 RNN Layers: The RNN component, a bi-directional Long Short-Term Memory (LSTM) network with MLP (Multi\nLayer Perceptron Network), processes the sequential input to model temporal dependencies. This makes it easier to\nspot seasonal trends and variations in the water quality.\n\n\u2022 Fully Connected Layers: The output from the CNN and RNN layers is combined and processed by fully connected\nlayers to provide the final predictions.\n\nHardware system:\n\nThe hardware system consists up of a main microcontroller Esp-32 which allows to operate as a main board for\nenhancing the edge computing-bas\n\nModel evaluation metrices:\n\nAccuracy: It is the percentage of accurate findings\u2014true positives and true negatives among all instances that\nwere looked at.\n\n$\\frac{TN+TP}{(FP+FN+TP+TN)}$..Equation 1.\n\nRecall: The proportion of all real positive observations to all accurately projected positive observations\n\n$\\frac{TP}{(FP+FN)}$..Equation 2.\n\nPrecision: The proportion of accurately forecast positive observations to the total number of positive predictions\n\n$\\frac{TP}{(TP+FP)}$..Equation 3.\n\nFl-score:\n\n$2*\\frac{Precision*Recall}{Precision+Recall}$..Equation 4.\n\nIt is the precision and recall weighted average, which balances the two"}, {"title": "2.4 Model Training and Evaluation", "content": "The model was trained using a dataset split into training and testing sets, ensuring an equal representation of all\nseasons. Hyperparameters, such as batch size, learning rate, and dropout rate, were optimized using grid search. The\nmodel's performance was evaluated using metrics such as Root Mean Square Error (RMSE), and R-squared (R2) score."}, {"title": "3. Results", "content": "The hybrid model outperformed traditional machine learning models and standalone deep learning architectures. It\ndemonstrated high predictive accuracy for multiple water quality parameters across different seasons. The R\u00b2 score\nimproved significantly, indicating a better fit to the observed data.\n\nResults show that on classification an accruracy of 93% is obtained. Siamilry, on cross validation on 10-folds we got\nan accuracy of 90%.\nThis table 4. summarizes the precision, recall, F1-score, and support metrics for each class (0, 1, and 2), as well as\nthe overall accuracy, macro average, and weighted average across all cla\nConfusion matrix plot"}, {"title": "4. Discussions and limitations", "content": "The hybrid deep learning model effectively captures the complex spatial and temporal relationships in water quality\ndata. The integration of MLP and RNN layers allows for comprehensive feature extraction and sequence modeling,\nenhancing the prediction accuracy. This approach can be extended to other regions and water quality datasets,\nproviding a robust framework for environmental monitoring.\n\nThe primary objective of the study in [10] was to assess the temperature, pH, electrical conductivity (EC), and\ndissolved oxygen (DO) of groundwater from wells that had been dug in the southern region of the Kathmandu Valley.\nThe temperature readings showed that the surrounding air was normally pleasant for microbiological stability in the\narea. Different wells had different pH values; the northwest and Hanumante Khola, for example, had more acidic\ntendencies than other locations, which could have been dangerous for corrosion. Because of additional chemical and\nbiological components, the moderate salt concentration indicated by the EC values is suitable for home and agricultural\nuse, but drinking water requires more investigation.\n\nDifferent DO readings indicated different amounts of organic present, which affected the freshness of the water. There\nwere some notable anomalies, such as pH in Nakhu Khola, EC in some regions of Kalanki, and DO in upstream river\nareas, indicating places that require special attention even though most metrics generally met local and international\nwater quality criteria for domestic and agricultural reasons. The research area's groundwater quality is generally stable,\nas evidenced by the negligible seasonal fluctuations in water quality measures [10]. Nonetheless, in order to fully\ncomprehend water quality for more extensive community health and environmental management initiatives, thorough\ninvestigations integrating chemical and microbiological analysis are advised. ML algorithms can be very useful for\nclassifying water quality of specific area as well as predicting WQI using the given parameters [5-12]."}, {"title": "5. Future Work", "content": "Future research can explore the incorporation of additional environmental factors and sensors based more data\ncollection. Methods for various factors such as rainfall and land use patterns, to further enhance prediction accuracy.\nMoreover, real-time monitoring and prediction systems can be developed to provide timely alerts and support\ndecision-making processes."}, {"title": "6. Conclusion", "content": "This research presents a novel hybrid deep learning model for predicting seasonal water quality in Nepal. By\nleveraging the strengths of CNN and RNN architectures, the model offers improved accuracy and reliability. The\nresults highlight the potential of deep learning in environmental applications, paving the way for better water resource\nmanagement and policy development.\n\nThe water quality being very important parameter for enhancing a country landscape the prediction yielding a good\nresult through ML and deep learning hybrid models suggest a great feasibility in solving global water pollution related\ncrisis by effectively mitigating the issue."}]}