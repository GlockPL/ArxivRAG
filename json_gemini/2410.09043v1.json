{"title": "Transforming In-Vehicle Network Intrusion Detection: VAE-based Knowledge Distillation Meets Explainable Al", "authors": ["Muhammet Anil Yagiz", "Pedram MohajerAnsari", "Mert D. Pes\u00e9", "Polat Goktas"], "abstract": "In the evolving landscape of autonomous vehicles, ensuring robust in-vehicle network (IVN) security is paramount. This paper introduces an advanced intrusion detection system (IDS) called KD-XVAE that uses a Variational Autoencoder (VAE)-based knowledge distillation approach to enhance both performance and efficiency. Our model significantly reduces complexity, operating with just 1669 parameters and achieving an inference time of 0.3 ms per batch, making it highly suitable for resource-constrained automotive environments. Evaluations in the HCRL Car-Hacking dataset demonstrate exceptional capabilities, attaining perfect scores (Recall, Precision, F1 Score of 100%, and FNR of 0%) under multiple attack types, including DoS, Fuzzing, Gear Spoofing, and RPM Spoofing. Comparative analysis on the CICIoV2024 dataset further underscores its superiority over traditional machine learning models, achieving perfect detection metrics. We furthermore integrate Explainable AI (XAI) techniques to ensure transparency in the model's decisions. The VAE compresses the original feature space into a latent space, on which the distilled model is trained. SHAP (SHapley Additive exPlanations) values provide insights into the importance of each latent dimension, mapped back to original features for intuitive understanding. Our paper advances the field by integrating state-of-the-art techniques, addressing critical challenges in the deployment of efficient, trustworthy, and reliable IDSes for autonomous vehicles, ensuring enhanced protection against emerging cyber threats.", "sections": [{"title": "1 Introduction", "content": "The emergence of autonomous vehicles (AVs) and the widespread integration of connected cars have significantly transformed the landscape of modern transportation, offering unprecedented levels of safety, efficiency, and convenience. Central to these technological advancements is the in-vehicle network (IVN), which enables seamless communication among various electronic control units (ECUs) that govern essential vehicular functions, including adaptive cruise control, lane-keeping assistance, and real-time navigation [33, 34]. However, the increasing connectivity of IVNs introduces significant cyber vulnerabilities, primarily due to the lack of robust security measures such as authentication and encryption. These weaknesses can be exploited by malicious actors to carry out cyber attacks, compromising passenger safety and undermining the operational integrity of vehicles [17].\nIntrusion Detection Systems (IDS) are essential for enhancing the security of IVNs. While traditional IDS approaches are somewhat effective, they often fail to address the sophisticated and evolving nature of cyber threats targeting IVNs. The dynamic nature of these attacks requires more advanced and flexible solutions. Recent advances in artificial intelligence (AI), particularly in machine learning (ML) and deep learning (DL), offer promising solutions to improve IVN security. These technologies can analyze vast amounts of network traffic data, learn intricate patterns of normal and anomalous behaviors, and detect previously unknown attack vectors in real time [16, 32].\nHowever, deploying ML and DL-based IDS in IVNs presents several challenges. A significant issue is the black-box nature of these models, which obscures their decision-making processes and diminishes the trust of stakeholders in their reliability. This lack of transparency, along with the resource-intensive nature of these models, is particularly concerning in the automotive industry, where safety and sustainable computing are paramount [4, 7, 9, 24]. Existing studies reveal significant gaps in current IDS solutions for IVNs, particularly in providing clear explanations for detections, which is crucial for gaining stakeholder trust and ensuring regulatory compliance [3, 7]. Furthermore, the high computational demand and complexity of training these models pose practical challenges for"}, {"title": "2 Related Work", "content": "This section provides a comprehensive review of the existing literature on security mechanisms designed to detect vulnerabilities and address security issues within autonomous vehicle IVNs. Additionally, it explores AI-based approaches for enhancing security within these networks."}, {"title": "2.1 Intrusion Detection Systems in IVNs", "content": "Intrusion Detection Systems (IDSes) are essential for securing networks such as the Controller Area Network (CAN) in vehicles, which inherently lack robust security features. Various strategies have been developed for detecting intrusions within CAN buses, employing different data analysis and ML techniques.\nRajapaksha et al. [27] categorized IDS approaches for in-vehicle networks into four primary types:\n\u2022 Fingerprint-based (bus level)\n\u2022 Parameter-monitoring-based (message level)\n\u2022 Information-theoretic-based (data-flow level)\n\u2022 Machine-learning-based (functional level)\nAmong these, the ML and DL methods have shown significant efficacy in identifying novel attacks on CAN buses through a comprehensive data analysis. Sun et al. [30] further classified intrusion detection algorithms into three groups: semantic-based, data-domain-based, and periodicity-based approaches. Semantic-based methods analyze the semantics of CAN messages. For instance, Zhao et al. [35] utilized an Artificial Neural Network (ANN) to enhance IDS precision. Data domain-based methods, such as those proposed by Qin et al. [26], predict CAN messages using long-short-term memory (LSTM) networks. Periodicity-based methods, exemplified by the LSTM-based approach from Hossain et al. [12], leverage the temporal patterns of CAN messages to detect anomalies, achieving high accuracy rates."}, {"title": "2.2 Integration of Advanced Techniques", "content": "Recent studies have integrated spatial and temporal features to enhance detection capabilities. Lo et al. [17] combined Convolutional Neural Networks (CNN) and LSTMs to successfully identify suspicious activities on the CAN bus. Despite their effectiveness, these"}, {"title": "3 Methodology", "content": ""}, {"title": "3.1 Threat Model", "content": "Understanding the specific characteristics and potential impacts of these attacks is essential to develop effective IDS. Each attack type exhibits unique patterns and behaviors that can be utilized to create robust detection algorithms. By incorporating comprehensive datasets such as the HCRL Car-Hacking [29] and CIC-IoV [22] datasets (see Section 4.1 for detailed description), researchers can simulate a diverse range of attack scenarios and assess the resilience of IDS against advanced cyber threats. In the following, we provide detailed descriptions of the attack types included in these popular datasets to elucidate their characteristics and potential impacts on vehicle security."}, {"title": "Denial of Service (DoS)", "content": "A DoS attack aims to overwhelm the vehicle's CAN bus with an excessive number of messages. This flood of traffic can effectively block legitimate messages from being transmitted, disrupting normal vehicle operations. In a DoS scenario, the vehicle's ECUs may be unable to communicate critical information, leading to potential safety hazards and system failures. On the CAN bus, a DoS attack is very straightforward as CAN messages with low identifiers (IDs) have higher priority and can thus prevent messages with higher IDs from communicating on the bus. As a result, injecting a message with CAN ID 0x0 would block any legitimate traffic on the bus."}, {"title": "Fuzzing", "content": "Fuzzing attacks involve sending a large number of random, misformed, or unexpected messages to the CAN bus to discover vulnerabilities within the vehicle's ECUs. By exposing the system to a variety of unexpected inputs, fuzzing can reveal weaknesses that can be exploited to cause the ECUs to malfunction or crash, thereby compromising vehicle safety and functionality."}, {"title": "Spoofing Attacks", "content": "Spoofing attacks on vehicular systems involve the injection of falsified data into the CAN bus, disrupting the accuracy of critical system readings and undermining vehicle performance and safety. There is a myriad of vehicular signals on the CAN bus that is subject to spoofing attacks, with the most prominent being RPM, gear, gas, speed, and steering wheel angle [22, 29]."}, {"title": "3.2 Data Pre-processing and Feature Scaling", "content": "Prior to training the IDS, rigorous data pre-processing steps were taken to ensure data quality and consistency. These steps included:\n(1) Missing Value Handling: Any missing or incomplete data entries were identified and addressed by imputation tech-niques or by discarding incomplete records to maintain the integrity of the dataset.\n(2) Data Conversion: The CAN IDs, originally in hexadecimal format, were converted to decimal to facilitate numerical"}, {"title": "3.3 Strategic Data Partitioning for Model Evaluation", "content": "To ensure a robust evaluation of the IDS, the datasets were divided into training and testing sets. In an unconventional approach aimed at rigorously testing the IDS, only 5% of the data was used for training, while the remaining 95% was reserved for testing. This split was chosen to simulate real-world scenarios where models must perform well even with limited training data. The split ensured that the model was tested on a diverse and extensive dataset, highlighting its generalization capabilities and robustness."}, {"title": "3.4 Proposed Model Architecture", "content": "To build a robust and efficient IDS, we employed a combination of advanced techniques, including VAEs and Knowledge Distillation."}, {"title": "3.4.1 Variational Autoencoder (VAE)", "content": "The VAE architecture was chosen for its ability to learn latent representations of the data, capturing the underlying distribution of normal and anomalous patterns in IVNs. The VAE consisted of an encoder, which mapped the input data to a latent space, and a decoder, which reconstructed the input data from the latent space. The reconstruction error was then used to identify anomalies. The key parameters and structures of the VAE are summarized in Table 1."}, {"title": "Encoder and Decoder Layers", "content": "The encoder and decoder were designed with multiple dense layers, employing ReLU activations to capture complex non-linear relationships."}, {"title": "Latent Space Dimension", "content": "The dimension of the latent space was carefully selected to balance the trade-off between reconstruction fidelity and computational efficiency."}, {"title": "Regularization", "content": "KL-divergence regularization was applied to ensure the latent space followed a standard normal distribution, facilitating better generalization and anomaly detection."}, {"title": "3.4.2 Knowledge Distillation", "content": "Knowledge distillation, initially proposed by Hinton et al. [10], facilitates the transfer of knowledge from a large and complex model (referred to as teacher) to a smaller and simpler model (referred to as student). The core motivation"}, {"title": "3.4.3 Explainable AI (XAI)", "content": "Interpretability is a fundamental aspect of our framework, enhancing trust and providing deep insight into the decision-making processes of our models. To illuminate the predictions made by the student model trained on the latent space representations from the VAE, we employ XAI techniques, focusing specifically on Shapley Additive Explanations (SHAP)."}, {"title": "4 Evaluation", "content": "In evaluating the performance of our proposed model against established competitors, we observed significant improvements in both efficiency and accuracy metrics."}, {"title": "4.1 Datasets", "content": "In this paper, two primary datasets were utilized to evaluate the performance of the IDS for IVNs, as detailed below:"}, {"title": "HCRL Car-Hacking", "content": "Collected by the Hacking and Counter-measure Research Lab (HCRL), this dataset is a comprehensive resource for automotive cybersecurity. It includes both benign CAN traffic and four distinct types of attacks-Denial of Service (DoS), Fuzzing, RPM Spoofing, and Gear Spoofing. The data were gathered from a Hyundai YF Sonata vehicle under real-world conditions,"}, {"title": "Canadian Institute for Cybersecurity Internet of Vehicles (CIC-IoV)", "content": "This dataset features DoS attacks and various spoofing scenarios conducted on a 2019 Ford vehicle. Attacks were executed under controlled conditions with the vehicle stationary, ensuring safety. It encompasses DoS, Gas Spoofing, Steering Wheel Spoofing, Speed Spoofing, and RPM Spoofing. Each entry contains a timestamp, CAN ID, Data Length Code (DLC), data bytes, and a flag indicating normal or injected messages. Sequential data frames are created by aggregating samples (n = 7), facilitating effective analysis and anomaly detection [22].\nThese datasets provide a comprehensive foundation for the development and evaluation of IDS in IVNs, enhancing the security and resilience of autonomous vehicles against sophisticated cyber threats, as summarized in Table 2."}, {"title": "4.2 Experimental Setup and Evaluation Metrics", "content": "The experiments are executed on a system featuring an Intel Core i9-13900K processor clocked at 3.0 GHz, 64 GB of DDR4 RAM, 1 TB SSD storage, and an NVIDIA GeForce RTX 3090 GPU with 24 GB of VRAM running Ubuntu 20.04 LTS.\nIn this study, we conducted comprehensive experiments to evaluate the performance of our proposed IDS model. The experiments were designed to rigorously test the model's ability to detect various types of cyber attack on IVNs. The evaluation was carried out using standard performance metrics and baseline comparisons with existing state-of-the-art IDS solutions. The key metrics used in this study are defined as follows:\n\u2022 Performance Metrics: Metrics such as accuracy, precision, recall, and $F_1$-score were calculated to assess the model's detection capabilities. These metrics provided a holistic view of the model's effectiveness in identifying both normal and anomalous CAN messages.\nThese comprehensive baseline comparisons illustrate the robustness, efficiency, and advanced capabilities of our proposed IDS model, establishing it as a leading solution for enhancing IVN security in autonomous vehicles."}, {"title": "4.3 Performance Evaluation on HCRL Car-Hacking Dataset", "content": "Table 4 provides a comprehensive comparison of performance metrics for various IDS models in the HCRL Car Hacking dataset, covering different attack types such as DoS, Fuzzing, Gear Spoofing, and RPM Spoofing. The detailed results are outlined below:\n\u2022 DoS attacks: KD-XVAE achieves an FNR of 0%, matching the perfect performance of the Transformer [23] and Time-Embedded Transformer [15]. The Recall, Precision, and F1 Score for KD-XVAE are all 1.0, indicating flawless detection and classification of DoS attacks. This performance is on par with the best models but with a significantly lower computational footprint.\n\u2022 Fuzzing attacks: KD-XVAE again demonstrates a perfect performance with an FNR of 0%, and Recall, Precision, and F1 Scores of 1.0. This surpasses the performance of models like Rec-CNN [6], which shows a high FNR of 17.0% and lower recall and precision values. The superiority of KD-XVAE in handling Fuzzing attacks highlights its robustness in identifying subtle and complex anomalies.\n\u2022 Gear Spoofing attacks: KD-XVAE maintains an FNR of 0% and perfect scores in Recall, Precision, and F1 Score. This is a significant achievement compared to models like the LSTM [23] and CNN-LSTM [23], which have lower accuracy metrics. The high performance across all metrics confirms KD-XVAE's ability to effectively detect and classify Gear Spoofing attacks.\n\u2022 RPM Spoofing attacks: KD-XVAE consistently delivers an FNR of 0%, with Recall, Precision, and F1 Score all at 1.0. This performance is comparable to the Time-Embedded Transformer [15] and superior to traditional models like DCNN ResNet [29], which, despite high precision, have lower recall values and higher FNRs.\nIn essence, KD-XVAE achieves perfect detection metrics (Recall, Precision, F1 Score of 1.0 and FNR of 0%) across all attack types in the HCRL Car-Hacking dataset. Performance consistency is particularly evident when compared to other models such as the Transformer [23] and the Time-Embedded Transformer [15], both of which also achieved high metrics but with greater computational demands."}, {"title": "4.4 Comparative Analysis on CICIoV2024 Dataset", "content": "Table 5 highlights the performance of KD-XVAE compared to traditional machine learning models on the CICIOV2024 dataset. The results clearly demonstrate the superiority of KD-XVAE in terms of accuracy and detection capabilities.\n\u2022 Accuracy: KD-XVAE achieves a perfect accuracy score of 1.0, surpassing Logistic Regression (0.89), AdaBoost (0.92), Deep Neural Network (0.96), and Random Forest (1.0) [22]. This indicates KD-XVAE's ability to classify all instances correctly.\n\u2022 Recall: With a recall of 1.0, KD-XVAE detects all attack instances. In comparison, Logistic Regression and AdaBoost show recalls of 0.50 and 0.66, respectively, while Deep Neural Network and Random Forest achieve 0.76 and 1.0."}, {"title": "4.5 Model Complexity and Inference Time", "content": "KD-XVAE's architecture, designed to be more compact, utilizes only 1669 parameters provided in Table 3. This is a considerable reduction compared to the Time-Embedded Transformer with Autoencoder, which operates with 259k parameters [15]. The streamlined parameter count directly correlates with reduced computational overhead, making KD-XVAE more suitable for resource-constrained environments typical of autonomous vehicles.\nIn terms of inference time, KD-XVAE demonstrates exceptional performance, requiring only 0.3 ms per batch, measured on the HCRL Car-Hacking dataset. This is a substantial improvement over the 3.58 ms needed by the Time-Embedded Transformer with Autoencoder [15]. Such efficiency gains are critical for real-time applications, ensuring prompt detection and response to cyber threats. Minimum cycle times for CAN messages on a 500 kBit/s bus as used for the two datasets stand at 10 ms [24]. As a result, any latency overhead caused by KD-XVAE needs to be smaller than 10 ms which also includes network latency and regular computation time. Our numbers easily satisfy this requirement, displaying the real-time capability of KD-XVAE."}, {"title": "4.6 \u03a7\u0391\u0399 Analysis", "content": "To further understand the inner workings of KD-XVAE and ensure transparency, we conducted an XAI analysis to identify the most and least influential features and latent variables related to different classes and datasets. The insights gained from this analysis are crucial for validating model decisions and ensuring trustworthiness in critical applications like automotive cybersecurity."}, {"title": "4.6.1 Latent Variables and Feature Influence in HCRL Car-Hacking Dataset", "content": "In the HCRL Car-Hacking dataset, KD-XVAE's latent dimensions are influenced by specific features as follows:\n\u2022 Latent dimension 0, 11, 22: Influenced by Timestamp.\n\u2022 Latent dimension 1, 12, 23: Influenced by CAN ID.\n\u2022 Latent dimension 2, 13, 24: Influenced by DLC.\n\u2022 Latent dimension 3-10, 14-21, 25-31: Influenced by DATA[0] to DATA[7]."}, {"title": "4.6.2 Latent Variables and Feature Influence in CIC-IoV Dataset", "content": "Similarly, in the CIC-IoV dataset, the influential features for the latent dimensions are as follows:\n\u2022 Latent dimension 0, 9, 18, 27: Influenced by CAN ID."}, {"title": "4.6.3 Feature Importance and Class-Specific Analysis", "content": "The XAI analysis provides a detailed understanding of the importance of features in different classes in the HCRL Car Hacking and the CIC-IoV dataset."}, {"title": "\u2022 HCRL Car-Hacking Dataset:", "content": "High Importance:\n* CAN ID: Crucial for detecting DoS, Fuzzing, Gear Spoof-ing, and RPM Spoofing attacks.\n* DATA Fields: All data bytes (DATA[0] to DATA[7]) are highly influential in identifying DoS, Fuzzing, Gear Spoofing, and RPM Spoofing attacks.\nLow Importance:\n* Timestamp: Low significance in identifying attack-free instances (only for Attack-Free class).\n* DLC (Data Length Code): Low importance in distinguishing normal traffic (only for Attack-Free class)."}, {"title": "\u2022 CIC-IoV Dataset:", "content": "High Importance:\n* CAN ID: Identifies the IDs involved in DoS, RPM spoof-ing, Speed spoofing, Steering wheel spoofing, and Gas spoofing.\n* DATA Fields: Reflects payload patterns indicative of DoS Attack, RPM Spoofing, Speed Spoofing, Steering Wheel Spoofing, and Gas Spoofing attacks.\nLow Importance:\n* Timestamp: Low significance in identifying attack-free instances (only for Attack-Free class)."}, {"title": "4.6.4 Comparative Analysis of Mean SHAP Value Ratio Between Teacher and Student Models", "content": "This section provides a comparative analysis of the mean SHAP value ratios between the teacher and student models across different classes in both the HCRL Car-Hacking and CIC-IoV datasets. The analysis reveals meaningful differences in feature importance between the models for specific classes.\nFor the HCRL Car-Hacking dataset, the teacher model consistently shows higher mean SHAP value ratios for key features such as CAN ID and DATA fields across various attack classes. This indicates that the teacher model relies more heavily on these features to identify attacks compared to the student model."}, {"title": "5 Discussion", "content": ""}, {"title": "5.1 Limitations", "content": "Despite the significant advancements introduced by our proposed IDS model, leveraging a VAE-based knowledge distillation approach, there are several limitations that need to be addressed. One notable limitation is the model's dependency on the quality and diversity of the training data. While KD-XVAE has demonstrated robust performance across various attack types on the HCRL Car-Hacking dataset, its effectiveness in detecting novel or previously unseen attack patterns remains to be fully validated. Additionally, the model's performance, although superior in terms of parameter efficiency and inference time, may still encounter challenges when deployed in environments with extreme computational constraints or in scenarios where real-time decision-making is crucial. The reliance on specific features such as CAN ID and DATA fields, while beneficial for detection accuracy, may also limit the model's adaptability to different types of automotive networks or configurations."}, {"title": "5.2 Future Work", "content": "Future work will primarily focus on addressing the aforementioned limitations to enhance the practical applicability and robustness of KD-XVAE. One key area of focus will be the optimization of the model for deployment in diverse real-world scenarios, including environments with varying computational resources and network configurations. This will involve extensive testing and validation of the model's performance across different automotive platforms and under varying operational conditions. Additionally, future research will aim to improve the model's ability to detect novel and evolving cyber threats by incorporating advanced techniques for anomaly detection and continuous learning. Enhancing the interpretability of KD-XVAE through the integration of more sophisticated XAI methods will also be a priority, ensuring that the decision-making process remains transparent and trustworthy. Finally, collaborative efforts with industry partners will be pursued to facilitate the practical deployment and real-world validation of KD-XVAE in modern automotive systems."}, {"title": "6 Conclusion", "content": "Our proposed IDS model, KD-XVAE, sets a new benchmark in IVN security by achieving state-of-the-art performance with a compact and efficient design. The presented results underscore the significant advancements brought by KD-XVAE, particularly in terms of model complexity and resource efficiency, which make it highly suitable for deployment in real-world automotive environments. The model's reduced parameter count significantly lowers the computational burden, enhancing its feasibility for vehicles with limited processing capabilities. Moreover, KD-XVAE's superior inference times, averaging 0.3 ms per batch, ensure its real-time applicability, enabling immediate detection and response to potential threats. The consistent high performance across all tested attack types"}]}