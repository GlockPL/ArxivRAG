{"title": "Enhancing Thermal MOT: A Novel Box\nAssociation Method Leveraging Thermal Identity\nand Motion Similarity", "authors": ["Wassim Ali El Ahmar", "Dhanvin Kolhatkar", "Farzan Nowruzi", "Robert Laganiere"], "abstract": "Multiple Object Tracking (MOT) in thermal imaging presents\nunique challenges due to the lack of visual features and the complexity\nof motion patterns. This paper introduces an innovative approach to im-\nprove MOT in the thermal domain by developing a novel box association\nmethod that utilizes both thermal object identity and motion similarity.\nOur method merges thermal feature sparsity and dynamic object track-\ning, enabling more accurate and robust MOT performance. Additionally,\nwe present a new dataset comprised of a large-scale collection of ther-\nmal and RGB images captured in diverse urban environments, serving as\nboth a benchmark for our method and a new resource for thermal imag-\ning. We conduct extensive experiments to demonstrate the superiority of\nour approach over existing methods, showing significant improvements in\ntracking accuracy and robustness under various conditions. Our findings\nsuggest that incorporating thermal identity with motion data enhances\nMOT performance. The newly collected dataset and source code is avail-\nable at https://github.com/wassimea/thermalMOT", "sections": [{"title": "Introduction", "content": "Thermal cameras have proven to be robust perception sensors that operate reli-\nably under different weather and lighting conditions for various tasks in computer\nvision [3, 4, 9, 24, 26, 29, 38, 42, 43]. This characteristic of thermal cameras allows\nvision systems utilizing them to take advantage of the unique thermal patterns\nof objects for more robust and reliable performance. Convolutional neural net-\nworks (CNNs) have been used to great effect for a variety of computer vision\ntasks for different spectrums (RGB, thermal, depth, hyperspectral, etc.) These\ntasks range from image classification [20,35,45,50] to object detection [13,27,47]\nand multiple object tracking [48, 49, 51, 52]."}, {"title": "Multiple Object Trackers", "content": "Multiple Object Tracking (MOT) is the task of detecting individual objects in\na video and tracking them over consecutive frames with a unique identifier. The\nperformance of a network is measured in terms of how each object is tracked\nover multiple frames with a consistent ID."}, {"title": "Literature Review", "content": "Our work builds upon the existing literature of object detection, two-stage mul-\ntiple object tracking, the use of thermal sensors for computer vision tasks, and\nexisting MOT datasets with thermal images."}, {"title": "Object Detection", "content": "The task of object detection consists of the detection in a scene of each object\nthat belongs to a set list of categories. The approaches can be divided into two\nmain categories depending on whether the detection pipeline generates object\nproposals to be refined by a second stage (two-stage object detection) [5,13,17-\n19,41] or not (one-stage) [27, 31, 34, 40]. Models in the latter category include\nSSD [34] and YOLO [40], and generally offer a simpler and faster architecture,\nwhile still achieving results competitive with two-stage models.\nThe Task-aligned One-stage Object Detection (TOOD) network, designed by\nFeng et al. [16], iterates upon preceding one-stage object detection networks. Its\narchitecture includes the Task-aligned Head (T-Head) which improves feature\nsharing for the classification and localization sub-tasks, as opposed to using sep-\narate network heads for each one. The Task-aligned Predictor (TAP) part of the\nT-head then improves the alignment of the classification and localization predic-\ntions to better combine them. The training of TOOD is also modified through\nTask Alignment Learning (TAL) which improves default anchor proposals."}, {"title": "Two-Stage Multiple Object Trackers", "content": "Two-stage multi-object trackers can be divided into two sub-tasks, one for each\nstage in the MOT solution: (1) per-frame object detection and (2) tracking over\na sequence. This tracking-by-detection approach enables the easy and direct use\nof existing state-of-the-art object detection networks as a high-accuracy first\nstage and places the design focus on the tracking stage [2,6, 48, 49, 51, 52]. This\nalso allows the training of the first stage on object detection datasets that do\nnot necessarily have tracking annotations, decoupled from the MOT task. The\nmain downside of this is in the limitations of the second stage to recover from\nmistakes in the detection stage, whether false positives or false negatives.\nThe Simple Online and Realtime Tracking (SORT) approach was introduced\nby Bewley et al. [2] and combines any of a variety of CNN object detectors with a\nstraightforward motion estimation tracking approach. After detection in a frame,\na Kalman filter [22] is used to approximate the velocity and the future location\nof each tracklet. For a new frame, the IoU between the approximated location of\nthe tracklets and the detector's predictions is used to assign either an existing"}, {"title": "Thermal Sensors", "content": "Thermal sensors are being used to great effect for a variety of computer vision\ntasks either on their own [14,23, 24, 26, 29, 38,42,43] or through the use of sensor\nfusion with RGB cameras [1,3,4,9].\nLee et al. [29] and Lahmyed et al. [25] both use an RGB camera and a\nthermal camera for the detection of pedestrians. In the former, motion is detected\nindependently in each sensor, and is then used to predict pedestrian location in\nboth sensors.\nLahouli et al. [26] devise a low computational cost method of tracking pedes-\ntrians using compressed thermal images taken by Unmanned Aerial Vehicles\n(UAVs). The suggested approach follows a tracking-by-detection framework where\nRegions of Interest (ROIs) are proposed and refined using saliency maps and con-\ntrast enhancement techniques. These are then tracked over consecutive images\nusing the MPEG compression algorithm's motion vectors.\nNowruzi et al. [38] propose a method to detect the number of passengers\nin a vehicle. A low-cost CNN is used to detect individuals while meeting the\nrequirements for use in an embedded system. Thermal images are used for their\nprivacy-preserving quality, as it is much harder to identify individuals from the\nfeatures present in a thermal image than an RGB image.\nAhmar et al. [1,14] collected a dataset of matching RGB and thermal frames\nwith object detection and MOT annotations. The authors used this dataset\nto compare detection and tracking performance from RGB and thermal data."}, {"title": "Datasets", "content": "Most existing tracking datasets that include thermal images are annotated for\nsingle-object tracking [30,32,33]. For the task of MOT, the City-Scene dataset [1,\n14] contains 15 sequences for a total of 1 997 annotated frames for both a FLIR\nthermal camera and an RGB camera. However, none of the existing thermal\nMOT datasets offer a sufficient volume of data for multi-object tracking for\npedestrians. With limited sequences and annotated frames, these datasets are\ninadequate for training and evaluating MOT algorithms in complex real-world\nscenarios. Recognizing this limitation, we undertook the collection and anno-\ntation of a new, large-scale dataset containing both RGB and corresponding\nthermal data. This initiative addresses the need for a more extensive and diverse\ndataset collected in real-world scenarios, allowing for the development and as-\nsessment of MOT algorithms in challenging, real-world conditions in both the\nthermal and color spectrums."}, {"title": "Data Collection", "content": "We utilize a FLIR ADK thermal sensor and a JAI GO-5100C RGB sensor for\nthe collection of the new dataset. The FLIR ADK thermal sensor specifications\ninclude a 75\u00b0 horizontal field of view, operates in the 8-14 microns (LWIR) spec-\ntral band, has a thermal sensitivity of less than 50 mK, consumes an average\nof 4W of power, and offers an image resolution of 640x512. The JAI GO-5100C\nRGB sensor, it features a global shutter, consumes 4.35W of power, and can\nachieve frame rates of up to 74 frames per second. A plastic enclosure was built\nto fix both sensors next to each other, and was mounted on a tripod for data\ncollection.\nThe dataset of 30 sequences (9000 frames per modality total) was collected\nat 5 different intersections around an urban campus in public spaces. RGB and\nthermal samples from the dataset are shown in Figure 1. The dataset was then\nannotated for multiple object detection and tracking. We refer to this dataset as\nthe RGB-Thermal MOT dataset.\nTo the best of our knowledge, this is the world's first large-scale dataset of\nRGB and corresponding thermal images annotated for MOT. We believe that\nthis dataset will prove to be a valuable resource for research and development\nof both thermal and RGB MOT research. Additional statistics related to the\ndataset are given in Table 1.\nIn the collection of our RGB-Thermal pedestrian dataset, we diligently fol-\nlowed local regulations and ethical guidelines to ensure the respectful and re-\nsponsible use of data. We sought advice from local authorities to align with pri-\nvacy and data protection standards, emphasizing the responsible use of urban"}, {"title": "Experiments", "content": "Our study focuses specifically on the enhancement of the box association step\nfor Multiple Object Tracking (MOT) in thermal imagery. We leverage the ca-\npabilities of the two most advanced two-stage trackers, (ByteTrack [51] and\nOCSORT [6]), as the basis for our experiments. This focused approach allows us"}, {"title": "Benchmarking SOTA MOT models on the RGB-Thermal MOT\ndataset", "content": "We use the OpenMMlab mmtracking framework [8] to benchmark two SOTA\nMOT models (ByteTrack [51] and OCSORT [6]), on both the RGB and thermal\nsequences of the RGB-Thermal MOT dataset. The corresponding RGB/thermal\nTOOD detectors described are used as backbones for the trackers.\nWe optimize the hyperparameters of both ByteTrack and OCSORT to max-\nimize their MOT metrics (specifically MOTA and IDF1) when using their stan-\ndard implementations. This step is crucial to ensure a fair comparison of our\ninnovative box association approach against the highest achievable performance\nof each of those two trackers.\nFurthermore, we conduct a performance evaluation of ByteTrack and OC-\nSORT on the RGB sequences within the RGB-Thermal MOT dataset. This as-\nsessment serves as a valuable reference for future users of this recently acquired\ndataset."}, {"title": "Development of New MOT Box Association Method Utilizing\nThermal Information", "content": "For enhancing Multiple Object Tracking (MOT) capabilities in thermal imagery,\nwe introduce a novel method that leverages motion and thermal identity char-\nacteristics of detected objects to enhance the quality of MOT box association in\nthermal imagery. This approach aims to capitalize on the unique, yet sparse, ther-\nmal signatures captured in thermal imaging, a dimension that standard MOT\nmodels typically overlook.\nThe core of our proposed algorithm is the integration of thermal and motion\ndata to establish a robust tracking framework, as outlined below:"}, {"title": "Thermal and Motion Bounding Boxes:", "content": "Let $T = {t_1, t_2, ..., t_m }$ and $D = {d_1, d_2, ..., d_n}$\ndenote the sets of tracking boxes predicted using a Kalman filter, and detection\nbounding boxes, respectively, within a given thermal image, denoted as $I_{thermal}$."}, {"title": "Initialization:", "content": "The conversion of bounding box coordinates into NumPy arrays\nis a fundamental step for efficient manipulation and computation within our\nalgorithm:\n$T, D \\leftarrow numpy(T, D)$\nThis step lays the groundwork for the algorithm's operations."}, {"title": "Similarity Matrix Construction:", "content": "We define $S_{thermal}$, an $m \\times n$ matrix, to quantify\nthe thermal similarity between each pair of $t_i$ and $d_j$. Initially,\n$S_{thermal} \\leftarrow Zeroes(m, n)$\nThis initialization is a preparatory step for accumulating similarity scores, rather\nthan indicating an absence of similarity."}, {"title": "Pairwise Histogram Comparison:", "content": "For each $t_i$ in $T$ and $d_j$ in $D$, their respec-\ntive Regions of Interest (ROIs) are extracted from $I_{thermal}$, denoted as $ROI_{t_i}$\nand $ROI_{d_j}$ . The histograms $H_{t_i}$ and $H_{d_j}$ are then calculated, normalized to $H_{t_i}$\nand $H_{d_j}$, using appropriate bin sizes and ranges to capture the thermal charac-\nteristics. The normalization process ensures histograms are on a uniform scale,\nessential for accurate comparison. The similarity $s_{ij}$ is computed using the Bhat-\ntacharyya coefficient, a robust measure for histogram comparison, to populate\n$S_{thermal}$ with meaningful values."}, {"title": "Integration with Motion Similarity:", "content": "The motion-based similarity matrix, $S_{motion}$,\nobtained through standard MOT methodologies, is integrated with $S_{thermal}$ to\nform the comprehensive similarity matrix, $S_{comp}$:\n$S_{comp} = \\alpha \\cdot S_{motion} + (1 - \\alpha) \\cdot S_{thermal}$\nHere, $\\alpha$ represents a carefully selected weighting factor that balances the con-\ntributions of motion and thermal similarities, optimized through experimental\nvalidation to ensure effective tracking performance. For ByteTrack, the optimal\nvalue of $\\alpha$ is proven to be 0.3, and that for OCSort is proven to be 0.8 . The value of $\\alpha$ is selected as to ensure the best trade-off between MOTA and\nIDF1.\nThe pseudo-code of the function is given in Algorithm 1."}, {"title": "Results", "content": null}, {"title": "Benchmarking standard MOT models running on RGB", "content": "The results of the standard implementations of ByteTrack and OCSORT on the\nRGB sequences of our newly collected dataset are given in Table 2."}, {"title": "Weighted average alpha-value selection", "content": "In order to accurately find the best alpha-value (the weight of the motion dis-\ntance matrix and the corresponding weight of the thermal distance matrix used\nto calculate the comprehensive distance matrix) we calculate the MOTA and\nIDF1 generated through our approach on the validation sequences of the RGB-\nThermal MOT dataset. The results are given in figure 2."}, {"title": "MOT Metrics Comparison", "content": "For evaluating the feasibility of our suggested box association method, we con-\nsider two state-of-the-art MOT models: Bytetrack [51] and OCSort [6]. Both\nBytetrack and OCSort utilize motion association for the box-association step.\nThe detailed results can be found in tables 3 and 4, while summarized metrics\nare given in figure 4.\nAnalyzing the tables, the following conclusions can be made:\nByteTrack benefits from utilizing thermal information when conducting box\nassociation. The overall MOTA and IDF1 for the original implementation of\nByteTrack are 65.5% and 62.6% respectively. These increase to 66.4% and\n63.8% respectively when using our proposed approach.\nA similar trend can be seen with OCSORT, with the overall MOTA and\nIDF1 values increasing from 54.4% and 57.8% respectively in the original\nimplementation of OCSORT to 56.4% and 58.6% respectively when using\nour proposed box association method.\nThe results validate the effectiveness of our proposed model on enhancing\ntracking performance, where utilizing thermal similarity proves to be beneficial\nfor box association when combined with motion similarity.\nThe proposed approach combines thermal and motion similarity scores through\na weighted average. This fusion method effectively integrates two sources of in-\nformation, allowing the system to make decisions based on both thermal and\nmotion aspects.\nBy considering both thermal and motion aspects, the tracking system be-\ncomes more robust and adaptable. When thermal data indicates a strong match\nbetween objects with similar thermal signatures, the system can prioritize ther-\nmal information. Conversely, when motion cues are reliable, they can take prece-\ndence. This adaptability makes the tracking system more resistant to false posi-\ntives and negatives. In addition, thermal data can assist in handling occlusions,\na common challenge in MOT. When one object obscures another, thermal signa-\ntures may still be distinguishable, allowing the system to maintain the identity\nof both objects."}, {"title": "Limitations", "content": "Our approach introduces an innovative use of thermal sensors for MOT, en-\nhancing detection and tracking capabilities. However, it's pertinent to note the\nrequirement of specialized thermal imaging equipment, which may not be uni-\nversally accessible. Furthermore, the current application and validation of our\nmethodology are confined to urban settings. The efficacy of our method in non-\nurban environments remains to be explored and would benefit from further di-\nversification of the dataset to ensure broad applicability and robustness across\nvarying scenarios."}, {"title": "Conclusion", "content": "In this paper, we have focused on enhancing the performance of MOT models\noperating in the thermal spectrum. Our key contribution lies in the introduction\nof a novel box association mechanism that harnesses both motion similarity and\nthermal object identity. This innovative approach enhances tracking accuracy\nand robustness by considering not just how objects move but also their distinct\nthermal signatures. The thermal and motion aspects are aggregated through a\nweighted average, resulting in a comprehensive similarity matrix that combines\nthe strengths of both modalities. A key contribution of this work is that this novel\nbox association method can be integrated with any two-stage MOT approach\noperating in the thermal spectrum, and encourages the exploration of utilization\nof unique spectrum characteristics when conducting box association. Given that\ntwo-stage MOT approaches are more robust and versatile than single-stage MOT\nmodels [52], we believe this work could inspire more innovative research in this\nfield.\nIn addition, we introduced the world's largest (to the best of our knowledge)\ndataset comprising of both RGB and corresponding thermal images, annotated\nfor pedestrian MOT. We anticipate that this RGB-Thermal MOT dataset will\nbe an invaluable resource for researchers in the fields of MOT and thermal vi-\nsion perception. We fine-tuned state-of-the-art object detection models on this\ndataset, both for RGB and thermal images. Subsequently, we benchmarked lead-\ning MOT models on the dataset with and without our proposed box association\nmethod.\nThe results are compelling. Notably, ByteTrack and OCSort, two state-of-\nthe-art MOT models, exhibited improved performance when our proposed box\nassociation method was employed. The fusion of thermal and motion-based sim-\nilarity scores proved advantageous, making the tracking system more adaptable,\nrobust to occlusions, and resistant to false positives and negatives."}]}