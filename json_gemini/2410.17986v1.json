{"title": "Federated Transformer: Multi-Party Vertical Federated Learning on Practical Fuzzily Linked Data", "authors": ["Zhaomin Wu", "Junyi Hou", "Yiqun Diao", "Bingsheng He"], "abstract": "Federated Learning (FL) is an evolving paradigm that enables multiple parties to collaboratively train models without sharing raw data. Among its variants, Vertical Federated Learning (VFL) is particularly relevant in real-world, cross-organizational collaborations, where distinct features of a shared instance group are contributed by different parties. In these scenarios, parties are often linked using fuzzy identifiers, leading to a common practice termed as multi-party fuzzy VFL. Existing models generally address either multi-party VFL or fuzzy VFL between two parties. Extending these models to practical multi-party fuzzy VFL typically results in significant performance degradation and increased costs for maintaining privacy. To overcome these limitations, we introduce the Federated Transformer (FeT), a novel framework that supports multi-party VFL with fuzzy identifiers. FeT innovatively encodes these identifiers into data representations and employs a transformer architecture distributed across different parties, incorporating three new techniques to enhance performance. Furthermore, we have developed a multi-party privacy framework for VFL that integrates differential privacy with secure multi-party computation, effectively protecting local representations while minimizing associated utility costs. Our experiments demonstrate that the FeT surpasses the baseline models by up to 46% in terms of accuracy when scaled to 50 parties. Additionally, in two-party fuzzy VFL settings, FeT also shows improved performance and privacy over cutting-edge VFL modelstings.", "sections": [{"title": "1 Introduction", "content": "Federated Learning (FL) is a learning paradigm that enables multiple parties to collaboratively train a model while preserving the privacy of their local data [27]. Among its various forms, Vertical Federated Learning (VFL) [53] is particularly prevalent form in real-world applications as highlighted in a recent technical report [48]. In VFL, participants possess different features of the same set of instances, where common features, such as names or addresses, serve as identifiers (a.k.a. keys) to link datasets across these parties.\nReal-world applications often necessitate multi-party fuzzy VFL, characterized by two key attributes. First, it supports collaboration among multiple parties, commonly observed in collaborations across hospitals [33], sensors [52], and financial institutions [38]. Second, it accommodates scenarios where these parties are linked using fuzzy identifiers, such as addresses. Such scenarios are prevalent in applications, as illustrated in an analysis [50] of the German Record Linkage Center [11]. For instance, multiple vehicle rental companies that are fuzzily linked by source and destination addresses in the same city can collaborate to predict travel times.\nTo illustrate the significance of multi-party fuzzy VFL, consider the application of travel cost prediction in a city through collaboration among taxi, car, bike, and bus companies, as shown in Figure 1. Since personal travel information is private and cannot be shared, VFL is essential.\nAdditionally, route identifiers-starting and ending GPS locations can only be linked using fuzzy methods. However, linking closely related source and destination points with multi-party fuzzy VFL can significantly enhance prediction accuracy.\nExisting VFL approaches generally address either the multi-party aspect or the fuzzy identifier issue. Several methods [33, 52, 38, 21, 26] facilitate multi-party VFL using Private Set Intersection (PSI) [10] to link datasets. These methods often presume the existence of precise, universal keys, which are not feasible in common VFL scenarios involving fuzzy identifiers. Conversely, other studies [17, 34, 50] propose two-party fuzzy VFL models that utilize cross-party key similarities for training. However, when extended to multi-party fuzzy VFL, these similarity-based approaches encounter significant challenges in performance and privacy. While some methods achieve reasonable performance, they often compromise privacy or incur prohibitive costs.\nDespite the potential of multi-party fuzzy VFL, several significant challenges must be addressed for effective implementation. First, as the number of parties with fuzzy identifiers increases, maintaining performance becomes increasingly challenging. The addition of parties leads to a quadratic growth in the number of key pairs, an increase in incorrect linkages between fuzzy identifiers, and larger model sizes. These factors collectively heighten the risk of overfitting and adversely impact model performance. Second, the rising costs of preserving privacy intensify as more parties with correlated data participate, leading to either significant computational costs [33, 52, 38] or accuracy loss [47]. Third, in a collaboration of multiple parties, a communication bottleneck arises for the party with labels, termed the primary party. This party must communicate with all other parties without labels, termed secondary parties, in each training round, placing substantial demands on the primary party's bandwidth. These challenges significantly hinder the practical deployment of VFL.\nTo address these issues, we introduce the Federated Transformer (FeT) to enhance performance and reduce privacy costs in multi-party fuzzy VFL. First, to tackle performance issues, we encode key similarities into data representations aligned by positional encoding averaging, which eliminates the need for quadratic calculations of key pairs. Additionally, we have designed a trainable dynamic masking module that automatically filters out incorrectly linked pairs, enhancing model accuracy by up to 13% in 50-party fuzzy VFL on the MNIST dataset. Second, to mitigate the escalating costs of privacy protection, we introduce SplitAvg, a hybrid approach that merges encryption-based and noise-based methods, maintaining a consistent noise level regardless of the number of participating parties. Third, to alleviate communication overhead on the primary party, we implement a party dropout strategy, which randomly excludes certain secondary parties during each training round. This effectively reduces communication costs by approximately 80% and improves model generalization. Our codes are available on GitHub\u00b9. In summary, our contributions are as follows:\n\u2022 We design Federated Transformer (FeT), a novel model achieving promising performance under multi-party fuzzy VFL.\n\u2022 We introduce SplitAvg to enhance the privacy of FeT by protecting local representations in multi-party fuzzy VFL, with a theoretical proof of its differential privacy.\n\u2022 Experimental results demonstrate that FeT significantly outperforms baseline models by up to 46% in terms of accuracy in 50-parties VFL. Moreover, while providing enhanced privacy, FeT consistently surpasses state-of-the-art models even in traditional two-party fuzzy VFL scenarios."}, {"title": "2 Preliminaries", "content": "In this section, we provide the foundational concepts necessary for understanding our approach to differential privacy. Differential Privacy (DP) offers a rigorous mathematical framework for preserving individual privacy. It quantifies privacy in terms of the probability of producing the same output from two similar datasets that differ by exactly one record.\nDefinition 1. Consider a randomized function M : Rd \u2192 O and two neighboring databases Do, D\u2081 ~ Rd that differ by exactly one record. For every possible output set O \u2286 O, M satisfies (\u03b5, \u03b4)-differential privacy if\nPr[M(Do) \u2208 O] < e\u03b5 Pr[M(D1) \u2208 O] + \u03b4,\nwhere \u025b > 0 and 8 \u2265 0.\nA single query that adheres to differential privacy is termed a mechanism. For example, the Gaussian mechanism [4] is commonly used to achieve DP by adding Gaussian noise to the output of the function.\nTheorem 1 (Gaussian Mechanism [4]). For a function f : X \u2192 Rd characterized by a global L2 sensitivity \u25b32, which signifies that the maximum difference in the L2-norm of the outputs of f on any two neighboring databases is \u25b32, and for any \u025b > 0 and \u03b4 \u2208 [0,1], the Analytic Gaussian Mechanism is defined as M(x) = f(x) + Z, where Z ~ N(0, \u03c3\u00b2I). This mechanism satisfies (\u03b5, \u03b4)-\ndifferential privacy if $(\\frac{\\varepsilon \\sigma}{2}) - \\Phi(\\frac{-\\varepsilon \\sigma}{2}) \\leq \\delta$, where $\\Phi(t) = \\frac{1}{\\sqrt{2\\pi}}\\int_{-\\infty}^{t} e^{-x^2/2}dx$\nis the cumulative distribution function (CDF) of the standard univariate Gaussian distribution.\nWhen multiple queries are made on the same database, independent Gaussian noise is added to each query to maintain differential privacy. The privacy loss of the composition of Gaussian mechanisms is formulated in Theorem 2.\nTheorem 2 (Moments Accountant [1]). There exist constants c1 and c2 so that given the sampling probability $q = \\frac{N}{B}$ and the number of steps T, for any \u025b < c1q2T, DPSGD [1] is (\u03b5, \u03b4)-differentially private for any \u03b4 > 0 if we choose $\\sigma > \\frac{C_2 \\sqrt{qT \\log(1/\\delta)}}{\\varepsilon}$"}, {"title": "3 Related Work", "content": "Performance. Traditional VFL approaches [29, 7] are typically limited to two-party scenarios. In contrast, existing multi-party VFL methods [12, 51, 33, 52, 38, 21, 26] often rely on the assumption of precise identifiers that ensure perfect alignment across all parties. These methods generally employ the SplitNN framework [45], where each party maintains a portion of the model, and the models are collaboratively trained on well-aligned data samples through the transfer of representations and gradients, commonly known as split learning. However, the requirement for perfect data alignment is impractical in many real-world scenarios [50, 3], where identifiers are often imprecise.\nTo address this limitation, semi-supervised VFL [22, 30, 19, 20] has emerged, attempting to improve model performance by leveraging unlinked records through semi-supervised or self-supervised learning. However, these methods still assume that datasets from each party can be precisely linked using exact identifiers, a premise that is often untenable in real-world settings [50, 3]. Given that the quality of linkage significantly impacts VFL accuracy [34], exploring effective linkage methods remains a pivotal issue in VFL.\nOn the other hand, FedSim [50], based on real linkage projects at the German Record Linkage Center (GRLC) [3], acknowledges that the keys of each party are usually not precisely linkable and that records may have one-to-many relationships, leading to fuzzy linkage scenarios, as seen with keys like GPS addresses. FedSim enhances training performance by performing soft linkage and conducting training based on transmitted key similarities. Nonetheless, it faces limitations in scalability beyond two parties and introduces new privacy concerns by directly transferring similarities.\nIn summary, while existing studies face significant performance challenges when handling fuzzy keys in multi-party settings, our proposed FeT demonstrates a scalable design that addresses these challenges and shows promising performance improvements in both multi-party fuzzy VFL and two-party settings compared to FedSim."}, {"title": "4 Problem Statement", "content": "In this section, we formalize the concept of multi-party fuzzy VFL. We consider a supervised learning task where one party holding labels, termed the primary party P, collaborates with k parties that do not hold labels, referred to as the secondary parties. The primary party P possesses n data records denoted as xp := {xpi}i=1n along with corresponding labels y := {yi}i=1n. Each secondary party Sk maintains its own dataset xk. All parties share common features, referred to as identifiers, expressed as xpi = [ki, di], where [\u00b7] signifies concatenation. These identifiers ki may exhibit inaccuracies and fuzziness, despite residing within the same range.\nmin\u03b8\u03b7  1n \u2211i=1nL(f(\u03b8; xpi,x1i,...,xSk i); yi) + \u03a9(\u03b8)\nIn this formulation, L(\u00b7) denotes the loss function, \u03b8 represents the model parameters, and \u03a9(\u03b8) refers to the regularization term. The symbol n indicates the number of samples in the primary party P.\nThreat Model. This study focuses on defending feature reconstruction attacks [25, 31], which target local representations shared with the primary party. FeT operates under the assumption that all participating parties are honest-but-curious, meaning they adhere to the protocol but may attempt to infer additional information about other parties. Furthermore, we assume that the parties do not collude with one another. While other forms of attacks, such as label inference attacks [13] and backdoor attacks aimed at compromising labels and gradients, exist, they are considered orthogonal to the objectives of this study. These additional threats will be explored in our future research."}, {"title": "5 Approach", "content": "In this section, we address the performance and communication challenges inherent in multi-party fuzzy VFL. To tackle these issues, we introduce a transformer-based architecture named the Federated Transformer (FeT). This model encodes keys into data representations, thereby reducing reliance on key similarities. To accurately exclude incorrectly linked data records, we propose a trainable dynamic masking module that generates masks based on keys. Furthermore, to combat overfitting caused by the large model and to alleviate communication bottlenecks faced by the primary party, we introduce a party dropout strategy that randomly invalidates some parties during training. Additionally, we identify a positional encoding misalignment issue across parties in the FeT and propose positional encoding averaging to ensure consistent alignment, thereby enhancing model performance."}, {"title": "5.1 Model Structure", "content": "The architecture of the FeT is illustrated in Figure 2. In FeT, each secondary party has an encoder, while the primary party has both an encoder and a subsequent decoder. The internal structure of both the encoder and decoder closely adheres to the conventional transformer model [43]. We utilize multi-dimensional positional encoding [28] to integrate key information into feature vectors. Outputs from the encoders at the secondary parties are aggregated and then fed into the decoder. Details regarding the privacy mechanisms employed during this aggregation phase are discussed in Section 6, while the details of the training process are elaborated in Section 5.2. We then elaborate on three techniques designed to improve performance and reduce communication costs.\nDynamic Masking. The size of the neighborhood varies significantly depending on the party and key values. Consequently, including a large number of neighbors K for all parties can hinder the model's ability to extract meaningful information and result in overfitting. To address this, we introduce a dynamic \u201ckey padding mask\" in the transformer, generated from the identifier values using a trainable MLP. This approach allows the model to effectively disregard distant data records, thereby eliminating the influence of irrelevant data when K is large. This concept resembles the weight gate in FedSim, but it diverges by using identifiers as inputs instead of similarities, enhancing privacy by preventing the transmission of similarity data across parties.\nThe learned dynamic masking is visualized in Figure 3. We derive two key insights from the visualization: (1) Dynamic masking effectively focuses on a localized area around the primary party's identifiers. Data records with distant identifiers on secondary parties (in cooler colors) receive small negative mask values, reducing their significance in the attention layers - without accessing the primary party's original identifiers. (2) The focus area varies in scale and direction across samples: for example, the left figure concentrates on a small bottom area, the middle figure on a small top area, and the right figure on a broad area in all directions.\nParty Dropout. Extending the Federated Transformer (FeT) to support multiple parties can be challenging for several reasons. First, the communication bandwidth required by the primary party becomes a significant bottleneck within the SplitAvg framework, increasing linearly with the number of parties. Second, the inclusion of many parties can result in an excessive number of parameters, which may lead to overfitting. To mitigate these issues, we introduce the concept of party dropout. Inspired by traditional dropout [40], we randomly set a portion ra of the parties' representations to zero during training. This method serves as a form of regularization, thus helping to reduce overfitting, while also significantly cutting down on communication overhead. In our experiments, we demonstrate that increasing the party dropout rate to 0.8 leads to minimal accuracy loss and can even improve accuracy. Consequently, the communication overhead on the primary party can be reduced by up to 80%, enhancing scalability when dealing with large numbers of parties.\nLike traditional dropout, it is crucial to maintain consistent scaling of the representations during both training and testing phases. This consistency is naturally achieved within the SplitAvg framework. During the averaging process, if a ratio r\u0105k of parties is set to zero, we adjust by dividing only by the number of non-zero parties, (1 \u2013 rd)k. This method ensures that the scale of the averaged representations remains consistent across training and testing, regardless of the value of rd.\nPositional Encoding Averaging. In positional encoding (PE), it is generally expected that the distances between encoded representations are positively correlated with the distances between identifiers. In FeT, each party employs its own encoder and PE layer, each tasked with encoding its local identifiers into representations. This configuration leads to significant PE misalignment issues, as illustrated in Figure 4. Although the identifiers and their corresponding encoded representations maintain a positive correlation within the PE layer of each party, there is almost no correlation between the identifiers and encoded representations across different parties. This lack of correlation causes integration issues and affects accuracy. However, directly sharing a PE layer among all parties is not viable due to privacy concerns. To address this, we propose positional encoding averaging.\nEvery Tpe epoch, the positional encoding layers are averaged and broadcast to all parties under a secure multi-party computation (MPC) scheme, akin to FedAvg [23] in horizontal federated learning [27]. While the privacy of the transmitted model can be a concern, this issue is an orthogonal open problem in horizontal federated learning."}, {"title": "5.2 Training", "content": "The FeT training process begins with employing Privacy-Preserving Record Linkage (PPRL) [44] to evaluate identifier similarities between the primary party P and each secondary party. Secondary parties each contribute a random subset for linkage (line 5). For each P's record, K nearest neighbors within these subsets from secondary parties are determined (line 6). The training leverages data embeddings of dimensions B \u00d7 L \u00d7 H, where B is batch size, L is the sequence length, and H is the hidden layer size, following the transformer architecture. In FeT's context, L = 1 for the primary and L = K for secondary parties, linking each primary record with K neighboring records from the secondaries. Identifiers are transformed into vectors using multi-dimensional positional encoding [28] and combined with data representations for processing via self-attention blocks (lines 7, 10). Secondary parties' representations are averaged under the MPC protocol. The primary party then employs attention blocks for forward propagation to compute the final prediction (line 13). Backpropagation sends gradient updates from the primary to secondary parties to refine their local models (lines 14-16). The privacy mechanism including norm clipping (lines 8, 11) and distributed Gaussian noise (line 12) are further discussed in Section 6."}, {"title": "6 Privacy", "content": "In this section, we address the challenges of privacy in multi-party fuzzy VFL. First, the risk of transferring raw similarities has been mitigated by the design of the FeT itself. Second, to address the increasing costs when more parties join, we introduce a multi-party privacy-preserving VFL framework, SplitAvg, which is compatible with FeT. The architecture of SplitAvg is illustrated in Figure 5. SplitAvg integrates differential privacy (DP), secure multi-party computation (MPC) [6], and norm clipping to enhance the privacy of representations. Additionally, to further improve the utility of FeT under DP, we employ privacy amplification techniques that reduce the noise scales by incorporating random sampling."}, {"title": "6.1 Differentially Private Split Neural Network - SplitAvg", "content": "This section outlines three techniques applied to the SplitAvg to improve privacy: representation norm clipping, privacy amplification, and MPC with distributed Gaussian noise. These strategies collectively protect the privacy of each secondary party's representations through differential privacy and ensure that privacy risks do not escalate with an increase in the number of parties due to MPC.\nRepresentation Norm Clipping. The magnitude of the l2-norm is pivotal in determining the sensitivity of differential privacy. To limit the maximum change of the l2-norm, norm clipping is essential. Specifically, for a representation R, we ensure that ||R||2 \u2264 C, where C is a predefined positive real number. This is achieved by scaling R by a factor of C, formally, R = R/ max(1, ||R||2/C'). Through this process, any representation R with ||R||2 exceeding C is scaled to C, while values of ||R||2 below C remain unaffected.\nSecure Multi-Party Computation with Distributed Gaussian Noise. To address the challenges of applying differential privacy in multi-party VFL, we propose a method that integrates noise addition into the process of aggregating representations, facilitated through MPC. In this setup, each secondary party first independently conducts representation norm clipping to limit the scale of their data. Subsequently, these clipped representations, along with Gaussian noise N(0,\u03c3/k2) independently generated by each of the k secondary parties, are aggregated through averaging under MPC. For the primary party, this aggregation is equivalent to adding independent Gaussian noise N(0, \u03c3\u00b2) to the averaged result. The adoption of MPC in our framework ensures that the secondary parties do not need to individually add N(0, 0\u00b2) noise to their representations. Instead, as the primary party only has access to the averaged result under MPC, each secondary party can add a smaller amount of noise. This method effectively improves utility with a small efficiency cost due to MPC.\nPrivacy Amplification by Secondary Subsam-pling. This technique is specifically designed for FeT configurations. According to the princi-ple of privacy amplification [5], applying a func-tion to a randomly sampled subset of data en-hances privacy compared to applying the same function to the entire dataset. By initiating link-age from a randomly sampled subset rather than the full dataset, the privacy parameters effec-tively shift from (\u03b5, \u03b4) to (qe, qd), where q < 1 represents the sampling rate. In FeT, the primary party typically selects subsets of candidate data records for training from each secondary party, targeting those with neighboring identifiers. By pre-sampling these subsets at a rate of q before conducting a k-nearest neighbors (kNN) search, we avoid processing the entire dataset, which in turn reduces the noise required to maintain the same privacy level."}, {"title": "6.2 Privacy Guarantee", "content": "Our analysis of differential privacy focuses on a hypothetical global dataset linked using all secondary parties, denoted as x1, . . ., xSk. Since these datasets are correlated, removing one data record from this global dataset will result in changes to the representations in all secondary parties. Consequently, privacy loss accumulates across secondary parties without the use of MPC. However, with MPC, a single aggregated noise, formed by distributing smaller noise contributions among parties, can be added, effectively reducing the overall required noise. The privacy guarantee for these representations is formally articulated in Theorem 3, with the proof provided in Appendix A.\nTheorem 3. For certain constants c\u2081 and c2, given a sampling rate q, the total number of epochs T, and the number of batches B in each epoch, each representation RSk achieves (\u03b5, \u03b4)-differential privacy for all \u025b < c\u2081q2T, with any \u03b4 > 0, by selecting the standard deviation \u03c3 of the Gaussian noise mechanism as follows:\n$\\sigma > C_2 \\frac{q\\sqrt{BT \\log(1/\\delta)}}{\\varepsilon}$"}, {"title": "7 Experiments", "content": "This section presents the experimental setup and results. We begin by outlining the experimental settings in Section 7.1, followed by an assessment of performance across varying numbers of parties and neighbors in Section 7.2. We then analyze the privacy of FeT in Section 7.3. Additionally, an ablation study is conducted in Appendix C to evaluate the contribution of each component to performance, including dynamic masking, party dropout, positional encoding, key fuzziness, and SplitAvg. The performance of FeT with exact key matching is assessed in Appendix D, while the computational and memory efficiency of MPC and training is evaluated in Appendix E. Privacy evaluation on two-party real datasets is included in Appendix F. Furthermore, FeT's performance under imbalanced feature splits across parties, based on VertiBench [49], is presented in Appendix G."}, {"title": "7.1 Experimental Settings", "content": "Datasets. Our experiments utilize five datasets, including three real-world datasets: house [35, 2], bike [8, 42], and hdb [18, 37], along with two high-dimensional datasets: gisette [16] and MNIST [24]. Detailed descriptions of these datasets can be found in Appendix 7.1. To simulate multi-party fuzzy VFL, we partition the features equally and randomly among the parties. The primary party's feature dimensions are reduced to 4 using principal component analysis (PCA) to serve as universal keys. To create fuzzy linked scenarios, we add independent Gaussian noise with a scale of 0.05 to the keys of each party.\nBaselines. We include three baselines in our experiments: (1) Solo: training only on the primary party; (2) Top1Sim: linking each data record in the primary party only with its most similar neighbor in the secondary parties; (3) FedSim [50]: training on the top K neighboring data records."}, {"title": "7.2 Performance", "content": "Two-party fuzzy VFL. In this experiment, we evaluate the performance of FeT in two-party settings without privacy mechanisms. The detailed results are presented in Table 1. Our experiments demonstrate that FeT consistently outperforms the leading two-party fuzzy VFL methods. Notably, this performance improvement is achieved while enhancing privacy protections, as FeT does not involve transferring similarity data.\nEffect of Number of Neighbors K. In this experiment, we assess the impact of the number of neighbors, K, on FeT's performance by varying K from 1 to 100. The results are displayed in Figure 6. The FedSim baseline is trained using the optimal K value (i.e., 50 for hdb and 100 for house and bike). The figure reveals two key insights: First, FeT's performance improves as K increases, demonstrating its ability to filter useful information even as the number of unrelated data records grows. Second, FeT consistently outperforms all baselines at larger values of K, highlighting its superiority in fuzzy VFL scenarios.\nEffect of Number of Parties In this experiment, we assess FeT's performance in fuzzy VFL with various numbers of parties. Due to the absence of real multi-party VFL data, we employ synthetic data for our evaluations. We partition the features equally and randomly among the parties, reducing the primary party's feature dimensions to 4 using PCA as the universal keys. To simulate fuzzy linked scenarios, we add independent Gaussian noise with a scale of 0.05 to the keys of each party.\nFigure 7 shows that FeT generally outperforms the baselines, particularly with a larger number of parties. This advantage is attributed to Solo's lack of informative features and Top1Sim's noise-affected linkage. FedSim performs poorly as the top-1 linked secondary parties are unaware of the primary parties' keys, leading to misalignment in subsequent soft linkage and training steps. On the gisette dataset with k = 10, FeT and other models slightly underperform compared to Solo, likely due to overfitting given gisette's small size."}, {"title": "7.3 Privacy", "content": "In this subsection, we analyze how the performance of FeT varies with different noise scales (\u03c3) and sampling rates on secondary parties, demonstrating the impact of privacy constraints on its accuracy. The results are depicted in Figure 8. We observe three key points: First, a moderate sampling rate has a negligible effect on model performance and may even slightly improve performance (e.g., on the MNIST dataset) by reducing overfitting. Second, despite increasing noise levels and enhanced privacy guarantees, FeT consistently outperforms baseline models. Third, the \u03b5 \u2013 \u03c3 privacy-noise curves illustrate that solely adding Gaussian noise without MPC, even with advanced analysis theorems such as R\u00e9nyi Differential Privacy (RDP) [32], would require much larger noise scales compared to our approach that integrates MPC."}, {"title": "8 Conclusion", "content": "In this study, we introduce the Federated Transformer (FeT), specifically designed to support multi-party VFL while effectively addressing critical challenges related to performance, privacy, and communication. Furthermore, we provide theoretical proof of FeT's differential privacy, ensuring that data representations remain protected from secondary parties. Notably, our experiments demonstrate that FeT surpasses baseline models, even under stringent privacy guarantees and within the traditional two-party setting, establishing its efficacy and robustness in complex federated environments.\nBroader Impact. The architecture of FeT, even without privacy mechanisms, has potential applications in multimodal learning. Multimodal tasks often require the alignment of data records across different modalities, which can be quite challenging. For instance, aligning 24Hz video streams with 48kHz audio tracks is complex, as each video frame may correspond to a range of audio samples. FeT has shown its capability to effectively learn from such fuzzily aligned data. Furthermore, the transformer model has proven effective across various data types, including images, text, and tabular data, highlighting FeT's suitability for multimodal learning applications."}, {"title": "E Efficiency", "content": "Parameter Efficiency. In our analysis, we assess the computational efficiency of standard addition compared to multi-party computation (MPC) addition, as shown in Table 7. Under the arithmetic GMW protocol [15], and given that the size of the aggregated vector varies by dataset, we use a typical size for our experiments. Specifically, we conduct MPC addition to aggregate 10,000-dimensional vectors from multiple parties. Each experiment is performed five times, with the average timing reported. Although MPC generally incurs higher computational requirements, the results in Table 7 indicate that aggregating high-dimensional vectors via MPC incurs only a one-second overhead, even as the number of parties increases to 100. This minimal time cost is relatively small, especially when compared to other factors such as communication costs. Therefore, our findings suggest that MPC remains a feasible and efficient approach for representation aggregation in the context of VFL.\nTraining Computational and Memory Efficiency. We evaluate the computational and memory efficiency of FeT during training on an RTX3090 GPU with a batch size of 128. The results, shown in Table 8, lead to three key observations: (1) FeT has a comparable number of parameters to FedSim; (2) FeT demonstrates improved memory efficiency compared to FedSim, although this improvement comes with a trade-off in training speed; and (3) the additional components, such as dynamic masking (DM) and positional encoding (PE), introduce only a minor overhead in terms of both parameters and computational cost."}, {"title": "G Performance on Imbalanced Split", "content": "The preceding experiments were conducted using a balanced feature split for VFL. Building on this foundation, we extended our evaluation of FeT to include datasets with varying levels of imbalance, motivated by the recent benchmarks presented in VertiBench [49]. The MNIST datasets are divided by features according to the methodology described in VertiBench [49], utilizing imbalance parameters \u03b1\u2208 {0.1, 0.5, 1.0, 5.0, 10.0, 50.0}, where a higher \u03b1 value denotes greater balance across parties. The findings, illustrated in Figure 15, lead to two key observations: firstly, both FeT and the baseline algorithms exhibit improved performance in more balanced scenarios. Secondly, despite the varying levels of data imbalance, FeT consistently shows competitive or superior performance relative to the baselines."}, {"title": "H Limitations", "content": "The design of FeT includes three primary limitations that warrant careful consideration. First, FeT operates under the assumption that common features exist across all parties. While this assumption is valid in many scenarios, it may not hold in more complex situations where the parties lack a shared set of features. This limitation necessitates further investigation into alternative frameworks or adaptations that can accommodate such cases, particularly in heterogeneous environments.\nSecond, although FeT facilitates the application of scalable differential privacy across multiple parties, the stringent privacy safeguards can lead to significant accuracy reductions when operating with low values of \u03b4. This trade-off between privacy and utility is particularly concerning in performance-sensitive applications, where quantifying the extent of accuracy loss is essential for informing users about the potential impacts on their results. Future work should explore methods to balance privacy and accuracy more effectively.\nThird, similar to other fuzzy VFL methods [50], FeT assumes a correlation between identifiers and data representations. This assumption may not hold in cases where identifiers are randomly generated, which could lead to overfitting and minor performance deficits compared to Top1 approaches. Experiments on such datasets (Appendix D) indicate that while FeT performs well in many scenarios, its effectiveness may vary significantly depending on the nature of the data and the key generation process. Therefore, further empirical studies are needed to assess FeT's robustness across diverse datasets and identifier generation strategies."}]}