{"title": "SCREENER: A general framework for task-specific experiment design in quantitative MRI", "authors": ["Tianshu Zheng", "Zican Wang", "Timothy Bray", "Daniel C. Alexander", "Dan Wu", "Hui Zhang"], "abstract": "Quantitative magnetic resonance imaging (qMRI) is increasingly investigated for use in a variety of clinical tasks from diagnosis, through staging, to treatment monitoring. However, experiment design in qMRI, the identification of the optimal acquisition protocols, has been focused on obtaining the most precise parameter estimations, with no regard for the specific requirements of downstream tasks. Here we propose SCREENER: A general framework for task-specific experiment design in quantitative MRI. SCREENER incorporates a task-specific objective and seeks the optimal protocol with a deep-reinforcement-learning (DRL) based optimization strategy. To illustrate this framework, we employ a task of classifying the inflammation status of bone marrow using diffusion MRI data with intravoxel incoherent motion (IVIM) modelling. Results demonstrate SCREENER outperforms previous ad hoc and optimized protocols under clinical signal-to-noise ratio (SNR) conditions, achieving significant improvement, both in binary classification tasks, e.g. from 67% to 89%, and in a multi-class classification task, from 46% to 59%. Additionally, we show this improvement is robust to the SNR. Lastly, we demonstrate the advantage of DRL-based optimization strategy, enabling zero-shot discovery of near-optimal protocols for a range of SNRs not used in training. In conclusion, SCREENER has the potential to enable wider uptake of qMRI in the clinic.", "sections": [{"title": "1 Introduction", "content": "Conventional magnetic resonance imaging (cMRI) techniques are frequently used in clinical settings for the diagnosis and monitoring [8]. However, assessing subtle changes using CMRI can be challenging, because cMRI produces contrasts that reflect the aggregate effect from a host of tissue properties. To address this challenge, quantitative MRI (qMRI) has been developed to disentangle the specific contribution from each tissue property, enabling the estimation of each individually [17]. Owing to its potential to provide specific insights into tissue characteristics, qMRI has been increasingly investigated to improve diagnosis, staging and treatment monitoring [10].\nDespite its advantages over cMRI, qMRI has yet to achieve wide uptake clinically, due in significant part to its lengthier scan time requirement compared to CMRI, necessitated by the need to acquire data with a range of settings (e.g. different b-values in diffusion MRI (dMRI)). With the number of acquisition settings to include constrained by the scan time budget, it is crucial to optimize the experiment design so that only the most useful settings are included. As attempting this with an empirical, trial-and-error, approach, is time consuming, there has been significant interest in developing computational alternatives, with the most common approach being based on the Cramer-Rao lower bounds (CRLB) [1,2,3,12,13,14,15,19] which aims to minimize the parameter variability. However, one common limitation of these existing approaches is that the underlying clinical task the qMRI experiment is designed for has no influence on the selection of the optimal protocols. We hypothesize that the optimal protocol may be task-dependent and propose a novel framework for qMRI experiment design that can be tailored for a particular task of interest. Our framework includes two components: a task-specific objective module and a deep reinforcement learning (DRL) based optimization module. The task-specific objective module leverages the recently developed, and validated, task-driven protocol assessment [7]. The DRL-based optimization module is chosen over conventional optimization strategies because the former can \u201cpredict\u201d near-optimal protocols under a different circumstance (e.g., different SNRs) to the one used during training without the need to repeat the optimization.\nTo evaluate our proposed framework, we employed a task of classifying the inflammation status of bone marrow using dMRI data with intravoxel incoherent motion (IVIM) modeling for four distinct classification tasks, including three binary classifications and one multi-class classification. Our main contributions can be summarized as follows:\n1. We propose a general computational framework for qMRI experiment design, which can optimize the protocol based on the specific task of interest.\n2. We show optimized protocols are task-dependent.\n3. We find optimized protocols can achieve significant, and robust, improvement in task performance over the ad hoc and CRLB-optimized protocols.\n4. We demonstrate DRL enables zero-shot discovery of near-optimal protocols across varying SNRs superior to ad hoc and CRLB-optimized protocols.\nThe rest of the paper is organized as follows: Section 2 describes the methodology of our proposed SCREENER; Section 3 reports the evaluation strategy and details the results comparing the proposed method against the baselines;\nSections 4 summarizes the contributions and discusses future work."}, {"title": "2 Method", "content": "Given a task of interest, SCREENER determines the optimal protocol through optimizing the corresponding task-specific objective. Below we first provide the details of the task-specific objective module before describing the specifics of the demonstrator of the proposed framework."}, {"title": "2.1 Task-specific objective module", "content": "The task-specific objective module adopts the algorithm recently described in [7]. Its overarching structure is depicted in Fig. 1, alongside the popular CRLB module [1] for comparison. The differences between our proposed framework and previous CRLB work are indicated in dark cyan.\nThe CRLB method is used to establish a lower limit for the variance of parameter estimates. However, it provides only a theoretical lower bound rather than an actual measure of parameter variability. Thus minimizing the CRLB does not guarantee a reduction in the actual variability of parameter estimation. But most importantly, it does not offer optimization tailored to a specific task, a problem we address here.\nIn contrast, the task-specific assessment addresses these limitations directly. It works by mimicking in silico real-world tasks (e.g. classification), downstream of parameter estimation, in its entirety. The algorithm can be summarised as follows:\n1. Simulate real-world cohorts with specific tissue properties;\n2. Simulate data acquisition from these cohorts;\n3. Determine tissue properties from the simulated data through parameter estimation;\n4. Evaluate task performance (e.g., classification) based on the estimated tissue properties."}, {"title": "2.2 Demonstration with IVIM", "content": "In this study, we utilize a series of classification tasks to assess the effectiveness of our proposed framework.\nSignal Model. The dMRI data of IVIM modelling [11] can be defined as:\n$S(b) = S_0e^{-TE/T_2}(fe^{-bD^*} + (1 - f)e^{-bD})$\nwhere S(b) is the MRI signal at diffusion weighting b, $S_0$ is the signal at b = 0,\nTE is the echo time, $T_2$ is the relaxation time, f is the perfusion fraction, $D^*$ is the pseudo-diffusivity, and D is the diffusivity of non-perfusing water.\nUnlike [7], the IVIM model used here includes the dependence of $T_2$ relaxation. Our initial experiments using the version adopted in [7] suggest the CRLB approach prefers protocols with maximum b-values significantly lower than those preferred by the proposed framework (data not shown). As the maximum b-value dictates the minimum TE, thus the maximum SNR, it becomes necessary to account for the effect of TE through the modelling of $T_2$ relaxation. The distribution of the parameters will follow Zhao et al. [21] corresponding to the specific tissue types. After the noise free signals are generated, the Rician noise can be added as follows [5]:\n$S_{noisy}(b) = \\sqrt{(S(b) + \\xi_1)^2 + \\xi_2^2}$\nwhere $S_{noisy}(b)$ is the noise incorporated signal, $\\xi_1, \\xi_2 \\sim N(0, \\sigma^2)$, and $\\sigma=1/SNR$.\nParameter estimation. We chose the most commonly used segmented fitting approach, building on Kaandrop et al. [9]. In this fitting process, we initially obtain the D and f from b-values > 200s/mm\u00b2 [21]. Subsequently, we estimate the value of $D^*$ from the residual signal.\nClassification task. qMRI, especially the IVIM model, is a clinically important tool for characterizing bone marrow pathology [6]. One clinically-important"}, {"title": "3 Experiments and Results", "content": "This section consists of four parts: 1) description of dataset we used, 2) validation of the task-specific objective module, 3) demonstration of the framework's ability to identify optimal protocols that exhibit superior performance in three binary classification tasks and one multi-class classification scenario within a clinical context, and 4) robustness and zero-shot prediction assessment."}, {"title": "3.1 Dataset", "content": "In this study, MRI signals were simulated according to Eqns. [1-2]. To minimize the discrepancy between the simulation and real scanning, the IVIM parameter distributions for different tissue types were set to the values reported by Zhao et al. [21]. We used a gradient strength (G) of 33 mT/m as reported in the official document\u00b3 and T2 was set as 100 ms following Wang et al., [18]. The ad hoc protocol was also taken from Zhao et al. [21] which employed a set of 10 b-values (0, 10, 20, 30, 50, 80, 100, 200, 400, and 800 s/mm\u00b2), and the SNR was set to 25 for $S_0$."}, {"title": "3.2 Validation of the task-specific objective module", "content": "In order to evaluate our Python implementation, we compared the performance for the three binary classification tasks, in terms of Area Under the Curve (AUC), with the original results from Zhao et al. [21] and the results from the original Matlab implementation [7]. In these experiments, the populations of different groups follow Zhao et al., comprising an active group (n = 20), a chronic group (n = 21), and a healthy group (n = 21). The evaluation SNR follows Epstein et al. [7]. We repeated the experiments 50 times and report the means and standard deviations of these fifty experiments, as shown in Table 1. The results of the baselines are obtained directly from the corresponding papers.\nIn Table 1, it can be seen that our Python implementation, is similar to the previous Matlab implementation, but exhibits higher similarity to the original results determined from clinical dataset. For example, in the classification of the active group and chronic group in the clinical dataset, only the parameter D can be used for classification, while the other two parameters show similar performance (0.55 vs. 0.54). Our method can mimic this phenomenon (0.51 vs.\n0.50) better than the original Matlab implementation (0.51 vs. 0.56) in terms of the mean AUC. This improvement may have resulted from the modelling of $T_2$ relaxation in our Python implementation."}, {"title": "3.3 Performance of the overall framework", "content": "After validating the correctness of the task-specific objective module, we evaluate the ability of the proposed framework to identify task-specific optimal protocols on three binary classification tasks and a multi-class classification task. We compare our optimized protocols with the ad hoc protocol reported in Zhao et al. [21] and a standard protocol optimization baseline using CRLB [1]. Both the CRLB optimization framework and our proposed method are optimized under the same SNR and tissue types. For the classification results, we conduct five-fold cross-validation, with the same population groups as Zhao et al. [21]. We repeat the classification process 50 times and report the mean accuracy along with the standard deviation.\nBinary classification. The results of the optimized protocols and the classification accuracies are shown in Table 2. It can be seen that among all three tasks, the ad hoc protocol shows the worst accuracies, the CRLB method shows moderate results, and our proposed method demonstrates the highest accuracy with at least a 3% improvement compared to the ad hoc sequence and a 2% improvement over the CRLB method. Furthermore, for the active group and chronic group, which are of greater clinical interest, our method achieved an improvement of up to 10% compared to the previous optimization method (CRLB).\nMulti-class classification. We further test our proposed method on the multi-class classification task, which is representative of the real-world clinical scenario where multiple tissue types are possible and need to be distinguished. Similar results to those seen with the binary classification tasks are observed: ad hoc has the worst accuracy and SCREENER has the highest accuracy. Our proposed method achieves a 13% improvement compared to the ad hoc protocol and 11% compared to the CRLB-optimized protocol. Additionally, the CRLB-optimized protocol for this multi-class classification is identical to the CRLB-optimized pro-"}, {"title": "3.4 Robustness and the zero-shot ability of the framework", "content": "To thoroughly assess the effectiveness of our proposed framework, we conducted robustness and zero-shot prediction tests on the multi-class classification task. All the settings were the same as in Section 3.3 for multi-class classification, except for the SNR. The results can be found in Fig. 2.\nVaried SNR. We trained the CRLB and the SCREENER under varied SNR and tested them under the same conditions to show the robustness of the SCREENER. The results are consistent with the previous experiments in Section 3.3. Our proposed method achieves the highest accuracy, while the ad hoc method achieves the lowest. Furthermore, we observe that both optimized protocols (CRLB and SCREENER) achieve higher accuracy as SNR increases. In contrast, the ad hoc protocol exhibits lower accuracy with increasing SNR.\nZero-shot SNR. As it can be practically difficult to estimate SNR in clinical protocols, we also tested the zero-shot ability of our method against training with incorrect SNR. Specifically, we trained our method on clinical SNR=25 and tested it on datasets with SNR=[5, 15, 25, 35]. As depicted in Fig. 2, our method achieves the highest accuracy compared with other methods, which exhibits zero-shot discovery ability of near-optimal protocols. Additionally, our method shows similar trends to those seen in the Varied SNR tests: higher SNR correlates with higher accuracy."}, {"title": "4 Conclusion", "content": "In this paper, we present a novel framework for task-specific experiment design optimization in qMRI and demonstrate its impact on a clinically-relevant classification task. Our work showcases that the optimized protocols are task-dependent and can lead to significant improvements compared to previous approaches. Additionally, we demonstrate the robustness of the framework across various levels of SNRs and its ability to discover near-optimal protocols in zero-shot scenarios.\nIn the future, we plan to test the framework on additional models and tasks to evaluate its generalizability, such as the time-dependent dMRI model for glioma classification. [20]."}]}