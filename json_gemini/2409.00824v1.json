{"title": "ACCELERATING HYBRID AGENT-BASED MODELS AND FUZZY COGNITIVE MAPS: HOW TO COMBINE AGENTS WHO THINK ALIKE?", "authors": ["Philippe J. Giabbanelli", "Jack T. Beerman"], "abstract": "While Agent-Based Models can create detailed artificial societies based on individual differences and local context, they can be computationally intensive. Modelers may offset these costs through a parsimonious use of the model, for example by using smaller population sizes (which limits analyses in sub-populations), running fewer what-if scenarios, or accepting more uncertainty by performing fewer simulations. Alternatively, researchers may accelerate simulations via hardware solutions (e.g., GPU parallelism) or approximation approaches that operate a tradeoff between accuracy and compute time. In this paper, we present an approximation that combines agents who \u2018think alike', thus reducing the population size and the compute time. Our innovation relies on representing agent behaviors as networks of rules (Fuzzy Cognitive Maps) and empirically evaluating different measures of distance between these networks. Then, we form groups of think-alike agents via community detection and simplify them to a representative agent. Case studies show that our simplifications remain accuracy.", "sections": [{"title": "1 INTRODUCTION", "content": "Agent-Based Modeling (ABM) serves to represent physical entities as virtual entities in a simulation for a plethora of real world scenarios. These entities known as 'agents' can imitate living organisms such as cells or physical objects such as cities. Furthermore, ABMs are constructed with specific rule sets and laws governing the actions of agents depending on the problem that modelers are attempting to analyze. Regardless of the problem at hand, there is a balance to be struck between the size of the agent population and the resources required for computation. While improving model resolution (i.e., a simulated agent represents fewer real-world individuals) allows for detailed analyses in sub-groups, we must find a compromise given the limited resources such as compute time. This can be achieved through parallelism (B\u0103beanu, Filatova, Kwakkel, and Yorke-Smith 2023) and/or hardware accelerators such as GPUs (Lysenko and D'Souza 2008; Ghumrawi et al. 2022) or FPGA (Xiao et al. 2019). However, modelers may not possess such resources or the programming skills to efficiently use them. An alternative is to group agents. Such groups can be achieved by locally representative agents, also known as \u2018super agents' or 'super nodes' (Lippe, Bithell, Gotts, et al. 2019; Parry and Evans 2008; Parry and Bithell 2012). Agents can also be aggregated/disaggregated via a higher level of abstraction such as a continuum model (Cilfone, Kirschner, and Linderman 2015; Minucci, Heise, and Reynolds 2024). In this paper, we focus on creating super agents to reduce the size of a model and accelerate simulations.\nIn order to find an agent whose behavior is representative of its group, we need to find a meaningful group (e.g., via community detection) and compare behaviors. When the behavior of an agent is primarily a function of its individual traits (e.g., agents have different age or socio-economic status), the comparison is based on the distance between the vectors of traits, as exemplified by the Axelrod model of culture. However, real-world individuals with the same traits can still engage in different behaviors. This is not due to randomness, but to the fact that people follow different rules: even if two seemingly indistinguishable individuals are presented with the same evidence, they may reach different conclusions. We thus use a"}, {"title": "2 BACKGROUD", "content": null}, {"title": "2.1 A Brief Introduction to Hybrid Agent-Based Models and Fuzzy Cognitive Maps", "content": "The heterogeneity of real-world individuals stems not only from looking different or living in different contexts, but also because people reflect differently on facts and experiences. In their reflections, people may be vague or uncertain, leading to fuzzy notions (\u201cif it's too sunny I'll put on some sunscreen\u201d) rather than crisp rules (\u201cIf UV Index Scale > 4 then apply 30 mg of SPF50 sunscreen\u201d). As they make decisions, individuals can consider a variety of pros and cons, which can be interrelated or form patterns such as cycles. For instance, an individual whose family is facing a financial abyss may consider taking their own lives, which would result in even greater financial insecurity (and trauma) for their family. Fuzzy Cognitive Maps (FCMs) allow to transform the implicit mental models of individuals into explicit simulation models where factors (nodes) can be connected (edges), and these causal connections have numerical weights obtained via fuzzy logic. FCMs have been used in over 20,000 studies, often to model the perspectives of stakeholders in complex socio-environmental problems (Giabbanelli et al. 2024). FCMs have also been integrated to ABMs, where each agent can be equipped with an FCM that has a unique structure and unique concept values, resulting in heterogeneity of behaviors (Giabbanelli 2024). Computationally, an FCM is akin to a neural network, hence it is defined by (i) the network structure of concepts and directed, weighted causal edges, representing an agent's ruleset; (ii) the current values of the agent's concept, known as activation vector; and (iii) a transfer function. In the same way as a neural network, a simulation is performed by applying the transfer function repeatedly to update the concept values, until either reaching stabilization or exceeding a user-defined number of iterations."}, {"title": "2.2 Comparing Behaviors via Networks: New and Established Measures", "content": "We can implement a variety of metrics to characterize the Fuzzy Cognitive Map of an agent (Gray, Sterling, Aminpour, et al. 2019) and hence compare maps (Tchupo and Macht 2022; Wills and Meyer 2020). However, using the most appropriate metric is currently an open problem, hence this paper covers many alternatives to evaluate their impact empirically. Since the behavior of each agent is defined by their FCM, we consider metrics that are applicable to FCMs as well as metrics used for networks more broadly. The list of metrics is summarized in Table 1 along with their equation, while this section summarizes the logic of each metric, including established metrics in network science (to keep this paper self-contained). We start with simple and quickly computed metrics (density, number of concepts, receiver/transmitter ratio, clustering coefficient) and then present more computationally intensive measures.\nGraph Density is the number of connections in a network with respect to the maximum number of connections possible for all concepts. It depicts the interwovenness of concepts within an FCM (Tchupo and Macht 2022). The density of a network is calculated depending on whether it is directed (as shown in Table 1) or not. The number of concepts simply compares the total number of nodes in a network to the total number of nodes in the other network (Tchupo and Macht 2022). Intuitively, it can capture that the behavior of one agent depends on more concepts than another agent. The receiver-transmitter ratio is computed based on the number of \u2018receiver nodes' (denoted as R), which serve exclusively as targets and have no outgoing edge, and the number of 'transmitter' nodes (denoted as T) that always act as a source and have no incoming edge (Tchupo and Macht 2022). The clustering coefficient measures the average density of a node's neighbors. That is, we measure the coefficient for each node by looking at the density in the subgraph limited to the node's neighbors. Then, we average the coefficient across the nodes in order to get a clustering coefficient at the level of the graph. The clustering coefficient of a node is given in Table 1 for the directed case. A node without neighborhood is a special case with a clustering of 0."}, {"title": "3 METHODS", "content": null}, {"title": "3.1 First Step: Weighing Social Ties by the Expected Similarity of Behavioral Rules", "content": "A hybrid model is initialized by creating agents with their individual FCMs, who interact through social ties. We start by identifying whether interacting agents can be merged, thus operating a local simplification. We thus only measure the similarity for each pair of interacting agents. That is, each social tie will be weighted using one of the 11 measures (section 2.2): graph density, graph TSP, KL for node and edge weight distributions, Jaccard and KS for edge weight distributions, cosine similarity of betweenness/degree/closeness centrality, number of concepts, clustering coefficient, receiver-transmitter ratio, KL for node, and KS for edge. For example, assume that a modeler defines similarity based on the number of concepts. In Figure 1, agents A and B have $n_A = 6$ and $n_B = 7$ concepts respectively thus their social tie has a weight of $\\frac{|n_A - n_B|}{(n_A + n_B)} \\approx 0.07$, which indicates a small difference. If they had the same number of concepts, the"}, {"title": "3.2 Second Step: Identify Groups of Like-Minded Agents by Clustering the Weighted Social Ties", "content": "Our goal is to reduce a group to a single representative agent. Locality is important: even if an agent had a soulmate at a given time on the other side of the world, the two should not be fused since their interactions with different people/places poses a risk to diverge over time. We posit that people who think alike and are embedded in the same context are more likely to remain similar throughout a simulation. Consequently, after assigning a weight to existing interactions between agents, we use a community detection algorithm on this network of social interactions to identify clusters of (i) like-minded agents who (ii) share a context. We sought balanced clusters so that a comparable level of simplification is operated throughout the agent population, instead of merging only some massive groups into few agents (i.e., few very large communities) or operating a minimal reduction by merging pairs of agents (i.e., many small communities). In addition, we use non-overlapping clusters to ensure that each super-agent represents a distinct group of the initial agents. We considered four algorithms. The chinesewhispers is a randomized algorithm in which nodes are initially assigned different classes, then take the class that dominates in their local neighborhood (Biemann 2006). DER (Diffusion Entropy Reducer) applies random walks and a variant of the k-means algorithm until the clusters stabilize (Kozdoba and Mannor 2015). Paris initially assigns each node to its own class and merges the closest classes recursively as long as the modularity metric increases (i.e., agglomerative hierarchical clustering) (Bonald, Charpentier, Galland, and Hollocou 2018). Finally, combo combines the optimization strategies of other algorithms as it involves merging clusters, splitting them, or re-assigning nodes to a different cluster as long as an objective function score improves (Sobolevsky et al. 2014)."}, {"title": "3.3 Third Step: Aggregating Each Cluster into a Representative Super-Agent", "content": "Each cluster represents a group of agent with similar behavioral rules and local context. We now simplify each group into a super-agent. This could be achieved by morphing the agents into a new composite agent or by identifying a representative agent. We take the latter approach by (i) calculating the sum of the concept values for each agent's FCM and (ii) selecting an agent in the median of these values. Once these representative agents are identified, we rebuild the simulation model by keeping only these agents. We ensure that two representative agents are connected if original agents in their communities used to interact."}, {"title": "4 RESULTS", "content": null}, {"title": "4.1 Overview", "content": "Our objective is to assess the effect of simplification onto fidelity with respect to the original simulation results. We assume the general case of stochastic models where results consist of a distribution of outcomes across repeated simulation runs. The impact of simplification is measured by (i) KL Divergence between the original and new distribution, (ii) the number of reduced nodes, (ii) statistics of distributions (mean, quartiles, std). In addition, we plot the distribution of outcomes as a visual aid. Since modelers control two parameters of our simplification process, results are analyzed with respect to the choice of similarity measure (among 11 possibilities) and the community detection algorithm (out of four choices). Although modelers do not control the case study on which the process would be applied, characteristics of a case study can mediate the results. In particular, our process relies on weighing existing ties between agents, hence the structure of social ties can have an effect and we investigate it through different social network structures. Algorithm 1 summarizes the generation of results and their ensuing analysis. To support replicability, our implementation of the Algorithm and its use on each case study can be found at https://osf.io/hpz7c/."}, {"title": "4.2 Case Studies", "content": "We considered two case studies that openly provide FCMs on nutrition (Giabbanelli, Bernard, and Cussat-Blanc 2022) and obesity (Giabbanelli, Jackson, and Finegood 2014). That is, these studies provide a collection of rulesets that can make agents behave in different ways. The nutrition case study consisted of 722 unique FCMs\u00b2, built from observed longitudinal data about real-world individuals using an algorithm"}, {"title": "4.3 Joint Effect of Community Detection Algorithm, Similarity Metric, and Network Structure", "content": "The communities depend on the structure of social ties, the choice of a measure that assigns similarity weights to these ties, and the choice of algorithm to detect communities from weighted social ties. We measure the interplay of these effects on the CMA-ES case study, as shown in Table 4 for two network structures. Communities are characterized by the average/min/max number of agents in each community and the number of communities. The results show that DER is not usable as it always yields only two communities. We also note that combo does not respond to the choice of the similarity metric, which is undesirable since the notion of a like-minded group should be largely driven by the definition of similarity. For this reason, we identify chinesewhispers as the most promising option and use it in our experiments."}, {"title": "4.4 Fidelity of Simulation Results Between the Simplified and the Original Model", "content": "We computed the distribution of outputs from the original and simplified models based on 100 runs. In both case studies, we observed that means are similar regardless of the case study. Based on the KL divergence, the distributions are similar (Table 5). We further analyzed these results by plotting the most similar distributions. We found that the main effect of the simplification is a greater uncertainty around the mean compared to the original model, as illustrated in Figure 2 for the obesity case study. Complete results on the distributions are provided in Table 6. The extent of the uncertainty depends on the choice of similarity measure, as some yield excessive levels of uncertainty (e.g., centrality and cosine similarity, density) while others have more contained increases. Interestingly, we note that the KL divergence between"}, {"title": "5 DISCUSSION AND CONCLUSION", "content": "Scaling a simulation by creating a small number of representative super-agents that represent a collective \u201chas implications for model forecasts [but] is an underdeveloped field of study\u201d (Wise, Milusheva, Ayling, and Smith 2023). As noted by Wise et al., population sizes can vary hence the extent of scaling is variable. Furthermore, the dynamics of the simplified model can also differ from the original one. In our work, we considered the structure of social ties, the definition of a group (i.e., the clustering algorithm) and the definition of similarity. We showed that chinese-whispers can create groups of varying sizes depending on the similarity and social ties. Our work complement Wise et al. who focused on the geographical dynamics of a model, while we examined the impact of social ties in a hybrid model. We also contribute to the work of Toupance, Chopard, and Lef\u00e8vre (2023), since their reduced model was obtained by a fixed grouping of nearby cells whereas we adapt groups based on social ties and similarity. In our work, the average simulation output was preserved and distributions of simulated outputs were similar between the simplified and original model, although the simplification increases the uncertainty. Future work should comprehensively examine the costs associated with mitigation scenarios for the uncertainty, as these costs may partly offset the benefits of our proposed simplification. For example, if a simplified simulation requires more runs than the original model to reach the same desired confidence interval, then the performance improvements from the simplification are reduced.\nWe analyzed the impact of reducing the number of nodes in a hybrid ABM/FCM model based on the two parameters of our method and one mediating characteristic of case studies. We incorporated three new metrics along with existing metrics to measure the similarities of FCMs of various agents and studied the impact of clustering agents into representative super agents. Both aspects can be elaborated upon in future works. By applying our methods to more cases, modelers may start to discern additional mediating characteristics, particularly with respect to the rulesets of the agents. While the Jaccard and KL metrics were strong performers in our study (by having less uncertainty than alternatives), metrics to compare agents can continue to be developed. For instance, instead of measuring the total number of concepts, we can use a distribution approach by measuring the Hamming distance between the presence or absence of specific concepts. This could be further weighted by concept categories: an agent motivated by price and perceived availability differs from an agent acting based on social-influence, intention, and visibility.\nThe hybrid ABM/FCM framework is an asset for our study as the agents' behaviors are defined through simulation models that allow to leverage the rich literature on network comparison. Dozens of studies have employed the ABM/FCM paradigm (Davis, Giabbanelli, and Jetter 2019), with new case studies appearing regularly (Ciftci and Durmusoglu 2023). However, there are many ways to operationalize the internal cognitive processes of an agent. ABMs can integrate causal relationships, but the representation of these relationships is not necessarily performed through a transparent network within each agent (Antosz et al. 2022). Our findings may thus only apply to frameworks in which cognitive processes of the agents are explicitly represented as a network. For example, hybrid ABM / System Dynamics (SD) models provide a closely related approach by using a network-based simulation model to guide the decision-making activities within each agent (Schieritz and Grobler 2003; Swinerd and McNaught 2014). Our metrics can thus apply to the ABM/SD approach, which could broaden the benefits of our approach for the simulation community."}]}