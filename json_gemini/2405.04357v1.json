{"title": "Global Scale Self-Supervised Channel Charting\nwith Sensor Fusion", "authors": ["Omid Esrafilian", "Mohsen Ahadi", "Florian Kaltenberger", "David Gesbert"], "abstract": "The sensing and positioning capabilities foreseen in\n6G have great potential for technology advancements in various\ndomains, such as future smart cities and industrial use cases.\nChannel charting has emerged as a promising technology in\nrecent years for radio frequency-based sensing and localization.\nHowever, the accuracy of these techniques is yet far behind the\nnumbers envisioned in 6G. To reduce this gap, in this paper, we\npropose a novel channel charting technique capitalizing on the\ntime of arrival measurements from surrounding Transmission\nReception Points (TRPs) along with their locations and lever-\naging sensor fusion in channel charting by incorporating laser\nscanner data during the training phase of our algorithm. The\nproposed algorithm remains self-supervised during training and\ntest phases, requiring no geometrical models or user position\nground truth. Simulation results validate the achievement of a\nsub-meter level localization accuracy using our algorithm 90%\nof the time, outperforming the state-of-the-art channel charting\ntechniques and the traditional triangulation-based approaches.", "sections": [{"title": "I. INTRODUCTION", "content": "Positioning techniques in wireless networks traditionally\nrely on channel parameter estimation methods like Received\nSignal Strength Indicator (RSSI), Time of Arrival (ToA), Time\nDifference of Arrival (TDoA), and Angle of Arrival/Departure\n(AoA/AoD) [1], [2]. These parameters help triangulate or\ntrilaterate a device's position while Channel State Information\n(CSI) offers a more comprehensive approach by considering\ndetailed channel properties and environmental effects on the\nsignal. This method is particularly effective in complex indoor\nenvironments where dense multipath propagation and NLoS\nconditions are dominant. Direct CSI positioning methods are\ndivided into two categories, supervised and unsupervised [3].\nSupervised learning, particularly fingerprinting (FP) methods,\nrelies on a pre-established database of signal characteristics\nlike CSI or Multi Path Components (MPC) as features col-\nlected at known UE locations. This database is used to train\na model that can later predict the location of a device based\non its observed CSI or features, making it highly effective\nin environments with stable signal patterns. Unsupervised\nlearning, on the other hand, does not require a pre-labeled\ndataset. Instead, it estimates a mapping directly from the\ncollected data for an objective function. This approach is\nvaluable in dynamic environments where it is impractical to\ncreate and maintain an extensive labeled dataset, offering the\nflexibility to adapt to changes in the environment over time.\nAlthough CSI provides a comprehensive view of wireless\nsignal propagation from the transmitter to the receiver, in-\ncluding the effects of environmental factors (e.g., scattering,\nfading, and reflection), this detailed information results in\nhigh-dimensional data, making analysis and application in\npositioning systems challenging. Channel Charting (CC), an\ninnovative approach in wireless networking, seeks to create a\nmap or chart of the wireless medium using CSI, enabling the\nprecise localization and tracking of devices within complex\nenvironments [4]. Channel charting is one of the applications\nof manifold learning, a non-linear dimensionality reduction\ntechnique, which plays a vital role in interpreting CSI data.\nManifold learning effectively uncovers the low-dimensional\nstructures hidden within high-dimensional CSI datasets. This\nrefines signal propagation properties, resulting in more precise\nand efficient perceptions of wireless signal interactions with\ntheir surroundings. The primary objective in dimensionality\nreduction is to map data from a high-dimensional space (D)\nto a lower-dimensional space (d) (where d << D), with\ntwo key objectives: i) The mapping should maintain the\nproximal relationships among data points, and ii) It should\neffectively generalize to new and unseen data. Non-parametric\nCC techniques such as Multidimensional Scaling (MDS),\nIsometric Mapping (ISOMAP), and Principal Component\nAnalysis (PCA) perform well in simplifying high-dimensional\ndata while retaining critical structures [5]. MDS focuses\non preserving pairwise distances, ISOMAP extends this by\nmaintaining geodesic distances on a manifold, and PCA\ncaptures the maximum variance through orthogonal principal\ncomponents. However, these methods often fail to accurately\npredict for unseen data as they do not learn a general mapping\nfunction from the original high-dimensional space to the\nreduced space. Instead, they are entirely dependent on the\nspecific dataset they are applied to, and any new data requires\nrecalculating the entire model, making them unsuitable for\nprediction in dynamic environments. Conversely, parametric\napproaches like deep learning-based methods are adept at\nlearning a mapping function that can be applied to novel,\nunseen data. This capacity to extend CC to previously unseen\nCSI data is a significant advantage over traditional strategies.\nDespite the recent advancements in self-supervised CC using\ndeep metric learning, they still struggle to match the precision"}, {"title": "II. RELATED WORK", "content": "Channel charting for localization in wireless networks has\nbeen used for the first time in [6] from a single base station\n(BS) with multiple antennas, and in [7], [8] from multiple\nmassive MIMO BSs in space. Since CC relies on dimension-\nality reduction of the CSI data, [9] and [10] used autoencoders\nto improve this task. A Siamese neural network in [11], [12]\nis proposed that takes random pairs of CSI data to first learn\na local channel chart and then transform it to the global form\nusing a subset of labeled data as reference points in a semi-\nsupervised manner. In this method, the Euclidean distances of\nthe CIR measurements are used as a dissimilarity metric. To\novercome the limitations of the Siamese loss function with\na Euclidean distance metric, a triplet-based loss is used in\n[13], [14] to learn the similarity between triplets of CSI data\nbased on the distance of other side-informations such as the\nrelative recording timestamps. Authors of [15], [16] combined\nCC with the classical localization approaches, taking TOA\nand AoA measurements to improve the global channel chart.\nAlthough the CSI measurements can contain rich information,\nnone of these CC studies exploiting only CSI data have\nsurpassed the performance of traditional triangulation-based\nmethods, even when LoS conditions are present. In [17],\nvelocity estimation and topological map data are used for\nthe global transformation of the CC. However, the global\nconsistency of this algorithm relies on the length of the\ntrajectory taken by the user. Also, the map-matching algorithm\nin this study works only if a unique match of the channel\nchart exists in the map. Finally in [18], by proposing a loss\nfunction containing a bilateration loss including multiple BSS\nwith known locations and a triplet loss, a self-supervised CC\nis made in real-world coordinates. Motivated by this, in this\npaper, we leverage sensor fusion and the location of the nearby\nTRPs in the training phase to enhance localization accuracy."}, {"title": "III. SYSTEM MODEL", "content": "We consider an indoor scenario where a mobile user, a.k.a\nUE,\u00b9 communicates with M fixed TRPs with known locations\nXm \u2208 R\u00b3, Vm \u2208 [1, M] placed in the environment. The UE\nfollows a trajectory with a duration of N time steps. The UE\nlocation at each time step n is assumed unknown and denoted\nby un \u2208 R\u00b3, n \u2208 [1, N]. The height of the UE is presumed\nto be fixed during its trajectory. Both the UE and TRPS\nare equipped with single antennas and operate in orthogonal\nfrequency-division multiplexing (OFDM) transmission mode\nwith total C sub-carriers. The estimated CSI of the link\nbetween the m-th TRP and the UE location un (yet assumed\nunknown) at time step n over all sub-carriers is denoted by\nhm,n \u2208 CC. We assume that the UE and each TRP are\nsynchronized. We denote the channel impulse response (CIR)\nby applying an inverse discrete Fourier transform on each\nCSI vector as wm,n and the concatenated CIR matrix over\nall TRPs at time step n is given by Wn \u2208 CM\u00d7C. We also\nconsider two phases of train and testing in this paper. During\nthe training phase, the UE is equipped with a 2D laser scanner\nto collect depth measurements in addition to CSI, while during\nthe test time, the algorithm only uses the CSI measurements,\nand no laser scanner is required. It is worth mentioning that,\nthe algorithm remains self-supervised during both train and\ntest phases and the only difference is the type of measurements\navailable at each phase. The depth measurements collected by\nthe laser scanner at time step n during the training phase are\ndenoted by ln = {(rk, \u00a2k),\u2200k \u2208 [1, K]} \u2208 RK\u00d72, where K\nis the number of points at each scan of the laser scanner, rk,\nand ok are the relative distance and the angle of each scanned\npoint, respectively, in the laser scanner body coordinate frame\nwhich we assume to be the same as the UE coordinate frame."}, {"title": "A. Data Preprocessing and Feature Extraction", "content": "To increase the robustness of the algorithm, we preprocess\nand extract certain features from the measured CIR. Since the\nmajority of the received power is usually concentrated in the\nfirst few taps, we only consider the first C columns of the\nCIR matrix. The truncated CIR is denoted by \u0174n \u2208 CMXC.\nTherefore, the main input of our algorithm is computed as\nYn = |\u0174n| \u2208 RM\u00d7\u1ee0, where |.| is the element-wise absolute\nvalue operator. We also extract the ToA of the LoS path\nbetween UE and TRPs at time step n by detecting the largest\npick among the columns of Yn. Equivalently, we can write:\nTm,n & arg max y(m)(c),\ncE [1,C]\n(1)\nwhere ym)(c) is the element of matrix Yn at row m and\ncolumn c, and Tm,n is the measured ToA corresponding to\nthe LoS path (i.e. the largest pick of the CIR vector) between\nthe UE and the m-th TRP at time step n. The ToA of all\nTRPs and the UE at time step n in a vectorized form is given\nby tn = (T1,n,\u2026\u2026,TM,n) \u2208 RM.\nFurthermore, we exploit the additional measurements pro-\nvided by a 2D laser scanner, which is available only during the\ntraining phase, to estimate the UE displacement between two\ndifferent time steps. To this end, we employ an Iterative Clos-\nest Point (ICP) algorithm which is a well-known algorithm\nfor processing the laser scanner data. For the sake of limited"}, {"title": "B. Deep Channel Charting", "content": "Given the CIR dataset, it is possible to find a mapping func-\ntion fo : RMXC \u2192 RD that transforms the CIR matrix Yn to\na lower dimension D \u2264 3 as a proxy to the locations, a.k.a\npseudo-position, of the user as \u016bn = fo(Yn). Deep neural\nnetwork has proven to be a good candidate for estimating the\nmapping function fe, as fe is a complicated and non-linear\nfunction. Various methods have been introduced in the litera-\nture to find the mapping function using deep neural networks.\nThese methods range from supervised to unsupervised [6]\u2013\n[18]. In this paper, we build a channel chart algorithm upon\nthe bilateration loss function akin to [18] and by capitalizing\non ToA measurements and the location of the TRPs. We\nextend this method further by incorporating laser scanner data\nto improve the accuracy of localization. Note that, the TRPS\nlocations and laser scanner data are only required during the\ntraining phase. Moreover, our approach is self-unsupervised\nand will provide a global scale representation of the user's\nlocation in the global coordinate frame very close to the\nground truth as opposed to the pseudo-position of the user.\nIn the following section, we elaborate on our approach."}, {"title": "IV. CHANNEL CHARTING USING DATA FUSION", "content": "In this section, we seek to learn a channel chart function\nfe given a training dataset Dtr = {Yn, Tn, xm, ln; Vn, m}.\nWe assume that the pilot signal sent by the UE is received\nat all TRPs. As expressed in [18], from the received CSI,\nwhen we compare the relative received powers at TRPs for\na given UE, the TRPs closer to the UE tend to receive\na signal with higher power under LoS conditions. Let's denote\nthe received power at TRP m from the UE at time step n with\nYm,n = 20log(||hn,m||F), where ||.||F is the Frobenius norm.\nTherefore, we can write:\nYm,nc > Ym,nf + \u0393,\u2200nc, nf \u2208 [1, N],\n(2)\nwhere ne, nf are time steps chosen such that the UE location\nat time step ne is closer to TRP m than when the UE is at time\nstep nf. In other words, ne, nf should satisfy the following:\n||Xm - Unc || < ||Xm - Unf ||,\n(3)\nwhere ||.|| is the Euclidean norm. The constant \u0393 imposes\nthat the received power differs at least by \u0413. From (3), we\ncan constitute the following bilateration loss function:\nLm,ne,ng = max(||xm \u2013 fo(Ync) || - ||xm \u2013 fo(Ynf)|| +d, 0),\n(4)\nwhere d > 0 indicates that the UE at estimated location\nfo(Ync) is closer to TRP m than the UE estimated location\nfo (Ynf) by at least d meters. Assuming that the TRPs are LoS\nto the UE at all time steps, finding a fe that minimizes (4) will\nideally satisfy inequality (2). However, in a realistic scenario,\nthere is no guarantee that the power-distance relation holds,\nas also indicated in [18]. Moreover, the loss in (4) might be\nequal to zero for a vast majority of (ne, nf) pairs, depending\non the value chosen for d, rendering it sample inefficient for\nlearning fe. To tackle this problem, since we can estimate\nthe ToA at each TRP, therefor we can have an estimate of\nd per measurement at each time step. Consequently, we can\nreformulate the loss function in (4) as follows\nLm,ne,ns = (||xm-fo(Ync)||-||xm-fo(Ynf)||+dm,no,nf)2,\n(5)\nwith\ndm,no,nf = |Tm,nc - Tm,ne|V,\n(6)\nwhere v is the speed of light, and |.| represents the absolute\nvalue operator. Please note that, the loss function in (5) is\nspecified per each measurement pair and is not spars, resulting\nin a more sample-efficient training process. However, the\nexpression in (5) is a differential loss function with respect\nto the UE location in two time steps and can bring ambiguity\nto the UE location estimate, hence not preserving the global\ngeometry features. To solve this issue, we redefine Lom,ne,nf\nby splitting it into two additive parts as follows:\nLm,no,ng Lm,nc + Lm,ng,\n(7)\nwhere\n(8)\nLm,n = (||xm - fo(Yn) || - Tm,n v)2.\nFurthermore, We can formulate a separate loss function for\nthe UE locations at time steps ne, nf as follows:\n\n(9)\nLinens = (||fo(Ync) \u2013 fo(Ynf) || - ||Unc - Unf ||)2,\nwhere the first part of this loss function (||fo(Ync)\nfo(Ynf)||) represents the displacement between two estimated\nUE locations at time steps nc,nf, and the second part\n(||Unc - Unf ||) is equivalent to the true UE displacement.\nTherefore, minimizing (9) will result in preserving the relative\ndisplacement between the estimated UE locations in two\ndifferent time steps. However, the second part of this loss\nfunction is not available. To tackle this problem, we exploit the\nmeasurements obtained from the laser scanner. We reformulate\nthe loss function (9) by incorporating the laser scanner data\nas follows:\nc, f\n(10)\nLnens = (||fo(Ync) \u2013 fo(Yns) || \u2013 \u00cenc,nf)2,\nwhere Tnenf is the estimated UE displacement between\ntwo time steps nc,nf using laser scanner data and the ICP\nalgorithm [19].\nFinally, the total loss function including the CIR radio\nmeasurements and the laser scanner data is given by:\nLm,no,ng = Lm,ne,ng + Inc,ns Enc,ng,\n(11)\nwhere Anc,nf is a coefficient that determines the impact of the\nloss pertaining to the laser scanner data. It is worth mentioning\nthat the ICP algorithm might fail to estimate the displacement\nbetween two time steps if the depth measurements in two"}, {"title": "A. Offset Estimation", "content": "The UE location estimated using the channel chart neural\nnetwork model (fe*) trained in the last section might deviate\nfrom the ground truth by an offset. This might happen when\na small set of TRPs (less than 3 TRPs) is available, which\ncan introduce an ambiguity to the UE location estimate and\nresult in getting stuck in a local minima. To tackle this\nproblem, given a trained channel chart model, we formulate\nthe following optimization problem to calculate the offset in\nthe estimation:\n\nb* := arg min \u03a3\u03a3 |\u00eem,n (b) \u2013 Tm,n, (13)\nn=1 m=1\nN M"}, {"title": "V. EVALUATIONS", "content": "To evaluate our proposed method against existing state-of-\nthe-art approaches, the following benchmarks were employed:\n\u2022 Classical PSO: We compared the results with an exten-\nsion of the classical TDoA-based localization algorithm\nin [21], where the PSO technique [20] is instead used to\ntriangulate and estimate the UE location given the TDOA\nmeasurements from the surrounding TRPs.\n\u2022\nSiamese Neural Network [12]: Uses pairs of CSI mea-\nsurements and their corresponding Euclidean distances\nas a dissimilarity metric, preserved in a 2-D encoded\nlatent space. This technique is semi-supervised since the\nestimated latent space requires a linear transformation to\nthe global coordinate frame using a subset of CSI data\nlabeled with true UE locations.\n\u2022 Triplet-based Neural Network [13]: It encodes triplets\nof CSI into a 2-D latent space and similar to Siamese, is\nsemi-supervised and utilizes some labeled data.\n\u2022 Triplets + Bilat. [18]: Employs a self-supervised ap-\nproach using known TRPs locations and their received\npower in a combined triplet and bilateration loss function\nto train a model in the global scale coordinate frame.\nThe performance of the channel charting models is assessed\nthrough both quantitative and qualitative methods. Quantita-\ntive key metrics include Continuity (CT) (ensuring spatial\nrelationships are preserved in lower-dimensional space), and\nTrustworthiness (TW) (ensuring charted similarities reflect\ntrue proximities) as detailed in [22]. In addition, the CDF of\nthe localization error at the 90th percentile (CE90), indicates\nlocalization accuracy and the spread of errors across locations.\nQualitatively, evaluating the charted space through visual\ninspections against expected wireless environment geometries\nhelps verify if the model accurately identifies meaningful\npatterns and relationships within the data."}, {"title": "VI. SIMULATION AND RESULTS", "content": "We consider an indoor factory scenario where there are\nM = 2 LoS TRPs with a fixed height of 8 m. For the sake\nof comparison, the training and testing trajectories are similar\nto the datasets from [12] and IPIN competition 2023 Track 7,\nboth recorded in the Fraunhofer IIS L.I.N.K. hall, where the\nmeasurements are taken in an approximately 20 \u00d7 15 m\u00b2 area.\nNevertheless, we reconstructed the CIR data from the above\ntrajectories in a Matlab environment using 3D map-based\nchannels and a Ray-Tracing toolbox to be able to simulate the\nlaser data in the same environment. In Fig. 2, we illustrated the\nground truth trajectory taken during the training phase while\nin Fig. 3a and 3f, we depicted the trajectories followed by the\nmobile UE during the testing phase. We also define the global\ncoordinate frame as the coordinate frame used for recording\nground truth trajectories. The test datasets corresponding to\nthe test trajectories shown in Fig. 3a and 3f are denoted\nby Dataset 1 and Dataset 2, respectively. The TRPs work\nin sub-6 GHz frequency with a bandwidth of 100 MHz and\n122.88 MSamples/sec sampling rate. We choose the first 49\nelements of the CIR matrix, therefore the dimension of the\ninput to our channel charting network is as Yn \u2208 R2\u00d749. The\nheight of the UE is assumed known and equal to 1.5 m and\nremained constant during both the training and test phases.\nTherefore, we estimate the UE location in the 2D space.\nWe simulated a 2D laser scanner during the training phase,\nwhich provides depth measurements with a resolution of 0.6\ndegree in the angular domain, and an accuracy of 5 cm for\nranging. Both depth and CIR measurements are collected\nevery 20 ms. The architecture of the neural network used\nfor the channel chart function is summarized in Table I. In\naddition, We selected Anc,nf = 5 when |nc - nf| \u2264 500,\notherwise Anc,nf = 0."}, {"title": "VII. CONCLUSIONS AND FUTURE WORK", "content": "In this paper, we presented a new method for channel\ncharting that makes use of ToA measurements from nearby\nTRPs along with their locations. In addition, we leveraged\nsensor fusion by incorporating laser scanner data during\nthe training phase of the algorithm. Our algorithm is self-\nsupervised during the training and test phases, requiring no\ngeometrical models or user position ground truth. Simulation\nresults demonstrated that our algorithm achieves sub-meter\nlevel localization accuracy 90% of the time, surpassing the\nstate-of-the-art channel charting techniques and the traditional\ntriangulation-based approaches."}]}