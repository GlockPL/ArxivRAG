{"title": "Gotham Dataset 2025: A Reproducible Large-Scale IoT Network Dataset for Intrusion Detection and Security Research", "authors": ["Othmane Belarbi", "Theodoros Spyridopoulos", "Eirini Anthi", "Omer Rana", "Pietro Carnelli", "Aftab Khan"], "abstract": "In this paper, a dataset of IoT network traffic is presented. Our dataset was generated by utilising the Gotham testbed, an emulated large-scale Internet of Things (IoT) network designed to provide a realistic and heterogeneous environment for network security research. The testbed includes 78 emulated IoT devices operating on various protocols, including MQTT, COAP, and RTSP. Network traffic was captured in Packet Capture (PCAP) format using tcpdump, and both benign and malicious traffic were recorded. Malicious traffic was generated through scripted attacks, covering a variety of attack types, such as Denial of Service (DoS), Telnet Brute Force, Network Scanning, CoAP Amplification, and various stages of Command and Control (C&C) communication. The data were subsequently processed in Python for feature extraction using the Tshark tool, and the resulting data was converted to Comma Separated Values (CSV) format and labelled. The data repository includes the raw network traffic in PCAP format and the processed labelled data in CSV format.\nOur dataset was collected in a distributed manner, where network traffic was captured separately for each loT device at the interface between the loT gateway and the device. Our dataset was collected in a distributed manner, where network traffic was separately captured for each loT device at the interface between the loT gateway and the device. With its diverse traffic patterns and attack scenarios, this dataset provides a valuable resource for developing Intrusion Detection Systems and security mechanisms tailored to complex, large-scale IoT environments. The dataset is publicly available at Zenodo.", "sections": [{"title": "VALUE OF THE DATA", "content": "\u2022 Large-scale Internet of Things (IoT) networks, such as smart cities, present significant challenges for network security research due to their heterogeneous nature with diverse devices, protocols, and attack surfaces. Most existing datasets in the field are limited in scale and lack the diversity needed to represent large-scale IoT networks accurately. In addition, most research papers on Al-based Intrusion Detection for loT networks neglect such networks' heterogeneity, resulting in unrealistic results.\n\u2022 The proposed dataset addresses these limitations by emulating a large-scale IoT network using the Gotham testbed, offering a realistic environment for network security research. It includes normal traffic generated with protocols such as MQTT, COAP, and RTSP, alongside diverse attack scenarios, including port scanning, brute force, and DoS. This enables researchers to study the complexities of security mechanisms tailored to large-scale IoT networks.\n\u2022 Furthermore, the dataset employs a distributed data collection and organisation approach, where network traffic is captured separately for each loT device at the interface between the IoT gateway and the device. The traffic is stored in device-specific files to reflect real-world IoT deployments where data is generated and maintained at the edge rather than centralised. This design makes the dataset suitable for research on distributed learning techniques in IoT contexts, such as Federated Learning (FL), by enabling the analysis of distributed IoT traffic without relying on centralised data storage. Additionally, this approach eliminates the need for distributing data to simulate realistic heterogeneous conditions, a mechanism most papers in the field rely on.\n\u2022 The dataset is fully reproducible and extensible as it relies on the open-source Gotham testbed. Researchers can replicate the experiments, integrate new loT devices, and expand attack scenarios over time under consistent conditions. Furthermore, the processing and labelling pipeline is shared on GitHub to provide clear and reusable tools for dataset creation.\n\u2022 Researchers can utilise this dataset to develop intrusion detection systems and defence mechanisms specifically designed for large-scale loT networks. The dataset includes diverse device behaviours, traffic patterns, and attack scenarios. This heterogeneity reflects real-world challenges in securing loT systems with diverse configurations and evolving threats."}, {"title": "BACKGROUND", "content": "The motivation behind compiling this dataset originated from the limitations of existing loT network security datasets, which often fail to capture the evolving and heterogeneous nature of large-scale IoT environments [1, 2]. Most datasets are collected in small to medium-scale environments, lacking the structured topologies and configurations in real-world IoT deployments [1]. Typically, devices in these datasets are connected to a single Local Area Network (LAN), which does not accurately reflect the diverse and distributed nature of large-scale IoT networks [1].\nAdditionally, many datasets overlook the heterogeneity of large-scale loT systems, failing to include diverse loT devices, communication protocols, and traffic patterns necessary to simulate real-world conditions [3]. Furthermore, most loT datasets are collected at centralised locations, limiting their relevance for studying distributed learning applications. Many studies focusing on distributed Al for intrusion detection rely on datasets that inadequately address heterogeneity, potentially affecting the"}, {"title": "DATA DESCRIPTION", "content": "The data was collected from the Gotham testbed in PCAP format and subsequently processed into CSV format for ease of processing and analysis. The dataset includes several cybersecurity attacks: DoS, Remote Command Execution, Ingress Tool Transfer, Reporting, Telnet Brute Forcing, Network Scanning, Periodic C&C Communication, Remote Code Execution, and CoAP Amplification Attack. It is a multi-class dataset, where each row represents a network packet and contains 23 features along with a label field. The label field can take 10 different values, including Benign, DoS Attack, Remote Command Execution, Ingress Tool Transfer, Reporting, Telnet Brute Forcing, Network Scanning, Periodic C&C Communication, Remote Code Execution, and CoAP Amplification Attack. The dataset is publicly available on the Zenodo repository [4].\nThe dataset is organised into a hierarchical structure to support scalability and facilitate distributed learning and decentralised analysis. "}, {"title": "EXPERIMENTAL DESIGN, MATERIALS AND METHODS", "content": "All the experiments were conducted using an AMD Ryzen\u2122\u2122 7 5800H (8-Core, 16-Thread) with 32GB RAM running Ubuntu 24.04 LTS."}, {"title": "Testbed Overview and Network Structure", "content": "The dataset is suitable for network intrusion detection studies in large-scale IoT environments. The network traffic was acquired in the Gotham testbed Internet of Things [5]. This testbed simulates large-scale IoT environments, leveraging the GNS3 network emulator [6] to provide a realistic setting for IoT network traffic and security research. Gotham comprises a wide array of Docker images and QEMU-based virtual machines emulating IoT/IloT devices, malware samples, servers, and networking infrastructure, including routers and switches. Real production libraries, Open vSwitch for network switching, VyOS for routing, and various malware samples and red-teaming tools were employed to generate authentic network traffic.\nThe network topology is segmented into three primary networks \u2013 city, cloud, and threat \u2013 connected via 10 routers and 30 switches. The city network was further divided into four network segments. Each segment represents a different operational area, with traffic patterns designed to reflect real-world IoT use cases. These segments generate diverse traffic based on typical smart city scenarios, ensuring a realistic simulation of network behaviour. Attack traffic was distributed across these networks to simulate a realistic smart city environment."}, {"title": "Threat Actors and Attack Scenarios", "content": "The testbed setup involved three distinct threat actors orchestrating a series of attacks: Mirai Malware, Merlin, Port Scanning and Amplification. Each actor employed specific tools and techniques to execute their respective attacks across the network."}, {"title": "Data Collection and Feature Extraction", "content": "Network packets were captured from IoT devices using tcpdump in a distributed manner, generating raw PCAP files. Each PCAP file contains network traffic for a specific IoT device during a given network event, enabling decentralised analysis and distributed learning. The network traffic was captured separately for each loT device at the interface between the loT gateway and the device.\nFirst, benign network traffic was captured over 2 hours without any security attacks, providing a baseline for normal communication. This data enables researchers to create baseline models for intrusion detection. Subsequently, various attacks were launched sequentially, with each attack lasting between 1 and 1.5 hours.\nFeatures were then extracted from the PCAP files using Tshark. This extraction produced CSV files containing the relevant feature vectors, detailing characteristics such as packet size, timestamp, protocol type, source/destination IP addresses, and ports.\nThe data generation, collection, and feature extraction processes were automated using Python scripts to ensure reproducibility and flexibility for adjustments."}, {"title": "Data Labelling", "content": "The extracted data were labelled in Python within a controlled environment, following a structured methodology to accurately distinguish between normal and malicious traffic based on metadata. The metadata was generated during the experimental setup by logging details about the attack scenarios in real-time. It included timestamps of attacks, network packet characteristics, and the attacker's IP address.\nA timing synchronisation strategy was applied to label network packets in the CSV files. This strategy involved aligning the timestamps of attack phases with the captured network traffic. For each attack phase, packets within the corresponding time window were labelled as malicious, while those outside the attack intervals were labelled as normal. This approach ensures precise labelling, maintains the integrity of the dataset and enables researchers to analyse attack behaviours in relation to the exact timing of network traffic. "}, {"title": "Use Examples", "content": "To demonstrate how the dataset can be utilised for intrusion detection research, we present an evaluation of a basic Deep Neural Network (DNN) trained on the dataset in an FL setup. A DNN was selected because DL models are particularly effective at capturing complex patterns in high-dimensional network traffic data. Prior studies [10] have evaluated conventional ML models (e.g., Decision Tree (DT), Random Forest (RF), Support Vector Machine (SVM), K-Nearest Neighbors (KNN)) alongside DNNs for cyber-attack detection in FL settings. The experimental results demonstrated the effectiveness of DNNs in handling large-scale and heterogeneous datasets.\nFL was selected to align with the decentralised nature of IoT systems, where data is generated across multiple devices rather than in a centralised manner. Beyond decentralisation, FL mitigates privacy risks by ensuring that raw network traffic data remains on each loT device [11]. This is particularly relevant for real-world smart city deployments, where transmitting large volumes of traffic data to a central server may introduce security risks as well as network congestion [11]. Additionally, this setup also supports scalability, as models can be trained without centralising vast amounts of data, making it ideal for large-scale IoT networks.\nIn this experiment, we used 10 rounds of FL, which is a typical number used in similar studies [10]. In each round, a subset of 13 IoT devices was sampled for model training. Each IoT device splits its dataset"}, {"title": "ETHICS STATEMENT", "content": "The authors have read and followed the ethical requirements for publication in Data in Brief and confirm that this work does not involve human subjects, animal experiments, or any data collected from social media platforms."}, {"title": "CRediT AUTHOR STATEMENT", "content": "Othmane Belarbi: Conceptualization, Methodology, Software, Data Curation, Writing - original draft.\nTheodoros Spyridopoulos: Methodology, Validation, Writing - review & editing, Supervision. Eirini Anthi: Writing \u2013 review & editing. Pietro Carnelli: Writing \u2013 review & editing. Aftab Khan: Writing review & editing."}, {"title": "DECLARATION OF COMPETING INTERESTS", "content": "The authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper."}]}