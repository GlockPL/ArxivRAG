{"title": "Multiclass Post-Earthquake Building Assessment\nIntegrating Optical and SAR Satellite Imagery, Ground\nMotion, and Soil Data with Transformers", "authors": ["Deepank Kumar Singh", "Vedhus Hoskere", "Pietro Milillo"], "abstract": "Timely and accurate assessments of building damage are crucial for effec-\ntive response and recovery in the aftermath of earthquakes. Conventional\npreliminary damage assessments (PDA) often rely on manual door-to-door\ninspections, which are not only time-consuming but also pose significant\nsafety risks. To safely expedite the PDA process, researchers have studied\nthe applicability of satellite imagery processed with heuristic and machine\nlearning approaches. These approaches output binary or, more recently, mul-\nticlass damage states at the scale of a block or a single building. However,\nthe current performance of such approaches limits practical applicability.\nTo address this limitation, we introduce a metadata-enriched, transformer-\nbased framework that combines high-resolution post-earthquake satellite im-\nagery with building-specific metadata relevant to the seismic performance\nof the structure. Our model achieves state-of-the-art performance in multi-\nclass post-earthquake damage identification for buildings from the Mw 7.8\nTurkey-Syria earthquake on February 6, 2023. Specifically, we demonstrate\nthat incorporating metadata, such as seismic intensity indicators, soil prop-\nerties, and synthetic aperture radar (SAR) damage proxy maps not only\nenhances the model's accuracy and ability to distinguish between damage\nclasses, but also improves its generalizability across various regions. Fur-\nthermore, we conducted a detailed, class-wise analysis of feature importance\nto understand the model's decision-making across different levels of building\ndamage. This analysis reveals how individual metadata features uniquely\ncontribute to predictions for each damage class. By leveraging both satellite", "sections": [{"title": "1. Introduction", "content": "In the aftermath of an earthquake, conducting a Preliminary Damage As-\nsessment (PDA) is typically the first step in evaluating the extent of damage\nand determining the need for governmental assistance [1]. The PDA pro-\ncess typically begins at the local level, where initial damage data is collected\nby local authorities through door-to-door inspections [2] to determine the\nmagnitude of damage, the impact of the disaster, and identify the worst-hit\nregions. These inspections can be unsafe due to falling hazards and other\nsafety concerns due to loss of structural integrity or the risk of aftershocks.\nAdditionally, delays from the large number of structures to be assessed can\nalso significantly hinder the speed of governmental aid deployment, exacer-\nbating the recovery period for affected communities. In 2017, following the\nMexico City earthquake, the Civil Engineering Association of Mexico took\napproximately three weeks to complete evaluations across the entire city,\nwhich delayed recovery efforts and left thousands of people without access\nto their homes [3, 4]. Similarly, in 2023, the Turkey-Syria earthquakes af-\nfected 15 million people, with the preliminary damage assessments taking\nmore than one month to complete. [5, 6, 7, 8, 9]. These cases underscore a\ncritical need for alternative methods that can accelerate the PDA process for\nquicker and more effective response effort.\nThe time-consuming part of the PDA process is the door-to-door building\ndamage assessment. To help speed up access to information for decision mak-\ning, researchers have proposed frameworks to automate the post-earthquake\ndamage assessment process for the identification of the damage state at the\nindividual building level [10, 11, 12]. We discuss these frameworks by adopt-\ning a categorization based on two criteria: (i) data type, including images\nfrom unmanned aerial vehicles (UAVs) and satellites and (ii) data process-\ning methods, either heuristic-based approaches relying on predefined rules or\ndata-driven approaches, such as machine learning (ML) and deep learning\n(DL) techniques, which learn patterns and make predictions based on past\ndata."}, {"title": "2. Proposed Framework", "content": "The framework outlined in Figure 1 consists of three main steps. First,\nhigh-resolution satellite imagery and its corresponding metadata are col-\nlected for the earthquake-affected region, ensuring that the metadata over-\nlaps with the geographic area covered by the satellite imagery. Next, this\nraw data is processed to extract building-level information, with building\nfootprints sourced from OpenStreetMap. Finally, a novel multi-input trans-\nformer model termed QuakeMetaFormer is proposed, trained, and validated\nto process the extracted building-level imagery and metadata and produce\na multiclass damage state. We now discuss the methodology behind these\nsteps in more detail."}, {"title": "2.1. Dataset Collection", "content": "To evaluate our proposed framework, we curate a novel dataset from\nbuildings affected by the Turkey-Syria earthquake of February 6, 2023,\nwhere a magnitude 7.8 quake was centered near Kahramanmara\u015f in southern\nTurkey, as shown in Figure 2(a). Strong aftershocks, including those of mag-\nnitudes 7.5 and 7.6 [44], further contributed to the widespread destruction,\ncausing additional damage. The earthquake damaged more than 200,000\nbuildings and led to the collapse of approximately 20,000 structures. [5, 7].\nWe now discuss details involved in the extraction of satellite imagery and\ncorresponding metadata."}, {"title": "2.1.1. Satellite Imagery", "content": "The satellite imagery used in this study were obtained through MAXAR\nTechnologies' open data program [45], which provides before and after satel-\nlite images during disasters. These images are geotagged and have a res-\nolution of 30 cm ground sample distance (GSD) [46]. In this study, we\nexclusively used post-earthquake imagery and filtered the images based on\nthe areas affected by the earthquake. To extract building-level images, cor-\nresponding building footprints from OpenStreetMap (OSM) were utilized\n[47]. OSM is a free and open-source geographic database, that is continu-\nously updated and maintained by a global community. Figure 2 illustrates a\nsample from the dataset for the city Kahramanmara\u015f, highlighting the satel-\nlite imagery and corresponding building footprints. The final output for each\nbuilding is a cropped section of the satellite imagery, containing three-channel\n(RGB) pixel-level data within the boundaries of the building footprint."}, {"title": "2.1.2. Metadata", "content": "The different sources utilized to collect the relevant metadata for this\nstudy are shown in Figure 3. We define metadata as data consisting of\nsingle-valued real numbers extracted using the centroid coordinates of the\ncorresponding buildings. The metadata can be categorized into three groups:\n(i) seismic intensity indicators, (ii) SAR-derived parameters, and (iii) soil\nproperties.\nSeismic intensity indicators include the Modified Mercalli Intensity (MI or\nMMI), Peak Ground Acceleration (PGA), Peak Ground Velocity (PGV) and\nPseudo-Spectral Acceleration (PSA) at intervals of 0.3 s, 1.0 s, and 3.0 s. MI\nassesses earthquake impact by considering its effects on people, structures,\nand the landscape, with values ranging from 1 to 10, where higher numbers\nindicate more intense shaking and damage. PGA is a quantitative measure\nof the maximum ground acceleration during an earthquake, particularly rel-"}, {"title": "2.2. Data Pre-Processing", "content": "An important step after collecting the imagery and the metadata, is to\naccurately map the ground truth of damage state of the building with the\nsatellite imagery and it's corresponding metadata. The ground truth damage\nstate for the buildings was acquired from the Turkish Ministry of Environ-\nment, Urbanization and Climate Change [54]. The damage severity in the\ndataset were classified into 4 damage classes, numbered 1-4, Slightly Dam-\naged, Heavily Damaged, Needs to be demolished, and Collapsed. Mapping\nthe ground truth with the dataset was done in two steps: mapping the ground\ntruth to the building footprint, and then retrieving its corresponding meta\ndata. In the first step, the nearest building footprint for each ground truth"}, {"title": "2.3. QuakeMetaFormer", "content": "Levaraging the MetaFormer architecture proposed by Diao et al. 2022[56],\nillustrated in Figure 4, QuakeMetaFormer is a multi-input model that takes\nboth image data and metadata as inputs optimized for post-earthquake PDA\nby accounting for extreme class imbalance. MetaFormer employs a hybrid"}, {"title": "3. Experiments", "content": "In this section, we evaluate the performance of the proposed PDA frame-\nwork by conducting four experiments: (i) impact of integrating metadata\nwith satellite imagery on the overall model performance, (ii) comparing the\nperformance of the proposed framework with two previously published state-\nof-the art machine learning frameworks, (iii) assessing the influence of in-\ndividual metadata features on damage state prediction, and (iv) evaluating\nthe effect of metadata in improving the trained model's generalizability to\ndifferent regions."}, {"title": "3.1. Impact of Adding Metadata on Performance: QuakeMetaFormer", "content": "Satellite imagery provides essential visual information for damage assess-\nment, while earthquake-related metadata, such as PGA, SAR, VS30, etc.,\noffers unique insights into event intensity and structural changes. However,\nrelying on either data source individually often lacks the detail necessary for\ndistinguishing between intermediate damage classes. The objective of this\nexperiment is to evaluate how incorporating metadata with satellite imagery\nimpacts the performance of the QuakeMetaFormer model.To achieve this,"}, {"title": "3.2. Comparison of QuakeMetaFormer and Machine Learning Frameworks", "content": "To evaluate the performance of our proposed framework against other\nstate-of-the-art PDA frameworks for earthquake damage assessment, we com-\npared different architectures trained on the same dataset. For this exper-\niment, we trained the QuakeMetaFormer model (QMF-Turkey-S) on the"}, {"title": "3.3. Feature Importance Across Metadata", "content": "Various metadata provide different insights related to earthquake damage\nassessment. To assess the contribution of individual metadata features, we\nconducted a detailed analysis using SHapley Additive exPlanations (SHAP)\n[58]. SHAP provides a robust method for understanding the output of ma-\nchine learning models by perturbing each feature and measuring the resulting\nchanges in prediction probabilities. These changes are then used to assign an\nimportance score based on the feature's contribution to the predictions. For\nthis experiment, we applied SHAP to the QMF-Turkey-L1 model to evaluate\nthe influence of various metadata inputs on damage state prediction. This\nanalysis helps in understanding the impact of different earthquake-related\nindices on model performance. We also performed a class-wise analysis of\nmetadata features to better understand the impact on different classes."}, {"title": "3.4. Generalization Across Regions", "content": "To evaluate the generalization capability of the QuakeMetaFormer model,\nwe divided the Turkey-L dataset into four major regions: Kahramanmara\u015f,\nAd\u0131yaman, Osmaniye, and Malatya. The locations of the training and testing\nregions are illustrated in Figure 5. For this experiment, we trained two\nseparate models on the Kahramanmara\u015f region (i) QuakeMetaFormer with"}, {"title": "3.5. Classification Metrics", "content": "To evaluate the experimental results, we employed five standard classifi-\ncation metrics, including accuracy, precision, recall, F1 score, and the average\narea under the receiver operating characteristic (AUC-ROC) curve. Accu-\nracy is the overall correctness of the model, calculated as the ratio of correctly\npredicted instances to the total number of instances. Precision measures the\nmodel's ability to minimize false positives by calculating the proportion of\ncorrectly predicted positive instances, averaged across all classes to ensure\nbalanced consideration. Similarly, recall assesses the model's effectiveness in\nidentifying true positives by averaging recall values across classes. The F1\nscore, combines precision and recall, serves as a balanced metric for accuracy,\nparticularly in datasets with imbalanced class distribution. The AUC-ROC\ncurve, widely used as a performance evaluation metric in classification mod-\nels, particularly in fields like remote sensing and natural hazard monitoring,\nprovides a comprehensive assessment of a classifier's ability to distinguish\nbetween classes [59, 60, 37, 61]. The AUC-ROC curve offers a comprehensive\nview of the classifier's ability to distinguish between positive and negative\ninstances by plotting the true positive rate (TPR) against the false positive\nrate (FPR). A higher AUC-ROC score indicates better ability to separate\npositive and negative instances.[59, 60, 37]. Table 6 summarizes the metrics\nand their formulas."}, {"title": "4. Results and Discussion", "content": "This section provides a detailed analysis of the four experiments discussed\nin the previous section, highlighting the performance outcomes and insights\nderived from each."}, {"title": "4.1. Impact of Adding Metadata on Performance: QuakeMetaFormer", "content": "The objective of this experiment is to assess the impact of integrating\nmetadata with satellite imagery in improving the performance of PDA frame-\nwork. The results, as shown in the Table 7, demonstrate that incorporating\nmetadata enhances model performance across all metrics."}, {"title": "4.2. Comparison of QuakeMetaFormer and Machine Learning Frameworks", "content": "We evaluate the effectiveness of our proposed models with state-of-the\nart models published in the literature. Xiao Y et al. [37] proposed a ma-\nchine learning approach using a random forest classifier trained on meta-\ndata from the Turkey-S dataset. The model achieved an AUC-ROC of\n0.69, outperforming DPM based methods by 11.25%. We train our proposed\nQuakeMetaFormer with the entire Turkey-S dataset including the satellite\nimagery and the results are shown in Table 8. Notably, QuakeMetaFormer\nachieves an AUC-ROC of 0.85, which is 16% higher than the machine learning\napproach (RF-Xiao). We also plot the ROC curve to understand the model's"}, {"title": "4.3. Feature Importance Across Metadata", "content": "Using SHAP, we quantify the contribution of each metadata feature and\nsatellite imagery to the model's predictions. Figure 10 illustrates the impact\nof all input features, including imagery, on the model's performance across\nfour damage classes: Slightly Damaged, Heavily Damaged, Needs to be De-\nmolished, and Collapsed. In the bar plot, higher values indicate features\nwith a stronger influence on the model's predictive accuracy. As anticipated,\nsatellite imagery demonstrates the highest contribution, as its detailed repre-\nsentation of visible building damage plays a crucial role in decision-making,\nfar outweighing the influence of metadata."}, {"title": "4.4. Generalization Across Regions", "content": "Figure 12 summarizes the results of our experiments, aimed at evaluat-\ning the model's ability to generalize across regions. The findings indicate\nthat the model trained with both metadata and imagery (QMF) consistently\nachieved high AUC-ROC and F1 scores, demonstrating strong generalization\nto unseen regions. For instance, the QMF model trained on Kahramanmara\u015f\nregion and tested on Ad\u0131yaman region, achieved an AUC-ROC of 0.79 and an\nF1 score of 0.45, while achieving 0.81 and 0.47, respectively, when both train-\ning and testing were conducted in Kahramanmara\u015f. This trend continues in\nOsmaniye and Malatya, where the QMF model demonstrates a stronger abil-\nity to generalize to unseen regions. We observe that testing the QMF model\non unseen regions resulted in an average reduction of only 0.026 in AUC-ROC\nand 0.04 in F1 score, highlighting the model's strong generalization ability\nacross different regions while maintaining performance."}, {"title": "5. Conclusion", "content": "In this study, we proposed a novel framework for post-earthquake pre-\nliminary damage assessment (PDA), achieving state-of-the-art performance\nfor the 5-class damage classification task. This problem has received lim-\nited attention in the literature to-date because of the very challenging na-\nture of making multiclass assessments after earthquakes. Our framework\nachieved an AUC-ROC of 0.85, surpassing the previous leading PDA frame-\nwork by 16%. Notably, the performance was consistent across all damage"}, {"title": "The modified focal loss is defined as:", "content": "Modified Focal Loss = $w_t \\cdot (1 \u2013 p_t)^\\gamma \\cdot CE$\n(1)\nwhere $w_t$ represents the class weight for the true class, $p_t$ is the predicted\nprobability of the true class, $\\gamma$ is the focusing parameter, and CE = - log($p_t$)\ndenotes the cross-entropy loss. We found that a gamma value of 4 worked\nbest for our dataset, effectively focusing on hard-to-classify samples."}]}