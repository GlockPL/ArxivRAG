{"title": "Spatiotemporal Air Quality Mapping in Urban Areas Using Sparse Sensor Data, Satellite Imagery, Meteorological Factors, and Spatial Features", "authors": ["Osama Ahmad", "Zubair Khalid", "Muhammad Tahir", "Momin Uppal"], "abstract": "Monitoring air pollution is crucial for protecting human health from exposure to harmful substances. Traditional methods of air quality monitoring, such as ground-based sensors and satellite-based remote sensing, face limitations due to high deployment costs, sparse sensor coverage, and environmental interferences. To address these challenges, this paper proposes a framework for high-resolution spatiotemporal Air Quality Index (AQI) mapping using sparse sensor data, satellite imagery, and various spatiotemporal factors. By leveraging Graph Neural Networks (GNNs), we estimate AQI values at unmonitored locations based on both spatial and temporal dependencies. The framework incorporates a wide range of environmental features, including meteorological data, road networks, points of interest (PoIs), population density, and urban green spaces, which enhance prediction accuracy. We illustrate the use of our approach through a case study in Lahore, Pakistan, where multi-resolution data is used to generate the air quality index map at a fine spatiotemporal scale.", "sections": [{"title": "I. INTRODUCTION", "content": "According to the World Health Organization (WHO), air pollution is responsible for approximately seven million deaths annually, with urban areas being particularly vulnerable due to the high concentration of pollutants such as particulate matter (PM2.5 and PM10), sulfur dioxide (SO2), nitrogen dioxide (NO2), ozone (O3), and carbon monoxide (CO). These pollutants have severe health consequences, including respiratory and cardiovascular diseases [1]. To mitigate these risks, continuous and real-time monitoring of outdoor air quality is crucial for public health and policy-making. In recent years, South Asia cities have been suffering from high pollution levels because of fossil fuel burning, industrial emissions, and crop burning [2]. In this context, this work focuses on generating a spatiotemporal air quality map from a limited (sparse) number of spatially distributed sensors in developing cities.\nThere are various methods to directly or indirectly measure outdoor air pollution such as remote sensing [3] and internet- of-things (IoT) based sensors [4]. Satellite-based approaches, such as those utilizing Aerosol Optical Depth (AOD), provide broader coverage but suffer from issues related to cloud interference, surface reflectance, and atmospheric conditions [5]. Furthermore, the identification of optimal sensor placement remains a difficult task [6], and large-scale deployment of sensors often incurs considerable resource costs.\nRecently, machine learning-based frameworks have been proposed to estimate air quality [7]. Graph neural networks (GNNs) and gated recurrent units (GRUs) are commonly used to model spatiotemporal dependencies [8]. Most of the research had studied the correlation of air pollution with different features, such as meteorological parameters [9], point-of-interests, and road networks with real-time sensors using neural networks [10], [11]. The Gaussian process (GP) regression has been used to identify the hot spot of pollutants in Lahore [12]. After analyzing the land use land cover patterns in [13], the author stated that urban expansion had degraded the air quality. Zhan et al. derived a statistical correlation of air pollution with natural and socioeconomic factors in China across different seasons [14]. Their studies claim that natural factors are more important and the location of air pollutant hot spots may vary from season to season. From the regression analysis, increasing wind speed, gross domestic product (GDP), and forest area in a region reduced air pollution [15]. To deploy new sensors in recommendation systems where AQI at unknown nodes is predicted using semi-supervised learning was employed to train the neural network [10], [11], [16]. These methods studied those geographical factors that had a positive correlation with air pollution. In urban areas, green spaces and water bodies can be included to precisely predict AQI values. In an urban environment, [17] used green spaces to determine their effect on air quality (AQ) estimation.\nNoting the recent development, this work proposes a framework for generating a high-resolution spatiotemporal AQI map for urban regions with sparse sensor data. By incorporating a variety of spatiotemporal factors including meteorological data (at multiple resolutions), road networks, points of interest (PoIs), population density, and urban green spaces, our model captures the spatiotemporal dynamics of air quality across a region. Additionally, we integrate satellite-derived AOD data to enhance the ability of the model to infer air quality at unmonitored nodes. We evaluate the model on the Lahore region and provide insights into the impact of multi-resolution data and urban features on AQI prediction."}, {"title": "II. PROPOSED METHODOLOGY", "content": "This work focuses on estimating measurements at unlabeled nodes in a known static graph G. Let X, Y, and YL represent the features (inputs) to the graph, measurements at all nodes, and measurements at labeled nodes, respectively. The goal is to infer Yu, the measurements at unlabeled nodes. The joint probability distribution for learning the model parameters is given by\n$p(\\Theta, Y_L, X) = p(\\Theta | Y_L, X) p(Y_L | X) p(X),$ (1)\nwhere $\\Theta$ represents the model parameters. To estimate Yu, we use the posterior distribution $p(Y_u | X, G, \\Theta)$, which integrates the spatial and temporal dependencies of the data encoded in the graph structure G."}, {"title": "B. System Model", "content": "We consider a graph G = (V, E, X), where V is a set of nodes (grid cells in the region of interest) with a total number of nodes |V| = N, E is a set of edges connecting the nodes, and X represents the feature vectors associated with each node.\nThe region of interest is divided into grid cells, each representing a node in the graph. The adjacency matrix A is constructed using a thresholded Gaussian kernel [18] with elements expressed as\n$a_{i,j} = \\begin{cases}exp(-\\frac{d_{i,j}^2}{\\sigma^2}), & \\text{if } exp(-\\frac{d_{i,j}^2}{\\sigma^2}) \\geq r,\\\\ 0, & \\text{otherwise,}\\end{cases}$ (2)\nwhere dij denotes the Euclidean distance between nodes i and j, \u03c3 controls the scale of the kernel, and r is the threshold for adjacency. The degree of the weighted adjacency matrix is formulated as $D_{ii} = \\sum_j A_{(i,j)}$, which is used to define the normalized adjacency matrix [19] as $\\bar{A} = D^{-\\frac{1}{2}} (A + I_N) D^{-\\frac{1}{2}}$.\nEach node in the graph is associated with spatio-temporal features such as temperature, pressure, humidity, and additional spatial characteristics like population density, road networks, and green spaces. These features are encoded as inputs"}, {"title": "C. Learning Framework", "content": "The overall learning network is shown in Fig. 1. To model spatial (or topological) features and capture temporal dynamics, we incorporate Graph Convolutional Networks (GCNS) and Convolutional Neural Networks (CNNs), respectively. The spatiotemporal data is characterized by two different resolutions. The feature matrix $X_1 \\in \\mathbb{R}^{C_1 \\times T_1 \\times N}$ consists of aerosol optical depth (AOD), land surface temperature (LST), surface pressure, humidity, wind speed, and wind direction, all with a one-day resolution. In contrast, $X_3 \\in \\mathbb{R}^{C_3 \\times T_3 \\times N}$ has a one-hour resolution, where its features include temperature, humidity, and pressure. Here, $C_1$ or $C_3$ represents the total number of features and $T_1$ or $T_3$ is the number of time-points (days or hours) of the historical data respectively.\nThe processing of the spatiotemporal data in the network is given by\n$H_k^{(l+1)} = f(\\bar{A} H_k^{(l)} W_k^{(l)}), H_k^{(0)} = f(\\text{conv}(X_k, W_k)),$ (3)\nwhere k \u2208 {1,3}, and $H_k^{(0)}$ denotes the initial input data for each feature set $X_k$. In (3), $W_k^{(l)}$ and $W_k$ represent the weights of the GCN and CNN for feature $X_k$, respectively, f denotes the activation function and l is the layer of the GCN.\nSpatial data is processed using GCN layers as\n$H_2^{(l+1)} = f(\\bar{A} H_2^{(l)} W_2^{(l)}),$ (4)\nwith the initial feature $H_2^{(0)} = X_2$. We combine the output of GCNs as\n$\\tilde{H} = \\alpha H_1 + \\beta H_2 + \\gamma H_3,$ (5)\nwhich is then vectorized before concatenating with the time of the day and the day of the week and then passing through a GCN layer to obtain the predicted output $\\hat{Y}$ over N number of nodes. Here \u03b1, \u03b2, and \u03b3 are learnable parameters. The ground truth Y represents the real-time AQI values obtained from the sensors at a given time. To train the network, the following total loss function is minimized [20]\n$\\mathcal{L}_{total} = \\mathcal{L}_{sup} + \\mathcal{L}_{reg},$ (6)\nwhere $\\mathcal{L}_{sup}$ is the supervised loss computed as the mean squared error (MSE) on the labeled nodes $V_L$ and $\\lambda$ is the penalty term for the unsupervised (smoothness) loss given by [21]\n$\\mathcal{L}_{reg} = \\sum_{i,j \\in V} a_{ij} (\\hat{Y}_i - \\hat{Y}_j)^2.$"}, {"title": "III. IMPLEMENTATION", "content": "We consider Lahore District, Pakistan's second-most populous city, covering 1,772 km\u00b2 at 31.5497\u00b0N, 74.3436\u00b0E, as a study area. We divide the Lahore region into 2401 grid cells (each with a spatial resolution of 1km\u00d71km), where each"}, {"title": "A. Data Acquisition", "content": "Data of various types, including air quality, meteorological conditions, road networks, points of interest, population density, and urban green spaces, are collected from multiple sources. These include geo-satellites (MODIS and ERA5), web services (Google Maps and OpenStreetMap), real-time sensors, and open-source datasets.\nParticulate Matter Data: We manually log the 2.5\u00b5m particulate matter (PM2.5) and AQI data from IQAir at hourly rate resolution from 20/12/2024 to 31/12/2024. Aerosol optical depth (AOD) is extracted from MODIS (Moderate Resolution Imaging Spectroradiometer) every day with a spatial resolution of 1 km. It contains the aerosol size of 0.44 \u00b5m and 0.55 \u00b5m. We employ the data of the MCD19A2 product that utilizes the multi-angle implementation of atmospheric correction (MAIAC) algorithm for cloud masking and corrects atmospheric effects over both dark vegetated surfaces and bright deserts.\nMeteorological Data: Atmospheric data has been extracted from ERA5 [22] with a spatial resolution of 9 km with the daily interval. We concatenated AOD, land surface temperature, pressure, relative humidity, wind speed, and wind direction to capture complex patterns. IQAir sensors provide temperature, pressure, and humidity at an interval of one hour. We use the inverse distance weighting to interpolate the data at the nodes where the measurements are not available.\nRoad Networks: Since the traffic congestion directly impacts air quality, we incorporate the road network to determine its correlation with the concentration of air pollutants. The aggregate length of smaller roads within the grid cell is used as a node feature. The total number of T-intersections and multi-leg intersections within a region are also included in the feature matrix.\nPoint-of-Interests (POIs): People and traffic congestion depend on the infrastructure and point-of-interests (PoIs). Such Pols determine the congestion patterns during rush hours in our daily routine.\nPopulation Count: In urban areas, densely populated areas have a positive correlation with polluting agents. We collected an estimated high-resolution population count provided by Landscan [23] with 30-arc seconds resolution.\nUrban Green Spaces (UGS): Urban green spaces (UGS) serve as natural filters, absorbing pollutants from the ambient environment and exhibiting a strong inverse correlation with air pollution. In this study, UGS data is incorporated into the model by summing the green areas within each grid cell. These spaces include various categories such as amenities, barriers, boundaries, land use, leisure areas, natural reserves, tourism sites, and parks, all extracted from OpenStreetMap (OSM).\nWe set r = 0.01 to construct the adjacency matrix and normalize the features using (x \u2013 \u03bc)/\u03c3, where \u03bcand \u03c3 represent the mean and standard deviation of each feature, respectively. The model is implemented using a deep neural network framework in the PyTorch environment, with the Adam optimizer employed for training over 100 epochs. To ensure robustness, we perform two independent experimental runs. In each run, two sensors are randomly selected for testing, while the remaining sensors are used for training the model. In our experimentation, we use T\u2081 as 4-day historical data and T3 as 24-hour historical data. We compute the mean absolute error (MAE), root mean square error (RMSE), mean absolute percentage error (MAPE) to evaluate the performance."}, {"title": "IV. RESULTS", "content": "We evaluate the performance of the proposed framework under various combinations of learning rate (lr) and \u03bb. For each experimental run, a random pair of sensors (out of 30) is selected for validation, while the sensor sequence remains fixed to isolate the effects of hyperparameters.\nTable II presents performance metrics for two individual runs, as well as the average metrics computed over 10 runs. The results indicate that the best average performance is achieved at lr = 10-4 and \u03bb = 10-6, underscoring the importance of both the learning rate and smoothness parameter in training the model effectively. The variability in performance metrics across runs can be attributed to differences in graph topology, as the connectivity and spatial dependencies within the graph significantly influence the learning process in graph-based models. Once the model is trained, we use it to generate high-resolution AQI spatial maps for the Lahore region. Notably, higher AQI values are observed on December 22 because of increased aerosol concentrations at 0.44 \u00b5m and 0.55 \u00b5m, which indicates reduced sunlight exposure. We compare the predicted AQI values with the actual AQI values for two sensor nodes during Run 2, as shown in Fig.4. Morning rush hours (7:00\u201310:00) and evening peak hours (17:00\u201320:00) are highlighted to analyze real-time AQI patterns. Notably, AQI peaks during evening hours, driven by traffic congestion and reduced sunlight. While the model effectively captures real-time trends, it does not fully replicate the entire structure of the data. Specifically, the model under-predicts AQI during evening hours in Fig.4a and overestimates it during morning rush hours in Fig. 4b.\nThe performance of the model deteriorates more significantly when the time points of X\u2081 are reduced from 4 to 2 days compared to reducing the time resolution of X3 from 24 to 12 hours. This highlights the critical role of AOD and meteorological parameters at a daily resolution in estimating AQI values. Additionally, the performance of our deep neural network (DNN) improves with larger temporal dependencies, demonstrating that temporal data at multiple resolutions enhances the predictive capabilities of the model. While spatial features are crucial for capturing the dynamic characteristics of urban environments, certain features limits the generalizability of the model. For example, Points of Interest (PoIs) and Urban Green Spaces (UGS) exhibit sparse distributions across the graph, which can negatively affect performance. To evaluate the contribution of individual spatial features, we trained the model with isolated feature sets. The analysis revealed that population counts have a more significant impact on AQI predictions compared to other spatial features. Despite the variability in their utility, spatial features remain integral to accurately modeling the complexities of large cities. Although we implemented this framework on a spatially sparse set of temporal AQI samples, it can be extended to handle long-duration datasets effectively."}, {"title": "V. CONCLUSIONS", "content": "We have proposed a framework for high-resolution spatiotemporal mapping of air quality using sparse sensor data, satellite imagery, and various environmental factors. By leveraging GNNs, our framework estimates AQI at unmonitored locations, capturing both spatial and temporal dependencies. We have integrated a wide range of features, including meteorological data, road networks, PoIs, population density, and urban green spaces, into the model. Our case study in Lahore demonstrated the effectiveness of the proposed approach of using multi-resolution data to generate AQI maps at a fine spatial scale. We believe that the proposed framework offers a valuable tool for policymakers to assess air quality distribution in densely populated areas and devise targeted interventions to mitigate pollution. Incorporating additional data sources and exploring different network architectures for improving the accuracy of AQI predictions are future research directions."}]}