{"title": "Cultural Heritage 3D Reconstruction with Diffusion Networks", "authors": ["Pablo Jaramillo", "Ivan Sipiran"], "abstract": "This article explores the use of recent generative AI algorithms for repairing cultural heritage objects, leveraging a conditional diffusion model designed to reconstruct 3D point clouds effectively. Our study evaluates the model's performance across general and cultural heritage-specific settings. Results indicate that, with considerations for object variability, the diffusion model can accurately reproduce cultural heritage geometries. Despite encountering challenges like data diversity and outlier sensitivity, the model demonstrates significant potential in artifact restoration research. This work lays groundwork for advancing restoration methodologies for ancient artifacts using AI technologies.", "sections": [{"title": "1 Introduction", "content": "The reconstruction of everyday items is a task as old as humanity itself and as diverse as any other technique. In recent decades, 3D printing has exploded in popularity, and with a vast and creative community, the technique and technology have advanced so quickly that on-site rapid construction of items ranging from whole products to replacements to tools is common in homes and industries.\nDespite the rapid growth in 3D generational technology, the design of these items, especially when requiring repairs of non-replaceable items, often involves a laborious manual task that requires previous experience with 3D modeling or CAD. Automated 3D reconstruction using Deep Learning models is a promising solution for this issue. The promise of this technique is simple: given a broken object, it can generate the shape required to restore it. However, the implementation is more elusive and subject to numerous research studies.\nRecent progress in generative AI has opened the door to a myriad of applications in which it is increasingly feasible to generate information that fits well with the known data distribution. Consequently, the data generated are of high quality and very similar to the original data. These characteristics make"}, {"title": "2 Related Work", "content": "Interest in three-dimensional reconstruction has increased significantly over the past several decades, resulting in the creation of numerous works that employ a diverse range of techniques and architectures. Each of these approaches offers unique advantages and characteristics that can be utilized to achieve specific objectives.\nExamples of the architectures used are Generative Adversarial Networks, Occupancy Networks, autoencoders, and, more recently, diffusion models.\nBy examining the results and underlying techniques of these studies, we can identify opportunities for further exploration. For instance, models that employ voxel representations have demonstrated effectiveness; however, achieving a practical resolution for general 3D reconstruction remains a challenge. Other promising models alleviate the need for computationally expensive voxel representations using point clouds as a compact representation. Nevertheless, achieving high-quality results remains a challenge because of the arbitrary sampling of points in 3D space.\nMore recently, reconstruction has been formulated as a completion task, where a model learns to predict a complete object given a partial observation. Diffusion models have also been used to address this problem. For example, some methods explore alternative representations, such as signed distance functions,"}, {"title": "3 Background", "content": "In this section, we describe the details on conditional completion with diffusion models [6]."}, {"title": "3.1 Completion with Diffusion Models", "content": "The task of reconstruction in the point cloud space with a diffusion model involves a conditional generation process with a forward and backward pass through a chain of probabilistic changes, inspired by [25], where the cloud of N points to be repaired co \u2208 RN\u00d73 is the conditional basis for generating a cloud xo that contains all points from co plus M corresponding to the repair. During training, ground-truth repair is necessary to obtain cloud \u00e3o \u2208 RM\u00d73 thus, xo = (xo, Co). Both N and M are hyperparameters of the model chosen by the desired level of quality, and relative volume of the complete shape that a repair is expected to take. With this, we can define the conditional forward diffusion process modeled as a Markov chain, where there is a sequence of T steps. Then, for each step, small additions of noise were made to \u00e3o, gradually shifting the positions of its points while keeping co unaffected. This results in clouds xi \u2208 {xi, Xi = (Xi, Co), Vi\u2208 No, i \u2264 T} and fits a distribution:\n$$q(xo:T) = q(xo) \\prod_{t=1}^{T} q(xt|xt\u22121)$$\nThe transitions consist of a parameterized Gaussian distribution that can have a set variance schedule \u03b21, ..., \u03b2r to control the rate of diffusion.\n$$q(xt|xt\u22121) := N (\\sqrt{1 \u2013 \u03b2}xt\u22121, \u03b2tI)$$\nThen the backward or \"reverse\" diffusion process undoes the formerly described process by removing noise from ~ ~ N(0, I) in a similar fashion under another Gaussian distribution as follows:\n$$p\u0473(xo:T) = p(xo) \\prod_{t=1}^{T} Po(Xt\u22121|xt, Co)$$\n$$Po(Xt-1|Xt, Co) := N (\u03bc\u0473(xt, Co, t), \u03b2tI)$$"}, {"title": "4 Generalization Experiment", "content": "The methodology and design behind the model are sound and do not provide indications as to why it would not perform in other scenarios. We then decided to try out the model using other datasets with more generic objects.\nAs a starting point, we decided to use the geometric break dataset from [11] which contains a variety of item classes similar to other popular datasets. These objects feature breakages with a degree of realism that, while not perfect, deliver fair representations of the surface patterns that can be seen in real-life breakages.\nIn particular, we tried out the bottle, cup, pot, and vase classes because they can represent practical, easy to conceptualize applications where 3D reconstruction can be of use. These have 447, 178, 500, and 500 different objects in obj mesh files, each broken in different ways such that they totaled 1274, 1559, 1377, and"}, {"title": "4.1 Evaluating Results", "content": "To evaluate the results, we devised a metric to determine the proximity of a given repair to an optimal repair. This metric involves calculating the Chamfer and Haussdorf distances [22] between our results and the ground truth, normalized by the respective distance between the ground truth itself. Specifically, for a given repair shape S, our calculated shape Sr, and its ground truth Sg, where the ground truth consists of N points and the calculated shape consists of M points with N > M, we use a method for random down sampling R that reduces a shape to a target number of points. For a distance metric D, we calculate the distance factor F as follows:\n$$FD = \\frac{D(Sr, R(Sg, M))}{D(R(Sg, M), R(Sg, M))}$$\nThe concept involves using a pair of random downsamplings of the ground truth to approximate the realistic lower bound for the distance between a generated repair shape and its ground truth counterpart. Consequently, the factor derived from the division in the aforementioned formula serves as an indicator of how close the generated shape is to an ideal reconstruction, assuming a downsample of the given ground truth is sufficiently useful. Naturally, this metric is"}, {"title": "5 Reconstructing Archaeological Artifacts", "content": "Given the insights obtained from the experiments with Geometric Breaks, we decided to perform another experiment to see how the model would compare against related work. The field chosen for this comparison was archaeological reconstruction."}, {"title": "5.1 Dataset creation", "content": "To implement the comparison, it was necessary to create a dataset that would approximate the variability of the already proven data. To this end, we compiled data from the Native American class from the Cultural Heritage dataset [10],"}, {"title": "5.2 Data Augmentation", "content": "To create the broken and repair representations, we performed straight cuts on the point clouds at a random height from the bottom 18% to 22% of the object's height after a random rotation of less than 30\u00b0 on the X and Z axes, where the coordinates have Y in the upward direction. The breakage was repeated four times per object to augment the data, resulting in 976 complete broken repair triplets.\nThe model was trained on a 70-30 split of the created augmented dataset, similar to the original work, with all augmented data points for every object belonging to the same part of the split, meaning that the model testing was performed without seeing any variant of a test object in its training."}, {"title": "5.3 Training", "content": "The experiment was performed with the values arrived at with the classes from Geometric Breaks leading; later, the experiment was repeated with double the number of points and increased epoch count to 4000 epochs to more closely approximate the level of refinement of the PCDiff training."}, {"title": "5.4 Results and comparison against DRDAP", "content": "To compare the results we chose to train the publicly available implementation of DRDAP [21] using a compiled dataset. This choice was made because we found it valuable to compare with existing related work in the chosen application field, its public availability, and the fact that it works with point cloud data. We used the same technique to create the distance factor as we described for the tests on general shapes. The following is a comparison over our compiled dataset's repair shapes, with 1638 points each between DRDAP and our application of PCDiff, both trained from scratch."}, {"title": "6 Limitations", "content": "When comparing the distance factors calculated for PCDiff, a substantial variation depending on the dataset is evident, highlighting potential limitations of the model.\nThe principal limitation of this model is its ability to handle diverse data. This limitation has not been formalized into a quantifiable expression and remains largely intuitive, based on the researcher's experience. This means as well that any fine tuning of the model should be an expansion or reinforcement of a"}, {"title": "7 Conclusions", "content": "In this article, we address the challenge of repairing cultural heritage objects using recent generative AI algorithms that have demonstrated impressive results in other domains. We introduce the application of a conditional diffusion model capable of effectively reconstructing 3D point clouds. Our contribution is twofold. First, we experiment with a general setting to analyze the model's capabilities. Second, we evaluate the performance in the domain of cultural heritage. Our results indicate that, under certain assumptions regarding the variability of the objects, the diffusion model can successfully recreate the geometry of cultural heritage models. We believe our research can serve as a foundation for developing new and improved methods for the restoration of ancient artifacts."}]}