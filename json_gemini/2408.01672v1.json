{"title": "radarODE: An ODE-Embedded Deep Learning Model for Contactless ECG Reconstruction from Millimeter-Wave Radar", "authors": ["Yuanyuan Zhang", "Runwei Guan", "Lingxiao Li", "Rui Yang", "Yutao Yue", "Eng Gee Lim"], "abstract": "Radar-based contactless cardiac monitoring has become a popular research direction recently, but the fine-grained electrocardiogram (ECG) signal is still hard to reconstruct from millimeter-wave radar signal. The key obstacle is to decouple the cardiac activities in the electrical domain (i.e., ECG) from that in the mechanical domain (i.e., heartbeat), and most existing research only uses pure data-driven methods to map such domain transformation as a black box. Therefore, this work first proposes a signal model for domain transformation, and then a novel deep learning framework called radarODE is designed to fuse the temporal and morphological features extracted from radar signals and generate ECG. In addition, ordinary differential equations are embedded in radarODE as a decoder to provide morphological prior, helping the convergence of the model training and improving the robustness under body movements. After being validated on the dataset, the proposed radarODE achieves better performance compared with the benchmark in terms of missed detection rate, root mean square error, Pearson correlation coefficient with the improvement of 9%, 16% and 19%, respectively. The validation results imply that radarODE is capable of recovering ECG signals from radar signals with high fidelity and can be potentially implemented in real-life scenarios.", "sections": [{"title": "I. INTRODUCTION", "content": "Radar-based human sensing is a rapidly evolving field that leverages radio-frequency signals to detect or recognize human activities in many future scenarios (e.g., smart home and in-cabin monitoring [1]\u2013[3]). Compared with other contactless sensors such as cameras and acoustic sensors with privacy issues, radar could sense the ambient environment in a non-invasive manner and achieve good robustness under light conditions or temperature variations [4], [5]. In exchange, radar signals cannot be directly interpreted by humans like other mediums with explicit meanings (e.g., images, sound), increasing the complexity of designing efficient frameworks for specific sensing tasks (e.g., pose estimation [6], object detection [7] and vital sign monitoring [8]).\nWithin all scenarios suitable for radar-based human sensing, contactless vital sign monitoring is a crucial task in providing healthcare information (e.g., respiration, heart rate and electrocardiogram (ECG)). The earliest attempt for radar-based res-piration monitoring can be traced back to 1975 by measuring the chest wall displacement induced by respiration [9]. The chest wall displacement will modulate the phase component of the emitted radar signal, and the latent respiration information can be demodulated from the phase variation [10]. Similarly, cardiac activities are small-scale displacements that also cause chest wall displacements, but such small displacements are normally ruined by respiration with orders more amplitude. The follow-up researchers are dedicated to extracting cardiac information in the presence of the respiration disturbance and also other common noises, such as random body movement (RBM) [11], [12], multi-path or multi-person interference [13], [14] and radar self-movement [15], [16].\nIn the context of cardiac monitoring, most early studies focused on the recovery of coarse cardiac information, such as heart rate (HR), heart sound and heart rate variability (HRV), from the perspectives of radar front-end design or advanced algorithms design [8]. For example, some advanced types of radar (e.g., frequency modulated continuous wave (FMCW) radar) are designed to enable high range-resolution or multi-person monitoring [17], and some baseband signal-processing algorithms are embedded on the radar platform to realize in-phase/quadrature modulation or accurate phase unwrapping [18]. In addition, various advanced algorithms are applied by leveraging different intrinsic characteristics of cardiac activities to robustly reconstruct cardiac features. For example, cardiac activities normally reveal strong peri-odicity in the time domain and have dominant peaks on the spectrum, inspiring periodicity-based methods (e.g., template matching [19], [20], hidden Markov model [21], [22]) and spectrum-based methods (e.g., Fourier transform [23], [24], wavelet transform [7], [25]) as two major categories in cardiac feature extraction algorithms.\nIn recent years, the emergence of commercial radar plat-forms with high operating frequency (millimeter-wave (mm-wave) radar) encourages researchers to extract fine-grained cardiac features (e.g., ECG and seismocardiography (SCG)) from the radar signal [8]. SCG signal is measured by the accelerometer mounted on the human chest to describe the mechanical vibrations produced by heartbeats, describing the fine-grained cardiac mechanical activities such as aortic/mitral valve opening/closing and isovolumetric contraction [26]. Although these vibrations are subtle, it is still reasonable to directly map the displacements detected by radar to each fine-grained cardiac mechanical activity using high-resolution radar as proved in [17]. However, radar-based SCG recovery is not widely investigated compared with ECG, because ECG pro-vides more comprehensive information (e.g., atrial/ventricular depolarization [27]) for clinical diagnosis.\nTo reconstruct ECG from radar signal, the most straight-forward approach is to directly sense the scattered electro-magnetic field variation through frequency shift of mm-wave response, and the ECG signal can then be decoupled from the scattered electromagnetic field based on the dynamic model in the form of partial differential equations deduced from cardiac electrophysiology (i.e., ionic concentration in cardiac cells) [28], [29]. However, the solutions of the entire model are extremely hard to obtain either numerically or analytically, and the constructed models will be changed with respect to different environments and noises due to the Green's function [30], causing difficulty in adapting the model in various real-life scenarios.\nThe second approach, which is also the most adopted approach, only uses radar to sense the cardiac mechanical activities through the phase-modulated mm-wave response as been investigated in coarse cardiac monitoring, but then the researchers must deal with domain decoupling to transform the measured signal from the mechanical domain to the electrical domain to generate the final ECG measurement. Intuitively, it is reasonable to say that mechanical conduction and electrical conduction are highly correlated in describing cardiac activities because the electrical changes in cells trigger the heart muscle contraction, whereas such a relationship is called excitation-contraction coupling in electrophysiology and is extremely hard to interpret or model by the people without biological knowledge [31], [32].\nIn literature, the existing studies all leverage deep learning methods to extract the latent information from enormous train-ing data and try to learn the domain transformation relying on the extraordinary non-linear mapping ability of the deep neural network [33]\u2013[36]. Although these studies could successfully reconstruct the ECG signal from radar, three drawbacks still need to be improved:\n\u2022 There is no existing signal model with an easily under-stood form that can be integrated into domain transfor-mation for radar-based ECG reconstruction.\n\u2022 The pure data-driven method could learn the domain transformation as a black box, but the researchers can hardly intervene in the learning process to enhance the characteristic peaks for ECG or provide prior knowledge to help with network training.\n\u2022 The well-trained deep learning model is not robust to abrupt noises such as body movement [35], [37], because these noises normally have orders of magnitude larger than cardiac-related vibrations, drowning the subtle fea-tures and ruining the forward propagation of the deep neural network [38].\nInspired by the above discussions, this paper aims to de-sign a framework for radar-based ECG reconstruction with ordinary differential equations (ODEs) embedded to provide prior knowledge on domain transformation. The contributions of this research can be concluded as:\n\u2022 This study innovatively models the radar signal in terms of fine-grained cardiac features, enabling further transfor-mation between cardiac mechanical and electrical activ-ities, instead of using pure data-driven approaches as in the literature.\n\u2022 Based on the proposed signal model, an ODE-embedded module called single cycle ECG generator (SCEG) is designed to parameterize the radar signal into sparse representations with morphological meanings, enhancing the characteristic peaks of the recovered ECG signal and also accelerating the convergence of the model training process.\n\u2022 By fusing the extracted morphological and temporal features, the proposed radarODE framework is proven to be robust in the presence of body movement noise and could realize accurate reconstruction of the ECG signal from the millimeter wave radar signal.\nThe rest of the paper is organized as follows. Section II introduces the background knowledge required for radar-based ECG reconstruction. Section III explains the proposed model for radar signal and the structure of radarODE framework. Section IV first introduces the public dataset used for valida-tion in this research and then presents the results obtained with corresponding comparisons and evaluations. Finally, Section V concludes this paper."}, {"title": "II. BACKGROUND", "content": "To understand the model and framework proposed later in this paper, this section will first provide the necessary background about the signal model for radar-based coarse cardiac monitoring and then briefly introduce the relationship between the cardiac electrical and mechanical activities."}, {"title": "A. Radar-Based Coarse Cardiac Monitoring", "content": "The vanilla signal model for radar-based cardiac monitoring (e.g., heart rate monitoring) using continuous wave (CW) radar starts from the transmitted signal expressed as\n$s_t(t) = A_t \\cos(2\\pi f t + \\theta(t))$\n(1)\nwhere $A_t$ and $f$ are the amplitude and carrier frequency of the transmitted signal, and $\\theta(t)$ is the phase noise from the signal generator with respect to time $t$ [39]. In the ideal case, the"}, {"title": "B. Radar-Based Fine-Grained Cardiac Monitoring", "content": "The coarse cardiac monitoring only aims to detect a sin-gle heartbeat within one cardiac cycle, and different cardiac features (e.g., HR, BBI and HRV) can then be calculated through the time indexes of a series of heartbeats. In contrast, fine-grained cardiac monitoring requires recovering as many cardiac activities as possible within one cardiac cycle. For example, Figure 1 shows the typical ECG and SCG signal waveform, representing the cardiac electrical and mechanical activities, respectively. ECG waveform comprises P-wave, QRS-complex and P-wave, corresponding to atrial depolariza-tion, ventricular depolarization and ventricular repolarization, respectively. These electrical changes trigger the heart muscle contraction, causing the aortic valve opening/closure (AO/AC) and mitral valve opening/closure (MO/MC) [31], [32], as shown in the SCG plot in Figure 1. In addition, The rela-tionship between cardiac electrical and mechanical activities is called excitation-contraction coupling in electrophysiology and can be modeled mathematically according to the intracel-lular calcium concentration, because calcium transient is the link between the action potential and muscle contraction [31], [32].\nIn the context of ECG reconstruction, two types of ap-proaches in literature have been generalized in the Introduction section. The first approach is not considered in this paper because it involves complex modeling of electrophysiology from biology and chemistry [28]. This research only focuses on the second approach by reconstructing the ECG from the mechanical activities measured by radar. Although the underlying principle of the second approach is exactly the same as derived in (9), the radar signal should have a higher signal-to-noise ratio (SNR) and resolution than that used for coarse monitoring. For example, the mechanical activities can be simplified as the first vibration related to AO and the second vibration related to AC [17], corresponding to the QRS-complex and T-wave in the ECG signal. Therefore, the radar signal with high SNR and resolution should be able to reveal these two vibrations $v_1$ and $v_2$ as shown in the radar signal in Figure 1. In this case, only one public dataset [35] collected by 77 GHz FMCW radar satisfies the requirement"}, {"title": "III. METHODOLOGY", "content": "In order to address the drawbacks in radar-based ECG recovery as mentioned in the Introduction, this section will first introduce the proposed signal model that considers the nature of the fine-grained cardiac mechanical activities, ensuring a reasonable transformation towards cardiac electrical activities (ECG) instead of using pure data-driven methods as a black box. Afterwards, the proposed radarODE framework will be elaborated to fulfill the transformation from radar to ECG signal with 50 synchronous radar signals [35] as inputs, rep-resenting the measurements from 50 spatial points within the chest region as shown in Figure 2. The radarODE is composed of three modules to output the final ECG reconstructions as:\n\u2022 The first module estimates the peak-to-peak interval (PPI) for consecutive heartbeats from the energy plot of the input radar signals based on the proposed peak detection algorithm, as shown in Figure 2(a).\n\u2022 The second module first transforms the time-domain radar signal into spectrograms using synchrosqueezed wavelet transform (SST) to reveal the latent information in the frequency domain. Then, the morphological features (i.e., amplitudes and positions of PQRST peaks) for the single cycle ECG signal can be extracted from SST plots using the proposed SCEG, as shown in Figure 2(b).\n\u2022 The third module is used to fuse the extracted morpho-logical features with the temporal features hidden in the original radar signal to generate the final ECG recovery, as shown in Figure 2(c)."}, {"title": "B. Model for Radar Signal and Pre-Processing", "content": "According to the discussion in the last section, the chest displacement $x(t)$ can be further decomposed as\n$x(t) = x_c(t) + x_r(t) + x_n(t)$\nwhere $x_c(t)$ means cardiac mechanical activities, $x_r(t)$ is res-piration induced displacement and $x_n(t)$ is noise term. After the pre-processing, the respiration term has been filtered out, and the actual radar signal $\\tilde{x}(t)$ provided in the dataset [35] can be expressed as\n$\\tilde{x}(t) = x_c(t) + x_n(t)$\nFurthermore, the pre-processed radar signal $\\tilde{x}(t)$ has two prominent vibrations $v_1$ and $v_2$ as shown in Figure 1, cor-responding to the fine-grained cardiac mechanical activities shown in SCG. According to the previous work on SCG mod-eling, the heart muscle contraction has a pulsatile nature [23], and the bones/tissues in chest area introduce the extra damping into the pulse [43]. Inspired by the natural characteristics, the radar signal with two prominent vibrations measured in a single cardiac cycle is innovatively modeled as the Gaussian pulses with certain central frequencies as\n$\\tilde{x}(t) = v_1(t) + v_2(t) + x_n(t)$\nwith\n$v_1 = a_1\\cos(2\\pi f_1t) \\exp{(-\\frac{(t-T_1)^2}{b_1^2})}$\n$v_2 = a_2\\cos(2\\pi f_2t) \\exp{(-\\frac{(t-T_2)^2}{b_2^2})}$\nwhere $a_1, b_1$ and $a_2, b_2$ jointly contribute to the amplitudes and length of the first and second prominent vibrations, $f_1, f_2$ are the corresponding central frequencies, $T_1, T_2$ determine when the vibrations happen, and $x_n(t)$ represents all the noises.\nThe aim of proposing the model in (12) is not to perform the curve fitting since the goal of this paper is ECG reconstruction but not SCG. In fact, the time indices of the vibrations ($T_1$ and $T_2$) are critical and need to be identified to help reconstruct QRS-complex and T-wave in ECG signals. In addition, to verify the fidelity of the proposed model in (12), a piece of high SNR radar signal $\\tilde{x}(t)$ with the corresponding synthesis is shown in Figure 3. Empirically, the central frequencies of"}, {"title": "2) Signal Pre-Processing with Synchrosqueezed Wavelet Transform (SST):", "content": "Based on the proposed radar signal model in (12), the next step is to localize when the vibrations happen (i.e., $T_1$, $T_2$). Figure 1 shows that the high SNR radar signal could reveal prominent peaks of $v_1$ and $v_2$ in the time domain, but in most cases, these two peaks (especially $v_2$) could be ruined by the noise. Therefore, this research decides to extract the time-frequency domain information from the spectrogram obtained by synchrosqueezed wavelet transform (SST) [44], and the two vibrations can then be localized by the SCEG module proposed later in Section III-C2.\nSST evolves from continuous wavelet transform (CWT) but with concentrated energy distribution along the frequency axis, providing a sparser time-frequency representation with enhanced prominent vibrations compared with other tools such as short-time Fourier transform (STFT) and CWT.\nThe first step of SST is to calculate the CWT of radar signal $\\tilde{x}(t)$ as\n$W_s(a, b) = \\int x(t)\\psi^* (\\frac{t-b}{a}) \\frac{dt}{a}$\nwhere $*$ is the complex conjugate of the chosen mother wavelet, and a, b are the adjustable scaling and translation factors for the wavelet $\\psi$ to extract frequency- and time-domain information, respectively. In this research, the Morlet wavelet is selected as mother wavelet because it is widely used for vibration signal processing, especially for time-frequency localization [45], [46].\nThe second step is to calculate the candidate instantaneous frequency for $W_s(a, b) \\neq 0$ as\n$f_i(a, b) = -\\frac{1}{2\\pi i} (W_s(a, b))^{-1} \\frac{\\partial W_s(a, b)}{\\partial b}$\nThe final step is to concentrate the energy along the candi-date instantaneous frequency as\n$T_a(2\\pi f, b) = \\int_{A(b)} W_s(a, b)a^{-3/2} \\delta(2\\pi f_i(a, b) - 2\\pi f) df$\nwhere $A(b) = \\{a; W_s(a, b) \\neq 0\\}$, and $\\delta$ represents the Dirac-delta function in a distribution version to smoothly squeeze the spread-out energy into a narrow band around the instantaneous frequency [44]."}, {"title": "C. radarODE Framework Design", "content": "The first module of radarODE aims to estimate the length of each single cycle ECG piece by calculating the interval between two consecutive heartbeats (i.e., PPI), and these heartbeats will bring intensive energy into the received radar signal [21]. Therefore, the energy plots $\\hat{x}(t)$ of the radar signal $x(t)$ can be obtained by simply adding the SST spectrogram along the frequency axis and are used for peak detection as shown in Figure 5a. In addition, it is found in practice that the algorithms designed for ECG R-peaks detection are also applicable for the peaks detection from the radar energy plot $\\hat{x}$ (omit (t) for simplic-ity) [47], because apparently the energy plot shares a similar upsurge with the ECG signal. However, the 50 synchronous radar signals provided in the dataset (\\{x_1,...,250\\}) do not"}, {"title": "Algorithm 1 PPI Estimation", "content": "Input: Radar Energy Plots \u03a7\u00a3 = {X1,X2,..., 250},\nSegments Length Iseg and Step Length 1step\nOutput: Estimated PPI\nINITIALIZATION:\n- Let Xs = {X},X2, ...,XZ} be an ordered list\nof the segment lists sliced from XL with length\nlseg and step lstep, where J = l-lseg.\nIstep\nLet PPI \u2190 0.\nMAIN ITERATION:\nfor each segment list X \u2208 Xs do\n- Let PPIc \u2190 \u00d8 to save the candidate PPI obtained\nfrom each segment.\nfor each segment \u2208 X do\n1) Apply biopeaks [47] on 2 to get all the detected\npeaks P as in (17).\n2) Get PPI for the current radar signal segment using\ndifferentiation as PPIc \u2190 di f f (P).\n3) Update PPIc \u2190 PPI\u0106 U PPIC.\nend for\nCalculate the probability density function f(p) for\nPPIC using KDE as in (18).\nDetermine the final PPI for the current segment\nlist and update the set as PPI \u2190 PPI U\narg maxp f (p).\nend for\ncorresponding to a single cardiac cycle, and the aim of the SCEG module is to reconstruct the ECG for each single car-diac cycle, hence realizing the transformation from mechanical to electrical domain. In general, the input of the SCEG is N segments of the SST plot within [1,25] Hz with the size of F \u00d7 T in frequency and time axis, and the output is the corresponding N pieces of ECG with the same length T, as shown in Figure 6. In practice, the deep neural network only accepts the inputs/outputs with the same size. Therefore, the actual SST segment is centered at the current cardiac cycle and expands to 4 seconds, and the corresponding ECG ground truth is resampled to a fixed length of 200 for loss calculation.\nFor the architecture design, the SCEG module adopts the popular backbone, encoder, and decoder structure as verified by enormous image-related tasks [50]\u2013[52], with detailed parameters shown in Table I. In addition, a feature fusion block is added after the decoder to fuse the temporal and morphological features and generate the final ECG reconstruc-"}, {"title": "1) Fine-Grained Model for Radar Signal:", "content": "According to the discussion in the last section, the chest displacement $x(t)$ can be further decomposed as\n$x(t) = x_c(t) + x_r(t) + x_n(t)$(10)\nwhere $x_c(t)$ means cardiac mechanical activities, $x_r(t)$ is respiration induced displacement and $x_n(t)$ is noise term. After the pre-processing, the respiration term has been filtered out, and the actual radar signal $\\tilde{x}(t)$ provided in the dataset [35] can be expressed as\n$\\tilde{x}(t) = x_c(t) + x_n(t)$(11)\nFurthermore, the pre-processed radar signal $\\tilde{x}(t)$ has two prominent vibrations $v_1$ and $v_2$ as shown in Figure 1, cor-responding to the fine-grained cardiac mechanical activities shown in SCG. According to the previous work on SCG mod-eling, the heart muscle contraction has a pulsatile nature [23], and the bones/tissues in chest area introduce the extra damping into the pulse [43]. Inspired by the natural characteristics, the radar signal with two prominent vibrations measured in a single cardiac cycle is innovatively modeled as the Gaussian pulses with certain central frequencies as\n$\\tilde{x}(t) = v_1(t) + v_2(t) + x_n(t)$(12)\nwith\n$v_1 = a_1\\cos(2\\pi f_1t) \\exp{(-\\frac{(t-T_1)^2}{b_1^2})}$(13)\n$v_2 = a_2\\cos(2\\pi f_2t) \\exp{(-\\frac{(t-T_2)^2}{b_2^2})}$\nwhere $a_1, b_1$ and $a_2, b_2$ jointly contribute to the amplitudes and length of the first and second prominent vibrations, $f_1, f_2$ are the corresponding central frequencies, $T_1, T_2$ determine when the vibrations happen, and $x_n(t)$ represents all the noises.\nThe aim of proposing the model in (12) is not to perform the curve fitting since the goal of this paper is ECG reconstruction but not SCG. In fact, the time indices of the vibrations ($T_1$ and $T_2$) are critical and need to be identified to help reconstruct QRS-complex and T-wave in ECG signals. In addition, to verify the fidelity of the proposed model in (12), a piece of high SNR radar signal $\\tilde{x}(t)$ with the corresponding synthesis"}, {"title": "2) Single Cycle ECG Generator (SCEG):", "content": "Based on the yielded PPI, the SST spectrogram can be sliced into segments corresponding to a single cardiac cycle, and the aim of the SCEG module is to reconstruct the ECG for each single car-diac cycle, hence realizing the transformation from mechanical to electrical domain. In general, the input of the SCEG is N segments of the SST plot within [1,25] Hz with the size of F \u00d7 T in frequency and time axis, and the output is the corresponding N pieces of ECG with the same length T, as shown in Figure 6. In practice, the deep neural network only accepts the inputs/outputs with the same size. Therefore, the actual SST segment is centered at the current cardiac cycle and expands to 4 seconds, and the corresponding ECG ground truth is resampled to a fixed length of 200 for loss calculation.\nFor the architecture design, the SCEG module adopts the popular backbone, encoder, and decoder structure as verified by enormous image-related tasks [50]\u2013[52], with detailed parameters shown in Table I. In addition, a feature fusion"}, {"title": "eature Fusion:", "content": "The feature fusion module could leverage respective advantages of the morphological and temporal features and generate the final ECG signal for loss calcu-lation, because the morphological feature only focuses on five peaks to provide a rough shape of ECG with calibrated peaks, and the temporal feature reserves all the other feature neglected in (19) to help the final reconstruction [59]. Therefore, two features are first fused together by multi-plication into one and then stacked four times by itself. Then, the stacked feature is encoded and decoded as in Table I to yield the final single cycle ECG piece.\nThe last step of SCEG is to resample all the ECG pieces generated after the feature fusion part with respect to the previous PPI estimation, and the resampled ECG pieces are concatenated in time sequence to form the final morphological reference for long-term ECG reconstruction."}, {"title": "3) Long-Term ECG Reconstruction:", "content": "The long-term ECG reconstruction network adopts a simpler encoder-decoder-fusion structure than SCEG as shown in Figure 2, because the morphological reference reduces the burden of learning the ECG peaks and patterns. In addition, the input changes to arbitrary segments of 50 synchronous time-domain radar signal instead of the SST segments within a single cardiac cycle. Therefore, the encoder for raw radar signal has the same structure as the backbone in SCEG, only with the deformable 2D convolution replaced by 1D convolution with K = 5, S = 2. Then, the decoder is performed by four Transconv1d blocks with the same K and S as an encoder to generate the temporal feature, and the feature fusion module also shares the same strategy as SCEG. Lastly, 9 stacks of the temporal convolutional network (TCN) with dilation fact of 2 are added as suggested in [35] to recursively generate the ECG based on the historical reconstructions."}, {"title": "IV. EXPERIMENTAL AND RESULT EVALUATION", "content": "The dataset provided in [35] is collected by TI AWR-1843 radar with 77 GHz start frequency and 3.8 GHz bandwidth, providing good SNR and resolution to detect subtle vibrations that fit the proposed signal model and framework. Half of the actual dataset is released with 91 trials for 11 subjects,"}, {"title": "Morphological Accuracy for radarODE and MMECG:", "content": ""}]}