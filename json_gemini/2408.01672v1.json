{"title": "radarODE: An ODE-Embedded Deep Learning Model for Contactless ECG Reconstruction from Millimeter-Wave Radar", "authors": ["Yuanyuan Zhang", "Runwei Guan", "Lingxiao Li", "Rui Yang", "Yutao Yue", "Eng Gee Lim"], "abstract": "Radar-based contactless cardiac monitoring has become a popular research direction recently, but the fine-grained electrocardiogram (ECG) signal is still hard to reconstruct from millimeter-wave radar signal. The key obstacle is to decouple the cardiac activities in the electrical domain (i.e., ECG) from that in the mechanical domain (i.e., heartbeat), and most existing research only uses pure data-driven methods to map such domain transformation as a black box. Therefore, this work first proposes a signal model for domain transformation, and then a novel deep learning framework called radarODE is designed to fuse the temporal and morphological features extracted from radar signals and generate ECG. In addition, ordinary differential equations are embedded in radarODE as a decoder to provide morphological prior, helping the convergence of the model training and improving the robustness under body movements. After being validated on the dataset, the proposed radarODE achieves better performance compared with the benchmark in terms of missed detection rate, root mean square error, Pearson correlation coefficient with the improvement of 9%, 16% and 19%, respectively. The validation results imply that radarODE is capable of recovering ECG signals from radar signals with high fidelity and can be potentially implemented in real-life scenarios.", "sections": [{"title": "I. INTRODUCTION", "content": "Radar-based human sensing is a rapidly evolving field that leverages radio-frequency signals to detect or recognize human activities in many future scenarios (e.g., smart home and in-cabin monitoring [1]\u2013[3]). Compared with other contactless sensors such as cameras and acoustic sensors with privacy issues, radar could sense the ambient environment in a non-invasive manner and achieve good robustness under light conditions or temperature variations [4], [5]. In exchange, radar signals cannot be directly interpreted by humans like other mediums with explicit meanings (e.g., images, sound), increasing the complexity of designing efficient frameworks for specific sensing tasks (e.g., pose estimation [6], object detection [7] and vital sign monitoring [8]).\nWithin all scenarios suitable for radar-based human sensing, contactless vital sign monitoring is a crucial task in providing healthcare information (e.g., respiration, heart rate and electrocardiogram (ECG)). The earliest attempt for radar-based respiration monitoring can be traced back to 1975 by measuring the chest wall displacement induced by respiration [9]. The chest wall displacement will modulate the phase component of the emitted radar signal, and the latent respiration information can be demodulated from the phase variation [10]. Similarly, cardiac activities are small-scale displacements that also cause chest wall displacements, but such small displacements are normally ruined by respiration with orders more amplitude. The follow-up researchers are dedicated to extracting cardiac information in the presence of the respiration disturbance and also other common noises, such as random body movement (RBM) [11], [12], multi-path or multi-person interference [13], [14] and radar self-movement [15], [16].\nIn the context of cardiac monitoring, most early studies focused on the recovery of coarse cardiac information, such as heart rate (HR), heart sound and heart rate variability (HRV), from the perspectives of radar front-end design or advanced algorithms design [8]. For example, some advanced types of radar (e.g., frequency modulated continuous wave (FMCW) radar) are designed to enable high range-resolution or multi-person monitoring [17], and some baseband signal-processing algorithms are embedded on the radar platform to realize in-phase/quadrature modulation or accurate phase unwrapping [18]. In addition, various advanced algorithms are applied by leveraging different intrinsic characteristics of cardiac activities to robustly reconstruct cardiac features. For example, cardiac activities normally reveal strong periodicity in the time domain and have dominant peaks on the spectrum, inspiring periodicity-based methods (e.g., template matching [19], [20], hidden Markov model [21], [22]) and spectrum-based methods (e.g., Fourier transform [23], [24], wavelet transform [7], [25]) as two major categories in cardiac feature extraction algorithms.\nIn recent years, the emergence of commercial radar plat-forms with high operating frequency (millimeter-wave (mm-wave) radar) encourages researchers to extract fine-grained cardiac features (e.g., ECG and seismocardiography (SCG)) from the radar signal [8]. SCG signal is measured by the accelerometer mounted on the human chest to describe the mechanical vibrations produced by heartbeats, describing the fine-grained cardiac mechanical activities such as aortic/mitral valve opening/closing and isovolumetric contraction [26]. Although these vibrations are subtle, it is still reasonable to directly map the displacements detected by radar to each fine-grained cardiac mechanical activity using high-resolution radar as proved in [17]. However, radar-based SCG recovery is not widely investigated compared with ECG, because ECG provides more comprehensive information (e.g., atrial/ventricular depolarization [27]) for clinical diagnosis.\nTo reconstruct ECG from radar signal, the most straight-forward approach is to directly sense the scattered electro-magnetic field variation through frequency shift of mm-wave response, and the ECG signal can then be decoupled from the scattered electromagnetic field based on the dynamic model in the form of partial differential equations deduced from cardiac electrophysiology (i.e., ionic concentration in cardiac cells) [28], [29]. However, the solutions of the entire model are extremely hard to obtain either numerically or analytically, and the constructed models will be changed with respect to different environments and noises due to the Green's function [30], causing difficulty in adapting the model in various real-life scenarios.\nThe second approach, which is also the most adopted approach, only uses radar to sense the cardiac mechanical activities through the phase-modulated mm-wave response as been investigated in coarse cardiac monitoring, but then the researchers must deal with domain decoupling to transform the measured signal from the mechanical domain to the electrical domain to generate the final ECG measurement. Intuitively, it is reasonable to say that mechanical conduction and electrical conduction are highly correlated in describing cardiac activities because the electrical changes in cells trigger the heart muscle contraction, whereas such a relationship is called excitation-contraction coupling in electrophysiology and is extremely hard to interpret or model by the people without biological knowledge [31], [32].\nIn literature, the existing studies all leverage deep learning methods to extract the latent information from enormous training data and try to learn the domain transformation relying on the extraordinary non-linear mapping ability of the deep neural network [33]\u2013[36]. Although these studies could successfully reconstruct the ECG signal from radar, three drawbacks still need to be improved:\n\u2022 There is no existing signal model with an easily understood form that can be integrated into domain transformation for radar-based ECG reconstruction.\n\u2022 The pure data-driven method could learn the domain transformation as a black box, but the researchers can hardly intervene in the learning process to enhance the characteristic peaks for ECG or provide prior knowledge to help with network training.\n\u2022 The well-trained deep learning model is not robust to abrupt noises such as body movement [35], [37], because these noises normally have orders of magnitude larger than cardiac-related vibrations, drowning the subtle features and ruining the forward propagation of the deep neural network [38].\nInspired by the above discussions, this paper aims to design a framework for radar-based ECG reconstruction with ordinary differential equations (ODEs) embedded to provide prior knowledge on domain transformation. The contributions of this research can be concluded as:\n\u2022 This study innovatively models the radar signal in terms of fine-grained cardiac features, enabling further transformation between cardiac mechanical and electrical activities, instead of using pure data-driven approaches as in the literature.\n\u2022 Based on the proposed signal model, an ODE-embedded module called single cycle ECG generator (SCEG) is designed to parameterize the radar signal into sparse representations with morphological meanings, enhancing the characteristic peaks of the recovered ECG signal and also accelerating the convergence of the model training process.\n\u2022 By fusing the extracted morphological and temporal features, the proposed radarODE framework is proven to be robust in the presence of body movement noise and could realize accurate reconstruction of the ECG signal from the millimeter wave radar signal.\nThe rest of the paper is organized as follows. Section II introduces the background knowledge required for radar-based ECG reconstruction. Section III explains the proposed model for radar signal and the structure of radarODE framework. Section IV first introduces the public dataset used for validation in this research and then presents the results obtained with corresponding comparisons and evaluations. Finally, Section V concludes this paper."}, {"title": "II. BACKGROUND", "content": "To understand the model and framework proposed later in this paper, this section will first provide the necessary background about the signal model for radar-based coarse cardiac monitoring and then briefly introduce the relationship between the cardiac electrical and mechanical activities."}, {"title": "A. Radar-Based Coarse Cardiac Monitoring", "content": "The vanilla signal model for radar-based cardiac monitoring (e.g., heart rate monitoring) using continuous wave (CW) radar starts from the transmitted signal expressed as\n$$s_t(t) = A_t\\cos(2\\pi f t + 0(t))$$\nwhere $A_t$ and $f$ are the amplitude and carrier frequency of the transmitted signal, and $0(t)$ is the phase noise from the signal generator with respect to time $t$ [39]. In the ideal case, the radar signal is only reflected by a human at a fixed distance $d_o$ with a varying chest displacement as $x(t)$, and the received signal after propagation time $T_p(t)$ can be derived as\n$$s_r(t) = A_r \\cdot \\cos(2\\pi f (t - T_p(t)) + 0(t - T_p(t)))$$\nwith\n$$T_p(t) = \\frac{2d(t)}{c}$$\n$$d(t) = d_o + x(t)$$\nwhere $A_r$ is the amplitude of the received signal, $c$ is the light speed and $2d(t)$ represents the round trip distance of the signal between the transmitter and receiver. Then, the received signal can be expanded as\n$$s_r(t) = A_r \\cos(2\\pi f t - \\frac{4\\pi d_o}{\\lambda} - \\frac{4\\pi x(t)}{\\lambda} + 0(t - \\frac{2d_o}{c} - \\frac{2x(t)}{c}))$$\nwhere $\\lambda$ is the wavelength that equals to $\\frac{c}{f}$. According to [39], [40], it is safe to eliminate the changes in amplitude and phase noise term because the chest displacement is much less than the fixed distance (i.e., $x(t) \\ll d_o$). Therefore, the approximate received signal is\n$$s_r(t) \\approx \\cos(2\\pi f t - \\frac{4\\pi d_o}{\\lambda} - \\frac{4\\pi x(t)}{\\lambda} + 0(t - \\frac{2d_o}{c}))$$\nThe received signal $s(t)$ will then pass a local oscillator with a low-pass filter to remove the frequency term, and the resultant baseband signal is\n$$s_b(t) = \\cos(\\theta_a + \\frac{4\\pi x(t)}{\\lambda} + \\Delta\\theta(t))$$\nwith\n$$\\theta_a = \\frac{4\\pi d_o}{\\lambda} + \\theta_o$$\n$$\\Delta\\theta(t) = 0(t) - 0(t - \\frac{2d_o}{c})$$\nwhere $\\theta_a$, $\\theta_o$ and $\\Delta\\theta(t)$ are phase shifts affected by different factors such as $d_o$, signal mixer and antenna, and can be set as constant in this paper [40]. Then, the phase signal unwrapped from the baseband signal is obtained as\n$$\\phi(t) = \\theta_a + \\frac{4\\pi x(t)}{\\lambda} + \\Delta0(t)$$\nFinally, the vanilla signal model derived above shows that the chest displacement $x(t)$ is involved in the phase variation of the baseband signal as\n$$\\Delta\\phi(t) = \\frac{4\\pi x(t)}{\\lambda}$$\nThe follow-up researchers have proposed various techniques to improve the accuracy of the unwrapped phase signal variation in (9). For example, the in-phase/quadrature modulation is proposed to solve the null point issue [39]; the differentiate and cross-multiply algorithm is designed to avoid discontinuity in the unwrapped phase signal [41]. In addition, chest displacement $x(t)$ is a mixture of cardiac activities, respiration and noises (e.g., RBM [11], [12], multi-path or multi-person interference [13], [14], [42]). Therefore, enormous advanced algorithms are proposed to decompose the cardiac information from $x(t)$, as have been reviewed in [8]."}, {"title": "B. Radar-Based Fine-Grained Cardiac Monitoring", "content": "The coarse cardiac monitoring only aims to detect a single heartbeat within one cardiac cycle, and different cardiac features (e.g., HR, BBI and HRV) can then be calculated through the time indexes of a series of heartbeats. In contrast, fine-grained cardiac monitoring requires recovering as many cardiac activities as possible within one cardiac cycle. For example, Figure 1 shows the typical ECG and SCG signal waveform, representing the cardiac electrical and mechanical activities, respectively. ECG waveform comprises P-wave, QRS-complex and P-wave, corresponding to atrial depolarization, ventricular depolarization and ventricular repolarization, respectively. These electrical changes trigger the heart muscle contraction, causing the aortic valve opening/closure (AO/AC) and mitral valve opening/closure (MO/MC) [31], [32]. In addition, The relationship between cardiac electrical and mechanical activities is called excitation-contraction coupling in electrophysiology and can be modeled mathematically according to the intracellular calcium concentration, because calcium transient is the link between the action potential and muscle contraction [31], [32].\nIn the context of ECG reconstruction, two types of approaches in literature have been generalized in the Introduction section. The first approach is not considered in this paper because it involves complex modeling of electrophysiology from biology and chemistry [28]. This research only focuses on the second approach by reconstructing the ECG from the mechanical activities measured by radar. Although the underlying principle of the second approach is exactly the same as derived in (9), the radar signal should have a higher signal-to-noise ratio (SNR) and resolution than that used for coarse monitoring. For example, the mechanical activities can be simplified as the first vibration related to AO and the second vibration related to AC [17], corresponding to the QRS-complex and T-wave in the ECG signal. Therefore, the radar signal with high SNR and resolution should be able to reveal these two vibrations $v_1$ and $v_2$ as shown in the radar signal in Figure 1. In this case, only one public dataset [35] collected by 77 GHz FMCW radar satisfies the requirement and complies with our proposed model in the next section."}, {"title": "III. METHODOLOGY", "content": "In order to address the drawbacks in radar-based ECG recovery as mentioned in the Introduction, this section will first introduce the proposed signal model that considers the nature of the fine-grained cardiac mechanical activities, ensuring a reasonable transformation towards cardiac electrical activities (ECG) instead of using pure data-driven methods as a black box. Afterwards, the proposed radarODE framework will be elaborated to fulfill the transformation from radar to ECG signal with 50 synchronous radar signals [35] as inputs, representing the measurements from 50 spatial points within the chest region as shown in Figure 2. The radarODE is composed of three modules to output the final ECG reconstructions as:\n\u2022 The first module estimates the peak-to-peak interval (PPI) for consecutive heartbeats from the energy plot of the input radar signals based on the proposed peak detection algorithm, as shown in Figure 2(a).\n\u2022 The second module first transforms the time-domain radar signal into spectrograms using synchrosqueezed wavelet transform (SST) to reveal the latent information in the frequency domain. Then, the morphological features (i.e., amplitudes and positions of PQRST peaks) for the single cycle ECG signal can be extracted from SST plots using the proposed SCEG, as shown in Figure 2(b).\n\u2022 The third module is used to fuse the extracted morphological features with the temporal features hidden in the original radar signal to generate the final ECG recovery, as shown in Figure 2(c)."}, {"title": "B. Model for Radar Signal and Pre-Processing", "content": "1) Fine-Grained Model for Radar Signal: According to the discussion in the last section, the chest displacement $x(t)$ can be further decomposed as\n$$x(t) = x_c(t) + x_r(t) + x_n(t)$$\nwhere $x_c(t)$ means cardiac mechanical activities, $x_r(t)$ is respiration induced displacement and $x_n(t)$ is noise term. After the pre-processing, the respiration term has been filtered out, and the actual radar signal $\\tilde{x}(t)$ provided in the dataset [35] can be expressed as\n$$\\tilde{x}(t) = x_c(t) + x_n(t)$$\nFurthermore, the pre-processed radar signal $\\tilde{x}(t)$ has two prominent vibrations $v_1$ and $v_2$ as shown in Figure 1, corresponding to the fine-grained cardiac mechanical activities shown in SCG. According to the previous work on SCG modeling, the heart muscle contraction has a pulsatile nature [23], and the bones/tissues in chest area introduce the extra damping into the pulse [43]. Inspired by the natural characteristics, the radar signal with two prominent vibrations measured in a single cardiac cycle is innovatively modeled as the Gaussian pulses with certain central frequencies as\n$$\\tilde{x}(t) = v_1(t) + v_2(t) + x_n(t)$$\nwith\n$$v_1 = a_1\\cos(2\\pi f_1 t) \\exp(-\\frac{(t-T_1)^2}{b_1^2})$$\n$$v_2 = a_2\\cos(2\\pi f_2 t) \\exp(-\\frac{(t-T_2)^2}{b_1^2})$$\nwhere $a_1$, $b_1$ and $a_2$, $b_2$ jointly contribute to the amplitudes and length of the first and second prominent vibrations, $f_1$, $f_2$ are the corresponding central frequencies, $T_1$, $T_2$ determine when the vibrations happen, and $x_n(t)$ represents all the noises.\nThe aim of proposing the model in (12) is not to perform the curve fitting since the goal of this paper is ECG reconstruction but not SCG. In fact, the time indices of the vibrations ($T_1$ and $T_2$) are critical and need to be identified to help reconstruct QRS-complex and T-wave in ECG signals. In addition, to verify the fidelity of the proposed model in (12), a piece of high SNR radar signal $\\tilde{x}(t)$ with the corresponding synthesis is shown in Figure 3. Empirically, the central frequencies of $v_1$ and $v_2$ are laid in the range of [1, 15] Hz and [20, 25] Hz respectively, and all the unknown parameters can be obtained by solving the linear regression problem with respect to the band-passed radar signal. For example, Figure 3(a) shows the radar signal $x(t)$ filtered by the bandpass filter (BPF) with range [1,15] Hz, and the corresponding synthesis $v_1$ is obtained as $a_1 = 0.22$, $b_1 = 0.05$, $f_1 = 10$ and $T_1 = -0.69$. Similarly, the synthesis of the radar signal after BPF ([20,25] Hz) is shown in Figure 3(b) with $a_2 = 0.12$, $b_2 = 0.03$, $f_2 = 23$ and $T_2 = -0.33$. The overall result $v_1 + v_2$ shows that the synthesis based on the proposed model fits the original radar signal well, and the time indices of two vibrations can be found accurately.\nRemark 1. Although the signal model proposed in this section is only used for the alignment between the cardiac mechanical and electrical features, this model actually describes the fundamental cardiac activities within a single cardiac cycle in a more realistic manner than only considering the single-tone heartbeat. Therefore, the proposed model is potentially universal to many other cardiac-related tasks as a template, such as heart rate monitoring, cardiac events segmentation and synthesis radar measurement generation/augmentation.\n2) Signal Pre-Processing with Synchrosqueezed Wavelet Transform (SST): Based on the proposed radar signal model in (12), the next step is to localize when the vibrations happen (i.e., $T_1$, $T_2$). Figure 1 shows that the high SNR radar signal could reveal prominent peaks of $v_1$ and $v_2$ in the time domain, but in most cases, these two peaks (especially $v_2$) could be ruined by the noise. Therefore, this research decides to extract the time-frequency domain information from the spectrogram obtained by synchrosqueezed wavelet transform (SST) [44], and the two vibrations can then be localized by the SCEG module proposed later in Section III-C2.\nSST evolves from continuous wavelet transform (CWT) but with concentrated energy distribution along the frequency axis, providing a sparser time-frequency representation with enhanced prominent vibrations compared with other tools such as short-time Fourier transform (STFT) and CWT.\nThe first step of SST is to calculate the CWT of radar signal $\\tilde{x}(t)$ as\n$$W(a, b) = \\int_{-\\infty}^{+\\infty} \\tilde{x}(t) \\frac{1}{\\sqrt{a}}\\psi^*(\\frac{t-b}{a})dt$$\nwhere $*$ is the complex conjugate of the chosen mother wavelet, and $a$, $b$ are the adjustable scaling and translation factors for the wavelet $\\psi$ to extract frequency- and time-domain information, respectively. In this research, the Morlet wavelet is selected as mother wavelet because it is widely used for vibration signal processing, especially for time-frequency localization [45], [46].\nThe second step is to calculate the candidate instantaneous frequency for $W(a, b) \\neq 0$ as\n$$f(a,b) = -\\frac{1}{2\\pi i} (\\frac{\\partial}{\\partial b} W_s(a,b)) \\oslash W_s(a,b)$$\nThe final step is to concentrate the energy along the candidate instantaneous frequency as\n$$T_a(2\\pi f, b) = \\int_{A(b)} W(a, b)a^{-3/2}\\delta (2\\pi f_a(a, b) - 2\\pi f) df$$\nwhere $A(b) = {a; W_s(a, b) \\neq 0}$, and $\\delta$ represents the Dirac-delta function in a distribution version to smoothly squeeze the spread-out energy into a narrow band around the instantaneous frequency [44].\nThe resultant spectrograms obtained from the same piece of radar signal using different time-frequency representation tools are shown in Figure 4. The spectrogram yielded by STFT in Figure 4(b) could show the rough positions of each $v_1$ but cannot clearly reveal the position for $v_2$. In comparison, CWT gives a sharp position for both vibrations, but the energy is still spread out and sometimes mixed with the background, as shown in Figure 4(c). By further concentrating the energy distribution, the spectrogram obtained by SST has a relatively clean background and sharp peaks for the vibrations as shown in Figure 4(d), reducing the burden of the deep-learning-based SCEG module in extracting latent features (i.e., $T_1$, $T_2$)."}, {"title": "C. radarODE Framework Design", "content": "1) Single Cycle ECG Length Estimation: The first module of radarODE aims to estimate the length of each single cycle ECG piece by calculating the interval between two consecutive heartbeats (i.e., PPI), and these heartbeats will bring intensive energy into the received radar signal [21]. Therefore, the energy plots $\\hat{x}(t)$ of the radar signal $\\tilde{x}(t)$ can be obtained by simply adding the SST spectrogram along the frequency axis and are used for peak detection as shown in Figure 5a. In addition, it is found in practice that the algorithms designed for ECG R-peaks detection are also applicable for the peaks detection from the radar energy plot $\\hat{x}$ (omit (t) for simplicity) [47], because apparently the energy plot shares a similar upsurge with the ECG signal. However, the 50 synchronous radar signals provided in the dataset ({$\\tilde{x}_1,...,\\tilde{x}_{50}$}) do not always have high SNR, potentially causing the wrong detection as shown in Figure 5b. Therefore, a new algorithm is proposed as in Algorithm 1 to eliminate the wrong detection obtained from 50 series of synchronous radar energy plots $\\mathcal{X}_L$, with the length of each $\\hat{x}_l \\in \\mathcal{X}_L$ equaling to $l$.\nThe design of Algorithm 1 is based on the fact that the PPI for healthy people tends to be unchanged in adjacent cardiac cycles. In this case, the long-term radar energy plots are firstly sliced into short segments as shown in the INITIALIZATION stage in Algorithm 1, and then the biopeaks algorithm [48] implemented in NeuroKit2 [47] is used for detecting all the potential peaks $P$ from each energy plot segment $\\hat{x}_c^l$ as:\n$$P = biopeaks(\\hat{x}_c^l)$$\nSecondly, the resultant $PPI_c$ obtained from Line 8-10 in Algorithm 1 contains potential estimated PPI from 50 radar energy plots, with the correct estimations as the majority. Therefore, the kernel density estimation (KDE) [49] is applied on the candidate set $PPI_c$ to calculate the probability density of different PPI values as:\n$$f(p) = \\frac{1}{nh} \\sum_{c=1}^{n} K(\\frac{p-PPI_c}{h})$$\nwhere $f(p)$ means the estimated probability density function at point $p$, $n$ is the number of all the estimated PPI in $PPI_c$, $K$ represents the Gaussian kernel function and $h = \\hat{\\sigma}n^{-1/5}$ is the bandwidth of the kernel. Lastly, the final PPI for the current segment is selected as argument $p$ when $f(p)$ achieves maximum as shown in Line 13 in Algorithm 1, and the long-term PPI estimation can be obtained step by step as the Algorithm 1 terminated.\nRemark 2. Algorithm 1 actually provides an accurate PPI estimation for coarse cardiac monitoring tasks as demonstrated later in Section IV-C1, and can be directly used for the monitoring of heart rate and HRV.\n2) Single Cycle ECG Generator (SCEG): Based on the yielded $PPI$, the SST spectrogram can be sliced into segments corresponding to a single cardiac cycle, and the aim of the SCEG module is to reconstruct the ECG for each single cardiac cycle, hence realizing the transformation from mechanical to electrical domain. In general, the input of the SCEG is $N$ segments of the SST plot within [1,25] Hz with the size of $F \\times T$ in frequency and time axis, and the output is the corresponding $N$ pieces of ECG with the same length $T$, as shown in Figure 6. In practice, the deep neural network only accepts the inputs/outputs with the same size. Therefore, the actual SST segment is centered at the current cardiac cycle and expands to 4 seconds, and the corresponding ECG ground truth is resampled to a fixed length of 200 for loss calculation.\nFor the architecture design, the SCEG module adopts the popular backbone, encoder, and decoder structure as verified by enormous image-related tasks [50]\u2013[52], with detailed parameters shown in Table I. In addition, a feature fusion block is added after the decoder to fuse the temporal and morphological features and generate the final ECG reconstruc-tions. The detailed implementation of each part in Table Iwith explanations can be elaborated as:\na. Backbone: Backbone is typically used as the first block to extract both low-level (e.g., color, edge) and high-level features (e.g., presence of specific pattern) from the input images. In the context of this research, the backbone is expected to localize the vibrations $v_1$, $v_2$ revealed as periodically appeared bright triangles within the range of [1,25] Hz on SST plots, providing latent information of $T_1$, $T_2$ for the further ECG reconstruction.\nAccording to the literature, the ResNet network with residual blocks is widely used as the backbone for feature extraction in many fields [53]\u2013[55], and this research will use a similar structure with 4 layers of residual blocks and downsample blocks as shown in Figure 7, with the key parameters listed in Table I. In addition, the traditional 2D convolution is all replaced by deformable 2D convolution [56] with deformable kernels (instead of square kernels) to fit the irregular shape of the target patterns, as shown in red triangles in Figure 6.\nb. Squeezer and Encoder: The output feature map from the backbone should involve both frequency- and time-domain features, and the squeezer is simply used to squeeze the frequency-domain feature using 2D convolution (Conv2d) and output the feature map with the temporal feature only. Then, the encoder assembled by three 1D transposed convolution (Transconv1d) blocks is used to further extract the temporal feature, with each block comprising Transconv1d, BN and ReLU. Finally, the output feature map from the encoder should contain the latent information about the $v_1$, $v_2$ (i.e., ($T_1$, $T_2$)).\nc. ECG Feature Decoder: The decoder is an essential part of SCEG to extract the temporal and morphological features separately from the latent information in the SST feature map, as shown in two branches in Figure 6. At first, an initial decoder is shared by the latter two decoders and comprises four 1D convolution (Conv1d) blocks with Conv1d, BN, and ReLU inside. Similarly, the temporal feature decoder is assembled by three Conv1d, and the output feature should contain prominent peaks at the position of $T_1$, $T_2$. However, these two peaks may still have deviations from the peaks in ECG ground truth, because obviously the mechanical vibrations $v_1$, $v_2$ lag behind QRS-complex and T-peaks, as shown in Figure 1. Another problem with the temporal feature decoder is that the ECG pieces have an entirely different shape with radar measurements, and the decoder needs to 'memorize' the unique pattern of ECG. Although the previous work shows the deep neural network could learn the patterns after training, the whole process of ECG reconstruction lacks supervision and is vulnerable to noise in radar signals [35], [57].\nIn this case, the ODE decoder is designed as a branch to assist the transformation between cardiac mechanical and electrical activities (radar to ECG) by introducing two prior facts in the real world:\n\u2022 Although the biological one-to-one correspondence between cardiac electrical and mechanical activities (excitation-contraction coupling) is too complex to be modeled, it is safe to claim that the measurements of mechanical activities generally lag behind those of electrical activities with a short time delay $\\tau$ [31], [32].\n\u2022 The shape of the ECG piece can be modeled morphologically using ODEs without any biological/chemical knowledge [58], and the introduction of ODEs could provide morphological prior to accelerating the convergence of the model training process and also providing extra robustness in the presence of noises.\nInspired by the above two facts, the ODE decoder is designed as a parameters estimation part and an ODE solver as shown in Figure 6, and the solution of the ODEs will be shifted to the left with time $\\tau$. To be specific, the parameters estimation part contains four linear blocks (Linear Layer, BN, Tanh) to project the latent space yielded by the initial decoder into parameters $\\eta$, $\\tau$, and $\\eta$ will be sent to an ODE solver to solve a 3D trajectory denoted by ($x$, $y$, $z$) as\n$$\\frac{dx}{dt} = \\alpha(x, y)x - wy$$\n$$\\frac{dy}{dt} = \\alpha(x,y)y + wx$$\n$$\\frac{dz}{dt} = \\sum_{e_f \\in F}a_{e_f} \\delta e_{e_f} e^{-(\\theta(x, y) - \\theta e_f)^2/2b_{e_f}}$$\nwith\n$$\\alpha(x, y) = 1 - \\sqrt{x^2 + y^2}$$\n$$\\Delta\\theta_{e_f}(x,y) = (\\theta(x, y) - \\theta_{e_f}) \\mod 2\\pi$$\n$$\\theta(x, y) = atan 2(y, x)) \\in [-\\pi,\\pi]$$\n$$e_f \\in F = {e_P, e_Q, e_R, e_S, e_T}$$\nwhere $F$ represents five characteristic peaks (PQRST) in a single cycle ECG signal, and the whole ODEs can be interpreted as manipulating each peak along a unit circle by varying the value of $\\eta = {a_{e_f},b_{e_f},\\delta_{e_f}}$ to adjust corresponding amplitude, width and position of each peak. After specifying all 15 parameters $\\eta$ (3 for each peak) and the initial conditions of ($x$, $y$, $z$), the value of $z$ can be solved out by the ODE solver using Euler method to get the final single cycle ECG signal as the morphological feature. In practice, the default values for $\\eta$ are provided in advance as in Table II, and the estimated parameters within the range of [-1,1] are used to scale the default values.\nd. Feature Fusion: The feature fusion module could leverage respective advantages of the morphological and temporal features and generate the final ECG signal for loss calculation, because the morphological feature only focuses on five peaks to provide a rough shape of ECG with calibrated peaks, and the temporal feature reserves all the other feature neglected in (19) to help the final reconstruction [59]. Therefore, two features are first fused together by multiplication into one and then stacked four times by itself. Then, the stacked feature is encoded and decoded as in Table I to yield the final single cycle ECG piece.\nThe last step of SCEG is to resample all the ECG pieces generated after the feature fusion part with respect to the previous PPI estimation, and the resampled ECG pieces are concatenated in time sequence to form the final morphological reference for long-term ECG reconstruction.\n3) Long-Term ECG Reconstruction: The long-term ECG reconstruction network adopts a simpler encoder-decoder-fusion structure than SCEG as shown in Figure 2, because the morphological reference reduces the burden of learning the ECG peaks and patterns. In addition, the input changes to arbitrary segments of 50 synchronous time-domain radar signal instead of the SST segments within a single cardiac cycle. Therefore, the encoder for raw radar signal has the same structure as the backbone in SCEG, only with the deformable 2D convolution replaced by 1D convolution with $K = 5$, $S = 2$. Then, the decoder is performed by four Transconv1d blocks with the same $K$ and $S$ as an encoder to generate the temporal feature, and the feature fusion module also shares the same strategy as SCEG. Lastly, 9 stacks of the temporal convolutional network (TCN) with dilation fact of 2 are added as suggested in [35] to recursively generate the ECG based on the historical reconstructions."}, {"title": "IV. EXPERIMENTAL AND RESULT EVALUATION", "content": ""}]}