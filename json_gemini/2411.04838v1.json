{"title": "Machine learning and optimization-based approaches to duality in statistical physics", "authors": ["Andrea E. V. Ferrari", "Prateek Gupta", "Nabil Iqbal"], "abstract": "The notion of duality - that a given physical system can have two different mathematical descriptions - is a key idea in modern theoretical physics. Establishing a duality in lattice statistical mechanics models requires the construction of a dual Hamiltonian and a map from the original to the dual observables. By using simple neural networks to parameterize these maps and introducing a loss function that penalises the difference between correlation functions in original and dual models, we formulate the process of duality discovery as an optimization problem. We numerically solve this problem and show that our framework can rediscover the celebrated Kramers-Wannier duality for the 2d Ising model, reconstructing the known mapping of temperatures. We also discuss an alternative approach which uses known features of the mapping of topological lines to reduce the problem to optimizing the couplings in a dual Hamiltonian, and explore next-to-nearest neighbour deformations of the 2d Ising duality. We discuss future directions and prospects for discovering new dualities within this framework.", "sections": [{"title": "I. INTRODUCTION AND BACKGROUND", "content": "A key concept in physics is duality, i.e. the idea that the same physical system can have two different mathematical descriptions. Duality sits at the heart of modern theoretical physics. Some influential examples selected from different areas of physics include [1-10].\nIn this work we seek to formalize the task of finding a duality in the controlled setting of lattice statistical physics, in a manner that allows modern machine learning as well as other numerical techniques to be used to systematically search for dualities. Our ultimate hope is that completely novel dualities may be found using such approaches. We will not realize these hopes in this work, however. Rather, we will elucidate interesting technical challenges that such a formulation poses, and build two algorithms that are sufficiently flexible and robust to \u201crediscover\u201d the celebrated Kramers-Wannier duality of the classical 2d Ising model [2, 3] in a fully automated way.\nThe first algorithm, which we present in Section II, is very general and has only elementary definitions as input. It could therefore apply mutatis mutandis to a variety of physical systems, perhaps even beyond the controlled setting of duality in lattice models. The second algorithm, which we present in Section III, relies instead on more refined but still rather elementary physical arguments (in particular the presence of topological lines associated with discrete symmetries [11]), and could efficiently be exploited to perform numerical explorations of dualities of Kramers-Wannier type. We will demonstrate this by studying deformations of the classical 2d Kramers-Wannier duality by the introduction of nearest-neighbour couplings, leaving further applications to future work.\nA portion of this work (the contents of Section II, where the first algorithm is discussed) will appear as a workshop paper at the Machine Learning for the Physical Sciences Workshop at NeurIPS2024."}, {"title": "A. Background on duality", "content": "We begin by formulating the notion of duality as we will use it in this work, and by formalizing the task of finding dualities.\nConsider a physical system described by some degrees of freedom $\\phi_i$, where generally $i \\in L$ labels points in some (possibly discrete) space $L$, e.g. a regular lattice of spatial"}, {"title": "II. GENERAL NEURAL NETWORK APPROACH", "content": "We now explain how, starting from the Hamiltonian $H[\\beta, \\sigma]$ of some statistical model on a lattice $L$, we can learn candidates $\\tilde{H}[\\beta, \\tilde{\\sigma}]$ for dual models as well as a dictionary between original and dual observables. This dictionary will turn out to include a mapping from the original to the dual lattice, where our approach will allow for an arbitrary local map of observables on links that will ultimately (at the end of the network training) be interpreted as defining the dual lattice from the original one."}, {"title": "A. Methodology", "content": "Framework and loss function: We assume that $\\tilde{H}$ can be written in terms of local couplings of spins:\n$H[\\beta] = -\\beta \\sum_{\\langle ij \\rangle} \\sigma_i \\sigma_j - \\beta_4 \\sum_{\\langle ijkl \\rangle} \\sigma_i \\sigma_j \\sigma_k \\sigma_l - \\cdots$  (II.1)\nwhere the couplings $\\beta_t$ are parameters to be learned.\nWe would like to find dual representations of the link products $F_{ij} = \\sigma_i \\sigma_j$ we described for the Ising model.\nWe assume that the link product in the original model is mapped to some functions of nearby link products in the dual model, more precisely\n$F_{ij}\\rightarrow G_{ij}(\\{\\sigma_{kl}\\}) $ (II.2)\nwhere $\\{\\sigma_{kl}\\}$ is a set of link products such as the one shown in Figure 2. We will use the simplified notation $G(\\tilde{\\sigma})$ below.\n$G$ is designed to be sufficiently flexible to recover models on lattices related in various ways to the original one. Note that a choice must be made about how to relate the assignment of link products neighbouring a horizontal link to the assignment of link products neighbouring a vertical link, as multiple choices are consistent with rotational invariance. In Figure 2 we display the choice used, which relates them by a rotation composed with a reflection. As we will see later, this choice is important for recovering the geometry of the dual lattice.\nWe now construct a loss function $L$ that is minimized when all correlation functions of $F_{ij}$ and $G_{ij}$ agree on the two sides of the duality, as in (1.3). This is similar to the matching of"}, {"title": "b. Optimization", "content": "We now need to solve the following optimization problem:\n$G^*, H^* = \\underset{G,H}{\\text{arg min}} L(G, H)$ (II.4)\n$G$ is represented by a neural network with parameters $\\theta$, $G=G_\\theta$.\nAlgorithm 1 outlines the procedure for optimization. Given a trial set of parameters $\\theta$ and couplings for the dual Hamiltonian $\\beta_a$, we simultaneously perform Markov Chain Monte Carlo (MCMC) sampling from the original and dual Hamiltonians using a standard Metropolis algorithm to obtain spin configurations $\\sigma_i$ and $\\tilde{\\sigma}$ drawn from the appropriate distributions respectively. We can then evaluate the expectation values in (II.3), and compute the loss $L$.\nTo minimize it we also need to compute gradients $\\partial_\\theta L$ and $\\partial_{\\beta_a} L$. For $\\theta$ this can be done straightforwardly using conventional automatic differentiation techniques. For the $\\beta_a$ we cannot backpropagate through a stochastic sampler, but explicit differentiation shows that we can relate the gradients to expectation values as follows. For concreteness we demonstrate the argument with only a single nonzero coupling $\\beta$ in (II.1), but the generalization to other couplings is immediate. For any function of spins $O[\\tilde{\\sigma}]$ we have\n$\\langle O \\rangle_{\\tilde{H}} = \\frac{1}{Z(\\beta)} \\sum_{\\{\\tilde{\\sigma}_i\\}} O e^{\\left(\\sum_{\\langle ij \\rangle} \\beta \\tilde{\\sigma}_i \\tilde{\\sigma}_j \\right)}  \\qquad Z(\\beta) = \\sum_{\\{\\tilde{\\sigma}_i\\}} e^{\\left(\\sum_{\\langle ij \\rangle} \\beta \\tilde{\\sigma}_i \\tilde{\\sigma}_j \\right)}$ (II.5)\nwhere the sum over $\\{\\tilde{\\sigma}_i\\}$ runs over all spin configurations. Now we have\n$\\frac{\\partial}{\\partial \\beta} L = -2\\sum_a l_a \\partial_{\\beta} \\langle \\psi^a[G(\\tilde{\\sigma}_i)] \\rangle_{\\tilde{H}}$, (II.6)\nwhere we have used the definition of $l_a$ in (II.3). From (II.5) the gradient of any observable with respect to $\\beta$ is\n$\\partial_\\beta \\langle O \\rangle_{\\tilde{H}} = - \\langle O \\rangle_{\\tilde{H}} \\left( \\sum_{\\langle ij \\rangle} \\tilde{\\sigma}_i \\tilde{\\sigma}_j \\right) + \\sum_{\\langle ij \\rangle} \\langle O \\tilde{\\sigma}_i \\tilde{\\sigma}_j \\rangle_{\\tilde{H}}$ (II.7)\nwhere the first term comes from differentiating $Z(\\beta)$ and the second from differentiating inside the Boltzmann measure weighting each configuration in (II.5). Using this expression to evaluate (II.7) for $O = \\psi^a[G(\\tilde{\\sigma}_i)]$ we find:\n$\\partial_\\beta L = 2 \\sum_a l_a \\left( \\langle \\psi^a[G(\\tilde{\\sigma}_i)] \\rangle_{\\tilde{H}} \\left( \\sum_{\\langle ij \\rangle} \\tilde{\\sigma}_i \\tilde{\\sigma}_j \\right) - \\sum_{\\langle ij \\rangle} \\langle \\psi^a[G(\\tilde{\\sigma}_i)] \\tilde{\\sigma}_i \\tilde{\\sigma}_j \\rangle_{\\tilde{H}} \\right)$ (II.8)\nWe can now evaluate the expectation value by MCMC sampling from the dual Hamiltonian. We note that this evaluation is computationally expensive, as each gradient step requires us to equilibrate an MCMC chain. For training conventional Boltzmann machines, one can use more efficient approaches such as contrastive divergence [19]. Due to the presence of the"}, {"title": "B. Experiments", "content": "In this section, we describe some simple experiments using the above machinery. We take our original Hamiltonian $H$ to be that of the 2d Ising model (1.4), and we take the dual Hamiltonian $\\tilde{H}$ in (II.1) to have only one non-zero parameter $\\tilde{\\beta}$ (and so $\\beta_4 = 0$, etc.).\na. Neural Network architecture for $G_\\theta$: For a given link product in the dual frame we assemble the 7 nearby links shown in Fig. 2 into a 7-dimensional vector $f_{(ij)} \\in (\\mathbb{Z}_2)^7$, where each element of the vector is the product of the two spins living on the two ends of the link. We consider a simplistic neural network acting on this input, with parameters formed by $\\theta_1 \\in \\mathbb{R}^7$, and scalars $\\theta_2$ and $\\theta_3$. We opt for hard attention using Gumbel-Softmax [20] so that only a few of the seven nearby links are utilized in the prediction task. Thus, the"}, {"title": "III. CONSTRUCTING THE MAPPING USING TOPOLOGICAL LINES", "content": "The approach outlined in the previous section is very general, and the rather minimal ingredients used raise the exciting possibility of using the approach to search for completely"}, {"title": "A. Background: topological lines", "content": "Let us begin by understanding a basic property of the spin correlations in the ordinary 2d Ising model, as reviewed in Section IA. Consider a product of neighbouring spins $\\sigma_i \\sigma_j$ where $i$ and $j$ are connected by a single link. Let us take a product of $n$ such two-spin products $\\sigma_{i_1} \\sigma_{j_1} \\sigma_{i_2} \\sigma_{j_2} \\cdots \\sigma_{i_n} \\sigma_{j_n}$ laid end-to-end along a continous path $C$ in an overlapping fashion, i.e. where $j_n = i_{n+1}$. At all intermediate sites along this path the spins themselves cancel, since $\\sigma_i^2 = 1$ for any site $i$. Thus this product is actually independent of the path $C$ itself, and only depends on the endpoints of the path:\n$\\prod_{\\langle ij \\rangle \\in C} \\sigma_i \\sigma_j = \\sigma_{i_1} \\sigma_{j_n} = \\sigma_{i_1} \\sigma_{i_{n+1}}$ (III.1)\nNow let us consider how this could be implemented in a duality. We seek a representation in terms of some dual spins $\\tilde{\\sigma}_i$; with associated Hamiltonian $\\tilde{H}$, where there is some function $G$ such that\n$\\langle \\sigma_i \\sigma_j \\rangle_H = \\langle G(\\{\\tilde{\\sigma}_i\\}) \\rangle_{\\tilde{H}}$. (III.2)\nThe path-independence of the product of the bilinears $\\sigma_i \\sigma_j$ that is exhibited in (III.1) is now very constraining: it tells us that an appropriate product of the $G$'s must also be path-independent. How can this be?\nThis is implemented in Kramers-Wannier duality by realizing $G$ above as a link of a topological line which follows from the existence of a $\\mathbb{Z}_2$ global symmetry. Indeed, whenever a system has a global symmetry, one can construct a topological operator \u2013 in this case a topological line \u2013 from it. This can be viewed as a generalization of Noether's theorem, and the rephrasing in terms of topological operators is most precise in the language of"}, {"title": "B. Methods", "content": "We now describe how this approach is implemented. In this section we will work with more general Hamiltonians.\nConstructing topological line\nWe first have to describe how to construct the topological line described above for a general $\\mathbb{Z}_2$-invariant Hamiltonian. This is a problem in bookkeeping. Consider a Hamiltonian density $H$ of the general form\n$H_i = - \\sum_a \\beta_a N_{a,i} [\\sigma]$ (III.6)\nwhere the sum $a$ runs over independent terms of the Hamiltonian, each $\\beta_a$ is a coupling, and where each $N_{a,i}$ is a local product of an even number of spins centered around the site $i$. By \"local\u201d we mean that this can be constructed by taking products of different spins which are connected by only a single link, i.e. if we denote this set of links by $L_a$ we have\n$N_{a,i} [\\sigma] = \\prod_{\\langle jk \\rangle \\in L_a} \\sigma_j \\sigma_k$ (III.7)\nFor example, for the usual Ising model, there are two $L_a$, corresponding to horizontal and vertical links respectively. Each of them contains only one link, which we express in the following relative fashion oriented around the site $i = (x, y)$:\n$L_{\\text{horizontal}} = \\{(x, y) \\leftrightarrow (x + 1, y)\\} \\qquad L_{\\text{vertical}} = \\{(x, y) \\leftrightarrow (x, y + 1)\\}$ (III.8)\nand by rotational invariance the corresponding couplings are the same $\\beta_{\\text{horizontal}} = \\beta_{\\text{vertical}} = \\beta$. The full Hamiltonian is constructed by summing the density $H_i$ over all sites in the lattice, $H[\\sigma] = \\sum_i H_i[\\sigma]$.\nAn efficient way to do the book-keeping for constructing the topological line is to gauge the $\\mathbb{Z}_2$ symmetry, i.e. to introduce an external $\\mathbb{Z}_2$-valued gauge field $t_{(ij)}$ on the links of the lattice, and to replace in the Hamiltonian each product of spins connected by a single link with the following gauged version:\n$\\sigma_i \\sigma_j \\rightarrow \\sigma_i t_{ij} \\sigma_j$ (III.9)\nThe new Hamiltonian $H'[\\sigma; t]$ constructed in this manner is now invariant under the following operation for an arbitrary $\\mathbb{Z}_2$ valued function $\\lambda_i$ of the sites:\n$\\sigma_i \\rightarrow \\sigma'_i = \\lambda_i \\sigma_i \\qquad t_{(ij)} \\rightarrow t'_{(ij)} = \\lambda_i t_{(ij)} \\lambda_j$ (III.10)\nand thus the partition function \u2013 which is now a function of the external $t_{(ij)}$ is invariant under the same transformation, which acts now only on $t$:\n$Z[t] = \\sum_{\\{\\sigma_i\\}} \\text{exp}(-H[\\sigma; t]) = Z[t']$ (III.11)\nThis invariance is equivalent to the arguments around (III.4) and allows us to construct a topological line.\nMore explicitly, consider drawing a path $C$ on the dual lattice which intersects a set of links of the original lattice. Set $t_{(ij)} = -1$ on all links intersected by the path and $t_{(ij)} = +1$ on all the rest of the links. This defines a line operator on the curve $C$. Denote the partition function in the presence of this source by $Z[t(C)]$. By using transformations of the form (III.10) the pattern of nontrivial $t_{(ij)}$ can be altered in such a manner that the curve $C$ is continuously deformed without altering the partition function, thus illustrating that the line $C$ is topological.\nWe can express this line operator as an expectation value in the original Hamiltonian. Note that setting $t_{(ij)} = -1$ along a curve $C$ has the effect of flipping the signs of some of the $\\beta_a$ in the expansion. Given an explicit parametrization of the curve $C$, it is a book-keeping problem to keep track of which $\\beta_a$ on which sites $i$ are so modified and then write the partition function as\n$Z[t(C)] = \\sum_{\\{\\sigma_i\\}} \\text{exp}(-H[\\sigma]) \\prod_{i,a \\in S} \\text{exp}(-2 \\beta_a N_{a,i} [\\sigma])$ (III.12)\nfor an appropriate set $S$."}, {"title": "Matching to dual Hamiltonian", "content": "We now use this technology to find pairs of Hamiltonians related by duality. In addition to a \"primal\" Hamiltonian $H$ defined as above, consider also a dual Hamiltonian with couplings $\\tilde{\\beta}_a$ and spins denoted by $\\tilde{\\sigma}_{i^*}$. We denote points on the lattice where the dual $\\tilde{\\sigma}$ live by starred coordinates $i^*$.\n$\\tilde{H} = - \\sum_{i^*, a} \\tilde{\\beta}_a \\tilde{N}_{a, i^*} [\\tilde{\\sigma}]  \\qquad H = - \\sum_{i, a} \\beta_a N_{a, i} [\\sigma]$ (III.13)\nWe apply the topological line approach to the dual Hamiltonian, and construct the operator associated with a curve $C$ that is only a single link $(i^*j^*)$; we denote this operator as $G_{(i^*j^*)}$ and it takes the form\n$G_{(i^*j^*)} = \\prod_{k^*, a \\in S(i^*, j^*)} \\text{exp}(-2 \\tilde{\\beta}_a \\tilde{N}_{a, k^*} [\\tilde{\\sigma}])$ (III.14)\nwhere the set $S$ of the couplings that we flip depends implicitly on the link chosen. Now by the arguments around (III.5), the Hamiltonian $\\tilde{H}$ is a Kramers-Wannier dual to $H$ if the following relation holds:\n$\\langle \\sigma_i \\sigma_j \\rangle_H = \\langle \\prod_{k^*, a \\in S(i^*, j^*)} \\text{exp}(-2 \\tilde{\\beta}_a \\tilde{N}_{a, k^*} [\\tilde{\\sigma}]) \\dots \\rangle_{\\tilde{H}}$ (III.15)\ni.e. if the link of a topological line can be realized directly in terms of fundamental spins in the dual frame.\nIn this section, we will assume that we are given the dual couplings $\\tilde{\\beta}_a$, and our task is to find the couplings in the original frame $\\beta_a$ such that (III.15) is satisfied. This is a significantly easier problem than that of the previous section, because we used physics input to completely determine the form of the function $G$; we thus need only determine the couplings. By taking appropriate products of the $G_{(i^*j^*)}$ and doing Monte Carlo simulations using $H$ we can compute arbitrary moments of the right-hand side of (III.15).\nThus the problem is equivalent to determining the couplings of a generalized Ising model $H[\\sigma]$ given all moments $\\langle \\sigma_i \\sigma_j \\dots \\rangle_H$. This problem is sometimes called the \u201cinverse Ising problem\", with a large literature: see [26] for a review of different approaches. We will use an algorithm from [27, 28] which essentially exploits a self-consistency relation on correlation functions.\""}, {"title": "Numerical implementation", "content": "We briefly review the algorithm, following the implementation outlined in [29]. For the remainder of this section we will consider only generalized Ising models with two-spin interactions; thus the Hamiltonian takes the form\n$H = - \\sum_i \\sum_\\delta K_{i,i+\\delta} \\sigma_i \\sigma_{i+\\delta}$ (III.16)\nwhere $K_{i,i+\\delta}$ is a 2-site coupling, and $\\delta$ should be understood as a displacement vector taking us from a site $i$ to a nearby (but not necessarily connected by a single link) site $i + \\delta$. We can derive a useful consistency relation by noting that the marginal probability distribution of a given $\\sigma_i$ depends only on its neighbours; explicitly summing over a single $\\sigma_i$ we find\n$\\langle \\sigma_i \\rangle = \\text{tanh} \\left( \\sum_{\\delta'} K_{i,i+\\delta'} \\sigma_{i+\\delta'} \\right)$ (III.17)\nwhich is the analogue of an \u201cequation of motion\" in this discrete statistical mechanics setting. In a $\\mathbb{Z}_2$ symmetric setting on a finite lattice both sides of the above equation identically vanish, but the following generalization is useful:\n$\\langle \\sigma_j \\sigma_{j+\\delta} \\rangle = \\left\\langle \\text{tanh} \\left( \\sum_{\\delta'} K_{j,j+\\delta'} \\sigma_{j+\\delta'} \\right) \\sigma_\\delta \\right\\rangle$ (III.18)\nThe idea of the algorithm is simply that given a set of samples of the $\\{\\sigma_i\\}$ from Monte Carlo simulations, we adjust the $K_{i,i+\\delta}$ so that (III.18) holds.\nAt a practical level, we do this by computing the following gradient\n$D_{\\delta,\\delta'} = \\frac{\\partial}{\\partial K_{j,j+\\delta'}} \\langle \\sigma_j \\sigma_{\\delta} \\rangle = \\left\\langle \\sigma_{j+\\delta} \\sigma_{j+\\delta'} \\text{sech}^2 \\left( \\sum_{\\delta''} K_{j,j+\\delta''} \\sigma_j \\sigma_{\\delta''} \\right) \\right\\rangle$ (III.19)\nNote that in a situation with translational invariance, $K_{i,i+\\delta} = K_\\delta$ alone, and similarly all correlation functions above do not depend on the reference point $j$, as the notation for $D_{\\delta,\\delta'}$ implicitly assumes.\nWe then implement a variant of Newton's method for $K_\\delta$ by solving the linearized equation:\n$\\langle \\sigma_j \\sigma_{j+\\delta} \\rangle - \\left\\langle \\text{tanh} \\left( \\sum_{\\delta'} K_{j,j+\\delta'} \\sigma_{j+\\delta'} \\right) \\sigma_\\delta \\right\\rangle = \\sum_{\\delta'} D_{\\delta,\\delta'} \\Delta K_{\\delta'}$ (III.20)\nfor the increment $\\Delta K_\\delta$, and iterating as $K_\\delta \\leftarrow K_\\delta + \\epsilon \\Delta K_\\delta$ for some learning rate $\\epsilon$. The fixed point of this procedure will drive the left-hand side to zero and thus find the values of the couplings $K$ that are consistent with the given data."}, {"title": "C. Dualities of nearest-neighbour couplings", "content": "We now discuss a specific model, followed by the results from this approach."}, {"title": "Next-to-nearest neighbour Ising model", "content": "We consider as a testbed the following the next-to-nearest neighbour (NNI) Ising model:\n$H[\\sigma] = - \\beta \\sum_{\\langle ij \\rangle} \\sigma_i \\sigma_j - \\kappa \\sum_{[ij]} \\sigma_i \\sigma_j$ (III.23)\nThe notation $\\langle ij \\rangle$ refers to the usual nearest-neighbour coupling - i.e. sites differing by the vectors (0, 1) or (1,0). Here $[ij]$ refers to a diagonal coupling, i.e. two sites $i,j$ which differ by (+1,+1) or (+1, \u22121), and is thus a next-to-nearest-neighbour coupling, as shown\na. Physics of the model and analytic dual. This model has been previously studied as an extension to the standard Ising model [30-32], and we briefly discuss its physics. At K = 0 this reduces to the usual Ising model with a phase transition at $\\beta \\approx 0.44$. At $\\beta = 0$ it reduces to two disconnected Ising models, each living on one of the two checkerboard bipartite partitions of the square lattice; thus this model also has an ordering transition at $\\tilde{\\kappa} \\approx 0.44$, though there is now an extra global symmetry corresponding to flipping the spins on each checkerboard independently. Numerical investigations show that the phase transition line connects these two points,"}, {"title": "Numerical exploration as a deformation of the 2d Ising duality", "content": "Our motivation to study this Hamiltonian is that it is the simplest model that allows us to explore the robustness of the algorithm to turning on extra couplings from known dualities, and we will take a slightly different but still informative approach. In particular, we will consider this duality as a deformation of the standard 2d Ising duality discussed above, and attempt to find a candidate dual Hamiltonian of the same form (i.e. also labeled by two couplings $\\beta$, K) defined on a dual square lattice. We note that this candidate dual Hamiltonian does not fit into the class of Hamiltonians found in [32], and thus it should only be viewed as an approximate duality, i.e. an effective description of the exact dual to the NNI Ising model (found by perturbing around the original Ising model). We wish to see how well this effective description can be brought to match correlation functions, and we will notice remarkable agreement."}, {"title": "D. Results", "content": "We now display the results of some preliminary investigations. As a check on the stability of the numerics we treat as independent parameters the coupling on each of the eight links"}, {"title": "IV. CONCLUSIONS AND OUTLOOK", "content": "In this work, we have formalized the task of finding dualities in classical statistical physics in such a way that it can be tackled by machine learning. The key insight is that in order to find dual candidates of a given model, one needs to generalize the classical problem of learning couplings $\\beta$ in a Hamiltonian $\\tilde{H}[\\beta, \\tilde{\\sigma}]$ starting from data to the simultaneous learning of\nthe couplings $\\beta$,\nsome properties of the underlying space $L$ in which the model is defined,\na mapping of observables $G(\\tilde{\\sigma})$.\nIn Section II \u2013 which we call the \u201cmachine learning approach\" \u2013 we have introduced a loss that measures the distance between moments of observables across the (given) original model and candidate dual models, and we have discussed algorithms aimed at minimizing it. We\""}, {"title": "Appendix A: Kramers-Wannier duality", "content": "For completeness, here we present a derivation of the usual Kramers-Wannier duality for the 2d Ising model on the square lattice in a manner that shows how the duality is complicated when the model is deformed away from the standard nearest-neighbour couplings."}, {"title": "Usual Kramers-Wannier duality", "content": "Consider the usual classical 2d Ising model with spins $\\sigma_i = \\pm 1$ living on the sites of a 2d lattice.\n$H[\\sigma] = -\\beta \\sum_{\\langle ij \\rangle} \\sigma_i \\sigma_j \\qquad Z = \\sum_{\\{\\sigma_i\\}} \\text{exp}(-H)$ (A.1)\nHere we have chosen to absorb the inverse temperature $\\beta$ into the Hamiltonian. The notation $\\langle ij \\rangle$ refers to the link connecting nearest neighbour sites $i$ and $j$. The model is invariant under the global $\\mathbb{Z}_2$ symmetry which acts simultaneously on all spins as $\\sigma_i \\rightarrow -\\sigma_i$.\nTo derive the duality, we will consider a gauged version of the model. In other words, we consider the following model with an extra dynamical $\\mathbb{Z}_2$-valued gauge field $t_{ij}$ living on the links.\n$H'[t, \\sigma] = -\\beta \\sum_{\\langle ij \\rangle} t_{ij} \\sigma_i \\sigma_j \\qquad Z' = \\sum_{\\{\\text{flat } t_{ij}\\}} \\sum_{\\{\\sigma_i\\}} \\text{exp}(-H)$ (A.2)\nThis model has an enlarged $\\mathbb{Z}_2$ gauge symmetry which acts as\n$t_{ij} \\rightarrow \\lambda_i t_{ij} \\lambda_j \\qquad \\sigma_i \\rightarrow \\lambda_i \\sigma_i$ (A.3)\nwhere $\\lambda_i$ is an arbitrary $\\mathbb{Z}_2$-valued function living on the sites.\nThe injunction to sum only over flat $t_{ij}$ means that we include in the partition sum only $t_{ij}$ that have vanishing field strength, i.e. if we take the product over all the links $l$ of a plaquette $p$ to define a plaquette-valued field strength $F_p = \\prod_{l \\in p} t_{i}$ we find 1 for all plaquettes:\n$F_p = 1 \\qquad \\leftrightarrow \\qquad t_{ij} \\text{flat}$ (A.4)\nIt is well-known that gauging a global symmetry in this flat manner results in a theory with essentially the same local physics in the symmetry-invariant sector, though global issues (i.e."}, {"title": "Kramers-Wannier duality with next-to-nearest neighbour interactions", "content": "We now consider applying a similar technique to the 2d Ising model with next-to-nearest neighbour couplings as in (III C 1):\n$H[\\sigma] = -\\beta \\sum_{\\langle ij \\rangle} \\sigma_i \\sigma_j - \\kappa \\sum_{[ij]} \\sigma_i \\sigma_j$ (A.14)\nWe will now gauge the symmetry as we did above. The gauged version of the model requires us to pick a way to connect two sites that are diagonally coupled using the links on the"}]}