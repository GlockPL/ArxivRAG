{"title": "Constructing and explaining machine learning models for chemistry: example of the exploration and design of boron-based Lewis acids", "authors": ["Juliette Fenogli", "Laurence Grimaud", "Rodolphe Vuilleumier"], "abstract": "The integration of machine learning (ML) into chemistry offers transformative potential in the design of molecules. However, the focus has often been on creating highly efficient predictive models, sometimes at the expense of interpretability. We leverage explainable Al techniques to explore the design of boron-based Lewis acids, which play a pivotal role in organic reactions. Using Fluoride lon Affinity as a proxy for Lewis acidity, we developed interpretable ML models based on chemically meaningful descriptors, including ab initio features and substituent-based parameters. By constraining the chemical space to well-defined molecular scaffolds, we achieved highly accurate predictions, surpassing conventional black-box deep learning models in low-data regime. Interpretability analyses of the models unraveled the origin of Lewis acidity in these compounds and identified actionable levers to modulate it. This work bridges ML and chemist's way of thinking, demonstrating how explainable models can inspire molecular design and enhance scientific understanding of chemical reactivity.", "sections": [{"title": "Introduction", "content": "Machine learning (ML) has become indispensable across various scientific domains for uncovering patterns in databases and modeling complex relationships among variables in high-dimensional spaces. 1-3 In chemistry, ML has made significant strides in recent years, leveraging experimental and computed data made accessible by the development of extensive databases, 4,5 high-throughput experiments, 6,7 and super-computers. 8,9 While data-driven modeling and statistical analysis have a long-standing history in chemistry, building upon foundational concepts like the Hammett correlations in 1937,10 the adoption of ML techniques marks a notable advancement. 11 Indeed, chemical questions ranging from drug discovery, 12 molecular simulations, 13,14 and chemical reaction outcome prediction 5,7,8,15-17 to synthesis planning 18-20 have been successfully addressed.\nHowever, many models, particularly those based on deep neural networks, lack interpretability and are often referred to as \"black-box\" models, 21 which poses challenges in trust-critical fields like medical diagnosis. 22 Interpretability not only aids in rationalizing decision-making processes but also helps evaluate the validity of a model's predictions against domain knowledge, guarding against spurious reasoning. 23 Furthermore, while some models can be highly accurate, their lack of interpretability limits the ability to extract scientific knowledge from them, thus diminishing their overall interest. The emergence of explainable artificial intelligence (XAI) seeks to address these issues by elucidating what ML algorithms have learned, fostering scientific knowledge, and inspiring new concepts and ideas. 24-26 In chemistry, XAI techniques have been successfully applied to the study of quantitative structure-activity relationships (QSAR), 27-30 drug discovery, 31 and the modeling of organic reactions. 32,33\nHere we investigate how ML can guide the design of molecules with a targeted specific property: the Lewis acidity. A Lewis acid is a molecule that readily accepts an electron pair from a Lewis base, resulting in the formation of a Lewis adduct. Lewis acids are usually made of a central atom exhibiting an electron vacancy, such as boron atom, surrounded by inorganic or organic ligands. These compounds play a pivotal role in promoting organic reactions. 34,35"}, {"title": "Results", "content": "We targeted scaffolds possessing aromatic ligands, which are particularly effective at transmitting electronic effects over long distances through their electronic systems, unlike aliphatic or non-conjugated ligands. This facilitates the combination of effects from multiple substituents on the same central atom. Additionally, as aromatic positions are not chemically equivalent, their diverse substitution allows to precisely modulate the effect on FIA. While the substitution of aromatic positions to modulate molecular reactivity is well-established in organic chemistry, 38 its systematic integration with ML to predict Lewis acidity is, to our knowledge, unprecedented. Previous databases, such as the one developed by Greb and coworkers, 36 have primarily focused on exploring the effects of the central atom type and ligand denticity. To enhance model performance and simplify interpretation, we limited the chemical space to four scaffolds: triarylboranes, which have been extensively studied for their catalytic activity, 34,35 and three constrained Lewis acid scaffolds (ONO44, NNN42, OCO45) featuring heteroatoms coordinated to boron. The planar geometry of these constrained ligands minimizes steric hindrance, while the pincer-like structure facilitates boron atom accessibility, enhancing Lewis acidity. 42 Each dataset comprises symmetric molecules, substituted with 13 possible electron-donating or -withdrawing substituents at specific aromatic positions, to minimize steric hindrance and ensure synthetic efficiency (Fig. 1). These constraints result in a chemical space of 2197 molecules for the ONO scaffold for example.\nThe FIA of each molecule was computed, forming a comprehensive database of boron Lewis acids and their associated FIAs. The range of FIA values varies depending on the ligand scaffold (Extended Data Fig. 1.A). OCO scaffold exhibits a very narrow distribution of FIAs, whereas FIA is relatively normally distributed across ONO derivatives, which will be advantageous when constructing ML models (see Methods). In contrast, triarylboranes show a more uniform distribution, offering a broader spectrum of accessible FIA values. Among these, the strongest Lewis acids are found in the ONO and triarylboranes scaffolds."}, {"title": "Chemical space", "content": "We targeted scaffolds possessing aromatic ligands, which are particularly effective at transmitting electronic effects over long distances through their electronic systems, unlike aliphatic or non-conjugated ligands. This facilitates the combination of effects from multiple substituents on the same central atom. Additionally, as aromatic positions are not chemically equivalent, their diverse substitution allows to precisely modulate the effect on FIA. While the substitution of aromatic positions to modulate molecular reactivity is well-established in organic chemistry, 38 its systematic integration with ML to predict Lewis acidity is, to our knowledge, unprecedented. Previous databases, such as the one developed by Greb and coworkers, 36 have primarily focused on exploring the effects of the central atom type and ligand denticity. To enhance model performance and simplify interpretation, we limited the chemical space to four scaffolds: triarylboranes, which have been extensively studied for their catalytic activity, 34,35 and three constrained Lewis acid scaffolds (ONO44, NNN42, OCO45) featuring heteroatoms coordinated to boron. The planar geometry of these constrained ligands minimizes steric hindrance, while the pincer-like structure facilitates boron atom accessibility, enhancing Lewis acidity. 42 Each dataset comprises symmetric molecules, substituted with 13 possible electron-donating or -withdrawing substituents at specific aromatic positions, to minimize steric hindrance and ensure synthetic efficiency (Fig. 1). These constraints result in a chemical space of 2197 molecules for the ONO scaffold for example.\nThe FIA of each molecule was computed, forming a comprehensive database of boron Lewis acids and their associated FIAs. The range of FIA values varies depending on the ligand scaffold (Extended Data Fig. 1.A). OCO scaffold exhibits a very narrow distribution of FIAs, whereas FIA is relatively normally distributed across ONO derivatives, which will be advantageous when constructing ML models (see Methods). In contrast, triarylboranes show a more uniform distribution, offering a broader spectrum of accessible FIA values. Among these, the strongest Lewis acids are found in the ONO and triarylboranes scaffolds."}, {"title": "Constructing models", "content": "As the triarylboranes have already been extensively studied and as we wanted to design novel boron Lewis acids, we focused on the ONO molecular scaffold for ML models building. A benchmark of ML models and molecular descriptors was realized (see Methods, Constructing models and Extended Data Fig. 2). Notably, linear models combined with Hammett-extended descriptors perform exceptionally well, achieving mean absolute errors (MAE) of nearly 6 kJ.mol\u00b9. Given the straightforward nature of the molecule description and the impressive results obtained with these basic models, they provide an optimal balance between interpretability and prediction accuracy. These findings align with Hammett's theory of linear free energy relationships (LFER), which suggests that functional groups on an aromatic ring near the reactive site linearly influence the molecule's reactivity. Then, an oracle was developed based on the linear ridge (LR) algorithm and the concatenation of RDKit and Hammett-extended descriptors (see Methods), achieving a MAE of 5.39 kJ.mol\u00b9 on the testing set (Fig. 2). The performance on the ONO dataset, with a MAE between 5 and 10 kJ.mol\u00b9 across almost all ML algorithms and molecular descriptors (Extended Data Fig. 2.A), can be attributed to the limited chemical space it encompasses. In contrast, the optimized GNN model of Greb and co-workers, 36 evaluated on a wide variety of molecular structures, struggles to achieve a MAE below 10 kJ.mol\u00b9. This model gave a MAE of 23 kJ.mol\u00af\u00b9 (R2 = 0.51) evaluated on the testing set of ONO scaffold. In addition, such deep learning (DL) models necessitate huge amounts of data to perform and are not designed for tasks in low-data regime. However, a restricted chemical space alone is insufficient to achieve high performance using simple models, as such an oracle was impossible to develop for triarylboranes for example (see Methods)."}, {"title": "Capacity to extrapolate to another molecular scaffold", "content": "After optimizing models to predict FIA within the restricted ONO chemical space, we aimed to assess their ability to predict FIA across different chemical spaces, particularly from a molecular scaffold to the other. We also explored methods, such as feature selection, to customize models for enhanced versatility. However, not all descriptors are suitable for this purpose. In addition to being difficult to interpret, fingerprints, represented as bit-vectors, have interdependent features that cannot be individually selected. Furthermore, Hammett-extended descriptors rely solely on the chemical properties of substituents (see Methods). Molecules with identical ortho, para, and meta substituents are then assigned the same molecular descriptors, even though their FIAs can differ significantly across structures (refer to Fig. S10). For this reason, we focus on enhancing the extrapolation capabilities of models based on quantum or RDKit descriptors (see the SI, section S5 for the latter).\nModels trained on ONO dataset, featured by the quantum descriptors, can generally predict the FIA trend for the NNN, though with a model-dependent bias that impacts the MAE (Table S7). Simple models struggle to extrapolate, whereas the Multilayer Perceptron (MLP) achieves reasonable prediction performance (MAE = 24.1 kJ.mol\u00b9), as expected given the inherent versatility of neural networks. This is illustrated in Fig. 3.A, showing the prediction for the NNN from a LR model trained on ONO. While the trend is well captured (Pearson's r = 0.96), the MAE is high reaching 188 kJ.mol\u00af\u00b9. The bias in prediction observed in most models can be partly attributed to the considerable variation in some features ranges between the two molecular scaffolds. When the model heavily relies on such features, predictions from one structure to another can be impacted by the high variation, leading the model to overestimate the features' effect. Even if these features are important for initial predictions, removing them may improve extrapolation. Additionally, features not correlated with the target FIA can be removed to streamline the models and enhance their generalizability.\nTherefore, we ranked features based on their differences between ONO and NNN structures (Table S9) and their correlation to the target FIA (Table S10). We assessed the prediction performance of the LR model by systematically removing features using these two criteria. Among the features not correlated with FIA, boron atom parameters such as its coordinates and buried volume led to a notable drop in MAE (from 188 to 158 kJ.mol\u00b9) when removed. Eliminating the lower unoccupied molecular orbital (LUMO) energy, that is strongly correlated with FIA (Pearson's r = 0.628) but varies considerably between structures, decreased the MAE to 140 kJ.mol\u00b9. Similarly, although not correlated with FIA (Pearson's r = 0.076), the population of Rydberg atomic orbitals (NPA_Rydberg) changes significantly between the two structures. Removing this feature decreased the MAE to 14.5 kJ.mol-\u00b9, indicating a considerable contribution to the observed bias, albeit difficult to explain. When this feature alone was excluded, the MAE dropped directly from 227 to 35.5 kJ.mol-1. Further removal of the dipolar moment of the molecule reduced the MAE to 13.6 kJ.mol\u00af\u00b9. The improvement in prediction performance of the LR model with the selected features is illustrated in Fig. 3.B. Prediction performance remained high within the ONO (8.26 kJ.mol\u00b9) and the NNN (11.4 kJ.mol\u00af\u00b9) chemical spaces using these selected features. However, it's important to note that the feature selection is task-specific, as evidenced by varying performance in predicting from ONO to OCO (MAE = 84.8 kJ.mol\u00b9) and triarylboranes (MAE = 759 kJ.mol\u00af\u00b9) using these features. This is due to inherent differences between scaffolds, notably in terms of FIA distribution (Extended Data Fig. 1.A) and electronic structure (Extended Data Fig. 3). To explore these differences, we attempted training on three molecular structures while testing on the fourth, which partly improved the extrapolation performances (see SI, section S5)."}, {"title": "Interpretability", "content": "Our goal here is to address two main questions by interpreting the developed models. First, we aim to gain insight into the intrinsic nature of Lewis acidity for boron derivatives. Second, we seek actionable explanations for a compound's Lewis acidity, exploring new routes to design molecular structures with targeted Lewis acidity."}, {"title": "Insights in the Lewis acidity", "content": "ML can serve as an instrument to unveil properties of a system that are challenging or even impossible to probe using traditional methods. Lewis acidity is rather a qualitative concept. It can be accessed through the reaction enthalpy of a Lewis acid-Lewis base adduct formation, but unlike electrophilicity, that is associated with the energy level of the LUMO, the relationship between molecular properties and Lewis acidity remains elusive. Analyzing FIA predictive models may help to unravel the origins of Lewis acidity at the electronic scale.\nWe used quantum descriptors that provide precise physical parameters for characterizing molecules and examined the whole database (four molecular scaffolds) to find broader patterns and insights. Conducting a principal component analysis (PCA) to simplify complex data into two dimensions, we identified distinct groups of molecules (Extended Data Fig. 3). Notably, the triarylboranes appear separate from other structures along the PC1 axis, which primarily encompasses electronic parameters of the boron atom. This separation is unsurprising as triarylboranes lack heteroatoms bonded to boron, which can affect electronic population through electron-withdrawing effects. Additionally, the two PC derived from quantum descriptors reflect FIA evolution across the database. This confirms the relevance of these descriptors in capturing Lewis acidity.\nWe then simplified the data by choosing twelve significant but uncorrelated features through a hierarchical clustering (SI, section S6). Most ML methods struggled with these simplified descriptors across the four molecular scaffolds, except for tree-based ensemble models like Random Forest (RF) and Gradient Boosting, which performed better than the others (see Table S17). Our goal was to explore how these features impacted the FIA using two interpretable ML approaches. We first looked at a straightforward and simple model using linear regression to understand how much each feature contributed. Then, we used the permutation feature importance post-hoc technique, with a Gradient Boosting regressor, as this model was the most performant on uncorrelated features (MAE = 14.61 kJ.mol\u00b9, Table S17). The learned coefficient of each feature in the linear model, as depicted in Fig. S13.C, reveals its importance. Both the global electronegativity of the molecule and the partial charge of the boron atom (NPA_charge) emerge as the most significant features, with approximately equal importance. This observation aligns with their ranking in permutation feature importance, although the electronegativity being slightly more influential (Fig. S13.B). When the regression is restricted to the ONO dataset (Fig. S15), electronegativity becomes the most significant parameter, with the partial charge coefficient being three times lower. Electronegativity is a linear combination of frontier orbital energies, suggesting that, for the boron derivatives studied, Lewis acidity is somewhat more influenced by molecular orbital interactions than by Coulombic interactions. This is notable because FIA is traditionally considered as an index of hard acidity, where Coulombic interactions would be expected to dominate. 46,47\nThe absolute electronegativity is then a key global factor in determining FIA magnitude, while local electronic parameters of boron atom more precisely adjust the predicted FIA. FIA can be roughly linearly predicted using only these two parameters for the ONO scaffold (FIA = 60.0 x + 8.15 NPA charge + 161, R2 = 0.88, Fig. S16). Steric parameters (e.g., molar_volume) seem to play a less significant role, potentially due to the predominance of constrained-ligand boron derivatives in our database. Thus, controlling the electronic environment around the boron atom is essential. While chemists cannot directly manipulate quantum properties that are not \"actionable\", they can adjust Lewis acidity through molecular design by varying functional groups on the molecular scaffold. However, this approach is complicated by the interconnected effects of the substituents on the same reactive site, making the use of ML relevant."}, {"title": "Molecular design", "content": "This part will focus on the ONO molecular scaffold (see SI, section S6 for a comparison with the triarylboranes). We used Hammett-extended descriptors, that are specifically tailored to unravel the effect of substituents.\nBefore any regression by a ML algorithm, we examined the correlation between ortho, meta, or para parameters, relative to the oxygens, and FIA (Fig. S17.A), which shows that para substituents have the most significant effect on FIA. Steric parameters, such as the torsional angle Otor or Sterimol parameters, poorly correlate with FIA. We then selected twelve uncorrelated features through hierarchical clustering (Fig. S18A). Using again the linear model (Fig. S17B) and a permutation importance algorithm (Fig. S18B) on a Gradient Boosting regressor, we identified the Hammett \u03c3 constants as the most significant parameters, \u03c3\u03c1 (p for para) being slightly more important than \u03c3m (mfor meta), with a lower contribution of parameters characterizing the electronic demand of the ortho substituent. This observation is consistent with the correlations with FIA (Fig. S17.A).\nThese methods help identify which aromatic positions to prioritize when designing an ONO compound with a specific Lewis acidity, namely here, the para position. However, they do not inform on the electronic demand of the substituent or the interactions between substituents at different positions. We used decision trees to understand the decision criteria for predicting FIA. We thus categorized FIA into six classes based on the ONO chemical space distribution (Extended Data Fig. 1.A), turning the original regression task into a classification problem. To simplify the analysis and the resulting tree structure, we focused on four Hammett-extended features capturing steric and electronic effects of ortho, meta, and para substituents. We included the partial charge of the oxygen atom of the C=O bond of benzoic acid (NBO=0) for each position (ortho: o, para: p, meta: m), as the Sigman group showed that these parameters could effectively replace the empirical \u03c3 constants, 48 plus Lo, the bond length between the ortho substituent and the aromatic ring, to account for steric effects at the ortho position. The root node of the decision tree shows that the NBO=0 charge for the para substituent is the critical criterion for classifying LA as good, strong or super if it exceeds -0.59e, - a threshold distinguishing mesomeric electron-withdrawing groups (such as CN and NO2) from others (see Table S6); otherwise, it is classified as medium. Subsequent nodes evaluate the ortho and meta substituents for majority-medium and majority-good classes, respectively. The obtained tree diagram is depicted in Fig. 4, translated into chemical terms based on the feature thresholds from the original Scikit-learn49 tree (see Fig. S19).\nIn summary, the tree structure shows that adding or not a mesomeric electron-withdrawing group at the para position of an ONO molecule already determines the accessible range of FIA (Fig. 4). Then, the substituents at the ortho and meta positions must be examined to refine the targeted FIA value. To confirm these results, we need more data for statistical analyses on the diverse substituents. For that, we have used the oracle previously developed (see Methods, oracle development) to screen the entire ONO chemical space and provide precise FIA values to enrich our database."}, {"title": "Interpretable ML", "content": "This part will focus on the ONO molecular scaffold (see SI, section S6 for a comparison with the triarylboranes). We used Hammett-extended descriptors, that are specifically tailored to unravel the effect of substituents.\nBefore any regression by a ML algorithm, we examined the correlation between ortho, meta, or para parameters, relative to the oxygens, and FIA (Fig. S17.A), which shows that para substituents have the most significant effect on FIA. Steric parameters, such as the torsional angle Otor or Sterimol parameters, poorly correlate with FIA. We then selected twelve uncorrelated features through hierarchical clustering (Fig. S18A). Using again the linear model (Fig. S17B) and a permutation importance algorithm (Fig. S18B) on a Gradient Boosting regressor, we identified the Hammett \u03c3 constants as the most significant parameters, \u03c3\u03c1 (p for para) being slightly more important than \u03c3m (mfor meta), with a lower contribution of parameters characterizing the electronic demand of the ortho substituent. This observation is consistent with the correlations with FIA (Fig. S17.A).\nThese methods help identify which aromatic positions to prioritize when designing an ONO compound with a specific Lewis acidity, namely here, the para position. However, they do not inform on the electronic demand of the substituent or the interactions between substituents at different positions. We used decision trees to understand the decision criteria for predicting FIA. We thus categorized FIA into six classes based on the ONO chemical space distribution (Extended Data Fig. 1.A), turning the original regression task into a classification problem. To simplify the analysis and the resulting tree structure, we focused on four Hammett-extended features capturing steric and electronic effects of ortho, meta, and para substituents. We included the partial charge of the oxygen atom of the C=O bond of benzoic acid (NBO=0) for each position (ortho: o, para: p, meta: m), as the Sigman group showed that these parameters could effectively replace the empirical \u03c3 constants, 48 plus Lo, the bond length between the ortho substituent and the aromatic ring, to account for steric effects at the ortho position. The root node of the decision tree shows that the NBO=0 charge for the para substituent is the critical criterion for classifying LA as good, strong or super if it exceeds -0.59e, - a threshold distinguishing mesomeric electron-withdrawing groups (such as CN and NO2) from others (see Table S6); otherwise, it is classified as medium. Subsequent nodes evaluate the ortho and meta substituents for majority-medium and majority-good classes, respectively. The obtained tree diagram is depicted in Fig. 4, translated into chemical terms based on the feature thresholds from the original Scikit-learn49 tree (see Fig. S19).\nIn summary, the tree structure shows that adding or not a mesomeric electron-withdrawing group at the para position of an ONO molecule already determines the accessible range of FIA (Fig. 4). Then, the substituents at the ortho and meta positions must be examined to refine the targeted FIA value. To confirm these results, we need more data for statistical analyses on the diverse substituents. For that, we have used the oracle previously developed (see Methods, oracle development) to screen the entire ONO chemical space and provide precise FIA values to enrich our database."}, {"title": "Chemometrics on ONO chemical space", "content": "Using the criterion set for the root node of the tree in Fig. 4, we compared the FIA distributions for ONO molecules with a mesomeric electron-withdrawing group in the para position to those without. The chemical space is effectively separated as shown by the weakly overlapping violin plots representing FIA distributions (.A). We then divided the dataset of molecules possessing a mesomeric electron-withdrawing group in para by their ortho group (Fig. 5.B). As these distributions are still broad, merely fixing the ortho group while maintaining a para mesomeric electron-withdrawing group fails to standardize the FIA. However, putting the same substituent at both the meta and ortho positions yields a single possible molecule, thus with a fixed FIA value. Varying the same substituent in both the ortho and meta positions, while keeping a mesomeric electron-withdrawing group in para, enables exploration of the full range of FIA values (from 400 to 600 kJ.mol\u00b9) for the ONO scaffold (spread of ONO FIA distribution, Extended Data Fig. 1.A).\nThis analysis suggests that if an organic chemist needs a compound within a specific FIA range, say 450 to 500 kJ.mol\u00b9, a practical approach using the ONO structure might involve adding a mesomeric electron-withdrawing group in para and halogens (such as -F, -Br, or -CI) in ortho and meta positions, although synthetic challenges should be considered when implementing this strategy."}, {"title": "Discussion", "content": "ML has proven highly effective in predicting Lewis acidity via FIA regression models. Advanced techniques like GNN, trained on extensive datasets of tens of thousands of molecules, 36 achieve MAE levels of 14 kJ.mol\u00b9,\nenabling rapid reactivity assessment without costly ab initio calculations. However, these models require substantial computational resources, which are unaffordable for many experimental labs, but also extensive data, which is challenging to acquire in chemistry considering data scarcity, heterogeneity, and cost. Nonetheless, effective simple models can be developed in low-data regime by constraining the chemical space and ensuring a normally-distributed target in the training set. We have successfully developed such a high-performing oracle, achieving a MAE of less than 6 kJ.mol\u00af\u00b9 (i.e., less than 2% error on average). Moreover, while simple classical ML models may be less versatile than DL models, they can be adapted to extrapolate across different chemical spaces through careful feature selection. DL models continue to serve as powerful tools for predicting quantities with profoundly nonlinear relationships with the features. However, in the case of FIA, we have demonstrated that linear models based on physically meaningful descriptors perform exceptionally well, suggesting a linear relationship between FIA and molecular parameters.\nApart from their simplicity, linear models and decision trees, that use chemical features in a way that resembles chemical thought, are also more interpretable than \"black-box\" DL models. Models that can learn and represent genuine chemical concepts are essential for integration into a broader scientific approach: building models, making predictions, interpreting results for deeper understanding, and eventually refining the models. Developing such ML approaches grounded in physical reality remains a challenge in chemistry. 21\nIn this study, we leveraged explainable ML in two key ways. We employed quantum descriptors based on electronic structure parameters and revealed that the reactivity of the studied boron Lewis acids is governed by molecular orbital interactions, classifying them as soft Lewis acids. However, these quantum descriptors are not readily actionable for molecular design. To address this, we introduced \"Hammett-extended\" descriptors, which focus on the nature and positioning of substituents. Interpretations from these models align with the XAI attributes identified by Wellawatte et al. 25 They are actionable and succinct, and, as they align with the language and concepts of organic chemistry, they are domain applicable. These explanations are also correct, corresponding to the expected electronic demand of a substituent at a given position. By interpreting models based on these descriptors, we unraveled the interdependent effects of substituents and identified design rules for creating novel ONO compounds with targeted Lewis acidity.\nHere, our aim was to provide a route for the design of novel organic compounds, bridging the gap between pure ML techniques and traditional intuition-based strategies in organic chemistry. While our focus was centered on Lewis acidity, this methodology holds promise for exploring other types of reactivity, provided relevant parameters can be readily accessed (either computationally or experimentally) to construct a relevant dataset."}, {"title": "Methods", "content": "To construct a database of boron Lewis acids, a robust metric for quantifying Lewis acidity was essential The chosen metric needed to be readily accessible to facilitate the fast labeling of molecules, while also ensuring consistency, as noisy datasets can hinder the learning process and potentially lead to overfitting. 50 Several metrics were evaluated and benchmarked with conventional scales employed in experimental organic chemistry to determine Lewis acidity (SI, section S1). FIA, representing the standard negative enthalpy change associated with the binding of a fluoride ion to the Lewis acid in the gas phase, was retained as the most relevant, consistent and accessible quantity as it is a computed metric. Various cost-effective ab initio methods were evaluated to compute FIA ensuring alignment with values computed at a higher level of theory 47 (SI, section S2). We used density functional theory (DFT) at the M062X/6-31G(d) level of theory in isodesmic calculations as a compromise between efficiency and precision to provide reliable FIA data. Throughout this manuscript, FIA has been used as a proxy for Lewis acidity. Therefore, any conclusions drawn about FIA also apply to Lewis acidity, and the terms have been used equivalently."}, {"title": "Lewis acidity metric", "content": "To construct a database of boron Lewis acids, a robust metric for quantifying Lewis acidity was essential The chosen metric needed to be readily accessible to facilitate the fast labeling of molecules, while also ensuring consistency, as noisy datasets can hinder the learning process and potentially lead to overfitting. 50 Several metrics were evaluated and benchmarked with conventional scales employed in experimental organic chemistry to determine Lewis acidity (SI, section S1). FIA, representing the standard negative enthalpy change associated with the binding of a fluoride ion to the Lewis acid in the gas phase, was retained as the most relevant, consistent and accessible quantity as it is a computed metric. Various cost-effective ab initio methods were evaluated to compute FIA ensuring alignment with values computed at a higher level of theory 47 (SI, section S2). We used density functional theory (DFT) at the M062X/6-31G(d) level of theory in isodesmic calculations as a compromise between efficiency and precision to provide reliable FIA data. Throughout this manuscript, FIA has been used as a proxy for Lewis acidity. Therefore, any conclusions drawn about FIA also apply to Lewis acidity, and the terms have been used equivalently."}, {"title": "Dataset construction", "content": "Datasets of the four molecular scaffolds were initially created by randomly substituting the well-defined aromatic positions with the 13 substituents listed in Fig. 1, prioritizing hydrogen atoms over other functional groups. This approach was intended to primarily examine the impact of having only one or two non-hydrogen substituents but resulted in an overrepresentation of molecules featuring one or two substituents (clusters in Extended Data Fig. 1.B, ONO dataset). To enhance diversity and representativeness of the chemical space for model development on the ONO and triarylboranes scaffolds, the datasets were expanded to their final number of molecules (272 and 186, respectively). This expansion utilized K-means51 and coverage 52 algorithms applied to molecular fingerprint representations, to uniformly cover the chemical space of the two molecular scaffolds (Extended Data Fig. 1.B, additional details in SI, section S3). The OCO and NNN datasets were not expanded and contain 61 and 80 molecules respectively.\nFIA values were computed for each molecule and compiled into tables where molecules are represented as SMILES53 strings. Outliers were detected plotting the distribution of FIA values and conducting PCA on quantum descriptors. These outliers were then eliminated from the database."}, {"title": "Molecular descriptors", "content": "We used the extended connectivity Morgan Fingerprints54 and RDKit descriptors. 55,56 Fingerprints are 1024 bit-vectors emphasizing molecular connectivity and fragment diversity. RDKit descriptors provide structural and property-based features, including fragment counts, minimum and maximum absolute partial charges, molecular weight, and other QSAR descriptors (208 features in total)."}, {"title": "Chemo-informatics descriptors", "content": "We used the extended connectivity Morgan Fingerprints54 and RDKit descriptors. 55,56 Fingerprints are 1024 bit-vectors emphasizing molecular connectivity and fragment diversity. RDKit descriptors provide structural and property-based features, including fragment counts, minimum and maximum absolute partial charges, molecular weight, and other QSAR descriptors (208 features in total)."}, {"title": "Quantum descriptors", "content": "Quantum features for each molecule were derived from the DFT calculation performed for FIA computation, using the Auto-QChem workflow developed by the Doyle Group. This enabled efficient extraction of precise and physically meaningful features (amounting to 43), including global molecular properties (e.g., frontier orbitals energies) as well as local atomic properties for the boron atom only (e.g., partial charge). In spite of requiring more computational resources to compute, these descriptors offer reliable insights into the relationship between the quantum features of molecules and their Lewis acidity (Results, Interpretability section). Although relatively interpretable, these descriptors present challenges in establishing clear causal relationships between specific features, like the population of Rydberg orbitals, and FIA. Moreover, quantum parameters are not directly manipulable by organic chemists for designing molecules, which is why we introduced Hammett-extended descriptors."}, {"title": "Hammett-extended descriptors", "content": "The typical strategy in organic chemistry involves altering molecular structures by substituting various functional groups, which play a significant role in modulating Lewis acidity when the ligand scaffold is unchanged. To better understand this influence, particularly the electronic effects of substituents, we used substituent-based molecular descriptors. This method builds upon the foundational work of Hammett, 10 who derived the substituent constants \u03c3m and \u03c3p, for the meta and para substituents respectively, establishing the groundwork for what would become a pioneering approach to QSAR. However, Hammett constants are limited to meta and para substituents on aromatic rings, as ortho substituents complicate the analysis by introducing both electronic and steric effects. 48 Indeed, when considering only meta- and para-substituted molecules from the triarylboranes dataset, the trend of FIA follows a linear relationship with \u03c3m and \u03c3\u03c1 (FIA = 243 \u03c3m + 91 \u03c3\u03c1 + 351, determination coefficient R2 = 0.91) (see Fig. S9.A). Conversely, when considering also the triarylboranes possessing a substituent on the ortho position, the linear relationship is compromised (Fig. S9.B, R2 = 0.63), and this effect is intensified when considering other molecular scaffolds such as ONO (R2 = 0.54), for which the labeling of ortho, meta and para substituents is less clear. To address this issue, we implemented \"Hammett-extended descriptors\", as proposed by Sigman et al. 48 Additionally to \u03c3m and \u03c3p, these descriptors encompass computationally derived steric and electronic parameters for substituents across all three aryl positions (ortho, meta, and para) of benzoic acid. They include infrared (IR) carbonyl stretching (Vc=0) and COH bending (VCOH) frequencies and intensities, natural bond orbital (NBO) charges of each atom in the carboxylic acid moiety,"}, {"title": "Dataset splitting", "content": "To address the low-data regime, stratified sampling was used to split the dataset into training and testing sets, preserving the FIA distribution across both (SI, section S5). Classes defined in the Molecular Design - Interpretable ML section for decision tree fitting were used for stratification, ensuring the testing set was representative of the overall FIA population for the ONO scaffold (Fig. S11)."}, {"title": "Constructing ML models", "content": "To address the low-data regime, stratified sampling was used to split the dataset into training and testing sets, preserving the FIA distribution across both (SI, section S5). Classes defined in the Molecular Design - Interpretable ML section for decision tree fitting were used for stratification, ensuring the testing set was representative of the overall FIA population for the ONO scaffold (Fig. S11)."}, {"title": "Model's evaluation", "content": "Data was preprocessed prior to model training. Models were optimized on the training set using grid search and K-fold cross-validation (K-fold CV) algorithms before final evaluation on the testing set. The mean absolute error (MAE) was used as the primary scoring metric, with the determination coefficient R\u00b2 calculated in some cases. For decision tree classifiers developed in part Molecular design \u2013 interpretable ML, accuracy was used as the scoring metric. Additional details on hyperparameters optimization"}]}