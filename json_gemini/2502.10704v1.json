{"title": "OCCLUSION-AWARE NON-RIGID POINT CLOUD REGISTRATION VIA UNSUPERVISED NEURAL DEFORMATION CORRENTROPY", "authors": ["Mingyang Zhao", "Gaofeng Meng", "Dong-Ming Yan"], "abstract": "Non-rigid alignment of point clouds is crucial for scene understanding, reconstruction, and various computer vision and robotics tasks. Recent advancements in implicit deformation networks for non-rigid registration have significantly reduced the reliance on large amounts of annotated training data. However, existing state-of-the-art methods still face challenges in handling occlusion scenarios. To address this issue, this paper introduces an innovative unsupervised method called Occlusion-Aware Registration (OAR) for non-rigidly aligning point clouds. The key innovation of our method lies in the utilization of the adaptive correntropy function as a localized similarity measure, enabling us to treat individual points distinctly. In contrast to previous approaches that solely minimize overall deviations between two shapes, we combine unsupervised implicit neural representations with the maximum correntropy criterion to optimize the deformation of un-occluded regions. This effectively avoids collapsed, tearing, and other physically implausible results. Moreover, we present a theoretical analysis and establish the relationship between the maximum correntropy criterion and the commonly used Chamfer distance, highlighting that the correntropy-induced metric can be served as a more universal measure for point cloud analysis. Additionally, we introduce locally linear reconstruction to ensure that regions lacking correspondences between shapes still undergo physically natural deformations. Our method achieves superior or competitive performance compared to existing approaches, particularly when dealing with occluded geometries. We also demonstrate the versatility of our method in challenging tasks such as large deformations, shape interpolation, and shape completion under occlusion disturbances.", "sections": [{"title": "1 INTRODUCTION", "content": "Non-rigid point cloud registration is a critical and challenging problem within the domains of computer vision, robotics, and medical imaging. Its objective is to optimize a deformation field that enables precise alignment between geometric shapes. Due to its fundamental importance, this problem has diverse applications, including reconstructions, generation, and animations."}, {"title": "2 RELATED WORK", "content": "We review the work that is closely related to ours. Readers are referred to  for more comprehensive studies.\nNon-rigid point cloud registration. In contrast to shape matching, which aims to establish correct correspondences, non-rigid point cloud registration focuses on optimizing the deformation field.\nWith the advent of deep learning, neural network-based approaches have also been developed for non-rigid point cloud registration. However, many of these methods rely on neural networks to extract features for point correspondences and subsequently employ classical registration methods like NICP for deformation optimization.\nNeural deformation representation. The representation of deformation fields is a core aspect in non-rigid point cloud registration. Traditional methods often rely on manually defined deformation functions, such as the thin-plate spline and the radial basis function."}, {"title": "3 PRELIMINARIES", "content": "Definition 1. (Cross) correntropy $V$ is a generalized local similarity measure between two arbitrary scalar random variables $X$ and $Y$ defined as\n$V(X,Y) = E_{xy}[k(X,Y)] = \\iint_{xy} k(x,y)p_{xy}(x, y)dxdy$,\nwhich is symmetric, positive, and bounded. Here $k(.,.)$ is a kernel function that satisfies the Mercer theorem, $E$ denotes the expectation operator, and $p_{xy}$ is the joint probability density function over the space $(X, Y)$.\nIn this work, we adopt the translation invariant Gaussian kernel $k_{\\sigma} = exp(-\\frac{||x-y||^2}{2\\sigma^2})$ to define the correntropy. This choice is motivated by the symmetric and positive definite nature of the Gaussian kernel, as well as its property of approaching zero as points move away from the center. Moreover, the kernel bandwidth $\\sigma$ allows flexible control over the decaying factor and enables accurate registrations in the presence of various occlusion. We empirically investigate the influences of $\\sigma$ on deformations in Appendix D.\nDefinition 2. Given the finite number of data points in the sample space, the correntropy-induced similarity metric (i.e., distance function) M between two vectors $x = (x_1,x_2,...,x_n) \\in \\mathbb{R}^n$ and $y = (y_1, y_2, ..., y_n) \\in \\mathbb{R}^n$ is defined as\n$M(x, y) = (k_{\\sigma}(0) - \\frac{1}{n} \\sum_{j=1}^n k_{\\sigma}(x_j - y_j))$.\nIn the machine learning community, for general optimization problems involving the unknown variable, minimizing $M(x, y)$ is equivalent to maximizing the correntropy.\nLemma 1. $M(x, y)$ is equivalent to the $l_2$ metric if $x, y$ are close, behaves similarly to the $l_1$ metric as $x, y$ get apart and approaches the $l_0$ when they are far apart.\nTherefore, Eq. (2) can be utilized as a novel cost function for adaptive training, referred to as the Maximum Correntropy Criterion (MCC). We explore the combination of unsupervised implicit neural representations and the MCC-induced local metric to address occlusion geometries in non-rigid point cloud registration. We also demonstrate the superior performance of our method over previous competing approaches."}, {"title": "4 PROPOSED METHOD", "content": "Problem formulation. Let $X = \\{x_i \\in \\mathbb{R}^3\\}_{i=1}^{M_1}$ and $Y = \\{y_j \\in \\mathbb{R}^3\\}_{j=1}^{M_2}$ denote two input point clouds, where $X$ represents the target shape, possibly with occlusion, and $Y$ is the source shape. Our objective is to solve the optimal non-linear map $T_{\\Theta}$ parameterized by $\\Theta$ to minimize the shape deviation between the transformed source shape $T_{\\Theta}(Y)$ and $X$. Note that we also aim to preserve the physical plausibility of the deformation $T_{\\Theta}$ regarding $Y$, ensuring that issues encountered in previous approaches, such as collapsing or tearing of the geometric shape, are avoided."}, {"title": "4.1 NEURAL DEFORMATION CORRENTROPY", "content": "Motivation. Unlike previous approaches that directly minimize the overall difference between two shapes, we leverage the advantage of local similarity induced by correntropy. This allows us to adaptively differentiate between various parts of a shape, ensuring that occluded regions have minimal influence on the deformation process.\nCorrentropy-induced metric. We utilize the unsupervised neural presentations defined by a set of network parameters $\\Theta$ to implicitly parameterize the non-linear map T. Based on MCC, our goal is to optimize the subsequent metric between $X = \\{x_i \\in \\mathbb{R}^3\\}_{i=1}^{M_1}$ and $Y = \\{y_j \\in \\mathbb{R}^3\\}_{j=1}^{N}$:\n$\\min_{\\Theta} L(\\Theta) = E(M(x_i, \\tilde{y}_i)) + E(M(T_{\\Theta}(y_j), \\tilde{x}_j))$,\nwhere $\\tilde{y}_i = \\min_{y_j \\in T(Y)} ||x_i - T_{\\Theta}(y_j)||_2$, $\\tilde{x}_j = \\min_{x_i \\in X} ||T_{\\Theta}(y_j) - x_i||_2$. As a result, Eq. (3) assigns adaptive importance during network training, i.e., giving significant importance to points with corresponding parts, while penalizing deformations in occluded regions. As demonstrated in subsequent experiments, our method effectively avoids physically implausible limitations, leading to more accurate and reasonable deformations.\nRelationship to Chamfer distance. We further analyze the relationship between the maximum correntropy criterion and the Chamfer distance. Unlike CD that performs a holistic evaluation, MCC is a local and adaptive similarity metric. Based on Lemma 1, we can draw the following conclusion.\nProposition 1. The Chamfer distance is a special case of Eq. (3), applicable only when both the source and target point clouds X and Y are complete and sufficiently close to each other. However, this equivalence does not hold when either of the inputs X and Y is occluded.\nTherefore, the correntropy-induced metric can serve as a more universal measure, potentially applicable to a wider range of point cloud analysis tasks."}, {"title": "4.2 LOCALLY LINEAR RECONSTRUCTION", "content": "Neural deformation correntropy ensures physically plausible deformations for unoccluded parts through a local measure. However, addressing the challenge of making reasonable deformation of parts in the source shape that lack correspondence in the target shape remains highly ill-posed. To tackle this, we propose incorporating a geometric prior by modeling the deformation field of occluded parts through Locally Linear Reconstruction (LLR), which transforms the unconstrained problem into a constrained non-linear optimization. This allows us not only maintaining a smooth and coherent deformation field for unoccluded parts but also ensuring physically plausible results for parts that lack correspondence.\nInspired by the principle of locally linear embedding in nonlinear spectral dimensionality reduction, we develop a novel method to preserve the linear pattern of the local geometric structure and reconstruct each point in the deformation space, especially for points that lack correspondences, by utilizing its neighboring structure. Concretely, for each source point $Y_j \\in \\mathbb{R}^3$ in $Y$, we formulate the locally linear reconstruction process as the subsequent optimization problem:\n$\\min_{w_j} L(w_j) = \\frac{1}{2} ||y_j - Z_j w_j||_2^2 = \\frac{1}{2} ||G_j w_j||_2^2, \\ \\ \\ s.t. \\ w_j^T 1_k = 1,$\nwhere $w_j = [w_{j1}, w_{j2},..., w_{jk}]^T \\in \\mathbb{R}^k$ is the set of unknown weight factors, $Z_j = [z_{j1}, z_{j2},..., z_{jk}] \\in \\mathbb{R}^{3 \\times k}$ is the k-nearest neighbors of $y_j$ (the investigation of the influences of k on deformations is presented in Appendix D), $G_j = (y_{j1} - Z_j)^T (y_{j1}^T - Z_j) \\in \\mathbb{R}^{k \\times k}$ is the Gram matrix, $1_k \\in \\mathbb{R}^k$ is the k-dimensional vector of all ones, and $T$ represents the matrix transpose operator.\nEq. (4) is a constrained non-linear least-squares regression problem, utilizing the Lagrange multiplier, we obtain the closed-form solution of $w_j$ for each $y_j$ (derivations are presented in Appendix B)\n$w_j = \\lambda_j G_j^{-1} 1_k = \\frac{G_j^{-1} 1_k}{1_k^T G_j^{-1} 1_k}$"}, {"title": "LLR regularization", "content": "Once obtaining the weight vectors $\\{w_j \\in \\mathbb{R}^k\\}_{j=1}^{N}$ for each $y_j \\in Y$, we keep them fixed. Then, we utilize these weight vectors to regularize the displacement field, aiming to promote its smoothness and ensure physical plausibility in the deformation space throughout the entire optimization process even without correspondences, i.e.,\n$R(\\Theta) = \\sum_{j=1}^N ||T_{\\Theta} (y_j) - T_{\\Theta} (Z_j) w_j||_2$\nGeometric meaning of LLR. Unlike rigid registration, where each point shares the same spatial transformation (i.e., rotation and translation), non-rigid deformation requires solving for each point\u2019s individual displacement. In challenging occlusion scenarios, Eq. (7) demonstrates that the deformation of occluded parts can be inferred from, or propagated through, the deformations of neighboring points via locally linear reconstruction."}, {"title": "4.3 UNSUPERVISED OPTIMIZATION", "content": "Given the active research and powerful fitting ability of implicit neural representations across various domains, we adopt a coordinate-based MLP with periodic activations as our deformation network $T$. Our objective is to optimize a set of network parameters $\\Theta$ to define the deformation space. Additionally, as a test-time optimization method, our method is unsupervised, requiring no data annotations. The neural network is composed of three hidden layers, each consisting of 128 neurons. We obtain the optimal neural network parameters $\\Theta^*$ by optimizing the following cost function with automatic differentiation:\n$\\Theta^* = arg \\min_{\\Theta} F(\\Theta) = \\alpha_1 L(\\Theta) + \\alpha_2 R(\\Theta)$,\nwhere $\\alpha_1, \\alpha_2 \\in \\mathbb{R}^+$ are trade-off factors. Finally, the resulting deformed point cloud $T_{\\Theta^*}(Y)$ is obtained by applying the learned deformation network $T_{\\Theta^*}$ to the source model $Y$."}, {"title": "5 EXPERIMENTAL RESULTS", "content": "We conduct comprehensive experiments to validate the performance of our method and compare it with state-of-the-art approaches in both occluded and complete settings. Additionally, we showcase the versatility of our method by applying it to shape interpolation and shape completion tasks.\nImplementation details. Our method is implemented using the PyTorch framework, and we employ the Adam optimizer with default settings $\\beta_1 = 0.9$, $\\beta_2 = 0.999$, and $\\epsilon = 10^{-8}$ to optimize the objective function defined in Eq. (8). The initial learning rate is set to lr = 1e-4, and the network is trained for 200 epochs with a batch size of 1. To dynamically update the learning rate, we utilize the ReduceLROnPlateau technique with a patience value of 1. During optimization, we fix $\\alpha_1 = 10^4$ and $\\alpha_2 = 10^2$, which yield appealing results across various scenarios. All experiments are conducted on a machine equipped with an NVIDIA A30 GPU and an Intel(R) Xeon(R) Gold 6248R CPU @ 3.00GHz. We utilize publicly available implementations of baseline approaches for evaluation, with their parameters either fine-tuned by ourselves or suggested by the authors to obtain their best results."}, {"title": "5.1 COMPARISONS", "content": "We first assess the proposed algorithm on occlusion scenarios using the silico liver dataset from Open-CAS. Open-CAS is an open collection of datasets specifically designed for validating computer-assisted surgery systems. The silico liver dataset consists of three pairs of liver models that have undergone deformation using a non-linear biomechanical model. Each pair, as illustrated in Fig. 1, consists of a source complete liver model and a target occluded liver model, along with its corresponding ground truth complete model. These pairs represent the pre-operative and intra-operative shapes, respectively. We adopt state-of-the-art approaches for comparison, including both traditional optimization-based methods GBCPD, AMM_NRR as well as neural network-based competitors NSFP, NDP, and DPF.\nThe quantitative comparison results presented in Tab. 1 demonstrate that our method consistently outperforms competing approaches with higher registration accuracy across all livers, indicating its robustness and stability to align the geometric shapes under occlusion disturbances. Notably, our method achieves the highest AccS and AccR values in all tests, surpassing competitors by a significant margin. Additionally, our method delivers the lowest EPE values among all approaches and maintains a zero outlier ratio in all tests. These achievements highlight the success of our method in avoiding significant registration errors such as collapses and tearing, thereby ensuring a high level of accuracy. The qualitative comparison presented in Fig. 1 further illustrates the advantage of our method in preserving detailed physical structures such as the blood vessel of the source liver."}, {"title": "5.2 REGISTRATION UNDER DIFFERENT TYPES OF OCCLUSION", "content": "To further investigate the performance of our proposed method in handling occlusion, we create three occlusion datasets using three different shapes (cat, horse, and dog) from the TOSCA dataset. Each dataset consists of five types of occlusion, such as the occlusion present in the body of the cat and the tail of the dog, as shown in Fig. 3. We exclude the outlier ratio from our analysis since the deformation solution is not unique in these cases. Additionally, we exclude AMM_NRR from our analysis due to its significant deviations from the target poses, which render the error metrics unreliable. The average metrics of all tests are reported in Tab. 2. The results indicate that our method still achieves the highest registration accuracy across different occlusion scenarios, especially in terms of the AccR metric. Although our method is slightly slower than other neural networks-based approaches, it is much faster than traditional optimization-based GBCPD."}, {"title": "5.3 REGISTRATION WITH CORRESPONDENCE", "content": "In addition to handling occlusion scenarios, we also demonstrate the capability of the proposed method for general large deformation registration tasks. To this end, we combine the pre-trained geometric feature descriptor Lepard with our method for non-rigid registration on the 4DMatch and 4DLoMatch animation benchmark datasets (details are presented in Appendix Appendix I). These datasets are collected from the DeformingThings4D sequence, which contains challenging scenarios with partial overlap, occlusion, and large motions. The 4DMatch dataset comprises point clouds with overlap ratios ranging from 45% to 92%, while the 4DLoMatch dataset exhibits lower overlap ratios of 15% - 45%. Following, we adopt the filtered dataset that has undergone the removal of near-rigid transformations for testing. Specifically, the 4DMatch dataset consists of 2,590 pairs of test, while the 4DLoMatch dataset contains 1,175 pairs.\nTab. 3 summarizes the quantitative comparison results, with the exception of our method, where the remaining results are taken from. It is important to note that all supervised models are re-trained on 4DMatch's training split prior to evaluation. Although our method is unsupervised, it still consistently achieves superior or competitive results compared to the competitors, particularly in terms of the two most important metrics, AccS and AccR. Moreover, it is worth noting that our method also delivers competitive performance on the highly challenging 4DLoMatch dataset even without any fine-tuning."}, {"title": "5.4 HUMAN REGISTRATION ON OCCLUDED DEPTH VIEWS", "content": "We further evaluate the proposed method for registering human point clouds captured from RGB-D cameras, which can be used for non-rigid reconstruction. As shown in Fig. 16, the sequences from exhibit occlusion disturbances due to human motion. The qualitative results presented in Fig. 17 evidence that our method still achieves high-quality deformations despite these challenges. In contrast to DPF, which produces physically unreasonable deformations such as collapse and distortion of body parts, our method consistently preserves realistic deformations, particularly evident in the human hands and arms."}, {"title": "5.5 ROBUSTNESS TEST", "content": "We also assess the robustness of our developed method against noise and outlier disturbances. To this end, we introduce Gaussian noise with increasing intensity and varying outlier ratios (%) to the point clouds. The inset table reports the statistical results, while Fig. 19 and Fig. 20 present the qualitative outcomes. As observed, our method demonstrates strong resilience against both noise and outliers, maintaining performance even with noise levels up to 0.6% and in the contamination of 2, 350 outliers."}, {"title": "5.6 ABLATION STUDY", "content": "The effect of LLR. To demonstrate the effect of the proposed LLR for non-rigid point cloud registration under occlusion disturbances, we construct a series of models with progressively increasing levels of occlusion. In Fig. 4, we illustrate this by manually removing some parts of the lion model, starting from the tail and extending towards the body. The statistical results in Fig. 5 indicate that our method equipped with the LLR constraint (i.e., MCC+LLR), which helps preserve the local neighboring geometry, consistently produces higher-quality registration results compared to the single MCC framework.\nAIAP VS. LLR. We also compare the performance of the commonly used AIAP regularization with the proposed LLR in handling challenging occlusion scenarios. As observed in Fig. 5, MCC+AIAP delivers similar results to MCC, while MCC+LLR consistently outperforms MCC+AIAP across different levels of occlusion. Moreover, benefiting from the reconstruction scheme and maintaining the local structure, LLR excels at preserving essential geometric details,"}, {"title": "5.7 APPLICATIONS", "content": "Shape interpolation. Since our method successfully avoids physically implausible scenarios, such as collapses and tearing, and employs an unsupervised neural implicit representation, it inherently allows for continuous deformation. In Fig. 6, we illustrate the shape interpolation effect using our non-rigid deformation under occlusion, where we vary the timestamp t within the range of [0.1, 1.0]. For instance, the interpolation shape with t = 0.5 is represented by $Y_{t=0.5} = Y + t * v(Y) = Y + 0.5 * v(Y)$ with $v$ denoting the learned displacement field. As observed, our method not only achieves accurate registration at t = 1.0 but also maintains substantially smooth and physically feasible interpolation configurations throughout the entire deformation process.\nShape completion. We also apply our method to address the problem of shape completion. In Fig. 7, we utilize the source mesh model as the standard template, while the other shapes exhibit various types of holes caused by occlusion, serving as the targets. It is evident that by deforming the template model to align with the target shapes and leveraging the highly accurate outcomes, our method offers a feasible solution to the ill-posed mesh hole filling task without requiring any additional annotations and constraints."}, {"title": "6 CONCLUSIONS", "content": "We introduced a novel unsupervised solution to address the challenging issue of occlusion disturbances in non-rigid point cloud registration, a problem that has not received adequate attention in prior approaches. We provide a comprehensive analysis to elucidate the reasons why previous methods struggle with occlusion scenarios. The first contribution of our method is maximizing the local similarity between source and target geometries, accomplished through the utilization of the adaptive maximization correntropy criterion. We also establish a connection between the correntropy-induced metric and the commonly used Chamfer distance, highlighting that this correntropy-induced metric can serve as a more general measure. Additionally, we develop a locally linear reconstruction paradigm to ensure that deformations in the occluded regions are physically plausible while preserving intricate geometric details of deformed shapes, in contrast to the commonly used AIAP metric. Our method achieves higher-quality non-rigid registration results across a range of datasets, while effectively mitigating the issues of collapses and tearing that are encountered in previous approaches. Moreover, our method ensures continuous deformation, allowing for promising applications in shape interpolation and shape completion tasks."}, {"title": "APPENDIX", "content": "In this appendix, we provide additional content to support our paper. Concretely, we present the data pre-processing step of normalization and the definition of used evaluation metrics in Appendix A, followed by the theoretical derivation of the closed-form weight solution in Appendix B. Appendix C presents more details and analyses of Lemma 1. Appendix D investigates the influences of the number of nearest neighbors k for each $y_j \\in Y$ and the kernel bandwidth $\\sigma^2$ on registration under occlusion disturbances. We present further ablation studies to investigate the regularization effect of implicit neural networks and activation functions in Appendix E. The differences and connections of MCC with robust functions are presented in Appendix F. Additional ablation studies of MCC and Chamfer distance as well as its variants are reported in Appendix G and Appendix H, separately. Appendix I gives the details of how to integrate the geometric descriptors with our proposed optimization framework. Then, we discuss the limitations and future work of the proposed algorithm in Appendix J. Finally, in Appendix K, we present more quantitative and qualitative results. These results include the registration on various types of occlusion from the TOSCA dataset, liver dataset, 4DMatch and 4DLoMatch datasets, shape completion for the challenging mesh hole filling task, human RGB-D views, failure cases, as well as robustness test."}, {"title": "A DATA PRE-PROCESSING AND THE METRIC DEFINITION", "content": "Given a pair of input point clouds $X = \\{x_i \\in \\mathbb{R}^3\\}_{i=1}^{M_1}$ and $Y = \\{y_j \\in \\mathbb{R}^3\\}_{j=1}^{M_2}$, where X and Y represent the target and source point clouds, separately, we first normalize them to follow a normal distribution, i.e.,\n$N(X) = (X - 1_M \\mu_X)/\\sigma_X,$\n$N(Y) = (Y - 1_N \\mu_Y)/\\sigma_Y,$\nwhere $\\mu_* \\in \\mathbb{R}^3$ represents the mean point in the set of * and $\\sigma_* \\in \\mathbb{R}^+$ is the farthest Euclidean distance from $\\mu$ to the elements in *. $1_M \\in \\mathbb{R}^M$ and $1_N \\in \\mathbb{R}^N$ are the vectors of all ones. However, when evaluating the registration results, we still use the original inputs by first performing denormalization.\nSpecifically, we compute the deviations between the deformed shape $\\hat{Y} = \\sigma_X T(N(Y)) + 1_M \\mu_X$ and the complete shape $X$ of X in terms of the metrics EnE, AccS, AccR, and Outlier Ratio by\n$EPE(\\hat{Y}, X) = \\frac{1}{N} Tr\\{(\\hat{Y} - X)^T (\\hat{Y} - X)\\}$,\n$AccS(\\hat{Y}, X) = \\frac{1}{N} \\sum_{j=1}^N I(||\\hat{Y}_j - X_j||_2 < 0.025) \\times 100\\%,$\n$AccR(\\hat{Y}, X) = \\frac{1}{N} \\sum_{j=1}^N I(||\\hat{Y}_j - X_j||_2 < 0.05) \\times 100\\%,$\n$Outlier(\\hat{Y}, X) = \\frac{1}{N} \\sum_{j=1}^N I(||\\hat{Y}_j - X_j||_2 > 0.3) \\times 100\\%,$\nwhere $Tr$ and $^T$ are the trace operator and transpose operator of a matrix, separately. I is the indicator function and $|| \\cdot ||_2$ represents the Euclidean distance."}, {"title": "B DERIVATION OF THE CLOSED-FORM SOLUTION IN EQ. (5) OF THE PAPER", "content": "To make the proposed method self-contained, we present the derivation of the closed-form solution in Eq. (5) as follows. According to the Lagrange multiplier, we have\n$\\mathcal{L}(w_j, \\lambda_j) = \\frac{1}{2} w_j^T G_j w_j - \\lambda_j (w_j^T 1_k - 1)."}, {"title": "C MORE DETAILS AND ANALYSES OF LEMMA 1", "content": "We present more details of Lemma 1. We can rewrite the correntropy of Gaussian kernel as\n$V_{\\sigma}(X,Y) = \\frac{1}{\\sqrt{2\\pi\\sigma}} \\sum_{n=0}^{\\infty} ((-1)^n) / (2^n n!) E [((X - Y)^{2n}) / (\\sigma^{2n})]$,\nwhich involves all the even moments of the random variable X \u2013 Y. When two points are in close proximity, the second-order moment tends to be dominant, causing correntropy to approach correlation, as the higher-order moments decay more rapidly. As the points become more distant, as shown in , correntropy transitions from behaving like an l1 norm to resembling an l0 norm. This transition further illustrates the inherent robustness of the MCC metric."}, {"title": "D INVESTIGATION OF k AND \u03c3\u00b2 ON DEFORMATION", "content": "We adopt the occluded liver 1 dataset (ope) and vary the number of neighbors $k \\in [2, 30]$ with $\\Delta k = 2$ and $\\sigma^2 \\in [0.2, 2]$ with $\\Delta \\sigma^2 = 0.2$ to investigate their influences on non-rigid registration under occlusion disturbances. As shown in Fig. 8, our method consistently achieves significantly lower outlier ratios across different values of k and \u03c3\u00b2. With increasing values of k, our method not only demonstrates higher AccS and AccR results but also with slower EPE. Nevertheless, larger values of k typically result in higher computational complexity due to the matrix inverse operation in Eq. (5) of the paper. Therefore, we suggest setting k = 30 for general use. Regarding \u03c3\u00b2, we suggest using \u03c3\u00b2 = 1.0 for general applications as its variation has a minimal impact on the results."}, {"title": "E ANALYSIS OF THE REGULARIZATION", "content": "Fig. 5 reveals that regularizing the deformation field of occluded regions is mainly from LLR rather than the network. This is because a network alone is insufficient to handle occlusions effectively, often resulting in significant deviations. We conduct additional ablation studies on the OpenCAS dataset to investigate the role of activation functions (i.e., ReLU and SIREN) with the LLR for regularization. The results presented in Tab. 4 reveal that the regularization of deformations in occluded areas is primarily attributed to LLR rather than the activation function, as ReLU+CD and ReLU+MCC still generate significant deformation errors, especially for both the EPE and Outlier metrics.\nMoreover, to investigate the intrinsic regularization capabilities of activation functions, we conduct an additional experiment by applying recursive deformations to complete shapes without occlusion. The EPE metric detailed in Tab. 5 demonstrates that ReLU and SIREN exhibit comparable performance on complete shapes. This finding further substantiates our conclusion that while activation functions do possess a regularization effect, they may fall short when addressing the complexities of challenging occlusions (i.e., the motivation and core contributions of this work). In such cases, LLR proves to be particularly beneficial."}, {"title": "F DIFFERENCES AND CONNECTIONS WITH ROBUST FUNCTIONS", "content": "Moreover, we conduct an in-depth analysis comparing correntropy with robust functions.\nDifferences. Unlike common robust functions, correntropy is initially proposed in information-theoretic learning to handle nonzero mean and non-Gaussian noise (e.g., the occlusion part can be seen as a certain type of non-Gaussian noise), which is related to the Renyi's quadratic entropy. Besides, MCC is a local measure that provides a probabilistic meaning of maximizing the error probability density at the origin according to the information potential.\nConnections. We derive the relationship between MCC and robust functions. By setting $\\rho(e) = (1 - \\exp (-e^2/2\\sigma^2)) /\\sqrt{2\\pi\\sigma}$, we can prove that $\\rho(e)$ is an influence function satisfying all the criteria of a robust function, i.e.,\n$\\rho(e) \\geq 0, \\rho(0) = 0, \\rho(e) = \\rho(-e),$\n$\\rho(e_i) \\geq \\rho (e_j) for|e_i| > |e_j|$."}, {"title": "GABLATION STUDY OF MCC AND THE CHAMFER DISTANCE", "content": "Additionally, we conduct additional ablation experiments to replace MCC with CD on a series of models used in Fig. 5, testing them with progressively increasing levels of occlusion (0-5). The quantitative comparison results in Fig. 9 demonstrates that MCC consistently achieves higher-quality deformation results, particularly with significantly high AccS and AccR metrics. Moreover, we provide a detailed comparison of the time consumption of both the Chamfer Distance and MCC in Tab. 6, measured in seconds. As observed, MCC also achieves significantly high efficiency with the computation time around 1 millisecond for a dataset comprising around 104 points."}, {"title": "H FURTHER COMPARISON WITH OTHER CD VARIANTS", "content": "To further demonstrate the advantages and versatility of the MCC metric, we conduct additional experiments to evaluate MCC against the most recent or state-of-the-art Hyperbolic Chamfer Distance (HCD) in point cloud completion. We use the author's source code to implement the HCD metric. Particularly, we adopt three distinct tests by adjusting the coefficient a within the HCD framework to achieve comprehensive results. The quantitative results reported in Tab. 7 demonstrate that our proposed method consistently achieves higher-quality deformations. Moreover, MCC shows potential for further exploration and application in general point analysis tasks, including point cloud completion."}, {"title": "I HOW TO INCORPORATE THE GEOMETRIC DESCRIPTOR", "content": "Given the two matching sets S(X) and S(Y) extracted by the pre-trained geometric descriptor Lepard, with |S(X)| = |S(Y)| < min(|X|, |Y|), our optimization function is formally defined as\n$\\Theta^* = arg \\min_{\\Theta} F(\\Theta) + \\beta M(\\Theta),$\nwhere F(\u0398) and M(\u0398) denote the deformation loss and the pointwise matching loss, separately."}, {"title": "J LIMITATIONS AND FUTURE WORK", "content": "While the proposed registration method demonstrates impressive performance on various occlusion disturbances, it is worth noting that the problem itself is highly challenging and severely ill-posed. When the occlusion region is significantly large, the method may yield unsatisfactory results (Fig. 18). However, integrating shape analysis theory, such as the geometric symmetry of models, could potentially mitigate this limitation.\nBesides, the computational complexity of the locally linear reconstruction step is relatively high due to the matrix inverse operation. One possible approach is to explore low-rank approximations of the Gram matrix to further speed up the deformation process.\nAnother future work is to further speed up the computation of the MCC metric. As demonstrated in , a distance transform is utilized to expedite the computation of the Chamfer distance, and in principle, this manner can be extended to the MCC-induced metric as our proposed method also incorporates pairwise computation. However, as the authors noted, we must carefully consider the trade-off between discretization error, grid resolution, memory consumption, and estimation accuracy."}, {"title": "KMORE QUANTITATIVE AND QUALITATIVE RESULTS", "content": "We provide additional results in the following to show the superiority of the proposed method. Specifically,\n1. Fig. 10 to Fig. 11 showcase the test results on the occluded TOSCA dataset, where various occlusion scenarios are present.\n2. Fig. 12 demonstrates the registration results of our proposed method by inversely deforming the occluded geometry to the complete one. It can be seen that our method achieves highly accurate registrations, preserves the original topology of the organs (including their distinct parts), and avoids the generation of physically infeasible parts.\n3. Fig. 13 presents qualitative results on the 4DMatch or 4DLoMatch datasets, where our method performs impressively despite the existence of challenging scenarios such as large deformation, low overlap, and occlusion.\n4. Fig. 14 showcases additional shape completion results by deforming the source model to the shapes with occluded holes. Thanks to the highly accurate registration results, our method provides a viable solution to this challenging mesh hole filling problem.\n5. Fig. 15 further reports the mesh hole filling results where the source or template models also contain holes. The source models are selected from Fig. 7 and Fig. 14, with the middle model in each case serving"}]}