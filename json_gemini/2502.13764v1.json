{"title": "An Overall Real-Time Mechanism for Classification\nand Quality Evaluation of Rice", "authors": ["Wanke Xia", "Ruxin Peng", "Haoqi Chu", "Xinlei Zhu", "Zhiyu Yang", "Yaojun Wang"], "abstract": "Rice is one of the most widely cultivated crops globally and has been developed into numerous\nvarieties. The quality of rice during cultivation is primarily determined by its cultivar and characteristics.\nTraditionally, rice classification and quality assessment rely on manual visual inspection, a process that\nis both time-consuming and prone to errors. However, with advancements in machine vision technology,\nautomating rice classification and quality evaluation based on its cultivar and characteristics has become\nincreasingly feasible, enhancing both accuracy and efficiency. This study proposes a real-time evaluation\nmechanism for comprehensive rice grain assessment, integrating a one-stage object detection approach,\na deep convolutional neural network, and traditional machine learning techniques. The proposed\nframework enables rice variety identification, grain completeness grading, and grain chalkiness\nevaluation. The rice grain dataset used in this study comprises approximately 20,000 images from six\nwidely cultivated rice varieties in China. Experimental results demonstrate that the proposed mechanism\nachieves a mean average precision (mAP) of 99.14% in the object detection task and an accuracy of\n97.89% in the classification task. Furthermore, the framework attains an average accuracy of 97.56% in\ngrain completeness grading within the same rice variety, contributing to an effective quality evaluation\nsystem.", "sections": [{"title": "1. Introduction", "content": "Rice is one of the most important crops worldwide and serves as a staple food for more than half of\nthe global population. Its quality has a significant impact on dietary health. Additionally, the cultivar and\ncharacteristics of rice are key factors influencing its market value and selling price. Therefore, the ability\nto assess rice quality rapidly and accurately is of critical importance. Rice quality is determined by a\nwide range of indicators. For instance, type quality is a fundamental factor in assessing the nutritional\nvalue of rice, while processing quality further influences its market competitiveness based on type quality.\nCurrently, manual sensory evaluation remains the most widely used method for rice quality assessment.\nHowever, this approach is susceptible to variations in lighting conditions, human eyesight, emotions, and\nother subjective factors, leading to slow identification speeds and an inability to meet the demands of\nrapid and objective evaluation.\nAs a widely applied technique in machine vision, deep learning enables automatic classification by\nleveraging large-scale labeled image datasets to train models for object detection and classification,\nthereby enhancing both efficiency and accuracy [1-4]. Moreover, deep learning plays a crucial role in\nquality assessment during rice production, representing a significant future direction for rice\nclassification and identification [5]. However, studies utilizing machine learning algorithms for rice\nidentification remain limited. Furthermore, the direct application of existing deep learning algorithms to"}, {"title": "2. Related Work", "content": "Traditionally, rice classification has been performed using human visual inspection, whereas the\nadoption of machine learning has significantly enhanced efficiency. Key quality indicators of rice include\nthe broken rice rate, impurity rate, chalkiness, and color. Conventional quality evaluation methods rely\non manual measurements using tools such as vernier calipers, which are subjective, time-consuming,\ninefficient, prone to errors, and labor-intensive [6]. Consequently, these methods are not well-suited for\nlong-term quality testing.\nWith the rapid advancement of computer vision technology, machine learning has been increasingly\napplied to agriculture, leading to breakthroughs in crop detection [1,2,7]. Machine learning excels in\nefficiently analyzing and processing data, making it highly valuable for rice quality assessment. Several\nstudies have demonstrated its effectiveness in this field. For example, Moses et al. [8] achieved single-\nclass accuracies of 98.33%, 96.51%, 95.45%, 100%, 100%, 99.26%, and 98.72% for healthy, fully chalky,\nchalky discolored, semi-chalky, broken, discolored, and normal damage classes, respectively, attaining\nan overall classification accuracy of 98.37% using the EfficientNet-B0 architecture. Din et al. [9]\ndeveloped the RiceNet model based on deep convolutional neural networks, using a dataset of over 4,700\nimages to classify five rice varieties, achieving an accuracy of 94%.\nLin et al. [10] proposed a machine vision system based on deep convolutional neural networks\n(DCNN) for rice classification, obtaining an accuracy of 95.5%. Zareiforoush et al. [11] applied heuristic\nclassification methods combined with computer vision to classify four rice types, achieving the highest\nclassification accuracy of 98.72% using an artificial neural network topology. Kurtulmu\u015f et al. [12]\nintroduced a cost-effective method based on computer vision and machine learning, reporting an overall\naccuracy of 99.24% with the best predictive model. Li et al. [13] achieved 96.67% accuracy in\ndistinguishing normal grains from the four most common types of damaged rice grains using computer\nvision and machine learning techniques.\nShi et al. [14] employed near-infrared spectroscopy and partial least squares regression (PLSR) for\nrice quality assessment. Similarly, D\u00edaz et al. [15] utilized machine learning algorithms, including logistic\nregression and support vector machines, to analyze near-infrared spectra, developing a linear model for\nnon-destructive rice taste classification with an accuracy of 94%. Yuan et al. [16] leveraged the YOLOv5s\nmodel to construct the WeedyRice5 object detection framework, integrating the CBAM attention\nmechanism and achieving a mean Average Precision (mAP) of 98.2% at an Intersection over Union (IoU)\nthreshold of 0.5.\nMakmuang et al. [17] applied an artificial neural network (ANN)-based classification method and\nutilized Self-Organizing Maps (SOM) to assess seed quality using hyperspectral imaging (HSI) data,\nobtaining a classification accuracy of 98%. Kang et al. [18] proposed a Multi-Scale Integrated Attention"}, {"title": "3. Materials", "content": "In this study, we primarily collected an image dataset comprising six widely cultivated rice varieties\nin China, with their basic characteristics detailed in Table 1. Phenotypic images of individual rice grains\nwere captured using an industrial camera, and each grain was manually annotated based on its\ncompleteness and chalkiness. The hardware setup for data acquisition included a Sony CMOS sensor\n(providing real-time imaging at 1920\u00d71080P resolution), an AOSVI T2-HD228S body microscope, a\nPhilips monitor, and other peripheral devices. The rice image acquisition process was conducted as\nfollows: First, rice grains were evenly spread on a carrier table with a monochrome background. Next,\noptical parameters were adjusted to obtain clear, high-magnification images, after which the industrial\ncamera was used to capture phenotypic images. Finally, the acquired images underwent manual screening\nand labeling to ensure data quality.\nFollowing this procedure, we collected approximately 20,000 images of Chinese rice grains against\na solid-color background. These images were manually filtered and labeled to construct a dataset for rice\nobject detection and completeness assessment. To enhance the robustness of the model, each rice variety\ndataset included both intact and broken grains in a ratio of approximately 10:1. Additionally, to\ninvestigate the effect of varying optical conditions on rice chalkiness detection, we selected 10 grains\nfrom each rice variety and captured their images under five different lighting environments, yielding a\ntotal of 300 images dedicated to the rice chalkiness experiment."}, {"title": "3.2. Image Processing", "content": "Some of the original rice images exhibited darker coloration, which obscured essential features such\nas translucency, chalkiness, contours, and other visual characteristics necessary for accurate observation.\nTo enhance the visibility of these attributes, this study initially applied grayscale processing to the darker"}, {"title": "3.2.1. Image Processing for One-Stage Mechanism", "content": "rice images. The maximum and minimum pixel values were computed, and each pixel value was\nremapped to a range of 0 to 255 using a lookup table, effectively replacing the original pixel values. This\nprocessing step enhanced the overall clarity, improving contour definition and sharpness, as illustrated\nin Fig. 1. Subsequently, image brightness was adjusted to further emphasize fine details and enhance\ncontrast. Taking Guangdong Simiao rice as an example, the final brightness-adjusted image is shown in\nFig. 2(a), demonstrating a notable improvement in brightness and visibility compared to Fig. 1(a). This\nenhancement facilitates more precise human and computational analysis.\nTo simulate real-world conditions where multiple rice varieties may be intermixed, we employed a\nrandomized mixing approach to construct a test dataset for rice identification. This dataset enables the\nevaluation of model accuracy in classifying rice varieties under practical scenarios.\nIn summary, the grayscale and brightness-adjusted rice images effectively highlight key visual\nfeatures such as grain outline, internal texture, chalkiness, and translucency. These enhancements ensure\nthat the images meet the requirements for classification and recognition tasks, making them suitable as\ninput data for relevant deep learning models."}, {"title": "3.2.2. Image Processing for Completeness Mechanism", "content": "For processing the broken rice image dataset, the same initial procedures outlined in Section 3.2.1\nwere applied using a one-stage method. In grading the completeness of rice grains, shape and contour\nfeatures play a crucial role. Compared to grayscale images, binarized images more clearly delineate the\nshape and contours of rice grains, thereby improving the accuracy of subsequent classification algorithms.\nFor instance, the preliminary binarized image of Guangdong Simiao rice, shown in Fig. 2(b), exhibits\nsignificantly more distinguishable geometric features than the original grayscale image in Fig. 1(a).\nHowever, several small, unwanted white regions were present in the images. To simplify the dataset\nand retain only the significant and relevant areas, all white regions with a pixel area smaller than 40,000\nwere filled with black. Additionally, to enhance dataset quality, a median filtering algorithm was applied\nto remove edge noise, as illustrated in Fig. 2(c)."}, {"title": "3.2.3. Image Processing for Chalk Mechanism", "content": "In studies that evaluate rice chalk using machine vision, accurate chalk discrimination requires\ndetermining a specific light intensity [19]. To investigate the impact of different light intensities on the\nrecognition algorithm, this study established five distinct brightness levels. Using Guangdong Simiao\nrice as an example, Fig. 2(d) and Fig. 2(e) illustrate the results obtained at brightness levels 2 and 5,\nrespectively."}, {"title": "4. Methods", "content": "This section elaborates on the functional components of the real-time mechanism designed for rice\nclassification and quality evaluation. The proposed model first employs an improved one-stage object\ndetection approach to accurately identify and distinguish multiple rice species in mixed samples. To\nassess the completeness of rice grains, a deep convolutional neural network (DCNN) is utilized,\neffectively differentiating intact grains from broken ones with enhanced precision. Additionally, the K-\nmeans clustering algorithm is applied to quantify the chalky area of rice grains, ensuring a more objective\nand reliable evaluation. The classification and grading criteria are established in accordance with China's\nNational Quality Standard for Rice, providing a standardized framework for assessing rice completeness\nand chalk area, thereby enhancing the robustness and applicability of the proposed method."}, {"title": "4.1. The One-Stage Model for Object Detection Mechanism", "content": "A one-stage model performs object detection and classification in a single forward pass without\ngenerating candidate regions beforehand. In this context, the YOLO (You Only Look Once) series has\nemerged as a leading framework [20], significantly advancing real-time object detection with remarkable\naccuracy. Building upon this foundation, our research focuses on enhancing detection performance\nthrough targeted model improvements based on the YOLOv5 network framework.\nThe YOLOv5 network comprises three primary components: the backbone, the neck, and the head.\nThe backbone is responsible for extracting feature representations from the input image, the neck further\nprocesses and fuses these features, and the head predicts bounding boxes, class probabilities, and\nobjectness scores to assess object properties.\nTo enhance the accuracy and mean Average Precision (mAP) of the model, we integrated the\nSimAM module, an attention mechanism, into the backbone network (Fig. 3). Unlike conventional\nattention mechanisms that typically introduce additional parameters or complex computations to\nemphasize or suppress features, SimAM adopts a self-induced approach that optimizes an energy\nfunction to assess the importance of individual neurons. This method enables the derivation of an\nanalytical solution for feature weighting without increasing the network's parameter count [21]. By\nreplacing a C3 layer in the backbone with SimAM, we observed a significant improvement in both\naccuracy and mAP, demonstrating the effectiveness of this enhancement."}, {"title": "4.2. The CNN Model for Completeness Mechanism", "content": "Deep Convolutional Neural Networks (CNNs) have become the dominant approach for visual\nclassification tasks. Among them, ConvNeXt, introduced in 2022, has demonstrated exceptional\nperformance across various classification scenarios [22]. Building upon this foundation, our research\nenhances the ConvNeXt network with algorithmic improvements specifically tailored for rice breakage\nrecognition.\nThe core building block of the ConvNeXt network is the ConvNeXt module, which consists of\nmultiple group convolution operations and transformation layers. By stacking multiple ConvNeXt\nmodules, a deep neural network can be constructed to meet the complexity of the task. In this architecture,\nthe output of the ConvNeXt module is connected to a global average pooling layer and fully connected\nlayers, with classification ultimately performed using the softmax function."}, {"title": "4.3. The K-means Clustering Algorithm for Chalk Mechanism", "content": "The recognition of rice chalk involves segmenting chalky and non-chalky pixel areas within rice\ngrains. The K-means algorithm, an iterative clustering technique, partitions data samples into K clusters\nby continuously updating cluster centroids. Samples within the same cluster exhibit high intra-cluster\nsimilarity, while those in different clusters demonstrate greater dissimilarity, thus facilitating effective\ndata clustering.\nIn the chalk recognition process, the K-means algorithm is employed to assign image pixels to K\ncluster centers, enabling image segmentation. Within the segmented image, each pixel is classified\naccording to its corresponding cluster center. By defining a category threshold, chalky areas are\nvisualized in black, while non-chalky regions appear white, thereby achieving effective segmentation of\nchalk regions.\nAccording to established rice chalk calculation methodologies, a minimum of 100 rice grains must\nbe sampled to accurately assess the chalk content of a given batch. When handling large datasets, the K-\nmeans algorithm demonstrates lower time complexity compared to other segmentation techniques, often\ncompleting clustering tasks efficiently. Unlike density-based clustering methods such as the DBSCAN\nalgorithm, K-means imposes fewer constraints on data distribution. Additionally, K-means allows for\nflexible adjustment of the number of clusters (K) to suit various segmentation requirements, whereas\nDBSCAN necessitates tuning parameters such as density thresholds and minimum sample counts, which\nmust be optimized for different datasets to achieve optimal clustering performance."}, {"title": "4.4. The Quality Evaluation Standards of Rice", "content": "In the rice quality evaluation task, we primarily adhere to the Chinese national standard GB/T 1354-\n2018 Rice as the assessment benchmark [24]. Our study conducts an in-depth analysis of key quality\nindicators, including chalkiness, broken rice rate, and admixture rate. Rice is generally classified into\nindica rice, japonica rice, and glutinous rice, each with distinct quality evaluation criteria. The\ncorresponding quality indicators for these rice varieties are detailed in Table 2."}, {"title": "4.4.1. The Standard of Rice Completeness", "content": "According to the classification criteria outlined in the Chinese National Standard GB/T 1354-2018\nRice, whole grains are defined as rice grains that remain intact in all parts except the embryo. Broken\nrice, on the other hand, refers to rice grains that are incomplete and have a length less than three-quarters\nof the average length of whole grains from the same batch, as retained on a 1.0 mm round-hole sieve.\nWithin the category of broken rice, sizeable broken rice includes incomplete grains with a length less\nthan three-quarters of the average length of whole grains from the same batch but retained on a 2.0 mm\nround-hole sieve. Tiny broken rice refers to fragments that pass through a 2.0 mm round-hole sieve but\nare retained on a 1.0 mm round-hole sieve.\nTo facilitate a more detailed analysis and assessment of broken rice in rice samples, we classified\nthe rice into three categories based on the degree of completeness as defined by the standard: whole\ngrains (with a length not less than three-quarters of the average length of whole grains from the same\nbatch), sizeable broken rice, and tiny broken rice. Subsequently, the rice samples were labeled according\nto the identification criteria specified in the standard document.\nFor experimental validation, we used a sample of no less than 10 g of rice and conducted broken\nrice classification tests. The ratio of sizeable broken rice to tiny broken rice was calculated following the\nmethod prescribed in the standard, as described by Equation (1).\n$X_1 = \\frac{m_1}{m} \\times 100\\%$", "latex": ["X_1 = \\frac{m_1}{m} \\times 100\\%"]}, {"title": "4.4.2. The Standard of Rice Chalk", "content": "According to the detection method for rice chalk specified in the Chinese National Standard GB/T\n1354-2018 Rice, the procedure begins by selecting 100 intact rice grains (n0) from the suspended rice\nsample. From this selection, the chalky rice grains (n1) are identified and separated. Subsequently, ten\nchalky rice grains are randomly selected from this group for further analysis. These selected grains are\nplaced flat and observed from the front to visually assess the chalky projection area as a percentage of\nthe total projection area of the intact rice grains. The average of these percentages is then calculated to\nquantify the degree of chalkiness. The chalk content is calculated using Equation (3), and the result is\nexpressed as a percentage (%).\n$D = WD \\times \\frac{n_1}{n_0}$", "latex": ["D = WD \\times \\frac{n_1}{n_0}"]}, {"title": "5. Experiments and Results", "content": "This section focuses on real-time rice detection experiments and quality evaluation studies. The first\nsubsection details the methodology and outcomes of conducting one-stage object detection experiments\non a dataset of rice images containing a mixture of multiple rice varieties. These images are derived from\nsix widely cultivated rice varieties in China. The second subsection presents the experimental process\nand results of employing deep convolutional neural network (CNN) models to classify rice grains based\non their degree of completeness. The dataset used for this task includes rice grains categorized into three\nclasses: severely damaged, slightly damaged, and undamaged. The third subsection describes the\nimplementation of a rice chalk evaluation experiment using the K-means clustering algorithm. All\nexperiments were conducted on a high-performance computing system equipped with an AMD EPYC\n7543 32-core processor, an Nvidia RTX 3090 graphics card, and the Linux Ubuntu 20.04 LTS operating\nsystem."}, {"title": "5.1. Object Detection Experiment", "content": "This study utilized the construction method described in Section 4.1 to develop a one-stage model\nfor rice object detection. Following this, the model was employed to classify and detect various rice types.\nThe confusion matrix of the improved model on the validation set is presented in Fig. 5. The results\nindicate that the model achieved a precision rate of 1.0 for the GD, NM, and YB categories. In contrast,\nperformance for WC, WN, and PJX categories was slightly lower but remained consistently above 0.95,\ndemonstrating favorable overall outcomes."}, {"title": "5.2. Completeness Experiment", "content": "Following the object detection task described in Section 5.1, the mechanism was further employed\nto classify and detect rice grains into three categories: whole grains, large broken grains, and small broken\ngrains, providing a comprehensive analysis of rice grain quality. To achieve optimal results with a\nrelatively small number of parameters, two pre-trained ConvNeXt models\u2014ConvNeXt-Tiny and\nConvNeXt-Small-were evaluated. Based on the average accuracy across the training and validation\ndatasets, ConvNeXt-Tiny demonstrated superior performance compared to ConvNeXt-Small, leading to\nits selection as the backbone model for the completeness experiment.\nAs shown in Table 4, the improved ConvNeXt-Tiny model achieved outstanding classification\nperformance in identifying the three rice completeness grades, with an average accuracy improvement\nof nearly 2%. Notably, significant increases in validation accuracy were observed for Guangdong Simiao\nrice and Wuchang rice. The validation accuracy for Guangdong Simiao rice improved from 88.65% to\n98.80%, while Wuchang rice increased from 95.44% to 96.10%."}, {"title": "5.3. Chalk Experiment", "content": "Chalk refers to the white, opaque portion in the rice endosperm, resulting from reduced translucency\ncaused by gaps between endosperm starch granules. It serves as a key indicator of rice quality and\nappearance, commonly used in rice production and quality control processes. According to the Chinese\nNational Standard GB/T 1354-2018 Rice, rice grains with a chalk content of greater than or equal to 2.0%\nare classified as first-grade premium rice. This implies that lower chalkiness correlates with higher rice\nquality. To improve the efficiency of rice production and quality control while minimizing subjectivity\nand human errors, this study applies artificial intelligence algorithms to analyze features such as\nbrightness, color distribution, and translucency in rice sample images, enabling automated chalk\nassessment. Rice images were collected under five different luminance intensities using the same light\nsource, then converted to grayscale for processing. The K-means algorithm was employed to cluster the\nimages, and by setting a category threshold, chalky regions were segmented, appearing black while non-\nchalky areas appeared white. To accurately determine the chalky area, a geometric polygon fitting method\nwas used to estimate the segmented regions' area. The formula for calculating chalky areas is detailed in\nSection 4.4.2.\nAs shown in Fig. 7, the size of the chalky regions increases with higher luminance intensities.\nManual comparisons revealed that the chalky area's ratio to the total rice area in images captured under"}, {"title": "6. Discussion", "content": "In practical experiments on rice recognition, we conducted a comparative analysis between the one-\nstage model employed in this study and various two-stage models to highlight the superiority of the\nproposed one-stage model in object detection and classification. The test set accuracy for each method\nis presented in Table 5.\nThe results in Table 5 indicate that two-stage models, when applied to both single-grain rice datasets\nand mixed-grain scenarios, fail to achieve high accuracy on the test set. Additionally, the one-stage model\nconsistently outperforms the two-stage models in terms of recognition speed, making it better suited to\nthe practical requirements of real-world applications."}, {"title": "6.1. Comparisons of Other Methods in the Object Detection Mechanism", "content": "In practical experiments on rice recognition, we conducted a comparative analysis between the one-\nstage model employed in this study and various two-stage models to highlight the superiority of the\nproposed one-stage model in object detection and classification. The test set accuracy for each method\nis presented in Table 5.\nThe results in Table 5 indicate that two-stage models, when applied to both single-grain rice datasets\nand mixed-grain scenarios, fail to achieve high accuracy on the test set. Additionally, the one-stage model\nconsistently outperforms the two-stage models in terms of recognition speed, making it better suited to\nthe practical requirements of real-world applications."}, {"title": "6.2. Comparisons of Other Methods in the Completeness Mechanism", "content": "We initially collected data for three categories of rice: whole rice, sizeable broken rice, and tiny\nbroken rice. The dataset included measurements of their short axis, long axis, and area. The data quantity\nfor each category was varied, resulting in an approximate ratio of 2:1:1. Based on the definitions of\nbroken rice outlined in GB/T 1354-2018 Rice, we utilized machine learning algorithms, including\ndecision trees, random forests, and support vector machines (SVM), to classify and grade broken rice.\nHowever, as shown in Table 7, a comparison between ConvNeXt and these traditional machine\nlearning algorithms reveals that ConvNeXt significantly outperforms them in terms of accuracy."}, {"title": "7. Conclusions", "content": "The mechanism proposed in this study demonstrates the capability to accurately identify rice\nvarieties and perform quality analyses, particularly regarding rice completeness and chalkiness. The\noverall rice processing framework consists of three primary steps. In the first step, a one-stage object\ndetection method is implemented to enable real-time visualization of rice positions and classification\ninformation, achieving an accuracy of 97.89% and a mean average precision (mAP) of 99.14%. The\nsecond step employs a convolutional neural network (CNN) to evaluate the grade of broken rice within\nthe same category, yielding an average accuracy exceeding 97%. In the third step, clustering algorithms\nare applied to accurately extract the chalky regions of whole rice and calculate precise chalkiness\nmeasurements.\nThis mechanism integrates multiple advanced techniques, including object detection, deep learning\nusing CNNs, and clustering, to deliver an efficient and accurate comprehensive analysis of rice quality.\nDespite its strengths, the study has areas for improvement. For instance, testing the mechanism with a\nbroader range of rice varieties is a priority for future research. Additionally, further evaluation of the\nmodel's lightweight design and effectiveness on actual hardware is essential to develop a practical quality\ndetection device for real-world applications [25]."}]}