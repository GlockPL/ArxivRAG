{"title": "RadiomicsFill-Mammo: Synthetic Mammogram Mass Manipulation with Radiomics Features", "authors": ["Inye Na", "Jonghun Kim", "Eun Sook Ko", "Hyunjin Park"], "abstract": "Motivated by the question, \"Can we generate tumors with desired attributes?\" this study leverages radiomics features to explore the feasibility of generating synthetic tumor images. Characterized by its low-dimensional yet biologically meaningful markers, radiomics bridges the gap between complex medical imaging data and actionable clinical insights. We present RadiomicsFill-Mammo, the first of the Radiomics-Fill series, an innovative technique that generates realistic mammogram mass images mirroring specific radiomics attributes using masked images and opposite breast images, leveraging a recent stable diffusion model. This approach also allows for the incorporation of essential clinical variables, such as BI-RADS and breast density, alongside radiomics features as conditions for mass generation. Results indicate that RadiomicsFill-Mammo effectively generates diverse and realistic tumor images based on various radiomics conditions. Results also demonstrate a significant improvement in mass detection capabilities, leveraging RadiomicsFill-Mammo as a strategy to generate simulated samples. Furthermore, RadiomicsFill-Mammo not only advances medical imaging research but also opens new avenues for enhancing treatment planning and tumor simulation. Our code is available at https://github.com/nainye/RadiomicsFill.", "sections": [{"title": "1 Introduction", "content": "In medical imaging, acquiring high-quality data is challenging due to privacy concerns and high labeling costs. Additionally, the inherent imbalance in available datasets complicates the training of effective neural networks, presenting a significant barrier to advancements in medical artificial intelligence (AI) [22,2]."}, {"title": "2 Method", "content": "For our study, we employed the publicly available VinDr-Mammo dataset [14] from Vietnam, containing 5,000 full-field digital mammography cases with breast density and annotation details. The data were pre-split into training and test sets"}, {"title": "3 Results", "content": ""}, {"title": "4 Conclusion", "content": "Our study introduces the pioneering application of utilizing radiomics features for generating synthetic tumors. We have successfully validated the generator's precision in mirroring specified tumor conditions, markedly enhancing mass detection capabilities when used as a data augmentor. This improvement is especially significant for high-density masses, which are often difficult to detect due to their reduced visibility in dense breast tissue. The findings demonstrate that defining specific tumor conditions in conjunction with an appropriately configured prompt encoder enables the generator to produce a wide range of synthetic tumors, preventing the generation of typical results. The innovative framework of RadiomicsFill-Mammo, which incorporates opposite breast images and clinical variables such as breast density and BI-RADS assessment as additional conditions for tumor generation, establishes a clinically meaningful approach. As the first endeavor in the RadiomicsFill series, RadiomicsFill-Mammo unveils substantial potential to advance the field of medical imaging research, achieving significant outcomes. The ability of RadiomicsFill to generate tumors with specific attributes highlights its utility for a range of clinical purposes, including simulating treatment responses. Furthermore, this work paves the way for applying RadiomicsFill techniques across different medical imaging fields, setting a promising direction for our future research."}, {"title": "2.1 Dataset", "content": "For our study, we employed the publicly available VinDr-Mammo dataset [14] from Vietnam, containing 5,000 full-field digital mammography cases with breast density and annotation details. The data were pre-split into training and test sets"}, {"title": "2.2 RadiomicsFill-Mammo", "content": "RadiomicsFill-Mammo, as illustrated in Fig. 1, is a framework designed for in-painting masses in masked regions of mammograms. It takes as input the masked image, an image of the opposite breast (other laterality image), and tumor conditions. The opposite side image is included to leverage breast symmetry, aiding in inpainting by providing a reference [20]. In 2D mammograms, normal and abnormal tissues overlap due to projection, and a rectangular mask may contain both normal and abnormal tissue depending on the radiomics condition. Using the opposite side helps fill the masked region with normal tissue texture while generating masses that reflect the given conditions.\n The generator within this framework is adapted from the stable-diffusion-2-inpainting [17] model, with modifications made to suit our specific requirements."}, {"title": "2.3 Tabular Encoder", "content": "We aim to produce prompts detailing tumor characteristics for integration into tumor generation within the stable diffusion framework. A key component of our RadiomicsFill model is the tabular encoder, trained as part of the Masked Encoding for Tabular data (MET) [10] process, incorporating its strategy for feature-specific embeddings. This encoder effectively identifies complex feature relationships by reconstructing masked values, acknowledging the stable but variable nature of these characteristics. While some features may be redundant, their relationships are effectively captured by the feature-specific embeddings. The embeddings are structured as feature number \u00d7 embedding dimension, allowing for precise representation of each feature's unique properties. After pretraining on a masked feature reconstruction task with mean squared error loss, this encoder becomes the prompt encoder in our tumor generator. Fig. 2 demonstrates the MET network's architecture and its pretraining approach, enabling the generation of clinically relevant and detailed images by leveraging the structured complexity of tabular data.\n Evaluation of the Tabular Encoder We adopted a Masked Tumor Condition, incorporating 9 shape, 18 histogram, and 40 texture features, alongside clinical variables (i.e., breast density as low/high and BI-RADS assessments as normal, benign, and malignant). Radiomics features were extracted using PyRadiomics [24] and normalized to a range of 0 to 1. In the case of normal samples, which lack"}, {"title": "2.4 Experimental Setting", "content": "To assess the performance of RadiomicsFill-Mammo, we experimented with four configurations for tumor condition prompts and encoders, as detailed below and illustrated in Fig. 3:\n(a) MassTextFill: Simplifies the approach by categorizing inputs into two broad categories: mass and normal cases.\n(b) ClinicalTextFill: Utilizes 12 distinct text prompts based on breast density, BI-RADS assessment, and view for more nuanced clinical inputs.\n(c) RadiomicsFill-MLP and (d) RadiomicsFill-MET: Both configurations use 67 radiomics features and 2 clinical variables (breast density and BI-RADS) as prompts but differ in their prompt encoder architectures, exploring various encoding strategies.\n During the denoising U-Net training phase, normal and mass prompts are used to inpaint images, facilitating the learning of distinctions between normal tissue and tumors. For inference, we applied Classifier-Free Guidance (CFG) with tailored prompts to enhance image specificity and clinical relevance [4]. Positive prompts detailed tumor characteristics, while negative prompts ensured differentiation from normal cases. This CFG approach significantly improves the model's accuracy by focusing on tumor-specific attributes and avoiding features typical of normal cases."}, {"title": "3.1 How Well Does It Generate Diverse and Realistic Tumors?", "content": "Radiomics Feature Consistency We assessed RadiomicsFill's ability to generate tumors reflecting specified radiomics features by comparing the radiomics features of generated tumors against those of the input image in unseen test set conditions. We employed a pretrained nnUNet model [7], trained on the mass training set, to predict synthetic tumor contours from mass images and bounding box mask images. The high similarity observed in Fig. 4 between input and synthetic tumor radiomics features confirms RadiomicsFill's effectiveness in accurately mirroring the given conditions in tumor generation.\n Quality Assessment of Synthetic Tumor All models, leveraging tailored prompts, consistently generated high-quality synthetic tumors. The performance was measured with metrics reflecting image fidelity: FID (Fr\u00e9chet Inception Distance), PSNR (Peak Signal-to-Noise Ratio), SSIM (Structural Similarity Index), and MS-SSIM (Multi-Scale Structural Similarity Index). Lower FID scores indicate better image quality, while higher PSNR, SSIM, and MS-SSIM scores suggest greater similarity to the target images. The strong performance across all prompt types suggests that the stable diffusion backbone is effective as a tumor generator."}, {"title": "3.2 How Can RadiomicsFill-Mammo Be Utilized?", "content": "Enhancing Downstream Tasks In evaluating RadiomicsFill-Mammo's impact on mass detection, we generated synthetic data using normal training images with mass prompts. The generated data were used for training a YOLO v8 detection model [8]. We trained models with two regimes: '1x' using only synthetic data, and '2x' combining synthetic data with the actual mass training set. For comparison, the baseline model was trained solely on the real mass training set. To assess mass detection performance, we conducted a comprehensive comparison using commonly employed metrics, with results detailed in Table 2.\n Visualizing Condition-Specific Tumor Variations Fig. 5 showcases synthetic tumors generated with progressively increasing the shape feature of size, while other features remain constant. This visualization demonstrates our model's ability to adapt to specific tumor characteristics, illustrating the potential for generating diverse, tailored synthetic tumors based on specific condition prompts.\n Fine-Tuning with External Validation Dataset This section underscores RadiomicsFill-Mammo's capability to adapt to external datasets, using the IN-breast dataset [11] from Portugal as a case study. To address data scarcity and enhance mass detection, we specifically fine-tuned the denoising U-Net of RadiomicsFill-Mammo by training only the added Low-Rank Adaption (LoRa) module [5]. This focused fine-tuning strategy demonstrates an effective adaptation even with limited data availability. To enrich the dataset, we generated synthetic masses on INbreast's normal images using mass prompts from the VinDr-Mammo trainset, generating an augmented dataset for training the mass detection model. Due to the limited size of the INbreast dataset, we proceeded directly to test set evaluation after 300 epochs of balanced training, without employing a separate validation set. The training and test sets included 7 L-B, 30 L-M, 4 H-B, and 3 H-M masses for training, and 9 L-B, 34 L-M, 18 H-B, and 6 H-M masses for testing, respectively using stratified sampling at the patient level. The improvements in diagnostic accuracy achieved through this refined fine-tuning method, as evidenced in Table 3, highlight the enhanced utility of RadiomicsFill-Mammo in real-world scenarios, even with limited available data."}]}