{"title": "Why is the estimation of metaorder impact with public market data so challenging?", "authors": ["Manuel Naviglio", "Giacomo Bormetti", "Francesco Campigli", "German Rodikov", "Fabrizio Lillo"], "abstract": "Estimating market impact and transaction costs of large trades (metaorders) is a very important topic in finance. However, using models of price and trade based on public market data provide average price trajectories which are qualitatively different from what is observed during real metaorder executions: the price increases linearly, rather than in a concave way, during the execution and the amount of reversion after its end is very limited. We claim that this is a generic phenomenon due to the fact that even sophisticated statistical models are unable to correctly describe the origin of the autocorrelation of the order flow. We propose a modified Transient Impact Model which provides more realistic trajectories by assuming that only a fraction of the metaorder trading triggers market order flow. Interestingly, in our model there is a critical condition on the kernels of the price and order flow equations in which market impact becomes permanent.", "sections": [{"title": "Introduction", "content": "Transaction cost analysis is a fundamental aspect of financial trading and market impact is the main source of costs for medium and large sized investors [1]. Thus, estimating the potential impact and cost of a trading decision is important to assess its profitability. This is particularly true and challenging for metaorders, i.e. sequences of orders and trades executed gradually over a long time period and following a single investment decision. In fact, while there is a vast literature on estimating and modeling impact of individual trades (or orders) from public data, it is less clear if and how such models can be used to estimate the expected price trajectory of a metaorder and the associated impact cost. To this end, the industrial practice is to estimate market impact and the associated cost of a metaorder by using data on actual metaorder execution (for academic researches using this approach, see, for example, [2-5]). However this approach presents some pitfalls. First of all, data on metaorder executions are typically proprietary and not publicly available. They also reflect the trading style of the specific trading firm owning the data and the conditions that lead the firm to trade. Thus they are potentially biased and very specific and might not be of general use. Second, market impact measurements are very noisy, thus large datasets are needed to accurately estimate costs. These datasets might not be available to the firm or they might require some aggregation and renormalization techniques (for example, multiple assets, long time periods, etc.) which could deteriorate the quality of the estimation.\nThe obvious alternative is the use of publicly available market data. However in order to use them, one needs to postulate a market impact model, and then use it to estimate, analytically or via numerical simulations, the price trajectory and impact costs of a metaorder. In this case the critical aspect is the choice of the appropriate model, since its misspecification could lead to wrong and misleading results. The advent of machine learning and artificial intelligence methods allows to use models which can be calibrated on market data and should be flexible enough to avoid the possible model misspecification. An interesting and challenging question is thus if the two approaches, the one based on actual metaorder executions and the one based on market data and impact models, provide compatible results. Although this is a very general (and maybe too ambitious) question, in this paper we provide a preliminary answer. Specifically, we consider linear and non-linear market impact models of the joint dynamics of price and trades, which we calibrate on public market data. We then use a generalized Impulse Response analysis to evaluate the average price dynamics during the execution of a metaorder predicted by the calibrated models.\nWe find that different market impact models give price profiles which are not compatible with the main stylized facts observed during the execution of real metaorders, namely the concavity of the price trajectory during the execution and a sharp convex reversion after the end of the metaorder. On the contrary, the trajectories display an almost linear increase and very small price reversion. In some cases, the predicted price trajectory even continues to grow (for a buy metaorder) for a while after the end of the metaorder. Interestingly similar results are recently reported [6,7] using different models spanning from Vector Autoregressive (VAR) models to Generative Adversarial Networks. Specifically, in the first part of this paper we confirm these observations by considering the linear Transient Impact Model (TIM) of [8] and a nonlinear model based on a combination of a Convolutional Neural Network and a Long Short Term Memory calibrated on market data. For the first model, we observe that, after the calibration on data, the parameters in the infinite lags limit tend to a critical condition. This was already observed in [7] and, as discussed in the paper, could have a role in the reproduction of stylized facts of metaorders. For the Hasbrouck Structural VAR model [9], we are able to provide close form expressions of the expected price trajectory. Even if with some differences, the qualitative findings of the neural network based model are similar.\nThe second part of the paper proposes a possible origin for this general disagreement and introduces a simple linear model which is capable to provide more realistic price trajectories. Starting from the TIM, we conjecture that the above-mentioned disagreement is due to the fact that statistically calibrated impact models overestimate the positive triggering effect that a child order has on the order flow of the market. As detailed in Section 5, the explanation of this overestimation is based on the model of correlated order flow proposed by Lillo-Mike-Farmer (LMF) in 2005 [10] and recently carefully empirically verified by Sato and Kanazawa [11]. The LMF model proposes that the empirically observed long memory of order flow is mostly due to the superposition of trading execution of metaorders of very heterogeneous size. If this is the correct explanation, strongly autocorrelated models of order flow will be fitted on empirical data, but the addition of a child order of a new metaorder does not trigger in reality new orders with the same direction (as the statistical model would suggest) because these orders will be essentially executed according to the trading program decided beforehand.\nIn order to quantitatively elaborate this hypothesis, we introduce a modified version of the TIM where a parameter \u03b1 tunes the effect that a child order has on price with respect to its effect on market order flow. Using the continuous time version of the model, we are able to provide closed form expressions for the price dynamics when the kernel of the TIM and of the correlated order flow are exponential functions. For power-law kernels, which are more in line with empirical observations, we provide numerical evidences based on the discrete time version of the model and confirm the qualitative behavior of the exponential case. We find that the model has a critical condition such that after the end of the metaorder the price reverts to a constant value, i.e. despite the transient nature of the impact, there is a non zero permanent impact. In particular, as we approach this condition, as suggested by the previous calibration of the model on data, we observe that incorporating the entire metaorder contribution into the order flow causes price trajectories to become linear during the execution of the metaorder. After the metaorder ends, prices only partially revert, eventually stabilizing around a fixed value. In the exact critical case, the system exactly converges to a nonzero value corresponding to a permanent impact. Thanks to the presence of \u03b1 we are able to reduce these effects and reproduce the empirical evidences.\nThe paper is organized as follows: Section 2 reviews the empirical literature on price dynamics during a metaorder execution. Section 3 introduces the problem and the estimation method based on a modified Impulse Response Analysis, providing also a close form expression for linear impact models. Section 4 presents some empirical results of the price trajectory inferred from public data with linear and nonlinear models and Section 5 provides a possible explanation of the discrepancy between empirical data and model predictions. In Section 6, we introduce a modification of the TIM which is able to reproduce the empirical results and finally in Section 7 we draw some conclusions."}, {"title": "Stylized facts on the price dynamics during and after a metaorder execution", "content": "We remind that a metaorder is generically defined as a sequence of orders and trades following a single investment decision. The orders composing a metaorder are often called child orders. As explained in the seminal paper by Kyle [12], the choice of executing progressively (large) orders is dictated by the need of minimizing transaction costs and hiding the trading decision from the market. Both effects are consequence of market impact, the price reaction to orders and trades. Thus the price dynamics in the presence of a metaorder is different from those that would have been observed without it. This section synthesizes the main findings from the literature, focusing on the stylized facts observed in empirical studies of real metaorder executions. Later in the paper we will compare these stylized facts with the predictions obtained from statistical models calibrated on market data.\nPrice Dynamics During Metaorder Execution. One of the primary observations across multiple studies is that the price trajectory during the execution of a metaorder is, on average, a concave function of time [4,5,13,14]. This behavior indicates that the price impact grows at a decreasing rate as the metaorder progresses. This phenomenon might be attributed to the increasing market awareness of the metaorder's presence, leading to adjustments in the trading strategies of other market participants. There is no agreement on the functional form followed by the (average) price during metaroder execution, also because the precise shape could depend on the trading speed during the execution. A reasonable functional form, however, is a square root function of time.\nPrice Dynamics After Metaorder Execution. The post-execution phase typically exhibits a convex price trajectory, where the price partially reverts towards its pre-execution level [4,5,13]. This behavior is commonly referred to as \"price reversion\" and is an essential feature of market impact models. In fact, this behavior is compatible with transient impact models and not, for example, with models where impact is fixed and permanent (for example, the Almgren-Chriss model). The degree of reversion often depends on the size of the metaorder and the liquidity of the traded asset.\nThe amount of price reversion has been widely debated in the literature. Some papers (for example [15]) claim that there is a full reversion of the price, while others (for example [5]) find a non-zero long-term impact. The difficulty in reaching a conclusive answer depends essentially on three aspects: (i) after the end of the metaroder the price fluctuations are very large and one needs to average a huge number of trajectories to reach a statistically significant conclusion; (ii) the observed average decay is very slow, thus one needs to extend the measurement to many hours after the end of the metaorder, with an even larger increase of the fluctuations, and sometimes this requires to consider data from the following days; (iii) metaorders are often autocorrelated in time [15,16] and one needs to deconvolve the measured average price trajectories to obtain a result not explained by the correlation between metaorders.\nDespite being outside the scope of this paper, it is worth mentioning the empirically observed relation between the total price change between the beginning and the end of the meta-order and its volume. This is the celebrated square-root impact law [3,5], which says that the total price change is well described by the square root of the suitably rescaled metaorder volume.\nSeveral theoretical models have been proposed to explain these stylized facts [17,18]. On the contrary, in this paper we are interested in assessing whether econometric or machine learning models, suitably calibrated on real data, can be used to obtain price trajectories that share the same properties of those observed in empirical data during the execution of real metaorders."}, {"title": "Price impact models and generalized Impulse Response Analy- sis", "content": "A general price and trade model describes their joint dynamics, possibly by taking into account other covariates, such as limit order book quantities (spread, bid-ask volume imbalance, etc). Thus, a general model in discrete time can be written as\n$$P_t = F_1 (P_{t-1}, P_{t-2},..., U_t, U_{t-1}, U_{t-2}, ..., X_t, X_{t-1}...)$$\n$$U_t = F_2(P_{t-1}, P_{t-2}, ..., U_{t-1}, U_{t- 2}, ..., X_t, X_{t-1}...)$$\nwhere $t\\in N$ is the trade time, $p_t$ is the midpoint price and $v_t$ is the signed volume\u00b9 of the trade at time $t$. Notice that the definition of price at time t is far from trivial and will be discussed below. Finally, $X_t$ is a vector that contains the covariates of the dynamics. The two functions $F_1$ and $F_2$ must be estimated from empirical data, either by using a parametric specification (e.g. a linear model, see next subsection) or approximated in a non-parametric form via, for example, neural networks or other machine learning tools.\nImpulse Response Analysis for metaorders. In order to estimate the price trajectory during and after a metaorder execution, we propose a modified Impulse Response Function (IRF) analysis. We remind that Ref. [9] originally suggested to use the standard IRF of linear VAR model to estimate the effect on price of a single trade placed at time t. This is defined as\n$$IRF(h; \\delta_v) = E[\\Delta P_{t+h}|\\Delta P_{t}, U_t + \\delta v, \\Delta p_{t-1}, U_{t-1}, \u00b7\u00b7.] - E[\\Delta P_{t+h}|\\Delta p_{t}, U_t, \\Delta p_{t-1}, U_{t-1},...],$$\nwhere the shock on volume is given by $\\delta v$, and the number of periods (horizons) $h = 0, 1, . . ., H$ are measured in \"trade time\". Furthermore, to evaluate the cumulative effect of a trade in price at each h, one defines the Cumulative IRF (CIRF) as $CIRF(h; \\delta v) := \\sum_{h'=0}^h IRF(h'; \\delta v)$. The CIRF at h = 0 is the instantaneous impact and, under stationary models, the CIRF converges to an asymptotic value called permanent impact when $h\\rightarrow\\infty$. As a consequence, when h is sufficiently large, the effect of $\\delta v$ on $\\Delta p_t$ disappears and thus there is no longer an impact.\nWe propose here to use a generalized IRF analysis for assessing the impact of a metaorder. Let us consider a metaorder executed between time t = 0 and t = T and let $dv$ the volume of each child trade of the metaorder. We assume that this volume is added to the market volume, thus at each time when the metaorder is traded the total volume is $v_t + \\delta v$."}, {"title": "Linear models", "content": "We consider first a linear specification of the general model of Eq. (1). This model is essentially\u00b2 the SVAR model proposed by Hasbrouck in [19] and defined by\n$$\\Delta p_t = \\sum_{i=1}^p a_i p_{t-i} + \\sum_{i=0}^p b_i v_{t-i} + U_{1,t},$$\n$$U_t = \\sum_{i=1}^p c_i p_{t-i} + \\sum_{i=1}^p d_i v_{t-i} + U_{2,t}.$$\nThe terms $u_{i,t}$ are uncorrelated white noises with given distributions that captures all price changes not directly due to trades. Defining $y_t = (\\Delta p_t, v_t)'$, the model can be written in a compact form as\n$$Y_t = \\sum_{i=1}^p A_i Y_{t-i} + U_t,$$\nwhere $A_i$ are suitable matrices and $\\overline{u}_t$ are correlated noises. SVAR model parameters can be easily estimated using ordinary least squares (OLS) since there are no identifiability problems due to the well defined causal structure between the variables (trades simultaneously impact prices but not the other way around). We name this model simply as H(p). Furthermore, as any VAR(p) model, Eq. (8) can be written in the companion form as\n$$Z_t = \\Gamma Z_{t-1} + \\epsilon_t,$$\nwhere $z_t$ and $\\epsilon_t$ are two 2p dimensional vectors and $\\Gamma$ is a suitable 2p \u00d7 2p matrix.\nIt is worth noticing that a special case of the H(p) model is the Transient Impact Model, obtained by setting to zero the $a_i$ and $c_i$ terms, namely\n$$\\Delta p_t = \\sum_{i=0}^p b_i v_{t-i} + U_{1,t},$$\n$$U_t = \\sum_{i=1}^p d_i v_{t-i} + U_{2,t}.$$\nThe standard IRF of Eq. 11 for a SVAR(p) Hasbrouck model can be written as (see [20])\n$$IRF(h; \\delta v) = J\\Gamma^h J' (0, \\delta v)',$$\nwhere $J := [I_2 : 0 : \uff65\uff65\uff65 : 0]$ is a 2 \u00d7 2p selection matrix and $I_2$ is the 2 \u00d7 2 identity matrix. The linearity of the SVAR models implies that the IRF in Eq. (11) depends only on the estimated parameters and not on the process history and that it is linear on the \"size\" of the shock $\\delta v$.\nThe generalized Impulse Response Function of Eq. 4 can be written in a compact form for a linear model. In Appendix A, we show that the expected midprice $p_k$ during the metaorder can be expressed as the cumulative sum of the average price increments as\n$$p_k = p_0 + \\sum_{j=1}^k \\Delta p_j = p_0 + \\delta v [e_1 (I_{2p} \u2013 \\Gamma)^{-1} \u00d7 (k I_{2p} \u2013 \\Gamma(I_{2p} \u2013 \\Gamma)^{-1}(I_{2p} \u2013 \\Gamma^k))e_2],$$"}, {"title": "Empirical results", "content": "Here we present the results on the price dynamics during and after the execution of a metaorder according to the above introduced models with parameters calibrated on real data. We use data obtained from LOBSTER\u00b3, containing observations from NASDAQ-listed stocks during the 22 trading days of June 2021. Specifically, we examine Microsoft, as representative of large tick stocks, and Amazon, as a small tick stock and the price changes are computed in the Hasbrouck convention. As customary, we exclude the first and last 30 minutes to reduce the effect of intraday pattern. Furthermore, we merge orders occurring at the same timestamp, with nanosecond precision, and having the same sign."}, {"title": "Results for the linear model", "content": "To estimate the parameters of the SVAR and reduced models of Equations (7) and (10), respectively, we use Ordinary Least Squares (OLS). This procedure mitigates possible estimation issues due to a misspecification of the distribution of the residuals. The choice of the number of lags p in linear models is critical to accurately capture the dynamics of price and volume, as well as the properties of the price dynamics around a metaorder. Originally, Hasbrouck [9] suggested setting p equal to five. However, subsequent studies have indicated that such setting might be insufficient to fully describe the properties of order flows and signed volumes, which exhibit characteristics consistent with long-memory processes [8, 21-24]. Moreover, an interesting recent contribution [7] finds that the largest eigenvalue of a VAR model describing price and market variables tends to one when the number of lags of the VAR is increased. To balance the effort of capturing long-memory effects and managing model complexity, we evaluated the model at two large p settings: p = 2 \u00d7 10\u00b3 and p = 4\u00d710\u00b3. These settings were selected to probe the depth of memory effects and the feasibility of parameter estimation, thereby enhancing the model's ability to reflect the underlying dynamics accurately.\nUpon reviewing the cumulative coefficients from our parameter estimations, it became evident that within the Hasbrouch model of Eq. (7), the coefficients ai and ci do not manifest significant cumulative effects, especially when contrasted with bi and di. Consequently, we redirected our focus towards the more influential coefficients, leading us to further investigate the TIM\u2074 of Eq. (10). We remind that in an AR(p) model as the second equation in (10) the sum of the di coefficients indicates the level of endogeneity of the process and when this sum approaches the value 1 the process becomes non stationary. Figure 2 shows this cumulative sum for the two considered values of the order p. In both cases it is evident that, increasing the order of autoregression, the cumulative sum of the di coefficients becomes closer and closer to 1 and this suggests that the volume process is approaching non-stationarity, consistently with the recent findings in [7].\nWhen we add the volume of the metaorder execution, the equations of the model become\n$$\\Delta p_t = \\sum_{i=1}^p b_i v_{t-i} + b \\delta v t,$$\n$$U_t = \\kappa (\\sum_{i=1}^p d_i v_{t-i} + \\delta v).$$\nwhere $\\delta v$ is the trade size of each child order of the metaorder and $\\kappa = {0,1}$ is a dummy variable. The case $\\kappa = 0$ corresponds to the case where market trading volumes are described by a white noise and the child order of size $v_t = \\delta v$ does not affect the market trading volume. On the contrary, when $\\kappa = 1$ the autoregressive dynamics of volumes is taken into account and the child order of size $\\delta v$ influences market volume which is then transferred to prices. We arbitrarily set the volume $\\delta$ of each child order of the metaorder equal to the median trade size of the considered asset, which is 7 shares for Amazon and 100 shares for Microsoft. Note however that, because of the linearity of the model, the impact is proportional to the child order size. The metaorder lasts from time t = 0 to t=T= 1000 trades.\nFigures 3 and 4 show the results for the estimated price dynamics during and after the metaorder execution when p = 2 \u00d7 10\u00b3 (left panels) and p = 4 \u00d7 10\u00b3 (right panels) form AMZN and MSFT, respectively. When considering the model without the autoregressive dynamics for the volume (\u03ba = 0), we observe a mildly concave dynamics of the price during the execution of the metaorder and a partial reversion of the price after its end. Moreover, the amount of price reversion after the metaorder is larger for larger p and the price is going to be completely reverted if p\u2192\u221e (i.e. if p\u226b T). This in line with what known for the TIM model, see for example the discussion in [22].\nWhen \u043a = 1, i.e. when the metaorder volume has an effect on market volume, the price impact dynamics is importantly modified. As seen from the figures, the price dynamics during the execution of the metaorder is essentially linear (or even mildly convex) and there is no appreciable reversion after its end. Moreover, and importantly for transaction cost analysis, the peak impact $p_T - p_0$ is roughly twice larger than in the case \u043a 0. The reason is that the metaorder triggers other market trades more likely with the same sign as the metaorder, pushing the price even higher (for a buy metaorder) than in the case with \u043a = 0. Similar patterns are reported in [6, 7], suggesting similar behavior under comparable conditions.\nInterestingly, when increasing p things get worse, in the sense that price patterns looks less similar to the ones obtained with real metaorder. Looking at the right panel of Fig. 3 for Amazon, a sort of pronounced inertia effect is observed: after the end of a buy metaorder, the price continues to increase for a significant amount of time before starting to decline. The explanation is that even when the metaorder is over, the order flow triggered by the metaorder is significant, also due to the large value of p and sustains the increase of price. This effect is less marked in Microsoft (right panel of Fig. 4), potentially reflecting differences in tick size and the slope of cumulative di coefficients. These observations suggest the hypothesis that tick size and microstructural differences may influence how quickly trade impacts dissipate, but more extensive analyses are needed."}, {"title": "Results for a non-linear LSTM model", "content": "One might question whether the unexpected results we observed are due to the linear nature of the TIM, since it might lack the complexity needed to capture the intricacies of the market. For this reason, we perform an analogue analysis using an highly non-linear model based on Neural Networks. In particular, we consider a combination of Convolutional Neural Networks (CNN) and Long Short Time Memory (LSTM). The first ones are deep learning architectures commonly used for processing grid-like data, such as images, and can also be applied to sequential data like time series. In the context of time series, CNNs apply convolutional operations to the input sequence, enabling them to capture local patterns and temporal dependencies within the data. The latters are another type of deep learning architecture suitable for sequential data processing. LSTMs are designed to capture temporal dependencies by maintaining hidden states that evolve over time as the network processes each element in the sequence. This enables LSTMs to model complex sequential relationships in time series data. Unlike CNNs, LSTMs have recurrent connections that allow them to maintain memory of past inputs, making them well-suited for tasks where historical context is important, such as time series predictions. The main difference between CNNs and LSTMs in the context of time series data lies in how they capture temporal dependencies. CNNs primarily capture local patterns and short-range dependencies within the data through convolutional operations, while LSTMs capture long-term dependencies by maintaining memory of past inputs through recurrent connections. The two architectures can be combined in such a way to take advantage of both properties.\nHere we consider a model composed by a first 1D CNN layer with 32 filters and a tanh activation function, followed by two LSTM layers with 64 neurons. Then, a decision layer is built as a dense layer with a sigmoid activation function, whose output is again given to another LSTM with the same hyperparameters as before. Finally, a two dimensional dense layer gives the output of the model predicting the next step of the volume and price time series. Thus, the model takes as input length varying time series of trade signed volumes and price changes and gives as output the next step of each of the two time series. The model has been trained and tested (80% and 20%) on one month of Microsoft (June 2021) using the same dataset as in the linear model case, minimizing an MSE loss function. The length of the input time series is 5 and 100. The model has good out of sample R\u00b2 performances in both cases both for returns (~ 13%) and volumes (~ 2%). After the calibration of the model, we simulate the market reaction to a metaorder execution by shocking the volumes with \u03b4v = 100, as done in the linear case, that are inserted as input of the volume in the Neural Network model.\nFigure 5 shows the result of the simulation. Also in this case the behaviour of the metaorder is not reproduced by the model. In fact the price increases almost linearly during the execution and its decay after the metaorder execution is not visible. A similar shape was already observed in [6], where, still using a non linear model, the expected response of the market to the metaorder execution was not reproduced. We emphasize that further studies on neural network models capable of more accurately reproducing the expected behavior are required, and this task is deferred to future work. Here, we show that behavior similar to that obtained with linear models can also be achieved using nonlinear models. These observations suggest a deeper underlying reason why metaorder execution is not well described by either linear or nonlinear models. To address this, in Section 6, we investigate this issue by introducing a modified version of the TIM that incorporates the metaorder volumes."}, {"title": "Why are statistical models unable to reproduce price trajecto- ries during metaorder executions?", "content": "The puzzling results shown in the previous Sections, which are consistent with those obtained in the literature, indicate that a purely econometric/statistical model, correctly capturing the lagged correlations, is"}, {"title": "A modified Transient Impact Model", "content": "We first present the model in continuous time, because this allows us to derive a closed-form expression for the price dynamics. Later, we provide the discrete-time version, which will be useful to extract some relevant results when analytical expressions are not available. In the following we neglect for simplicity the noise contribution in the price and in the volume equations, in other words we are considering the deterministic"}, {"title": "Continuous time version: exponential kernels", "content": "In this Section, we analyze the case where the kernel D(t) has the exponential form $D(t) = e^{-\\beta t}$. Under this assumption, the stationary conditions (17) and (18) impose the following constraint on the parameters:\n$$\\beta > \\lambda.$$\nThe strict inequality corresponds to the stationary condition (17), where volumes decay exponentially to zero. In contrast, the equality corresponds to the critical condition (18), where volumes and consequently prices-retain a permanent impact. In the following, we first derive the volume dynamics before and after the metaorder execution, and then the corresponding price dynamics still using an exponential kernel in the form $G(t) = e^{-\\rho t}$."}, {"title": "Volume dynamics", "content": "In Appendix B, we explicitly derive the solution of the Volterra equation for the volume, which is for all t\n$$v(t) = \\begin{cases} aV \\frac{\\beta}{\\beta-\\lambda} \\left[ 1 + (1-\\frac{\\lambda}{\\beta}) e^{-(\\beta-\\lambda)t} \\right] - aV \\frac{\\beta}{\\beta-\\lambda} e^{-(\\beta-\\lambda)(t-T)}  & \\text{ if } \\beta \\neq \\lambda, \\\\ aV{1 + \\beta t - \\theta(t-T)[1 + \\beta(t - T)]}, & \\text{ if } \\beta = \\lambda. \\end{cases}$$\nIt can be noticed that the \u03bb parameter assumes the role of an inverse time scale which is put in relation with \u03b2, representing the inverse time scale of the exponential kernel D.\nAlthough the solution holds for any \u03b2 and \u03bb, as discussed above, condition (19) must be satisfied to ensure that volumes remain stationary."}, {"title": "Price dynamics", "content": "After computing volume dynamics, we can substitute the result in the expression of prices in Eq. (15) and extract the related dynamics. The computation is performed in details in Appendix C and the result reads\n$$p(t) = \\begin{cases} \\frac{aV}{\\rho} \\left{ 1 - e^{-\\rho t} + (1 - \\alpha) \\frac{\\beta}{\\beta - \\lambda} \\left[ \\frac{\\lambda}{\\rho - \\beta + \\lambda} \\left[ e^{(- \\beta + \\lambda) t} - e^{-\\rho t} \\right] + (1 - \\frac{\\lambda}{\\beta}) \\frac{\\beta}{\\rho - (\\beta - \\lambda)} \\left[ e^{-(\\beta - \\lambda)(t-T)} - e^{-\\rho (t-T)} \\right] \\right] \\right} + (1 - \\alpha) V \\left[ \\frac{1 - e^{-\\rho t}}{\\rho} - \\theta(t - T) \\frac{1 - e^{-\\rho (t-T)}}{\\rho} \\right], & \\text{ for } \\beta \\neq \\lambda, \\\\ \\frac{aV}{\\rho} \\left{ 1 - e^{-\\rho t} + \\frac{\\beta}{\\rho} \\beta t + \\frac{e^{-\\rho t} - 1}{\\rho^2} - \\theta(t - T) \\left[ \\frac{1 - e^{-\\rho (t-T)}}{\\rho} + \\beta \\frac{ \\rho (t - T) + e^{-\\rho (t-T)} - 1}{\\rho^2} \\right] \\right} + (1 - \\alpha) V \\left[ \\frac{1 - e^{-\\rho t}}{\\rho} - \\theta(t - T) \\frac{1 - e^{-\\rho (t-T)}}{\\rho} \\right], & \\text{ for } \\beta = \\lambda. \\end{cases}$$\nPrice dynamics during the execution of the metaorder. Let us first study the dynamics\n$$p(t < T) = \\begin{cases} \\frac{aV}{\\rho} \\left[ 1 - e^{-\\rho t} + \\frac{\\beta}{\\beta - \\lambda} \\left[ \\frac{\\lambda}{\\rho - \\beta + \\lambda} \\left[ e^{(- \\beta + \\lambda) t} - e^{-\\rho t} \\right] \\right] \\right] + (1 - \\alpha) V \\frac{1 - e^{-\\rho t}}{\\rho}, & \\text{ for } \\beta > \\lambda \\\\ \\frac{aV}{\\rho} \\left[ 1 - e^{-\\rho t} + \\frac{\\beta}{\\rho} \\beta t + \\frac{e^{-\\rho t} - 1}{\\rho^2} \\right] + (1 - \\alpha) V \\frac{1 - e^{-\\rho t}}{\\rho}, & \\text{ for } \\beta = \\lambda. \\end{cases}$$\nThe right panel illustrates the opposite limit, i.e., \u03b1 = 1, where price dynamics are influenced solely by metaorders through the volume dynamics. In this case, as with volumes, the reciprocal value of \u03b2 and the scale \u03bb become relevant. For \u03b2 > \u03bb, the price dynamics remains consistently concave. As we approach the critical condition \u03b2 = \u03bb, if a is appreciably different from zero, after the relaxation of price dynamics (which occurs at a rate determined by the inverse of \u03c1), the price tends to a linear regime. Thus, if the system is near this regime, i.e. \u03b2\u03bb, the concave convergence of prices is still guaranteed to occur, but on much longer timescales, depending on how close \u03b2 is to \u03bb.\nLet us now examine what happens at the beginning of the metaorder execution, i.e., for\n$$t <<< min\\left( \\frac{1}{\\rho}, \\frac{1}{\\beta - \\lambda} \\right).$$\nBy performing a Taylor expansion, we obtain\n$$P(t \\sim 0) \\sim tV + t^2 V[a \\frac{\\lambda}{\\beta} - \\rho], \\text{ for } \\beta > \\lambda.$$\nThus, at small times, the price initially grows linearly, regardless of the value of a. As t increases, the quadratic term also becomes significant. If \u03b1 = 0, the behavior is always concave since \u03c1 > 0. On the other hand, for a > 0 and a > \u03c1/\u03bb, the price dynamics is initially convex, then it becomes concave as the price begins to converge to a fixed value. This change in concavity is illustrated in Fig. 8. In the opposite case, \u03b1 < \u03c1/\u03bb, the price dynamics remains concave at all times.\nFinally, for \u03b2 > \u03bb, price dynamics eventually becomes concave for sufficiently large times, converging to the value\n$$p(t) \\rightarrow \\alpha \\frac{V}{\\rho} \\frac{\\beta}{\\beta-\\lambda} + (1 - \\alpha) \\frac{V}{\\rho}$$\nIn contrast, as we approach the critical case \u03b2 = \u03bb, we tend to a configuration in which the linear term persists, as seen in Eq. (24), similar to the volume case. Thus, near criticality, since the volume during the metaorder only saturates for very large times, a similar behavior arises in prices, resulting in a quasi-linear price trajectory converging to a fixed value only on large timescales."}, {"title": "Price dynamics after the execution of the metaorder", "content": "Price dynamics after the execution of the metaorder. Let us now discuss what happens after the metaorder execution. Thus, let us switch"}]}