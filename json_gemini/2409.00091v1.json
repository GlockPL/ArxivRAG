{"title": "Classification of Safety Events at Nuclear Sites using Large Language Models (LLMs)", "authors": ["Mishca de Costa", "Muhammad Anwar", "Daniel Lau", "Issam Hammad"], "abstract": "This paper proposes the development of a Large Language Model (LLM)-based machine learning classifier designed to categorize Station Condition Records (SCRs) at nuclear power stations into safety-related and non-safety-related categories. The primary objective is to augment the existing manual review process by enhancing the efficiency and accuracy of the safety classification process at nuclear stations. The paper discusses experiments performed to classify a labeled SCR dataset and evaluates the performance of the classifier. It explores the construction of several prompt variations and their observed effects on the LLM's decision-making process. Additionally, it introduces a numerical scoring mechanism that could offer a more nuanced and flexible approach to SCR safety classification. This method represents an innovative step in nuclear safety management, providing a scalable tool for the identification of safety events.", "sections": [{"title": "Introduction", "content": "Station Condition Records (SCRs) are reports documenting events or conditions that occur at a nuclear power generating station, as well as initial actions taken or planned in response. An SCR that is assessed as relevant to safety goes through extra scrutiny to maintain personnel safety at the nuclear station. The current method of SCR classification is a manual one that involves human evaluators to examine multiple SCRs every week. These records, which may be submitted by any employee, cover a broad spectrum of events and undergo management review to determine an appropriate reaction. If an SCR is deemed relevant to safety, it undergoes further examination by the Health and Safety department and is documented in a specialized database. The SCR database encompasses a range of occurrences, from equipment malfunctions and delays in material delivery to staff missing training sessions, making it cumbersome for the Health and Safety department to sift through each SCR to identify safety-related items before transferring pertinent details into their safety tracking system. The aim of this project is to develop a machine learning classifier to automatically differentiate between safety-related and non-safety-related SCRs. While this tool is not intended to supplant human assessment, it will serve as an additional layer of scrutiny and facilitate the swift review of safety- related SCRs by triggering a pipeline that copies all relevant data into the safety system for final human verification."}, {"title": "Literature Review", "content": "Utilizing AI for CANDU-type nuclear power plants was previously proposed by several researchers to enhance safety and operational efficiencies. Budzinski's work [1] highlights machine learning techniques for the verification of refueling activities in CANDU-type nuclear power plants with direct applications in nuclear safeguards. Ahsan and Hassan [2] develop a machine learning-based fault prediction system for the primary heat transport system of CANDU type pressurized heavy water reactors, illustrating its potential to pre-emptively address system failures and enhance reactor safety. Hammad et al. [3-4] utilize deep learning and linear regression to automate the detection of flaws in nuclear fuel channel ultrasonic scans, significantly advancing the automation of safety inspections. Wallace et al. [5] improve the localization of fuel defects using neural networks and ancillary data sources, and in [6] developed an ultrasonic inspection analysis tool that supports decision-making in defect identification.\nFocusing on Natural Language Processing, Kant et al. [7] utilize a Transformer model for sentiment classification which, despite achieving a moderate 0.69 F1 score, required substantial computational resources and time for training. The fine-tuning process involved intricate balancing and additional strategies like active learning to address label nuances and class imbalances. Zhao et al. [8] present an approach to interpret CNN-based text classification using SHAP values, providing a deeper understanding of model decisions but adding complexity to the CNN model. Abburi et al. [9] explore the use of ensemble methods with various pre-trained LLMs, including BERT and its variants, for text classification. These models, while not achieving top results in binary classification tasks, demonstrated potential for nuanced classification and model attribution. In summary, while CNNs and LSTMs require significant effort to train and are sensitive to data imbalances and nuances, the reviewed works suggest that LLMs, especially when used in ensemble configurations, can more naturally capture the subtleties of language, justifying their use over traditional machine learning models for complex text classification tasks without requiring significant compute time or costs when using foundational models like GPT-4."}, {"title": "Exploratory Data Analysis", "content": "To tackle this problem, we collected a random sample of 100,000 SCRs from the Safety Information Database (SIDB). These SCRs were selected for inclusion in SIDB based on various search criteria and were subsequently reviewed and classified by humans as either safety or non-safety events.\nThis SIDB database therefore contains both safety-positive and -negative samples; in fact, the non- safety records outnumber the safety records in our sample by a ratio of approximately 9:1 (90358 non- safety-related SCRs versus 9642 safety-related records).\nThis data source was chosen because the records it contains were subjected to a more thorough review with respect to safety than records in the larger SCR database. This allows us to place greater confidence in the human-made labels which are used to train the machine-learning classifier."}, {"title": "Station Condition Record (SCR) Length Distribution", "content": "The SCRs ranged in size from 43 to 7998 tokens, with a mean of 584.4 and a median of 368 tokens. Given the small record size, summarization is not required to fit within the context window of modern LLMs like GPT-4 with >8k tokens of context window. The number of output tokens is very small (just the classification of YES/NO, often in JSON format to maximize consistency)."}, {"title": "Vector Embeddings", "content": "To better represent the relationship between SCRs, we first concatenated all the relevant text data, and then computed vector embeddings from this combined text field, using OpenAI's ada2 embeddings endpoint. The resulting embeddings compress the information contained in each SCR (regardless of length) into a vector of 1536 numbers. These 'semantic features' are computed based on the meaning of the text by the transformer encoder architecture of OpenAI's ada2 model. These semantic embeddings allow SCRs to be visualized and compared based on their contents.\nt-SNE (t-distributed Stochastic Neighbor Embedding) is an unsupervised dimensionality reduction technique used to visualize high-dimensional data. More similar embeddings are represented close to each other, allowing clusters of similar SCRs to be identified. A t-SNE representation of all 100k SCR embeddings is shown below, in which it can be observed that most safety-related SCRs are grouped in one area of the graph, comprising several distinct sub-clusters. A smaller number of SCRs classified as safety events are also dispersed among non-safety SCRs."}, {"title": "Model Development", "content": "As outlined in the introduction, the objective is to employ GPT-4 for this use case. However, given the close grouping observed in the t-SNE analysis during the exploratory data analysis (EDA) phase, it is advisable to initially test a basic classification approach. This will help gauge its performance and establish a baseline for comparison."}, {"title": "Evaluation and Results", "content": ""}, {"title": "Nearest Neighbors (k-NN) Classification", "content": "This observation of safety-related SCR embeddings clustering together prompted us to experiment with using traditional machine learning techniques to classify SCRs as safety- or non-safety-related. Specifically, k-Nearest Neighbors (k-NN), a supervised machine learning approach, was employed. A k-NN model was trained on a sample of 10,000 SCRs using k=5, meaning samples were classified based on the 5 SCRs with embeddings closest to their own. The results of this experiment are shown in Figure 4.\nAlthough the overall accuracy of this method was promising, it came at the cost of poor performance on safety records, which are the minority class in this dataset.\nDue to the poor recall of this sample on safety-related SCRs, the decision was made to develop a classifier using an LLM specifically OpenAI's GPT models. Ultimately, it is preferred for this model to"}, {"title": "GPT-4 based Classifier", "content": "GPT-4 was the model selected for this problem because the task involves high-level reasoning and complex decision-making based on consideration of context and informed assumptions. In short, GPT- 4 is OpenAI's most advanced and capable model, and this task was deemed to be difficult enough to warrant its use. If the results are successful, smaller open-source models (such as Mistral, Phi-2) can be swapped in, potentially after being fine-tuned on a labelled dataset."}, {"title": "Prompt 1 \u2013 Basic Prompt", "content": "Initial experiments yielded unsatisfactory results. In one early run, GPT-4 was given the following system prompt along with the combined text field for each SCR.\nYou are an AI assistant designed for helping classify safety events.\nEvents are filed by employees for anything from how well a project went to actual safety situations that could cause harm.\nOne element of a safety event, is when someone gets hurt either as a direct result of work or any other medical event.\nEven if someone doesn't get hurt, if there are any unsafe conditions that could cause harm to workers or put them in unsafe conditions, it is still considered a safety event.\nPlease respond in json format: { \"safety\": \"Y/N\" }."}, {"title": "Prompt 2 \u2013 Safety Culture Adjustments", "content": "Overall, we noted that OPG's strong safety culture was biasing the results. There is a tendency for staff to tie almost any and all events back to safety in some way, this is simply the way work gets prioritized based on the safety impact, so even technical problems often have an anecdote of safety mentioned in the writeup.\nImprovements were made to the system prompt to be more specific on what criteria constitutes a safety event to improve the results. In consultation with Health and Safety personnel three factors were identified which were used by managers when assessing the safety-relevance of SCRs. These were incorporated into a revised prompt, one version of which is shown below.\nYou are an AI assistant designed to classify reports as either safety events or non-safety events.\nConsider the following factors when making this determination:\n1. Does this report describe an event in which someone was injured, a situation in which someone was ill, or a situation that could have directly caused someone to be injured?\n2. Does this report describe an adverse physical condition with potential to directly cause an injury or illness?\n3. Does this information describe a safety hazard or actions taken to correct a safety hazard?\nPlease respond in json format: { \"safety\": \"Y/N\" }."}, {"title": "Prompt 3 \u2013 Corrective Action Adjustments + Potential for Harm", "content": "After reviewing some of the false-positive records, it was noted that corrective actions were often recommended using safety as a justification for their priotization even though they didn't necessarily stem from a safety event. So modifications to the system prompt were devised to reduce the likelihood of erroneous positive classification by explaining the corrective action context, and also adding a disclaimer that if the risk/potential for harm is very low, it shouldn't be counted. These changes resulted in the following prompt:\nYou are an AI assistant designed to classify reports as either safety events or non-safety events.\nConsider the following factors when making this determination:\n1. Does this report describe an event in which someone was injured, a situation in which someone was ill, or a situation that could have directly caused someone to be injured?\n2. Does this report describe an adverse physical condition with potential to directly cause an injury or illness?\n3. Does this information describe a safety hazard or actions taken to correct a safety hazard?\nCorrective actions taken do not necessarily indicate an event is safety-related unless those actions are taken to address direct threats to personnel safety.\nIn addition, the potential to cause harm may not be sufficient to warrant a safety-related status if the likelihood of potential harm is very small."}, {"title": "Prompt 4 \u2013 Score Introduction", "content": "To address these concerns a final improvement was implemented - the model was instructed to output a numerical score representing a record's safety-relatedness. This gives us greater control over the performance of the model, by selecting the threshold at which an SCR would be classified as a safety event. This change was contained in the following system prompt:\nIn addition, please assign a score of safety-relatedness, as a number from 0 (non- safety-related) to 1 (strongly safety-related).\nConsider the following factors when making this determination:\n1. Does this report describe an event in which someone was injured, a situation in which someone was ill, or a situation that could have directly caused someone to be injured?\n2. Does this report describe an adverse physical condition with potential to directly cause an injury or illness?\n3. Does this information describe a safety hazard or actions taken to correct a safety hazard?\nCorrective actions taken do not necessarily indicate an event is safety-related unless those actions are taken to address direct threats to personnel safety.\nIn addition, the potential to cause harm may not be sufficient to warrant a safety-related status if the likelihood of potential harm is very small.\nWith x denoting the safety-relatedness score between 0 and 1, please respond in json format: {\"safety score\": x, \"safety\": \"Y/N\"}."}, {"title": "Prompt 5 \u2013 Score control + Final Improvements", "content": "One drawback of this specific version of the prompt was that the model always output safety scores as multiples of 0.1 (e.g. 0.1 or 0.4, never 0.27). This limited our control over the classification threshold, as it could only be set at a small number of points.\nThis was improved with the following prompt, which also includes a few miscellaneous improvements mainly the inclusion of JHSC as a trigger to guarantee a safety detection:\nYou are an AI assistant designed to classify reports as either safety events or non-safety events.\nIn addition, please assign a score of safety-relatedness, as a number from 0 (non- safety-related) to 100 (strongly safety-related). Please give granular scores including numbers that are not multiples of 5 or 10 (e.g. 53, 14, 62).\nConsider the following factors:\n1. Does this report discuss an injury or potential injury, a situation in which someone was ill, or a situation that could have directly caused someone to be injured?\n2. Does this report describe an adverse physical condition or behavior with potential to directly cause an injury or illness?\n3. Does this information describe a safety hazard or actions taken to correct a safety hazard, or safety conditions that are non-compliant with policies and procedures?\nAny record that mentions \"Joint Health & Safety Committee\" or \"JHSC\" is a safety event.\nCorrective actions taken do not necessarily indicate an event is safety-related unless those actions are taken to address direct threats to personnel safety.\nIn addition, the potential to cause harm may not be sufficient to warrant a safety-related status if the likelihood of potential harm is very small.\nWith x denoting the safety-relatedness score between 0 and 100, please respond in json format: {\"safety score\": x, \"safety\": \"Y/N\"}."}, {"title": "Conclusions and Future Work", "content": "In conclusion, we have developed a model that performs sufficiently well for the Health and Safety department to consider its deployment to enhance efficiency. While the model is not without flaws, its current level of performance justifies a pilot deployment due to the significant potential gains in worker efficiency and safety. Looking ahead, several improvements are suggested: Firstly, transitioning to GPT-4 Turbo, which offers a larger context window allowing for handling extensive SCRs without the need for summarization that might compromise quality or context. Additionally, this model improves instruction following capabilities, reducing the risk of format errors in safety scoring outputs- currently managed with retry logic that increases runtime. Secondly, integrating GPT technology directly into the data intake process could address issues with limited or vague SCR data. A proposed chatbot could interactively refine data input, running the AI classifier during record entry and prompting for more details when confidence in the record's detail is low, thereby improving prediction quality. Lastly, considering an ensemble model combining the XGBOOST Classifier, which, despite its lower overall performance compared to ChatGPT, has shown high recall, could potentially enhance results further. This hybrid approach may leverage the strengths of both models to achieve superior outcomes in safety event identification."}]}