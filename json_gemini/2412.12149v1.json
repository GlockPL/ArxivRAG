{"title": "MHSA: A Multi-scale Hypergraph Network for Mild Cognitive Impairment Detection via Synchronous and Attentive Fusion", "authors": ["Manman Yuan", "Weiming Jia", "Xiong Luo", "Jiazhen Ye", "Peican Zhu", "Junlin Li"], "abstract": "The precise detection of mild cognitive impairment (MCI) is of significant importance in preventing the deterioration of patients in a timely manner. Although hypergraphs have enhanced performance by learning and analyzing brain networks, they often only depend on vector distances between features at a single scale to infer interactions. In this paper, we deal with a more arduous challenge, hypergraph modelling with synchronization between brain regions, and design a novel framework, i.e., A Multi-scale Hypergraph Network for MCI Detection via Synchronous and Attentive Fusion (MHSA), to tackle this challenge. Specifically, our approach employs the Phase-Locking Value (PLV) to calculate the phase synchronization relationship in the spectrum domain of regions of interest (ROIs) and designs a multi-scale feature fusion mechanism to integrate dynamic connectivity features of functional magnetic resonance imaging (fMRI) from both the temporal and spectrum domains. To evaluate and optimize the direct contribution of each ROI to phase synchronization in the temporal domain, we structure the PLV coefficients dynamically adjust strategy, and the dynamic hypergraph is modelled based on a comprehensive temporal-spectrum fusion matrix. Experiments on the real-world dataset indicate the effectiveness of our strategy. The code is available at https://github.com/Jia-Weiming/MHSA.", "sections": [{"title": "I. INTRODUCTION", "content": "Mild cognitive impairment (MCI) detection through hypergraphs represents a fundamental challenge in the intersection of biology and artificial intelligence. Early studies, such as Ding et al. [1], Shao et al. [2], and Ji et al. [3] employ a hypergraph learning strategy for the detection of MCI. In recent years, with the evolution of deep learning methodologies [4], researchers have utilized data features of various models to construct multimodal hypergraphs [5]\u2013[7], significantly refreshing the state-of-the-art records.\nHowever, current studies [4], [8], [9] on hypergraph construction rely on vector distances to deduce similarities between brain regions, as illustrated in Fig. 1, encompassing details such as spatial proximity and functional connectivity. Indeed, acquiring such signal scale features is intensely challenging in reflecting dynamic functional connectivity changes and some temporal impossible in describing the complex synchronized interactions of biological signals between corresponding ROIs [10], [11].\nTo our knowledge, no existing studies consider the MCI detection problem with synchronous information. In practice, functional magnetic resonance imaging (fMRI) sequences can reflect continuous dynamic changes of ROIs in the temporal domain when brains perform specific tasks [12], [13], and different ROIs demonstrate phase dependencies in the spectrum domain [14], as evidenced by their well-characterized phase synchronization attributes. MCI detection with hypergraphs poses two main challenges. First, vector distances are overly dependent on inferred interactions in geometric space, which will lose the dynamic connectivity patterns and complex interactions between regions. Second, it is difficult to align and optimize the connection effectiveness in the process of multi-scale feature fusion. Intuitively, to handle the above issues, we should 1) fully exploit the phase synchronization information of signals; and 2) adaptively refine connection strengths employing phase synchronous indicators.\nIn this paper, we propose a Multi-scale Hypergraph Network with Synchronous and Attentive Fusion for MCI Detection. First, the PLV is introduced to quantify the phase synchronization of fMRI signals in the spectrum domain. Second, we employ an attention algorithm to evaluate and optimize the direct contribution of each ROI to phase synchronization in the temporal domain and dynamically adjust the PLV coefficients, yielding a comprehensive temporal-spectrum fusion matrix. Finally, an adaptive hypergraph is modeled based on the above matrix, and MCI detection is realized by learning its graph representations.\nOverall, our contribution is summarized as follows:\n\u2022 We are the first to consider the synchronization between ROIs during the process of MCI detection and propose a new method to address this issue.\n\u2022 We formulate a multi-scale hypergraph construction method to integrate the dynamic connectivity of fMRI via synchronous and attentive fusion strategy.\n\u2022 We demonstrate the effectiveness and superiority of the proposed method in the ADNI dataset, compared to baseline approaches."}, {"title": "II. RELATED WORK", "content": "The construction of brain networks from neuroimaging data for brain disease detection is a prominent research topic. Conventional methods typically rely on direct relationships between node pairs and utilize Graph Convolutional Networks (GCNs) to extract disease-related features. For instance, Ma et al. [15] construct multi-view brain networks for Alzheimer's Disease (AD) diagnosis by leveraging the temporal series similarity of ROIs, which are then processed by a GCN to extract node embeddings. Zhao et al. [16] propose a self-learning spatial-temporal GCN for enhanced preclinical AD diagnosis. Meanwhile, Maet al. [17] develop a multi-graph cross-attention network to improve MCI classification performance. However, these methods establish only pairwise connections between brain regions and fail to capture higher-order interactions and associations, resulting in an incomplete representation of the brain network\u2019s structure and function.\nRecently, employing hypergraphs to model brain networks and capture intricate higher-order interactions has gained considerable attention. Liu et al. [18] utilize a spatio-temporal weighted hypergraph convolutional network to capture high-order brain activity patterns, thereby enhancing MCI classification. The dwHGCN model [19] adaptively refines hyperedge weights during training to improve the learning of brain functional connectivity features. Meanwhile, Li et al. [20] have developed a hypergraph attention network that leverages attentive feature aggregation for MCI classification. Despite these advancements, these methods still rely on direct vector distances between brain signals, which inadequately represent their true functional connections.\nAdditionally, some approaches analyze interactions between brain regions in the spectrum domain to capture more accurate topological relationships within brain networks. For instance, Wang et al. [21] dynamically capture spatial topological structures by analyzing multichannel EEG in the frequency domain using the PLV. Similarly, Wang et al. [22] investigate emotional states by constructing brain networks in the spectrum domain with PLV, thereby assessing functional connectivity differences across various emotions. Unfortunately, the connections within brain networks are both complex and diverse, neither focusing on a single signal domain nor just establishing higher-order relationships can fully simulate brain activity. Thus, our method captures both spectrum and temporal relationships in brain signals, constructing a higher-order network that more comprehensively represents the complex information transmission and interactions within the brain."}, {"title": "III. METHODOLOGY", "content": "In this paper, the multi-scale hypergraph is constructed via a synchronous and attentive fusion strategy for MCI detection. The overall architecture of the proposed model is illustrated in Fig. 2. Subsequently, the implementation of MHSA will be described."}, {"title": "A. Synchronization analysis model", "content": "PLV is a crucial method for calculating the synchrony characteristic of electrophysiological signals at specific frequencies, and the regional synchrony is proportional to the correlation between the signals. We calculate the PLV value between the pairwise ROI temporal signals $x_i$ and $x_j$ to evaluate the degree of phase synchronization, as below:\n$PLV_{ij} = \\frac{1}{T}\\sum_{l=1}^{T} eiI(\\Delta\\phi_{ij}(t_l))$    (1)"}, {"title": "B. Multi-scale feature fusion model", "content": "Considering the real change of practical bioelectrical signal transmission during the process of contributing brain networks, we focus on a multi-scale feature fusion mechanism to integrate dynamic connectivity features of fMRI from both the temporal domain and spectrum domain. Specifically, $C^{SPE}$ provides the synchronization relationship of ROIs in the spectrum domain. Then, the attention mechanism [24] is employed to calculate the weight coefficient among the ROIs signals $x_i$ and $x_j$ as the connection strength in the temporal domain:\n$C_{ij} = \\frac{exp(LeakyReLU(a^T([W_e x_i || W_e x_j]))}{\\sum_{k \\in N_j} exp(LeakyReLU(a^T([W_e x_i || W_e x_k]))}$, (3)\nwhere $a \\in R^{2T \\times 1}$ and $W_e$ are a parameterized vector and a learnable weight matrix, respectively. $||$ is the concatenation operation. And $e_{ij}$ computes the degree of association between ROIs signals $x_i$ and $x_j$ in the temporal domain, and $N_i$ represents the set of nodes directly related to the signal $x_i$ if $C^{SPE}_{ij}$ is greater than a preset threshold $T$. Furthermore, an attention matrix $M_e \\in R^{N \\times N}$ is defined with $M = e_{ij}$ to represent the correlation between all ROIs on the temporal domain, and the minimization optimization function is utilized to obtain the best combination of learnable parameters:\n$\\mathcal{L}_{opt} = \\sum_{i,j=1}^{N} {||x_i - x_j||^2 M_{ij} + \\lambda ||M_e||_F^2}$, (4)\nwhere $\\lambda > 0$ is a regularization parameter. To prevent attention from overly concentrating on specific pairs of ROIs, we define an all-ones matrix $M_{ones} \\in R^{N \\times N}$ to smooth the attention matrix $M_e$, enabling the model to evenly consider information from all brain regions.\n$C^{TEM} = M_e + M_{ones}$, (5)\nwhere $C^{TEM}$ is a smoothed temporal-domain matrix. Finally, from the view of multi-scale, $C^{TEM}$ and $C^{SPE}$ are combined through a Hadamard product to unveil the synchronicity and dynamic changes between ROIs:\n$C^{TS} = C^{TEM} \\odot C^{SPE}$ (6)"}, {"title": "C. Hypergraph construction model", "content": "In this section, the temporal-spectrum matrix $C^{TS}$ is utilized to form a hypergraph for feature representation. Initially, a hypergraph is represented by $G(V, E, W)$, where $V = {v_1, v_2, ..., v_n}$ denotes the node set and $E = {e_1, e_2, ..., e_m}$ represents the hyperedge set, which each e connects multiple nodes and is weighted by a diagonal matrix of W. Afterwards, the hypergraph G is expressed through a $|V|\\times |E|$ incidence matrix H, defined as follows:\n$H(v,e) = {\\begin{cases} 1 & \\text{if } v \\in e, \\\\ 0 & \\text{if } v \\notin e. \\end{cases}}$    (7)\nThen, the hyperedge construction is according to $C^{TS}$. For each ROI $i$, select $K$ in $C^{TS}$ the associated regions with the highest connection value, defined as set $top\\_K_i$. Based on this, the incidence matrix H is redefined as:\n$H(i,j) = {\\begin{cases} 1 & \\text{if } j \\in top\\_K_i, \\\\ 0 & \\text{otherwise}. \\end{cases}}$    (8)\nFor the incidence matrix H, its vertex degree matrix is defined as $D_v= diag({d(v_i)}_{i=1}^n)$ with $d(v) = \\sum_{e \\in E} w(e) H(v,e)$, and the hyperedge degree matrix represents as $D_e = diag({d(e_i)}_{i=1}^n)$, where $\\delta(e) = \\sum_{v \\in V} H(v,e)$. Finally, hypergraph neural networks (HGNNs) [25] are utilized to capture higher-order relationships between ROIs for feature representation, which the l-th convolution layer can be represented as:\n$X^{l+1} = \\sigma (D_v^{-1/2} HWD_e^{-1} H^T D_v^{-1/2} X^{(l)} \\Theta^{(l)})$  (9)\nwhere $X^{(l)}$ denotes the convolution output features of the l-th layer, $\\Theta^{(l)}$ as a filter is applied to extract node features in hypergraphs, and $W = diag({w(e_i)}_{i=1}^m)$ denotes a learnable hyperedge weight matrix."}, {"title": "D. Readout and Classification", "content": "After feature extraction by hypergraph neural networks, the output Z is used for graph-level reading and disease classification. Then, a multilayer perceptron is trained to derive the prediction:\n$\\hat{y} = MLP(Z)$.    (10)\nFor T samples of subjects, the predicted label $\\hat{y}_t$ and true label $y_t$ are taken as the input of a cross-entropy function to estimate the prediction loss:\n$\\mathcal{L} = -\\frac{1}{T} \\sum_{t=1}^T[y_t \\cdot log(\\hat{y}_t) + (1 - y_t) \\cdot log(1 - \\hat{y}_t)]$.  (11)"}, {"title": "IV. EXPERIMENTS AND RESULTS", "content": "In this study, brain imaging data was collected from the Alzheimer\u2019s Disease Neuroimaging Initiative (ADNI) dataset\u00b9. ADNI facilitates the sharing of global data on AD in its early stages. The initiative attempts to explore interventions, prevention, and treatment strategies for MCI and AD by using various biomarkers. Our study selected 179 subjects, including 51 patients with mild cognitive impairment (MCI), 64 patients with early MCI (EMCI), 36 patients with late MCI (LMCI), and 28 age-matched normal controls (NC). The details of demographics and clinical characteristics are presented in Table I.\nThe Data Processing Assistant for Resting-State fMRI (DPARSF) package was used in this study to preprocess the raw functional images and extract the ROI fMRI temporal series. This multi-step process is as follows: first, slice timing correction is performed by removing the first 10 temporal points. Then, motion correction is conducted, and subjects with head movement exceeding 2.5 mm or 2.5 degrees are excluded. Next, Statistical Parametric Mapping (SPM) is employed to realize co-registration with T1-weighted structural images and perform subsequent segmentation into gray matter, white matter, and cerebrospinal fluid; then, normalization is applied to the Montreal Neurological Institute (MNI) space using DARTEL. Subsequently, functional images are smoothed with a 4mm full width at half-maximum (FWHM) Gaussian kernel to reduce registration variability. Finally, bandpass filtering is performed on the functional temporal series between 0.01 and 0.1 Hz.\nThe MHSA method is compared with existing baselines, including well-estimated graph methods and specifically designed brain network analysis models.\n\u2022 SVM [26]: A classical supervised machine learning algorithm achieves data classification by optimizing the feature space\u2019s hyperplane margin.\n\u2022 GCN [27]: A classical graph learning algorithm. Its core idea is to simplify the polynomial convolution to a first-order form and realize information aggregation in a one-hop neighborhood.\n\u2022 GAT [24]: A classical spatial graph convolution algorithm. Its core idea is to determine the node importance of the first-order neighborhood by using the self-attention mechanism for localized convolution.\n\u2022 GCNII [28]: An effective extended model of GCN. The model is improved using the initial residual and identity mapping technology so that the convolutional layer can stack multiple layers. It performs well in heterogeneous and homogeneous graph processing.\n\u2022 GCNH [29]: A spatially localized convolution inspired by spectrum methods. Its core idea is to sparsify a generalized form of graph diffusion to effectively alleviate the issues of noisy edges and arbitrary definitions encountered in real graphs.\n\u2022 CAGNN [30]: An algorithm specifically designed for heterogeneous networks. It decouples node features into discriminative features for downstream tasks, aggregates features for graph convolutional layers and fuses the two features for classification through a shared mixer module.\n\u2022 SIGAT [31]: The SiGAT offers a new graph learning method for directed signed networks, utilizing social network theories and attention mechanisms to produce effective node embeddings.\n\u2022 HGNN [25]: HGNN extends the convolution operation to the domain of hypergraph learning. It implements spectrum convolution using hypergraph Laplacian, which is then efficiently approximated by truncated Chebyshev polynomials.\nTo demonstrate the advantage of our MHSA model in classifying MCI, four evaluation metrics were used: accuracy, sensitivity, precision, and F1-score. The optimal parameter combinations for all methods were identified using five-fold cross-validation and grid parameter optimization, and fair comparisons were conducted within a unified PyTorch environment equipped with an NVIDIA GeForce A800 GPU."}, {"title": "C. Main disease prediction results", "content": "In this section, the performance of MHSA in different MCI classification tasks is introduced in detail. Firstly, to validate the capacity of MHSA to distinguish between various subtypes of MCI, as shown in Table II, the ADNI dataset was divided into three specific classification tasks: NC vs. MCI, NC vs. LMCI, and NC vs. EMCI. The experimental results suggest that MHSA outperformed others in almost all evaluation metrics for these tasks. Meanwhile, to evaluate the efficacy of MHSA in the broader MCI classification task, as shown in Table III, MCI, LMCI, and EMCI were consolidated into a single disease category for comparison with NC. The experimental outcomes indicate that MHSA is more competitive on this task and demonstrates an overall leading effect. It outperforms the sub-optimal by 2.23% in accuracy and achieves a perfect score of 100% in sensitivity, showcasing its exceptional recognition capability. In terms of precision, it exceeds the second-best model by 0.12%. Additionally, in the F1 score, an indicator of the model\u2019s overall effectiveness, we have seen a 1.36% improvement over the second-ranked model. Overall, the experimental results in the two tables, along with the illustrative visualization in Fig. 3, fully demonstrate the advantage of MHSA in the task of MCI detection."}, {"title": "D. Hyperedge analysis in brain networks", "content": "The properties of hyperedge connections were analyzed in depth, with a focus particularly on the synchronization among multiple ROIs connected by the same hyperedge. The results, shown in Fig. 4, reveal a significant level of synchronization. This synchronization highlights the critical role of hyperedges in connecting different brain regions and demonstrates the collaborative dynamics in these regions during cognitive processes. The analysis of such synchronicity is the key to unveiling the intricate mechanisms underlying information transfer and neural computation in brain networks.\nThen, our analysis of brain networks in various MCI states focuses on the properties of the hyperedge. Fig. 5 demonstrates a significant difference in the number of vertices connected on the same hyperedge at different stages of MCI. The results suggest that to achieve the best detection effect of MCI at different stages, the number of vertices connected by one hyperedge is different. This difference may be related to the neurobiological mechanisms of cognitive decline, providing a potential avenue for further investigation into MCI.\nMoreover, we quantified the connectivity of individual brain regions by determining the number of hyperedges associated with each region and concentrated on the 10 regions exhibiting the highest connectivity, respectively regions PreCG.R, PreCG.L, TPOsup.L, CAU.L, PCL.L, MTG.L, POCG.L, MOG.L, TPOmid.L and PoCG.R, as depicted in Fig. 6. We propose that these regions are pivotal within the pathological network of MCI, not only occupying central positions within the brain network but also demonstrating strong associations between functional connectivity, metabolic activity, and structural integrity with cognitive function. Further examination of these regions equips medical professionals with a robust tool for more precisely predicting MCI progression, thereby providing a strong scientific foundation for early diagnosis and personalized treatment development."}, {"title": "E. Ablation analysis", "content": "A variety of extensive experiments were undertaken to confirm the significance of two pivotal elements of MHSA: PLV and the attention mechanism. PLV provides a synchronous analysis tool that can adeptly uncover the intricate interplay among signals. The removal of this component will result in constructing a hypergraph that relies only on the attention mechanism. The attention mechanism further optimizes the PLV, and if it is removed, the hypergraph construction will be reverted to a method based on pristine synchronous analysis. In this context, MHSA-attention and MHSA-PLV denote distinct component exclusion modes. To delve deeper into the significance of these components, this study removed both components simultaneously and used the distance-based KNN algorithm to construct brain networks [25]. This approach helped identify the critical role of these components by eliminating potential confounding factors. Finally, the findings presented in Table IV intuitively demonstrate the indispensable functions of these two components in the MHSA framework."}, {"title": "F. Parameter sensitivity and analysis", "content": "The analysis focused on three key parameters that have a significant impact on the performance of MHSA: the dimension of the hidden layer (hidden), the learning rate (lr), and the regularization parameter (\u03bb). Fig. 7 shows that the model achieves the best performance at hidden layer dimensions of 64 and 128. This result suggests that a higher-dimensional hidden layer is more suitable for capturing features in brain networks than its lower-dimensional counterparts. Notably, our findings suggest that excessively high learning rates should be avoided to mitigate potential model performance degradation. In contrast, choosing larger values for the regularization parameter leads to satisfactory results. Regarding the remaining parameters common to deep learning models, a standardized analysis was conducted within a predefined range of values. This comprehensive parameter examination has provided profound insights into how changes in these parameters specifically affect model performance."}, {"title": "V. CONCLUSION", "content": "In this study, we proposed MHSA, a novel hypergraph modeling method via synchronous and attentive fusion for MCI detection. We are innovative in using PLV as a new method to analyze the phase synchronization of fMRI in the spectrum domain. Subsequently, we implemented a multi-scale feature fusion mechanism, and a temporal-spectrum fusion matrix was generated to fully reflect the continuous dynamic changes of brain regions. Furthermore, using the hypergraph and graph representation learning technology based on the derived matrix. Experiments verify that our approach manifests effectively in various types of MCI detection. In future work, we will explore the potential application of the MHSA model to other neurodegenerative diseases."}, {"title": "VI. ACKNOWLEDGMENT", "content": "This work was supported by the National Natural Science Foundation of China (Grants No.62106020, 62466042), the Inner Mongolia University High-level Talent Project (Grant No.10000-23112101), the Inner Mongolia Autonomous Region to Introduce High-Level Talent Research Support Project in 2023 (Grant No.13100-15112038), the Beijing Natural Science Foundation (Grant No.L211020), and the Science and Technology Program of the Joint Fund of Scientific Research for the Public Hospitals of Inner Mongolia Academy of Medical Sciences (Grant No.2023GLLH0004)."}]}