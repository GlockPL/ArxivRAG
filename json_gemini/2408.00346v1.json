{"title": "Neural Graph Matching for Video Retrieval in Large-Scale Video-driven E-commerce", "authors": ["Houye Ji", "Ye Tang", "Zhaoxin Chen", "Lixi Deng", "Jun Hu", "Lei Su"], "abstract": "With the rapid development of the short video industry, traditional e-commerce has encountered a new paradigm, video-driven e-commerce, which leverages attractive videos for product showcases and provides both video and item services for users. Benefitting from the dynamic and visualized introduction of items, video-driven e-commerce has shown huge potential in stimulating consumer confidence and promoting sales. In this paper, we focus on the video retrieval task, facing the following challenges: (1) How to handle the heterogeneities among users, items, and videos? (2) How to mine the complementarity between items and videos for better user understanding? In this paper, we first leverage the dual graph to model the co-existing of user-video and user-item interactions in video-driven e-commerce and innovatively reduce user preference understanding to a graph matching problem. To solve it, we further propose a novel bi-level Graph Matching Network (GMN), which mainly consists of node- and preference-level graph matching. Given a user, node-level graph matching aims to match videos and items, while preference-level graph matching aims to match multiple user preferences extracted from both videos and items. Then the proposed GMN can generate and improve user embedding by aggregating matched nodes or preferences from the dual graph in a bi-level manner. Comprehensive experiments show the superiority of the proposed GMN with significant improvements over state-of-the-art approaches (e.g., AUC+1.9% and CTR+7.15%). We have developed it on a well-known video-driven e-commerce platform, serving hundreds of millions of users every day.", "sections": [{"title": "1 INTRODUCTION", "content": "In the era of the information explosion, the recommender system has become the most effective way to help users discover what they are interested from enormous data. As two basic Internet applications, e-commerce and content recommendation both provide the recommender service but focus on either item recommendation or content (e.g., video and live) recommendation. Recently, with the thriving of online applications, there is a surge of video-driven e-commerce [8], which integrates video and e-commerce for better services. Benefiting from vivid and attractive video shows, video-driven e-commerce provides a new business paradigm which improves user stickiness and activeness, and has become a new driving force for e-commerce development. For example, TikTok and Kuaishou integrate e-commerce with videos, while Taobao and JD.COM leverage videos to improve the user experience in traditional e-commerce. As shown in Figure 1(a), JD.COM first incentivizes authors to produce videos for related items, and then conducts video recommendations for users. Due to the large-scale video set, industrial recommendation systems usually adopt the classical two-stage architecture: retrieval and ranking [18]. Given a user, the retrieval stage aims to find thousands of candidate videos from the whole video set, then the ranking stage aims to precisely select hundreds of videos from the retrieved candidate videos.\nIn this paper, we focus on the video retrieval stage with the following challenges: (1) How to handle the heterogeneities among users, items, and videos? The characteristics of items (e.g., price, sales, and shop) are markedly different from videos (e.g., resolution, duration, and author) and them aim to stimulate user consumption and attract users stay, respectively. This disparity compels us to treat user-item interactions and user-video interactions with distinct considerations, given the unique characteristics each type of interaction manifests. (2) How to mine the complementarity between items and videos for better user understanding? While at a cursory glance these interactions may seem discrete, they exhibit a strong complementary nature upon closer examination. As exemplified in"}, {"title": "RELATED WORK", "content": "Recommendation System (RS), which mainly focuses on user preference understanding and recommends diverse types of candidates (e.g., items and videos) to them, has accompanied diverse paradigms, such as item recommendation [5, 6, 16], video recommendation [8, 13, 15], and business-driven recommendation [9, 10]. Real-world RS usually consists of two stages: retrieval [2, 14, 18] and ranking [1, 8]. YoutubeDNN [2] retrieves videos for online video services, while MIND [14] retrieves items for e-commerce. Unlike them, we study a newly emerging video-driven e-commerce, which models the co-existing of items and videos.\nCross-domain Recommendation (CDR) attempts to learn useful knowledge from the source domain to help the target domain. Hu et al. [7] propose CoNet to perform dual transfer at the unit level. [4, 8, 18, 21] unify both source and target domains as graph-structured data and perform CDR via graph learning. Significantly different from the above works, we we first model video-driven e-commerce as a dual graph and reduce it to a graph matching problem.\nGraph Neural Networks (GNNs) generalize deep learning to graph-structured data, where graph convolution [12] aims to aggregate neighbors information and update node embedding, while graph pooling [11, 19] aims to aggregate all node to update graph embedding. Recently, many works [1, 8, 18] apply GNNs to recommendation scenarios. SURGE [1] reduces user behaviors into graphs and then extracts users' core interests via cluster-aware graph pooling. Furthermore, several works [8, 18, 20] generalize GNN to multiple interactions (or domains). MGFN [20] proposes a multi-graph learning for cross domain video recommendation. Different from the above works, we first propose a novel bi-level graph matching network to align user behaviors and preferences on both videos and items for retrieval."}, {"title": "3 PRELIMINARIES", "content": "Definition 3.1. Dual Graph. The dual graph, termed as $\\mathcal{G}=(\\mathcal{G}_{U-V}, \\mathcal{G}_{U-I})$, describes the co-existing of user behaviors on both videos and items in video-driven e-commerce. Here $\\mathcal{N}=\\mathcal{N}_U \\cup \\mathcal{N}_V \\cup \\mathcal{N}_I$ is the union set of User, Video, and Item, respectively. Also, $\\mathcal{E}=\\mathcal{E}_{U-V} \\cup \\mathcal{E}_{U-I}$ is the edge set, where $\\mathcal{E}_{U-V}=(\\mathcal{N}_U,\\mathcal{N}_V)$ denotes User-Video interaction and $\\mathcal{E}_{U-I}=(\\mathcal{N}_U,\\mathcal{N}_I)$ denotes User-Item interaction.\nExample. Figure 1(b) gives an illustrative example of the dual graph in video-driven e-commerce. Given a user $u$ and the dual graph $\\mathcal{G}$, we can obtain his neighbor sets, including $\\mathcal{N}_{u-1}=\\{i|(u, i) \\in \\mathcal{E}_{U-I}\\}$ from $\\mathcal{G}_{U-I}$. In the dual graph, user $u_1$'s neighbor sets are $\\mathcal{N}_{u-1}=\\{i_1, i_2, i_3, i_4\\}$ and $\\mathcal{N}_{u-V}=\\{v_1, v_2\\}$, respectively. Furthermore, we also extract user-centric sub-graphs for user $u$ from the dual graph, termed as $\\mathcal{G}_u = (\\mathcal{G}_{U-V},\\mathcal{G}_{U-I})$. In detail, $\\mathcal{G}_{U-V}$ contains multi-hops neighbors of user $u$ and himself (i.e., $\\mathcal{V}_{U-V} = \\mathcal{N}_{U-V} \\cup u$), as well as induced edges $\\mathcal{E}_{U-V}^{U-V}$. Note that, dual graphs can be widely used in many other related fields, such as the co-existing of user-music and user-movie, or even the co-existing of user-item(old/warm domain) and user-item(new/cold domain).\nFinally, we formulate the video retrieval problem in video-driven e-commerce as follows:\n$$\\arg \\max_{v \\in \\mathcal{N}_V} Pr(v|u; \\mathcal{G}),$$\nwhich aims to retrieve candidate videos $v$ from the whole video set $\\mathcal{N}_V$ for user $u$ based on the dual graph $\\mathcal{G}$."}, {"title": "4 THE PROPOSED MODEL", "content": "In this section, we present a novel Graph Matching Network, which aims the to match the users' behaviors as well as preferences via both node- and preference-level graph matching. The overall framework of GMN is shown in Figure 2."}, {"title": "4.1 Embedding Initialization", "content": "In this section, we first initialize the node embeddings of users, videos, and items via feature embeddings, and then update them via GNNs. Taking embedding initialization of video $u$ as an example, we have:\n$$x_v^0 = ||f_v||x_v,$$  where $||$ denotes the vector concatenation, $x_v^f$ and $x_v$ denote the initial embedding of video $v$ and the f-th feature embedding of video v, respectively. After that, we further utilize two interaction-specific GNNs (i.e., GNN$_{U-V}$ and GNN$_{U-I}$) to update corresponding embeddings. Given video $v$ and $\\mathcal{G}_{U-V}$, GNN$_{U-V}$ is able to update the video $x_v^{U-V}$ embedding via aggregating its neighbors $\\mathcal{N}_{U-V}$, as follows:\n$$x_v^{U-V} = \\text{GNN}_{U-V}(x_u|u \\in \\mathcal{N}_{U-V}).$$\nNote that, we focus on bi-level graph matching and simply instantiate GNN$_{U-V}$ as the MeanPooling [9, 10]. Similarly, the embedding of item $i$ via GNN$_{U-I}$ is $x_i^{U-I}$. For user $u$, we can also get his embeddings on the dual graph $x_u^{U-V}$ and $x_u^{U-I}$."}, {"title": "4.2 Node-level Graph Matching", "content": "In this section, we propose node-level graph matching to mine the relevance between videos and items in the dual graph, and then enhance their connections via aggregating cross-graph neighbors based on the matching scores.\nTo handle large-scale video-driven e-commerce, we first extract user-centric sub-graphs (i.e., $\\mathcal{G}_{u-V}$ and $\\mathcal{G}_{u-I}$) for user $u$, and then actually perform the node-level graph matching $\\text{GMN}_L$ on them, shown as follows:\n$$\\mathcal{R}_u = \\text{GMN}_L(\\mathcal{G}_{u-V},\\mathcal{G}_{u-I}).$$\nHere $\\mathcal{R}_u \\in R^{|\\mathcal{V}_{U-I}|\\times|\\mathcal{V}_{U-V}|}$ denotes the personalized relevance matrix of user $u$ in node-level. Given a user $u$, the personalized relevance score $r_{v,i}^u$ between video $v \\in \\mathcal{G}_{u-V}$ and item $i \\in \\mathcal{G}_{u-I}$ is shown as follows:\n$$r_{v,i}^u = (x_v^{U-V})^\\top \\mathbf{M} \\cdot x_i^{U-I}.$$ \nHere $(\\cdot)^\\top$ denotes the transposition operator. $\\mathbf{M}$ is a learnable metric matrix, harmonizing the embeddings of heterogeneous nodes (video v.s. item). Obviously, the personalized relevance score $r_{v,i}^u$ is dynamically changed with regard to users, videos, and items.\nAfter obtaining the personalized relevance scores $\\{r_{v,i}^u\\}$, we normalize them via the softmax function to get the personalized matching scores $s_{v \\leftarrow i}^u$ and $s_{i \\leftarrow v}^u$, shown as follows:\n$$s_{v \\leftarrow i}^u = \\text{softmax}_i(r_{v,i}^u) = \\frac{\\exp(r_{v,i}^u)}{\\sum_{i'\\in \\mathcal{V}_{U-I}} \\exp(r_{v,i'}^u)},$$  $$s_{i \\leftarrow v}^u = \\text{softmax}_v(r_{v,i}^u) = \\frac{\\exp(r_{v,i}^u)}{\\sum_{v'\\in \\mathcal{V}_{U-V}} \\exp(r_{v',i}^u)}.$$\nNote that the above matching scores are asymmetric since they are normalized on different node sets (i.e., $\\mathcal{V}_{U-I}$ and $\\mathcal{V}_{U-V}$). Given a user $u$, the personalized matching score $s_{v \\leftarrow i}^u$ measures the matching level from item $i$ to video $v$. Intuitively, aggregating relevant items embeddings into video embeddings is able to the alleviate the heterogeneity and sparsity problem, improving user preference understanding and the effectiveness of video retrieval.\nTaking personalized matching scores (e.g., $\\{s_{v \\leftarrow i}^u\\}$) as coefficients, we can properly summarize all information $\\sum_{i \\in \\mathcal{V}_{U-I}} s_{v \\leftarrow i}^u x_i^{U-I}$, which needs to propagate from relevant items $i \\in \\mathcal{G}_{u-I}$ to video $v$, and then utilize it to enhance the video embedding. The final video"}, {"title": "4.3 Preference-level Graph Matching", "content": "In this section, we introduce a novel method for preference-level graph matching. This method mines the relevance of user preferences for videos and items. Subsequently, this relevance is utilized in cross-graph propagation to refine preference embeddings.\n4.3.1 Extracting User Preferences via Dual Graph Pooling. Specifically, we propose a novel dual graph pooling method (i.e., GPN$^{U-V}$ and GPN$^{U-I}$) to cluster user-centric sub-graphs (i.e., $\\mathcal{G}_{u-V}$ and $\\mathcal{G}_{u-I}$) as preference graphs, where each node indicates a cluster of similar videos or items and corresponding user preferences.\nGiven a user $u$ and $\\mathcal{G}_{u-V}$, a graph pooling network GPN$^{U-V}$ is able to cluster all video embeddings $\\{h_v^{U-V}|v \\in \\mathcal{V}_{U-V}\\}$ into $k_1$ preferences, and constructs the condensed preference graph $\\mathcal{Z}^{U-V}$:\n$$\\mathcal{Z}^{U-V} = \\text{GPN}^{U-V}(\\mathcal{G}^{U-V}),$$  $$\\{z_{u_{k_1}}^{U-V},\\dots, z_{u_{k_1}}^{U-V}\\} = \\text{GPN}^{U-V}(h_v^{U-V}),$$\nwhere $z_{u_{k_1}}^{U-V}$ is the embedding of the $k_1$-th user preference. If we set $k_1 > 1$, then GPN$^{U-V}$ actually extracts multiple types of user preferences. Therefore, we simply instantiate GPN$^{U-V}$ as the MeanPooling [9] Similarly, we use GPN$^{U-I}$ to extract $k_2$ preference embeddings $\\{z_{u_{k_2}}^{U-I},\\dots, z_{u_{k_2}}^{U-I}\\}$ for user $u$ from $\\mathcal{G}^{U-I}$.\n4.3.2 Improving Preference Embedding via Preference-level Graph Matching. Intuitively, user preferences on both videos and items also have potential relevance. So we further propose the preference-level graph matching GMN$_{PL}$, which learns the preference-level relevance matrix $\\mathbf{P}_u \\in R^{k_1\\times k_2}$ between preference graphs (i.e., $\\mathcal{Z}^{U-V}$ and $\\mathcal{Z}^{U-I}$), shown as follows:\n$$\\mathbf{P}_u = \\text{GMPL}(\\mathcal{Z}^{U-V},\\mathcal{Z}^{U-I}),$$ \nwhere each element $p_{k_1,k_2}^u$ indicates the relevance between the $k_1$-th video preference and the $k_2$-th item preference of user $u$, as follows:\n$$p_{k_1,k_2}^u = (z_{u_{k_1}}^{U-V})^\\top z_{u_{k_2}}^{U-I}.$$\nThen, we also normalize $p_{k_1,k_2}^u$ on $\\mathcal{Z}^{U-V}$ and $\\mathcal{Z}^{U-I}$ via softmax, and get corresponding matching scores $s_{k_1 \\leftarrow k_2}^u$ and $s_{k_1 k_2}^u$. Then, the embeddings of preference nodes can be enhanced via bi-directional propagation, as follows:\n$$e_{u_{k_1}}^{U-V} = z_{u_{k_1}}^{U-V} + \\sum_{u_{k_2} \\in \\mathcal{Z}^{U-I}} s_{k_1 \\leftarrow k_2}^u z_{u_{k_2}}^{U-I},$$  $$e_{u_{k_2}}^{U-I} = z_{u_{k_2}}^{U-I} + \\sum_{u_{k_1} \\in \\mathcal{Z}^{U-V}} s_{k_1 k_2}^u z_{u_{k_1}}^{U-V}.$$\nInteractively performing graph pooling and graph matching on preference graphs for $L$ times, we can progressively compress the original graph into a single node (i.e., $k_1 = k_2 = 1$), termed as $e^{U-I}$ and $e^{U-I}$, representing the overall user preferences."}, {"title": "4.4 Prediction and Optimization", "content": "To comprehensively understand user preferences, we fuse user preferences on both videos and items, and get the final user embedding $z_u$ of user $u$, as follows:\n$$z_u = \\text{MLP}(e^{U-V}||e^{U-I}||x^{U-V}||x^{U-I}).$$\nSince the feature of video is much simpler and more stable than users, we only perform GMN for user modeling, and the final embedding $z_v$ of video $v$ is actually $x_v^{U-V}$. Similar to previous works[1, 8, 17], we do not use a more sophisticated fusion network (e.g., attention-based fusion), so the effectiveness of bi-level graph matching can be clearly verified.\nThe estimated preference $\\hat{y}_{u,v}$ of user $u$ towards the target video $v$ is the inner product of their embeddings:\n$$\\hat{y}_{u,v} = (z_u)^\\top \\cdot z_v.$$\nThe overall loss function is as follows:\n$$\\mathcal{L} = \\sum_{(u,v,v_{neg}) \\in \\mathcal{D}} -\\ln \\sigma(\\hat{y}_{u,v} - \\hat{y}_{u,v_{neg}}) + \\lambda \\cdot ||\\Theta||_2,$$  where $\\Theta$ denotes all trainable model parameters, and $\\lambda$ controls the L2 regularization strength to prevent overfitting. The whole model can be optimized via back-propagation."}, {"title": "4.5 Model Analysis", "content": "Here we give the analysis of the proposed GMN as follows:\n Considering the characteristics of video-driven e-commerce, we first represent it as the dual graph, and then reduce user preference understanding to a bi-level graph matching problem. So, the proposed GMN focused on matching relevant nodes (e.g., videos and items) and preferences properly in a bi-level manner, rather than designing better GNN architectures to learn nodes and preferences embeddings. Similar to previous works [3, 9, 10], we adopt basic GNNs as backbones, so the effectiveness of bi-level graph matching could be clearly verified.\n We analyze the time complexity of GMN in both the node- and preference-level graph matching. In the node-level graph matching, if we directly match all nodes between $\\mathcal{G}^{U-V}$ and $\\mathcal{G}^{U-I}$, the computational cost is $O(|\\mathcal{N}^V|\\cdot |\\mathcal{N}^I|)$, which is unacceptable for real-world scenarios. Fortunately, we actually match user-centric"}, {"title": "5 OFFLINE EVALUATIONS", "content": "5.1 Datasets.\nAlthough video-driven e-commerce has grown rapidly on many platforms, related data is protected by privacy and security policies. Therefore, we sample user logs from a real-world video-driven e-commerce platform, and then extract two large-scale dual graph datasets from different time periods (7-days, and 30-days) for verification. We also use a public dataset MovieLens-1M released by GIFT[8] to mimic video-driven e-commerce, which takes user-movie (warm) as user-item interaction and user-movie (cold) as user-video interaction, respectively. The details of the datasets are shown in Table 1."}, {"title": "5.2 Baselines.", "content": "To validate the effectiveness of GMN, we first select single interaction based methods (i.e., YoutubeDNN[2], MIND[14], and SURGE[1]) as well as multiple interactions based methods (i.e., GIFT[8], MGFN[20], and CCDR[18]). Since MIND and SURGE cannot be directly applied to the dual graph, we also provide corresponding dual versions (i.e., MIND+ and SURGE+) for better performance. The baselines are shown below:\n YoutubeDNN[2]: It is a classical model for large-scale video retrieval, utilizing two-tower architecture to learn the embeddings of users and videos based on their features.\nMIND/MIND+[14]: MIND is a classical retrieval model, which utilizes a dynamic routing mechanism to extract users'"}, {"title": "5.3 Implementation.", "content": "For all models, we random initialize parameters with Xavier initializer and select Adam as the optimizer. For a fair comparison, we use the following hyper-parameters for all models: the dimension of node embedding is 128, the learning rate is 0.0015, the L2 regularizer is 0.01, and the dropout rate is 0.75. For MIND and SURGE, we use the multiple preferences version and set the maximum number of preferences to 5. For YoutubeDNN, we use 3 layer DNN (1024-512-256) for prediction. For offline evaluation, we select AUC, Precision, Recall, and Loss as evaluation metrics. We implement all models with TensorFlow 1.15 and run them on Nvidia A100 Cluster. The code of GMN and the anoymous version of the industrial dataset will be released after acceptance."}, {"title": "5.4 Performance Comparison", "content": "The comparison results are shown in Table 2, where we have the following observations:\n The proposed GMN consistently performs better than all baselines with significant gaps. Compared to the best performance of baselines, the improvements of GMN on AUC metric is up to 1.2%-1.9% on large-scale video-driven e-commerce, which indicates the effectiveness of both node- and preference-level modeling in the proposed GMN for video retrieval.\n Multiple interactions based methods (i.e., MIND+ and CCDR) outperform single graph methods (i.e., MIND and SURGE). It makes sense because both user-video and user-item interactions are able to provide valuable information for understanding user preferences. By capturing the correlation between two types of interaction, GIFT, MGFN, CCDR, and GMN always show their superiority over concatenate based models (i.e., MIND+ and SURGE+).\nGNN-based models, including SURGE, GIFT, MGFN, CCDR, and GMN, perform better than traditional DNN-based models (i.e., MIND and YoutubeDNN), indicating the effectiveness of graph structure modeling in the recommendation."}, {"title": "5.5 Ablation Study", "content": "In this section, we conduct both model-level and graph-level ablation studies for further verification, shown in Table 3.\n Model-level. We first conduct a model-level ablation study to show how the delicate designs in GMN affect performance. As shown in Table 3, we test two variants of GMN (GMN\\$_{NL}$ and GMN\\$_{PL}$), which remove node- and preference-level graph matching, respectively. Obviously, GMN performs better than both"}, {"title": "5.6 Case Study", "content": "We further present a case study to show the potential interpretability of GMN. Taking a young boy as an example who is interested in the Apple iPhone and the Casio watch, he has interacted with related items and videos. Figure 3 shows the heatmap on both node- and preference-level relevance matrix, where darker color means higher relevance. Since item i9 and video v8 are both related to iPhone, the node-level relevance score $r_{v_8, i_9}^u$ is high. A similar phenomenon can be observed at the preference-level (e.g., $p_{1,1}^u$)."}, {"title": "5.7 Parameter Study", "content": "In this section, we investigate the sensitivity of parameters and report the performance of GMN on the offline 7-days dataset with various parameters in Figure 4.\n Dimension of Metric Matrix. As shown in Figure 4(a), we test the effect of the dimension of the metric matrix M. Obviously, with the growth of the dimension, the performance of GMN continues to rise. The reason is that, a larger dimension enables the proposed GMN to properly measure the similarity between videos and items.\n Number of User Preferences. Naturally, most users have diverse preferences, and one preference fails to comprehensively"}, {"title": "6 ONLINE EVALUATIONS", "content": "6.1 Online A/B Testing\nWe conduct A/B testing during 0907-0925 (19 days) for online evaluations, shown in Figure 6. Although MIND+ is not the strongest benchmark in offline evaluation, it is the previously deployed model, affecting hundreds of millions of users every day. Therefore, we use MIND+ as the baseline in online A/B testing. Here, we select the widely used CTR\\footnote{CTR = $\\frac{\\text{Number of clicked videos}}{\\text{Number of exposed videos}} \\times 100(\\%)$  }  to evaluate online performance. The larger CTR means users are willing to click the exposed videos recommended by our system and indicates better performance.\nAs shown in Figure 6, the proposed GMN consistently shows significant superiority over the previously deployed MIND+ on all days. More specifically, the average CTR of the proposed GMN is 3.74% while MIND+ achieves only 3.49%, resulting in a CTR improvement of up to 7.15%. Following [8], we also use TP99\\footnote{TP99 is a minimum time that 99% of queries have been served.}  response time to evaluate the efficiency of our system, shown in Figure 7. Full-day observation shows that the response time of the proposed GMN"}, {"title": "6.2 System Architecture and Online Serving.", "content": "Here we present how to deploy the proposed GMN system for real-world video-driven e-commerce, shown in Figure 5. For offline training, we collect real-world user clicks as positive samples and random sample several videos as negative samples. Then, we sample user-centric sub-graphs and associate them with training samples as training data. The trained model will be divided into two parts and developed in different platforms: (1) The user part, which is developed to the model center, will generate user embedding based on real-time user behavior. (2) The video part, which is developed to the retrieval center, will retrieve candidate videos based on user embedding."}, {"title": "7 CONCLUSION", "content": "The thriving of e-commerce is accompanied by a newly emerging paradigm, video-driven e-commerce, which utilizes attractive videos to improve user experience and stimulate consumption. In this paper, we propose the dual graph to represent video-driven e-commerce and innovatively reduce the user preference understanding problem to a graph matching problem. To solve it, we further propose a novel Graph Matching Network (GMN), which mainly consists of node- and preference-level graph matching. By properly matching the heterogeneous interactions and preferences,"}]}