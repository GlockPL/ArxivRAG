{"title": "Improving Automatic Fetal Biometry Measurement with Swoosh Activation Function*", "authors": ["Shijia Zhou", "Euijoon Ahn", "Hao Wang", "Ann Quinton", "Narelle Kennedy", "Pradeeba Sridar", "Ralph Nanan", "Jinman Kim"], "abstract": "The measurement of fetal thalamus diameter (FTD) and fetal head circumference (FHC) are crucial in identifying abnormal fetal thalamus development as it may lead to certain neuropsychiatric disorders in later life. However, manual measurements from 2D-US images are laborious, prone to high inter-observer variability, and complicated by the high signal-to-noise ratio nature of the images. Deep learning-based landmark detection approaches have shown promise in measuring biometrics from US images, but the current state-of-the-art (SOTA) algorithm, BiometryNet, is inadequate for FTD and FHC measurement due to its inability to account for the fuzzy edges of these structures and the complex shape of the FTD structure. To address these inadequacies, we propose a novel Swoosh Activation Function (SAF) designed to enhance the regularization of heatmaps produced by landmark detection algorithms. Our SAF serves as a regularization term to enforce an optimum mean squared error (MSE) level between predicted heatmaps, reducing the dispersiveness of hotspots in predicted heatmaps. Our experimental results demonstrate that SAF significantly improves the measurement performances of FTD and FHC with higher intraclass correlation coefficient scores in FTD and lower mean difference scores in FHC measurement than those of the current SOTA algorithm BiometryNet. Moreover, our proposed SAF is highly generalizable and architecture-agnostic. The SAF's coefficients can be configured for different tasks, making it highly customizable. Our study demonstrates that the SAF activation function is a novel method that can improve measurement accuracy in fetal biometry landmark detection. This improvement has the potential to contribute to better fetal monitoring and improved neonatal outcomes.", "sections": [{"title": "1 Introduction", "content": "The thalamus is a critical brain region that relays and modulates information between different parts of the cerebral cortex, and plays a vital role in signal transmission and processing, including pain recognition and reaction [13]. Abnormal fetal thalamus development, which can disrupt serotonin receptor development, may contribute to the development of later neuropsychiatric disorders [12]. Thalamus development is influenced by maternal factors such as diabetes that suppresses thalamus development after 2 weeks of gestation [16]. To further investigate the relationship between maternal factors and fetal thalamus growth, a dataset containing maternal factors, fetal thalamus diameter (FTD), and fetal head circumference measurements (FHC) is needed. FHC measurement is necessary to normalize FTD against gestational age. However, measuring FTD and FHC manually from 2D-US scans is laborious, prone to high inter-observer variability, and complicated by 2D-US images' high signal-to-noise ratio (SNR) nature due to ultrasound wave's lack of penetration power compared to ionizing radiations such as the x-ray, acoustic shadows cast by highly echogenic objects, and unique noise characteristics due to ultrasound reverberation [3,9,4].\nIn recent years, landmark-based detection approaches based on deep learning have been employed to measure biometrics from fetal US images. They were used to detect measurement key points for brain structures in the fetal brains, and bony structures such as length of the femur or dimensions in the pelvic floors [2,7,14]. In these studies, the distance between a pair of landmarks represents the biometry being measured. The current state-of-the-art (SOTA) landmark detection algorithm for measuring biometry in fetal 2D-US images is the BiometryNet proposed by Avisdris et al., which was developed to detect landmarks for measuring the FHC and fetal femur length [2]. BiometryNet is based on High-Resolution Net (HRNet) and it has shown great performances in measuring dimensions of fetal skull and femur bone, outperforming other landmark-based methods [10]. BiometryNet uses dynamic orientation determination (DOD) to enforce a consistent orientation between detected landmarks', i.e. the first landmark is always the left/top measurement key point, and the second landmark is always the right/bottom key point [2].\nHowever, BiometryNet cannot be directly used to measure FTD and FHC due to two specific difficulties. First being that the \"guitar-shaped\" structure (GSS) by Sridar et al. to measure FTD has similar echogenicity to surrounding brain tissues, resulting in fuzzy boundaries, especially around the wing-tips where measurement landmarks are located [9] (Fig. 1). This difficulty is also observed in 2D-US images of fetal skulls when they appear broken due to unfused bones and acoustic shadows cast by the skull bones themselves (Fig. 1). Second being that the shape of the GsS resembles the silhouette of a guitar and more complex than that of a skull or femur bone (Fig. 2) [9]. These two difficulties causes uncertainties in the localization of measurement landmarks of FTD, resulting in inaccurate measurement of FTD.\nTo address the above difficulties, we present a novel Swoosh Activation Function (SAF) designed to enhance the regularization of heatmaps produced by"}, {"title": "2 Method", "content": "2.1 Swoosh Activation Function\nSAF is introduced to optimize pHs by enforcing an optimum MSE between a pair of pHs and a secondary optimum MSE between a predicted heatmap (pH) and a zero matrix (O). We determine the optimum MSE by computing the MSE between a pair of ground truth heatmaps (gHs). Each ground truth heatmap (gH) represents a measurement landmark by a smaller matrix drawn from a Gaussian distribution that is centered at the landmark coordinates with the peak assigned at the value of 1 (Fig. 3.A). Since we determine that gHs represent optimum heatmaps, the MSE between a pair of pHs should approximate the MSE between a pair of gHs. In addition, the secondary optimum MSE between a pH and a zero matrix is half of the MSE between a pair of gHs, since only one Gaussian distribution is being compared. We demonstrate in Fig. 3.B and C how deviations from this optimum MSE value can lead to incorrect and noisy heatmaps.\nTo enforce this pre-determined optimum MSE, we defined SAF as:\n$f(x > 0)) = (ax + \\frac{1}{bx})^c Min$\t\t\t(1)"}, {"title": "2.2 SAF Regularization", "content": "The loss function consists of the MSE between pH and gH, and three additional SAF regularization terms. We chose SAF as the activation function to control these regularization terms because SAF's output grows exponentially on either side of the minimum point (Supplementary Fig. 1) where the x-axis represents input values of MSE(pH1,pH2), MSE(pH1,O), and MSE(pH2,O), while y-axis represents the output values of SAF which minimize to 0 when input values approximate the predetermined optimum MSE. SAF locks the input MSE to the pre-determined optimum value because deviation from this value would result in a fast increase in the gradient of SAF. The first SAF term regularizes the MSE between a pair of pHs. The next two SAF terms regularize the MSE between each pH and a zero matrix. The equation for the entire loss function is:\nL(pH1, pH2, gH1, gH2,O) = MSE(pH1, gH1) + MSE(pH2,gH2)+\nSAF(MSE(pH1,pH2)) + SAF(MSE(pH1,O))+\nSAF(MSE(pH2, O))\t\t\t(2)"}, {"title": "2.3 Datasets", "content": "FTD Dataset: The dataset used in this study consists of 1111 2D-US images acquired during the second trimester of pregnancies and confirmed by board-certified ultrasonographers to be suitable for measuring FTD [8]. No additional ethics approval was required. Spatial constraints were provided by manually added bounding boxes around the GsS, verified by the same ultrasonographers. Pycocotools generated two gHs for each pair of measurement landmarks, with hotspots representing landmarks [6]. 5-fold cross-validation was performed. During training, 100 training samples were randomly held out as the validation set. The intraclass correlation coefficient (ICC) score was computed using IBM\u2122\u2122 SPSSTM version 28, with the ICC configuration being Two-Way Random and Absolute Agreement [5].\nHC18 Dataset: HC18 dataset is available on the Grand Challenge website [11]. We utilized least squared fitting of an ellipse to determine the center, width, height, and angle of rotation of the elliptical ground truth mask. We used trigonometry to determine the coordinates of the landmarks for the major"}, {"title": "2.4 Experimental Setup", "content": "Training Epochs and Learning Rate We conducted our experiments using PyTorch version 1.12 on two NVIDIA GTX-1080Ti graphical processing units, each with 11GB of video memory. For landmark detection training, we used the same learning rate configuration as Avisdris et al. [2] to train both BiometryNet with / without SAF. Specifically, we set the initial learning rate to 10-5 and reduced it using a multi-step learning rate scheduler that scaled the learning rate by a factor of 0.2 at epoch numbers 10, 40, 90, and 150. We trained all BiometryNet models for a total of 200 epochs. For EfficientNet with / without SAF, we set the initial learning rate to 10-5 and reduced it using a multi-step learning rate scheduler that scaled the learning rate by a factor of 0.1 at epoch number 300 and 350. We trained both models for 400 epochs.\nPre-processing Our pre-processing pipeline included random rotation of \u00b1 180 degrees, random re-scaling of \u00b1 5%, resizing to 384 \u00d7 384 pixels without pre-serving aspect ratio, and normalization using ImageNet-derived mean = (0.485, 0.456, 0.406) and standard deviation = (0.229, 0.224, 0.225) for each color channel.\nSAF Configuration Given our dataset configuration where each biometry landmark was represented by a 19 \u00d7 19 matrix with values derived from a Gaussian distribution with the center point's value peaked at 1, the MSE between a pair of gHs was 0.0061. This configuration followed the standard implementation used in human pose estimation landmark detection [15]. The secondary optimum MSE between a pH and a zero matrix was halved at 0.00305. We also predetermined the value of Min to be 0.001 to prevent SAF from overpowering the MSE loss between gHs and pHs. We experimented with different values of the coefficient a (1, 4, and 8) to evaluate coefficient a's influence on landmark detection accuracy. We then determined the value of coefficient b using Supplementary Eq. 1, and the value of coefficient c using Supplementary Eq. 2. We conditionally activated SAF when the average of MSE(pH1, gH1) and MSE(pH2, gH2) was less than 0.0009 because SAF is not bounded and early activation would hinder algorithm learning. The proposed SAF algorithm was evaluated using six model configurations, including Vanilla BiometryNet, BiometryNet with SAF with coefficient a values of 1, 4, and 8, an EfficientNet, and"}, {"title": "3 Results", "content": "The results of FTD dataset show that BiometryNet with SAF_al (BiometryNet_SAF_a1) achieved the highest ICC score at 0.737, surpassing the performance of the vanilla BiometryNet, which scored 0.684. Moreover, BiometryNet with SAF_a4 (BiometryNet_SAF_a4) and BiometryNet with SAF_a8 (BiometryNet_SAF_a8) also demonstrated superior ICC scores for FTD measurement, albeit to a lesser degree than BiometryNet_SAF_al. The impact of SAF on performance was further observed in the modified EfficientNet, where Efficient-Net_SAF_a4 achieved a higher ICC score of 0.725, compared to the modified Efficient Net without SAF, which only scored 0.688. We also observed that SAF reduced the similarities between a pair of pHs and the dispersiveness of hotspot in the pH. We display such heatmaps produced by BiometryNet in Fig.4.A and BiometryNet_SAF_al in Fig.4.B.\nFor the HC18 dataset, BiometryNet_SAF_a8 demonstrated the lowest measurement mean difference from the ground truth at 3.86 mm \u00b1 7.74 mm. Additionally, all configurations outperformed the vanilla BiometryNet. The impact on FHC measurement was further observed in the modified EfficientNet, where"}, {"title": "4 Discussion", "content": "The main findings of this study are as follows: (1) SAF improved the measurement accuracy of algorithms in both FTD and FHC measurement tasks; (2) SAF regularization is architecture-agnostic, as it improved the measurement accuracy of both BiometryNet and EfficientNet compared to their vanilla forms that do not use SAF; and (3) the optimum configuration of SAF coefficients is task-dependent. For FTD measurement, the most optimum configuration was to use a = 1, while for FHC measurement was with coefficient a = 8.\nThe results demonstrate the performance improvement brought about by SAF regularization, effectively improving the accuracy of landmark detection of fetal biometries in 2D-US images. SAF regularization forces a pair of heatmaps to highlight different areas and reduce the dispersiveness of hotspots in pHs, which results in improved fetal biometry landmark detection accuracy. This is supported by the comparison of heatmaps produced by BiometryNet and BiometryNet_SAF_al displayed in Fig. 4. Moreover, SAF regularization is simple to implement and easy to configure, requiring no modification to the network architecture. Our results also suggest that SAF is highly generalizable as it is architecture-agnostic, improving the performance of both BiometryNet and EfficientNet. SAF is also highly configurable for different tasks via different coefficient configurations. Furthermore, we also suggest that SAF is generalizable to other imaging modalities that also require pair-wise landmark detection. For example, detecting mitral and aortic valves in 2D-US images of heart and detecting cranial sutures in CT images of skull.\nAs part of our future study, we will explore the effectiveness of SAF regularization in other fetal landmark detection tasks, especially those that suffer from similar issues with fuzzy edges and uncertain landmark locations. Addi-"}, {"title": "5 Conclusion", "content": "Our study demonstrated the effectiveness of SAF as a novel activation function for regularizing heatmaps generated by fetal biometry landmark detection algorithms, resulting in improved measurement accuracy. SAF outperformed the previous state-of-the-art algorithm, BiometryNet, in both FTD and FHC measurement tasks. Importantly, our results showed that SAF is architecture-agnostic and highly configurable for different tasks through its coefficients, making it a generalizable solution for a wide range of landmark detection problems."}]}