{"title": "CrySPAI: A new Crystal Structure Prediction Software Based on Artificial Intelligence", "authors": ["Zongguo Wang", "Ziyi Chen", "Yang Yuan", "Yangang Wang"], "abstract": "Crystal structure predictions based on the combination of first-principles calculations and machine learning have achieved significant success in materials science. However, most of these approaches are limited to predicting specific systems, which hinders their application to unknown or unexplored domains. In this paper, we present CrySPAI, a crystal structure prediction package developed using artificial intelligence (AI) to predict energetically stable crystal structures of inorganic materials given their chemical compositions. The software consists of three key modules, an evolutionary optimization algorithm (EOA) that searches for all possible crystal structure configurations, density functional theory (DFT) that provides the accurate energy values for these structures, and a deep neural network (DNN) that learns the relationship between crystal structures and their corresponding energies. To optimize the process across these modules, a distributed framework is implemented to parallelize tasks, and an automated workflow has been integrated into CrySPAI for seamless execution. This paper reports the development and implementation of AI AI-based CrySPAI Crystal Prediction Software tool and its unique features.", "sections": [{"title": "1. Introduction", "content": "Crystal structure plays a fundamental role in understanding the physical and chemical properties of solid materials. One of the key challenges in materials research is how to efficiently and accurately determine crystal structures. Currently, two primary approaches are used to obtain target structures for inorganic materials. The first approach involves searching for similar structures in established crystal structure databases, such as the Inorganic Crystal Structure Database (ICSD)[1], the Pauling File[2], and others. The second approach involves predicting crystal structures by substituting elements in structure prototypes using high-throughput techniques[3-5]. While these methods can sometimes yield accurate structures quickly, they are less effective when dealing with new or unknown structure types. Moreover, the extremely high computational cost associated with the substitution method limits its practical applicability. Consequently, the ability to rapidly predict crystal structures based solely on chemical composition remains a pressing issue in theoretical materials research.\nIn recent years, several computational methods have been proposed and widely used for crystal structure prediction. These include the simulated annealing algorithm (SA)[6], genetic algorithm (GA)[7-11], particle swarm optimization (PSO)[12-13], and ab initio random structure searching (AIRSS)[14]. These methods have achieved notable success in predicting the structures of element, binary, ternary systems. Building on these approaches, several software packages for structure prediction have also been developed. Notable examples include USPEX (Universal Structure Predictor: Evolutionary Xtallography), which uses GA method[7-8], CALYPSO (Crystal structure AnaLYsis by Particle Swarm Optimization), which is based on PSO method [13], an adaptive-GA method that combines classical potential and DFT calculations[11], and XTALOPT, which implements an evolutionary algorithm with hybrid operators[15]. In all of these packages and workflows, structural energies are typically calculated using density functional theory (DFT). While DFT provides accurate results, its high computational cost limits the size and complexity of the structure cells that can be modeled. In addition, the accuracy of DFT is influenced by the choice of exchange-correlation functional and basis set, which can introduce uncertainties in energy rankings and affect the prediction of the most stable structures. In contrast, artificial intelligence technologies offer the advantage of lower computational costs and shorter development cycles, presenting a promising alternative.\nWith the increasing performance of artificial intelligence across various fields, machine learning, coupled with powerful DFT data, has become increasingly common in materials design and discovery[16-23]. In particular, interatomic potentials trained by machine learning have been employed to predict thermodynamical and other properties of bulk materials, achieving DFT-level accuracy for energy calculations. The typical models include structure-property relationship model and force field model. Structure-property relationship mainly includes Crystal Graph Convolutional Neural Network (CGCNN)[24], MatErials Graph Network (MEGNet)[25], and Tripartite interaction representation algorithm-enhanced Crystal Graph Neural Networks (TiraCGCNN)[26]. The widely used force field model includes M3GNet[27], CHEGNET[28] and GPTFF[29]. To facilitate their use, several software packages have been developed to construct accurate atomic interaction potentials. For example, the open-source Atomic Energy Network (aenet)[30] provides a deep learning-based representation of potential energy. DeepKit also provides the representation of potential energy and force fields, enabling molecular dynamics simulations[31-32]. Additionally, workflows have been developed to generate new crystal structures. Notable examples include MAGUS, which combines DFT calculations with machine learning methods[33], and a framework that integrates a graph network model with an optimization algorithm[34]. A more ambitious effort by Google DeepMind utilized AI to predict 380,000 new materials with the GNOME model[35]. While these existing tools and programs have demonstrated success in predicting crystal structures within predefined chemical or structural families, they face significant challenges when applied to unknown or unexplored materials. Therefore, the development of a new program is urgently needed to overcome these limitations by introducing a generalized, robust, and efficient approach.\nIn this paper, building on our previous work with the adaptive genetic algorithm (AGA)[36-37], we propose a crystal structure prediction software based on artificial intelligence (CrySPAI), which supports automatic structure optimization by combining AI technology with DFT data. The software consists of three modules: an evolutionary optimization algorithm (EOA) for searching crystal structure configurations, DFT calculations for determining energy values, and a deep neural network (DNN) for fitting the relationship between structures and their energies. Additionally, a structure-energy function is employed to filter out unreasonable structures in the EOA module. CrySPAI offers four distinct advantages, making it a powerful tool for researchers in the field of materials science: (1) Broad applicability. It can be applied across a wide range of inorganic materials. (2) Seamless integration and automation. The software integrates and automates all stages of the prediction process. (3) Enhanced predictive accuracy and efficiency. By combining AI and DFT, CrySPAI delivers improved accuracy and efficiency. (4) Exploration of unknown domains. It provides robust capabilities to explore materials in previously uncharted domains."}, {"title": "2. Results", "content": "Three modules have three main modules, EOA, DFT and DNN. The schematic workflow of CrySPAI is shown in Figure 1. The input consists of the chemical composition provided by the user, and the output is the recommended crystal structure that CrySPAI determined to be energetically stable. The iterations in the middle shown in Figure 1 is used to train a convergence model, and it is the core of CrySPAI. The accuracy of model, as well as its applications, are key factors in determining the overall performance of the software. The model is iteratively trained to accurately predict the energy of different structures. The EOA module and DFT module in the iterative loop provide samples for the data set of the model training, while the EOA module operates outside the iterations to search for reasonable structures based on the trained model. Two databases are employed: one stores the results from DFT calculations, and the other contains the converged models.\nModel training is a time-consuming and continuously evolving process, particularly when exploring new materials from scratch. However, once the model has been successfully trained, it facilitates efficient structure searching by comparing real-time structural energy information. This process, shown as the right process in Figure 1, enables CrySPAI to generate numerous satisfactory output structures, optimizing the search for the most stable configurations."}, {"title": "2.2. Applications on Crystal Structure Prediction of CrySPAI", "content": "The simplest way to predict crystal structures using CrySPAI is by providing the component information of the structure, such as the element names and their atomic numbers. If you wish to modify the default settings of CrySPAI, you can do so by editing the parameter file. The default parameter file, args.py, includes structure information, model training parameters, and computational resource settings."}, {"title": "2.2.1 Parameters and Files Preparation", "content": "For the structure information, five main parameters need to be specified. The parameter names, default values, and descriptions are listed in Table 1.\nAmong these parameters, atomType and atomn are required, while the others are optional. The aenergy parameter is used to determine whether a new structure is stable. If the energy of the new structure exceeds the sum of the aenergy values for all atoms, CrySPAI will consider the structure unstable and discard it; otherwise, it will be retained. The crystalsys parameter specifies the crystal system of the target structure. However, throughout the training process, seven crystal systems are used to develop a universal model, as mentioned earlier.\nIn addition to the structure parameters, some input calculation files must be prepared in advance. The specific files required depend on the calculation software accessed by CrySPAI's DFT module, and users are free to customize the settings of these files. For the Vienna Ab initio Simulation Package (VASP), the required files include INCAR and POTCAR. If these input files are not provided, CrySPAI will automatically generate an INCAR file with default parameter settings. In the INCAR file, the \"Accurate\" precision mode is selected to avoid aliasing or wrapping errors. A conjugate-gradient algorithm is used to relax the ions to their instantaneous ground state, with a maximum of 100 ionic steps and an energy convergence criterion of 10-6 eV/atom. A plane-wave basis set is employed, with the kinetic-energy cutoff determined by the precision mode or manually specified by the user. The smallest allowed spacing between k-points is 0.1 \u00c5\u00af\u00b9. In this work, the generalized gradient approximation (GGA)[38], specifically the Perdew-Burke-Ernzerhof (PBE) form, is used to calculate the exchange-correlation energy. While PBE is widely used for inorganic materials, we acknowledge its limitations and recommend users validate results for specific systems using alternative functionals when necessary. CrySPAI allows users to specify any functional supported by the chosen calculation software, such as LDA, meta-GGA, hybrid functionals, or even dispersion corrections like DFT-D2 or DFT-D3. Users performing DFT calculations with VASP must hold a valid VASP license. CrySPAI also supports other first-principles calculation software, such as Abinit, providing users with flexibility in their computational workflows.\nParameters related to model convergence and the training method are specified in the arg.py file, and users can review and modify them as needed. Once all preparations are complete, users can configure computational resources and submit tasks to supercomputers. After all iterations are finished, the results, including DFT calculations and trained models, will be stored in the database, and the recommended structure information will be output in a file format."}, {"title": "2.2.2 Crystal Structure Prediction", "content": "To demonstrate the effectiveness of the software in structure prediction, we selected several widely studied representative materials, including the electronic device material Si, the photocatalytic material TiO2, the perovskite material CaTiO3, and the metallic material Mg. These materials serve as foundational structures for a wide range of research areas, and their modifications have led to numerous research hotspots. The accuracy of structure prediction for these materials highlights the application potential of our software. Moreover, these representative materials also showcase CrySPAI's capability to predict structures for elemental crystals, binary compounds, and ternary compounds.\nWe specified the atomic numbers and volumes for Si, TiO2, Mg, and CaTiO3 to generate their crystal structures. The composition and volume information for these materials are provided in Table 2. All models are trained from scratch based on DFT calculation results, with structures generated at a fixed volume. These structures are derived from the seven crystal systems, and the initial model is trained using DFT results from randomly generated structures. The model is then iteratively updated until it converges globally. The EOA module uses the converged model to search for target structures.\nTo describe the local atomic environment, the feature vector is constructed using a Chebyshev expansion[39], ensuring that the computational complexity of the machine learning model remains manageable even as the number of chemical species increases. Default DFT calculation parameters are employed. The model convergence tolerance is set to 8 meV/atom, and the 'patience' for epochs with no loss improvement is set to 40, based on repeated testing. Additionally, the swarm algorithm is integrated to enhance the prediction accuracy of the neural network during the training process."}, {"title": "3. Discussion", "content": "For an unknown structure, CrySPAI first calculates its volume and then searches for the structural information, including shape and atomic positions. In all these processes, the accuracy of the model is crucial. The network model quickly predicts the energies of structures and recommends the optimal structural candidates for further generation. To enhance the robustness and efficiency of CrySPAI, an adaptive volume adjustment algorithm and a hybrid swarm intelligence algorithm are introduced. The adaptive volume adjustment algorithm is employed to determine an appropriate unit cell, while the hybrid swarm intelligence algorithm -combining the strengths of genetic algorithms, particle swarm optimization, and Bayesian optimization-is used to optimize the neural network, improving model stability and training efficiency. Further details of this method can be found in our previous work[40]."}, {"title": "3.1. Volume Prediction Performance", "content": "To verify whether CrySPAI can accurately predict a suitable volume for the structure, we first calculated the volumes of five typical metal crystal structures to test the adaptive volume adjustment algorithm we developed. Table 3 presents the predicted and experimental results for these five metal elemental crystals, along with their respective volumes. As shown, the volumes of the structures recommended by CrySPAI are generally consistent with the experimental standard values, with a volume error of less than 3 \u00c5\u00b3/cell. This demonstrates that the proposed volume adjustment strategy is effective for searching unknown structures. Additionally, the space groups were predicted with good accuracy, particularly for Ni4, which shows a higher level of precision."}, {"title": "3.2. Swarm Intelligence Algorithm Performance", "content": "To evaluate the performance of the swarm intelligence algorithm in CrySPAI, we tested model convergence using a small dataset and conducted structure searches based on trained models for Li, Ca, and Mn. The results were compared with those obtained using the traditional back-propagation algorithm, as shown in Table 4. In this test, the total dataset consisted of approximately 1000 structures, the loss was kept below 0.08 eV/atom, and the iteration count was set to 1500 for each loop of the EOA module used for structure searching.\nAs shown in Table 4, the proposed swarm intelligence algorithm demonstrates excellent performance in structure searching. It effectively utilizes small datasets to achieve rapid convergence and exhibits strong generalization ability. In comparison, while the traditional back-propagation algorithm also performs well with small datasets, it is more prone to getting stuck in local optima or overfitting, which can hinder the EOA module from finding the optimal structure during the search process. Therefore, the swarm intelligence algorithm in CrySPAI offers faster convergence and higher accuracy, as the recommended individuals provide a stronger initial advantage. Additionally, energy prediction models for TiO2 and CaTiO3 were trained in earlier tests, showing that the neural network optimized by the proposed hybrid swarm intelligence algorithm improves both efficiency and accuracy, particularly for systems with a larger variety of atoms[40]."}, {"title": "3.3. Capability Performance of CrySPAI in Crystal Structure Search", "content": "To evaluate the performance of CrySPAI, we compare it with two well-known structure search software, CALYPSO and GSGO, using available data from previous studies[12]. CALYPSO employs a particle swarm optimization algorithm, while GSGO utilizes a genetic algorithm for structure search. Both software packages use first-principles calculations for optimization. It is important to note that each software searches different structural systems independently, so we treat the search in each system as one generation. When comparing the same optimized population size Npop, CrySPAI reproduces experimentally reported structures in fewer generations than the other methods shown in Table 5. This improvement is primarily due to the efficiency of the DNN model, which reduces computational cost, and the more accurate parent structures provided by the model, allowing CrySPAI to more effectively search for the global optimum."}, {"title": "4. Materials and Methods", "content": ""}, {"title": "4.1. Implementations of CrySPAI", "content": ""}, {"title": "4.1.1. EOA Module", "content": "The GA, inspired by Darwinian evolution, has been widely used for crystal structure optimization. In CrySPAI, the EOA module employs GA to generate structures through inheritance, mutation, selection, and crossover operations. To enhance the comprehensiveness and accuracy of the structure search, the EOA module runs seven parallel procedures, each corresponding to a different crystal system. Each procedure consists of several iterations using the same GA operations. The workflow of the EOA module for the cubic system is shown in Figure 2.\nThe input information typically includes the element names, number of atoms, and optional volume data. When the EOA module receives the input for the target materials, it activates seven parallel processes, each corresponding to a different crystal system. For example, Figure 2 illustrates the structure search process for the cubic crystal system. Initially, some candidate crystal structures are generated based on the input data with the help of the ICSD database. These structures are then subjected to energy calculations in the \"local optimization process.\" During this process, the energies of the crystal structures are predicted using a trained model. If the model is unavailable, energy calculations based on empirical formulas or single-point DFT calculations are used instead."}, {"title": "4.1.2 DFT Module", "content": "The DFT module is used to obtain accurate energy values for crystal structures. These results, along with their corresponding structures, form the training set for the model. As the choice of exchange-correlation functional and basis set can influence the energy calculations and ranking results, a brief note has been included to draw the user's attention to this critical aspect. In addition to its role within the iteration loop of the DNN module (as shown in Figure 1), the DFT module can also be used to calculate the energies of structures recommended by the EOA module upon user request. The DFT module in CrySPAI interfaces with external DFT calculation software, with VASP being the default computational tool. Input files such as POTCAR (containing pseudopotential information) and INCAR (with calculation parameters) must be prepared by the user, while the POSCAR file is automatically generated and transferred from the EOA module. The KPOINTS file is optional. Given the time-consuming nature of DFT calculations, parallel computing and high-throughput computational techniques are employed to accelerate the process. All relevant information, including composition, lattice parameters, atomic positions, and their energies, is extracted and stored in a MongoDB database in a standardized format for each DFT calculation.\nThe goal of the DFT module is to construct a comprehensive training dataset, which is continuously updated and expanded until the DNN iterations are complete. All results from DFT calculations are stored in the Materials database; however, not all of these calculations are added to the training set. CrySPAI considers two cases in which structure-energy pairs are excluded from the training set. The first case involves structures that are similar to those already present in the training dataset. The second case involves \"useless\" structures, where the energies from DFT calculations closely match the predicted values from the existing potential model, indicating little new information is provided."}, {"title": "4.1.3 DNN Module", "content": "Once the number of DFT calculations exceeds a specific threshold, the DNN module is activated. An atomic energy DNN model is then generated, and the model undergoes continuous training and updates in the model iteration loop, as shown in Figure 1, until convergence is achieved. The default neural network used in CrySPAI consists of four layers: one input layer, two hidden layers, and one output layer. The architecture of the neural network is illustrated in Figure 3."}, {"title": "4.2. Adaptive Volume Adjustment Algorithm", "content": "As volume is a key physical parameter in constructing crystal structures, CrySPAI allows users to provide the volume value of the target structure. Alternatively, the volume can be calculated using the adaptive volume adjustment algorithm.\nIn this algorithm, the structural volume is calculated as the sum of the volumes of all atoms in the structure, as given by Equation 2. A is an adjustment factor, with a default value of 1.2. The ionic radii, R, can be obtained either from the periodic table or from the \"RCORE\" parameter in the VASP pseudopotential file. CrySPAI offers several methods for users to specify the volume, including direct input of atomic or structural volume, extraction of ionic or atomic core radii from the periodic table or the VASP pseudopotential file, and other options."}, {"title": "5. Conclusions", "content": "In this work, we developed CrySPAI, a crystal structure prediction software based on artificial intelligence. CrySPAI integrates EOA for structure search, DFT for energy calculations, and DNN for modeling the relationship between structure and energy. These modules operate both independently and collaboratively, enabling efficient and accurate predictions of crystal structures.\nTo ensure a robust model, we used a diverse training dataset that includes structures from various crystal systems, stoichiometries, and cell sizes. This approach ensures CrySPAI's versatility in predicting a wide range of materials. Additionally, CrySPAI employs human-computer collaboration to refine and validate structure predictions, further improving overall accuracy. Currently, CrySPAI is tailored specifically for the prediction of crystal structures of inorganic materials, given their chemical compositions. While the present implementation is optimized for inorganic materials due to their distinct structural and energetic characteristics, the employed methods could theoretically be extended to organic or hybrid systems.\nAlthough CrySPAI has demonstrated significant success in inorganic crystal structure predictions, further development are required.\n(1) Dependence on training data. CrySPAI's prediction accuracy is heavily dependent on the quality and diversity of the training data used for DNN. To address this, we plan to expand the training dataset to cover a broader range of materials,, ensuring better generalization and improved performance.\n(2) Scalability to complex systems. While CrySPAI is currently effective for inorganic materials, its application to highly complex systems, such as amorphous materials, organic materials, or systems with strong electron correlation effects, may require additional computational resources or tailored methods. Future iterations of CrySPAI will involve specific adaptations to handle these complex systems effectively.\n(3) Generalizability to experimental conditions. CrySPAI predictions now are conducted under idealized computational conditions (e.g., OK and no pressure). These may differ from experimental conditions, some phase transitions and defects states will also been thrown away. In the future versions, we will extend CrySPAI's capabilities to simulate dynamic processes, offering deeper insights into material behaviors under realistic conditions."}]}