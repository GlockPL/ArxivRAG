{"title": "Causal Discovery by Interventions via Integer Programming", "authors": ["Abdelmonem Elrefaey", "Rong Pan"], "abstract": "Causal discovery is essential across various scientific fields to uncover causal structures within data. Traditional methods relying on observational data have limitations due to confounding variables. This paper presents an optimization-based approach using integer programming (IP) to design minimal intervention sets that ensure causal structure identifiability. Our method provides exact and modular solutions that can be adjusted to different experimental settings and constraints. We demonstrate its effectiveness through comparative analysis across different settings, demonstrating its applicability and robustness.", "sections": [{"title": "Introduction", "content": "Causal discovery is a crucial endeavor in many scientific fields. Specifically, it focuses on revealing the causal structures within the data. Generally, causal discovery can be carried out through one of two data collection approaches - observational data-based discovery and interventional or experimental data-based discovery. Most of past research employs observational methods, such as those using conditional independence tests, to provide valuable insights into causal structure. However, these methods have significant limitations, as they often face challenges from confounding variables and their inability to determine causality conclusively [1, 2]. Observation-based causal discovery can most reveal a Directed Acyclic Graph (DAG) up to its Markov Equivalence Class (MEC) level, which means that there could be multiple different causal structures equivalent to fitting to the conditional independence revealed by the observational data alone [3].\n\nThe experimental approach, in contrast, provides a robust framework for discovering causal relationships by sys- tematically manipulating variables and observing the effects [4]. The randomized controlled trial (RCT) is often considered the gold standard in this context, providing clear evidence of causality by isolating the effects of specific interventions [5]. However, traditional experimental designs presume a bipartite separation of variables into treatment and outcome categories (with possible covariates), which requires prior knowledge of which variables are potential causes (treatments) and which are potential effects (outcomes). They cannot adequately address the causal structure scenarios that do not fit this framework. For example, for a complex causal network, the conventional Design of Experiments (DOE) principles often do not provide useful guidance to the design of network interventions [6].\n\nThe primary goal of traditional DOE is to determine whether the treatment variable influences the outcome variable and, if so, to what extent. However, it does not offer advice on how to select treatment variables. Although bipartite separation is assumed in many studies given the condition of time-ordered information or limited intervention possibilities, there are numerous other situations where such restrictions are unwarranted (e.g., when multiple causal pathways exist between treatment and outcome variables).\n\nA more comprehensive framework for discovering causal structures - causal Bayes nets \u2013 has been developed in the fields of computer science and philosophy [7, 2]. Unlike the bipartite structure assumed in DOE, causal Bayes nets"}, {"title": "Related Work", "content": "In [9] the authors prove the bounds for the minimal number of experiments required for causal discovery for one- intervened-variable or multiple-intervened-variable experiments. Frederick Eberhardt's early work [10] has laid a solid groundwork for the field of interventional causal discovery. Two main types of interventions are discussed in his thesis: structural interventions and parametric interventions. Structural interventions break all incoming causal influences to an intervened variable, making it independent of its causes, thus it is effective in determining direct causal links from the intervened variable to other unintervened variables. Parametric interventions, on the other hand, modify the conditional probability distribution of the intervened variable without breaking incoming influences, preserving the original causal structure. This is necessary when structural intervention is impractical or unethical. His thesis explores the efficacy of fixed and adaptive [11, 12, 13, 14] intervention strategies and discusses the efficiency of multiple simultaneous variable interventions. Following Eberhardt's seminal work, [15] specifies the minimal number of experiments needed to uniquely determine a causal graph from its observational MEC. The authors show that the number of required experiments is related to the largest clique in MEC. The OPTINTER algorithm proposed by the authors focuses on breaking down cliques quickly by selecting vertices in the largest cliques, but this algorithm is an NP-complete MAX-CUT problem.\n\n[16] formalize the causal identifiability problem as variable pair conditions as follows:\n\n\u2022 Unordered Pair Condition (UPC): Ensures an experiment where one of any two variables is intervened upon and the other is passively observed.\n\n\u2022 Ordered Pair Condition (OPC): Ensures an experiment where the first variable in any ordered pair is intervened upon and the second is passively observed.\n\n\u2022 Covariance Condition (CC): Ensures an experiment where a pair of variables are passively observed.\n\nThe paper connects these conditions to combinatorial problems, using separating systems and cut-coverings in graph theory following results in [17, 18]. This approach allows the construction of optimal experiment sets that satisfy the necessary conditions for causal discovery in the worst case (when the true DAG is fully connected).\n\nLater work, such as that by [19] developed algorithms based on the optimal coloring of chordal graphs, requiring up to log2(x) interventions to learn any causal graph, where x is the chromatic number of the chordal skeleton of the DAG.\n\n[20] focus on the problem of learning causal networks using interventions under Pearl's Structural Equation Model with independent errors (SEM-IE). They aim to minimize the number of experiments needed to discover the causal directions of all edges in a causal graph. A key contribution is proving that any deterministic adaptive algorithm needs to be a separating system to learn complete graphs in the worst case. They also present a novel separating system construction that is close to optimal and simpler than previous work in combinatorics.\n\n[21] address the same problem with a cost consideration. They formulate the cost-optimal causal graph learning problem, aiming to design a set of interventions with a minimum total cost that can uniquely identify any causal graph given its skeleton. Their approach leverages the connection between graph-separating systems and proper colorings, although this connection is not widely known in the literature. The cost of an intervention is assumed to be a sum of costs assigned to each variable that is subject to manipulation which can be a special cost structure and may not be applicable in many real scenarios.\n\n[22] also explore the minimum cost intervention design problem, where the objective is to identify a set of interventions with a minimum total cost that can learn any causal graph given its essential graph representing its MEC. They demonstrate that this problem is NP-hard and provide a (2 + \u20ac)-approximation algorithm using a greedy approach"}, {"title": "Our Contribution", "content": "In this paper, we present a set of modular optimization models for interventional causal discovery, addressing the UPC, OPC, and CC outlined in [16]. We provide detailed mathematical formulations and demonstrate their effectiveness in identifying interventions that are minimally required to identify the causal structure involving a set of observable variables. This approach can be used to incorporate a wide variety of cost and number-of-variable-per-experiment constraints into the main formulation presented in this paper as will be demonstrated."}, {"title": "Optimization Approach", "content": "We formulate the interventional causal discovery problem into an Integer Programming (IP) formulation. The objective is to design a minimal set of interventions that satisfies the UPC, OPC, and CC, ensuring the entire causal structure among variables of interest is identifiable."}, {"title": "Benefits of Using IP Optimization Models", "content": "Using IP (and optimization models in general) offers several benefits:\n\n\u2022 Exact Solutions: IP models can provide exact solutions to intervention design problems, ensuring that the minimal set of interventions will be found.\n\n\u2022 Modularity: The optimization models are modular, allowing for easy adjustments and extensions to incorporate additional constraints or prior knowledge such as the cost of each intervention. They can also accommodate various secondary objectives, such as minimizing the average number of variables manipulated per intervention or minimizing the maximum (worst case) number of variables in a single intervention.\n\n\u2022 Anytime Algorithm: The Branch and Bound (B&B) algorithm commonly used to solve IP problems can be viewed as an anytime algorithm; that is, it provides progressively better solutions the longer it runs. This allows for flexibility in computational time and resources, making it possible to obtain good solutions even under computational budget constraints. With a sufficient run time, it can provide all solutions (intervention sets) that attain the minimum number of interventions necassary, which can be leveraged for various soft constraints in decision-making."}, {"title": "Problem Formulation", "content": "Given a set of variables V = {X1, X2, ..., XN}, one of the goals of causal discovery is to determine the causal structure that describes how these variables influence each other. This structure is typically represented by a DAG, G, which is a tuple of a set of nodes and a set of directed edges connecting them. The nodes correspond to variables and directed edges represent direct causal relationships."}, {"title": "Assumptions", "content": "To ensure the identifiability of the causal structure, several assumptions need to be made about the underlying causal model:\n\n\u2022 Acyclicity: The graph G is acyclic. This ensures that for any Xi, Xj \u2208 V, if Xi causes Xj, then Xj cannot reciprocally cause Xi. Formally, G is a Directed Acyclic Graph (DAG).\n\n\u2022 Causal Sufficiency: There are no unobserved common causes of two or more observed variables. Mathematically, for any pair of observed variables Xi, Xj \u2208 V, there does not exist an unobserved variable U such that U causally influences both Xi and Xj.\n\n\u2022 Faithfulness: The observed conditional independencies in the data correspond exactly to those implied by the causal graph. Formally, if Xi \u2aeb Xj | Z (where \u2aeb denotes conditional independence), then Xi \u2aeb Xj | Z must hold in the observed data as well."}, {"title": "Achieving Structure Identifiability", "content": "To achieve identifiability of the causal structure, certain combinations of UPC, OPC, and CC must be satisfied:\n\n\u2022 Assuming causal sufficiency, acyclicity, and faithfulness, the causal structure is identifiable if for any two variables Xi, Xj \u2208 V, two interventional experiments have been conducted where, either:\n\n the OPC holds for the pairs (Xi, Xj) and (Xj, Xi), or\n both the UPC and the CC hold for the pair {Xi, Xj}.\n\n\u2022 Without assuming causal sufficiency, acyclicity, or faithfulness, but assuming a linear data-generating model, the causal structure among observed variables is identifiable if the OPC holds for all ordered pairs of variables [24, 25, 26].\n\nThe focus of this work will be on the first case where no parametric form of the data model is assumed and when acyclicity, sufficiency, and faithfulness are met. Access to an independence oracle is also assumed.\n\nIn a multi-variable intervention experiment, any subset of variables in V can be manipulated while the remaining variables are observed. In such cases, [27] shows that at most half of all variables need to be intervened on to reveal all causal links. Interventions where more than half of the variables are intervened on are not optimal. Therefore, unless a limit on the number of variables that can be intervened on is imposed, only the interventions where up to [|V|/2] variables are manipulated are considered."}, {"title": "Notation", "content": "We use the following notations in the optimization models:\n\n\u2022 I: The set of all possible interventions.\n\n\u2022 K: The index set of all possible interventions.\n\n\u2022 Sk: The subset of variables subject to an intervention, Sk \u2208 I, where k indicates the kth intervention.\n\n\u2022 Ik: A binary decision variable indicating whether an intervention Sk is chosen (Ik = 1) or not (Ik = 0).\n\n\u2022 fij: A binary decision variable indicating if there is a forward experiment constraint (see the identifiability section) for the pair (Xi, Xj).\n\n\u2022 bij: A binary decision variable indicating if there is a backward experiment constraint (see the identifiability section) for the pair (Xi, Xj).\n\n\u2022 uij: A binary decision variable indicating if there is a null experiment for the pair (Xi, Xj)."}, {"title": "Objective Function", "content": "The objective function for all base models is to minimize the number of chosen interventions:\n\nMinimize  \u2211k\u2208K Ik  (1)"}, {"title": "Binary Constraint", "content": "The binary constraint for all models is:\n\nIk\u2208 {0,1}, \u2200 k \u2208 K (2)"}, {"title": "CC, UPC, and OPC Models", "content": "We first present the formulation for satisfying the CC, UPC, and OPC individually."}, {"title": "Covariance Condition", "content": "The covariance condition ensures that for any pair of variables, there exists at least one intervention where neither of the variables is manipulated. This can be represented as:\n\n\u2211k\u2208K Xi\u2209Sk,Xj\u2209Sk Ik \u2265 1, {Xi, Xj } \u2286 V (3)\n\nNote that the null experiment, where no variables are manipulated (i.e. a passive observation of the system) is a trivial solution to this IP."}, {"title": "Unordered Pair Condition", "content": "The unordered pair condition requires that for any pair of variables, there exists at least one intervention where one variable is affected, but the other is not. This is modeled as:\n\n\u2211k\u2208K (Xi\u2208Sk,Xj\u2209Sk)\u2228(Xi\u2209Sk,Xj\u2208Sk) Ik \u2265 1, \u2200{Xi, Xj } \u2286 V (4)\n\nThis ensures that for each pair {Xi, Xj}, there is an intervention where one is affected while the other remains unaffected."}, {"title": "Ordered Pair Condition", "content": "The ordered pair condition ensures that for each ordered pair of variables, there exist interventions where one variable is affected but not the other, and vice versa. This is formulated as two separate constraints:\n\n\u2211k\u2208K Xi\u2208Sk,Xj\u2209Sk Ik \u2265 1, \u2200{Xi, Xj} \u2286 V (5)\n\n\u2211k\u2208K Xi\u2209Sk,Xj\u2208Sk Ik \u2265 1, \u2200{Xi, Xj} \u2286 V (6)\n\nThese constraints ensure that for any ordered pair (Xi, Xj), there is an intervention where Xi is affected and Xj is not, and another intervention where Xj is affected and Xi is not."}, {"title": "Identifiability", "content": "Our DAG is a connected graph and any cyclic pattern is prohibited. Therefore, for a pair of variables (Xi, Xj), when both variables do not simultaneously appear in an intervention set, they should satisfy the following constraints to ensure their cause-effect direction is uniquely identifiable."}, {"title": "The Set-Covering Problem", "content": "The UPC, OPC, CC formulations in our interventional causal discovery framework can be viewed as instances of the Set Covering Problem (SCP), a well-known NP-hard problem in combinatorial optimization. The SCP aims to cover a universe of elements with the minimum number of subsets, which parallels our objective of identifying minimal intervention sets to ensure causal structure identifiability. The SCP is NP-hard, meaning that finding an optimal solution is computationally infeasible for large instances [28]. This complexity extends to our models, necessitating the exploration of efficient approximation techniques.\n\nGiven the generic formulation of intervention experimental design, our models can be extended to accommodate various practical considerations:\n\n\u2022 Weighted Set Cover: Incorporating intervention costs to minimize the total cost [29].\n\n\u2022 k-Set Cover: Limiting the number of interventions to a fixed number k [30].\n\n\u2022 Partial Set Cover: Allowing for partial identifiability by covering a subset of causal relationships [31].\n\nFor a large system, the following approximation algorithms can be employed to find near-optimal solutions:\n\n\u2022 Greedy Algorithm: Selects interventions iteratively, each time choosing the one that covers the most yet- uncovered pairs, achieving an O(log n)-approximation [32].\n\n\u2022 Linear Programming (LP) Relaxation and Rounding: If each element occurs in at most f sets, a solution can be found in polynomial time that approximates the optimum to within a factor of f using LP relaxation [33]."}, {"title": "Extensions", "content": "By framing the UPC, OPC, and CC models within the context of SCP, well-established optimization techniques can be leveraged to enhance the efficiency and effectiveness of causal discovery through interventions. Exact solutions to these optimization problems can guarantee optimality; conversely, approximation methods can provide flexibility and scalability, which is crucial for real-world applications."}, {"title": "Minimizing Cost of Interventions", "content": "These IP models can be made to minimize the total cost of interventions instead of the number of interventions. This is achieved by changing the objective function to\n\nMinimize \u2211k\u2208K Ck Ik (12)\n\nwhere Ck is the cost of intervention Ik. Since each Ck can be set independently, the cost structure can be general and need not be limited to a linear function of the cost of intervening on individual variables. These modifications offer a substantial practical significance as minimizing the cost of interventions is a more realistic objective than the actual number of interventions.\n\nFor example, consider the case of V = {X1, X2, X3, X4}. Therefore, there are 11 viable variable sets of up to size [|V|/2] = 2 to be considered for an intervention, I:\n\n\u2022 So: \u00d8\n\n\u2022 S1: {X1}\n\n\u2022 S2: {X2}\n\n\u2022 S3: {X3}\n\n\u2022 S4: {X4}\n\n\u2022 S5: {X1, X2}\n\n\u2022 S6: {X1, X3}\n\n\u2022 S7: {X1, X4}\n\n\u2022 S8: {X2, X3}\n\n\u2022 S9: {X2, X4}\n\n\u2022 S10: {X3, X4}\n\nThe theoretical lower bound for the necessary number of interventions required to identify a graph of 4 variables is [log2(4)] + 1 = 3 [27]. There are (131) = 165 possible 3-intervention solutions, but only 92 of them can satisfy the identifiability conditions. Without cost considerations, the 92 intervention experimental designs are equal solutions for this 4-variable causal discovery problem. However, if we consider the empty variable set (i.e. the null experiment, where all variables are passively observed) to have a zero cost and any other intervention experiment to have a one-unit cost, i.e., setting the IP objective function with C0 = 0 and Ck = 1,\u2200k \u2208 {1, . . ., 10}, yields only 12 solutions that will attain the minimum cost."}, {"title": "Limited number of variables that can be subject to an intervention simultaneously", "content": "When there is a limit on the maximum number of variables that can be intervened simultaneously in an interventional experiment, kmax, the IP model can incorporate this requirement by defining I to only include the sets of |Sk| \u2264 kmax. The branch-and-bound algorithm will only seek to minimize the number of interventions necessary (or the total cost of interventions) over the reduced space of possible interventions which ensures that the limit is satisfied."}, {"title": "Secondary objectives", "content": "[16] provide algorithms that not only yield a set of interventions that meet the theoretical bounds of minimum necessary interventions to meet the UPC or OPC respectively but also construct these interventions while minimizing either the average or the maximum intervention size. The IP approach can likewise be used to find the minimum number of interventions and additionally optimize another practically significant objective. As discussed before, there often exist many optimal solutions to the main objective function, choosing a solution that can also optimize a secondary objective is thereof desirable. [10] presents such a case when the number of variables, |V|, is 8 for which the theoretical lower bound of number of interventions required (assuming multi-variable interventions are permissible) is 4. Multiple configurations of intervention sizes can attain this bound, such as 4 experiments with intervention sizes of (4, 4, 4, 0), or of (3, 3, 3, 1).\n\nOn the other hand, setting the minimization of the average intervention size as a secondary objective will yield the configurations. The size of an intervened variable set is often of practical importance in implementation, as a larger size can greatly increase the complexity of an experiment. Therefore, a smaller average size of interventional experiments is more desirable.\n\nBy utilizing our IP framework, it is easy to optimize secondary objectives such as the minimal size of intervened variable sets. Our final solutions can be refined to adhere to some soft decision-making requirements."}, {"title": "Conclusion", "content": "In this paper, we introduce an optimization-based approach to causal discovery through interventions, leveraging integer programming to design the minimal number of intervention sets that ensure the identifiability of causal structures. Our method addresses the limitations of traditional observational methods, offering exact and modular solutions adaptable to various experimental settings and constraints.\n\nWe have demonstrated the effectiveness of our approach through detailed mathematical formulations and comparative analyses, highlighting its robustness and applicability across different scenarios. The flexibility of our IP models allows"}]}