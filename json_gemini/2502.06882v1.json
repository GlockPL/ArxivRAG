{"title": "Multi-Agent Simulator Drives Language Models for Legal Intensive Interaction", "authors": ["Shengbin Yue", "Ting Huang", "Zheng Jia", "Siyuan Wang", "Shujun Liu", "Yun Song", "Xuanjing Huang", "Zhongyu Wei"], "abstract": "Large Language Models (LLMs) have significantly advanced legal intelligence, but the scarcity of scenario data impedes the progress toward interactive legal scenarios. This paper introduces a Multi-agent Legal Simulation Driver (MASER) to scalably generate synthetic data by simulating interactive legal scenarios. Leveraging real-legal case sources, MASER ensures the consistency of legal attributes between participants and introduces a supervisory mechanism to align participants' characters and behaviors as well as addressing distractions. A Multi-stage Interactive Legal Evaluation (MILE) benchmark is further constructed to evaluate LLMs' performance in dynamic legal scenarios. Extensive experiments confirm the effectiveness of our framework. The detailed resources are available at https://github.com/FudanDISC/MASER.", "sections": [{"title": "1 Introduction", "content": "The emergence of Legal Artificial Intelligence (Legal AI) (Atkinson et al., 2020; Ge et al., 2021) induces significant transformations within the legal field. Especially, recent advancements in Large Language Models (LLMs) (Achiam et al., 2023; Yao et al., 2024; Yue et al., 2024a), through continuous training on legal knowledge and instructions, have shown remarkable capabilities in various legal tasks, such as legal information extraction (Shen et al., 2024), judgment prediction (He et al., 2024) and instrument drafting (Yue et al., 2023). However, previous endeavors (Fei et al., 2023) predominately concentrated on non-intensive interactive tasks, involving prediction with directly specified elements, thereby restricting the wider real-world application of Legal AI.\nThe real-world judicial service scenario is highly complex, presenting two major challenges: (1) High professionalism. The rationality of content and the legality of procedures are crucial for legal information services, requiring practitioners to follow a procedural agenda while offering services. (2) Intensive interactivity. Since users often lack basic legal knowledge, legal consultations typically require multiple rounds of interaction, with practitioners guiding users step by step through the process. As shown in Figure 1, drafting a legal complaint is a complex task that demands fulfilling all the listed requirements. However, when the user exhibits incomplete information, vagueness or concerns, both GPT-40 (Achiam et al., 2023) and LawLLM (Yue et al., 2024a) struggle with adaptive handling while simultaneously following agendas. This results in misunderstanding of the user's demands and omission of necessary facts, ultimately"}, {"title": "2 Multi-agent Legal Simulation Driver", "content": "As shown in Figure 2, MASER achieves legal objectives (i.e., complaint drafting) through intensive interactions, which consist of three agents: a client, a lawyer, and a supervisor. Each character assumes specific roles and responsibilities within the framework. The MASER consists of Role Agent Presetting (\u00a72.1) and Multi-Agent Legal Simulation (\u00a72.2), ultimately producing synthetic scene data to train arbitrary LLMs (\u00a72.3).\nDue to limited expertise, vanilla LLM-driven simulators tend to produce substantial legal illusions, compromising reliability of synthetic data. Hence, the authenticity setting of role agent presents two challenges: the client's diversity and legal consistency among roles. To this end, we develop the individual's features across different dimensions based on the Big-5 Personality Traits. Additionally, we configure various legal elements in real legal events with the same logic chain to different agents. To establish"}, {"title": "2.3 Training", "content": "Synthetic Data Generation. MASER is utilized to construct a high-quality synthetic legal scene dataset, SynthLaw, consisting of 4,532 samples. Note two keys in the synthetic process: 1) real-legal source configurations and supervision mechanisms in each interaction ensure that the generated data is aligned at the sentence level, closely approximating real-world scenarios. 2) the diverse client behavioral styles and legal demands ensure the data generalization. This approach greatly remedies the dilemma of scene data construction under legal resources. In addition, we collect 4k high-quality multi-round legal counseling data to enhance the legal routine Q&A capability.\nSupervised Finetuning. We initialize a general LLM and train it on SynthLaw dataset $D_s$. For each example $(X_{c,1}, X_{l,1},..., X_{c,T}, X_{l,T}) \\subset D_s$, where c and l denote Client and Lawyer, a standard conditional language modeling objective, maximizing likelihood:\n$\\mathcal{L} = \\sum_i -log p(x_i | X_{c,<i}, X_{l,<i}), X_i \\in X_l$\nwhere L is the token length of sequence X, $X_i$ is the current predicted the Lawyer's response tokens, $X_{c,<i}$ and $X_{l,<i}$ are the Client's response and Lawyer's response tokens before $x_i$."}, {"title": "3 MILE Benchmark", "content": "Unlike existing legal benchmarks (Fei et al., 2023; Yue et al., 2023) that employ static assessment, Multi-Stage Interactive Legal Evaluation (MILE) introduces an approach for assessing the model's ability to complete designated legal tasks in a dynamic environment. This benchmark offers the key advantage that it better aligns with real-world conditions and thus more reliably reflects the model's performance. Leveraging powerful LLM to simulate the non-legal characters (i.e., Client), MILE thoroughly evaluates the performance of LLMs-driven lawyer within this dynamic legal interaction environment. MILE is divided into two phases: interaction evaluation and goal evaluation."}, {"title": "5 Experiment Results", "content": "Comparison on goal evaluation. We conduct the goal evaluation from global and local perspectives, with the former perspective evaluating the generated complaint as a whole by scoring its format and professionalism, and the latter focusing"}, {"title": "5.2 More Analysis", "content": "Analysis of client behavioral consistency. To demonstrate the effectiveness of MILE Benchmark,"}, {"title": "6 Related Work", "content": "Legal LLM. Legal-domain LLMs have achieved astounding performance on legal tasks, such as legal information extraction (Bommarito et al., 2018), case retrieval (Ma et al., 2021), judgment prediction (Huang et al., 2021), which offer broad applications that benefit different groups of the population. Initial progress (Huang et al., 2023; Yue et al., 2024a; Deng et al., 2023) has been made by fine-tuning general LLMs to utilize legal knowledge for different legal tasks. Specifically, Lawyer-LLaMa (Huang et al., 2023) and Interrogatory inject domain knowledge during continuous training. Fuz-imingcha trained on a vast corpus of unsupervised Chinese legal texts and supervised judicial fine-tuning data. LawLLM (Yue et al., 2023, 2024a) introduces legal retrieval capability to enhance factuality. Previous approaches focused on static tasks, ignoring the dynamic properties of real-world legal tasks. To fill this gap, this study places emphasis"}, {"title": "7 Conclusion", "content": "In this paper, we introduce the Multi-agent Legal Simulation Driver (MASER), a legal-specific simulator that serves as data-generation engine, empowering arbitrary LLMs with intensive interaction capabilities. In MASER, we establish consistency in the legal attributes among roles using real legal case sources, and introduce a supervisory mechanism to align the characters and behaviors during interactions, which enables high-quality and sentence-level aligned legal interaction data. In addition, an interactive legal benchmark, Multi-Stage Interactive Legal Evaluation (MILE), is proposed to evaluate the capacity of LLMs as lawyers in performing legal tasks (i.e., complaint drafting) within dynamic scenarios. The experimental results demonstrate the effectiveness of our MASER. Our framework can extend more complex domain scenarios, bridging the gap between intensive interaction and achieving special objectives."}]}