{"title": "Fiber Transmission Model with Parameterized Inputs based on GPT-PINN Neural Network", "authors": ["YUBIN ZANG", "BOYU HUA", "ZHIPENG LIN", "FANGZHENG ZHANG", "SIMIN LI", "ZUXING ZHANG", "HONGWEI CHEN"], "abstract": "In this manuscript, a novelty principle driven fiber transmission model for short-distance transmission with parameterized inputs is put forward. By taking into the account of the previously proposed principle driven fiber model, the reduced basis expansion method and transforming the parameterized inputs into parameterized coefficients of the Nonlinear Schr\u00f6dinger Equations, universal solutions with respect to inputs corresponding to different bit rates can all be obtained without the need of re-training the whole model. This model, once adopted, can have prominent advantages in both computation efficiency and physical background. Besides, this model can still be effectively trained without the needs of transmitted signals collected in advance. Tasks of on-off keying signals with bit rates ranging from 2Gbps to 50Gbps are adopted to demonstrate the fidelity of the model.", "sections": [{"title": "1. Introduction", "content": "Nowadays, the disciplinary field of artificial intelligence (AI) and fiber optics has been developing at a remarkable pace[1-3]. When it comes to fiber transmission, the characteristics of how the attenuation, dispersion and non-linearty have influence on the signal propagation can be accurately described by the Non-linear Schr\u00f6dinger Equation (NLSE)[4]. Like other partial derivative equations, NLSE rarely posses analytical solutions. Therefore, traditional communication simulation software usually adopts the Split Step Fourier Method (SSFM) to obtain the numerical solutions. By dividing the whole transmission distance into various basic computing units and assuming that the effect of dispersion and non-linearity decouples in each computing unit, SSFM can sequentially compute the signal waveforms unit by unit till the end [5-6]. Though SSFM is accurate as long as the length of computing unit is appropriately determined, it may consume large scale of running time especially for cases with long distance or strong non-linearity.\nResearchers have been trying to utilize the Al's strong regression ability to overcome the drawback of SSFM. Indeed, multiple AI based fiber transmission models have been put forward in recent 10 years. Among them are bidirectional long short time memory (BiLSTM) models [7], Generative Adversarial Network (GAN) [8-9] models, attention mechanism models [10-11] and etc. These models have greatly increased the computational efficiency but discard the physical background behind the signal transmission since they all view as the pure regression tasks. Besides, these models can be ineffective unless the transmitted signals are collected in advance. In order to better keep the balance between computing efficiency and the physical background, principle driven fiber models were proposed. By adopting NLSE as its loss functions to guide the model's convergence, the model can progressively establish the relations between the coordinates of both time and distance with the shape of signals. The model can not only be effectively trained without the pre-collected signals after transmission, but also remain the physical background. However, for the optimizing of fiber communication systems which in important in the B5G communication system establishing, the inputs are always changeable with various bit rates, but it is inconvenient for the principle driven fiber transmission model to efficiently compute because it needs to be retrained for different input signals [12-13].\nTherefore, In this manuscript, the generalized principle driven fiber transmission model which can deal with input signals with different bit rates without re-training the whole model is proposed. This work can be successfully completed by transforming the parameters of the inputs into the coefficients of NLSE and taking both previously proposed principle fiber driven model and the reduced basis expansion method to establish the generalized model. The article will be developed into four parts. Backgrounds and motivations will be illustrated in the introduction part. Then both principles of parameter transform, principle driven models and reduced basis method will be developed in the second part. Task of OOK with bit rates ranging from 2Gbps to 100Gbps which is utilized to test the whole model will be illustrated and analyzed in the part of simulation setups and analysis. Advantages and further research interests will be discussed in the conclusion part."}, {"title": "2. Model structures and configurations", "content": ""}, {"title": "2.1 Fiber Transmission and Parameter Transform", "content": "According to the theory of fiber optics and transmissions, Nonlinear Schr\u00f6dinger Equation (NLSE) is used to mathematically describe how attenuation, dispersion and non-linearity affect the signal propagation which can be expressed as\n$\\begin{aligned}i \\frac{\\partial S}{\\partial z}+i\\frac{\\alpha}{2} S+\\frac{i \\beta_{3}}{6} \\frac{\\partial^{3} S}{\\partial T^{3}} &= \\frac{\\beta_{2}}{2} \\frac{\\partial^{2} S}{\\partial T^{2}}+\\gamma|S|^{2} S=0 \\\\ &{\\left[S(z=0, T ; R_{b})=F\\left(T ; R_{b}\\right)\\right.} \\end{aligned}$\nin which S=S(T,z;Rb) denotes the solution of NLSE under the initial condition F(T; Rb). Here, both solution and initial condition closely related with bit rate, therefore, Rb becomes the important parameter. z and T represents the original distance and time coordinate under the time-retarded frame. \u03b1, \u03b22, \u03b23 and \u03b3 is the loss per distance, second-order phase propagation constant, third-order phase propagation constant and nonlinear coefficient which reflect the attenuation, dispersion, high-order dispersion and nonlinear effect respectively.\nObserved from Eq.(1), parameters are introduced by the initial condition which seems to be hard to handle. But fortunately, since only bit rate varies, this parameter can be moved from the initial condition into coefficients of NLSE by choosing the appropriate time coordinate transform. Other coordinate transform including time, distance coordinate transform, intensity transform are necessary so as to obtain the standard NLSE in which normalized time ranges from -1 to 1, normalized distance ranges from 0 to 1 and normalized amplitude or intensity of the signal ranges from 0 to 1. This normalization can also let the neural network based model which will be illustrated later work in a proper way. In all, the coordinate transforms are defined as\n$\\begin{aligned}\\xi &=\\frac{z}{L_{\\max }} ; \\tau=\\frac{T}{T_{\\max }}; s=\\frac{S}{P_{0}} \\\\ L_{D} &=\\frac{1}{\\left|\\beta_{2}\\right|}\\left(\\frac{1}{R_{b}}\\right)^{2} ; L_{N L}=\\frac{1}{\\gamma P_{0}} \\\\ L_{D 3} &=\\frac{1}{\\left|\\beta_{3}\\right|}\\left(\\frac{1}{R_{b}}\\right)^{3} \\end{aligned}$\n$\\begin{aligned}z=L_{\\max } \\zeta=K_{1} L_{D} \\dot{\\zeta} \\\\\nT=T_{\\max } \\tau=K_{2} \\frac{1}{R_{b}} \\dot{\\tau} \\\\S=\\sqrt{P_{0}} s\\end{aligned}$\n$\\begin{aligned}i A_{1} \\frac{\\partial s}{\\partial \\zeta}+i K_{1} A_{2} \\frac{\\partial^{2} s}{\\partial \\tau^{2}}+i K_{1} A_{3} \\frac{\\partial^{3} s}{\\partial \\tau^{3}}+K_{1} A_{5}|s|^{2} s=0 \\\\\ns(\\zeta=0, \\tau)=f(\\tau)\\end{aligned}$\nin which s=s(t,s) represents the normalized solution. Rs now becomes the parameter of those coefficients K1, K2, A2,A4, A5 of the normalized NLSE. The initial condition f(t) is no longer related with the symbol rate. Under this circumstance, those five equals\n$\\begin{aligned}&A_{1}=-\\frac{\\alpha}{2} L_{D} \\\\\n&A_{2}=\\frac{\\beta_{2} L_{D}}{2 R_{b}^{2}} ; A_{4}=-\\frac{\\beta_{3} L_{D}}{6 \\beta_{2} R_{b}} ; A_{5}=\\frac{\\gamma P_{0} L_{D}}{2 \\beta_{2} R_{b}^{2}}\\end{aligned}$"}, {"title": "2.2 The Principle Driven Fiber Model", "content": "The principle driven fiber model as previously proposed is a multi-layer fully connected network with respect to normalized time and distance coordinates (t,s) under the time-retarded frame as its inputs and the real and imaginary part of the waveform value (SR,SI) as its outputs. Linear multiplications and nonlinear Tanh() activation consist of the basic computations between each layer.\nUnlike other data driven models which utilize normalized mean square error (NMSE) as their loss functions, the principle driven fiber model substitutes its prediction into NLSE to calculate the residue error as to measure the prediction precision. Besides, the principle driven fiber model also compares the distance between the prediction at 0 distance with the initial condition, i.e, the input signal. This loss function can be defined as\n$\\begin{aligned}&L=\\frac{1}{N_{g}} \\sum_{k=1}^{N_{8}} \\left|A_{1} \\frac{\\partial s_{\\text {pred }}}{\\partial \\xi}+i K_{1} A_{2} s_{\\text {pred }}+K_{1} A_{3} \\frac{\\partial^{2} s_{\\text {pred }}}{\\partial \\tau^{2}}+K_{1} A_{5}\\left|s_{\\text {pred }}\\right|^{2} s_{\\text {pred }}\\right| \\\\\n&+\\frac{1}{N_{i m i}} \\sum_{k=1}^{N_{i m i}} \\left|s_{\\text {pred }}(\\zeta=0, \\tau)-s_{k}(\\zeta=0, \\tau)\\right|\\end{aligned}$\nIn Eq.(5), Ng and Nini represents the points of the solution and initial condition respectively."}, {"title": "2.3 Reduced Basis Expansion Method", "content": "Until now, the solutions for the previously proposed fiber model is a one-by-one solution which indicates that each model should be specifically trained for each Rb which can consume large amounts of time when the scale of Rb is large. In order to compress both the scale and number of fiber models to be trained to obtain the solutions for each Rb, reduced basis expansion method is utilized.\nIt should be noticed that, the findings of c in greedy algorithm can adopt the gradient descend method in order to increase the search efficiency. In order to do so, it is necessary to calculate both values and gradients of approximation errors. The errors can be expressed as\n$\\begin{aligned}\\sum_{k=1}^{N_{g}} \\mid A_{1} \\frac{\\partial s_{\\text {pred }, k}}{\\partial \\xi}+i K_{1} A_{2} s_{\\text {pred }, k}+K_{1} A_{3} \\frac{\\partial^{2} s_{\\text {pred }, k}}{\\partial \\tau^{2}}+K_{1} A_{5}\\left|s_{\\text {pred }, k}\\right|^{2} s_{\\text {pred }, k}\\right|\\\\&+\\frac{1}{N_{i n i}} \\sum_{k=1}^{N_{i n i}}\\left|s_{\\text {pred }}(\\zeta=0, \\tau)-s_{k}(\\zeta=0, \\tau)\\right|\\end{aligned}$"}, {"title": "3. Simulation results and analysis", "content": ""}, {"title": "3.1 Simulation Configurations", "content": "Task of OOK signal transmission whose bit rates range from 2Gbps to 50Gbps is utilized to demonstrate the performance of the model. Table 1 clearly shows the simulation configurations for the task. All parameters of the transmission link take value from the standard single mode fiber.\nWhen it comes to the configuration of the principle driven fiber model as is shown in Table 2, for single pulse predicting, the scale of hidden layers is determined to be 6 layers, each with 100 neurons. Early stopping and maximum training epochs is set to be 10-4 and 40000 respectively. As for the configurations of the reduced basis expansion method, the maximum number of basis taken for estimating the universal solution is decided to be 12."}, {"title": "3.2 Training of the Principle Driven Fiber Model", "content": "The training algorithm for the previously proposed principle driven fiber model is adaptive gradient descend method (ADAM) [15]. Fig. 2 shows both convergence performance and final prediction of each basic solution. As can be seen from the left column, the loss function descends quickly in the first 1000-2000 epochs. Then it slows down to better search for the local minima. The whole trend of the convergence curve is in consistent with the characteristics of ADAM. Apart from the convergence rate, there still exists several fluctuations which indicates that it can be relatively challenging for the model to map both time and distance coordinate into waveform transmitted."}, {"title": "3.3 Training of the Reduced Basis Expansion", "content": "After each basic solution is found by the previously proposed fiber transmission model, approximation errors should be minimized by finding of the most appropriate linear combination coefficients with all basic solutions till now and checked for the prediction precision of each different value of Rb. Fig.3 clearly shows the process of finding the best linear combination coefficients and the error for each Rb."}, {"title": "3.4 Performances of the Parameterized Fiber Model", "content": "The performances of the model is to utilized all basic solutions obtained to better approximate generalized solutions with respect to different Rb. Some results for typical values of Rb is shown in Fig.4. What is interesting is that, the basic solutions found for approximation gather around the larger part of bit rates. This phenomenon indicates that the model tends to predict more accurately for the signals with lower bit rates."}, {"title": "3.5 Computational Complexity Comparison", "content": "The improvement of prediction accuracy can lay on the increase in the scale of the model, i.e, the number of layers, the number of neurons in the previously proposed fiber model, maximum number of basis in the reduced basis expansion method and so on. This is because larger scale of model tend to have better ability of capturing more detailed and rapidly changed characteristics which will results in the increase in prediction accuracy.\nLogarithmic loss of the model's prediction with respect to the whole bit rate can be directly seen in Fig. 5. Those bit rates which are chosen to be basic solutions are marked with colored triangles. The color is in consist with that of Fig. 2. Other parameters are marked in blue. As can be seen from the figure, all loss are lower than 10-3 which shows relatively great prediction accuracy of the model. Those errors of the \u2018specially selected' parameter to form basic solutions are no longer to be the largest among all except 50Gbps. This is because waveforms with the largest bit rate contains more severe changes during the propagation which becomes the most challenging prediction task for the model.\nTime consumption distribution can be obviously seen in Fig.6. Here, training of basic solutions takes up most of the time. Different basic solution training consumes different time due to the different difficulty of letting the solution converge under different bit rates.\nComparison of computational complexity between SSFM, previously proposed fiber model and the fiber model proposed in this manuscript is also necessary. Few assumptions ought to be put forward before comparison. In order to erase out the differences between each operating software, the scale of multiplications and additions (MAC) is utilized as the comparison standard. Here, there are in total T different values of Rb. Both coordinates of time and distance are discretized into M\u2081 and Mr respectively. The longest transmission distance is Lmax. For comparison fairness, both principle driven fiber model and the inserted fiber model inside the parameterized model posses K hidden layers, each layer contains P neurons. For the parameterized fiber model, the maximum basis is determined to be Nb. The length of computational unit equal Lu. Under these assumptions, the computational complexity of SSFM can be calculated as\n$C_{S S F M}=O\\left(\\frac{T L_{\\max }}{L_{u}} M_{1} M_{r} \\log _{2} M_{1}+N_{\\text { neurons }}+N_{\\text { active }}\\right)$\nThe complexity of the previously proposed fiber model should be\n$C_{f}=O\\left(2 T P+T(K-1) P^{2}\\right)$\nAnd the complexity of the parameterized fiber model equals\n$C_{p f}=O\\left(2 N_{b} P+N_{b}(K-1) P^{2}+2 N_{b}\\right)$\nSince N is greatly larger than T, it can be easily concluded that the computational complexity of the parameterized fiber model is only the T/N of that of the previously proposed fiber model."}, {"title": "4. Conclusions and discussions", "content": "In this manuscript, the principle driven fiber model for parameterized input signals is proposed. By transforming the parameter from signals to NLSE, using both fiber model previously proposed and reduced basis expansion method, any solutions with respect to different bit rates can be expressed in a relatively high accuracy.\nSeveral great advantages can be obtained when taking the model into use. First, this model can keep the better balance between prediction accuracy and physical backgrounds since it takes NLSE to design its loss function. Second, compared with other data driven models, this model can still be effectively trained without the needs to collect large scale of transmitted signals before hand. Most importantly, this model can solve signals transmitted at different bit rates all without the need to retrain the whole model which can greatly save large amounts of model's complexity."}]}