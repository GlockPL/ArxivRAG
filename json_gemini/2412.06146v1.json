{"title": "Homogeneous Dynamics Space for Heterogeneous Humans", "authors": ["Xinpeng Liu", "Junxuan Liang", "Chenshuo Zhang", "Zixuan Cai", "Cewu Lu", "Yong-Lu Li"], "abstract": "Analyses of human motion kinematics have achieved tremendous advances. However, the production mechanism, known as human dynamics, is still undercovered. In this paper, we aim to push data-driven human dynamics understanding forward. We identify a major obstacle to this as the heterogeneity of existing human motion understanding efforts. Specifically, heterogeneity exists in not only the diverse kinematics representations and hierarchical dynamics representations but also in the data from different domains, namely biomechanics and reinforcement learning. With an in-depth analysis of the existing heterogeneity, we propose to emphasize the beneath homogeneity: all of them represent the homogeneous fact of human motion, though from different perspectives. Given this, we propose Homogeneous Dynamics Space (HDyS) as a fundamental space for human dynamics by aggregating heterogeneous data and training a homogeneous latent space with inspiration from the inverse-forward dynamics procedure. Leveraging the heterogeneous representations and datasets, HDyS achieves decent mapping between human kinematics and dynamics. We demonstrate the feasibility of HDyS with extensive experiments and applications. The project page is https://foruck.github.io/HDyS.", "sections": [{"title": "1. Introduction", "content": "Analyses on human motion have a wide range of applications including animation, healthcare, and robotics. The computer vision community has made tremendous progress in understanding human kinematics with tasks like human reconstruction, action recognition, and motion generation. However, the production mechanism hidden beneath human motion, known as human dynamics, is still limitedly explored.\nIn this paper, we aim to push the understanding of human"}, {"title": "2. Related Works", "content": ""}, {"title": "2.1. Human Dynamics", "content": "By human dynamics, we mean the production mechanism of human motion, which the biomechanics community has actively explored. To produce a certain motion, neural commands are sent to activate the muscles. After receiving the activation signals, muscles contract and produce muscle forces. Multiple muscle forces form the joint torques according to certain musculoskeletal geometry, and the joint torques drive the accelerations that accumulate into movements. Thus, understanding human dynamics typically involves two heterogeneous hierarchies: joint torques and muscle activations. However, both are hard to measure non-intrusively. In the literature, to obtain them, an optimization problem is typically introduced as\nmin ||a||, s.t. 0 \u2264 a \u2264 1, \u03c4 = A(q)F(a),\nM(q)q+C(q, q) + G(q) = JX + \u03c4.\nwith the generalized human inertia matrix M(q) w.r.t. generalized coordinate q, Coriolis and centrifugal forces C(q, q), gravity G(q), Jacobian matrix J mapping external forces X to the generalized coordinates, and muscle activations a. The joint torques could be obtained by \u03c4 = A(q)F(a), where A(q) maps muscle forces into joint torques and F(a) maps a into muscle forces usually with the hill-type function."}, {"title": "2.2. Learning-based Human Dynamics", "content": ""}, {"title": "Joint Torques.", "content": "Early efforts were made on ML-based joint torque analysis for certain human body parts. Lv et al. developed a Gaussian mixture framework for whole-body joint torque estimation. Other architectures like k-nearest neighbor-based regression, random forests, and neural networks were also adopted for the estimation of joint torques. However, most of these efforts suffered from limited data scale, which hampered learning methods from exploiting their full potential. The recent emergence of AddBiomechanics, which aggregated multiple biomechanics datasets, considerably boosted the data scale. However, most of the collected sequences contained only gaits with limited diversity. Another line of work adopted reinforcement learning to simulate motion in physics simulators, and the joint torques could be obtained in simulation. Though generalizability was limited at first, emerging efforts managed to replicate a wide span of motion in simulators. The paradigm is further incorporated into recent MoCap systems for simultaneous estimation of motion and the joint torques. However, due to the involvement of simulators, the sim2real gap exists. The learned dynamics could be restricted to certain simulators or human models, which might diverge from real humans."}, {"title": "Muscle Actions.", "content": "sEMG is usually adopted as a proxy measurement of muscle actions and has been extensively studied in biomechanics. There have been efforts delving into predicting sEMG signals given either joint torques, goniometers, motion"}, {"title": "3. Method", "content": "We introduce the proposed Homogeneous Dynamics Space (HDYS). We first cover the involved kinematics and dynamics representations in Section 3.1, 3.2. Then, the model architecture and designed losses are introduced in Section 3.3."}, {"title": "3.1. Kinematics Representations", "content": "As shown in Fig. 2, we adopt four types of kinematics representations: Cartesian representations of markers and skeleton key-points, joint angles of Rajagopal's model from the biomechanics community, and SMPL which is widely adopted for CV and CG applications.\nMarkers, placed on the human body surfaces, are typically the raw data for optical motion capture. In practice, most other representations are calculated by fitting certain human prior models to the marker observations, making it easy to obtain for heterogeneous datasets and representations. Thus, markers are expected to be a generalizable representation across heterogeneous datasets, though they could also be rather low-level and thus hard to learn. We define the marker representation at timestamp t as xm = (mt,mt,m) \u2208 RNm\u00d79, which is composed of marker Cartesian coordinates mt, finite-differentiated velocities m and finite-differentiated accelerations mt with Nm markers. Skeletal Keypoints, compared to markers, are less generalizable due to their reliance on pre-defined kinematic trees. However, with its Cartesian coordinates, common sense of human topology, and easy access, the gap between different kinematic trees can be mitigated. We define the joint representation at timestamp t as x1 = (kt, kt,k) \u2208 RNk\u00d79, which is composed of joint coordinates kt, finite-differentiated velocities kt and finite-differentiated acceler-ations kt with Nk skeletal joints.\nJoint Angles are preferred for clinical analyses which more faithfully preserves the biomechanics information of human kinematics. We adopt the Rajagopal's model used in AddBiomechanics, and define the joint angle representation at timestamp t as x = (at, at, \u00e0) \u2208 R3Nj, containing joint angles at, finite-differentiated velocities at and acceler-ations at with N\u2081 joints in Rajagopal's model (only 23"}, {"title": "3.2. Dynamics Representations", "content": "We adopt three different types of dynamic representations: joint torques, muscle actions, and sEMGs.\nJoint Torques are the net torques exerted at each joint to drive the motion, represented as Tt \u2208 RNt. Nt is coupled with the number of joints Nj as Nt = N; - 6, with the 6-DoF free root joint unactuated. For clarity, we denote the joint torques corresponding to Rajagopal's model as Ttr, and that corresponding to SMPL as Tts.\nMuscle Actions represent the activation level of each muscle, resulting in the muscle forces that produce joint torques. We denote muscle actions as Tm \u2208 RNm with Nm muscles. SEMG detects the electric potential generated on the body surface by activated muscle cells, which is closely related to muscle actions. We represent sEMGs at timestamp t as T\u2208 RNe with Ne sEMG channels."}, {"title": "3.3. Homogeneous Dynamics Space", "content": "With the heterogeneous representations, we construct our homogeneous dynamics space (HDyS) as an aggregation of multiple auto-encoders corresponding to the inverse-forward dynamics procedure. Then, reconstruction and alignment losses are adopted for supervision. For simplicity, all superscripts t are omitted."}, {"title": "4. Experiments", "content": ""}, {"title": "4.1. Datasets", "content": "AddBiomechanics contains over 50 hours of human motion data with joint torques from Nimble simulation. We follow the setting in with the armless part of AddBiomechanics. Markers, key points, and joint angles are used as kinematics representations, and joint torques corresponding to represent the dynamics.\nMuscles in Times (MinT) simulates part of AMASS in OpenSim to obtain the actions of 402 muscles. We randomly split them into 906 sequences for training and 227 sequences for testing. Markers, key points, and SMPL parameters are used as kinematics representations, and muscle actions are the dynamics representations.\nMuscles in Act (MiA) consists of 12.8 hours of human exercise motion reconstructed from videos with VIBE and sEMG data of 8 muscles. Following, We split them into 19,563 training sequences and 3,053 testing sequences. Markers and key points are kinematics representations, and SEMGs are dynamics representations.\nImDy adopted PHC to imitate motion sequences from AMASS and KIT, resulting in over 150 hours of human dynamics data, with 27,501 sequences for training and 3,055 sequences for evaluation. Markers, key points, and SMPL are kinematics representations, and SMPL torques are dynamics representations.\nAMASS contains over 11,000 motion sequences represented in SMPL. Though not paired with human dynamics, we included it as an extra knowledge base for training. Markers, key points, and SMPL parameters are used as kinematics representations."}, {"title": "4.2. Implementation Details", "content": "We adopt a compact design for HDyS with a latent dimension of 128. For joint angle and SMPL parameters, three-layer MLPs with hidden unit sizes of 256 and 128 are adopted as encoders, projecting the input to the 128-D latent space. For markers and key-points, three-layer transformer encoders with 2 heads are adopted as encoders. The transformer in the ID decoder is of 4 layers, 4 heads, and a dimension of 128. All MLPs in decoders are two-layer, with a hidden size of 32 for Rajagopal's torque, SEMG, joint angle accelerations, and key-point accelerations, and a hidden size of 64 for SMPL torque, SMPL accelerations, and muscle actions. For training, we adopt an AdamW optimizer with a learning rate of le-3 and a batch size of 9,600 frames for 1,000 epochs. Loss weights are set as \u03b1\u2081 = 0.01, \u03b12 = 0.05. Also, during training, a balanced sampling strategy is adopted to minimize the scale influence of different datasets. That is, we randomly sample 3,000 sequences per dataset for each training epoch. In this way, the comparison is fair in terms of the number of seen samples under different dataset settings. All experiments are conducted on a single NVIDIA Titan Xp GPU."}, {"title": "4.3. Results on Inverse Dynamics", "content": ""}, {"title": "Metric.", "content": "We report mPJE and RMSE as\nMPJEj= 1/J \u03a3||\u03c4j - \u03c4_j||2, RMSEj = ||\u03c4j - \u03c4_j||2."}, {"title": "4.3.1 Quantitative results", "content": "Quantitative results are shown in Tab. 1, where HDyS is reported with the averaged predictions from different input kinematics representations and the best predictions among all representations. Compared to previous methods [3, 31], the proposed HDyS provides superior performances with substantial improvements on all datasets. We further analyze the performance of HDyS with three questions.\nHow do the heterogeneous datasets contribute to HDyS?\nWe compare HDyS with its single-dataset variants and drop-one-out variants in Tab. 1. HDyS outperforms the corresponding single-dataset variants on all datasets, validating the existence of homogeneous human dynamics knowledge behind these heterogeneous datasets. According to the drop-one-out results, it is noticeable that datasets with similar dynamics representations are more cooperative. That is, muscle-related datasets (MiA and MinT) tend to benefit more from each other and less from torque-related datasets (AddBiomechanics and ImDy), and vice versa. Moreover, mutually harmful effects could be observed for ImDy and MinT. These are consistent with the gaps between these datasets: the sim2real gap from ImDy to others and the torque-to-muscle gap from AddBiomechanics and ImDy to MiA and MinT. AMASS, though not paired with dynamics information, is shown to be beneficial for inverse dynamics with its diverse and high-quality kinematics.\nThe heterogeneous datasets introduce both increased data scale and heterogeneous knowledge. Given this, we try to investigate further the source of the improvement in Tab. 1. Trying to decompose the contributions of scale and heterogeneity, we compared the performance of the following three models on a single target test set in Tab. 2. HDyS-Single-50 denotes single-dataset HDyS with 50% of the data from the target dataset. HDyS-50/50 denotes HDyS using 50% of the data from the target dataset and 50% of the data from the other datasets, maintaining the same data scale as the target dataset. HDyS-Single represents the corresponding single-dataset variants of HDyS in Tab. 1. The performance of the best representation is reported on AddBiomechanics and MiA, considering their suitable scale and realistic nature. As shown, HDyS-50/50 consistently"}, {"title": "4.3.2 Qualitative results", "content": "We visualize the inverse dynamics results of different datasets. As shown in Fig. 4-5, the joint torques could be faithfully reconstructed for different actions from either synthetic and jittering ImDy or realistic AddBiomechanics with the same HDyS. For muscle actions shown in Fig. 6, HDyS manages to produce reasonable estimations for lower-body muscles when walking. Moreover, as in the right half, though the lower-body kinematics are less significant, HDyS could capture the ankle muscle actions with high fidelity. The predictions are also coherent with GT for upper-body muscles like the internal oblique and levator scapulae. More details are in the appendix."}, {"title": "4.4. Results on Downstream Tasks", "content": ""}, {"title": "4.4.1 Ground Reaction Force Estimation", "content": "We evaluate the effectiveness of HDyS on GRF estimation with GroundLink, which contains 1.5-hour motion with GRF recordings. We finetune HDyS with subjects 1-6, and evaluate it on subject 7. mPJE for GRF at both feet normalized by body weight is reported following Eq. 4. GroundLinkNet and HDyS trained on GroundLink from scratch are also compared. As shown in Tab. 4, the finetuned HDyS outperforms its counterparts, indicating the efficacy of the aggregated homogeneous knowledge. Also, the GroundLink-only HDyS outperforms GroundLinkNet, reflecting the feasibility of unifying heterogeneous representations for better dynamics knowledge."}, {"title": "4.4.2 Biomechanical Human Simulation", "content": "HDyS could also be adopted for biomechanical human simulation. We start with the armless Rajagopal's model in Nimble. Given a motion sequence, we first adopt HDyS to estimate the joint torques. Then, we use the predicted torques to reproduce the motion in Nimble. Starting from the current state, we feed the predicted torques for k steps and compare the simulated joint angles q with the real joint angles q. The simulation is performed at 90FPS. We report the per-frame MSE of joint angles.\nResults. We demonstrated the results in Tab. 5 and Fig. 7, the results with optimized torques are also reported as a reference. Surprisingly, for different k, simulation with HDyS is superior with better stability. However, it could be shown"}, {"title": "4.4.3 Physical Character Control", "content": "We adopt HDyS for physical character control following the setting of PHC, with 140 testing sequences and the rest for training. We train the baseline as a primitive in PHC with a batch size of 700 for 10k steps. Then, the HDyS latents of key points are inserted as extra observations. We report the global and local mPJPE and the errors of velocity and acceleration in Tab. 6. HDyS manages to improve its performance, validating its efficacy."}, {"title": "5. Discussion", "content": "Despite the impressive results of HDyS, it could be improved. First, it is noticeable that HDyS performs better for the lower body than the higher body in Fig. 6. This might be due to the imbalanced focus on lower body dynamics in datasets adopted by HDyS. For all datasets, data on lower-body dynamics like gaits are dominating. And for"}, {"title": "6. Conclusion", "content": "We analyzed the heterogeneity issue existing for human dynamics learning and highlighted the homogeneity beneath it. To fully exploit the homogeneity, we proposed HDyS as a homogeneous human dynamics space. Extensive experiments were conducted to validate the feasibility of digging homogeneity out from heterogeneity for human dynamics with detailed analyses of the contribution of heterogeneous components. We further demonstrated the potential of HDyS for downstream applications. We believe HDyS could shed new light on human dynamics understanding."}, {"title": "A. Licenses", "content": "All the data used are from the open-sourced datasets and for research purposes only. We give the links to the gathered datasets here.\n\u2022 AMASS: https://amass.is.tue.mpg.de /\nlicense.html\n\u2022 Muscles in Actions: https://musclesinaction. cs.columbia.edu/\n\u2022 AddBiomechanics: https://addbiomechanics. org/download_data.html\n\u2022 Muscles in Time: https://davidschneider.ai/ mint/\n\u2022 ImDy: https://foruck.github.io/ImDy/"}, {"title": "B. Extensive Experiments", "content": ""}, {"title": "B.1. Analysis on Parameters", "content": "We compare the size of the models involved in Table 1 in Table 7. The full HDyS is comparable in #param compared with previous efforts. In addition, it could process four heterogeneous kinematics representations and four heterogeneous dynamics representations, which could not be fulfilled with previous efforts. Moreover, even with a much smaller model scale, HDyS-32D and HDyS-64D manage to provide competitive performances, validating the efficacy of heterogeneous knowledge."}, {"title": "B.2. Extensive Results on Inverse Dynamics", "content": ""}, {"title": "B.2.1 Data Construction", "content": "To decompose the contributions of scale and heterogeneity, we construct two sets of control experiments. The first set of control experiments were controlled for the same data scale, and they differed only in whether the data constituted heterogeneity or not. The second set of control experiments varies only in the scale of the data.\nThus, we constructed HDyS-50/50 to form the first set of control experiments with the original HDyS-Single, and"}]}