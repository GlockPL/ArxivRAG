{"title": "LLM-Powered Multi-Agent System for Automated Crypto Portfolio Management", "authors": ["Yichen Luo", "Yebo Feng", "Jiahua Xu", "Paolo Tasca", "Yang Liu"], "abstract": "Cryptocurrency investment is inherently difficult due to its shorter history compared to traditional assets, the need to integrate vast amounts of data from various modalities, and the requirement for complex reasoning. While deep learning approaches have been applied to address these challenges, their \"black-box\" nature raises concerns about trust and explainability. Recently, large language models (LLMs) have shown promise in financial applications due to their ability to understand multi-modal data and generate explainable decisions. However, single LLM faces limitations in complex, comprehensive tasks such as asset investment. These limitations are even more pronounced in cryptocurrency investment, where LLMs have less domain-specific knowledge in their training corpora. To overcome these challenges, we propose an explainable, multi-modal, multi-agent framework for cryptocurrency investment. Our framework uses specialized agents that collaborate within and across teams to handle subtasks such as data analysis, literature integration, and investment decision-making for the top 30 cryptocurrencies by market capitalization. The expert training module fine-tunes agents using multi-modal historical data and professional investment literature, while the multi-agent investment module employs real-time data to make informed cryptocurrency investment decisions. Unique intrateam and interteam collaboration mechanisms enhance prediction accuracy by adjusting final predictions based on confidence levels within agent teams and facilitating information sharing between teams. Empirical evaluation using data from November 2023 to September 2024 demonstrates that our framework outperforms single-agent models and market benchmarks in classification, asset pricing, portfolio, and explainability performance.", "sections": [{"title": "1 INTRODUCTION", "content": "Cryptocurrency investment is a challenging and comprehensive task due to its limited asset pricing evidence [9, 13], the requirement for data from various modalities [19, 20, 30, 31], and the need for complex reasoning [17]. As a result, analyzing the cryptocurrency market, designing strategies, and building portfolios become a huge undertaking and impose a heavy workload on financial experts, making professional services either scarce or expensive [6]. To address these challenges, many researchers have explored the use of deep learning techniques [15, 23] for cryptocurrency investment. However, the \"black-box\" nature of most deep learning models raises concerns about trust and explainability, making investors hesitant to rely on these techniques when investing their capital [4, 5, 25].\nThe introduction of large language models (LLMs) has revolutionized the financial field, offering promising solutions for cryptocurrency investment. Numerous studies have demonstrated the strong capability of LLMs to understand and learn from multi-modal data [39] such as text [27, 38] and images [40], which makes them well-suited for learning professional cryptocurrency investment knowledge and analyzing the market from data in different modalities. On the other hand, LLMs has excellent natural language generation capability [28, 35], which enables them to generate explainable cryptocurrency investment decisions. However, the performance of single LLMs in asset prediction is limited due to the comprehensive nature and complex reasoning requirement of this task [24, 37]. The weakness is even more pronounced in cryptocurrency investment, where LLMs have less domain-specific knowledge in their training corpora. To address this type of challenge, researchers have developed methodologies that decompose complex tasks into subtasks [32, 36]. This method uses the collaboration between multiple LLM-based agents to derive final comprehensive solutions,"}, {"title": "2 RELATED WORKS", "content": "In this section, we review the progress of empirical cryptocurrency pricing research and examine works that utilize single LLM and multi-agent frameworks for investment.\nEmpirical Cryptocurrency Pricing. As an emerging class of alternative assets, cryptocurrencies have attracted significant research interest, particularly in the field of asset pricing. Empirical cryptocurrency pricing is a branch of empirical asset pricing originally developed by Eugene Fama and Kenneth French to explain asset returns [12]. Early studies in empirical cryptocurrency pricing focused on the predictability of market returns, identifying factors such as network activity, momentum, and investor attention as strong predictors of future cryptocurrency market returns [30]. Additionally, news sentiment has been shown to significantly impact cryptocurrency market returns [1]. Subsequently, market, size, and momentum factors were identified as key determinants of cross-sectional expected cryptocurrency returns, leading to the development of cryptocurrency-specific three-factor models [31]. Moreover, trend-based technical indicators, commonly identified on candlestick charts, have also demonstrated predictive power in forecasting cross-sectional cryptocurrency returns [34]. While these studies highlight robust predictive information across various modalities, including panel data, textual information, and chart patterns, there remains a significant gap in the development of a unified model capable of integrating these diverse data modality.\nLarge Language Models for Investment. With their powerful text understanding and reasoning capabilities, LLMs have become widely used in different investment tasks. Early studies have focused on employing single LLMs to predict asset prices and execute investment strategies. Some works have attempted to fine-tune their own financial LLM to complete investment tasks [24, 29, 37]. Additionally, one study specifically examined the performance of LLMs in trading three cryptocurrencies: Bitcoin, Ethereum, and Solana [26]. However, the predictive power of single LLMs remains limited even after fine-tuning, and their results often exhibit significant bias."}, {"title": "3 METHODOLOGY", "content": "In this section, we first decompose the cryptocurrency investment process into multiple subtasks and formalize them. Next, we present the proposed multi-agent cryptocurrency investment framework, depicted in Fig. 2. The framework consists of two main modules: (1) the expert training module, which fine-tunes agents using multi-modal historical data and professional investment literature; (2) the multi-agent investment module, which leverages real-time data to make informed cryptocurrency investment decisions.", "subsections": [{"title": "3.1 Problem Formulation", "content": null, "subsections": [{"title": "3.1.1 Cryptocurrency-cash allocation", "content": "Given a vector of market-specific risk factors $\u03b2_{t-1} = [f_i]_{p\u00d71}$ at week $t - 1$, where $p$ denotes the total number of factors, and news data $N_{t-1} = [N_i]_{q\u00d71}$ at week $t - 1$, where $q$ denotes the total number of news headlines, our goal is to generate the crypto weight $w_t$ to maximize the weighted market return: $arg \\underset{w_t}{max} r_{mkt}$ and a human-readable explanation $\u00ea_{mkt}$ at week $t$."}, {"title": "3.1.2 Cryptocurrency selection", "content": "Given a set of cryptocurrencies $C = \\{c_i\\}_{i=1}^{|C|}$, a matrix of crypto-specific risk factors $a_{t-1} = [a_{i,c}]_{m\u00d7n}$, where $m$ is the total number of crypto-specific risk factors and $n$ is the total number of cryptos, and a vector of visual data $v_{t-1} = [v_c]_{m\u00d71}$, we aim to generate a subset $C^* \u2282 C$ to maximize the average future 7-day returns of those cryptos $arg \\underset{C^*}{max} \\frac{1}{|C^*|} \\underset{c \u2208 C^*}{max} r_c$ and a human-readable explanation $\u00ea$."}]}, {"title": "3.2 Framework Overview", "content": "In this paper, we propose an explainable multi-agent framework for cryptocurrency investment, as illustrated in Fig. 2. Our framework consists of two major components: expert training and multi-agent investment. The first component, detailed in \u00a73.3, employs collaboration among multiple agents to generate training prompts that incorporate data from various modalities along with corresponding high-quality, case-by-case explanations. Subsequently, knowledge derived from diverse data modalities is integrated into the respective expert agents through fine-tuning. The second component, described in \u00a73.4, enables expert agents to manage corresponding subtasks in the cryptocurrency investment and collaboratively construct the final cryptocurrency portfolio. This framework aims to decompose complex investment challenges into smaller, specialized tasks handled by expert agents, thereby enhancing prediction accuracy and improving portfolio performance."}, {"title": "3.3 Expert Training", "content": "The expert training process involves collaboration among multiple agent teams.", "subsections": [{"title": "3.3.1 Data Team", "content": "Within the data team, the data fetcher is responsible for fetching and processing raw data. This agent utilizes tools to gather data from leading cryptocurrency providers, including Coingecko, Blockchain.info, Coin Metrics, and Cointelegraph. Once the raw data is fetched, the data fetcher processes it into multi-modal formats, including price trend ground truth, 30-day candlestick charts, risk factors (alphas), and news headlines, as illustrated in Fig. 1. The 30-day candlestick charts (Fig. 1a) and binary price trends (Fig. 1b) are derived from open high low and close (OHLC) price data and trading volume provided by Coingecko. Risk factors (Fig. 1c) are computed using OHLC price data, trading volume, and market capitalization from Coingecko, along with on-chain data sourced from Blockchain.info and Coin Metrics. Risk factors are categorized into five quintiles: \"Very Low\", \"Low\", \"Medium\", \"High\", and \"Very High\". The quintile cutoffs are determined using cross-sectional data for crypto-related factors and the initial two years of data for market-related factors. Additionally, news headline data (Fig. 1d) is obtained through web crawling from Cointelegraph. We report the detailed data description in Appendix A."}, {"title": "3.3.2 Literature Team", "content": "In the literature team, the literature fetcher is tasked with retrieving academic papers from Google Scholar. The academic papers are selected based on their relevance to specific data modalities in the domain of empirical cryptocurrency pricing."}, {"title": "3.3.3 Explanation Team", "content": "To generate training prompts with detailed case-by-case reasoning derived from academic papers, an explanation team is responsible for enhancing the training data."}]}, {"title": "3.4 Multi-Agent Investment", "content": "The multi-agent investment component employs collaboration among multiple agents to complete the cryptocurrency investment process. This process begins with the data team fetching and processing real-time multi-modal data from various providers, as detailed in \u00a73.3.1. Subsequently, the market team, crypto team, and trading team receive the processed data and complete their respective subtasks, contributing to the overall investment process.", "subsections": [{"title": "3.4.1 Market Team", "content": "To complete the cryptocurrency-cash allocation subtask described in \u00a73.1.1, the market team employs a trained news expert $A_{news}$ and a trained market factor expert agent $A_{mf}$ to predict market trends. Specifically, the news expert is provided with the System Instruction in 3 and a prompt generated by filling news headline data from the past week, $N_{t-1}$, into the template outlined in Prompt 6. Using this prompt, the news expert generates a prediction for the current week, $\\hat{Y}_{news}$, which includes two components: (1) a binary classification, $\\hat{y}_{news} \u2208 \\{\\text{``Rise''}, \\text{``Fall''}\\}$, representing the expected market trend for the upcoming week and (2) a human-readable explanation, $\\hat{e}_{news}$, that provides detailed reasoning behind the prediction, i.e., $\\hat{Y}_{news} = (\\hat{y}_{news}, \\hat{e}_{news})$. We can formalize this process as\n$\\hat{Y}_t = A(X_{mkt}),$\nwhere $X_{mkt}$ is the generalized market-specific data for the last week. In this scenario, $X_{mkt} = N_{t-1}$. Similarly, the market factor expert agent $A_{mf}$ is provided with the system instruction and prompt integrated with market-specific risk factors, $\u03b2_{t-1}$, to generate a prediction $\\hat{Y}_{mf}$ including a binary classification, $\\hat{y}_{mf} \u2208 \\{\\text{``Rise''}, \\text{``Fall''}\\}$, and a human-readable explanation, $\\hat{e}_{mf}$.\nTo enable collaboration between these two agents within a team and generate a final solution for the crypto-cash allocation subtask, the intrateam collaboration method illustrated in Fig. 3a is employed. This method allows the two agents to ensemble their predictions based on their respective prediction confidence levels. Specifically, since the LLM generates text by selecting tokens with the highest probabilities, we can extract the log probability of \"Rise\" for the classification token (\"Rise\" or \"Fall\u201d). This log probability of \"Rise\", expressed as $log P(\\hat{y}_t = \\text{``Rise''} | N_{t-1})$, is visually represented"}, {"title": "3.4.2 Crypto Team", "content": "To complete the cryptocurrency selection subtask discussed in \u00a73.1.2, the crypto team employs a trained crypto factors expert and a trained technical expert to collaboratively predict the price trend for individual cryptocurrencies.\nTo enable the agents in the crypto team to make predictions that incorporate not only crypto-specific information but also the broader market context, we employ interteam collaboration, as illustrated in Fig. 3b. Specifically, the agents in the crypto team receive the System Instruction 3 and the Prompt 6 integrated with the relevant crypto-specific data as their primary input. Additionally, they are provided with inputs and predictions from the market factor expert and the news expert, which serve as contextual information or shared short-term memory to enhance their decision-making process. We can formalize it as:\n$\\hat{Y}_{c,t} = A(c, X_{c,t-1}, X_{mf}, \\hat{Y}_{news}, \\hat{e}_{news}).$\nWhile market information alone does not directly contribute to cross-sectional cryptocurrency price trend prediction, since all cryptocurrencies share the same market-level data, we expect the expert agents to learn the interactions between market-level information and individual crypto. By identifying these interactions, the crypto team can enhance the accuracy of their predictions. Therefore, the crypto factors expert is provided with individual crypto c and the vector of its crypto-specific risk factors, $a_{c,t-1} = [a_i]_{m\u00d71}$, while the technical expert receives the crypto c and its 30-day candlestick chart of, $v_{c,t-1}$. Using these inputs, the experts generate binary classifications, $\\hat{y}_f \u2208 \\{\\text{``Rise''}, \\text{``Fall''}\\}$ and $\\hat{y}_{chart} \u2208 \\{\\text{``Rise''}, \\text{``Fall''}\\}$, representing the predicted price trends for the cryptocurrencies over the following week. Additionally, they produce human-readable explanations, $\\hat{e}_f$ and $\\hat{e}_{chart}$, providing detailed reasoning behind their respective predictions.\nUsing the same intrateam collaboration method discussed in \u00a73.4.1, expert agents within the crypto group come to a consensus about the price trend of individual cryptocurrencies by generating the final ensemble rise probability for each individual cryptocurrency in set C, $P_c$, via Eq. 2. Then, we sort cryptocurrencies in set C into quintile portfolios based on the $P_c$. Specifically, we form 5 disjoint equal-weighted (1/N) portfolios, each representing a range of rise probabilities, denoted by $P_i$. The portfolios are constructed as follows:\n$P_i = \\{ c_i | P_{(\\frac{|C|}{5}(i-1))} < P_i < P_{(\\frac{|C|}{5}i)} \\} , i = 1,..., 5,$\nwhere $P_{(j)}$ denotes the j-th order static of the ascending set of rise probabilities $\\{P_c : 1 \u2264 c \u2264 |C|\\}$ of all cryptocurrencies in set C. $\\lfloor\\cdot\\rfloor$ is the floor operator. Portfolios $P_1,\u2026, P_5$ are labeled Very Low, Low, Medium, High, and Very High. Finally, the portfolio labeled Very High, $P_5$, is selected as the target subset of cryptocurrencies, $C^* = P_5 \u2282 C$, for investment."}, {"title": "3.4.3 Trading Team", "content": "The final trading team is tasked with executing trades by interacting with the APIs of cryptocurrency exchanges based on the provided portfolio, ensuring that the entire process is fully end-to-end."}]}]}, {"title": "4 EXPERIMENT", "content": "In this section, we evaluate the performance of our multi-agent framework on our collected dataset against the related baselines.", "subsections": [{"title": "4.1 Experiment Settings", "content": "In this work, we employ ChatGPT-4o as the base model, as it is the most advanced multi-modal model capable of implementing vision fine-tuning at the time of writing 1. We collected our dataset from June 2023 to September 2024, following the methodology described in \u00a73.3.1. We designate the set of targeted cryptocurrencies, C, as the top 30 cryptocurrencies by market capitalization according to CoinGecko. This list is updated weekly to reflect changes in market capitalization. The rationale for including only high-capitalization cryptocurrencies is that those with low market capitalization often exhibit pricing dynamics that differ significantly from high-liquidity cryptocurrencies, partly due to risks such as pump-and-dump schemes. Additionally, trading low-liquidity cryptocurrencies tend to involve higher slippage, further complicating our task. To prevent information leakage, we set the data from November 2023 to September 2024 as the test set, given that ChatGPT-4o's training data extends only up to October 2023 2. Consequently, the training set comprises data from June 2023 to October 2023.\nTo demonstrate the effectiveness of our multi-agent framework, we evaluate it from three distinct perspectives: classification performance, portfolio performance, and asset pricing performance:"}, {"title": "4.1.1 Classification and Asset Pricing Performance", "content": "For classification and asset pricing performance, we employ the following benchmarks:\n\u2022 Single GPT-4o without fine-tuning: For both tasks, we provide the same prompts integrated with news, factors, and candlestick charts to a GPT-4o. Single ChatGPT has previously been explored in other cryptocurrency prediction works.\n\u2022 Single GPT-4o with fine-tuning: For both tasks, we fine-tune a GPT-4o with all training prompts. Then, we provide the same prompts integrated with news, factors, and candlestick charts to the fine-tuned GPT-4o. This setup allows us to compare the cryptocurrency pricing capability of the single-agent model with that of the multi-agent model, ensuring that both are provided with identical information.\n\u2022 Risk factors in cryptocurrency: For asset pricing performance, we use the risk factors outlined in Tab. 6 to construct quintile-based portfolios, serving as a benchmark. This approach follows the empirical asset pricing methodology described in Eq. 4. This aims to compare the explanatory power of cryptocurrency returns between the traditional one-factor model and our multi-agent model."}, {"title": "4.1.2 Explainability Performance", "content": "To evaluate the explainability performance of our multi-agent model compared to the baseline models, we introduce five key metrics for assessing explanation quality. Each response is rated on a scale from 0 to 1 using GPT-4o, based on these metrics applied to a representative set of samples. The metrics are defined as follows:\n\u2022 Professionalism: Does the explanation reflect expertise and professionalism in the field of finance?\n\u2022 Objectivity: Is the explanation presented in an unbiased and neutral manner?\n\u2022 Clarity & Coherence: Is the explanation easy to understand, and does it follow a logical structure that connects different factors effectively?\n\u2022 Consistency: Does the explanation align with the provided data and avoid contradictions?\n\u2022 Rationale: Does the explanation provide a detailed reasoning process that clearly articulates how the metrics influence performance?"}, {"title": "4.1.3 Portfolio Performance", "content": "For the portfolio performance, we have the following benchmarks:\n\u2022 1/N portfolio [10]: We build a portfolio where the top 30 cryptocurrencies in the basket are equally weighted, with each cryptocurrency receiving the same allocation.\n\u2022 Market portfolio [26]: We use the Nasdaq Crypto Index\u00b3, which consists of a basket of eligible cryptocurrencies selected by the Nasdaq Crypto Index Oversight Committee.\n\u2022 BTC portfolio [26]: We build a buy-and-hold portfolio consisting of 100% Bitcoin.\nTo facilitate our analysis, we define the boom and bust periods of the crypto market based on the Nasdaq Crypto Index. We borrow the definition method from [2]. Specifically, we define a boom period as the period between a price trough and a peak with an increase of over 15%, and define a bust period as the period between a price peak and a trough with a decrease of over 15%. There also exist periods with below 15% price change which are neither a boom nor a bust.\nWe use the following well-known metrics in empirical asset pricing to quantify the portfolio and asset pricing performance:\n\u2022 Cumulative Return (Cumulative) [3] measures the total changes in the price of a portfolio over the trading period, calculated as $\\prod_{t=1}^{T}(1 + r_t) \u2212 1$, where T denotes the total number of weeks over the trading period and $r_t$ denotes the weekly return.\n\u2022 Weekly Return Mean (Mean) [16] measures the average of weekly returns over the trading period, indicating the portfolio's typical weekly performance.\n\u2022 Weekly Return Standard Deviation (Std) [16] measures the standard deviation of weekly return over the trading period, representing the volatility of the portfolio.\n\u2022 Sharpe Ratio (Sharpe) [33] measures the risk-adjusted return, calculated as $\\frac{\\bar{r}_t - r_f}{\\sigma_t}$, where $\\bar{r}_t$ denotes the weekly return mean, $r_f$ is the risk-free rate, $\\sigma_t$ denotes the weekly return standard deviation."}]}, {"title": "4.2 Performance Comparison", "content": "In this subsection, we evaluate the classification, portfolio, asset pricing, and explanation performance of our multi-agent model, via quantitative and qualitative comparisons against the related baselines.", "subsections": [{"title": "4.2.1 Classification Accuracy", "content": "Tab. 1 presents the quantitative results for cryptocurrency price and market trend predictions. In terms of prediction accuracy, our multi-agent framework achieves"}, {"title": "4.2.2 Portfolio Performance", "content": "In addition to classification accuracy, the portfolio performance achieved by our multi-agent model is also crucial. Fig. 5 depicts the out-of-sample cumulative returns of our multi-agent model against the market index and equal-weighted portfolios (1/N) of the top 30 cryptocurrencies. From Fig. 5a, we observe that the portfolio generated by our model outperforms two constructed indices throughout the entire sample period, except for February 2024.\nA 100% buy-and-hold Bitcoin strategy is popular among investors. To evaluate the performance of our multi-agent model against this strategy, we compare their cumulative returns. Fig. 5b presents the ratio of the cumulative returns of our model to those of the 100% buy-and-hold Bitcoin strategy. The results indicate that the cumulative returns of our model consistently surpass those of the buy-and-hold Bitcoin strategy throughout the entire sample period, with the exception of February 2024.\nTab. 3 presents the comparison of portfolio results across full, boom, and bust periods. The table shows that our multi-agent model outperforms other methods in most portfolio metrics across all periods, including boom and bust phases, while maintaining comparable performance in terms of standard deviation. Notably, our model exhibits strong resistance to declines during the bust period, further highlighting its effectiveness."}, {"title": "4.2.3 Asset Pricing Performance", "content": "In this section, we evaluate the performance of our multi-agent framework in cryptocurrency pricing. In the crypto market, the trend of an individual cryptocurrency is not limited to a binary outcome, i.e. rise or fall, but instead exists on a spectrum. Therefore, the model should also have the capability to explain the variation in cross-sectional cryptocurrency returns effectively. Tab. 4 reports the Performance comparison of out-of-sample quintile-based portfolios of our multi-agent model against baselines. The top 30 cryptocurrencies are sorted into quintiles based on their predicted \"Rise\" probability for LLM-based models and factor values for risk factors in the next week according to Eq. 4. We report the average realized weekly returns, their standard deviations, and Sharpe ratios, respectively. All portfolios are equal-weighted."}, {"title": "4.2.4 Explanation Performance", "content": "A key advantage of using LLMs over traditional deep learning methods for prediction is their ability to generate explanations in natural language [21]. In the context of crypto portfolio management, we define model explainability as the ability to generate rationales for cryptocurrency and market trend predictions grounded in professional asset pricing knowledge from the field of finance. Fig. 6 compares the example outputs of our crypto factor expert agent with fine-tuning and GPT-4o without fine-tuning. We observe that the explanation generated by the expert agent after fine-tuning incorporates significantly more asset pricing terminologies from the provided literature. This indicates that the training prompts annotated by the explanation team, combined with the fine-tuning process, significantly enhance the expert agent's capability for explainability.\nIn addition, Fig. 7 reports the average score for each metric outlined in \u00a74.1.2. From Fig. 7, we observe that models with fine-tuning outperform those without fine-tuning except for consistency. This suggests that the fine-tuning process significantly enhances most aspects of explainability. However, for consistency, the single GPT-4o model with fine-tuning does not perform better than the single"}]}, {"title": "4.3 Ablation Study", "content": "In this section, we evaluate the contribution of each component of our multi-agent model to portfolio performance. Tab. 5 presents the results of the ablation study, where key components or mechanisms are systematically removed to assess their impact on the overall portfolio performance. We highlight the following insights from the results:\nAdvantage of Intrateam Collaboration: We observe that removing any agent results in a decrease in cumulative return, average return, and the Sharpe ratio, highlighting each agent's significant contribution to overall portfolio performance through the intrateam collaboration mechanism. In the absence of intrateam collaboration, different opinions within the same team cannot be harmonized effectively. As a result, this outcome demonstrates the efficacy of the intrateam collaboration mechanism in enhancing predictive accuracy and investment decision-making."}, {"title": "5 CONCLUSION", "content": "In this work, we explored the explainable cryptocurrency investment task, a challenging problem due to the shorter history of cryptocurrencies, diverse information sources, and high market volatility compared to traditional assets. While the introduction of LLMs has revolutionized the field of finance, the performance of single LLMs remains limited. To address these challenges, we propose an explainable, multi-modal, multi-agent framework that employs multiple teams of agents collaborating both within and across teams to enable supervised learning and investment decisions across the top 30 cryptocurrencies by market capitalization. Our experimental results demonstrate that our model outperforms single-agent models, both with and without fine-tuning, in terms of classification accuracy and asset pricing performance. Furthermore, we show that our framework surpasses market benchmarks in portfolio performance."}, {"title": "APPENDIX", "content": null, "subsections": [{"title": "A DATA DESCRIPTION", "content": "Tab. 6 presents the data description, associated agents, and relevant literature. The table provides an overview of our multimodal data, specifying the agent responsible for analyzing each data type and the literature fetched by the literature team to enhance the agents' explainability."}]}]}