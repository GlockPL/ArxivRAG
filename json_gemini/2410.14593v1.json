{"title": "Temporal Fair Division of Indivisible Items", "authors": ["Edith Elkind", "Alexander Lam", "Mohamad Latifian", "Tzeh Yuan Neoh", "Nicholas Teh"], "abstract": "We study a fair division model where indivisible items arrive sequentially, and must be allocated immediately and irrevocably. Previous work on online fair division has shown impossibility results in achieving approximate envy-freeness under these constraints. In contrast, we consider an informed setting where the algorithm has complete knowledge of future items, and aim to ensure that the cumulative allocation at each round satisfies approximate envy-freeness-which we define as temporal envy-freeness up to one item (TEF1). We focus on settings where items can be exclusively goods or exclusively chores. For goods, while TEF1 allocations may not always exist, we identify several special cases where they do-two agents, two item types, generalized binary valuations, unimodal preferences\u2014and provide polynomial-time algorithms for these cases. We also prove that determining the existence of a TEF1 allocation is NP-hard. For chores, we establish analogous results for the special cases, but present a slightly weaker intractability result. We also establish the incompatibility between TEF1 and Pareto-optimality, with the implication that it is intractable to find a TEF1 allocation that maximizes any p-mean welfare, even for two agents.", "sections": [{"title": "Introduction", "content": "Fair division, a topic at the intersection of economics and computer science, has been extensively studied over the years, with applications spanning from divorce settlements and inheritance disputes to load balancing [Brams and Taylor, 1996, Moulin, 2003]. A typical fair division problem consists of a set of agents and a set of items, and the goal is to obtain a fair allocation of items to agents. In our work, we study the model where these items are indivisible, so each must be wholly allocated to an agent. Moreover, the items can either provide positive utility (also called goods) or negative utility (also called chores or tasks). When allocating indivisible items, a desirable and widely-studied fairness notion is envy-freeness up to one item (EF1), a natural relaxation of envy-freeness (EF). In an envy-free allocation, each agent values their own received bundle of items at least as much as every other agent's bundle, but this is not always possible for indivisible items.\u00b9 Accordingly, in an EF1 allocation, any envy that an agent has towards another agent can be eliminated by removing a single item from the latter or former agent's bundle, depending on whether the items in question are goods or chores, respectively.\nMost prior research studies the problem in the offline setting, assuming that all of the items are immediately available and ready to be allocated. However, there are various applications where the items arrive and need to be allocated on the spot in a sequential manner. For example, when the university administration places an order for lab equipment, or when a company orders new machines for its franchises, the items may not arrive at the same time, and instead arrive over time due to their availabilities"}, {"title": "Related Work", "content": "Our work is closely related to online fair division, whereby items arrive over time and must be irrevocably allocated to agents. The key difference is that in the standard online setting, the algorithm has completely no information on future items, whereas we assume complete future information. Moreover, the goal in online fair division models is typically to guarantee a fair allocation to agents at the end of the time horizon, rather than at every round.\nAs we focus on EF1, papers satisfying envy-based notions in online allocations are particularly relevant. Aleksandrov et al. [2015] consider envy-freeness from both ex-ante and ex-post standpoints, giving a best-of-both-worlds style result by designing an algorithm for goods which is envy-free in expectation and guarantees a bounded level of envy-freeness. Additionally, Benad\u00e8 et al. [2024] find that allocating goods uniformly at random leads to maximum pairwise envy which is sublinear in the number of rounds. For further reading, we refer the reader to the surveys by Aleksandrov and Walsh [2020] and Amanatidis et al. [2023].\nThere has also been work on online fair division with partial information on future items. Benad\u00e8 et al. [2024] study the extent to which approximations of envy-freeness and Pareto efficiency can be simultaneously satisfied under a spectrum of information settings, ranging from identical agents and i.i.d. valuations to zero future information. An emerging line of work on learning-augmented online algorithms has an alternate approach to partial future information: the algorithms are aided by (possibly inaccurate) predictions, typically from a machine-learning algorithm. The focus is to design algorithms"}, {"title": "Our Contributions", "content": "We outline our paper's answers to these key questions as follows.\nIn Section 3, we show the existence of TEF1 allocations (for goods or chores) in restricted settings, such as the case of two agents, when there are two types of items, when agents have generalized binary valuations, or when they have unimodal preferences. For each of these cases, we provide an accompanying polynomial-time algorithm. For the allocation of goods, we show that determining whether there exists a TEF1 allocation is NP-hard; whereas for chores, we show that given a partial TEF1 allocation, it is NP-hard to determine if there exists a TEF1 allocation that allocates all remaining chores.\nIn Section 4, we investigate the compatibility of TEF1 and Pareto-optimality (PO). We show that even in the case of two agents, while a TEF1 allocation is known to exist and can be computed in polynomial time (for both goods and chores), existence is no longer guaranteed if we mandate PO as well. Moreover, we show that in this same setting, determining the existence of TEF1 and PO allocations is NP-hard. Our result also directly implies the computational intractability of determining whether there exists a TEF1 allocation that maximizes any p-mean welfare objective (which subsumes most popular social welfare objectives).\nFinally, in Section 5, we consider the special case where the same set of items arrive at each round, and show that even determining whether repeating a particular allocation in two consecutive rounds can result in a TEF1 allocation is NP-hard. We complement this with a polynomial-time algorithm for computing a TEF1 allocation in this case when there are just two rounds."}, {"title": "Preliminaries", "content": "For each positive integer k, let $[k] := \\{1, ..., k\\}$. We consider the problem of fairly allocating indivisible items to agents over multiple rounds. Let an instance of the informed online fair division problem be denoted by $I = (N,T, \\{O_t\\}_{t\\in[T]}, v = (v_1,..., v_n))$, in which we have a set of agents $N = [n]$ and a set O of m items which arrive over T rounds, and are to be allocated to the agents. For each $t \\in [T]$, we denote the set of items that arrive at round t by $O_t$, and define the cumulative set of items that arrived in rounds 1, \u2026 \u2026 \u2026, t by $O^t := \\bigcup_{e\\in[t]} O_e$. Note that $O = O^T$.\nWe assume that each agent $i \\in N$ has an additive valuation function $v_i : 2^O \\rightarrow \\mathbb{R}$ over the items, i.e., for $S \\subseteq O$, $v_i(S) = \\sum_{o \\in S} v_i(\\{o\\})$. For notational convenience, we write $v_i(o)$ instead of $v_i(\\{o\\})$ for a single item $o \\in O$, and $v$ instead of $v_i$ when valuation functions are identical. Denote $v = (v_1, ..., v_n)$ as the valuation profile. In this work, we consider two cases: goods allocation where for each $i \\in N$ and $o \\in O$, $v_i(o) \\geq 0$, and chores allocation where for each $i \\in N$ and $o \\in O$, $v_i(o) \\leq 0$. For clarity, we use $g$ instead of $o$ and refer to items as goods when explicitly referring to the goods setting, and $c$ instead of $o$ and refer to items in chores when considering the chores setting.\nAn allocation $A = (A_1, ..., A_n)$ of items in $O$ to the agents is an ordered partition of $O$, i.e. for $i, j \\in N$, $A_i \\cap A_j = \\emptyset$ and $\\bigcup_{i \\in N} A_i = O$. In addition, for $t \\in [T]$ we denote the allocation after round t by $A^t = (A^t_1, ..., A^t_n)$ where $A^t_i = A_i \\cap O^t$. For $t < T$, we sometimes refer to $A^t$ as a partial allocation. Note that $A = A^T$.\nOur goal is to find an allocation that is fair after each round. The main fairness notion that we consider is envy-freeness up to one item (EF1), which is a well-studied notion in the problem of allocating indivisible items.\nDefinition 2.1. In a goods (resp. chores) allocation instance, an allocation $A = (A_1, . . ., A_n)$ is said to be EF1 if for all pairs of agents $i, j \\in N$, there exists a good $g \\in A_j$ (resp. chore $c \\in A_i$) such that\n$v_i(A_i) \\geq v_i(A_j \\setminus \\{g\\})$ (resp. $v_i(A_i \\setminus \\{c\\}) \\geq v_i(A_j)$).\nIn this work we target fairness in a cumulative sense, introducing the notion of temporal envy-freeness up to one item (TEF1) which requires that at every round prefix, the cumulative allocation of items that have arrived so far satisfies EF1.\nDefinition 2.2 (Temporal EF1). For any $t \\in [T]$, an allocation $A^t = (A^t_1, . . ., A^t_n)$ is said to be temporal envy-free up to one item (TEF1) if for all $t' < t$, the allocation $A^{t'}$ is EF1.\nIt is important to note the distinction between TEF1 and EF1: while the EF1 property applies only to a single allocation, TEF1 extends this requirement by ensuring that the cumulative allocation at every prior round also satisfies EF1.\nHowever, the possible non-existence of TEF1 allocations has been shown in the general goods allocation setting, as He et al. [2019, Thm. 4.2] illustrated using a counterexample with 3 agents and 23 items, which can be generalized to n > 3 agents. For completeness, we include this counterexample along with an intuitive explanation in Appendix A. We remark that this counterexample cannot be modified to show a similar non-existence result in the case of chores. As such, while we conjecture that this non-existence result should also hold for chores, this remains an open question.\nWe assume that the reader is familiar with basic notions of classic complexity theory [Papadimitriou, 2007]. All omitted proofs can be found in Appendices B and C."}, {"title": "On the Existence of TEF1 Allocations", "content": "We know that TEF1 does not always exist in general instances. However, there are some restricted classes of instances under which a TEF1 allocation is guaranteed to exist. In this section we identify"}, {"title": "Two Agents", "content": "He et al. [2019, Thm. 3.4] showed the existence of a TEF1 allocation for goods when n = 2, by presenting a polynomial-time algorithm that returns such an allocation. We begin by extending this result to the case of chores.\nIntuitively, in each round the algorithm greedily allocates the single chore that arrives in that round to an agent that does not envy the other agent in the current (partial) allocation. A counter s is used to denote the last round after which $A^s$ was envy-free, and if the allocation of a chore $c_t$ (for some round $t \\in [m]$) results in both agents envying each other in $A^t \\setminus A^s$, then the agents' bundles in $A^t \\setminus A^s$ are swapped."}, {"title": "Other Restricted Settings", "content": "The next natural question we ask is whether there are other special cases where EF1 allocation is guaranteed to exist. We answer this question affirmatively by demonstrating the existence of EF1 allocations in three special cases, each supported by a polynomial-time algorithm that returns such an allocation."}, {"title": "Two Types of Items", "content": "The first setting we consider is one where items can be divided into two types, and each agent values all items of a particular type equally. Formally, let $S_1, S_2 \\subseteq O$ be a partition of the set of items, so that $S_1 \\cap S_2 = \\emptyset$, and $S_1 \\cup S_2 = O$. Then, for any $r \\in \\{1,2\\}$, two items $o, o' \\in S_r$, and agent $i \\in N$, we have that $v_i(o) = v_i(o')$.\nSettings with only two types of items/tasks arise naturally in various applications, such as distributing food and clothing donations from a charity, or allocating cleaning and cooking chores in a household. This preference restriction has been studied for chores in offline settings [Aziz et al., 2023, Garg et al., 2024], and we remark that agents may have distinct valuations for up to 2n different items, unlike the"}, {"title": "Generalized Binary Valuations", "content": "The next setting we consider is one where agents have generalized binary valuations (also known as restricted additive valuations [Akrami et al., 2022, Camacho et al., 2023]). This class of valuation functions generalizes both identical and binary valuations, which are both widely studied in fair division [Halpern et al., 2020, Plaut and Roughgarden, 2020, Suksompong and Teh, 2022]. Formally, we say that agents have generalized binary valuations if for every agent $i \\in N$ and item $o_j \\in O$, $v_i(o_j) \\in \\{0,p_j\\}$, where $p_j \\in \\mathbb{R} \\setminus \\{0\\}$.\nWe show that for this setting, a TEF1 allocation can be computed efficiently, with the following result. We remark that the resulting allocation also satisfies Pareto-optimality (Theorem 4.1)."}, {"title": "Unimodal Preferences", "content": "The last setting that we consider is the class of unimodal preferences, which consists of the widely studied single-peaked and single-dipped preference structures in social choice [Black, 1948, Arrow, 2012] and cake cutting [Thomson, 1994, Bhardwaj et al., 2020]. We adapt these concepts for the online fair division setting with a single item at each timestep.\nDefinition 3.8. A valuation profile $v$ is single-peaked if for each agent $i \\in N$, there is an item $o_{i*}$ where for each $j, k \\in [m]$ such that $j < k < i*$, $v_i(o_j) < v_i(o_k) \\leq v_i(o_{i*})$, and for each $j, k \\in [m]$ such that $i* < j < k$, $v_i(o_{i*}) \\geq v_i(o_j) \\geq v_i(o_k)$.\nDefinition 3.9. A valuation profile $v$ is single-dipped if for each agent $i \\in N$, there is an item $o_{i*}$ where for each $j, k \\in [m]$ such that $j < k < i*$, $v_i(o_j) \\geq v_i(o_k) \\geq v_i(o_{i*})$, and for each $j, k \\in [m]$ such that $i* < j < k$, $v_i(o_{i*}) \\leq v_i(o_j) \\leq v_i(o_k)$.\nIn other words, under single-peaked (resp. single-dipped) valuations, agents have a specific item $o_{i*}$ that they prefer (resp. dislike) the most, and prefer (resp. dislike) items less as they arrive further away in time from $o_{i*}$.\nNote that this restricted preference structure is well-defined for the setting of a single item arriving per round, but may not be compatible with a generalization to multiple items per round as described in Lemma 3.1 (unless the items in each round are identically-valued by agents).\nUnimodal preferences may arise in settings where agents place higher value on resources at the time surrounding specific events. For example, in disaster relief, the demand for food and essential supplies peaks as a natural disaster approaches, then declines once the immediate crisis passes. Similarly, in project management, the workload for team members intensifies (in terms of required time and effort)"}, {"title": "Hardness Results for TEF1 Allocations", "content": "The non-existence of TEF1 goods allocations for $n \\geq 3$ prompts us to explore whether we can determine if a given instance admits a TEF1 allocation for goods. Unfortunately, we show that this problem is NP-hard, with the following result."}, {"title": "Compatibility of TEF1 and Efficiency", "content": "In traditional fair division, many papers have focused on the existence and computation of fair and efficient allocations for goods or chores, with a particular emphasis on simultaneously achieving EF1 and Pareto-optimality (PO) [Barman et al., 2018, Caragiannis et al., 2019]. In this section, we explore the compatibility between TEF1 and PO. We begin by defining PO as follows.\nDefinition 4.1 (Pareto-optimality). We say that an allocation $A$ is Pareto-optimal (PO) if there does not exist another allocation $A'$ such that for all $i \\in N$, $v_i(A'_i) \\geq v_i(A_i)$, and for some $j \\in N$, $v_j(A'_j) > v_j(A_j)$. If such an allocation $A'$ exists, we say that $A'$ Pareto-dominates $A$.\nObserve that for any $A$ that is PO, any partial allocation $A^t$ for $t < [T]$ is necessarily PO as well. We demonstrate that PO is incompatible with TEF1 in this setting, even under very strong assumptions (of two agents and two types of items), as illustrated by the following result."}, {"title": "Multiple Items per Round", "content": "We now move to the setting where multiple items may arrive at each round. Recall that Lemma 3.1 states that instances where multiple items arrive per round can be transformed into instances where a single item arrives per round. Accordingly, in this section, we focus on results for restricted settings which are incompatible with Lemma 3.1. We begin by showing that when there are two timesteps, a TEF1 allocation can be computed efficiently."}, {"title": "Conclusion", "content": "In this work, we studied the informed online fair division of indivisible items, with the goal of achieving TEF1 allocations. For both goods and chores, we demonstrated the existence of TEF1 allocations in four special cases and provided polynomial-time algorithms for each case. Additionally, we showed that determining whether a TEF1 allocation exists for goods is NP-hard, and presented a similar, though slightly weaker, intractability result for chores. We further established the incompatibility between TEF1 and PO, which extends to an incompatibility with p-mean welfare. Finally, we explored the special case of multiple items arriving at each round.\nNumerous potential directions remain for future work, including revisiting variants of the standard fair division model. Examples include studying the existence (and polynomial-time computability) of allocations satisfying a temporal variant of the weaker proportionality up to one item prop-erty (as defined by Conitzer et al. [2017]), which would be implied by EF1; studying group fairness [Aleksandrov and Walsh, 2018, Aziz and Rey, 2020, Benabbou et al., 2019, Conitzer et al., 2019, Kyropoulou et al., 2019, Scarlett et al., 2023]; considering the more general class of submodular valuations [Ghodsi et al., 2022, Montanari et al., 2024, Suksompong and Teh, 2023, Uziahu and Feige, 2023]; examining the house allocation model where each agent gets a single item [Choo et al., 2024, Gan et al., 2019], which was"}, {"title": "Counterexample for Goods when $n \\geq 3$", "content": "As mentioned in the main text, He et al. [2019, Thm. 4.2] used the following counterexample to show that a TEF1 allocation may not exist for goods when n = 3. Note that in this counterexample, one good arrives at each round.\nFor completeness, we briefly explain the counterexample. There are three parts to this example, which ultimately ensure that in any TEF1 allocation, after g22 is allocated, agent 2 envies both other agents, and one other agent envies agent 2. As a result, g23 cannot be allocated to any agent without violating TEF1.\nThe first part consists of goods g1 to g7. The instance is constructed such that after all of the goods in this part have been allocated in a TEF1 manner, the possible envy relations are restricted. Specifically, we have that after round 7, agent 3 cannot envy agent 1, and that agent 2 cannot envy agents 1 or 3.\nThe second part consists of goods g8 to g16, and builds on top of the previous envy restriction to ensure that after round 16, agent 2 is envied by either agent 1 or agent 3 in any TEF1 allocation.\nThe final part consists of goods g17 to g23. Since agent 2 is envied by some agent at the start, it cannot receive good g17 or g20, and must receive one of \\{g18, g19\\} and one of \\{g21, g22\\}. This causes agent 2 to envy both other agents, while one of the other agents continues to envy agent 2. Therefore, TEF1 will be violated regardless of which agent receives g23.\nNote that this example cannot be modified to act as a counterexample for chores. We have found that in the first part, we cannot sufficiently restrict the possible envy relations. This is due to the fundamental difference in allocating goods and chores: goods cannot be allocated to an agent which is envied, whilst chores cannot be allocated to an agent which envies others."}, {"title": "Omitted Proofs from Section 3", "content": null}, {"title": "Proof of Theorem 3.6", "content": "Consider the following greedy algorithm (Algorithm 2)."}, {"title": "Proof of Theorem 3.7", "content": "We first prove the result for goods. Consider the following greedy algorithm (Algorithm 3) which iterates through the rounds and allocates each good to the agent who has the least value for their bundle."}, {"title": "Proof of Theorem 3.10", "content": "Consider the following greedy algorithm (Algorithm 5). Note that the same algorithm works for both settings for goods when valuations are single-peaked, and for chores when valuations are single-dipped."}, {"title": "Proof of Lemma 3.13", "content": null}, {"title": "Omitted Proofs from Section 4", "content": null}, {"title": "Proof of Theorem 4.3", "content": "We reduce from the NP-hard problem 1-IN-3-SAT. An instance of this problem consists of conjunctive normal form F with three literals per clause; it is a yes-instance if there exists a truth assignment to the variables such that each clause has exactly one True literal, and a no-instance otherwise.\nConsider an instance of 1-IN-3-SAT given by the CNF F which contains n variables \\{x_1,...,x_n\\} and m clauses \\{C_1,...,C_m\\}.\nWe construct an instance I with two agents and 2n + 1 goods. For each $i \\in [n]$, we introduce two goods $t_i, f_i$. We also introduce an additional good r. Let agents' (identical) valuations be defined as follows:\n$v(g) = \\begin{cases}  5^{m+n-i} + \\sum_{j: x_i \\in C_j} 5^{m-j}, & \\text{if } g = t_i, \\\\  5^{m+n-i} + \\sum_{j: \\neg x_i \\in C_j} 5^{m-j}, & \\text{if } g = f_i, \\\\  \\sum_{i \\in [m]} 5^{3-1}, & \\text{if } g = r. \\end{cases}$"}, {"title": "Proof of Theorem 4.4", "content": "We reduce from the NP-hard problem 1-IN-3-SAT. An instance of this problem consists of conjunctive normal form F with three literals per clause; it is a yes-instance if there exists a truth assignment to the variables such that each clause has exactly one True literal, and a no-instance otherwise.\nConsider an instance of 1-IN-3-SAT given by the CNF F which contains n variables \\{x_1,...,x_n\\} and m clauses \\{C_1,...,C_m\\}.\nWe construct an instance I with two agents and 2n + 1 chores. For each $i \\in [n]$, we introduce two chores $t_i, f_i$. We also introduce an additional chore r. Let agents' (identical) valuations be defined as follows:\n$v(c) = \\begin{cases} -5^{m+n-i} - \\sum_{j: x_i \\in C_j} -5^{m-j}, & \\text{if } c = t_i, \\\\ -5^{m+n-i} \u2013  \\sum_{j: \\neg x_i \\in C_j} 5^{m-j}, & \\text{if } c = f_i, \\\\ -\\sum_{i \\in [m]} 5^{3-1}, & \\text{if } c = r. \\end{cases}$"}, {"title": "TEF1 for Mixed Manna", "content": "We first define TEF1 for mixed manna.\nDefinition D.1 (Temporal EF1 for mixed manna). In the case of with both goods and chores, an allo-cation $A^t = (A^t_1, . . ., A^t_n)$ is said to be temporal envy-free up to one item (TEF1) if for all $t' < t$ and $i, j \\in N$, there exists an item $o \\in A_i \\cup A_j$ such that $v_i(A^t_i \\setminus \\{o\\}) \\geq v_i(A^t_j \\setminus \\{o\\})$.\nThen, we can extend the result of Theorem 3.2 to the more general mixed manna setting, with the following result."}]}