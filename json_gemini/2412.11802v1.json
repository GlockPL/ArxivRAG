{"title": "AMI-Net: Adaptive Mask Inpainting Network for Industrial Anomaly Detection and Localization", "authors": ["Wei Luo", "Haiming Yao", "Wenyong Yu", "Zhengyong Li"], "abstract": "Unsupervised visual anomaly detection is crucial for enhancing industrial production quality and efficiency. Among unsupervised methods, reconstruction approaches are popular due to their simplicity and effectiveness. The key aspect of reconstruction methods lies in the restoration of anomalous regions, which current methods have not satisfactorily achieved. To tackle this issue, we introduce a novel Adaptive Mask Inpainting Network (AMI-Net) from the perspective of adaptive mask-inpainting. In contrast to traditional reconstruction methods that treat non-semantic image pixels as targets, our method uses a pre-trained network to extract multi-scale semantic features as reconstruction targets. Given the multiscale nature of industrial defects, we incorporate a training strategy involving random positional and quantitative masking. Moreover, we propose an innovative adaptive mask generator capable of generating adaptive masks that effectively mask anomalous regions while preserving normal regions. In this manner, the model can leverage the visible normal global contextual information to restore the masked anomalous regions, thereby effectively suppressing the reconstruction of defects. Extensive experimental results on the MVTec AD and BTAD industrial datasets validate the effectiveness of the proposed method. Additionally, AMI-Net exhibits exceptional real-time performance, striking a favorable balance between detection accuracy and speed, rendering it highly suitable for industrial applications. Code is available at: https://github.com/luow23/AMI-Net Note to Practitioners-AMI-Net restores defective images to normal ones and subsequently detects defects by leveraging the differences between them. This method only needs to collect about a few hundred defect-free samples for training, without the need for additional defect samples. It is noteworthy that AMI-Net is applicable not only to the detection of simple texture surface defects, such as carpet, leather, and tile, but also to the detection of surface defects in objects with posture diversity, such as cable, transistor, and screw. The trained model not only exhibits high detection accuracy but also demonstrates superior real-time performance, showcasing significant potential in practical industrial settings.", "sections": [{"title": "I. INTRODUCTION", "content": "In industrial manufacturing processes, a myriad of un- controllable factors can give rise to defects in industrial products, thereby compromising their intrinsic value. Consequently, industrial anomaly detection [3]\u2013[5] assumes a pivotal role in the realm of industrial quality supervision. Owing to the unpredictable nature of industrial defects and the significantly higher number of normal samples in com- parison to abnormal samples, the collection and annotation of a comprehensive dataset are deemed impractical. This greatly restricts the application of traditional supervised learning [6], [7] methods. As a result, a substantial amount of research [8]\u2013 [10] on anomaly detection is conducted under the unsupervised paradigm. Unsupervised anomaly detection methods are built upon the premise of utilizing only normal samples for training. During the inference process, regions that deviate significantly from the normal patterns are identified as anomalies. The reconstruction-based methods have garnered widespread at- tention due to their simplicity and effectiveness. As a typ- ical example of reconstruction methods, autoencoder (AE) [1] establishs a representation of the distribution of normal samples by minimizing the reconstruction error, which refers to the disparity between input images and corresponding reconstructed images. AE posits that a model trained only on normal data is capable of reconstructing normal patterns during testing but struggles to accurately reconstruct abnormal patterns, resulting in larger reconstruction errors for abnor- mal samples and effectively distinguishing them from normal samples. However, this assumption does not always hold true, as neural networks exhibit strong generalization capabilities. Specifically, as shown in Fig. 1(a), AE can accurately re- construct not only normal regions but also defects during the testing process. This results in a minimal difference in reconstruction errors between normal and abnormal regions, making it challenging to differentiate between abnormal and normal samples. In order to address the issue in AE that defects are also well reconstructed, several mask-based approaches [2], [11], [12] have been proposed, transforming the image reconstruction task into an image inpainting task. However, existing mask-based methods exhibit certain limitations. Firstly, they employ random masks during testing, which may inadequately mask all defect regions. This results in the model leveraging seman- tic information from unmasked defect areas to generate defect patterns in the masked regions, as illustrated in Fig. 1(b). Additionally, employing random masks during testing intro- duces instability in model performance. In other words, varied random masks result in disparate detection outcomes, posing a critical challenge for real-world industrial scenarios that demand exceptionally high stability. Moreover, these methods adopt multiple complementary masks during the testing phase, causing a notable decrease in the model's inference speed. In industrial scenarios where strict real-time requirements exist, this limitation hinders the practical viability of these methods for actual industrial applications. To tackle the aforementioned limitations in existing mask- based methods, we introduce a novel adaptive mask inpaint- ing network (AMI-Net) for unsupervised industrial anomaly detection. Diverging from conventional image reconstruction approaches, we utilize features extracted by a pre-trained network as the reconstruction targets. During the training phase, we still employ a random position and quantitative masking strategy. However, unlike conventional mask-based methods, we introduce a variable masking ratio instead of a fixed one, which refers to the proportion or percentage of the masked area in relation to the total area of the image. This adjustment is motivated by the diverse scales inherent in real industrial defects. Subsequently, during the testing phase, we propose a novel adaptive mask generator, which dynamically generates adaptive masks for each image, mask- ing the defective regions while retaining the normal regions. In this manner, as shown Fig. 1(c), the model can leverage the visible normal global contextual information to restore the masked defective regions, thereby effectively suppressing the reconstruction of defects. Furthermore, our model avoids randomness during the testing process and eliminates the need for multiple complementary masks, thereby enhancing the stability and real-time performance of the model. This characteristic demonstrates significant potential in real-world industrial scenarios. The main contributions of this article can be summarized as follows: \u2022 We propose a novel mask-based reconstruction method, AMI-Net. This approach employs a random positional and quantitative masking strategy to address the multi- scale issue of defects in industrial scenarios. In the testing phase, we introduce a novel adaptive mask generator capable of adaptively masking defect areas while preserv- ing normal regions as much as possible. This effectively addresses the issue of perfect defect reconstruction in the testing process for existing mask-based methods. The proposed AMI-Net demonstrates outstanding ap- plicability in the industrial domain. Firstly, it exhibits remarkable inspection performance on two industrial datasets, MVTec AD [13] and BTAD [14]. Furthermore, under three different training settings, one-for-one (train- ing separate models for different categories of objects), one-for-all (training a unified model for detecting anoma- lies across all different object categories), and few-shot (training models using a few samples), AMI-Net consis- tently achieves excellent detection performance. Finally, the inference time of AMI-Net is measured at 11.48 ms, highlighting its superior real-time performance. There- fore, AMI-Net holds significant potential for widespread application in industrial scenarios. The remaining structure of this paper is organized as fol- lows: A review of related research on unsupervised indus- trial anomaly detection is presented in Section II. Section III provides a detailed introduction to AMI-Net. Extensive comparative and ablation analyses are conducted in Section IV. Finally, Section V concludes the paper with a summary and a discussion of future research directions."}, {"title": "II. RELATED WORK", "content": "In this subsection, we present an overview of reconstruction- based methods from the perspective of data usage. Depending on the type of data employed, we categorize these methods into three groups: those based on normal data, those based on artificial anomalies, and mask-based methods. 1) Reconstruction method using normal data: As depicted in Fig. 2(a), reconstruction methods based on normal data refer to approaches that exclusively use normal samples for the reconstruction task, without incorporating other data augmen- tation techniques, such as artificial anomalies or mask-based strategies. Autoencoders (AE) [1] minimize the reconstruction error of normal samples during the training process, and larger reconstruction errors are expected for the regions with anomalies during the testing process. However, the powerful generalization capability of neural networks leads to AE re- constructing defects, resulting in relatively smaller reconstruc- tion errors for the anomalous regions. To address this issue, numerous methods [15]\u2013[19] have been proposed. MemAE [15] introduces a memory module that utilizes normal memory items to replace anomalous features, thereby alleviating the problem of defect reconstruction. TrsutMAE [16] improves the memory mechanism and leverages perceptual distance [20] to jointly enhance the detection accuracy. DAAD [17] proposes a block-wise memory module from the perspective of feature separation and assembly. Indeed, while these methods have effectively improved performance, the approaches based on normal data still tend to reconstruct defect regions. 2) Reconstruction method using artificial defect: As shown in Fig. 2(b), reconstruction methods based on artificial anoma- lies involve designing artificial defects to simulate real defects in industrial scenarios, thereby addressing the issue of defect reconstruction. Cutpaste [21] involves randomly cutting a portion of the original image and then randomly pasting it back onto the image. AFEAN [22] designs artificial defects by introducing random grayscale variations in specified regions. Considering the diverse shapes of defects, DRAEM [23] incorporates a Perlin noise to define the shapes of artificial anomalies. Furthermore, natural images contain redundant features relative to industrial images. Therefore, DRAEM employs natural image blocks in designated regions to emulate real industrial defects, resulting in a notable improvement in the model's performance. However, despite the many advance- ments in methods [8], [9], [24] based on artificial anomalies, it remains impractical to simulate all real-world defects using artificial anomalies due to the unpredictable nature of defects. Furthermore, relying solely on artificial anomalies can lead to model overfitting and a lack of generalization. 3) Reconstruction method using mask strategy: As shown in Fig. 2(c), reconstruction methods based on mask strategy approach anomaly detection from an image inpainting perspec- tive. They utilize information from normal regions to repair the masked regions. RIAD [2] employs multi-scale random masking to enhance the model's ability to perform inpainting. On the other hand, ST-MAE [25] utilizes complementary random masks for feature transformation, which leads to meaningful reconstructed outcomes. MSTUnet [12] utilizes anomaly generation and masking techniques, incorporating the Swin Transformer [26] as the inpainting network, resulting in remarkable performance. However, the aforementioned mask- based methods use random masking during the testing phase, which has the potential to leave defect areas inadequately covered and thus, may result in false positives. SSM [11] em- ploys a progressively refined incremental masking approach, progressively identifying normal regions and ultimately iden- tifying anomalous areas. InTra [27] reconstructs the image by iteratively sliding a mask and eventually concatenating all repaired masked patches. While these two methods do not involve random masking, their reliance on multiple iterations to obtain detection results leads to a significant decrease in inference speed. Therefore, they are not suitable for indus- trial applications. As illustrated in Fig. 2(d), our approach introduces an adaptive mask generator to alleviate the issue of defects still being reconstructed. Furthermore, our method does not require multiple iterations; it runs only once to obtain detection results, significantly enhancing inference speed and demonstrating substantial potential in industrial scenarios."}, {"title": "III. THE AMI-NET METHODOLOGY", "content": "In this section, we provide a comprehensive explanation of the proposed AMI-Net. We begin by presenting the overar- ching framework of AMI-Net. Subsequently, we delve into the details of the multi-scale pre-trained feature extraction. Moving forward, we introduce the strategy of employing a ran- dom positional and quantitative masking approach. Following this, the adaptive mask generator is introduced. Furthermore, we provide insights into both the training and inference procedures of the network. Lastly, we outline the specific parameter configuration utilized in the network."}, {"title": "A. Overall Framework of AMI-Net", "content": "The overall architecture of AMI-Net is illustrated in Fig. 3. Initially, multi-scale features are extracted using a pre- trained convolutional neural network (CNN), with these fea- tures serving as the reconstruction targets instead of the com- plete images. During the training phase, a random positional and quantitative masking strategy are employed, allowing the model to acquire the capability to handle various types of defects. Additionally, in the training process, cluster tokens are introduced to aggregate normal features, thereby laying the foundation for the adaptive masking process during inference. In the testing phase, an adaptive mask generator is employed to generate adaptive masks for the multi-scale features. These masks obscure defect-related features while retaining normal features. Subsequently, an inpainting network is utilized to generate defect-free reconstructed features. Finally, the defect localization map is derived by utilizing both the input features and the reconstructed features. The comprehensive architecture of AMI-Net synergistically leverages these components to proficiently enable the tasks of anomaly detection and localization. The inclusion of adaptive masks and the integration of cluster tokens synergistically enhance the model's adaptability in handling a wide range of anomalies, thereby significantly bolstering its overall per- formance."}, {"title": "B. Multi-Scale Pre-Trained Feature Extraction", "content": "Reference [35] has provided evidence that normal and abnormal patterns exhibit heightened discriminative charac- teristics within the feature space. Therefore, we leverage the WideResnet50 [36] $ pre-trained on ImageNet [37] to extract features. WideResNet50 proves adept at extracting abundant semantic information while maintaining a relatively fast inference speed, striking a favorable balance between"}, {"title": "C. Random Positional and Quantitative Masking Strategy", "content": "As illustrated in Fig. 3(a), following the acquisition of multi-scale features, we employ a linear projection $\\textit{f}_{linear}$ with a patch size of $K$ to transform the 2D feature map $F(I)$ into a 1D sequence of feature tokens $E_F^{(1)} = \\{T^{(1)}_1, T^{(1)}_2, \\dots, T^{(1)}_{|T|}\\}, T^{(1)}_i \\in \\mathbb{R}^D$. \n$$E_F^{(1)} = \\textit{f}_{linear}(F(I); \\theta_{\\textit{linear}})$$ \nIn the above context, $E_F^{(1)} \\in \\mathbb{R}^{L \\times D}$, where $L = \\frac{H_F}{K} \\times \\frac{W_F}{K}$, and $\\textit{f}_{linear}$ as well as $\\theta_{\\textit{linear}}$ correspondingly denote the function and parameters of the linear projection. The $D$ signifies the feature dimension of the tokens. MAE [38] uses a fixed masking ratio to train the visual representation ability of the model. However, employing a fixed masking ratio for anomaly detection is unsuitable, as industrial defects can vary greatly in size. To address this limitation, our study introduces a dynamic masking ratio, randomly applied, to effectively handle defects of diverse sizes. Initially, we randomly sample a mask ratio from a uniform distribution ranging between 0 and 1. Subsequently, based on the chosen mask ratio, we generate the corresponding mask $M_{random} \\in \\mathbb{R}^{L}$ for subsequent procedures. Provided with a feature token $T_{mask} \\in \\mathbb{R}^D$ comprising exclusively zeros, our next step involves masking the specified region:\n$$E_F^{(1)} = \\textit{Sub}(E_F^{(1)}, M_{random}, T_{mask})$$\nWhere $\\textit{Sub}$ operation denotes replacing the tokens in $E_F^{(1)}$ at positions where the corresponding positions in matrix $M_{random}$ are 0 with the $T_{mask}$. Then, we add fixed sinusoidal positional embedding $E_{pos}$ into $E_F^{(1)}$:\n$$E_F^{(1)} = E_F^{(1)} + E_{pos}$$\nWhere $E_{pos} \\in \\mathbb{R}^{L \\times D}$. Subsequently, $E_F^{(1)}$ is fed into the inpainting network $f_{in}$ to obtain the reconstructed feature token sequence $\\hat{E}_F^{(1)}$:\n$$\\hat{E}_F^{(1)} = f_{in}(E_F^{(1)}; \\theta_{in})$$\nWhere $f_{in}$ and $\\theta_{in}$ respectively represent the function and parameters of the inpainting network. As shown in Fig. 3(a), the inpainting network consists of $N_i$ transformer blocks,"}, {"title": "D. Adaptive Mask Generator", "content": "As depicted in Fig. 2(c), existing mask-based methodologies also involve the application of random masks during the testing phase, thus leading to situations where defective regions are not effectively concealed. In order to tackle this issue, we introduce a novel adaptive mask generator. Moving forward, we provide a comprehensive overview of the adaptive mask generator for both training and testing perspectives, delving into specific details 1) Training Stage: As illustrated in Fig. 3(a), we utilize an additional linear projection $\\textit{f}_{linear}$ to convert the multi-scale features $F(I)$ into a 1D token sequence $E_F^{(1)} = \\{T^{(1)}_1, T^{(1)}_2, \\dots, T^{(1)}_{|T|}\\}, T^{(1)}_i \\in \\mathbb{R}^D\\}$: \n$$E_F^{(1)} = \\textit{f}_{linear}(F(I); \\theta_{\\textit{linear}})$$\nWhere $\\textit{f}_{linear}$ and $\\theta_{\\textit{linear}}$ respectively represent the function and parameters of the linear projection, and the sequences of $E_F^{(1)}$ and $E_F^{(1)}$ share the same length and feature dimension. Then, we add fixed positional embedding $E_{pos}$ into $E_F^{(1)}$: \n$$E_F^{(1)} = E_F^{(1)} + E_{pos}$$\nSubsequently, we introduce $P$ trainable cluster to- kens to form a sequence of cluster tokens $E_{clu} = \\{T_{clu}, T_{clu}, \\dots, T_{clu}\\} | T_{clu} \\in \\mathbb{R}^D\\}$. Then, we concatenate $E_{clu}$ and $E_F^{(1)}$ along the dimension of length and feed them into semantic aggregation network $f_{sem}$, enabling the semantic information from $E_F^{(1)}$ to be aggregated into $E_{clu}$. The semantic aggregation network is composed of $N_s$ transformer"}, {"title": "E. Training and Inference Processes", "content": "AMI-Net comprises two core components: the adaptive mask generator and the inpainting network. The clustering loss $L_{clu}$ (in Section III-D) is employed for optimizing the former, while the reconstruction loss $L_{rec}$ (in Section III-C) is applied to enhance the latter. Hence, the holistic loss function of AMI- Net is defined as follows:\n$$L_{total} = L_{rec} + L_{clu}$$\nThe $L_{total}$ is directly employed to optimized the entire AMI- Net model. During the testing process, given a test image $I_t \\in \\mathbb{R}^{H \\times W \\times C}$, AMI-Net employs a pre-trained CNN to extract multi-scale features $F(I_t)$. Subsequently, the adaptive mask generator generates an adaptive mask for the features. Fol- lowing this, the masked features are input into the inpainting network in order to obtain reconstruction features $\\hat{F}(I_t)$. Ultimately, the anomaly score map $A_s$ can be generated through the utilization of both the reconstructed features and the input features.\n$$A_s = ||F(I_t) - \\hat{F}(I_t)|| \\times (1 - \\frac{\\hat{I}(I_t) \\cdot F(I_t)}{||F(I_t)|| \\times ||\\hat{F}(I_t)||})$$\nWhere $A_S \\in \\mathbb{R}^{H_F \\times W_F}$. Then, we employ a bilinear upsam- pling operation to scale $A_s$ to the size of $H \\times W$."}, {"title": "F. Parameter Configuration", "content": "The key hyperparameters of AMI-Net include $K$, $P$, $N_i$, $N_s$, and $\\lambda$. The patch size $K$ influences the granularity of feature tokens. When $K$ is excessively large, it leads to the loss of fine details in the features. Conversely, when $K$ is too small, it results in a significant increase in computational workload, thereby reducing the inference speed. Therefore, in this study, we set $K$ to an appropriate value, specifically 4."}, {"title": "IV. EXPERIMENTS", "content": "In this section, we validate the detection performance of AMI-Net on publicly available MVTec AD [13] and BTAD [14] datasets, while also assessing its inference speed. Further- more, an extensive set of ablation experiments is conducted to showcase the influence of varying parameter configurations on the performance of AMI-Net."}, {"title": "A. Experimental Configuration", "content": "1) Dataset: We conducted performance validation on two benchmark datasets: MVTec AD and BTAD. The MVTec AD dataset consists of 15 categories of industrial defect images, including 5 categories of texture images and 10 categories of object images. This dataset contains 3629 normal images for training, and 498 normal images and 1982 defect images for testing. The BTAD dataset encompasses 3 categories of industrial texture images, presenting a more challenging pixel- level localization aspect. It comprises 1799 normal training images and 451 normal images along with 290 defect images for testing. 2) Implementation Details: The baseline model AMI-Net is trained over 200 epochs employing the AdamW optimizer with a learning rate of 0.001 and a batch size of 8. The enhanced model AMI-Net incorporates a feature jittering strategy inspired by Reference [40]. This strategy requires the model to effectively recover the source message, even when presented with inputs containing noise. Each image is resized to 256 x 256 and subjected to normalization using the mean and standard deviation extracted from the ImageNet dataset. All experimental runs are executed on a computer equipped with an Intel(R) Core(TM) i7-13700KF CPU operating at 3.40 GHz, coupled with an NVIDIA GeForce RTX 4090 GPU boasting a substantial 24GB memory capacity. 3) Evaluation Criteria: We adopt widely employed Area Under the Receiver Operating Characteristic Curve (AUROC) metrics at both the image and pixel levels as the standard for defect detection and localization. Additionally, in the ablation experiments, we incorporate Average Precision (AP) metrics at both image and pixel levels. 4) Comparative Methods: In our experiments, we compare our proposed AMI-Net with the following outstanding meth- ods: AE_SSIM [43], TrustMAE [16], RIAD [2], DFR [44], DRAEM [23], PatchCore [31], MKD [35], MBPFM [34], VT- ADL [14], Patch SVDD [29], SPADE [30], FastFlow [45], CFA [46], US [47], PaDiM [48], SimpleNet [49], UniAD [40],"}, {"title": "B. Overall Performance Comparative Experiment", "content": "1) Experiment on MVTec AD Dataset: To validate the detection performance of AMI-Net, we compare it against several state-of-the-art anomaly detection methods on the MVTec AD [13] dataset, including AE_SSIM [43], TrsutMAE [16], RIAD [2], DFR [44], DRAEM [23], PatchCore [31], MKD [35], and MBPFM [34]. Table I presents the quantitative experimental results. AMI- Net (Ours in the table) achieves the second-best detection performance, trailing only behind PatchCore, and it attains the best localization. Notably, AMI-Net attains a perfect image- level AUROC of 100% on the Leather, Wood, Bottle, Hazelnut and Transistor datasets. Compared to the existing mask-based method RIAD, AMI-Net achieves a notable improvement of +7.3/+4.0% in image/pixel-level AUROC respectively across the 15 categories. This enhancement can be attributed to the introduced adaptive mask generator, which generates masks during the testing process that obscure defect areas while retaining normal regions. This approach significantly bolsters the model's detection performance. Qualitative detection results of AMI-Net are depicted in Fig. 7(a). AMI-Net accurately localizes defect regions across all 15 categories of data. It is noteworthy that global defects such as \"cable swap\" in the Cable category and \"misplaced\" defects in the Transistor category are effectively detected by AMI- Net, attributed to the inclusion of position encoding during clustering. 2) Experiment on BTAD Dataset: To further validate the performance of AMI-Net, we conduct comparative evaluations on the challenging BTAD [14] dataset against several state-of- the-art approaches, including VT-ADL [14], Patch SVDD [29], SPADE [30], PatchCore [31], FastFlow [45], and CFA [46]. Quantitative experimental results are presented in Table II. AMI-Net (Ours in the table) achieves the best detection and localization outcomes. In terms of the image/pixel AU- ROC metric, AMI-Net outperformes the second-best result by +0.9/+0.7%, respectively. Notably, AMI-Net attains a 100% image-wise AUROC on the class 03 dataset, further confirming the superiority of AMI-Net's detection capabilities. The qualitative detection results of AMI-Net are depicted in Fig. 7(b). AMI-Net demonstrates the capability to accurately locate even very small defects, achieving precise localization across all three datasets. This affirms its detection generaliza- tion prowess. 3) Potential reasons why AMI-Net is not the best in MVTec AD but performs best in BTAD: During the training process, the adaptive mask generator of AMI-Net requires clustering operations on the input features. In comparison to texture categories, object categories exhibit greater pose diversity, posing a more formidable challenge in the clustering process and subsequently leading to a performance decline. Therefore, AMI-Net is more suitable for the detection of texture cate- gories. The MVTec AD dataset comprises 5 texture and 10 object categories, whereas the BTAD dataset includes only 3 texture categories. Consequently, on the BTAD dataset, AMI- Net performs exceptionally well, whereas it does not achieve optimal results on the MVTec AD dataset. 4) Real-Time Analysis: Industrial anomaly detection neces- sitates a favorable trade-off between detection accuracy and speed. Hence, we conduct a real-time analysis of AMI-Net and other competitive methods. The quantitative real-time analysis results are illustrated in"}, {"title": "C. Multi-Class Anomaly Detection with A Unified Model", "content": "Traditional anomaly detection methods typically follow a one-for-one scheme, training separate models for different categories of objects, which is time-consuming for practical industrial applications. Recently, UniAD [40] proposed a one- for-all scheme, aiming to utilize a unified model for detect- ing anomalies across all different object categories without any fine-tuning, which is more challenging than traditional anomaly detection because it requires accurate modeling of multi-class distribution. Consequently, we compare the pro- posed AMI-Net with several outstanding methods under the unified setting on MVTec AD dataset [13], including US [47], Patch SVDD [29], PaDiM [48], MKD [35], DRAEM [23], SimpleNet [49], PatchCore [31], and UniAD [40]. Quantitative experimental results are presented in Table III. AMI-Net (Ours in the table) achieves the best overall detection and localization performance with image/pixel level AUROC of 97.2/97.5%, respectively, surpassing the current"}, {"title": "D. Few Shot Anomaly Detection", "content": "In real industrial scenarios, there may be situations where the number of samples is limited, and maintaining good performance under such circumstances is crucial. Therefore, we evaluate AMI-Net in the few-shot setting on MVTec AD dataset [13] and compare its performance with some algo- rithms specifically designed for few-shot anomaly detection, including TDG [50], DiffNet [51], and RegAD [52]. Quantitative experimental results are illustrated in Table IV. AMI-Net (Ours in the table) achieves the best localization results and the second-best detection performance, trailing only slightly behind RegAD. It is noteworthy that RegAD is a method specifically designed for few-shot anomaly detection, and its performance in other settings is not outstanding. In con- trast, our AMI-Net not only demonstrates commendable per- formance in the few-shot setting but also showcases excellent"}, {"title": "E. Ablation Experiments on MVTec AD", "content": "1) Impact of Pre-trained Network: Pre-trained networks are employed for extracting features from images. AMI-Net utilizes the extracted features as reconstruction targets; hence, the quality of the extracted features critically influences the model's performance. Consequently, we conduct comparative experiments on different variants of AMI-Net utilizing various pre-trained networks. The quantitative ablation experiment results are illustrated in Fig. 9(a). As more intricate pre-trained networks are employed for feature extraction, the detection accuracy of the model ex- hibits an upward trend while its detection speed progressively diminishes. Notably, the model variant employing WideRes- net50 outperforms its Resnet50 counterpart in both detection accuracy and speed. This distinction arises from the fact that WideResnet50 employs a broader and shallower convolutional architecture. As discussed earlier, industrial defect detection necessitates a favorable equilibrium between detection accu- racy and speed. Consequently, we adopt WideResnet50 as the pre-trained network of choice to achieve this balance. 2) Influence of Patch Size K: The patch size K influences the granularity of feature tokens, consequently affecting the quality of feature reconstruction. Therefore, a comprehensive analysis of the impact of K on model performance and speed is provided below. Quantitative experimental results are illustrated in Fig. 9(b). When the value of parameter K is either excessively large or excessively small, it leads to a decline in the detection speed of the model. The former can be attributed to an excessive number of parameters in the linear projection, while the latter is due to an elongated token sequence, resulting in"}, {"title": "F. Visualization Results", "content": "As illustrated in Fig. 10, we visualize the reconstruction results of different methods. The vanilla autoencoder perfectly reconstructs defects, given its lack of an explicit defect feature suppression mechanism. While existing mask-based methods can partially suppress the reconstruction of defects to some extent, the use of random masks during the testing process leads to the leakage of defect information, resulting in the reconstruction of a portion of defects. In contrast, our approach employs adaptive masks that entirely cover the defect regions, preventing the leakage of defect information and ensuring that defects are no longer reconstructed. The visualized reconstruc- tion results vividly demonstrate the superiority of our method."}, {"title": "G. Failure Case Analysis", "content": "The extensive array of experiments presented above corrob- orates the efficacy and superiority of the proposed AMI-Net. However, it is important to acknowledge that AMI-Net does"}, {"title": "H. Discussion on Extending AMI-Net to Cases with Some Abnormal Training Samples.", "content": "In real industrial settings, the quantity of normal sam- ples significantly surpasses that of abnormal samples. Conse- quently, the proposed AMI-Net utilizes only normal samples for training. In fact, a few abnormal samples are often available in real-world industrial scenarios, the valuable knowledge of known defects should also be effectively exploited. Therefore, in this subsection, we discuss the extension of our AMI-Net to address this particular situation. AMI-Net is a reconstruction-based approach; thus, direct utilization of abnormal training samples is not feasible due to the absence of corresponding normal reconstruction targets. Drawing inspiration from BGAD [54], we propose extracting defect regions from abnormal training samples, subjecting them to data augmentation, and subsequently randomly pasting them onto normal samples. This process yields more authen- tic artificial defect samples, with their reconstruction targets corresponding to the respective normal samples. Of course, the aforementioned strategy is merely a pre- liminary approach. In future research, we aim to refine this methodology continuously, enabling AMI-Net to more effec- tively extend to cases with some abnormal training samples."}, {"title": "V. CONCLUSION", "content": "This paper introduces an innovative AMI-Net designed for precise anomaly detection. Addressing the challenge of signifi- cant variations in industrial defect sizes, AMI-Net incorporates"}]}