{"title": "Dynamic PDB: A New Dataset and a SE(3) Model Extension by\nIntegrating Dynamic Behaviors and Physical Properties in Protein Structures", "authors": ["Ce Liu", "Jun Wang", "Zhiqiang Cai", "Yingxu Wang", "Huizhen Kuang", "Kaihui Cheng", "Liwei Zhang", "Qingkun Su", "Yining Tang", "Fenglei Cao", "Limei Han", "Siyu Zhu", "Yuan Qi"], "abstract": "Despite significant progress in static protein structure collec-\ntion and prediction, the dynamic behavior of proteins, one of\ntheir most vital characteristics, has been largely overlooked in\nprior research. This oversight can be attributed to the limited\navailability, diversity, and heterogeneity of dynamic protein\ndatasets. To address this gap, we propose to enhance exist-\ning prestigious static 3D protein structural databases, such as\nthe Protein Data Bank (PDB), by integrating dynamic data\nand additional physical properties. Specifically, we introduce\na large-scale dataset, Dynamic PDB, encompassing approxi-\nmately 12.6K proteins, each subjected to all-atom molecular\ndynamics (MD) simulations lasting 1 microsecond to capture\nconformational changes. Furthermore, we provide a compre-\nhensive suite of physical properties, including atomic veloci-\nties and forces, potential and kinetic energies of proteins, and\nthe temperature of the simulation environment, recorded at 1\npicosecond intervals throughout the simulations. For bench-\nmarking purposes, we evaluate state-of-the-art methods on\nthe proposed dataset for the task of trajectory prediction. To\ndemonstrate the value of integrating richer physical proper-\nties in the study of protein dynamics and related model de-\nsign, we base our approach on the SE(3) diffusion model and\nincorporate these physical properties into the trajectory pre-\ndiction process. Preliminary results indicate that this straight-\nforward extension of the SE(3) model yields improved accu-\nracy, as measured by MAE and RMSD, when the proposed\nphysical properties are taken into consideration.", "sections": [{"title": "1 Introduction", "content": "Advancements in experimental techniques such as X-ray\ncrystallography, nuclear magnetic resonance, and electron\nmicroscopy have substantially enriched the repository of\nstatic 3D structural data for biological macromolecules,\nincluding proteins, nucleic acids, and complex assem-\nblies (Berman et al. 2000). This extensive repository not\nonly facilitates research in the prediction of static protein\nstructures but also plays a pivotal role in fundamental sci-\nentific inquiry, applied sciences, and technological develop-\nment. Specifically, a comprehensive understanding of pro-\ntein 3D structures is crucial for the rational design of drug\nmolecules that precisely target specific active sites, thereby\nenhancing drug efficacy and minimizing adverse side ef-\nfects (Zhang 2009; \u015aled\u017a and Caflisch 2018). Moreover, the\ncapacity to predict static protein structures can facilitate the\ndevelopment of novel enzymes, thereby improving the ef-\nficiency of biocatalytic reactions (Dobson and Doig 2005).\nAdditionally, these structures serve as critical references for\nthe synthesis of new functional proteins or biological mod-\nules, which in turn propels the advancement of innovative\nbiological systems and products (Pantazes, Grisewood, and\nMaranas 2011; Huang, Boyken, and Baker 2016; Kuhlman\nand Bradley 2019).\nAmong the various repositories of static protein structure\ndata, the Protein Data Bank (PDB) (Berman et al. 2000)\nis particularly noteworthy, encompassing over 220K pro-\nteins with experimentally determined 3D structures acquired\nthrough methodologies such as X-ray crystallography and\ncryo-electron microscopy. The advent of deep learning tech-\nniques, as exemplified by AlphaFold (Jumper et al. 2021)\nand its derivatives (Baek et al. 2021; Wu et al. 2022; Rives\net al. 2019; Lin et al. 2023), has revolutionized the do-\nmain by accurately predicting the structures of over one mil-\nlion proteins based on their amino acid sequences. How-\never, the analysis of proteins' dynamic behaviors, critical for\nunderstanding conformational changes, remains a substan-\ntial challenge. This challenge is primarily due to the limited\navailability, diversity, and heterogeneity of dynamic protein\ndatasets (Vander Meersche et al. 2023; Vander Meersche\net al. 2021; Marchetti et al. 2021).\nThis paper introduces a novel dataset, Dynamic PDB,\ndesigned to capture the dynamic behavior of proteins, ac-\ncompanied by a comprehensive suite of physical proper-\nties such as atomic velocities and forces, potential and ki-\nnetic energies, and the temperature of the simulation en-\nvironment. To address the challenges inherent in study-\ning protein dynamics, molecular dynamics (MD) simula-\ntions have been extensively employed (Lindahl and San-\nsom 2008; Klepeis et al. 2009; Lindorff-Larsen et al. 2011).\nThese simulations monitor atomic motion within protein\nsystems by integrating Newton's equations of motion over\ntime. MD simulations have proven crucial in providing in-"}, {"title": "2 Related Work", "content": "This section commences with a review of the existing liter-\nature pertaining to protein structural datasets, as well as the"}, {"title": "3 Dynamic Protein Dataset", "content": "In this section, we introduce the proposed dataset, detailing\nthe preparation process, the molecular dynamics simulation,\nand the analysis of dynamic behaviors."}, {"title": "3.1 Source of Protein Structural Data", "content": "Currently, there are 223.8K experimentally determined\nprotein structures deposited in the Protein Data Bank\n(PDB) (Berman et al. 2000). Despite the extensive scope\nof the PDB database, some structures, such as membrane\nproteins, present challenges for molecular dynamics (MD)\nsimulations (Lindahl and Sansom 2008). To address these\nchallenges, we implement a series of processing steps, de-\ntailed below, to prepare the proteins for MD simulation."}, {"title": "3.2 Preprocessing of Protein Data", "content": "To prepare proteins for molecular dynamics simulations, we\nadhere to a systematic approach involving selection, clean-\ning, and completion. The flowchart is in appendix.\nSelection. Initially, we select proteins with structures de-\ntermined via X-ray diffraction, ensuring a resolution of no\ngreater than 2.0 \u00c5. Subsequently, we filter out single-chain\nproteins that are monomeric in their oligomeric state and\npossess a sequence length of 500 residues or fewer. We\nfurther exclude membrane proteins by consulting databases\nsuch as OPM (Lomize et al. 2006), PDBTM (Kozma, Si-\nmon, and Tusnady 2012), MemProtMD (Newport, Sansom,\nand Stansfeld 2019), and mpstruc (Bittrich et al. 2022).\nLastly, we utilize the dictionary of secondary structure in\nproteins (DSSP) (Kabsch and Sander 1983) to eliminate pro-\nteins characterized by more than 50% coil-loop conforma-\ntions.\nCleaning. In this step, we remove all heteroatoms from the\nprotein structures, including water molecules and ligands,\nto focus on the intrinsic dynamic behavior of the proteins.\nAdditionally, we standardize the nomenclature by replacing\nnon-standard residue names with their corresponding stan-\ndard designations.\nCompletion. For proteins exhibiting 5 or fewer missing\nresidues, we employ MODELLER (Webb and Sali 2016)\nfor reconstruction. Conversely, for proteins with 6 or more\nmissing residues, restoration is achieved utilizing AlphaFold\n2 (Jumper et al. 2021). Furthermore, we incorporate hydro-\ngen atoms into the protein structures using MODELLER to\nensure completeness."}, {"title": "3.3 MD Simulation Protocol", "content": "All-atom molecular dynamics simulations are conducted us-\ning OpenMM (Eastman et al. 2017) in conjunction with the\nAmber-ff14SB force field, which has been shown to enhance\nthe accuracy of protein side chain and backbone parameters.\nThe dimensions of the periodic box containing each protein\nare defined by a padding distance of 1 nm. This box is filled\nwith TIP3P water molecules and subsequently neutralized\nwith Na+/Cl- ions at a concentration of 150 mM.\nTo mitigate structural artifacts, minimize atomic clashes,\nand establish a stable starting conformation for reliable sim-\nulation outcomes, an energy minimization process is per-\nformed. The force tolerance for this minimization is set to\n2.39 kcal/mol\u00b7 nm without any imposed maximal step lim-\nits. Following energy minimization, two sequential equili-\nbration processes are carried out: first in a canonical ensem-\nble (NVT) and subsequently in an isothermal-isobaric en-\nsemble (NPT), each spanning 1 ns with a time step of 1 fs.\nThe LangevinMiddleIntegrator is employed as the integrator\nfor both equilibration phases, with the heat bath temperature\nand friction coefficient set to 300 K and 1.0 ps-1, respec-"}, {"title": "3.4 Analysis of Dynamic Protein Dataset", "content": "Attributes of Proposed Dataset. The proposed dataset\ncomprises extensive molecular dynamics simulation data for\n12,643 distinct protein chains, meticulously organized to en-\nhance accessibility and facilitate analysis. Statistics regard-\ning protein length and secondary structures are presented in\nappendix, which illustrates the structural diversity present\nwithin the dataset. Specifically, protein lengths range from 9\nto 444 residues, while the percentage of alpha helices varies\nfrom 0.00 to 0.92.\nAs an advantage of our dataset, the long-term simulations,\nillustrated in Figure 1, can potentially capture a broader\nrange of protein conformational changes, whereas shorter\nsampling intervals, depicted in Figure 4, provide a more de-\ntailed representation of the protein's trajectories.\nThe root mean square\nfluctuation (RMSF) represents a crucial metric in molecu-\nlar dynamics, quantitatively assessing the standard deviation\nof atomic positions over the simulation trajectory. In this\nanalysis, we randomly selected six proteins to compare their\nRMSF values with those obtained from the ATLAS dataset,\nwith the results presented in Figure 2. The plots indicate that\nboth datasets exhibit analogous fluctuation patterns across\nthe residue sequence, suggesting consistency in the dynamic\nbehavior of the proteins.\nA significant advantage\nof the proposed dataset over previously established pro-\ntein datasets in molecular dynamics is its extended simu-\nlation duration, which facilitates a more comprehensive ex-\nploration of conformational changes in proteins. In Figures 1\nand 3, we present the root mean square deviation (RMSD)\ncurves for proteins from both datasets. The RMSD quanti-\nfies the deviation of the protein structure from its initial con-\nformation. Extended simulations reveal markedly enhanced\nconformational dynamics, thereby providing richer biophys-\nical insights into protein behavior.\nThe Ramachandran plot serves as a\ntool to assess whether the dihedral angles \ud835\udf19 and \ud835\udf13 of amino\nacid residues in a protein structure fall within acceptable re-\ngions. Using protein 3TVJ_I as a representative example,\nwe visualize the Ramachandran plot in Figure 1. The plot\ndemonstrates that the dihedral angles observed during our\nsimulation are appropriately positioned within the permissi-\nble regions, indicating the structural validity of the protein.\nThe contact map functions as a\nrepresentation of the spatial relationships between all possi-\nble pairs of amino acid residues, formatted as a binary two-\ndimensional matrix. For any two residues $i$ and $j$, the $(i, j)$\nelement of the matrix is assigned a value of 1 if the two\nresidues are situated within a distance threshold of 7.5 \u00c5,\nand 0 otherwise. Using protein 3TVJ_I as a case study, we\nillustrate the contact map frequency across the entire trajec-\ntory in Figure 1, normalizing the values to the range [0, 1].\nOur analysis reveals that many elements fall between 0 and\n1, indicating that the 3D structures of the protein undergo\nsignificant changes throughout the simulation.\nThe gyration radius is defined as the\ndistance from an axis of a body to a point within the body\nat which the moment of inertia is equivalent to that of the\nentire body. We present a plot depicting the gyration radius\nas a function of simulation time in Figure 1, illustrating the\nchanges in this parameter throughout the duration of the sim-\nulation."}, {"title": "4 Physics Conditioned Dynamic SE(3)\nDiffusion", "content": "In this section, we begin with an overview of the SE(3) dif-\nfusion model (Yim et al. 2023), employed for the genera-\ntion of protein backbones from random noise. We then en-\nhance the SE(3) diffusion model by integrating embeddings\nof amino acid sequences and relevant physical properties to\nimprove the denoising process. This augmented framework\nis subsequently applied to the task of protein trajectory pre-\ndiction."}, {"title": "4.1 SE(3) Diffusion Model", "content": "The SE(3) model serves as a score-based generative ap-\nproach (Song et al. 2020) for sampling protein backbones,\ncharacterized by a framework that parameterizes the back-\nbone of a protein with L residues. This framework utilizes\ntransformations $Y \\in SE(3)^L$ and torsion angles $\\psi \\in \\mathbb{R}^L$.\nThe methodology incorporates a forward diffusion process\non SE(3) to systematically transform the initial config-\nurations Y into a noise representation, followed by a re-\nverse denoising process. To achieve this, the SE(3) diffu-\nsion model employs a neural network to estimate both the\nscore and the torsion angles. Initially, the model takes as in-\nput the node embedding, edge embedding, and a randomly\ninitialized representation of Y. A series of iterative layers is\nthen applied to refine these embeddings and update Y. No-\ntably, the final layer output predicts the torsion angles via the\nnode embedding, while the transformation Y is leveraged to\ncompute the score. The initialization of the node embedding\nis derived from residue indices and time steps, adhering to\nthe methodology outlined in ProtDiff (Trippe et al. 2023),\nwhereas the edge embedding incorporates relative sequence\ndistances. Each layer of the model consists of an initial re-\nfinement of the node embedding using the Invariant Point\nAttention (IPA) module (Jumper et al. 2021), followed by\nfurther processing with a spatial Transformer (Vaswani et al.\n2017). Subsequently, the updated node embedding is utilized\nto enhance both the edge embedding and the transformation\nY via multi-layer perceptrons (MLPs)."}, {"title": "4.2 Integrating Dynamics and Physical\nConditions", "content": "In this section, we present an extension of the SE(3) diffu-\nsion model by integrating dynamic constraints and physical\nproperties, with the overall architecture depicted in Figure 5.\nThis enhancement of the SE(3) diffusion model involves the\nincorporation of the amino acid sequence alongside relevant\nphysical characteristics to refine the denoising process. Ad-\nditionally, we expand the representation of torsion angles to\n$\\alpha \\in \\mathbb{R}^{L \\times 7}$, enabling the recovery of all atomic positions,\nincluding those of the side chains, in accordance with the\nmethodologies established by AlphaFold 2."}, {"title": "Amino Acid Embedding.", "content": "In our approach, we extract fea-\ntures from the amino acid sequence of the protein in accor-\ndance with the protein prediction framework established by\nOmegaFold (Wu et al. 2022). For each residue $i$, we define a\ncorresponding node feature $Q_i \\in \\mathbb{R}^{D_Q}$, which is designed to\nencapsulate critical information, such as the type of amino\nacid. Additionally, for each pair of residues $i$ and $j$, we in-\ntroduce an edge feature $E_{(i,j)} \\in \\mathbb{R}^{D_E}$ that encodes the po-\ntential interactions between these residues. We enhance the\noriginal node and edge embeddings within the SE(3) diffu-\nsion framework by incorporating the features Q and E."}, {"title": "Physical Condition Embedding.", "content": "We propose a unified\nencoder to extract features from various physical properties.\nSpecifically, for each residue $i$, we analyze the transforma-\ntion $Y_i$, the torsion angles $\\alpha_i$, the velocity $V_i \\in \\mathbb{R}^3$, and\nthe force $F_i \\in \\mathbb{R}^3$ associated with the C\u0251 atom in residue $i$.\nFor each type of physical property, we initially apply MLPs\nto capture the relevant features. Subsequently, we normal-\nize the extracted features across all residues using layer nor-\nmalization (Ba, Kiros, and Hinton 2016). Finally, we con-\ncatenate the normalized features from all physical properties\nalong the channel dimension. We denote the resultant feature\nvector that encapsulates all physical properties for residue $i$\nas $K_i \\in \\mathbb{R}^{D_K}$."}, {"title": "4.3 Network Overview", "content": "Finally, we apply our proposed design to the task of protein\ntrajectory prediction. At the current time step, we denote the\nrelevant variables, including transformation, torsion angles,\nvelocity, and force, as $Y^t$, $\\alpha^t$, $V^t$ and $F^t$ respectively. Cor-\nrespondingly, we denote the variables at the next time step as\n$Y^{t+1}$, $\\alpha^{t+1}$, $V^{t+1}$ and $F^{t+1}$. The objective of this task is to estimate\n$Y^{t+1}$ and $\\alpha^{t+1}$ based on the known variables $Y^t$, $\\alpha^t$, $V^t$ and $F^t$.\nTo initiate the process, we first initialize the unknown vari-\nables at the next time step using the corresponding known\nvariables from the current time step. For each residue and\neach time step, we extract both the amino acid embedding\nand the physical properties embedding. Subsequently, we\nrefine the node features using the Invariant Point Attention\n(IPA) module and concatenate these features with the physi-\ncal properties embedding. Finally, we apply 2D convolution\nalong both the time dimension and the protein sequence di-\nmension. The resulting node features at the next time step\nare then utilized to update the predicted transformation and\ntorsion angles through multi-layer perceptrons (MLPs)."}, {"title": "5 Experiment", "content": "In this section, we benchmark state-of-the-art methods on\nthe proposed dataset. Additionally, we evaluate our proposed\nphysics-conditioned dynamic SE(3) diffusion model, con-\nducting ablation studies to demonstrate the efficacy of in-\ncorporating physical properties."}, {"title": "5.1 Implementation", "content": "Experimental Setup. All experiments were conducted on\na server equipped with an Intel Xeon CPU operating at 2.90\nGHz and an NVIDIA A100 GPU with 80 GB of memory. All\nmethods were implemented using the PyTorch framework."}, {"title": "5.2 Quantitative Results", "content": "We compare our method with several state-of-the-art\napproaches, including FM (Kohler et al. 2023), SE(3)-\nTrans (Fuchs et al. 2020), EGNN (Satorras, Hoogeboom,\nand Welling 2021), SEGNN (Brandstetter et al. 2021),\nand SEGNO (Liu et al. 2024), on the proposed dataset.\nThe results of this comparison are presented in Table 2. It\nis important to note that FM predicts only the Ca atoms;\nconsequently, the metrics for FM are computed exclusively\nbased on these atoms. Our method demonstrates superior\nperformance across both evaluation metrics, achieving a\nsignificant reduction in RMSD from 0.653 to 0.352."}, {"title": "Analysis of Time Interval.", "content": "The time interval between ad-\njacent time steps significantly influences the prediction ac-\ncuracy of the methods. To investigate this effect, we evalu-\nate the methods across different time intervals, specifically\n1 ps, 10 ps, and 50 ps. The mean absolute error (MAE) re-\nsults are reported in Table 3. Our findings indicate that all\nmethods exhibit improved accuracy with shorter time inter-\nvals across both metrics. For instance, the MAE of EGNN\nincreases by 97% when the time interval is extended from 1\nps to 10 ps. To further explore the impact of the time interval\nduring training, we conducted an additional experiment us-\ning FM, which was trained on time intervals of 1 ps, 10 ps,\nand 50 ps, but evaluated exclusively at a 1 ps interval. The re-\nsults of this evaluation are presented in Figure 6. Our analy-\nsis reveals that FM trained on shorter time intervals achieves\nsuperior accuracy."}, {"title": "Analysis of Simulation Time.", "content": "In longer molecular dy-\nnamics (MD) simulations, a greater diversity of protein con-\nformations is observed. To investigate this effect, we trained\nthe methods on training sets generated from simulations last-\ning for 1 \u00b5s, 100 ns, and 50 ns, respectively, while keeping\nthe test set constant. The mean absolute error (MAE) results\nare reported in Table 4. Our findings indicate that FM ex-\nhibits improved accuracy with longer simulation durations.\nIn contrast, SE(3)-Trans, EGNN, and SEGNN demonstrate\ncomparable accuracy across different simulation lengths."}, {"title": "Analysis of Physical Properties.", "content": "Physical properties, in-\ncluding velocity and force, provide valuable information for\ntrajectory prediction. To investigate their effects, we con-\nducted ablation studies using the protein 2ERL_A. As shown\nin Table 5, the inclusion of velocity resulted in a reduction of\nthe mean absolute error (MAE) from 0.284 to 0.279 and the\nroot mean square deviation (RMSD) from 0.546 to 0.533.\nFurthermore, by incorporating force into the model, both"}, {"title": "Generalization on New Proteins", "content": "We train our diffusion\nmodel on trajectories of multiple proteins simultaneously,\nand make prediction for unseen proteins. Specifically, we\ntrain our model on 10 proteins and 214 proteins respectively,\nwhich exclude the protein 2ERL_A, and then test on the\n2ERL_A as above, the results are shown in Table 6. With\nmore proteins during training, our model makes better pre-\ndiction for new proteins."}, {"title": "5.3 Qualitative Results", "content": "We visualize the predicted 3D structures from our method,\nand compare with SE(3)-Trans in Figure 7. Our results\ndemonstrate that the incorporation of physical properties al-\nlows the predictions from our approach to align more closely\nwith the ground truth. The top two rows show the results on\nthe protein 2ERL_A, where our predictions on the alpha he-\nlices are more accurate. The bottom two rows show the pre-\ndicted 3TVJ_I. Our predictions are closer to the ground truth\non the beta sheets."}, {"title": "6 Limitations of Future Works", "content": "While our dataset and model extension represent obvious\nadvancements in capturing protein dynamics, several lim-\nitations warrant attention. Firstly, although extensive, the\ndataset may not encompass the full diversity of protein con-\nformations encountered in nature. Additionally, the com-\nputational expense associated with long-duration molecular\ndynamics simulations can be prohibitive, thus constraining\nthe scalability of our approach. Although the SE(3) model\nextension is effective, it may benefit from further refinement\nto fully leverage the integrated physical properties. Future\nresearch should prioritize expanding the dataset to include a\nbroader array of proteins and conformational states. More-\n      over, optimizing computational efficiency and exploring al-\nternative modeling techniques could enhance the predictive\ncapabilities and overall applicability of our methodology.\nFurther investigations could also focus on integrating addi-\ntional physical and biochemical properties, providing a more\ncomprehensive understanding of protein dynamics."}, {"title": "7 Conclusion", "content": "In this paper, we presented a novel dataset that integrates\ndynamic behaviors and physical properties within protein\nstructures, effectively addressing the limitations of existing\nstatic protein databases. By conducting all-atom molecu-\nlar dynamics simulations on approximately 12.6K proteins,\nwe captured significant conformational changes and com-\npiled a comprehensive suite of physical properties. Our ex-\ntension of the SE(3) diffusion model, which incorporates\nthese physical properties, demonstrated enhanced accuracy\nin trajectory prediction tasks, as indicated by reductions in\nmean absolute error (MAE) and root mean square deviation\n(RMSD). The results underscore the critical role of dynamic\ndata and physical properties in advancing the understand-\ning of protein dynamics. This work paves the way for fu-\nture research in protein trajectory prediction and the devel-\nopment of more sophisticated models that capitalize on dy-\nnamic protein datasets."}, {"title": "A Appendix", "content": "In this part, we present an overview of\nthe pipeline in Figure A.1. The protein structure is from the\nProtein Data Bank. We first preprocess and then perform\nMD simulation.\nIn Fig-\nure A.2, we present the adopted methods to complete the\nmissing residues of proteins, and the percentage of each"}]}