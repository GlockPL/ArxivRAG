{"title": "Dynamic PDB: A New Dataset and a SE(3) Model Extension by Integrating Dynamic Behaviors and Physical Properties in Protein Structures", "authors": ["Ce Liu", "Jun Wang", "Zhiqiang Cai", "Yingxu Wang", "Huizhen Kuang", "Kaihui Cheng", "Liwei Zhang", "Qingkun Su", "Yining Tang", "Fenglei Cao", "Limei Han", "Siyu Zhu", "Yuan Qi"], "abstract": "Despite significant progress in static protein structure collection and prediction, the dynamic behavior of proteins, one of their most vital characteristics, has been largely overlooked in prior research. This oversight can be attributed to the limited availability, diversity, and heterogeneity of dynamic protein datasets. To address this gap, we propose to enhance existing prestigious static 3D protein structural databases, such as the Protein Data Bank (PDB), by integrating dynamic data and additional physical properties. Specifically, we introduce a large-scale dataset, Dynamic PDB, encompassing approximately 12.6K proteins, each subjected to all-atom molecular dynamics (MD) simulations lasting 1 microsecond to capture conformational changes. Furthermore, we provide a comprehensive suite of physical properties, including atomic velocities and forces, potential and kinetic energies of proteins, and the temperature of the simulation environment, recorded at 1 picosecond intervals throughout the simulations. For benchmarking purposes, we evaluate state-of-the-art methods on the proposed dataset for the task of trajectory prediction. To demonstrate the value of integrating richer physical properties in the study of protein dynamics and related model design, we base our approach on the SE(3) diffusion model and incorporate these physical properties into the trajectory prediction process. Preliminary results indicate that this straightforward extension of the SE(3) model yields improved accuracy, as measured by MAE and RMSD, when the proposed physical properties are taken into consideration.", "sections": [{"title": "1 Introduction", "content": "Advancements in experimental techniques such as X-ray crystallography, nuclear magnetic resonance, and electron microscopy have substantially enriched the repository of static 3D structural data for biological macromolecules, including proteins, nucleic acids, and complex assemblies (Berman et al. 2000). This extensive repository not only facilitates research in the prediction of static protein structures but also plays a pivotal role in fundamental scientific inquiry, applied sciences, and technological development. Specifically, a comprehensive understanding of protein 3D structures is crucial for the rational design of drug molecules that precisely target specific active sites, thereby enhancing drug efficacy and minimizing adverse side effects (Zhang 2009; \u015aled\u017a and Caflisch 2018). Moreover, the capacity to predict static protein structures can facilitate the development of novel enzymes, thereby improving the efficiency of biocatalytic reactions (Dobson and Doig 2005). Additionally, these structures serve as critical references for the synthesis of new functional proteins or biological modules, which in turn propels the advancement of innovative biological systems and products (Pantazes, Grisewood, and Maranas 2011; Huang, Boyken, and Baker 2016; Kuhlman and Bradley 2019).\nAmong the various repositories of static protein structure data, the Protein Data Bank (PDB) (Berman et al. 2000) is particularly noteworthy, encompassing over 220K proteins with experimentally determined 3D structures acquired through methodologies such as X-ray crystallography and cryo-electron microscopy. The advent of deep learning techniques, as exemplified by AlphaFold (Jumper et al. 2021) and its derivatives (Baek et al. 2021; Wu et al. 2022; Rives et al. 2019; Lin et al. 2023), has revolutionized the domain by accurately predicting the structures of over one million proteins based on their amino acid sequences. However, the analysis of proteins' dynamic behaviors, critical for understanding conformational changes, remains a substantial challenge. This challenge is primarily due to the limited availability, diversity, and heterogeneity of dynamic protein datasets (Vander Meersche et al. 2023; Vander Meersche et al. 2021; Marchetti et al. 2021).\nThis paper introduces a novel dataset, Dynamic PDB, designed to capture the dynamic behavior of proteins, accompanied by a comprehensive suite of physical properties such as atomic velocities and forces, potential and kinetic energies, and the temperature of the simulation environment. To address the challenges inherent in studying protein dynamics, molecular dynamics (MD) simulations have been extensively employed (Lindahl and Sansom 2008; Klepeis et al. 2009; Lindorff-Larsen et al. 2011). These simulations monitor atomic motion within protein systems by integrating Newton's equations of motion over time. MD simulations have proven crucial in providing in-"}, {"title": "2 Related Work", "content": "This section commences with a review of the existing literature pertaining to protein structural datasets, as well as the"}, {"title": "3 Dynamic Protein Dataset", "content": "In this section, we introduce the proposed dataset, detailing the preparation process, the molecular dynamics simulation, and the analysis of dynamic behaviors."}, {"title": "3.1 Source of Protein Structural Data", "content": "Currently, there are 223.8K experimentally determined protein structures deposited in the Protein Data Bank (PDB) (Berman et al. 2000). Despite the extensive scope of the PDB database, some structures, such as membrane proteins, present challenges for molecular dynamics (MD) simulations (Lindahl and Sansom 2008). To address these challenges, we implement a series of processing steps, detailed below, to prepare the proteins for MD simulation."}, {"title": "3.2 Preprocessing of Protein Data", "content": "To prepare proteins for molecular dynamics simulations, we adhere to a systematic approach involving selection, cleaning, and completion. The flowchart is in appendix.\nSelection. Initially, we select proteins with structures determined via X-ray diffraction, ensuring a resolution of no greater than 2.0 \u00c5. Subsequently, we filter out single-chain proteins that are monomeric in their oligomeric state and possess a sequence length of 500 residues or fewer. We further exclude membrane proteins by consulting databases such as OPM (Lomize et al. 2006), PDBTM (Kozma, Simon, and Tusnady 2012), MemProtMD (Newport, Sansom, and Stansfeld 2019), and mpstruc (Bittrich et al. 2022). Lastly, we utilize the dictionary of secondary structure in proteins (DSSP) (Kabsch and Sander 1983) to eliminate proteins characterized by more than 50% coil-loop conformations.\nCleaning. In this step, we remove all heteroatoms from the protein structures, including water molecules and ligands, to focus on the intrinsic dynamic behavior of the proteins. Additionally, we standardize the nomenclature by replacing non-standard residue names with their corresponding standard designations.\nCompletion. For proteins exhibiting 5 or fewer missing residues, we employ MODELLER (Webb and Sali 2016) for reconstruction. Conversely, for proteins with 6 or more missing residues, restoration is achieved utilizing AlphaFold 2 (Jumper et al. 2021). Furthermore, we incorporate hydrogen atoms into the protein structures using MODELLER to ensure completeness."}, {"title": "3.3 MD Simulation Protocol", "content": "All-atom molecular dynamics simulations are conducted using OpenMM (Eastman et al. 2017) in conjunction with the Amber-ff14SB force field, which has been shown to enhance the accuracy of protein side chain and backbone parameters. The dimensions of the periodic box containing each protein are defined by a padding distance of 1 nm. This box is filled with TIP3P water molecules and subsequently neutralized with Na+/Cl- ions at a concentration of 150 mM.\nTo mitigate structural artifacts, minimize atomic clashes, and establish a stable starting conformation for reliable simulation outcomes, an energy minimization process is performed. The force tolerance for this minimization is set to 2.39 kcal/mol\u00b7 nm without any imposed maximal step limits. Following energy minimization, two sequential equilibration processes are carried out: first in a canonical ensemble (NVT) and subsequently in an isothermal-isobaric ensemble (NPT), each spanning 1 ns with a time step of 1 fs. The LangevinMiddleIntegrator is employed as the integrator for both equilibration phases, with the heat bath temperature and friction coefficient set to 300 K and 1.0 ps-1, respec-"}, {"title": "3.4 Analysis of Dynamic Protein Dataset", "content": "Attributes of Proposed Dataset. The proposed dataset comprises extensive molecular dynamics simulation data for 12,643 distinct protein chains, meticulously organized to enhance accessibility and facilitate analysis. Statistics regarding protein length and secondary structures are presented in appendix, which illustrates the structural diversity present within the dataset. Specifically, protein lengths range from 9 to 444 residues, while the percentage of alpha helices varies from 0.00 to 0.92.\nAs an advantage of our dataset, the long-term simulations, illustrated in Figure 1, can potentially capture a broader range of protein conformational changes, whereas shorter sampling intervals, depicted in Figure 4, provide a more detailed representation of the protein's trajectories.\nTable 1 provides a detailed overview of the data attributes associated with each protein. This structured format supports subsequent analyses and interpretations of the intrinsic dynamic behaviors and properties of the proteins within the dataset. To facilitate further exploration of the dynamic behaviors of the proteins, we present additional relevant metrics in the following sections.\nRoot Mean Square Fluctuation. The root mean square fluctuation (RMSF) represents a crucial metric in molecular dynamics, quantitatively assessing the standard deviation of atomic positions over the simulation trajectory. In this analysis, we randomly selected six proteins to compare their RMSF values with those obtained from the ATLAS dataset, with the results presented in Figure 2. The plots indicate that both datasets exhibit analogous fluctuation patterns across the residue sequence, suggesting consistency in the dynamic behavior of the proteins.\nRoot Mean Square Deviation. A significant advantage of the proposed dataset over previously established protein datasets in molecular dynamics is its extended simulation duration, which facilitates a more comprehensive exploration of conformational changes in proteins. In Figures 1 and 3, we present the root mean square deviation (RMSD) curves for proteins from both datasets. The RMSD quantifies the deviation of the protein structure from its initial conformation. Extended simulations reveal markedly enhanced conformational dynamics, thereby providing richer biophysical insights into protein behavior.\nRamachandran Plot. The Ramachandran plot serves as a tool to assess whether the dihedral angles \u03c6 and \u03c8 of amino acid residues in a protein structure fall within acceptable regions. Using protein 3TVJ_I as a representative example, we visualize the Ramachandran plot in Figure 1. The plot demonstrates that the dihedral angles observed during our simulation are appropriately positioned within the permissible regions, indicating the structural validity of the protein.\nContact Map Frequency. The contact map functions as a representation of the spatial relationships between all possible pairs of amino acid residues, formatted as a binary two-dimensional matrix. For any two residues i and j, the (i, j) element of the matrix is assigned a value of 1 if the two residues are situated within a distance threshold of 7.5 \u00c5, and 0 otherwise. Using protein 3TVJ_I as a case study, we illustrate the contact map frequency across the entire trajectory in Figure 1, normalizing the values to the range [0, 1]. Our analysis reveals that many elements fall between 0 and 1, indicating that the 3D structures of the protein undergo significant changes throughout the simulation.\nGyration Radius. The gyration radius is defined as the distance from an axis of a body to a point within the body at which the moment of inertia is equivalent to that of the entire body. We present a plot depicting the gyration radius as a function of simulation time in Figure 1, illustrating the changes in this parameter throughout the duration of the simulation."}, {"title": "4 Physics Conditioned Dynamic SE(3) Diffusion", "content": "In this section, we begin with an overview of the SE(3) diffusion model (Yim et al. 2023), employed for the generation of protein backbones from random noise. We then enhance the SE(3) diffusion model by integrating embeddings of amino acid sequences and relevant physical properties to improve the denoising process. This augmented framework is subsequently applied to the task of protein trajectory prediction."}, {"title": "4.1 SE(3) Diffusion Model", "content": "The SE(3) model serves as a score-based generative approach (Song et al. 2020) for sampling protein backbones, characterized by a framework that parameterizes the backbone of a protein with L residues. This framework utilizes transformations \\(Y \\in SE(3)^L\\) and torsion angles \\(\\psi \\in \\mathbb{R}^L\\). The methodology incorporates a forward diffusion process on SE(3) to systematically transform the initial configurations Y into a noise representation, followed by a reverse denoising process. To achieve this, the SE(3) diffusion model employs a neural network to estimate both the score and the torsion angles. Initially, the model takes as input the node embedding, edge embedding, and a randomly initialized representation of Y. A series of iterative layers is then applied to refine these embeddings and update Y. Notably, the final layer output predicts the torsion angles via the node embedding, while the transformation Y is leveraged to compute the score. The initialization of the node embedding is derived from residue indices and time steps, adhering to the methodology outlined in ProtDiff (Trippe et al. 2023), whereas the edge embedding incorporates relative sequence distances. Each layer of the model consists of an initial refinement of the node embedding using the Invariant Point Attention (IPA) module (Jumper et al. 2021), followed by further processing with a spatial Transformer (Vaswani et al. 2017). Subsequently, the updated node embedding is utilized to enhance both the edge embedding and the transformation Y via multi-layer perceptrons (MLPs)."}, {"title": "4.2 Integrating Dynamics and Physical Conditions", "content": "In this section, we present an extension of the SE(3) diffusion model by integrating dynamic constraints and physical properties, with the overall architecture depicted in Figure 5. This enhancement of the SE(3) diffusion model involves the incorporation of the amino acid sequence alongside relevant physical characteristics to refine the denoising process. Additionally, we expand the representation of torsion angles to \\(\\alpha \\in \\mathbb{R}^{L \\times 7}\\), enabling the recovery of all atomic positions, including those of the side chains, in accordance with the methodologies established by AlphaFold 2."}, {"title": "Amino Acid Embedding.", "content": "In our approach, we extract features from the amino acid sequence of the protein in accordance with the protein prediction framework established by OmegaFold (Wu et al. 2022). For each residue i, we define a corresponding node feature \\(Q_i \\in \\mathbb{R}^{D_Q}\\), which is designed to encapsulate critical information, such as the type of amino acid. Additionally, for each pair of residues i and j, we introduce an edge feature \\(E_{(i,j)} \\in \\mathbb{R}^{D_E}\\) that encodes the potential interactions between these residues. We enhance the original node and edge embeddings within the SE(3) diffusion framework by incorporating the features Q and E."}, {"title": "Physical Condition Embedding.", "content": "We propose a unified encoder to extract features from various physical properties. Specifically, for each residue i, we analyze the transformation Y, the torsion angles \\(\\alpha_i\\), the velocity \\(V_i \\in \\mathbb{R}^3\\), and the force \\(F_i \\in \\mathbb{R}^3\\) associated with the \\(C_\\alpha\\) atom in residue i. For each type of physical property, we initially apply MLPs to capture the relevant features. Subsequently, we normalize the extracted features across all residues using layer normalization (Ba, Kiros, and Hinton 2016). Finally, we concatenate the normalized features from all physical properties along the channel dimension. We denote the resultant feature vector that encapsulates all physical properties for residue i as \\(K_i \\in \\mathbb{R}^{D_K}\\)."}, {"title": "4.3 Network Overview", "content": "Finally, we apply our proposed design to the task of protein trajectory prediction. At the current time step, we denote the relevant variables, including transformation, torsion angles, velocity, and force, as \\(Y^t, \\alpha^t, V^t\\) and \\(F^t\\) respectively. Correspondingly, we denote the variables at the next time step as \\(Y^{t'}, \\alpha^{t'}, V^{t'}\\) and \\(F^{t'}\\). The objective of this task is to estimate \\(Y^{t'}\\) and \\(\\alpha^{t'}\\) based on the known variables \\(Y^t, \\alpha^t, V^t\\) and \\(F^t\\). To initiate the process, we first initialize the unknown variables at the next time step using the corresponding known variables from the current time step. For each residue and each time step, we extract both the amino acid embedding and the physical properties embedding. Subsequently, we refine the node features using the Invariant Point Attention (IPA) module and concatenate these features with the physical properties embedding. Finally, we apply 2D convolution along both the time dimension and the protein sequence dimension. The resulting node features at the next time step are then utilized to update the predicted transformation and torsion angles through multi-layer perceptrons (MLPs)."}, {"title": "5 Experiment", "content": "In this section, we benchmark state-of-the-art methods on the proposed dataset. Additionally, we evaluate our proposed physics-conditioned dynamic SE(3) diffusion model, conducting ablation studies to demonstrate the efficacy of incorporating physical properties."}, {"title": "5.1 Implementation", "content": "Experimental Setup. All experiments were conducted on a server equipped with an Intel Xeon CPU operating at 2.90 GHz and an NVIDIA A100 GPU with 80 GB of memory. All methods were implemented using the PyTorch framework."}, {"title": "5.2 Quantitative Results", "content": "We compare our method with several state-of-the-art approaches, including FM (Kohler et al. 2023), SE(3)-Trans (Fuchs et al. 2020), EGNN (Satorras, Hoogeboom, and Welling 2021), SEGNN (Brandstetter et al. 2021), and SEGNO (Liu et al. 2024), on the proposed dataset. The results of this comparison are presented in Table 2. It is important to note that FM predicts only the \\(C_\\alpha\\) atoms; consequently, the metrics for FM are computed exclusively based on these atoms. Our method demonstrates superior performance across both evaluation metrics, achieving a significant reduction in RMSD from 0.653 to 0.352."}, {"title": "Analysis of Time Interval.", "content": "The time interval between adjacent time steps significantly influences the prediction accuracy of the methods. To investigate this effect, we evaluate the methods across different time intervals, specifically 1 ps, 10 ps, and 50 ps. The mean absolute error (MAE) results are reported in Table 3. Our findings indicate that all methods exhibit improved accuracy with shorter time intervals across both metrics. For instance, the MAE of EGNN increases by 97% when the time interval is extended from 1 ps to 10 ps. To further explore the impact of the time interval during training, we conducted an additional experiment using FM, which was trained on time intervals of 1 ps, 10 ps, and 50 ps, but evaluated exclusively at a 1 ps interval. The results of this evaluation are presented in Figure 6. Our analysis reveals that FM trained on shorter time intervals achieves superior accuracy."}, {"title": "Analysis of Simulation Time.", "content": "In longer molecular dynamics (MD) simulations, a greater diversity of protein conformations is observed. To investigate this effect, we trained the methods on training sets generated from simulations lasting for 1 \u00b5s, 100 ns, and 50 ns, respectively, while keeping the test set constant. The mean absolute error (MAE) results are reported in Table 4. Our findings indicate that FM exhibits improved accuracy with longer simulation durations. In contrast, SE(3)-Trans, EGNN, and SEGNN demonstrate comparable accuracy across different simulation lengths."}, {"title": "Analysis of Physical Properties.", "content": "Physical properties, including velocity and force, provide valuable information for trajectory prediction. To investigate their effects, we conducted ablation studies using the protein 2ERL_A. As shown in Table 5, the inclusion of velocity resulted in a reduction of the mean absolute error (MAE) from 0.284 to 0.279 and the root mean square deviation (RMSD) from 0.546 to 0.533. Furthermore, by incorporating force into the model, both"}, {"title": "Generalization on New Proteins", "content": "We train our diffusion model on trajectories of multiple proteins simultaneously, and make prediction for unseen proteins. Specifically, we train our model on 10 proteins and 214 proteins respectively, which exclude the protein 2ERL_A, and then test on the 2ERL_A as above, the results are shown in Table 6. With more proteins during training, our model makes better prediction for new proteins."}, {"title": "5.3 Qualitative Results", "content": "We visualize the predicted 3D structures from our method, and compare with SE(3)-Trans in Figure 7. Our results demonstrate that the incorporation of physical properties allows the predictions from our approach to align more closely with the ground truth. The top two rows show the results on the protein 2ERL_A, where our predictions on the alpha helices are more accurate. The bottom two rows show the predicted 3TVJ_I. Our predictions are closer to the ground truth on the beta sheets."}, {"title": "6 Limitations of Future Works", "content": "While our dataset and model extension represent obvious advancements in capturing protein dynamics, several limitations warrant attention. Firstly, although extensive, the dataset may not encompass the full diversity of protein conformations encountered in nature. Additionally, the computational expense associated with long-duration molecular dynamics simulations can be prohibitive, thus constraining the scalability of our approach. Although the SE(3) model extension is effective, it may benefit from further refinement to fully leverage the integrated physical properties. Future research should prioritize expanding the dataset to include a broader array of proteins and conformational states. Moreover, optimizing computational efficiency and exploring alternative modeling techniques could enhance the predictive capabilities and overall applicability of our methodology. Further investigations could also focus on integrating additional physical and biochemical properties, providing a more comprehensive understanding of protein dynamics."}, {"title": "7 Conclusion", "content": "In this paper, we presented a novel dataset that integrates dynamic behaviors and physical properties within protein structures, effectively addressing the limitations of existing static protein databases. By conducting all-atom molecular dynamics simulations on approximately 12.6K proteins, we captured significant conformational changes and compiled a comprehensive suite of physical properties. Our extension of the SE(3) diffusion model, which incorporates these physical properties, demonstrated enhanced accuracy in trajectory prediction tasks, as indicated by reductions in mean absolute error (MAE) and root mean square deviation (RMSD). The results underscore the critical role of dynamic data and physical properties in advancing the understanding of protein dynamics. This work paves the way for future research in protein trajectory prediction and the development of more sophisticated models that capitalize on dynamic protein datasets."}, {"title": "A Appendix", "content": "In this part, we present an overview of the pipeline in Figure A.1. The protein structure is from the Protein Data Bank. We first preprocess and then perform MD simulation."}, {"title": "A.1 More Details for Dynamic Protein Dataset", "content": "Overall Pipeline."}, {"title": "Statistics of Protein Completion Methods.", "content": "In Figure A.2, we present the adopted methods to complete the missing residues of proteins, and the percentage of each"}, {"title": "Attributes in Dynamic Protein Dataset.", "content": "Table A.1 provides a detailed overview of the data attributes associated with each protein. This structured format supports subsequent analyses and interpretations of the intrinsic dynamic behaviors and properties of the proteins within the dataset."}, {"title": "Statistics of Protein Structures.", "content": "We present statistics regarding protein length and secondary structures in Figure A.4, which illustrates the structural diversity present within the dataset. The protein lengths range from 9 to 444 residues. The percentage of alpha helices varies from 0.00 to 0.92. The percentage of beta sheets varies from 0.00 to 0.78. The percentage of coils varies from 0.00 to 0.49."}, {"title": "Statistics of Physical Properties.", "content": "In Figure A.3, we present statistics about the physical properties of 3TVJ_I,"}]}