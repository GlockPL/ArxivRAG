{"title": "Federated PCA on Grassmann Manifold for IoT Anomaly Detection", "authors": ["Tung-Anh Nguyen", "Long Tan Le", "Tuan Dung Nguyen", "Wei Bao", "Suranga Seneviratne", "Choong Seon Hong", "Nguyen H. Tran"], "abstract": "With the proliferation of the Internet of Things (IoT) and the rising interconnectedness of devices, network security faces significant challenges, especially from anomalous activities. While traditional machine learning-based intrusion detection systems (ML-IDS) effectively employ supervised learning methods, they possess limitations such as the requirement for labeled data and challenges with high dimensionality. Recent unsupervised ML-IDS approaches such as AutoEncoders and Generative Adversarial Networks (GAN) offer alternative solutions but pose challenges in deployment onto resource-constrained IoT devices and in interpretability. To address these concerns, this paper proposes a novel federated unsupervised anomaly detection framework FedPCA that leverages Principal Component Analysis (PCA) and the Alternating Directions Method Multipliers (ADMM) to learn common representations of distributed non-i.i.d. datasets. Building on the FedPCA framework, we propose two algorithms, FEDPE in Euclidean space and FEDPG on Grassmann manifolds. Our approach enables real-time threat detection and mitigation at the device level, enhancing network resilience while ensuring privacy. Moreover, the proposed algorithms are accompanied by theoretical convergence rates even under a sub-sampling scheme, a novel result. Experimental results on the UNSW-NB15 and TON-IoT datasets show that our proposed methods offer performance in anomaly detection comparable to non-linear baselines, while providing significant improvements in communication and memory efficiency, underscoring their potential for securing IoT networks.", "sections": [{"title": "I. INTRODUCTION", "content": "HE ubiquity of Internet of Things (IoT) technologies has led to a transformative shift where intelligent devices exchange information and enact decisions via the internet, requiring minimal human intervention. This has significantly enhanced the quality of life and found applications across numerous sectors such as smart city infrastructures [1], energy systems [2], or climate systems [3]. However, as the IoT ecosystem expands and becomes increasingly complex, ensuring robust network security emerges as a paramount task, especially considering the inherent security vulnerabilities of many IoT devices due to their limited computational resources [4].\nIn this intricate landscape, machine learning-based intrusion detection systems (ML-IDS) form a crucial line of defense. These systems often utilize supervised learning methods that range from traditional techniques to more sophisticated deep learning approaches [5]. While effective in various scenarios, they come with several limitations. For instance, they necessitate access to a considerable volume of labeled data, which can be time-consuming and costly to generate. Additionally, they often struggle with high-dimensional data and are limited in their ability to detect novel anomalies not represented in the training data. In contrast, recent unsupervised ML-IDS methods, such as AutoEncoders [6] and GAN-based models [7], [8], provide anomaly detection by learning representation of normal behavior without relying on labeled data. However, these techniques often involve training deep neural network models, which can be computationally demanding and lack clear interpretability [9] \u2013 factors that pose significant challenges for resource-limited IoT devices.\nTraditionally, most ML-IDS lean on centralized deployment which is becoming less feasible in IoT networks due to privacy concerns and resource limitations. Hence, there's a heightened demand for distributed security frameworks where IoT devices can have self-monitoring capabilities that allow them to identify potential threats in their network traffic while contributing their insights to the broader system. Such a distributed approach would considerably enhance the resilience of IoT networks, enabling real-time anomaly detection and mitigation in heterogeneous environments. In light of this, Federated Learning (FL) has stepped in as a promising paradigm that allows IoT devices to collaboratively learn a shared model while retaining their data locally, thereby harmonizing privacy preservation and efficient resource utilization. Despite its potential, the exploration of federated unsupervised IDS under the heterogeneity of IoT traffic remains relatively nascent, indicating the need for further research in this area.\nIn response to these challenges, we introduce a novel feder-ated unsupervised anomaly detection framework that leverages the representation power of PCA [10] and the decomposability of ADMM [11], namely FedPCA [12]. Specifically, we aim to harness PCA's capabilities to learn a common representation of distributed non-i.i.d datasets via consensus optimization that captures the hidden states within the data. These hidden states typically reflect complex correlations and underlying patterns within the data, which are instrumental in effective anomaly detection. In order to solve FedPCA, we design two distinct algorithms including FedPCA in Euclidean space (FEDPE) and"}, {"title": "II. RELATED WORKS", "content": "Federated Learning (FL) represents a cutting-edge distributed learning approach that allows for the execution and subsequent updating of machine learning models across thousands of participating devices, while simultaneously safeguarding against data leaks [15]. In FL, models are deployed and trained locally on individual clients' devices using local data. These locally trained models are then transmitted back to the central server for aggregation, such as weight averaging [16]. Thanks to the attributes of efficient communication and privacy protection, FL proves highly advantageous for IoT networks and applications. Various versions of FL have been developed after the birth of the standard FedAvg [16], significantly augmenting the intelligence of IoT systems across a multitude of applications [17]. The primary challenges of FL can be broadly classified into two categories: communication bottlenecks, resulting from the need to exchange large model's parameters between parties, and data heterogeneity, arising from the diversity of the data held by FL clients. This motivated some prior works to design more communication-efficient strategies such as local updates [18]\u2013[20], model compression [21], and adaptive communication [22]. Meanwhile, data heterogeneity concerned with clients' non-i.i.d. data has also been well-studied [23], [24].\nGrassmann manifold optimization has recently gained traction as an advanced mathematical tool in the fields of machine learning. This approach leverages the geometric properties of Grassmann manifolds, a space representing linear subspaces, to facilitate the analysis and understanding of high-dimensional data, thereby enabling efficient optimization and enhanced modeling in various machine learning and data analysis tasks [25]. In centralized learning, the optimization over Grassmann manifolds has been employed to enhance manifold learning and data classification, with applications extending to computer vision and speech recognition [26]\u2013[28]. In decentralized learning contexts, particularly in FL, Grassmann learning has not fully explored yet, making it a promising avenue for continued research and development.\nOwing to their inherent vulnerabilities, IoT systems require robust measures against malicious activities [29]. This need has propelled anomaly-based Intrusion Detection Systems (IDS) into the limelight, bolstered by the radical advancements in machine learning. Early research on anomaly-based IDS within IoT networks has been heavily centered around methodologies where data is consolidated onto a central server [30]\u2013[35], raising concerns related to privacy and cyber intrusions. The recent trend has veered towards the use of FL frame-works for network anomaly detection. For example, Nguyen et al. [36] developed a federated intrusion detection system using Recurrent Neural Network models that were trained on local gateways and then amalgamated into a single model. Similarly, Wang et al. [37] demonstrated how a feed-forward artificial neural network can augment detection performance. Mothukuri"}, {"title": "III. PROBLEM FORMULATION", "content": "We consider an IoT network comprised of a central global coordinator CO and a set of N IoT devices, each denoted\nPrincipal Component Analysis Revisiting: We first revisit the basics of PCA to formally define our method. PCA projects a given dataset X onto principal components ordered by the amount of variance they capture in the data [54]. Specifically, it seeks an optimal rank-k (k < d) matrix X that minimizes the reconstruction error $||X \u2013 X||_F$, where $|| ||_F$ denotes the Frobenius norm [55]. Typically, X is derived based on the singular value decomposition (SVD) of X, i.e., $X = UDV^T$, where $U \\in R^{dxd}$ is an orthonormal matrix containing the left singular vectors of X, $\\Sigma = diag(\\sigma_1,...,\\sigma_d)$ contains the singular values ($\\sigma_1 \\ge \\sigma_2 > ... > \\sigma_d$), and $V \\in R^{D \\times D}$ contains the right singular vectors of X. Let $U(k) \\in R^{d \\times k}$ be the first k columns of U and $\\Sigma_k = diag(\\sigma_1,...,\\sigma_k)$. We can rewrite the solution for X as\n$X = U(k)U(k)^TX$,\n(1)\nwhich can be interpreted as the projection of data matrix X onto the column space of U(k). The PCA problem can thus be formulated as an optimization problem as follows:\n$\\min_{U\\in R^{d\\times k}} ||(I \u2013 UU)X||_F$\ns.t. $UU = I$.\n(2)\nThe essence of this problem is to locate an orthogonal matrix U that minimizes the reconstruction error of X when projected onto the column space of U, resulting in a matrix $Z = U^TX \\in R^{k \\times D}$ provides a lower-dimensional representation of X.\nIn the context of developing ML-IDS for IoT networks, solving this PCA problem typically requires IoT devices to transmit their local data to a centralized server. While this approach offers a streamlined method for anomaly detection, it is"}, {"title": "Federated PCA via ADMM Consensus Optimization:", "content": "To address these concerns, we propose a federated approach for solving PCA on distributed datasets, namely FedPCA, which aims to collectively learn a common representation from all local datasets, X1, X2, ..., XN, without the CO directly accessing these datasets. We first introduce a set of local variables U1,..., UN, where U\u2081 is the local PCA matrix learned by client i. Then, we formulate a consensus optimization problem as follows:\n$\\min_{U_1,...,U_N} \\sum_{i=1}^{N} ||(I\u2013 U_iU_i^T)X_i||_F^2$\ns.t. $U_i = Z, \\forall i = 1, ..., N$,\n$U_iU_i^T = I, \\forall i = 1, . . ., N$,\n(3)\nwhere the first linear constraint enforces the \"consensus\" to a common low-rank matrix Z [56] for all local Ui. The second constraint ensures that the matrix Ui is orthonormal for every client keeping the distributed problem consistent with the classical centralized PCA. However, addressing the non-linearity introduced by this orthonormality constraint is a challenging task due to the non-convex nature of the problem. Here, we employ a surrogate technique, as introduced in [46], to handle the above non-linear constraint as follows.\n$h_i(U_i) = max \\{0, U_i^TU_i \u2013 I\\}^2$,\n(4)\nwhere the operators max and squared are component-wise. By reformulating the problem to the $h_i(U_i)$ function, we gently steer the optimization towards matrices Ui that approach orthonormality, making the landscape more tractable for iterative frameworks. We then have the problem (3) equivalent to the following:\n$\\min_{U_1,...,U_N} \\sum_{i=1}^{N} ||(I\u2013 U_iU_i^T)X_i||_F^2$\ns.t. $U_i = Z, \\forall i = 1, ..., N$\n$h_i(U_i) \\le 0, \\forall i = 1, ..., N$.\n(5)\nGiven the nature of problem (5) as a consensus optimization with linear constraints, we opt to utilize ADMM [11] for its resolution. The essence of this iterative framework is the alternating updates of primal and dual variables to achieve two main objectives: the U\u2081 across clients converge towards a common Z and the objective function is iteratively minimized. Applying this to our problem, we first construct the augmented Lagrangian function associated with the problem (5) as follows."}, {"title": "B. FedPCA using ADMM on Grassmann Manifold", "content": "Although FEDPE effectively addresses the proposed problem, we further extend its capacity by formulating FedPCA on Grassmann manifolds, denoted as FEDPG, to accelerate convergence. Notably, the orthonormality constraint utilized in (3) signifies that the parameters of (7) can be projected onto a Grassmann manifolds [25].\nOrthonormality meets the Grassmannian: The Grassmann manifold, denoted as G(n, d), represents a geometric space that encapsulates sets of d-dimensional subspaces within an overaching n-dimensional real or complex Euclidean space, subject to n > d > 0 [25]. The distinct of this manifold lies in its representation capacity: Any point on G(n,d) can be identified by an n \u00d7 d orthogonal matrix U whose column spans the corresponding subspace to ensure orthonormality $U^TU = I_d$. Hence, G(n, d) is defined as follows.\nG(n, d) = \\{span(U) : U \\in R^{n\\times d}, U^TU = I_d\\}\n(12)\nFedPCA via Grassmann Manifold Optimization: By fram-ing problem (3) within the Grassmann manifold, the augmented Lagrangian (6) evolves as follows.\n$\\mathcal{L}(\\{U\\}, Z, \\{Y\\}) = \\sum_{i=1}^{N} f_i(U_i) + \\sum_{i=1}^{N} (Y_i, U_i \u2013 Z)_F + \\sum_{i=1}^{N} \\frac{\\rho}{2} ||U_i - Z||_F^2$,\n(13)\nHere, the terms associated with $h_i(U_i)$ are eliminated because the inherent orthonormality constraints are satisfied.\nDenoting the local update for each client i at the k-th iteration by following:\n$F(U_i) := f_i(U_i) + (Y_i, U_i- Z)_F + \\frac{\\rho}{2} ||U_i - Z||_F^2$, (14)\nWe then recast the update rules for Ui and Z on the Grassmann manifold as follows.\n$U_i^{k+1} = arg \\min_{U_i} \\{F(U_i)\\}$\n(15)\nAs detailed in Alg. 2 (lines 5-8), projected gradient descent on the Grassmann manifold is applied in every local iteration in clients to find the update of $U_i^{k+1}$ in (15). Considering the definition of the Grassmann manifold in (12), we enforce the second constraint $U^TU_i = I$ by using the projected gradient descent on the Grassmann manifold (Alg. 2, line 8) as follows\n$U_i^{k+1} = R(U_i \u2013 \\eta \\nabla_U F(U_i))$,\n(16)\nHere, \u03b7 is the step size and $\\nabla_U F(U_i)$ is the gradient of F(U) at the point $U_i^k$, and the retraction function R(\u00b7) is the projection operation performed by QR decomposition [25]. The projection process for U and $U_i^{k+1}$ is graphically illustrated in Fig. 2. We compute the updates by projecting the Euclidean gradient onto the tangent space of the manifold using orthogonal projection $F(U_i) \\rightarrow \\nabla_U F(U_i)$ (Alg. 2,"}, {"title": "IV. FEDPCA: CONVERGENCE ANALYSIS", "content": "In this section, we present a theoretical analysis to understand the convergence properties of FEDPG and FEDPE within the FedPCA framework. To begin with, we consider an FL environment with N clients, indexed by i = 1, 2, ..., N, and introduce the following notations for the analyses:\nAlso:\n\nWe then have rewrite following for augmented Lagrangian (13).\n$\\mathcal{L}(\\{U\\}, Z, \\{Y\\}) = \\sum_{i=1}^{N} f_i(U_i) + \\sum_{i=1}^{N} Y_i (U_i - Z)  +\\frac{\\rho}{2} \\sum_{i=1}^{N} ||U_i - Z||^2$.\n(18)\n$\\mathcal{L} \\mathcal{L}_{u} = arg\\min_{U_i}\\{f_i(U) + Y_i(U_i - Z)_F +\\frac{\\rho}{2} \\sum_{i=1}^{N}||U_i - Z||^2 \\}$(20)\nWe have $Y^{k+1} = Y^k + \\rho_i(U^{k+1} - Z^{k+1})$(21)"}, {"title": "V. EXPERIMENTAL RESULTS", "content": "In this section, we first present the datasets, model settings and measures for performance assessment. Subsequently, to illustrate the efficacy of the proposed methods, we contrast FEDPE and FEDPG with various benchmark strategies within the context of an IDS deployment in IoT networks.\nIn our research, all experiments are conducted in a coding environment powered by an AMD Ryzen 3970X Processor with 64 cores and 256GB of RAM. Additionally, four NVIDIA GeForce RTX 3090 GPUs are employed to accelerate the training process. For software, we rely on Python 3 as our primary language, supplemented by advanced machine learning and optimization frameworks such as PyTorch [59] and Scikit-Learn [60].\n1) Datasets and Metrics: In this study, we employ the UNSW-NB15 [13] and TON-IoT Network [14] datasets. The former, a benchmark in network intrusion detection system (NIDS) research, encompasses a myriad of network traffic scenarios, with various attack types interlaced with normal activities commonly found in real-world network (internet) environments. The latter, TON-IoT, includes heterogeneous data sourced from Telemetry datasets of IoT and IIoT sensors, amassed through parallel processing to capture a spectrum of normal and cyber-attack events. Following preprocessing, from the UNSW-NB15 dataset, we utilized a training set of 56,000 normal samples and a test set comprising 20,000 normal and 45,332 abnormal samples, all with 39 numerical features. From the TON-IoT dataset, our training set consists of 114,956 normal samples, while the test set includes 10,000 normal samples and 56,557 abnormal samples, all with 49 numerical features.\nIn the setting of a host-based ML-IDS deployment, each IoT device functions as a localized ML-IDS, using its unique data to develop an anomaly detection model. This approach reflects the inherent diversity of traffic distribution across disparate clients, and to mimic this realistically, the comprehensive training set is equally subdivided into 100 individual client datasets, each representing non-identically distributed (non-i.i.d.) local data. This subdivision is achieved by grouping records based on the number of connections that contain the same service (ct_srv_src) for UNSW-NB15 and the range of source ports (srcports) for TON-IoT.\n2) Baselines: In order to highlight the efficacy of FEDPE and FEDPG in IoT network anomaly detection, we conduct a comprehensive comparative study against a variety of unsupervised techniques including:\n3) Performance Metrics: In this work, we are primarily concerned with identifying anomalies in network traffic."}, {"title": "VI. CONCLUSION", "content": "In this study, we analyze the convergence of the federated PCA framework on the Grassmann manifold, thereby enhancing efficient unsupervised anomaly detection in IoT networks with realistic datasets. The proposed framework empowers IoT devices to collaboratively create a profile of normal network traffic while abstaining from the exchange of local data. Specifically, we devise FEDPE, an innovative federated algorithm that approximates PCA utilizing the principle of ADMM and is accompanied by theoretical guarantees. We further conceptualize the federated PCA via Grassmannian optimization and propose another algorithm, FEDPG. This algorithm is geared towards ensuring a swift training process and early anomaly detection, even within computing environ-ments that are resource-constrained. Through our experimental evaluations, we establish the adaptability of FEDPE and FEDPG to the IoT environment and demonstrate their superior performance over conventional approaches when tested on the UNSW-NB15 and TON-IoT datasets."}, {"title": "VII. BIOGRAPHY SECTION", "content": "No content."}]}