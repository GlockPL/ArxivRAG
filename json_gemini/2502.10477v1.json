{"title": "Knowledge Integration Strategies in Autonomous Vehicle Prediction and Planning: A Comprehensive Survey", "authors": ["Kumar Manas", "Adrian Paschke"], "abstract": "This comprehensive survey examines the integration of knowledge-based approaches into autonomous driving systems, with a focus on trajectory prediction and planning. We systematically review methodologies for incorporating domain knowledge, traffic rules, and commonsense reasoning into these systems, spanning purely symbolic representations to hybrid neuro-symbolic architectures. In particular, we analyze recent advancements in formal logic and differential logic programming, reinforcement learning frameworks, and emerging techniques that leverage large foundation models and diffusion models for knowledge representation. Organized under a unified literature survey section, our discussion synthesizes the state-of-the-art into a high-level overview, supported by a detailed comparative table that maps key works to their respective methodological categories. This survey not only highlights current trends-including the growing emphasis on interpretable AI, formal verification in safety-critical systems, and the increased use of generative models in prediction and planning-but also outlines the challenges and opportunities for developing robust, knowledge-enhanced autonomous driving systems.", "sections": [{"title": "I. INTRODUCTION", "content": "Autonomous driving has evolved into a complex and multifaceted research field. Vehicles' safe and efficient operation relies on accurately anticipating and planning motions in real-time. While significant progress has been made in simulation environments, the true challenge lies in transitioning automated vehicles from controlled simulations to the unpredictable real world. In real-world scenarios, vehicles must contend with a wide variety of situations, including unforeseen behaviors and novel circumstances. While effective in structured environments, rule-based systems often require adaptation to accommodate dynamic traffic conditions. On the other hand, machine learning (ML)-based solutions, though powerful, typically demand extensive amounts of data and can struggle when deployed in out-of-distribution scenarios or unfamiliar domains. Unlike machines, human drivers excel in such situations by leveraging a combination of rules, knowledge, and general driving intuition to make informed decisions. Integrating such human-like reasoning-infusing rules and domain knowledge-into the autonomous driving pipeline could enhance the system's accuracy, robustness, and ability to handle new or unexpected scenarios. Two critical components in this domain are trajectory prediction and trajectory planning. In our context, trajectory prediction refers to the process of forecasting the future paths of other traffic agents based on observed historical data and contextual information such as road geometry, dynamic interactions, and regulatory constraints. Trajectory planning, on the other hand, involves generating a feasible and optimal motion path for the controlled (ego) vehicle that satisfies safety, legal, and comfort constraints while taking into account the anticipated behavior of other road users.\nDespite numerous surveys addressing various aspects of autonomous driving-from computer vision and object detection to deep reinforcement learning and semantic segmentation-there remains a notable gap in comprehensive reviews focusing specifically on integrating explicit knowledge representations into trajectory prediction and planning. In particular, there is a lack of surveys examining recent foundation and diffusion model-based methodologies. These emerging approaches have gained traction due to their ability to leverage vast amounts of unstructured data and advanced generative techniques to produce precise and adaptable predictions. They can embed traffic rules and environmental constraints either implicitly within learned representations or explicitly through integrated symbolic reasoning, thereby enhancing both interpretability and performance in complex driving scenarios.\nThis survey is driven by several key observations:\n\u2022 Fragmented Literature: Previous reviews have explored trajectory prediction and planning [1]. However, they rarely holistically integrate these tasks under frameworks combining traditional methods with modern generative techniques and extensive domain knowledge. We examine"}, {"title": "II. LITERATURE SURVEY", "content": "This section presents a high-level overview of the diverse methodologies proposed for integrating domain knowledge, traffic rules, and commonsense reasoning into autonomous driving systems. Our survey is organized into several subsections-ranging from Knowledge-Graph and Ontology-Based Methods, Reinforcement Learning (RL) methods, and Large Language Model (LLM) approaches to Formal Logic-Based and Hybrid Neuro-Symbolic Methods that collectively cover the spectrum of current research. To guide the reader through these varied approaches, provides a compact, comparative summary of the key works discussed in this survey.\n\nA. Knowledge-Graph and Ontology-Based Methods\nRecent advancements in autonomous driving have highlighted the importance of structured knowledge representation using ontologies and knowledge graphs (KGs) to model complex urban environments, enhance prediction accuracy, and enable rule-compliant planning. These frameworks provide explicit semantic representations of static road elements (e.g., lanes, traffic signs), dynamic interactions (e.g., vehicle-pedestrian relationships), and regulatory constraints, enabling interpretable reasoning across heterogeneous data sources.\nEarly works demonstrated the potential of ontology-based reasoning for driving scenarios. [3] pioneered a scenario-adaptive approach using Web Ontology Language (OWL) to formalize spatial states and vehicle-road relationships, integrating these with hidden Markov models for maneuver prediction. At the same time, their method improves prediction horizons through domain knowledge and manual ontology engineering limits scalability. Similarly, [4] developed intersection-specific ontologies with rule-based decision-making, and [5] established a framework for querying static and dynamic traffic semantics in real-time. These studies underscore the trade-off between interpretability and adaptability: rule-based ontologies excel in structured environments like intersections [4] but struggle with unseen scenarios.\nSemanticFormer [6] improves autonomous driving trajectory prediction by considering traffic participants, road topology, and signs, enhancing performance by 4-5% when added to existing trajectory predictors. Hybrid methods combining ontologies with probabilistic models address uncertainty inherent in traffic interactions. [7] merged high-level traffic coordination ontologies with low-level trajectory models, while [8] integrated description logic with probabilistic semantics to handle incomplete information. [9] extended this by encoding interaction probabilities for long-term behavior prediction, though computational delays hindered real-time control. [10] augmented scene understanding by integrating KGs extracted from textual corpora, enabling causal reasoning for novel scenarios. However, offline knowledge curation in their approach limits responsiveness to dynamic environments.\nOntologies also support real-time decision-making through hierarchical reasoning. [11] leveraged driving experience knowledge bases for situation estimation, while [12] modeled critical factors via joint description logic and rule-based reasoners. These methods enhance transparency in regulatory compliance, but face scalability challenges as ontology complexity grow [5]. A comprehensive survey by [13] emphasizes that while ontological frameworks improve interoperability and rule awareness, their rigidity complicates adaptation to unexpected events.\nCurrent research focuses on mitigating manual engineering burdens through standardization and automation. Domain-specific ontologies like ASAM OpenXOntology\u00b9 provide reusable templates for traffic concepts, reducing development efforts [14], [15]. Promisingly, Large Language Models (LLMs) are being explored for semi-automated KG generation [16], potentially enabling dynamic knowledge integration with sensor data. Such advances aim to balance the interpretability of symbolic reasoning with the adaptability of data-driven methods, addressing long-standing challenges in real-time performance and scalability [9], [13].\nB. Reinforcement Learning (RL) Methods\nReinforcement learning (RL) has emerged as a powerful paradigm for developing autonomous driving systems, enabling sequential decision-making through dynamic environment interactions. By integrating safety constraints, regulatory compliance, and structured domain knowledge into reward functions and state representations, RL frameworks excel in learning adaptive policies for complex driving scenarios. Recent advancements in this domain focus on curriculum learning, safety-centric reward design, and sim-to-real transfer"}, {"title": "C. Large Language Model and Retrieval-Augmented Generation Methods", "content": "Large language models (LLMs) and retrieval-augmented generation (RAG) techniques have emerged as transformative tools in autonomous driving. They use unstructured text and regulatory data to improve decision-making, adaptability, and interpretability. These methods enable systems to incorporate vast knowledge repositories dynamically, generate human-readable explanations, and adapt to region-specific traffic laws, addressing key challenges in prediction and planning.\nA prominent application of LLMs is their ability to interpret and adapt to traffic regulations in real-time. LLaDA (Large Language Driving Assistant) [24] exemplifies this capability, using LLMs to adapt driving behavior to new environments, customs, and laws. By interpreting traffic rules from local driver handbooks, LLaDA provides context-aware driving instructions and demonstrates zero-shot generalization. Similarly, [25] propose a framework where a Traffic Regulation Retrieval Agent employs RAG to query regional traffic documents, and an LLM-based reasoning module evaluates maneuvers for compliance and safety. While this approach dynamically adapts to region-specific laws and generates rule-referenced explanations, it faces latency and LLM hallucination challenges. The TR2MTL framework [26] further advances this paradigm by using LLMs in a chain-of-thought learning paradigm to translate natural language traffic rules into metric temporal logic formulas, reducing manual rule specification and enabling scalable regulatory updates.\nLLMs are increasingly integrated with multimodal data to enhance perception and decision-making. DriveGPT4 [27] represents an end-to-end system that generates driving decisions directly from sensory inputs, providing natural language explanations for its trajectory predictions. This approach improves interpretability and generalization in novel environments. Mao et al. [28] further contribute by developing a language agent that fuses textual reasoning with visual perception, retrieving relevant rule excerpts and synthesizing actionable driving strategies. Industry efforts, such as Waymo's EMMA model [29], highlight the potential of multimodal LLMs like Google's Gemini to process sensor data and predict future trajectories, signaling a shift toward LLM-centric autonomous systems.\nRecent works explore using LLMs as central decision-making components in autonomous driving. DriveLLM [30] charts a comprehensive roadmap for integrating LLMs into fully autonomous driving systems, emphasizing their role in high-level reasoning, planning, and interaction with dynamic environments. By leveraging LLMs' generative and contextual understanding capabilities, DriveLLM demonstrates how these models can enhance adaptability and interpretability in complex driving scenarios. Similarly, LanguageMPC [31] proposes a framework where LLMs serve as decision-makers within a model predictive control (MPC) pipeline. This approach combines the reasoning capabilities of LLMs with the robustness of traditional control methods, enabling the system to generate human-like driving strategies while ensuring safety and compliance. Both frameworks highlight the potential of LLMs to bridge the gap between high-level reasoning and low-level control. However, challenges such as real-time performance and integration with existing systems remain.\nLLMs and RAG techniques are also employed to augment reasoning with commonsense and regulatory knowledge. [10] utilize dense retrieval mechanisms and LLMs to answer domain-specific questions about traffic scenarios, implicitly integrating background knowledge into decision-making. The \"Drive Like a Human\" framework [32] enhances generalization and interpretability by combining LLM-generated high-level context descriptions with neural perception modules. RAG-Driver [33] extends this concept by employing a multimodal LLM for driving explanations and control predictions,"}, {"title": "D. Formal Logic-Based Methods", "content": "Formal logic-based methods have become a cornerstone in autonomous driving research, offering rigorous frameworks for monitoring, verification, prediction, and planning through mathematically grounded representations of traffic rules and safety requirements. A central theme in this work is the formalization of traffic regulations using temporal logic and answer set programming (ASP). For instance, [35] formalizes traffic rules at uncontrolled intersections by encoding yielding and right-of-way as temporal logic formulas, ensuring that vehicle behaviors adhere to safe bounds even though extending this approach to complex urban scenarios remains challenging. Similarly, AUTO-DISCERN [36] employs ASP via the goal-directed s(CASP) system to simulate commonsense reasoning in driving decisions. By encoding driving rules as explicit logical constraints and generating proof trees to justify maneuvers, AUTO-DISCERN achieves high interpretability while grappling with scalability issues and sensor noise.\nAnother emerging direction involves integrating formal logic with data-driven techniques to enhance robustness in trajectory prediction. RuleFuser [37] exemplifies this trend by combining neural predictors with classical rule-based predictors; here, formal logic is used to represent traffic rules that guide predictions in out-of-distribution scenarios. In a related effort, the TR2MTL framework [26] leverages large language models (LLMs) to automatically translate unstructured natural language traffic rules into metric temporal logic (MTL) formulas. By employing a chain-of-thought in-context learning strategy, TR2MTL reduces manual rule formalization, although its performance is sensitive to prompt design and input quality.\nFormal logic is also employed to enhance situational awareness and decision-making. [38] apply ASP-based reasoning to model and assess driver situation awareness in semi-autonomous vehicles, formalizing scene interpretation as logical rules that verify correct perception and reaction to dynamic traffic conditions. Complementing these approaches works such as [39], [40] integrate set-based reachability analysis with convex optimization to plan safe trajectories that comply with legal driving standards, albeit with challenges in accurately modeling the behavior of other road users in unpredictable environments.\nFurther reinforcing the role of formal methods, safety verification techniques based on differential dynamic logic [41] have been applied to prove the safety of vehicle control systems under varied driving conditions. Such methods, along with survey works like [23], illustrate that while formal logic-based approaches provide strong guarantees and a high level of interpretability, they often face challenges in terms of computational complexity, scalability, and real-time integration of continuous changing sensor inputs.\nDefeasible Deontic Logic (DDL) has been applied to formalize traffic rules, enabling autonomous vehicles to reason about obligations, permissions, and prohibitions in dynamic driving environments. By encoding traffic regulations using DDL [42], [43], vehicles can predict trajectories that comply with legal and ethical standards while also accommodating exceptions and resolving conflicts among rules. This approach enhances the interpretability and adaptability of trajectory prediction systems, allowing for more nuanced decision-making in complex traffic scenarios. However, implementing DDL in real-time applications poses challenges due to its computational complexity and the need for comprehensive rule databases. Balancing the expressiveness of DDL with the efficiency required for real-time trajectory prediction remains a critical area for further research.\nIn practice, many of these formal logic-based methods are integrated into hybrid and optimization-based models. Formal logic offers a versatile toolkit for ensuring provably safe and compliant autonomous driving behaviors, whether employed as constraints in loss functions, integrated into reinforcement learning reward structures, or used in optimization layers for planning. Despite their promise, ongoing research continues to address the trade-offs between the rigor of formal methods and the need for real-time, scalable performance in dynamic driving environments.\n1) Formal Logic in MPC and Optimization: Model Predictive Control (MPC) is a widely adopted optimization-based control strategy in autonomous driving. It solves an optimal control problem over a finite receding horizon to generate trajectories that account for both current sensor data and predicted future states. This approach translates traffic rules into mathematical inequalities or cost functions directly embedded into optimization-based planning frameworks. By formulating safety rules as constraints within MPC, recent"}, {"title": "E. Hybrid Approaches Combining Symbolic and Neural Methods", "content": "Hybrid approaches for autonomous driving have evolved by fusing the adaptability of neural networks with the rigor and interpretability of symbolic reasoning. Such methods aim to leverage the pattern recognition power of deep learning while enforcing explicit, rule-based constraints, ultimately improving safety, robustness, and explainability. These approaches can be broadly grouped by their integration strategy.\nOne prominent strand couples deep neural perception pipelines with symbolic reasoning modules. For example, AUTO-DISCERN [36] processes sensory inputs through deep networks whose features feed into an answer set programming-based module (via the goal-directed s(CASP) system) to apply commonsense rules and enforce driving behaviors. Similarly, the framework in [61] combines explicitly encoded traffic rules with learning-based trajectory predictors; here, the symbolic component acts as a constraint, guiding the neural network towards rule-compliant predictions while reducing the data requirements.\nA second category focuses on integrating symbolic knowledge directly into the learning process. In [49], symbolic constraints are injected into the loss functions and network architectures, enhancing robustness in rare or hazardous scenarios. This idea is further developed in [50], where formal rules expressed as temporal logic is incorporated in a differentiable manner, penalizing non-compliant predictions. In a related effort, [58] employs signal temporal logic and syntax trees as features within a generative adversarial network framework to improve trajectory prediction accuracy without biasing the system away from lawful behavior.\nA recent trend leverages large language models (LLMs) to bridge high-level symbolic reasoning and sensor-driven perception. For instance, [32] utilizes an LLM to generate high-level symbolic descriptions of the driving context, which are then fused with deep learning-based sensor interpretations. Building on this concept, DILU [51] automatically generates symbolic rules from unstructured data via LLMs and integrates them into the decision-making pipeline. Although promising, these systems still face challenges such as LLM hallucinations, integration latency, and the synchronization of subsymbolic and symbolic processing streams.\nComplementing these technical approaches, several surveys and alternative frameworks provide a broader perspective on the hybrid paradigm. Reviews in [52] and the survey on hybrid motion planning [53] underscore the potential of embedding domain knowledge into learning-based systems to enhance safety and interpretability. Additional work such as [40] employs set-based prediction methods\u2014using formalized traffic rules and nondeterministic motion models to perform reachability analysis for collision avoidance, while neural-symbolic methods like Logic Tensor Networks [54] and DeepProbLog [55] offer frameworks for integrating logical constraints into deep learning models.\nFinally, specialized systems have been designed to address real-time adaptability and conflict resolution. For example, [56] formalizes explicit traffic rules to rule out infeasible maneuvers, and [57] combines incremental symbolic perception with reactive control synthesis to generate verified, rule-compliant driving maneuvers in dynamic environments.\nIn summary, hybrid approaches that integrate symbolic and neural methods offer significant advantages by combining explicit rule-based reasoning with the flexibility of deep learning. While these methods enhance interpretability and safety in complex driving scenarios, challenges remain in managing computational complexity, ensuring real-time performance, and effectively synchronizing heterogeneous components."}, {"title": "1) Diffusion and Other Learning-Based Prediction Incorporating Traffic Rules:", "content": "Diffusion-based models have recently shown promising results in generating rule-compliant trajectories while adhering to user-defined constraints. These models can encode traffic rules as STL within the diffusion process [59] or integrate control barrier functions and Lupanov function-based reachability encoding [60]. Diffusion models are particularly effective at capturing multimodal distributions and generating diverse trajectories while maintaining constraint satisfaction. However, they often require careful design to balance stochastic exploration with rule adherence.\nBeyond purely formal and optimization-based approaches, learning-based trajectory prediction has increasingly incorporated explicit traffic rules and regulatory constraints. These methods enhance deep neural models by embedding formal rules into loss functions or input representations, ensuring predicted trajectories optimize performance while complying with safety and legal standards. For example, RuleFuser [37] demonstrates that combining symbolic reasoning with data-driven predictors improves robustness in out-of-distribution scenarios. Similarly, approaches that integrate temporal logic constraints into the training process [50] yield dynamically feasible and rule-compliant trajectories.\nSince we focus on representing traffic rules and integrating them into learning-based methods, our approach aligns closely with hybrid methods that blend formal constraints with data-driven models."}, {"title": "III. DISCUSSION AND FUTURE DIRECTIONS", "content": "This survey systematically reviews methodologies for trajectory prediction and planning in autonomous driving. We define trajectory prediction as forecasting agents' future paths using historical and contextual data and trajectory planning as generating safe, collision-free paths for the ego vehicle under regulatory constraints. Our analysis spans classical methods (e.g., geometric models, optimization-based strategies) to modern hybrid frameworks merging symbolic reasoning with deep neural networks.\nA central focus lies in emerging foundation model- and diffusion model-based approaches, which leverage unstructured data and generative mechanisms to encode traffic dynamics or explicitly integrate domain knowledge implicitly. These methods show promise in enhancing prediction accuracy and planning robustness in complex scenarios, signaling a paradigm shift in autonomous systems. Our review equips researchers with methodologies to address prediction-planning challenges while balancing safety, efficiency, and goal achievement.\nCritical challenges persist. Future work must resolve real-time performance in dynamic environments, improve the interpretability of deep learning systems, and unify heterogeneous data streams (e.g., sensor inputs and traffic rules). The scalability and adaptability of foundation/diffusion models in diverse driving conditions require further validation. Multimodal reasoning and formal safety guarantees-particularly for handling nuanced, conflicting rules and hierarchical regulatory frameworks-will grow in importance.\nIn summary, by synthesizing state-of-the-art methods across different paradigms, this survey highlights the current capabilities and limitations in trajectory prediction and planning. It lays out a roadmap for future investigations. Advancements in integrating explicit knowledge-whether through symbolic reasoning, hybrid models, or generative approaches-will be crucial in developing the next generation of autonomous driving systems that are both safe and efficient in real-world operations. By diligently advancing knowledge representation techniques and fostering synergistic combinations of different approaches, we can pave the way for more intelligent, trustworthy, and ultimately safer autonomous vehicles that can seamlessly and reliably navigate the full spectrum of real-world driving complexities."}]}