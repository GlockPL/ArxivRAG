{"title": "Multi-Modal Attention Networks for Enhanced Segmentation and Depth Estimation of Subsurface Defects in Pulse Thermography", "authors": ["Mohammed Salah", "Naoufel Werghi", "Davor Svetinovic", "Yusra Abdulrahman"], "abstract": "AI-driven pulse thermography (PT) has become a crucial tool in non-destructive testing (NDT), enabling automatic detection of hidden anomalies in various industrial components. Current state-of-the-art techniques feed segmentation and depth estimation networks compressed PT sequences using either Principal Component Analysis (PCA) or Thermographic Signal Reconstruction (TSR). However, treating these two modalities independently constrains the performance of PT inspection models as these representations possess complementary semantic features. To address this limitation, this work proposes PT-Fusion, a multi-modal attention-based fusion network that fuses both PCA and TSR modalities for defect segmentation and depth estimation of subsurface defects in PT setups. PT-Fusion introduces novel feature fusion modules, Encoder Attention Fusion Gate (EAFG) and Attention Enhanced Decoding Block (AEDB), to fuse PCA and TSR features for enhanced segmentation and depth estimation of subsurface defects. In addition, a novel data augmentation technique is proposed based on random data sampling from thermographic sequences to alleviate the scarcity of PT datasets. The proposed method is benchmarked against state-of-the-art PT inspection models, including U-Net, attention U-Net, and 3D-CNN on the Universit\u00e9 Laval IRT-PVC dataset. The results demonstrate that PT-Fusion outperforms the aforementioned models in defect segmentation and depth estimation accuracies with a margin of 10%.", "sections": [{"title": "I. INTRODUCTION", "content": "OVER the recent years, the growing demand for quality control drove the emergence of advanced inspection processes in various production lines, such as the aerospace [1], [2] automotive [3], [4], and construction [5] industries. This paradigm shift led to the adoption of Non-Destructive Testing (NDT) techniques to detect subsurface defects and assess the structural integrity of industrial components. As a result, a large spectrum of NDT techniques have been developed to detect subsurface defects, such as radiography, ultrasonic testing, and infrared thermography (IRT) [6]. IRT has garnered significant attention due to its simplicity, low cost, and non-contact nature. These advantages have demonstrated the potential of IRT for inspection of aircraft parts [2], [7]\u2013[9], construction pipelines [5], [10]\u2013[12], and artworks [13], [14]. Among IRT inspection techniques, pulse thermography (PT) is valued for its efficiency in inspecting large areas and its capability to rapidly identify subsurface defects [15]. Meanwhile, recent advancements in artificial intelligence (AI) have been adopted in PT setups to enhance inspection accuracies. For instance, AI-driven PT inspection algorithms have been proposed for defect classification [16], [17], segmentation [18], [19], and depth estimation [2], [20]. State-of-the-art PT inspection methods feed AI models compressed thermographic sequences using principal component analysis (PCA) [21] or thermographic signal reconstruction (TSR) [22] for defect characterization. While these methods demonstrated considerable potential, treating PCA and TSR as two independent modalities limits the performance of PT inspection models. For instance, PCA tends to enhance defect visibility while TSR models the temporal evolution of the pixel responses. To address this limitation, this work introduces PT-Fusion, a multi-modal attention-based fusion network that fuses both PCA and TSR complementary representations for segmentation and depth estimation of subsurface defects in PT setups. The contributions of the paper are the following:\n1) PT-Fusion network architecture is proposed for defect segmentation and depth estimation in pulse thermography setups.\n2) Novel feature fusion modules, Encoder Attention Fusion Gate (EAFG) and Attention Enhanced Decoding Block (AEDB) are proposed to fuse PCA and TSR representations for enhanced segmentation and depth estimation of subsurface defects.\n3) A novel data augmentation technique is introduced, leveraging random sampling from thermographic sequences to overcome the burden of complex PT data collection setups.\n4) The proposed work is tested on the IRT-PVC dataset and benchmarked against state-of-the-art PT inspection models. The results demonstrate that PT-Fusion outperforms U-Net, attention U-Net, and 3D-CNN architectures in segmentation and depth estimation accuracies.\nPulse thermography (PT) has established itself as a key NDT technique for the detection of subsurface defects in"}, {"title": "II. PRELIMINARIES", "content": "A typical PT setup is shown in Fig. 1. PT involves a flash lamp providing a heat pulse into a target specimen [41]. If the specimen is sound, all pixels approximately generate the same thermal profile. In the presence of defects, heat gets trapped, generating an abnormal thermal distribution that is captured over time by the thermal camera. Consequently, the acquired thermal images are pre-processed using the methods discussed in section II-B and are utilized as inputs to PT-Fusion.\nSeveral public datasets are available following the general PT setup discussed in section II-A. In this work, PT-Fusion is trained and tested on the IRT-PVC dataset [20]. The dataset comprises 38 inspection sequences of 3D-printed PVC specimens with back-drilled holes at different depths ranging between 0 and 2.5 mm. Each inspection sequence $S_{i} = \\{I_{k}\\}_{k=1}^{N_{t}}$ is a 3D matrix of shape $(N_{t}, N_{y}, N_{x})$ with $I_{k}$ thermograms, where $k = 1,2,..., N_{t}$ is the image timestamp, i represents the sample index, $N_{y}$ is the image height, and $N_{x}$ is its width. $S_{i}$ is reshaped to $(N_{t}, N_{y} \\times N_{x})$ by a raster-like operation and standardized by"}, {"title": null, "content": "$\nS_{i} =\n\\frac{S_{i}-\\mu_{\\sigma}}{\\sigma_{k}}\n$"}, {"title": null, "content": "$\n\\mu_{k}=\\frac{1}{N_{t}}\\sum_{k=1}^{N_{t}}S_{i}^{(k)},\n$"}, {"title": null, "content": "$\n\\sigma_{k}^{2}=\\frac{1}{N_{t}-1}\\sum_{k=1}^{N_{t}}(S_{i}^{(k)}-\\mu_{k})^{2},\n$"}, {"title": null, "content": "$\nln (\\Delta T) = a_{0} + a_{1} ln (t) + a_{2} ln (t)^{2}\n        + a_{3} ln (t)^{3} + a_{4} ln (t)^{2} + a_{5} ln (t)^{5},\n$"}, {"title": "III. METHODOLOGY", "content": "PT-Fusion integrates the complementary features of PCA, $P_{i}$, and TSR, $T_{i}$. Generally, the direct approach for fusing both modalities is by either concatenating them at the input or concatenating their feature maps in the intermediate layers. However, the network, in such cases, does not inherently learn the weighted contribution of these modalities, limiting its performance. Instead, PT-Fusion adaptively fuses both representations using the proposed attention-based fusion modules, EAFG and AEDB.\nPT-Fusion, illustrated in Fig. 3, follows a U-Net encoder-decoder architecture [42] and involves passing $P_{i}$ and $T_{i}$ through two parallel CNN heads to extract feature maps from both modalities. Each CNN head consists of m encoder layers, where m = 1, 2, ..., M. Each layer, see Fig. 4, feeds its input through a learnable residual convolution with a downsampling max pooling operation as"}, {"title": null, "content": "$\nF_{m}^{p} = ResidualConv(MaxPool(F_{m-1}^{p}))\n$"}, {"title": null, "content": "$\nF_{m}^{t} = ResidualConv (MaxPool(F_{m-1}^{t}))\n$"}, {"title": null, "content": "$\n\\alpha_{M} = \\sigma(W_{M}^{1f}(F_{M}^{p})),\n$"}, {"title": null, "content": "$\nF_{M}^{f} = \\alpha_{M} F_{M}^{p} + (1 - \\alpha_{M}) \\otimes F_{M}^{t}\n$"}, {"title": null, "content": "$\nD'_{m} = W_{m}^{dm} (D_{m-1}),\nF'_{m} = W_{m}^{fm} (F_{m}^{f}).\n$"}, {"title": null, "content": "$\n\\psi_{m} = \\sigma (W_{m}^{f} (ReLU(D'_{m} + F'_{m})));\n$"}, {"title": null, "content": "$\nD_{m} = D_{m-1} \\otimes \\psi_{m}.\n$"}, {"title": "B. Data Augmentation", "content": "As the IRT-PVC dataset comprises 38 inspection sequences, the dataset size is scarce and training the deep architecture of PT-Fusion remains challenging. While traditional augmentation techniques, such as random rotations, translations, and shearing, introduce spatial variability, they fall short in addressing the spatiotemporal nature of thermographic data. These sequences require augmentations that account for both spatial and temporal dimensions to effectively enhance dataset diversity. Therefore, this work proposes a spatiotemporal augmentation strategy, illustrated in Algorithm 1, to address this limitation. The proposed method involves three steps. First, subsets of thermographic sequences are randomly sampled from the original inspection sequences to introduce temporal variability. Second, additive Gaussian noise is applied on the randomly sampled sequences to further augment the dataset temporally. Finally, PCA and TSR tensors are generated from the randomly sampled sequences as new training samples in the expanded dataset. During training, traditional spatial augmentation techniques are applied dynamically on the generated tensors to enhance generalizibility of the network."}, {"title": null, "content": "$\nS'_{i,n} = \\{I'_{r_{1}},..., I'_{r_{n}} | r_{n} \\sim Uniform(min(\\hat{S}_{i,n}), max(\\hat{S}_{i,n}))\\}\n$"}, {"title": null, "content": "$\nS^{noisy}_{i,n} = S'_{i,n} + \\eta, \\eta \\sim N(0, \\sigma^{2}),\n$"}, {"title": "IV. EXPERIMENTS", "content": "Given the training, validation, and testing splits, the two variants of PT-Fusion are tested on the unaugmented testing dataset in two corresponding testing routines. The first variant is trained to segment defects to different depth classes; thereby, multi-class segmentation, see section IV-B. For such type of problem, the common evaluation metrics, mean Intersection over Union mIoU, Recall, and Precision, are employed for evaluation and are defined by"}, {"title": null, "content": "$\nmIoU = \\frac{1}{C} \\sum_{c=1}^{C} \\frac{P_{G_{c}}}{P \\cup G_{c}}\n$"}, {"title": null, "content": "$\nRecall = \\frac{1}{C} \\sum_{c=1}^{C} \\frac{TP_{c}}{TP_{c} + FN_{c}}\n$"}, {"title": null, "content": "$\nPrecision = \\frac{1}{C} \\sum_{c=1}^{C} \\frac{TP_{c}}{TP_{c} + FP_{c}},\n$"}, {"title": null, "content": "$\nIoU = \\frac{P \\cap G}{P \\cup G}\n$"}, {"title": null, "content": "$\nMAE = \\frac{1}{N} \\sum_{i=1}^{N}|Y_{i} - Y_{i,d}|,\n$"}, {"title": "V. CONCLUSION", "content": "Infrared thermography (IRT) became prominent in the field of NDT, enabling the detection of subsurface defects in industrial components. Particularly, pulse thermography (PT) is valued for its efficiency and fast nature. Current state-of-the-art PT inspection methods rely on PCA and TSR independently as image modalities to train defect segmentation and depth estimation learning-based PT inspection models. This limits the performance of the trained networks as these representations possess complementary semantic features. Thus, this work proposes PT-Fusion, a multi-modal attention network that fuses PCA and TSR for enhanced segmentation and depth estimation of subsurface defects. The network architecture introduces two fusion modules, namely, Encoder Attention Fusion Gate (EAFG) to adaptively learn the weighted contributions of the input representations and Attention Enhanced Decoding Block (AEDB) to dynamically fuse the encoded features with outputs of the PT-Fusion decoders. In addition, due to the scarcity of PT datasets, a novel spatiotemporal data augmentation technique is proposed to mitigate this challenge and facilitate training of PT-Fusion. The network is tested on the Universit\u00e9 Laval IRT-PVC dataset for defect segmentation and depth estimation. PT-Fusion is also benchmarked against state-of-the-art PT network architectures, such as U-Net, attention U-Net, and 3D-CNN. The results demonstrate that PT-Fusion outperforms the aforementioned models with an IoU of 0.882 and depth estimation error of 0.0082 mm. Future research efforts will be directed towards extending PT-Fusion to lock-in thermography setups and inspection of other materials such as CFRP and PLA. In addition, experimental studies will be conducted on the efficacy of self and cross-attention mechanisms during the inspection of materials with varying thermal conductivities."}]}