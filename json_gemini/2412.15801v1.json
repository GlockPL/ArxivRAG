{"title": "Bi-directional Mapping of Morphology Metrics and 3D City Blocks for Enhanced Characterization and Generation of Urban Form", "authors": ["Chenyi Cai", "Biao Li", "Qiyan Zhang", "Xiao Wang", "Filip Biljecki", "Pieter Herthogs"], "abstract": "Urban morphology, examining city spatial configurations, links urban design to sustain-ability. Morphology metrics play a fundamental role in performance-driven computational urban design (CUD) which integrates urban form generation, performance evaluation and optimization. However, a critical gap remains between performance evaluation and com-plex urban form generation, caused by the disconnection between morphology metrics and urban form, particularly in metric-to-form workflows. It prevents the application of optimized metrics to generate improved urban form with enhanced urban performance. Formulating morphology metrics that not only effectively characterize complex urban forms but also enable the reconstruction of diverse forms is of significant importance. This paper highlights the importance of establishing a bi-directional mapping between morphology metrics and complex urban form to enable the integration of urban form generation with performance evaluation. We present an approach that can 1) formulate morphology metrics to both characterize urban forms and in reverse, retrieve diverse similar 3D urban forms, and 2) evaluate the effectiveness of morphology metrics in rep-resenting 3D urban form characteristics of blocks by comparison. We demonstrate the methodology with 3D urban models of New York City, covering 14,248 blocks. We use neural networks and information retrieval for morphology metric encoding, urban form clustering and morphology metric evaluation. We identified an effective set of morphol-ogy metrics for characterizing block-scale urban forms through comparison. The pro-posed methodology tightly couples complex urban forms with morphology metrics, hence it can enable a seamless and bidirectional relationship between urban form generation and optimization in performance-driven urban design towards sustainable urban design and planning.", "sections": [{"title": "1. Introduction", "content": "Urban form, or the spatial structure of cities, is typically examined as the physi-cal spatial configuration within urban spaces (Lynch and Rodwin, 1958; Kropf, 2009; Chiaradia, 2019). Urban morphology \u2014 the study of urban form \u2014 focuses on how the physical form and structure of cities are shaped and organized. It examines the patterns and layouts of buildings, open spaces, streets and other elements that make up the built environment (Moudon, 1997; Scheer, 2016; Kropf, 2018). The morphological approach seeks to understand the relationship between physical urban form patterns and a range of issues regarding urban social, economic, and environmental sustainability (Jabareen, 2006; Ratti et al., 2003). Urban morphology exhibits strong relationships with urban performance evaluations such as micro-climate, heat and energy, mobility resilience, and the entire social-economic-technological fabric of urban systems (Zhou et al., 2022; Mash-hoodi and Unceta, 2024; Rode et al., 2014; Lee et al., 2016; Bramley and Power, 2009). Therefore, effectively representing the characteristics of urban form is crucial for linking urban design with performance evaluations.\nMorphology metrics, the representations of urban form characteristics, are fundamen-tal to understanding the urban morphology of the built environment and to generating urban forms for sustainable development (Dibble et al., 2019; Zhang et al., 2023). Effec-tive morphology metrics facilitate both the analysis of existing forms and the generation of future designs, enabling a holistic approach to urban planning and design. They provide quantifiable measures of urban form that can be linked to various urban performance evaluations. For instance, solar and energy efficiency can be assessed by morphology metrics such as surface-to-volume ratio, sky view factor and others (Chatzipoulka et al., 2018). Researchers use different sets of morphology metrics to investigate the relationship between urban form and sustainability outcomes, such as urban ventilation, air pollution, urban heat island (UHI), transportation mode and more (Galster et al., 2001; Li et al., 2022; Liu et al., 2017; Yin et al., 2018; Rybarczyk and Wu, 2014; Zhang et al., 2023). Mor-phology metrics measure urban form and support the interpretation of shape complexity with characterizations such as footprints, orientations and surface ratios (Basaraner and Cetinkaya, 2017). Consequently, performance-driven urban form generation has garnered significant attention and investigations to support computational urban design (CUD) and optimization, pursuing more comfortable indoor and outdoor environments. The workflow consists of three steps - urban form generation, performance evaluation, and performance-driven optimization (Shi et al., 2017; Koenig et al., 2020; Zhang et al., 2024). However, performance-driven CUD is hindered by disconnected workflows, particularly the gap between urban form generation and performance evaluation.\nThe fundamental cause of the gap mentioned above is the disruption in the link-ages between morphology metrics and urban form, which are mostly one-directional from form to metric. The absence of operations in the metric-to-form direction hinders the generation of the improved urban form based on the morphology metrics within the op-timized solution space of the performance evaluation(Figure 1). The performance-driven CUD process should ideally operate as multiple iterations of complete loops. One it-eration of the loop begins with the generation of the initial urban form, followed by performance evaluation based on its morphology metrics. Optimization engines are then employed to enhance performance, identifying optimized values of morphology metrics. These optimized metrics are subsequently used to generate improved urban forms, en-abling iterative refinement and continuous integration between performance evaluation, optimization, and form generation. However, when the metric-to-form workflow is dis-"}, {"title": "2. Background", "content": "Urban form, or the spatial structure of cities, is typically examined as the physical configuration of various elements within urban spaces (Batty, 1976; Kropf, 2018; Lynch and Rodwin, 1958). Urban form demonstrates significant correlations with urban perfor-mance, for instance, it impacts micro-climates, thermal and energy dynamics, mobility resilience, and the broader socio-economic-technological structure of urban systems (An-derson et al., 1996; Chiaradia, 2019; Zhou et al., 2022; Lee et al., 2016; Bramley and Power, 2009). Urban form generation, one of the main topics in computational urban design, provides systematic approaches to produce design solutions and accelerate urban design decisions and processes by using computational tools (Batty, 1991; Jiang et al.,"}, {"title": "2.1. Performance-driven urban form generation", "content": "Urban morphology is the multidisciplinary and multi-scale method of investigating the physical form of settlements, which is an important task in multiple domains such as urban planning, landscape and geography (Kropf, 2009; Moudon, 1997). In digital urban planning and design, multiple representations, quantifications and parameters are utilized towards computational design for modelling and simulating (Batty, 1976; Jiang et al., 2024). As the main components of the 3D urban morphology, buildings are arranged in various configurations throughout cities, creating diverse morphologies (Liu et al., 2014, 2020). Each building possesses distinct physical attributes, such as height, area, volume, and outline. These unique characteristics collectively influence the overall 3D urban morphology of a region. Hence many efforts have been made to develop morphology metrics for characterizing, analyzing and understanding spatiotemporal patterns of the built environments.\nUrban forms can be quantified and represented by urban morphology metrics using measurements from various aspects (e.g. density, shape), and distribution of buildings, streets, and open spaces. Multi-disciplinary investigations for quantitatively analysing and representing urban form characteristics vary in methods and scales (Li and Zeng,"}, {"title": "2.2. Urban morphology metrics", "content": "2024; Zhang et al., 2023). With the explosive growth of information technology and available multi-source data, researchers from multiple disciplines have developed various approaches for quantifying morphology, including shape grammar approaches, spatial analytical approaches, ML-based approaches and urban morphological metrics (Kropf, 2018; Biljecki and Chow, 2022; Li and Zeng, 2024). Researchers have investigated com-prehensive lists of UMIs with multi-scale measures through systematic literature reviews (Biljecki and Chow, 2022; Li and Zeng, 2024). Morphology metrics can represent the complexity, relative richness and diversity of urban forms. By employing a variety of spatial metrics, researchers can assess the compactness, connectivity, and complexity of urban environments, which in turn inform planning and policy decisions (Lowry and Lowry, 2014).\nTraditional urban morphology metrics were widely used to quantify two-dimensional spatiotemporal patterns based on land use/cover data and are extensively applied to optimize land use, improve and guide urban developments (Jabareen, 2006; Yu et al., 2020). For example, indicators like floor area ratio (FAR), building density (BD), and street network density provide insights into land use efficiency and urban sprawl (Tsai, 2005). Berghauser Pont and Haupt (2021) developed Spacemate with a focus on vari-ous types of density on the urban block such as compactness (FAR), the coverage (BD), spaciousness: open space ratio (OSR), network density and the average number of stores (Berghauser Pont and Haupt, 2005). Shape indicators can be used to identify block footprint characteristics, then developing case-based methods for urban design genera-tion (Xu and Li, 2019). Additionally, advanced metrics derived from spatial analysis techniques, such as fractal factors and space syntax, allow for a deeper examination of the spatial organization and accessibility of urban areas (Hillier et al., 1976; Batty and Longley, 1994).\nVertical information in urban morphology has been underscored to advance three-dimensional spatial pattern analysis based on new data sources and techniques (Liu et al., 2020). For instance, OpenStreetMap (OSM) is an open digital mapping database cre-ated through crowdsourced and volunteer-contributed geographic information, including buildings and infrastructure worldwide (Herfort et al., 2023; Biljecki et al., 2023). Anyone can edit all features of buildings and infrastructure. Researchers have advanced numer-ous 3D indicator systems based on established theories and practices (Li and Zeng, 2024; Labetski et al., 2023). Volumetric approaches have been used as a means of better cap-turing the 3D morphological characteristics of cities (Bruyns et al., 2021). Morphology metrics used are also defined and delineated in city planning regulations, and it has been demonstrated that one can generate 3D urban form from regulations (Chadzynski et al., 2022; Grisiute et al., 2023). Studies have extended three-dimensional landscape metrics derived from 2D metrics using various statistical methods in the scope of the patch-mosaic model (PMM) (Wu et al., 2017). Other scholars have developed 3D spatial metrics based on gradient surface models, focusing on metric development on buildings to quantify ur-ban morphology (Kedron et al., 2019). At the local scale, researchers have examined 3D building metrics to represent the distinct characteristics of complex 3D building shapes (Labetski et al., 2023). Indicator sets are valuable for better understanding urban forms and for spatial analysis. However, the indicator sets remain empirical in their ability to describe complex urban forms, and it has yet to be validated whether they are sufficient for computers to effectively represent urban form characteristics.\nBased on the existing literature, we first observe a disconnection in the fully auto-mated process of performance-driven urban form generation and optimization, caused by"}, {"title": "3. Methodology", "content": "This section introduces our methodology for improving urban form generation based on morphology metrics derived from targeted 3D block-scale models, bridging morphology metrics and 3D urban form bi-directionally. It is a systematic pipeline that includes data collection and pre-processing, morphology metrics formulation, clustering, encoding and case retrieval techniques. For urban forms, we first calculated their morphology metrics and used them to train self-organizing maps (SOM) for clustering the urban forms. Then a context-based encoding method based on the trained SOMs was developed for more effective representations for urban forms: SOMEncoding vectors. Using the trained SOMs and SOMEncoding vectors, we can retrieve more 3D models from the dataset. Consequently, we can retrieve 3D urban form models on the corresponding morphology metrics. Diverse urban forms can be associated with the target urban form types and the deriving morphology metrics, hence it can bridge morphology metrics and urban form in digital models.\nWe set out the implementations based on the following scopes and aims:\n\u2022 In preference of open-source geoinformation, 3D urban form data were collected from readily accessible platforms. We used data from OpenStreetMap. Although plots are often representative study units in urban design, we take blocks as our study units because we can only slice blocks based on the used dataset. In our work, the effectiveness of morphology metrics is evaluated solely with block-scale urban form characteristics from New York City, as it is our chosen study area.\n\u2022 To develop effective morphology metrics, the selected UMIs are unambiguous, can be universally present in all cities and have geometric significance in representing block-scale 3D urban form characteristics of shape complexity. The morphology metric sets we selected for comparison are primarily drawn from existing litera-ture, so they are not exhaustive. However, they cover the four main urban form characteristic types: height, surface, content, and shape.\n\u2022 The effectiveness of morphology metrics is assessed through observational analysis and comparative evaluation. In the experiments comparing different sets of mor-phology metrics, a guiding principle is that the morphology metrics can represent the constituent elements of urban form such that their homologous characteristics can be rigorously defined and measured (Dibble et al., 2019). In our study, urban"}, {"title": "3.1. Data collection and pre-processing", "content": "An area of New York City was downloaded from OpenStreetMap, including building footprints and road networks classified as Primary, Secondary, and Residential(Figure 2). In the figure, buildings are coloured based on their height information. Roads categorized as Residential primarily define block-scale units; therefore, the urban blocks used for further studies were delineated based on the boundaries set by these three road types.\nWhen building footprints in the dataset did not have corresponding height information (e.g. building footprints marked red in Figure 3a ), we assigned the average height of the surrounding buildings. While this average value likely does not correspond to the actual height, we argue this fuzzy estimation is sufficiently accurate to demonstrate our general methodology. This resulted in a dataset of 14,248 3D city blocks. Figure 3b shows that the height information is completed as no building or block is coloured red. Some of the selected 3D city blocks can be visualized in Figure 3c."}, {"title": "3.2. Urban morphology indicator selection", "content": "For the selection of morphological indicators, we identified 15 morphological indica-tors that are globally used for urban planning practice and urban performance research. They represent 4 types of block characteristics: height, surface ratio, block content and"}, {"title": "3.3. Urban form clustering based on morphology metrics", "content": "We deployed clustering techniques using self-organizing maps (SOMs), to evaluate the effectiveness of morphology metrics in representing urban form characteristics. By comparing the clustering results based on different morphology metric sets, we can val-idate their performance. We used six self-organizing maps (SOMs) for clusterings. The samples' morphology metrics values after normalization are used as urban form feature vectors for the input to SOMs. Hence six SOMs were trained based on the six sets of morphology metrics respectively. After training, the 3D urban form models were clus-tered and indexed according to the clusters they fall within. SOM is a general-purpose nonlinear data transformation method that offers solutions for data clustering and 2D vi-sualization by creating continuous visual patterns on top of high-dimensional data. The node weight value is a high-dimensional vector with the same dimension as the input feature vectors and is updated by reducing the distance between the node and the input data. To calculate the distance between the node and the sample, we used Euclidean"}, {"title": "3.4. Embedding 3D urban morphology characteristics by SOMEncoding", "content": "Each 3D model sample's characteristic is encoded by feature vectors which are nor-malized morphology metrics. Each sample has six sets of feature vectors with different dimensions, including BFH feature vectors with 3 dimensions, ExtendedBFH feature vectors with 5 dimensions, Spacemate and Blockshape feature vectors both with 4 di-mensions, BriefBlockMetric feature vectors with 7 dimensions and HybridBlockMetric feature vectors with 11 dimensions. Figure 6, shows three kinds of feature vectors based on BFH, Spacemate, and HybridBlockMetric, taking one sample as an example. The similarity of the urban models is determined by the distance between their feature vec-tors. One of the common ways is to calculate the Euclidean distance based on those feature vectors. Hence similar and diverse cases can be retrieved and ranked based on their similarity.\nDuring the case retrieval process, the calculated distance based on feature presenta-tion significantly influences the retrieval results. Context-based encoding can improve the feature representation (Zhang et al., 2018). Hence, encoding the morphology metrics within the trained data space ensures better representation and enhances retrieval out-comes. In this study, we developed SOMEncoding vectors to use in further case retrieval, instead of using BMU or original feature vectors. In our SOMEncoding method, vectors are calculated by applying a context-based encoding method that captures the unique characteristics of a sample relative to the entire data space. In addition to normaliza-tion, this method encodes urban form morphology metrics based on the corresponding trained SOM's BMUs. The feature vectors computed based on SOMEncoding will be referred to as SOMEncoding vectors. The SOMEncoding process can be described as fol-lows. For example, for a sample whose feature vector is x; in a SOM map with K nodes, the SOMEncoding vector is a set of distances between xi and all the SOM node weight vectors, wj, j = (1, .., K). Hence xi has K dimensions (in our case, 100 dimensions).\nThe morphology metrics were re-encoded into 100-dimensional SOMEncoding vectors. We visualized the SOMEncoding vectors by grayscale images in a 10x10 map, taking a randomly selected block sample as an example (Figure 6), showcasing BFH, Spacemate and HybridBlockMetric. Figure 6 also showcases the four grey-scale colour maps which are the top four cases similar in SOMEncoding vectors. The retrieved four grey-scale colour maps show a high degree of consistency with the target.\nSOMEncoding vector offers the advantage of making case retrieval across different morphology metric sets more comparable. By reducing the heterogeneity between the morphology metrics, all samples can be represented as vectors in the same dimensions after encoding. In this way, we mapped a 3D urban form to its corresponding morphology metrics, then standardised the morphology metrics into feature vectors based on which we trained SOMs, and then encoded the feature vectors based on the context of trained"}, {"title": "4. Results", "content": null}, {"title": "4.1. Mapping between morphology metrics and 3D urban forms", "content": "To assess the effectiveness of the six morphology metric sets in capturing urban form characteristics, we compare the similarities between the retrieved 3D models and the"}, {"title": "4.2. Evaluating morphology metrics by comparison", "content": "We evaluate the performance of morphology metrics in representing urban form char-acteristics by retrieving and comparing the 3D models that are retrieved according to"}, {"title": "5. Discussion", "content": null}, {"title": "5.1. Contributions", "content": "Urban morphology indicators have a combinatorial effect in representing urban forms. The results demonstrate that our study provides innovative approaches that enable the bi-directional bridging between 3D block-scale urban models and morphology metrics. Further, our study provides approaches for evaluating the effectiveness of different mor-phology metrics in representing 3D urban form characteristics. The results also show that our proposed HybridBlockMetric can represent volumetric block-scale urban form characteristics in terms of prototype similarity and morphological diversity. We outline our contributions:\n1. Our methodology offers a systematic way for deriving morphology metrics from 3D urban models, facilitating both the characterization and generation of urban form. It enables the flexible retrieval of a diverse range of 3D models with similar urban morphology based on given morphology metrics derived from 3D block-scale models, linking urban form and morphology metrics bi-directionally. As the morphology metric set can include UMI for performance evaluation, the capability allows for the integration of performance evaluation with urban form generation to advance the automation of performance-driven computational urban design."}, {"title": "5.2. Directions for future work", "content": "Our study offers great potential to bridge the generation of improved urban form and optimized morphology metrics in performance-driven urban computational design. We proposed a methodology for establishing bi-directional links between morphology metrics and 3D urban forms and evaluated the performance of these morphology metrics. Many of the UMIs that constitute our morphology metrics are derived from urban form indicators primarily used for energy analysis, such as microclimate analysis.\nIn the further extensions, when our proposed approaches are applied to other urban form datasets, additional specific UMIs can be incorporated and further examined accord-ing to the characteristics of those urban forms. Using a case study of performance-driven design is helpful to extend our work, applying our approaches to retrieved 3D urban form models based on optimized morphology metrics with enhanced performance evaluation. For instance, by simulating and storing the energy performance of these blocks based on the morphology metrics, we can further provide improved urban form models with better energy profiles according to the input urban form types. In that way, energy implications of different urban forms can be further investigated, hence achieving a comprehensive digital link between urban form generation and design impact analysis. Integrating en-ergy simulation into the framework can provide urban designers and planners with tools to assess the environmental impacts of their designs in real-time, fostering sustainable and efficient urban development."}, {"title": "6. Conclusion", "content": "The accelerating digitalization in urban planning and design underscores the impor-tance of bi-directional links between intangible urban forms and tangible quantifications in digital models, such as real-time interactions for urban form generation and design impact analysis. This work, focusing on 3D block-scale urban forms and their morphol-ogy metrics, presents approaches for evaluating morphology metrics and associating them with 3D models that have similar urban forms. Our methodology has innovative con-tributions in encoding morphology metrics, evaluating morphology metrics in effectively representing features in 3D urban forms, and digitally coupling morphology metrics and 3D urban forms."}, {"title": "Table 1: Overview of our selected urban morphological indicators, including their definitions and the urban form characteristic types they describe. The table shows an example of a 3D model and its indicator values.", "content": "Characteristic UMI\ntype\nMaxHeight\n(MaxH) /m\nMinHeight\n(MinH) /m\nAverageHeight\n(AveH) /m\nStandard-\nDeviationHeight\n(SDH)\nsdh =\nHeight\nHeight\nHeight\nHeight\nHeight\nWeighted-\nAverageHeight\n(WAH) /m\nwah =\nDefinition\nMaximum building height within\na block.\nMinimum building height within\na block.\nAverage building height within a\nblock.\nThe standard deviation of build-\ning heights within a block.\n\u221a\u2211N\ni=1 (hi \u2212 h)2\nN \u22121\nh is the average height of build-\nings within the block. hi is the\nheight of building i.\nBuilding height is weighted by\nthe building footprint area.\n\u2211N\ni=1 Aihi\n\u2211N\ni=1 Ai\nhi is the height of building i.\nAverage buildings stories within\na block.\nThe ratio of the total building\nfootprint area to the gross block\nAverageStoreys (AS)\nSurface Ratio\nBuilding-\nCoverageRatio (BCR)\nbcr =\nN\narea.\n\u2211i=1 Ai\nAb\nAi is footprint area of building i.\nAb is gross block area. N is num-\nber of buildings in the block.\n\u2211S\nSurface Ratio\nFloor AreaRatio (FAR)\nfar =ij=1 Aij\nAb\nAij is the area of floor j of build-\ning i. S is the number of stories\nof building i.\nThe ratio of a building's total\nfloor area to the gross area of its\nblock."}, {"title": "Table 2: Overview of the identified urban morphology metric sets and their UMI compositions. The table shows that different mor-phology metric sets include indicators spanning various character-istic types.", "content": "Morphology metric Height SurfaceRatio BlockContent Block2DShape Resource\nsets\nBFH MaxH BCR;\nFAR\nExtendedBFH MaxH BCR; NOB BA\nFAR\nSpacemate AveS BCR; Berghauser Pont\nFAR; and Haupt\nOSR (2021)\nBlockShape FAR BA; Xu and Li\nBSF; (2019)\nBSS\nBrief BlockMetric AveH; CAR GHWR; BA\nSDH; NOB\nWAH\nHybridBlockMetric MaxH; BCR; GHWR; BA\nMinH; FAR; NOB\nAveH; CAR\nSDH;\nWAH"}, {"title": "Distance BMU(x) = maxxj (f(yj|x))", "content": "{\\displaystyle BMU(x) = \\max_{x_j} (f(y_j|x))}"}, {"title": "Distance f(yj|x) =", "content": "{\\displaystyle f(y_j|x) =  \\frac{exp s (w_j, x)}{\\sum_{l=1}^{k} exps (w_j, x)}}"}]}