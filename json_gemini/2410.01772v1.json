{"title": "DEFINE: Enhancing LLM Decision-Making with Factor Profiles and Analogical Reasoning", "authors": ["Yebowen Hu", "Xiaoyang Wang", "Wenlin Yao", "Yiming Lu", "Daoan Zhang", "Hassan Foroosh", "Dong Yu", "Fei Liu"], "abstract": "LLMs are ideal for decision-making due to their ability to reason over long contexts\nand identify critical factors. However, challenges arise when processing transcripts\nof spoken speech describing complex scenarios. These transcripts often contain\nungrammatical or incomplete sentences, repetitions, hedging, and vagueness. For\nexample, during a company's earnings call, an executive might project a positive\nrevenue outlook to reassure investors, despite significant uncertainty regarding\nfuture earnings. It is crucial for LLMs to incorporate this uncertainty systematically\nwhen making decisions. In this paper, we introduce DEFINE, a new framework\nthat constructs probabilistic factor profiles from complex scenarios. DEFINE then\nintegrates these profiles with analogical reasoning, leveraging insights from similar\npast experiences to guide LLMs in making critical decisions in novel situations.\nOur framework separates the tasks of quantifying uncertainty in complex scenarios\nand incorporating it into LLM decision-making. This approach is particularly\nuseful in fields such as medical consultations, negotiations, and political debates,\nwhere making decisions under uncertainty is vital.", "sections": [{"title": "1 INTRODUCTION", "content": "Large language models are increasingly utilized for decision-making, thanks to their advanced\nreasoning abilities (Eigner & H\u00e4ndler, 2024). While research has examined various types of reasoning,\ne.g., deductive, inductive, mathematical, and multi-hop reasoning, most studies have tackled simpler\ntasks, such as natural language inference and math word problems (Bostrom et al., 2022; Huang &\nChang, 2023; Sprague et al., 2024; Mondorf & Plank, 2024). There is a significant gap in handling\ncomplex, real-world scenarios, such as making financial investment decisions (Keith & Stent, 2019),\nwhere the stakes are high and poor decisions can result in severe consequences. Therefore, it is\ncrucial to understand how LLMs make decisions, allowing domain experts to collaborate with them\nto make informed, rational decisions in complex situations.\nThe challenges are compounded when LLMs are required to handle long contexts, extract multiple\nrelevant pieces of information, and make decisions based on this data (Krishna et al., 2023; Laban\net al., 2024). Key issues include a tendency to prioritize information at the beginning and end of\nthe context (recency bias; Liu et al. 2023), handling inconsistencies, and mitigating hallucinations\nin numerical data (Hu et al., 2024a;b). Current tools such as chain-of-thought (CoT; Wei et al.\n2023), tree-of-thought (ToT; Yao et al. 2023), Reflexion (Shinn et al., 2023), are designed to provide\nreasoning traces for LLM decisions; however, their explanations remain ambiguous. They lack\nprecise, quantitative insights into key factors and the degree of uncertainty involved. Consequently,\ndecision-makers are left with doubts about the reliability of these decisions and how they can be\nimproved. There is a pressing need to enhance the verifiability of LLMs in complex decision-making\nscenarios to ensure their dependability and effectiveness.\nWe present DEFINE, a new framework designed to build probabilistic factor profiles from transcripts\nof spoken speech that describe complex scenarios. These transcripts are often excessively long,\ncontaining ungrammatical sentences, repetitions, hedging, and vagueness (Sawhney et al., 2020;\nMedya et al., 2022). For example, during a quarterly earnings call, a company executive might project"}, {"title": "2 OVERVIEW AND FACTOR ANALYSIS", "content": "LLMs have shown great promise in financial services (Reddy et al., 2024; Lee et al., 2024), yet the\nspecifics of their decision-making processes remain largely unexplored. In this paper, we investigate\nhow LLMs can guide investment decisions by analyzing earnings call transcripts. The transcripts\ncontain a rich mix of textual and numerical data, presenting a unique challenge for LLMs in making"}, {"title": "2.1 FACTOR PROFILE", "content": "Let X denote an earnings call transcript, based on which we predict a stock investment decision Y,\nwhich can take one of 5 categorical outcomes: {strong buy, buy, hold, sell, strong sell}. We construct\na factor profile for each transcript X. Specifically, we define a set of factors F = {F1, F2, ..., Fn},\nwhere each factor F\u1d62 is associated with multiple potential outcomes Oi1, Oi2,..., Oim. The like-\nlihood of each outcome, given the transcript, is modeled by a probabilistic function, P(Oij|X).\nThese probabilities are inferred using a methodology that optimally integrates textual reasoning with\nquantitative analysis. Thus, each factor outcome's probability informs the aggregation model that\npredicts the investment decision Y.\nIn this study, we focus on a curated set of 15 factors,\ncategorized into three groups: macroeconomic in-\nfluences (e.g., economic health, market sentiment),\ncompany-specific dynamics (e.g., mergers and ma-\njor acquisitions, product launches), and historical\nfinancial metrics (e.g., past earnings, stock prices).\nThese factors were carefully selected through an\niterative process of querying the LLM for key vari-\nables crucial in forecasting stock movements fol-\nlowing earnings announcements. We intentionally\nlimited our variable set to 15 factors, each with two\nto three potential outcomes, as detailed below. By\ndistilling the analysis to a few significant predic-\ntors, our approach balances complexity and perfor-\nmance, while also allowing for future integration\nof domain-specific factors identified by financial\nalysts.\n\u2022 Macroeconomic Influences. These encompass broad economic factors that affect the entire\nmarket or large segments of it. This includes the overall economic health, market sentiment,\npolitical events, natural disasters and geopolitical issues (Liu et al., 2024). Each factor leads\nto two potential outcomes; for instance, natural disasters might cause a 'Major Impact' by\ndisrupting economies and global supply chains, and directly affecting market performance;\nthe 'Unknown or Uncertain' outcome reflects the unpredictability of such events.\n\u2022 Company-Specific Dynamics. These factors are linked to the internal operations and strate-\ngic decisions of individual companies, such as mergers and acquisitions, regulatory changes,\nfinancial health, company growth potential, product launches, and issues within the supply\nchain. Each factor can result in one of two potential outcomes. For example, a 'Positive"}, {"title": "2.2 ANALYZING KEY FACTORS USING THE BRADLEY-TERRY MODEL", "content": "The Bradley-Terry model is a probabilistic framework used for estimating the relative strengths of\nitems based on pairwise comparisons, and the outcome of each comparison indicates which of the two\nitems is 'better' in a specific context (Bradley & Terry, 1952). This model has been widely used for\nranking purposes in sports tournaments, LLM preference studies, and other domains where pairwise\ncomparison data is available (Hu et al., 2023; Zhu et al., 2024). In this model, we estimate parameters\nthat represent the strength of each factor. These parameters are generally presented on a logistic scale,\nwhere the probability that factor A is considered more significant than factor B is modeled as:\nP(A > B) = \\frac{e^{\\beta_A}}{e^{\\beta_A} + e^{\\beta_B}}\nHere, \\beta_A and \\beta_B represent the strengths of factors A and B, respectively. The estimated parameters\nare often exponentiated, so that p\u1d62 = e^{\\beta_i} measures the relative strength of each factor. A higher value\nindicates a stronger influence. In determining which factors to prioritize in a post-earnings analysis,\nthose with higher Bradley-Terry scores are considered more crucial.\nConsider a comparative analysis of two earnings call transcripts, A and B, transcript A is more likely\nto lead to favorable stock movements than transcript B (A > B). We obtain such pairwise comparisons\nbased on target labels; with 'strong-buy' ranked higher than 'hold', 'sell', and 'strong-sell'; 'buy'\noutranking 'sell' and \u2018strong-sell\u2019; and 'hold' surpassing 'strong-sell'. The comparison of A and B\nwill involve creating a set of factor-outcome pairwise comparisons, where each outcome in transcript\nA is preferable to that in transcript B: O(A) > O(B), suggesting that the factors associated with\ntranscript A outperform those in transcript B.\nWe further consider the weight-adjusted effect of comparisons between factors. Our method com-\npares the influence of factors from transcripts A and B by calculating an 'expected occurrence',\nwhich is determined by multiplying the likelihood of these factors appearing in both transcripts,\nP(Oij|X(A)) \u00d7 P(Oij|X(B)). This approach provides a probability-based comparison, offering a\nmore detailed evaluation than simple counting methods. These expected occurrences then feed into a\nBradley-Terry model matrix W. The model helps to estimate the relative importance of each factor by\nassigning a coefficient p\u2093 to each outcome Oij, indicating its influence on stock investment decisions.\nWe refine these estimates using an EM-like algorithm, which iteratively adjusts and normalizes p\u2093 to"}, {"title": "3 BAYESIAN DECISION-MAKING", "content": "In Bayesian decision-making, utility functions play a crucial role in navigating uncertainty (Halawi\net al., 2024; Lin et al., 2024; Ye et al., 2024). A Bayesian framework updates beliefs about possible\noutcomes. Decisions are then made by evaluating the expected utility for each possible action, which\ninvolves calculating the utility across the updated beliefs. This method ensures that choices are made\nto maximize expected utility, so decisions are aligned with the decision-maker's preferences and risk\ntolerance.\nConcretely, to compute P(Oij|X), we construct a probabilistic factor profile from a given earnings\ncall transcript, where Oij represents the j-th outcome of the i-th factor. The likelihood P(Y|Oij),\nwhich estimates how the j-th outcome influences stock investment decisions, is calculated using\nthe Bradley-Terry model. This model provides a framework for quantifying the impact each factor\noutcome has on the decision-making process. Using these probabilities, the Bayesian decision-making\nformula integrates over all factors and their potential outcomes to determine the optimal action. The\noverall decision is derived by:\nY = \\arg \\max_i \\sum_i \\sum_j P(Y|O_{ij})P(O_{ij}|X)\nThe parameters calculated by the Bradley-Terry model for P(Y|Oij) help us determine how each\nfactor influences stock movements. During our testing phase, transcripts are assigned to one of five\ndecision categories based on their computed scores. For example, if the ground truth indicates there\nare k 'strong buy' recommendations, the top k scoring transcripts are classified correspondingly\nas 'strong buy'. This approach uses probabilistic factor profiles in conjunction with Bradley-Terry\nmodeling to identify influential factors, providing a transparent method for understanding decision-\ndriving elements. Moving forward, we extend beyond individual factors by examining analogous\ncases that directly influence decisions."}, {"title": "4 ANALOGICAL REASONING", "content": "Analogical reasoning, which involves drawing parallels between similar situations (Webb et al., 2023;\nOzturkler et al., 2023; Yuan et al., 2024; Sourati et al., 2024; Yasunaga et al., 2024), is an effective\nmethod for decision-making. This approach is particularly useful when analyzing how stocks react to\nearnings announcements by referencing past, similar events. For example, in the tech sector, stocks\noften show high volatility after earnings calls that introduce significant technological updates, even if\nthe revenue and EPS meet expectations. If a tech company is rumored to discuss a new technology\ntrend in its upcoming earnings announcement, using this method, we can infer that this company's\nstock might also experience increased volatility. Investors might use this analysis to make investment\ndecisions or hedge against potential volatility.\nAccurately identifying analogous examples from earnings call transcripts is crucial. We propose a\nmethod that utilizes probabilistic factor profiles, denoted as P(Oij|X), where Oij represents the j-th\noutcome of the i-th factor. To measure the similarity between profiles, we calculate the Kullback-\nLeibler (KL) divergence, which quantifies the information loss when one probability distribution\napproximates another. The KL divergence is computed as follows:\nD_{KL}(P||Q) = \\sum_{i=1}^n \\sum_{j=1}^m P(O_{ij}|X) \\log \\frac{P(O_{ij}|X)}{Q(O_{ij}|X_c)}\nHere, P represents the factor profile for the target transcript, and Q denotes the profile for a compara-\ntive transcript Xc from our training set. Transcripts with lower KL divergence values are considered\nmore analogous, and therefore more likely to influence investor decisions similarly."}, {"title": "5 DATA COLLECTION", "content": "Our dataset contains 11,950 earnings call transcripts\nfrom S&P 500 and NASDAQ 500 companies, gath-\nered from the Motley Fool over the period of 2017-\n2024. The Motley Fool is a well-regarded financial\nservice website that regularly publishes earnings call\ntranscripts from U.S. companies. We make sure to\nfollow their terms of use carefully during data col-\nlection. We do not use audio recordings or analyze\nacoustic or prosodic features. Each transcript is for-\nmatted as a JSON object, including the company's\nstock ticker, the date of the earnings announcement,\nparticipant names and their affiliations, executive pre-\npared remarks, and a series of question-answer pairs\nfrom the Q&A session."}, {"title": "6 EXPERIMENTS", "content": "In this section, we evaluate the decision-making performance of various systems, analyze the key\nfactors that influence stock movement predictions, and conduct an analysis of analogical reasoning."}, {"title": "6.1 DECISION-MAKING WITH DEFINE", "content": "We test our system, DEFINE, against different decision-making strategies: (a) LLM+CoT+Trans:\nWe feed the entire earnings call transcript to the LLM and then use the chain-of-thought to assign a\nlabel, with both labels and their interpretations also provided to the LLM. (b) LLM+CoT+Summ and\nLLM+CoT+Factors: These approaches use a summarize-then-predict strategy. LLM+CoT+Summ\nsimplifies the transcript into a textual summary, while LLM+CoT+Factors condenses it into a factor\nprofile. It is considered a structured summary, unlike the textual summary produced by direct LLM\nprompting. Details on the prompts used for these methods can be found in the Appendix."}, {"title": "6.2 INFLUENTIAL FACTORS", "content": "We develop three variations of our DEFINE-BT approach, each using the Bradley-Terry model for\npairwise comparisons in different contexts: DEFINE-BT-Same Sector compares companies within the\nsame sector, DEFINE-BT-Cross Sectors examines companies across different sectors, and DEFINE-\nBT-Same Company analyzes a company's current earnings call transcript against its historical ones.\nTo ensure fairness, we maintain the same number of pairwise comparisons across all three settings,\ndownsampling where necessary. According to the F-scores presented in Table 4, all DEFINE-BT"}, {"title": "6.3 INSIGHTS INTO ANALOGICAL REASONING", "content": "Analogical reasoning utilizes a select number of analogous examples, denoted as K, to inform\ndecision-making in LLMs. In Figure 3, we adjust K from 3 to 9 and observe its impact on the\nF-Score. In these experiments, we use the majority vote from the K examples as the final prediction."}, {"title": "7 RELATED WORK", "content": "Analogical Reasoning. This type of reasoning identifies connections between similar, though not\nidentical, situations to transfer knowledge from a known context to a new one (Webb et al., 2023;\nOzturkler et al., 2023; Yu et al., 2024; Yuan et al., 2024; Sourati et al., 2024; Yasunaga et al., 2024).\nIt helps decision makers draw parallels between current situations and past experiences, effectively\nleveraging historical insights. Analogical reasoning plays a crucial role in various fields, e.g., doctors\napply knowledge from one disease to diagnose another, and lawyers use past rulings to argue new\ncases (Lehman et al., 2022; Charmet et al., 2022; Cao et al., 2024a). This ability to recognize and use\nsimilarities in different situations is important for decision-making.\nWhile zero-shot analogical reasoning is a desired capability for LLMs, recent studies show they\nlack the robustness and generality of human analogy-making, as evidenced by counterexamples in\ntasks such as letter string analogies (Hodel & West, 2024; Lewis & Mitchell, 2024). Musker et al.\n(2024) test both humans and LLMs on tasks that require transferring semantic structure and content\nbetween domains. Yasunaga et al. (2024) introduce analogical prompting, where LLMs self-generate\nrelevant examples using prompts such as \u201c# Recall relevant problems and solutions:\u201d before solving\nthe original problem; Qin et al. (2024) find that the accuracy of self-generated examples is key to\neliciting such capability. Unlike previous research, our study employs probabilistic factor profiles to\nmodel analogical reasoning, grounding our approach in solid mathematical principles."}, {"title": "8 CONCLUSION", "content": "We propose DEFINE, a new framework for decision-making in complex scenarios, such as those\nencountered in corporate earnings calls. By combining probabilistic factor profiles with analogical\nreasoning, this framework not only captures the uncertainties embedded in earnings call transcripts\nbut also allows the LLM to apply previous insights to new challenges more efficiently. Our approach\nsurpasses strong baseline models and enhances the practical utility of LLMs by identifying analogous\nexamples. The DEFINE framework offers a promising avenue for navigating complex data and\nsupporting decision-making processes."}, {"title": "9 LIMITATIONS", "content": "The effectiveness of the DEFINE framework, as presented in this paper, is predominantly based on\ncontrolled experimental conditions. While the framework has been designed to enhance decision-\nmaking capabilities through the use of probabilistic factor profiles and analogical reasoning, actual\noutcomes may vary when applied in real-world scenarios. Users should be aware that the framework's\nperformance can be influenced by various external factors including data quality, context-specific\nnuances, and the dynamic nature of real-world environments. We encourage users to consider these\nvariables when implementing and adapting the DEFINE approach to ensure its optimal application\nand to mitigate potential discrepancies between expected and actual results."}, {"title": "A APPENDIX", "content": "Constructing a Factor Profile from an Earnings Call Transcript\nSystem Message\nYou are a financial analyst specializing in earnings call transcripts. You will\nreceive the complete transcript of an earnings call, which includes both the\nprepared remarks and the Q&A session. Your job is to identify the key factors\nfrom the transcript and assign probabilities to the potential outcomes of these\nfactors.\nUser Message\nYour task is to conduct a comprehensive analysis of the earnings call transcript\nbelow. Be sure to accurately capture the important factors and estimate the\nlikelihood of each factor resulting in specific outcomes.\nEarnings Call Transcript for Company {Company}\n# Prepared Remarks\nSpeaker: {Speech...}\n# Questions and Answers\nAnalyst: {Speech...}\nPlease analyze the above earnings call transcript, focusing on the following key\nfactors:\n{Enumerate factors, descriptions, and outcomes}\n1. Economic health: Economic health refers to the overall stability\nand performance of the economy, reflected in factors like growth,\nemployment, inflation, and market confidence. Outcomes: {positive-outlook,\nunknown-or-uncertain}\n2. Market sentiment and investor psychology: Market sentiment reflects the\noverall mood or attitude of investors toward a particular market, influenced\nby news, economic data, and global events. Investor psychology refers to the\nemotions and cognitive biases that drive decisions, often leading to behaviors\nlike fear-driven selling or greed-fueled buying. Outcomes: {optimistic,\nunknown-or-uncertain}\nPlease take the time to thoroughly understand the transcript. For each key\nfactor, provide a detailed summary based on the given transcript. Then,\nreview all associated outcomes and assess the likelihood of each outcome. The\nlikelihood should be strictly selected from the following options: {very likely,\nlikely, somewhat likely, somewhat unlikely, unlikely, very unlikely}. Format\nyour response in JSON.\n# Example Output:\n{JSON output example}\n# Your Output:"}, {"title": "Using Analogical Reasoning to Make Investment Decisions", "content": "System Message\nYou're a financial analyst who specializes in giving investors buy or sell\nrecommendations by thoroughly analyzing earnings call transcripts.\nUser Message\nHere are several example company profiles. Each profile highlights key factors\nfrom an earnings call transcript and probabilities for potential outcomes based\non those factors. Each profile represents a specific company and is based on its\nhistorical earnings call data. Your job is to pick the most analogous example and\nuse its strategy to solve the initial problem.\nExample Company Profile 1:\n{Factor Profile 1}\nAnalyst recommendation: {Action 1}\nExample Company Profile 2:\n{Factor Profile 2}\nAnalyst recommendation: {Action 2}\nExample Company Profile 3:\n{Factor Profile 3}\nAnalyst recommendation: {Action 3}\nExample Company Profile 4:\n{Factor Profile 4}\nAnalyst recommendation: {Action 4}\nExample Company Profile 5:\n{Factor Profile 5}\nAnalyst recommendation: {Action 5}\n**Initial Problem**\nBased on your analysis of the earnings call for {Company Name} held on\n{Announcement Date}, decide on the most likely analyst recommendation for the\nnext 30 days from these options:\nAction 1: strong buy: The stock price will increase by more than 5%\nAction 2: buy: The stock price will increase by 2% to 5%\nAction 3: hold: The stock price is expected to remain stable, fluctuating\nbetween -2% to 2%\nAction 4: sell: The stock price will decrease by 2% to 5%\nAction 5: strong sell: The stock price will decrease by more than 5%\nBelow is the company profile summarized from {Company Name}'s earnings call on\n{Announcement Date} and the historical price trend probabilities judged by an\nanalyst:\n{Factor Profile Constructed Using an Earnings Call Transcript}\n**Solve the Initial Problem**\nPlease respond with the analyst recommendation for this stock in JSON format,\nincluding these keys: ('idx', 'recommendation', 'justification'). \u2018idx' is\nthe index of the most analogous example profile, and 'recommendation' should be\none of the actions mentioned above for 30 days of trading, and 'justification'\nshould clearly explain your recommendation using the strategy you learned from\nthe selected example company profile."}, {"title": "A Prompt that Uses Chain-of-Thought to Make Investment Decisions", "content": "System Message\nYou're a financial analyst spcializing in giving investors buy or sell\nrecommendations by thoroughly analyzing earnings call transcripts.\nUser Message\nBased on your analysis of the earnings call for Company Name} held on\n{Announcement Date}, decide on the most likely analyst recommendation for the\nnext 30 days from these options:\nAction 1: strong buy: The stock price will increase by more than 5%\nAction 2: buy: The stock price will increase by 2% to 5%\nAction 3: hold: The stock price is expected to remain stable, fluctuating\nbetween -2% to 2%\nAction 4: sell: The stock price will decrease by 2% to 5%\nAction 5: strong sell: The stock price will decrease by more than 5%\nBelow is the Factor Profile, Transcript or Summary} from {Company Name}'s\nearnings call on {Announcement Date}:}\n{Factor Profile, Transcripts or Summary}\nPlease think step by step and respond with the analyst recommendation for this\nstock in JSON format, including these keys: ('thoughts', 'recommendation',\n'justification'). 'Thoughts' should be your detailed reasoning steps,\n'recommendation' should be one of the actions mentioned above for 30 days trading,\n'Justification' should clearly explain your recommendation using the strategy\nyou learned from the selected example company profile."}, {"title": "A Prompt to Analyze Trends Based on Historical Financial Metrics", "content": "System Message\nYou are a financial analyst specializing in historical data analysis, including\nstock prices, earnings per share (EPS), and revenue. Your goal is to assess the\nlikelihood of different market trends based on past data.\nUser Message\nThe potential outcomes to consider are: {bullish, stable, and bearish}. For\neach outcome, please assign a likelihood level from the following options: {very\nlikely, likely, somewhat likely, somewhat unlikely, unlikely, very unlikely}.\nBelow, you will be provided with a historical data table: {Data\nName}:{Description}\n{Historical Data Table}\nDate\tClose Price\n2023-07-31\t195.22\n2023-08-01\t195.46\n{... until the date of the earnings announcement.}\nPlease analyze this historical data and provide the likelihood of each outcome in\nJSON format.\n# Example Output:\n{\"historical EPS\": {\"bullish\": very likely, \"stable\":somewhat likely, \"bearish\":\nunlikely}}\n# Your Output:"}]}