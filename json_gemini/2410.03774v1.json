{"title": "Human-Based Risk Model for Improved Driver Support in Interactive Driving Scenarios", "authors": ["Tim Puphal", "Benedict Flade", "Matti Kr\u00fcger", "Ryohei Hirano", "Akihito Kimata"], "abstract": "This paper addresses the problem of human-based driver support. Nowadays, driver support systems help users to operate safely in many driving situations. Nevertheless, these systems do not fully use the rich information that is available from sensing the human driver. In this paper, we therefore present a human-based risk model that uses driver information for improved driver support. In contrast to state of the art, our proposed risk model combines a) the current driver perception based on driver errors, such as the driver overlooking another vehicle (i.e., notice error), and b) driver personalization, such as the driver being defensive or confident. In extensive simulations of multiple interactive driving scenarios, we show that our novel human-based risk model achieves earlier warning times and reduced warning errors compared to a baseline risk model not using human driver information.", "sections": [{"title": "I. INTRODUCTION", "content": "Driver support systems are nowadays successfully helping users in many everyday driving situations [1]. For example, adaptive cruise control [2] has been introduced in production vehicles, using the time headway to the front driving car as a risk model to successfully follow other vehicles. Various parking assistance systems [3] are standard in vehicles, using distance signals to inform the driver about nearby objects like buildings and walls. Finally, collision mitigation systems, such as the work of [4], are also widespread in the market, using time-to-collision metrics to warn about vehicles in the forward driving area.\nHowever, until now, these driver support systems mostly apply only risk models and do not consider the human driver. According to previous research [5], rich information is available from sensing the human driver. There are already first approaches, see, for instance, the work [6], which check if the driver is falling asleep or which ensure that the driver is not looking at their phone while driving to improve the system usability. Using such human driver information has a large potential to improve driver support.\nFig. 1 shows an example of a driving situation in which human driver information can improve driver support. In this example, a motorcycle rider intends to change lanes because of a slower car in front. The rider must consider the car on the neighboring lane to successfully change lanes. Here, the driver perception influences the future driving risk. We define driver perception based on driver errors. For example, if the motorcycle rider overlooks the car on the neighboring lane (i.e., notice error), the rider might make an unexpected and dangerous lane change. Other driver errors include the rider estimating a wrong velocity of the other car (i.e., forecast error) or inferring a wrong lane change intention of the other car (i.e., inference error). Driver perception modeling allows warnings tailored to the driver's current state.\nAdditionally, the motorcycle rider can exhibit different driver types (e.g., defensive and confident) in the given driving situation. Such human driver information changes the warning preference for driver support. A defensive motorcycle rider, for example, prefers an early warning to have enough time reacting to the situation. In contrast, a confident rider prefers a late warning. Driver personalization based on driver types can also improve driver support.\nIn this paper, we present a human-based risk model that improves driver support by combining both aformentioned human driver aspects: a) the current driver perception and b) driver personalization. Our proposed approach is based on a stochastic collision risk model. In extensive simulations of multiple interactive driving scenarios, such as the depicted lane change situation, we show that our approach achieves improved driver support. On average, the human-based risk model achieves an earlier warning time and reduced warning errors compared to a state-of-the-art baseline risk model that does not use human driver information."}, {"title": "A. Related Work", "content": "In recent human factors research, there are many technologies proposed that are able to sense the human driver. For example, the driver's gaze, sleepiness and general attention for the driving situation can be estimated from cameras inside the vehicle pointed towards the driver [6]. In addition, motion data from the driver's vehicle has been shown to correlate with the general driving type of the driver [7]. Still, only few approaches use human driver information to improve driver support.\nModeling driver perception is here challenging and has not received much attention in the context of driver support. One interesting work in this direction is [8], in which a system is proposed that detects if the driver intends to brake and, if so, issues no warning of the upcoming critical objects. Another related work is [9], which took another approach by allowing the driver to see the current system predictions. The driver can then correct the prediction for automated driving through speech input.\nIn the context of personalization for driver support, there are many approaches presented that estimate parameters of vehicle control systems or driver models, but there are only few approaches that use personalization to improve driver support in the form of risk warnings. As an example, the authors of [10] estimate driver-specific critical intersection merging gaps from driving data with machine learning. The authors of [11] estimate reaction times for the driver model called Intelligent Driver Model (IDM), and the authors of the paper [12] adapt parameters for the driver's risk field to different driving situations, such as curve driving, and could safely handle the scenarios when coupling the system to a vehicle controller.\nLastly, a driver perception model was previously developed with risk considerations for improved driver warning, as we have demonstrated in [13]. Furthermore, we showed that driver support with personalization can effectively adapt risk warning to the driver in [14]. In this paper, we combine both aspects of human driver information for driver support: a) the current driver perception and b) driver personalization. To the best of the authors' knowledge, this is the first time such a combined human-based risk model is proposed."}, {"title": "B. Contribution", "content": "In this paper, we build upon related work and present a human-based risk model to achieve improved driver support. In detail, the contributions are two-fold:\n1) We show how human models of driver perception and driver personalization can be combined into a human-based risk model for driver support.\n2) We present a large-scale simulation experiment and analysis for multiple driving scenarios with variations of the scenarios and of the human driver information input for the human-based risk model.\nIn the experiments, we assume sensed human driver information as given and focus on how the information can be used for risk models. The results highlight that human factors can improve driver support for many driving scenarios.\nThe remainder of the paper is structured as follows. In the next Section II, we first present state-of-the-art risk models and driver behavior planning. Section II then introduces the human-based risk model and explains the system architec-ture and parametrization. Section IV shows evenutally the experimental setup and the statistical results of applying the proposed human-based risk model in simulation and Section V gives a conclusion and outlook."}, {"title": "II. RISK MODEL", "content": "Common risk models in state of the art do not consider the human driver but use only the vehicle states to generate a warning. Fig. 2 shows the block diagram of such a risk model. The vehicle states include the vehicle state of the driver and the state of surrounding vehicles. The model then predicts driving risks, e.g., vehicle collisions, by assuming a constant velocity for both the driver and other vehicles and predicting their positions along driving paths. The resulting risk value is used to generate a warning signal.\nSince predicting into the future involves uncertainty, many common risk models account additionally for uncertainties in the vehicle trajectories. In this paper, we use our previously published approach [15] for this purpose.\nThe risk model includes the stochastic models of the Gaussian method and survival analysis. The Gaussian method includes uncertainty in vehicle positions by modeling two-dimensional Gaussian distributions. The distributions are defined by mean positions $\\mu_1$ and $\\mu_2$, and uncertainty matrices $\\Sigma_1$ and $\\Sigma_2$ for the driver's vehicle and another vehicle. In this way, the collision probability between the two vehicles can be given by the overlap of the distributions. We write for the collision probability\n$P_{coll}(t + s) = det |2\\pi(\\Sigma_1 + \\Sigma_2)|^{-\\frac{1}{2}} exp{-\\frac{1}{2} (\\mu_2 - \\mu_1)^T (\\Sigma_1 + \\Sigma_2)^{-1} (\\mu_2 - \\mu_1)}$\nwhich is computed for each future timestep $t + s$ starting from the current timestep $t$ in the driving prediction.\nIn the Gaussian method, the two-dimensional Gaussian distributions are defined to grow over the future time. The further the risk model predicts into the future, the less likely the position estimates of the vehicles become.\nFinally, the risk model uses the survival analysis to condense the prediction into one risk value for the current time. In detail, we integrate the collision probabilities $P_{coll}(t + s)$ over the future time. The final risk value is given by\n$R(t) = \\int_{0}^{Smax} P_{coll}(t + s)S(s;t) ds,$\nin which we cap the integration of the survival analysis with a fixed prediction horizon $Smax$. Moreover, a survival function $S(s;t)$ is added in the integration to include uncertainty in time. The function resembles a decaying exponential function and rates collisions in the distant future less than those in the near future of the risk prediction."}, {"title": "A. Risk Maps", "content": "While the risk model allows to generate a warning signal for driver support, the risk model can also be used in driver behavior planning. We will briefly describe state-of-the-art behavior planning using risk models. Fig. 3 shows the block diagram of the example approach Risk Maps [16].\nTo plan a behavior, Risk Maps initially samples different target velocities for the vehicle of the driver, representing"}, {"title": "III. HUMAN-BASED RISK MODEL", "content": "The last section introduced risk models and behavior planning in state of the art. Both approaches do not consider the human driver. In this section, we therefore present a human-based risk model that improves driver support by explicitly including human driver information.\nFig. 4 depicts the block diagram of the human-based risk model of this paper. In addition to the risk model, the human-based risk model includes two further components: perceived Risk Maps and risk factor personalization. Perceived Risk Maps (grey block) is a driver behavior planner like the pre-viously mentioned Risk Maps planner but considers vehicle states and driver errors in the planning to model the driver perception. The risk model (blue block) uses the planned driver behavior of perceived Risk Maps. Concretely, the risk is computed by predicting the vehicle of the driver with the found driver behavior of perceived Risk Maps and the other vehicles with a general constant velocity assumption.\nThe risk factor personalization (grey block) allows finally to further adapt the driver support to the current driver type. Perceived Risk Maps and the risk model is additionally parametrized based on the risk factor personalization com-ponent.\nIn this paper, we focus on using sensed human factors for human driver modeling and improved driver warning support. We will therefore assume a driver state estimation module that senses human factors as given. For approaches of state estimation modules, please refer, for example, to the work of [6]. Estimating the driver state from sensors is another research work by itself."}, {"title": "A. Perceived Risk Maps", "content": "Perceived Risk Maps uses the three driver errors of notice error, forecast error and inference error that describe the current perception of the driver. A notice error models the condition that the driver is unaware of another object. If the driver has not seen the other object, or has seen it more than a fixed time ago, the driver might not be aware of this object. We define the interface of the notice error for perceived Risk Maps using\n$O_{per} = \\begin{cases} aware, & \\text{for NE} \\in [0,0.5), \\\\ not \\ aware, & \\text{for NE} \\in [0.5, 1], \\end{cases}$\nwith the discrete variable $O_{per}$ describing the perceived awareness for the object and an estimated value of the notice error NE from a state estimation module. The driver can be either aware or not aware of the other object. These variables and all following variables are dynamic and defined for the current time t, which gives us oper(t) and NE(t).\nA forecast error represents the condition that the driver estimates the velocity of another vehicle incorrectly. We thus define the interface of the forecast error as\n$V_{per} = V_{obj} + FE \\cdot V_{off}, \\text{ for FE } \\in [0, 1],$ \nin which the contained $V_{per}$ is the perceived velocity of another vehicle for the driver and FE represents the forecast error from a state estimation module. The error defines how much an offset value $v_{off}$ changes the correct, objective velocity $v_{obj}$, whereby $v_{off}$ is a parameter and can be chosen depending on the driver state.\nLastly, an inference error describes a driver that predicts the intention of another vehicle (i.e., driving path) wrong. We define the interface of the inference error as\n$p_{per} = \\begin{cases} p_{obj}, & \\text{for IE} \\in [0,0.5), \\\\ p_{pred}, & \\text{for IE} \\in [0.5, 1]. \\end{cases}$\nIn the equation, two paths are here given. First, the correct, objective future path of the other vehicle pobj and second, the predicted path from the ego driver for the other vehicle ppred."}, {"title": "B. Risk Factor", "content": "The risk factor defines the driver types for driver personalization. Besides the driver types of a defensive driver and confident driver from the introduction of this paper, we also consider a normal driver type in this paper that lies in between the two driver types.\nIn the risk model, the risk factor is defined as an additional parameter for the Gaussian method. We scale the maximum assumed uncertainties $\\Sigma_1$ and $\\Sigma_2$ of the two-dimensional Gaussian distributions in the vehicle predictions with the risk factor $\\alpha$. For example, a defensive driver holds a high value for the risk factor. A defensive driver sees high uncertainty in the future behavior of vehicles and prefers to keep distance to other vehicles. In the same manner, a normal driver holds a medium-sized value and a confident driver holds a low value for the risk factor. While a normal driver keeps reasonable distances to other vehicles, a confident driver keeps low distances to other vehicles, both based on the amount of assumed uncertainty from the risk factor.\nWe define the collision probability $P_{coll}(t, \\alpha)$ after personalization as\n$P_{coll}(t + s; \\alpha) \\sim det |2\\pi(\\Sigma_1(\\alpha) + \\Sigma_2(\\alpha))|^{-\\frac{1}{2}} exp{-\\frac{1}{2} (\\mu_2 - \\mu_1)^T (\\Sigma_1(\\alpha) + \\Sigma_2(\\alpha))^{-1} (\\mu_2 - \\mu_1)}.$\nThe equation denotes the uncertainty dependencies to the risk factor $\\alpha$ with $\\Sigma_1(\\alpha)$ and $\\Sigma_2(\\alpha)$. For better readability, we did not write out the dependency of the mean positions and uncertainties on the prediction time t + s.\nIn a last step, the personalization component considers a further risk weight that is computed based on the risk factor. The risk weight wa adapts the strength of the warning signal to match the driver's expectation. The weight is linearly dependent on the risk factor and leads for a defensive driver to overestimate the risk ($w_a > 1$) and for a confident driver to underestimate the risk ($w_a > 1$) compared to a normal driver ($w_a = 1$). We write accordingly\n$W(t) = w_a * R(t, \\alpha, V_{tar}).$\nfor the warning signal. The warning signal W(t) is overall dependent on the risk weight wa, the risk factor $\\alpha$ and the found driver behavior $V_{tar}$ from perceived Risk Maps."}, {"title": "C. Parametrization", "content": "The human-based risk model has several parameters that can be chosen by the designer of the driver support system. We will lastly give an overview of these parameters and show example parameter values. A summary of the parameters is shown in Tab. 1.\nIn perceived Risk Maps, three parameters are given that describe the driver errors. For the forecast error, a vehicle velocity offset $v_{off}$ was introduced. We set the value in this paper to $Voff = -4m/s$ as an example value for inner-city driving. For the inference error, the parameters of a wrongly assumed acceleration behavior for another vehicle were used with $a_{intent}$ and $t_{intent}$. In this paper, we set these parameters to $a_{intent} = -1.5 m/s^2$ and $t_{intent} = 3s$. The parameter values for perceived Risk Maps can potentially also be estimated with a driver state estimation module during real driving.\nRegarding the driver types, the personalized risk factor and personalized risk weight can be tuned by the designer of the driver support system. For each driver type, a different parametrization is needed. Here, it is important to cover a wide range of driving types with the parametrization. In this paper, we set the scaling risk factor for the defensive driver to $\\alpha_{def} = 1$, for the normal driver to $\\alpha_{norm} = 0.5$ and for the confident driver to $\\alpha_{conf} = 0.04$. The risk weights for the different driver types were set to $w_{def} = 10$, $w_{norm} = 1$ and $w_{conf} = 0.1$ in this paper.\nIn comparison, the baseline risk model [15] does not use any human models and therefore does not consider the same set of parameters. The risk factor and risk weight for this risk model equals here the parametrization of the normal"}, {"title": "IV. EXPERIMENTS", "content": "The following section describes the experiments that show driver support using the presented human-based risk model of this paper. In the experiments, simulations were done with a custom simulator written in python. The simulator can simulate vehicles as point masses without detailed vehicle dynamics, allowing for high-level testing of driver support systems. The human driver information of the given driver error and driver type can be set in the simulator and was assumed fix over one simulation.\nOverall, we simulated variations of six interactive driving scenarios. Besides the \"motorcycle lane change\" scenario, which was explained in the introduction, we analyze the scenarios of \"car overtaking\u201d, \u201cpriority intersection\u201d, \u201ccurve taking intersection\", \"bicycle cut-in\" and \"pedestrian cut-in\u201d. The scenarios are depicted in Fig. 5. For each scenario, we varied the system inputs. For the experiments, we then compared our novel approach with the baseline risk model [15] that uses no human driver information.\nIn the next subsection, we will describe the scenario variation in detail. The simulation results are given afterwards and finally, we will conclude with a discussion of the limitations of the experiments and the proposed human-based risk model."}, {"title": "A. Scenario Variation", "content": "To simulate a wide range of driving conditions for the driving scenarios, we simulated each scenario with different driver errors and driver types for the ego driver that is supported by the system. The variations for the driver errors were set either to no driver error for any other vehicle, or to a notice error with NE(t) = 1, forecast error with FE(t) = 1 or inference error with IE(t) = 1 for the most important other vehicle in the scenario. The variations for the driver type included a defensive driver, normal driver or confident driver.\nIn addition, each driving scenario had three variations in which we varied the urgency of the driving scenario. We varied starting distance of the vehicles interacting, velocity of the interaction vehicles or timing of a behavior change in the driving scenario (i.e., timing of the lane change, overtaking or sudden cut-in).\nRegarding parametrization in the human-based risk model, the following guidelines were kept for the driver personalization. First, the defensive risk factor and risk weight were set so that no warning is issued in the results for no driver error, and an earlier warning is achieved when the driver has a driver error compared to the baseline risk model. Second, the confident risk factor and risk weight were set so that fewer false positives were achieved for no driver error, and there is on average no later warning when the driver has a driver error compared to the baseline. These guidelines need"}, {"title": "B. Simulation Results", "content": "The results of the experiments for the human-based risk model show that an improvement of the driver support can be achieved compared to the baseline risk model.\nThe warning time improvement for a defensive driver is shown in Fig. 6, whereby the improvement for a normal driver and the improvement for a confident driver is depicted in Fig. 7 and Fig. 8, respectively. The figures show heatmaps that denote the warning time difference between the proposed human-based risk model and the baseline risk model for the simulation of each scenario variation. The abscissa in the heatmaps shows the scenario variation name and the ordinate shows the driver error which was simulated. The warning time improvements reach up to 5.25 seconds when the driver has a driver error.\nAs can be seen, the scenarios of the motorcycle lane change (i.e., \"motorc. lane change 1 - 3\") and car overtaking (i.e., \"car overtaking 1 - 3\") are the easiest to handle for the human-based risk model. Larger warning time improvements are achieved in all figures because the risk increases slowly over the time in these scenarios and there is more potential to warn earlier. In contrast, the pedestrian cut-in scenario (i.\u0435., \u201cpedestrian cut-in 1 - 3\u201d) is challenging for the proposed risk model. Smaller warning time improvements are achieved in the figures because the risk increases very sudden and there is not much time to warn in advance.\nFor the warning time improvement, Fig. 6 shows that the highest improvement can be achieved for the defensive driver. The driver can be warned on average 1.55 seconds earlier when the driver has a driver error.\nOn the same line, the warning error reduction improvements for a defensive driver, a normal driver and a confident"}, {"title": "C. Discussion", "content": "The experiments show that the proposed human-based risk model of this paper is able to improve driver support and generalizes to the different driving scenarios used in this"}, {"title": "V. CONCLUSION AND OUTLOOK", "content": "In summary, in this paper, we presented a human-based risk model that considers the human driver in driver support. The proposed risk model combines a) the current driver perception with a so-called perceived Risk Maps planner and b) driver personalization with a personalized risk factor. Perceived Risk Maps considers here human-specific driver errors in the behavior planning and the personalization component additionally adapts the warning signal to the given driver type by changing the parametrization.\nIn experiments, the human-based risk model was compared to the baseline risk model from [15] that does not consider the human driver. In simulation variations of six different interactive driving scenarios, the proposed approach was shown to achieve improved driver support. On average, an earlier warning time of 1.55 seconds was achieved for a defensive driver and a warning error reduction of 28% was achieved for a confident driver. The results highlight the generalizability of the approach to different interactive driving scenarios. In comparison to related work, the proposed human-based risk model is the first model that combines driver perception with driver personalization for improved driver support.\nA limitation of the work is that the experiments were done in simulation. In future work, we therefore intend to test the human-based risk model of this paper on real test vehicles in in order to investigate noise effects and error effects from sensed human driver information on the proposed risk model. Moreover, we aim to analyze if the driver prefers the human-based risk model in real vehicle drives. A user study helps to further fine-tune the parameters of the approach. Closing the simulation-to-reality gap of human factors is an essential research direction."}]}