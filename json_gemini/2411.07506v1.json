{"title": "FM-TS: FLOW MATCHING FOR TIME SERIES GENERA-\nTION", "authors": ["Yang Hu", "Xiao Wang", "Lirong Wu", "Huatian Zhang", "Stan Z. Li", "Sheng Wang", "Tianlong Chen"], "abstract": "Time series generation has emerged as an essential tool for analyzing temporal data\nacross numerous fields. While diffusion models have recently gained significant\nattention in generating high-quality time series, they tend to be computationally de-\nmanding and reliant on complex stochastic processes. To address these limitations,\nwe introduce FM-TS, a rectified Flow Matching-based framework for Time Series\ngeneration, which simplifies the time series generation process by directly optimiz-\ning continuous trajectories. This approach avoids the need for iterative sampling\nor complex noise schedules typically required in diffusion-based models. FM-TS\nis more efficient in terms of training and inference. Moreover, FM-TS is highly\nadaptive, supporting both conditional and unconditional time series generation.\nNotably, through our novel inference design, the model trained in an uncondi-\ntional setting can seamlessly generalize to conditional tasks without the need for\nretraining. Extensive benchmarking across both settings demonstrates that FM-TS\nconsistently delivers superior performance compared to existing approaches while\nbeing more efficient in terms of training and inference. For instance, in terms of\ndiscriminative score, FM-TS achieves 0.005, 0.019, 0.011, 0.005, 0.053, and 0.106\non the Sines, Stocks, ETTh, MuJoCo, Energy, and fMRI unconditional time series\ndatasets, respectively, significantly outperforming the second-best method which\nachieves 0.006, 0.067, 0.061, 0.008, 0.122, and 0.167 on the same datasets. We\nhave achieved superior performance in solar forecasting and MuJoCo imputation\ntasks, significantly enhanced by our innovative t power sampling method. The\ncode is available at https://github.com/UNITES-Lab/FMTS.", "sections": [{"title": "INTRODUCTION", "content": "Time series data is fundamental to modern data\nanalysis, serving as a cornerstone in diverse\ndomains such as finance, healthcare, energy\nmanagement, and environmental studies (Lim\nand Zohren, 2021; Ye et al., 2024; Dama and\nSinoquet, 2021; Liang et al., 2024). How-\never, acquiring high-quality time series data\noften presents significant challenges, including\nstringent privacy regulations, prohibitive data\ncollection costs, and data scarcity in certain\nscenarios. These challenges highlight the poten-\ntial benefits of synthetic time series data, which\ncan provide a cost-effective solution for data\nscarcity, overcome privacy concerns, and offer\nflexibility in generating diverse scenarios representing a wide range of possible patterns and trends.\nTo obtain high-quality synthetic data, there is a pressing need for advanced time series generation tech-\nniques that can produce realistic and diverse patterns, accurately reflecting real-world complexities\nand variations.\nRecent years have witnessed significant advancements in time series generation, ranging from VAE-\nbased approaches (Desai et al., 2021; Xu et al., 2020) to diffusion models (Kong et al., 2021;\nTashiro et al., 2021), demonstrate remarkable capabilities in capturing complex temporal dynamics.\nWhile these studies have paved new paths for time series modeling (Coletta et al., 2023; Yoon\net al., 2019a), important challenges remain in theoretical foundations and computational efficiency.\nDiffusion models (Ho et al., 2020; Song et al., 2020a;b) are then utilized for time series generation,\nyield exceptional generative quality. They offer several advantages, including their ability to capture\nlong-range dependencies and generate diverse, high-quality samples. However, diffusion models\nsuffer from slow generation speeds and high computational cost due to the requirement of many steps\nto infer (see figure 1 and (Nichol and Dhariwal, 2021)). Moreover, diffusion models struggle to\npreserve the long-term dependencies and intricate patterns inherent in time series data (Rasul et al.,\n2021).\nRecently, rectified flow matching (Liu et al., 2022) has emerged as a promising generative modeling\napproach, because of its efficiency and capacity for scalability (Esser et al., 2024a). Rectified flow\nmatching optimizes neural ordinary differential equation (ODE) to transport between distributions\nalong approximately straight paths, solving a nonlinear least squares problem. This approach offers\nmore efficient sampling than diffusion models through approximately straight paths, while providing\na unified framework for generative modeling and domain transfer with theoretical guarantees on\ntransport costs (Liu et al., 2022).\nIn contrast to diffusion models, rectified flow matching directly maps the latent space to the data space,\nwhereas diffusion models must learn to denoise data based on a scheduled noise-adding process.\nIn addition, rectified flow matching requires only a single forward pass for sampling (Liu et al.,\n2022), significantly enhancing both efficiency and performance. Rectified flow matching has shown\nsuperior performance in various tasks, including image generation (Kim et al., 2024; Mehta et al.,\n2024; Kuaishou Technology, 2024). However, it has not yet been applied to time series generation,\nprimarily due to the unique characteristics of time series data, such as temporal dependencies and\npotential seasonality.\nTo address these challenges, we introduce FM-TS, a flow matching based framework for time series\ngeneration. Our method not only inherits the efficiency of rectified flow matching but can also\ngeneralize in both unconditional and conditional settings. The main contributions of this work are:\n\u2022 FM-TS consistently outperforms existing state-of-the-art methods across a variety of time se-\nries generation datasets with notable efficiency (see Figure 1). To the best of our knowledge,\nthis work is the first to utilize rectified flow matching to time series generation.\n\u2022 For conditional time series generation, we also introduce a simple yet powerful sampling\ntechnique: t power sampling, a simple timestep shifting method (used in generation), which\ncan boot performance of conditional generation quite a lot.\n\u2022 With our novel inference design, the model trained in an unconditional setting can seamlessly\ngeneralize to conditional tasks without requiring retraining and redundant gradient-based\noptimization steps like (Yuan and Qiao, 2024).\nThe experiments on various tasks demonstrate that the proposed framework can significantly boost\nperformance through rectified flow matching. We achieve most state-of-the-art, e.g., FM-TS can\nachieve context fid (lower is better) with 0.019, 0.011 on stocks, ETTh unconditional generation\ndatasets while previous best result is 0.067, 0.061. On solar forecasting tasks, our method achieves\nan MSE of 213, outperforming the previous best result of 375 (Yuan and Qiao, 2024) by 43.2%."}, {"title": "RELATED WORK", "content": "Generating realistic time series data has attracted significant attention in recent years, driven by\nthe need for high-quality synthetic data in various domains such as finance, healthcare, and energy"}, {"title": "TIME SERIES GENERATION", "content": "management (Lim and Zohren, 2021). Unconditional time series generation (Nikitin et al., 2023) is to\ngenerate time series data without specific constraints to mimic statistical properties and patterns of real\ndata. Conditional time series generation is to Generate time series data based on specific conditions\nor constraints, like forecasting (Alcaraz and Strodthoff, 2022a) and imputation (Tashiro et al., 2021).\nEarly time series generation approaches primarily utilized Generative Adversarial Networks (GANs)\n(Goodfellow et al., 2014). Notable works in this category include TimeGAN (Yoon et al., 2019a),\nwhich incorporates an embedding network and supervised loss to capture temporal dynamics, and\nRCGAN (Esteban et al., 2017), which uses a recurrent neural network architecture conditioned on\nauxiliary information for medical time series generation. Both TimeGAN and RCGAN are capable\nof conditional generation, with RCGAN specifically designed for conditional tasks, while TimeGAN\ncan be adapted for both conditional and unconditional generation."}, {"title": "DIFFUSION MODELS FOR TIME SERIES", "content": "Recently, diffusion models, particularly Denoising Diffusion Probabilistic Models (DDPMs) (Ho\net al., 2020), have emerged as a powerful paradigm for generative modeling across various domains.\nDiffusion models offer better perceptual quality compared to GANs, avoiding optimization issues in\nadversarial training. In the context of time series, diffusion models have shown promising results in\ntasks such as audio synthesis (Kong et al., 2020), time series imputation (Tashiro et al., 2021), and\nforecasting (Rasul et al., 2021). (Rasul et al., 2021) proposed TimeGrad, a conditional diffusion model\nthat predicts in an autoregressive manner, guided by the hidden state of a recurrent neural network.\nTashiro et al. (2021) and Alcaraz and Strodthoff (2022a) adapt diffusion models for time series\nimputation using self-supervised masking strategies. Shen and Kwok (2023) introduced TimeDiff,\na non-autoregressive diffusion model that addresses boundary disharmony issues in time series\ngeneration. For unconditional time series generation, Lim et al. (2023) employed recurrent neural\nnetworks as the backbone for generating regular 24-time-step series using Score-based Generative\nModels (SGMs). Kollovieh et al. (2024) proposed a self-guiding strategy for univariate time series\ngeneration and forecasting based on structured state space models. However, these methods suffer\nfrom slow generation speeds, high computational costs, and a complex sampling schedule."}, {"title": "FLOW MATCHING FOR GENERATION", "content": "Rectified flow matching (Liu et al., 2022) is a simple ODE method for high-quality image generation\nand domain transfer with minimal steps, differing from diffusion models by avoiding noise and\nemphasizing deterministic paths. Compared to diffusion methods, it has two main advantages,\nstability of training and effectiveness of inference. Rectified flow matching has shown remarkable\nresults in video generation (Kuaishou Technology, 2024), image generation stable diffusion 3 (Esser\net al., 2024b) and flux (bla, 2024), point cloud generation (Wu et al., 2023) (Kim et al., 2024),\nprotein design (Campbell et al., 2024; Jing et al., 2024), human motion generation (Hu et al.,\n2023), TTS (Mehta et al., 2024; Guan et al., 2024; Guo et al., 2024). Despite the great success\nand effectiveness of rectified flow matching, flow matching has not yet been applied to time series\ngeneration. Witnessing the great potential of flow matching for this task, that motivates to propose\nFM-TS for time series generation on both unconditional and conditional settings."}, {"title": "METHOD", "content": "In this section, we present FM-TS, our novel framework for time series generation based on rectified\nflow matching. We begin by introducing the problem setting, then providing an overview of the\nFM-TS framework, followed by the inference pipeline of FM-TS for unconditional and conditional\ntime series generation, respectively."}, {"title": "PROBLEM STATEMENT", "content": "Unconditional Time Series Generation Unconditional time series generation focuses on producing\nsequential data without any conditions, where the model learns underlying temporal patterns from a\ntraining set and generates new sequences that follow a similar distribution. Formally, the problem is\ndefined as follows:"}, {"title": "RECTIFIED FLOW MATCHING FOR TIME SERIES GENERATION.", "content": "In FM-TS, we propose to learn rectified flow as the model G for time series generation. Rectified\nflow (Liu et al., 2022) is a method of learning ordinary differential equation (ODE) models to\ntransport between two empirical distributions $\u03c0_0$ and $\u03c0_1$. In our setting, $\u03c0_0$ is $N(0, I)$, and $\u03c0_1$ is the\ntarget distribution, where $X_{1:\u2113} \u223c \u03c0_1$. Thus, the problem can be reformulated as: given empirical"}, {"title": "SAMPLING PROCESS FOR INFERENCE", "content": "To generate new time series, we use a sampling process that follows the shifting of timestep schedules\napproach (Esser et al., 2024b). Starting from $Z_0 \u223c N(0, 1)$, we iteratively refine it using:\n$Z_{(i+1)/N} = Z_{i/N} + (t_{shifted} - t_i^{k}) \\cdot G(Z_{i/N}, t_{shifted})$"}, {"title": "EXPERIMENTS", "content": "Our evaluation employs six diverse datasets: The 3 real-world datasets include Stocks * for measuring\ndaily stock price data, ETTh\u2020 (Zhou et al., 2021) for interval electricity transformer data, and"}, {"title": "UNCONDITIONAL TIME SERIES GENERATION", "content": "We benchmarked FM-TS against other methods for un-\nconditional time series generation across six datasets. As\nshown in Table 1, FM-TS consistently outperforms other\nmethods on most evaluation metrics. On the discrimina-\ntive score, FM-TS achieves 0.005, 0.019, 0.011, 0.005,\n0.053, and 0.106 on the Sines, Stocks, ETTh, MuJoCo,\nEnergy, and fMRI datasets, respectively. In comparison,\nthe second-best method, Diffusion-TS, achieves 0.006,\n0.067, 0.061, 0.008, 0.122, and 0.167 on the same datasets.\nThis represents a reduction in discriminative score ranging\nfrom 17% to 82%, validating FM-TS's great improvement.\nWe attribute this superior performance to the synergy of\nrectified flow matching with time series-specific optimiza-\ntions.\nIn Table 2, we extended unconditional time series generation to longer sequences (64, 128, 256) on\nETTh and Energy datasets. We observe FM-TS excels on the ETTh dataset, achieving best scores in\n11 out of 12 metrics (except on Discriminative score with 256-length on Energy dataset) across all\nlenghts, with particularly strong performance in Context-FID. On the Energy dataset, FM-TS shows\nmixed results, outperforming in Context-FID but a little bit falling behind Diffusion-TS in others,\nsuggesting dataset-specific characteristics may influence its effectiveness on longer sequences."}, {"title": "EFFICIENCY BENCHMARK OF FM-TS", "content": "Compared to Diffusion-TS (Yuan and Qiao, 2024), FM-TS not only delivers superior perfor-\nmance across various settings but also demonstrates significantly better efficiency in both train-\ning and inference. To evaluate training efficiency, we benchmarked FM-TS and Diffusion-TS\nacross multiple training epochs on the Energy dataset. As shown in Figure 1, We observe\nthat FM-TS consistently achieves superior FID scores compared to Diffusion-TS, with train-\ning epochs ranging from 2,500 to 25,000. Notably, FM-TS outperforms even with as few as\n30 iterations ($N = 30$), whereas Diffusion-TS can not achieve even with 200 inference steps.\nThe observed efficiency in terms of required iterations N can be attributed to the straightness\nproperty of rectified flow matching, a phenomenon extensively studied by Liu et al. (2022).\nTo further assess inference\nefficiency, we compared the\nfinal models of FM-TS and\nDiffusion-TS, testing differ-\nent numbers of iterations\n(N) during sampling for in-\nference. As seen in Fig-\nure 3, FM-TS not only de-\nlivers better performance but also achieves faster inference times compared to Diffusion-TS, highlight-\ning its efficiency advantages. This empirical evidence indicates that FM-TS is capable of facilitating\nmore rapid and accurate time series generation."}, {"title": "CONDITIONAL TIME SERIES GENERATION", "content": "After validating FM-TS on unconditional time series generation, we further assessed its\ngeneralizability for conditional time series generation. Instead of retraining the model, we employed\nthe specialized inference algorithm, detailed in Algorithm 1, to incorporate observed information into\ninference for conditional setting. As stated in Section 3.1, conditional time series generation includes\ntwo primary tasks: forecasting and imputation. To demonstrate the effectiveness of FM-TS, following\nthe practice in (Alcaraz and Strodthoff, 2022a) and (Tashiro et al., 2021), we benchmarked it on\nSolar and Mujoco datasets."}, {"title": "VISUALIZATION COMPARISON OF FM-TS", "content": "To offer a more direct comparison be-\ntween generated and target sequences,\nwe followed the practices outlined\nin (Yuan and Qiao, 2024), mapping\nboth generated and target sequences\ninto an embedding space using PCA\n(Shlens, 2014) and t-SNE (Van der\nMaaten and Hinton, 2008). In\nFig. 5a, 5d, 5b, 5e, we present a\ncomparison of PCA and t-SNE visu-\nalizations between sequences gener-\nated by FM-TS and Diffusion-TS, as\nwell as the corresponding target se-\nquences. It is evident that the embed-\ndings from FM-TS show greater con-\nsistency with the target sequences in\nboth visualizations, highlighting the\nsuperior performance of FM-TS. We\nfurther analyzed the results using ker-\nnel density estimation (KDE) (Chen,\n2017), shown in Fig. 5c and 5f. The\nKDE for FM-TS aligns more closely\nwith the target sequences, especially\non the right slope, where Diffusion-\nTS exhibits noticeable fluctuations, further validating FM-TS's superior accuracy."}, {"title": "ABLATION STUDY", "content": "In this section, we will study the key components in FM-TS framework to understand their\ncontributions."}, {"title": "CONCLUSION", "content": "We introduced FM-TS, a novel time series generation framework based on rectified flow matching.\nFM-TS achieves efficient one-pass generation while maintaining high-quality output. Experimental\nresults demonstrate FM-TS's superior speed in training and inference, consistently outperforming\nstate-of-the-art methods across various datasets and tasks in both conditional and unconditional\ngeneration. A key innovation of FM-TS is the novel t power sampling technique, which significantly\nenhances performance in conditional generation tasks. By using $t^k$ with $k < 1$, the model focuses\non later steps in the generation process, allowing for more effective incorporation of conditional\ninformation. This adaptive sampling strategy proves particularly beneficial in tasks like forecasting\nand imputation, where FM-TS demonstrates substantial improvements over existing methods."}]}