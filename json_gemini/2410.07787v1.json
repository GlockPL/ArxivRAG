{"title": "Mastering Contact-rich Tasks by Combining Soft and Rigid Robotics with Imitation Learning", "authors": ["Mariano Ram\u00edrez Montero", "Ebrahim Shahabi", "Giovanni Franzese", "Jens Kober", "Barbara Mazzolai", "Cosimo Della Santina"], "abstract": "Soft robots have the potential to revolutionize the use of robotic systems with their capability of establishing safe, robust, and adaptable interactions with their environment, but their precise control remains challenging. In contrast, traditional rigid robots offer high accuracy and repeatability but lack the flexibility of soft robots. We argue that combining these characteristics in a hybrid robotic platform can significantly enhance overall capabilities. This work presents a novel hybrid robotic platform that integrates a rigid manipulator with a fully developed soft arm. This system is equipped with the intelligence necessary to perform flexible and generalizable tasks through imitation learning autonomously. The physical softness and machine learning enable our platform to achieve highly generalizable skills, while the rigid components ensure precision and repeatability.", "sections": [{"title": "Introduction", "content": "In the quickly advancing field of robotics, combining new technologies to enhance robot performance and efficiency is crucial. Soft robots (1, 2), recognized for their flexibility and adaptability to complex and unpredictable environments (3), are particularly valuable in agriculture (4, 5), underwater exploration (6\u20138), and grasping applications (9, 10). They are typically made from flexible and stretchable materials like silicone and smart polymers, with their movement driven by systems such as pneumatic and hydraulic pumps (11\u201313), electric actuators (14\u201316), cable-driven actuators (17, 18), and other mechanisms (19, 20). The octopus arm is particularly notable among bio-inspired soft robotic designs (16, 18, 21). Its unique ability to bend, twist, and grasp objects in multiple directions precisely and delicately makes it an ideal model for developing soft robots. This biological design forms the basis for versatile robotic systems that can perform complex tasks in environments requiring flexibility and adaptability.\nOn the other hand, rigid robots, made from materials like metals and hard plastics, are designed for high precision, strength, and durability tasks. These robots work especially well in manufacturing and assembly lines, where consistent performance and precise movements are essential.\nWe argue that integrating soft and rigid robots has the potential to combine their strengths, creating a new class of robots with enhanced capabilities. For instance, these hybrid systems can use the softness and flexibility of soft robots to grasp fragile objects safely, either by using soft grippers (22\u201325) or incorporating them into locomotion robots to grasp and move items (26). Additionally, some researchers focus on combining rigid drones and soft grippers (27, 28).\nNonetheless, while many variations of this soft gripper approach exist, we also believe it is worthwhile to consider more complex hybrids. For example, combining a larger soft robot that can perform whole body grasping with a rigid robot, which is exactly the case we consider in the hybrid platform we propose.\nHowever, we also note that combining soft and rigid robots presents several challenges, such as coordinating movements between the soft and rigid components to achieve precise control. Moreover, the question of how to design systems that effectively combine the advantages of both types of robots is still largely unexplored. For example, for a rigid manipulator with a traditional parallel gripper, there is a clear point one can consider the end-effector. In the case of a soft arm, it is harder to define a clear end-effector point, especially when doing whole-body grasping, which can make it harder to explicitly program skills and behaviors. Because of this, applying imitation learning (29) to such hybrid platforms can be particularly valuable. Moreover, imitation learning allows non-expert users to teach robots more easily.\nWe thus propose a novel hybrid robotic platform that combines a rigid 7-DoF robotic manipulator and a cable-driven soft arm, shown in Figure 1 manipulating an obejct, and showcase"}, {"title": "Results", "content": "We showcase three manipulation skills with our platform. First, a stacking task where three cylindrical objects of different radii have to be stacked on each other. Second, a picking task, but where the object must be manipulated through a narrow opening. Finally, we grasp hollow objects by taking advantage of the soft embodiment of our hybrid platform.\nIn all experiments we first provide a single kinesthetic demonstration (see Figure 2a) where the 6D poses of the robot end-effector are recorded. We use buttons at the top of the robot to control two servos which pull the cables of the soft arm during demonstrations, and we also record the states (positions) of the servos. Our learned policy can then output a new desired pose and new servo positions based on the current state. We also record the position of our source keypoints before providing the single demonstration, where we use AprilTags cite and a Realsense D405 to track these chosen keypoints. By observing the new positions of our keypoints, we can then generalize our learned skill to new situations. See the Material and Methods section below for more details."}, {"title": "Stacking task", "content": "In the first task there are three cylindrical cups of different radii, and the robot has to pick the medium-size cup, stack it on the smallest cup, pick the largest cup, and finally stack it on the medium cup, as Figure 2a shows. For this task the keypoints we record are the positions of the three objects. Figure 2b shows how after providing a single demonstration, the robot is able to replicate the task in a configuration of the objects similar to the original one during the demonstration. We then move the red and purple objects to new positions, and the robot is still able to successfully perform the task, as shown in Figure 2c. Note that since the three objects did not move rigidly together, the transformation between the original and new positions of the keypoints is non-linear, and being able to deal with this non-linearity is a key element of our generalization method."}, {"title": "Manipulation through narrow openings", "content": "Apart from more conventional manipulation tasks such as stacking, we also wanted to highlight the possibilities this hybrid platform provides compared to a conventional rigid robot. For example, with this task we show how we are able to slip the soft arm through a narrow opening to manipulate an object that is behind the obstacles creating the opening, see Figure 3. We also note how the soft arm allows us to perform the task with both a smaller and a bigger object using the same skill since it naturally conforms to these different sizes, as shown in Figure 3b and Figure 3c."}, {"title": "Unconventional grasping strategies", "content": "We also show how the soft arm can be taken advantage of to manipulate hollow objects in an unconventional way: by going inside these objects and twisting the arm, so that it tightens against the object, see Figure 4. This can make it easier to manipulate different hollow objects with the same skill, as Figures 4a and 4c show."}, {"title": "Material and Methods", "content": "Our hybrid platform's main components are a rigid 7-DoF Franka Emika Panda robotic manipulator and the soft cable-driven arm, both shown in Figure 5. We use two Dynamixel servos to control the cables, which are inside the black cylindrical casing also shown in Figure 5. Finally, for perception, we use a Realsense D405 depth camera, which is especially important to detect keypoints and thus generalize our skills to new situations. We use impedance control on the rigid manipulator, which allows us to easily provide kinesthetic demonstration by making the robot compliant. The Dynamixel servos are controlled using the buttons on top of the rigid robot, specifically, the servo will move by a pre-defined amount in a specific direction depending on which button is pressed."}, {"title": "Soft cable-driven arm", "content": "The soft robotic arm was designed to replicate a real octopus arm's flexibility and movement capabilities (see Figure 6). This design enables the arm to navigate and operate effectively in various environments, especially limited or irregularly shaped ones. The arm has a total length of 380 mm, which allows it to wrap securely around objects. The arm is designed with a tapering profile, where its maximum diameter at the base is 35 mm, gradually reducing to 7 mm at the tip. This tapered design enhances the arm's ability to perform delicate and precise manipulations, similar to the natural movements of an octopus.\nThe arm is fabricated from a soft, flexible material (Ecoflex 00-50), crucial for achieving the desired range of motion and adaptability. This material choice enables the arm to bend, twist, and conform to various shapes and surfaces, much like an octopus's arm.\nThe movement of the arm is actuated by a cable-driven mechanism. These cables are attached to pulleys rotated by a servo motor (DYNAMIXEL MX-28). This setup provides control over two separate types of motion: twisting and bending. The twisting motion is controlled by the purple cable located in the lower left side of the arm, changes direction approximately a quarter of the way up, and then extends to the top right corner. This configuration allows the arm to perform a smooth and controlled twisting motion. Additionally, the bending motion is controlled by the blue cable, which runs along the arm's length. When this cable is pulled, it causes the arm to bend ventrally, mimicking the bending motion observed in natural octopus arms."}, {"title": "Skill Learning and Generalization", "content": "When learning a robot policy from kinesthetic demonstration, a set of robot poses and servo positions are aggregated during a demonstration. Throughout the paper, we denote the available policy labels as:\n\u2022 The set of $M$ Cartesian position labels $X = \\{x_1,x_2,...,x_M\\}$, where $x_i \\in \\mathbb{R}^3$.\n\u2022 The set of $M$ Cartesian orientation labels $R = \\{R_1, R_2, . . ., R_M\\}$, where $R_i \\in SO(3)$.\n\u2022 The set of $M$ servo positions $L = \\{l_1, l_2, . . ., l_M\\}$, where $l_i \\in \\mathbb{R}^{2+}$.\nWhere $\\mathbb{R}^3$ denotes the 3-dimensional Euclidean space, $SO(3)$ represents the special orthogonal group of 3x3 rotation matrices, and $\\mathbb{R}^{2+}$ the 2-dimensional positive real values of the servos' positions. When executing the skills, the closest element in position and time with respect to the current state is selected. The desired pose of each robot state is chosen as the next one in the demonstration. The pose is tracked using a low-level Cartesian impedance controller. The reactive choice of the attractor and the low-level impedance controller ensures a safer interaction with the environment and human disturbances (31).\nTo generalize learned skills to new situations, for example different object positions, we use the method presented in (30). Defined source keypoints are tracked during the single demonstration provided for a given skill, so that given new target keypoints, we can still perform the learned skill. These keypoints thus parametrize our learned skills. We summarize here the main aspects of the method, and detail an extension we had to apply to adapt the method to our hybrid platform.\nWe can first define a source distribution $S$, which contains the positions of our $N$ keypoints in Cartesian space, i.e.,\n$S = \\{s_1, s_2, . . ., s_n\\}$, where $s_i \\in \\mathbb{R}^3$,\nand a target distribution $N$ target keypoints $T$, i.e.,\n$T = \\{t_1, t_2, . . ., t_n\\}$, where $t_i \\in \\mathbb{R}^3$.\nNote that we assume that these points are already registered, i.e. the i-th target keypoint is the new position of the i-th source keypoint. Our goal is then to find a (non-linear) deformation map $\\phi$ which deforms the spaces such that to overlap the source points on the target points, i.e.,\n$T = \\phi(S)$.\nGiven the fitted deformation map, we can transport the recorded poses, i.e. position and orientation, using the map and its derivatives, i.e, the transformed Cartesian trajectory becames\n$\\hat{X} = \\varphi(X)$,\nand the transformed end effector orientation becomes\n$R = J_\\varphi R$.\nwhere matrix $J_\\varphi$ is obtained through the polar decomposition of $J$, defined as the partial derivation of the map $\\frac{\\partial \\varphi(X)}{\\partial X}$. The polar decomposition ensures that $J_\\varphi$ is a proper rotation matrix within $SO(3)$, see (30).\nWe note that an implicit assumption of the space deformation-based generalization method is that the trajectory will be deformed according to its proximity to the source keypoints. While this applies to many manipulation tasks with a rigid robot, where the end-effector position can be unambiguously defined and tracked, this assumption is less valid with a soft robot. We thus enhance the source keypoint definition by updating them with the closest (and ideally most relevant) point on the trajectory and shift the target distribution of the same amount.\nIn practice, we find the new, projected source distribution points $\\hat{s}_i$ on the Cartesian demonstration $X$,\n$\\hat{s}_i = \\underset{x \\in X}{argmin} ||x - s_i||$,\nwe then calculate the shift $\\Delta_i$ for each keypoint from the old and the new source distribution,\n$\\Delta_i = \\hat{s}_i - s_i$,\nand perturb the target key points of the same amount, i.e.,\n$\\hat{t}_i = t_i + \\Delta_i$.\nWith these updated source and target distributions $\\hat{S}$ and $\\hat{T}$, the generalization method outlined before (and in (30)) can be used in the same way to transport the original demonstration."}, {"title": "Conclusion and Discussion", "content": "We present a hybrid soft and rigid robotic platform, which we argue achieves enhanced performance through this combination of soft and rigid elements. Moreover, we address the challenge of creating intelligent behaviour with such hybrid platforms through the use of imitation learning, which remains largely unexplored in the context of soft robotics.\nBy performing a stacking task, we show how our platform can perform more conventional manipulation tasks, and we show how we can generalize to new object configurations from a single demonstration. We also showcase the unique possibilities that the soft arm presents, such as manipulation through narrow openings or grasping hollow objects by twisting inside these objects."}]}