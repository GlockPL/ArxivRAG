{"title": "FOCUS on Contamination: A Geospatial Deep Learning Framework with a Noise-Aware Loss for Surface Water PFAS Prediction", "authors": ["Jowaria Khan", "Alexa Friedman", "Sydney Evans", "Runzi Wang", "Kaley Beins", "David Andrews", "Elizabeth Bondi-Kelly"], "abstract": "Per- and polyfluoroalkyl substances (PFAS), chem-icals found in products like non-stick cookware,are unfortunately persistent environmental pollu-tants with severe health risks. Accurately mappingPFAS contamination is crucial for guiding targetedremediation efforts and protecting public and en-vironmental health, yet detection across large re-gions remains challenging due to the cost of test-ing and the difficulty of simulating their spread. Inthis work, we introduce FOCUS, a geospatial deeplearning framework with a label noise-aware lossfunction, to predict PFAS contamination in surfacewater over large regions. By integrating hydrologi-cal flow data, land cover information, and proxim-ity to known PFAS sources, our approach leveragesboth spatial and environmental context to improveprediction accuracy. We evaluate the performanceof our approach through extensive ablation stud-ies and comparative analyses against baselines likesparse segmentation, as well as existing scientificmethods, including Kriging and pollutant transportsimulations. Results highlight our framework's po-tential for scalable PFAS monitoring.", "sections": [{"title": "1 Introduction", "content": "PFAS or per- and polyfluoroalkyl substances are persistent\n\"forever chemicals\" widely used in industrial and consumer\nproducts such as non-stick cookware, waterproof textiles\nand firefighting foams. Unfortunately, these substances resist\ndegradation and accumulate in water, soil, and living organ-isms, with 97% of Americans exhibiting detectable levels in\ntheir blood [CDC, 2024]. Such pervasive exposure is linked\nto severe health risks including cancers, liver damage, and\ndevelopmental disorders [Manz, 2024].\nAlthough PFAS contamination is widespread and present\nin surface water [Langenbach and Wilson, 2021], groundwa-ter [Schroeder et al., 2021], and soil [Crone et al., 2019], the\nhigh cost of sampling has resulted in sparse ground truth data,\nleaving us uncertain about where the highest concentrations\noccur. This lack of detailed spatial information hampers tar-geted remediation and calls for scalable, data-driven methods\nto identify PFAS hotspots and safeguard drinking water.\nArtificial intelligence (AI) presents a promising avenue for\naddressing complex health and environmental issues, includ-ing identifying PFAS hotspots. In various domains, AI has\nproven effective at automating labor-intensive tasks and syn-thesizing domain expertise, whether in land cover mapping\n[Robinson et al., 2020], agricultural optimization [Kerner et\nal., 2024], or disease prediction [Bondi-Kelly et al., 2023].\nIn the domain of PFAS contamination prediction, scientists\nhave predominantly applied machine learning (ML) models\nsuch as random forests [Breiman, 2001] and XGBoost [Chen\nand Guestrin, 2016]. For example, [DeLuca et al., 2023] used\na Random Forest model to predict PFAS contamination in the\nColumbia River Basin via a tabular approach that aggregates\nenvironmental features within a 5 km buffer around sample\npoints, which helps account for the limited ground truth data.\nBuilding on these efforts, we frame PFAS prediction as a\ngeospatial deep learning (DL) task. Our approach directly\nprocesses imagery, preserving spatial dependencies and re-ducing the need for extensive feature engineering, leading to\nmore efficiency. This approach will also allow for repeated,\nhigh-resolution mapping to support ongoing monitoring ef-forts.\nOur contributions in this work are summarized as follows:\n\u2022 We propose FOCUS (Framework for Environmental\nContamination with Uncertainty Scaling), a framework\nemploying a geospatial DL model for segmentation"}, {"title": "2 Related Work", "content": "The study of PFAS contamination has gained significant at-tention due to its widespread environmental and health im-pacts. Existing research in this domain spans analytical meth-ods from scientific domains for detecting and understandingcontamination patterns, as well as emerging computationalapproaches, including AI techniques, aimed at improving de-tection and prediction capabilities.\nCurrent Ways to Measure and Predict PFAS. The mea-surement of PFAS relies on laboratory-based analysis of wa-ter, fish tissue, and human blood samples with techniquessuch as liquid chromatography-tandem mass spectrometry(LC-MS) [Shoemaker and Tettenhorst, 2020]. Fish accumu-late PFAS over time, serving as integrative indicators of watercontamination hotspots that may be missed by sporadic watersampling. Therefore, fish tissue measurements provide com-plementary, long-term insights into PFAS presence, as well\nas potential exposure risks to anglers [Environmental Work-ing Group, 2023]. While highly accurate, these methods arecostly [Doudrick, 2024], time-intensive, and difficult to scalefor large spatial datasets.\nPFAS monitoring efforts have made use of such measure-ment techniques and beyond. For example, states such asColorado have implemented water testing, treatment grants,and regulatory measures since 2016 [Colorado Department\nof Public Health and Environment, nd]. In addition, thereare community-based water sampling initiatives such as vol-unteer sampling by the Sierra Club [Sierra Club, nd] and fo-cused efforts by organizations like the Ecology Center [Eco-Center, nd]. A recent study further underscores the impor-tance of these efforts, revealing associations between PFAScontamination in drinking water and higher COVID-19 mor-tality rates in the U.S. [Liddie et al., 2024]. Resources like\nthe PFAS-Tox Database [Pelch et al., 2022] further assistresearchers, policymakers, and communities in monitoringPFAS. These efforts are important and complementary toFOCUS; we aim to bridge critical data gaps and provide con-tinuous, scalable predictions until additional sampling can becarried out.\nVarious modeling approaches have been explored to pre-dict contaminant distribution. Hydrological models such asSWAT [SWAT, nd] and MODFLOW [ktorcoletti, 2012] sim-ulate pollutant transport using environmental parameters likeflow rates, land use, and weather conditions. While effective,these models require extensive data and are computationallyexpensive at large scales [Zhi et al., 2024]. Kriging, a geo-statistical interpolation technique, has been widely used formapping pollutants, including soil contamination [Largueche,\n2006] and groundwater quality estimation [Singh and Verma,\n2019]. Though useful in data-sparse environments, Krigingrelies on simplifying assumptions such as spatial continuity\nand stationarity [GISGeography, 2017] that may not hold for\ncomplex contaminants like PFAS, whose transport dynamics\nand uncertainties are more intricate. We aim to take a data-driven, expert-informed approach to address these challenges.\nAI Approaches for PFAS Prediction. Recent advances in\nAI and geospatial modeling have opened new avenues for\ntackling the complexities of PFAS detection and prediction byintegrating environmental variables such as land cover, prox-imity to industrial facilities, and hydrological flow patterns.For example, DeLuca et al. [DeLuca et al., 2023] used ran-dom forests to predict PFAS contamination in fish tissue in\nthe Columbia River Basin, leveraging geospatial data from"}, {"title": "3 Methodology", "content": "3.1 Dataset\nThis study aims to perform segmentation on surface water\npixels, classifying them as having PFAS concentrations above\nor below established health advisory thresholds using geospa-tial data. The dataset is built from the U.S. Environmental\nProtection Agency (EPA) National Rivers and Streams As-sessment (NRSA) [U.S. EPA, OW, 2015] and the Great Lakes\nHuman Health Fish Fillet Tissue Study [U.S. EPA, 2024b],\nwhich together provide 866 sample points collected over mul-tiple years. PFAS concentrations in fish tissue were measured\nas continuous values in these datasets but were then catego-rized into above (1) or below (0) health advisory thresholds\nbased on thresholds defined by the U.S. EPA's Fish and Shell-fish Advisory Program [U.S. EPA, 2024a]. These thresholdsindicate the health risks associated with different PFAS com-pounds in fish tissue. These sample points also exhibit a sig-nificant class imbalance, with 775 points labeled as above\n(89.5%) and 91 labeled as below (10.5%) safety thresholds.\nOur dataset consists of ground truth masks generated from\nthese data, multi-channel raster images as features, and noise\nmasks, all of which provide a spatially and environmentallycontextualized representation of contamination risks.\n3.2 Raster Image Generation\nTo spatially integrate the data, multi-channel raster images\nwith 45 channels were generated around each sample point.\nEach image is a P \u00d7 P pixels patch with a 30-meter reso-lution, centered on the geographic coordinates of the sample\npoint, where the optimal value of P is determined in Sec-tion 3.8. These raster images integrate several key features.\nFirst, we incorporate readily available data products such as\nthe National Land Cover Database (NLCD) raster [U.S. Geo-logical Survey, 2024] to represent land cover types, and flow\ndirection rasters that capture hydrological connectivity. In\naddition, we generate distance rasters to quantify proximity\nto potential PFAS dischargers. The discharger location data\nare obtained from the U.S. EPA Enforcement and Compli-ance History Online (ECHO) [U.S. Environmental Protection\nAgency, nd] and converted into distance rasters using a dis-tance transform for efficient spatial analysis."}, {"title": "3.3 Ground Truth Masks", "content": "Our goal is to perform segmentation of surface water to pre-dict PFAS contamination, but the available data consists ofsparse point-level contamination measurements rather thandense labels. To generate dense training labels, we adopt apoint-based ground truth expansion strategy, where every sur-face water pixel in a patch is labeled according to the EPA-defined contamination status of the patch's sample point.Specifically, if the sample point indicates PFAS above thesafety thresholds, all surface water pixels are labeled 1; if be-low, they are labeled 0. Non-surface water pixels are assigneda value of 2. This approach extends point-level data acrossthe patch, assuming that nearby areas share similar contami-nation levels."}, {"title": "3.4 Noise Masks", "content": "To quantify the confidence that a pixel's label (either 0 or 1) iscorrect since we are expanding the ground truth data, we com-bined four key factors; proximity to PFAS dischargers, landcover type, distance to other sample points, and downstreamflow, into a single probability value. Each factor contributeda portion of the final probability, reflecting domain-informedassumptions about which conditions most strongly indicatecorrect labeling.\nThe final contamination probability for each surface waterpixel i is computed as:\n$P_{final} = \\alpha_1 \\cdot P_{dischargers} + \\alpha_2 \\cdot P_{landcover} + \\alpha_3 \\cdot P_{sample\\_dist} + \\alpha_4 \\cdot P_{downstream}$\nwhere $p_{dischargers}$, $P_{landcover}$, $P_{sample\\_dist}$, and $P_{downstream}$ representthe contamination probabilities derived from (i) proximity toPFAS dischargers, (ii) land cover type, (iii) distance to othersample points, and (iv) downstream flow, respectively. In thefollowing paragraphs, we briefly describe each factor:\nProximity to PFAS Dischargers (pdischargers) If a pixel'slabel was 1, we applied an exponential decay function of dis-tance, assigning higher probabilities to pixels closer to knowndischargers. For pixels labeled 0, we inverted this logic sothat being near a discharger lowered confidence in the 0 la-bel.\nLand Cover Type (Plandcover) For pixels labeled 1, sur-rounding urban or built-up areas received higher probabili-ties than forested regions, consistent with research linkingPFAS to industrial zones [Dimitrakopoulou et al., 2024].Conversely, for 0-labeled pixels, surrounding undeveloped orforested land cover increased confidence in low contamina-tion.\nProximity to Other Sample Points (psample_dist) Pixelscloser to known sample points were assigned higher proba-bilities using an exponential decay function based on distanceto each sample point in the patch.\nDownstream Flow (pdownstream) If a pixel lies downstreamof a sample point labeled 1, its probability for label 1 in-creases, and similarly for label 0. This flow direction channelwas generated using ArcGIS Pro [ESRI, nd], a geographicinformation system (GIS) software used for spatial analysis,\nand environmental modeling. ArcGIS Pro enabled extraction"}, {"title": "3.5 Model", "content": "Our framework, FOCUS, is inspired by the Prithvi architec-ture [Blumenfeld, 2023] and employs a masked autoencoder(MAE) approach for pretraining. Instead of relying on rawsatellite imagery and Prithvi's pretrained weights, we pre-train our model on derived geospatial data products (e.g., landcover), which offer more contextual information for captur-ing the environmental nuances critical to PFAS contaminationprediction (see Section 4). This pretraining uses masked au-toencoding with a mean squared error loss. The pretrained en-coder is then fine-tuned with a dedicated decoder head for thedownstream task of PFAS prediction, resulting in improveddata efficiency and overall performance."}, {"title": "3.6 Loss Function", "content": "The loss function used in FOCUS combines the focal loss withnoise mask weighting as follows:\n$L_{FOCUS} = \\frac{1}{N} \\sum_{i=1}^{N} L_{focal} (z_i, y_i) \\cdot M_i,$\n$L_{focal} (z_i, y_i) = (1 - p_{y_i})^{\\gamma} \\cdot L_{CE} (z_i, y_i),$\n$L_{CE}(z_i, y_i) = - log \\frac{exp(z_{i,y_i})}{\\sum_{j}exp(z_{i,j})}$\nwhere N is the number of pixels, $z_i$ and $y_i$ are the predictedlogits and true label for pixel i, respectively, $M_i$ is thenoise mask value for pixel i, and $p_{y_i}$ is the predicted probability forthe true label $y_i$. Here, $z_{i,y_i}$ is the logit for the true class and\nj indexes all classes.\nThe parameter \u03b3 = 2 is used in the focal loss to focus\non hard-to-classify examples, as this value showed the best\nperformance in previous studies introducing focal loss [Lin\net al., 2018]. Notably, class weights to address dataset im-balance are directly incorporated into the cross-entropy loss\n($L_{CE}$), removing the need for an explicit alpha term in focalloss. By combining focal loss and noise mask weighting, theloss function addresses label noise and class imbalance while\nemphasizing high-confidence pixels during training."}, {"title": "3.7 Baselines", "content": "To contextualize our proposed framework for PFAS contam-ination prediction, we introduce several baseline approachescommonly employed in the field:\n\u2022 Pollutant transport simulation: A process-based ap-proach that models contaminant movement using hydrolog-ical principles.\n\u2022 Landsat-based method: Uses Landsat 7 multispectral im-agery [U.S. Geological Survey, nd] and the original Prithviweights to infer contamination from raw satellite imagery.\n\u2022 FESTA loss approach: An alternative state-of-the-arttechnique for sparse segmentation that encodes spatial andfeature relationships, originally designed for datasets withmixed spatial formats such as incomplete lines, polygons,and points.\n\u2022 Kriging: A geostatistical interpolation technique that pre-dicts contamination based on spatial relationships betweenpoints.\n\u2022 Random forest: Following the methodology of [DeLucaet al., 2023], this model aggregates environmental featureswithin a 5 km buffer around each sample from the NRSAdataset; for example, calculating the percentage of variousland cover types and the distance to the nearest PFAS dis-chargers to predict contamination at individual points.\n\u2022 Rule-based approach: This approach assigns contamina-tion labels based on predefined environmental heuristics.Similar to our noise mask computation, but without dataabout ground truth points, it computes a contaminationprobability by combining weighted factors, such as dis-charger proximity, land cover, and flow direction, and thenthresholds the result to yield binary labels.\nFurther details on Kriging and pollutant transport simulationare provided in the supplementary material. Collectively,these baselines provide a comprehensive benchmark for eval-uating the performance and scalability of our proposed frame-work."}, {"title": "3.8 Experiments and Ablation Study", "content": "We now describe our experimental setup, with more detailsin the supplementary material.\nTraining Configuration. We adopted an 80%-20% splitfor each year's data for training and testing, respectively, en-suring that the test set is geographically disjoint for rigorousevaluation. A batch size of 4 and a learning rate of 5 \u00d7 10-4were adopted to preserve the stability of our pretrained back-bone, minimizing the risk of large, destabilizing updates.In addition, we employed AdamW [Loshchilov and Hutter,\n2019] as the optimizer with \u03b2\u2081 = 0.9 and \u03b22 = 0.999. Fur-thermore, we used a custom learning rate scheduler with aninitial warmup phase followed by polynomial decay, whichhelped stabilize convergence and ensured that the model grad-ually adapted to the limited data.\nAblation Study. We conduct ablation studies across the fol-lowing dimensions:\n\u2022 Raster Size: To understand the influence of spatial context,we compare raster patches of 512 \u00d7 512 and 256 \u00d7 256 pix-els. Larger patches capture broader contextual information,\npotentially including contamination sources farther fromthe sample point, while smaller patches reduce noise andfocus on localized features. This evaluation identifies thetrade-off between contextual richness and spatial precision.\n\u2022 Noise Weights: We evaluate the impact of incorporatingnoise masks into the FOCUS loss function. With noisemasks, pixel-wise confidence scores scale the focal lossto emphasize high-confidence pixels; without them, theloss reduces to the standard focal loss function [Lin et al.,2018]."}, {"title": "3.9 Metrics", "content": "The reported metrics include accuracy, Intersection overUnion (IoU), F-score, precision, and recall. All the perfor-mance metrics in this study are reported exclusively from testset evaluations, using only the contamination points providedby the EPA datasets. These metrics provide a comprehensive"}, {"title": "4 Results", "content": "All results in this section reflect performance on the test set,where evaluations are conducted solely on the actual contam-ination points from the EPA datasets.\nWe compared FOCUS against six alternative approachesfor PFAS contamination prediction as shown in Figure 5.Overall, FOCUS achieves better performance across allthe years and most metrics, aside from accuracy and pre-cision in 2022. The Landsat-based method yielded moder-ate results, suggesting that geospatial data products are moreeffective for capturing PFAS contamination patterns than re-lying solely on raw satellite data. The Random Forest ap-proach, despite achieving acceptable accuracy, suffered fromlower F-score, precision, and recall, likely due to the limitedspatial context from per-point feature aggregation. Similarly,although Kriging provided decent accuracy and precision, itstruggled with recall, indicating difficulties in detecting allinstances of contamination, and pollutant transport simula-tion demonstrated weak overall performance. The FESTAloss approach, originally tested on datasets with mixed spa-tial formats (e.g., incomplete lines, points, and polygons),showed suboptimal performance in our experiments as well.This may be attributed to our dataset's exclusive use ofpoint data and the complex dynamics of PFAS contamina-tion, which may challenge the spatial continuity assumptionsof the FESTA loss. While rule-based masks, designed toapproximate contamination using domain-specific heuristics,can provide a reasonable estimate in some cases, they fallshort in consistency and accuracy compared to the data-drivenapproach. This finding underscores the importance of incor-porating domain expertise and AI for more reliable PFAScontamination prediction.\nTo further illustrate the model's performance, we presenta predicted contamination map using our model for a sampleimage in Figure 6. For this patch, real data was availableonly for the central pixel, corresponding to the location ofan EPA sampling point. While the model correctly predictscontamination at this central point, its predictions for othersurface water regions within the patch remain unverified dueto no corresponding ground truth data. Further results on themodel calibration as measured by the Expected CalibrationError [Guo et al., 2017] are provided in the supplementarymaterial."}, {"title": "4.1 Ablation Results", "content": "Table 1 presents a comparison of three configurations: (i)point-based ground truth expansion masks using 256 \u00d7 256pixels patches, (ii) point-based ground truth expansion masksusing 512x512 pixels patches, and (iii) our FOCUS approach.The first two configurations employ standard focal loss, while"}, {"title": "4.2 Time Efficiency", "content": "We followed the methodology of DeLuca et al. [DeLuca etal., 2023], which uses similar environmental features and theNRSA dataset with a Random Forest model, as a baseline forefficiency comparisons. Table 2 compares feature extractionand inference times between the ML method and our FOCUSapproach over a 1 km\u00b2 area and in Northern Michigan (NM).\nFor feature extraction, we aggregated environmental fea-tures within a 1 km buffer around each point for the MLmethod. On average, this per-point aggregation took about1.2 minutes. In contrast, our deep learning approach pro-cesses the entire 1 km\u00b2 patch, including the creation andstacking of individual raster channels, taking only 4.7 sec-onds on average. Over NM, ML extraction took about 2 dayscompared to 3.2 hours for our FOCUS approach.\nFor inference, the ML method took 0.0003 seconds perpoint (7.5 seconds for NM), while our FOCUS approach re-quired 0.0005 seconds per patch (13 seconds for NM). Al-though FOCUS inference is marginally slower, this trade-offis acceptable given the efficiency gains in feature extractionand the advantage of producing dense, spatially contextual-ized predictions. All reported times for feature extractionover the 1 km\u00b2 area and inference were averaged over 10 runs.\nFeature extraction for both methods was performed on an In-tel Xeon Gold 6154 processor (3.0 GHz), while inference wasconducted on an AMD Ryzen Threadripper PRO 7985WXprocessor, with an NVIDIA RTX 6000 Ada Generation GPU.\nOverall, these results demonstrate that our deep learningframework offers a scalable and efficient solution for PFAScontamination mapping."}, {"title": "5 Conclusion and Future Work", "content": "PFAS contamination is a global environmental issue due toits persistence in water, soil, and wildlife. While methodslike LC-MS offer high accuracy, they are expensive and slow.Alternative approaches, such as spatial interpolation, remotesensing, ML methods, and hydrological models, provide in-sights but struggle with feature engineering and loss of spatialcontext.\nOur geospatial DL framework, incorporating the novelFOCUS loss, directly processes multi-channel raster data andintegrates contextual information, improving detection accu-racy and preserving spatial dependencies, making it a promis-ing tool for large-scale PFAS contamination mapping that canhelp identify high-risk areas.\nFuture work will explore model uncertainty estimation toguide targeted sampling. This would enhance the robustnessand reliability of our predictions. We plan to build on pub-licly available PFAS contamination maps, such as those pro-duced by the Environmental Working Group [EnvironmentalWorking Group, 2024] and [U.S. Geological Survey, 2023],by deploying our AI-based framework responsibly."}, {"title": "Ethical Statement", "content": "The public dissemination of PFAS contamination maps car-ries significant ethical implications. Given the potential im-pact on public health, environmental justice, and even prop-erty values, it is essential to communicate our findings trans-parently and responsibly. Our interdisciplinary team met bi-weekly to discuss findings and collectively decide on nextsteps, ensuring that our approach remains well-informed andgrounded in both technical rigor and community needs. Ourframework is well-suited to also support the generation ofvisualizations that can reflect prediction uncertainty, therebyhelping decision-makers and impacted communities make in-formed choices. Prior to deployment, we plan to engage localstakeholders and community groups via public forums andworkshops to tailor our maps to community needs. This ap-proach facilitates responsible use of the data and predictionsin guiding remediation efforts and policy decisions."}]}