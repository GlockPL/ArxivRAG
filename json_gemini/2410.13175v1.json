{"title": "TCP-Diffusion: A Multi-modal Diffusion Model for Global Tropical Cyclone Precipitation Forecasting with Change Awareness", "authors": ["Cheng Huang", "Pan Mu", "Cong Bai", "Peter AG Watson"], "abstract": "Precipitation from tropical cyclones (TCs) can cause disasters such as flooding, mudslides, and landslides. Predicting such precipitation in advance is crucial, giving people time to prepare and defend against these precipitation-induced disasters. Developing deep learning (DL) rainfall prediction methods offers a new way to predict potential disasters. However, one problem is that most existing methods suffer from cumulative errors and lack physical consistency. Second, these methods overlook the importance of meteorological factors in TC rainfall and their integration with the numerical weather prediction (NWP) model. Therefore, we propose Tropical Cyclone Precipitation Diffusion (TCP-Diffusion), a multi-modal model for global tropical cyclone precipitation forecasting. It forecasts TC rainfall around the TC center for the next 12 hours at 3 hourly resolution based on past rainfall observations and multi-modal environmental variables. Adjacent residual prediction (ARP) changes the training target from the absolute rainfall value to the rainfall trend and gives our model the capability of rainfall change awareness, reducing cumulative errors and ensuring physical consistency. Considering the influence of TC-related meteorological factors and the useful information from NWP model forecasts, we propose a multi-model framework with specialized encoders to extract richer information from environmental variables and results provided by NWP models. The results of extensive experiments show that our method outperforms other DL methods and the NWP method from the European Centre for Medium-Range Weather Forecasts (ECMWF).", "sections": [{"title": "Introduction", "content": "Tropical cyclone (TC) precipitation refers to the substantial rainfall events that accompany the formation, development, and movement of tropical cyclones. These precipitation events can lead to severe disasters in the affected regions, like heavy rainfall, flooding, mudslides, and landslides. These TC rainfall-related disasters cause more economic losses and deaths than strong winds (Wendler-Bosco and Nicholson 2022), yet most TC forecasting efforts focus only on track and wind intensity. Therefore, it is important to accurately predict the precipitation around the TC center.\nNumerical weather prediction (NWP) is widely used for various weather forecasting tasks, including TC forecasting. It simulates atmospheric dynamics, thermodynamics, and"}, {"title": "Task Definition", "content": "Different from regular precipitation forecasting, where the predicted regions are fixed, TC precipitation forecasting focuses on the 10\u00b0 by 10\u00b0 rainfall field around the TC center, which moves with the TC. We denote the final output of our work as \\(\\hat{Y} = {\\hat{y}_{n+1}, \\hat{y}_{n+2},..., \\hat{y}_{n+t},..., \\hat{y}_{n+m}}\\) , where \\(\\hat{y}_{n+t}\\) represents the rainfall prediction around the TC center t time steps into the future. Here, n represents the input time steps and m represents the output time steps. The input data we used can be divided into two parts, as shown in the left part of Figure 2: the first part is historical observation data (\\(X_{historical} = {X^p_1, X^p_2, X^p_3, X^p_4}\\) ) where \\(X^p_t\\) is the input data at the t time step and it includes the rainfall value data, A Rainfall, the 2-Dimension environment data, and scalar TC variables, like intensity. The second part is the future prediction data from an NWP system (\\(X_{future} = {X^f_1, X^f_2,..., X^f_t,..., X^f_m}\\)), where \\(X^f_t\\) denotes the prediction data at future t time step, which is provided by ECMWF (ECMWF 2017). Overall, imagine a TC developing, just like shown in Figure 1. We obtain all"}, {"title": "Adjacent Residual Prediction (ARP)", "content": "In the TC rainfall forecasting task, predicting the rainfall value directly is difficult because weather systems exhibit chaotic characteristics. Some NWP methods improve the accuracy and stability of forecasts by keeping the weather change as their prediction goal (Kalnay 2003). Inspired by this idea, we find the capability of change awareness is helpful to our model, so we replace the direct prediction of rainfall value with predicting the adjacent residual \u2206 between rainfall at adjacent time steps (\u2206 Rainfall). We call this mechanism Adjacent Residual Prediction. A can be calculated as:\n\\[\\Delta X_{t}^{rain}=X_{t}^{rain}-X_{t-1}^{rain} \\] (2)\nwhere \\(X_{t}^{rain}\\) and \\(X_{t-1}^{rain}\\) are the original rainfall data at t time step and t - 1 time step respectively. In our work, apart from the absolute rainfall values data, we add adjacent residual sequence \\(D_{\\Delta} = {\\Delta_1,\\Delta_2,...,\\Delta_t,..., \\Delta_m}\\), where \\(\\Delta_t\\) is calculated by the Equation 2, which shown as the A Rainfall in Figure 2. Additionally, the direct output sequence of our DL model is \\(D_{Y} = {\\hat{\\Delta}_{n+1},\\hat{\\Delta}_{n+2},...,\\hat{\\Delta}_{n+t},..., \\hat{\\Delta}_{n+m}}\\), where \\(\\hat{\\Delta}_{n+t}\\) is the adjacent residual we predict between rainfall of time step n + t - 1 and n + t. The final prediction \\(\\hat{Y} = {\\hat{y}_{n+1},\\hat{y}_{n+2},..., \\hat{y}_{n+t},..., \\hat{y}_{n+m}}\\) can be computed as:\n\\[Y_{n+t} = X_{n}^{rain} + \\sum_{z=1}^{t}{\\hat{\\Delta}_{n+z}} \\] (3)\nY is obtained by the accumulation of the latest historical TC rainfall data \\(X_{n}^{rain}\\) and the adjacent residual prediction \\(\\Delta y\\)."}, {"title": "Diffusion Model", "content": "The prediction process of DMs involves removing noise from a completely random noise r step by step, shown in Figure 2's N Steps. Based on the DMs' generation process, our training goal is to teach our model to perform accurate denoising based on the specific step s and the given information. Specifically, the training goal is to make the noise \\(\\hat{r}_s\\) predicted by our model as close as possible to the noise \\(r_s\\) added to the target at the s-th step, s \u2208 {1, 2, . . ., N }. N is a hyper-parameter.\nDMs typically include two processes: a forward nois-ing process and a reverse denoising process. The forward"}, {"title": "Environment Awareness 3DUNet (EA-3DUNet)", "content": "EA-3DUNet is the main component of TCP-Diffusion. It can extract various features from multi-modal data sources. Due to the differing characteristics and dimensions of these heterogeneous meteorological data, we need to build multiple encoders to embed these data. Therefore, we build the Historical Data Encoder for Rainfall Data and Environment Data, and the Future Prediction Data Encoder for ECMWF's Future prediction data encoding. To better extract temporal and spatial information from these data, we build 3DUNet with a temporal and spatial attention mechanism. We will introduce all these modules in the following sections."}, {"title": "Evaluation metrics", "content": "Equitable Threat Score (ETS) The Equitable Threat Score (ETS) (Gandin and Murphy 1992) is a metric used to evaluate the accuracy of precipitation forecasts. Compared to the more popular metric, the Critical Success Index (CSI) (Schaefer 1990), it considers the effects of random chance, providing a more equitable assessment of a forecast model's performance (Manzato and Jolliffe 2017). The definition of ETS can be checked in Supplementary Material.\nWe use this metric to show the performance for predicting light, medium, and heavy rainfall, setting thresholds 6 mm/3hr (ETS-6), 24 mm/3hr (ETS-24), and 60 mm/3hr (ETS-60) respectively.\nTotal Precipitation Mean Absolute Error (TPMAE) TPMAE is a critical index for representing the intensity of TC rainfall. We calculate the absolute difference between real TC rainfall Y and the predicted rainfall \\(\\hat{Y}\\), which is denoted as Total Precipitation Mean Absolute Error (TPMAE,"}, {"title": "Comparison with State-of-the-art DL Methods", "content": "TCP-Diffusion is compared with a deterministic DL method: U-Net (\u00c7i\u00e7ek et al. 2016). We also compare our model with two generative DL methods developed for now-casting precipitation: PreDiff, which is DM-based (Gao et al. 2024), and NowcastNet (Zhang et al. 2023). We also compare TCP-Diffusion with a basic baseline, persistence forecasting, using the last observed rainfall field for each future prediction (Panofsky 1963)."}, {"title": "Comparison with NWP Methods", "content": "We also compare our model with a NWP method. We select the precipitation forecast data in TIGGE provided by ECMWF (ECMWF 2006), denoted as ECMWF-IFS, which performs much better than the ERA5-IFS used in our training stage. However, the spatial resolution of ERA5-IFS is lower than that of ECMWF-IFS, which can save the costs of training. As ECMWF-IFS forecasts in the TIGGE archive are for 6-hourly rather than 3-hourly precipitation, we sum 3-hourly TCP-Diffusion forecasts within each 6-hour interval. Additionally, ECMWF-IFS forecasts start at 12 am and 12 pm UTC each day, so we use TCP-Diffusion to forecast TC rainfall at the same start times. Thus, the test samples in"}, {"title": "Ablation Studies", "content": "To demonstrate the effectiveness of individual components of our model, an ablation study is conducted. As shown in Table 3, comparing the results from the model with and without ARP in the first two rows, we find that changing the regular rainfall value prediction to the adjacent residual prediction results in an improvement in ETS of about 0.1-15.0%. This indicates that predicting the adjacent residual reduces cumulative errors. Then, due to the rich and important TC environment information from multi-modal meteorological data, the model with M and ARP (third row) performs better than the model with only ARP, showing an improvement of about 5.6-13.0% in ETS and a reduction in TPMAE. This demonstrates the significance of building different encoder modules to extract TC rainfall-related information, addressing the deficiency of information provided only by the TC rainfall field. Finally, our complete model TCP-Diffusion including NWP forecast inputs (fourth row) achieves a 1.9\u201325.9% improvement in ETS over the model with only M and ARP. This demonstrates that using forecasts provided by NWP to guide DL prediction can enhance skill. Overall, due to the contributions of ARP, M, and F, our final model TCP-Diffusion achieves an improvement in ETS scores of about 11.9\u201363.8% over the baseline original video diffusion model across the different metrics."}, {"title": "Conclusion", "content": "In this paper, we propose TCP-Diffusion for global TC precipitation forecasting, conditional on various meteorological variables. Due to the ARP mechanism, TCP-Diffusion possesses the capability to detect changes in rainfall. Besides, TCP-Diffusion includes a framework with different encoders to extract information from various variables, such as historical TC rainfall data, TC-related environmental data, and forecasting data from NWP models, to guide and control our model for better predictions. TCP-Diffusion produces precipitation predictions in the region around TCs with real-"}]}