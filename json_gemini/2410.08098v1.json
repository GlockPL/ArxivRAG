{"title": "A Generative AI Technique for Synthesizing a Digital Twin for U.S. Residential Solar Adoption and Generation", "authors": ["Aparna Kishore", "Swapna Thorve", "Madhav Marathe"], "abstract": "Residential rooftop solar adoption is considered crucial for reducing carbon emissions. The lack of photovoltaic (PV) data at a finer resolution (e.g., household, hourly levels) poses a significant roadblock to informed decision-making. We discuss a novel methodology to generate a highly granular, residential-scale realistic dataset for rooftop solar adoption across the contiguous United States. The data-driven methodology consists of: (i) integrated machine learning models to identify PV adopters, (ii) methods to augment the data using explainable AI techniques to glean insights about key features and their interactions, and (iii) methods to generate household-level hourly solar energy output using an analytical model. The resulting synthetic datasets are validated using real-world data and can serve as a digital twin for modeling downstream tasks. Finally, a policy-based case study utilizing the digital twin for Virginia demonstrated increased rooftop solar adoption with the 30% Federal Solar Investment Tax Credit, especially in Low-to-Moderate-Income communities.", "sections": [{"title": "Introduction", "content": "The emergence of distributed energy generation sources, such as rooftop solar and wind turbines, is propelling a clean energy wave across the United States. Riding on rapidly expanding positive public opinion, augmented by support through government incentives and other funding initiatives, there is a growing consensus for their pivotal role in enhancing energy security and reducing emissions [1-3]. By encouraging the widespread adoption of solar panels, the energy industry can create new market opportunities by not only tapping into a clean and renewable source of power but also reducing the reliance on fossil fuels, which are argued to be one of the major contributors to greenhouse gas emissions. This paradigm shift towards solar energy aligns well with global efforts to mitigate the impacts of climate change and carbon emission reduction by promoting sustainable energy practices [4, 5].\nThere is overwhelming support in the scientific literature for transitioning to renewable energy sources. Projects such as DeepSolar [6, 7] and Google Project Sunroof [8] have been at the forefront of constructing comprehensive spatiotemporal datasets using historical satellite and aerial imagery. The DeepSolar project, for instance, mapped photovoltaic (PV) installations from 2006 to 2017 across 420 U.S. counties. Recently, Wussow et al. [9] further enhanced this database to include installations for all 50 states and the District of Columbia, in the year 2022.\nBuilding upon these foundational works, researchers have also analyzed rooftop solar adoption's current status and future potential at different spatial and temporal resolutions [10-12]. In addition to the technical and geographic analyses, research in this domain also assesses the importance of rooftop solar adoption [13] and analyzes the social, demographic, and economic disparities along with their influence on rooftop and community solar adoption, examining various temporal resolutions to understand how adoption rates evolve over time [14-17]. While these studies make a compelling case for solar panel adoption, the lack of PV data at a granular resolution (e.g., household and hourly levels) poses a significant roadblock for informed decision-making in optimal investment and incentive designs, policy decisions, grid stability management and accurate forecast modeling. We address this key data and knowledge gap through this work. Our aim is to explore the geographical and temporal dynamics of solar adoption and PV generation using a synthetic population of the U.S.\nIn our study, we develop a novel generative AI methodology to assign PVs to households in the U.S., and then create household PV energy profiles. The methodology consists of two key steps. The first step involves using integrated machine learning (ML) models for predicting household solar adoption. We employ an ensemble of ML models for the pre-processing step of square footage classification, followed by a calibrated decision threshold with a custom loss function XGBoost model for solar adopter identification. The model's parameters are chosen through Bayesian optimization to refine the precision of solar adopter identification. Our dataset is validated against real-world data for each state to mirror actual solar adoption patterns [14]. Furthermore, we utilize explainable artificial intelligence (XAI) techniques using SHapley Additive explanations (SHAP) [18] to unravel patterns from state-level ML models, offering a transparent and comprehensible analysis of the factors influencing solar adoption [19-21]."}, {"title": "Results", "content": "Spatial and temporal insights on rooftop solar adoption and PV generation are critical for sustainable urban development.\nAs an initial step, we identify solar adopters in each state of the U.S. (methodology is outlined in Section 3 and the pre-processing steps along with the performance"}, {"title": "Explainability of the models", "content": "Understanding the factors that govern our state-level solar production models' predictions is important for its validation. The model's explainability becomes vital, especially when considering the practical implications of deploying such models in policy-making and energy management. SHAP is a popular explainability technique used in machine learning to interpret the predictions of ML models. It assigns each feature an importance value (SHAP value) based on its contribution to the prediction. In Figure 3, we purposefully selected the state-level solar adoption ML models for VA-North Carolina (NC) and Texas (TX)- New York (NY) state-level models to highlight their geographic, political, and climatic similarities/contrasts. The variables used and their descriptions are mentioned in Section 3. In the VA-NC model [Figure 3(a)], houses constructed recently (YEARMADERANGE) have high SHAP values for VA, suggesting their high contribution to solar adoption. Conversely, NC shows mid-range YEARMADERANGE with higher SHAP values. In this model, recent constructions negatively impact predictions. VA finds medium-sized properties and households with higher income (\u039c\u039f\u039d\u0395\u03a5\u03a1Y) positively influencing SHAP values, linking them to solar production. In NC, larger homes and middle incomes positively affect SHAP values, differing from VA's pattern.\nIn the TX-NY model [Figure 3(b)], a notable contrast is observed in the beeswarm plots for MONEYPY, where the direction and magnitude of this feature contribution appear to reverse between the two states. Property size significantly influences solar adoption predictions in the TX model, while in the NY model, household income and the number of bedrooms are identified as key determinants. Additional analysis for VA-NC and TX-NY models are presented in Supplementary Note 5. Thus, the contrasting SHAP value trends in the state-level models uncover the importance of property-specific details (e.g., square footage range and construction period), demographic characteristics (e.g., number of household members), and socio-economic factors (e.g., income level) across different geographic landscapes in solar adoption."}, {"title": "Validation of synthetic solar data", "content": "The primary goal is to compare synthetic solar adopter state-wise counts with real-world datasets developed by multiple researchers to assess the accuracy of the distribution against actual solar adoption. Next, we compare the load shape curves and PV energy profile distribution between real and synthetic data to validate the temporal and spatial patterns of solar energy generation, ensuring the synthetic models accurately reflect real-world dynamics. We use the LBNL solar project [14] dataset for residential solar project and the DeepSolar dataset [9] with residential state-wise solar adopter count to validate our overall count of adopters. We corroborate our solar generation profiles through the samples of recorded household data from the Pecan Street, updated through 2020, for TX and NY [22]. We utilize each household's 15-minute average solar generation data to validate the hourly solar generation load shapes and compare the state-wide distribution.\nIn Figure 4a, we compared the synthetic solar adopter counts with two residential solar adopter datasets. The results show that the synthetic solar adopter counts are analogous to the two real-world residential solar adopter datasets. More detailed insights on the solar adopter validation are presented in Supplementary Note 6. Next, we compared daily load patterns between the Pecan Street and our synthetic dataset"}, {"title": "Case study: Policy impacts on rooftop solar adoption", "content": "As an illustration of the use of the generated digital twin, we carried out a case study motivated by recent policy considerations. The objective of case study is to use the digital twin to understand the dynamics of solar adoption and its penetration under various case scenarios. The scenarios primarily vary in the likelihood of solar adoption for different communities, illustrating the policy interventions. The case scenarios are described in Section 3. One of the top challenges in rooftop solar adoption is overcoming the economic barriers. Federal policies, including tax rebates and incentives, play a crucial role in providing financial assistance and thus accelerating clean energy adoption. Additionally, policies focused on increasing solar adoption and penetration in LMI communities help to address social disparities and support the government's objective of the Justice40 initiative [26]. However, evaluating the benefits of these policies and the resulting solar adoption penetration remains challenging. Factors such as peer influence, where social networks influence household decisions, and the social-demographic attributes of the households introduce uncertainty in the penetration of solar energy. Agent-based modeling using digital twins is one of the methods to simulate and better understand this behavior.\nOur analysis examines how these different policies, under the influence of peer effects, and microelements such as socio-demographic attributes of households contribute towards solar adoption within the state of VA using a framework for contagion simulation modeling [27], which capture individual components, community components for spatial effects, and neighbor components for the influence of immediate neighbors. We examine the impact of these policies on different segments of the population - (i) LMI [28] and non-LMI communities, and (ii) rural and urban populations. Model design and experimental setup are explained in Section 3.\nFigure 5a summarizes our policy study results and shows overall solar adoption trends: Cases 4, 1b, and 5 have unique patterns, while Cases 1a, 2a, 2b, and 3 follow similar paths. The 30% tax credit policy leads to the highest adoption in all communities. Figure 5b reveals that equal opportunity policies are effective in urban and rural LMI areas, influenced by community and network structures. This suggests the significant role of community effects and peer influence in adoption, with non-LMI adopters notably impacting overall penetration. Our case study suggest that policy interventions, like tax credits to all individuals, are essential for higher adoption.\nHowever, even the most successful policies see less than 1% LMI rooftop adoption. This outcome is attributed to the chosen network's workplace-based nature. Given the higher unemployment rates within the LMI community [29], this network model results in fewer connections among LMI households, limiting the spread of adoption through peer influence. This study, using the synthetic population of Virginia, demonstrates how digital twins can be utilized to analyze solar adoption and penetration. Similar studies can be conducted in other states or over different networks to gain deeper insights on solar penetration."}, {"title": "Discussion", "content": "Our work has bridged a key research gap in the understanding and prediction of rooftop residential solar adoption work. We identified solar adopters using a calibrated"}, {"title": "Methods", "content": "Solar adoption and PV profile generation\nWe aim to generate hourly PV energy profiles for households that have adopted solar energy. All datasets, the variables/abbreviations along with their explanations used in"}, {"title": "Synthetic household square footage range classification", "content": "The square footage range (SQFTRANGE) classification is treated as a multi-class classification task, categorizing households based on their square footage ranges. First, we identify common independent variables (features) associated with the demographics and household properties across both the RECS survey and the synthetic households. We employ Recursive Feature Elimination with Random Forest classifier to determine the minimal set of essential features for the square footage class prediction. The final feature set includes the number of household members (NHSLDMEM), number of bedrooms (BEDROOMS), type of housing unit (TYPEHUQ), main space heating fuel (FUELHEAT), ownership status of the unit (KOWNRENT), the year range in which the housing unit was built (YEARMADERANGE), annual household income range (MONEYPY), and the building's climate zone (BA_climate). These features undergo pre-processing to maintain consistent meaning for the categorical values between the two datasets (RECS and synthetic population). Next, we address class imbalance issues in the SQFTRANGE classification. We utilize an oversampling technique, the Synthetic Minority Over-sampling Technique for Nominal (SMOTEN) [32]. To ensure inter-feature correlations remain similar before and after SMOTEN, we compute the correlation matrix using Cramer's V coefficient [33].\nNext, we train various machine learning models tailored to different census divisions across the U.S., aiming to capture the regional similarities and differences for SQFTRANGE prediction. We employ an ensemble of machine learning models for the task of predicting SQFTRANGE classifications. Our ensemble is comprised of: (i) a random forest classifier, (ii) a support vector machine (SVM) classifier, and (iii) a gradient boosting classifier. These models have undergone hyperparameter optimization through a grid search. For making predictions, we adopt a voting mechanism that takes into account the outputs from all three classifiers. Specifically, we employ a plurality/hard voting strategy [34] when at least two classifiers agree on the predicted class, determining the final class based on this majority consensus. Conversely, when each classifier outputs a different class, we resort to a soft voting approach [35]. This method involves aggregating the predicted class probabilities from all classifiers, and the class with the highest total probability is selected as the ensemble's output. This combination of voting strategies enhances the robustness and generalizability of our model, mitigating the biases and overfitting tendencies that might affect the individual classifiers.\nFinally, we apply the ensemble trained model tailored for each census division to predict the SQFTRANGE for synthetic households in the corresponding U.S. states within each division. Upon obtaining the square footage predictions, we integrate them with the existing attributes of each household. Following this augmentation, we proceed to the next task of identifying solar adopters in the synthetic population."}, {"title": "Identification of solar adopters", "content": "The solar adopter identification modeling is performed on a state-wise basis to incorporate state-specific characteristics into the model. We employ over-sampling techniques like random oversampling or SMOTEN to address the class imbalances. Next, we perform model learning using an XGBoost classifier. The rationale for choosing the XGBoost classifier is twofold: first, tree-based classifiers are well-suited for tabular data [36], and second, XGBoost permits the integration of a custom log loss function and the calibration of the decision threshold, aligning closely with our problem setting. We undertake this step to satisfy our specific objective of minimizing the discrepancy between the actual state-wise solar adopter counts in the U.S. and the predicted counts in our synthetic model. The real state-wise solar adopter counts for the U.S are derived from the data published by LBNL [14]. Here, the data specifies the percentage and count of state-wise samples, enabling us to approximate the real number of adopters. In the weighted custom log loss function, we introduce a penalty term, $$\\beta$$ to allow us to control the penalty given for false positives/false negatives while training. The weighted log loss function is expressed as:\nWeighted Log Loss = $$\\frac{1}{T} \\Sigma[y_i log(\\hat{y_i}) + \\beta \\cdot (1 \u2013 y_i) log(1 \u2013 \\hat{y_i})]$$ (1)\nwhere T is the total number of samples, $$y_i$$ is the true label of the $$i^{th}$$ sample,  $$\\hat{y_i}$$ is the predicted probability of the $$i^{th}$$ sample to belong to positive class and $$\\beta$$ adjusts the weight given to the negative class in the loss function [37].\nWe also adjust the decision threshold, T while training the machine learning model [38], such that the binary decision label Di is predicted as\n$$D_i = \\begin{cases}1 & \\text{if } \\hat{y_i} > T \\\\0 & \\text{otherwise}\\end{cases}$$(2)\nThese customizations assist with the class imbalance problem and also achieve our objective of minimizing the discrepancy. Next, the task is to identify optimal  $$\\beta$$ and $$\\tau$$ without brute-force hyperparameter search. We explore the search space using Bayesian optimization method that uses expected improvement as the acquisition function [39]. In our approach, the Gaussian process regressor (GPR) serves as a probabilistic model in the Bayesian optimization framework. The key feature of a Gaussian Process model is its ability to provide a predictive mean and variance (uncertainty) for any point in the input space, based on the observations made so far. Expected improvement (EI) uses the mean and variance provided by the GPR to determine which new combination of hyperparameters is most likely to yield an improvement over the current best result.\nThe El acquisition function is given as\n$$EI(x) = (f_{min} \u2013 \\mu(x))\\Phi(\\frac{f_{min} \u2013 \\mu(x)}{\\sigma(x)}) + \\sigma(x)\\varphi(\\frac{f_{min} \u2013 \\mu(x)}{\\sigma(x)})$$(3)\nwhere $$f_{min}$$ is the observed current minimum discrepancy value, $$\\Phi$$ and $$\\varphi$$ are the cumulative distribution function (CDF) and probability density function (PDF) of the standard normal distribution, respectively, and $$\u03bc(x)$$ and $$\u03c3(x)$$ are the mean and standard deviation obtained at the point x given by the Gaussian process regressor"}, {"title": "Generation of hourly PV profiles", "content": "Square footage estimation: The pre-processing step of square footage estimation is essential before proceeding to the final step of generating hourly PV energy profiles to calculate the suitable area for roof-top PV installation. It involves determining the square footage values for each household in the synthetic population.\nTo estimate a house's square footage, we systematically divide square footage ranges into sub-classes, each with a weight based on occurrence frequency in RECS survey data. Taking a household $$\\hbar_i$$ as an example, if the predicted square footage range is between $$N_{low} \u2013 N_{high}$$, the sub-classes could be represented as $$(N_{low} \u2013 N_{1}), (N_{1} \u2013 N_{2}), \u2026, (N_{k} \u2013 N_{high})$$. Each sub-class has an associated weight, $$W_{N_1}, W_{N_2},\u2026$$, which is derived from the frequency of its occurrence in the RECS survey data. These weighted sub-classes help narrow down the square footage estimate more precisely.\nNext, we proceed with weighted random sampling to select M sub-classes yielding, $$\\mathbb{S}{N1}, \\mathbb{S}{N2}, \u2026, \\mathbb{S}{NM}$$. The likelihood of selecting a particular sub-class is proportional to its weight, ensuring that more common sub-classes are more likely to be chosen. Finally, for each of the selected M sub-classes, we uniformly sample L square footage values. This step introduces variability and accounts for the inherent diversity within each sub-class. Consequently, we end up with a total of M * L square footage values for household $$\\hbar_i$$. To provide a more stable and reliable square footage estimate for a household, we take the average M * L values. Mathematically, the final square footage estimate for household $$\\hbar_i$$, denoted as $$SF_{\\hbar_i}$$, is given by:\n$$SF_{\\hbar_i} = \\frac{1}{M X L} \\sum_{j=1}^{M} \\sum_{k=1}^{L} SF_{jk}$$(4)\nwhere $$SF_{jk}$$ represents the kth square footage value sampled from the jth selected sub-class.\nWe proceed to develop and create hourly PV energy profiles for households that have adopted solar panels. The time-invariant and time-variant variable categories are explained below.\n1. Time-invariant variables: For each solar adopter household hi, the time-invariant variables include Ai, representing a possible set of suitable roof areas for solar panels; ni, a set of values for solar panel yield; PRi, a set of values for performance ratio; \u03b8i, a set of possible tilt angles; and wi, a set of possible azimuth directions.\n2. Time-variant variables: For each solar adopter household hi, the time-variant variable includes $$HT_{i,d,w}$$, representing hourly solar radiation values on tilted panels"}, {"title": "State selection for results and validation", "content": "Our study focuses on different states in the U.S., chosen as representative examples for our result analysis and validation purposes. The details are described in Table 3. For SQFTRANGE classification and spatial-temporal dynamics study, we selected five states across the U.S. These selected states bring insights into the spatial distribution and geographical nuances across the U.S. as they belong to different U.S. census divisions and climatic zones defined by the International Energy Conservation Code (IECC) [42].\nFor the explainability of the state-level models, we chose VA-NC and TX-NY models. In the VA-NC model, both states have geographic similarities. However, based on the outcomes of the past four presidential elections, they have different political affinities. In the TX-NY model, both states have a comparable number of solar adopters and high adoption rates. However, they differ significantly in geographic and political affiliation. We selected TX and NY for validating the PV energy generated profiles based on the availability of real-world datasets."}, {"title": "Explainability of the models", "content": "We utilize SHAP (SHapley Additive exPlanations) [18] to interpret and compare the predictions of these models. SHAP framework aids in understanding the predictions by comparing the contributions of different features to the outcome. We study the feature contribution at a global (state-level) and local level (for every data point). Additionally, we provided insights into the interactions between different features using SHAP."}, {"title": "Validation of dataset", "content": "We compared our synthetic solar adopter data with the state-wise residential solar adopter data from LBNL [14] and DeepSolar [9]. We compared the absolute value as well as calculated the relative percentage differences between the datasets. Our validation approach for energy profile has two steps: (i) compare the aggregated generated energy distributions and (ii) compare the daily load curve shape. First, we aggregate hourly generation to daily totals and calculate their average and standard deviations for the synthetic data. This process mirrors the Pecan Street data aggregation for average daily generation. We assess differences using the Jensen-Shannon Divergence (JSD), which scores from 0 (same distributions) to 1 (different distributions), providing a symmetric comparison unlike Kullback-Leibler Divergence (KLD). Mathematically, for two probability distributions P and Q, the JSD is given by:\n$$JSD(P || Q) = \\frac{1}{2}KLD(P || M) + \\frac{1}{2}KLD(Q || M)$$(7)\nwhere $$M = \\frac{1}{2}(P + Q)$$ and the KLD is calculated as:\n$$KLD(P || Q) = \\sum_{x} P(x) log(\\frac{P(x)}{Q(x)})$$(8)\nWe used two methods to calculate the JSD and compare probability distributions. The first, a histogram-based approach, compares average solar generation, providing a direct comparison. The second method, Kernel Density Estimation (KDE), considers average values and standard deviations, offering insight into the data's variability. Our synthetic dataset includes standard deviation for refined bandwidth in KDE, unlike the Pecan Street data, which uses a default bandwidth determined by Scott's Rule, $$h = n^{-1/5}$$, based on the number of data points. Next, we compared daily load patterns between Pecan Street and our synthetic dataset for TX and NY, selecting an equivalent number of households. First we aggregated hourly data, for each month and for each household. Next, for each month, we computed the Pearson correlation coefficient of the aggregated hourly data between the Pecan Street households and the selected synthetic households. Finally, we computed the mean correlation for each month."}, {"title": "Case study", "content": "Our objective in this case study is to analyze the evolution of solar adoption using digital twin by considering the influence of policies, peer effects, and microelements such"}]}