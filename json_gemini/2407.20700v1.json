{"title": "Industrial-Grade Smart Troubleshooting through Causal Technical Language Processing: a Proof of Concept", "authors": ["Alexandre Trilla", "Ossee Yiboe", "Nenad Mijatovic", "Jordi Vitri\u00e0"], "abstract": "This paper describes the development of a causal diagnosis approach for troubleshooting an industrial environment on the basis of the technical language expressed in Return on Experience records. The proposed method leverages the vectorized linguistic knowledge contained in the distributed representation of a Large Language Model, and the causal associations entailed by the embedded failure modes and mechanisms of the industrial assets. The paper presents the elementary but essential concepts of the solution, which is conceived as a causality-aware retrieval augmented generation system, and illustrates them experimentally on a real-world Predictive Maintenance setting. Finally, it discusses avenues of improvement for the maturity of the utilized causal technology to meet the robustness challenges of increasingly complex scenarios in the industry.", "sections": [{"title": "1 INTRODUCTION", "content": "The degradation of industrial assets is a complex multifaceted problem that can be explained by different factors. As the components wear and deteriorate, the systems exhibit a series of changes that increase in severity until they eventually fail. In this case, failure patterns may also emerge. For instance, in the Reliability Engineering field, assets are most expected to fail either prematurely (early) during their break-in period, or late by the end of their remaining useful life (wear-out) [10]. These failure types can be anticipated because their modes, mechanisms, and effects, are well known and documented. In consequence, engineers introduce quality checks in the manufacturing process and inspection actions in their (more-or-less conservative) preventive maintenance schedule to mitigate their impact. However, for as long as the machines operate, failures may seem to appear \"randomly\" at any point in time. This is especially challenging for dependable assets while they transit the middle risky region, when the failure rate is relatively low, but uniform/constant.\nIn this uncertain setting, the field of Predictive Maintenance tackles the problem by introducing the data as a means to closely follow the actual evolution of each asset and make better informed and timely decisions [12]. In this sense, the detection of incipient anomalous behaviors and the capacity to diagnose their root causes and predict their solutions towards a more favorable prognosis become increasingly important to guarantee the availability of the machines.\nTo succeed in these multiple objectives, the required information and knowledge, which displays a clear causal character, is typically described and compiled in textual form through two different (linguistic) environments [7]. On the one hand, an ontological reference framework based on a Failure Mode, Mechanism, and Effect Analysis (FMMEA) [15], which provides a scholarly structure of causality driven by degradation. On the other hand, a methodological/epistemological approach via an actual record on Return On Experience (RoX), the data of which have been explicitly written for the purpose of explaining both the root causes and solutions of the reported failures. In both environments, several experts inherently identify which properties of the observations describe spurious correlations unrelated to the causal explanation of interest, and which properties represent the phenomenon of interest, i.e., the stable invariant associations.\nTraditional approaches for processing language in Predictive Maintenance settings have initially considered the idiosyncrasies of technical environments [6], and have evolved into exploiting Large Language Models [23], ontologies [43], and extracting recurrent problems and frequently suggested solutions [35]. Almost concurrently, the community of natural language processing and computational linguistics identified causal challenges in textual data [11], and these were soon also considered in the technical domains as a means to explain the degradation mechanisms by developing custom word embeddings [37] and unconfounded subsystem structures [38].\nThis workshop paper holds the hypothesis that root causes and solutions can be learned directly from the textual expressions found in field-specific RoX data, which are fully aligned with the Smart Troubleshooting objective: given the description of a problem, the system shall be able to accurately determine the related root cause and solution. The paper is organized as follows: Section 2 reviews the modeling fundamentals of Causality and Language, Section 3 describes the proposed causal diagnosis method from the standpoint of standard Predictive Maintenance, Section 4 illustrates the implementation of the method on a specific illustrative example, Section 5 discusses avenues of improvement to increase the robustness of the approach, and Section 6 concludes the work."}, {"title": "2 BACKGROUND", "content": "This section presents the basic notions on how to model the environment under analysis, both from a causal and a linguistic perspective.", "sections": [{"title": "2.1 Structural Causal Model", "content": "The causal links among the variables X that build the model of a system are assumed to be most effectively represented using the tools from the field of Causality. In this sense, the Structural Causal Model (SCM) is the framework that can most generally capture such directed associations [31]. The SCM defines a set of assignments governing their specific functional associations f, along with some independent exogenous noise N that accounts for everything that is not explicitly included in the model:\n\\(Xj := fj (PAj, Nj),\\)\n(1)\nwhere \\(PAj\\) represents the direct causes of the \\(Xj\\) variable.\nIf enough knowledge and experience from the field is available from the subject matter experts, e.g., through the FMMEA or RoX structures, then a complete SCM graph may be developed right from the start. Otherwise, the data need to be carefully leveraged to drive the discovery of the causal model."}, {"title": "2.1.1 Causal Bayesian Network", "content": "Once the structural graph that binds the variables is determined, the functional associations of the SCM may be learned, and this work specifically adopts a stochastic interpretation of the world. Therefore, it treats all X as random variables, and the resulting SCM statistically describes their (conditional) probability distributions.\nConsidering n random variables X1, X2, ..., Xn and a directed acyclic graph that relates them causally, a Causal Bayesian Network (CBN) is a generative model that has the following factorized joint probability distribution:\n\\(P(X_1,..., X_n) = \\prod_{j=1}^{n} P(X_j|PA_j, N_j).\\)\n(2)\nThe graphical nature of Bayesian networks allows seeing relationships among different variables, and their conditional dependencies enable performing probabilistic inference [1]. In particular, CBN are powerful tools for knowledge representation and inference under uncertainty [33]."}, {"title": "2.2 Causal Inference", "content": "Beyond probabilistic inference, Causal Inference provides the tools that allow estimating causal conclusions from observational data, i.e., in the absence of a true experiment, given that certain assumptions are fulfilled. These assumptions increase in strength as is defined in Pearl's Causal Hierarchy (PCH) abstraction [5], which is summarized as follows for the purposes of this paper."}, {"title": "2.2.1 PCH Rung 1: Associational", "content": "Describes the observational distribution of the factual data through their joint probability function P(X). From this point forward, interesting quantities, i.e., the queries XQ, can be directly computed given some evidence XE through their conditional probability, which is computed as a ratio of marginals:\n\\(P(X_Q|X_E) = \\frac{P(X_Q, X_E)}{P(X_E)}\\)\n(3)\nThis level of analysis displays a degree sophistication akin to classical (un)supervised Machine Learning techniques. As such, it is subject to confounding bias, where common causes may induce spurious statistical associations/correlations [34]."}, {"title": "2.2.2 PCH Rung 2: Interventional", "content": "Describes an actionable distribution, which endows causal information at the population level. This level of analysis can be achieved through actual experimentation via Randomized Control Trials, or through statistical adjustments that smartly combine the observed conditional probabilities to reduce the spurious associations in the estimation. Pearl's do-calculus is likely to be the most effective approach to determine the identifiability of causal effects by applying the following three rules: 1) insertion/deletion of observations, 2) action/observation exchange, and 3) insertion/deletion of actions [30]."}, {"title": "2.3 Language Model", "content": "Finally, to operate with textual data, there is the need to numerically represent linguistic information in the former \"generic\u201d variables X. To this end, Probabilistic Language Models are functions that assign a probability to a sentence, to eventually build up a whole piece of text. Traditionally, in such statistical models the sentences have been broken down, i.e., tokenized, into sequences of words, and the goal has been to predict the probability of an upcoming word [18, 26]:\n\\(P(X_{n+1} | X_0, ..., X_{n-1}, X_n).\\)\n(4)\nToday, with the advent of distributed representations of words and phrases [28], along with the Transformer neural architecture [39], long texts are directly represented in dense vector spaces, and the task of the resulting Large Language Models is now to provide responses to carefully engineered input prompts [8]."}]}, {"title": "3 METHOD", "content": "This section details the Smart Troubleshooting objectives and the analysis procedure to attain them, which focuses on providing root cause diagnostics and predictions of solutions for a problem observation based on written text data. Since the applied industrial environment belongs to the area of Predictive Maintenance, the consideration of a common development standard such as the ISO 13374 is recommended [16]. This specification breaks down the complexity of a problem into small modules that may be developed in isolation, thus increasing the chances of project success while also improving the interpretability and explainability of the technical solution, and help to reduce the technical debt. What follows is a description of the Data Manipulation and Health Assessment processing blocks.", "sections": [{"title": "3.1 Data Manipulation", "content": "Causality is an emergent property of complex industrial systems [44]. In this setting, linguistic variables constitute high level qualitative descriptions that group functions into categories and hierarchies, as is established by the FMMEA documentation."}, {"title": "3.1.1 Return On Experience Records", "content": "In the Smart Troubleshooting setting, the RoX text data are collected as a means to capture and describe the factual ontological relationships observed in the field [37]. They display the following variable type structure:\n\u2022 Subsystem Z (common context): Categorical\n\u2022 Root Cause C (problem source): Categorical\n\u2022 Observation O (reported problem, failure): Text\n\u2022 Solution S (repair/maintenance action): Text\nThis data structure is populated from several projects or environments, which exhibit some differences regarding the verbosity of the language used to describe the problem and its solution."}, {"title": "3.1.2 Textual Entailment", "content": "The concept of entailment refers to the directional nexus between text fragments. Regarding the RoX data, these assumed relations are encoded in the following graph:"}, {"title": "3.1.3 Text Embeddings and Large Language Models", "content": "Probably one of the most challenging parts of this environment is the embedded numerical representation of the text, which is typically considered as unstructured data. The approach described in this method has been implemented using a discrete categorical representation obtained with a \"BERTopic\" Large Language Model [14]. The proposed strategy integrates: 1) MiniLM [40], which is a compressed version of Sentence-BERT (i.e., a Transformer-based language model at the sentence level), 2) UMAP [27], which reduces the dimensionality of the embedded vector space, and 3) HDBSCAN [25], which clusters and quantizes the resulting low-dimensional representation."}, {"title": "3.2 Health Assessment", "content": "In the Smart Troubleshooting environment, one of the main challenges is dealing with the confounding bias introduced by the diversity of subsystems and components. To this end, Causal Inference techniques are utilized in the technical language processing scenario to extract relevant linguistic features from the text [11].\nThis module exploits the probabilistic SCM, which has been designed as a discrete category based Bayesian network following the structure of the RoX data, and conducts a fine-grained diagnosis of the observed input anomaly description by determining its root cause, and also by providing an unbiased estimation of the (most likely) potential solution."}, {"title": "3.2.1 Root Cause Analysis", "content": "Root Cause Analysis (RCA) is a troubleshooting method of problem solving used for identifying the sources of the failures [42]. RCA is a form of deductive inference since it requires an understanding of the underlying causal mechanisms for the potential faults and the problem, i.e., what is typically found in the context of Predictive Maintenance through the FMMEA documentation.\nThe discrete causal Bayesian Network is suitable for exploiting the categorized description of an observed problem (i.e., the effect) and predicting the likelihood of the several possible known causes. Thus, estimating the likely root causes amounts to computing the conditional probability diagnosis function P(C|O). Note that this estimand operates on the Observational rung of the Hierarchy of Causality, see Section 2.2.1. Eventually, RCA yields a ordered list of potential root cause variables along with their probabilities, which aligns with the way complex systems fail [9]. The variables that comprise the data are required to be representative enough to help the developers and engineers pinpoint the source of the observed problems through the root causes and their effects [41]."}, {"title": "3.2.2 Solution Generation", "content": "Predicting the solution is especially challenging due to the large cardinality of the Observation and Solution spaces (O,S). To obtain an unbiased result, an (atomic) intervention shall be performed. This represents an action do() that is conducted on a system to set (not filter via conditioning) its variables Xi to known values xi and then evaluate their impact/effect on other variables Xk, i.e., P(Xk|do(Xi = xi)). This constitutes an advanced level of analysis that is not attainable with the observed data alone: it also needs to account for the assumptions encoded in the causal model in the form of variable dependencies. As a result, the aforementioned confounding bias in the estimation is reduced through the following adjustment formula:\n\\(P(S|do(O)) = \\sum_{C,Z} P(CZ) P(S|C, Z, O) P(Z) .\\)\n(5)"}]}, {"title": "4 RESULTS", "content": "This section develops the experimental work through one illustrative example in the Predictive Maintenance domain. The causal model has been trained on several projects with RoX dataset sizes between 4k and 20k records, yielding average accuracy root cause classification scores over 80% (and over 70% for precision and recall)."}, {"title": "4.1 Data Observation", "content": "The specific exemplifying instance displays the following RoX data descriptions:\n\u2022 Subsystem: Suspension\n\u2022 Root Cause: Part physically damaged\n\u2022 Observation: \"failure mechanical brake trailer and use electrical release kph brake\"\n\u2022 Solution: \"download showed only one instance of failure on trailer with loss of comms with bcu this fault cleared when tram was put i nto to remove brake isolation however on tram being put back into s axle failed to apply download showed w at fault cor re ct reporting checked end switch disconnected and found verdigris on pins new loom made up and fitted fault still present so ch anged proximity switch tram te ran to bulwell and back with tct all probes alignedthrough coasting all trailer proximity swi tches and looms cleaned and checked\"\nThe data for this record are shown for qualitative comparative purposes. In a live real-world Smart Troubleshooting setting, the maintainer or engineer shall provide the description of the observed problem only, and the system shall add value by producing the diagnosis results in terms of the root cause(s) and the likely solution(s)."}, {"title": "4.2 Results Prediction and Retrieval", "content": "Table 1 shows the resulting distribution of root causes. Note that the correct cause leads this ranking, and the rest are given a smooth uniform value."}, {"title": "4.3 Prompt-based Generation", "content": "Finally, based on the given problem Observation text, on the most likely Root Cause, and on the text retrieved from the most likely unbiased Solution, the LLM can now synthesize the following enhanced advisory:\n\u2022 Solution 1: Check and Replace Bolts. As the possible cause suggested is failure of handover from the off-coming shift, which resulted in torquing the hangar bolts using old bolts, it is possible that the bolts may have been loose or damaged. Therefore, check and replace the bolts to ensure they are tightened properly to secure the suspension.\n\u2022 Solution 2: Address Oil Leakage. Another possible cause mentioned is oil leakage from the axles, which can cause damage to the suspension and affect the braking system. Check for oil leakage around the axle and replace any damaged seals to prevent further damage.\n\u2022 Solution 3: Replace Snapped Earth Cable. Previous observation mentions that a snapped earth cable was found, which can cause electrical issues in the braking system. Replace the snapped earth cable to ensure proper electrical connection and prevent any further failures.\n\u2022 Solution 4: Address Corrosion. Corrosion can affect the suspension and braking system, leading to safety issues. Check for any signs of corrosion in the suspension and braking components and address them accordingly. Apply anti-corrosion measures, such as applying Loctite corrosion inhibitor, to prevent further damage.\n\u2022 Solution 5: Adjust or Replace Fixings. Previous observation mentions that some fixings were found to be below spec, which can affect the suspension. Adjust or replace any fixings that are found to be damaged or not secure enough to ensure proper suspension.\n\u2022 Solution 6: Inspect Sanding Compressor. Previous observation mentions that the sanding compressor was rebuilt, but faults were still present after testing. Inspect the compressor and its components to identify any potential issues and address them to prevent any further failures.\n\u2022 Solution 7: Address Worn Cable Insulation. Previous observation mentions that the cable insulation was found worn through, which can cause electrical issues in the braking system. Address any worn-out cable insulation to ensure proper electrical connection and prevent any further failures.\n\u2022 Solution 8: Replace Damaged Component. Previous observation mentions that a damaged mudflap was found, which can affect the suspension and braking performance. Replace any damaged components to ensure proper operation of the suspension and braking system.\nIt is important to note that these proposed solutions are based on the given information and any previous records, and they may not be exhaustive. However, most of them correctly advise a replacement action (for a part that is physically damaged).\nFinally, while the way to quantitatively (i.e., objectively) evaluate the LLM-generated outcomes is still an open research question driven by correlational (i.e., not necessarily causal) scores [20], these qualitative (i.e., subjective) results suggest a reasonably promising future to help the subject matter experts troubleshoot the failures in challenging industrial settings."}, {"title": "5 DISCUSSION", "content": "Apparently, the quality of the text generated by the LLM seems higher than what the staff write on the RoX records: it shows more clarity, better diction, and better spelling. Nevertheless, there are no safety guarantees against hallucinations, and state-of-the-art LLMs are also subject to irrational behavior and reasoning breakdown even on simple tasks [24, 29].\nUp to this point, the approach presented in this workshop paper has described the basic principles of its causal RCA and Solution Generation technology, and an initial experimental proof of concept has been shown. This early stage of maturity corresponds to a standard ISO 16290 Technology Readiness Level (TRL) between 4 and 5, because it has been validated in some real-world relevant environments [17]. This section brainstorms some avenues of improvement to increase this robustness indicator up to higher quality standards, considering the specific challenges of complex industrial environments, and to eventually demonstrate the technology in an operational environment (TRL 6-7)."}, {"title": "5.1 Vector Database", "content": "One first idea could be to improve the granularity of the (currently discrete categorical) linguistic representation in the Causal Bayesian Network. The approach presented in Section 2.1.1 first embeds the unstructured text data into a large vector space, then it reduces the dimensionality of this real-valued numerical description, and finally it quantizes the resulting low-dimensional representation to obtain a categorical random variable. At each step, though, some information is lost due to compression, and while this is especially advantageous to decrease the complexity of the ensuing (discrete) probabilistic model, maybe it also introduces some unnecessary limitations. Therefore, to potentially improve this situation, Hybrid Bayesian Networks may be helpful to represent the Observation and Solution texts with their original vectors (note that the Subsystem and the Root Cause variables shall retain their categorical nature). Hybrid Bayesian approaches, which are able to simultaneously model both discrete and continuous variables [3], have already enjoyed success in multivariate domains for predicting delays in operations [21], and also in the reliability assessment of large infrastructure networks [45].\nIn this new modeling scenario, the text may exploit the larger distributed representation of the LLM embedding, which is characterized by a set of independent real-valued dimensions. For retrieval purposes, the most likely vector v* in the embedded linguistic space V = (00, 01, ...) could first be obtained as:\n\\(\\hat{v^*} = \\max_{v_i, ieV} [P(v_i),\\)\n(6)\nand then the matching with the RoX records could be conducted using the cosine distance metric that has traditionally been supported by the statistical language processing field. However, it remains to be seen how the curse of dimensionality will affect the technical setting. In any case, this realignment with the well established techniques may be of help to increase the TRL."}, {"title": "5.2 Transportability", "content": "Generalizing empirical findings to new environments or populations is necessary in the Smart Troubleshooting setting because there are different projects and fleets considered, and each environment exhibits particularities in the written form of the text data. The concept of \"transportability\" is defined as a license to transfer information learned in one environment or domain to a different environment [4], and thus reduce the covariate shift problem.\nTransportability analysis assumes that enough structural knowledge about both domains is known in order to substantiate the production of their respective causal diagrams. To formally articulate this transfer procedure, a selection variable K must be introduced to represent the differences between the deployments. In the RoX-based Smart Troubleshooting setting for the industry, the assumption is that the only relevant difference among the environments is driven by the population of subsystems, thus K \u2192 Z (in fact, some components are only present in specific platforms and assets, so this premise is well founded). The resulting transport formula to generate solutions from a source environment A to a target environment B is shown as follows:\n\\(P_B(S|do(O)) = \\sum_{C,Z} P_A(CZ) P_A(S|C, Z, O) P_B (Z) .\\)\n(7)\nIf one particular environment B is found to be especially lacking in some aspect, then the rest of the environments A can be used to estimate the desired probabilistic distribution. This smart workaround to a direct data shortage problem that leverages the indirect data from multiple settings is expected to increase the robustness of the predicition, which in turn may help to increase the TRL of the final solution."}, {"title": "5.3 Counterfactual Analysis", "content": "So far, the main focus of the analysis has been put on the observed factual data at the population level. However, these data represent only one of the many potential outcomes the system could have experienced: had things been different, an alternative outcome may have been observed. In this sense, a counterfactual describes a potential distribution at the individual level driven by hypothetical speculations over data that may contradict the facts. This level of analysis constitutes an additional third rung in the Hierarchy of Causality described in Section 2.2. Conducting this estimation requires the following three steps [32]:\n(1) Abduction: Beliefs about the world are initially updated by taking into account all the evidence E given in the context of a single instance/unit. Formally, the exogenous noise probability distributions P(U) are updated to P(U|E).\n(2) Action: Interventions are then conducted to reflect the counterfactual assumptions, and a new causal model is therefore created.\n(3) Prediction: Finally, counterfactual reasoning occurs over the new model using the updated knowledge.\nGaining access to such involved analysis creates a new area of research to enhance Predictive Maintenance."}, {"title": "5.3.1 Algorithmic Recourse", "content": "Algorithmic Recourse is an approach that systematically explores these counterfactual worlds [19]. Such environments are simulated via inference through (atomic) interventions a in the form of alternative problem descriptions. This is expected to help in the recognition and understanding of the general root causes that lead to the system failure [22], and the solution advisory that leads to greater availability.\nFormally, the specific retrospective reasoning that these counterfactuals explore on the reported anomaly, i.e., the full description of the solved problem, can be stated as:\n\\(P(S^*|do(O = a), Z, C, O, S) .\\)\n(8)\nGiven that the solution of a problem was factually implemented and recorded in the RoX data, i.e., through observing all of the variables (Z,C,O,S), Equation (8) estimates the probability distribution of the textual representation of the hypothetical Solution S* had the problem been described (and represented) by a, instead of the numerical representation it actually had when it was written. This sophisticated degree of surgical detail enbales driving investigations to a deeper level, and this is regarded to help in the advance of the TRL."}, {"title": "6 CONCLUSION", "content": "This workshop paper has developed a complete top-down troubleshooting approach from first Causal Inference principles that is also compliant with industrial development guidelines. On the basis of processing technical language, the focus of this learning challenge has been put on creating a distributed representation of linguistic features, and exploiting it for the purpose of obtaining unbiased causal diagnostics and solutions. This approach has been illustrated through a relevant example in the Predictive Maintenance domain, and the results arguably suggest a promising line of future research toward a method to evaluate generative models in other industrial settings."}]}