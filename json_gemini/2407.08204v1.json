{"title": "Chromosomal Structural Abnormality Diagnosis by Homologous Similarity", "authors": ["Juren Li", "Fanzhe Fu", "Ran Wei", "Yifei Sun", "Zeyu Lai", "Ning Song", "Xin Chen", "Yang Yang"], "abstract": "Pathogenic chromosome abnormalities are very common among\nthe general population. While numerical chromosome abnormali-\nties can be quickly and precisely detected, structural chromosome\nabnormalities are far more complex and typically require consider-\nable efforts by human experts for identification. This paper focuses\non investigating the modeling of chromosome features and the\nidentification of chromosomes with structural abnormalities. Most\nexisting data-driven methods concentrate on a single chromosome\nand consider each chromosome independently, overlooking the cru-\ncial aspect of homologous chromosomes. In normal cases, homolo-\ngous chromosomes share identical structures, with the exception\nthat one of them is abnormal. Therefore, we propose an adaptive\nmethod to align homologous chromosomes and diagnose struc-\ntural abnormalities through homologous similarity. Inspired by the\nprocess of human expert diagnosis, we incorporate information\nfrom multiple pairs of homologous chromosomes simultaneously,\naiming to reduce noise disturbance and improve prediction perfor-\nmance. Extensive experiments on real-world datasets validate the\neffectiveness of our model compared to baselines.", "sections": [{"title": "1 INTRODUCTION", "content": "chromosomal abnormalities, which include missing, extra, or ir-regular portions of chromosomal DNA [25], are the root cause ofvarious genetic and hereditary diseases. It is estimated that 6 of ev-ery 1,000 newborns have chromosomal abnormalities, which oftenresult in dysmorphism, malformations, and developmental disabil-ities [52]. These chromosomal changes caused by abnormalitieslead to serious consequences, e.g. 25% of all miscarriages and still-births, and 50%-60% of first-trimester miscarriages [19]. With thehelp of chromosomal abnormality detection, clinicians can identifymore abnormalities that may result in birth defects and take fur-ther preventive measures, which is of great significance to people'slivelihood and social development.\nThere are two types of chromosomal abnormalities: numericalabnormality and structural abnormality [11]. Numerical abnormal-ities involve the absence or addition of entire chromosomes [14].For example, an extra copy of chromosome 21 will cause Downsyndrome. Structural abnormality refers to the deletion, excess, in-version, or translocation of a certain segment of one chromosome to"}, {"title": "2 PRELIMINARIES", "content": "To clearly illustrate our work, this section first introduces thedataset and the preprocessing steps. Detailed and formal defini-tions of the dataset and the problem formulation will be providedin this section."}, {"title": "2.1 Dataset and Preprocessing", "content": "Each chromosome data in the dataset contains two sequences sam-pled from the chromosome diagram. As shown in Figure 1 (a) and(b), the chromosome diagrams indicate a unidirectional flow of in-formation, suggesting that the information density aligns with thechromosome's direction. Typically, image data exhibits informationdensity along two perpendicular directions. Therefore, we proposeconverting the original data into chromosomal sequences for ourdataset.\nAs shown in Figure 2, the chromosomal sequences represent thegray mean sequences derived from the left and right parts of thecorresponding chromosome diagram. In a chromosome diagram,sister chromatids cross over the left and right sides of the chromo-some. A sister chromatid refers to the identical copies (chromatids)formed by the DNA replication of a chromosome [41]. In theory,both of them would look the same in chromosome diagram. How-ever, the left and right sides of the chromosome diagram are notcompletely symmetrical due to the bending of the chromosome anduneven staining of stains. Thus, we need to sample both the left andright sequences. For convenience, we use the term \u201cchromosome\u201dto represent the sampled chromosomal sequence."}, {"title": "2.2 Problem definition", "content": "Inspired by the diagnostic process of human experts, we find thatconsidering the information of multiple-pairs homologous chro-mosomes at the same time can make the judgment more reliable.This also reduces the noise disturbance of considering only onepair of homologous chromosomes. Thus we combine multi-pairhomologous chromosomes to form a bag, denoted by X.\nEach homologous chromosome in X is denoted by Hi.\nThen we get X = {H1, H2, . . ., Hm}, where m is the number ofhomologous pairs. All the homologous chromosomes Hi \u2208 X arefrom different cells of the same patient, and their chromosome typeare the same, denoted by c. c is one-hot vector with the length of 24.As mentioned above, the band levels of chromosomes of cells maybe different. In the dataset, band level is denoted by b, a one-hotvector with the length of 4. Because there are four types of bandlevel in our dataset: 300, 400, 550 and 700, which also covers mostof the common band types. Each Hi consists of two chromosomes,where homologous chromosome 1 and 2 are denoted by Hi,1 \u2208 R2\u00d7dand Hi,2 \u2208 R2\u00d7d, respectively. d is the length."}, {"title": "3 METHODOLOGY", "content": "In this section, we introduce the proposed model HomNet for di-agnosing chromosomal structural abnormalities by homologoussimilarity."}, {"title": "3.1 Overview", "content": "The framework of HomNet is depicted in Figure 3, comprising threemain components: CMSBlock, HomBlock, and BagBlock.\nTo capture common characteristics of structural abnormalitiesacross chromosomes with varying morphologies, we design Hom-Net based on homologous similarity. We generate five types ofartificial abnormal chromosome sequences as negative samplesbased on real-world structural abnormalities. Subsequently, we de-vise a self-supervised training strategy to utilize the chromosomesof healthy individuals and the artificially generated chromosomes.To address the data inconsistent distribution problem across differ-ent hospitals, we propose fine-tuning the model for each specifichospital.\nFor each query tuple (X, c, b), CMSBlock extracts the distinguish-able features R; from each chromosome in X, where j \u0454 1, 2. Sub-sequently, HomBlock aligns each pair of homologous chromosomesand captures the differences between them based on homologoussimilarity, denoted as H. Finally, BagBlock considers all the H todiagnose the structural abnormalities.\nMore specifically, CMSBlock first captures the features of thechromosomes. During this process, CMSBlock utilizes prior infor-mation band level b and chromosome type c to help HomNet toextract the features. Generally, there is at most one chromosomewith structural abnormality in any pair of homologous chromo-somes. Thus, we propose to detect the chromosomal structuralabnormalities by homologous similarity. However, it is challengingto capture the differences since the shape of each chromosomevaries and the diagram of chromosome pair may be flipped over, i.e.,they are not perfectly aligned. To align each part, HomBlock uses aninter-attention based strategy to capture the difference H betweenHi,1 and H'i,2 of homologous chromosome 1 and2. As mentioned above, in order to reduce noise disturbance andincrease judgment reliability, HomNet considers multiple pairs ofhomologous chromosomes simultaneously in BagBlock. After get-ting all the difference representation (H', H2, ..., H'm) of the Bag X,BagBlock makes a prediction \u0176 according to these representations."}, {"title": "3.2 Self-supervised Learning with Artificial Abnormalities", "content": "Due to the significant imbalance between the number of chromo-somes with structural abnormalities and those without, it becomeschallenging to identify distinctive features for abnormality detec-tion [27]. On the bright side, we possess a substantial amount ofchromosome data from healthy individuals. Leveraging this data"}, {"title": "3.3 Modeling the Feature of Chromosomes", "content": "Before capturing the differences between homologous chromo-somes, we model features of chromosomes. Each chromosome,Hi,j, is from a chromosome diagram with or without structuralabnormality. We propose CMSBlock to extract the features of eachchromosome. As Figure 3 shows, the CMSBlock first merges twosequences into one, and get Hmg. H Then, CMSBlock utilizes Hmg\ni,j. i,j\nband type b and chromosome type c to obtain the chromosomalrepresentation Rij\nMerge two chromosome sequences. The chromosome datawe obtain consists of two sequences: Hi,j \u2208 R2\u00d7d. As previouslymentioned, these sequences represent the mean sequences of theleft and right portions of the chromosome diagrams, respectively.Given the partial differences between the left and right sequenceswithin Hi,j, both containing crucial chromosome information, asimple merging approach using average, maximum, or minimumvalues would result in substantial information loss. Therefore, weopt to merge these sequences using a learnable method. Specifically,we employ a convolution operation, and get the representationHmg\ni,j\n\nHi,jmg = Conv(Hi,j) (1)\nModel the feature of regions. Subsequently, CMSBlock extractsthe features of each chromosome, obtaining the feature representa-tion R. As depicted in Figure 2, the chromosome diagram displaysmultiple grayscale bands along the chromosomes, which are re-ferred to as regions [35]. When a structural abnormality occurs,the region where the abnormality happens will correspondinglychange. For instance, in the case of a chromosomal deletion [35],the corresponding region will also be missing.\nTherefore, HomNet detects structural abnormalities by analyzingthe differences in regions between homologous chromosomes.\nTherefore, we divide Hmg\ni, jinto multiple subsequences, each rep-resenting a region of the chromosome.\nAdditionally, leveraging the prior knowledge that chromosome\ntypes and band levels can aid in modeling the chromosomes, we"}, {"title": "3.4 Capture the Differences between Homologous Chromosomes", "content": "Based on expert detection processes, HomNet diagnoses structuralabnormalities through homologous similarity. As depicted in Fig-ure 1, diagrams of homologous chromosome pairs with structuralabnormalities differ, while those of normal homologous chromo-somes are similar. However, most existing anomaly detection meth-ods concentrate on individual objects and do not leverage the dis-tinctions between homologous chromosomes with structural abnor-malities. Therefore, we introduce HomBlock to capture the differ-ences between homologous chromosomes, based on their featurerepresentations, R1 and R2\nAdaptive region alignment in homologous pairs. As men-tioned above, obtaining the difference of homologous chromosomesinvolves comparing the distinctions between the feature represen-tations of corresponding regions in a pair of homologous chromo-somes. However, due to the free oscillation of chromosomes incells, and potential inversion of chromosome diagrams, the rep-resentations R and R2, which encode chromosomal structuralinformation, are not well aligned. Mere subtraction or stacking ofthese representations without proper alignment introduces bias.Therefore, HomBlock employs an adaptive alignment method tocapture homologous differences by aligning each region betweenhomologous chromosomes. HomBlock adaptively aligns each rowof R with each row of R. Here, r; represents the eth row ofRi; and also the eth region in the chromosome.\nHomBlock initially computes the similarity between correspond-ing regions. For instance, considering the eth region of homologouschromosome 1, 1, we calculate the similarity between all regions"}, {"title": "4 EXPERIMENT", "content": "Datasets. As mentioned in Section 2.1, we use the dataset sampledfrom healthy people for self-supervised learning. Additionally, wealso use the artificial samples with and without structural abnormal-ities. After self-supervised training, we fine tune HomNet on eachdataset from patients with chromosomal structural abnormalitiesfrom Hos#1, Hos#2, Hos#3 and Hos#4. The number of homologouschromosome pair in a bag is set as 5, that is, m is set as 5. Due tothe privacy and sensitivity of chromosome data with structuralabnormalities, almost all public datasets contain only normal chro-mosomes. Therefore, we constructed artificial structural abnormalchromosome data on the public chromosome dataset Pki-3 [44].Experiments are also performed on this dataset for supplemen-tal reference. More details about the dataset can be found in theAppendix.\nBaseline. We compare our proposed model, HomNet, with severalbaseline models. Specifically, we initially compare our model with aclassical machine learning method: Logistic Regression (LR) basedon feature engineering. Additionally, we conduct experiments usingcommonly employed unsupervised methods for anomaly detection,including OC-SVM [51], Deep-SVDD [46], and an AutoEncoder (AE)based method [61]. Furthermore, we compare our model with su-pervised methods, such as MLP-Mixer [57], Vit [12], Xception [10],ResNet [20], DensNet [23], and MobileNet [22]. In addition, we alsoconduct an experiment with a recent contrastive learning-basedmethod for detecting structural anomalies [5]. This method employsa Siamese architecture and allows for interchangeable backbone"}, {"title": "4.2 Performance Evaluation", "content": "We present the performance of all methods in chromosomal struc-tural abnormalities detection across four hospital datasets in Table 2.The results for Hos#4 outperform those of other hospitals, whilethe outcomes for Hos#1 and Hos#3 are marginally less favorable.The varying performances across different hospitals highlight theinconsistency in the distribution of chromosome data, emphasizingthe need to individually fine-tune the data from each hospital basedon these experimental findings.\nOverall, HomNet demonstrates superior performance across allfour hospitals. On the one hand, the manual feature-based logis-tic regression method only exhibits limited capability in detecting"}, {"title": "4.3 Ablation Study", "content": "HomNet utilizes the homologous similarity between aligned homol-ogous chromosomes (Pair strategy) to diagnose structural abnormal-ities. Additionally, HomNet considers multiple pairs of homologous"}, {"title": "4.4 Running Time Comparison", "content": "We evaluated the running time of HomNet in comparison with othermodels by testing the completion of 100 batches and measuringthe convergence time on the pre-training dataset. The followingresults, presented in seconds, are obtained:"}, {"title": "5 APPLICATION", "content": "For practical clinical diagnostic applications, HomNet integrates anend-to-end pipeline with AutoVision [54], an Al analysis systemfor karyotypes developed by Hangzhou Diagens Biotechnology Co.,Ltd., China. To begin with, physicians upload their patients' kary-otypes to AutoVision, which has been enhanced with the integrationof HomNet. Subsequently, the enhanced AutoVision, now incorpo-rating HomNet, optimizes and organizes the karyotypes, yieldingchromosome diagrams and band level identifications within animpressive 3 seconds, as depicted in Figure Figure 4. The chromo-some diagrams are then converted into sequence data, as detailedin Section 2.1. This sequence data, along with the chromosome typeand band levels, serves as input for HomNet, which diagnoses thepresence of structural abnormalities. The final diagnosis results aredirectly output to the physicians. Notably, HomNet can diagnosechromosomal structural abnormalities using data from a single pa-tient, encompassing 115 pairs of homologous chromosomes fromfive cells, in less than 5 milliseconds."}, {"title": "6 RELATED WORK", "content": "For clarity, we first review methods related to anomaly detection,then introduce works about detecting chromosomes with structuralabnormalities.\nAnomaly detection is an important topic in diverse researchfields and application domains [8, 9, 24]. Anomalies are alsoreferred to as outliers, deviants or abnormalities [2]. Chromosomeswith structural abnormalities that are different from normal chro-mosomes can also be called anomalies.\nTraditional anomaly detection methods include Principal Com-ponent Analysis (PCA) based methods [21, 53], Nearest Neighbor(NN) based methods [6, 31], and the One-Class Support Vector Ma-chine (OC-SVM) [51] that learns a decision function for noveltydetection, that is, classifying new data as similar or different one tothe training set. These methods are unsupervised. Because in the"}, {"title": "7 CONCLUSION", "content": "In this paper, we study the problem of chromosomal structuralabnormalities diagnosis. Inspired by the homologous similarity ofchromosomes and the diagnostic process of doctors, we proposea novel model, HomNet, to model features of chromosomes anddiagnose chromosomal structural abnormalities by homologoussimilarity.\nCentral to our approach is the innovative utilization of multi-ple homologous chromosome pairs: a strategy akin to how skilleddiagnosticians compare multiple diagrams for accuracy. HomNetsimultaneously considers the information of multiple pairs of ho-mologous chromosomes and detects structural abnormalities bycapturing the differences between homologous chromosomes.\nAdditionally, we artificially construct chromosomal samples withstructural abnormalities according to different types of real-worldstructural abnormalities. And self-supervised learning has beenadopted to enable HomNet to fully learn chromosomes with data ofnormal chromosomes and artificial structural abnormalities. Then,we fine-tune HomNet with data from different hospital to addressthe challenge of inconsistent distribution.\nExperimental results show that HomNet achieved significantlybetter performance than other baselines on real-world dataset andpublic datset with artificial abnormalities. In addition, ablationstudies further underscore the indispensability of each componentwithin HomNet, highlighting the synergistic effect of its carefullycrafted design."}, {"title": "A APPENDIX", "content": "According to the real world chromosomes with structural abnormal-ities in our datasets, we construct five types of artificial structuralabnormality chromosome sequences:\n\u2022 Deleted. Part of the sampled chromosome sequences is deleted,which makes the length of the chromosome sequence shorterthan before. The corresponding types of real world chromosomestructural abnormality include deletion: a portion of the chromo-some is missing or has been deleted [33], and the donor chromo-somes in insertion abnormalities: a portion of one chromosomehas been deleted from its normal place and inserted into anotherchromosome [4].\n\u2022 Added with other fragments. The sampled chromosome sequencesare added with a non-self segment, which makes the length of thechromosome sequences longer than before. The correspondingtypes of real world chromosome structural abnormalities includethe receptor chromosomes of insertion abnormality and someunbalanced translocations: a portion of one chromosome hasbeen transferred to another chromosome [36].\n\u2022 Duplicated with self fragments. The sampled chromosome se-quences are added with a segment of its own, which also makesthe chromosome sequences longer. The corresponding type ofreal world chromosome structural abnormality is duplication: aportion of the chromosome has been duplicated [60].\n\u2022 Replaced. One segment of a pair of sampled chromosome se-quences, the left part and right part, is replaced by another, whichdoesn't change the length. If it is replaced by a segment of itself,the corresponding type of real world chromosome structural ab-normality is inversion: A portion of the chromosome has brokenoff, turned upside down, and reattached [38]. If it is replaced bya segment from another pair of sampled chromosome sequences,the corresponding type of real world chromosome structuralabnormality is balanced translocations.\n\u2022 Robertsonian translocation. The chromosome sampling sequencewas symmetrical and repeated, which make the length doubled.The corresponding type of real world chromosome abnormalityis robertsonian translocation: an entire chromosome has attachedto another at the centromere [18]."}, {"title": "A.2 Datasets", "content": "As mentioned in Section 2.1, we use the dataset sampled from bothhealthy people and patients. We split the datasets according to thedesensitized patient IDs. There is no overlap between the patientsin the training set and test set. In the self-supervised learning stage,"}, {"title": "A.3 Experiment setting", "content": "For feature engineering-based LR, we carefully extract features ofone chromosome including mean, variance, on-peak and off-peak ofthe sampled sequence data, and features between the chromosomesin a homologous pair including DTW distance, the correlationcoefficient and covariance. For anomaly detection methods, suchas OC-SVM, Deep-SVDD and AE-based method, we use the dataof normal chromosomes from healthy people as the training set.For the supervised-learning based method, we change the opera-tion of dividing the image into multiple patches in the first stepinto the operation of dividing the sampled sequence into multiplesubsequences or transfer the Conv2D into Conv1D to handle thesequential chromosome data. For LR and OC-SVM, We used thesk-learn [40] library for our experiments. For Deep-SVDD and AE-based method, we use the PyOD [61] libary for our experiments. Thecodes of MobileNet, Xception, DensNet and ResNet refer to https://github.com/weiaicunzai/pytorch-cifar100. The code of MLP-Mixerrefers to https://github.com/google-research/vision_transformer.The code of Vit refers to https://github.com/lucidrains/vit-pytorch.The code of Siamese refers to https://github.com/MEABECHAR/ChromosomeSiameseAD. Besides, we use Adam [30] optimizerwith a learning rate of 0.001 for self-supervised learning and that of0.00001 for fine-tuning, and the batch size is set as 512. During thefine-tuning, we freeze the parameters of CMSBlock and the firstdifference extraction layer in HomBlock, namely the first attentionlayer."}]}