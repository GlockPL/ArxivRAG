{"title": "Optimal Power Grid Operations with Foundation Models", "authors": ["Alban Puech", "Jonas Weiss", "Thomas Brunschwiler", "Hendrik F. Hamann"], "abstract": "The energy transition, crucial for tackling the climate crisis, demands integrating numerous distributed, renewable energy sources into existing grids. Along with climate change and consumer behavioral changes, this leads to changes and variability in generation and load patterns, introducing significant complexity and uncertainty into grid planning and operations. While the industry has already started to exploit AI to overcome computational challenges of established grid simulation tools, we propose the use of AI Foundation Models (FMs) and advances in Graph Neural Networks to efficiently exploit poorly available grid data for different downstream tasks, enhancing grid operations. For capturing the grid's underlying physics, we believe that building a self-supervised model learning the power flow dynamics is a critical first step towards developing an FM for the power grid. We show how this approach may close the gap between the industry needs and current grid analysis capabilities, to bring the industry closer to optimal grid operation and planning.", "sections": [{"title": "1 Introduction and Problem Definition", "content": "In 2018, global electric grid losses led to around 1 gigaton of CO2 emissions, comparable to the annual emissions of half the U.S. households [1]. While optimizing grid operations is challenging due to its size and uncertainties, it is crucial to reduce these losses and fight climate change [2].\nThe grid is divided into high-voltage transmission and lower-voltage distribution. Transmission operators manage four key tasks [3]: grid operation (ensuring operation within safe voltage and power limits), contingency analysis (assessing resilience against outages), economic dispatch (optimizing power generation costs), and capacity expansion (increasing transmission capacity to meet future demand). A number of concurrent factors are adding uncertainty and complexity to grid operations [4]: (1) The energy transition and the shift to weather-dependent renewable energy resources increase the variability in energy production patterns. (2) Changes in consumer behavior and accelerated electrification of the industry and mobility sectors affect demand profiles. Consequently, stochastic optimizations now need to run more scenarios, which is computationally more expensive. (3) The integration of distributed energy resources adds to the challenge, transforming the grid from a top-down system to a distributed network. This requires novel co-simulation frameworks for optimal power flow [5], especially in distribution grids. (4) Extreme weather, aging infrastructure, and grid expansion further intensify the need for frequent and comprehensive contingency analyses [6].\nDealing with the added uncertainty and complexity requires larger and more frequent power flow analysis and optimization. However, current iterative power flow methods scale quadratically with grid nodes [7] and can no longer cope with the problem sizes. The energy transition is thus dependent on the availability of faster, more efficient computational approaches [8]."}, {"title": "2 Proposed Solution", "content": "Foundation Models (FMs) as scalable, operational grid models. Al has already demonstrated great value for power grid operation and optimization\u00b9 [12, 13]. With AI, instead of solving complex physics equations, we shift computational cost from inference to model training, speeding up run-time performance. By exploiting AI FMs [14], pre-trained on large datasets, and fine-tuned on smaller, labeled datasets, we overcome the typical AI challenges of limited application space and lack of topology transferability. The latter is addressed by exploiting known properties of Graph Neural Networks (GNNs) [15], facilitating efficient model adaptation to different grid topologies [16]. By fine-tuning the model to multiple down-stream tasks or sub-grids, pre-training investments can be amortized. FMs have the required skill to approximate complex physical systems, as already demonstrated in weather forecasting [17], with 4\u20135 orders of magnitude speedups [18].\nSolving power flow as a proxy for the underlying grid physics. FMs are typically pre-trained on a suitable reconstruction task in a self-supervised manner [14]. The better pre-training learns structures and dynamics exploited in the downstream task, the better the final model will perform [19]. We thus suggest using power flow as a pre-training task. It (1) describes fundamental power grid physics (Ohm's and Kirchhoff's laws [20, 21]), and (2) is at the core of power grid operations with economic dispatch, contingency analysis, or capacity expansion. With increasing grid sizes and variable grid conditions, these tasks need to be executed increasingly frequently. They can thus greatly benefit from AI-accelerated power flow solutions [22, 9]. A simplified version of the power flow problem can be modeled as follows: We represent a transmission grid as a directed graph G = (N, E), where nodes N are buses (e.g. loads, generators, or slack buses, used to balance power flow by absorbing generation-consumption differences) and edges E are branches (e.g. transmission lines). The net power injection at bus i is Si = pi + jqi, with pi the active, qi the reactive power, and j = \u221a\u20131.\nThe power flow from bus i to bus j is Si,j = Pi,j + jqi,j. The voltage at bus i is Vi = veidi, and the current between buses i and j is Ii,j \u2208 C. The complex impedance Zi,j \u2208 C is a fixed grid parameter. We denote by I, the conjugate of Ii,j. The complex-form power flow equations are:\n\n$Si = \\sum_{(i,j)\\in E} S_{i,j} - \\sum_{(k,i)\\in E} (S_{k,i} - Z_{k,i} |I_{k,i}|^2), \\forall i \\in N$\n\n$I_{i,j} = (V_i \u2013 V_j)/(Z_{i,j})\\ \\forall (i, j) \\in E$\n\n$S_{i,j} = V_i I_{i,j}^* \\forall (i, j) \\in E$\n\nThe real valued equivalent of (A) has 2|N| + 4|E| equations with 4|N| + 4|E| variables. Given the value of at least 2|N| real variables, (A) can be solved for the remaining variables. In the \u201cstandard\" power flow problem [20], the known variables are: the active (generated) power pi and voltage magnitude vi at the generator buses, the active and reactive (load) power pi and qi at the load buses and the voltage magnitude vi and angle di at the slack bus."}, {"title": "3 Methodology and Implementation", "content": "Task and Architecture: Let G = (N, E) be a graph representation of a transmission grid, with node variables xi = (Pi, qi, Vi, di), for all i \u2208 N and edge parameters ei,j = (Zi,j) for all (i, j) \u2208 E. Si,j and Ii,j are not included in the graph, as they can be derived from node variables and edge parameters. To infer missing node variables from the known ones, we build a generative neural power flow equations solver. We train it as an autoencoder using self-supervised learning with node-feature masking strategies, such as GraphMAE [26, 27], on a reconstruction task. Reconstructing a grid graph with all but 2|N| variables masked effectively constitutes solving the power flow equations.\nLoss: The loss function is key to guide and constrain the model during reconstruction training towards meaningful node variable values and within physical boundaries. Within the loss L = LSCE + Lpower flow, the scaled cosine error LSCE minimizes the distance between the reconstructed and the original graphs [26], while Lpowerflow encourages satisfaction of the power flow equations by penalizing deviations between the left and right sides of the equations in (A), similar to [22].\nData: Our focus is reconstructing grid-graphs node variables. Initially, we will use the synthetic power flow dataset from [24]. In the following, to generate power flow problems with real-world profiles as in [24], we will leverage graph topologies from PGLIB-OPF [28], and apply topology and load perturbations. These problems will be solved using Pandapower [29] and PowerModels.jl [30]. This will provide a collection of power flow solutions for various topologies, suitable for training the model on graphs with perturbed topologies (for contingency analysis) and real-world load profiles.\nModel Evaluation and Exploration: In [22] and [24], neural power flow solvers are topology-specific. We believe that a grid FM should also generalize well on diverse grid topologies, whether radial (e.g., Quebec Interconnection) or meshed (as often seen e.g. in the U.S.). We will assess and refine the model architecture and training data towards this goal. The key questions we will answer include: How well can a single model generalize to unseen topologies? How many topology and parameter combinations are needed for training? Should models be tailored to specific ranges of graph sizes? How much fine-tuning is required for optimal performance on a given topology?"}, {"title": "4 Outlook and Expected Impact", "content": "An FM model trained on power flow dynamics can be immediately applied to high-value tasks. We expect minimal fine-tuning for downstream tasks that need power flow to be solved significantly faster. With demonstrated speedups ranging from 2 (for a 500-bus grid) to 4 orders of magnitude (for a 10,000-bus grid) over traditional power flow solvers [22], stochastic simulations of much larger grids become practical. This will benefit applications like (1) replacing power flow solvers for tasks that don't require exact solutions e.g. instead of DC approximations [31]; (2) functional/operational-aware power flow, if fine-tuned with measured power flow data that contain functional and economic constraint. (3) N-1 and higher order contingency analysis; or (4) operationally constrained optimal economic dispatch [4].\nA grid FM has the prospect of becoming an early power grid digital twin. Learning grid dynamics from real-time, operational grid measurements and adding operational constraints may help overcome traditional modeling uncertainties into a data-driven, more accurate representation of even very large grids. With the FM speedup advantage, more optimal grid scenarios can be found, leading to economic gains and higher efficiency, thus lower emission footprints. In Lithuania, e.g., AI models are monitoring and predicting line throughput, resulting in an increased usable transmission capacity of 52% [32]. Large cost savings are also possible by mitigating power outages through optimal grid management. They are estimated to cost American businesses $150 billion every year [33]. Exploiting the very large scenario handling and optimization capability of FMs has further the prospect of significantly impacting long-term grid expansion planning [9]."}, {"title": "5 Appendix", "content": ""}, {"title": "5.1 Masking and reconstruction steps", "content": ""}, {"title": "5.2 Downstream tasks", "content": "We provide an overview of the motivation and implementation directions for a selection of high-value downstream tasks that directly leverage our proposed model:\n(1) Replacing Numerical Power Flow Solvers. Motivation: Solving power flow problems is computationally expensive, with the most accurate solvers relying on Newton's method to iteratively solve the AC power flow equations [34] (refer to Equations (A)). Implementation: For applications that require solving power flow many times, where speed is valued over accuracy, linearized approximations (such as DC power flow [35]) are typically used. These applications can directly benefit from faster AI-based power flow solvers, used in place of DC power flow solvers. We expect minimal fine-tuning of our model for power flow solving, as the task is equivalent to the suggested pre-training reconstructing task when masking all node variables except for: active (generated) power pi and voltage magnitude vi at the generator buses, active and reactive (load) power pi and qi at the load buses, and the voltage magnitude vi and angle di at the slack bus. Depending on the masking strategy during training, if sufficient number of graphs are masked according to the power flow problem, no fine-tuning may be necessary at all.\n(2) Functional/Operational-Aware Power Flow. Motivation: While power flow analysis is essential for grid modeling and analysis, it does not account for important functional constraints or economic factors inherent in grid operation. This is problematic for applications like operational planning, capacity expansion (where various grid configurations are simulated for future load and generation conditions), or contingency analysis (where it is crucial to determine whether the grid can handle the loss of a generator or line). Accurate representation of grid operation for these scenarios is vital, but it is difficult to model using traditional mathematical approaches. However, these dynamics can be inferred and learned by data-driven AI models from observed and historic grid operations data, enabling more accurate grid simulations, improving grid planning, and potentially reducing over-provisioning and safety margins. Implementation: After pre-training on a collection of power flow problems solved using physics-based methods, our model learns the power flow dynamics as described by the equations. Complementing this initial pre-training with a second, self-supervised reconstruction phase using real data collected under various conditions over an extended period of time should augment the model with the additional dynamics associated with grid operation. Another possibility is to use the pre-trained model to generate grid embeddings, which could then be used in conjunction with another model that accounts for external information such as time of the day, date, and other factors typically influencing grid operation. This combined model could be fine-tuned on real-world data to capture operational nuances."}, {"title": "(3) Contingency Analysis.", "content": "Contingency analysis is essential for assessing grid resilience. In an N-1 contingency analysis, the loss of one line, one transformer, or one generator is simulated, and grid stability is assessed for many possible scenarios using power flow analysis. Currently, operators are constrained by the time required to perform a single power flow analysis, limiting the number of scenarios they can evaluate. For example, an N-1 contingency analysis on the Western Interconnection takes approximately 5 minutes [9]. On a grid with 1,000 lines, simulating all possible losses of 1 line requires solving 1,000 power flow problems. However, simulating scenarios involving the losses of any 2 components, requires 499,500 power flow analyses, as the problem scales with k (the number of lost elements) as O(Nk), where N is the number of candidate lost elements. A 100 times faster power flow solver would allow operators to run contingency analyses with many more scenarios (solving 499,500 scenarios with AI would only take as long as solving 5,000 scenarios using traditional physics-based power flow solvers), thereby greatly enhancing grid resilience assessments. Implementation: For a power flow model that additionally accounts for changing grid topologies, experiments will be necessary to determine if the model can directly manage this extra complexity. Alternatively a fine-tuned model may be used, on datasets obtained by solving power flow problems on grids with perturbed topologies (e.g., with dropped generators, lines, transformers, etc.)."}, {"title": "(4) Operationally Constrained Optimal Dispatch.", "content": "The goal of optimal power flow (OPF) is to determine the most efficient operating conditions for a power system. Economic dispatch is a variant of OPF that specifically aims to minimize generation costs. OPF problems are typically solved using interior point methods, which require the computation of the Hessian of a Lagrangian function at each step. Accelerating the solution of power flow problems while integrating both functional and economic operator constraints is of high value. This can replace DC-approximation-based solvers, that may give infeasible solutions [36]. For example, [22] demonstrated an OPF speedup of 2 to 4 orders of magnitude and accurate solutions, but the model was trained on synthetic data only. Implementation: OPF is an optimization problem, distinct from the standard power flow problem. The generator outputs are unknown and must be determined to meet load demands, while respecting generator capacities, and line capacity constraints. Whether OPF can be treated as a reconstruction task by masking the generator power in addition to the variables usually masked in power flow problems is subject of further studies. The challenge is that the reconstructed generator power must also minimize an objective function (like cost in economic dispatch), which the model does not know. We anticipate good performance of models fine-tuned on reconstruction tasks with fixed generator cost, but they may not generalize well to other cost functions or generator capacity constraints. The challenge is exacerbated by reconstructed node variables that must adhere to bounds (e.g., generator capacity constraints) that the model does not know either, calling into question a feasible solution altogether. However, we are confident that power flow solvers can be hierarchically integrated into optimization schemes where generator power is iteratively adjusted, solution feasibility is checked, and other variables are determined using the power flow solver. By combining existing optimization schemes to modify the generator variables, an optimal setting within the solution space can then be found. This is an approach we will explore in the future."}]}