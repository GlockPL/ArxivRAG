{"title": "An Adaptive CSI Feedback Model Based on BiLSTM for Massive MIMO-OFDM Systems", "authors": ["Hongrui Shen", "Long Zhao", "Kan Zheng", "Yuhua Cao", "Pingzhi Fan"], "abstract": "Deep learning (DL)-based channel state information (CSI) feedback has the potential to improve the recovery ac- curacy and reduce the feedback overhead in massive multiple- input multiple-output orthogonal frequency division multiplexing (MIMO-OFDM) systems. However, the length of input CSI and the number of feedback bits should be adjustable in different scenarios, which can not be efficiently achieved by the existing CSI feedback models. Therefore, an adaptive bidirectional long short-term memory network (ABLNet) for CSI feedback is first designed to process various input CSI lengths, where the number of feedback bits is in proportion to the CSI length. Then, to realize a more flexible feedback bit number, a feedback bit control unit (FBCU) module is proposed to control the output length of feedback bits. Based on which, a target feedback performance can be adaptively achieved by a designed bit number adjusting (BNA) algorithm. Furthermore, a novel separate training approach is devised to solve the model protection problem that the UE and gNB are from different manufacturers. Experiments demonstrate that the proposed ABLNet with FBCU can fit for different input CSI lengths and feedback bit numbers; the CSI feedback performance can be stabilized by the BNA algorithm; and the proposed separate training approach can maintain the feedback performance and reduce the complexity of feedback model.", "sections": [{"title": "I. INTRODUCTION", "content": "Massive multiple-input multiple-output (MIMO) technology has become the key technology of 5G mobile communication due to its high spectrum efficiency [1], [2]. To generate beamforming for downlink signal transmission, it is neces- sary to obtain timely and accurate downlink channel state information (CSI) at the next generation nodeB (gNB). In time division duplex (TDD) mode, the downlink CSI can be directly estimated from uplink pilot by using channel reciprocity [3]. While in frequency division duplex (FDD) mode, different frequency bands are employed for uplink and downlink, making it challenging to estimate the downlink CSI from uplink pilot. Consequently, the CSI feedback scheme for massive MIMO in FDD systems has become one of hot topics in recent years.\n The traditional CSI feedback methods, such as compressive sensing (CS) algorithms [4], [5], utilize the channel sparsity and orthogonal basis matrix to compress CSI and then feed-back the low-dimension CSI to the gNB for reconstruction. However, the actual channel is not completely sparse on any orthogonal basis. Moreover, both the number of algorithm it- erations and the feedback overhead increase dramatically with the increasing number of antennas in massive MIMO systems. Therefore, feasible CSI feedback methods for massive MIMO systems need to be further studied.\n Recently, artificial intelligence (AI) has been developed rapidly, including deep learning (DL) [6]\u2013[8] and reinforce- ment learning (RL) technology [9]-[11]. In particular, wire- less communication systems based on DL frameworks have attracted a lot of attention, which can efficiently achieve channel estimation [12], [13], feedback [14]-[22], channel encoding[23], and signal detection [24]. Specifically, the DL- based CSI feedback, including full channel CSI feedback and eigenvector-based CSI feedback, has been widely studied since it can provide higher recovery accuracy and lower feedback overhead simultaneously.\n For the full channel CSI feedback, a kind of CSI feedback architecture based on the autoencoder structure [25], termed as CsiNet, was first introduced in [14]. Based on which, a series of feedback models were proposed to improve the feedback accuracy by optimizing the model structure or quantizing method of the compressed vector with continuous values [15]\u2013 [19]. On the other hand, for the eigenvector-based CSI feed-back discussed by 3rd generation partnership project (3GPP) [26], fully connected layers and convolutional neural network (CNN) are adopted to design EVCsiNet [20]. Moreover, the encoder of Transformer was used for both the encoder and decoder of CSI feedback model to compress and recover the eigenvectors [21]. And in [22], authors proposed a lighter model, named MixerNet, based on MLP-Mixer structure [27].\n These studies in [14]-[22] primarily focus on the design of DL-based models or quantization methods to improve the CSI feedback performance, they needs to train and store a large number of feedback models to handle different input CSI lengths and feedback bit numbers. Therefore, for the full channel CSI feedback, the model with adaptive inputs or compression ratios (CRs) are studied. On the one hand, a DL- based feedback schemes only relying on fully convolutional are proposed for CSI with different numbers of subcarriers and antennas, however realizing multiple CRs needs a list of model parameters [28]-[30]. On the other hand, a framework consisting of an encoder with multiple fully connected layers and multiple decoders is proposed to realize various CRs by"}, {"title": "II. SYSTEM MODEL", "content": "This section firstly introduces massive MIMO-OFDM sys- tem model and then discusses the DL-based CSI feedback model in detail."}, {"title": "A. Massive MIMO-OFDM System Model", "content": "In a massive MIMO-OFDM system, $N_T$ transmit antennas are deployed at the gNB and $N_R$ receive antennas are deployed at each UE. As illustrated in Fig. 1, by leveraging channel estimation at the UE [38], the downlink channels in fre- quency domain can be obtained based on the pilot sequences transmitted by the gNB. Then, the downlink channels are divided into K subbands, where each subband consists of $N_{sc}$ subcarriers and the subcarriers in the same subband employ the same beamformer at the gNB in order to reduce the system complexity. The common beamformer in each subband can be obtained by the following method in order to maintain the performance of each subcarrier.\n Assume that the downlink channel of the nth subcar- rier in the kth subband is denoted as $H_{kn} \\in \\mathbb{C}^{N_R \\times N_T}$ (1 \u2264 k \u2264 K,1 \u2264 n \u2264 Nsc). Then, the correlation matrix of the channel of each subcarrier in the kth subband can be calculated as $H_{kn}H_{kn}^H$, and the average correlation matrix of the kth subband can be written as\n\n$R_k = \\frac{1}{N_{sc}} \\sum_{n=1}^{N_{sc}} H_{kn}H_{kn}^H$\n\nBased on eigenvalue decomposition (EVD), the feedback eigenvector of the kth subband can be calculated by\n\n$R_k w_k = \\lambda_k w_k$,\n\nwhere $\\lambda_k$ and $w_k = [w_{k1}, w_{k2},\u2026, w_{kN_T}]^T \\in \\mathbb{C}^{N_T \\times 1}$ represent the maximum eigenvalue and corresponding eigenvector of matrix $R_k$ in the kth subband. From (2), $w_k$ is a complex vector; to fit for the processing of universal neural network, the corresponding real-valued eigenvector is given by\n\n$\\mathbf{w}_{k} = [\\text{Re} \\{w_{k1}\\}, \\text{Im} \\{w_{k1}\\},\u2026, \\text{Re}\\{w_{kN_T}\\}, \\text{Im}\\{w_{kN_T}\\}]^T$"}, {"title": "B. DL-Based CSI Feedback Model", "content": "Since the CSI feedback scheme is comparable to the overall workflow of the autoencoder, the autoencoder architecture can be employed to design the DL-based CSI feedback framework. As shown in Fig. 1, an adaptive CSI feedback model is proposed to adapt to the input CSI eigenvector with different lengths and various numbers of feedback bits.\n Among the feedback model, the UE first obtains the CSI eigenvector w and compresses it to codeword vector c by the encoder, which is denoted as\n\n$c = f_{\\text{OE}}(\\mathbf{w}, K)$,\n\nwhere $f_{\\text{OE}}(\\cdot)$ is the encoder function with parameter set $\\Theta_E$. And the length $m$ of codeword vector c changes proportionally with K.\n Then, a FBCU module is applied to make the codeword vector c changeable based on the capacity requirements of feedback channel. If the number q of quantization bit is fixed, the length of feedback bits obtained after quantization is also changeable according to the length n (\u2264 m) of c. Therefore, if the FBCU module is applied, (5) becomes\n\n$c = f_{\\text{OE}}(\\mathbf{w}, K, \\eta)$.\n\nAfter passing through the quantization and dequantization module, the obtained feedback bit stream s and recovered codeword vector $\\hat{c}$ can be respectively expressed as\n\n$\\mathbf{s} = f_{\\text{quan}}(\\mathbf{c}), \\hat{\\mathbf{c}} = f_{\\text{dequan}}(\\mathbf{s})$,"}, {"content": "where $f_{\\text{quan}}(\\cdot)$ and $f_{\\text{dequan}}(\\cdot)$ are the quantization and de- quantization functions, respectively.\n Finally, the gNB reconstructs the CSI eigenvector $\\hat{\\mathbf{w}}$ with the decoder module, which is denoted as\n\n$\\hat{\\mathbf{w}} = f_{\\text{OD}}(\\hat{\\mathbf{c}}, K)$,\n\nwhere $f_{\\text{OD}}(\\cdot)$ is the decoder function with parameter set $\\Theta_D$. Usually, the square of generalized cosine similarity (SGCS) is taken to evaluate the recovery performance of eigenvector- based CSI feedback. The average SGCS $\\rho$ between the original joint eigenvector w and the recovered joint eigenvector $\\hat{\\mathbf{w}}$ with K subbands can be written as\n\n$\\rho = \\frac{1}{K} \\sum_{k=1}^K \\bigg( \\frac{|w_k^H \\hat{w}_k|}{|w_k|||\\hat{w}_k||} \\bigg)^2$\n\nThen, one objective of the paper is to optimize the model weight parameter set $\\Theta_1 = \\{\\Theta_E, \\Theta_D\\}$ to make the feedback performance $\\rho$ as high as possible, as most existing studies [14]-[22] have done. On the other hand, for the proposed separate training with multiple UEs and a single gNB, the objective is to optimize the weight parameter set $\\Theta_2 = \\{\\Theta_{E1}, \\Theta_{E2},\u2026, \\Theta_{EN}, \\Theta_D\\}$ to make the feedback performance $\\rho$ of all N UEs as high as possible, i.e.,\n\n$\\Theta_2 = \\arg \\max_{\\Theta_2} \\frac{1}{N} \\sum_{n=1}^N \\rho_n (\\Theta_{En}, \\Theta_D)$,\n\nwhere $\\Theta_{En}$ and $\\rho_n$ (1 \u2264 n \u2264 N) represent the encoder parameters set and the SGCS of the nth UE, respectively."}, {"title": "III. ADAPTIVE CSI FEEDBACK MODEL", "content": "The adaptive CSI feedback model based on BiLSTM struc- ture, named ABLNet, is first introduced in this section. The role of ABLNet includes adapting to different input lengths of CSI eigenvectors and ensuring the recovery accuracy. Then, the FBCU module is designed to make the feedback bit number of ABLNet model more adjustable. Based on which, the BNA algorithm is introduced to achieve the target SGCS for every input CSI by adjusting the number of feedback bits."}, {"title": "B. ABLNet for Adjustable Subband Number", "content": "1) Deal with different subband numbers: Generally, DL- based models have the fixed-length input interface. As a result, in order to satisfy the fixed input length of the proposed ABLNet, the input CSI eigenvectors with different number of subbands need to be unified to the maximum number of subbands through the approach of padding 0. Meanwhile, the BiLSTM layer only processes the non-zero input part during the feature extraction and the zero-padding part is automatically ignored. Therefore, on the one hand, every subband eigenvector of each kind of subband number can be further compressed and quantified through the ABLNet after padding operation; on the other hand, the length Q of feedback bit streams is in proportion to the number K of CSI eigenvector subbands.\n In this way, when the ABLNet model receives CSI eigen- vectors with different subband numbers in different scenarios, the feedback overhead can also change with the subband number. As shown in Fig. 4, CSI eigenvectors with subband number $K_1, K_2,\u2026\u2026, K_M$ are input to the model, and after compression and quantization, the lengths $Q_1, Q_2, \u2026, Q_M$"}, {"title": "C. FBCU for Adjustable Feedback Bit Number", "content": "Since the encoder output length $m$ of the codeword vector $c$ and the number q of quantization bit for each float number in the output codeword vector $c$ are predetermined, the CSI feedback bit stream s obtained by the UE has a constant length Q, which can be calculated as\n\n$Q (m) = m \\times q$.\n\nWhile in the actual communication systems, different sce- narios or applications may require changeable feedback over- head, even for the same length of input eigenvector. And every subband CSI eigenvector can report different length of feedback information. Therefore, as shown in Fig. 5, a CSI feedback scheme with FBCU that adapts to different numbers of feedback bits is proposed to improve the generalization and practicability of the CSI feedback model.\n 1) FBCU principle: The FBCU is applied for CSI feedback model to change the length of the compressed vector output by the encoder and further change the number of feedback bits. Assuming the output codeword vector of the encoder is c = $[c_1, c_2,..., c_m]$ in Fig. 5, the FBCU can maintain the code- word vector with length n, i.e., $\\bar{c}$ = $[c_1, c_2, \u2026\u2026\u2026, c_n]$, according to the feedback overhead requirements and directly discard the rest part of the codeword vector, i.e., $[c_{n+1},c_{n+2},\u2026\u2026\u2026, c_m]$. Then, the remaining codeword vector $\\bar{c}$ is quantized and fed back to the gNB through the feedback link. Due to the fact that"}, {"title": "D. BNA Algorithm for Target SGCS", "content": "1) Purpose of BNA algorithm: Generally, when the CSI feedback performance approaches one target SGCS $p_t$, further improving the SGCS will increase little communication perfor- mance and meanwhile consume a lot of feedback overhead. On the other hand, for the varying input CSI eigenvectors, the SGCS performance is different with a fixed number of feedback bits. Therefore, by utilizing the adjustable character- istic of feedback bit numbers of ABLNet with FBCU, a BNA algorithm is developed to increase or decrease the number Q of feedback bits to make the SGCS performance $\\rho$ stabilize at a reasonable target SGCS $p_t$ for every feedback eigenvector.\n 2) Description of BNA algorithm: Assume that the min- imum and maximum number of feedback bits supported by ABLNet with FBCU are $Q_{min}$ and $Q_{max}$, respectively; given the initial feedback bit number $Q_i$, the corresponding SGCS performance $p_i$, the target SGCS $p_t$ and the tolerance error $\\epsilon = 0.01$, the BNA algorithm is shown in Algorithm 1.\n In Algorithm 1, according to the relation of $p_i - p_t$ and $\\epsilon$, the Binary_Search method is taken to find the appropriate feedback bit number $Q_a$, making the corresponding feedback performance $p_a$ within the tolerance error $\\epsilon$ of $p_t$. Because the SGCS performance $\\rho$ increases with the feedback bit number Q, taking the binary search strategy can improve the adjustment efficiency. Finally, both $Q_a$ and $p_a$ are the output of the BNA algorithm as the final adjusted feedback bit number and SGCS performance, respectively.\n Moreover, if the $p_a$ has reached the error $\\epsilon$ range of $p_t$, but the adjusted feedback bit number $Q_a$ is lower than $Q_{min}$ or higher than $Q_{max}$, the BNA algorithm takes the $Q_{min}$ or $Q_{max}$ and the corresponding feedback performance as the final output."}, {"title": "E. UE-First Separate Training for Different Manufacturers", "content": "1) Training process: When the UE and gNB come from different manufacturers, the trained encoder that matched to the adopted decoder at the gNB may not be transmitted to the UE due to the model protection. On the other hand, most"}, {"title": "V. CONCLUSIONS", "content": "This paper proposes an adaptive CSI feedback model ABLNet and designs a FBCU to process different lengths of input CSI eigenvectors and numbers of feedback bits. Then, a BNA algorithm is developed to achieve a target SGCS for every input CSI by adjusting feedback bit number flexibly. Moreover, a UE-first separate training approach is realized for decoupled training of encoders and decoder among the UEs and gNB from different manufacturers. Experiments reveal that the proposed ABLNet has better feedback performance with adapting different lengths of input CSI. Meanwhile, ABLNet with FBCU can improve the model robustness and maintains the SGCS performance. The designed BNA algo- rithm can effectively stabilize the SGCS performance for every input CSI with fewer number of feedback bits. Finally, separate training delivers comparable feedback performance to joint training model, and can reduce the complexity of feedback model."}]}