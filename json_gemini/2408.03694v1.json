[{"title": "A Blockchain-based Reliable Federated Meta-learning for Metaverse: A Dual Game Framework", "authors": ["Emna Baccour", "Aiman Erbad", "Amr Mohamed", "Mounir Hamdi", "Mohsen Guizani"], "abstract": "The metaverse, envisioned as the next digital frontier for avatar-based virtual interaction, involves high-performance models. In this dynamic environment, users' tasks frequently shift, requiring fast model personalization despite limited data. This evolution consumes extensive resources and requires vast data volumes. To address this, meta-learning emerges as an invaluable tool for metaverse users, with federated meta-learning (FML), offering even more tailored solutions owing to its adaptive capabilities. However, the metaverse is characterized by users heterogeneity with diverse data structures, varied tasks, and uneven sample sizes, potentially undermining global training outcomes due to statistical difference. Given this, an urgent need arises for smart coalition formation that accounts for these disparities. This paper introduces a dual game-theoretic framework for metaverse services involving meta-learners as workers to manage FML. A blockchain-based cooperative coalition formation game is crafted, grounded on a reputation metric, user similarity, and incentives. We also introduce a novel reputation system based on users' historical contributions and potential contributions to present tasks, leveraging correlations between past and new tasks. Finally, a Stackelberg game-based incentive mechanism is presented to attract reliable workers to participate in meta-learning, minimizing users' energy costs, increasing payoffs, boosting FML efficacy, and improving metaverse utility. Results show that our dual game framework outperforms best-effort, random, and non-uniform clustering schemes improving training performance by up to 10%, cutting completion times by as much as 30%, enhancing metaverse utility by more than 25%, and offering up to 5% boost in training efficiency over non-blockchain systems, effectively countering misbehaving users.", "sections": [{"title": "I. INTRODUCTION", "content": "Recently, the concept of metaverse has gained considerable attention, driven by the COVID-19 pandemic's constraints on physical mobility and the interests of major tech companies [3]. Through customizable 3D avatars, users can engage in activities mirroring real-life experiences within this shared virtual reality. The advancement of metaverse technology has substantially reduced the barriers between physical and digital worlds, aided by technologies like digital twins, blockchain, extended reality (XR), and AI algorithms [4]. As this digital frontier evolves, high-performing AI models are required to ensure a seamless user experience and real-time rendering. However, a significant challenge arises from the scarcity of data within each user's individual context and the need for frequent model personalization due to the ever-shifting nature of tasks. These dynamics demand extensive resources, vast data volumes, and high learning time to train robust and adaptive models.\nTo overcome this limitation and enhance model perfor- mance, a collective training approach, Federated Learning (FL), is required, facilitating collaborative model refinement across decentralized devices. The integration of Federated Learning in the metaverse (FL4M) [5] promises enhanced data privacy and security, alongside decentralized machine learning that leverages user-generated data and computational resources for model building. Yet, in the metaverse, effective management of heterogeneous data is crucial to maintain data utility. In FL, data heterogeneity arises due to diverse client data characteristics, often exhibiting non-independent and non-identically distributed (non-IID) properties, affecting model accuracy. This heterogeneity is not limited to data characteristics; indeed, the metaverse has enormous number of users, objects, and interactions, which creates scalability challenges for traditional FL algorithms. Users may have different preferences, devices, and learning tasks, which can create challenges to adapt to the behavior of the avatars, pursue the ever-shifting nature of their tasks, and provide a more personalized experience, especially that FL mainly focuses on learning one ML task across multiple devices [6]. Furthermore, users expect a responsive and adaptive virtual environment, which cannot be achieved through FL that requires long re- training. Addressing these multifaceted heterogeneity aspects is crucial for efficient FL solutions in the metaverse.\nFederated Meta-Learning (FML), known as \"learning to learn\", emerges as a solution to tackle multi-task learning challenges [7], while preserving the benefits of Federated Learning, such as data security and flexibility [8]. Particularly, initialization-based meta-learning algorithms are well known for fast adaptation and strong generalization to new tasks [9]. In other words, it enables a model to adapt swiftly to new tasks by using its prior experience from other tasks in real-time. As an illustrative example, in a vehicular metaverse, distinct users engage within similar virtual environments but with differing tasks and objectives, such as optimizing fuel efficiency and improving driving techniques. FML demonstrates its prowess by seamlessly accommodating these divergent tasks using different data and offering personalized virtual driving models catering to each user's unique needs. Additionally, FML con- siders evolving tasks within the metaverse, such as simulating snowy roads, efficiently personalizing previously generated models with minimal data samples, computation resources, and learning latency.\nHowever, despite its promising benefits, FML comes with new challenges in the metaverse. Specifically, three critical issues must be addressed. First, the metaverse has a vast number of heterogeneous users with diverse data structures, tasks, and sample sizes, making collective training inefficient due to unrelated tasks and leading to low convergence speed with random uniform device selection [7], [10]. Non-uniform device selection widely applied for FL [8] face challenges in FML due to bias, statistical heterogeneity, and high-order information in stochastic gradients. Excluding meta-learners with minimal contributions, as proposed in [11], is not feasible in the metaverse, where users actively seek participation to craft personalized experiences. Therefore, a clustering mech- anism should be wisely designed to group metaverse users based on their tasks and data similarity. Coalition formation games have been introduced in the context of FL to support Hierarchical Federated Learning (HFL) techniques [12] or to optimize communication resource efficiency [13]. Neverthe- less, the high diversity of tasks within the metaverse poses a challenge, making conventional clustering methods unsuitable for direct application. Secondly, some metaverse users may misbehave to selfishly increase their utility, resulting in a bad training experience. Hence, clustering mechanism should consider the presence of unreliable users to create a fair training circumstances among different coalitions in order to minimize the impact on each coalition's training performance. Third, users' devices may be unwilling to engage in metaverse services due to resource allocation concerns, energy consump- tion, and the absence of appropriate incentives. While resource allocation and incentive mechanisms for FL have been the focus of extensive research, particularly for metaverse [14], [15], FML remains underexplored.\nIn this paper, to the best of our knowledge, we are the first to design a framework that manages the usage of feder- ated meta-learning to empower metaverse services. Our novel distributed computing framework integrates FML techniques with blockchain technology [16], [17] to address the unique challenges of the metaverse previously discussed and pave the way for efficient and personalized learning strategies. The framework introduces a dual game mechanism consisting of a cooperative coalition formation game for clustering metaverse meta-learners and a Stackelberg game for resource allocation and incentives, which are novel approaches not explored before in the context of FML. On one hand, the coalition formation game clusters metaverse meta-learners based on their tasks similarities, contributions and reputations, address- ing the inefficiencies caused by statistical heterogeneity and ensuring average reliability of each coalition. On the other hand, the Stackelberg game serves as an incentive mechanism to ensure fair payoff distribution among metaverse users within each coalition according to their contribution. The framework operates in steps process, starting with users requesting per- sonalized meta-models from a metaverse service provider and concluding with the update of different models and reputa- tions of users after each FML round. Throughout training rounds where both games interact, our framework enables efficient meta-training, enhances users contributions and pay- offs, and reduces energy costs while promoting collaboration and fairness among them. Blockchain technology underpins the framework, to securely manage reputations and incentives, track participation, and ensure transparent interactions among metaverse entities. Our contributions are:\n\u2022 We introduce a novel blockchain-based reliable federated meta-learning framework designed to support immersive user experiences in the metaverse. Our framework lever- ages a unique dual game mechanism to address the chal- lenges of tasks heterogeneity and prompt personalization.\n\u2022 We propose a cooperative coalition formation game to cluster metaverse users based on their computation con- tribution, model embedding similarity, and overall rep- utation, which is partly dependent on past contributions to similar tasks. This proposed approach effectively ad- dresses the inefficiencies caused by statistical diversity in the metaverse.\n\u2022 We introduce a novel method that quantifies the impact of users on model performance and tasks completion time as contribution. On these bases, a reputation management scheme is designed based on historical contributions and potential contributions to present tasks, leveraging correlations between past and new tasks.\n\u2022 We formulate a Stackelberg game to incentivize reli- able users to participate in metaverse FML services and improve system utility. This game-theoretic approach ensures optimal resource allocation and fair payoff dis- tribution among FML participants within each coalition.\n\u2022 We present an algorithm, namely Game-Theoretic Fed- erated Meta-Learning (GFML) for the metaverse, that leverages the interaction between the dual games.\n\u2022 Simulation results show that our proposed framework in a metaverse system guarantees better learning performance and resilience against malicious metaverse users. Addi- tionally, users can obtain higher profits compared to the best-effort, random and non-uniform clustering schemes.\nThis paper is organized as follows: Section II provides an overview of existing literature on federated learning and fed- erated meta-learning. In Section III, we detail the framework and system model for our proposed blockchain-based reliable federated meta-learning in the metaverse. The development of the reputation model and the coalition formation game are introduced in Section IV. The incentive mechanism based on the Stackelberg game is formulated in Section V. An evalua- tion of the performance of our reliable metaverse framework is presented in Section VI. Finally, Section VII concludes the"}, {"title": "II. RELATED WORKS", "content": "The metaverse has gained significant attention, driving research into integrating advanced technologies and AI tech- niques, such as digital twin [4], XR [3], blockchain [18], and semantic learning [19]. Federated learning has particularly garnered interest for its ability to ensure data privacy and leverage user resources in the metaverse [5]. For example, Zhou et al. [15] proposed an optimization framework for FL in mobile augmented reality within the metaverse, focusing on minimizing energy consumption and completion time while improving model accuracy. Kang et al. [18] explored a privacy-preserving FL framework for the industrial metaverse using blockchain. However, these works primarily focused on re- source and time performance, overlooking the critical aspect of data heterogeneity among learners. Zeng et al. [14] presented HFedMS, an FL system for the industrial metaverse that addresses data heterogeneity and learning forgetting through clients regrouping and semantic compression and compen- sation. Most of federated learning efforts in the metaverse, including HFedMS, aim to address the core issue which is data heterogeneity. Nevertheless, the metaverse's heterogene- ity extends beyond data characteristics and user preferences, encompassing system and protocol variations that challenge traditional FL. Furthermore, the dynamic and personalized nature of the metaverse, with users having evolving and diverse tasks, poses additional challenges for FL algorithms, which primarily focus on learning a single task across devices.\nEfficiently addressing these multifaceted heterogeneity is- sues is crucial for enhancing collaborative training perfor- mance within the metaverse's unique ecosystem, which is the focus of this paper. Federated Meta-Learning offers a promis- ing solution by enabling fast adaptation to new tasks and heterogeneous users, increasing learning accuracy for diverse multi-task environments, and allowing diverse metaverse users to handle a wide range of scenarios and contexts. Despite its advantages, FML has not been integrated or adapted for the metaverse, leaving user-specific needs unmet. To our knowl- edge, we are the first to propose the integration and adaptation of FML techniques to cater to the tasks-heterogeneity of users in the metaverse dynamic environment.\nRecent literature shows growing interest in FML, with efforts focusing only on enhancing model convergence and accuracy through optimized loss functions and averaging methods for general applications. Among these mainstream works, Chen et al. introduced FedMeta, an FML method enhancing FL and FedAvg through a Model-Agnostic Meta- Learning (MAML) algorithm [20] for high statistical and systematic challenges. Jiang et al. explored the relationship between MAML and FedAvg, demonstrating improved and stable personalized performance offered by FML [21]. Lin et al. analyzed FML convergence considering adversarial data and strongly convex loss functions [22], while Fallah et al. confirmed FML's convergence in non-convex scenarios with stochastic gradients [7]. The FML algorithms described above frequently face challenges with slow convergence and inef- ficient communication due to random device selection. Non- uniform device selection has been proposed in meta-learning [11], which involves the exclusion of users with minimal contributions to the training. This approach is impractical in metaverse, as users actively seek participation to create personalized experiences. Clustering all active users looking for a customized experience according to their tasks and context similarities, is not explored in the literature. Our paper will not focus on enhancing loss and averaging performance as is common in existing works, where well-established tech- niques prevail. Instead, we aim to bridge a significant gap by proposing a novel method for dynamic clustering tailored to the unique needs of the metaverse.\nAnother critical gap in FML literature is the lack of"}, {"title": "III. FRAMEWORK AND SYSTEM MODEL", "content": "Fig. 1 presents the federated meta-learning process in the metaverse, including the coalition formation phase and the meta-learning execution phase guided by the stackelberg game.\nOur framework introduces a novel integration of federated meta-learning within the metaverse, leveraging blockchain technology for decentralized management of interactions among metaverse Meta-Learners (MMLs). At its core, the framework is designed to ensure reliable and real-time person- alized experiences through a dual game managing metaverse users and their contributions to the FML process. Specifically, the process unfolds in seven sequential steps, beginning with MMLs requesting meta-models from a metaverse Service Provider (MSP) and concluding with the MSP updating the requested models and reputations of MMLs post each FML round. Central to this process is the cooperative coalition for- mation game clustering MMLs based on utility maximization, and a Stackelberg game framework for optimal task allocation and incentives distribution. Blockchain technology underpins the framework, managing the reputations of MMLs through a decentralized and tamper-proof mechanism, securing transac- tions between MMLs and the MSP, and ensuring that incen- tives are distributed fairly and transparently. It also records all interactions, formed coalitions and MMLs' contributions, thereby providing an immutable and trusted history that can be referenced for future coalition formation, tasks allocation, incentives distribution, and reputation updates. Details about this process are introduced as follows:\nStep 1: A set $N$ of metaverse meta-learners request meta- models from the MSP through the blockchain layer. Each MML looks for a good model initialization, i.e., meta-model, that can be quickly re-fined to a high-performing model via one or few gradient descent steps $\\tau \\geq 1$, in order to be used for the personalized tasks and potential new learning tasks. Furthermore, each MML $i \\in N$ has a labeled private dataset $D_i = \\{(x,y)\\}$, where $(x,y) \\in \\mathcal{X} \\times \\mathcal{Y}$ is a data input following an underlying distribution $P$ with $x$ denoting the sample and $y$ denoting the label. MMLs might opt to join the FML process, offering their data and computing resources in exchange for incentives (Active MMLs), or they might choose to acquire a pre-trained model and perform only the personalization phase (Passive MMLs). Hence, the set $N$ is defined as $N = \\{1, ..., N_a\\} \\cup \\{1, ..., N_p\\}$, where $N_a$ is the number of active MMLs and $N_p$ is the number of passive MMLs. It is worth noting that each active learner $i$ submits its request with its tolerated task completion time $T^{max}_i$, maximum and minimum CPU frequency, i.e., $\\delta^i_e$ and $\\delta^i_d$, that it can offer, its location, and its data characteristics.\nStep 2: To evaluate the reliability of active MMLs, the blockchain system calculates composite reputation scores de- rived from the historical contributions of various users in previous tasks. Miners play an essential role in this process by being incentivized to safely record the users' interactions with the metaverse and calculate their composite reputations when needed.\nStep 3: The MSP initiates a blockchain transaction to recruit the MMLs willing to serve for the learning tasks in the metaverse and choose among them a set $H = \\{h_1,...,h_M\\}$ of $M$ heads with lower task completion constraints and superior blockchain-recorded reputations. The heads serve as aggregators for the FML tasks. The transaction contains the requirements of the MSP, such as the reputation threshold $R_{th}$, and the incentives $I_{rep}$ and $I_{comp}$ for reputation and competition contributions, respectively. It also includes the initial model parameters, such as the weights $\\theta$ of the Deep Neural Network (DNN) in addition to the number of local computational epochs $\\tau$ that should be processed by any active MML.\nStep 4: Due to data heterogeneity and task objectives, MMLs are clustered into $M$ coalitions, i.e., $\\Pi = \\{C_1, ..., C_M\\}$, led by the selected heads using a cooperative coalition forma- tion game. In cooperative games, the MMLs which are self- interested and focus on maximizing their own utilities, exhibit preferences regarding the clusters they wish to join based on their statistical similarity to the head, the incentives they can"}, {"title": "A. Framework", "content": "Our framework introduces a novel integration of federated meta-learning within the metaverse, leveraging blockchain technology for decentralized management of interactions among metaverse Meta-Learners (MMLs). At its core, the framework is designed to ensure reliable and real-time person- alized experiences through a dual game managing metaverse users and their contributions to the FML process. Specifically, the process unfolds in seven sequential steps, beginning with MMLs requesting meta-models from a metaverse Service Provider (MSP) and concluding with the MSP updating the requested models and reputations of MMLs post each FML round. Central to this process is the cooperative coalition for- mation game clustering MMLs based on utility maximization,"}, {"title": "B. System model", "content": "We consider a wireless multi-user system, where a set of $N_a$ MML devices collaborate in coalitions to carry out federated meta-learning aided by the wireless network, as illustrated in Fig. 2. Each global round consists of two phases:\nthe computation phase and the communication phase. In the computation phase, each MML device $i \\in C_j$ downloads the meta-model embeddings of heads to calculate its utility and choose its coalition, as will be detailed in the subsequent section. Once the coalitions are formed, the MML receives the current global model from the head and computes its local model using its own dataset. During the communication phase, the MML devices send their local models to the respective head via wireless nodes. After that, each head aggregates the received models and starts the following round. For the sake of simplicity, we omit the consideration of downlink communication due to the asymmetric uplink-downlink nature of wireless networks. This implies that the transmission power and downlink communication bandwidth, typically stronger at the server (e.g., a base station), make the downlink time negligible compared to uplink data transmission time [11].\nConsidering the learning process within a coalition con- sumes computational energy, the computing cost of each MML $i$ can be depicted as follows2:\n$\\mathcal{C}_{j,i}^{comp} = p \\tau \\mathcal{C}_{j,i} \\left|\\mathcal{D}_{j,i}\\right| \\zeta(\\delta_{j,i})^2$,   (6)\nwhere $p$ is the unit computation cost and $\\tau$ denotes the number of iterations during one round $k$. We denote $\\mathcal{C}_{j,i}$ as the CPU cycles to update the model with one sample, and $\\mathcal{D}_{j,i}$ as the batch size used in local update. Therefore, $\\mathcal{C}_{j,i} \\left|\\mathcal{D}_{j,i}\\right|$ is the number of CPU cycles required to run one iteration. $\\zeta$ rep- resents the effective capacitance parameter of the computing chipset of MML $i$. Finally, $\\delta_{j,i}$ is the computation capability of the device $i$, which is determined by the clock frequency of the CPU. Furthermore, we can express the time cost of the computing phase for a device $i$ in the iteration $k$, as follows:\n$T_{j,i}^{comp} = \\frac{\\tau \\mathcal{C}_{j,i} \\left|\\mathcal{D}_{j,i}\\right|}{\\delta_{j,i}}$. (7)\nMoreover, the energy consumption to transmit the updated model is expressed as follows [13]:\n$C_{j,i}^{comm} = a \\frac{(\\delta_{j,i})^2}{1-\\epsilon} + b \\frac{(\\delta_{j,i})^{-2}}{1-\\epsilon} + z,$(8)\nwhere $a$, $b$, and $z$ are the coefficients of communication costs, $\\epsilon$ indicates the loss rate during transmission, and $\\psi()$ presents the energy consumed accounting for transmission losses. The energy consumed for the communication between the MML and the coalition head is negligible compared to the energy consumed for computational tasks. Hence, for simplicity, we assume that $\\mathcal{C}_{j,i}^{comm}<<\\mathcal{C}_{j,i}^{comp}$. The transmission time is presented by:\n$T_{j,i}^{comm} = \\frac{W}{B_{j,i}}$, (9)\nwhere $W$ is the size of the local model pramaters, and $B_{j,i}$ is the mean transmission rate from user $i$ to the wireless node."}, {"title": "IV. RELIABLE HEADS SELECTION AND COALITION FORMATION", "content": "In order to incentivize users to join the meta-learning coalitions actively, the metaverse service provider attributes rewards to workers that contribute to metaverse services in exchange for their consumed resources."}, {"title": "A. Profit function of metaverse meta-learners", "content": "Rewards can be categorized into basic or reputation incen- tives $I_{rep}$ and competition incentives $I_{comp}$. The MMLs that"}, {"title": "B. Reputation model based on contribution", "content": "In metaverse environment, each MML requests to acquire multiple models and participate in various meta-learning tasks. Hence, it is necessary for the MSP to comprehensively con- sider the long-term contributions of current users and their contributions in historical similar meta-learning tasks, espe- cially as their data undergo continual changes. Additionally, it is impractical to assume that workers will always remain honest; some may maliciously attempt to manipulate their contributions to gain some advantages, such as joining specific coalitions by falsifying the reported similarity to the head's data, misreporting their computational efforts to reduce energy consumption while still claiming high incentives, or disturbing the training to deteriorate the system performance."}, {"title": "1) Contribution quantification of metaverse meta-learners:", "content": "The contribution of a given MML $i$ during the global round $k$ is determined by two factors: its contribution to model training and its task completion time. Accordingly, this contribution is quantified as:\n$v_{j,i} = (u_{j,i} + 1) \\times \\log\\left(1 + \\frac{T_{i}^{max} - T_{j,i}^{comm}}{T_{j,i}^{comp}}\\right)$,  (14)\nwhere $u_{j,i}$ is the contribution of the user $i$ to the reduction of the round global loss in the coalition $C_i$ using its local dataset $\\mathcal{D}_{j,i}$ and gradient norm. We define the contribution $u_{j,i} \\in [-1,1]$ as [11]:\n$\\begin{aligned} u_{j,i} = & \\sum_{t=0}^{\\tau-1} \\left|\\left|\\nabla \\mathcal{F}_{j,i}\\left(\\theta_{j,i}^{t}\\right)\\right|\\right|^{2} \\\\ & - \\frac{2\\left(1 + \\frac{1}{\\left|\\mathcal{D}_{j,i}\\right|}\\right) \\left|\\left|\\nabla \\mathcal{F}_{j,i}\\left(\\theta_{j,i}^{0}\\right)\\right|\\right|}{\\sqrt{\\left|\\mathcal{D}_{j,i}\\right|}}\\end{aligned}$,  (15)\nWe note that the contribution $u_{j,i}^k$ is equal to $0$ when MML $i$ has the lowest contribution to the training, as indicated by $u_{j,i} = -1$, and when it has the longest task completion time. Using this quantified contribution, we present a reputation mechanism to assess long-term user behavior. This reputation system takes into account both the user's global and task- specific reputation scores."}, {"title": "2) Global reputation score:", "content": "The global reputation captures the historical performance of active MMLs within the meta- verse system, reflecting their cumulative contributions across various training rounds and coalitions. To give prominence to recent contributions, we introduce contribution freshness metric. This is essential as a user's data and integrity can change over time. Furthermore, an honest user may be hijacked maliciously or may falsify its contribution (e.g., quality of data and computation resources). Thus, the global reputation is expressed as follows:\n$R_{j,i}^{global} = \\sum_{k=1}^{K} \\lambda^{k} v_{j,i}^{k}$.  (16)\nwhere $\\lambda \\in [0, 1]$ is a constant. The term $\\lambda^k$ represents a time declining factor, ensuring that more recent contributions are given greater weight."}, {"title": "3) Task-specific reputation score:", "content": "The task-specific reputa- tion value refers to the performance of a user when partici- pating in tasks related to the head $h_j$, which is formulated as follows:\n$R_{j,i}^{task} = \\sum_{k=1}^{K} \\chi^k \\left(\\delta^{k}_{j=i} + (1-\\delta^{k}_{j=i}) S_{j,r}^{k} \\left|\\mathcal{D}_{i}\\right|\\right)$ (17)\nThis reputation score comprises two parts:"}, {"title": "C. Cooperative coalition game formulation", "content": "The proposed federated meta-learning for metaverse in- volves creating disjoint coalitions, imposing the introduction of a cooperative coalition formation game. The two key re- quirements for classifying a coalitional game as a cooperative, also named hedonic game, are as follows [12]:\nCondition 1 (hedonic conditions). A coalition formation game is classified as cooperative when it meets the following two conditions:\n1) The utility of any player depends solely on the members of the coalition to which the player belongs.\n2) The coalitions form as a result of the preferences of the players over their possible coalitions' set.\nProposition 1. Our formulated problem matches the cooper- ative coalition formation game since it satisfies the conditions above.\nProof. First, based on eq. (10), the utility function $\\mathcal{U}_{j,i}^{MML}$ depends solely on the MMLs in the coalition $C_j, \\forall i \\in C_j, \\forall j \\in M$. Second, it is clear that a coalition is subject to modification if and only if an MML $i, \\forall i\\in C_j$, would like to join a new coalition $C_{j'}, \\forall j' \\neq j$, in order to gain higher incentives based on its data similarity to the head $h_{j'}$, and its contribution in terms of data, computation, and reputation within the new coalition. Before examining how the cooperative game is applied to our proposed model, we introduce several definitions [12]."}, {"title": "D. Cooperative coalition formation algorithm", "content": "To reach the game's Nash-stability, we introduce the co- operative game formation algorithm, allowing the MMLs to select coalitions that maximize their utilities in the final partition. The process for cooperative coalition formation in the metaverse for meta-learners is outlined in Algorithm 1.\nFor all $k$, The partition $\\Pi^k$ is first initialized to the previous partition $\\Pi^{k-1}$ (line 7). Then, for each coalition $C_j$, a new head is selected based on two criteria: the highest reputation and the lowest requirement in terms of task completion time (line 8 - line 14). Specifically, it is imperative that the heads are trusted to prevent any potential misleading of the training process. This concern arises if a head misbehaves and modifies its embedding, consequently misguiding data similarity to other players. Such behavior could ultimately affect the formation of coalitions. Furthermore, each head should be one of the players presenting a strict constraint in task completion time, so that the algorithm can guarantee to deliver the trained models within the time requirements of most metaverse users. Note that our algorithm will not ensure that all MMLs receive their models within their time requirements; instead, it ensures a trade-off between reputation and completion time (line 12). The rest of the algorithm follows the switch rule outlined in Definition 5. Any MML $i \\in C_j$ can perform a switch operation if and only if it gets higher utility by joining another coalition $C_{i'}$, where $j \\neq j'$. More specifically, based on the updated reputations, the current contribution in terms of data and computation, and the embedding presented by the new head, each MML $i$ computes its utility from its current coalition using eq. (10) (line 19). Moreover, the MML $i$ evaluates its incentives from other coalitions that it can possibly join and rank them according to Definition 3 in order to determine its preference profile (line 21-line 23). If the MML achieves higher gains in another coalition, it leaves its current group and switches to the new one (line 24-line 28). Given any change in the partition, the coalitions are updated, and the Nash-stability is not yet reached (line 29-line 31). This process repeats until no MML has an incentive to leave its current coalition and join another one. At the end, the Nash-stable partition $\\Pi^k$ that maximizes the utilities of all MMLs is returned (line 36)."}, {"title": "V. STACKELBERG GAME-BASED INCENTIVE MECHANISM FOR METAVERSE", "content": "The interaction between the MSP and the MMLs is for- mulated as a single-leader multi-followers Stackelberg game. Within this framework, the MSP assumes the role of the leader, strategically determining the optimal competition incentives to encourage MMLs to execute meta-learning tasks. On the other hand, the MMLs, as followers, adapt their computation frequencies to increase their individual profits. The strategies of both the MSP and the MMLs are formulated as follows:\n$\\text{\\textbullet}$ The MML's computing capacities in Stage II: Based on the reward strategy, MML $i \\in C_j$ determines its computing resources that maximize its profit which is given as:\n$\\begin{aligned} \\mathcal{U}_{j,i}^{MML} \\left(\\delta_{j,i}, I^{comp}\\right) = & \\left(S_{j,i} +\\left(-1\\right)^{l} \\zeta\\frac{\\delta_{i} - \\delta_{j}}{\\delta_{j} - \\delta_{i}} \\zeta\\frac{\\left|\\mathcal{D}_{j,i}\\right|}{\\sum_{k \\in \\mathcal{C}_{j}}\\left|\\mathcal{D}_{j,k}\\right|}\\right) \\times \\left(\\frac{\\frac{I^{rep}}{\\left|\\mathcal{C}_{j}\\right|}}{\\sum_{\\mathcal{H}\\left(R_{j,k}\\right)}}\\right)  \\\\ & + \\frac{\\delta_{i} - \\delta_{j}}{\\delta_{j} - \\delta_{i}} \\frac{\\left|\\mathcal{D}_{j,i}\\right|}{\\sum_{k \\in \\mathcal{C}_{j}}\\left|\\mathcal{D}_{j,k}\\right|} \\times I^{comp} - \\mathcal{C}_{j,i}^{comp} - \\mathcal{C}_{j,i}^{comm}\\end{aligned}$.(20)\nFor each coalition $C_i$, the set of MMLs computing frequencies is $\\delta_j = \\{\\delta_{j,1}, \\delta_{j,2}, ..., \\delta_{j,|c_5|}\\}$, which serve to calculate the computation delays using eq. (7). Accord- ingly, the round $k$ latency of the coalition $C_j$ is:\n$\\mathcal{T}^{\\text{round}} = \\max\\left(\\mathcal{T}_{j,i}^{comp} + \\mathcal{T}_{j,i}^{comm}, \\forall i \\in \\mathcal{C}_{j}\\right)$.(21)\nEach MML subgame problem is expressed as follows:\nProblem 1 (MML $i \\in C_j$ subgame):\n$\\max_{\\delta_{j,i}}\\mathcal{U}_{j,i}^{MML} \\left(\\delta_{j,i}, I^{comp}\\right)$\\ subject to $\\begin{aligned} & \\underline{\\delta} \\le \\delta_{j,i} \\le \\overline{\\delta}^{i} \\\\ & \\frac{T_{i}^{max}}{\\zeta} > \\mathcal{T}_{j,i}^{comp} + \\mathcal{T}_{j,i}^{comm} \\\\ & \\mathcal{C}_{j,i}^{comp} - \\mathcal{C}_{j,i}^{comm} < \\mathcal{C}_{j,i} \\\\ & \\mathcal{U}_{j,i}^{MML} \\left(\\delta_{j,i}, I^{comp}\\right) > 0, \\end{aligned}$(22)\nwhere $\\underline{\\delta}$ and $\\overline{\\delta}$ are the minimum and maximum compu- tation capacities that can be offered by each MML."}, {"title": "1) MMLs' optimal strategies as equilibrium in Stage II:", "content": "Utilizing the incentive strategy $\\overline{I^{comp"}], "follows": "n$\\begin{aligned} \\mathcal{L}\\left(\\delta_{i}, \\lambda_{1}, \\lambda_{2}, \\lambda_{3}\\right) = & \\left(S_{j,i} +\\left(-1\\right)^{l} \\zeta\\frac{\\delta_{i} - \\underline{\\delta}}{\\overline{\\delta} - \\underline{\\delta}} \\zeta\\frac{\\left|\\mathcal{D}_{j,i}\\right|}{\\sum_{\\mathcal{K}}\\left|\\mathcal{D}_{j,k}\\right|}\\right) \\times \\frac{\\frac{I^{rep}}{\\left|\\mathcal{C}_{j}\\right|"}, {}]