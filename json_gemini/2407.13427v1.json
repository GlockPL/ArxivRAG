{"title": "DeepClar: Utilizing Market Forecasts for Effective Portfolio Selection", "authors": ["Donghee Choi", "Jinkyu Kim", "Mogan Gim", "Jaewoo Kang"], "abstract": "Utilizing market forecasts is pivotal in optimizing portfolio selection strategies. We introduce DeepClair, a novel framework for portfolio selection. DeepClair leverages a transformer-based timeseries forecasting model to predict market trends, facilitating more informed and adaptable portfolio decisions. To integrate the forecasting model into a deep reinforcement learning-driven portfolio selection framework, we introduced a two-step strategy: first, pre-training the time-series model on market data, followed by fine-tuning the portfolio selection architecture using this model. Additionally, we investigated the optimization technique, Low-Rank Adaptation (LoRA), to enhance the pre-trained forecasting model for fine-tuning in investment scenarios. This work bridges market forecasting and portfolio selection, facilitating the advancement of investment strategies.", "sections": [{"title": "1 INTRODUCTION", "content": "Market outlooks are beneficial for achieving successful investment returns in portfolio selection. Classic portfolio selection strategies involve not only analyzing current market situations but also utilizing future market states. The role of market forecasts in portfolio selection is renowned for its reliability in various sources from both academic communities and business industries. Specifically, market forecasts can contribute to help investors understand macroeconomic trends, diversify their assets, mitigate risks, and ultimately achieve better returns. Previous research works have proposed portfolio selection frameworks that employ deep reinforcement learning (RL) approaches. One of the most recent models, DeepTrader, introduced an RL-based framework that consists of an asset scoring unit, market scoring unit, and portfolio generator. Particularly, the purpose of the market scoring unit was to help the framework exploit current market conditions in adjusting its investment decisions. However, in real-world situations, unanticipated market dynamics may inflict severe losses in investment profits. This necessitates the incorporation of market forecasts for minimizing expected risks in making asset-wise investment decisions (i.e., long and short), which naturally leads to the maximization of investment returns. Therefore, our work establishes cross-talk between two intertwined tasks which are market forecasting and optimal portfolio selection, posing another question of how to devise an integration of each of its approaches where the former employs reinforcement learning. Time-series forecasting models, mostly optimized by supervised learning, have undergone a series of model advancements. Their core design approach revolves using Transformers, which motivated many researchers to utilize them in stock price prediction tasks. Meanwhile, other Transformer variants such as FEDformer demonstrated their success in long-term time series data prediction which are attributed to their exploitation of external augmentations such as time series decomposition in Fourier domain. Our work's central motivation lies in the integration of two related tasks associated with distinct learning strategies which are market forecasting with supervised learning and portfolio selection with RL. Furthermore, we present two critical research questions regarding the under-explored compatibility of two learning methods and well-known difficulty of optimizing large-scale Transformers. To solve the former, we propose a transfer learning approach, by incorporating a pre-trained forecasting Transformer into a RL-based framework specializing in portfolio selection. This approach can be facilitated by RL, characterized by formulating a reward function optimized through investment trials under realistic and different market conditions. However, the latter remains a challenge as most state-of-the-art forecasting Transformers have massively large amount of trainable parameters especially the FEDformer (approximately 60 million in our case). While fine-tuning is deemed the primary choice in optimizing models for specific downstream tasks, adjusting a large number of parameters incurs additional computational burden. To cope with this, Low-Rank Adaptation (LoRA) were proposed to efficiently apply transfer learning from the pre-trained weights to downstream tasks. Moreover, LoRA exhibited performance enhancements comparable to full fine-tuning methods, showing success in vision-to-text and text-to-text transfer learning works. Perhaps the most motivational relevant work in our study design's approach to adopt RL in training large language models, mainly Transformer-based, on downstream tasks related to natural language processing. In fact, this work highlights LoRA's transferibility of textual knowledge trained with supervised learning method to task adaptation based on RL. Therefore, we hypothesize that utilizing this approach in integration of two methodologies used in market forecasting and optimal portfolio selection task can lead to improved investment outcomes, which aligns with the common notion of market outlooks being useful in devising optimal portfolio selection strategies. In this work, we introduce DeepClair, a deep clairvoyant portfolio selection model that leverages not only its current understanding of the market situation but also its forecasting of future market states. DeepClair leverages the advanced deep RL framework capabilities and incorporates a recently developed Transformer-based model that views time-series market data in the frequency domain. To the best of our knowledge, our novelty lies in the attempt to incorporate current transformer-based market forecasting into RL-based portfolio selection. This work represents a cornerstone empirical trial demonstrating that supervised pre-training tasks can aid RL scenarios, which are challenging to optimize in real-world environments. The contributions in this work are the following: To the best of our knowledge, this is the first attempt to incorporate the current transformer-based market forecasting methodology into an automatic portfolio selection framework. We pre-trained recently proposed transformer-based models on various time-series datasets and empirically chose FEDformer with LoRA adaptation as our market price forecasting module. Experiments on portfolio selection demonstrate DeepClair's ability to capitalize on its market forecasting ability to achieve the best investment returns compared to its baselines. Moreover, qualitative analysis shows how DeepClair can adaptively shift its positioning strategy during two phenomenal bullish and bearish periods."}, {"title": "2 RELATED WORKS", "content": "2.1 Time-series Forecasting Transformers The evolution of time-series forecasting models witnessed a significant transition from earlier approaches to the advent of transformers. Informer represents a notable model in this shift, followed by more recent advancements like Autoformer and FEDformer. These newer models capitalize on advanced capabilities for composing seasonal trends. Traditional portfolio strategies often lack adaptability to dynamic market conditions. In response, the introduction of RL-based portfolio selection models, as discussed in earlier works like DeepTrader and HADAPS, has aimed to address this limitation. Transformer-based time-series forecasting systems demonstrated success in various domains. However, within our current understanding, attempts to integrate forecasting into portfolio selection approaches have primarily utilized deterministic models, as seen in the use of genetic algorithms. 2.2 Reinforcement Learning adopting to Downstream Tasks Adapting to downstream tasks utilizing the RL method was originally discussed in the context of traditional RL problems such as robotics. It has since demonstrated its utility in the textual domain by adapting pre-trained language models to downstream tasks such as text summarization. Furthermore, research by has shown that language model training can adapt effectively to smaller human relevance corpora. Notably, the success of models like LLaMA2 has further validated the efficacy of this mechanism. 2.3 Parameter Efficient Fine-Tuning Method After the Adapter method came out to transfer the knowledge of the pre-trained textual language model to downstream text classification tasks, several methods have been introduced, including soft prompts, IA3, and OFT. Among these, LoRA has emerged as a prominent approach. The LoRA method has shown its possibility not only in textual adaptation tasks such as chatbot and recommendation systems with textual cues but also in vision-related domains. These include Vision Question Answering (VQA), 2D to 3D image generation and text to 3D generation. Additionally, LoRA has been explored for textual alignment using RLHF, showing potential for adapting models trained with supervised learning to RL context."}, {"title": "3 PROBLEM STATEMENT", "content": "The following details are the preliminaries for our tasks. Problem 1 (Optimal Portfolio Selection). Given a set of $n$ assets $\\mathcal{A}=\\left\\{a_{1}, a_{2}, \\ldots, a_{n}\right\\}$, we denote each $i$ th asset $a_{i}$ having historical stock prices as $\\mathbf{P}_{i, t}=\\left[\\mathbf{p}_{i, t-w}, \\cdots, \\mathbf{p}_{i, t-1}\right]$ where $\\mathbf{p}_{i, j}$ is the closing market price of asset $a_{i}$ at historical time step $j$. At current time step $t$ prior to market closing and given a window size of historical prices $w(w \\geq 1)$, the objective of DeepClair is to dynamically adjust the portfolio composition $C=\\left[\\mathbf{c}_{1, t}, \\mathbf{c}_{2, t}, \\cdots, \\mathbf{c}_{n, t}\right]$ where $\\mathbf{c}_{i, t}$ is the portfolio ratio of asset $a_{i}$ at time $t$. The goal is to maximize the return $\\delta_{t}=\\sum_{i=1}^{n} \\delta_{i, t} c_{i, t}$, where $\\delta_{i, t}=\\left(\\mathbf{p}_{i, t}-\\mathbf{p}_{i, t-1}\right) / \\mathbf{p}_{i, t-1}$. In sum, the goal of a system is to make adaptive investment decisions given dynamic market circumstances at time $t$. As illustrated above, market forecasts can contribute to refining portfolio strategies for better investment returns. To solve 1, we formulate two tasks which are Learning to Forecast Market and Learning Optimal Portfolio Selection using the Transferred Market Forecasting Module. Task 1 (Learning to Forecast Market). For each $i$ th asset $a_{i} \\in \\mathcal{A}$ and discrete time step $t$, the agent's task is to predict its future market state $\\hat{\\mathbf{P}}_{i, t}=\\left[\\hat{\\mathbf{p}}_{i, t}, \\cdots, \\hat{\\mathbf{p}}_{i, t+h-1}\right]$ of forecast horizon $h(h \\geq 1)$ given its historical prices $\\mathbf{P}_{i, t}=\\left[\\mathbf{p}_{i, t-w}, \\cdots, \\mathbf{p}_{i, t-1}\right]$ of window size $w$. The learning objective in this task is to minimize forecast error between $\\hat{\\mathbf{P}}_{i, t}$ and $\\hat{\\mathbf{P}}_{i, t}$ where $\\hat{\\mathbf{P}}_{i, t}=\\left[\\hat{\\mathbf{p}}_{i, t}, \\cdots, \\hat{\\mathbf{p}}_{i, t+h-1}\right]$ is the actual sequence of $h$ closing market prices for asset $a_{i}$. Task 1 serves as an auxiliary task, aiding the system in understanding and adapting to market trends, thereby improving its ability to make informed investment decisions. Task 2 (Learning Optimal Portfolio Selection Using the Transferred Market Forecasting Model). The agent's task is to formulate an optimal portfolio strategy $\\mathcal{C} \\in \\mathcal{U}$ for all assets $a_{i} \\in \\mathcal{A}$ at discrete time step $t$. This involves considering both the actual market data $\\mathbf{P}_{i, t}$ and the predicted market data $\\hat{\\mathbf{P}}_{i, t}$ to maximize the total return $\\delta_{t} . C_{t}$ represents the vector of allocation weights $c_{i, t}$ for each asset $a_{i}$, indicating the proportion of the total portfolio value invested in each asset at time $t$. Task 2 and Task 1 are DeepClatr's primary and auxiliary tasks respectively. Task 1 contributes to improving DeepClatr's understanding in market trends and ability to exploit them in investment decisions involved in Task 2."}, {"title": "4 DEEPCLAIR", "content": "DeepClatr is an advanced portfolio selection system that combines two components described in Fig 1: 1) a transformer-based timeseries forecasting model $M_{1}$ for portfolio evaluation to solve Task 1 and 2) a RL-based portfolio optimization framework $M_{2}$ to solve Task 2. 4.1 Market Price Forecasting Model The primary objective of this framework is to predict future asset prices $\\hat{\\mathbf{P}}_{., t}$ based on a given market signal $\\mathbf{P}_{., t}$. $\\hat{\\mathbf{P}}_{., t}=M_{1}\\left(\\mathbf{P}_{., t}\right)$ where $\\hat{\\mathbf{P}}_{., t} \\in \\mathcal{R}^{n}$ and $\\mathbf{P}_{., t} \\in \\mathcal{R}^{n, w}, w$ is a window size of historical prices and $n$ represents the number of assets. In this study, we adopted FEDformer as our forecasting model $M_{1}$, employing 2 encoder blocks and 1 decoder block. FEDformer is renowned for its ability to capture the global view of time-series data, including overall trends, through a seasonal-trend decomposition method. This aligns with our model's objective of predicting preceding prices by capturing broader market trends, aiding in determining the proportion of long and short positions. 4.1.1 Training Procedures by Time Series Forecasting. We optimize $M_{1}$ as regression problem for solving Task 1 by minimizing the prediction of the Forecasting model $\\hat{\\mathbf{P}}$ and the real price data $\\hat{\\mathbf{P}}$. 4.2 Portfolio Optimization Framework The objective of this framework is to optimize a portfolio optimization framework $M_{2}$ by a RL method. $M_{2}$ consists of Asset Scoring Module, Portfolio Selection Module, and Market Scoring Module. 4.2.1 Asset Scoring Module. The asset scoring module produces a confidence vector $\\mathbf{v}_{-t}=\\left\\{v_{1, t}, \\cdots, v_{a, t}, \\cdots, v_{n, t}\right\\}$, where $v_{a, t}$ is a confidence score of asset $a$ at time $t$ and $n$ represents the number of assets. $\\mathbf{v}_{-t}=A S M\\left(\\mathbf{P}_{-t}\right)$ The notation of ASM denotes the Asset Scoring Module, with a window size of historical input prices $w$ set to 5 . The asset scoring unit integrates temporal and graph convolution layers, along with a spatial attention mechanism, enabling the capture of temporal correlations among asset prices. 4.2.2 Portfolio Selection Module. The portfolio selection module's (PSM) role is selection of long and short position vectors, $\\mathbf{w}_{t}^{\text {long }}$ and $\\mathbf{w}_{t}^{\text {short }}$, respectively. Here, $\\mathbf{w}_{t}=\\left\\{w_{1, t}, w_{2, t}, \\cdots, w_{n, t}\right\\}$, where $w_{a, t}$ is a weight for long or short position for asset $a$. The PSM selects top $n_{\text {long }}$ and a list of its indexes as $\\mathbf{v}_{t}^{\text {long }}$ and for bottom $n_{\text {short }}$ assets, $\\mathbf{v}_{t}^{\text {short }}$ for each portfolio selection by using the asset score vector $\\mathbf{v}_{t}$. Then PSM decides the proportions of each top and bottom assets with the proportion vector $\\mathbf{w}_{t}^{\text {long }}$ and $\\mathbf{w}_{t}^{\text {short }}$. $w_{i, t}^{\text {long }} = \begin{cases}\\frac{\\exp \\left(v_{i, t}\right)}{\\sum_{j \\in v_{t}^{\text {long }}} \\exp \\left(v_{j, t}\right)} & \text { if } i \\in \\mathbf{v}_{t}^{\text {long }} \\ 0 & \text { if } i \notin \\mathbf{v}_{t}^{\text {long }}\\end{cases} w_{i, t}^{\text {short }} = \begin{cases}\\frac{-\\exp \\left(1-v_{i, t}\right)}{\\sum_{j \\in v_{t}^{\text {short }}} \\exp \\left(1-v_{j, t}\right)} & \text { if } i \\in \\mathbf{v}_{t}^{\text {short }} \\ 0 & \text { if } i \notin \\mathbf{v}_{t}^{\text {short }}\\end{cases}$ each elements in long $\\mathbf{w}_{t}^{\text {long }}$ and short $\\mathbf{w}_{t}^{\text {short }}$ vectors are normalized with the equations 3 and 4 . We apply the softmax function for selecting portfolio actions because using the softmax function to optimize discrete action spaces in RL is a well-established approach. This method is particularly relevant in the context of portfolio selection with RL. A value of 0 is assigned to the assets for which no position is selected. 4.2.3 Market Scoring Module. Since market conditions are inherently unpredictable and uncertain, it is impossible to accurately predict stock movements solely based on historical data. However, previous approaches attempted to utilize the current market conditions to select actions aimed at achieving future optimal positions, under the naive assumption that the current market status will persist. We advance this approach by incorporating outputs from the forecasting module to better inform decisionmaking. The Market Scoring Module (MSM) is responsible for determining $\rho_{t}$, which represents the Long and Short proposition of DeepCLatr. $\\dot{\\mathbf{P}}_{-t} =M_{1}\\left(\\mathbf{P}_{-t}\right) M S M\\left(\\mathbf{P}_{-t}\right) =\\operatorname{Linear}\\left(M_{1}\\left(\\mathbf{P}_{-t}\right)\right) \\mu_{t}, \\sigma_{t} =M S M\\left(\\mathbf{P}_{-t}\right)$ During the training phase, we sample $\rho_{t}$ from the distribution $N\\left(\\mu_{t}, \\sigma_{t}\right)$. In testing, we use $\\mu_{t}$ as the value of $\rho_{t}$. This technique is for stable exploring the agent's action space, widely used in RL domains after Soft Actor-Critic technique, recently in the portfolio selection domain. Adaptation of Forecasting Module using LoRA. We use LoRA to adapt the forecasting module $M_{1}$, which was trained in the pretraining task (Task 1), to the fine-tuning task (Task 2). The primary objectives of integrating the LoRA module are twofold: 1) to retain the forecasting ability established during the initial pre-training phase; and 2) to adapt the module's behavior for portfolio selection during the fine-tuning stage. We apply LoRA adapters to every transformer block in the encoders of forecasting model $M_{1}$. 4.2.4 Formulating Portfolio Selection Vectors. Final portfolio selection is done by using the proportion $\rho_{t}$ between the long position vector $\\mathbf{w}_{i, t}^{\text {long }}$ and we note that the short position vector $\\mathbf{w}_{i, t}^{\text {short }}$. $\text { Portfolio }_{t}^{l o n g}=\rho_{t} \times\\left\\{w_{0, t}^{\text {long }}, w_{1, t}^{\text {long }} \\cdots w_{n, t}^{\text {long }}\right\\} \text { Portfolio }_{t}^{\text {short }}=\\left(1-\rho_{t}\right) \times\\left\\{w_{0, t}^{\text {short }}, w_{1, t}^{\text {short }} \\cdots w_{n, t}^{\text {short }}\right\\}$ 4.3 Training Procedures by Portfolio Selection The primary objective of DeepClatr is to maximize reward $r_{1}$ by exploring the action spaces defined in investment outcome Portfolio ${ }^{\text {long }}$ and Portfolio ${ }^{\text {short }}$. This $r_{1}$ is defined as $r_{1, t}=\\sum\\left(\\delta_{t} \\circ \text { Portfolio }_{t}^{l o n g}+\\delta_{t} \\circ \text { Portfolio }_{t}^{\text {short }}\right)$ where $\\delta_{t}$ is a rate of return that is calculated by price change within the target day and $\\circ$ stands for element-wise multiplication. If the directions of the price change and the position are the same, $r_{1, t}$ has a positive value that strengthens the behavior by the value of amplifications, and if not, $r_{1, t}$ acts like a negative reward because it has a negative value. The output is connected to the decision of the Asset Scoring Module and the Forecasting Module, so $r_{1, t}$ is a signal to update all the parameters in Asset Scoring Module and the LoRA parameters in the Forecasting Module. Also, we add an auxiliary reward $r_{2, t}$ to maximize the prediction capability of the Asset Scoring Module by using all of the confidence prediction parameterized as $\\mathbf{v}_{t}$. $r_{2, t}=\\sum \\delta_{t} \\circ \\mathbf{v}_{-t}$ $r_{1}$ uses the final output of DeepClatr, which is straightforward, but this neglects the other confidence scores in $\\mathbf{v}$, which could be helpful signals while training. $r_{2}$ is defined to overcome the shortage of formulation about $r_{1}$. The final training objective of DeepClatr is defined as follows: $J(\\phi)=\\mathbb{E}_{\\mathbf{v}_{-t}}\\left[\\alpha \\log \\left(\rho_{t}\right) \times r_{1, t}+\beta r_{2, t}\right]$ $\beta$ are used to control the magnitude of the $r_{2, t}$. We set $\\alpha$ as $0.05, \beta$ as 1 ."}, {"title": "5 EXPERIMENTAL SETTINGS", "content": "5.1 Dataset and Evaluation We evaluated our model using Nasdaq and Dow Jones datasets, selecting the top 26 stocks by market capitalization as of 2023, with data from January 1992 to the present, sourced from Yahoo Finance. For Task 1, the development and test datasets were split over the same period. In Task 2, the test period was extended for a more robust evaluation. Additionally, we used two types of datasets to evaluate the performance of our forecasting model (Task 1). The first dataset, from existing literature, includes the ETTh1 (Electricity Transformer Temperature) dataset with 1-hour-level load and oil temperature data spanning 2 years, and an electricity dataset with hourly consumption data of 321 clients over 2 years. The second dataset category includes our Nasdaq and Dow Jones datasets, used to evaluate the model's pricing data predictions. All experiments were repeated ten times with different random seeds and their results are based on mean performance. The evaluation measures to evaluate investment performance that were used in the experiments are the following: Annualized Return (ARR), Annualized Sharpe Ratio (ASR), Maximum Drawdown (MDD), Calmar Ratio (CR), and Sortino Ratio (SoR). ARR measures the overall return of a method, ASR, SoR, and CR evaluate risk-adjusted returns, and MDD assesses risk. 5.2 Model Baselines The baseline models used in the experiments and categorized by their approaches are the following, (1) Benchmark Index: This indicates the market trends of each of its associated major index in the U.S. market. (2) Traditional Investment Strategies: Cross-Sectional Momentum strategy(CSM) and Buy Losers Sell Winners strategy(BLSW). (3) Deep Reinforcement Learning Approaches: EIIE (Ensemble of Identical Independent Evaluators) is a foundational open-source RL framework for portfolio selection. DeepTrader and HADAPS (Hierarchical Adaptive MultiAsset Portfolio Selection) are recent RL-based portfolio management systems."}, {"title": "6 EXPERIMENTAL RESULTS", "content": "DeepClair was designed as a RL-based portfolio selection AI system, harnessing the predictive capabilities of a current transformerbased time-series forecasting model. We conducted experiments to address the following research questions, validating the underlying design principles: RQ1. Does incorporation of market forecasting into portfolio selection framework contribute to better investment results? RQ2. For architectural design of DeepClair, what is the optimal market forecasting transformer-based model? RQ3. For incorporation of FEDformer into DeepClair, what is the best optimization strategy? RQ4. Can we find empirical evidence supporting DeepClair's adaptive capabilities in capturing market shifts? 6.1 RQ1. DEEPCLAIr shows superior investment performance and greatly benefits from market forecasts Table 2 shows the results of the main experiments conducted on two separate datasets. The purpose of these experiments was to comprehensively evaluate and compare DeepClair's portfolio selection with other baselines. Notably, DeepClair outperformed its baselines in most evaluation metrics including ARR, ASR, CR and SoR in both datasets Nasdaq (15.22, 0.659, 0.346, 10.593) and Dow Jones (10.30, 0.526, 0.220, 8.052). The performance gain in terms of investment return is significant based on a comparison with the other baseline methods on both datasets. According to the experimental results, traditional investment strategies such as CSM and BLSW underperformed across all evaluation metrics on both datasets. This indicates that during our testing period, traditional strategies that follow trends (CSM) or their reverse (BLSW) were less effective compared to more adaptive trading strategies. DeepClair preemptively capitalizes on its forecasting ability to make rational investment decisions and evade the severe drawbacks of swaying itself towards uncertain market trends. The experimental results featuring deep RL model baselines imply that adaptive investment strategies help mitigate risks. This is empirically shown by DeepClair unable to show the best performance in terms of risk measures AVol and MDD in both datasets. However, DeepClair which also employs deep RL to facilitate adaptive portfolio selection, still outperforms in other evaluation metrics related to risk-adjusted returns (CR and SoR). This suggests that integrating adaptive investment strategies with studying market trends amplifies portfolio selection's effectiveness. 6.2 RQ2. FEDformer is a suitable choice for the Market Scoring Module in DeepClair Prior to choosing which transformer-based model is suitable for our DeepClair framework, we conducted experiments on four different time series datasets which are ETTH1, Electricity, Nasdaq and Dow Jones in Table 3. We first selected previously introduced forecast models which are Transformer, Informer, Autoformer, and FEDformer. A clear distinction in terms of forecasting performance (MAE, RMSE, and MAPE) was found between Transformer, Informer and Autoformer, FEDformer. This difference is mostly attributed to the seasonal-trend decomposition approach exploited by both Autoformer and FEDformer which is an autoregressive property helpful in long time-series forecasting. As shown in Table 3, FEDformer has outperformed other baselines in all three evaluation metrics. Additionally, we conducted an ablation study on different transformer variants used as DeepClair's market price forecasting model which are Transformer, Informer, and Autoformer, as shown in Table 4. In both the Nasdaq and Dow Jones datasets, FEDformer outperformed other transformer variants in providing accurate market forecasts which led DeepClair to make effective long and short decisions in unseen market circumstances. This is attributed to its ability to extract meaningful seasonal patterns in the frequency domain during the pre-training phase and exploit them to foresee fourteen years of uncertain market situations in an adaptive manner. 6.3 RQ3. Low Rank Adaptation applied to FEDformer's Encoder benefits optimization of DeepClair As shown in Table 4, we explored various ways of incorporating the pre-trained FEDformer model into the adopted DeepTraderbased framework. The FEDformer was designed based on encoderdecoder architecture where two of the modules are interconnected via the Frequency Enhanced Attention block (FEA). Importing pre-trained transformer-based models and fine-tuning them on different downstream tasks has been a conventional practice in other domains, especially natural language processing. As this is our first attempt to utilize the FEDformer in DeepClair, we conducted additional experiments related to several optimization methods associated with large pre-trained models. The additional experiments related to FEDformer are the followings: FED-Removed/Frozen/Finetuning: Ablated versions of DeepClair with FEDformer removed, parameters frozen, or parameters trainable, respectively. FED-LoRA: LoRA applied to different components in the pretrained FEDformer: all decoder layers (FED-LoRA-Decoder), the Frequency-Enhanced-Attention block (FED-LoRA-FEA), or the Encoder, Decoder, and FEA (FED-LoRA-ALL). Transformer/Informer/Autoformer-LoRA-Encoder: LoRA applied to the Encoder in baseline models: Transformer, Informer, and Autoformer. As shown in Table 3, experimental results for ablations on optimization of the FEDformer used as DeepClair's market forecasting module implicate several findings. We concluded that unfreezing all FEDformer parameters is not a feasible choice in optimizing DeepClair on the portfolio selection task. In addition, experimental results for ablations on LoRA applied to FEDformer demonstrate that injecting the trainable matrices into the pre-trained FEDformer's encoder module yields the best investment performance in both datasets. Since conventional transformers apply LoRA to its encoder and/or decoder module, we explored different options that also consider the FEDformer's FEA block. Among different options regarding which sub-component of FEDformer to apply LoRA, FED-LoRA-FEA yielded the worst performance along with FED-LoRA-AII. We speculate that altering the pre-trained parameters of the FEA block rather disrupts DeepClair's learning trajectory which should be aimed towards optimizing its portfolio selection ability. Overall, applying LoRA to only the FEDformer's encoder module proved to be the optimal choice. 6.4 RQ4. DeepClair exhibits adaptive investment behavior in drastically changing situations. In Figure 2, we scrutinize DeepClair's portfolio selection behavior by monitoring the parameter $\rho$, determining the ratio between long and short positions, and compare it with other design choices such as Frozen and Fine-tuning. The Frozen scenario exposes the model's incapacity to adhere to a long-range investment strategy, potentially due to the forecasting model's output being treated as a noisy false signal. Conversely, in the Fine-tuning scenario, the model tends to invest overwhelmingly in a coherent manner, suggesting a potential loss of forecasting ability and convergence toward a generic RL approach. In our case, DeepClair demonstrates adaptive capabilities, effectively responding to both bullish and bearish market conditions. We posit that this adaptability is facilitated by LoRA, serving as a bridge to align the generalizability of the forecasting output with the RL structure. Overall, our experimental results demonstrate three findings: 1) the significance of exploiting market forecasting in portfolio selection tasks, 2) the rationale behind utilizing FEDformer as market forecast module in DeepClair, and 3) the benefits of applying LoRA to FEDformer's encoder module when training DeepClair on portfolio selection task."}, {"title": "7 CONCLUSION", "content": "In this work, we introduced DeepClair, a novel RL portfolio selection system that leverages a market-forecasting module based on a frequency-enhanced transformer architecture pre-trained with supervised time-series forecasting. Our approach involves two stages of training strategies: pre-training the forecasting module to establish forecasting abilities and fine-tuning the transferred module to determine DeepClair's long-short investment positions through a portfolio selection RL training procedure. The portfolio selection task itself aims at formulating practical investment practices, making our work focused on creating strategies that can be effectively applied in real-world scenarios. In our experiments, we showcased our method's adaptive investments while demonstrating better returns. Since DeepClair relies on deep learning architecture, capturing the causal relationship between inputs and investment decisionmaking can be challenging. However, we plan to conduct a thorough investigation into the interpretability of the backbone transformer attention architecture we use. Additionally, although our work follows the mainstream portfolio selection experiment settings, we aim to explore more realistic and robust experimental settings. This includes accounting for transaction fees, incorporating other investment sources such as gold, cash, and cryptocurrencies, and experimenting with different date splits (train, test, validation) for investments. This work was conducted in collaboration with investment experts at Shinhan Bank, aiming to develop practically usable advanced automated investment strategies using artificial intelligence."}]}