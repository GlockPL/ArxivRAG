{"title": "Detecting Underdiagnosed Medical Conditions with Deep Learning-Based Opportunistic CT Imaging", "authors": ["Asad Aali, MS", "Andrew Johnston, MD, MBA", "Louis Blankemeier, MS", "Dave Van Veen, PhD", "Laura T Derry, MD, MBA", "David Svec, MD, MBA", "Jason Hom, MD", "Robert D. Boutin, MD", "Akshay S. Chaudhari, PhD"], "abstract": "Abdominal computed tomography (CT) scans are frequently performed in clinical settings. Opportunistic CT involves repurposing routine CT images to extract diagnostic information and is an emerging tool for detecting underdiagnosed conditions such as sarcopenia, hepatic steatosis, and ascites. This study utilizes deep learning methods to promote accurate diagnosis and clinical documentation. We analyze 2,674 inpatient CT scans to identify discrepancies between imaging phenotypes\u2014characteristics derived from opportunistic CT scans\u2014and their corresponding documentation in radiology reports and ICD coding. Through our analysis, we find that only 0.5%, 3.2%, and 30.7% of scans diagnosed with sarcopenia, hepatic steatosis, and ascites (respectively) through either opportunistic imaging or radiology reports were ICD-coded. Our findings demonstrate opportunistic CT's potential to enhance diagnostic precision and accuracy of risk adjustment models, offering advancements in precision medicine.", "sections": [{"title": "Introduction", "content": "Body composition analysis is a crucial component of clinical assessments, helping identify health risks associated with obesity, malnutrition, and other conditions. Over 85 million computed tomography (CT) scans are performed each year, providing diagnostic insights into patient health [1]. The widespread use of abdominal CT scans in clinical settings indicates a vast repository of underutilized imaging data. Abdominal CT scans offer an opportunity to extract quantitative body composition metrics, serving as diagnostic and prognostic biomarkers. While manual extraction of these metrics is labor-intensive, opportunistic CT provides an automated alternative. Opportunistic CT involves leveraging existing CT scans to generate additional diagnostic insights beyond their original purpose, potentially identifying underdiagnosed conditions [2\u20134] including: 1) sarcopenia, which is characterized by the progressive loss of skeletal muscle mass and strength, and is associated with increased risks of falls, fractures, and mortality, 2) hepatic steatosis, which is marked by excessive fat accumulation in the liver, and is linked to metabolic disorders and cardiovascular risks, and 3) ascites, which is the pathological accumulation of fluid in the abdominal cavity, and is often indicative of a poor prognosis, particularly in patients with advanced liver disease.\nSuch conditions are clinically significant due to their contribution to increased mortality, particularly in aging populations [5]. Despite their clinical relevance, these conditions are often under-recognized in electronic health records (EHRs), leading to delays in diagnosis and treatment [6,7]. Deep learning offers promising advancements in body composition analysis. For example, Comp2Comp [8], a library for extracting clinical insights from CT scans has shown promise in quantifying critical body composition metrics. In parallel, vision-language foundational models like Merlin [9] have shown immense potential in accurate disease detection using CT scans. While manual assessment of muscle mass, liver morphology, and fluid accumulation can provide valuable insights, it is time-consuming and prone to interobserver variability. Deep learning algorithms can facilitate efficient and accurate detection of associations between imaging biomarkers and medical conditions, potentially at a much larger scale [10]. In this study, we evaluate 2,674 inpatient CT scans to explore discrepancies between imaging findings, radiology report findings, and International Classification of Diseases (ICD) coding for sarcopenia, hepatic steatosis, and ascites."}, {"title": "Methods", "content": "Body Composition Analysis: To detect sarcopenia and hepatic steatosis, we used an open-source Python package designed to automate body composition analysis [8]. Comp2Comp uses convolutional neural networks to segment CT images, enabling consistent and reproducible extraction of body composition metrics for large-scale analysis. In this study, three specific pipelines were utilized from Comp2Comp: 1) 2D Spine, Muscle, and Adipose Tissue Analysis in the third lumbar vertebra (L3), 2) 2D Contrast Phase Detection, and 3) 3D Analysis of Liver and Spleen."}, {"title": "Vision Language Foundation Model for CT", "content": "To detect ascites, we used Merlin [9], a 3D vision-language foundation model. Originally developed to leverage structured EHR data and unstructured radiology report supervision, Merlin can process 3D volumetric data, making it suitable for abdominal CT analysis. We fine-tuned the Merlin model for ascites detection using a dataset curated by musculoskeletal radiologists, consisting of 200 labeled CT scans. We applied a train-test split of 50/50 and fine-tuned the full model weights using the Adam optimizer. The learning rate ($\\lambda$) was set to 1e \u2013 5, and we fine-tuned the model for 100 epochs."}, {"title": "Data Acquisition", "content": "This IRB-approved study included a retrospective consecutive CT dataset from a single academic medical center from 2014 to 2018, comprising 23,540 unique patients linked to 33,548 CT scans (demographics in Table 5). For each scan, the highest slice resolution series was selected. We focused exclusively on inpatient CT scans to include more severe cases. We utilized various EHR sources, including demographics, admission/discharge/transfer (ADT) records, radiology reports, and labs (Figure 1) using an internal data linkage tool. For feature and label extraction, we utilized an open-source tool called STARR-Labeler [11], resulting in a cohort containing relevant EHR features, CT scans, ICD-9 and ICD-10 labels. For each disease, we searched for relevant ICD codes within a window of 7 days before and 30 days after the scan date. After removing erroneous entries (e.g., outliers, missing values), the final cohort comprised 2,674 CT scans. For sarcopenia, we utilized the entire 2,674 inpatient cohort. For hepatic steatosis, we selected 2,275 contrast-enhanced scans, recognizing that the presence of a contrast agent can affect liver density measurements. After running Comp2Comp's contrast detection algorithm, we found that our cohort comprised 2,275 (85%) contrast-enhanced scans in the venous phase. While non-contrast CT scans have previously been used to measure liver density to detect fat content, they were a small portion of our cohort and were therefore excluded from the study. For ascites, we excluded scans with erroneous model outputs (null values), leaving us with 2,320 scans."}, {"title": "Criteria for Clinical Diagnosis", "content": "Sarcopenia was assessed using skeletal muscle cross-sectional area (SMA) and skeletal muscle index (SMI) (incorporating both muscle mass and radiodensity) measurements at the L3 vertebral level. We chose two independent cutoffs to validate the outcomes. The first study [12] defined a T-Score approach based on the SMI value at the L3 vertebral level (L3SMI): $\\frac{L3SMI-47.5}{6.6}$ and $\\frac{L3SMI-60.9}{6.6}$ for female and male patients, respectively. The second study [13] used a BMI-adjusted Z-Score (BMI-Z-Score) approach for body size adjustment based on the SMA value at L3 (L3SMA). The BMI-Z-Score is calculated as $\\frac{L3SMA-I}{SD(I)}$ where $I = 50 + 6.6 * BMI + 13 * sex + 0.6 * BMI * sex$, and $SD(I) = 8.8 + 2.6 * sex$. In this study, scans with scores 2.5 standard deviations below the mean of the reference population were given a sarcopenia diagnosis. For hepatic steatosis, we did not find a single consensus criterion. Hence, we employed two independent Hounsfield Unit-based (HU) cutoffs: 1) liver attenuation \u2264 90 HU (achieved 75.9% and 95.7% sensitivity and specificity, respectively [14]), and 2) liver-spleen attenuation difference \u2264 -19 HU (achieved 69.2% and 95.8% sensitivity and specificity, respectively [15]). We used the fine-tuned Merlin model for ascites because the volumetric assessment of intraabdominal fluid was not incorporated into our pipeline. We also analyzed radiology reports to enhance confidence in diagnosing steatosis and ascites."}, {"title": "Results", "content": "Sarcopenia: Out of the 2,674 scans, only 7 scans were coded for sarcopenia. We further identified that 388 of remaining 2,667 scans (14.6%) had T-Scores \u2264 -2.5. Using BMI-Z-Scores, we identified 515 of 2,667 scans (19.3%) with scores \u2264 -2.5, clearly representing the scale of sarcopenia under-coding. Of the 7 scans that were coded for sarcopenia, only 1 (14.3%) and 3 (42.9%) scans had T-Scores and BMI-Z-Scores \u2264 -2.5 (possible over-coding). Even in cases where both T-Score and BMI-Z-Score approaches agreed (302 scans) and had scores \u2264 -2.5, only 1 (0.33%) case was ICD-coded. The overlap between T-Score and BMI-Z-Score approaches and ICD coding is shown in Table 1. In Figure 2, we show two examples (not sarcopenia coded) with qualitative comments from a radiologist in our team, where cases 1 and 2 show patients with/without sarcopenia. Figure 5 shows the distribution of T-Scores and BMI-Z-Scores, categorized by ICD diagnosis.\nascites. To detect hepatic steatosis using radiology reports, we searched for the following terms: steatosis, liver hypoattenuation, MASLD, non-alcoholic fatty liver, NAFLD, focal fatty sparing, and fatty liver. For ascites, we searched for the following terms: free fluid, free air, pelvic fluid, paracolic gutter, and loculated appearing fluid."}, {"title": "Hepatic Steatosis", "content": "Out of the 2,275 contrast-enhanced scans, only 28 scans were coded for hepatic steatosis. From the remaining 2,247 scans, we identified that 227 (10.1%) scans had a liver attenuation of \u2264 90 HU. Similarly, 370 of the 2,247 scans (16.5%) had a liver-spleen attenuation difference of \u2264 \u221219 HU, representing the scale of under-coding. Of the 28 scans that were coded for steatosis, only 7 (25%) and 14 (50%) scans got an opportunistic diagnosis based on the liver and liver-spleen approaches, respectively (possible over-coding). Even in cases where both cutoff methods agreed on steatosis diagnosis (132 scans), only 6 (4.5%) cases were ICD-coded. Furthermore, our analysis showed 63 scans where both quantitative approaches and radiology reports agreed on a steatosis diagnosis. From these 63 scans, only 5 (7.9%) were ICD-coded. The overlap between the two independent quantitative approaches, radiology report diagnoses, and ICD coding is detailed in Table 2. In Figure 3, we show two cases from our cohort with observations from our team radiologist. Case 1 shows a hepatic steatosis example that was correctly diagnosed through opportunistic imaging and in the radiology report but was not coded. While case 2 was diagnosed through opportunistic imaging, it was neither coded, nor mentioned in the radiology report, demonstrating the benefit of opportunistic CT beyond coding and radiology reports. Figure 6 shows the distribution of mean liver HU and liver-spleen difference HU, categorized by ICD diagnosis."}, {"title": "Ascites", "content": "Ascites detection was performed using sigmoid outputs from the fine-tuned Merlin model. For predicting ascites, we optimized the classification threshold given the test results in Table 4. We chose a threshold of 0.6, prioritizing higher precision and specificity while maintaining a minimum F1-Score of 70%. Our evaluation of the Merlin model relied on the fine-tuned model's validated performance, with no further manual verification. From the 2,320 scans, 644 scans were coded for ascites. Of the remaining 1,676 scans not coded, the fine-tuned Merlin model diagnosed 1,101 (65.7%) scans with ascites. Furthermore, from the 1,676 scans not coded for ascites, we found 696 (41.5%) scans diagnosed through opportunistic imaging and the radiology reports, representing the under-coding scale. Furthermore, we observed that from the 644 scans that were coded for ascites, only 372 (57.8%) scans got a diagnosis through opportunistic imaging and radiology reports, possibly suggesting over-coding. We also report that out of all cases where Merlin predicted ascites, the radiology report diagnosis agreed 66.3% of times. However, the radiology report diagnoses proportion dropped to 33.6% in cases where the model did not predict ascites, representing a positive correlation between the two approaches. The overlap between the Merlin model's predictions, radiology report diagnoses, and ICD coding is further detailed in Table 3. In Figure 4, we show two cases from our cohort (not ascites coded) with comments from our team radiologist. Case 1 shows an example of ascites that was correctly diagnosed through opportunistic imaging and radiology reports but was not coded. While case 2 was diagnosed through opportunistic imaging, it was neither coded nor mentioned in the radiology report."}, {"title": "Discussion", "content": "This study utilized deep learning-driven models\u2014Comp2Comp for detecting sarcopenia and hepatic steatosis, and the Merlin model for ascites prediction\u2014to assess the prevalence of these conditions in 2,674 inpatient CT scans. Discrepancies were identified between sarcopenia diagnoses and ICD coding, with only 0.5% scans being ICD-coded out of all scans diagnosed with sarcopenia via either the T-Score or BMI-Z-Score criteria. Similarly, of the scans diagnosed with hepatic steatosis via either the mean liver HU, liver-spleen HU criteria, or radiology reports, only 3.2% scans were ICD-coded. Finally, of the scans diagnosed with ascites through radiology reports or opportunistic imaging, only 30.7% scans were ICD-coded. While our study focused on analyzing potential under-coding, over-coding discrepancies were also found across the three medical conditions. For example, 16.4% of cases that showed neither a mention of ascites in radiology reports nor were classified positive by the Merlin model, were ICD-coded for ascites. These findings indicate the need for further investigation into such cases to refine both deep learning models and clinical coding practices. The threshold of the outputs of deep learning models like Merlin can also be optimized for diverse clinical applications.\nThe ability to accurately diagnose sarcopenia, hepatic steatosis, and ascites through opportunistic CT has significant clinical implications. Early identification of these conditions enables timely interventions that can improve patient outcomes. For example, diagnosing sarcopenia early allows for dietary interventions and lifestyle changes that can mitigate muscle loss and associated risks such as falls and fractures. Similarly, detecting hepatic steatosis earlier can facilitate weight management strategies, including emerging treatments like Ozempic, potentially preventing progression to more severe liver diseases. In the case of ascites, identifying the underlying cause\u2014often cirrhosis\u2014can enable targeted investigations and treatments, reducing complications and improving patient quality of life. Furthermore, employing more reliable large-scale studies through deep learning-driven models can improve diagnostic accuracy, and ultimately streamline clinical workflows.\nHowever, this study has limitations, including its retrospective nature and reliance on a single institution inpatient dataset, which can affect generalizability. Additionally, integrating imaging and EMR data across multiple sites presents significant challenges due to variations in data standards, infrastructure, and coding practices, which may limit the broader applicability of these findings. The use of ICD codes as a reference standard could also introduce bias due to inconsistencies in documentation and coding practices, particularly in the inpatient setting where coders cannot directly code from radiology reports, unlike in the outpatient setting [16]. Future studies should include prospective evaluations, validation across multiple institutions, and application to additional diseases with long-term health impacts."}, {"title": "Conclusion", "content": "This study demonstrates the potential of deep learning-based opportunistic CT in improving the detection and coding of medical conditions. Accurate capture of diagnoses is crucial, as incomplete data can result in suboptimal patient management, inaccurate billing, and skewed research. Integrating opportunistic imaging can enhance diagnostic accuracy while minimizing under-diagnosis and over-diagnosis. Through our analysis, we demonstrate that deep learning-based opportunistic imaging tools have the potential to strengthen both clinical practice and precision medicine research."}]}