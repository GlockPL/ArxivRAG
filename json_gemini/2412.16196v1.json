{"title": "AgroXAI: Explainable AI-Driven Crop Recommendation System for Agriculture 4.0", "authors": ["\u00d6zlem TURGUT", "\u0130brahim K\u00d6K", "Suat \u00d6ZDEM\u0130R"], "abstract": "Today, crop diversification in agriculture is a critical issue to meet the increasing demand for food and to improve food safety and quality. This issue is considered to be the most important challenge for the next generation of agriculture due to diminishing natural resources, limited arable land and unpredictable climatic conditions caused by climate change. In this paper, we employ emerging technologies such as the Internet of Things (IoT), machine learning (ML) and explainable artificial intelligence (XAI) to improve operational efficiency and productivity in the agricultural sector. Specifically, we propose an edge computing-based explainable crop recommendation system, AgroXAI, which suggests suitable crops for a region based on weather and soil conditions. In this system, we provide local and global explanations of ML model decisions with methods such as ELI5, LIME, SHAP, which we integrate into ML models. More importantly, we provide regional alternative crop recommendations with the Counterfactual explainability method. In this way, we envision that our proposed AgroXAI system will be a platform that provides regional crop diversity in the next generation agriculture.", "sections": [{"title": "I. INTRODUCTION", "content": "Today, global climate change, population growth, agricultural land depletion and biodiversity loss pose serious environmental, social and economic threats [1]. Under these globally changing conditions, industrial growth and production methods based on sustainable agricultural principles are needed to meet the increasing demand for food and improve food security and quality [2]. At this point, ensuring crop diversity in agriculture stands out as a critical issue. Crop diversification is the process of adding a new crop, a different variety, to a field [3]. It is not only mitigates various agricultural challenges such as soil degradation, pest infestation, and climate change impacts, but also enhances farm resilience, fosters income growth on small holdings, stabilizes commodity prices, improves soil health, and offers a diverse range of nutritious food options for both humans and livestock [4]. In this context, ensuring regional crop diversity based on low-cost digital technologies, in response to changing environmental and climate conditions, emerges as a key area of focus for agriculture 4.0 [5]. In particular, it is necessary to periodically monitor the soil, air, and environmental factors in distributed geographic regions and provide suitable crop alternatives accordingly.\nThe concept of the Internet of Things (IoT), which provides technology-oriented creative solutions to the current needs in the new agricultural era, comes to the forefront [6], [7]. IoT offers innovative digital solutions in many areas based on low-cost, low-latency approaches such as edge and fog computing that respond to end-user needs on-site [8]. Many of these solutions are also being used effectively in agriculture domain. In this context, a wide variety of IoT-supported smart agriculture applications are implemented in crop management, soil management, water management, livestock management, green management, weather management, and tracking and tracing [9], [10]. It is observed that these applications are becoming widespread with AI support, but there is also a growing need for interpretability and explainability for the effective use of these technologies. In this regard, Explainable Artificial Intelligence (XAI) plays a crucial role in agriculture by enhancing the transparency of AI-driven recommendations, such as those for crop selection, soil health, and pest management [11]. By clarifying how environmental factors, soil properties, and climate conditions shape AI suggestions, XAI builds trust in technological solutions and supports data-driven decision-making. This interpretability is essential for sustainable agricultural practices, allowing stakeholders to make informed choices that enhance resilience and productivity amid changing environmental conditions.\nSpecifically, the existing research efforts related to crop prediction in the agriculture domain are as follows.\nSharma et al. [12] developed a crop prediction model based on Gaussian Naive Bayes, Decision Tree, Logistic Regression, Random Forest, and XGBoost models. The authors developed their models by training them on data collected from different agricultural fields in India. The forecasting system based on the developed models was enabled to be used online and offline via an Android application. Similarly, Doshi et al. [13] developed an intelligent recommendation system called AgroConsultant to help farmers in India make an intelligent decision on which crop to grow depending on various environmental and geographical factors. In the developed system, the authors presented a system design that combines data sets showing soil, climate and precipitation characteristics and decides which crop farmers will grow by using Decision Tree, K-Nearest Neighbour, Random Forest, regression and Neural Network models.\nRajak et al. [14] aimed to design a crop recommendation system using an ensemble learning model based on Support Vector Machine, Naive Bayes, Multi-layer Perceptron and Random Forest models. The proposed system was tested with soil dataset collected from different sources. Rule-based output was produced with the ensemble model used in the system. Similarly, Pudumalar et al. [15] aimed to design a highly accurate and effective crop recommendation system using ensemble techniques. They applied the majority voting technique in Random Forest, CHAID, K-Nearest Neighbour and Naive Bayes learners. In this study, soil testing lab and crop data available in online sources were used as a dataset. As a result of the applied model, they created a rule. Saranya et al. [16] developed a crop recommendation module that ensembles the results of Support Vector Machine, Random Forest, Naive Bayes, and K-Nearest Neighbor models using majority voting. In addition, they designed a web-based interface called TILLAGE that includes fertilizer recommendation and pesticide recommendation modules based on the CNN model. The proposed modular solution aims to increase agricultural production by improving soil use, fertilization and crop selection.\nUnlike the above studies, edge computing architecture and Deep Reinforcement learning (DRL) learning-based methods have been used in the architectural design and product management of smart agriculture applications. For example; Wang [17] aimed to design an edge-cloud computing-based smart agriculture system using DRL. This system consists of an agricultural data collection layer, edge computing layer, data transmission layer, and cloud computing layer. While data is collected from various sensors placed in the agricultural data collection layer, DRL is deployed in the cloud computing layer for instant smart decision-making. In another study, Alonso et al. [18] proposed an architecture called Global Edge Computing Architecture (GECA) to realize Edge-IoT applications. In this architecture, they developed SDN/NFV capabilities and a Double Deep-Q Learning model to control virtual data flows. Din et al. [19] focused on the problem of monitoring crop health in a semi-structured farm. For this problem, a non-uniform area coverage algorithm based on the Double Deep Q-Network (DDQN) algorithm was developed.\nOn the other hand, studies on the explainability of smart agriculture practices have been quite limited. Sabrina et al. [20] designed an ML and fuzzy logic-based smart agriculture system aiming to increase crop production. The system is based on SVR, KNN and Naive Bayes models to monitor soil properties, and weather conditions, and detect possible abnormal conditions for the target crop. In the paper, an approach based on fuzzy rules is presented to ensure user trust and interoperability. In a similar study, Cartolano et al. [21] focused on crop recommendation and effective feature extraction based on explainable ML methods in smart agriculture. They applied Extreme Gradient Boosting, Multi-layer Perceptron, and SVR models on the crop recommendation database. In these models, they obtained visualization with various graphics using SHAP and LIME, which are explainable artificial intelligence methods.\nConsidering the existing gaps and shortcomings in the literature, in this work we present an explainable and interpretable decision support system based on IoT edge computing in the agricultural domain. The key contributions of this paper are summarized as follows.\n\u2022 We propose a XAI based crop recommendation system called AgroXAI that provides a dynamic regional crop diversity.\n\u2022 We introduce a conceptual IoT architecture to operate the proposed system at the edge based on an edge computing approach.\n\u2022 We also provide SHAP, LIME and ELI5 based post-hoc explainability of why the preferred crop is planted for an agricultural area.\nThis paper is structured as follows: Section II explains the proposed crop recommendation system model, used ML models and XAI methods. Section III presents experimental result of ML models and discusses the XAI method results. Section IV provides a comprehensive discussion of security, privacy, ethical considerations, economic feasibility of the model and local preferences. Finally, Section V concludes the paper."}, {"title": "II. AN EDGE COMPUTING-BASED EXPLAINABLE CROP RECOMMENDATION SYSTEM (AGROXA\u0399)", "content": "In this section, we introduce the proposed system model for crop recommendation system and used ML and XAI methods."}, {"title": "A. System Model", "content": "Next generation agriculture aims to make agricultural production more efficient, sustainable and predictable through technologies such as digitalization, automation and artificial intelligence. With this new vision of agriculture, data-driven decision-making processes will enable farmers to make more informed and region-specific crop choices. However, due to differences in climate, soil structure, water resources, temperature and humidity in different regions, there is a need for low-cost and effective decision support systems that can make localized decisions at the most extreme regional level. Therefore, in this study, we propose a data-driven and AI-supported crop recommendation system that will make regional crop selection more effective at the edge close to the end user. Specifically, the proposed system shown in Figure 1 is based on a conceptual IoT architecture consisting of physical layer, edge layer, fog layer and cloud layer.\n\u2022 Physical Layer: This layer includes sensors that measure the region's climate, soil structure, water resources, temperature and humidity, and actuators that provide conditions that can be changed in the region. In this way, it will be possible to periodically measure the current conditions for crop forecasting and change the environment when necessary.\n\u2022 Edge Layer: At this layer, for each geographic region, there are end devices to analyze the locally collected data. these devices are capable of running classical ML and XAI methods (such as Raspberry Pi). Regionally, the edge devices are tasked with taking the data in their coverage area, predicting the appropriate crops for each region and providing an explanation of the prediction results. The ML models and XAI methods used in this study operate at this layer.\n\u2022 Fog Layer: This layer includes hardware clouds that manage data traffic between the edge and the cloud layer and have the potential to provide network control.\n\u2022 Cloud Layer: This layer includes resource-rich network devices that can perform computation and storage tasks that cannot be performed on edge systems in the proposed architecture. In particular, it collects all agricultural data in one center and provides batch analysis when needed.\nIn the physical layer of AgroXAI, farmers in each geographical region will be able to collect regional conditions at the time of planting crops with IoT sensors and see the most suitable crops to be planted according to ML and XAI results on edge devices. When needed, the obtained information can be stored on the fog server or cloud server and stored on central servers."}, {"title": "B. ML Models", "content": "In this paper, we used K-Nearest Neighbors (KNN), Random Forest (RF), Decision Tree (DT), Support Vector Machine (SVM), LightGBM (LGBM) and Multilayer Perceptron (MLP) models to classify the crop.\n1) KNN: KNN, which is based on the distance between data points, is used to solve classification and regression problems. It uses the nearest \"k\" pieces of data to decide which class the data belongs to. The success of KNN is determined by the number of neighbors (k) and the distance calculation algorithm used [22].\n2) RF: RF is an ensemble approach. A forest is made up of many independent decision tree classifiers. Changing the attribute choices at random instead of the training examples is the main concept. Every tree in the forest generates a result by doing its own assessment. Each tree votes, and the value with the highest score is chosen [22].\n3) DT: DT is a model that predicts by learning simple rules extracted from data features, represented by a tree representation. Instances are ordered from root to leaf node. Each node in the tree indicates a feature of the instance to be tested. Based on the tested features, the path from the root to a leaf node leads to the class label. The overfitting problem in DT can be encountered. Pruning can be applied to solve this problem [23] .\n4) SVM: SVM is a method for classifying both linear and non-linear data. In this method, data are classified into pre-defined classes with the help of a hyperplane. In determining the hyperplane, margins and support vectors, which are data points close to the hyperplane, are used [22].\n5) LGBM: LGBM is a type of histogram-based boosting method. It is capable of rapidly processing big datasets [24]. It uses the leaf-wise strategy, one of the methods used in learning decision trees. This strategy allows an unbalanced tree to grow and aims to split the leaf with the most loss. In this way, the loss is minimized [25].\n6) MLP: MLP is a simple feedforward neural network and basically consists of three layers. The first layer is the input layer, which accepts incoming signals and then passes them on to neurons in the hidden layer. Calculations are performed in the hidden layer. There may be one hidden layer, or there could be multiple hidden layers. The last layer, the output layer, accepts the output signals from the hidden layer and creates the output pattern of the network [23]."}, {"title": "C. Explainable AI Methods", "content": "In the classification process, not only is it important for models to achieve high accuracy, but the interpretability of the models' decisions is also of critical importance. Providing interpretability in these developed systems emerges as a factor that enhances trust in the model decisions [26]. Therefore, in this study, we employ IML methods such as ELI5, LIME, SHAP, and Counterfactual.\n1) Explain Like I'm 5 (ELI5): ELI5 is a Python package used for the explainability of black box models. It provides both global and local explainability. ELI5 uses tree models for calculating feature weights. The contribution of the feature to the decision is based on how much the score has changed from parent to child at each node of the tree. [27]\n2) SHapley Additive explanations (SHAP): SHAP is an explainability method based on game theory. In this method, a value called Shapley value is calculated for each feature, which expresses the contribution of the feature to the outcome. Shap provides both local and global explanation [28].\n3) Local Interpretable Model-agnostic Explanations (LIME): LIME method examines how the model works by changing the inputs and observing how the predictions vary. LIME is model-agnostic and provides local explanations [29].\n4) Counterfactual: Counterfactual is a human-friendly explainability method that explains the smallest change in feature values and transforms the prediction into a predefined output. Although a counterfactual tries to generate feature values as close as possible to the corresponding instance, it is not always possible to find a counterfactual for every predefined prediction [28]."}, {"title": "III. EXPERIMENTAL RESULTS AND EVALUATION", "content": ""}, {"title": "A. Dataset Information", "content": "In this paper, we use the agriculture dataset available in Kaggle [30]. The dataset contains 2200 rows of data and seven features. The features are presented in Table II. In addition, the dataset contains 22 different crop types as target labels. These crops are apple, banana, blackgram, chickpea, coconut,"}, {"title": "B. ML Results and Evaluation", "content": "We tested all used models with the best parameters in Table I and obtained the results in Table III. When comparing classification models based on precision, recall, F1 score, and accuracy, all models show strong performance with an overall value above 95%. In particular, RF outperforms the others with outstanding precision, recall, F1 score, and accuracy reaching 99.24%. The DT follows closely behind with a balanced performance with an accuracy of 98.48%. KNN, SVM, LGBM, and MLP also show strong performances, reaching over 95% accuracy. The success of RF here may be due to combining multiple decision trees and mitigating overfitting through random sampling, which tends to provide robust generalization."}, {"title": "C. XAI Results and Evaluation", "content": "We used ELI5, SHAP, and Counterfactual explainability methods to explain ML models developed for crop diversity. In this context, we first used ELI5 and SHAP methods for local and global explanation of the decisions of the most successful ML models RF and LGBM models. Then, we determined the crop varieties to be grown in the relevant region using the counterfactual method.\nThe global explainability of the ELI5 method with respect to RF and LGBM models is shown in Figure 2. These graphs show the most effective attributes for classifying the crop variety according to the weather and soil conditions in the region. According to the information in the figure, it is seen that the first two features that contribute the most to the decision in crop classification for RF and LGBM models are \"Humidity\u201d and \u201cRainfall\u201d. The third attribute is \"Potassium\u201d for RF and \"Phosphorus\u201d for LGBM. This information shows that moisture and rainfall features are critical in determining crop diversity.\nFor local interpretability, a single data instance is selected, and the model's decision output for this data is analyzed. In this context, the local interpretability of the most successful models, RF and LGBM, has been extracted for randomly selected data instances. In this study, more than one method is used for better interpretability of model decisions. In this context, RF and LGBM model decisions are also explained both locally and globally with the SHAP method.\nThen, SHAP local explainability results were obtained for the sample test data provided in the description of Figure 6 and illustrated using a force plot. In the force plot, the feature occupying the largest area is the one contributing the most to the decision. We also examined the local explanations of the RF and LGBM model according to LIME, another local explainability method.\nUp to this point, we have evaluated the post-hoc explainability of the model results by using ELI5, SHAP and LIME. In this study, we also aimed to provide alternative crop recommendation based on edge computation regionally in addition to the interpretability of the current decisions. In this context, we used the counterfactual explainability method to identify the list of other crops that can be planted for each predicted crop. In counterfactual explainability, each selected data sample is referred to as the \"actual instance,\" and the class for selected data is predicted. In addition to this result, alternative counterfactual suggestions are provided for the output. In this way, regionally appropriate products and alternative suggestions are obtained. When all the explainability method results are evaluated, post-hoc explainability of the ML models has been achieved through methods such as ELI5, SHAP, and LIME. Accordingly, although each algorithm highlights different features"}, {"title": "IV. DISCUSSION", "content": "The AgroXAI system ensures model explainability while fostering crop diversity by offering locally relevant alternative crop recommendations. These features allow for the transparent disclosure of the rationale behind agricultural system decisions, thereby enhancing the decision-making process of farmers. While the AgroXAI system offers numerous advantages, it is essential to also address critical aspects such as security, privacy, ethical considerations, economic feasibility, and local preferences. Therefore, this section will explore these key issues in detail.\nIn explainable systems, there is generally a trade-off between accuracy and interpretability. Accordingly, models with high interpretability tend to have lower accuracy, while models with higher accuracy may exhibit reduced interpretability. In the context of AgroXAI, this highlights the need to strike a balance between optimizing the accuracy and ensuring transparency for users. Therefore, the selection of XAI methods in systems like AgroXAI may depend on a choice between maximizing model accuracy and presenting the system's decisions in an understandable and user-friendly manner.\nWhile the AgroXAI system facilitates transparency and informed decision-making, its reliance on user data and sensor-derived information introduces potential concerns. If sensor security is not adequately ensured, malicious actors could create privacy and security risks. As such, addressing security and privacy is paramount in the design and implementation of the system to ensure its trustworthiness.\nIn another dimension, AgroXAI aims to minimize environmental impacts by helping farmers optimize resource usage. By employing the counterfactual method, it provides valuable information on how farmers should adjust water and fertilizer levels for different crops, thus enhancing productivity. For instance, this feature supports sustainable agriculture by promoting the efficient use of water resources and preserving soil health through optimized fertilizer use. However, the potential impacts of crop recommendations on livelihoods and food security must also be carefully considered. For instance, if the recommended crops are not suitable for local climate conditions or soil characteristics, crop failure may occur, leading to a significant decline in farmers' income. Such losses present considerable risks, particularly in regions where agriculture and food security are critical. In light of these challenges, the ability of developed systems to adapt to changing environmental conditions and provide appropriate recommendations becomes increasingly important, especially in a context where climate variability and soil degradation are escalating."}, {"title": "V. CONCLUSION", "content": "In this study, we propose a digitalized, remotely manageable, data-driven, and AI-supported system aimed at achieving the sustainability, efficiency, capacity enhancement, and smart agricultural production goals targeted by Agriculture 4.0. We present an explainable AI-powered smart crop selection and recommendation system to meet these needs. The proposed system is structured to identify crops suitable for specific geographical conditions and to provide a list of alternative crops. By focusing on the promising area of XAI within the field of AI, AgroXAI has the potential to build trust on the user side. The obtained results have increased the interpretability of the model decisions of the developed system through different XAI methods and established confidence among users. Additionally, the results provide insights into the environmental factors that need to change for regional crop alternatives. In this respect, AgroXAI is expected to contribute to customized production processes by serving as both an intelligent and explainable decision support system in agricultural production. In the coming years, with the widespread adoption of such systems, farmers will be able to better understand region-specific conditions, increase efficiency, minimize environmental impacts, and optimize product diversity."}]}