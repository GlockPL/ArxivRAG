{"title": "Reliable Multi-View Learning with Conformal Prediction for Aortic Stenosis Classification in Echocardiography", "authors": ["Ang Nan Gu", "Michael Tsang", "Hooman Vaseli", "Teresa Tsang", "Purang Abolmaesumi"], "abstract": "The fundamental problem with ultrasound-guided diagnosis is that the acquired images are often 2-D cross-sections of a 3-D anatomy, potentially missing important anatomical details. This limitation leads to challenges in ultrasound echocardiography, such as poor visualization of heart valves or foreshortening of ventricles. Clinicians must interpret these images with inherent uncertainty, a nuance absent in machine learning's one-hot labels. We propose Re-Training for Uncertainty (RT4U), a data-centric method to introduce uncertainty to weakly informative inputs in the training set. This simple approach can be incorporated to existing state-of-the-art aortic stenosis classification methods to further improve their accuracy. When combined with conformal prediction techniques, RT4U can yield adaptively sized prediction sets which are guaranteed to contain the ground truth class to a high accuracy. We validate the effectiveness of RT4U on three diverse datasets: a public (TMED-2) and a private AS dataset, along with a CIFAR-10-derived toy dataset. Results show improvement on all the datasets. Our source code is publicly available at: https://github.com/an-michaelg/RT4U", "sections": [{"title": "1 Introduction", "content": "Clinical motivation. Aortic Stenosis (AS) is a heart valve disease in which the restricted motion of the aortic valve leaflets (AVL) impairs blood circulation. AS is highly prevalent in older populations [4], posing a growing societal burden with global aging trends. Early detection, monitoring, and timely intervention are crucial due to the low survival rate among untreated AS patients [23]. AS diagnosis typically involves echocardiography (echo), with the decision on disease severity relying mostly on blood flow measurements from spectral Doppler [7]."}, {"title": "Challenges in interpreting echo exam data.", "content": "Echocardiograms are 2-D (+time) visualizations of 3-D (+time) patient anatomy, captured by human sonographers. However, variations in patient size and operator skill can result in echo views that lack sufficient diagnostic information [8]. Directly training a model to predict AS severity from any cross-sectional view can be misleading due to limited AVL visibility. This limitation holds true even for the parasternal long-axis (PLAX) and parasternal short-axis (PSAX) views, for which acquiring the correct angle to image the AVL requires operator skill. Therefore, during inference, we would like the model to have robust uncertainty estimation (UE) to warn users and prevent failed predictions if the input is inadequate. To the best of our knowledge, simultaneously pursuing these two goals - learning with imperfect data and developing strong UE - is rarely done."}, {"title": "Conformal prediction.", "content": "Neural networks predictions are often overconfident [13]. Temperature scaling can mitigate this effect, but does not have a rigorous connection between the validation and test set performance. In contrast, Conformal Prediction (CP) is a way of transforming class predictions $p(y|x) \\in [0,1]^K$ to prediction sets $C(x) \\subseteq \\{1, ..., K\\}$ , where K is the number of classes. Crucially, the sets are guaranteed to \u201ccover\u201d the ground truth to some user-specified probability [6] (see section 2)."}, {"title": "Contributions.", "content": "Inspired by a technique for learning with noisy labels [9], we frame the problem as \u201clearning with noisy inputs\u201d. The disparity between inputs affected by some inherent ambiguity (e.g., from poor image quality or cross-sectioning) and one-hot labels can be viewed as noise. Given that these labels fail to capture the ambiguity a clinician might encounter when analyzing the echo data, they should not be one-hot encoded. This type of noise, while uncommon in camera images, is ubiquitous in echo imaging due to the images being 2-D visualizations of 3-D anatomy. We propose Re-Training for Uncertainty (RT4U), a training method that uses pseudo-labels to mitigate overfitting to noisy inputs. RT4U is a model-agnostic technique without hyperparameters, and it can be applied to existing approaches for AS classification with minimal overhead. We show that RT4U leads to improvements both top-1 accuracy and reduces prediction over-confidence."}, {"title": "2 Background and Related Works", "content": "Automated detection of aortic stenosis. Deep learning approaches have been proposed for AS severity classification from 2-D echo. Huang et al. [16] used images from multiple standard-plane views, and predicted both the view and the severity. Dai et al. [10] and Holste et al. [15] separated severe AS cases from other cases with PLAX view videos as the input. Ginsberg et al. [11] proposed an ordinal regression based approach. Ahmadi et al. [2] used an attention-based architecture to identify key video frames for classification. Vaseli et al. [25] used an attention-based framework to identify important spatio-temporal components of the video. However, all the aforementioned works utilized one-hot labels. Secondly, none incorporated conformal prediction techniques to improve prediction reliability.\nConformal prediction. Conformal prediction originated from Vovk et al. [27]. Recent advancements such as LABEL [21], APS [20], and RAPS [5] have introduced CP algorithms with lower and more adaptive set sizes. In the medical domain, Lu et al. [18] validated CP on clinical data and extended RAPS to guarantee coverage for specific patient subgroups. Lu et al. [17] extended APS to ordinal regression problems. Stutz et al. [24] extended CP principles to data with multi-rater labels. CP principles have also been applied to skin disease [31] and histopathology images [29]."}, {"title": "3 Methodology", "content": "3.1 Training dynamics with input-dependent noise\nDeep learning models can overfit complex forms of noise [3]. This includes overfitting to non-informative ultrasound views, which can be considered as input-dependent noise. An observation by Chen et al. [9] shows that neural networks tend to fit simpler examples first. We confirm that this phenomenon also exists for ultrasound images (Fig. 2). Consequently, the evolution of model's confidence during training can serve as a rough approximation of the 'noise\" of a particular sample. We can take advantage of this to create new pseudo-labels using the history of model predictions during training (Eq. (2)), where T denotes the total number of epochs, \u03c3 denotes softmax, and f(.) denotes the logits of the predictive model.\n3.2 RT4U algorithm\nOur proposed RT4U algorithm can be applied to any iterative training approach. First, we train the model with $D_{tr} = \\{X_{tr}, Y_{tr}\\}$ for T epochs, saving the prediction of training set $f(x_i)_t \\forall i \\in X_{tr}, t \\in T$. We form pseudo-labels $y' \\forall x_i \\in X_{tr}$ using Eq. (2). Subsequently, we train the model from scratch with (x, y') pairs for T epochs. This re-initialization is necessary for eliminating the impact of overfitting caused by training in the initial round. Subsequently, CP algorithms can be applied to the trained model to generate prediction sets. We opt for the LABEL algorithm [21]. LABEL requires a calibration set $D_{cal} = \\{X_{cal}, Y_{cal}\\}$ to find a conformal score quantile, $\\hat{q}$. The $\\hat{q}$ is then used as a threshold; classes with confidence exceeding it belongs to $C(x)$ for samples $x \\in X_{test}."}, {"title": "4 Experiments", "content": "4.1 Simulated noise on CIFAR-10 dataset\nWe first demonstrate the efficacy of our proposed model-agnostic methodology on a toy problem. We generate quadrant-label pairs from images in the CIFAR-10 dataset, creating what we term CIFAR-Q. For each image-label pair (Zi, Yi), we train the network on the four image quadrants $(X_{i1}, Y_i)$, $(X_{i2}, Y_i)$, $(X_{i3}, Y_i)$, $(X_{i4}, Y_i)$ (see Fig. 1). CIFAR-Q simulates learning from potentially non-informative 2-D slices of 3-D objects, within a controlled environment constructed from a well-known dataset. We first split the CIFAR-10 training set randomly with a 95:5 ratio, then form $X_{tr}$ and $X_{val}$ from the quadrants of the splits.\nThe setups compared are as follows: Vanilla training with cross-entropy loss (CE), CE with temperature scaling on $X_{val}$ (CE+Temp), CE with temperature scaling and RT4U training (CE+RT4U+Temp), Mean Absolute Error loss (MAE), and Active Negative Loss [30] (ANL) with hyperparameters (\u03b1, \u03b2, \u03b4) = (1, 1, 0).\n4.2 Aortic stenosis classification using image and video data\nWe integrate RT4U into state-of-the-art methods for AS classification.\nIn the image domain, we compare with Huang et al. [16] on the public TMED-2 dataset. This dataset contains 17270 images from 599 echo studies classified as no/early/significant AS. We use the training and validation splits from the provided DEV479 file, excluding studies lacking AS diagnosis labels.\n4.3 Metrics\nWe evaluate approaches with the following metrics at both the instance-level and study-level. \"Study\u201d refers to an echo study consisting of multiple images/videos, or an entire image consisting of four quadrants for CIFAR-Q. BAcc and BCov are class-balanced versions of the top-1 accuracy and coverage accuracy. We report the median BCov and |C(x)| from 100 random trials in order to confirm the marginal coverage property while accounting for randomness.\n4.4 Decision aggregation\nWe use different approaches for aggregating multiple instance-level predictions into a study-level prediction. For CIFAR-Q experiments and R(2+1)D [11], we employ the method in Satop\u00e4\u00e4 et al. [22] to average the instance-level predictions in the logit space (Eq. (3)), where $x_j$, j \u2208 [1, M] denote the M instances within the same study.\nFor Huang et al. [16], we perform a weighted average based on the predicted view probability of PSAX or PLAX. We approximate the view probability with a ResNet-18 model. For ProtoASNet [25], we perform an average of the instance-level predictions \u2208 [0,1]K with consideration of the additional \u201cuncertainty\u201d class that is introduced by the ProtoASNet architecture. These aggregation approaches are consistent with their original works.\n4.5 Results and discussion\nIncorporating RT4U raises the BAcc for each of the three AS severity classification methods (Tables 1 and 2). This is because RT4U reduces the loss induced"}, {"title": "5 Conclusion and Future Work", "content": "We introduce RT4U, a novel training method aimed at tackling the issue of limited information within medical images. Firstly, the pseudo-labels provided by RT4U can mitigate overfitting to noisy inputs, and allow the network to associate these inputs to a high-uncertainty state. Secondly, in terms of conveying uncertainty, conformal prediction sets with a guaranteed accuracy offer a promising alternative to top-1 predictions and confidence values. Future improvements include introducing hyperparameters to refine the pseudolabel generation process, exploring the relationship between output logits and the size of prediction"}], "equations": ["Yi = \\Sigma \\sigma (f(xi))"]}