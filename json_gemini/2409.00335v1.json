{"title": "Evaluating the Effectiveness of Large Language Models in Representing and Understanding Movement Trajectories", "authors": ["Yuhan Ji", "Song Gao"], "abstract": "This research focuses on assessing the ability of AI foundation models in representing the trajectories of movements. We utilize one of the large language models (LLMs) (i.e., GPT-J) to encode the string format of trajectories and then evaluate the effectiveness of the LLM-based representation for trajectory data analysis. The experiments demonstrate that while the LLM-based embeddings can preserve certain trajectory distance metrics (i.e., the correlation coefficients exceed 0.74 between the Cosine distance derived from GPT-J embeddings and the Hausdorff and Dynamic Time Warping distances), challenges remain in restoring numeric values and retrieving spatial neighbors in movement trajectory analytics. In addition, the LLMs can understand the spatiotemporal dependency contained in trajectories and have good accuracy in location prediction tasks. This research highlights the need for improvement in terms of capturing the nuances and complexities of the underlying geospatial data and integrating domain knowledge to support various GeoAI applications using LLMs.", "sections": [{"title": "Introduction", "content": "The emergence of powerful AI foundation models (e.g., Large Language Models-LLMS, pre-trained vision and multi-modal models) has captured the enthusiasm of researchers, developers, and decision makers in various domains. The development of foundation models (e.g., Generative Pre-trained Transformer, GPT) is still in its early stages towards artificial general intelligence, but the potential society benefits are enormous. The model pre-training process involves learning a vast amount of data from a wide range of resources, thus being able to adeptly grasp linguistic patterns, comprehend contextual information, and connect knowledge from different domains. The extensive scale empowers such pre-trained LLMs to be applied directly or transfer to a wide range of cross-domain tasks after minor fine-tuning or few-shot/zero-shot learning, e.g. education [6], transportation [18], healthcare [17], GIS skills and geospatial semantics [9, 8], etc. The tasks can be in the form of question answering, content generation, classification, causal inference, etc. Researchers have explored the use of LLMs to ensure text coherence and consistency in time series data analysis [8].\nInspired by the preliminary works on GeoAI and movement data analytics [3, 4, 5], we are motivated to utilize LLMs for trajectory representation and analysis, which is fundamental to understanding human mobility, urban dynamics, and animal ecology. Trajectory data inherently consists of spatiotemporal sequence data, thus being compatible with LLMs designed for textual sequences. Despite the abundance of trajectory datasets, the analytical framework is usually customized to address specific problems in human movements or animal ecology [2]. Moreover, current models usually rely on subjective decisions on the discretion of the space and time extents at the cost of resolution lower than the documented [7, 12]. While it is possible to extend LLMs to disruptive movement analysis, the degree to which a trajectory can be properly represented and the mobility patterns can be preserved remains to be examined, which will be the focus of this work."}, {"title": "Methodology", "content": "The work aims to assess the capacity of LLMs in representing and conducting reasoning on available movement trajectory data. From longitudinal trajectory data collected from location-based services, we are able to derive two types of trajectories: First is the sequence of stay points where individuals were engaged in activities. Second, is the travel path between two consecutive stay points, referred to as the origin and destination (OD), which records the locations (e.g. GPS fixes) traversed during the trip at a fine spatiotemporal resolution. The obtained trajectories (sequences of coordinates) are then formatted as input into LLMs.\nWe hypothesize that an LLM can serve as an encoder to learn the high-dimension representation (embedding) of a trajectory composed of coordinates, which can capture contextual information, such as temporal dependency and spatial patterns. Additionally, by incorporating effective prompts and employing fine-tuning or few-shot learning [15], the models can potentially leverage the newly acquired knowledge as well as the pre-trained knowledge to perform specific tasks or offer valuable insights. We identify two extensively studied trajectory mining tasks (T1 and T2) for validation and evaluation (See Section 2.4)."}, {"title": "Dataset", "content": "The GeoLife human movement trajectory dataset [19] is employed to evaluate our proposed evaluation framework. The GeoLife dataset consists of individual users' outdoor movements with 17,621 trajectories from 182 users over a period from April 2007 to August 2012 using GPS loggers and GPS phones. A GPS trajectory consists of a sequence of time-stamped points of longitude and latitude. Due to the difference in tracking devices, the sampling rates are not the same across users, with majority of users sampled at about every 5 seconds. Since the participants were recruited through rewards, the total duration of an individual's trajectories varies from weeks to years. The Python library scikit-mobility [10] and scikit-learn are used to preprocess the dataset, including noise filtering, trajectory compression, stay points identification, stay points clustering, and user filtering."}, {"title": "Foundation Model", "content": "The GPT-J from EleutherAI [14] is used in this work to explore the potential application of LLMs in trajectory modeling. The GPT-J project aims to replicate OpenAI's GPT-3 model with a reduced number of parameters while making it open source to the public. Therefore, like GPT-3, GPT-J enables few-shot learning in text analysis and serves specified downstream tasks."}, {"title": "Problem statement", "content": "T1: Trajectory distance measures\nDescription: In this task, we focus on the global trajectory distances which consider the overall similarity between a pair of trajectories regarding all the points contained [20]. We compare the distance between two trajectories using two approaches: traditional distance metrics and the distance between embeddings.\nMethod: The effectiveness of using LLM-based embedding for measuring trajectory distance is assessed as in Figure 1.\nT2: Contextless destination prediction\nDescription: The aim of the task is to predict the destination given the partial travel path of an ongoing trip. In a contextless data setting, only trajectory coordinates are available without contextual information such as timestamps and place semantics [13].\nMethod: Given that the destination information is not originally contained in the partial trajectories, a potential approach is to leverage the generation capability of LLMs to produce destinations by fine-tuning a causal language model (CausalLM). The training prompts contain both the partial trajectories and destinations, for instance, \"Trajectory: (116.3248,\n40.012), (116.3217, 40.0107), (116.3242, 40.0091), (116.3244, 40.0061) => Destination (116.3262, 40.0002)\". However, during testing, the destinations are omitted from the prompts and need to be completed by the fine-tuned model. In order to build a comparative baseline, we implement the trajectory distribution model proposed in [1]. The model predicts the destinations based on the Gaussian Mixture Model clustering of trajectory points.\nEvaluation: We first need to check whether the output text is valid coordinates (i.e., within the latitude [-90,90] and longitude [-180,180] ranges in degree). If valid, we adopt similar evaluation metrics as presented in [13]. The prediction error is calculated by the haversine distance between the ground truth and predicted destinations. A prediction is classified as accurate if it is within a given distance of the true destination. In addition, because a generative model may generate multiple possible results, we further extend the performance metrics to Error@k and Accuracy@k, which are the mean error of k trials and the fraction of times the destination is correctly predicted among the top k candidates."}, {"title": "Results", "content": "The GeoLife trajectories of medium length (based on percentile) are selected for experimental evaluation. We compute the pairwise trajectory distances according to the details described in Section 2.4. All the distance measures are parameter-free except LCSS, which requires a spatial threshold e to match locations in LCSS. We compute the LCSS distance with e = 0.005 and \u20ac = 0.02 respectively. According to the Spearman's rank correlations between different distance measures listed in Table 1, inconsistency exists between metrics. The correlation coefficients exceed 0.74 between the Cosine distance derived from GPT-J embeddings and the Hausdorff and DTW distances, while the LCSS distance is sensitive to the matching threshold with a higher dissimilarity."}, {"title": "Conclusion", "content": "In this research, we utilize the pretained GPT-J foundation model to encode the string format of trajectories and then evaluate the effectiveness of LLM-based embeddings for trajectory data analysis in the era of GeoAI. The experiments demonstrate that while the LLM-based embeddings can preserve certain trajectory distance metrics, challenges remain in estimating numeric values and retrieving spatial neighbors for destination prediction. In addition, the LLMs can understand the spatiotemporal dependency contained in trajectories and has good accuracy in location prediction task. Future work will focus on evaluation of other LLMs (e.g., GPT-4, GPT-40, Llama 3, and Claude 3) and the exploration of semantic queries on trajectory data with attributes (e.g., activity mode, trip purpose, place visits). This research highlights the need for improvement in terms of capturing the nuances and complexities of the underlying geospatial data and integrating domain knowledge to support various GeoAI applications using LLMs. Looking ahead, when we integrate more AI foundation models into the human movement data analytics, we also need to pay attention to the increasing concerns regarding the location privacy, biases, and ethical issues in LLMs [11, 16]."}]}