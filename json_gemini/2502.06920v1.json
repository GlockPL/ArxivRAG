{"title": "Direct Estimation of Pediatric Heart Rate Variability from BOLD-fMRI: A Machine Learning Approach Using Dynamic Connectivity", "authors": ["Abdoljalil Addeh", "Karen Ardila", "Rebecca J Williams", "G. Bruce Pike", "M. Ethan MacDonald"], "abstract": "Motivation: In many pediatric fMRI studies, cardiac signals are missing or have poor quality. Therefore, it would be highly beneficial to have a tool to extract Heart Rate Variation (HRV) waveforms directly from fMRI data without the need for peripheral recording devices.\n\nGoal: Develop a machine learning framework to accurately reconstruct HRV tailored for pediatric applications.\n\nApproach: A hybrid model using one-dimensional Convolutional Neural Networks (1D-CNN) and Gated Recurrent Units (GRU) analyzed BOLD signals from 628 ROIs, integrating past and future data.\n\nResults: Achieved an 8% improvement in HRV accuracy, evidenced by enhanced performance metrics, demonstrating the model's effectiveness.\n\nImpact: This method enhances pediatric fMRI by eliminating the need for peripheral photoplethysmography devices, reducing costs and simplifying procedures. It could also improve the robustness of pediatric fMRI studies, which are more affected by physiological and developmental variations than in adults.", "sections": [{"title": "Introduction", "content": "Recent advancements in machine learning (ML) have facilitated a novel approach that leverages resting-state BOLD-fMRI signals to directly estimate respiratory variation (RV) waveforms in pediatric participants [1], thereby circumventing the need for external measurements. This methodology, validated with data from the Human Connectome Project in Development (HCP-D) [2], has proven highly effective in reconstructing RV. In contrast, the estimation of heart rate variation (HRV)\u2014vital for addressing cardiac confounds has not yet been explored in pediatric fMRI research. The challenge of HRV estimation is accentuated by its complex temporal dynamics, where BOLD-fMRI signal alterations span a substantial temporal window of 6 to 42 seconds and affect both gray and white matter [3-5].\n\nIn response to these challenges, this work presents the first study aimed at estimating HRV from resting-state BOLD-fMRI data in pediatric subjects. We propose an ML framework utilizing dynamic functional connectivity (dFC)-based brain atlases [6] designed to enhance the model's ability to capture the intricate temporal dynamics of HRV by integrating data from both gray and white matter. This approach is expected to refine the accuracy of HRV estimation, with an anticipated improvement in performance metrics by at least 5%, compared to static functional connectivity-based brain atlases used in the RV estimation study."}, {"title": "Method", "content": "This study employed a novel HRV reconstruction approach using a hybrid model of one-dimensional Convolutional Neural Networks (1D-CNN) and Gated Recurrent Units (GRU) to analyze BOLD signals from 628 ROIs (518 cortical, 62 subcortical, and 48 white matter ROIs) derived from dynamic and diffusion tensor imaging-based atlases [6, 7]. A 65 TR sliding window technique is used to estimate HRV at the 10th point, enhancing the capture of HRV-related BOLD fluctuations (Figure 1). Out of 2451 scans in the HCP-D dataset, 352 were selected for high-quality photoplethysmography (PPG) signals.\n\nWe used ten-fold cross-validation, dividing the dataset into ten subsets. Nine subsets were used for training and one for testing in each fold, repeated across all folds to create 10 independent models, with each subset tested once. Model performance was evaluated using multiple metrics: Mean Absolute Error (MAE), Mean Squared Error (MSE), Pearson correlation coefficient, and Dynamic Time Warping (DTW) on the test datasets. Performance metrics from all iterations were averaged, and the results were reported as mean values to provide a clear indication of the model's overall efficacy."}, {"title": "Results", "content": "Many PPG signals from the HCP-D dataset exhibit spikes from subject movement or technical issues. Figure 2 displays PPG signals, with the first (Figure 2.a) showing correctable noise used to train and test our ML model, while others are discarded due to excessive noise or incomplete data. The 1D-CNN + GRU network's accuracy in reconstructing HRV time-series is shown in Figure 3, demonstrating high precision, especially during significant HRV fluctuations."}, {"title": "Discussion", "content": "This study introduces an innovative method for estimating HRV from BOLD-fMRI data using a hybrid model of 1D-CNN and GRU. Our findings indicate that the dFC-based brain atlases significantly outperform static or anatomical ROIs by effectively capturing the complex temporal fluctuations of HRV.\n\nIncorporating white matter regions substantially enhanced HRV accuracy, supporting previous studies that suggest the inclusion of non-cortical areas improves physiological confound correction [10]. This integration aids in detecting global physiological fluctuations, enhancing HRV estimation accuracy across both gray and white matter.\n\nWe hypothesized that combining dynamic ROIs, white matter, and a hybrid network would improve HRV accuracy by at least 5%, and this was confirmed with over 8% improvement in correlation and other performance metrics such as MAE and MSE. Despite these advances, challenges remain, particularly with stable HRV pattern detection due to the limitations of the sliding window technique and input variability.\n\nFuture efforts will focus on refining the network architecture and improving ROI selection methods. Testing the model on larger and more diverse datasets could also provide further insights and enhance the model's generalizability. These enhancements are critical as they highlight the potential of machine learning to transform neuroimaging analysis, setting new directions for physiological signal estimation from BOLD-fMRI data."}]}