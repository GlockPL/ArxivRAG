{"title": "Driving with Regulation: Interpretable Decision-Making for\nAutonomous Vehicles with Retrieval-Augmented Reasoning via LLM", "authors": ["Tianhui Cai", "Yifan Liu", "Zewei Zhou", "Haoxuan Ma", "Seth Z. Zhao", "Zhiwen Wu", "Jiaqi Ma"], "abstract": "This work presents an interpretable decision-\nmaking framework for autonomous vehicles that integrates traf-\nfic regulations, norms, and safety guidelines comprehensively\nand enables seamless adaptation to different regions. While\ntraditional rule-based methods struggle to incorporate the full\nscope of traffic rules, we develop a Traffic Regulation Retrieval\n(TRR) Agent based on Retrieval-Augmented Generation (RAG)\nto automatically retrieve relevant traffic rules and guidelines\nfrom extensive regulation documents and relevant records based\non the ego vehicle's situation. Given the semantic complexity\nof the retrieved rules, we also design a reasoning module\npowered by a Large Language Model (LLM) to interpret\nthese rules, differentiate between mandatory rules and safety\nguidelines, and assess actions on legal compliance and safety.\nAdditionally, the reasoning is designed to be interpretable,\nenhancing both transparency and reliability. The framework\ndemonstrates robust performance on both hypothesized and\nreal-world cases across diverse scenarios, along with the ability\nto adapt to different regions with ease.", "sections": [{"title": "I. INTRODUCTION", "content": "utonomous driving has advanced significantly in recent\nyears, showing its promising potential for enhancing safety\nand efficiency, and is gradually being integrated into ev-\neryday life [1], [2], [3], [4], [5], [6]. For autonomous\nvehicles to seamlessly integrate into transportation systems\ndesigned for humans, they are expected to fulfill several key\nrequirements: (1) adhere to traffic rules (traffic regulations,\nlaws, and social norms) for humans; and (2) earn and\nmaintain public trust through transparent, safe, and reliable\noperations around humans. Based on these requirements, it\nis crucial that the decision-making process of autonomous\nsystems ensure compliance with traffic rules and adherence\nto safety guidelines. Additionally, ensuring that this rule-\naware decision-making process is interpretable is equally\nimportant. Interpretability is essential not only for identifying\nthe applicable rules but also for fostering trust and ensuring\naccountability for users.\nOne of the major challenges in achieving rule-aware\ndecision-making is the complexity of identifying which\nrules apply in a given driving situation. Traffic rules are\ndiverse and complex, encompassing thousands of regula-\ntions from laws, driving handbooks, or driving norms of\ndifferent regions. Among these traffic rules, the ego vehicle\nmust consider various factors, such as the actions of other\nroad users, current road conditions, and environmental con-\ntext-to identify the ones that are relevant to the specific\nscenario. Changes in any of these factors might require\ndifferent rules or a re-prioritization of existing ones. Previous\nefforts have focused on selecting key rules and creating\nhand-crafted decision-making rules [7], [8], [9], however,\nthis manual encoding approach struggles to handle a large\nnumber of traffic rules and cannot easily adapt to regulations\nin different regions without additional effort.\nAnother challenge in rule-aware decision-making is the\nsemantic complexity and context dependence of traffic rules,\nmaking accurate interpretation and compliance difficult for\nmodels. Traffic rules range from signage interpretation to\nspecific driving behaviors, necessitating varied integration\ninto decision-making processes. For instance, legal codes are\nstrict constraints, while local norms and safety guidelines\nmay require flexible applications based on context. There-\nfore, intelligently understanding and incorporating hand-\ncrafted rules into the decision-making system is crucial for\nautonomous vehicles' seamless integration into human traffic\nsystems. This is a challenging task for conventional AI\nsystems that are trained for specific tasks, but it becomes\npossible with the powerful comprehension and reasoning\ncapabilities of Large Language Models (LLMs).\nTo address these gaps, this paper introduces a novel in-\nterpretable decision maker for traffic rule compliance, which\nincorporates a Traffic Regulation Retrieval Agent built upon\nRetrieval-Augmented Generation (RAG) and a reasoning\nmodule using LLM, specifically GPT-40. The reasoning\nmodule assesses the actions on two levels: (1) whether\nthe action is compliant, meaning it follows all mandatory\ntraffic rules; and (2) whether the action is considered a safe\nbehavior, meaning it adheres to both mandatory traffic rules\nand safety guidelines. This dual-level assessment ensures\na comprehensive evaluation and decision making of both\nlegal compliance and adherence to safe driving practices.\nAdditionally, for enhanced interpretability, intermediate rea-\nsoning information, such as the traffic rules used in the\nreasoning process, is also output, providing transparency\nin the evaluator's decision-making process. Experiments are\nconducted on both hypothesized and real-world cases, with\nour framework consistently demonstrating robust results.\nOur contributions are summarized as follows:\n\u2022 We introduce a novel LLM-driven decision-making\nframework for autonomous vehicles that integrates traf-\nfic rules, featuring an interpretable Reasoning Agent"}, {"title": "II. RELATED WORK", "content": "arious techniques have been applied to integrate traf-\nfic regulations into autonomous driving systems. Early ap-\nproaches included rule-based systems [10] and finite state\nmachines [11], which encoded traffic laws through explicit if-\nthen rules or state transitions. To handle complex scenarios,\nmore sophisticated methods emerged: behavior trees created\nhierarchical decision-making structures capable of represent-\ning and executing traffic rules [12], and formal methods using\ntemporal logics like LTL or MTL provided rigorous frame-\nworks for specifying and verifying compliance with traffic\nlaws [13]. However, these methods often struggled with the\nambiguity and regional variations of real-world traffic rules,\nleading to challenges in creating autonomous vehicles that\ncould adapt to different regulatory environments.\nRecently, Large Language Models (LLMs) have demon-\nstrated remarkable capabilities in understanding natural lan-\nguage and interpreting complex scenarios [14], [15], [16],\n[17], [18], [19]. By leveraging these abilities, LLMs can pro-\ncess and integrate traffic rules in a more flexible and context-\naware manner, eliminating the need for rule-based encoding.\nFor example, LLaDA [20] utilizes LLMs to interpret traffic\nrules from local handbooks, enabling autonomous vehicles to\nadjust tasks and motion plans accordingly. Similarly, Agent-\nDriver [21] incorporates traffic rules into an LLM-based\ncognitive framework, storing and referencing them during\nplanning. However, ensuring LLMs accurately apply rele-\nvant traffic rules without hallucinations or misinterpretations\nremains a key challenge."}, {"title": "A. Traffic Regulation in Autonomous Driving", "content": "Retrieval-Augmented Generation (RAG) [22] addresses\nLLM hallucinations and improves information retrieval ac-\ncuracy by combining neural retrieval with a sequence-to-\nsequence generator, producing outputs based on relevant doc-\numents. Recent studies [23], [24] have demonstrated RAG's\neffectiveness in enhancing LLM accuracy and factual correct-\nness across domains like current events, language modeling,\nand open-domain question answering. These findings elicit\nRAG's potential for enhancing LLM-based autonomous driv-\ning systems' compliance with traffic regulations. Its dynamic\nretrieval capability [22] enables real-time access to region-\nspecific traffic rules, addressing the challenge of adapting\nto diverse regulatory environments. The enhanced factual\ngrounding provided by RAG [23] can reduce hallucinations\nin LLMs, mitigating the risk of fabricating or misapplying\ntraffic rules. RAG's ability to handle complex and contex-\ntual information [24] is well-suited for interpreting nuanced\ntraffic regulations with multiple conditions or exceptions.\nFurthermore, the transparency inherent in RAG's retrieval\nprocess can improve the interpretability of decision-making\nin autonomous driving systems, a crucial factor for regulatory\ncompliance and public trust."}, {"title": "B. Retrieval-Augmented Generation", "content": "Decision-making methods of autonomous driving have\nevolved from rule-based [25] to learning-based methods [26].\nLearning-based methods demonstrate greater adaptability\nthan the former in dynamic driving environments and free\nautonomous vehicles from the constraints of complex hand-\ncrafted rules. Two typical learning methods are imitation\nlearning (IL) and reinforcement learning (RL). The IL fo-\ncuses on imitating the expert's decision but faces different\ndistribution in online deployment [27], [28]. On the contrary,\nthe RL explores and learns in the online interaction [26],\n[29], but such trial-and-error is inefficient. Furthermore,\nGPT-Driver [30] introduced the GPT to the autonomous\nvehicle (AV), which reformulates the planning as a language\nmodeling problem. Nonetheless, in the human driving en-\nvironment structured by traffic rules, AVs not only need to\nensure safety but also follow these rules while driving with\nhuman-driven vehicles. The integration of diverse semantic\ntraffic rules into decision-making using a unified model\nremains underexplored."}, {"title": "C. Decision-Making of Autonomous Driving", "content": "ur proposed method, as shown in Fig. 1, comprises\ntwo main components: a Traffic Rules Retrieval Agent that\nretrieves relevant traffic rules from regulation documents\nusing a retrieval query, and a Reasoning Agent that assesses\nthe traffic rule adherence of each action in the action set\nbased on environment information, ego vehicle's state and\nretrieved traffic rules.\nWe first perform an environment analysis to generate the\nretrieval query for the Traffic Rules Retrieval Agent and\nprovide the environment information input for the Reasoning\nAgent. To extract more regulation-related features beyond\nthe common perception output, we use a Vision Language\nModel (VLM), GPT-40, to analyze the environment based\non the ego vehicle's camera images. The analysis follows\na carefully designed Chain-of-Thought (CoT) process: the\nVLM first performs a broad environment overview and\nchecks general road information, then it conducts a detailed\nanalysis concentrating on critical elements such as other\nroad users, traffic elements, and lane markings, especially\nthose relevant to the vehicle's global planning output (e.g.,\n'Right,' 'Left,' or 'Forward'). The VLM then generates a\nconcise retrieval query that summarizes the current scenario"}, {"title": "III. METHOD", "content": "for the Traffic Rules Retrieval Agent. An example output of\nEnvironment Analysis is shown in Fig. 3.\nWe extract an action set containing all possible actions\nfrom the Action Space based on the Global Planning output.\nFor simplicity and to maintain the focus of this work on\ntraffic rule adherence, the Action Space only consists of a\npredefined set of actions: turning right, turning left, going\nforward (with current speed, acceleration, or deceleration),\nchanging lane to the left, and changing lane to the right.\nThe extraction process selects the actions that align with the\nGlobal Planning output. For example, if the Global Planning\noutput is \"LEFT,\" the action set would include turning left\nwith current speed, an acceleration, or a deceleration."}, {"title": "A. Retrieval-Augmented Generation with Traffic Regulations", "content": "To enhance the model's understanding of localized traffic\nrules and norms, and to fully consider all the related rules\nfrom available sources, we developed the Traffic Regulation\nRetrieval (TRR) Agent, as illustrated in Fig. 2.\nSince different regions have varying sources of traffic\nrules, we take the United States as an example to demonstrate\nhow the TRR Agent fully considers available sources. Due\nto constitutional reasons, traffic regulations in the U.S. are\nset by each state rather than the federal government. Cities\nalso establish local rules for management. To ensure com-\nprehensive coverage, the TRR includes both state and local\nregulations. Additionally, case laws that provide reference\nfor the U.S. judiciary systems and driving manuals that\nprovide extra safety guidelines along with regulations are\nalso considered as important sources and are included in the\nTRR. Therefore we design TRR with an integration of a\ncomprehensive collection of regulatory documents as below:\nState-Level Traffic Law: Laws regulate vehicle opera-\ntions and ensure road safety established by state legislatures\nand enforced statewide.\nState-Level Driving Manual: Published by each state's\nDMV, this manual details state traffic laws and safe driving\npractices. It includes driving safety guidelines in the form of\ntext and illustration images.\nCity-Level Traffic Regulation: Set by local governments,\nrules to address specific needs such as parking, speed limits,\nand lane usage to manage local traffic and ensure safety.\nState-Level Court Cases: Judicial rulings on traffic-\nrelated cases clarify laws and influence enforcement.\nTraffic Norms: Widely recognized behaviors that drivers\nfollow to ensure smooth and safe road interactions. These\nnorms are essential for autonomous vehicles to align with\nhuman driving behaviors and societal expectations. This\npaper does not focus on building a repository of records for\nsuch norms but we will use examples to illustrate that our\nframework still applies.\nUpon evaluating retrieval performance against traditional\ninverted index-based retrieval methods relying on keyword\ninputs such as BM25 [31] and Taily [32], we found that\nembedding-based algorithms, which utilize informative long\nqueries and retrieve based on paragraph similarity, signifi-\ncantly outperform in terms of completeness and efficiency.\nIntegrated into the TRR Agent, embedding-based methods\nhandle the complexities of driving scenarios more effectively.\nEach document or record is reformatted into markdown\nwith hierarchical headers to improve clarity, enabling better\ninterpretation by the subsequent Reasoning Agent. In ad-\ndition to textual content, figures, especially widely used in\nstate-level handbooks, which clarify regulations with visual\nexamples, are integrated into the TRR Agent. This integra-\ntion is particularly important when regulatory details are\nembedded in images but are not explicitly described in the\naccompanying text. To address this, figures are transformed\ninto text labels and appended at the end of the relevant\nparagraphs, and appropriately restored at the end of the\nretrieval process.\nDuring the retrieval process, we first produce vector em-\nbeddings for both the regulatory documents and the previ-"}, {"title": "B. Reasoning Agent", "content": "ously generated traffic rule retrieval query, and then apply\nFAISS similarity search [33] to determine their relevance. A\ncascading retrieval pipeline from paragraph-level to sentence-\nlevel helps ensure that the results are both comprehensive\nand concise. After paragraph-level embeddings across the\nentire data source, a top-k selection is applied to choose the\nmost relevant paragraphs, forming a new niche database. To\naddress the sparsity issue that can affect search accuracy due\nto the large size of the tokenized traffic book, we re-embed\nthe selected paragraphs at the sentence level. This second-\nlevel embedding provides better, more accurate indexing and\nsearching capabilities by focusing on the most pertinent\nsections. This approach allows for dynamic adaptation by\nprioritizing the relevance of available regulations.\nIn the end, the TRR Agent aggregates the selected sen-\ntences from traffic regulation and state-level laws, rules from\ncity regulations, and court cases will be combined together\nas well as the attribute images to produce a comprehensive\nresult which is later provided to the Reasoning Agent."}, {"title": "IV. EXPERIMENTS", "content": "The Reasoning Agent is responsible for determining\nwhether each action in the action set complies with traffic\nrules, leveraging an LLM (GPT-40) with a CoT prompting\nmethod. The Reasoning Agent receives three key inputs: (1)\nthe current environment information from the environment\nanalysis (2) ego vehicle's action set, and (3) a set of retrieved\ntraffic rules from TRR Agent.\nIn the reasoning process, the agent first filters the retrieved\ntraffic rules to identify those that are most applicable to both\nthe current situation and the ego vehicle's intended action.\nThese rules are then categorized into either mandatory rules,\nwhich must be followed to ensure legal compliance, or safety\nguidelines, which represent best practices that, while not\nlegally required, are advisable for optimal driving behavior.\nThe Reasoning Agent proceeds to check for compliance\nwith mandatory rules. If the current action violates any\nmandatory rule, the agent concludes that the action is non-\ncompliant; otherwise, it is marked as compliant. The model\nthen evaluates safety by checking both mandatory rules and\nsafety guidelines, if any safety guidelines are retrieved. If the\naction complies with both, it is marked as safe; otherwise, it\nis marked as unsafe.\nThe Reasoning Agent outputs a binary compliance and\nsafety decision for each action in the action set, along with\na clear explanation referencing each applicable rule, detailing\nwhy the action complies or does not comply to increase the\ninterpretability of the reasoning process. The framework then\nselects the actions that are marked as both compliant and safe\nas the final output for decision-making. An example output\nof the Reasoning Agent is shown in Fig. 3."}, {"title": "A. Traffic Regulation Retrieval (TRR) Agent and RAG", "content": "To validate our proposed method and access its effec-\ntiveness in leveraging regulation for decision-making, we\ndevelop a comprehensive benchmark that contains hypoth-\nesized and real-world scenarios as depicted in Fig. 3. Hy-\npothesized scenarios offer greater diversity, while real-world\ndata experiment demonstrates the framework's practical per-\nformance in real driving conditions. We primarily evaluated\nscenarios in the region of Boston City."}, {"title": "B. Hypothesized Scenarios", "content": "The document collection we used in the TRR Agent\nfollows the architecture shown in Fig. 2 includes:\nBoston City Traffic Rules and Regulations: Article IV\n(One-Way Regulations) and V (Operation of Vehicles).\nMassachusetts State General Law: Chapter 89 (Law of\nthe road), section 1 to section 12.\nMassachusetts State Driver's Manual: Chapter 4 (Rules\nof the Road) and Chapter 5 (Special Driving Situations).\nMassachusetts State Selected Court Cases: Twelve se-\nlected traffic violation cases among the state.\nSelected US Traffic Norms: Ten selected driving norms\nwithout regulation violation.\nWe used the model \u201ctext-embedding-ada-002\u201d from Ope-\nnAI for the paragraph level retrieval with a threshold of 0.28\nand \u201cparaphrase-MiniLM-L6-v2\u201d from SentenceTransform-\ners [34] for the sentence level retrieval and collected top-5\nretrieved sentences."}, {"title": "C. Real-world Scenarios", "content": "The hypothesized scenarios, described in text format, in-\nclude 30 situations that cover both common scenes-such as\nturning or passing intersections\u2014and rare cases like passing\na stopped school bus on a divided road or yielding to\nan emergency vehicle approaching from behind, which are\ngenerally not covered by real-world datasets. These scenarios\nwere identified manually by the researchers by reviewing\nBoston's regulation codes and driving manual, as they are\npotentially challenging for human or autonomous drivers.\nWe assessed our framework's performance across 30 hy-\npothesized scenarios, with and without data from the TRR\nAgent, shown in Fig. 4. In scenarios lacking specific local\nregulations or reliant on traffic norms, the LLM effectively\nuses its extensive pretrained knowledge to make correct deci-\nsions. However, in scenarios requiring adherence to detailed\ncity-level or state-level regulations or judicial precedents,\nLLM alone is inadequate for ensuring safety. Incorporating\nTRR Agent, which includes localized regulations and judicial\ndecisions, improves scenario-action reasoning accuracy from\n82% to 100% and decision-making accuracy from 76% to\n100% across these scenarios. This highlights the importance\nof integrating comprehensive legal and judicial information\ninto the LLM framework to effectively tackle complex real-\nworld driving situations."}, {"title": "V. CONCLUSION", "content": "To evaluate our framework's performance on real-world\ndata, we tested it on the nuScenes dataset [35], a real-world\nautonomous driving dataset that provides annotated sensor\ndata from urban driving scenes collected in Boston and Sin-\ngapore. Since it is not designed for traffic regulation-related\ntasks, it does not contain traffic rule annotations. To address\nthis, we manually reviewed the camera images and selected\nsamples with a strong relevance to traffic regulations, where\nthe actions are more constrained or influenced by traffic rules.\nFor each sample, we annotated compliance and safety labels\nfor actions in the action set, identifying the compliant and\nsafe action as the ground truth for decision-making output.\nTo ensure a meaningful evaluation and avoid unbalance due\nto repeated or overly similar scenarios, we carefully selected\nsamples where either different traffic rules applied or there\nwere variations in how the same rule was applied due to\nscenario-specific factors directly related to the regulation. As\na result, we identified 17 diverse samples from the validation\nset for evaluation, and our model produced correct outputs\nfor 15 out of the 17 samples, along with accurate reasoning.\nIn Fig. 6, we demonstrate a case in Singapore to show\nthat our model can adapt to different regions with ease.\nIn this scenario, the ego vehicle attempts to turn right at\na red traffic light. While right turns on red are legal in\nBoston, they are illegal in Singapore. As shown, our model\ncorrectly outputs \u201cnon-compliant,\u201d aligning with Singapore's\ntraffic regulations. Unlike previous rule-based approaches,\nwhich require re-creating rules for each new region, our\nmodel seamlessly adapts to the new scenario by simply\nswitching the traffic regulation documents from Boston's to\nSingapore's."}, {"title": "CONCLUSION", "content": "This paper introduces an interpretable LLM-driven, traffic\nrules-aware decision-making framework that integrates a\nTraffic Rules Retrieval (TRR) Agent and a Reasoning Agent.\nExperiments conducted on both hypothesized and real-world\nscenarios confirm the strong performance of our approach\nand its seamless adaptation to different regions. We believe\nthis framework will markedly improve vehicle safety and\nreliability in autonomous driving systems, enhancing trust\namong regulators and the public. Future work will expand\nthe testing of the framework to more regions and diversify\nour test scenarios. Additionally, developing a comprehensive\nreal-world dataset for traffic rule-related tasks is important\nfor future research and advancements in the field."}]}