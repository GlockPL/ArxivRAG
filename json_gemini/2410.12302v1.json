{"title": "Two Birds with One Stone: Multi-Task Semantic Communications Systems over Relay Channel", "authors": ["Yujie Cao", "Tong Wu", "Zhiyong Chen", "Yin Xu", "Meixia Tao", "Wenjun Zhang"], "abstract": "In this paper, we propose a novel multi-task, multi-link relay semantic communications (MTML-RSC) scheme that enables the destination node to simultaneously perform image reconstruction and classification with one transmission from the source node. In the MTML-RSC scheme, the source node broadcasts a signal using semantic communications, and the relay node forwards the signal to the destination. We analyze the coupling relationship between the two tasks and the two links (source-to-relay and source-to-destination) and design a semantic-focused forward method for the relay node, where it selectively forwards only the semantics of the relevant class while ignoring others. At the destination, the node combines signals from both the source node and the relay node to perform classification, and then uses the classification result to assist in decoding the signal from the relay node for image reconstructing. Experimental results demonstrate that the proposed MTML-RSC scheme achieves significant performance gains, e.g., 1.73 dB improvement in peak-signal-to-noise ratio (PSNR) for image reconstruction and increasing the accuracy from 64.89% to 70.31% for classification.", "sections": [{"title": "I. INTRODUCTION", "content": "With the rapid advancement of artificial intelligence (AI), semantic communications have recently garnered significant attention, as they represent the second level of information transmission outlined by Shannon and Weaver [1]. This paradigm shift in communications moves the focus from the accurately conveying symbols to effectively transmitting the intended meaning. By employing AI to extract and transmit the semantic essence of the source data, semantic communications significantly enhance the efficiency of the communication process. Consequently, semantic communications are regarded as a promising approach to fulfilling the demanding specifications of sixth-generation (6G) wireless networks [2].\nPrevious studies have explored various scenarios in se-mantic communications [3]\u2013[6]. Three key works focus on the foundational design of joint source-channel coding (JSCC) for semantic communications. In [4], DeepJSCC is introduced for image transmission based on convolutional neural networks (CNNs), aiming to optimize performance. An enhanced version, SwinJSCC, is later proposed in [5], incorporating advanced Transformer modules. More recently, MambaJSCC, a lightweight and efficient deep JSCC archi-tecture for wireless image transmission, was developed in [6] based on selective structure state space models (SSM). Building on these works, research on multi-task semantic communications has advanced in [7]\u2013[9]. In [7], additional decoder heads are introduced to handle different tasks, while [8] proposes a Feature Importance Ranking module to assess the impact of each feature on task performance. Moreover, [9] divides the features into shared and private groups for each task, allowing the node to selectively transmit features, thereby improving efficiency.\nIn practice, communication via a relay node is common, as direct communication between distant parties often suffers from poor signal quality. Unlike the traditional amplify-and-forward (AF) and decode-and-forward (DF) methods, [10] introduces the semantic-and-forward (SF) approach for semantic communications, where the relay first interprets and then forwards semantic information. This approach has been further developed in works such as [11]\u2013[15]. Due to the broadcasting nature of the source node's transmission, the signal can also reach the destination node through the direct source-destination (SD) link. Although the SD link typically has lower quality, it still provides valuable information that can enhance performance, for example, by using traditional maximum ratio combining (MAP) techniques, which are often overlooked in existing studies. Only one study [16] explores the use of the SD link in semantic relay commu-nication, where the destination node employs a semantic combining method to integrate signals from both the SD link and the relay-destination (RD) link. However, this study focuses solely on text transmission and lacks a specialized design for multi-task communication.\nMotivated by this, we propose a multi-task, multi-link relay communications (MTML-RSC) scheme that enables the destination node to simultaneously perform image re-construction and classification with a single transmission from the source node. We analyze the characteristics of the two tasks, noting that classification requires significantly less information than reconstruction, allowing it to be com-pleted with high quality via the direct link. Additionally, the classification result can be served as side information, guiding and improving the reconstruction process. Therefore, we propose a semantic-focused forward mode at the relay node in the proposed MTML-RSC scheme, where the relay extracts and forwards the semantics of specific classes while disregarding the semantics of irrelevant classes. Furthermore, the improved reconstruction can also enhance classification by providing more accurate semantic information. Based on this, the destination node combines signals from both the source and relay nodes to perform classification, then leverages the classification result to aid in decoding the relay signal for image reconstructing. Experimental results show that the proposed MTML-RSC scheme delivers notable performance improvements, e.g., a 1.73 dB boost in peak signal-to-noise ratio (PSNR) for image reconstruction and a rise in classification accuracy from 64.89% to 70.31%."}, {"title": "II. SYSTEM MODEL", "content": "In this section, we propose our MTML-RSC scheme for both image reconstruction and classification under the relay channel, combining the direct link.\nOur scheme consists of three nodes: the source node, the relay node, and the destination node as shown in Fig. 1.\n1) Source node: The source node is composed of a JSCC encoder to extract and encode the source image $s \\in \\mathbb{R}^{3\\times H \\times W}$ to the channel input signal $x^s \\in \\mathbb{C}^{n\\times\\frac{I}{2}}$ with power constraint $E||x^s|| < P_s$, where the $H, W$ is the height and weight of the image and 3 represents the color channel R, G and B. $I$ denotes the total length of the real and imaginary part of the complex channel input signal and n denotes the signal patches. The JSCC encoder model consists of two stages with Swin Transformer as its backbone modules. In the first stage, the source image is transformed to $c_1$ learnable patches with size $h_1 x w_1$ by the patch embedding module and then $n_1$ Swin Transformer modules are applied to these patches to furtherly learn the effective representation of these patch with their number and size unchanged. The output patches are then fed into the second stage, comprising a downsampling patch merging module, outputting $c_0$ patches with size $h_0 \\times w_0$, and additional $n_0$ Swin Transformer modules. Finally, a fully connected (FC) module is applied on these patches, followed by power normalization for the channel input signal. The signal $x^s$ is then broadcasted to both the relay node and the destination node under the source-raley (SR) and SD links.\n2) Relay node: The relay node applies our proposed semantic-focused forward, which is composed of a JSCC decoder, a classifier, and a classification-aided JSCC encoder. The JSCC decoder reconstructs the image as $\\hat{s}^r \\in \\mathbb{R}^{3\\times H \\times W}$ from $y^r$, followed by the classifier performing label $z^r$ to the reconstructed image. After that, a classification-aided JSCC encoder takes the $\\hat{s}^r$, along with $z^r$, as input to recode the image as $x^r \\in \\mathbb{C}^{n\\times\\frac{I}{2}}$ for forwarding to the destination through RD link with power constraint $E||x^r||^2 \\leq P_r$.\nThe JSCC decoder has a symmetrical structure to the encoder, which also consists of two stages with Swin Trans-former as its backbone module. Firstly, an FC module is applied to expand the received signal to $c_2$ patches with size $h_2 \\times w_2$. The output patches are then fed into stage 2, which comprises $n_2$ Swin Transformer modules and an upsampling patch division module, outputting $c_3$ patches with size $h_3 \\times w_3$. In stage 1, $n_3$ Swin Transformer modules are applied to these patches to further learn the effective representation of these patches with their number and size unchanged. These patches are then passed through an upsam-pling patch division module, followed by a reshaping process to reconstruct the source image.\n3) Destination node: The destination node applies the proposed multi-link combining receiving, which is composed of a classification-aided JSCC decoder, a classifier, and a mutual attention module. Firstly, the mutual attention module integrates $y^d$ and $y^f$ from the two links into a fused signal $y$, followed by the classifier performing label $z^d$ from $y$. After that, a classification-aided JSCC decoder takes the $y^f$ and $z^d$ as input to reconstruct the source image as $\\hat{s}^d \\in \\mathbb{R}^{3\\times H \\times W}$."}, {"title": "B. Channel model", "content": "Typically, we consider the links to be Rayleigh fading with different SNR and large-scale fading. Therefore, the i-th element of received signals at the relay node $y^r$ and destination node $y^d$ obtained from the SR link and the SD link can be expressed respectively as\n$y^r_i = d_{SR}h_ix^s_i + n^r_i,$\n(1)\n$y^d_i = d_{SD}h_ix^s_i + n^d_i,$\n(2)\nwhere $h_i^r, h_i^d \\sim \\mathcal{CN}(0,1)$ are independent and identically distributed (i.i.d.) Rayleigh fading gains, $d_{SR}$ and $d_{SD}$ are the distance of the SR link and SD link, $n_i^r$ and $n_i^d$ are i.i.d. Additive White Gaussian Noise (AWGN) samples with variance $\\sigma_r^2$ and $\\sigma_d^2$, and $\\alpha$ is the large-scale fading exponent. Here we set $d_{SR} < d_{SD}$ and $\\sigma_r^2 \\leq \\sigma_d^2$, reflecting the typical relay scenario that the channel condition the SR link is superior to that of the SD link.\nAnalogous to the preceding links, the i-th element of received signal $y^f$ from the RD link can be expressed as\n$y^f_i = d_{RD}h_ix^r_i + n^f_i,$\n(3)\nwhere $h_i^f \\sim \\mathcal{CN}(0,1)$ are i.i.d Rayleigh fading gain of RD link, $d_{RD}$ is distance between them, $n_i^f$ is i.i.d AWGN sample with variance $\\sigma_f^2$. The RD link is also better than the SD link as the common scenario in relay communications such that $\\sigma_f^2 < \\sigma_r^2$ and $d_{RD} < d_{SD}$. We also consider the AWGN channel with large-scale fading, where the Rayleigh fading gains $h_i^r, h_i^d, h_i^f$ are ignored as constant 1."}, {"title": "III. RELAY AND RECEIVER DESIGN", "content": "In this section, we provide a detailed illustration of the proposed semantic-focused forward and the multi-link com-bining receiving technologies.\nAs previously discussed, the destination node receives both the forwarded signal and the broadcasted signal through the RD and SD links. Although the signal experiencing from SD link is severely degraded compared to that from the RD link, the destination node can still understand some semantic information from it. Therefore, the relay node is required to selectively forward the semantic information that remains ambiguous to the destination node only from SD link to utilize the RD link more effectively. However, this poses a challenge, as the relay node has no knowledge of the semantics which the destination node has understood through the SD link. To address the problem, we first analyze the characteristics of the classification and reconstruction tasks to provide prior knowledge for the relay node.\nOn one hand, the two tasks are interrelated, as better reconstruction includes the better recovery of class features, leading to more accurate classification, and accurate classi-fication can also guide to understand the semantic for better reconstruction. On the other hand, the two tasks require distinct amounts of information, with accurate classifica-tion needing significantly less information than high-quality reconstruction. Based on the observation, we assume that the destination node can understand the classification-related semantics through the degraded SD link. Thus, the relay node can concentrate on the semantics of relevant class, preserving transmission capacity of the RD link for reconstruction.\nBased on the above analysis, we propose a semantic-focused forward relay mode, where the relay node first decodes the received signal for reconstruction, followed by a classifier recognizing the image class. After that, the class-aided JSCC encoder focuses on re-encoding and forwarding the specific semantics of this class, while the semantics of other classes are ignored. Thus, in the semantic-focused forward, only the most relevant semantics to the class are forwarded, while the semantic of other class are ignored, thus enhancing coding efficiency for enhanced performance.\nRemark 1. The improvement in the transmission quality and performance can be understood through the perspective of entropy. It is well known that in our scenario, the entropy of the reconstructed image at the relay node under the condition of its class is always less or equal to its entropy, which can be expressed as\n$H(\\hat{s}^r|z^r) < H(\\hat{s}^r)$.\n(4)\nTherefore, in the semantic-focused forward mode, the in-formation expected to be coded and forwarded is reduced. The reduced part is acquired through the SD link, thus avoiding redundant information transmission for enhancing the transmission efficiency.\nThe semantic-focused forward is achieved by the classifier and the designed class-aided JSCC encoder. The classifier takes the reconstructed image $\\hat{s}^r$ as input and extracts it feature through the similar architecture of the JSCC encoder, except that the mean of the output from the final stage is pro-cessed by a multi-layer perceptron (MLP) for classification."}, {"title": "B. Multi-link combining receiving", "content": "In cooperation with the semantic-focused forward, the destination node is required to recognize the class from the SD link. Moreover, based on the analysis that the two tasks are benefitial to each other. Therefore, it is better to combine the signals from both links for classification. On the other hand, the source image should be reconstructed using the signal from the RD link, with class information acquired from the classification task. Thus, the reconstruction task is completed after the classification task for combining the classification result. Based on this analysis, we propose a multi-link combining receiving, where the signal from both SD and RD links are received as real number with n patches of length I and combined by the designed mutual attention module, which maps the n signal groups with size l from the SD link to $K_j, V_j, j = 1,2,...,n$ by 2n FC modules and then signal groups from the RD link are projected to $Q_j$ by another n FC modules. Then the softmax multi-head attention is adopted to them as\n$y = \\text{softmax}(\\frac{Q_jK_j^T}{\\sqrt{I}})V_j$.\n(5)\nThese n outputs are then concentrated and addressed by another FC as final output $y \\in \\mathbb{R}^{n\\times l}$. $y$ is then fed into the classifier for classification. After classification, the class-aided JSCC decoder combined the classifier output $z^d$ and the signal from the RD link to reconstruct the source image. The class-aided JSCC decoder consist of the symmetrical architecture of the class-aided JSCC encoder as shown in Fig. 2(b), while the label attention module only exists at the end of the second stage. The combined reconstruction process ensures that the decoder is synchronized with the encoder, allowing them to focus on the same class for improving reconstruction quality."}, {"title": "C. Training algorithm", "content": "In the new architecture, the entire training algorithm is divided into three stages. In the first stage, the JSCC encoder at the source node and the JSCC decoder at the relay node are trained. In the second stage, the classifier at the relay node is trained. In the third stage, the class-aided JSCC encoder at the relay node, the class-aided JSCC decoder at the destination node, the classifier, and the mutual attention module are jointly trained.\nDuring the first stage, the mean squared error (MSE) is used as the loss function, based on the input souce s and the reconstruction $\\hat{s}^r$. the loss function can be expressed as\n$\\mathcal{L}_1(s, \\hat{s}^r) = E_{s \\sim p(s)} ||s - \\hat{s}^r||_2,$\n(6)\nwhere $p(s)$ represents the distribution of s. The objective is to enable the relay node to recover the original image through semantic communications.\nIn the second stage, the classifier at the relay node is trained independently with the reconstructed image as input to avoid influence the performance of reconstruction arising from the balance of the two tasks. When training the clas-sifier, cross-entropy is used as the performance metric, and the loss function can be formulated as\n$\\mathcal{L}_2(p_{\\hat{s}^r}(z^r), q_{\\hat{s}^r}(z^r)) = -E_{\\hat{s}^r \\sim p(\\hat{s}^r)} [p_{\\hat{s}^r}(z^r) \\log q_{\\hat{s}^r}(z^r)],$\n(7)\nwhere $p_{\\hat{s}^r}(z^r)$ denotes the true probability distribution of the class label of the images in the distribution $p(\\hat{s}^r)$, and $q_{\\hat{s}^r}(z^r)$ represents the predicted probability distribution by the classifier in the relay node.\nThe third stage involves multi-task joint training, which includes both the recovery of the original image and the target classification. Therefore, our performance metric is the weighted sum of MSE and cross-entropy, and the loss function can be formulated as\n$\\mathcal{L}_3(S, \\hat{s}^d, p_{y^d,y^f}(z^d), q_{y^d,y^f}(z^d)) = \\mathcal{L}_1(s, \\hat{s}^d) + \\lambda\\mathcal{L}_2(p_{y^d,y^f}(z^d), q_{y^d,y^f}(z^d)),$\n(8)\nwhere $\\lambda$ represents the weight assigned to the classification task. It should be noted that during the training process, the class label input to the class-aided JSCC is the true label of the image, and after training, the predicted labels output by the classifiers are used for transmission. This is because the predictions may be incorrect, and during the training process, it is necessary to ensure that the class-aided JSCC has the correct information about the true label to learn the correct semantics for better performance. In practice, the true label is difficult to obtain, so only the predicted labels can be input into the class-aided JSCC. The training algorithm is summarized in Algorithm 1."}, {"title": "IV. EXPERIMENTS RESULTS", "content": "In this section, we present the detailed experimental setup and results to validate the effectiveness of our scheme.\nIn our experiments, we adopt the STL10 dataset with 10 classes, where each class contains 500 images for training and 800 images for evaluation. The images come from the famous and widely adopted ImageNet dataset with size 96 \u00d7 96. For the position of the three nodes, we adopt a normalized distance with $d_{SD} = 1$ and $d_{SR} + d_{RD} = 1$ with their values in the range from 0 to 1. Also, we control $P_s = P_r$ and set $\\sigma_{SR} = \\sigma_{RD} = \\sigma_{SD}$ for clarity. In this way, the signal-to-noise ratio (SNR) is defined as $SNR = 10\\log_{10}(\\frac{P_s}{\\sigma_{SD}^2})$.\nAdditionally, we employ a minimum mean square error (MMSE) equalizer to process the signals transmitted over a Rayleigh fading channel. We take the scheme with only the relay link as the baseline, which has the same architecture as our MTML-RSC except the mutual attention module at the destination node and the classifier at the relay node."}, {"title": "V. CONCLUSION", "content": "In this paper, we propose the MTML-RSC scheme for relay semantic communications to combine the direct link and the relay link for enhancing image reconstruction quality and classification accuracy simultaneously. We reveal that the two tasks can benefit each other and also classification requires significantly less information than reconstruction. Thereby, we proposed a semantic-focused forward, which utilizes the designed classifier-aided JSCC encoder to extract and transmit the semantics of the focused class. Further-more, the destination node applies the proposed multi-link combining receiving, where the signals from both links are combined through the mutual attention module for classifica-tion, which then guides the focus of the class-aided decoder for reconstruction. Experimental results illustrate that the proposed MTML-RSC achieves significant gains in PSNR and accuracy simultaneously, proving the effective utilization of the direct link."}]}