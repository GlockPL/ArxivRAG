{"title": "Hierarchical Classification for Automated Image Annotation of Coral Reef Benthic Structures", "authors": ["C\u00e9lia Blondin", "Joris Gu\u00e9rin", "Kelly Inagaki", "Guilherme Longo", "Laure Berti-\u00c9quille"], "abstract": "Automated benthic image annotation is crucial to efficiently monitor and protect coral reefs against climate change. Current machine learning approaches fail to capture the hierarchical nature of benthic organisms covering reef substrata, i.e., coral taxonomic levels and health condition. To address this limitation, we propose to annotate benthic images using hierarchical classification. Experiments on a custom dataset from a Northeast Brazilian coral reef show that our approach outperforms flat classifiers, improving both F1 and hierarchical F1 scores by approximately 2% across varying amounts of training data. In addition, this hierarchical method aligns more closely with ecological objectives.", "sections": [{"title": "Introduction", "content": "Coral reefs host around 25% of global marine species [1] and provide vital ecosystem services for coastal populations, including maintaining fish stocks, protecting shorelines from waves, and fostering tourism [2]. Despite their importance, these ecosystems are facing unprecedented threats from climate change [3] as illustrated by the increasing frequency of coral bleaching events [4]. In response to these challenges, comprehensive coral reef surveying and monitoring have become essential for implementing appropriate and timely conservation actions [5].\nBenthic monitoring focuses on measuring seafloor coverage by various organisms, especially corals [6]. Over the past decades, monitoring programs have shifted from direct underwater measurements to photographic methods [7], creating lasting records and significantly reducing underwater time. Traditionally, collected images were annotated manually using specialized software, involving sampling random points and labeling them with their benthic categories (Figure 1). These annotations serve to calculate cover proportions, which are essential for coral monitoring.\nHowever, manual annotation is time-consuming, which can delay the availability of survey results, and can introduce bias due to differences between analysts [8]. To address this, platforms like CoralNet [9] use deep learning for automatic annotation [10]. Small pixel patches (typically 224x224) are extracted around each point and the problem of point annotation is addressed as an image classification task (Figure 1). This way, ecologists only need to manually annotate a small subset of images, which are used to train a neural network capable of automatically annotating the remaining images.\nDuring our collaboration between data scientists and marine ecologists, we identified a misalignment between Machine Learning (ML) approaches and ecological needs. Current models use detailed labels encompassing various taxonomic levels and coral health status. For instance, a point labeled as \"Bleached Palythoa\" simultaneously conveys information about coral type, genus, and health status (Figure 2). However, in practice, ecologists often need to aggregate these labels differently to compute cover proportions of macro groups, e.g., grouping all corals regardless of species or health.\nFlat classification presents challenges for underrepresented categories, which often lack sufficient labeled data for accurate classification at such a high level of detail. To address this issue, we"}, {"title": "Methodology", "content": "Hierarchical Classification (HC) consists in organizing classes into a hierarchy, represented as a tree [13, 11] (Figure 2). This structure reflects the natural relationships between classes, with general categories at higher levels and specific subcategories at lower levels. Two main approaches exist: local approaches, often called \"top-down\", train separate classifiers for each node of the hierarchy, while global approaches build a single, comprehensive model considering the entire hierarchy simultaneously. In this paper, we evaluate the potential of top-down HC for benthic image annotation."}, {"title": "Building the Hierachy", "content": "Implementing HC for coral images requires a paradigm shift in how the label set is designed. Marine ecologists must establish a classification tree representing the taxonomic hierarchy, rather than a flat set of labels. Building an HC tree requires answering several design questions: Can a prediction be composed of multiple labels? Can multiple path lead to the same label? Can predictions stop at intermediate nodes? As the goal of this work is to validate the relevance of HC for benthic image annotation, we choose the most simple tree design possible where the final prediction is always a single leaf node, and there is only one path to each label. The tree (Appendix A) was designed in a collaboration between an ML expert and a marine ecologist to ensure both computational constraints and biological relevance are respected. While this initial step represents an additional effort, it helps aligning the annotation process with biological classification principles and facilitates subsequent ecological analyses involving grouping labels at various taxonomic levels."}, {"title": "Hierarchical Classifier", "content": "The first step to annotate an image is to extract 224x224 patches around the annotation points. Each patch is passed through the CoralNet backbone, an EfficientNet B0 pre-trained on 16 million benthic images [10], to extract features. Then, a top-down hierarchical classifier is implemented. We use the hiclass library [14] and train a Local Classifier per Parent Node approach. This approach consist of using an independent classifier for each non-leaf node. In our case, we use MLPs with two hidden layers (200 and 100 neurons) as the individual node classifiers."}, {"title": "Experiments", "content": "This section presents the experiments conducted to assess the potential of HC for benthic image annotation. We provide a detailed Github repository to reproduce our results\u00b9."}, {"title": "Experimental Setup", "content": ""}, {"title": "Dataset", "content": "For the experiments, we used a custom dataset, collected and annotated by the Marine Ecology Laboratory/UFRN, at Rio do Fogo, Northeast Brazil. Between 2017 and 2022, 100 images were collected from 2 sites every 3 months. We utilized a subset of 1,549 images, each annotated with 25 random points, resulting in 38,725 annotations. The dataset contains 54 distinct labels, which are highly imbalanced \u2013 11 labels account for 95% of the annotations, while 24 classes count less than 20 annotations. The distribution of annotate patches is detailed in Appendix B. We created a test set by randomly selecting 10% of the dataset, maintaining the overall class distribution. Test patches were chosen independently, without considering image-level coherence."}, {"title": "Baseline", "content": "Current approaches typically train a flat classifier with a large set of labels corresponding to all leaf nodes [10]. Ecologists can subsequently group these labels to calculate the cover of super-classes, such as \"all corals\" [15]. This post-hoc grouping task can be viewed as \u201cbottom-up\" hierarchical classification. In this work, we compare a traditional bottom-up approach \u2013 MLP with 2 hidden layers (200, 100) \u2013 against the proposed top-down approach, which considers the hierarchy during training."}, {"title": "Evaluation Metrics", "content": "Traditional benthic image annotation approaches employ standard classification metrics (e.g., accuracy, precision, recall, F1-score), evaluating a model's ability to make perfect predictions across all taxonomic levels. However, considering the hierarchical nature of benthic classifications, not all misclassifications have equal ecological significance. For instance, misclassifying a Bleached Palythoa as a non-bleached Palythoa has less impact on derived ecological metrics than misclassifying it as Algae. The former error affects only leaf-node accuracy, while the latter affects cover estimates at all levels. To address this nuance, we use Hierarchical Classification (HC) metrics [12], which account for the varying severity of classification errors based on their position in the hierarchy. In our study, we compare top-down and bottom-up approaches using both the traditional F1-score (F1) and the hierarchical F1-score (hF1). This dual evaluation allows us to assess the impact of incorporating hierarchical information during training on both perfect label prediction and partially accurate predictions. By doing so, we aim to provide a more comprehensive evaluation that aligns with the hierarchical nature of benthic classification and its ecological implications."}, {"title": "Results", "content": "Our experimental results are displayed in Figure 3, where we compare the F1-score and hierarchical F1-score for the flat and hierarchical classifiers when the number of training patches increases. It shows that the hierarchical classifier always outperforms the flat classifier, with performance gains ranging from 1% (for small training sets) to 2% (for larger sets).\nInterestingly, the performance gap between the two approaches remains similar for the hierarchical F1-score, contrary to our expectation that this metric would more severely penalize errors early in the tree structure for the flat classifier. This suggests that the flat classifier may implicitly capture some of the hierarchical relationships between classes. If the flat classifier were making largely implausible errors, we would expect a more substantial difference in the hierarchical F1-score."}, {"title": "Conclusion", "content": "In this work, we investigated the potential benefits of using hierarchical classification for benthic image annotation. Our experimental results indicate that HC outperforms traditional flat classifiers across both flat and hierarchical metrics. However, the flat classifier is more robust than anticipated to hierarchical F1-score, possibly due to its ability to learn some inherent class relationships. Further investigation into the specific types of errors made by each classifier could provide additional insights into their respective strengths and limitations.\nTo gain a deeper understanding of the performance of HC for benthic image annotation, we plan to apply this methodology to other datasets to contextualize these results and assess their significance. For instance, the Moorea Labeled Corals dataset [16] contains a larger number of annotations and a simpler hierarchical structure, which could provide additional insights.\nAlthough building the tree represents an additional effort, it enables better consideration of the labels used, avoids overlapping categories or unnecessary labels, and facilitates subsequent ecological analyses, which often involve grouping labels at various taxonomic levels. To alleviate the workload of tree construction, a promising research direction to improve our approach is to investigate how this process can be automated and refined to enhance class discrimination [17]. Additionally, exploring alternative hierarchical classification methods, such as global HC, could represent a valuable contribution.\nFinally, while our results demonstrate the potential of HC, the modest performance gains (2%) necessitate careful consideration of the trade-off between improved accuracy and increased computational costs associated with training and inferring with multiple classifiers in a hierarchical setups. This balance will be crucial in determining the applicability of HC in benthic image annotation tasks."}]}