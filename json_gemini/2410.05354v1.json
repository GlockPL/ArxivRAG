{"title": "Over-the-Air Federated Learning in Cell-Free MIMO with Long-term Power Constraint", "authors": ["Yifan Wang", "Cheng Zhang", "Yuandon Zhuang", "XX XX", "Yongming Huang"], "abstract": "Wireless networks supporting artificial intelligence have gained significant attention, with Over-the-Air Federated Learning (OTA-FL) emerging as a key application due to its unique transmission and distributed computing characteristics. This paper derives error bounds for OTA-FL in a Cell-free MIMO system and formulates an optimization problem to minimize optimality gap via joint optimization of power control and beamforming. We introduce the MOP-LOFPC algorithm, which employs Lyapunov optimization to decouple long-term constraints across rounds while requiring only causal channel state information. Experimental results demonstrate that MOP-LOFPC achieves a better and more flexible trade-off between the model's training loss and adherence to long-term power constraints compared to existing baselines.", "sections": [{"title": "I. INTRODUCTION", "content": "Cell-free multiple-input multiple-output (CF-MIMO) is an-ticipated to be a key enabling technology in next-generation wireless communication systems [1]. In CF-MIMO systems, multiple distributed access points (APs) within a given geo-graphic area are connected to a central processing unit (CPU) via fronthaul links to enable coordinated transmission. This architecture provides enhanced spectral and energy efficiency, ultra-low latency, ultra-high reliability, and equitable quality of service (QoS) for user equipment (UEs).\nWith the rapid advancement of artificial intelligence (AI) technologies, the development of communication networks that support distributed AI systems, such as Federated Learn-ing (FL), has become essential [2]. FL conducts training directly at the network edge using locally generated real-time data, reducing the computational load on central units and addressing local data privacy concerns [3]. However, the effec-tiveness of FL is often limited by the communication efficiency between the central units and distributed nodes. In this context, Over-the-Air (OTA) computation has emerged as a promising technique for overcoming these limitations. By leveraging the superposition properties of analog signals, OTA-FL enables the simultaneous aggregation of distributed data across multiple devices, enhancing the efficiency of parameter transmission in FL systems and offering significant advantages over traditional methods [4]. Given the strengths of the CF-MIMO architecture and OTA computation in FL, exploring their coordination is essential for improving FL service capabilities.\nExisting studies have focused on enhancing OTA-FL effi-ciency in traditional cellular systems, particularly in single-cell, multi-user scenarios, through the joint optimization of communication and computation resources. To design energy-efficient and practical communication systems, many of these studies incorporate energy and structural constraints. For ex-ample, [5] explored the joint optimization of power harvesting systems and OTA-FL, proposing a transceiver design and device scheduling algorithm that demonstrates superior prac-ticality and effectiveness. Additionally, [6] addressed dynamic scheduling for power-limited devices, particularly under un-even local data distribution. Beyond communication resource optimization, [7] investigated learning rate optimization for mean square error (MSE) reduction, introducing an enhanced Federated Averaging algorithm for local learning rate opti-mization and proposing a near-optimal beamforming solution.\nIn contrast to traditional cellular systems, OTA-FL within a CF-MIMO framework supports larger-scale distributed learn-ing tasks, enhancing scalability and performance. The role of CF-MIMO in supporting FL was examined in [8], which proposed a practical implementation of OTA-FL integrated with CF-MIMO and conducted a performance analysis, high-lighting the advantage of cell-free networks in reducing energy consumption compared to cellular systems for OTA-FL tasks. Additionally, the impact of wireless fronthaul errors between APs and the CPU was investigated in [9], where the authors developed transmit precoding and two-phase power allocation schemes based on sufficient statistics. Currently, research on OTA-FL in CF-MIMO systems mainly addresses communica-tion errors, rather than focusing on the optimality gap [10], a metric more closely aligned with the AI model's loss function. Energy consumption has consistently been a critical issue in communication systems. Existing research on OTA-FL primarily focuses on short-term power constraints, with limited attention to long-term constraints. Furthermore, studies that do consider long-term constraints often operate under ideal-ized channel state information (CSI) conditions. An earlier study [11] addressed long-term power constraints in OTA-FL systems and proposed a power allocation scheme. However, this study was limited to a single-antenna setup and required non-causal CSI, which is difficult to obtain accurately during each training round. Lyapunov optimization offers an effective approach for addressing dynamic stochastic optimization prob-lems, particularly in the context of wireless communications [12], making it well-suited for power allocation with long-term"}, {"title": "Power constraint in OTA-FL systems.", "content": "In the context of CF-MIMO, there exists a research gap in optimizing OTA-FL performance under short-term and long-term power constraints, particularly in minimizing the optimality gap after several communication rounds. This paper studies this problem and focuses on the joint optimization of power control and beamforming in a CF-MIMO scenario. The main contributions of this work are summarized as follows:\n\u2022 We derive upper bounds of the first order and seond order of the OTA aggregation error and its based optimality gap expression. And we further formulate an optimization problem of joint beamforming and power control across multiple rounds with both the short-term and long-term power constraint.\n\u2022 An alternating iterative optimization algorithm, named MOP-LOFPC, is developed to separately tackle the beam-forming vector at the AP side and the power control at the user side. In each round, beamforming is optimized to minimize the optimality gap component, while the power control across mutiple rounds with the long-term constraint are decoupled with the help of Lyapunov optimization, requiring only causal CSI.\n\u2022 Closed-form solutions are derived for both optimization variables, and their effectiveness is validated through extensive simulations. Compared to existing benchmarks, our proposed approach MOP-LOFPC achieves a better and more flexible trade-off between the model's training loss and adherence to long-term power constraints."}, {"title": "II. SYSTEM MODEL", "content": "We consider an OTA-FL system within a cell-free network, which consists of 1 CPU, L APs, and K UEs, all working collaboratively to facilitate a FL task."}, {"title": "A. Federted Learing Model", "content": "Assume that the FL model parameters are represented by $w \\in \\mathbb{R}^{1\\times q}$, where q is the size of the model parameters. A model training process involves identifying the optimal model w that minimises the global loss function F(w). We define T as the maximum number of FL iteration rounds with $T\\leqq \\{1,\\ldots,T\\}$. A standard process of FL is as follows:\n1) At each round $t\\in T$, the CPU broadcasts the global model of round t to each UE. 2) The UE executes a stochastic gradient descent algorithm utilizing the local data set and the global model to derive the local model of round t + 1. 3) This local model is then uploaded to the AP and subsequently forwarded to the CPU via the fronthaul link. Finally, the CPU aggregates the all local models to obtain the global model of round t + 1. This standard FL process is repeated until either the desired accuracy is achieved or the maximum number of training rounds is reached.\nLet K denote the set of UEs and $\\mathcal{D}_k$ represent the local dataset of UE k, with the global dataset defined as the union of all local datasets, i.e., $\\mathcal{D}_{tot} = \\bigcup_{k \\in \\mathcal{K}}\\mathcal{D}_k$. The loss function $f(w, x_i, \\tau_i)$ quantifies the error of model w on sample $(x_i, \\tau_i)$, where $x_i$ and $\\tau_i$ are the input and the label, respectively. The loss function of model w on dataset $\\mathcal{D}_k$ is\n$$F_k(w) = \\frac{1}{|\\mathcal{D}_k|} \\sum_{(x_i, \\tau_i) \\in \\mathcal{D}_k}f(w, x_i, \\tau_i).$$\nWe assume that each user is allocated a dataset of identical size, denoted as $D \\equiv |\\mathcal{D}_k| = |\\mathcal{D}_k|, \\forall k \\in \\mathcal{K}$. Consequently, the global loss function of the model w is given by\n$$F(w) = \\frac{1}{|\\mathcal{D}_{tot}|}\\sum_{k\\in\\mathcal{K}}|\\mathcal{D}_k|F_k(W) = \\frac{1}{K} \\sum_{k=1}^{K}F_k(w),$$\nwhere $D_{tot} = |\\mathcal{D}_{tot}| = \\sum_{k\\in\\mathcal{K}} D_k$ denotes the size of global dataset. The local model of user k in round t+ 1 is determined by the global model and local gradient in round t [13], i.e.,\n$$w_k^{t+1} = w^t - \\eta_t \\nabla F_k(w^t),$$\nwhere $\\eta_t$ denotes the learning rate in round t. The ideal global model aggregated at the CPU should be $w_k^{t+1} = w^t$. However, condisering the tranmission error in the model up-loding process, the model aggregation error is non-negligible.\nThe next section introduces OTA-FL in the cell-free scenario."}, {"title": "B. Over-the-Air Communication for FL", "content": "In this study, we assume that APs possess sufficient re-sources to ensure error-free downlink model broadcasting.\nTo reduce uplink communication error in cell-free network, we employ the OTA computation technology. In contrast to conventional orthogonal multiple access technologies, all users transmit concurrently within the same time-frequency resource block during the communication process. We assume that the channel gain coefficient remains constant within each com-munication round but varies across different communication rounds.\nIn this study, we consider an uplink communication system comprising single-antenna UEs and multiple-antenna APs, where the AP is connected to the CPU via a high-capacity backhaul link. Let $h_{l,k} \\in \\mathbb{C}^{N_r \\times 1}$ denote the complex channel gain vector from UE k to AP l, where $N_r$ denotes the antenna number of AP. The model information is aggregated at the AP l using the following receive beamforming vector $r_l^t \\in \\mathbb{C}^{N_r \\times 1}$, yielding the model parameter expressed as\n$$z^t_l = (r_l^t)^H\\Big( \\sum_{k=1}^{K}h_{l,k}\\sqrt{p_k^t} w_k^t + n_l^t \\Big),$$\nwhere $p_k^t \\in \\mathbb{R}$ denotes the transmission power of UE k at t-th round communication. $\\mathbf{n}_l^t = [n_{l,1}^t,\\ldots,n_{l,q}^t]^T \\in \\mathbb{C}^{N_r \\times q}$ represents the additive white Gaussian noise, with each column vector being independently and identically distributed in a Gaussian distribution, i.e., $n_{l,i}^t \\sim \\mathcal{CN}(0, \\sigma^2 I)$ and $\\sigma^2$ being the noise power. The model information obtained at the CPU at t-th round communication is\n$$z^t = w^t = \\sum_{l=1}^{L}(r_l^t)^H\\Big( \\sum_{k=1}^{K}h_{l,k}\\sqrt{p_k^t} w_k^t + n_l^t \\Big) = \\sum_{l=1}^{L}\\sum_{k=1}^{K}(r_l^t)^Hh_{l,k}\\sqrt{p_k^t} w_k^t + \\sum_{l=1}^{L}(r_l^t)^Hn_l^t .$$\nRecall the idea model, the aggregation error at t-th round communication can be expressed as\n$$\\varepsilon^t = \\tilde{z}^t - w^t = \\sum_{l=1}^{L}\\sum_{k=1}^{K}(r_l^t)^Hh_{l,k}\\sqrt{p_k^t} w_k^t - w^t+ \\sum_{l=1}^{L}(r_l^t)^Hn_l^t .$$"}, {"title": "C. Problem Formulation", "content": "According to a previous pioneering study [11], the gap between the loss function of the final round model $w^T$ and the optimal loss function $F^*$ can be quantified as\n$$\\mathbb{E} \\Big( F (w^T) \\Big) - F^*$$\n$$\\leqq \\Big(\\prod_{t=1}^{T} M_t \\Big) (F (w^0) - F^*) + \\sum_{t\\in T} J_t (\\eta_{t-1}^2\\Omega N + \\eta_{t-1}^2\\Omega^2 W)$$\n$$+ \\sum_{t=1}^{T}\\frac{\\eta_{t-1}}{2} \\Big( \\frac{1}{N_{t-1}} \\mathbb{E} \\| \\varepsilon^t \\|^2 + S^2 \\eta^2 N + S \\mathbb{E} \\| \\varepsilon^t \\|^2 \\Big),$$\nwhere $M_t = 1 - (1 - (\\Omega - 1)\\mu \\eta_t)$, $J_t = \\prod_{t=t}^{T} M_t$, $\\Omega$ denotes the number of local model training epochs, $\\mu$ characterizes the convergence rate of gradient descent, $N, W, S$ respectively captures the gradient variance bound, the gradient bounds, and the amplitude of gradient fluctuations. $\\mathbb{E} (\\varepsilon^t)$ and $\\mathbb{E} (\\|\\varepsilon^t\\|^2)$ denote the mean error and MSE in the t round of model aggregation process.\nLemma 1. $\\|\\mathbb{E} [\\varepsilon^t] \\|^2$ and $\\mathbb{E} (\\|\\varepsilon^t\\|^2)$ are bounded by (10) and (11), respectively, which can be expressed as\n$$\\|\\mathbb{E} [\\varepsilon^t] \\|^2 \\leqq G^2 \\Big( \\sum_{l=1}^{L}\\sum_{k=1}^{K} (r_l^t)^H h_{l,k} \\sqrt{p_k^t} - 1 \\Big)^2,$$\n$$\\mathbb{E} [\\mathbb{E}^2] < G^2 \\sum_{k=1}^K\\Big( \\sum_{l=1}^L (r_l^t)^H h_{l,k} \\sqrt{p_k^t} \\Big)^2 + \\sigma^2.$$\nProof: By setting $\\mathbb{E}\\[ \\|w_k\\|^2 ] = \\sigma_w^2 +  E\\[\\|w_k\\|^2]$, based on [14], we have the assumption about model bound $\\mathbb{E}\\[\\|w_k\\|^2] > G^2, \\forall k \\in K$. Considering the irrelevance between different user models and the boundary of the models, the proof of Lemma 1 can be completed. Details are omitted for page limit."}, {"title": "By removing irrelevant terms, we can construct an equivalent optimization objective, such as", "content": "$$\\mathbb{E}\\Big\\{\\Phi\\Big(\\mathbf{\\{p\\}, \\{r\\}}\\Big)\\Big\\} = \\sum_{t=1}^{T}\\frac{J_t}{2} \\Big( \\frac{1}{N_{t-1}} \\mathbb{E} \\| \\varepsilon^t \\|^2 \\Big) - B_t \\mathbb{E} (\\| \\varepsilon^t \\|^2)$$\n$$\\leqq \\sum_{t=1}^{T} \\frac{J_t}{2} \\Big( A_t \\Big\\|\\sum_{l=1}^{L}\\sum_{k=1}^{K} (r_l^t)^H h_{l,k} \\sqrt{p_k^t} - 1 \\Big\\|^2 \\Big) + \\sum_{t=1}^{T} \\frac{1}{2} \\Big( C_t \\sum_{k=1}^{K} \\Big( \\sum_{l=1}^{L} (r_l^t)^H h_{l,k} \\sqrt{p_k^t} \\Big)^2 + B_t \\sigma^2 \\Big),$$\nwhere $A_t = \\frac{J_t}{N_{t-1}}$, $B_t = S^2\\eta_{t-1}N + S$, $C_t = \\frac{J_t}{N_{t-1}}G^2$. The optimization problem can be formulated as\n$$\\begin{aligned}\n& (P1): \\min_{\\{\\mathbf{p}\\}, \\{\\mathbf{r}\\}} \\sum_{t=1}^{T}\\mathbb{E}\\[ \\Phi\\[t] ]\\\\\n& \\text { s.t. } \\sum_{t=1}^{T} p_k^t \\leqq P_{ave}, \\forall k \\in K, \\\\\n&\\quad \\quad 0 < p_k^t < P_{max}, \\forall k \\in K,\\forall t \\in T,\n\\end{aligned}$$\nwhere $P_{max} = \\frac{qP_{max}}{2}$, $P_{ave} = \\frac{qP_{ave}}{2} \\forall k \\in K.$"}, {"title": "III. METHODOLOGY", "content": "The coupling of transmit power and receive beamforming in (P1) results in the problem being non-convex, which is chal-lenging. The constraint (13) further couples power variables across the time domain, adding complexity to the solution process. To this end, we employ an alternating iterative op-timization framework to decouple the optimization of power vector and beamforming vector. First, the receive beamforming vector is computed using a beamforming algorithm given the transmit power of all users. Subsequently, each user's tranmsmit power is determined using a power optimization algorithm based on the receiving beamforming in the AP side. Causal CSI is considered in this paper for practical cases, which nonetheless makes the optimal solution to this problem hard to achieve due to the uncertainty of future channel states."}, {"title": "A. MOP Receive Beamforming", "content": "In this section, we propose the MOP receive beamforming algorithm for minimizing single-round component of optimal-ity gap based on given power. Since the beamforming vectors are decoupled in different slots, their optimization can be addressed independently at each time slot. At each time slot, the optimization problem can be formulated as follows:\n$$\\begin{aligned}\n& \\min_{\\{\\mathbf{r}\\}} \\Phi\\[t] = A_t \\Big\\|v^H u_t - 1\\Big\\|^2 + C_t \\sum_{k=1}^{K} \\Big( \\sum_{l=1}^{L} (r_l^t)^H h_{l,k} \\sqrt{p_k^t} \\Big)^2 + B_t\\sigma^2\\\\&\\text { where } u_t = \\Big\\[(h_{1,1}^t)^H \\sqrt{p_1^t}, \\ldots, (h_{L,1}^t)^H \\sqrt{p_1^t}, \\ldots,(h_{1,K}^t)^H \\sqrt{p_K^t}, \\ldots, (h_{L,K}^t)^H \\sqrt{p_K^t} \\Big\\]^H\\\\&\\quad \\quad h = \\Big\\[(h_{1,1}^t)^H, \\ldots, (h_{L,1}^t)^H, \\ldots,(h_{1,K}^t)^H, \\ldots, (h_{L,K}^t)^H \\Big\\]^H\\\\&v = \\Big\\[(r_1^t)^H, \\ldots, (r_L^t)^H \\Big\\]^H\\\\&u_t^k = \\Big\\[(h_{1,k}^t)^H, \\ldots, (h_{L,k}^t)^H \\Big\\]^H\\\\\n\\end{aligned}$$\n$u^k \\in \\mathbb{C}^{N_L\\times1}$, $v,u_t  \\in \\mathbb{C}^{N_L\\times1}$. By setting the first derivative of the objective function in problem (15) to be zero, the optimal solution is calculated by\n$$v_t^* = \\frac{A_t u_t}{A_t u_t (u_t)^H + C_t \\sum_{k=1}^K u_t^k (u_t^k)^H + B_t q\\sigma^2 I}.$$"}, {"title": "B. LOFPC Power Optimization", "content": "To reduce the complexity of handling (13) within a finite time, we propose LOFPC algorithm based on Lyapunov opti-mization to transform the power control problem from finite time to infinite time. By setting $H_k = \\sum_{l=1}^{L}(r_l^t)^H h_{l,k} \\sqrt{p_k^t} = \\sqrt{p_k}$, while eliminating irrelevant terms, a new optimization problem can be formulated as\n$$\\begin{aligned}\n& (P2): \\min_{\\{\\mathbf{p}\\}} \\lim_{T \\rightarrow \\infty} \\frac{1}{T} \\sum_{t=1}^{T} \\Big( \\sum_{k=1}^K A_t \\Big|\\Big| \\sum_{l=1}^{L} (r_l^t)^H h_{l,k} \\sqrt{p_k^t} - 1 \\Big|\\Big|^2 + \\\\\\n&\\qquad \\qquad \\qquad C_t \\sum_{k=1}^{K} \\Big( \\sum_{l=1}^{L} (r_l^t)^H h_{l,k} \\sqrt{p_k^t} \\Big)^2 + B_t\\sigma^2 \\Big)\\\\\n&\\text { s.t. }  \\lim_{T \\rightarrow \\infty} \\frac{1}{T} \\sum_{t=1}^{T} p_k^t \\leqq P_{ave}, \\forall k \\in K, \\\\\\n&\\quad \\quad 0 < p_k^t < P_{max}, \\forall k \\in K,\\forall t \\in T.\n\\end{aligned}$$\nIn order to decouple the temporal coupling in (P2), a virtual queue is established for each UE to represent the current cumulative energy consumption, which can be expressed as\n$$q_k\\[t] = \\max\\{q_k\\[t - 1] + (p_k^t)^2 - P_{ave}, 0\\}, q_k\\[0] = 0.$$\nNext, we will outline the method for utilizing virtual queues to convert long-term power constraints into processes that can be managed within each individual time slot. According to (19), we have the following result:\n$$\\frac{1}{T}\\sum_{t=1}^{T}\\Big(q_k\\[t] - q_k\\[t-1]\\Big) = \\frac{1}{T}\\sum_{t=1}^{T}\\Big((p_k^t)^2 - P_{ave}\\Big) = \\frac{1}{T}q_k\\[T],$$\nwhere the long-term power constraint can be met when $\\lim_{T \\rightarrow \\infty} \\frac{1}{T}q_k\\[T] = 0$. Based on the virtual queue, the Lyapunov drift function can be defined as $\\Delta L_k(t) = \\mathbb{E}\\[ (q_k\\[t]^2 - q_k\\[t - 1]^2) \\| q_k\\[t-1]\\]$. The Lyapunov drift plus penalty function is defined as $\\Delta L(t) + V \\mathbb{E}\\[\\phi\\[t]]$, where the penalty factor $V > 0$ is introduced to balance the average power stability and the communication efficiency of FL. If V decreases, the power converges more rapidly to satisfy the average power constraint. As V increases, better optimization performance can be achieved.\nAccording to (19), we can drive that:\n$$\\frac{1}{2} \\Delta L_k(t) = \\frac{1}{2}\\Big((p_k^t)^2 - P_{ave}\\Big)^2 + q_k\\[t - 1] \\Big((p_k^t)^2 - P_{ave}\\Big),$$\nTherefore, we can formulate a new optimization problem, which can be expressed as\n$$\\begin{aligned}\n& (P3): \\min_{\\{\\mathbf{p}\\}} \\mathbb{E}\\[\\xi\\[t] + V\\phi\\[t]] , \\\\\n&\\text { s.t. }  0 < p_k^t < \\sqrt{P_{max}}, \\forall k \\in K,\\forall t \\in T,\n\\end{aligned}$$\nwhere $\\xi\\[t] = \\frac{1}{2}\\Big((p_k^t)^2 - P_{ave}\\Big)^2 + q_k\\[t - 1] \\Big((p_k^t)^2 - P_{ave}\\Big)$. We can differentiate the optimization objective and find a closed-form solution for the optimization variable according to Cardano formula, which can be written as\n$$p_k^* = \\sqrt[3]{-\\frac{v}{2} + \\sqrt{D}} + \\sqrt[3]{-\\frac{v}{2} - \\sqrt{D}}, D > 0$$\n$$-\\frac{v}{D} \\Big( cos(\\theta) + 2\\pi \\eta ) \\Big), \\eta = 0, 1, 2, \\qquad D < 0,$$\nwhere $v = \\frac{q_k[t - 1]}{A_t}$, $u = \\frac{C_t}{A_t}$, $ [  t  ] = V (At + Ct)||H_k||^2 , \\Delta = (\\frac{-u}{3})^3 + (\\frac{-v}{2})^2$, and $\\theta = arccos ( \\frac{-v}{2D} )$. Based on the previous two sections, the alternating optimization algo-rithm for solving (P1) can be derived, as shown in Algorithm 1, denoted as MOP-LOFPC."}, {"title": "IV. SIMULATION RESULTS", "content": "We consider randomly placing 3 UEs and 6 APs in a 500m \u00d7 500m area. Each UE is equipped with a single antenna, while each AP is equipped with 4 antennas. Channel fading is obtained by multiplying large-scale fading and small-scale fading. We assume that the small-scale fading follows a Rayleigh fading model. The large-scale fading is characterized by Log-Distance Path Loss Model in an urban environment. The carrier frequency is set to 2.4 GHz, and the bandwidth is 20 MHz. All UEs have the equal power constraints, with an average power $P_{ave} = 0.3$ W and a maximum instaneous power $P_{max} = 0.5$ W. The noise power is -101 dBm.\nWe adopt the ridge regression task setup as described in [11] with a fixed learning rate. The sample-wise loss function is given by $f(w,x, t) = \\frac{1}{2} \\|x^T w - \\tau\\|^2 + \\rho R(w)$, where the generated sample vector $x \\in \\mathbb{R}^q$ with q = 10 and the regu-larization function is $R(w) = \\|w\\|^2$ with the hyperparameter $\\rho = 5 \\times 10^{-5}$. We consider the data samples are evenly dis-tributed among users with identical size $D_k = 1000, \\forall k \\in K$. Its label is obtained by $\\tau = x(2) + 3x(5) +0.2z$, where $x(n)$ represents the n-th element of x, and z denotes the observation noise with i.i.d. Gaussian distribution, i.e., $z \\sim \\mathcal{N}(0, 1)$."}, {"title": "B. Baselines", "content": "Three power control algorithms for comparison are given as follows.\nFixed power strategy: Each user employs a fixed transmis-sion power in each communication round $p_k^t = P_{ave}, \\forall k \\in K$.\nCi power strategy: In each time slot t, each UE per-forms power optimization for $[t]$. Formally, similar to the channel inversion strategy, the transmit power is given by"}, {"title": "In each", "content": "H)"}, {"title": "Lgr power strategy:", "content": "The Lagrangian dual method is used to solve the time coupling issue arising from long-term power constraints (13) in power control problem [11]. However, this algorithm is an offline power control strategy and requires non-causal CSI, i.e., the perfect CSI of all communication rounds. The proposed beamforming strategy is the MOP algorithm, while the MRC beamforming strategy serves as a baseline for comparison. This strategy is a reasonable maximum ratio combining algorithm for cell-free scenarios, as referenced in [8]. The receive beamforming at each AP is a weighted sum of the channels from all UEs to the AP, with weights inversely proportional to the large-scale fading of the channels."}, {"title": "C. Results and Discussions", "content": "Fig. 1 shows the satisfaction of long-term power con-straints across communication rounds for various power con-trol schemes. The Lgr strategy consistently meets the long-term constraint, while the LOFPC algorithm converges after approximately 100 iterations. Conversely, the Ci method fails to satisfy the constraint compared to the others.\nFig. 2 illustrates the learning loss across various power control and receive beamforming schemes. The proposed LOFPC algorithm consistently outperforms both the fixed and Lgr algorithm under the same beamforming strategy. The Lgr algorithm enforces stricter long-term power constraints, while the fixed algorithm lacks optimization flexibility. Although the Ci method yields better performance than LOFPC and Lgr, it fails to satisfy long-term power constraints. Additionally, the MOP beamforming scheme consistently outperforms the MRC scheme, as MOP directly optimizes the gap to the optimal solution, unlike MRC, which focuses solely on channel gain.\nFig. 3 shows that the LOFPC algorithm balances improved optimization objectives and accelerated convergence to the long-term power constraint by adjusting the penalty parameter V. Recall that Fig. 1 and Fig. 3, we can see that a larger V can achieve better model training results, but it takes longer time for the average power to converge. A smaller V can achieve faster average power convergence, but the model training effect is worse under the same training rounds."}, {"title": "V. CONCLUSION", "content": "This paper introduces a communication resource allocation algorithm to enhance energy efficiency in distributed AI sys-tems within a cell-free framework. We formulated an optimiza-tion problem linking communication error to the optimality gap and proposed a joint power control and beamforming algorithm, named LOFPC-MOP, based on the alternating itera-tive optimization framework. Experimental results demonstrate that the MOP-LOFPC provides a more effective and adaptable balance between minimizing the model's training loss and maintaining compliance with long-term power constraints, outperforming existing benchmarks."}]}