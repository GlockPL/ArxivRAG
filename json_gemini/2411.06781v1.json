{"title": "MP-PINN: A Multi-Phase Physics-Informed Neural Network for Epidemic Forecasting", "authors": ["Thang Nguyen", "Dung Nguyen", "Kha Pham", "Truyen Tran"], "abstract": "Forecasting temporal processes such as virus spreading in epidemics often requires more than just observed time-series data, especially at the beginning of a wave when data is limited. Traditional methods employ mechanistic models like the SIR family, which make strong assumptions about the underlying spreading process, often represented as a small set of compact differential equations. Data-driven methods such as deep neural networks make no such assumptions and can capture the generative process in more detail, but fail in long-term forecasting due to data limitations. We propose a new hybrid method called MP-PINN (Multi-Phase Physics-Informed Neural Network) to overcome the limitations of these two major approaches. MP-PINN instils the spreading mechanism into a neural network, enabling the mechanism to update in phases over time, reflecting the dynamics of the epidemics due to policy interventions. Experiments on COVID-19 waves demonstrate that MP-PINN achieves superior performance over pure data-driven or model-driven approaches for both short-term and long-term forecasting.", "sections": [{"title": "1 Introduction", "content": "The COVID-19 pandemic has claimed over 7 million lives for just 4 years\u00b3. Let us pause for a moment and consider a hard counterfactual question: Could the majority of these lives have been saved if we had predicted the spread better at the onset of the pandemic and acted more effectively? In fact, the world did all it could: modelling, forecasting, implementing lockdowns, developing vaccines, and much more. In the absence of proper understanding of the viruses' nature and with limited data available when a wave just started, epidemiologists had to make assumptions in model-driven methods, such as those in the mechanistic SIR family [10] or in detailed agent-based simulations [11]. When some data became available, for example, after a month, data-driven methods, as preferred by the data science community, could be employed to detect trends in the time-series [25,21]. A key open challenge is the complex interplay of evolving interventions, human factors and technological advances driving the epidemic waves [1]."}, {"title": "2 Related Works", "content": "We briefly review the literature in epidemic forecasting most relevant to our work as the literature has exploded since the COVID-19 outbreak in late 2019:\nModel-driven approach Compartmental models, such as the Susceptible-Infectious-Recovered (SIR) model, are foundational in epidemic modelling due to their simplicity and reliance on mechanistic understanding of disease spread. They are particularly effective for long-term forecasting because they incorporate known epidemiological dynamics [10]. However, their fixed parameters often lead to less accurate short-term predictions, as they cannot easily adapt to rapid changes in transmission dynamics. The have been a plethora of SIR extensions with sophisticated assumptions such as SIRD [13], SEIR [4] and SEIRM [24].\nData-driven approach Machine learning models, particularly deep learning techniques, have gained prominence for short-term forecasting due to their ability to capture complex patterns in large datasets [3]. Techniques such as Long Short-Term Memory (LSTM) networks excel in identifying trends and making predictions over short periods. However, their performance deteriorates over longer horizons due to their lack of incorporation of epidemiological knowledge, making them less reliable for long-term predictions [28]. In [12], authors studied forecasting influenza outbreaks, e.g. training model with data in four years to predict in the future outbreaks, hence the training data is much larger than ours which consists of only one outbreak.\nMost existing data-driven approaches make short-term predictions (less than a month). For example, the work in [9] used two months to train and predict the next one months with prediction windows are 3/7/14 days. Likewise, the model in [30] trained on almost ten months and test on one month with prediction window is 7/14/21/28 days. In [14] and [26], models were trained on 377 days, but window of forecasting in both works is the next 7 days (observed previous 21 days). In contrast, we train the model only on data collected for 35 days, and forecast the rest of the outbreak (97 days). Thus our setting is much more challenging and almost impossible to achieve without utilising epidemic models and prior knowledge.\nPhysic-Informed Neural Networks (PINNS)\nRecently, PINNs have emerged as a framework to incorporate known physical rules to train deep neural networks [23]. It has been demonstrated to be effective in solving forward and inverse problems involving partial differential equations (PDEs). Since then, numerous studies have explored the application of PINNs in various domains, such as fluid dynamics [2], material science [20], and epidemic modelling [24]."}, {"title": "3 Preliminaries", "content": "In epidemiology and other fields where the behaviour of large populations is studied, the compartment models are models in which the population are divided into a discrete set of qualitatively-distinct states/types/classes/groups, so-called compartments. These models also define the transition between the compartments. We focus on SIR (Susceptible-Infected-Recovered), the most popular compartments model used to model the spread of infectious diseases in epidemiology [10]. SIR contains three compartments: (1) Susceptible, (2) Infected, (3) Recovered/removed populations which are denoted as $S(t)$, $I(t)$ and $R(t)$ as a function of time $t$, respectively. At time $t$, an individual in the population is classified into one of these compartments, typically transiting from being susceptible to infected and finally recovered (or removed). Hence, the size of the population ($N$) is the sum of the number of the susceptible, infectious and recovered persons, i.e., $N = S(t) + I(t) + R(t)$. Here, we considered a single outbreak SIR model comprises a set of ordinary differential equations (ODEs) that describe the transitions between three compartments:"}, {"title": "3.1 Mechanistic Compartment Models", "content": "In epidemiology and other fields where the behaviour of large populations is studied, the compartment models are models in which the population are divided into a discrete set of qualitatively-distinct states/types/classes/groups, so-called compartments. These models also define the transition between the compartments. We focus on SIR (Susceptible-Infected-Recovered), the most popular compartments model used to model the spread of infectious diseases in epidemiology [10]. SIR contains three compartments: (1) Susceptible, (2) Infected, (3) Recovered/removed populations which are denoted as $S(t)$, $I(t)$ and $R(t)$ as a function of time $t$, respectively. At time $t$, an individual in the population is classified into one of these compartments, typically transiting from being susceptible to infected and finally recovered (or removed). Hence, the size of the population (N) is the sum of the number of the susceptible, infectious and recovered persons, i.e., $N = S(t) + I(t) + R(t)$. Here, we considered a single outbreak SIR model comprises a set of ordinary differential equations (ODEs) that describe the transitions between three compartments:\n$\\frac{dS(t)}{dt} = -\\frac{\\beta}{N}S(t)I(t),$\n$\\frac{dI(t)}{dt} = \\frac{\\beta}{N}S(t)I(t) - \\gamma I(t),$\n$\\frac{dR(t)}{dt} = \\gamma I(t),$\nwhere parameters of the model $\\beta > 0$ and $\\gamma \\in (0,1)$ are the infection rate and the recovery rate, respectively. In real-world and more complex models, these parameters can also vary over time or depend on different factors such as policy or other properties of the population. The initial condition of the ODEs are $S(0) > 0, I(0) > 0$, and $R(0) \\geq 0$.\nAn important assumption of the SIR model is that all recovered individuals (in the R group) are completely immune and cannot return to the susceptible (S) or infected (I) groups, and that the total population N remains constant. However, N does not always represent the entire population, especially in real-world scenarios. For instance, one assumption of the SIR model [8] is that the population mixes homogeneously, meaning everyone has the same level of interaction with others. However, during the early stages of the COVID-19 outbreak in 2020, it was impractical to consider the entire population as susceptible. Instead, N might only represent a fraction of the population. Moreover, the population could therefore be divided into two distinct groups [32]: those with inherited immunity and those without. These distinctions imply that the total number of susceptible individuals S(t) may not always correspond to the entire population N, but rather to a specific portion of it, depending on factors such as inherited immunity or other epidemiological considerations."}, {"title": "3.2 Physics-Informed Neural Networks (PINNS)", "content": "PINNS [23] are neural networks equipped with physical constraints of the domain, either through the network architecture or as a regularisation term during the training process. These physical laws often involve parameters that need to be estimated. During the training of a PINN, both the neural network weights and the physical parameters are optimised to achieve the best fit to the observed data while simultaneously satisfying the physical constraints.\nMore formally, given a training dataset D, learning searches for a neural network $f \\in H$ by solving an optimisation problem:\n$f^* = \\min_{f \\in H} L(f; D) + \\lambda \\Omega(f),$\nwhere $L(f; D)$ is usual data loss function, $\\Omega(f)$ is a regularisation term that introduces physical prior knowledge into the learning process, and $\\lambda > 0$ is a balancing weight. When the prior is specified as partial differential equations (PDEs), the regularisation typically takes the form of the PDE residual loss:\n$\\Omega(f) = \\frac{1}{L} \\sum_{j=1}^{L} (\\frac{\\partial f}{\\partial x}_{fnn}(x_j) - \\frac{\\partial f}{\\partial x}_{PDE}(x_j))^2,$\nwhere $\\frac{\\partial fnn}{\\partial x}(x_j)$ denotes the partial derivative of the neural network evaluated at $x_j$, and $\\frac{\\partial f}{\\partial x}_{PDE}(x_j)$ denotes the corresponding partial derivate specified by the PDEs. The evaluation points $j = 1, 2, ..., L$ are sampled so that the function $f$ and its derivative are well supported."}, {"title": "4 Methods", "content": "We now present our main contributions of developing PINNs for epdidemic forecasting. The overall framework is depicted in Fig. 2. We start from a single-phase assumption, then advance into the multi-phase model. Both single-phase and multi-phase models integrate expert knowledge and a data-driven parameter estimation process. In the multi-phase model, however, parameters such as infection rate ($\\beta$) and recovery rate ($\\gamma$) vary between phases, enhancing the model's ability to adapt to complex real-world scenarios. The single-phase approach is described in Sec. 4.1 and the multi-phase approach is detailed in Sec. 4.2.\nMore concretely, using the SIR model described in Sec. 3.1 as physics prior, we build a PINN framework with separate neural networks $f_{S}(t)$ and $f_{I}(t)$ where $f_{pi}$ that takes $t$ as input to predict the Susceptible $S(t)$ and the Infected $I(t)$, respectively. For clarity, we present the case where the input is only the time $t$, but any other features, static or dynamic can be applicable. Note that we do not need to model the Recovered $R(t)$ because of the constraint $S(t) + I(t) + R(t) = N$ described in Sec. 3.1."}, {"title": "4.1 Single-Phase PINN (SP-PINN)", "content": "Consider an outbreak of T days, where we observe the first $T_0$ days and forecast the rest of $(T - T_0)$ days. Let N be the size of population who will be infected through the lifetime of the wave. The PINN's objective function involves an empirical loss $L$ and regulariser $\\Omega$, as described in Eqs. (4,5):\n$L = \\frac{1}{T_0} \\sum_{t=1}^{T_0} [(\\frac{d \\hat{S}}{dt}(t) - S(t))^2 + (\\frac{d \\hat{I}}{dt}(t) - I(t))^2],$\nwhere and $S(t)$ and $I(t)$ are the ground truth susceptible and infected populations at observed time $t = 1, 2, ..., T_0$. The physics-informed regulariser has two components:"}, {"title": "4.2 Multi-Phase PINN (MP-PINN)", "content": "The singe-phase approach assumes that the SIR parameters are unchanged during the entire epidemic. This might suffice when the epidemic is well contained and the inter-vention does not change over time. This is unrealistic in the case of COVID-19. We found that the SP-PINN demonstrated good performance for short-term forecasting, it struggled to capture the evolving dynamics of longer-term outbreaks (see Table 1 for more details). This limitation motivated the development of our multi-phase PINN, or MP-PINN, described below.\nA complex epidemic outbreak at the scale of COVID-19 is typically handled by a sequence of interventional policies (e.g., social distancing, restrictions, lock-downs, and rolling out of vaccines) to adaptively control the virus spreading and minimise the"}, {"title": "6 Conclusions", "content": "In this work, we introduced MP-PINN (Multi-Phase Physics-Informed Neural Network), a novel approach to epidemic forecasting that addresses the limitations of both traditional model-driven and data-driven methods. By integrating the mechanistic understanding"}]}