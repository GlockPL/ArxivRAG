{"title": "Early Risk Prediction of Pediatric Cardiac Arrest from Electronic Health Records via Multimodal Fused Transformer", "authors": ["Jiaying Lu", "Stephanie R. Brown", "Songyuan Liu", "Shifan Zhao", "Kejun Dong", "Del Bold", "Michael Fundora", "Alaa Aljiffry", "Alex Fedorov", "Jocelyn Grunwell", "Xiao Hu"], "abstract": "Early prediction of pediatric cardiac arrest (CA) is critical for timely intervention in high-risk intensive care settings. We introduce PEDCA-FT, a novel transformer-based framework that fuses tabular view of EHR with the derived textual view of EHR to fully unleash the interactions of high-dimensional risk factors and their dynamics. By employing dedicated transformer modules for each modality view, PEDCA-FT captures complex temporal and contextual patterns to produce robust CA risk estimates. Evaluated on a curated pediatric cohort from the CHOA-CICU database, our approach outperforms ten other artificial intelligence models across five key performance metrics and identifies clinically meaningful risk factors. These findings underscore the potential of multimodal fusion techniques to enhance early CA detection and improve patient care.", "sections": [{"title": "I. INTRODUCTION", "content": "Cardiac arrest (CA) in the pediatric population is a critical and life-threatening event with significant implications for morbidity and mortality [1]. While less common than in adults, pediatric CA is often associated with a preceding period of physiological instability, making timely identification and intervention crucial. Many cases of CA in children occur in intensive care units (ICUs) [2], particularly cardiac ICUs [3], where children with congenital or acquired heart diseases are managed. In these high-stakes environments, the interplay of complex cardiac conditions, surgical interventions, and critical care therapies, coupled with significant cognitive and data overload, creates a unique set of challenges for clinicians [4]. Early prediction of CA [5] in this setting could enable proactive measures to prevent arrests and provide situational awareness. This underscores the importance of developing robust predictive models tailored to the pediatric cardiac ICU population, integrating clinical, physiological, and potentially novel data sources.\nElectronic Health Records (EHRs) offer a rich repository of patient data [2], making them an attractive resource for cardiac arrest risk prediction. By aggregating diverse information such as demographics, vital signs, laboratory results, and clinical notes, EHRs provide a comprehensive view of a patient's health trajectory. However, leveraging EHR data for pediatric CA risk prediction is not without challenges [6]. First, EHRs are inherently heterogeneous, encompassing various modalities that differ in format and clinical significance. For examples, demographics are stored in the static categorical format that serve as underlying risk factors, whereas vital signs are recorded as longitudinal numerical measurements that reflect short term physiological status. Second, EHR data are multi-resolution: some measurements, like vital signs, are updated in near real-time, while others, such as lab results, are recorded at more sparse intervals. Traditionally, clinicians have relied on manually developed criteria and scoring systems (e.g., PEWS [7], IDO2 [8]) to predict cardiac arrest. While these systems are valuable, they may not fully capture the subtle, individual-specific nuances of a patient's condition because they depend on universally predefined thresholds applied to a fixed set of clinical observations. Moreover, certain systems, such as IDO2, are proprietary, limiting their accessibility without incurring additional costs. In contrast, data-driven approaches leverage EHR data through advanced artificial intelligence (AI) techniques, leading to improved performance in early detection and risk stratification of pediatric cardiac arrest [5].\nThe heterogeneous and multi-resolution nature of EHR poses significant challenges to AI models for EHR-based pediatric CA risk prediction. Conventional AI models (e.g., random forest, XGBoost [9]), which are designed for static tabular data, excel at handling high-dimensional numerical and categorical risk factors by capturing subtle and non-linear patterns indicative of impending cardiac arrest. However, these models operate on fixed-dimensional input features and typically require ad-hoc, domain-specific feature preprocessing\u2014such as aggregation [10]\u2014which can overlook important dynamic temporal changes in risk factors. On the other hand, time-series AI models [11] are well-suited for analyzing longitudinal data, as they can capture temporal dependencies and trends. Although resolution unification techniques (e.g. resampling, padding, interpolation) [12], [13] can address the multi-resolution challenges inherent in EHR data, time-series models often struggle to effectively handle high-dimensional inputs.\nTo address the above mentioned challenges, we propose our innovative approach, namely PEDiatric Cardiac Arrest"}, {"title": "II. STUDY DESIGN", "content": "We are interested in the early risk prediction of cardiac arrest for pediatric ICU population.\nDefinition 1 (Patient EHR Data): The EHR data $x^{(t)}$ of one patient include static risk factors $x^{(s)} \\in \\mathbb{R}^{d_s}$ during one admission such as demographics and admission diagnosis, and temporal risk factors $x^{(t)} \\in \\mathbb{R}^{d_t \\times T}$ such as patient's lab results, vital signs, and nursing assessments. Therefore, the EHR data within first $\\tau$ hours is defined by $x_{t<\\tau} = (x^{(s)}, x^{(t)})$, and $n$ denotes overall number of risk factors contained in EHR data.\nDefinition 2 (Early Risk Prediction of Cardiac Arrest):\nWe aim to employ a predictive model $f_\\theta(\\cdot)$ using a patient EHR data $x_{t<\\tau}$ available in the first $\\tau$ hours of admission, to predict the probability of developing cardiac arrest $\\hat{y} = f_\\theta(X_{t<\\tau})$, where $\\hat{y} \\in \\{0,1\\}$ during the rest of the admission stay."}, {"title": "III. METHODS", "content": "The two major challenges we face are (1) the large feature space due to the multimodal, heterogeneous patient risk factors; (2) the label imbalance due to the low prevalence of CA in pediatric CICU patients. Our proposed model, PEDCA-FT, is a multimodal transformer late-fusion model, which utilize both raw structured EHR features (tabular) and derived textualized EHR features (textual) as input. As can be seen in Fig. 1, PEDCA-FT consists of three modules: tabular-transformer $T_{tab}$, pre-trained textual-transformer $T_{txt}$, and fusion-transformer $T_{fus}$. The tabular-transformer is corresponding to obtain latent representation from patient's raw EHR data, denoted by $h_{tab} = T_{tab}(x_{t<\\tau})$. The textual-transformer is corresponding to obtain latent representation from patient's textualized EHR data, denoted by $h_{txt} = T_{txt}(g(x_{t<\\tau}))$ where $g(\\cdot)$ denotes the textualization function for EHR. After obtaining latent representations from two views, we utilize the fusion-transformer to predict the likelihood of cardiac arrest, denoted by $\\hat{y} = T_{fus}(h_{tab}, h_{txt})$.\nTabular models (e.g. XGBoost [9], LightGBM) have demonstrated excessive performance in EHR-based risk predictions. Here, we also employ a tabular view to handle the numerical and categorical risk factors that widely exist in the EHR. We follow the common practice to preprocess these tabular features, where numerical ones are passed through without change and categorical ones are encoded as monotonically increasing integers. For the static risk factors $x^{(s)}$, we keep them as the original format. For the temporal risk factors, aggregation process is needed to accommodate the input format requirements. Therefore,\n$x^{(t)}_{agg} = \\phi(x_{t<\\tau}),$\nwhere $\\phi: [\\mathbb{R}^{d_t \\times T} \\rightarrow \\mathbb{R}^{d_t}$ denotes the aggregation operator that maps the time-series features into tabular features. A wide range of aggregation operation can be used for $\\phi$, and we opt to $LAST(\\cdot)$ which keeps the last observed element from the whole time-series. The input of tabular-transformer $T_{tab}$ is $X_{t<\\tau} = (x^{(s)}, x^{(t)}_{agg})$ after applying Eq. (1)."}, {"title": "B. Textual Transformer", "content": "The drawback of tabular view is that the aggregation process simplifies the time-series risk factors. We propose a textual view to fully capture the trend and change of these time-series risk factors by presenting their value ranges. Moreover, the static risk factors can also be effectively captured by directly presenting them in the textual format. A pre-trained textual-transformer $T_{txt}$ is employed to obtain the latent embedding of the textualized EHR data $D = g(x_{t<\\tau})$. In general, the textualized representation of i-th factor $x^{(i)} \\in X_i$ of $x_{t<\\tau}$ is computed by\n$D^{(i)} = g^{(i)}(x^{(i)}),$\nwhere $g^{(i)}(\\cdot)$ is the i-th textualization function, and $D^{(i)}$ denotes a sequence of length $|D^{(i)}|$ textual tokens $\\{d_1, d_2,..., d_{|D^{(i)}|}\\}$. Specifically, we implement $g^{(i)}(\\cdot)$ using the following template for static feature $X^{(i)} \\in X^{(i)}$\n$g^{(i)}(x^{(i)}) = factorName(x^{(i)}) + \":\" + x^{(i)}$\nwith factorName() denotes retrieving the factor name of $X^{(i)}$, and $#$ denotes text concatenation function. For instance, $g^{(i)}(x^{(i)}) =  \u201cGender: Female\u201d when $x^{(i)} =$ \u201cFemale\u201d indicating the patient\u2019s gender. Moreover, we implement $g^{(i)}(\\cdot)$ using the following template for variable length time-series feature $X^{(i)}_{0:\\tau}$:\n$g^{(i)}(x^{(i)}_{0:7}) = factorName(x^{(i)}) + \":\" +\\begin{cases}\nset(x^{(i)}_{0:7}), & \\text{if } x^{(i)} \\text{ is categorical} \\\\\nmin-max(x^{(i)}_{0:\\tau}), & \\text{otherwise,}\n\\end{cases}$\nwhere we keep all distinct values of each categorical time-series risk factor, and value min-max range of each numerical time-series factor. As an illustration, for categorical time-series risk factor skin color, the textualized result is \u201cSkin Color: Pink; Pale.\u201d which covers all recorded values. Similarly, for numerical time-series risk factor body temperature, the textualized result is \u201cBody Temp: 91.4\u201398.4.\u201d. With the help of proposed textualization process, the heterogeneous multimodal EHR data is represented into a unified textual format which can be effectively handled by textual transformer, capturing dynamic trend of time-series.\nPre-trained on massive textual corpus that covers public EHR databases, transformer-based models have shown promising in adults-centered risk prediction tasks [21], [22], [23]. We employ a standard bidirectional encoder-only transformer (i.e., BERT [24]) for the pediatric cardiac arrest prediction, since it essentially is a sequence prediction problem after textualization of EHR. Follow the common practice, we add a special sequence token \u201c[CLS]\u201d at the beginning of the converted text, which is used as the text-view representation of one patient\u2019s EHR,\n$h_{BERT} = BERT([CLS], D),$\nwhere $h_{BERT} \\in \\mathbb{R}^{(|D|+1) \\times d_{txt}}$ and $BERT(\\cdot)$ denotes the employed bi-directional transformer model. It is worth noting that BERT here is different from the multi transformer layer in Eq. (6), since $BERT(\\cdot)$ contains additional word embedding layer and its all learnable parameters are pre-trained. We use the \u201c[CLS]\u201d corresponding embedding as the text-view embedding of textualized EHR, thus $h_{txt} = h_{BERT}[0, :] \\in \\mathbb{R}^{d_{txt}}$. One technical challenge for our textual transformer module is the maximum sequence length. To accommodate with that constraint, we further polish the textualization function $g(\\cdot)$ for time-series laboratory test results. Inspired by the clinical decision making process that paying more attentions to abnormal findings [25], we filter out laboratory results that fall into the normal reference range and only keep the names of abnormal ones. Therefore, an example of textualized laboratory results can be \u201c(High) Sodium; Potassium. (Low) Glucose.\u201d. Furthermore, we add section headers, including \u201cDemographics\u201d, \u201cVitals\u201d, \"Assessments\", \u201cLabs\u201d and \u201cMedications\u201d, for each covered EHR table, as can be seen in the toy example of Fig. 1. These above ad-hoc design aims to make the textualized EHR more readable and concise for the textual-transformer."}, {"title": "C. Fusion Transformer", "content": "After obtain the view-specific dense representation of patient EHR from tabular-transformer by $h_{tab} = T_{tab}(x_{t<\\tau})$ and textual transformer by $h_{txt} = T_{txt}(g(x_{t<\\tau}))$, we utilize a late-fusion strategy [14], [15] to calculate the final probability of the pediatric patient\u2019s cardiac arrest onset. We still use the powerful Transformer architecture as the major technical component, with a concatenation operation to pool the two representations\n$p = sigmoid(W(F_{1:M}(h_{tab}, h_{txt})) + b),$\nwhere p$\\in$ [0,1] denotes the predicted probablity of CA onset, $F_{1:M}$() denotes the multiple transformer layers, and W() + b denotes the last prediction layer.\nThe focal loss [26] is used to train the three modules of PEDCA-FT to deal with the class imbalance (CA incidence=3.1%)\n$FL(p_{true}) = -(1 - p_{true})^\\gamma log(p_{true}),$\nwhere\n$p_{true} = \\begin{cases}\np, & \\text{if y = 1,} \\\\\n1 - p, & \\text{otherwise,}\n\\end{cases}$\nand $\\gamma$ is a hyperparameter focusing on reduce the loss contribution from well-classified examples ($p_{true} \\approx 1$)."}, {"title": "IV. EXPERIMENTAL RESULTS", "content": "We use our curated cardiac arrest cohort from CHOA-CICU to conduct 5-fold cross-validation. We further ensure that no patient appears in both the training and testing sets for an unbiased evaluation. As defined in Sec. II, our research problem, early risk prediction of CA, is formulated asa a binary classification task. Accordingly, we employ a broad set of binary classification metrics, including balanced accuracy (Bal_Acc), F1 score, Matthews Correlation Coefficient (MCC), Area Under the Precision-Recall Curve (AUPRC), and Area Under the Receiver Operating Characteristic Curve (AUROC), to comprehensively assess model performance while accounting for the inherent class imbalance (admission-wise CA incidence = 3.1%). In our evaluation, CA events are treated as the positive class. Among these metrics, Bal Acc is a specifically designed metric to avoid inflated performance on imbalanced dataset, which is essentially arithmetic mean of sensitivity and specificity in binary classification case. F1 is a harmonic mean of the precision and recall. MCC is defined as\n$MCC = \\frac{tp \\times tn - fp \\times fn}{\\sqrt{(tp + fp)(tp + fn)(tn + fp)(tn + fn)}}$\nwhere is generally regarded as a balanced metric for imbalanced case. A MCC of +1 presents a perfect prediction, 0 an random prediction, and -1 an inverse prediction. AUROC and AUPRC both assess trade-offs between key performance rates. While AUROC is widely used providing a threshold-independent evaluation of the balance between TPR and FPR and serving as a valuable benchmark for comparison with prior work\u2014AUPRC is often more informative in scenarios with class imbalance [27], as it emphasizes the trade-off between precision and recall and focuses on performance for the minority (positive) class."}, {"title": "B. Compared Baseline Models", "content": "To comprehensively evaluate the effectiveness of our proposed model, we include ten other AI models. As we summarize before that the EHR data used for pediatric CA is heterogeneous and multi-resolution, the ten AI models can be categories into the following three groups with different EHR feature processing techniques."}, {"title": "D. Feature Importance Analysis", "content": "We use permutation importance method [37] to calculate the feature importance scores for our proposed perturbed copy of the data where this feature\u2019s values have been randomly shuffled across rows. We set number of different permutation shuffles as 5, and the confidence level as 0.95. Top 15 important features with p_value < 0.05 are presented in Fig. 3. Our analysis reveals that key clinical indicators, such as capillary refill, total bilirubin level, and hematocrit, are among the most important predictors for pediatric cardiac arrest. Notably, factors related to hemodynamic stability and oxygenation/ventilation\u2014including CO2 level on arterial blood gas, and FIO2, also rank highly, emphasizing their critical role in patient monitoring. Furthermore, the inclusion of demographic factors such as sex and race highlights the multifactorial nature of cardiac arrest risk in the pediatric population. Overall, this feature importance analysis not only identifies clinical risk factors but also uncovers novel predictors that may enhance early risk detection and guide future targeted interventions."}, {"title": "V. CONCLUSION", "content": "Electronic health records contain a wealth of patient information that can be leveraged to study risk factors for the early detection of pediatric cardiac arrest. In this paper, we introduce PEDCA-FT, a novel multimodal fused transformer that effectively handle the heterogeneous multi-resolution EHR data. Extensive experiments on a curated pediatric cohort demonstrate the effectiveness of PEDCA-FT, indicating its potential translational impact in clinical settings. In the future, we plan to (1) extend our methodology to more diverse datasets and incorporate other modalities (e.g., clinical notes, waveforms) to further enhance predictive accuracy; (2) Explore continuous risk monitoring scenarios"}]}