{"title": "Continual Learning with Strategic Selection and Forgetting for Network Intrusion Detection", "authors": ["Xinchen Zhang", "Running Zhao", "Zhihan Jiang", "Handi Chen", "Yulong Ding", "Edith C.H. Ngai", "Shuang-Hua Yang"], "abstract": "Intrusion Detection Systems (IDS) are crucial for safeguarding digital infrastructure. In dynamic network environments, both threat landscapes and normal operational behaviors are constantly changing, resulting in concept drift. While continuous learning mitigates the adverse effects of concept drift, insufficient attention to drift patterns and excessive preservation of outdated knowledge can still hinder the IDS's adaptability. In this paper, we propose SSF (Strategic Selection and Forgetting), a novel continual learning method for IDS, providing continuous model updates with a constantly refreshed memory buffer. Our approach features a strategic sample selection algorithm to select representative new samples and a strategic forgetting mechanism to drop outdated samples. The proposed strategic sample selection algorithm prioritizes new samples that cause the 'drifted' pattern, enabling the model to better understand the evolving landscape. Additionally, we introduce strategic forgetting upon detecting significant drift by discarding outdated samples to free up memory, allowing the incorporation of more recent data. SSF captures evolving patterns effectively and ensures the model is aligned with the change of data patterns, significantly enhancing the IDS's adaptability to concept drift. The state-of-the-art performance of SSF on NSL-KDD and UNSW-NB15 datasets demonstrates its superior adaptability to concept drift for network intrusion detection.", "sections": [{"title": "I. INTRODUCTION", "content": "Intrusion Detection Systems (IDSs) serve as the primary defenders of digital infrastructures and interconnected systems, such as the Internet of Things, playing a critical role in monitoring network traffic to identify and alert on unauthorized or malicious activities [1]\u2013[6]. They act as early warning systems, providing vital defense against the constant threat of cyber-attacks and ensuring system integrity [7].\nIn dynamic network environments, both the threat landscapes and normal operational behaviors are constantly changing [8]. Attackers always look for new vulnerabilities, leading to new attack types. Additionally, user behaviors may shift, resulting in changing normal operation patterns. These elements drive concept drift [9], a phenomenon characterized by changing statistical distribution in data over time [10]. The effectiveness of IDSs depends on their ability to detect, anticipate, and adapt to the above changes. This adaptability is crucial for maintaining their resilience against the persistent evolution of both cyber attacks and normal patterns.\nHowever, traditional learning-based IDSs [11]\u2013[13] typically function with static models that, once trained, remain unchanged regardless of subsequent shifts in the environment, like system behaviors or attack strategies. This static nature reveals that most existing learning-based IDSs cannot cope with the inherent variability of dynamic environments, as they lack mechanisms to adapt to concept drift.\nBy incorporating continual learning, IDSs can adapt to concept drift with the capability for continuous updates and evolution [14], [15]. To keep pace with concept drifts, it is essential to select new samples that accurately reflect these evolving patterns. However, existing continual learning strategies typically employ random sampling [16], [17] or rely on criteria such as the importance of a sample in the learning process or its representativeness of the overall distribution [10]. These criteria often fail to provide adequate attention to the 'drifted' pattern, the most challenging aspect. Simply treating the 'drift' as part of the overall distribution overlooks its critical role in causing concept drift. In addition, the most common solution in current continual learning methods [18]\u2013[21] is to preserve as much old knowledge as possible to prevent catastrophic forgetting [22], where a model forgets previously learned information upon learning new data. However, they ignore the potential concern that past knowledge becomes out-of-date or requires correction when drifting occurs. Maintaining outdated or incorrect knowledge can hinder, rather than facilitate, the model's adaptation to new drifts [23].\nIn this work, we present SSF (Strategic Selection and Forgetting), a novel continual learning method that provides dynamic model updates to the IDS, facilitated by a refreshed memory buffer to strategically address concept drifts by including the most representative new data while retaining useful historical data. More specifically, we propose a novel sample selection strategy that identifies the most representative new samples for the 'drifted' pattern. By accurately capturing these drifts, our algorithm significantly enhances the model's adaptability to concept drift and provides valuable insights into the evolving landscape. For the unchanged pattern, we utilize already labeled old samples to save labeling effort. This combination of labeled old samples for the unchanged pattern and unlabeled new samples for the drifted pattern"}, {"title": "II. PRELIMINARIES FOR CONCEPT DRIFT", "content": "Learning-based applications often perform well under independently and identically distributed (i.i.d.) assumption. However, in open-world scenarios, this assumption may fail as test distributions can diverge [10], causing concept drift.\nDefinition 1 (Concept Drift). Concept drift refers to the phenomenon where the statistical properties of the joint probability distribution $P(X,Y)$ of the input feature space $X$ and the label space $Y$ change over time. Formally:\n$P(X,Y,t) \\neq P(X,Y,t_0), t\\neq t_0$,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 WILL BE INCLUDED."}, {"title": "III. METHODOLOGY", "content": "This section details the framework of SSF, which follows the common logic of memory-based continual learning methods [16], [20]: training the model on a fixed memory buffer, periodically updating the memory buffer/dataset, and fine-tuning the model based on the updated dataset.\nAs shown in Fig. 2, the workflow of SSF comprises four main steps: drift detection, sample selection, memory buffer update, and model fine-tuning, which are executed periodically. The drift detection step identifies significant changes in the distribution. The sample selection step aims to find the most valuable samples for update training/fine-tuning with minimal labeling resources. The memory buffer update step takes different actions based on drift detection results, employing strategic forgetting when drift is detected to help the model adapt quickly to significant changes. Finally, the model fine-tuning step adjusts the model based on the updated memory buffer, ensuring continuous adaptation to new data."}, {"title": "A. Drift Detection", "content": "Considering a scenario where the memory buffer $M_t = \\{(x_i, y_i) | i \\in \\{1,2,...,N\\}\\}$ with size $N$ is updated periodically by new samples/dataset $D_t = \\{(x_i,0) | i \\in \\{1,2,...,N'\\}\\}$, with size $N'$. For the new dataset $D_t$, all new samples are initially unlabeled. When updating the memory buffer, we can label a subset of new samples under labeling resource constraints.\nWe initiate the continual learning process with a critical preliminary step: examining whether the new distribution $P_n = \\{f(x_i) | x_i \\in D_t\\}$ of new dataset $D_t$, has drifted from old distribution $P_o = \\{f(x_i) | x_i \\in M_t\\}$ of the existing memory buffer $M_t$. The superscript 'o' denotes variables related to old samples, while the superscript \u2018n' for new samples. Detecting any such drift is essential, as it sets the stage for subsequent actions based on the drift status.\nTo detect distributional shifts, we employ the Kolmogorov-Smirnov (K-S) test [27], which determines if two discrete samples originate from the same continuous distribution, thereby identifying any significant changes in the distribution. In this context, 'samples' are subsets of data extracted from a larger population. The K-S test is a nonparametric statistical method, which allows for the detection of distribution drifts without specific assumptions about the underlying distribution. This kind of method provides greater flexibility and robustness, particularly useful in scenarios where the exact distribution is unknown. Specifically, the K-S test measures the maximum distance between the empirical cumulative distribution functions of two samples. A large distance suggests the samples may come from different distributions, indicating potential drift between the memory buffer $M_t$ and the new dataset $D_t$.\nThe K-S test produces a p-value, which measures the likelihood that the observed difference between samples could occur if they were from the same distribution. The drift detection result is determined by comparing the p-value with a predefined significance level, typically set at $\\alpha$. We define a decision function $h(\\cdot)$ for drift detection as follows:\n$h(p) = \\begin{cases} 1 & \\text{if } p < \\alpha, \\text{ drift detected,} \\\\ 0 & \\text{if } p \\geq \\alpha, \\text{ no drift detected.} \\end{cases}$\nA p-value less than the significance level $\\alpha$ indicates a significant distribution drift between the memory buffer $M_t$ and the new dataset $D_t$. Conversely, if the p-value is greater than or equal to the threshold, it suggests that there is no significant drift."}, {"title": "B. Strategic Sample Selection", "content": "Before updating the memory buffer by incorporating new samples and discarding old samples, it is essential to identify the most representative samples. Selecting the right samples is critical for effective training, especially when labeling resources and memory resources are limited, as it ensures that the memory buffer contains the most relevant information for the model to learn from with minimal labeling resource cost.\nThis step has two phases: (i) common distribution representation selects old samples to represent the common distribution between the old and new data. Both old samples and new samples can represent the common distribution, but choosing already labeled old samples helps conserve labeling resources; and (ii) distribution drift representation selects new samples to represent the distribution drift between the old and new data. This ensures that the most representative and meaningful new samples are included, maximizing the value of each labeled sample.\nFor common distribution representation, both new and old samples can contribute to the construction of the common distribution between the old and new distributions. However, the distribution drift can only be represented by new samples. Therefore, using old samples to reconstruct the new distribution essentially means selecting old samples that represent the common distribution between the old and new distributions.\nTo achieve this, we introduce a mask vector $m^o = \\{m_1^o, m_2^o,...,m_i^o,...\\}$ for the old samples within the memory buffer $M_t$. Each entry $m_i^o$ in the mask vector represents the selection decision for the corresponding old sample $x_i^o$. The mask values, ranging between 0 and 1, indicate selecting a sample for representing the common distribution when the value is 0.5 or higher, and not selecting it otherwise. We formulate the problem of reconstructing the new distribution with selected old samples $x_i^o$ as:\n$\\min L_{old}, \\text{s.t. } m_i^o \\in [0, 1],$                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    , and   the distribution of its components . The second one is:"}, {"title": "C. Memory Buffer Update with Strategic Forgetting", "content": "The memory buffer update process is essential for maintaining the relevance and effectiveness of the model in the face of changing distributions. The update strategy depends on the outcome of the drift detection $h(p)$. The detailed process is outlined in Algorithm 1, and the specific functions used in this process are described in Algorithm 2.\nAccording to the result of the sample selection, new samples can be classified into two types: representative ($m^n \\geq 0.5$) or non-representative ($m^n < 0.5$) for distribution drift. Similarly,"}, {"title": "D. Model Fine-Tuning", "content": "This step involves updating/fine-tuning the model using the updated memory buffer/dataset, with a strategy of assigning greater weights to new samples for better adaptation to concept drift. Based on the drift detection results $h(p)$, different strategies are employed for each scenario.\nFor intrusion detection using deep learning-based methods, model training typically involves a task-specific loss $L_{task}$. This loss can take various forms, such as cross-entropy loss for classification-based approaches [28]\u2013[30] or contrastive loss [8], [11] for similarity-based approaches, depending on the specific method used to tackle the problem.\nThe task-specific loss $L_{task}$ is generally computed as the sum of individual losses for each sample. In a static environ-"}, {"title": "IV. EXPERIMENTS", "content": "This section presents the experimental setup and results. We detail the datasets, experiment settings, and baseline methods in subsection IV-A. The superior performance of AOC-IDS over the baseline methods in the online setting is demonstrated in subsection IV-B. Additionally, ablation experiments are conducted to illustrate the contribution of sub-components in AOC-IDS in subsection IV-C. The experimental results reveal that our method outperforms the state-of-the-art (SOTA) techniques and underscores the significant contributions of each component in our system to its capacity and adaptability."}, {"title": "A. Dataset Preparation and Experiment Settings", "content": "1) Datasets: We conduct experiments on two datasets that are widely used in network intrusion detection [11], [12], [31], i.e., NSL-KDD and UNSW-NB15.\nThe NSL-KDD dataset comprises 125,973 training samples and 22,544 test samples of network traffic. The UNSW-NB15 dataset is divided into a training set with 175,341 samples and a test set with 82,332 samples.\n2) Baselines: We compare our proposed method with five well-established continual learning methods within the same continual learning setting. The continual learning baselines include AOC-IDS [8], which is specifically designed for the intrusion detection domain, as well as other notable continual learning approaches including Experience Replay (ER) [16], [17], Averaged Gradient Episodic Memory (AGEM) [20], Learning without Forgetting (LwF) [18], and Elastic Weight Consolidation (EWC) [19]."}, {"title": "B. Comparitive Experiments", "content": "We compare SSF against five well-established continual learning methods, as well as a static model for reference. All methods are evaluated under the same continual learning setting, where we can only obtain 1% ground truth labels of new unlabeled samples. Moreover, we highlight the exceptional capacity of SSF in scenarios with extremely limited labeling resources by analyzing its performance across different labeling conditions. Additionally, we provide a visualization example to illustrate how SSF enhances the model's ability.\n1) Overall Performance: As displayed in TABLE I, SSF surpasses other methods in both accuracy and F1 score on the NSL-KDD and UNSW-NB15 datasets. Specifically, our method achieves high detection accuracies of 90.50% and 90.27% on the NSL-KDD and UNSW-NB15 datasets, respectively, demonstrating improvements of approximately 4.0% and 3.7%. Notably, our method is the only one to perform uniformly well on both datasets, while other compared methods either exhibit generally poor performance across both datasets or excel only on one dataset.\nAOC-IDS is designed under the assumption of infinite memory capacity, allowing it to retain all past samples while incorporating new ones. This overlooks the inherent constraints of physical storage, which have finite capacities and cannot store unlimited amounts of data. In a realistic continual learning scenario with finite memory constraints, AOC-IDS loses its effectiveness, indicating that AOC-IDS relies heavily on having access to the entire historical dataset. It lacks the ability to select representative samples and learn rich, concept drift-adaptive information from a limited set of samples.\nBoth ER and AGEM are memory-based continual learning methods that store and replay a subset of past information from previous tasks in a fixed-size memory buffer, similar to our approach. The performance of ER shows improvement compared to the static, non-updated scenario, successfully achieving learning new knowledge without catastrophically forgetting old knowledge. However, this conservative and simple random selection approach is highly likely to miss the most representative samples and fail to capture the most critical samples for adapting to concept drift, preventing it from achieving exceptional performance. Similarly, the moderate performance of AGEM demonstrates that AGEM's approach of preserving past knowledge by gradient projection is far less effective than our method's approach of selecting the most representative samples for drift adaptation. Our method prioritizes learning new, useful knowledge over merely preserving old knowledge, which proves to be more beneficial.\nLwF and EWC, which are regularization-based methods, perform relatively well on the UNSW-NB15 dataset but poorly on the NSL-KDD dataset. These methods do not require retaining past data; instead, they use constraints to mitigate catastrophic forgetting. However, they face significant limitations when the absolute number of new samples available is very small. To be specific, in the NSL-KDD dataset, the model is updated every 5000 samples, providing only 50 new samples (1%) per update. In contrast, the UNSW-NB15 dataset allows for model updates every 20,000 samples, providing 200 new samples (1%) per update. The poor performance of these methods on NSL-KDD can be attributed to their inability to effectively learn from such a small number of new samples, which hampers their ability to update knowledge without disrupting existing information. In contrast, by focusing on identifying and utilizing the most representative samples, we maximize the value of labeled resources. With the help of old samples representing the common distribution for new patterns, our method proves to be particularly advantageous in scenarios with very limited labeling resources.\n2) Accuracy under Different Label Conditions: We analyze the accuracy of our method in comparison to other baseline methods under varying label resource conditions, as illustrated in Fig. 4. It is evident that continual learning is most effective when only a small portion of new samples are labeled. If the majority of new samples are manually labeled, the IDS essentially loses its purpose as an automated detection method. The continual learning method that can operate effectively with fewer labeled resources is superior and more practical."}, {"title": "C. Ablation Experiments", "content": "In this section", "Selection": "We compare our strategic sample selection algorithm with simple random sampling, denoted by 'w/o sample selection'. As shown in TABLE II, the results demonstrate that our strategic sample selection algorithm significantly outperforms random sampling. This indicates that merely selecting samples randomly is likely to miss crucial information"}]}