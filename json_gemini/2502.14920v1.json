{"title": "DISPLAY FIELD-OF-VIEW AGNOSTIC ROBUST CT KERNEL SYNTHESIS\nUSING MODEL-BASED DEEP LEARNING", "authors": ["Hemant Kumar Aggarwal", "Antony Jerald", "Phaneendra K. Yalavarthy", "Rajesh Langoju", "Bipul Das"], "abstract": "In X-ray computed tomography (CT) imaging, the choice\nof reconstruction kernel is crucial as it significantly impacts\nthe quality of clinical images. Different kernels influence\nspatial resolution, image noise, and contrast in various ways.\nClinical applications involving lung imaging often require\nimages reconstructed with both soft and sharp kernels. The\nreconstruction of images with different kernels require raw\nsinogram data and storing images for all kernels increases\nprocessing time and storage requirements. The Display Field-\nof-View (DFOV) adds complexity to kernel synthesis, as\ndata acquired at different DFOVs exhibit varying levels of\nsharpness and details. This work introduces an efficient,\nDFOV-agnostic solution for image-based kernel synthesis us-\ning model-based deep learning. The proposed method explic-\nitly integrates CT kernel and DFOV characteristics into the\nforward model. Experimental results on clinical data, along\nwith quantitative analysis of the estimated modulation trans-\nfer function using wire phantom data, clearly demonstrate the\nutility of the proposed method in real time. Additionally, a\ncomparative study with a direct learning network, that lacks\nforward model information, shows that the proposed method\nis more robust to DFOV variations.", "sections": [{"title": "1. INTRODUCTION", "content": "X-ray computed tomographic (CT) image Kernel Synthesis\n(KS) involves transforming an image reconstructed with one\nkernel into an image reconstructed with another kernel [1, 2,\n3]. This process has various applications, including improv-\ning low contrast distinguishability, enhancing computer-aided\ndetection [4], and facilitating quantitative analysis [5].\nWhen reconstructing an image from raw sinogram data\nusing the filtered back projection (FBP) algorithm, a re-\nconstruction kernel is typically used to emphasize certain\nanatomical regions depending on the application. For in-\nstance, smooth kernels offer excellent low-contrast distin-\nguishability with lower noise and fewer artifacts but have low\nspatial resolution. Conversely, sharp kernels provide high\nspatial resolution but also increase noise and artifacts. If raw\nsinogram data is unavailable or not stored due to large storage\nrequirements, image-based kernel synthesis is used to recon-\nstruct images with different kernels. However, image-based\nkernel synthesis remains a challenging inverse problem, as the\nsynthesis must be robust to variations in the display field of\nview (DFOV) of the reconstructed images. For instance, Fig-\nure 1 illustrates the modulation transfer functions (MTFs) of\nsmooth (input) and sharp (target) kernels at different DFOVs,\nranging from 5 cm to 20 cm. It is evident from the plots\nthat varying DFOVs result in different resolutions of recon-\nstructed images. The effect of DFOV on image quality (IQ)\nis further demonstrated in Figure 2 using real water phantom\ndata, where an increase in DFOV corresponds to increased\nspeckle sharpness. In addtion to DFOV variations, manag-\ning artifacts and noise is another challenge in image-based\nkernel synthesis, especially when converting from smooth to\nsharp kernel images. Ohkubo et al. in [6] proposed a direct\nkernel synthesis method that employs the ratio of modulation\ntransfer functions (MTFs) between input and target kernels to\ntransform images. This method is inherently robust to vari-\nations in the display field of view (DFOV) but often results\nin decreased image quality (IQ), particularly when converting\nsmooth to sharp kernel images, due to amplified noise and\nartifacts in the reconstructed images.\nRecently, several deep learning methods have been pro-\nposed to address kernel synthesis problem. Unlike direct ker-\nnel synthesis methods, these approaches are effective at man-\naging noise during image transformation but struggle with\nvariations in DFOVs. For example, a simple direct learn-\ning method like U-Net [7], trained on a specific DFOV, does\nnot perform well when applied to data with different DFOVs.\nSimilarly, experiments show that a network trained on data\nfrom all DFOVs tends to bias towards a specific DFOV.\nTo overcome this issue, we propose a model-based deep\nlearning method that explicitly incorporates kernel MTFs into\nthe deep learning framework. The proposed architecture for\nsolving kernel synthesis problem consists of two parts: a deep\nlearning-based projection step and an iterative data consis-\ntency solver that utilizes these MTFs. Enforcing data con-\nsistency during the training of the denoising network makes\nthe kernel synthesis solution DFOV-agnostic, allowing a sin-\ngle network to be trained across various DFOVs with the ad-\nvantage of requiring only a few hundred training samples.\nThis work complements our previous research [8] by de-\nveloping a deep model in a supervised manner that is agnostic\nto DFOV using clinical data whereas previous work [8] fo-\ncused on self-supervision using single-slice for noise aware\nkernel synthesis. A continuous kernel synthesis approach has\nbeen discussed in [9] but it is self-supervised. In contrast\nto [9], our proposed method is supervised learning with fo-\ncused on DFOV and CT noise awareness."}, {"title": "2. PROPOSED METHOD", "content": "The image-domain kernel synthesis can be expressed as a lin-\near inverse problem of the form\n$$y = Hx + n,$$\n(1)\nwhere y \u2208 $\\mathbb{R}^{N}$, N = p \u00d7 q represents vectorized input kernel\nimage of p rows and q columns, x \u2208 $\\mathbb{R}^{N}$ is the target kernel\nimage which needs to be synthesized, H is the forward op-\nerator representing kernel synthesis process having input and\ntarget kernel information at specific DFOV. More specifically,\nusing diagonalization, H can be expressed as H = $\\mathcal{F}^{T}$ A$\\mathcal{F}$ where, $\\mathcal{F}$ is the Fourier transform operator, A represents a\nDFOV dependent ratio of input and target CT kernel's modu-\nlation transfer function (MTF). Unlike tradition inverse prob-\nlems in imaging, n is a kernel and DFOV dependent noise that\nis assumed to be additive, as discussed in Fig. 2.\nIt is possible to utilize a direct learning approach such as\nUNet that takes y as input and \u00e6 as target and learns a map-\nping x = CNN(y) between input and target pair of images to\nresult in network prediction 2. However, such a direct learn-\ning approach depends on the large amount of training dataset\nconsisting of DFOV variation which is difficult to collect for\nx-ray CT imaging. Further, without the explicit information\nabout the Kernel's MTF and DFOV, the learned model does\nnot necessarily leads to data-consistent result as demonstrated\nin the experimental results in Fig. 4.\nThis work propose to find a solution to kernel synthesis in-\nverse problem (1) using model-based deep learning [10] and\nrepresents the network regularized optimization problem in\nthe form\n$$\\mathop{\\arg \\min}_{xz} ||y - Hx||_{2}^{2} + \\lambda ||x - z||_{2}^{2},$$\n(2)\nwhere, z represents the output of a CNN that satisfy data con-\nsistency constraint as explicitly implied by the above prob-\nlem formulation. Here, A is a regularization parameter initial-\nized with 0.5 and decayed with iteration, Ak+1 = 0.9Xk, to\ngradually give more importance to data consistency term. The\nabove problem (2) can be solved iteratively in two steps using\nalternating minimization as follows:\n$$z_{k} = CNN(x_{k})$$\n(3)\n$$x_{k+1} = \\mathcal{F}^{T} (\\frac{\\mathcal{F}(H^{T} y + \\lambda z_{k})}{\\mathcal{A}^{2} + \\lambda} )$$\n(4)\nwhere xo can be initialized as Tikhonov solution of the form\nx0 = ($\\mathcal{H}^{H}$$\\mathcal{H}$ + \\$\\lambda$I)$^{-1}$$\\mathcal{H}^{H}$y, here I is identity matrix. The\nanalytical solution in Eq. (4) assumes zk to be constant for the\ndata-consistency problem.\nAs visually demonstrated in Fig. 2, DFOV impacts the\ntexture of water phantom data, which is used as noise during\nnetwork training. Fig. 3 presents a schematic diagram of the\nend-to-end network training strategy using supervised learn-\ning with existing clinical data from different DFOVs. The use\nof DFOV-dependent water phantom data as noise allows for\ncontrolling the enhancement of noise and artifacts during the\niterative reconstruction process."}, {"title": "3. TRAININGS AND EXPERIMENTS", "content": "Two separate supervised training setups were used. The first\nwas a direct learning method that trained a U-Net to perform\ncombined DFOV training without kernel MTF information.\nThe second was the proposed method, which employed a U-\nNet with weight sharing across five unrolls and incorporated\nexplicit DFOV and kernel information in the forward model.\nThe networks were trained using existing clinical lung\nimages obtained from the GE Revolution Ascend system,\nacquired with 120 kVp and 544 mA, and reconstructed with\ndifferent DFOV values of 5 cm, 10 cm, 15 cm, and 20 cm. The\ntraining data consisted of 1280 slices, each of size 512 \u00d7 512,\nfrom different subjects. STANDARD kernel images were\nused as input, and LUNG kernel images were used as target\nimages for all DFOVs. Both networks were trained for 500\nepochs with an initial learning rate of 1 \u00d7 10\u22124, using mean\nsquare error (MSE) combined with the structural similarity\nindex (SSIM) as the loss function. Following the training, the\nperformance of the trained networks was verified using both\nclinical and phantom data across various DFOV.\nIn the first experiment, we compared the reconstruction\nquality of the proposed method with that of the direct learn-\ning method. Fig. 4 shows portions of the input and target\nkernel images, along with the outputs of the direct learning\nmethod and the proposed method for DFOV 5 cm and DFOV\n10 cm, respectively, in the top and bottom rows. The proposed\nmethod achieves sharpness closer to the ground truth while\npreserving structural information, unlike the direct learning\nmethod, which results in blurred images with hallucinations,\nas indicated by the green circle and red arrow.\nIn the second experiment, we quantitatively evaluated the\nperformance of the proposed method by estimating the MTF\non the DFOV 10 cm wire phantom data. Figure 5(a) shows\nthe wire phantom images for the input, target, direct learn-\ning method, and proposed method. It is evident from the im-\nages that the wire image produced by the proposed method\nis closer to the target wire image compared to the wire im-\nage from the direct learning method. Figure 5(b) displays the\nMTFs estimated for the proposed method and the direct learn-\ning method, compared with the input and target MTFs. The\nestimated MTF by the proposed method shows a higher mid-\nfrequency boost compared to the direct learning method and\nis closer to the target."}, {"title": "4. CONCLUSIONS", "content": "This work presented a DFOV-agnostic image-based kernel\nsynthesis method that performs kernel synthesis which is\nrobust to input noise. This method significantly improves\ndisease diagnosis and treatment by enhancing the visibility\nand precision of anatomical structures such as bones, vessels,\nand lesions as shown by converting smooth kernel images to\nsharp kernel images."}, {"title": "5. COMPLIANCE WITH ETHICAL STANDARDS", "content": "This research study was conducted using human subject\ndata made available through appropriate research contracts.\nAll the activities necessary for obtaining the research re-\nsults/development were carried out with due approval from\nthe ethics committee and competent authorities in compliance\nwith the regional laws and regulations."}]}