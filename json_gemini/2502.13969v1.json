{"title": "Bridging Simulation and Reality: A 3D Clustering-Based Deep Learning Model for UAV-Based RF Source Localization", "authors": ["Saad Masrur", "\u0130smail G\u00fcven\u00e7"], "abstract": "Localization of radio frequency (RF) sources has critical applications, including search and rescue, jammer detection, and monitoring of hostile activities. Unmanned aerial vehicles (UAVs) offer significant advantages for RF source localization (RFSL) over terrestrial methods, leveraging autonomous 3D navigation and improved signal capture at higher altitudes. Recent advancements in deep learning (DL) have further enhanced localization accuracy, particularly for outdoor scenarios. DL models often face challenges in real-world performance, as they are typically trained on simulated datasets that fail to replicate real-world conditions fully. To address this, we first propose the Enhanced Two-Ray propagation model, reducing the simulation-to-reality gap by improving the accuracy of propagation environment modeling. For RFSL, we propose the 3D Cluster-Based RealAdaptRNet, a DL-based method leveraging 3D clustering-based feature extraction for robust localization. Experimental results demonstrate that the proposed Enhanced Two-Ray model provides superior accuracy in simulating real-world propagation scenarios compared to conventional free-space and two-ray models. Notably, the 3D Cluster-Based RealAdaptRNet, trained entirely on simulated datasets, achieves exceptional performance when validated in real-world environments using the AERPAW physical testbed, with an average localization error of 18.2 m. The proposed approach is computationally efficient, utilizing 33.5\u00d7 fewer parameters, and demonstrates strong generalization capabilities across diverse trajectories, making it highly suitable for real-world applications.", "sections": [{"title": "I. INTRODUCTION", "content": "Unmanned aerial vehicles (UAVs) have become essential tools for applications such as search and rescue, surveillance, and radio frequency (RF) source localization [1]. Their flexibility, cost-effectiveness, and autonomous 3D navigation capabilities make them well-suited for enhancing coverage and efficiency in localization tasks [2]. Accurately modeling the air-to-ground (A2G) wireless channel is crucial for advancing UAV-assisted sensing and localization. Various studies have explored RF source localization (RFSL) using UAVs, employing conventional algorithms such as linear least squares and particle filters [1], [3]. The impact of transmitter and receiver antenna patterns on localization accuracy is analyzed in [4], while their effect on A2G propagation models is quantified in [5].\nMost UAV-based localization studies use the free-space path loss model for outdoor propagation due to its simplicity [1]. Traditional free-space and two-ray propagation models [6], while simple, fail to capture the complexities of real-world environments, leading to a gap between simulated and real-world performance. Received signal strength (RSS) at the UAV is significantly influenced by factors such as dynamic 3D propagation conditions, UAV movements (roll, pitch, and yaw), the 3D radiation pattern of the antenna, multipath effects, and shadowing caused by the UAV's structure. These factors can cause power variations of up to 60 dB for narrow-band links, making accurate modeling essential. In [7], the authors investigated the impact of UAV movements on the temporal autocorrelation function (ACF) of the A2G wireless channel, modeling the UAV movements as positional variations of the UAV but neglecting their effect on antenna gains.\nTo address these challenges, we propose an enhanced two-ray propagation model that incorporates UAV dynamics and structural shadowing to bridge the simulation-to-reality (sim2real) gap. While fingerprint-based localization using deep learning (DL) has seen significant advancements, particularly for outdoor applications [8], [9], most existing DL-based localization solutions are trained and evaluated solely on simulated datasets. Such approaches often fail to perform effectively in real-world scenarios due to the inherent disparities between simulated and real-world environments. Recognizing this critical limitation, we introduce the 3D Cluster-Based RealAdaptRNet, a model specifically designed to generalize from simulated training to real-world deployments. The model is trained entirely on simulated datasets for scalability and computational efficiency, but its performance is rigorously validated using real-world data collected on the Aerial Experimentation and Research Platform for Advanced Wireless (AERPAW) physical testbed. Unlike existing methods, our approach explicitly addresses the sim2real gap, demonstrating that DL models trained on simulations can achieve exceptional accuracy and generalization when tested in real-world environments."}, {"title": "II. SYSTEM MODEL", "content": "The AERPAW [10] is a state-of-the-art testbed for wireless research using UAVs. In Fall 2023, AERPAW hosted the AERPAW Find a Rover (AFAR) competition, which challenged participants to design and implement algorithms for UAVs equipped with wireless receivers to localize a hidden ground-based RF source transmitting a narrowband signal with a 12 kHz bandwidth. The algorithms were developed in the Digital Twin of AERPAW [10]. Several teams contributed innovative localization approaches and algorithms during the competition [11], [12]. Building on the AFAR competition's objectives, this paper proposes a robust solution for accurate ground-based RFSL. The RF source position, $P_{RF} = (x, y, z)$, lies within the green region shown in Fig. 1, while the UAV operates within the blue-shaded region in Fig. 1 for a duration of $T = 10$ minutes.\nThe UAV, serving as the receiver, measures RSS at an interval of 0.03 seconds. Consequently, the total number of received samples can be approximated as $S = \\frac{T}{0.03}$. The discretized position of the UAV for the s-th collected sample is represented as $l_{uav,s} = (r_{x,s}, r_{y,s}, r_{z,s})$, where $s \\in \\{1, 2, ..., S\\}$. The corresponding RSS at this position is denoted by $P_{r,s}$. Over the complete UAV flight duration T, the set of RSS values collected is represented as $p_r \\in R^{S \\times 1}$. The associated x- and y-coordinates of the UAV's trajectory are denoted by $r_x, r_y \\in R^{1xs}$, respectively, forming a comprehensive mapping of the UAV's spatial positions and RSS measurements. Upon completing its flight, the UAV estimates the RF source's location, $P_{RF} = (x, y)$, by analyzing the collected RSS measurements $p_r$, assuming the source is fixed at a height of $z = 5m$ and limiting the estimation to 2D positioning.\nTrajectory planning can be categorized into two primary approaches: fixed waypoints and autonomous-waypoints. In the fixed-waypoint approach, the UAV follows a predefined flight path uploaded prior to deployment, systematically collecting RSS measurements along this trajectory. Conversely, the autonomous trajectory approach enables the UAV to dynamically adjust its waypoints based on observed signal strength or other experimenter-defined criteria.\nThis study employs a fixed-plan trajectory due to its predictability and systematic coverage, ensuring comprehensive data collection without any regions being overlooked. The UAV operates at a constant altitude of $r_{s,z} = 30 m$ for all $s \\in \\{1, 2, ..., S\\}$, simplifying navigation and minimizing path deviations. The selected spiral trajectory, illustrated in Fig. 1 (blue solid lines), covers the overlapping area of the green and blue regions. The lower half of the blue region is excluded, as it contains no RF sources, and flying there will be of no use. This design allows efficient RSS data collection within the given operational time constraints."}, {"title": "A. Two Ray Model", "content": "The Free Space Path Loss (FSPL) model, widely used for A2G propagation in line-of-sight (LoS), is simple but ignores multipath and environmental factors [2]. To address this, we build upon the two-tay A2G model which describes the RSS as the combined effect of the LoS and reflected ray, and is mathematically expressed as [5]:\n$P_{2ray}(\\theta, \\phi) = \\frac{P_t}{(\\frac{4\\pi}{\\lambda})^2} \\sqrt{G_{tx}(\\phi_l,\\theta_l)G_{rx}(\\phi_l,\\theta_l)}\\frac{1}{d_3} + \\Gamma(\\theta) \\sqrt{G_{tx}(\\phi_r,\\theta_r)G_{rx}(\\phi_r,\\theta_r)}e^{-jV_{phase}}\\frac{1}{d_1 + d_2}^2$\nwhere $p_{2ray}$ represents the RSS, $P_t$ denotes the transmitted signal power, and $\\lambda$ is the wavelength of the transmitted signal. $\\theta_l = tan^{-1}(\\frac{z+r_z}{d_{2D}})$ and $\\theta_r = tan^{-1}(\\frac{r_z-z}{d_{2D}})$ are the elevation angles for the LoS and reflected rays, respectively. The distances $d_1, d_2, d_3$ are defined in Fig. 2. Additionally, $\\phi_l$ and $\\phi_r$ denote the azimuth angles for the LoS and reflected rays, respectively, while $G_{tx}$ and $G_{rx}$ represent the transmitter and receiver antenna gains as functions of $\\theta$ and $\\phi$. These gains encapsulate the directional characteristics of the antennas and their dependence on the geometric orientation of propagation paths. $V_{phase}$ represents the phase difference between the two propagation paths, and $\\Gamma(\\theta)$ denotes the ground reflection coefficient [5].\nAntenna gain, a critical factor in A2G propagation models, directly influences the RSS. Two approaches are employed to evaluate its impact on the A2G propagation model. The first utilizes an elevation-angle-dependent \"donut-shaped\" dipole antenna pattern, with the expressions for $G_{tx}$ and $G_{rx}$ provided in [1]. The second approach utilizes measured 3D antenna patterns obtained through anechoic chamber measurements. The transmitter and receiver antenna (RM-WB1-DN) pattern is sourced from the IEEE DataPort repository [6]. As emphasized in [5], incorporating realistic antenna patterns significantly enhances the accuracy of the two-ray model, achieving closer alignment with measured RSS."}, {"title": "B. Enhanced Two-Ray Model", "content": "The conventional two-ray model, commonly used in A2G communication, captures RSS variations but fails to account for UAV dynamics, including roll $(\\Phi_r)$, pitch $(\\Phi_p)$, and yaw $(\\Phi_y)$, as well as shadowing from the UAV's structural components (i.e., legs). These limitations hinder its ability to accurately model the complexities of the A2G propagation environment. In particular, $\\Phi_r$, $\\Phi_p$, and $\\Phi_y$ represent the UAV's rotational dynamics around its longitudinal (x, nose-to-tail), lateral (y, side-to-side), and vertical (z) axes, respectively. These rotations alter the antenna's $\\theta$ (elevation) and $\\phi$ (azimuth) angles relative to the receiver, directly impacting antenna gain and LOS conditions. Specifically, roll modifies the azimuth by tilting the main lobe sideways, pitch adjusts the elevation by tilting the lobe upward or downward, and yaw alters the azimuth by rotating the antenna horizontally. Accurate modeling of the A2G propagation model requires accounting for these orientation changes, particularly for UAVs equipped with highly directional antennas.\nThe objective is to update the $\\theta$ and $\\phi$ angles defining the antenna's direction relative to the receiver after UAV movements $(\\Phi_r, \\Phi_p, \\Phi_y)$. This is achieved by applying the combined rotation matrix to the initial direction vector,"}, {"title": "III. DL-BASED MODEL FOR RF LOCALIZATION WITH UAV", "content": "This section presents a DL-based approach for RFSL, utilizing RSS measurements collected by the UAV during its flight. The proposed approach is trained on simulated datasets generated using the A2G models described in Section II and validated in real-world scenarios using the AERPAW testbed. Although the enhanced two-ray model improves the accuracy of simulations, it cannot fully replicate the complexities of real-world environments. Consequently, a simple DL model may struggle to generalize effectively. To address this, we propose the 3D Clustering-Based RealAdaptRNet model, designed to overcome the sim2real gap and enhance localization performance.\nThe overall DL pipeline for RFSL is depicted in Fig. 3. The pipeline operates in two phases: (1) Offline Training Phase and (2) Online Testing Phase. In the offline training phase, the proposed RealAdaptRNet model is trained on datasets generated from the A2G propagation models described in Section II. For the A2G propagation model, a dataset of N data points was generated by randomly placing the RF source at N distinct locations. For each RF location, the UAV completed its spiral trajectory, collecting RSS measurements to form the dataset. Each data-point, denoted as $P_{r,n} = [P_{E-2ray}, P_{E-2ray}]^T \\in R^{(S \\times 1)}$, represents the RSS measurements for the n-th RF source location generated using the enhanced two-ray (E-2ray) model\u00b9, where $n \\in (1,......,N)$, while the output is the estimated 2D coordinates of the RF source, $P_{RF,n} \\in R^{(1 \\times 2)}$. The online phase involves deploying the trained RealAdaptRNet model in the AERPAW testbed for real-world localization."}, {"title": "A. Data Preprocessing", "content": "UAV during its trajectory collects roughly $S = 20k$ RSS samples, directly using such a large number of samples for DL-based localization significantly increases the model's computational complexity in terms of FLOPs and parameters. To address this, and considering that RSS values often exhibit deep fades, we group the RSS samples $p_{r,n}$ into non-overlapping segments of size $S_g$. To reduce the data size and smooth the RSS signals while preserving key information, the average RSS value is computed for each group, with the resulting output denoted as $p'_{r,n} \\in R^{1 \\times S/N_g}$.\nRSS measurements are smoothed using discrete convolution with a Gaussian kernel g:\n$g(\\mu) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} exp(-\\frac{\\mu^2}{2\\sigma^2})$\nwhere \u03bc ranges from $-\\lfloor{k_s/2}\\rfloor$ to $\\lfloor{k_s/2}\\rfloor$ and $k_s = 6\\sigma + 1$. The kernel is normalized so that $\\Sigma_\\mug(\\mu) = 1$. The smoothed RSS values $p'_{r,n}$ are then obtained by convolving the raw measurements $p_{r,n}$ with $g(\\mu)$ as:\n$P_{r,n}[i] = \\sum_{\\mu=-\\lfloor{k_s/2}\\rfloor}^{\\lfloor{k_s/2}\\rfloor} p[i - \\mu]g(\\mu).$\nThis filtering step reduces high-frequency noise while preserving the underlying signal trend.\nAs a baseline, we also considered using the Normalized RSS, denoted as $\\tilde{p}_{r,n}$, as input to the RealAdaptRNet model (to be defined in Subsection III-C) for localization. Gaussian filtering is excluded in this setup since the model's convolutional layers inherently perform the smoothing operation."}, {"title": "B. 3D Clustering", "content": "After Gaussian smoothing, the processed data for the n-th RF source location is represented as $D_n = [r_{x,n}, r_{y,n}, P'_{r,n}]$. A 3D clustering approach is then applied using k-nearest neighbors (KNN) on $D_n$, partitioning the data into clusters $C_k$, where black lines differentiate samples belonging to each cluster. While the clustering is depicted for visualization purposes in 2D, the actual clustering is performed in 3D space, incorporating both spatial coordinates and RSS values ($P'_{r,n}$) to effectively capture the spatial and signal characteristics of the UAV's trajectory.\nUnlike traditional clustering based solely on RSS values, which may group distant points with similar signal levels into the same cluster, the 3D clustering strategy effectively captures both the spatial and signal characteristics of the UAV's trajectory. This prevents the merging of spatially distant but signal-similar points, which can occur due to multipath effects or shadowing.\nFor each cluster $C_c$, where $c \\in \\{1, . . ., T_c\\}$, the $n_t$ samples with the highest RSS values are identified and denoted as $P''_{r,n,c} = max(P'_{r,n,c}, n_t)$, where $P'_{r,n,c}$ represents the complete set of RSS measurements associated with cluster $C_c$. The corresponding coordinates $(\\tilde{r}_{x,n,c}, \\tilde{r}_{y,n,c})$ associated with the highest RSS values are similarly selected. These selected samples are depicted in circles within each cluster in Fig. 4a. This process forms regions reflecting different proximities to the RF source-some near the source with high RSS values and others farther away with lower RSS values. This ensures the selected high-RSS samples provide a well-distributed representation of the UAV's trajectory, avoiding bias toward densely sampled areas or specific points. The average RSS for the selected highest values is computed as $\\overline{P''_{r,n,c}} = \\frac{1}{m} \\sum_{j=1}^m P''_{r,n,c}(j)$. Similarly, the corresponding mean coordinates are denoted by $(\\overline{r}_{x,n,c}, \\overline{r}_{y,n,c})$.\nBy prioritizing high-RSS samples within spatially coherent clusters, and taking the average, the proposed approach mitigates the effects of multipath fading and reduces sensitivity to outliers.\nThe vector $\\overline{P''_{r,n}}$, called the 3D Clustering input, is formed by concatenating average RSS values with centroid coordinates of all clusters and serves as input to the RealAdaptRNet model. Formally, it is represented as:\n$\\overline{P''_{r,n}} = [\\overline{r_{x,n,C_1}}, \\overline{r_{y,n,C_1}}, \\overline{P''_{r,n,C_1}},  ..., \\overline{r_{x,n,C_k}}, \\overline{r_{y,n,C_k}}, \\overline{P''_{r,n,C_k}}]^T \\in R^{3C_k \\times 1}.$\nThis input vector provides a structured and concise representation of the key spatial and signal characteristics for the RFSL task. Using 3D clustering offers several advantages over directly inputting all RSS values $P'_{r,n}$ into the model for localization. The proposed clustering approach reduces the input size significantly, thereby lowering computational complexity and memory usage. Additionally, it improves the"}, {"title": "C. RealAdaptRNet Model", "content": "Our proposed RealAdaptRNet model as shown in Fig. 4b leverages a hybrid 1D ResNet-MLP architecture designed to estimate precise RF source position. The one-dimensional input (i.e., $\\overline{P''_{r,n}} \\in R^{3C_k \\times 1}$, or, $\\tilde{p}_{r,n} \\in R^{S/N_g \\times 1}$) is transformed by the first convolutional layer into an expanded feature space of dimension $R^{N_{inp} \\times f}$, where $f$ represents the number of filters in the convolutional layer, and $N_{inp}$ in the input size of one data samples (i.e., $N_{inp} = 3C_k$ for 3D clustering approach). This transformation projects the input into a multi-channel representation, allowing the network to capture diverse and complex feature patterns crucial for spatial feature extraction. The network is composed of multiple convolutional blocks with residual connections to preserve information and stabilize gradient flow. Each block consists of 1D convolutions (kernel sizes of $k = 3$ or $k = 1$), batch normalization, ReLU activations, and average pooling for effective feature extraction and dimensionality reduction. The MLP head consists of $N_{MLP} = 4$ fully connected layers that progressively reduce the feature space, outputting the predicted 2D coordinates."}, {"title": "IV. NUMERICAL RESULTS AND ANALYSIS", "content": "In the numerical analysis, the transmit power and central frequency were set to $P_t = 41$ dBm and $f_c = 3.32$ GHz, respectively, with a relative permittivity of $\\epsilon_0 = 2$. To simulate UAV movement effects, the roll $(\\Phi_r)$, pitch $(\\Phi_p)$, and yaw $(\\Phi_y)$ angles were uniformly sampled from $U(-5^\\circ, 5^\\circ)$. The angular spread was set to $\\Delta = 5^\\circ$, the shadowing threshold elevation angle to $\\delta = 10^\\circ$, and the reference distance to $d_0 = 1$ m. Gaussian noise with zero mean and unit variance is added to the RSS for training, and Y is obtained using the linear least squares method. To reduce data dimensionality, a grouping factor of $N_g = 2$ was applied, halving the number of samples. Gaussian smoothing with a kernel $(\\sigma = 20)$ mitigated high-frequency noise while preserving signal characteristics. The RSS values were clustered into $C_k = 20$ clusters, and the top $n_t = 40$ RSS samples from each cluster were selected to construct the feature vectors. The proposed RealAdaptRNet algorithm is implemented using Jax and Flax libraries."}, {"title": "A. Analysis of Enchaned Two Ray Path Loss Model", "content": "This section evaluates the performance of the proposed enhanced two-ray model against the two-ray and free-space propagation models. Fig. 5 illustrates the absolute error (dB) between the measured real-world RSS and the predictions from the free-space, two-ray with \"donut-shaped\" gains, and enhanced two-ray propagation models. The free-space and two-ray models exhibit comparable performance; however, the two-ray model occasionally performs worse due to the oversimplified antenna gain assumptions. In contrast, the enhanced two-ray model demonstrates superior accuracy, with over 90% of the errors contained within 22 dB, outperforming both the free-space and standard two-ray models. By integrating antenna directionality through the angles $\\Phi_r$, $\\Phi_p$, $\\Phi_y$ and accounting for UAV body-induced shadowing effects, the model effectively captures real-world RSS variations, making it highly reliable for realistic propagation scenarios."}, {"title": "B. Analysis of RealAdaptRNet model for RFSL", "content": "This subsection evaluates the real-world localization performance of the proposed 3D Cluster-Based RealAdaptRNet model, focusing on its ability to generalize from simulated datasets to real-world scenarios. Results on the simulated dataset are omitted due to space constraints. Experimental trials were conducted using the AERPAW testbed, with the RF source placed at two distinct locations for validation, referred to as trials. In Trial 1, the RF source was positioned at $P_{RF} = (17.67, 194.29, 5)$ m. For Trial 2, to evaluate the robustness of the proposed method, the RF source was placed outside the overlap region, within the green area depicted in Fig. 1, at $P_{RF} = (206,275.80, 5)$ m, as illustrated in Fig. 1.\nPerformance Evaluation of 3D Clustering and Propagation Models: In this subsection, the performance of the RealAdaptRNet model is evaluated using the enhanced two-ray propagation model with two input representations: the proposed 3D clustering approach ($\\overline{P''_{r,n}}$) and the normalized RSS approach ($\\tilde{p}_{r,n}$). Furthermore, the model trained with the enhanced two-ray propagation model is compared to its counterpart trained with the free-space model, both utilizing the 3D clustering approach, to assess the impact of different propagation models on localization performance."}, {"title": "V. CONCLUSION", "content": "This study addresses the gap between simulated and real-world scenarios by introducing an enhanced two-ray propagation model that accounts for UAV dynamics' impact on antenna gains and shadowing caused by the UAV structure. While simulations cannot fully replicate real-world complexities, the proposed 3D Cluster-Based RealAdaptRNet model bridges this gap by learning from simulated datasets and delivering accurate RFSL in real-world conditions. The 3D clustering approach significantly improves localization accuracy compared to normalized RSS input, reducing the average error from 48.42 m (normalized RSS) to 47.61 m with the free-space model and further to 16.12 m with the enhanced two-ray model. The proposed method also achieves a 33.5\u00d7 reduction in parameters, significantly lowering computational complexity without compromising performance. Validation on the AERPAW testbed confirms the model's robustness and generalization capabilities, achieving an average error of 35.403 m across all trials and trajectories, even when tested on trajectories different from those used during training. Future work will focus on further narrowing the sim2real gap, exploring adaptive trajectory planning, and developing advanced methods to enhance localization accuracy and efficiency."}]}