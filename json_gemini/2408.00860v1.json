{"title": "UlRe-NeRF: 3D Ultrasound Imaging through Neural Rendering with Ultrasound Reflection Direction Parameterization", "authors": ["Ziwen Guo", "Zi Fang", "Zhuang Fu"], "abstract": "Three-dimensional ultrasound imaging is a critical technology widely used in medical diagnostics. However, traditional 3D ultrasound imaging methods have limitations such as fixed resolution, low storage efficiency, and insufficient contextual connectivity, leading to poor performance in handling complex artifacts and reflection characteristics. Recently, techniques based on NeRF (Neural Radiance Fields) have made significant progress in view synthesis and 3D reconstruction, but there remains a research gap in high-quality ultrasound imaging. To address these issues, we propose a new model, UlRe-NeRF, which combines implicit neural networks and explicit ultrasound volume rendering into an ultrasound neural rendering architecture. This model incorporates reflection direction parameterization and harmonic encoding, using a directional MLP module to generate view-dependent high-frequency reflection intensity estimates, and a spatial MLP module to produce the medium's physical property parameters. These parameters are used in the volume rendering process to accurately reproduce the propagation and reflection behavior of ultrasound waves in the medium. Experimental results demonstrate that the UlRe-NeRF model significantly enhances the realism and accuracy of high-fidelity ultrasound image reconstruction, especially in handling complex medium structures.", "sections": [{"title": "Introduction", "content": "Ultrasound (US) is a highly valued imaging modality in medicine due to its cost-effectiveness, safety, non-invasiveness, and ability to provide real-time imaging. Unlike MRI and CT, US is portable, radiation-free, and user-friendly, making it ideal for various clinical applications, including intraoperative imaging and surgical guidance. Its affordability and efficiency have led to its growing popularity among clinicians and researchers. Compared to conventional two-dimensional (2D) ultrasound, three-dimensional (3D) ultrasound offers significant advantages. 3D ultrasound allows direct visualization of 3D anatomy, enhancing diagnostic accuracy and reducing dependence on operator skill, while providing"}, {"title": "Related Works", "content": "Neural Radiance Fields (NeRF) uses implicit representation and explicit rendering to achieve novel view synthesis [14]. Given any input 3D position x and view direction d, NeRF uses a spatial MLP to output the density \u03c3(x) and bottleneck vector b(x) from 3D position x, and then use a second directional MLP to outputs the color of light c(x, d) emitted by a particle at 3D position x and direction"}, {"title": "Methods", "content": "NeRF and its early variants perform poorly in parameterizing reflection directions and handling high-frequency information, especially in complex media"}, {"title": "Ultrasound Reflection Direction Parameterization", "content": "To better simulate the reflection characteristics of ultrasound waves at the medium interface, we propose a new method for parameterizing reflection directions, as shown in Figure 2(a). The reflection and refraction properties of ultrasound waves, treated as rays, can be calculated using the laws of wave physics [21]. When an ultrasound wave \\(I_i\\) impinges on the medium interface at a certain angle, reflection and refraction occur. The intensities of reflection and"}, {"title": "Reflective Harmonic Encoding", "content": "In the traditional NeRF framework, positional encoding methods have limitations when handling high-frequency information, leading to an inability to accurately reproduce high-frequency details in the propagation of ultrasound waves [9] [14]. This poses challenges in simulating the behavior of ultrasound waves in various media, especially in biological tissues with complex structures and heterogeneous properties, where traditional methods fail to accurately capture reflection direction information. To address this issue, we drew inspiration from the Integrated Directional Encoding (IDE) method in Mip-NeRF [2] and applied it to ultrasound imaging, calling it Reflective Harmonic Encoding (RHE). RHE uses spherical harmonics to encode high-frequency information of reflection directions, making it particularly suitable for biological tissues with complex characteristics [1]. It finely encodes reflection directions, improving reconstruction accuracy. Specifically, we use the von Mises-Fisher (vMF) distribution to define the distribution of reflection directions and encode these directions using a set of spherical harmonics. First, we define the distribution of reflection directions on the unit sphere using the von Mises-Fisher distribution, centered at the reflection vector \\(\\hat{I}_r\\), with the concentration parameter \\(\\kappa\\) defined as the reciprocal of roughness \\(\\rho\\), \\(\\kappa = 1/\\rho\\). Next, we represent the encoding of reflection directions using a weighted sum of spherical harmonic functions \\(\\{Y^l_m\\}\\). The encoding form under the vMF distribution is defined as:\n\\[\nRHE \\left(\\mathbf{I}_r, L\\right)=\\sum_{(l, m) \\in L} A_{\\ell}(\\kappa) Y_{\\ell}^m\\left(\\mathbf{I}_r\\right)\n\\]\nWhere L represents the set of spherical harmonic functions. The weighting function \\(A_{\\ell}(\\kappa)\\) depends on the concentration parameter \\(\\kappa\\) and can be approximated by the following formula:\n\\[\nA_{\\ell}(\\kappa) \\approx \\exp \\left(-\\frac{\\ell(\\ell+1)}{2 \\kappa}\\right)\n\\]\nThis encoding method allows us to more accurately capture and express information about ultrasound wave reflections. Through RHE, we can finely encode these reflection directions, significantly improving the accuracy of boundary reconstructions. Especially when dealing with reflections in complex tissue structures and rich details, RHE provides higher resolution and accuracy."}, {"title": "Sine Activation Function", "content": "Sinusoidal representation networks (SIRENs) [23] utilize sine as the activation function in MLPs to model high-frequency information accurately. They introduced an initialization scheme to prevent vanishing gradients in periodic activation functions, showing that SIRENs fit complex signals and their derivatives robustly. This provides a solid foundation for using the Sine activation function in ultrasound image reconstruction. The periodicity and continuity of the Sine activation function enable it to capture high-frequency components and subtle variations effectively. Its expression is:\n\\[\nSine (x) = sin(x)\n\\]\nCompared to traditional activation functions like ReLU and Sigmoid, which are sensitive to initial parameters and unstable with complex signals, the Sine activation function is more stable and robust over a wide range of parameters [16]. In the Ultra-NeRF model, results were initially unstable and highly dependent on network configuration. By introducing the Sine activation function, our model demonstrated more consistent performance across different initial configurations, reducing the impact of initial settings on the final imaging outcome. This improvement enhances the model's robustness and stability, making it better suited for various configurations and complex ultrasound imaging scenarios."}, {"title": "Ultrasound Neural Rendering Architecture", "content": "To address the complexity of ultrasound scenes and accurately reconstruct ultrasound characteristics within the medium, we designed an ultrasound neural rendering architecture based on implicit neural networks and volume rendering (as shown in Figure 3). This architecture integrates two main modules, the directional MLP and the spatial MLP, and performs volume rendering based on ray tracing and physical principles, significantly improving the reconstruction accuracy of ultrasound images.\nThe primary function of the directional MLP is to process ray direction information. Specifically, it receives the ray direction d as input and generates view-dependent reflection intensity information. By generating the reflection intensity estimate \\(\\hat{C}_{ref}\\), it ensures that the reflection characteristics under each view are accurately captured, enhancing the ability to simulate complex reflection properties. The formula is as follows:\n\\[\nC_{ref} = \\mu \\left(c_{d}+c_{s}\\right)\n\\]\nWhere \\(C_{ref}\\) is the reflection intensity estimate, \\(c_s\\) is the specular reflection information encoded by direction, \\(c_d\\) is the diffuse reflection information produced during the interaction of ultrasound waves with the interface, which is only position-dependent, and \\(\\mu\\) is a scaling function that limits the output value to the range [0,1]."}, {"title": "US volume rendering", "content": "The traditional Neural Radiance Fields (NeRF) method generates images by accumulating point data in 3D space along the line of sight. However, this approach has significant limitations when applied to ultrasound imaging. The physical phenomena involved in ultrasound imaging are more complex, requiring consideration of wave effects and acoustic impedance matching, which are not factors in natural image rendering. Therefore, a more specialized approach is necessary. We improved the Ultra-NeRF method by proposing a volume rendering technique that utilizes the physical properties of the medium. This new method combines parameters generated by directional MLP and spatial MLP and incorporates classical ultrasound imaging theory and ray tracing technology [3], thereby achieving more accurate simulations of ultrasound wave propagation and reflection to produce high-fidelity rendered images.\nSpecifically, we synthesize views by querying the ultrasound characteristics of the medium along the path of the sound wave: attenuation coefficient \u03b1, reflectivity \\(\\beta\\), scattering density \\(\\rho_s\\), and amplitude \\(\\phi\\). As shown in Figure 3, we treat ultrasound waves as rays emitted from the transducer, simulating their propagation paths through different media. For each scanliner, we define the ultrasound intensity \\(C_{\\text{render}}(r,t)\\) at a distance t as the sum of the reflected energy \\(R(r,t)\\) and backscattered energy \\(B(r,t)\\), describing the energy changes of the ultrasound wave during propagation:\n\\[\nC_{\\text{render}}(r,t) = R(r, t) + B(r, t)\n\\]\nBased on the Beer-Lambert law, we introduce the concept of residual energy \\(I(r, t)\\), whose variation is calculated using the following formula:\n\\[\nI(r, t) = I_0 \\exp \\left(\\int_0^t -\\left(\\alpha \\cdot f \\cdot \\Delta t\\right) d r\\right) \\cdot \\prod_{n=0}^{t-1} \\left(1-\\beta(r, n)\\right)\n\\]\nWhere \u03b1 is the attenuation coefficient of the medium, f is the frequency of the ultrasound wave, and \\(\\beta(r, n)\\) is the reflection coefficient of the medium in the tissue. This formula describes the exponential decay of the signal as it propagates through the medium.\nThe reflected energy \\(R(r,t)\\) refers to the energy generated at the medium interface due to reflection. The calculation of \\(R(r,t)\\) is based on the residual energy \\(\\beta(r, t)\\), the reflection coefficient, and a predefined two-dimensional point spread function (PSF):\n\\[\nR(r,t) = I(r, t) \\cdot \\beta(r, t) \\otimes \\text{PSF}(r),\n\\]\nIn our model, the point spread function (PSF) is simplified to include only the axial and lateral directions, excluding the elevation direction. The PSF function"}, {"title": "Experiments", "content": "Our experiments were conducted on a computer equipped with an NVIDIA RTX 3070 GPU and 32GB of RAM. We utilized the Ultra-NeRF open-source dataset to simulate liver ultrasound images generated from CT scans, following the image generation methods outlined in Ultra-NeRF's work and using the ImFusion tool. The dataset includes seven scans: six at different oblique angles and one vertical scan. Each scan contains 200 2D ultrasound images along with their tracking"}, {"title": "Ablation Study Results of the Neural Network Architecture", "content": "Although NeRF and Mip-NeRF (the previous best-performing techniques) have shown outstanding performance in view synthesis and image reconstruction, their ray integration-based rendering method has limitations in ultrasound imaging. The traditional NeRF method determines pixel color values by integrating along a ray, which is suitable for visible light images. However, ultrasound imaging involves interactions of ultrasound waves with different tissues along the propagation path. To address this, we made specific modifications to NeRF and Mip-NeRF to better handle the characteristics of ultrasound images. Specifically, we used a Directional MLP in the model to directly output simulated ultrasound images, capturing reflection information of ultrasound waves in different directions. Furthermore, we conducted ablation studies on the performance of each model using the ultrasound dataset."}, {"title": "Ablation Study Results of the Rendering Components", "content": "To demonstrate the effectiveness of UlRe-NeRF's rendering method in ultrasound image reconstruction, we designed various ablation experiments comparing it to Ultra-NeRF. These experiments included replacing Ultra-NeRF's rendering method with ours and using Ultra-NeRF's rendering method in our model. Table 2 shows the quantitative comparison results of different models across several metrics. It is evident that UlRe-NeRF exhibits significant advantages in all metrics, especially in significantly reducing the LPIPS value. This improvement is reflected in the visual quality of the images, with a noticeable suppression of noise and artifacts, resulting in clearer and more realistic images. In contrast, using Ultra-NeRF's original rendering method results in significant noise and detail loss in the images. Additionally, when Ultra-NeRF adopts our method, there is a significant improvement in image quality and metrics, indicating that our method better reconstructs ultrasound signals and effectively reduces noise interference. Quantitative analysis of the results shows that our method can more accurately capture and reconstruct details when handling complex tissue structures, significantly enhancing image clarity and realism."}, {"title": "Discussion & Conclusion", "content": "In this paper, we present UlRe-NeRF, a more effective and precise Neural Rendering method for 3D Ultrasound Imaging. We incorporate additional inductive biases about ultrasound: improving implicit representation network with reflection direction parameterization and Reflective Harmonic Encoding (RHE) to capture complex tissue reflections, improving explicit volumic rendering with integration of reflection intensity and volume rendering to simulate the medium's physical properties and light interactions.\nThe experiments show that our approach can achieve high-fidelity 3D ultrasound imaging synthesizes: it learns view-dependent geometry and capture complex tissue structures; it simulates various physical property parameters of the the medium; it reproduces the propagation and reflection behavior of ultrasound waves in the medium.\nOur study provides an important advance in ultrasound image reconstruction techniques, demonstrating the potential of ultrasound neural rendering architectures based on implicit neural networks and explicit ultrasound volume rendering to improve ultrasound image quality [15].\nThe characteristics of ultrasonic imaging itself limit the usage of hierarchical sampling strategy. Another methods specific for ultrasound to make rendering more sample-efficient is required. Although we have proposed new explicit ultrasound volume rendering methods to improve the contrast and clarity of physi-"}]}