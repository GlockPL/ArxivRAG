{"title": "XTraffic: A Dataset Where Traffic Meets Incidents with Explainability and More", "authors": ["Xiaochuan Gou", "Ziyue Li", "Tian Lan", "Junpeng Lin", "Zhishuai Li", "Bingyu Zhao", "Chen Zhang", "Di Wang", "Xiangliang Zhang"], "abstract": "Long-separated research has been conducted on two highly correlated tracks: traffic and incidents. Traffic track witnesses complicating deep learning models, e.g., to push the prediction a few percent more accurate, and the incident track only studies the incidents alone, e.g., to infer the incident risk. We, for the first time, spatiotemporally aligned the two tracks in a large-scale region (16,972 traffic nodes) over the whole year of 2023: our XTraffic dataset includes traffic, i.e., time-series indexes on traffic flow, lane occupancy, and average vehicle speed, and incidents, whose records are spatiotemporally-aligned with traffic data, with seven different incident classes. Additionally, each node includes detailed physical and policy-level meta-attributes of lanes. Our data can revolutionalize traditional traffic-related tasks towards higher interpretability and practice: instead of traditional prediction or classification tasks, we conduct: (1) post-incident traffic forecasting to quantify the impact of different incidents on traffic indexes; (2) incident classification using traffic indexes to determine the incidents types for precautions measures; (3) global causal analysis among the traffic indexes, meta-attributes, and incidents to give high-level guidance of the interrelations of various factors; (4) local causal analysis within road nodes to examine how different incidents affect the road segments' relations. The dataset is available at http://xaitraffic.github.io.", "sections": [{"title": "1 Introduction", "content": "In today's era of deep learning, a technological foundation has been laid for intelligent transportation systems [53, 56, 28]. Primarily, conducting myriad traffic analysis relies on two types of data: traffic and incident data. Traffic data encompasses the traffic state-related time-series, e.g., volume, speed, and occupancy rate on the road network over time. This continuous stream of data is essential for forecasting the future volume, understanding peak usage times, and optimizing traffic signals and routes [14, 23]. Real-time traffic data allows for dynamic adjustments to be made, enhancing the efficiency of traffic flow and reducing overall travel times. On the other hand, incident data includes information about traffic accidents, road closures, and unexpected events that can significantly affect traffic flow. This data helps in understanding the impact of such incidents on traffic congestion and travel time, facilitating more accurate predictions and enabling timely responses from traffic"}, {"title": "2 Related Work", "content": null}, {"title": "2.1 Preliminary of Four Intended Tasks", "content": "Traffic Forecasting is to predict traffic indexes at nodes within a road network based on historical data collected by sensors at each node. Consider a traffic road network represented as a graph G = (V, E), where V denotes the set of N traffic nodes, with |V| = N, and E represents the set of undirected edges. An edge Eij = 1 indicates a physical connection between nodes i and j in the road network; otherwise, Eij = 0. Traffic volume data is recorded by sensors in evenly spaced time intervals and can be represented as a sequence of matrices $(X_1, X_2, ..., X_T) \\in \\mathbb{R}^{N \\times T}$, where $X_t$ is the matrix of volume signals $(x_1, x_2, ..., x_N)$ at time slot t for all N nodes.\nThe goal in traffic flow forecasting is to devise a function $F_1$ that uses the observed traffic data from $T_1$ time slots to predict the traffic volumes for the subsequent $T_2$ time slots: $(X_{t-T_1+1}, ..., X_t) \\stackrel{F_1}{\\longrightarrow} (x_{t+1}, ..., X_{t+T_2})$, where $X^{t+1}$ represents the prediction at time t + 1, and a general loss function is defined as: $\\min_\\Theta \\sum_{i=1}^{T_2} L_1(X^i, \\hat{X^i})$.\nIncident Classification is to identify traffic incidents using traffic indexes. Since traffic sensors are not always available at the site of an incident, for brevity, we associate the parameters in the nearest single sensor to classify an incident, rather than aggregating data from multiple neighboring sensors. For the i-th paired sample $(X_i, y_i)$ in the dataset D, $X \\in \\mathbb{R}^{C\\times w}$ is the input and $y_i$ represents its corresponding label, where C denotes the number of multivariate feature channels (e.g., speed and flow) and w indicates the time window at the post-incident timing t. There is $X = {x_t, x_{t+1},...,x_{t+w-1}}$ and the j-th entity $x_{t+i} \\in \\mathbb{R}^C$. The classification task is: $\\hat{y_i} = F_2(X; \\Theta)$, where $\\hat{y_i}$ is the predicted result, $F_2$ is the classifier, and $\\Theta$ is trainable parameters. The overall objective is to minimize the classification loss $L_2$ (e.g., cross-entropy) on D: $\\min_\\Theta \\sum_i L_2(F_2(X; \\Theta), y_i)$.\nCausal Analysis and Directed Acyclic Graph (DAG) In causal analysis, the primary objective is to elucidate the causal relationship, which is represented in a dynamic acyclic graph (DAG). Within a DAG, each node corresponds to a variable, and each directed edge delineates a causal relationship between two variables. The causal structural model enables the representation of a node's distribution $w_i$ through $w_i = f_i(W_{pa_i}, e_i)$, where $W_{pa_i}$ denotes the set of all parents of node $w_i$, and $e_i$ represents the exogenous noise associated with node wi. We consider two subtasks:\n(1) Global Causal Analysis for The Whole System: In global causal analysis, we focus on the problem that macro-level phenomena influence each other, such as the impact of weather on accident rates. Therefore, each node within the graph represents distinct variables like weather conditions, traffic accidents, or overall traffic statistics. This approach helps in understanding the broader implications of various environmental and systematic factors on traffic dynamics.\n(2) Local Causal Analysis for Road Relations: In local causal analysis, we focus on the temporal dependency structure underlying the complex traffic road network. We aim to find a graph G where the nodes are the variables representing traffic nodes at different lag-times and the links represent lagged or contemporaneous causal dependencies between traffic nodes. This approach helps in understanding how topologic of the road network affects traffic conditions."}, {"title": "2.2 Related Work of Traffic and Incident Analysis", "content": null}, {"title": "Traffic Forecasting with Incidents Considered.", "content": "A large number of works, e.g., STGCN[53], STGODE[7], DSTAGNN[19], are proposed to improve the prediction accuracy based on GNN [50] and RNN [39] models. However, these works only consider historical traffic for future traffic, yet other critical impacts, e.g., incidents and meta-features are ignored ([54, 18, 45, 30] offer detailed reviews in traffic forecasting). There are a few works that have considered incidents when predicting, whose main design is incorporating incident-related embedding as auxiliary information into traditional spatiotemporal prediction framework [51, 12, 31, 16]. For example, DIGC-Net [51] inputs the type and duration of the incident to predict the affected speed. Yet, the dataset only brings one week of incident data (17-24 Apr 2019) from a"}, {"title": "3 XTraffic Datacube", "content": null}, {"title": "3.1 Comparison with Existing Datasets", "content": null}, {"title": "3.2 Collection and Construction", "content": "Both incident and traffic data are collected from Caltrans Performance Measurement System (PEMS). For traffic data, we removed the sensor with less than 50% observations of traffic volume and reserved the data of 16,972 sensors with meta-features. These sensors are located in 42 different cities and counties. We also collected comprehensive meta-features of these sensors. After excluding the features with the same value and features unrelated to traffic, 26 meta-features are reserved. These meta-features can be divided into 5 types as shown in Table 1. Full meta-features are in Table 6, Appx. A.1. As most methods in traffic forecasting are graph-based, the adjacency matrix is a key component for the model to learn spatial dependency. Typically, the adjacency matrix is constructed based on distance [30]. In order to get the real travel distance, we set up an open-source rooting machine engine [33] based on OpenStreetMap, and calculate the shortest travel distance between two sensors based on the coordinate. One more precise adjacency matrix is constructed based on the direction of the lanes and the coordinates of two sensors A and B.\nFor incident data, we removed repeated incident records and the records without absolute postmile (indicating the position and date-time). As the source and CA PM (we have Abs PM to locate the incident) are relatively redundant in the traffic analysis, thus also being removed. The reserved incident data includes 476,766 samples with 9 features. Identifying which nodes are impacted by an incident is crucial for leveraging incident records in traffic analysis. To facilitate this, we use a method that combines the freeway name and absolute postmile (Abs PM) markers to pinpoint sensors that might be affected by the incident. We provide two methods for this matching process: (1) involves matching only the nearest sensor on the same freeway as the incident, (2) involves setting a distance threshold and incorporating all sensors within this specified range."}, {"title": "4 Experiments", "content": null}, {"title": "4.1 Descriptive Analysis of XTraffic", "content": "(1) Different surfaces affect the traffic indexes: The traffic volume, occupancy, and speed vary sig- nificantly across different surface materials. In Fig. 2(a), the Base & surface < 7\" thick show distinct patterns (especially in volume and occupancy) compared to Bridge deck and Concrete surfaces, indicating that surface type influences traffic behavior. (2) Incidents affect the traffic indexes: In Fig. 2(b), traffic incidents such as incident 1141 cause noticeable disruptions and signifi- cant drops in traffic flow. (3) Long-tail of incident durations: Fig. 2(c) summarizes the distribution of incident durations, revealing a long-tail distribution where most incidents are relatively short, but a few incidents last for an extended period. It also demonstrates the geographical distribution of incidents, with higher concentrations in urban areas. (4) Traffic hazard is the dominant incident: The pie chart in Fig. 2(d) shows hazards constitute the majority (52.2%), followed by accidents (no injuries and w/ injuries, accounting for 35.3%). 1141 and other types collectively amount for 12.6%."}, {"title": "4.2 Traffic Forecasting after Incidents", "content": "The existing models are effective in general traffic forecasting tasks. However, their performance under irregular volumes caused by incidents has not been thoroughly discussed. To assess these models' response in such conditions, we conduct irregular traffic forecasting based on XTraffic.\nExperiment Setting: We selected prediction samples from the test set that one incident occurred within a 5-minute window. We divided all the data into training, validation, and test sets in a 6:2:2 ratio. Due to the large volume of data, we chose to conduct experiments using traffic volume data from the San Bernardino (561 mainline sensors) within the XTraffic dataset for the first 3 months. All of the baselines are state-of-the-art in the spatial-temporal forecasting or traffic forecasting domain. Our forecasting experiments were implemented within the same software framework employed by [30]. We further adhered to the identical experimental settings outlined within the work. We set the batch size as 24 for DSTAGNN and 64 for all of other models. The learning rate is set as 0.001. Other hyperparameters of models are set as the same as the original settings.\nResults. As shown in Table 3, all baselines perform significantly better in predicting on the general test dataset compared to the incident test dataset, since incidents added irregularity into the traffic systems. This suggests that investigating how to improve the performance of forecasting models on time series prediction following an incident is worth- while and warrants further re- search and discussion. More de- tails in Appx. \u0391.2."}, {"title": "4.3 Incident Classification", "content": "Since traffic incidents typically affect the traffic parameters in the nearest sensors, it is viable to deduce the traffic conditions based on the dynamics of the parameters. In this work, a time series classification task is designed on XTraffic, which involves inferring incident categories based on the traffic parameters during particular time slots detected by the sensors.\nExperimental setting. Since traffic sensors are not always available at the site of an incident, we start by identifying the nearest sensor affected by each incident according to the distance (i.e., the ABS PM in Table 6). Then, we extract recorded indexes (traffic speed, lane occupancy, and traffic flow) in these sensors during a time window when the incident occurs. Augmented with normal data,"}, {"title": "Performance Evaluation.", "content": "From Table 4: (1) The best classification can achieve 41% accuracy, indicating classifying traffic conditions based on traffic indexes is feasible (better than ran- dom guess). Among the datasets with different inputted features, DT and PatchTST always out- perform the baselines. gMLP also shows strong performance, notably achieving top ranks in sev- eral categories and particularly excelling in the mixed channels. (2) Variability across channels. Different methods exhibit varying degrees of ef- fectiveness depending on the channel used, e.g., Sequencer performing better with speed and worse with flow, and OmniScaleCNN opposite. Thus, selecting appropriate features can guarantee the model effectiveness.(3) Integrating multiple fea- tures often leads to better classification. However, the performance gain is method-dependent, e.g., DT and gMLP showing substantial improvement, but TS2Vec and OmniScaleCNN benefit less."}, {"title": "4.4 Global Traffic Causal Analysis", "content": "Experiment Setting: In our XTraffic dataset, we have static variables, e.g., road information, represented as scalar and vector, and dynamic variables, e.g., accidents and traffic flow, represented as functional data. Considering the multimodal nature of the variables, we employ MM-DAG [20] to construct the causal network in different districts. We collect data on 17 variables across four"}, {"title": "Results:", "content": "Fig. 4(a) illustrates the four causal networks derived by MM-DAG. (1) Certain static variables are essential; such as road surface, terrain, and road width, they exert significant influences on the incidence of traffic events and the overall traffic conditions. (2) The static variables' impacts are consistent: Across various districts, due to their inherent properties, these underlying attributes consistently influence road and traffic dynamics across different regions. (3) Dynamic variables like time, weather, and visibility also affect traffic incidents, though their causal relationships appear to be weaker and vary by district. For example, the causal links from events to fire and events to hazards show variability and weaker connections in different districts.\nWe further explain four significant edges. In Fig. 4(b1), the probability of encountering hazards is higher during the early morning (5 AM to 8 AM) and late afternoon (after 3 PM) on weekdays compared to weekends, likely due to increased traffic flow during peak commuting hours. In Fig. 4(b2), rain increases the probability of accidents compared to dry conditions, but the amount of rainfall does not significantly affect the accident rate. In Fig. 4(b3), bridges and road surfaces with a base thickness of >7 inches have a lower probability of hazards compared to concrete surfaces. This may be due to the enhanced durability and grip provided by thicker road surfaces and bridge constructions. In Fig. 4(b4), flat terrain is associated with higher average speeds compared to rolling terrains. The tendency for higher speeds on flat terrains is likely due to the reduced need for vehicles to decelerate for climbs or curves, allowing for more consistent and faster travel."}, {"title": "4.5 Local Causal Analysis for Road Relations", "content": "To demonstrate the value of our XTraffic dataset in revealing the causal relations among the roads, we conduct local causal analysis on a real case from XTraffic. We employ the PCMCI+ [40] algorithm for causal structure learning. Since the underlying ground truth of causal dependencies is unknown, the hyperparameters, e.g., significance level and maximum time lag, are set for better interpretability."}, {"title": "Experiment Setting:", "content": "In Fig. 5, we select the road network near an interchange in Novato, California. On the evening of February 11, 2023, a traffic incident \"1141\" occurred at the east- bound exit of the interchange. This in- cident indicates that a traffic collision occurred and that there were potential injuries requiring a medical response. We then select four traffic nodes, rep- resented by their traffic flow indexes, {X1, X2, X3, X4}, that might be af- fected by the traffic incident. We see from Fig. 5 (a2) that the decrease in traffic flow of X\u00b3, which is the node closest to the incident, significantly ac- celerated after the incident occurred.\nResult: The causal graphs learned by PCMCI+ are in Fig. 5 (b), where the colors depict the strength of causal dependencies and the label of a link represents the time lag of causal de- pendencies. The pre-incident causal structure matches the common under- standing about traffic propagation, in- dicating that traffic flow propagates from X\u00b2 through X\u00b3 to X4. Compared to the pre-incident graph, the post-incident graph has two additional lagged causal links X3 lag} X2 and X4 lag} X\u00b9. In such a complicated dynamic traffic system, explaining the change of causal dependencies is challenging and we endeavour to provide some conjectures for reference. Due to the traffic collision between X\u00b2 and X\u00b3, congestion likely occurred near X\u00b3, reducing the traffic flow at each time slot. However, the traffic demand from X2 to X\u00b3 did not decrease in the short term, causing the congestion to gradually spread to X2. The congestion at the eastbound exit of the interchange led to a decrease in traffic demand from X\u00b9 to X4. Fewer vehicles chose to slow down to enter the ramp, causing increased speed and higher traffic flow at X\u00b9."}, {"title": "5 Conclusion and Limitations", "content": "Conclusion. We propose a pioneering traffic and incident dataset XTraffic. It integrates traffic flow data with incident records and road comprehensive meta-features, filling a significant gap in traffic analysis and Incident analysis. XTraffic lays a solid groundwork for research focused on understanding traffic dynamics, causality, and interrelationships. Through four groups of experiments, we demonstrate that our dataset offers expanded possibilities for research in traffic forecasting, incident classification, and detection, as well as causal analysis.\nLimitation and future work.Our dataset currently faces three primary limitations. Firstly, weather data is crucial for traffic and incident analysis; however, our dataset lacks well-integrated weather information for use. Secondly, while we can locate specific incident locations relatively precisely using absolute PM values and road names, this method is less effective for visualization compared to using latitude and longitude coordinates. Lastly, there are still gaps in our traffic data. In response to these issues, we plan to enhance our dataset by collecting more comprehensive weather data. Additionally, we will use OpenStreetMap to analyze and generate precise geographical coordinates for incidents. Finally, we aim to develop improved methods for imputing missing values in the traffic data to ensure completeness and reliability."}, {"title": "A Appendix", "content": "In this Appendix, we will introduce a few more details about the XTraffic data, and the experiment settings of the Post-Incident Traffic Forecasting, Incident Classification, Global Causal Analysis, and Local Causal Analysis."}, {"title": "A.1 Details of XTraffic", "content": "Licence: According to the Ownership section in Caltrans Terms of Use of PEMS, we can collect and construct a dataset from the source and distribute it. We collected all of the data before 17/05/2024. More details and the introduction of the dataset can be found in the supplementary material. Our XTraffic is released under a CC BY-NC 4.0 International License. The code for the experiments is released under a MIT License.\nIncidents: The details of incident data features are shown in Table 5."}, {"title": "A.2 Experiment Details on Post-Incident Traffic Forecasting", "content": "Baselines. The baselines we selected to do the forecasting experiments are typical models in traffic forecasting domain.\n\u2022 LSTM[15]: A basic model focusing solely on the temporal relationships within traffic data.\n\u2022 ASTGCN[13]: Enhances the STGCN by incorporating an attention mechanism to better capture node correlations.\n\u2022 DCRNN[25]: An RNN-based model that utilizes diffusion convolution to model traffic flows.\n\u2022 AGCRN[4]: An adaptive model that combines RNN architecture with an attention mecha- nism to focus on spatial correlations.\n\u2022 GWNET[49]: Utilizes a gated mechanism in a TCN framework to filter out irrelevant information effectively.\n\u2022 STGODE[11]: Uses ordinary differential equations to dynamically model relationships among traffic nodes.\n\u2022 DSTAGNN[19]: Designed to dynamically capture changing correlations among traffic sensors.\n\u2022 D2STGNN[42]: A dual-layer spatial-temporal GNN that addresses hidden correlations in traffic data for forecasting."}, {"title": "A.3 Experiment Details on Incident Classification", "content": "Baselines. We adopt the following representative time series classification baselines. (1) Decision Tree (DT): We tailor the canonical decision tree algorithm for the task, recursively partitioning data based on feature values to create a tree-like model that makes classifications at its leaf nodes. (2) TS2Vec [55]: It is a universal framework for learning robust and flexible time series representations using hierarchical contrastive learning over augmented context views, making the classification by a linear classifier. (3) gMLP [29]: It is a simple network architecture based solely on MLPs with gating, which performs as well as Transformers in key language and vision applications. (4) Sequencer [47]: It models long-range dependencies using LSTMs without self-attention layers, which enhances performance by reducing the sequence length and creating spatially meaningful receptive fields. (5) OmniScaleCNN [46]: It is a 1D-CNN architecture that utilizes a set of prime number-based kernel sizes to efficiently capture optimal receptive field sizes without scale tuning across diverse time series classification tasks. (6) PatchTST [35]: It incorporates patching of time series into subseries-level patches and channel-independence to improve long-term forecasting accuracy based on the Transformer backbone. (7) FormerTime [6]: It employs a hierarchical Transformer-based architecture to learn multi-scale feature maps and introduces an efficient temporal reduction attention mechanism and a context-aware positional encoding generator for multivariate time series classification.\nMore Results. Fig. 6 reports the critical difference diagram as presented in [8], which compares the mean ranks of the baseline methods on the four datasets (three channel-only and all mixed) in the classification task. The thick horizontal lines in the diagram denote groups of methods whose performance differences are not statistically significant within the critical difference (CD) threshold. It can be seen that DT, gMLP, and PatchTST are among the top-performing methods with the lowest mean ranks, indicating their superior performance. Although DT, gMLP, and PatchTST are highlighted as top performers, the differences among the top five methods are not statistically significant since they are in a group, suggesting comparable effectiveness in this task."}, {"title": "A.4 Experiment Details on Global Causal Analysis", "content": "The introduction of MM-DAG: MM-DAG is a score-based causal discovery algorithm. It learns multiple DAGs with multimodal data where their consensus and consistency are maximized. For"}, {"title": "A.5 Experiment Details on Local Causal Analysis", "content": "In local causal analysis, We employ the PCMCI+ algorithm to discover the causal relations in traffic data, which utilizes momentary conditional independence (MCI) test to determine the existence of causal links. Typically, the lagged and contemporaneous causal relations are displayed in a dynamic"}]}