{"title": "Computational Pathology for Accurate Prediction of Breast Cancer Recurrence: Development and Validation of a Deep Learning-based Tool", "authors": ["Ziyu Su", "Yongxin Guo", "Robert Wesolowski", "Gary Tozbikian", "Nathaniel S. O'Connell", "M. Khalid Khan Niazi", "Metin N. Gurcan"], "abstract": "Accurate recurrence risk stratification is crucial for optimizing treatment plans for breast cancer patients. Current prognostic tools like Oncotype DX (ODX) offer valuable genomic insights for HR+/HER2- patients but are limited by cost and accessibility, particularly in underserved populations. In this study, we present Deep-BCR-Auto, a deep learning-based computational pathology approach that predicts breast cancer recurrence risk from routine H&E-stained whole slide images (WSIs). Our methodology was validated on two independent cohorts: the TCGA-BRCA dataset and an in-house dataset from The Ohio State University (OSU). Deep-BCR-Auto demonstrated robust performance in stratifying patients into low- and high-recurrence risk categories. On the TCGA-BRCA dataset, the model achieved an area under the receiver operating characteristic curve (AUROC) of 0.827, significantly outperforming existing weakly supervised models (p=0.041). In the independent OSU dataset, Deep-BCR-Auto maintained strong generalizability, achieving an AUROC of 0.832, along with 82.0% accuracy, 85.0% specificity, and 67.7% sensitivity. These findings highlight the potential of computational pathology as a cost-effective alternative for recurrence risk assessment, broadening access to personalized treatment strategies. This study underscores the clinical utility of integrating deep learning-based computational pathology into routine pathological assessment for breast cancer prognosis across diverse clinical settings.", "sections": [{"title": "1. Introduction", "content": "Breast cancer is the most prevalent cancer and the second biggest reason for cancer-related death in women in the United States [1]. The effective treatment options and prognosis for breast cancer patients are highly dependent on the patient's molecular subtype of breast cancer as determined by estrogen, progesterone, and human epidermal growth factor 2 (HER2) receptor expression. Among all different subtypes, hormone receptor-positive (HR+) and epidermal growth factor receptor-negative (HER2-) breast cancer represents the most common entity, accounting for approximately 65% of all cases [2, 3]. This subtype of breast cancer is highly dependent on estrogen signaling, and most such patients can be safely treated with endocrine therapy aimed at blocking this signaling. However, chemotherapy effectively reduces the recurrence risk in a small subset of patients with operable disease. At the same time, it does not significantly benefit the majority of this group. Given the significant short- and long-term toxicities of chemotherapy that can badly affect patients' quality of life, it is critical to know which patients will derive significant benefits from cytotoxic chemotherapy to justify these risks.\n\nThe Oncotype DX (ODX) test is widely used as a prognostic and predictive tool and a prognosis indicator for breast cancer recurrence risk in patients with operable HR+/HER2- breast cancer. It is a gene-assay based on 21 critical gene expression levels obtained through reverse transcriptase-polymerase chain reaction (RT-PCR) technology [4]. The assay assigns a risk score ranging from 0 to 100, with a higher score indicating a higher risk of breast cancer recurrence. Recurrence risk is also an indicator suggesting the benefits of chemotherapy. Recent research reports that a risk score of 25 or less is associated with no benefit from receiving adjuvant chemotherapy for women with node-negative, HR+/Her2- above who are older than 50 years old or post-menopausal women with the presence of metastases to 1-3 axillary lymph nodes [5, 6]. On the other hand, for women under 50 years old with early-stage, node-negative, HR+/HER2- breast cancer, and ODX recurrence score between 16-25, there are modest chemotherapy benefits and the decision whether to use it is based on close assessment of other risk factors and thorough discussion between healthcare provider and the patient. Therefore, a common practice is stratifying patients into low or high-risk based on a cut-off value 25.\n\nAlthough effective, ODX has limited usage for the vast majority of breast cancer patients due to its high cost (~4000 US dollars per test). According to the World Bank statistics [7], 70 countries with low-income or lower-middle-income economies have average annual per capita incomes of less than $1,146 and $4,515, respectively. It would be difficult, if not impossible, for women in these countries and several other countries to access expensive tests. Several studies have shown that race/ethnic minorities in the U.S., such as African Americans and Hispanic Americans, have fewer chances to receive ODX compared to Caucasian Americans [8-10]. Furthermore, inner-city and municipal hospitals have lower ODX utilization than private hospitals [11]. Therefore, there are significant racial and income disparities in the utilization of ODX, highlighting the need for more accessible and affordable prognostic tools to ensure equitable healthcare for all breast cancer patients [12].\n\nRecently, several studies have explored machine learning methods to predict ODX outcomes using readily accessible medical data modalities [12-15]. Among these approaches, computational pathology has demonstrated significant potential as a cost-effective alternative to gene assays, thanks to the affordability of histopathology slides and advancements in deep learning technology [13, 14, 16]. Computational pathology involves the computational analysis of digitized histopathology slides, namely the whole slide images (WSIs) [17]. With the progress in deep learning, it is now possible to extract quantitative features from WSIs, enabling the prediction of clinically significant outcomes.\n\nPrevious studies have demonstrated the potential of predicting ODX outcomes from H&E-stained WSIs using deep learning techniques [18-21]. These approaches leverage deep learning models to extract hand-crafted nuclei features from WSIs. However, developing these methods requires massive annotation efforts from pathologists, which is costly. In addition, their multi-stage feature extraction methods increase the implementation difficulties and variabilities. With the advancements in the deep learning domain in the past five years, weakly supervised learning models have gradually become the mainstream of deep learning models for computational analysis. According to the weakly supervised learning paradigm, deep learning models are not used to extract hand-crafted features. Instead, they treat a high-resolution WSI as a single input and automatically learn clinically relevant features from WSIs. Multiple successful applications of weakly supervised learning have emerged in various tasks, such as tumor metastasis classification [22, 23], subtyping [24], survival prediction [25], etc. However, the performance of existing methods on ODX prediction has remained moderate [14]. Our latest study showed promising results, achieving an AUC higher than 0.8 [13]. Nevertheless, this assessment was based on a relatively small dataset comprising 150 WSIs, indicating the need for validation on a larger cohort to confirm these findings and improve the model's robustness.\n\nIn this study, we introduce a fully automatic pipeline called Deep-BCR-Auto, which utilizes deep learning models to predict ODX results based on H&E-stained WSIs. The pipeline comprises two main components: tumor bulk segmentation and weakly supervised ODX prediction, eliminating the need for pathologists' annotations. Our dataset is sourced from the TCGA Breast Cancer (BRCA) database, encompassing a total of 1,006 patients, including 516 with HR+/HER2- status. Research-based ODX recurrence risks are calculated from the provided patients' mRNA expression data [16]. Our experimental results demonstrate that Deep-BCR-Auto accurately predicts ODX-based breast cancer recurrence risk from WSIs. The model's performance remains consistently robust across different racial and age groups, demonstrating its potential for broad clinical application. When evaluated independently on an in-house dataset with actual ODX results, Deep-BCR-Auto maintained strong generalizability. Our approach not only offers a cost-effective and accessible alternative to traditional gene assays but also addresses disparities in healthcare access by providing reliable prognostic information to a diverse patient population."}, {"title": "2. Methods", "content": "2.1. Dataset\nOur study utilizes two datasets of H&E-stained breast cancer resections: the publicly available TCGA Breast Cancer (TCGA-BRCA) dataset and an in-house dataset referred to as the OSU dataset. Details of each dataset are outlined below.\n\nThe TCGA-BRCA dataset consists of 1133 WSIs, which are employed for training and testing the deep learning models. Although the original dataset does not include ODX results, we utilized the research-based ODX results calculated by Howard et al. [16], which are derived from the TCGA provided patient-level mRNA expression data. In a nutshell, they normalized the sequencing data and calculated the score using the ODX formulas. Subsequently, they chose a threshold differentiating high/low-risk patients based on the 15th percentile results of all HR+/HER2- patients, following the statistics in the National Cancer Database [16, 26].\n\nWe performed data cleaning to remove WSIs from TCGA-BRCA dataset with missing ODX or receptor status information, as well as those that failed to undergo processing in our slide processing pipeline. As a result, the finalized TCGA-BRCA dataset comprises 1065 H&E-stained WSIs sourced from 1006 patients (i.e. some patients have multiple WSIs). Among these patients, 516 patients are HR+/HER2-, with 443 classified as low risk and 73 classified as high risk. Detailed demographics are summarized in Table 1. In our study, we primarily use HR+/HER2- patient data for model training and testing. For patients who are not HR+/HER2-, we include their WSIs in our training set to enhance the training of the deep learning models (details can be found in Section 2.4).\n\n2.2. Automatic ODX prediction pipeline\nIn this study, we developed a fully automatic WSI-based ODX prediction pipeline, DeepBCR-Auto. The proposed approach for ODX prediction includes two main steps: 1) tumor bulk segmentation and 2) ODX prediction on tumor bulks (see Figure 1)."}, {"title": "2.3. Weakly supervised learning model", "content": "Weakly supervised learning, also known as multiple instance learning (MIL), is a machine learning paradigm that aims to classify a bag of instances instead of individual instance [17]. During the training, the model can only see the bag-level labels without seeing the label for each instance. Thus, the model needs to comprehensively analyze and aggregate the instance-level features to make a bag-level prediction. The weakly supervised learning model is widely applied in WSI analysis due to its label-efficient property [17]. Given the giga-pixel level resolution of WSIs, it is challenging for pathologists to extensively annotate each region of a WSI, which results in limitations of carefully annotated WSI datasets. For some tasks, such as our recurrence risk prediction problem, it is impossible for the pathologists to indicate which regions are responsible for high ODX scores. With the help of weakly supervised learning, we can formulate a WSI as a bag and encoded patches as instances, so that we only need to collect the slide-level or patient-level outcomes to train our model. The model will intelligently aggregate the patch features to predict the slide-level outcomes.\n\nIn our pilot study [13], we proposed Deep-BCR, a weakly supervised learning model for ODX recurrence risk prediction. The essential idea of Deep-BCR is to learn attention scores for each input patch of a WSI and then aggregate all the encoded patches into a slide-level representation using the learned attention scores. The slide-level representation will be used to predict the recurrence risk. Unlike other models, Deep-BCR employs a cross-attention neural network to correlate each input patch with some representative patches from both low and high-risk categories. The correlations are then used to learn the attention weights for the patches via a neural network. The architecture of Deep-BCR is depicted in Figure 1c and more details can be found in [13]. The implementation details for training Deep-BCR are described in Supplemental Methods 2."}, {"title": "2.4. Experimental design", "content": "Our task is formulated as an image classification problem to determine low or high-risk categories. To develop our model, we performed a stratified three-fold cross-validation on the HR+/HER2- cohort of the TCGA-BRCA dataset. The dataset was split at the patient level to ensure no overlap of patient data between the training and testing sets. Due to the categorical imbalance of the dataset, we augmented the training set for each fold with all the non-HR+/HER2- data to create a relatively balanced training set.\n\nTo thoroughly test the accuracy and generalizability of Deep-BCR-Auto, we used the OSU dataset as an independent testing set for model trained on the TCGA-BRCA dataset. For independent testing, we picked the model performed the best under three-fold cross-validation on the TCGA-BRCA dataset.\n\nTo evaluate our model, we report AUROC (Area Under the Receiver Operating Characteristic) and AUPRC (Area Under the Precision-Recall Curve). The 95% confidence intervals (CI) were calculated using the 1000-time bootstrapping method. For comparisons, we selected CLAM [27] and CLAM-CTrans as the comparison methods in our study, as they demonstrated excellent performance in our previous ODX prediction study [13]. CLAM is a widely used MIL model that has been applied across various WSI analysis tasks [31-33], while CLAM-CTrans is the improved version of CLAM, incorporating a histopathology-specific patch encoder [29]. P-values for AUROC were calculated to compare Deep-BCR-Auto against the comparison models using Delong's test. Additionally, we adjusted our prediction threshold to achieve 70%, 80%, and 90% sensitivities to test the rule-out performance of our model under high sensitivities. Performance was assessed using confusion matrices, specificity, negative predictive value (NPV), and positive predictive value (PPV)."}, {"title": "3. Results", "content": "In this section, we first report the cross-validation performance of the Deep-BCR-Auto compared with other MIL models on the TCGA-BRCA dataset (see Section 3.1). Then, we selected the best-performing model on the TCGA-BRCA dataset and tested it on our in-house OSU dataset (see Section 3.2)."}, {"title": "3.1 Cross-validation results on TCGA-BRCA dataset", "content": "In Figure 2 and Table 2, we report the performance of Deep-BCR-Auto in predicting ODX recurrence risk using H&E-stained WSIs from the TCGA-BRCA dataset. We compared Deep-BCR-Auto with CLAM [27] and CLAM-CTrans. As a result, the Deep-BCR-Auto achieved the best performance (AUROC 0.827, 95% CI 0.821-0.831) that outperforms CLAM-CTrans (AUROC 0.794, 95% CI 0.789-0.803) and CLAM (AUROC 0.750, 95% CI 0.742-0.756). Notably, Deep-BCR-Auto was significantly better than the original CLAM based on the Delong's test (p=0.041). This result indicates superior accuracy of the proposed Deep-BCR-Auto model."}, {"title": "3.2 Independent testing on the OSU dataset", "content": "For the Deep-BCR-Auto trained on the TCGA-BRCA dataset, we performed an independent testing experiment on the OSU dataset. Out of the three models we trained in the three-fold cross-validation, we selected the best performing model for the TCGA-BRCA dataset. Then, we applied the selected model to the WSIs from the OSU dataset. In Figure 5, we plot the receiver operating characteristic (ROC) and the precision-recall (PR) curves along with the AUCs of this experiment. We found that the proposed Deep-BCR-Auto achieved an AUROC of 0.832 (95% CI 0.829-0.833), which is comparable to its performance on the TCGA-BRCA dataset (AUROC 0.827, 95% CI 0.821-0.831).\n\nThe calibration performance of Deep-BCR-Auto, as shown in Figure 5c, highlights its clinical utility in predicting ODX recurrence risk. The calibration curve (solid black line) represents the relationship between predicted high-risk probabilities and observed proportions. In a perfectly calibrated model, predictions would fall directly on the ideal line (dashed red line), indicating that the predicted risk matches the true recurrence risk. For Deep-BCR-Auto, the calibration curve follows the ideal line closely at lower risk levels, indicating that the model accurately predicts low-risk patients. However, at higher predicted probabilities, the curve diverges, reflecting slight underestimation of risk in higher-risk patients. With a C (ROC) of 0.83, the model demonstrates strong discrimination between high- and low-risk patients, which is crucial for stratifying treatment decisions. However, the slope of 0.62 indicates slight underestimation in high-risk cases, a potential area for refinement to improve treatment allocation in patients who may require more aggressive intervention.\n\nSince Deep-BCR-Auto was trained and tested on datasets from different hospitals, we further adjusted the classification threshold using a small validation set held out from the OSU dataset. Specifically, we split 15% of the WSIs for validation (denoted as OSU validation set) and 85% for testing (denoted as OSU testing set). We then selected the threshold that maximized the model's F1-score on the OSU validation set, balancing accuracy between the two categories. Testing was subsequently conducted on the OSU testing set using the optimized threshold, with results shown in Table 4. The proposed model achieved an overall accuracy of 82.0%, with 85.0% specificity and 67.7% sensitivity, comparable to its performance on the TCGA-BRCA dataset (accuracy 78.9%, specificity 78.5%, and sensitivity 75.8%). These findings highlight the excellent generalizability of Deep-BCR-Auto across datasets from different hospitals.\n\nWe further analyzed the Deep-BCR-Auto's misclassified samples from the OSU testing set. In Figure 6, we compare the ODX score distribution of misclassified samples to that of all samples. We found that misclassified samples primarily concentrated in the 20 to 30 score range, while samples with extremely low or high scores are less likely to be misclassified. As a reference, the original sample distribution is skewed towards lower ODX scores. These findings suggest that samples with intermediate ODX scores (i.e., 20-30) are more challenging to classify, likely due to the fact that 25 serves as the cut-off between low and high risk [5, 6]. On the other hand, this also indicates that the proposed model captures intrinsic features distinguishing ODX recurrence risk from the WSIs, although these features become ambiguous near the boundary between low and high risk. Our finding could also point to inherent ambiguity in these intermediate ODX scores from a clinical perspective."}, {"title": "4. Discussion and Conclusions", "content": "One of the most crucial steps in breast cancer prognosis is recurrence risk stratification. Accurate stratification enables healthcare providers to devise tailored treatment plans and optimize the use of chemotherapy, which will balance the benefits of treatment against potential risks and side effects. Receptor status plays a significant role in informing patients about their cancer progression, recurrence risk, and response to various treatments. Notably, HR+/HER2- cases constitute approximately 70% of breast cancer patients in the U.S. [34]. Patients with operable, HR+/HER2- breast cancer can often be treated effectively with endocrine therapies that are aimed at disrupting estrogen signaling, such as selective estrogen receptor modulators (tamoxifen) [35], or aromatase inhibitors (letrozole, anastrozole, or exemestane) [36, 37] if the recurrence risk is low. Conversely, patients with a high recurrence risk due to more aggressive disease biology, derive significant benefit from chemotherapy followed by endocrine therapy [38]. ODX examination is a gene assay commonly used to risk-stratify HR+/HER2- breast cancer patients. It has also been proven to be informative in assessing the efficacy (or lack of it) of chemotherapy [5]. However, due to the high cost of ODX, there is a notable disparity in its utilization among different racial/ethnic groups and around the world. This disparity underscores the need for more accessible and cost-effective prognostic tools.\n\nCompared to gene expression assays, information gained from histopathology assessments is much more cost-effective and incorporated as a standard-of-care assessment tool for cancer diagnosis. In recent years, several computational pathology models have been proposed to predict ODX outcomes based on WSIs [18, 19, 39]. However, most of these methods rely on hand-crafted features and involve multiple steps, which can introduce human bias into their models. Recently, weakly supervised learning approaches have emerged as the mainstream in computational pathology for WSI analysis [23, 40-42]. Unlike traditional machine learning methods, weakly supervised learning models do not require extensive tissue annotations on WSIs but only a single diagnostic label for each WSI. This characteristic allows computational pathology models to overcome data limitations, enabling the training of models on a larger scale. Despite this progress, the application of weakly supervised learning models to predict ODX from WSIs has been limited, with existing models achieving only moderate performance [14]. In this study, we propose Deep-BCR-Auto as a fully automatic ODX prediction pipeline for H&E-stained WSIs. By leveraging the advantages of weakly supervised learning, Deep-BCR-Auto aims to enhance the accuracy and scalability of ODX predictions, providing a more efficient and unbiased approach to breast cancer prognosis.\n\nWe first trained and tested Deep-BCR-Auto on the publicly available TCGA-BRCA dataset. Then, we performed independent testing on an in-house dataset collected from The Ohio State University Wexner Medical Center (OSUWMC). Our three-fold cross-validation results on the TCGA-BRCA dataset are mainly reported in Table 2 and Figure 2. We found that the Deep-BCR-Auto achieved the best performance (AUROC 0.827, 95% CI 0.821-0.831) that outperforms CLAM-CTrans (AUROC 0.794, 95% CI 0.789-0.803) and CLAM (AUROC 0.750, 95% CI 0.742-0.756). By adjusting the threshold, we also found that our model achieved reasonable specificities while maintaining high sensitivities. Additionally, our model demonstrated excellent negative predictive values (NPVs). A high sensitivity model is critical in clinical practice to identify the majority of high-risk patients. Our model has exhibited its ability to precisely rule out low-risk patients, thereby reducing unnecessary ODX examinations. This property will make Deep-BCR-Auto a valuable tool in clinical settings, improving the efficiency of breast cancer prognosis and potentially lowering healthcare costs by minimizing the reliance on expensive and labor-intensive gene expression assays.\n\nIn our independent testing experiment, we selected the best-performing Deep-BCR-Auto model from the TCGA-BRCA experiments and evaluated it on the OSU dataset. The primary results are presented in Figure 5 and Table 4. The Deep-BCR-Auto model achieved an AUROC of 0.832 (95% CI 0.829-0.833), comparable to its performance on the TCGA-BRCA dataset. Additionally, after tuning the classification threshold using a small validation set from the OSU dataset, the model demonstrated strong classification performance on the OSU testing set (accuracy 82.0%, specificity 85.0%, sensitivity 67.7%). These findings further highlight the robust generalizability of the proposed model across data from different hospitals. The model's calibration curve in Figure 5c, particularly the slope of 0.62, indicates a slight underestimation of risk for high-risk patients, which aligns with the model's sensitivity. This reveals a potential area for future refinement, as improving the accuracy for high-risk patients could significantly impact clinical decision-making. From the other hand, the model demonstrates strong discrimination between high- and low-risk patients, evidenced by a C (ROC) of 0.83. Overall, the results demonstrate that Deep-BCR-Auto effectively predicts the ODX recurrence risk from the WSIs.\n\nIn our analysis of the Deep-BCR-Auto's performance on the OSU testing set, we observed that misclassifications predominantly occurred in cases with ODX scores in the 20 to 30 range (Figure 6). In contrast, samples with very low or high ODX scores were less frequently misclassified. These results highlight the challenge of accurately classifying cases with intermediate ODX scores, particularly around the threshold of 25, which delineates low and high-risk groups. This result also demonstrates that the proposed model effectively captures the intrinsic features related to ODX recurrence risk. However, the features are ambiguous when the ODX score is closer to the cut-off value.\n\nMoreover, our study shows that a computational pathology model can achieve comparable prediction performances among African American, Caucasian, and Asian patients. This finding is particularly significant given that African American patients have been reported to have lower chances of receiving ODX due to cost barriers and healthcare disparities [9]. The ability of Deep-BCR-Auto to provide accurate and equitable prognostic information across different racial groups highlights the model's robustness and generalizability. By addressing these disparities, our results underscore the importance of using advanced computational methods to ensure all patients have access to high-quality breast cancer care. This uniformity in diagnostic capability ensures that all demographic groups receive the same high standard of care, potentially reducing racial and ethnic disparities in breast cancer outcomes. Consequently, Deep-BCR-Auto represents a major advancement in personalized medicine, potentially enhancing treatment planning and improving prognostic accuracy for diverse patient populations.\n\nAlthough our study shows promising results, there are areas that could be improved. Our datasets exhibit a categorical imbalance between low and high-risk cases, particularly for the HR+/HER2- subset we focused on. As a result, our testing data includes a limited number of high-risk slides (~15% of all slides), which restricts our ability to evaluate the performance of our model thoroughly. This data imbalance could also impact the training process, causing the deep learning model to be biased toward predicting low-risk cases more frequently. This is expected, as high-risk cases are typically rare in ODX examinations. According to the National Cancer Database, only 15% of patients are classified as high-risk, which aligns with our data distribution [43]. Despite this, our proposed model achieved a balanced specificity, sensitivity, and excellent AUROC. In future studies, we plan to collect a larger cohort of patients to strengthen our dataset and further validate our model's performance. Additionally, we envision developing Deep-BCR-Auto into a web-based platform that can analyze ODX scores from uploaded WSIs, thereby extending access to this critically important test to regions where the actual test is currently unavailable.\n\nIn conclusion, Deep-BCR-Auto exhibits the potential to enhance personalized treatment planning and improve patient outcomes in breast cancer care. Future research should focus on validating our findings with larger clinical-level datasets and exploring the integration of this technology into routine clinical practice. By doing so, we can ensure that more patients benefit from precise and equitable breast cancer prognosis and treatment."}]}