{"title": "Score-based Generative Diffusion Models for Social Recommendations", "authors": ["Chengyi Liu", "Jiahao Zhang", "Shijie Wang", "Wenqi Fan", "Qing Li"], "abstract": "With the prevalence of social networks on online platforms, social recommendation has become a vital technique for enhancing personalized recommendations. The effectiveness of social recommendations largely relies on the social homophily assumption, which presumes that individuals with social connections often share similar preferences. However, this foundational premise has been recently challenged due to the inherent complexity and noise present in real-world social networks. In this paper, we tackle the low social homophily challenge from an innovative generative perspective, directly generating optimal user social representations that maximize consistency with collaborative signals. Specifically, we propose the Score-based Generative Model for Social Recommendation (SGSR), which effectively adapts the Stochastic Differential Equation (SDE)-based diffusion models for social recommendations. To better fit the recommendation context, SGSR employs a joint curriculum training strategy to mitigate challenges related to missing supervision signals and leverages self-supervised learning techniques to align knowledge across social and collaborative domains. Extensive experiments on real-world datasets demonstrate the effectiveness of our approach in filtering redundant social information and improving recommendation performance. Our codes are available at https://github.com/Anonymous-CodeRepository/Score-based-Generative-Diffusion-Models-for-Social-Recommendations-SGSR", "sections": [{"title": "I. INTRODUCTION", "content": "In the era of information explosion, Recommender Systems (RS) have emerged as indispensable tools for mitigating information overload and personalizing users' content stream across e-commerce and social media platforms. Collaborative Filtering (CF), which aims to learn user and item representations from historical interactions, forms the foundation of modern recommender systems [1]\u2013[4]. However, CF-based methods face a persistent challenge due to their reliance on the quality of user-item interaction data: real-world interaction data used for training is often sparse, which can adversely impact the performance of these models [5]\u2013[7]. To address the data sparseness issue, social recommendation methods incorporate social context to enhance the modelling of user intent within user representations. This practice aligns with the idea that individuals connected through social ties often exhibit similar preferences-a phenomenon supported by social influence theory [8], [9] and also recognized as social homophily [10], [11]. In recent years, a wide range of research has focused on enhancing the performance of social recommendations by leveraging the social homophily condition, encompassing Graph Neural Networks (GNNs) methods [12]\u2013[15] and Self-Supervised Learning (SSL) methods [16], [17].\nNevertheless, the underlying assumption of social ho-mophily has recently been questioned. Extensive statistical and empirical analyses [11], [18]\u2013[20] have suggested that leveraging the raw social graph can be unreliable and may further degrade the recommendation performance. This counter-intuition arises because of the inherent complexity and noise present in real-world social networks [21], [22], introducing noisy information into learned user representations. Considering the example in Fig. 1, a male student (i.e., User A) might establish social relationships with a female classmate (i.e., User B) who has recently acquired cosmetics or feminine apparel, yet such relationships likely contribute to unreliable recommendations for the male. Consequently, these noisy social signals can propagate through social encoder layers, accumulating bias and ultimately hindering the recommender system's effectiveness [19]. Thus, it is necessary to develop social denoising methods to filter redundant social signals from user-user social graph, alleviating the negative impact of such signals on recommendation performance.\nEfforts to address the low social homophily problem pri-marily rely on data-centric graph editing methods [11], [18], [19], [23], which denoise the social graph by deleting or rewiring edges based on human-designed heuristics, resulting in improved user representations. For example, GDMSR [18] uses a transformer layer to compute user similarity with users' interacted item lists, thereby refining the social network ac-cording to these user similarities. However, these methods face two key limitations in achieving optimal social representation consistent with collaborative signals:\n\u2022 Handcrafted Similarity Metrics: These graph editing methods, guided by the heuristic rules, rely solely on handcrafted user similarity metrics (e.g., cosine similarity), which lacks generalizability and effectiveness in evaluating social networks. These metrics are typically limited to one-hop modifications of social relations and depend heavily on the representation capacity of the underlying backbone models in the social domain. As illustrated in Fig. 2 (a), handcrafted heuristics may lead to suboptimal user repre-sentations (denoted by dark circles) that are far from the optimal representation (denoted by red star *).\n\u2022 Expressive Capability Limitation: These methods are unable to adaptively account for all users within a so-cial network, which is computationally infeasible due to the vast number of users. The graph rewiring algorithms focus on a small, predefined subset with a fixed number of candidates, such as one-hop neighbours or users with high embedding similarity. This approach neglects users with similar preferences who do not conform to these predefined criteria, thereby missing opportunities to enhance the alignment between social and collaborative signals. Furthermore, extending denoising to multi-hop optimization may introduce conflicts between local and global optima in the graph editing process.\nTo overcome the aforementioned limitations, we propose a fundamentally novel approach to denoise social information in recommendation systems (RS) from a generative perspective. Specifically, our key idea is to model the underlying distri-bution of users' social representations and directly generate denoised social representations that maximize consistency with collaborative signals. This generative paradigm is highly desirable as it allows us to transcend all possible graph structure revisions and achieve the ideal social representation, which may be unreachable through graph editing steps under computational constraints. To instantiate this novel generative paradigm, we draw inspiration from the success of diffusion models in image restoration [24]\u2013[26], and propose to leverage the potential of score-based generative models (SGMs) [27], a strong yet unexplored class of diffusion models. Empowered by stochastic differential equations (SDEs) SGMs unify the diffusion processes, such as DDPM [28] and SMLD [29], in continuous time steps. This unified continuous formulation enables a predict-and-correct generative paradigm that flexibly incorporates a wide range of numerical SDE solvers and statistical methods, thereby reducing numerical errors in the computation of diffusion models and more accurately captur-ing the complexities of the social denoising problem [30], [31].\nDespite the great potential, it is highly challenging to directly take advantage of SGMs for social denoising in social recommendations. First, the optimal social network that accurately aligns with users' preference patterns remains unknown, leading to a lack of appropriate supervision signals (i.e., training objectives) for SGMs. Additionally, since SGMs were originally designed for image generation and denoising, applying them to social recommendations introduces multiple challenges, such as handling high-order graph structures and aligning signals from social and collaborative domains. To address the challenges above, we propose the Score-based Generative Model for Social Recommendation (SGSR) to transcend the social homophily condition in social recommen-dations with SGMs. Instead of manually determining the sub-optimal embeddings from edited social graphs as supervisory signals, a curriculum learning mechanism is introduced to facilitate the modelling of social representations across social graphs with incrementally sparse levels. Furthermore, a joint optimization method is developed to leverage collaborative signals to implicitly identify the optimal social representation. Our main contributions are summarized as follows:\n\u2022 We propose a score-based generative framework (SGSR) that effectively captures the underlying distribution of social representations and improves their collaborative consistency.\n\u2022 To effectively adapt the SGM in the context of social rec-ommendation, we derive a novel classifier-free conditioning objective to achieve the personalized denoising diffusion process based on the user-item behaviour.\n\u2022 To address training obstacles of leveraging SGMs for social"}, {"title": "C. Score-based Generative Social Denoising", "content": "To address the limitations of existing graph-based social denoising methods, we adopt a controllable SDE-based dif-fusion process to directly optimize social representations. This approach enables the continuous refinement of social representations, guided by user interaction behavior.\n(1) Graph Representation Learning. To encode the high-order social relations into the denoising framework, we first trans-form the original social embeddings into a latent space before the diffusion process. Specifically, we employ the widely used Graph Convolutional Network (GCN) [32]\u2013[34] as the social encoder (denoted by \\(SoEnc(\\cdot)\\)) of our denoising framework, which follows an iterative message-passing process described as follows:\n\\(E^{(0)} = P_s,\\)\n\\(E^{(l)}_S = \\phi(A_s E^{(l-1)}_S W^{(l)}), \\forall l = 1, 2, ..., L,\\) (1)\nwhere \\(L\\) denotes the number of GCN layers, \\(W^{(l)}\\) denotes trainable transformation matrices, and \\(\\phi\\) is an activation func-tion. The normalized adjacency matrix of the social graph is defined as \\(A_s = D_S^{-1/2} S D_S^{-1/2}\\), where \\(D_S\\) is the diagonal degree matrix of \\(S\\).\nAdditionally, we obtain user and item representations from the collaborative domain to control the social denoising pro-cess. We adopt an arbitrary graph-based encoder (e.g., Light-GCN [3], PinSAGE [35], etc.) for collaborative filtering with \\(L\\) layers, denoted by \\(RecEnc(\\cdot)\\), and obtain the collaborative representation as follows:\n\\(E^{(0)}_R = P_R,\\)\n\\(E^{(L)}_R = RecEnc(E^{(L-1)}_R, A_R),\\) (2)\nwhere \\(A_R\\) is the adjacency matrix of the collaborative graph. Note that the choice of \\(RecEnc(\\cdot)\\) is independent of the input of our generative social denoising model, indicating that the proposed SGSR is a general framework adaptable to existing recommendation backbone models.\n(2) Collaboratively Controlled Denoising Diffusion Paradigm. After capturing the long-range and non-linear relations in the social network, we apply the score-based diffusion process on the propagated social representation \\(E^{(L)}_S\\) for further denoising. Specifically, SGMs use two Stochastic Differential Equations (SDEs) to model the noising and denoising processes of the data distribution.\nForward Process. The forward process aims to transform the original data distribution of social representations into a prior distribution (e.g., Gaussian noise) in a continuous manner. Considering the forward diffusion process \\({x_t\\}_{t \\in [0,1]}\\) with respect to the continuous time step \\(t\\), we first define the raw social embedding \\((e^{(L)}_S)_u\\) of a user \\(u\\) as the initial state \\(x_0\\), taken from embedding matrix \\(E^{(L)}_S\\), and \\(x_t\\) follows the prior distribution. The forward diffusion process is defined by the following SDE:\n\\(dx = f(x, t)dt + g(t)dw,\\) (3)\nwhere \\(w\\) refers to the standard Wiener process [36] (a.k.a. Brownian motion), and \\(dt\\) is an infinitesimal time step. The"}, {"title": "D. Curriculum-Driven Training of the Social Denoising Model", "content": "Since the optimal social representation that maximizes con-sistency with collaborative signals is difficult to determine, training the SGM for social graph denoising presents signifi-cant challenges due to the lack of ground truth and supervision signals. For example, in image restoration tasks, SGMs use deteriorated images as input and compute the loss function between the ground-truth image and the denoised image. This straightforward training strategy is inapplicable in the context of social denoising, as the ground-truth optimal social representation is not accessible. To overcome this limitation, we employ a curriculum learning strategy that enables the SGM to perceive social representations across social graphs with varying levels of sparsity. This approach potentially encompasses the optimal social graph, which the SGM model can identify automatically with collaborative signals.\nThe two-stage curriculum training mechanism implements a progressive learning paradigm, gradually exposing the SGM to increasingly sparse social distributions. The sparser social distributions, characterized by fewer relationships, encapsulate reduced learnable information, posing greater challenges for models to learn the distributions [41]. This method forms an easy-to-hard training strategy, enhancing the robustness of the learning process. Specifically:\n\u2022 In the initial stage, the model retains the percentage \\(p\\) of social connections that exhibit the most similar preference patterns for \\(N\\) epochs. Given the collaborative represen-tations of user \\(i\\) and \\(j\\) from \\(RecEnc(.)\\) as \\((e^{(L)}_R)_u\\) and \\((e^{(L)}_R)_{uj}\\), we leverage the inner product to measure the similarity \\(sim = \\langle (e^{(L)}_R)_{ui}, (e^{(L)}_R)_{uj}\\rangle\\) [18].\n\u2022 In the second stage, a random selection mechanism keeps \\(p\\) percentage of social relations for the subsequent \\(M\\) epochs in the curriculum period, facilitating SGM's access to a broader range of social representations.\nThis approach encourages the SGM to model the rela-tionship between collaborative conditions and social patterns across varying levels of graph sparsity. The initial pro-cess focuses on user-level sparsification, selectively removing seemingly irrelevant social connections that are more readily learnable [42], while the latter method implements a holistic"}, {"title": "E. Score-based Denoising Model Optimization", "content": "Besides explicit conditioning on the observed user be-haviour patterns, the SGSR leverages the recommendation signal to implicitly guide the SGM in identifying the optimal social representation. On the other hand, to integrate the produced social representation into the collaborative domain, the SGSR introduces an auxiliary SSL loss to augment the primary recommendation task.\n(1) Cross-domain Contrastive Learning. The stochastic Wi-ener process and exposure bias in the interactive sampling process may introduce undesired noise to the generated social representation [44], [45]. To mitigate these biases and effec-tively leverage the learned social representation distribution, the SGSR incorporates contrastive learning techniques, known for their high efficiency in knowledge transfer [16], [46]. The SGSR enhances the RS with social information by maximizing the consistency of user representations across the social and collaborative domains.\nAs described in II-C, we construct the denoised social repre-sentation \\(\\hat{E}^{(L)}_S\\), produced by the SDE-based diffusion process as the self-supervised signal. To integrate social information into the collaborative domain, we adopt the InfoNCE loss [47] as our contrastive learning objective to optimize the user representations by maximizing the agreement between \\(\\hat{E}^{(L)}_S\\) and \\(P^{(L)}_R\\), which can be defined as:\n\\(\\mathcal{L}_{Col} = \\sum_{u\\in U} -log\\frac{s(\\hat{e}_u, p_u)}{s(\\hat{e}_u, p_u) + \\sum_{k\\neq j} s(\\hat{e}_u, p_{u_k})},\\) (12)\nwhere \\(\\hat{e}_u = MLP((\\hat{e}^{(L)}_S)_u)\\) and \\(p_u = MLP((e^{(L)}_R)_u)\\) denotes the social representation and collaborative representation of user u projected to the same semantic space by multi-layer perceptrons MLP(\u00b7), \\(s(\\hat{e}_u, p_u) = exp\\langle cos(\\hat{e}_u, p_u)/\\tau\\rangle\\), and \\(\\tau\\) is the temperature parameter.\n(2) Joint Training Mechanism. The SGSR leverages the recommendation signal to guide the social representation re-finement trajectory with the well-established Bayesian Person-alized Ranking (BPR) loss, denoted as \\(\\mathcal{L}_{BPR}\\) [48].\n\\(\\mathcal{L}_{BPR} = \\sum_{u \\in U} \\sum_{i \\in V^+} \\sum_{j \\in V^-} -log\\sigma(\\hat{p}_{ui} - \\hat{p}_{uj}),\\) (13)\nwhere \\(V^+\\) represents the set of items interacted by user u, \\(\\sigma(\\cdot)\\) denotes the sigmoid function, \\(\\hat{p}_{ui}\\) and \\(\\hat{p}_{uj}\\) represent the predicted scores for user u over the positive item and negative sample, respectively. The joint optimization loss for the SGSR is:\n\\(\\mathcal{L} = \\mathcal{L}_{Diff} + \\lambda_1 \\mathcal{L}_{BPR} + \\lambda_2 \\mathcal{L}_{cl},\\) (14)\nwhere \\(\\lambda_1\\) and \\(\\lambda_2\\) are hyperparameters to balance the social denoising score matching and the recommendation accuracy. Details of the training process of the denoising model are shown in the Algorithm 2."}, {"title": "III. EXPERIMENT", "content": "In this section, we evaluate the effectiveness of the proposed SGSR framework through extensive experiments.\nA. Experiment Settings\n(1) Datasets. The experiments are conducted on three real-world social recommendation datasets: Ciao 1, Epinions\u00b9, and Dianping 2. Each dataset records users' ratings on items on a scale of [1,5] and their social connections. These three datasets have been shown to satisfy the low social homophily assumption (with graph-wise homophily ratio smaller than 0.1"}, {"title": "IV. RELATED WORK", "content": "In this section, we summarize the related works on the social recommendation task and diffusion models for recommenda-tions."}, {"title": "A. Social Recommendations and Social Denoising Methods", "content": "(1) General Social Recommendation Methods. The widespread use of online social networks has alleviated the data sparsity issue in recommender systems by incorporating social context to enhance user representation modelling. Early approaches to social recommendations adopted the social homophily assumption and directly leveraged raw social net-works, evolving through matrix factorization [49], [56], [57], graph neural networks [12], [32], [58], and self-supervised learning [17], [46], [50]. However, these methods struggle to address the redundant or irrelevant information inherent in raw social networks, introducing noise into user representations. This problem necessitates systematic denoising methods to improve social recommendation.\n(2) Data-centric Social Denoising Methods. Current social denoising methods primarily focus on modifying users' social relations by assessing the confidence of social connections using handcrafted metrics to filter out irrelevant relations. For example, GDMSR [18] employs a transformer layer to evaluate the confidence of social connections based on histor-ical interactions, removing a fixed percentage of edges with the lowest similarity scores. SHaRe [11] and MADM [59] use cosine similarity to assess the reliability of social rela-tions, discarding or rewiring connections with low similarity scores and keeping reliable connections. GBSR [20] introduces a theoretically-inspired framework to maximize the mutual information between the denoised social graph and the in-teraction matrix, but it only drops the links in the social network while ignoring possibly beneficial edge rewiring or injecting operations. Generally speaking, existing data-centric social denoising methods can hardly reach the optimal social representation, since the best-fitted measure of social relations remains unknown and cannot be simply designed by human heuristics. Besides, graph editing methods only improve users' social representations indirectly, and the editing path to the optimal graph structure corresponding to the optimal social representation may be computationally infeasible. This shows that it is necessary to address the low social homophily issue from an innovative generative perspective, which is the key research aim of this paper.\n(3) Contrastive Social Denoising Methods. Unlike data-centric methods that modify the structure of social networks to enhance user representations, another line of research focuses on directly improving users' representations through con-trastive learning. These methods [53], [59], [60] typically align user representations from different views (e.g., social or col-laborative domains) to achieve a position more consistent with collaborative signals in the latent space. However, contrastive denoising approaches also rely on pre-defined user similarity measurements, which may not fully leverage the supervision signal from collaborative filtering, potentially falling short of reaching the optimal user representations. Additionally, since contrastive denoising methods adjust the training loss function to reduce noise in social networks, they are orthogonal to our proposed framework and can be adaptively integrated. We plan to explore the integration of the proposed SGSR framework with various auxiliary loss functions in future work."}, {"title": "B. Diffusion Models for Recommendations", "content": "Diffusion models, a powerful class of generative models, have significantly reshaped various recommendation tasks with their effective generation capabilities. In collaborative filtering (CF), DiffRec [51] serves as a fundamental contribution, pro-viding accurate recommendations from a diffusion perspective. Specifically, DiffRec encodes a user's list of interacted items into a latent vector and employs a forward-reverse process to generate missing user-item interactions in the latent space. The diffused latent vector is then decoded into predicted user-item interactions. Following the proposal of the DiffRec framework, CF-Diff [61] and GiffCF [62] enhanced this approach by incor-porating high-order relational capabilities through graph-level diffusion models. Another notable diffusion model, Dream-Rec [52], targets sequential recommendation tasks by using a conditional generation paradigm to generate target-item embeddings based on historical interaction sequences. Addi-tionally, leveraging the strong generative ability of diffusion models to produce high-quality samples or representations for recommendation has shown promise in recommendations [55], [63], [64]. For instance, DDRM [55] refines noisy implicit user-item interaction data by applying a diffusion process to user and item representations, conditioned on their initial embeddings. Moreover, other tasks, such as point-of-interest (POI) recommendation [65] and knowledge-aware recommen-dation [66], have also benefited from the success of diffusion models. However, existing diffusion recommender models are not designed to integrate denoised social information into recommendations, which differs from the primary research ob-jective of this paper. Additionally, most existing works utilize the Denoising Diffusion Probabilistic Models (DDPM) [28] framework, which can be seen as a specific discretized form of Score-based Generative Models (SGM) [30], highlighting the novelty of the proposed SGSR framework."}, {"title": "V. CONCLUSION", "content": "In this paper, we address the low homophily challenge in social recommendation from a generative perspective using score-based diffusion models. Specifically, we implement an SDE-based diffusion process to produce collaboratively con-sistent social representations conditioned on user preference patterns. Recognizing that classifier guidance is unsuitable for recommendation contexts, we derive a novel classifier-free optimization objective to facilitate the training of SGMs. To address the lack of supervision signals in recommendation scenarios, we introduce a curriculum learning mechanism and a joint training strategy. Our evaluation of SGSR on three real-world datasets demonstrates significant improvements in recommendation performance compared to existing methods, validating the effectiveness of our social denoising approach. For future work, a promising direction is to accelerate sampling by designing consistent functions [67] within the recommendation context (training time analysis in Appendix III-E). Additionally, exploring various SDE solvers, such as Runge-Kutta methods, could enhance the inference process by leveraging the computational flexibility of score-based diffusion models. Furthermore, while this paper primarily"}]}