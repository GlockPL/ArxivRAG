{"title": "Testability of Instrumental Variables in Additive Nonlinear, Non-Constant Effects Models", "authors": ["Xichen Guo", "Zheng Li", "Biwei Huang", "Yan Zeng", "Zhi Geng", "Feng Xie"], "abstract": "We address the issue of the testability of instrumental variables derived from observational data. Most existing testable implications are centered on scenarios where the treatment is a discrete variable, e.g., instrumental inequality (Pearl, 1995), or where the effect is assumed to be constant, e.g., instrumental variables condition based on the principle of independent mechanisms (Burauel, 2023). However, treatments can often be continuous variables, such as drug dosages or nutritional content levels, and non-constant effects may occur in many real-world scenarios. In this paper, we consider an additive nonlinear, non-constant effects model with unmeasured confounders, in which treatments can be either discrete or continuous, and propose an Auxiliary-based Independence Test (AIT) condition to test whether a variable is a valid instrument. We first show that if the candidate instrument is valid, then the AIT condition holds. Moreover, we illustrate the implications of the AIT condition and demonstrate that, in certain conditions, AIT conditions are necessary and sufficient to detect all invalid IVs. We also extend the AIT condition to include covariates and introduce a practical testing algorithm. Experimental results on both synthetic and three different real-world datasets show the effectiveness of our proposed condition.", "sections": [{"title": "1 Introduction", "content": "Estimating causal effects from observational data is a fundamental task in understanding the underlying relationships between variables. The instrumental variables (IV) model is a well-established method for estimating the causal effect of a treatment (exposure) X on an outcome Y in the presence of latent confounding and has been used in a range of fields, such as economics (Imbens, 2014; Imbens and Rubin, 2015), sociology (Pearl, 2009; Spirtes et al., 2000), epidemiology (Hern\u00e1n and Robins, 2006; Baiocchi et al., 2014), and artificial intelligence (Chen et al., 2022; Wu et al., 2022). Generally speaking, given a causal relationship X \u2192 Y, the valid IV Z is required to satisfy the following three conditions:\nC1. Z is related to the treatment (relevance), C2. Z is independent of the unmeasured confounders that affect the treatment and outcome (exogeneity), and C3. Z has no direct path to the outcome (exclusion restriction)."}, {"title": "2 Preliminaries", "content": "Our research is conducted within the framework of causal graphical models as elaborated by Pearl (2009) and Spirtes et al. (2000). Specifically, we represent causal relationships using the directed acyclic graph (DAG), denoted as G, where nodes represent variables and directed edges (arrows) indicate causal links between those variables. Sets of variables are represented in bold, and individual variables and symbols for graphs are in italics. We use \"instrumental variable (IV)\u201d and \u201cinstrument\" interchangeably. The main symbols used in this paper are summarized in Table 1."}, {"title": "2.2 Additive Non-Parametric Instrumental Variable Model", "content": "The instrumental variable approach offers a strategy for inferring the causal effect of interest in the presence of unmeasured confounders (Bowden and Turkington, 1990; Angrist et al., 1996; Pearl, 2009; Imbens and Rubin, 2015). Given a causal relationship X \u2192 Y, a valid IV Z is required to satisfy the following three conditions:\nC1. (Relevance). Z has directly affect the treatment X;\nC2. (Exogeneity or Randomness). Z is independent of the unmeasured confounders U;\nC3. (Exclusion Restriction). Z does not directly affect the outcome Y."}, {"title": "Definition 1", "content": "A random variable Z is a valid IV for causal relationship X Y if the above three conditions C1 ~ C3 are satisfied.\nWe here consider the additive non-parametric IV model presented in Newey and Powell (2003), which, for a valid IV Z, it can be expressed as follows 1:\n$X = g(Z) + \\varphi_x(U) + \\varepsilon_X,$\n$Y = f(X) + \\varphi_y(U) + \\varepsilon_Y,$\nwhere $E[\\varphi_y (U) + \\varepsilon_Y|Z] = 0$, and the noise terms $\\varepsilon_X$ and $\\varepsilon_Y$ are statistically independent."}, {"title": "Remark 1", "content": "Newey and Powell (2003) have shown that, given a valid IV Z, the causal effect f(\u00b7) of interest in the above model in Equation (1) can be consistently estimated if the"}, {"title": "2.3 Additive Nonlinear, Non-Constant Effects Model", "content": "Without loss of generality, we assume that all variables have a zero mean (otherwise can be centered) and that no covariates are present for simplicity. In Section 4, we address the practical scenario where covariates are included. In this paper, we focus our attention on the Additive Nonlinear, Non-Constant Effects (ANINCE) Model. Specifically, the generation process satisfies the following structural causal model:\n$X = g(Z) + \\varphi_x(U) +\\varepsilon_X,$\n$Y = f(X,Z) + \\varphi_y(U) + \\varepsilon_Y,$\nwhere f(.) denotes the true, unknown causal effect of interest, and g(\u00b7), f(\u00b7) and $\\varphi_*(\u00b7)$ are smooth/deterministic functions from R \u2192 R. The noise terms $\\varepsilon_X$ and $\\varepsilon_Y$ are statistically independent. Note that Z and U may be dependent, which indicates that the exogeneity condition (C2) is violated, and the non-zero f(\u00b7, Z) function indicates that Z directly affects the outcome Y, implies that the exclusion restriction condition (C3) is violated.\nA special case of the ANINCE model is the additive linear, constant effects model (AL-ICE), where functions g(\u00b7), f(\u00b7), and $\\varphi_*(\u00b7)$ are linear functions, which have been extensively studied in works such as those by Bowden et al. (2015); Kang et al. (2016); Silva and Shimizu (2017); Windmeijer et al. (2021). Compared to these works, we investigate the testability of IV in a more challenging scenario, where g(\u00b7), f(\u00b7), and $\\varphi_*(\u00b7)$ may be non-linear functions. Additionally, we focus on the testability of a single valid IV, whereas previous works have focused on the testability of a set of IVs (including at least two or more valid IVs among the candidate variables).\nOur Goal. The goal of this paper is to determine, from the observed dataset {X, Y, Z} satisfying an ANINCE model, whether Z is related to X (i.e., relevance condition), Z is exogenous relative to (X, Y) (i.e., exogeneity condition) and Z does not directly affect outcome Y (i.e., exclusion restriction condition). Note that the first condition relevance, can be easily checked by the independent test because Z and X are observed variables. Therefore, we focus on the last two conditions of IV Z. In summary, we aim to provide a new necessary condition to detect whether a variable is a valid IV and investigate the necessary and sufficient conditions under which all invalid IVs can be detected."}, {"title": "Remark 2", "content": "Existing approaches have attempted to detect the violations of exogeneity of a single IV within the discrete variable setting. Representative methods along this line include instrumental inequality (Pearl, 1995), and its extensions (Manski, 2003; Palmer et al., 2011; Kitagawa, 2015; Wang et al., 2017; K\u00e9dagni and Mourifi\u00e9, 2020). Unlike existing work, we focus on settings with continuous variables. Pearl (1995) already conjectured that instrument validity is not testable in a continuous variable setting without additional assumptions, a theory recently confirmed by Gunsilius (2021). The key difference to existing"}, {"title": "3 AIT Condition and Its Implications in ANINCE Models", "content": "In this section, we first formulate the Auxiliary-based Independence Test Condition (AIT Condition) and show that it is a necessary condition for evaluating IV validity. We further present theoretical results regarding the implications of the AIT condition in the linear, constant effects model and nonlinear, non-constant effects model."}, {"title": "3.1 AIT Condition", "content": "Below, we give the AIT Condition, which defines the independent relationship between the \"Auxiliary variable\" and candidate IV. Note that concepts to \"auxiliary variable\" have been developed to address different tasks (Drton and Richardson, 2004; Chen et al., 2017; Cai et al., 2019), but our formalization is different from theirs (See Equation (3)). To the best of our knowledge, it has not been realized that the independence property involving such an auxiliary variable reflects the validity of the IV in the ANINCE model."}, {"title": "Definition 2 (AIT Condition)", "content": "Suppose treatment X, outcome Y, and candidate IV Z are nodes in a causal graph G. Define the auxiliary variable of the causal relationship X \u2192 Y relative to Z, as\n$A_{X\\rightarrow Y||Z} := Y \u2013 h(X),$\nwhere h(\u00b7) satisfies $E[A_{X\\rightarrow Y||Z}|Z] = 0$ and h(\u00b7) \u2260 0. We say that {X,Y||Z} follows the AIT condition if and only if $A_{X\\rightarrow Y||Z}$ is independent from Z.\nFor the sake of conciseness, we often drop the subscript X \u2192 Y||Z from $A_{X\\rightarrow Y||Z}$ when there is no ambiguity. The following theorem shows the testability of an IV in light of the AIT condition in an ANINCE model."}, {"title": "Theorem 1 (Necessary Condition for IV)", "content": "Let X, Y, and Z be the treatment, outcome, and candidate IV in an ANINCE model, respectively. Suppose that X, Y, and Z are correlated and that the sample size n \u2192 \u221e holds. Further, suppose that the probability densities p(\u03b5\u03c5) and p(\u03b5z) are twice differentiable, and positive on (-\u221e,\u221e). If Z is a valid IV relative to X \u2192 Y, then {X,Y||Z} always satisfies the AIT condition."}, {"title": "Proof", "content": "If Z is a valid IV relative to X \u2192 Y, then the ANINCE model can be rephrased as additive non-parametric IV models (Equation (1)). Following the consistent IV estimation method via the conditional mean model (e.g., Newey and Powell (2003); Singh et al. (2019); Bennett et al. (2019)), h(\u00b7) can represent the unbiased causal effect f(\u00b7) of X on Y as the sample size n \u2192 \u221e, implying that h(\u00b7) = f(\u00b7). Thus, we have auxiliary variable\n$A_{X\\rightarrow Y||Z} = Y \u2013 h(X) = Y \u2212 f(X) = \\epsilon = \\varphi_y (U) + \\varepsilon_Y.$"}, {"title": "Theorem 1", "content": "means that if {X,Y||Z} violates the AIT condition, then Z is an invalid IV relative to X \u2192 Y. Otherwise, Z may or may not be valid."}, {"title": "3.2 Implications of AIT Condition in Additive Linear, Constant Effects Models", "content": "In this section, we focus our attention on a special type of ANINCE model, the linear, con-stant effects model, which has been widely studied (Bowden et al., 2015; Kang et al., 2016;Silva and Shimizu, 2017; Windmeijer et al., 2021). Specially, we assume that each node inthe graph G represents a linear structural equation model, i.e., $V_i = \\sum_{V_j \\in pa(V_i)}\\alpha_{ij} V_j + \\varepsilon_{v_i}, i =1, 2, ..., n$, where the noise terms $\\varepsilon_{v_1},..., \\varepsilon_{v_n}$ are independent of each other, and $\\alpha_{ij}$ is thedirect effect of $V_j \\rightarrow V_i$. Hence, the ANINCE model in Equation (2) can be expressed asfollows:\n$X = \\tau Z + \\rho U + \\varepsilon_X,$\n$Y = \\beta X + \\nu Z + \\kappa U + \\varepsilon_Y,$"}, {"title": "Proposition 1 (Non-testability in Linear Gaussian Models)", "content": "Let X, Y, and Z bethe treatment, outcome, and candidate IV in a linear model (Equation (8)), respectively.Suppose that X, Y, and Z are correlated and that the sample size n \u2192 \u221e holds. If all noiseterms of variables follow Gaussian distributions, then regardless of whether Z is a valid IVrelative to X \u2192 Y or not, {X,Y||Z} always satisfies the AIT condition."}, {"title": "Proof", "content": "The proof of Proposition 1 is straightforward. Let Z represents any candidateIV, which may or may not be valid. By the definition of the AIT condition, we have$E[A_{X\\rightarrow Y||Z}|Z] = 0$, regardless of the choice of h(\u00b7). This directly implies that the correla-tion between $A_{X\\rightarrow Y||Z}$ and Z is zero. In the linear Gaussian model, zero correlation impliesindependence (Bain and Engelhardt, 1992). Therefore, the condition $E[A_{X\\rightarrow Y||Z}|Z] = 0$implies that $A_{X\\rightarrow Y||Z}$ is independent of the candidate IV Z in the linear Gaussian model.In other words, {X,Y||Z} always satisfies the AIT condition."}, {"title": "Proposition 1", "content": "states that checking the AIT condition in a linear Gaussian causal model(second-order statistics) does not provide any useful information for identifying invalid IVs.Below, we show that higher-order statistics 2 of noise terms enable us to identify certaintypes of invalid IVs that violate the exogeneity condition. Before presenting the result, wegive the key assumption."}, {"title": "Assumption 1 (Partial Non-Gaussianity)", "content": "At least one of the following conditions holds:(i) there exists at least one variable $U_k \\in U$ whose noise term follows a non-Gaussian dis-tribution and cause Z; (ii) the noise term of Z follows a non-Gaussian distribution."}, {"title": "Assumption 1", "content": "states the non-Gaussianity of data, which is expected to be widespread,as suggested by Cram\u00e9r Decomposition Theorem (Cram\u00e9r, 1962). Considerable works havealready been built on this assumption (Shimizu et al., 2006; Salehkaleybar et al., 2020). Foradditional references, see Spirtes and Zhang (2016); Shimizu (2022).\nWe now show that the AIT condition can access the validity of exogeneity condition inlinear models under Assumption 1."}, {"title": "Proposition 2 (Testability of Exogeneity in Linear Models)", "content": "Let X, Y, and Z bethe treatment, outcome, and candidate IV in a linear model (Equation (8)), respectively.Suppose that X, Y, and Z are correlated and that the sample size n \u2192 \u221e holds. Further-more, suppose that Assumption 1 holds. If Z violates the exogeneity condition, i.e., at leastone variable $U_k \\in U$ causes Z, then {X,Y||Z} violates the AIT condition."}, {"title": "Proof", "content": "Roughly speaking, if $A_{X\\rightarrow Y||Z}$ shares common non-Gaussian noise terms with Z, bythe Darmois-Skitovich theorem (Darmois, 1953; Skitovitch, 1953), $A_{X\\rightarrow Y||Z}$ is statisticallydependent from Z. This implies that {X,Y||Z} violates the AIT condition. See AppendixA.1 for its complete proof."}, {"title": "Remark 3", "content": "When all noise terms follow the non-Gaussian distributions, the linear partialnon-Gaussian model becomes the well-known Linear Non-Gaussian Acyclic Model (LiNGAM),which has been extensively studied (Shimizu et al., 2006; Salehkaleybar et al., 2020). Con-sequently, according to Proposition 2, an invalid IV that violates the exogeneity conditionin LiNGAM can be detected in light of the AIT condition."}, {"title": "Proposition 3 (Non-testability of Exclusion Restriction in Linear Models)", "content": "Let X,Y, and Z be the treatment, outcome, and candidate IV in a linear model (Equation (8)),respectively. Suppose that X, Y, and Z are correlated and that the sample size n \u2192 \u221eholds. If Z satisfies the exogeneity condition, regardless of whether Z violates the exclusionrestriction condition or not, then {X,Y||Z} always satisfies the AIT condition."}, {"title": "Proof", "content": "This proof is straightforward. The auxiliary variable $A_{X\\rightarrow Y||Z}$ shares no commonnoise terms with candidate IV Z, whether the noise terms are Gaussian or non-Gaussian.By the Darmois-Skitovich theorem (Darmois, 1953; Skitovitch, 1953), $A_{X\\rightarrow Y||Z}$ is statisti-cally independent from Z. This implies that {X,Y||Z} always satisfies the AIT condition.See Appendix A.2 for its complete proof."}, {"title": "Theorem 2 (Necessary and Sufficient Conditions in Linear Models)", "content": "Let X, Y, andZ be the treatment, outcome, and candidate IV in a linear model (Equation (8)), respec-tively. Suppose that X, Y, and Z are correlated and that the sample size n \u2192 \u221e holds.Furthermore, suppose that Assumption 1 holds. {X,Y||Z} violates the AIT condition ifand only if the candidate IV Z is invalid due to a violation of the exogeneity condition."}, {"title": "Proof", "content": "See Appendix A.3 for its proof."}, {"title": "3.3 Implications of AIT Condition in Additive Nonlinear, Non-ConstantEffects Models", "content": "In this section, we investigate the implications of the AIT condition on the ANINCE model.Before giving our main results, we first show a simple example to show that nonlinearity isbeneficial in identifying the invalid IV."}, {"title": "Proposition 4 (Testability of IV in ANINCE Models)", "content": "Let X, Y, and Z be the treat-ment, outcome, and candidate IV in an ANINCE model, respectively. Suppose that X, Y,and Z are correlated and that the sample size n \u2192 \u221e holds. Furthermore, suppose thatthe probability densities p(\u03b5\u03c5) and p(\u03b5z) are twice differentiable, and positive on (-\u221e,\u221e),and Assumption 2 holds. If the candidate IV Z is invalid, then {X,Y||Z} violates the AITcondition."}, {"title": "Proof", "content": "See Appendix A.4 for its proof."}, {"title": "4 Practical Implementation of AIT Condition", "content": "In this section, we discuss the practical implementation of the AIT condition. In Section4.1, we first address how to conduct the AIT condition when covariates are present. Wethen present a method for applying the AIT condition to data with a limited sample sizein Section 4.2."}, {"title": "4.1 AIT Condition with Covariates", "content": "In practice, there are scenarios where covariates W are present. For instance, age mayinfluence how the treatment method affects patient recovery speed. Therefore, we firstextend the AIT condition from Definition 2 to account for the presence of covariates, asstated in the following definition."}, {"title": "Definition 3 (AIT Condition with Covariates)", "content": "Suppose treatment X, outcome Y, co-variates W, and candidate IV Z are nodes in a causal graph G. Define the auxiliary variableof the causal relationship X \u2192 Y relative to (Z,W), as\n$A_{X\\rightarrow Y||(Z,W)} := Y \u2013 h(X, W),$\nwhere h(\u00b7) satisfies $E[A_{X\\rightarrow Y||(Z,W)}|Z,W] = 0$ and h(\u00b7) \u2260 0. Define the residual of Z afterregressing on W as:\n$\\widetilde{Z} := Z \u2013 E[Z|W].$\nWe say that {X,Y||(Z, W)} follows the AIT condition if and only if $A_{X\\rightarrow Y||(Z,W)}$ is inde-pendent from $\\widetilde{Z}$."}, {"title": "Corollary 4 (Necessary Condition for IV with Covariates)", "content": "Let X, Y, W, and $\\widetilde{Z}$be the treatment, outcome, covariates, and candidate IV in an ANINCE model, respectively.Suppose that X, Y, W, and $\\widetilde{Z}$ are correlated and that the sample size n \u2192 \u221e holds. Fur-thermore, suppose that the probability densities p(\u03b5\u03c5) and p(\u025bz) are twice differentiable, and"}, {"title": "Proof", "content": "See Appendix A.9 for its proof."}, {"title": "4.2 AIT Condition with Finite Data", "content": "Below, we provide the practical implementation of AIT condition with finite data. For acandidate IV Z, under the ANINCE model, we need to test the following hypothesis:\n$H_0$: Z is a valid IV, $H_1$: Z is an invalid IV.\nTo achieve this goal, we need to address the following two issues:\n\u2022 how can we compute the auxiliary variable $A_{X\\rightarrow Y||(Z,W)}$ using {X,Y, W, Z}?\n\u2022 how to test whether $A_{X\\rightarrow Y||(Z,W)}$ is statistical independence of $\\widetilde{Z}$?\nNext, we address the first issue. The intuitive idea is that we first use a standard IVestimator to estimate h(X, W), and then compute $A_{X\\rightarrow Y||(Z,W)} = Y \u2212 h(X, W)$. Note thatgiven a valid IV, the estimated h(X, W) is exactly f(X, W) (Newey and Powell, 2003).Otherwise, given an invalid IV, the estimated h(X, W) is biased relative to the true model.There are now many IV estimators for Additive Non-Parametric IV Models (Guo and Small,2016; Singh et al., 2019; Bennett et al., 2019). Here, we adopt the control function IV esti-mator proposed by Guo and Small (2016), which is a two-stage approach. In the first stage,it regresses the treatment variable X on covariates W and instruments (Z, h\u2082(Z), . . .,hk(Z))(a known vector of linearly independent functions of Z), obtaining the predicted value $\\widehat{X}$and the residual $e_1 = X - \\widehat{X}$. In the second stage, the outcome Y is regressed on thetreatment $\\widehat{X}$, covariates W, and the residual $e_1$ from the first stage regression. The coeffi-cients of the second stage regression are taken as the control function estimates. Note thatnonlinear functions can be estimated using basis functions. In our experiments, we applypolynomial basis functions as a predefined set of linearly independent functions, leveragingthis control function method.\nWe now tackle the second issue. To check the statistical independence of $A_{X\\rightarrow Y||(Z,W)}$and $\\widetilde{Z}$, we employ the Large-Scale HSIC Test, a Hilbert-Schmidt Independence Criterion(HSIC)-based test proposed by Zhang et al. (2018), which utilizes large-scale kernel approx-imations for independence testing. If the output Pvalue is less than the preset significancelevel \u03b1, we reject the null hypothesis $H_0$, indicating that the candidate IV Z is invalid.Conversely, if we fail to reject the null hypothesis, it suggests that Z is a valid IV.\nBased on the above discussions, the complete AIT Condition test procedure is givenin Algorithm 1. To allow for greater flexibility in the algorithm and considering that priorknowledge, such as a constant causal effect, may sometimes be available, we include a two-stage least squares estimator suitable for linear effects (Basmann, 1957; Henckel et al., 2024)to estimate the causal effect (See Lines 2 ~ 3). Note that if the covariates W have a causal effect on IV Z, we will use the random forest method to obtain the residual $\\widetilde{Z}$ of IV Z (SeeLine 8)."}, {"title": "5 Experiments", "content": "In this section, we evaluated the performance of the proposed instrument validity AITcondition using both synthetic data and three real-world datasets. All experiments wereperformed with Intel 2.90 GHz and 2.89 GHz CPUs and 128 GB of memory. Our sourcecode is available from https://github.com/zhengli0060/AIT_Condition."}, {"title": "5.1 Synthetic Data", "content": "We conducted simulation experiments from three perspectives. First, in Section 5.1.1, weverified the correctness of our theoretical results. Then, in Section 5.1.2, we compared the IV-PIM method proposed by Burauel (2023), which is designed for continuous treatments withcovariates. Finally, in Section 5.1.3, we compared the proposed method with Kitagawa'smethod, abbreviated as the K-test method (Kitagawa, 2015), which is designed for discretetreatments. In all experiments, we evaluated the performance of our method using thefollowing metrics:\n\u2022Valid IVs Misidentification Ratio (Valid MR): the ratio of the number of validIVs incorrectly identified in the output.\n\u2022Invalid IVs Misidentification Ratio (Invalid MR): the ratio of the number ofinvalid IVs incorrectly identified."}, {"title": "5.1.1 THEORETICAL VALIDATION OF PROPOSED METHOD", "content": "In this section, we conducted simulations to verify our theoretical results for both the linearmodel and the ANINCE model. Specifically, we tested our method's ability to identifyinvalid IVs that violate the exogeneity condition under three scenarios: linear constant con-ditions with varied distributions, partially nonlinear constant conditions (with Gaussiannoise terms), and partially nonlinear non-constant conditions with varied functional forms. The performance results are presented in Table 2, Ta-ble 3, and Table 4, respectively. Further, we examined the proposed method's effectivenessin identifying invalid IVs that violate the exclusion restriction condition under nonlinearconstant and nonlinear non-constant conditions with different functional forms but the sameBeta distribution. Results for these tests are shown in Table 5 and Table 6.\nExperimental Design: We generated data according to the model in Equation (2),where each candidate IV set contains both a valid IV and an invalid IV. For the nonlin-ear non-constant effects model, we applied five functions-logarithmic, quadratic polynomial,cubic polynomial, logarithmic quadratic polynomial, exponent quadratic polynomial-for g(\u00b7),f(\u00b7) and $\\varphi_*(\u00b7)$. In contrast, these functions were linear under linear, constant settings. For the error term $\\epsilon_*$, we selected six distributions\u00b3: Gaussian, Uniform, T, Beta, Gamma, Log-normal. In all experiments, the significance level was adjusted to 10 divided by the sample size. Each experiment was repeated 100 times with randomly generated data, and the re-ported results were averaged. Additional experimental details can be found in AppendixB."}, {"title": "3.3 Implications of AIT Condition in Additive Nonlinear, Non-ConstantEffects Models", "content": "In this section, we investigate the implications of the AIT condition on the ANINCE model.Before giving our main results, we first show a simple example to show that nonlinearity isbeneficial in identifying the invalid IV."}, {"title": "4 Practical Implementation of AIT Condition", "content": "In this section, we discuss the practical implementation of the AIT condition. In Section4.1, we first address how to conduct the AIT condition when covariates are present. Wethen present a method for applying the AIT condition to data with a limited sample sizein Section 4.2."}, {"title": "4.1 AIT Condition with Covariates", "content": "In practice, there are scenarios where covariates W are present. For instance, age mayinfluence how the treatment method affects patient recovery speed. Therefore, we firstextend the AIT condition from Definition 2 to account for the presence of covariates, asstated in the following definition."}, {"title": "6 Conclusions", "content": "In this paper, we explored the testability of single IVs in the additive nonlinear, non-constanteffects (ANINCE) model, where the treatment variable can be either discrete or continuous.To this end, we introduced a necessary condition, termed the AIT Condition, to detectwhether a variable is a valid IV without knowing whether some other variable is an instru-ment. Furthermore, we provided the precision conditions for identifying all invalid IVs inlinear and ANINCE models. We then proposed the practical AIT condition test algorithmwith covariates and finite data. Experimental results using both simulation data and threereal datasets have further validated the usefulness of our algorithm. In the future, we planto investigate whether the AIT condition could facilitate the testability implication of aninvalid IV set."}]}