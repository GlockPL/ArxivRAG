{"title": "Mitigating Metropolitan Carbon Emissions with Dynamic Eco-driving at Scale", "authors": ["Vindula Jayawardana", "Baptiste Freydt", "Ao Qu", "Cameron Hickert", "Edgar Sanchez", "Catherine Tang", "Mark Taylor", "Blaine Leonard", "Cathy Wu"], "abstract": "The sheer scale and diversity of transportation make it a formidable sector to decarbonize. Here, we consider an emerging opportunity to reduce carbon emissions: the growing adoption of semi-autonomous vehicles, which can be programmed to mitigate stop-and-go traffic through intelligent speed commands and, thus, reduce emissions. But would such dynamic eco-driving move the needle on climate change? A comprehensive impact analysis has been out of reach due to the vast array of traffic scenarios and the complexity of vehicle emissions. Such an analysis would require careful modeling of many traffic scenarios and solving an eco-driving problem at each one of them - a challenge that has been out of reach for previous studies. We address this challenge with large-scale scenario modeling efforts and by using multi-task deep reinforcement learning with a carefully designed network decomposition strategy. We perform an in-depth prospective impact assessment of dynamic eco-driving at 6,011 signalized intersections across three major US metropolitan cities, simulating a million traffic scenarios. Overall, we find that vehicle trajectories optimized for emissions can cut city-wide intersection carbon emissions by 11-22%, without harming throughput or safety, and with reasonable assumptions, equivalent to the national emissions of Israel and Nigeria, respectively. We find that 10% eco-driving adoption yields 25%-50% of total reduction, and nearly 70% of the benefits come from 20% of intersections, suggesting near-term implementation pathways. However, the composition of this high-impact subset of intersections varies considerably across different adoption levels, with minimal overlap, calling for careful strategic planning for eco-driving deployments. Moreover, the impact of eco-driving, when considered jointly with projections of vehicle electrification, hybrid vehicle adoption, and travel growth, remains significant. More broadly, this work paves the way for large-scale analysis of traffic externalities, such as time, safety, and air quality, and the potential impact of solution strategies.", "sections": [{"title": "Introduction", "content": "For interrupted traffic flow dynamics, dynamic eco-driving has attracted significant attention in recent decades Mintsis et al. (2020). Dynamic eco-driving is concerned with reducing carbon emissions and/or fuel consumption of vehicles individually and at the fleet level by strategically modifying driving patterns and behaviors. (Figure 1). Owing to advances in vehicle-to-infrastructure (V2I) communication technologies and the standardization of the signal phase and timing (SPaT) messages, these technologies have facilitated the research of dynamic eco-driving, especially near signalized intersections, where traffic flow is persistently interrupted Mintsis et al. (2020). Based on prior studies, we crudely estimate that persistent yet unproductive idling and excess accelerations at signalized intersections could contribute up to 14.6% of land transportation CO2 emissions in the United States (US) (refer to Appendix 10.1). Highlighting its significance, this is comparable to half of the well-scrutinized US airline sector emissions Lee et al. (2009). Reducing emissions at signalized intersections thus emerges as a promising avenue for achieving climate change mitigation goals."}, {"title": "Related Work", "content": "In the following sections, we present a summary of related work by categorizing them into four sub-sections that are closely related to our work."}, {"title": "Eco-driving at signalized intersections", "content": "Over the past decade, numerous studies have investigated the challenge of dynamic eco-driving at signalized intersections. While they often study different traffic settings, Mintsis et al. Mintsis et al. (2020) show an average eco-driving benefit of 17%, with a standard deviation of 11% by considering 21 past studies. While this highlights the potential of eco-driving, these studies often consider only a few factors that are known to have an impact on eco-driving benefits, making the shown benefits scenario/traffic setting specific. Based on the literature, we identify nearly 33 factors that affect eco-driving benefits. We refer the reader to Appendix 10.3 for more details on these factors and their known impact.\nMoreover, most eco-driving studies focus on devising better eco-driving strategies (e.g., how to eco-drive). Such studies often take three forms: 1) analytical approaches, 2) simulation approaches, and 3) field experiments Mintsis et al. (2020). Analytical approaches often focus on analyzing the eco-driving problem from a theoretical point of view by analyzing properties such as the stability of the system under certain eco-driving strategies Coppola et al. (2022). On the other hand, simulation-based approaches are used to test the potential of new eco-driving strategies and also to conduct impact assessments. However, one of the major limitations of such work is the lack of consideration of many factors that affect eco-driving benefitsBarkenbus (2010); Jayawardana and Wu (2022); Meng and Cassandras (2020); Mintsis et al. (2020). Furthermore, for simplicity and tractability of eco-driving control optimization scope, most of these studies analyze a few intersections under simplified traffic conditions (e.g., uniform inflow rates) Sun et al. (2020); Yang et al. (2016, 2020). A few studies that focus on multiple intersections often solely focus on the generalization of eco-driving strategies and rely on synthetically generated traffic scenarios while not considering the impact assessment requirements Jayawardana et al. (2024). Finally, field studies are also conducted to demonstrate the benefits of eco-driving and to validate the applicability of eco-driving strategies Hao et al. (2018); Mintsis et al. (2017); Stahlmann et al. (2018). However, these studies are often confined to small regions (e.g., a few intersections) due to the logistical difficulties of conducting such experiments at scale Mintsis et al. (2020)."}, {"title": "Traffic intersection scenario modeling", "content": "Numerous studies have focused on modeling intersections for various purposes, such as traffic signal control Ault and Sharon (2021) and autonomous driving Leurent (2018). However, they often remain limited to specific scenarios Ault and Sharon (2021); Wang et al. (2021b), primarily due to a focus on proof of concepts rather than comprehensive assessments of proposed methods. Additionally, modeling multiple intersections can be prohibitively expensive, requiring data fusion from various sources and handling missing data.\nHowever, our requirements for modeling intersection scenarios are objectively and strategically different from previous work, necessitating us to develop our own datasets. First, we are neither presenting an eco-driving proof of concept nor attempting to answer how to do eco-driving. Our goal is to analyze the impact of eco-driving to answer the question of whether to eco-drive. Such questions can not be answered by analyzing merely a few intersection scenarios. Unless we have a representative set of intersection scenarios, merely relying on a select intersection could lead to evaluation overfitting where the insights extracted from a few scenarios do not generalize to the class of scenarios Jayawardana et al. (2022); Whiteson et al. (2011).\nFurthermore, we must avoid overfitting to a specific region in our impact assessment Gately et al. (2015). While there are popular intersection datasets available for Manhattan Island in New York Wei et al. (2019), using them could lead to regional overfitting. Manhattan Island exhibits distinct spatial and temporal traffic dynamics due to its block-oriented road network. Insights drawn from an impact assessment solely based on these intersections would not be effective in generalizing to other cities or regions.\nAnother option is to use synthetic datasets, which are easier to generate Li et al. (2022). However, impact assessments based on these datasets are not particularly meaningful as they may not reflect the real-world intersection distributions and may contain oversimplified scenarios Feng et al. (2023)."}, {"title": "Methods for eco-driving control", "content": "Earlier studies on eco-driving have predominantly explored five control strategies for controlling vehicles. They include 1) dynamic programming, 2) heuristics, 3) trajectory optimizations, 4) model-based reinforcement learning (model-based RL), and 5) model-free reinforcement learning (model-free RL). Each of these approaches exhibits distinct advantages and drawbacks. In Table 1, we offer a comparative analysis of these methods, focusing on five prevalent shortcomings."}, {"title": "Reinforcement learning for vehicle-based traffic control", "content": "Contrary to conventional traffic control mechanisms such as traffic signals and stop signs, vehicle-based traffic control is increasingly being explored in recent research. Such vehicle-based control is referred to as Lagrangian traffic control and involves controlling a fleet of vehicles to achieve certain fleet-level (including both controlled and uncontrolled vehicles) objectives such as congestion management Vinitsky et al. (2018), reducing emissions Jayawardana and Wu (2022), and fostering smoother traffic flow Wu et al. (2021); Yan et al. (2022). While various studies have presented proofs-of-concept, they still fall short of accurately modeling real-world scenarios Di and Shi (2021); Wu et al. (2017); Yan et al. (2022) or go beyond toy traffic problems Yan et al. (2022).\nExisting research often relies on simplified traffic models, such as toy traffic blocks Yan et al. (2022), to assess the benefits of Lagrangian traffic control methods. However, none of these studies explore the potential of large-scale implementations that could offer meaningful insights for practical decision-making. While toy tasks are valuable for gaining preliminary insights into a method, they might not resonate strongly with policymakers and stakeholders due to the lack of rigorous analysis of the benefits at a scale that holds significance Esser and Rickert (2000).\nIn order to create more impactful outcomes that can drive policy changes and engage stakeholders, future research should focus on conducting comprehensive analyses that consider real-world complex-ities and practical scenarios. By doing so, the potential benefits of Lagrangian traffic control can be better understood, and its implementation may gain the attention and support needed to truly transform transportation systems, and make a substantial positive impact on traffic congestion and emission reduction, and improve overall traffic flow dynamics. In this work, we take a step towards this direction by analyzing the impact of Lagrangian eco-driving at signalized intersections in the metropolitan city scale."}, {"title": "Preliminaries", "content": ""}, {"title": "Reinforcement Learning", "content": "In reinforcement learning, an agent learns a control policy by interacting with its environment, typically modeled as a Markov Decision Process (MDP) denoted as $M = (S,A,p,r,\\rho,\\gamma)$. Here, $S$ represents the set of states, $A$ denotes the possible actions, $p(s_{t+1}|s_t, a_t)$ denotes the transition probability from the current state $s_t$ to the next state $s_{t+1}$ upon taking action $a_t$, the reward received for action $a_t$ at state $s_t$ is $r(s_t, a_t) \\in \\mathbb{R}$, a distribution over the initial states is $\\rho$, and $\\gamma \\in [0, 1]$ is a discounting factor that balances immediate and future rewards.\nGiven the MDP, we seek to find an optimal policy $\\pi^* : S \\rightarrow A$ over the horizon $H$ that maximizes the expected cumulative discounted reward over the MDP.\n$\\pi^*(s) = \\underset{\\pi}{argmax} \\mathbb{E} \\Big[ \\sum_{t=0}^{H} \\gamma^t r(s_t, a_t) \\Big| s_0, \\pi \\Big]$"}, {"title": "Contextual Reinforcement Learning", "content": "A Contextual Markov Decision Process (cMDP) is an extension to the definition of an MDP introduced in Section 4.1 by incorporating contextual information. The context parameterizes environmental variations, like changes in speed limits or lane lengths at different intersections in eco-driving. A CMDP is denoted as $M = (S, A, C, p_c, r_c, \\rho_c, \\gamma)$. Different from MDPs, a context space $C$ is introduced, but the action space $A$ and state space $S$ stay the same. The transition dynamics $p_c$, rewards $r_c$, and initial state distribution $\\rho_c$ are conditioned on the context $c\\in C$. In other words, a cMDP $M$ is a set of MDPs, each defined based on a context, and $M = \\{M_c\\}_{c\\sim C}$ where $M_c$ is an MDP.\nSolving a cMDP requires solving an algorithmic generalization problem within the task. This can be achieved by finding a policy that performs well in the cMDP overall, as denoted by Equation 2.\n$\\pi^*(s) = \\underset{\\pi}{argmax} \\mathbb{E} \\Big[ \\sum_{c\\in C} \\sum_{t=0}^{H} \\gamma^t r(s_t, a_t) \\Big| s_0, \\pi \\Big]$"}, {"title": "Multi-task Learning", "content": "In multi-task reinforcement learning, we extend the single-MDP (single task) reinforcement learning in Section 4.1 to multiple MDPs (multiple tasks). Accordingly, our objective in finding optimal policy thus becomes,\n$\\pi^*(s) = \\underset{\\pi}{argmax} \\mathbb{E} \\Big[ \\sum_{T\\in \\mathcal{T}} \\sum_{t=0}^{H} \\gamma^t r(s_t, a_t) \\Big| s_0, \\pi \\Big]$\nwhere $\\mathcal{T}$ is the set of MDPs (tasks). When this set of MDPs is defined based on a context, multi-task learning solves a cMDP. Also, note that we seek a unified policy in multi-task reinforcement learning that is performant over all MDPs (tasks)."}, {"title": "Zero-shot Transfer Learning", "content": "Zero-shot transfer learning extends the concept of learning across multiple tasks, as in cMDPs, where the agent must perform well on new, unseen tasks without additional training. The goal is to leverage knowledge from a set of source tasks $T_{source}$, which the agent has experienced during training, to generalize effectively to a set of target tasks $T_{target}$. These target tasks are typically drawn from a distribution that may encompass tasks not encountered during training. In particular, a policy $\\pi_{source}$ trained with the $T_{source}$ is evaluated on the target tasks $T_{target}$ without further training on the target tasks. Such a transfer learning strategy reduces the training overhead and can be better than training a policy from scratch on the target tasks Kirk et al.."}, {"title": "Problem Formulation", "content": ""}, {"title": "Regional eco-driving problem", "content": "Optimizing eco-driving at the traffic network scale can yield the highest benefits, but it is a significantly hard problem and intractable even with advances in modern computing and thus remains an open optimization challenge Qadri et al. (2020). Therefore, many studies adopt a network decomposition from the full network to the intersection level and optimize vehicle trajectories at individual intersections. While this has been a standard practice, it has to be performed carefully as isolated optimization of intersection-level behaviors can cause unexpected adverse events (e.g., intersection queue spillback from one intersection to another) at the network level. In this work, we adopt the same network decomposition strategy and take careful precautions to isolate the effects of the changed vehicle behaviors on each individual intersection.\nIn light of this, consider a region comprised of traffic scenario variations $\\Phi$ where $|\\Phi|$ is very large (e.g., millions of individual signalized intersection scenarios). With the network decomposition strategy, traffic scenario variations are stemming at the intersection level (e.g., changes in traffic flow, temperature, etc.). Let $\\pi_{\\Phi} := (\\pi_{\\phi})_{\\phi \\in \\Phi}$ denote the set of eco-driving control laws. Similarly, let $\\pi^{\\Phi} := (\\pi^{\\phi})_{\\phi \\in \\Phi}$ denote the baseline (status quo driving). Let $f(\\pi,\\phi)$ denote a function that captures the $CO_2$ emission for the scenario $\\phi$ under the control law $\\pi$. We then define the regional eco-driving effectiveness as,\n$\\mathbb{E}_{\\phi} (\\pi_{\\phi}, \\pi_{\\phi}^{\\Phi}) := 1 - \\frac{\\mathbb{E}_{\\phi \\in \\Phi} [f(\\pi_{\\phi}, \\phi)]}{\\mathbb{E}_{\\phi \\in \\Phi} [f(\\pi_{\\phi}^{\\Phi}, \\phi)]}$\nWe thus seek to solve the regional eco-driving problem for the control laws $\\pi_{\\phi}$ such that, Find\n$\\pi_{\\Phi}^* = arg \\underset{\\pi_{\\Phi}}{max} \\mathbb{E}_{\\phi} (\\pi_{\\phi}, \\pi_{\\phi}^{\\Phi})$\nsubject to,\n$\\eta_{\\phi} \\ge \\eta^{\\Phi} \\forall \\phi \\in \\Phi$\n$m_{\\phi} \\le \\tau \\forall \\phi \\in \\Phi$\n$\\omega_{\\phi} \\le \\omega^{\\Phi} \\forall \\phi \\in \\Phi$\nHere, the $\\eta_{\\phi}$ and $\\eta^{\\Phi}$ denote the throughput of the intersection where the eco-driving is assessed in the scenario $\\phi$ under the control laws of $\\pi$ and $\\pi^{\\Phi}$, respectively. Similarly, $m_{\\phi}$ denotes the average observed queue length to lane length ratio of the immediately following intersection to the intersection where the eco-driving is assessed, and $\\tau$ is a hyperparameter. Finally, $\\omega$ and $\\omega^{\\Phi}$ denote the average waiting time per vehicle in the immediate preceding intersection to the intersection where the eco-driving is assessed under control laws of $\\pi$ and $\\pi^{\\Phi}$, respectively.\nThe Equations 6, 7, and 8 ensure the network decomposition strategy would not induce traffic events that would adversely affect the traffic flow at the network level. In particular, Equations 6 ensures that by eco-driving, we do not reduce the intersection throughout, as a reduction in throughput could create traffic queues that would adversely affect the network traffic flow. Equations 7 ensure that if there is an increase in the throughput at an intersection with eco-driving, it will not lead to a saturated incoming approach in the immediately following intersection, which ensures that the immediately following intersection has the capacity to absorb the increased throughput. Finally, Equation 8 ensures that if the eco-driving affects the inflow of vehicles to the intersection being assessed, it would not be propagated back to the intersection preceding it. These constraints collectively ensure that changes in the traffic flow due to eco-driving are either localized to the assessed intersection or implemented with high confidence that they will not adversely affect overall"}, {"title": "Eco-driving control problem at an intersection", "content": "Finding the policy $\\pi_{\\phi}$ we as described in Section 5.1, leads to solving an eco-driving control problem for every traffic scenario. Here, we offer a high-level overview of this eco-driving control problem for a generic scenario. It is important to note that every scenario demands a customized formulation to address its unique instantiations of the eco-driving factors.\nThe main objective of the optimal eco-driving control problem for a given scenario at a signalized intersection is to minimize the emissions of a fleet of vehicles (both controlled semi-autonomous vehicles and human-driven vehicles). However, this should be done with minimal impact on the travel times of vehicles. Given a vehicle dynamics model $x_i$ for guided semi-autonomous vehicle $i$ and $y_j$ for human-driven vehicle $j$ and the traffic signal timing plan p of the signalized intersection being assessed, we formulate the optimal-control problem in discrete time-space as follows,\n$min J = \\sum_{i=1}^{n} \\sum_{t=0}^{T_i} E(a_i(t), v_i(t)) + T_i$\nsuch that for every vehicle i,\n$a_i(t) = \\begin{cases} X_i(s_i(t), \\dot{s}_i(t), v_i(t), p) &\\text{if vehicle i is controlled to eco-drive} \\\\ Y_i(S_i(t), \\dot{S}_i(t), v_i (t), p) &\\text{otherwise} \\end{cases}$\n$\\sum_{t=0}^{T_i} v_i(t)\\Delta t = d$\n$S_{min} \\le S_i(t) \\le S_{max} \\forall t \\in [0, T_i]$\n$U_{min} \\le V_i(t) < U_{max} \\forall t \\in [0, T_i]$\n$a_{min} \\le a_i(t) \\le a_{max} \\forall t \\in [0, T_i]$\nHere, n represents the total number of vehicles in the fleet, $a_i(t), v_i(t), s_i(t)$, and $\\dot{s}(t)$ denote the acceleration, velocity, headway and relative velocity of vehicle $i$ at time $t$, $E(.)$ denotes the emission function that measures instantaneous emission of vehicle $i$ at time $t$, $T_i$ denotes the travel time of vehicle $i$, and $d$ represents the total required travel distance, which includes both arrival to and departure from the intersection. Furthermore, $\\Delta t$ defines the discretized time step usually in [0.5, 1]. The minimum and maximum headway values are denoted as $s_{min}$ and $s_{max}$, while $U_{min}, U_{max}$ and $a_{min}, a_{max}$ indicate the same for velocities and accelerations. These variables and constraints ensure safety, connectivity via V2V communication (if applicable), and passenger comfort.\nWe use IDM Treiber et al. (2000) as the dynamics model for human drivers. Thus, $y_j$ entails the ordinary differential equations defined by the calibrated parameterization of IDM for human-driven vehicle j. The $x_i$ for controlled vehicle i is learned using multi-task deep reinforcement learning."}, {"title": "Methodology", "content": "In the following subsections, we detail our approach to assessing the impact of eco-driving at signalized intersections by describing our approach to scenario modeling, solving eco-driving control, and how we perform impact assessment. A visual illustration of the overall methodology and how each of the three steps are connected is given in Figure 2."}, {"title": "Scenario Modeling", "content": "Scenario modeling involves modeling each eco-driving scenario within a high-fidelity agent-based traffic simulator, replicating intersections as digital intersections, and calibrating for real-world conditions. Naive scenario modeling, which exhaustively models all possible scenarios, lacks practicality due to the inclusion of unrealistic scenarios (e.g., snow in Phoenix, Arizona). On the other hand, exhaustive yet realistic modeling offers superfluous detail that is redundant in decision-making (e.g., temperature impact on eco-driving at a fine-grained scale). Our approach seeks a representative subset of scenarios $(\\Phi' \\subset \\Phi)$, ensuring realism, computational feasibility, and comprehensive coverage, as shown in Figure 4.\nAs illustrated in Figure 3, related literature and expert opinions identify 33 major factors that impact eco-driving benefit levels. We omit the details of each factor here and refer the reader to Section 10.3 in the Appendix for further details on each of these 33 factors and their known effects."}, {"title": "Eco-driving Control", "content": "Eco-driving control involves devising a set of eco-driving strategies for the representative scenario set $\\Phi'$. Eco-driving control for one million scenarios is a challenging task. Traditional methods like dynamic programming are computationally limiting Doan et al. (2018), while heuristics are often suboptimal Katsaros et al. (2011). Trajectory optimizations are limited by the complexity of required vehicle dynamics models, particularly due to inter-vehicle dynamics and environmental variability introduced by many factors we consider Yang et al. (2016).\nMeanwhile, recent studies have shown the effectiveness of deep reinforcement learning in complex control tasks Bellemare et al. (2020); Silver et al. (2017); Wurman et al. (2022). Neural vehicle control using deep reinforcement learning Jayawardana and Wu (2022); Wu et al. (2021); Yan et al. (2022), which can handle diverse traffic scenarios without manual fine-tuning, is also gaining popularity. However, training such a policy for each scenario is impractical due to the number of scenarios. Training a unified policy is complex due to multifaceted factors and the induced complex expectation Zhang and Yang (2021). Learning both discrete lane changes and continuous longitudinal accelerations presents optimization challenges, demanding diverse exploration strategies and distinct neural network representations.\nThus, we introduce a custom training method involving three key steps: 1) similar scenario partitioning, 2) within partition multi-task deep reinforcement learning (MT-DRL), and 3) rule-based lane changes and a hierarchical policy selection strategy to accommodate lane changes. Below, we detail each of these steps in detail.\nSimilar scenario partitioning: In this step, our aim is to partition scenarios by their similarities, allowing us to train separate MT-DRL policies for each partition. This strategy is inspired by the mixture of expert architecture widely used in real-world systems with generalization requirements Ma-soudnia and Ebrahimpour (2014). It can reduce scenario diversity within a partition and help reduce training complexity. While each scenario is defined by many factors, we only utilize intersection geometry and traffic flow-specific features as partitioning features because they strongly influence policy behaviors.\nHowever, since signalized intersections lack rotational invariance, comparing them for similarity is challenging. Therefore, we break down the intersection environment into non-conflicting pairs of incoming and outgoing approaches. This has added advantages. It accelerates training by simulating fewer vehicles and improves training stability by alleviating credit assignment challenges Zhou et al. (2020). Further, it has no impact on modeling realism due to the decoupling nature of traffic signals (e.g., northbound traffic and eastbound traffic do not collide). These selected pairs, along with the ghost approaches connected to them, thus become our training environments and are illustrated in Figure 7.\nThe training environments are then partitioned into 28 partitions, considering the semi-autonomous vehicle penetration level, lane count, and traffic signal phase count as partition features. However, the environments in each partition may not form a uniform distribution. This may make environments sampled in consecutive training iterations differ significantly, requiring adaptive learning strategies. To overcome this, we adopt a synthetic environment distribution $\\Phi_\\tau$ derived from the full scenario set for each partition with a uniform distribution for policy training as illustrated in Figure 2. Additional details about the training environment distributions can be found in Appendix 10.7.\nWithin partition MT-DRL: Training an MT-DRL policy per partition involves solving an eco-driving contextual Markov Decision Process (cMDP) where each scenario is an MDP within the CMDP. Furthermore, MDPs within a cMDP can take on either single-agent or multi-agent forms. We adopt multi-agent control, necessitating implicit or explicit coordination among controlled vehicles for better emission reductions. Consequently, each MDP in the cMDP is modeled as a Partially Observable Markov Decision Process (POMDP)."}, {"title": "Impact Assessment", "content": "Impact assessment involves leveraging the trained eco-driving policies to assess the benefits of eco-driving in the representative scenario set $\\Phi'$. Let $\\Pi$ be the trained policy set for all 28 partitions. We further employ the zero-shot generalizability of these policies to conduct the final impact assessment. In particular, for a given semi-autonomous vehicle penetration level, we have seven partitions by varying the lane count and phase count. Recall that we denote each partition as $\\Psi_i$ where $i \\in \\{1,...,7\\}$ when the semi-autonomous vehicle penetration level is given. Let $\\Pi' = [(\\pi^{\\Psi_i}_{k}, \\pi^{\\Psi_i}_{l}) i\\in \\{1,...,7\\} \\cup \\pi^{\\Phi}]$ be the subset of trained policies for all seven partitions under a given semi-autonomous vehicle penetration level and the status quo driving baseline control policy $\\pi_0$.\nFor a given scenario $\\phi$ belonging to one of the seven clusters, we seek the best-performing policy $\\pi_{\\phi}^*$ as follows,\n$\\pi_{\\phi}^* = arg \\underset{\\pi_k \\in \\Pi'}{min} (g(\\pi_k, \\pi_0, \\phi))$\nThe function $g(\\cdot)$ is defined as,\n$g(\\pi_k,\\pi_0, \\phi) = \\begin{cases} f(\\pi_k, \\phi) &\\text{if network decomposition constraints are satisfied} \\\\ M &\\text{otherwise} \\end{cases}$\nsuch that $f(\\pi, \\phi)$ denoting the function that captures the $CO_2$ emission for the scenario $\\phi$ under the control law $\\pi$ and M is large enough constant to indicate the policy $\\pi_k$ is invalid due to any of the network decomposition constraint violations as listed in Equations 6, 7, and 8. If any of the constraints are not satisfied, we default to the status quo driving baseline control policy $\\pi_0$. Below, we describe how we check for these constraint violations.\nControl active intersection throughput constraint: To check if the control policy $\\pi_k$ satisfies the throughput requirement, we compare its throughput with the status quo driving baseline $\\pi_0$ throughput. If $\\eta_k$ is the throughput of $\\pi_k$ and $\\eta_0$ is their throughput of $\\pi_0$, then the constraint is satisfied if $\\eta_k \\ge \\eta^{\\Phi}$.\nFollowing intersection queue length to lane length ratio constraint: If the eco-driving increases the throughput of the intersections by smoothing traffic flow, it is imperative to ensure that additional throughput is bearable by the intersection immediately ahead of the control active intersection. To ensure this, we leverage the average vehicle queue length to lane length ratio of each approach as it indicates how many additional vehicles the approach can accommodate without congestion in the equilibrium state. In particular, we check if the vehicle inflow to all the control active intersections is increased by r percent (mimicking increased throughput from the preceding intersection), can we ensure that all control active intersections under policy $\\pi_k$ have vehicle queue length to lane length ratio $m_{\\phi k} < \\tau$ where $\\tau$ is a hyperparameter. When $\\tau < 1$, the lane can accommodate more vehicles. In practice, we find the maximum r with $\\tau = 0.3$ such that at least 99% of the intersections can accommodate the additional throughput. Once such r is found, all presented analyses will ensure that the following intersection queue length to lane length ratio constraint is satisfied.\nPreceding intersection vehicle waiting time constraint: When eco-driving is performed at the control active intersection, the changed vehicle flow may affect the outflow of the intersection immediately precedes it (e.g., when the vehicles glide at the control active intersection slowing the rate other vehicles leave the preceding intersection). To ensure this does not happen, we check if $w_{\\pi k} < w_{\\pi0}$ where $w_{\\pi k}$ and $w_{\\pi0}$ are the average waiting time per vehicle in the preceding intersection under eco-driving policy $\\pi$ and status quo driving baseline $\\pi_0$, respectively. In simulations, this also includes any vehicle that has been scheduled to be spawned in the road network but yet to be spawned due to congested traffic settings.\nFinally, by performing above zero-shot transfer scheme to all scenarios in $\\Phi'$, we obtain the best policy $\\pi_{\\phi}^*$ for each scenario $\\phi$. We then use the best policy of each scenario for subsequent impact assessments. In particular, regional eco-driving effectiveness $\\mathbb{E}(\\cdot)$ is used to assess the overall benefit level as per Equation 4. Each scenario is simulated five times for statistical significance, and results are averaged following the recommended practice Agarwal et al. (2021)."}, {"title": "Simulation-based Analysis", "content": ""}, {"title": "Experimental setup", "content": "We use Proximal Policy Optimization (PPO) Schulman et al. (2017) algorithm in training our MT-DRL policies with actor-critic architecture. The actor and critic do not share parameters and are separate neural networks. Centralized training and a decentralized execution paradigm are used for training. Section 10.8 in the Appendix describes the architecture details and all the hyperparameter configurations used in training."}, {"title": "Impact of eco-driving", "content": "Our eco-driving assessment encompasses diverse perspectives. First, we analyze the overall regional eco-driving effectiveness and the resultant variations in the intersection throughput in the three cities. Second, we analyze which intersection-related factors contribute greater influence at different levels of eco-driving adoption. Third, we analyze the level of intersection compatibility needed to achieve the benefits, informing implementation plans. Fourth, we analyze eco-driving behaviors and examine the safety implications of eco-driving, an aspect that has not received adequate attention in previous work Carslaw et al. (2010). Last, we contextualize eco-driving by analyzing its role in joint consideration with travel growth projections and decarbonization technologies such as vehicle electrification and the adoption of hybrid vehicles."}, {"title": "Eco-driving effectiveness", "content": "Figures 8 show the annual average effectiveness of eco-driving, assessing the percentage emission reduction and average throughput improvement. Eco-driving achieves a notable 11-22% emission reduction, equivalent to the national carbon emissions of Israel and Nigeria, respectively (refer to Appendix 10.2 for the estimation). Notably, a 10% eco-driving adoption can yield 25-50% of the total emission reduction, showcasing a non-linear benefit scaling and greater potential for short-term deployments to gain a majority of total benefits. Importantly, these gains incur no costs to intersection throughput. Additionally, Figure 9 demonstrates consistent emission benefits under different weather conditions across seasons, with minor fluctuations. This emphasizes that eco-driving can yield benefits throughout the year.\nFigure 10 shows the spatial distributions of these emission benefits under different eco-driving adoption levels. The low benefits intersections in Figure 10 can happen due to three reasons. First, eco-driving at those intersections would not yield benefits due to their characteristics (e.g., not enough lane lengths for eco-driving). Second, the benefits of those intersections are defaulted to zero due to network decomposition constraint violation. Third, our MT-DRL policies are suboptimal in these intersections. Therefore, the benefits we observe in our analysis are a lower bound for the potential of eco-driving, and future work can address these challenges and increase the benefit levels."}, {"title": "Influential factors in eco-driving", "content": "Through a Pearson correlation analysis in Figure 11, we underscore key factors influencing emission benefits for informed intersection design and city planning. We consider nine key eco-driving factors that are known to have a significant impact on emission benefits and are directly observable, including temperature, humidity, speed limit, road grade, signal time ratio, vehicle inflow, phase count, lane count, and lane length. The signal ratio denotes the ratio between approach-related phase times and total cycle time. Notably, speed limits, vehicle inflow, and lane lengths significantly impact emission benefits. In particular, when the speed limit and lane length increase, the benefit levels increase. On the other hand, when the inflow increases, the benefit decreases. This explains why the three cities we consider have different benefit levels. As discussed in Appendix Section"}]}