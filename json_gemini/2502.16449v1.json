{"title": "Facilitating Emergency Vehicle Passage in Congested Urban Areas Using Multi-agent Deep Reinforcement Learning", "authors": ["Haoran Su"], "abstract": "Emergency Response Time (ERT) serves as a pivotal metric of urban resiliency and public safety, encapsulating a city's capacity to respond promptly and effectively to medical, fire, and crime emergencies. Over the last decade, increasing urbanization and traffic congestion have severely exacerbated ERT, undermining emergency management systems and public trust. In New York City (NYC), average ERT for medical emergencies has surged by 72% from 7.89 minutes in 2014 to 14.27 minutes in 2024, with over 50% of delays attributable to prolonged Emergency Vehicle (EMV) travel times. These escalating delays have dire consequences: every minute of delay during a stroke can lead to the loss of 2 million brain cells, and survival rates for cardiac arrest diminish by 7\u201310% per minute. This underscores the urgency of addressing EMV travel inefficiencies through advanced routing and traffic management strategies.\nThis dissertation responds to these critical challenges by advancing the state of EMV facilitation through three substantive contributions. First, it introduces EMVLight, a decentralized multi-agent reinforcement learning (MARL) framework that dynamically integrates EMV routing and adaptive traffic signal pre-emption. EMVLight leverages real-time traffic data and decentralized coordination between agents to optimize EMV travel paths while reducing disruptions to non-EMV traffic. Experimental results demonstrate a 42.6% reduction in EMV travel times and a 23.5% decrease in the average travel time for non-EMVs across synthetic and real-world traffic networks.\nSecond, the dissertation develops the Dynamic Queue-Jump Lane (DQJL) system, which employs Multi-Agent Proximal Policy Optimization (MAPPO) to enable coordinated lane-clearing maneuvers in mixed-traffic environments comprising autonomous and human-driven vehicles. By dynamically forming queue-jump lanes in response to real-time traffic conditions, DQJL minimizes lane-change maneuvers and reduces EMV travel times by up to 40%, with benefits amplified under higher autonomous vehicle penetration rates.\nThird, the dissertation conducts an equity-focused evaluation of Emergency Medical Services (EMS) accessibility in NYC, integrating demographic, infrastructural, and traffic data to uncover disparities in response times across boroughs. Findings reveal systemic inequities, with Staten Island experiencing the longest delays due to sparse signalized intersections, while Manhattan, despite its dense network, faces severe congestion. The study proposes actionable interventions, including optimized EMS station placements,", "sections": [{"title": "Introduction", "content": "In this chapter, we present the background and motivations underpinning this dissertation in Section 1.1, providing a comprehensive overview of the problem domain and its significance. Section 1.2 identifies the key research challenges that this work aims to address, highlighting gaps in the existing literature and practical constraints. Finally, Section 1.3 outlines the major contributions and structure of this dissertation."}, {"title": "Background and Motivation", "content": "Emergency Response Time (ERT) is a critical metric for assessing urban resiliency and public safety, reflecting a city's capacity to respond promptly and effectively to a diverse range of emergencies, including medical incidents, fire outbreaks, and criminal activities. Shorter ERTs are indicative of well-coordinated emergency response systems, efficient infrastructure, and sufficient resource allocation. Conversely, delays in ERT exacerbate the severity of incidents, increasing risks to human life and property.\nOver the past decade, urban centers have faced mounting challenges in maintaining"}, {"title": "Research Challenges", "content": "Efficient EMV passage in urban traffic networks presents two interrelated challenges: dynamically routing EMVs under time-dependent traffic conditions and coordinating traffic signal pre-emption to minimize delays for both EMVs and non-EMVs.\nThe first challenge arises from the inherently dynamic nature of urban traffic, where congestion levels fluctuate across road segments in real time. As an EMV progresses through the network, its routing decisions must be continuously updated to account"}, {"title": "Intra-link Movement for EMV", "content": "From a microscopic perspective, the intra-link traversal of EMVs poses significant challenges. While traffic laws mandate yielding the right-of-way to EMVs, and most drivers instinctively comply, their uncoordinated and unpredictable maneuvers often result in suboptimal outcomes, especially on congested roadways. This lack of coordination leads to inefficiencies and delays that undermine the effectiveness of emergency responses.\nDespite advancements in vehicle-to-everything (V2X) technologies designed to enhance EMV mobility, sirens remain the primary tool relied upon in practice. However, traditional siren systems frequently fail to provide sufficient warning time to other drivers, particularly in heavily congested traffic conditions. Furthermore, ambiguity regarding which route should be cleared often causes confusion, delaying the EMV's progress. These uncertainties exacerbate delays and contribute to accident rates that are 4 to 17 times higher [5], along with increased collision severity [6]. These factors not only hinder EMV traversal but also pose additional risks to traffic safety, highlighting the urgent need for effective solutions.\nCurrent lane-clearing strategies in emergency scenarios predominantly rely on mixed-integer linear programming (MILP) formulations. While these approaches offer theoretical insights, they often oversimplify real-world traffic dynamics and fail to provide actionable decisions in real time. The reliance on computationally intensive models makes them unsuitable for dynamic, time-sensitive scenarios. Additionally, these methods struggle to account for the stochastic nature of traffic flows, unexpected driver behaviors, and the cascading disruptions caused by lane-clearing maneuvers.\nThe core challenge, therefore, is how to quickly establish a cleared and easy-to-maneuver route for EMV passage on a road segment while minimizing additional disturbances for non-EMVs. Addressing this challenge requires innovative strategies capable of capturing real-time traffic information, managing uncertainties, and delivering computationally efficient solutions that can infer optimal actions within milliseconds. Meeting this need is critical for ensuring timely and safe EMV traversal through congested urban traffic. Chapter 3 focuses on providing a solution."}, {"title": "Dissertation Contributions and Summary", "content": "This dissertation addresses the aforementioned challenges associated with efficient EMV passage in congested urban areas, adopting a comprehensive approach that spans network-level EMV route optimization to intra-link EMV passage strategies. By systematically reducing EMV travel time and mitigating downstream traffic disturbances, the proposed methods aim to enhance emergency response efficiency. Furthermore, a qualitative case study on the emergency accessibility of NYC is conducted to evaluate the potential of the proposed solutions in a real-world setting. The research topics explored in this dissertation represent some of the earliest contributions in EMV passage, addressing critical gaps between theoretical concepts and their practical applications in real-world scenarios."}, {"title": "EMVLight", "content": "Chapter 2 introduces EMVLight, a decentralized multi-agent reinforcement learning (MARL) framework that addresses two critical challenges mentioned above: dynamically routing EMVs under time-dependent traffic conditions and coordinating traffic signal pre-emption to minimize delays for both EMVs and non-EMVs. Dynamic EMV routing is particularly challenging due to the evolving nature of road congestion, which requires"}, {"title": "\u041c\u0410\u0420PO-DQJL", "content": "Chapter 3 introduces dynamic queue-jump lanes (DQJLs) as a novel intra-link coordination strategy designed to expedite EMV passage through congested road segments. Extending the traditional concept of queue-jump lanes (QJLs) used in bus operations, DQJLs dynamically form lanes during an EMV's approach or traversal, leveraging V2X communication technologies to coordinate connected autonomous vehicles (CAVs) while accounting for non-connected human-driven vehicles (HDVs). To address the inherent complexity of mixed traffic environments, we model DQJL formation as a partially observable Markov decision process (POMDP), which captures both the controllable behavior of CAVs and the stochastic, unpredictable nature of HDVs. To optimize the DQJL formation process, we develop a multi-agent proximal policy optimization algorithm (MAPPO-DQJL) that employs centralized training with decentralized execution, enabling CAVs to efficiently coordinate lane-clearing maneuvers while minimizing disruptions to all non-EMVs. This framework effectively balances the dual objectives of reducing EMV passage time and reducing disturbance to overall traffic, demonstrating scalability across varying CAV penetration rates and traffic densities in multilane roadways. Through extensive SUMO-based simulations, the proposed framework is validated, achieving up to 39.8% reduction in EMV passage times and up to 55.7% reduction in lane-changing maneuvers compared to baseline methods, with particularly pronounced benefits under scenarios of increasing CAV adoption. These contributions address critical gaps in current EMV passage strategies, providing a robust and scalable solution for integrating DQJLs into EMV management systems."}, {"title": "EMS Accessibility Study of NYC", "content": "Chapter 4 presents a comprehensive intersection-aware EMS accessibility model to address the critical challenge of EMS accessibility in congested urban environments, focusing on NYC as a case study. By integrating road network characteristics, intersection density, and population demographics, the proposed model provides a granular evaluation of EMS accessibility, identifying vulnerable regions where response times exceed critical benchmarks. The study introduces a novel metric that incorporates intersection-induced delays into travel time calculations, capturing the complexities of urban traffic networks more realistically. Additionally, it highlights the disparities in EMS coverage across NYC boroughs, with significant accessibility gaps in Staten Island, Queens, and parts of Manhattan. The implementation of EMVLight, introduced in Chapter 2, is further explored to demonstrate its potential in reducing intersection delays, improving hospital accessibility, and ensuring that over 95% of NYC residents are served within the benchmark response time. These contributions lay a robust foundation for advancing emergency traffic management strategies and guiding urban planning decisions aimed at equitable and efficient EMS accessibility."}, {"title": "Dissertation Outline", "content": "The remainder of this dissertation is organized as follows. Chapter 2 introduces EMV-Light, a multi-agent reinforcement learning framework for EMV decentralized routing and traffic signal control. Chapter 3 proposes MAPPO-DQJL, an innovative approach that facilitates intra-link EMV movements through cooperative and efficient lane-clearing strategies. Chapter 4 presents a case study on EMS accessibility in New York City, providing valuable insights into the potential impacts of deploying EMVLight in real-world settings. Finally, Chapter 5 concludes with a summary of research contributions, a discussion of research limitations, and potential directions for future work."}, {"title": "Literature Review", "content": "Conventional routing optimization and traffic signal pre-emption for EMVs.\nAlthough routing and pre-emption are coupled in reality, existing methods usually solve them separately. Many of the existing approaches leverage Dijkstra's shortest path algorithm to determine the optimal route [23, 24, 25, 26]. Nordin et al. [27] proposed an A* algorithm for ambulance routing, assuming that routes and traffic conditions are fixed and static, which fails to address the dynamic nature of real-world traffic flows. Another line of work considers the temporal dynamics of traffic flows. For instance, Ziliaskopoulos et al. [28] developed a shortest-path algorithm for time-dependent traffic networks, assuming that travel times associated with each edge are known in advance. Similarly, Musolino et al. [29] proposed routing strategies tailored to specific times of the day (e.g., peak/non-peak hours) based on historical traffic data. However, in the problem under consideration, routing and pre-emption strategies can significantly influence the travel time of each edge during the EMV passage, and the existing methods fail to handle such real-time changes effectively. Haghani et al. [18] formulated the dynamic shortest path problem as a mixed-integer programming model, and Koh et al. [30] utilized reinforcement learning (RL) for real-time vehicle navigation and routing. Related studies [31, 32, 33, 34, 35, 36, 37, 38, 39, 40] explored adaptive routing problems in various stochastic and time-dependent traffic scenarios. However, none of these works considered the coupling of traffic signal pre-emption with EMV routing or the specific context of EMV passage when solving shortest path problems.\nOnce an optimal route for the EMV has been determined, traffic signal pre-emption is deployed to further reduce the EMV travel time. A common pre-emption strategy is to extend the green phases of traffic signals to allow the EMV to pass through intersections"}, {"title": "Preliminaries", "content": "In this section, we introduce relevant preliminary terms and definitions which facilitate the problem formulation."}, {"title": "Traffic map, movement and signal phase", "content": "A traffic map can be represented by a graph G(V, E), with intersections as nodes and road segments between intersections as edges. We refer to a one-directional road segment between two intersections as a link. A link has a fixed number of lanes, denoted as h(l) for lane l. Vehicles are allowed to switch lane between two intersections. Fig. 2.1 shows 8 links and each link has 2 lanes.\nA traffic movement (l, m) is defined as the traffic traveling across an intersection from an incoming lane l to an outgoing lane m. The intersection shown in Fig. 2.1 has 24 permissible traffic movements. As an example, vehicles on lane 1 are turning left, and vehicles on lane 2 may go straight or turn right. After turning into the link, vehicles will enter either lane. Thus, the incoming South link has the potential traffic movements of {(1,7), (1, 8), (2, 5), (2, 6), (2, 3), (2, 4)}. The set of all permissible traffic movements of an intersection is denoted as M.\nA traffic signal phase is defined as the set of permissible traffic movements. As shown in Fig. 2.2, an intersection with 4 links has 8 phases."}, {"title": "Pressure", "content": "The pressure of an incoming lane l measures the unevenness of vehicle density between lane l and corresponding out going lanes in permissible traffic movements. The vehicle density of a lane is x(l)/Xmax(l), where x(l) is the number of vehicles on lane l and Xmax(l) is the vehicle capacity on lane l, which is related to the length of a lane. Then the pressure of an incoming lane l is\n$$w(l) = \\bigg | \\frac{x(l)}{x_{max}(l)} -  \\sum \\limits_{\\{m|(l,m)\\in M\\}} \\frac{1}{h(m)} \\frac{x(m)}{x_{max}(m)} \\bigg |,$$\nwhere h(m) is the number of lanes of the outgoing link which contains m. In Fig. 2.1, h(m) = 2 for all the outgoing lanes. An example for Eqn. (2.1) is shown in Fig. 2.1.\nTaking the intersection's traffic conditions shown in Fig.2.1 as an example, assuming the maximum capacity for each lane is 5 vehicles, we can calculate the lane pressure for lane 2 to be\n$$w(2) = \\bigg | \\frac{2}{5} - \\frac{1}{2} (\\frac{1}{5}+\\frac{1}{5}+\\frac{3}{5}+\\frac{0}{5}) \\bigg | = \\frac{2}{5}$$\nThe pressure of an intersection indicates the unevenness of vehicle density between incoming and outgoing lanes in an intersection. Intuitively, reducing the pressure leads to more evenly distributed traffic, which indirectly reduce congestion and average travel time of vehicles. EMVLight defines pressure of an intersection in EMVLight as the average of the pressure of all incoming lanes,\n$$P_i = \\frac{1}{\\vert Z_i\\vert} \\sum\\limits_{l\\in Z_i} w(l),$$\nwhere Zi represents the set of all incoming lanes of intersection i. According to such definition, the intersection pressure shown in Fig.2.1 is computed to be $\\frac{8}{25}$.\nPressLight [51] assumes that traffic movements are lane-to-lane, i.e., vehicles in one lane can only move into a particular lane in a link. Because of the lane-to-lane assumption, in PressLight, the pressure is defined per movement. PressLight defines the pressure of a movement as the difference of the vehicle density between an incoming lane l and the outgoing lane m, i.e.,\n$$w^*(l, m) = \\frac{x(l)}{X_{max}(l)} - \\frac{x(m)}{X_{max}(m)}.$$\nFor instance, lane 2, shown in Fig.2.1, carries w*(2, 3), w*(2, 4), w*(2,5), w*(2,6), w*(2, 7) and w*(2,8). Taking the permissible traffic movement from lane 2 to lane 4 as an example, we can get the pressure for this movement as\n$$w^*(2, 4) = \\frac{2}{5} - \\frac{1}{5} = - \\frac{1}{5}$$\nPressLight then defines the pressure of an intersection i as the absolute value of the sum of pressure of movements of intersection i, i.e., When calculating the pressure intersection, PressLight has\n$$P^*_i = \\bigg | \\sum_{(l,m) \\in M_i} w^*(l, m) \\bigg |,$$\nwhere Mi is the set of permissible traffic movements of intersection i. According to PressLight's definition of intersection pressure, Fig.2.1 shows an intersection with pressure of 6.\nPressure in our work EMVLight assumes a lane-to-link style traffic movement as vehicles can enter either lane on the target link, see Fig.2.1. Following lane pressure defined in (2.1),\nComparison The first difference between the two definitions is that w*(l,m) can be both positive or negative, but w(l) can only take positive values that measures the unevenness of the vehicle density in the incoming lane and that of the corresponding outgoing lanes. We take the absolute value since the direction of pressure is irrelevant here, and the goal of each agent is to minimize this unevenness. The second difference is that at the intersection level, $P^*_i$ takes a sum but $P_i$ takes an average. The average is more suitable for our purpose since it scales the pressure down and the unit penalty for normal agents would be relatively large as compared to rewards for pre-emption agents (Eqn. (3)). This design puts the efficient passage of EMV vehicles at the top priority. Our experimentation results, presented in Sec.2.6 indicate the proposed pressure design produces a more robust reward signal during training and outperforms PressLight in congestion reduction."}, {"title": "Emergency capacity", "content": "A roadway segment may have additional capacity, e.g. shoulder, parking lanes, bike lanes, dedicated to providing extra space that can be used under emergencies and incidents. In the presence of EMVs, existing vehicles are allowed to pull-over or park on the shoulders temporarily, forming an emergency lane for the emergency vehicle to pass. An emergency lane is an lane formed between original lanes dedicated for EMV passage, see Fig.2.3 bottom. EMVs are assumed to travel freely on the emergency lane through the dense traffic. This is referred as an emergency yielding and non-EMVs are experiencing an part-time shoulder use [72].\nAdaptive traffic management strategies based on part-time shoulder use, such as dynamic hard shoulder running (D-HSR) [73], have proven beneficial and cost-effective for such scenarios."}, {"title": "Methodology", "content": "In this section, we elaborate the methodology of EMVLight. We begin with implementing a decentralized shortest path onto EMV navigation in traffic networks, and then incorporate it into the proposed multi-class RL agent design. Subsequently, we introduce the multi-agent advantage actor-critic framework as well as the RL training workflow in details."}, {"title": "Decentralized Routing for EMVLight", "content": "Dijkstra's algorithm is an algorithm that finds the shortest path between a given node and every other nodes in a graph. The time-based Dijkstra's algorithm finds the fastest path and has been widely used for EMV routing. In order to find such a path, the EMV travel time along each link need to be estimated first and we refer to it as the intra-link travel time. Dijkstra's algorithm takes as input the traffic graph, the intra-link travel time and a destination, and can return the time-based shortest path as well as estimated travel time from each intersection to the destination. The latter is usually referred to as the estimated time of arrival (ETA) of each intersection.\nIn a traffic network, the intra-link travel time usually depends on the link's emergency capacity and number of vehicles in that link. In our model, this dependency is captured by EMV speed Eqn. (2.2). The intra-link travel time is then calculated as the link length divided by the EMV speed. However, traffic conditions are constantly changing and so does EMV travel time along each link. Moreover, EMV pre-emption techniques alter traffic signal phases, which will significantly change the traffic condition as the EMV travels. The pre-determined shortest path might become congested due to stochasticity and pre-emption. Thus, updating the optimal route dynamically can facilitate EMV passage. One option is to run Dijkstra's algorithm repeatedly as the EMV travels through the network in order to take into account the updated EMV intra-link travel time. However, this requires global traffic information of the entire traffic network throughout EMVs' trips. Even when a centralized controller is established to navigate the EMV, the synchronization and communication cost grows exponentially when the network size increases and the nonscability disallows the centralized scheme to be real-time for the navigation.\nDecentralized routing approaches [74, 75, 76] were introduced to find the shortest"}, {"title": "Reinforcement Learning Agent Design", "content": "While dynamic routing directs the EMV to the destination, it does not take into account the possible waiting times for red lights at the intersections. Thus, traffic signal pre-emption is also required for the EMV to arrive at the destination in the least amount of time. However, since traditional pre-emption only focuses on reducing the EMV travel time, the average travel time of non-EMVs can increase significantly. Thus, we set up traffic signal control for efficient EMV passage as a decentralized RL problem. In our problem, each intersection is an RL agent. Each agent makes decisions on the traffic signal phases of this intersection based on local information. Aside from communicating with the approaching EMV, agents are also communicating with each other. Multiple agents coordinate the control signal phases of intersections cooperatively to (1) reduce EMV travel time and (2) reduce the average travel time of non-EMVs. First we design 3 agent types. Then we present agent design and multi-agent interactions."}, {"title": "Types of agents for EMV passage", "content": "When an EMV is on duty, we distinguish 3 types of traffic control agents based on EMV location and routing (Fig. 2.5). An agent is a primary pre-emption agent ip if an EMV is on one of its incoming links. The agent of the next intersection $i_s$ = Nextip is refered to as a secondary pre-emption agent. The rest of the agents are normal agents. We design these types since different agents have different local goals, which is reflected in their reward designs."}, {"title": "Agent design", "content": "State: The state of an agent i at time t is denoted as $s_i^t$ and it includes the number of vehicles on each outgoing lanes and incoming lanes, the distance of the EMV to the intersection, the estimated time of arrival (ETA), and which link the EMV will be routed to (Next), i.e.,\n$$s_i^t = \\{x_t(l), x_t(m), d^t_{EMV} [L_{ji}], ETA^{t'}, Next^{t'} \\},$$\nwhere Lji represents the links incoming to intersection i from its adjacent intersections j \u2208 N. With a slight abuse of notation, l and m denote the set of incoming and outgoing lanes, respectively. The vector $d^t_{EMV}$ contains the information about the distance of an EMV to the intersection is EMV is present. For the intersection shown in Fig. 2.1, $d^t_{EMV}$ is a vector of four elements. In particular, for primary pre-emption agents, one of the elements represents the distance of EMV to the intersection in the corresponding link and the rest of the elements are set to -1. For all other agents, $d^t_{EMV}$ are padded with -1.\nAction: Prior work has focused on using phase switch, phase duration and phase itself as actions. In this work, we define the action of an agent as one of the 8 phases in Fig. 2.2; this enables more flexible signal patterns as compared to the traditional cyclical patterns."}, {"title": "Multi-agent Advantage Actor-critic", "content": "We adopt a multi-agent advantage actor-critic (MA2C) framework similar to [61] to address the coupling of EMV navigating and traffic signal control simultaneously in a decentralized manner. The difference is that our local state includes dynamic routing information and our local reward encourages efficient passage of EMV. Here we briefly introduce the MA2C framework.\nIn a multi-agent network G(V, E), the neighborhood of agent i is denoted as Ni = \\{j\\vert ji \u2208 E or ij \u2208 E\\}. The local region of agent i is Vi = Ni \u222a i. We define the distance between two agents d(i, j) as the minimum number of edges that connect them. For example, d(i, i) = 0 and d(i, j) = 1,\u2200j \u2208 Ni. In MA2C, each agent learns a policy $\u03c0_{\u03b8_i}$ (actor) and the corresponding value function $V_{\u03c6_i}$ (critic), where $\u03b8_i$ and $\u03c6_i$ are learnable neural network parameters of agent i.\nLocal Observation. In an ideal setting, agents can observe the states of every other agent and leverage this global information to make a decision. However, this is not practical in our problem due to communication latency and will cause scalability issues. We assume an agent can observe its own state and the states of its neighbors, i.e., $s_{V_i}^t= \\{s^t_j\\vert j \u2208 V_i\\}$. The agents feed this observation to its policy network $\u03c0_{\u03b8_i}$ and value network $V_{\u03c6_i}$.\nFingerprint. In multi-agent training, each agent treats other agents as part of the environment, but the policy of other agents are changing over time. [84] introduce fingerprints to inform agents about the changing policies of neighboring agents in multi-agent Q-learning. [61] bring fingerprints into MA2C. Here we use the probability simplex of neighboring policies $\u03c0^{N_i} = \\{\u03c0_j^{t-1}\\vert j\u2208 N_i\\}$ as fingerprints, and include it into the input of policy network and value network. Thus, our policy network can be written as $\u03c0_{\u03b8_i} (a^t_i\\vert s_{V_i}^t, \u03c0^{N_i})$ and value network as $V_{\u03c6_i} (s_{V_i}^t, \u03c0^{N_i})$, where $s_{V_i}^t$ is the local observation"}, {"title": "Multi-agent Advantage Actor-critic", "content": "with spatial discount factor introduced below.\nSpatial Discount Factor and Adjusted Reward. MA2C agents cooperatively optimize a global cumulative reward. We assume the global reward is decomposable as rt = \u2211i\u2208Vrt, where $r^t_i$ is defined in Eqn. (2.4). Instead of optimizing the same global reward for every agent, here we employ the spatial discount factor \u03b1, introduced by [61], to let each agent pay less attention to rewards of agents farther away. The adjusted reward for agent i is\n$$D^t_i = \\sum\\limits_{d=0}^{D_i} (\\sum\\limits_{j\u2208V \\vert d(i,j)=d} \u03b1^d r^t_j ),$$\nwhere Di is the maximum distance of agents in the graph from agent i. When \u03b1 > 0, the adjusted reward include global information, it seems this is in contradiction to the local communication assumption. However, since reward is only used for offline training, global reward information is allowed. Once trained, the RL agents can control a traffic signal without relying on global information.\nTemporal Discount Factor and Return. The local return $R^t_i$ is defined as the cumulative adjusted reward $R^t_i := \\sum^T_{t'=t} \u03b3^{t'\u2212t} r^{t'}_i$, where \u03b3 is the temporal discount factor and T is the length of an episode. We can estimate the local return using value function,\n$$R^t_i = r^t_i + \u03b3 V_{\u03c6_{\\bar{i}}}(s^{t+1}_{V_i}, \u03c0_{\u03b8_{\\bar{i}}}),$$\nwhere $\u03c6_{\\bar{i}}$ means parameters $\u03c6_i$ are frozen and $\u03b8_{\\bar{i}}$ means the parameters of policy networks of all other agents are frozen.\nNetwork architecture and training. As traffic flow data are spatial temporal, we leverage a long-short term memory (LSTM) layer along with fully connected (FC) layers for policy network (actor) and value network (critic). Fig. 2.6 provides an overview for the MA2C frameworks for EMVLight."}, {"title": "Experimentation", "content": "In this section, we demonstrate our RL framework using Simulation of Urban Mobility (SUMO) [85] SUMO is an open-source traffic simulator capable of simulating both microscopic and macroscopic traffic dynamics, suitable for capturing the EMV's impact on the regional traffic as well as monitoring the overall traffic flow. An RL-simulator training pipeline is established between the proposed RL framework and SUMO, i.e., the agents collect observations from SUMO and preferred signal phases are fed back into SUMO. Notice that in order to reflect the proposed emergency lane in Fig.3, we enable the built-in Sublane model [86] and Blue light device [87] to establish the emergency lane for EMV passage. Under this scenarios, non-EMVs pull over to the sides when the EMV is driving between, and they resume normal driving when the EMV leaves the segment, see A.3 for more details."}, {"title": "Datasets and Maps Descriptions", "content": "We conduct the following experiments based on both synthetic and real-world map.\nSynthetic Grid5\u00d75 We synthesize a 5 \u00d7 5 traffic grid, where intersections are connected with bi-directional links. Each link contains two lanes. We assume all the links have zero emergency capacity. We design 4 configurations of time-varying traffic flows, listed in Table 2.2. The origin (O) and destination (D) of the EMV are labelled in Fig. 2.7. The traffic for this map has a time span of 1200s. We dispatch the EMV at t = 600s to ensure the roads are compacted when it starts travel.\nEmergency-capacitated (EC) Synthetic Grid5\u00d75 This map adopts the same network layout as the Synthetic Grid5\u00d75 but with emergency-capacitated segments. As shown"}, {"title": "Benchmark Methods", "content": "Due to the lack of existing RL methods for efficient EMV passage, we select traditional methods and RL methods for each subproblem and combine them to set up benchmarks.\nFor traffic signal pre-emption, the most intuitive and widely-used approach is the idea of extending green light period for EMV passage at each intersection which results in a"}, {"title": "Results and Discussion", "content": "In this section, we demonstrate the performance of EMVLight and compare it against that of all benchmark methods on four experimentation maps. The results show a clear advantage of EMVLight under the two metrics. In addition, we illustrate the difference of underlying route selection by EMVLight and benchmark methods. We further conduct ablation studies to investigate the contribution of different components to EMVLight's performance."}, {"title": "Performance Comparison", "content": "To evaluate the performance of the proposed EMVLight and all benchmark methods, we conduct SUMO simulation with five independent runs for each setting. Randomly generated seeds are used in learning-based methods. Means as well as standard deviations of the simulation results are reported for a full numerical assessment. The differences in simulation results for the same setting under independent SUMO runs are coming from configuration noise during generation, such as vehicles' lengths/accelerations/lane-changing eagerness, and, for RL-based methods, random seeds for initialization."}, {"title": "Emergency-capacitated Synthetic Grid5\u00d75 results", "content": "Table 2.5 shows TEMV of all the methods implemented on the emergency-capacitated synthetic Grid5\u00d75 map. By comparing Table 2.3 and Table 2.5, we conclude that the emergency-capacitated map exhibits overall shorter TEMV in all configurations. For benchmark methods, the nonzero emergency capacity shorten TEMV by an average of approximately 12 seconds. In particular, dynamic routing-based methods benefit more from the additional emergency capacity, resulting in an average reduction of in 16.28 seconds TEMV. This is due to the adaptive nature of dynamic navigation. By comparing EMVLight and benchmark methods in Table 2.5, we observe that EMVLight reduce TEMV by up to 50 seconds (25%) as compared to the best benchmark method in all configurations. The substantial difference in TEMV reduction between benchmark methods and EMVLight is due to high success rate of emergency lane forming under coordination,"}, {"title": "Manhattan16\u00d73 results", "content": "Table 2.7 presents EMV travel time and average travel time of all the methods on the Manhattan16\u00d73 map. In terms of TEMV, dynamic routing benchmarks in general result in faster EMV passasge, as expected. Compared with benchmark methods, EMVLight produces a considerably low average TEMY of 292.82 seconds, which is 38% faster than the best benchmark (W+static+CL). As for Tavg, We have similar observation as in the synthetic maps that Max Pressure achieves a similar level of performance on reducing congestion as PressLight and beats CDRL by a solid margin of 25%. CoLight stands out among benchmarks regarding both metrics. Particularly, CoLight shortens Tavg by approximately one minute than Max Pressure strategies on this map.\nFig. 2.11 and Fig. 2.12 shows the learning curves of TEMV and Tavg, respectively, in"}, {"title": "Hangzhou4\u00d74 results", "content": "Table 2.8 presents TEMV and Tavg of EMVLight and benchmark methods on Hangzhou4\u00d74. EMVLight achieves the lowest Temy of 194.52 seconds, beating the best benchmark (W+dynamic+CL) by 115 seconds (37%). As for Tavg, EMVLight also has excellent performance, exhibiting a 10% advantage over W+dynamic+CL, and a 20% advantage over W+dynamic+MP. Once again, Max Pressure outperforms PressLight in terms of Tavg. This is consistent with our observations with other maps above, suggesting Max Pressure result in great traffic signal coordination strategies to reduce overall congestion.\nBased on results of all introduced experiments, Max Pressure has evinced the consistency to restrict congestion, particularly when restoring stagnant traffic after EMV passages. Consequently, Max Pressure accomplishes the comparable congestion reduction acquirement with, if not better than, RL-based strategies.\nCDRL fails to learn an effective coordination strategy to manage congestion, where its Tavg trivially differs from Fix Time strategy's Tavg. CoLight surpasses other methods by shortening Tavg by at least 40 seconds but it does not illustrate significant improvement"}, {"title": "Routing choices", "content": "In this section, we investigate the reason behind EMVLight's best performance in TEMV from a routing perspective. In particular, we show how EMVLight is able to\nleverage emergency capacity to achieve maximum speed passage. To understand different route choices between benchmark methods and EMV"}]}