{"title": "Match Point AI: A Novel AI Framework for Evaluating Data-Driven Tennis Strategies", "authors": ["Carlo N\u00fcbel", "Alexander Dockhorn", "Sanaz Mostaghim"], "abstract": "Many works in the domain of artificial intelligence in games focus on board or video games due to the ease of reimplementing their mechanics [1], [2]. Decision-making problems in real-world sports share many similarities to such domains. Nevertheless, not many frameworks on sports games exist. In this paper, we present the tennis match simulation environment Match Point AI, in which different agents can compete against real-world data-driven bot strategies. Next to presenting the framework, we highlight its capabilities by illustrating, how MCTS can be used in Match Point AI to optimize the shot direction selection problem in tennis. While the framework will be extended in the future, first experiments already reveal that generated shot-by-shot data of simulated tennis matches show realistic characteristics when compared to real-world data. At the same time, reasonable shot placement strategies emerge, which share similarities to the ones found in real-world tennis matches.", "sections": [{"title": "I. INTRODUCTION", "content": "For two decades, the men's tennis scene has revolved around the dominant trio dubbed \"the Big Three\". From 2003 to 2023, they claimed 66 out of 80 Grand Slam titles. While Federer retired and Nadal battled injuries, Djokovic, the last of the triumvirate remains unmatched. This paper explores Al's potential in tennis decision-making, aiming to dissect strategies, enhance shot placements, and potentially aid emerging players in challenging Djokovic's reign.\nSports data analytics has been shown to provide deep insights into athletic performance and tactical patterns. While analyzing real-world data can already help us to revise and improve our knowledge of a sport in general or an upcoming opponent, it does not allow us to test new strategies and how they would perform against others. Artificial intelligence can bridge this gap, by running simulations in which the behavior of our opponent is imitated, allowing us to specifically train against it. Hence, we developed the Match Point AI framework, which models Tennis matches and players based on historical data and aims to empower AI agents in optimizing tennis strategies.\nIn sports, particularly tennis, Monte Carlo Tree Search (MCTS) has seen limited application so far. For instance, [3]"}, {"title": "II. TENNIS RULES AND TERMINOLOGY", "content": "For a better understanding of the presented framework, we provide a short introduction to tennis and its terminology.\nTennis is a game played between two players that involves them hitting the ball to the other side of the court. A rally is the shot sequence containing all the shots starting with the serve of one player until a point is won or lost. Points can be won through opponent errors or successful shots that the opposing player was not able to reach. An error occurs, if the ball lands outside of the court or in the net. A fault, e.g. by hitting the ball into the net on the first serve allows a second attempt; a double fault gives the opponent the point.\nA detailed explanation of the scoring system in Tennis is not necessary for this paper. However, it is important to note, that a match consists of points, games, and sets. Scoring sufficient points earns a player a game; accumulating enough games secures a set, and claiming enough sets leads to a match victory. Each game starts with a serve from the right side of the court, called the deuce side, and the ball has to land in the opponent's left serving box. The next point then starts with a serve from the left side of the court, referred to as the advantage side and the serve has to land in the opponent's right service box. The service boxes mark specific court areas where serves must land, and players take turns serving between each game within a set. More details about the scoring system and rules in tennis can be found at USTA [5]."}, {"title": "III. MATCH POINT AI", "content": "In a real-world tennis match, many factors can influence the course of a match and the outcome of individual points. There can be external factors such as rain delays or the support by fans. On the court, there can be foot faults when serving, time violations, and medical timeouts. The outcome of a rally is heavily influenced by the shots in that rally, particularly the ball velocity, the player's movements and position on the court, and the direction of the previous shot. To tackle the shot direction selection problem in tennis, we model tennis as a non-deterministic game. Each action consists of an active choice of direction and a probability for that shot to be a winner or an error. For the shot direction encoding, we differentiate between serves and normal shots.\nFurthermore, in Match Point Al, the players follow the typical tennis match rules (see section II). When it is one of the player's turns to choose an action in an ongoing rally, he can choose to play the ball in the three different directions, encoded as 1, 2, and 3. If it is a player's turn to serve, he can choose between the action encodings 4, 5, and 6. The shot length encoding is used for visualization purposes. It is based on the match charting project dataset as well. Still, it does not influence the winner and error probabilities of individual shots and the depth can not actively be chosen by the players in Match Point AI.\nTo summarize, each shot in Match Point Al consists of an active choice of direction of one of the players and a stochastic component, whose error and winner probabilities are dependent on the current game state. The probability of the return being an error is for example higher when the previous serve was a first serve instead of a second serve because the second serve is usually easier to return than a first serve.\nThe Source Code of Match Point AI can be found at https://github.com/cnuebel98/Match_Point_AI_Public.git"}, {"title": "IV. DATA-DRIVEN BOT STRATEGIES", "content": "From related work on game AI, it is known that the performance of an Al agent depends on the quality of its opponent model. Especially, in search-based methods like MCTS, in which the opponent model drives the simulations, it can make a difference in the final agent's performance [7].\nFor this purpose, we derived data-driven bot behavior using data from the match charting project spanning from 2017 to 2023. It consists of shot-by-shot tennis data for 295,354 rallies of singles matches in professional men's tennis. It covers 30 attributes of each tracked rally, including the tournament at which the match was played, the two opposing players, the scores, and the directions and types of all shots in the rallies.\nWhile players of real-world tennis differentiate between shot types, those are not considered throughout Match Point AI. In general, special shots, such as slice, volley, stops, or lob only make up 20% of the data set and are therefore omitted from the current version (see Section A in Supplementary Materials).\nBased on the introduced dataset two different bot strategies were created. For this purpose, we differentiate between three main shot types: the serve, the return, and other shots. For the Serve we differentiate between the side of the court from which it is hit, whether it was a first or second serve, and in which of the three different directions of the service box it was hit. A total of 36 different probabilities are included for the bot's serve behavior. For the Return the direction and the corresponding error and winner probabilities are dependent on the previous serve. Given 12 serve scenarios, 3 directions, and 3 possible outcomes (error, winner, undecided), a total of 108 probabilities is extracted. For the remaining Normal Shots, we consider the player who initiated the serve (due to their impact on the remaining rally), if it was the first or second serve, and the player's possible directions and the shot's possible outcomes. Once again a total of 108 probabilities is extracted. For creating different bots this analysis was done on different parts of the datasets. The Djokovic Bot was created, only extracting probabilities from rallies in which Novak Djokovic was playing. The Average Bot is based on all rallies in the specified time frame."}, {"title": "V. EXPERIMENTS AND RESULTS", "content": "Match Point Al enables us to conduct numerous match simulations with diverse settings, offering a wide range of possibilities for the exploration of tennis strategies and the performance analysis of different MCTS agents. Three sets of experiments were conducted for this paper, to illustrate different ways of how Match Point AI can be used.\nIn the first experiment, the Average Bot competed against the Djokovic Bot in 500 simulated matches. Out of these, the Djokovic Bot emerged victorious in 82.6% of them. Comparatively, between 2017 and 2023, the real-world Novak Djokovic participated in 394 competitive matches, winning 336 of them, resulting in a match-win rate of 85.3%. While there is a difference of 2.7%, it's important to acknowledge the factors of real-world tennis, which are not modeled in the simulations of Match Point Al. The comparison shows that Match Point AI is already able to produce similar results to the ones observed in real games and may therefore be used to produce new and interesting insights into the shot direction selection problem in tennis.\nWith the second set of experiments, we want to compare different characteristics found in the generated data in Match Point AI to real-world data and assess the effectiveness of various selection policies in the MCTS algorithm. Therefore, we simulate matches where MCTS agents compete against two bot strategies. The MCTS agents using different policies and their match and point win rates against the Average and the Djokovic Bot can be seen in Table I. It illustrates the correlation between point win rates and match win rates. Winning even slightly more points than the opponent leads to substantially higher match-win rates. This correlation aligns with real-world data. Table II displays several professional tennis players' point and match win rates and the correlation found in our generated data can be seen in this real-world data as well.\nFurthermore, the rally length distribution of the rallies generated in Match Point AI was compared to the distribution in the real-world data. While no significant difference was found between the total distributions, we can see in 3, that the real-world data contains 3.79% more rallies with only one shot, compared to the generated data. A one-shot rally only consists of a first-serve winner, an ace. This means it is harder to hit an ace in Match Point AI compared to real-world tennis. This could be due to the simplicity, with which tennis is modeled in Match Point AI, compared to the complexity of real-world tennis.\nWe then compared the effectiveness of different selection policies in the MCTS algorithm when used in Match Point AI. In all matches, agents were using a Greedy decision policy. For the different selection policies, we see that slight variations in the point-win rate can result in drastic differences in the match-win rate. Overall, in both matchups agents using the UCT selection policy were performing best.\nFrom this data, we also extracted the most frequent shot direction selection strategies in specific situations in a tennis rally used by the MCTS agents against the Djokovic Bot. The results are visualized in 4. We only look at the first three shots in a rally when the agents are serving first and also second serves from both the advantage and the deuce side of the court. An interesting observation is that the agents are trying to make the Bot run. On the far left court for example, after placing the first serve to the far left side of the opponent's service box, the third shot is placed to the far right corner of the court. The same can be seen for the first serve from the advantage side on the inner left court. Making your opponent run is a common strategy in tennis. That agents can learn this strategy does however speak to the ability of Match Point AI to generate realistic tennis data as well as to the MCTS algorithm capability to solve the shot direction selection problem.\nFinally, to analyze the effect that different parameter settings can have on the performance of the MCTS algorithm in Match Point AI, in the third experiment we simulate matches with the MCTS agent using UCT as selection and Greedy as decision policy. We adapt this agent by using three different C values $(\\sqrt{2} \u2013 0.5, \\sqrt{2} and \\sqrt{2}+0.5)$ during the simulation phase and let these adapted agents play against the Average Bot in 100 matches each. The results in Table III show, that the agent using a C value of $\\sqrt{2} + 0.5$ wins significantly more points against the Average Bot compared to agents using the other two C values."}, {"title": "VI. CONCLUSION AND FUTURE WORK", "content": "In this work, we present the tennis match simulation environment, Match Point Al, in which tennis is modeled as a non-deterministic game. Further, we showcase how different data-driven bot strategies, reflecting real-world player behaviors, can engage in matches against different MCTS-based agents. By comparing the shot-by-shot data generated by Match Point Al with real-world tennis data, we observe realistic parallels, such as the rally length distributions and correlations between point and match win rates. By analyzing the strategies devised by the agents, we demonstrate how MCTS can be used in Match Point Al to optimize the shot direction selection problem in tennis. Here, different policies and parameter settings are used in the MCTS algorithm to determine, which MCTS adaptation is best suited to solve this problem.\nEven though the first experiments conducted with Match Point Al show promising results, there are several opportunities for future improvements of the framework. Most of these improvements, however, largely depend on incorporating more and better tennis data. The dataset used in this paper is a valuable source of real-world shot-by-shot tennis data, with untapped potential for example for adding shot types like drop shots, lobs, and volleys. However, it lacks detailed information on ball velocities and player positions and their movements, which are crucial for understanding a player's shot direction decisions.\nThere are already other ways of tracking tennis data, which can keep track of the data automatically and more precisely than the crowd-sourced match charting project, such as electronic line calling with Hawk-Eye [8], [9]. The Hawk-Eye technology nowadays replaces line judges at major tournaments and tracks ball placement down to the millimeter. Including data like this would drastically increase the capabilities of Match Point AI and the bot strategies would represent the real-world player's behavior much more precisely.\nIt would also be interesting to see, if the agents come up with personalized strategies against different Bots, mirroring other player's behavior than that of Novak Djokovic, because the best strategy to win against Djokovic is probably not the best strategy to win against Rafael Nadal. The shot pattern analysis was conducted for a few very specific scenarios in a tennis match. Tennis and also the resulting data of Match Point Al offers a wide range of other scenarios, that would be interesting to explore as well.\nFinally, in this paper, we used the MCTS algorithm and analyzed the influence of different policies and different parameter settings on its performance in winning points in Match Point Al. Despite our attempts to tune the agent's parameters, no agent has been capable of defeating the Djokovic bot. Therefore, future testing will involve the development of further MCTS variants and other agents to find innovative solutions to the shot direction selection problem in tennis."}]}