{"title": "Detecting Daily Living Gait Amid Huntington's Disease Chorea using a Foundation Deep Learning Model", "authors": ["Dafna Schwartz", "Lori Quinn", "Nora E. Fritz", "Lisa M. Muratori", "Jeffery M. Hausdorff", "Ran Gilad Bachrach"], "abstract": "Background: Wearable sensors offer an objective, non-invasive means to collect physical activity (PA) data with walking as a key component. However, in conditions involving involuntary movements, for example, due to neurodegenerative diseases (NDDs), existing models struggle to accurately detect gait bouts. We developed a novel gait detection approach for individuals with movement disorders, like Huntington's disease (HD), in daily-living environments.\nMethods: We developed J-Net, a deep learning model inspired by U-Net, which uses a pre-trained self-supervised foundation model fine-tuned with in-lab HD data and paired with a segmentation head for sample-wise gait classification, to detect gait during daily living using wrist-worn accelerometer data. J-Net's performance was evaluated on in-lab and daily-living data from individuals with HD, Parkinson's disease (PD) patients, and healthy controls.\nResults: J-Net outperformed existing methods across all in-lab metrics, achieving a 10-percentage point increase in ROC-AUC for people with HD, reaching 0.97. In daily-living settings, J-Net did not show significant differences in median daily walking time between HD and controls (p = 0.23), while other models suggested, counterintuitively, that people with HD walked significantly more (p < 0.005). Median walking time measured by J-Net correlated with the UHDRS-TMS clinical measure of HD severity (r = -0.52; p = 0.02), supporting its clinical meaningfulness. Fine-tuning J-Net on PD data also improved gait detection over existing methods.\nConclusions: The J-Net architecture is a promising tool for gait detection in individuals with NDDs like HD and PD using wrist-worn accelerometers. By combining a foundation model with a segmentation network, J-Net outperformed existing methods, particularly in detecting gait during severe chorea in HD. In daily-living settings, J-Net provided an estimate of walking time and insights on the diurnal patterns of gait with face validity, in contrast to existing methods. The novel dataset created for this study, is now open source, along with the J-Net model, enabling further research.", "sections": [{"title": "1 Introduction", "content": "Physical activity (PA) is essential for maintaining health, reducing morbidity and mortality, and enhancing quality of life. Traditionally, self-report has been used to evaluate PA[1], though subjective measures often lack a strong correlation with objective measures [2], limiting utility. Wrist-worn devices and smartphones provide objective, non-invasive means to collect PA data[3], particularly for walking, a key component of PA. However, an important consideration that has largely been ignored is that among people with involuntary movements, such as those with neurodegenerative diseases (NDDs), existing models struggle to detect gait bouts accurately.\nNDDs like Huntington's disease (HD) and Parkinson's disease (PD) are characterized by progressive motor impairments [4, 5], posing unique challenges to gait identification from wearable sensors. In PD, motor symptoms include involuntary hand movements such as tremor and dyskinesia, while HD is marked by chorea and dystonia, manifesting as involuntary hyperkinetic and hypokinetic movements. Recent work has explored chorea quantification in HD using wearable sensors during structured tasks in daily-living settings[6], demonstrating feasibility. However, this study does not allow continuous measurement of chorea or gait in HD. Accurate identification of walking is crucial, as gait metrics serve as sensitive indicators of PA and disease severity[7-10]. Moreover, objectively assessing gait in daily living through wrist-worn sensors provides valuable insights into intervention effectiveness. The present study focuses on HD, addressing gait detection challenges in chorea, while illustrating the broader utility of our approach in PD.\nGiven the challenges in collecting high-quality gait recordings from individuals with NDDs like HD, the scarcity of labeled data is a major barrier [11, 12]. Labeling data is time-consuming and expensive, often requiring expert clinicians to annotate recordings, which constrains dataset availability. Ethical considerations, participant burden, and logistical challenges also make collecting sufficient data difficult. This lack of comprehensive, labeled datasets restricts the development and validation of accurate models critical for identifying subtle deviations in gait patterns associated with movement disorders like HD. Overcoming this limitation is essential for advancing gait analysis research and improving outcomes for individuals affected by these diseases.\nA promising solution to data scarcity is leveraging foundation models combined with transfer learning. This involves training a model on a surrogate task and adapting it to the task of interest through fine-tuning[13]. Foundation models are becoming a major pillar of artificial intelligence[14-18]. Typically, these models use self-supervised learning (SSL) to acquire rich feature representations that are fine-tuned for specific tasks using relatively small labeled datasets. This approach has shown promise in human activity recognition (HAR) and step detection, yielding superior performance over traditional methods[19-21]. However, none of these studies have addressed the unique challenges of detecting gait abnormalities in HD and similar NDDs.\nIn this study, we show that existing methods for gait detection from wrist-worn accelerometers often incorrectly detect gait bouts of people with movement disorders such as HD. To mitigate this problem, we develop a novel approach for gait detection specifically designed for individuals with HD chorea in daily-living environments. Our"}, {"title": "2 Methods", "content": "Participants with HD and age-matched healthy controls (HC) were recruited as part of a study designed to evaluate the feasibility, acceptability, and utility of wearable activity monitors in people with early-mid stage HD. Tri-axial accelerometer signals were collected using wrist-worn devices during an in-clinic assessment. Participants completed a set of standardized laboratory-based functional activities, reflecting independent activities of daily living. The in-clinic assessment lasted approximately 30 minutes per participant. After this session, participants wore the GENEActiv (Kimbolton, UK) device on their wrist for the next 7 days in their daily environment to assess the performance of our model in daily-living. Details on device specifications, assessment protocols, and labeling procedures for the accelerometer signals are provided in the Supplementary Methods (SM)."}, {"title": "2.2 Model architecture and training", "content": null}, {"title": "2.2.1 Foundation Model: Multi-Task Self-Supervised Learning", "content": "We adopted a multi-task SSL pre-trained model introduced by Yuan, Chan, Creagh, et al. [20] as the foundation for HAR. This SSL model was trained on the unlabeled UK Biobank (UKB) dataset, which comprises approximately 700,000 person-days of free-living activity data from over 100,000 participants, spanning seven days of wear for each participant. Notably, this model demonstrated superior performance in HAR, compared to previous HAR SSL models [20], likely because it leveraged a significantly larger dataset encompassing diverse natural human activities. In this approach, the tri-axial accelerometer data from wrist-worn activity trackers were used to train a feature extractor (FE) based on the ResNet-V2 architecture[24]. The input to the network consisted of 10 second length windows of the 3-axis accelerometer data resampled to a frequency of 30Hz. The FE outputs a learned representation vector of 1024 dimensions, capturing essential information for subsequent activity recognition tasks."}, {"title": "2.2.2 Baseline Model Architecture and Training Procedure", "content": "To establish a baseline model, we adopted the architecture and training methodology originally outlined by Yuan, Chan, Creagh, et al. [20] to fine-tune the model for downstream HAR tasks. We integrated the FE network with a binary gait detection head, consisting of a fully-connected (FC) layer and a sigmoid readout, facilitating the classification of each window as gait or non-gait. The pre-trained FE and the gait detection head were fine-tuned simultaneously using the HD dataset (See Fig. 1a). The data preprocessing pipeline is described in the SM."}, {"title": "2.2.3 J-Net Segmentation Model Architecture and Training Procedure", "content": "To enhance the precision of gait detection based on wrist-worn accelerometer signals, we developed a novel segmentation head to combine with the pre-trained network architecture. This head modifies the network's task to segmentation, effectively enabling sample-wise classification in contrast to the window-wise classification used in Yuan, Chan, Creagh, et al. [20]. We developed the J-net architecture, shown in Fig. 1b, which is inspired by the U-net architecture[25] and previous similar implementations from the field of computer vision [22, 26]. In U-net, the data goes through a down sampling process followed by an up-sampling process. In J-net, the pre-trained foundation model replaces the down-sampling part of the U-net and then an up-sampling part is added to fine-tune the model for gait segmentation. Hence, the name J-net represents that the J-net is the right-hand side of the U-net. See the SM for details on the preprocessing steps, input format, and training procedure."}, {"title": "2.3 Evaluation", "content": "For the evaluation of our model trained on in-lab data, where ground-truth labels were available, we employed five-fold participant-wise cross-validation. The performance metrics were calculated based on this in-lab dataset. We computed a confusion matrix to analyze the gait detection results overall and stratified by chorea level. Additionally, we calculated the receiver operating characteristic area under the curve (ROC-AUC) to evaluate models of imbalanced data such as in gait detection. This assesses the performance of a classifier across all possible classification thresholds. For a detailed explanation of the AUC estimation method and the computation"}, {"title": "2.4 Performance evaluation in Daily-living", "content": "To evaluate the performance of J-Net in real-world scenarios, we used a dataset collected in daily-living. The gait detection models were applied to generate gait predictions. Since this data is unlabeled, we used gait predictions of the suggested segmentation model and the baseline classification model to perform a comparative analysis between the cohorts of HD and HC. We assessed hourly and daily walking percentages and walking time. Details on the statistical analysis, including the comparison between the HD and HC groups and the correlation with disease severity, are provided in SM."}, {"title": "2.5 Performance evaluation in Parkinson's disease", "content": "To evaluate generalizability to other NDDs, we used a dataset of 18 individuals with PD. These individuals wore a tri-axial accelerometer on their wrist for up to 10 days, with a sampling frequency of 25 Hz (Garmin, Olathe, KS, USA). A description of the dataset can be found in [27]. We compared the performance of the baseline classification model and J-Net on the PD dataset. Additional details on the evaluation with the PD dataset is in SM."}, {"title": "3 Results", "content": "In-clinic data collected from 25 participants with HD and 10 age-balanced HC participants were used for training and testing the models (Table S1). Disease-specific status was quantified through the Unified Huntington's Disease Rating Scale (UHDRS)[28] including the TFC, Total Motor Score (TMS) and Functional Assessment (FA). The scores were administered by certified raters at each site (Table S1). Data from daily-living of HD, HC and PD individuals were used to further evaluate and compare model performance. The dataset used in this study is publicly available and can be accessed at [https://doi.org/10.5281/zenodo.14384260]. Additionally, the code used is available on GitHub."}, {"title": "3.1 Performance evaluation of baseline classification and J-Net segmentation models for gait detection", "content": "The baseline classification model preprocessing produced 1,008 windows for the HD cohort and 766 for the HC cohort, while the segmentation model generated 5,920 windows for HD and 2,537 for HC, with each window containing 300 samples of 3-axis data. Examples of signals of HC, HD without chorea and HD with high chorea are illustrated in Fig. 2. More details on the results of the preprocessing stage are provided in the Supplementary Results (SR). Recall, precision, and ROC-AUC values for both the baseline classification model and the new J-Net segmentation model for HD and HC participants are summarized in Table 1. When comparing the overall performance of the two models across chorea levels, J-Net exhibited significant improvements across all metrics. Specifically, there was a 10 percentage points increase in ROC-AUC for HD participants, reaching an AUC of 0.97 \u00b1 0.0006, and a 4 percentage points increase in ROC-AUC for HC participants, reaching an AUC of 0.98 \u00b1 0.0004. While both models performed better for HC, the segmentation model showed similar ROC-AUC values for HD and HC.\nTable 1 summarizes the AUC and 95% confidence intervals (CI) of the baseline model and the proposed segmentation model per chorea level. Fig. S1 displays a series of confusion matrices, organized in ascending order of chorea severity levels. As the chorea level increased, the ability of the models to accurately detect gait decreased. However, for the baseline model, the differences are larger between the chorea levels. Specifically, the reduction (degradation) in AUC between no chorea (chorea level 0) and highest chorea level (chorea level 4) with the baseline model was 58.5 percentage points. In contrast, with J-Net, the reduction was only 10 percentage points. In Chorea Level 4, the most severe stage marked by pronounced chorea, the baseline model demonstrated inadequate performance (AUC=0.35\u00b10.17) while the J-Net still performed adequately (AUC=0.88\u00b10.015). Ablation study results are in the SR."}, {"title": "3.2 Daily living performance", "content": "Fig. 3 displays the diurnal pattern of walking time in minutes per hour as predicted by the two models for the HD and HC cohorts. The classification model under-estimated the walking time consistently throughout the day for HC and also counter intuitively identified more walking time in HD compared to HC (Figs. 3a and 3b))."}, {"title": "4 Discussion", "content": "In this study, we developed a novel deep learning model for gait detection using wrist-worn accelerometer signals that effectively addresses challenges in measuring gait for people with involuntary movements. By combining a pre-trained foundation model and an advanced segmentation architecture, our approach learns to detect gait even in the presence of irregular gait patterns seen in daily life, offering more reliable detection of gait bouts in individuals with movement disorders like HD.\nAlgorithms for HAR using wearable devices, particularly wrist-worn ones, are considered accurate and are integrated into popular smartwatch applications[29-32]. Recent works describe robust and generalized algorithms for HAR in daily-living settings using pre-trained models fine-tuned for specific datasets [19\u201321].\nDespite the robustness of these generalized algorithms in non-diseased populations, our study revealed that they do not generalize well to individuals with movement disorders, particularly HD and PD. When evaluating their performance on a dataset of individuals with HD, we observed a significant drop in accuracy as chorea"}, {"title": "5 Supplementary Methods", "content": null}, {"title": "5.1 Dataset description", "content": "Participants with HD and age-matched healthy controls (HC) were recruited from three clinical centers: (1) Teachers College, Columbia University, (2) the George Huntington Institute, M\u00fcnster, Germany, and (3) Cardiff University. The study was originally designed to evaluate the feasibility, acceptability, and utility of wearable activity monitors in people with early-mid stage HD. Tri-axial accelerometer signals were collected using wrist-worn devices (GENEActiv, Activinsights; 43 \u00d7 40 \u00d7 13 mm; weight: 16 g; 100 Hz sampling rate) in HD participants and HC during the in-clinic assessment. Participants completed a standardized laboratory-based circuit of functional activities, reflecting independent activities of daily living in the home. The overall in-clinic assessment lasted approximately 30 minutes for each subject. The accelerometer signals were recorded continuously during the assessment and, therefore, activities in between the standard tasks were also included in the signals. The in-clinic assessments were video-recorded, and these videos were subsequently used in the labeling procedure of the accelerometer signals. After the in-clinic session, the HD and HC participants were given a GENEActiv device to wear on their wrist for 24 hours per day over the next 7 days in their daily environment, with participants asked to continue their activities as usual. At the end of the 7-day period, participants removed the device and sent it back to the local clinical site. The data from the in-clinic assessment were used to train and validate the gait detection algorithm, and later, we used the daily-living dataset to assess the performance of our model in daily living."}, {"title": "5.2 Labeling procedure", "content": "The signals captured from the wearable sensor were synchronized with corresponding video recordings and were annotated by certified Unified Huntington's Disease Rating Scale (UHDRS) motor raters. The start and end of activities including walking, sitting, standing and transitions between the activities (i.e., sitting down and standing up) were annotated. This labeling procedure resulted in continuous segments of the signal with an activity label. Similarly, we marked the start and end of every chorea episode together with the chorea level exhibited by the right arm (where the sensor was placed). Chorea levels ranged between 0 (none) to 4 (severe), reflecting the chorea severity, as defined by the UHDRS. Instances where the subject's movements were unclear due to being obscured from the camera or positioned too far from it, resulting in uncertainty regarding the activity preformed or chorea rating, were designated as 'cannot be ranked'."}, {"title": "5.2.1 Baseline Model Architecture and Training Procedure", "content": "The data preprocessing pipeline for the baseline model included the following steps:\n1. Applying a bandpass filter with a high cutoff frequency of 15Hz and a low cutoff frequency of 0.2Hz.\n2. Resampling the signal to 30Hz\n3. Breaking the signals into 10-second windows"}, {"title": "5.2.2 J-Net Segmentation Model Architecture and Training Procedure", "content": "The input to the network was a 10-second window (300 samples) and the output was a 10-second window segmented to gait and non-gait. In the preprocessing pipeline, we replicated the steps of filtering and resampling utilized in the baseline model. To address the challenge of accurately predicting events occurring at the edges of windows, we devised a strategy of creating batches of three consecutive windows with overlap of 5 seconds between the first window and the second window, and 5 seconds overlap between the second and third. In this way, we created an effective 10-second window that was padded with 5 seconds before and after. Each of the three windows was input to the feature extractor network and the outputs (including the output from the skip connections and the feature vector) were concatenated. The concatenated outputs were used as an input to the J-Net network that was then upsampled to the size of 3 \u00d7 300. The predictions of the network were for the middle window only. This triple window strategy allowed it to learn the context from 20 seconds overall (i.e.,10 seconds padded in 5 seconds at the beginning and end) and reduced potential inaccuracies near the window edges. Since this is a segmentation task, no majority rule was used, and the labels of each time sample were utilized. We employed the masked cross-entropy loss to handle samples labeled as \"-1\", indicating invalid data. We calculated the cross-entropy loss only of valid samples and normalized it by the number of valid samples. Consistent with the baseline model, we utilized a batch size of 64 and employed the Adam optimizer with a learning rate of le-3 [36]."}, {"title": "5.3 Evaluation", "content": "We used the observation that the AUC is equivalent to the probability that a randomly chosen gait sample had a higher score than a non-gait sample (plus half of the probability of ties is added, if any), and that can be expressed as: $AUC = P[Y > X] + \\frac{1}{2}P[Y = X]$ where X and Y are the scores of randomly chosen non-gait and gait samples, respectively. We used the unbiased estimator of the AUC presented in Cho, Matthews, and Harel [37] and then the confidence interval was computed as a Wald-type interval based on the variance estimator of the ROC-AUC as suggested by Hanley and McNeil [38]. We evaluated a model trained on healthy populations for detecting gait in individuals with HD. We assessed the performance of a baseline classification model fine-tuned with HC data by inferring on the HD dataset. Additionally, we evaluated the effectiveness of our segmentation"}, {"title": "5.4 Performance evaluation in Daily-living", "content": "A comparison between the median walking time of the HD group and HC group was computed using a Student t-test. To further investigate the relationship between predicted walking time and disease severity, we calculated the median daily walking time for each subject. This metric was then correlated with the Unified Huntington's Disease Rating Scale-Total Motor Score (UHDRS-TMS). We computed Spearman correlation coefficients to quantify the strength and direction of the relationship."}, {"title": "5.5 Performance evaluation in Parkinson's disease", "content": "An additional tri-axial accelerometer sensor was placed on the lower back. Labeling of the PD dataset into gait and non-gait segments was conducted based on \"gold-standard\" annotations from the lower-back sensor [7, 39]. We also fine-tuned the baseline classification model and our J-Net segmentation model with the PD dataset to assess their performance after adaptation to this specific cohort."}, {"title": "6 Supplementary Results", "content": null}, {"title": "6.1 Dataset", "content": "Table S1 summarizes HD and HD characteristics."}, {"title": "6.2 Performance evaluation of baseline classification and J-Net segmentation models for gait detection", "content": "The preprocessing approach for the baseline classification model resulted in 1,008 windows of 3-axis data, each with 300 samples for the HD cohort and 766 windows for the HC cohort, utilized for training and evaluation. Meanwhile, the preprocessing approach for the proposed segmentation model generated 5,920 windows of 3-axis data, each with 300 samples for the HD cohort and 2537 windows for the HC cohort, utilized for training and testing. The differences between the number of windows originate in the approach to remove ambiguous windows (i.e., windows in which less than majority of 70% from one activity) which we found to improve the classification model in a preliminary test. The preprocessing approach for the segmentation model allowed the inclusion of samples that were labeled as not valid in the classification training data.\nFig. S1 displays a series of confusion matrices, organized in ascending order of chorea severity levels, from none to high. Each matrix corresponds to a specific chorea level and facilitates a comparative analysis of gait detection performance, stratified by the severity of chorea."}]}