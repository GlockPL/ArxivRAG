{"title": "Leveraging Self-Supervised Learning for Fetal Cardiac Planes Classification using Ultrasound Scan Videos", "authors": ["Joseph Geo Benjamin", "Mothilal Asokan", "Amna Alhosani", "Hussain Alasmawi", "Werner Gerhard Diehl", "Leanne Bricker", "Karthik Nandakumar", "Mohammad Yaqub"], "abstract": "Self-supervised learning (SSL) methods are popular since they can address situations with limited annotated data by directly utilising the underlying data distribution. However, adoption of such methods is not explored enough in ultrasound (US) imaging, especially for fetal assessment. We investigate the potential of dual-encoder SSL in utilizing unlabelled US video data to improve the performance of challenging downstream Standard Fetal Cardiac Planes (SFCP) classification using limited labelled 2D US images. We study 7 SSL approaches based on reconstruction, contrastive loss, distillation and information theory, and evaluate them extensively on a large private US dataset. Our observations and finding are consolidated from more than 500 downstream training experiments under different settings. Our primary observation shows that for SSL training, the variance of the dataset is more crucial than its size because it allows the model to learn generalisable representations which improve the performance of downstream tasks. Overall, the BarlowTwins method shows robust performance irrespective of the training settings and data variations, when used as an initialisation for downstream tasks. Notably, full fine-tuning with 1% of labelled data outperforms ImageNet initialisation by 12% in Fl-score and outperforms other SSL initialisations by at least 4% in Fl-score, thus making it a promising candidate for transfer learning from US video to image data.", "sections": [{"title": "1 Introduction", "content": "Fetal sonography is used to assess the growth and well-being of the fetus. The ISUOG\u00b3 guidelines [3] and the FASP4 handbook [17] recommend the acquisition and use of standardised planes for fetus abnormality and growth assessment which is done manually by sonographers. In practice, a well-trained sonographer should account for variations caused by fetal movement & position, maternal body habitus, probe placement angle, etc. At the device level, even calibration and manufacturing differences can produce variations in image quality and measurements. This makes it hard to acquire Standard Fetal Planes (SFP) consistently and even more complicated for Standard Fetal Cardiac Planes (SFCP) which is critical in assessing conditions such as congenital heart diseases and intrauterine growth restrictions. Building automated systems to tackle aforementioned issues faces challenges due to large intra-class variations and inter-class similarities among the anatomical structures. This becomes even more challenging for SFCP, with fast motion due to heartbeats, leading to many misclassifications.\nA myriad of work exists to solve the automated FSP classification using data-driven approaches like supervised machine learning [25] and deep learning (DL) [2,24] with fetal ultrasound (US) images. But labelling large amounts of data that can help capture class variability and distribution shifts is expensive. In addition, unlike natural images, the existence of large public datasets is also hindered by privacy concerns. In most healthcare facilities, large volumes of unlabelled data will be found in isolation, which could neither be shared publicly nor be labelled to utilise privately. Recent self-supervised learning (SSL) techniques mitigate the requirement of large labelled datasets to train good DL models. Although SSL methods have been applied on US imaging analysis especially echocardiography [12,19], it is understudied in the fetal image analysis field. Since US scanning involves the recording of fetal scans as videos alongside the acquisition of 2D images, it can be leveraged for data-hungry self-supervision methods and thus can be utilised on private data available at healthcare facilities to create/improve AI systems.\nIn this work, we aim to clarify the following two questions regarding the dual-encoder SSL methods. How does SSL pretraining on US video data impact downstream SFCP classification with limited labelled data? Which SSL method is effective in utilizing US video data?\nWe believe that answering these questions will facilitate practical decision-making in a broad scope and easier adoption of leveraging real-world healthcare data instead of relying on complex engineering techniques to achieve good performance. This work does not intend to provide a new technical addition to the deep learning community. The research contribution of this work is to provide a thorough analysis of a set of well-established SSL methods, that strictly do not require labelled data, for the problem of fetal US image classification. We con-"}, {"title": "2 Related Work", "content": "SSL methods have been explored for utilizing fetal US videos with pretext tasks such as correcting reordered frames and predicting geometric transformations [14] or restoring altered images [4] to learn transferable representations for downstream tasks. More recently, SSL has moved towards dual-encoder architectures [1,5,10,11,26](similar to siamese network) which rely on the distribution of data itself to learn meaningful representations rather than crafting pretext tasks that suit specific problems/data of interest. This line of SSL methods has not gained much focus for applications utilizing US video. A comprehensive survey by Fiorentino et al. [8] studies DL methods in fetal sonography and highlights recent trends and challenges. This shows a gap in the adoption of SSL, especially dual-encoder methods for US videos. Benchmark analysis by Taher et al. [13] shows the effective transferability of self-supervised pretraining over supervised pretraining using ImageNet [7] dataset for a variety of medical imaging tasks.\nThe work by Fu et al. [9] incorporates a contrastive SSL approach with anatomical information by utilising labels. Zhang et al. [27] proposed hierarchical semantic level alignments for US videos using contrastive learning with labels through a smoothing strategy to improve the transferability. Different from these works, our study focuses on leveraging medical data itself i.e. US scan videos for SSL with no annotation information. A survey by Schiappa et al. [20] provides a detailed review and comparison of SSL techniques including dual-encoder using contrastive methods in the natural video domain."}, {"title": "3 Methodology", "content": "We perform our experiments on a large private fetal US scan data. This dataset consists of two modalities, labelled images of SFP and unlabelled videos (mainly SFCP and a few other views) collected from pregnant patients during their second trimester screening. The data is gathered over one calendar year and across different machine types (Voluson E8/E10/P8/S10-Expert/V830). For classification (Cls), we use four classes corresponding to the following standard cardiac planes: 3 Vessels View/3 Vessels Trachea view (3VV/3VT), 4 Chamber view (4CH), Left Ventricular Outflow Tract view (LVOT), and Right Ventricular Outflow Tract view (RVOT) and sample few non-heart SFP and create a 5th class corresponding to a non-heart view. The datasets are split at the patient level to avoid any information leakage about the classification test set, even patients"}, {"title": "3.2 Self-Supervision Procedure", "content": "To study the benefits of various SSL methods adopted for pretraining, we select methods belonging to different strategies\n(a) Reconstruction - AutoEncoder [16], Inpainting [18]\n(b) Contrastive Loss - SimCLR-v2 [5], MoCo-v2 [11]\n(c) Distillation-based - BYOL [10]\n(d) Information theory - VICReg [1], BarlowTwins [26]\nThese methods do not explicitly require labelled data which is a critical consideration as we use unlabelled scan videos. We use ResNet-50 as the backbone network along with the appropriate projector network as mentioned in the literature for each dual-encoder method and a convolutional decoder network to output an image plane for reconstruction methods.\nWeight initialisation: We study the effect of weight initialisation on SSL training by comparing ImageNet classification pretrained weights and random weights initialisation, both as available in PyTorch.\nHyperparameters: We follow optimal hyperparameters, optimizer settings,"}, {"title": "3.3 Classification Procedure", "content": "We use a network initialised with different SSL pretrained weights (SSL-weight) as the feature extractor and attach a linear classifier layer on top to train for"}, {"title": "4 Results and Discussions", "content": "How do SSL pretrained models perform on different data sizes? Under full fine-tuning, the SSL pretrained weights (SSL-weight) perform better than the de facto ImageNet initialisation when the annotated data size is low. But as the annotated data size increases, the gains diminish and for 100% of the data to fine-tune on, the difference becomes marginal. Even randomly initialised weights for classification show comparable results in larger data setting. F1-Scores for different SSL-weights across different data sizes are shown in Figure 1.\nSince we train SSL on video data and train the downstream classification on a different set of 2D image data, the aforementioned observation could be because of the following reasons: (a) the data available for SSL training is not very representative of the entire distribution which can lead to limited generalisation, or (b) gain of transfer learning diminishes as the amount of labelled data"}, {"title": "5 Conclusion", "content": "In this work, we conduct extensive experimentation to understand the behaviour of various SSL methods in utilising fetal US scan videos. Specifically, we study their empirical value in Cardiac Planes (SFCP) classification under real-world medical constraints. Our observations show that SSL methods give a boost in performance under limited annotated data. We found that BarlowTwins is most robust to variations in data distribution/size and training settings and gives consistent performance. In the scope of this study, we do not consider different backbones or methods that leverage label information during SSL training, since our motive is to evaluate the utility of SSL methods requiring no labels. However, our findings could be further extended with different backbones or methods leveraging labels during SSL training. We believe that our findings will lay a firm foundation for future works focused on recent forms of SSL methods for the US domain, especially in leveraging video data."}]}