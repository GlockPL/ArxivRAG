{"title": "Brain Age Estimation with a Greedy Dual-Stream Model for Limited Datasets", "authors": ["Iman Kianian", "Hedieh Sajedi"], "abstract": "Brain age estimation involves predicting an individual's biological age from their brain images, which\noffers valuable insights into the aging process and the progression of neurodegenerative diseases.\nConducting large-scale datasets for medical image analysis is a challenging and time-consuming task.\nExisting approaches mostly depend on large datasets, which are hard to come by and expensive. These\napproaches also require sophisticated, resource-intensive models with a large number of parameters,\nnecessitating a considerable amount of processing power. As a result, there is a vital need to develop\ninnovative methods that can achieve robust performance with limited datasets and efficient use of\ncomputational resources. This paper proposes a novel slice-based dual-stream method called GDSM\n(Greedy Dual-Stream Model) for brain age estimation. This method addresses the limitations of large\ndataset requirements and computational resource intensiveness. The proposed method incorporates local\nand global aspects of the brain, thereby refining the focus on specific target regions. The approach employs\nfour backbones to predict ages based on local and global features, complemented by a final model for age\ncorrection. Our method demonstrates a Mean Absolute Error (MAE) of 3.25 years on the IBID's test set,\nwhich only contains 289 subjects. To demonstrate the robustness of our approach for any small dataset, we\nanalyzed the proposed method with the IXI dataset and achieved an MAE of 4.18 years on the IXI's test\nset. By leveraging dual-stream and greedy strategies, this approach achieves efficiency and robust\nperformance, making it comparable with other state-of-the-art methods. The code for the GDSM model is\navailable at https://github.com/iman2693/GDSM.", "sections": [{"title": "Introduction", "content": "Brain ageing refers to the gradual changes in the brain's structure and functionality as an individual ages\n[1, 2]. These changes can include decreased brain volume, changes in neurotransmitter levels, and changes\nin cerebral blood flow [3]. Cognitive abilities may also deteriorate as people age. However, everyone ages\ndifferently, and these changes can be influenced by genetics, lifestyle, and general health. Maintaining a\nhealthy lifestyle, exercising regularly, and controlling risk factors can help promote healthy brain ageing\nand potentially slow cognitive loss [4]. Regular medical examinations and cognitive evaluations can help\ndetect serious brain health issues [5].\nBrain age estimation is a computational method using neuroimaging and machine learning algorithms\n[6, 7] to determine an individual's biological age based on structural and functional brain traits [8]. This\nmethod offers insights into brain ageing, early detection of neurodegenerative diseases, and personalized\ncognitive well-being interventions [9]. It also contributes to understanding individual variances in brain\nhealth and age-related changes [10]. The term 'brain age gap' denotes the discrepancy between a person's\nestimated brain age and their chronological age [1, 11]. A positive gap indicates a faster aging process,\npotentially indicating cognitive decline or a higher risk of age-related illnesses like dementia and\nAlzheimer's disease [1, 12]. Conversely, a negative gap suggests a slower aging process and increased\ncognitive resilience [12]. Detecting a positive gap can help identify and prevent age-related disorders,\nenabling healthcare professionals to implement preventive measures and personalized interventions [11,\n13]. Conversely, a negative gap may indicate resilience in the aging process, allowing for strategies to\nimprove cognitive well-being and potentially reduce neurological disorders [14]. Understanding and\nleveraging the brain age gap can lead to more effective disease prediction, intervention, and personalized\nhealthcare approaches.\nBrain age estimation is a complex process that involves various methods, including EEG\n(Electroencephalography) signals [15] and MRI (Magnetic Resonance Imaging) images [16, 17]. MRI\noffers high-resolution structural and functional information, making it a preferred choice for accurate age\nprediction. The use of MRI dates back to the early 2000s when researchers applied machine learning\ntechniques to neuroimaging data [18]. The basic methods involve extracting structural and functional\nfeatures from the brain, such as gray matter volume and white matter integrity [19], and feeding these into\nmachine learning algorithms trained on known chronological ages. However, these methods may not\ncapture the intricate details of brain images effectively. The introduction of Convolutional Neural Network\n(CNN) models has significantly improved the power of feature extraction, allowing CNNs to capture spatial\npatterns and relationships within neuroimaging data, enhancing the model's ability to extract relevant\nfeatures from MRI images [8]. This has led to improved accuracy and robustness in predicting brain age,\nproviding more nuanced insights into age-related changes in the brain.\nFurther pushing the boundaries of neuroimaging research, Transformer models, originally designed for\nnatural language processing [20], are being used in neuroimaging to improve brain age estimation\ncapabilities [21, 22]. These models can learn complex relationships between brain regions and their\ndynamic interactions over time, providing a more comprehensive understanding of the aging process. The\nself-attention mechanism in transformers allows for effective modeling of local and global spatial\ndependencies in brain images, potentially leading to more accurate diagnostics and tailored interventions\nfor age-related neurological conditions.\nHowever, Complex models like deep 3D CNNs or transformers on small datasets can lead to overfitting\nissues, while simpler machine learning approaches may result in underfitting. To avoid these issues, a\nbalance must be struck between harnessing the power of CNNs or transformers while mitigating overfitting\nrisks, especially in limited data availability [23]. This ensures the model captures important features without\nsuccumbing to the limitations of a small dataset, enhancing performance on diverse and unseen data points.\nIn medical imaging tasks like brain age estimation, models must navigate data scarcity while maintaining\nhigh performance.\nIn this study, we designed two experiments to show that the proposed approach is robust to the small\ndatasets. Furthermore, these experiments show that the proposed approach can be used for the large-scale\ndatasets too. The main characteristics of our proposed method are as follows:"}, {"title": "Robustness to Small Size Datasets", "content": "This paper presents a method for estimating brain age using two small datasets, 289 and 580 samples.\nThe architecture is designed to handle limited datasets, making it effective in 3D medical images like MRI\nor CT. The design considers the three-plane nature of these images, enhancing its applicability and\nperformance. The method also proposes a slice-based 2D CNN divide and conquer method to address data\nleakage."}, {"title": "Performance on Extended Datasets", "content": "The proposed method, designed for small datasets, shows increased efficacy as the dataset size increases.\nExperiments show the model's performance remains robust and significantly improves as the dataset grows,\nhighlighting its scalability and versatility. This makes it a flexible solution capable of delivering exceptional\nperformance across diverse dataset sizes."}, {"title": "Scalability of the Model", "content": "Our proposed approach incorporates custom backbone structures that are designed to fit the unique\ncharacteristics and scale of our dataset. The model's inherent adaptability allows for easy adjustments to\naccommodate variations in dataset size, thanks to its componentized nature, which allows for seamless\ntransitions between smaller and larger backbones."}, {"title": "Parallelization of the Model", "content": "The proposed network introduces a parallelized architecture, deviating from the traditional hierarchical\napproach, to enhance efficiency and performance by enabling parallel processing of different components.\nThis approach, due to effective componentization, makes parallelization a feasible strategy for concurrent\ncomputations, potentially improving the model's overall performance."}, {"title": "Employment of Several 2D CNNs for Age Prediction", "content": "The brain structure can be modeled using voxel-based or slice-based approaches. 3D CNNs are\ncommonly used for modeling the entire brain voxel, but this method has challenges due to extensive\nparameters and the lack of suitable pre-trained deep 3D CNN models for smaller or medium-sized datasets.\nTo address these issues, a different strategy is proposed: using 2D CNNs for slice processing instead of\nprocessing the entire voxel simultaneously. This approach incorporates information from all relevant slices\nof the entire brain, including the axial, coronal, and sagittal planes, by deciding for each part of the brain\nsimultaneously and integrating predictions."}, {"title": "Related Works", "content": "The approaches in brain age estimation can be categorized into three distinct groups called voxel-based\nand slice-based [6] and region-wise based approaches. An overview of a way of categorization of these\napproaches is shown Figure 1. The following subsections are about these three types of approaches and are"}, {"title": "Voxel-Based Approaches", "content": "The first group of the approaches is related to the voxel-based method which uses whole 3D MRI volume\nfor modeling. In most of the proposed approaches in this field, the 3D learnable models were used for\nbackbones, and there were usually multi-site large-scale datasets because 3D models have a massive\nparameter size and need large-scale datasets. In the remaining part of this section some different methods\nin this area will be discussed."}, {"title": "Utilizing Lightweight Networks", "content": "The earliest tries in this area used a lightweight network with a small number of layers. As an earliest\nexamples, Cole et al. [24] proposed a method which firstly gathered White Matter (WM) and Gray Matter\n(GM) of the brain using SPM12 toolbox and then trained a 3D CNN and demonstrated that GM is better\nthan WM in the brain age estimation. As a drawback, the model is complex and training of it is time-\nconsuming even with a small dataset. In a similar work, Wang et al. [25] segmented WM, GM and\nCerebrospinal Fluid (CSF) before architecting model. They used GM for the training of proposed 3D CNN\nmodel. In another work, Pardakhti et al. [26] used a 3D CNN followed by a support vector regression (SVR)\nmodel and Gaussian process regression (GPR). This study is one of the studies which used only the healthy\nsubjects from IXI dataset. In addition, Hong et al. [27] proposed a 3D CNN network for the brain age\nestimation in children. They also tested 2D CNNs and demonstrated 3D CNNs' performance is better. In\nall of the presented works, although the authors tried to propose a neural network which can model brain\naging, they posed to problems: (1) The trainable parameters of the models are too much and the\ncomputational complexity is too high. (2) They could not use a deep 3D CNN network because of the\nproblem of overfitting. So, they could not extract high-level features from the brain voxels."}, {"title": "Utilizing Deeper 3D CNN Networks", "content": "Besides simple 3D CNN architecture, 3D versions of other CNN networks such as VGG, Resnet, etc.\nwidely used for brain age estimation. These networks are often expected to perform better than previous\nnetworks due to the optimized design. For example, Feng et al. [9], used 5 layers of 3D VGGNet model.\nSome other works used an ResNet as their model to address age estimation problem. In another work, Jiang\net al. [28] segmented MRI images with a reference map into 7 regions. Each segmented areas fed to a 3D\nVGGNet for the purpose of age estimation. In another endeavor, Dinsdale et al. [29] used 3D VGGNet for\nbrain age estimation on a dataset containing 12,802 structural MRI images from the UK Biobank. The\ncomputational complexity of this work is significant and needs much time and resources. Similarly, Peng\net al. [30] proposed a simple fully-connected convolutional network similar to VGGNet model. Some\ndetails such as dropout, voxel shifting and mirroring. There are some other similar endeavors. For example,\nWood et al. [31] and Lee et al. [32] proposed two 3D DenseNet-based models for the brain age prediction.\nBesides, Fisch et al. [33] presented a 3D CNN network with two ResNet-based layers and a basic CNN\nblock and only T1-weighted pictures were employed."}, {"title": "Ensemble Methods", "content": "The aforementioned methods employed a singular estimator for each individual subject. To enhance\nmethod reliability, some approaches opted for a multi-estimator setup for a single voxel. Although this\nmethod led to enhanced outcomes, it also resulted in a rise in computational complexity. The primary\nchallenges in these approaches revolve around model selection and the integration of model results to\naccurately predict the final age. There are several studies which used ensemble voxel-based techniques. For\ninstance, Kuo et al. [34] presented a sophisticated ensemble approach comprising a model composed of 26\nlayers of 3D ResNet. Their ensemble strategy encompassed five distinct methods, ending with the use of"}, {"title": "Incorporating Multiple Modalities and Segmentation", "content": "Despite the various ensemble methods discussed earlier, some approaches differ by incorporating\nmultiple modalities or breaking down one subject's voxel into various segments. While both are sometimes\ncategorized as ensemble methods, a clear distinction exists between them. Ensemble methods typically\ninvolve inputting a sample into different models and aggregating their predictions. On the contrary, the\nfollowing studies entail dividing each sample's image into several distinct parts and employing multiple\nmodels for each segment. For instance, in a study by Jonsson et al. [37], more than one modality was\nutilized. The researchers used WM, GM, Original T1-weighted, and Jacobian map as inputs for multiple\n3D ResNet models. In this research, additional information such as scanner details and gender were fed into\nthe last layers of the fully connected neural network (FCNN) to enhance overall performance. In another\npaper, Hofmann et al. [38] proposed a multi-level ensemble on three different modalities such as T1\nweighted, FLAIR, and Susceptibility Weighted Imaging (SWI). The model architecture was relied on 3D\nCNNs and used linear head model for integrating the results. Similarly in another approach Mouches et al.\n[39] proposed a two-stream 3D CNN model. In the first stream, they used T1-weighted images and in the\nsecond stream, the TOF MRA scans were used as the input. Finally, they applied a linear regression model\nfor the integration of results derived from the two streams.\nSome other works used local chunks for brain age estimation. Local chunks for brain age estimation\nreduce complexity and aid in ROI identification by reducing image dimensions and utilizing aging-\ninfluenced parts. For example, Popescu et al. [40] used a 3D U-Net based model which used local parts of\nbrain as input and Bintsi et al. [17] used 3D patches of the brain and 3D ResNet networks for model brain\nage estimation. This work used Linear Regression and bias correction for the last stage of processing the\npredicted ages. Using bias correction was a good idea to correct the first predicted ages. Similarly,\nKolbeinsson et al. [41] used a 3D ResNet model which input six local parts of the brain including left\namygdala, left cerebellar, left insular cortex and the left crus, right hippocampus, and vermis. The other\nfactor which affected by brain aging also assessed. As one of the most recent works, Poloni et al. [42]\nintroduced a novel brain age estimation model comprising two 3D CNN models based on EfficientNet. The\ninput images were 3D voxels of the brain's right and left hippocampus parts. They averaged the results of\ntwo networks to calculate the final predicted age.\nBeyond the previous research, Numerous studies have focused on the influence of aging on different\nparts of the brain. For instance, several studies used the right and left hippocampus parts of the brain for\nbrain age estimation [21, 41-45]. These papers analyzed different parts of the brain and demonstrated that\nthe hippocampal region is affected by aging more than others or used the hippocampus region for their\ndownstream classification or regression tasks. The papers under consideration highlight additional brain\nregions, including the Frontal and Prefrontal Cortex [21, 45], Frontal Operculum [21], Parietal Lateral [21,\n45], GM [21, 45], WM [21, 45], CSF [21], and various other regions. These investigations establish\ncorrelations between age progression and volumetric alterations in specific brain regions."}, {"title": "Transformer based approaches", "content": "In the recent years, most of the works used a complex model for the brain age estimation such as vision\ntransformers and attention mechanisms. Transformers were first used for Natural Language Processing"}, {"title": "Slice-Based Approaches", "content": "Concerning problems of voxel-based approaches, using slice-based approaches can be useful to address\nmentioned problems like problems in the complexity of voxel-based approaches [53]. Several works used\n2D models to address brain age estimation such as [51, 54-61]. The slice-based approaches can be\ncategorized into several distinct groups in the following parts."}, {"title": "Simple and Deep 2D CNN Models", "content": "Like the voxel-based section, we start the slice-based model with simple 2D CNN models. As the first\nexample in this area, Huang et al. [54] introduced a 2D CNN network built upon VGGNet. Their approach\ninvolved utilizing 15 slices, resulting in initial layers with a channel size of 15. However, a limitation arose\nas they employed 2D slices from 3D voxels without implementing adequate pre-processing steps, hindering\nthe attainment of optimal results. Additionally, the study lacked the reporting of results from other models.\nIn another work, Shi et al. [55] proposed a slice-based 2D ResNet that trained on T2-weighted images to\nestimate the ages of fetal. They also used attention for gathering feature map in the last step of the proposed\nnetwork. In another vein, Dular et al. [56] used four 2D CNN approach with transfer learning, domain\nadaptation, and bias correction. In three models they used slices of all 3D voxel for training the models and\nin one of them they used only 15 axial slices for modeling. While these endeavors aimed to tackle the\nchallenges posed by limited resources and datasets, they fall short in capturing essential between-slices\ninformation. This information, distinct from the spatial details captured by 2D CNNs, eludes their grasp,\nhighlighting a gap in their capability to incorporate such crucial data. Some papers proposed a solution for\nthis problem of 2D CNNs. As an example, Lam et al. [51] proposed a model which inputs sequence of\nslices and encode them using a 2D CNN model. The result feature maps fed to a LSTM model for generating\nage embedding. They finally applied a linear regression on age embedding to generate final age. Similarly,\nLin et al. [57] proposed a 2D AlexNet for the feature extraction of GM part of MRI images and then used\nprincipal component analysis (PCA) for feature extraction and finally applied relevance vector machine\n(RVM) with polynomial kernel as the estimator. In another novel method, Gupta et al. [58] developed a\ntwo-component architecture for MRI scans. The first part encodes each 2D slice of an MRI scan, and the\nsecond aggregates these encodings. The encoded slices are then processed by an attention-based module\nand directed to fully connected layers for the final estimation. This architecture is claimed to be more\nefficient and accurate than conventional 3D-CNN models. In another work, For example, Pilli et al. [61]\nfirst segmented voxels into WM, GM and CSF tissues. Then they extracted 2D slices from 3D voxels based\non entropy. In the final stage of data preprocessing, they used a Generative Adversarial Network (GAN) as\na data augmenter. For the modeling they used a ResNet-50."}, {"title": "Ensemble-Like Slice-Based Models", "content": "Beside of mentioned approaches, many studies in the slice-based domain, often referred to as ensemble\nmethods by some, may not strictly qualify as ensembles. Instead, they employ various models to process\ndistinct slices, planes, or local patches. For example, Ballester et al. [59] presented a slice-based multi-\nregressor model incorporating linear regression and CNNs to estimate brain age. The approach involved\nemploying three distinct streams to process age estimation. Each stream was specifically dedicated to a\nparticular plane, and slices from that plane were input into the respective network. Within each stream, the\nassociated slices were fed into the network, and age predictions were made for each slice. The predicted\nages from all slices were then integrated using three linear regression models, and the average of the three\nresults was considered as the final predicted age. As another endeavor, Hwang et al. [60] used a 2D CNN\nfor the brain age estimation which inputs multiple slices from MRI voxels. They calculated ages with\nseveral slices and then averaged the results. The drawback of this method is that all slices are not influential\nfor the brain age estimation as equal proportion."}, {"title": "Transformer based approaches", "content": "Like the transformer-based section in voxel-based approaches, there are some papers which used the 2D\nslices as the input of their model and used transformers in one part of their architecture. As the only example\nin this part, Sheng He et al. [21] proposed a model that captures both local and global features of the brain\nusing two pathways. The information of local and global parts is integrated using a global-local transformer.\nAlthough the computational complexity is reduced compared to similar transformer-based approaches in\n3D voxels, there is also a need for high computational resources and big datasets for training these models.\nWhile slice-based approaches may offer advantages over voxel-based methods when faced with data\nand resource limitations, there are inherent challenges associated with their use. A primary concern with\nslice-based models is the potential omission of critical information between different slices or planes, a\ndrawback that voxel-based approaches excel in addressing. If the selected slices comprehensively cover"}, {"title": "Region-wise Approaches", "content": "In previous sections, the voxel-based and slice-based approaches were thoroughly analyzed, and some\nworks in each area were reviewed. As mentioned, there is another method of using MRIs for the task of\nbrain age estimation, known as region-wise approaches. In region-wise approaches, before the learning\nphase, some preprocessing steps are performed to gather the volume of each brain part. The region-wise\napproach is fundamentally different from the voxel-based and slice-based approaches. Instead of\nconsidering the brain as a whole or in slices, this method focuses on specific regions of the brain. These\nregions are identified based on their anatomical or functional significance in the context of brain aging. The\npreprocessing steps involve segmenting the brain MRI into different regions using various techniques such\nas atlas-based or learning-based methods. The volume of each region is then calculated. This data forms\nthe basis for the learning phase. In the learning phase, machine learning algorithms are used to establish a\nrelationship between the volumes of the different brain regions and the age of the individual. The model\nthus developed can then be used to estimate the brain age of a new individual given their brain MRI. In this\nstudy, only a limited number of approaches in this area were analyzed, which did not technically use\ncomputer vision techniques. For example, Ahmed et al. [62] first gathered region-wise features and then\nused some traditional models such as Support Vector Regression (SVR) and Linear Regression for\nmodeling brain age. In another work, Beheshti et al. [63] proposed an algorithm in which voxel-wise and\nregion-wise features were calculated by SPM12 and FreeSurfer toolkits. They finally used the integration\nof gray matter voxel-wise maps and all region-wise metrics for feeding to an SVR model."}, {"title": "Material and Methodology", "content": "An overview of the proposed model is depicted in Figure 3. As discussed, the model is justified for small\ndatasets. The model contains three main components. The local stream predicts ages using the local parts\nof the brain in different planes and slices. There is also a global component that predicts ages using different\nslices from each of the three planes. These predicted ages from the global and local streams, along with the\nreference images, are fed into an age correction component. This component takes the predicted ages and\ntries to enhance the predictions to achieve a better result. This model operates similarly to the global\ncomponent, with the difference being that it accepts predicted ages as input."}, {"title": "Data Preprocessing", "content": "Data preprocessing is an essential phase in the process of estimating brain age using MRI. It involves\nrefining raw MRI data for use in computational age prediction models. This study, like many advanced\napproaches, uses several preprocessing stages to prepare MRI voxels for model input.\nThe first step in preprocessing MRI data for brain age estimation is to remove non-relevant elements,\nsuch as the skull and surrounding areas, from the original T1-weighted MRI voxels. This is achieved using\nthe SynthStrip [64] model, a U-Net-based deep neural network that was trained on a large dataset to mask\nthe brain tissue. SynthStrip has shown superior performance and better generalization ability across\ndifferent image types and quality levels compared to other non-learning toolkits.\nThe second step in preprocessing MRI data is bias correction, which is essential for addressing signal\nvariations and non-uniformities in brain MRI. These irregularities, often due to factors like magnetic field\ninhomogeneities or radiofrequency coil sensitivity, can distort the data and impact the accuracy of further\nanalyses. Bias correction methods, like the N4 bias correction [65] used in this study, aim to normalize\nthese irregularities to ensure the MRI data accurately reflects the actual anatomical structures.\nThe T1-weighted images were registered to the MNI152 atlas using the flirt tool in FSL [66], with voxel\nsizes of 1\u00d71\u00d71mm and 2\u00d72\u00d72mm. This MRI registration process aligns images to a standardized template,\nreducing spatial variations for consistent comparisons. The final voxel sizes were 182\u00d7218\u00d7182px for 1mm\nand 91\u00d7109\u00d791px for 2mm.\nPatch-scale normalization is used to standardize the intensity values of each 2D training image, scaling\nthem between 0 and 255, and then dividing by 255. This ensures uniformity and addresses intensity\ninconsistencies. Manual validation is then performed to identify any potential artifacts or abnormalities in\nthe IBID dataset. However, despite identifying some issues, they are not removed due to the small size of\nthe dataset. Some of these problems can be shown in Figure 11."}, {"title": "Patch Selection", "content": "Patch selection in MRI images is crucial for estimating brain age, as it captures the structural\ntransformations associated with aging. MRI data provides detailed representations of the brain's intricacies,\nmaking it a valuable resource for age estimation. The process involves extracting specific regions or sub-\nregions from scans, focusing on areas susceptible to aging-related changes. This refines the model,\nsimplifies it, and enhances its ability to discern age-related patterns, facilitating generalization across\ndiverse datasets.\nThis study focuses on selecting specific regions of the brain, such as the hippocampus, frontal cortex,\nfrontal operculum, and parietal lateral, for the local stream of a network. Due to limited dataset availability,\nfindings from other investigations exploring the impact of age on various brain regions were utilized in this\nstudy. The relevant articles, benefiting from extensive and reliable datasets, yielded more precise\nconclusions. Therefore, specific points proposed in those studies have been incorporated into this research.\nMasks were created using MNI and Harvard Oxford atlases, segmenting brain tissue into specific regions.\nPatches were resized to 80 by 80 for consistency and divided into right and left halves due to their size. The\nfilling approach was bilinear interpolation. Figure 5 shows an overview of patch selection in this study.\nWhile the exploration of suitable local patches has been conducted in the context of brain age estimation\ntasks previously, delving into a novel area necessitates the assistance of interpretable models such as Grad-CAM [67]. These models can aid researchers in identifying regions of interest, providing valuable insights\nfor focused investigation."}, {"title": "Slice Selection", "content": "The importance of proper slice selection in MRI for accurate age estimation is emphasized. The choice\nof slices at different angles allows for a comprehensive evaluation of anatomical structures, enhancing the\nprecision of age estimation. Middle slices, which contain a high density of relevant information, are\nparticularly significant [21, 58]. Selecting middle slices can improve efficiency and potentially reduce strain\non medical resources. In this work, several slices around the center from each of the three planes - axial,\ncoronal, and sagittal were selected, while others were omitted. Due to the use of 1mm and 2mm\nregistration of MRI voxels in this study, slice selection varies for the local and global streams. Here is the\ndescription for slice selection for local and global stream respectively:\nFor the local stream, 1mm registration voxels are used due to the smaller sizes of local regions. This\nchoice, driven by the impact of image resolution on model performance, allows for effective analysis of\nintricate details within these regions, enhancing precision and overall performance. The slice selection for\neach plane in the local stream is detailed in Table 1.\nThe global stream is the second stream, where 2D slices are input without patch extraction. To avoid\noverfitting and reduce the input dimension, a 2mm registration is used for MRI voxels. As mentioned, the\ndimensions of these registered T1-weighted images are 91\u00d7109\u00d791 pixels. The slices around the center,\nwhich are more informative and provide clearer details of brain tissue, are chosen. The selected slices are\ndetailed in Table 2."}, {"title": "Data Augmentation", "content": "Data augmentation, a technique that applies various transformations to original medical images, plays a\npivotal role in enhancing machine-learning models. It artificially enriches the training dataset, thereby\nimproving model performance. However, it requires domain-specific strategies to ensure the clinical\nrelevance of augmented data and to maintain patient data privacy. In this study, we employed a specific\naugmentation setting for each patch and slice. In the local stream, after the production of each patch in the\ntraining dataset preprocessing, augmentation was performed using a random count between 0 and 6. For\nthe global stream, each slice was augmented with a factor, a random number between 0 and 10. Our\naugmentation setting, inspired by [42], is detailed in Table 3. Additionally, Figure 6 showcases examples\nof local and global data augmentation. This approach not only enhances the diversity of our dataset but also\nensures the integrity of sensitive medical information."}, {"title": "Model Architecture", "content": "As previously described, we propose an architecture that comprises multiple modules and some details.\nAs shown in Figure 3, three main components in this architecture will be explained in detail. These three\ncomponents are the local stream, the global stream, and the Age Correction component. Initially, an MRI\nvoxel is registered with a 2mm and 1mm registration process. The 1mm registered weighted-T1 images are\nfed to the local stream, which derives 469 ages per subject. Simultaneously, the global 2mm 2D slices are\nfed to the global stream to extract the relevant ages. The global stream also outputs 80 predictions for\ndifferent slices and planes (20 for axial, 30 for coronal, and 30 for sagittal). The culmination of predictions\nfrom both streams forms the basis for the final predicted age. Prior to this integration, a distinct component\nfor predicted age correction was introduced. This component utilizes the predicted ages from the local and\nglobal streams to estimate new ages relevant to the subjects' brain images. In the following subsections, the\nindependent streams used in the architecture will be described in detail."}, {"title": "Local Stream", "content": "The architecture of the proposed local stream is shown in\nFigure 7. As mentioned in the previous section, the local black box inputs local patches of the brain,\nwhich are extracted from MRI voxels by the MNI and Harvard Oxford atlases. The output of this black box\nis a vector of predicted ages with a size of 469\u00d71. In the black box of the local stream, there are three\nseparate pathways for each plane. The local patches for each plane are fed to the corresponding pathway.\nFor example, the left hippocampus of a slice in the axial plane is given to the local pathway for the axial\nplane. The reason for using three pathways in the local stream is the high number of variations that the local\nparts have in each plane. According to Table 1, eight regions have been chosen for local processing. These\neight regions for each plane can create a diversity that is hard for a 2D CNN model to handle and can affect\nperformance. Because of this, we decided to split these three pathways to help the models generalize and\nfind a template for aging more easily. Moreover, the number of local training images in all planes was"}, {"title": "Global Stream", "content": "The architecture of the proposed global stream is shown in\nFigure 7. Unlike the local stream, this stream has only one backbone. This backbone processes 2D slices\nof the whole brain from each of the three planes: axial, coronal, and sagittal. As shown in Table 2, there are\n80 2D images for each subject in total. The backbone processes all the 2D slices and extracts the feature\nmap for each of them. Finally, an FCNN is utilized to estimate the ages using these feature maps. In addition\nto the feature maps, the corresponding encoded labels for gender, slice number, and plane type, which\nindicate to which plane the slice belongs, are fed to the FCNN. Clearly, for each subject, the global stream\noutputs 80 results. Notably, the reason for considering one backbone for the global stream was the limitation\nin the dataset. In a small dataset, there are not enough independent slices and the slice numbers are limited.\nTherefore, having three independent backbones for each plane is not logical. However, in the case of having\na larger dataset, having three separate pathways is a good choice. The 2D CNN backbone used, which was\nalso pre-trained on the ImageNet dataset, was Xception. This can be changed in different situations\ndepending on the dataset size."}, {"title": "Age Correction Component", "content": "Enhancing the integration of predicted ages from local and global backbones is a crucial task that offers\nsignificant potential for performance enhancement. In this study, our approach involves the use of an age\ncorrection component"}]}