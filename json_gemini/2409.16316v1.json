{"title": "Surface solar radiation: AI satellite retrieval can outperform Heliosat and generalizes well to other climate zones", "authors": ["K. R. Schuurman", "A. Meyer"], "abstract": "Accurate estimates of surface solar irradiance (SSI) are essential for solar resource assessments and solar energy forecasts in grid integration and building control applications. SSI estimates for spatially extended regions can be retrieved from geostationary satellites such as Meteosat. Traditional SSI satellite retrievals like Heliosat rely on physical radiative transfer modelling. We introduce the first machine-learning-based satellite retrieval for instantaneous SSI and demonstrate its capability to provide accurate and generalizable SSI estimates across Europe. Our deep learning retrieval provides near real-time SSI estimates based on data-driven emulation of Heliosat and fine-tuning on pyranometer networks. By including SSI from ground stations, our SSI retrieval model can outperform Heliosat accuracy and generalize well to regions with other climates and surface albedos in cloudy conditions (clear-sky index < 0.8). We also show that the SSI retrieved from Heliosat exhibits large biases in mountain regions, and that training and fine-tuning our retrieval models on SSI data from ground stations strongly reduces these biases, outperforming Heliosat. Furthermore, we quantify the relative importance of the Meteosat channels and other predictor variables like solar zenith angle for the accuracy of our deep learning SSI retrieval model in different cloud conditions. We find that in cloudy conditions multiple near-infrared and infrared channels enhance the performance. Our results can facilitate the development of more accurate satellite retrieval models of surface solar irradiance.", "sections": [{"title": "1. Introduction", "content": "Surface radiation estimates are required in solar resource assessments [1, 2, 3], solar forecast models [4, 5] and climate studies. High temporal and spatial coverage and resolution are essential for forecasting solar radiation for minutes to hours ahead (solar nowcasting) across large regions. While plant-level forecasts often rely on ground-based sensors [6, 7, 8], forecasts across spatially extended regions require surface radiation retrieved from geostationary satellites [9, 5, 10, 11, 12, 13]. Grid operators and energy providers use solar nowcasts to anticipate volatile solar energy and ensure grid stability. The relation between surface solar irradiance (SSI) and top-of-atmosphere reflectances measured from geostationary satellites has been explored and leveraged for retrieving SSI estimates for more than five decades [14, 15]. Satellite retrievals of"}, {"title": "2. Previous work", "content": "SSI utilize top-of-atmosphere visible and infrared reflectances to estimate the amount of solar radiation that reaches the Earth's surface.\nData-driven solar retrieval models can outperform physical models for single ground stations [16]. Deep learning has enabled increases in SSI retrieval accuracy of up to 20% compared to state-of-the-art retrievals [17, 18, 19, 20]. Recent data-driven retrieval models have been trained on pyranometer ground stations with geostationarily measured radiances as predictors to retrieve SSI by either post-processing previous SSI retrievals [21, 22] or by directly estimating SSI retrievals for individual ground stations [20, 23, 16, 17, 22]. SSI retrievals are expected to not only achieve high accuracy and low biases within the geographic region of their training set ground stations but also well beyond. In particular, an SSI retrieval should also be accurate in regions with other surface albedos and other climates, which have not been included in the development of the SSI retrieval model (out-of-domain generalization) [22, 20, 23, 24]. Existing machine-learning based SSI retrievals were found to lack generalizability and to feature artefacts showing up in SSI estimates at locations outside their training set domains [20, 24].\nThe goal of our study is to develop a machine-learning-based SSI retrieval model that enables accurate generalizable SSI estimates across all of Europe and North Africa at low retrieval latency time. We aim to go beyond previous work by providing an accurate data-driven satellite retrieval of instantaneous SSI that can generalize to unseen locations beyond the training set region. Our study provides the first machine learning satellite retrieval of instantaneous SSI, to our knowledge. Instantaneous SSI estimates are highly relevant for estimating and forecasting SSI at intra-hour and intra-day time scales. We achieve improved generalizability by emulating a radiative-transfer-based SSI retrieval algorithm and fine-tuning it on ground station measurements. SSI retrieval emulation involves the application of SSI fields, in our case from Heliosat, as target variables in the emulator training. Emulation is also commonly referred to as surrogate modelling.\nThe structure of this paper is outlined as follows. Section 2 reviews existing SSI retrieval methods. Section 3 introduces the datasets utilized in this study. The deep learning SSI retrieval and its development are detailed in section 4. Results of this study are discussed in section 5 and conclusions are provided in section 6.\nOne of the first SSI satellite retrieval algorithms, Heliosat-1, included an empirical formula to calculate SSI [25]. An empirical clear-sky model estimated SSI in the absence of clouds and assuming a given atmospheric composition. The transmissivity of the clouds was then estimated by the ratio between top-of-atmosphere reflectivity measured and the minimum reflectivity over a month for cloud-free skies. The clear-sky reflectance mainly depends on the local solar zenith angle (SZA) and the surface albedo at the monitored site. Reliable surface albedo estimates are considered essential for accurate SSI retrievals [26]. Current state-of-the-art surface solar irradiance retrieval algorithms, such as CAMS [27], SARAH-3 [28], MSG-CPP [29, 30], and SolarGIS [31], use a combination of radiative transfer model (RTM) and the clear-sky index (CSI) to estimate SSI. The CSI is defined as the ratio between all-sky SSI and clear-sky SSI,\n$\\mathrm{CSI}=\\frac{\\mathrm{SSI}_{\\text {all-sky }}}{\\mathrm{SSI}_{\\text {clear-sky }}}$\nwhere the clear-sky SSI is calculated using a clear-sky RTM. The latter performs corrections to the clear-sky SSI due to attenuation from aerosols and trace gases. CAMS, SARAH-3 and MSG-CPP apply a cloudy-sky RTM to extract all-sky SSI based on cloud optical properties. RTM simulations are computationally expensive, so all three methods utilize look-up"}, {"title": "3. Data", "content": "3.1. Meteosat\nVisible and infrared radiances from Earth that are measured by geostationary satellites provide the basis of SSI retrieval products. The Meteosat Second Generation (MSG) satellite at 0\u00b0 E, 0\u00b0 N is monitoring the regions of interest in our study - Europe and North Africa \u2013 with the Spinning Enhanced Visible and Infrared Imager (SEVIRI) that scans from East to West by rotating its sensor's view. After each rotation, the sensor resets and scans the next line from North to South. One line scan is close to an instantaneous capture of longitudinal pixels, but individual scan lines have a delay associated with them, so an entire scan of the satellite's disk takes approximately 12 minutes [35]. The ground resolution of the sensor is 3x3 km at nadir. All eleven visible and infrared channels are included as input to the emulator model training. The purpose of the channels can be summarized as follows [35]: The visible bands VIS006 and VIS008 are crucial for cloud detection, tracking, aerosol and land surface/vegetation monitoring. The near-infrared channel 1.6 \u00b5m (IR016) helps distinguish snow from clouds and ice from water clouds, and provides information on aerosols. Infrared 3.9 \u00b5m (IR039) primarily helps detect low clouds and fog, measure land/sea surface temperatures at night, and enhance low-level wind coverage through cloud tracking. The water vapor bands 6.2\u00b5m and 7.3 \u00b5m (WV062, WV073) are meant for water vapor observation, using two channels at different tropospheric levels, aiding in thin cloud height allocation. Band 8.7 \u00b5m (IR087) provides data on thin cirrus clouds and helps differentiate between ice and water clouds. Band 9.7 \u00b5m (IR097) is utilized for tracking ozone patterns and contributing to numerical weather prediction by monitoring the total ozone field. Infrared 10.8 \u00b5m and 12.0 \u00b5m (IR108, IR120) are split window channels essential for measuring sea/land surface and cloud-top temperatures, and detecting cirrus and volcanic ash clouds. The last band 13.4 \u00b5m (IR134) is a CO2 absorption channel and improves the height allocation of cirrus clouds.\n3.2. Heliosat\nHeliosat SARAH-3 Pfeifroth et al. [28] provides Meteosat-derived estimates of surface solar irradiance and other atmospheric variables related to clouds and radiation. It spans Meteosat First Generation (1977-2017) and MSG (2002-present) satellite retrievals from their respective instruments MVIRI and SEVIRI. The MVIRI is the predecessor of SEVIRI. SARAH-3 employs only the visible channels to keep the SARAH-3 record homogeneous in time.\nThe SARAH-3 algorithm draws on the cloud index method of the original Heliosat-1 algo-rithm by Cano et al. [25] to derive an estimated effective cloud albedo CAL. The cloud index method calculates the ratio between measured broadband reflectance p, clear-sky reflectance $\\rho_{\\text {cls}}$ and maximum reflectance $\\rho_{\\max }$ as $\\text{CAL} = \\frac{\\rho - \\rho_{\\text {cls }}}{\\rho_{\\max } - \\rho_{\\text {cls }}}$. The clear-sky and maximum reflectance are estimated from the frequency distribution within a month, where the maximum reflectance is taken as the 95th quantile in the month and the clear-sky reflectance as a stationary variate of lowest p values. The lowest reflectance in the month is not taken as clear-sky reflectance due to cloud shadows which give low reflectance outliers in the tail of the distribution. The effective cloud albedo is converted to a cloud index with a smooth piecewise function defined in Dagestad [36]. The observed pixel-wise cloud index serves as input to a radiative transfer look-up table to retrieve SSI [32]. Instantaneous SSI from SARAH-3 is published with a two-week delay at a frequency of 30 minutes, so every second SEVIRI capture.\n3.3. Grid data preprocessing\nThe research domain of our study was selected as 29\u00b0 N-62\u00b0 N and 9\u00b0 W-28\u00b0 E to include most of Europe and parts of Northern Africa. Given the availability of high-quality measurements from IEA-PVPS in the years 2016-2022, we chose SARAH-3 and SEVIRI images from 2016 to 2023 for this study. The SEVIRI Level-1.5 data was acquired from the EUMETSAT datastore. We utilized eleven visible and infrared SEVIRI channels. The SEVIRI Level-1.5 data corresponds to image data that is corrected for unwanted radiometric and geometric effects. The Level-1.5 VIS006, VIS008, and IR016 reflectivity radiances were converted to bidirectional reflectance factor. The Level-1.5 emissivity radiances for channels IR039, WV062, WV073, IR087, IR097, IR108, IR120 and IR134 were converted to brightness temperature using the Satpy module [37]. The conversions homogenized the record between different MSG satellites and corrected the reflectivity channels for changing Sun-Earth distance. The images were reprojected to the geographic SARAH-3 grid with the nearest neighborhood interpolation.\n3.4. Ground stations\nOur SSI emulator models were validated on ground-based SSI sensors. Pyranometers measure the total amount of solar radiation from a half-dome in segments of one to ten minutes. These sparse ground observations represent only a single point in space whereas the SEVIRI imager measures an average reflectivity over a ground area of approximately 3x3 km. The ground station datasets for validating the SSI emulators are summarised in Table 1. They include SSI measurements from the Royal Netherlands Meteorological Institute (KNMI), the German Weather Service (DWD) and the Swiss Federal Office for Meteorology and Climatology (MeteoSwiss). Additionally, SSI measurements from the International Energy Agency Photovoltaic Power Systems Programme (IEA-PVPS) worldwide benchmark were gathered. They contain quality controlled SSI measurements from across Europe and North Africa [38]. The IEA-PVPS dataset comprises 14 stations from different operators. Six stations \u2013 CAB, CAR, CEN, PAL, PAY, and TOR - form part of the Baseline Surface Radiation Network (BSRN, [39]). Two stations \u2013 TAB and MIL \u2013 belong to the Centre for Energy, Environmental and Technological Research (CIEMAT) and Research on Energy Systems (RSE), respectively. The Swedish Meteorological and Hydrological Institute (SMHI) provided two additional stations, NOR and VIS. Finally, the EnerMENA project contributed four stations located in Northern Africa: GHA, MIS, OUJ, and TAT [40]. All stations of the IEA-PVPS dataset are equipped with three thermophile radiometers measuring SSI, direct normal irradiance and diffuse irradiance at 1-minute intervals [38]."}, {"title": "4. SSI retrieval model", "content": "We trained five retrieval models in total. All models were trained on the same predictors: The Meteosat visible and infrared channels and the above scalar variables. The models are: E) a model trained only on DWD ground station data as target variable (section 4.2); A) an emulator model trained on the Heliosat SARAH-3 SSI as surrogate (section 4.3); and B-D) Three fine-tuned models, which trained to emulate SARAH-3 first and then fine-tuned on ground station\n4.1. Architecture\nWe implemented a convolutional residual network (ConvResNet) similar to the one of Jiang et al. [23] with the following adjustments, as shown in Figure A.9 in the Appendix. We defined patches of 15x15 pixels so that the centre pixel corresponds to the retrieved SSI pixel using all 11 visible and infrared channels. Extra geographical information was given by the digital elevation model (DEM) from Copernicus GLO-90 [42] coarsened to the same grid. Channel features were extracted from the patches by the CNN. Further features included the day of the year, the latitude, longitude, solar zenith angle and solar azimuth angle and were appended to the channel features and fed through a two-layer fully-connected neural network (FCN). The first part of the CNN is the feature mapping part where the spatial size is kept constant within the first two convolutional mappings (Figure A.9). The second part consists of a 2x2 max pooling (MP) step to reduce spatial size followed by a convolutional residual block. The third part is the same where a 2x2 MP is followed by a convolutional residual block. The output of the CNN is first global average pooled (GAP) and then flattened to serve as input to the FCN. The kernel size in each\n4.2. Training on ground stations\nColocated samples in time and space were created between the ground station and images to train a retrieval model on ground stations. The IEA-PVPS ground observations were averaged to 10 minutes from the start of each nominal satellite capture time. For the ground observations from KNMI, DWD and MeteoSwiss which already measured 10-minute averages, the SEVIRI nominal capture times were matched with ground observation measurement start times. This meant that non-quarterly observation times at the 10/20/40/50 minute marks were disregarded. All available matching observations between 2016 and 2022 were used. Patches of 15x15 pixels with the center pixel overlapping the ground station were selected. Scalar input features latitude, longitude, SZA and AZI were calculated for the exact locations of the respective stations. The DWD stations were split randomly into 80 training and 19 validation stations. The density of the MeteoSwiss network is so high that we could afford to keep more validation stations than training stations and they were randomly split into 50 training and 85 validation stations. The KNMI stations were left out of training due to the lack of quality control. The station data were filtered for SZA<85\u00b0 to select daytime periods only. When training on ground stations, the samples of different sites were first merged and then randomly shuffled to ensure that training, validation and test sets have similar statistical characteristics. The model (E) was trained only on the DWD dataset for 15 epochs with a mean squared error loss with an Adam optimizer with weight decay [43].\n4.3. Emulator training on Heliosat\nThe emulator model (A) was trained on Heliosat SARAH-3 SSI. SARAH-3 provides SSI fields for every second capture of the SEVIRI imager. The SARAH-3 SSI as target variable and the SEVIRI images and scalar features (latitude, longitude, SZA, AZI, day of the year) as pre-dictor variables were merged at nominal capture time to form a dataset to train, validate and test our SSI emulator model. The scalar features were calculated at the center of each pixel. We split the SEVIRI images and SARAH-3 retrievals into training (years 2016\u20132021), validation (2022) and test set (2023). Daytime locations were defined as pixels where SZA < 85\u00b0. Images with less than 50% daytime pixels were dropped. The images were shuffled randomly for training. A sample consists of 15x15 patches of each grid input and the five scalar features from the center pixel. The inputs and outputs were min-max normalized for all training and fine-tuning steps. A training batch consisted of 2048 uniformly distributed samples per image. Only the daytime pixels were sampled from images containing both day- and nighttime pixels. A single epoch consisted of cycling through all images with 2048 samples per image. The network was trained for two epochs on a mean squared error loss with an Adam optimizer with weight decay [43]. The validation loss was monitored to prevent overfitting the training dataset. A learning rate of $10^{-4}$\n4.4. Fine-tuning on ground stations\nThe pre-trained emulator (A) was further fine-tuned on ground station data, yielding our three fine-tuned retrieval models (B-D). The fitted weights found in section 4.3, optimized to emulate Heliosat SARAH-3 SSI, were the starting point for fine-tuning the first retrieval model (B). Fine-tuning in machine learning is the process of adapting a pre-trained model to statistically similar but somewhat different target datasets and tasks. While, in principle, that somewhat different dataset could be directly trained on, training a large model from scratch on a comparatively small dataset, such as a ground station dataset, risks overfitting: the model might learn to perform well on the training examples but generalize poorly to new data and locations. In the context of SSI retrieval, the ground stations are available over a limited subregion while the Heliosat SARAH-3 SSI is available across the entire SEVIRI disk. Here, the goal of fine-tuning is to increase the SSI retrieval's precision to ground station measurements without becoming biased toward them.\nWe applied three techniques to prevent the fine-tuned emulator from overfitting the ground station observations. Firstly, the validation loss and bias on the original Heliosat SARAH-3 data were monitored every tenth of a training epoch. The frequency was adjusted depending on the number of samples in the fine-tuning set. Secondly, a proximal loss function for the weights was added, $L_{prox}(\\theta, \\theta_0) = =||\\theta-\\theta_0||^2$, which punishes the model for deviating from the weights learned in the previous domain. The $\\theta_0$ weights specify the best-fit model for the Heliosat SARAH-3 emulation task and $\\theta$ the weights after fine-tuning the task of estimating SSI for ground stations. The proximal loss intends to regularize overfitting on the ground observation constrained by the best-fit model for the emulation task (model B). Thirdly, the FCN part of the model was frozen, meaning the FCN weights were fixed for fine-tuning. This aims to keep the relationship between SZA and SSI stable because the SZA is only appended to the model inputs before the FCN.\nIn total, we trained three fine-tuned models (rows B, C and D in Table 2). To arrive at the first fine-tuned retrieval model (B), we fine-tuned the emulator on the DWD ground stations training set with a proximity loss (\u03b1 = 5000), a frozen FCN and a decreased learning rate lr = $10^{-6}$. In the second stage of fine-tuning, which yielded the second fine-tuned model (C), the previous model fine-tuned on DWD (B) was further fine-tuned on the MeteoSwiss training set with a higher proximity loss (\u03b1 = 10000), a frozen FCN and the same learning rate. In the last stage of fine-tuning, which yielded the third fine-tuned model (D), the model previously fine-tuned on DWD and MeteoSwiss ground stations (C) was further fine-tuned on the IEA-PVPS SSI measurements without a frozen FCN and with a smaller learning rate lr= $10^{-7}$. For each stage, the previous model weights were set as the \u03b80 in the proximity loss, as shown in column \"Weights \u03b80\" in Table 2. In the first two stages of fine-tuning, the validation loss and MBE per station on IEA-PVPS were monitored ten times per epoch to signalize a change in bias or overfitting to the stations on which the model was being fine-tuned. In the third stage, the validation loss and MBE on MeteoSwiss and DWD validation stations were monitored for the same reason. Each fine-tuning stage lasted at most two epochs on their respective training set or shorter when the model showed signs of overfitting or bias shifts."}, {"title": "5. Results and discussion", "content": "5.1. Characterisation of the SSI emulator\nThe emulator model trained in section 4.2 was compared to the Heliosat SARAH-3 SSI on the test set and to the ground stations SSI to characterise its performance. Root mean square deviation (RMSD) and mean bias deviation (MBD) were calculated pixel-wise and over daytime periods only. We found that the emulator follows the SARAH-3 SSI remarkably closely, as shown in Figures 3 and 4. It emulates SSI with high accuracy and with biases negligibly small for solar energy applications such as resource assessments and forecasting. Specifically, the emulator model has a small positive MBD of 10.2 W/m\u00b2 by somewhat overestimating low Heliosat SARAH-3 SSI values (Figure 3). The emulator generates an RMSD of 51.7 W/m\u00b2 with regard to the SARAH-3 SSI on the test set.\nThe RMSD with regard to SARAH-3 is the largest in mountainous regions such as the Alps, the Pyrenees, and the Scandinavian mountains, with RMSD values of up to 125 W/m\u00b2. Stations in mountainous regions tend to be affected by larger SSI retrieval uncertainties due to complex terrain, local clouds and snow cover [2]. Snow cover can be challenging to distinguish from clouds due to the similarity of visible reflectivity, which leads to underestimation when snow cover is mistaken for clouds [2]. Non-moving highly reflective pixels are flagged and treated either as fog or snow cover by Heliosat SARAH-3 [28]. This inadvertently can lead to the opposite problem of overestimating SSI where it accurately identifies snow cover but does not consider clouds covering a snowy region.\nDeviations with regard to Heliosat SSI are also somewhat elevated across North Africa with RMSD values of around 75 W/m\u00b2. The lowest regional RMSD of around 45 W/m\u00b2 can be found over large water bodies, such as the North Sea, the Atlantic and the Mediterranean Sea. The\n5.2. Retrieval over Europe\nFigure 2 illustrates differences and similarities across our five SSI retrieval models (Table 2) and Heliosat SARAH-3 on a randomly selected day and time. Overall, the five retrieval models mimic all cloud features seen in SARAH-3 at remarkable quality. When examining the retrievals closely, some differences become apparent. Firstly, the boundaries between clouds and clear-sky SSI tend to be somewhat sharper in SARAH-3 whereas the deep learning models exhibit moderate smoothing compared to SARAH-3. This may be attributed to the 16x16 pixel inputs which likely blend the SSI with neighboring pixel information. However, it is important to note that determining which level of smoothness is more accurate is challenging due to the absence of spatially extensive SSI measurements over large areas as ground truth.\nSecondly, both SARAH-3 and the emulator reveal a gradient from high SSI in the west to low SSI in the east in clear-sky regions. This gradient, which is caused by varying incident angles of sunlight, appears more gradual in SARAH-3 compared to our five data-driven models. For example, the emulator shows moderate deviations in this gradient over the Iberian Peninsula and Northern Africa, while models A and C-E display more pronounced deviations in the clear-sky gradient. We also note that the emulator-based models (A-D) appear to exibit fewer artefacts than the model trained on only ground stations (E) which features spatially correlated structures of excessive SSI in the Alps, across the Iberian peninsula and on the western parts of North Africa. These artefact structures appear to be correlated with orography.\n5.3. Validating SSI retrieval models on ground stations\nWe validated our SSI retrieval models on multiple ground station networks across Europe and North Africa. To compare the models to actual SSI measurements rather than Heliosat SSI, we investigated root mean square errors (RMSE) and mean bias errors (MBE) with regard to the ground stations. The RMSE and MBE were calculated as averages over all matched ground station measurements from 2016 to 2022 including training set. Nominal start times HH:15 UTC and HH:45 UTC of the SEVIRI scan were excluded from the RMSE and MBE analysis to match the 30-minute frequency of the Heliosat SARAH-3 record. In Figures 5 and 6, the MBE and the difference in RMSE with regard to SARAH-3 were plotted by station. The IEA-PVPS dataset provides the largest coverage of the considered domain and is used for the analysis. The numeric values of MBE and RMSE for the IEA-PVPS dataset are given in Tables B.3 and B.4.\nAs shown in Figure 5, the MBE of the SARAH-3 SSI is on the order of -10 to 10 W/m\u00b2 except for mountainous sites. The emulator generates somewhat higher biases than SARAH-3. Fine-tuning on DWD stations accomplished a bias reduction compared to SARAH-3 SSI on a majority of DWD stations but also increased the biases in mountain regions. Subsequently fine-tuning the emulator fine-tuned on DWD also on the MeteoSwiss stations reduced the biases in the Alps, but left the biases across the southern sites at a similar level. The accuracy and generalization of the fine-tuned model can be further increased by fine-tuning it also on the IEA-PVPS stations, yielding model E). This reduces the biases in the North African sites to near zero without affecting the biases across the KNMI, DWD and MeteoSwiss validation sets. However, note that due to the small number of ground stations in the IEA-PVPS dataset, fine-tuned model E was fine-tuned and validated on the same IEA-PVPS stations, so model E) may to some extend be affected by overfitting. To exclude this, efforts to collect a large Europe-wide dataset of high-quality SSI ground measurements are needed which also include strongly under-represented regions.\n5.3.1. Alpine validation\nThe emulator demonstrates a significant enhancement in performance across Alpine ground stations, as presented in Figures 5 and 6, particularly in regions with large RMSD relative to SARAH-3 (Figure 4b). Some of the ground stations, such as Gornergrat (GOR) at 3129 m a.s.l., are located at high altitudes on mountain ranges. Even though the emulator was trained solely on SARAH-3 SSI without any ground stations data, it achieves RMSE reductions of up to 50 W/m\u00b2 compared to SARAH-3, indicating an improvement in retrieval accuracy.\nComparing SSI from Alpine stations such as Gornergrat to Heliosat SARAH-3 reveals a systematic underestimation of SSI by SARAH-3, as indicated by a pronounced off-diagonal frequency peak in Figure C.12(a). This underestimation, which likely results from the misclassification of snow cover as clouds by Heliosat SARAH-3 [2], affects the majority of Alpine stations (not shown). Notably, the emulator does not replicate this pattern, even without fine-tuning (Figure C.12(b)), which suggests that the spectral signatures of snow cover differ sufficiently from those of clouds to allow for improved distinction.\nTwo anomalies in the retrieval of Alpine SSI are evident in Figure 5, involving models B (\"Finetuned on DWD\") and E (\"Trained on DWD\"). Both models were trained on DWD stations and display significant biases at certain Alpine stations. Model B, which was fine-tuned on DWD data, exhibits a bias exceeding 150 W/m\u00b2 across the entire Alps. The scatter plot for model B (\"Finetuned on DWD\") at GOR (Figure C.12(B)) shows that this bias stems from an overestimation at low SSI values. Conversely, model E (\"Trained on DWD\") exhibits a substantial negative bias (<-150 W/m\u00b2) at some Alpine stations, including GOR, as reflected by the underestimation in the scatter plot (Figure C.12(E)). Similar patterns are observed at other high-altitude stations. One possible explanation for the underestimation with model E is that the spectral signature of Alpine surfaces under clear-sky conditions differs markedly from the surfaces predominant in the DWD training set.\n5.3.2. Representativeness error\nMeteosat SEVIRI Level-1.5 data are provided at a typical grid size of 3x3 km, so the SSI estimates represent instantaneous values of the mean SSI in a 3x3 km area. In contrast, SSI ground\n5.4. Cloudy versus clear-sky conditions\nThe performance of our SSI retrieval models is discussed for different cloudiness conditions in the following. SSI retrieval errors depend on the level of cloudiness present. Quesada-Ruiz et al. [17] showed that the RMSE of Heliosat-2 SSI with regard to ground stations depends on the CSI. They presented a retrieval method that achieved the largest reductions in RMSE in overcast conditions, where the Heliosat retrievals had the highest RMSE. Likewise, Verbois et al. [20] accomplished the largest improvements in RMSE for samples with CSI < 0.6. We investigate the performance of our five retrieval models in clear-sky and cloudy conditions by separating the ground station measurements into CSI classes. The clear-sky index was calculated from measured SSI at the ground stations and using the Ineichen-Perez clear-sky surface radiation model [47]. Figure 7 shows SSI error statistics for different levels of cloudiness as expressed by the CSI. Heliosat SARAH-3 underestimates SSI by around -25 W/m\u00b2 in clear-sky index larger than 1 and overestimates SSI by around 27\u201390 W/m\u00b2 for CSI < 0.8. The large systematic biases in SARAH-3 and other radiative-transfer-based SSI retrievals (positive for CSI<0.8 and negative for CSI\u22651) [48] may partially be related to fractional clouds (J\u00f6rg Trentmann, personal communication). Clouds that partially cover the grid cell are measured at a point location while the satellite observes an average. The clear-sky index defined on the basis of ground observations and not over the entire grid cell can result in these biases. The emulator and the fine-tuned models mimick the negative and positive biases of Heliosat SARAH-3 (Figure 7). While the emulator generates somewhat larger residuals, fine-tuning on ground stations effectively decreased the residual spread for CSI<0.8 compared to SARAH-3.\nInterestingly, solely training on ground stations without any Heliosat emulation (model E \"Trained on DWD\") generates the smallest biases in cloudy conditions (CSI<0.8). The model trained only on ground stations (model E) also features the best generalizability to locations that are remote from its training set sites. Therefore, in cloudy conditions, the model trained solely on DWD stations provides SSI estimates with the smallest biases and RMSEs even at out-of-domain locations compared to the other models and with large performance improvements over Heliosat (Figure 7). The superior SSI retrieval performance of model E is exemplified in Figure C.13 for the Moroccan IEA-PVPS station. Even though the model was trained only on ground stations in Germany without any training data from any other regions, it shows the best SSI retrieval performance in cloudy conditions even in countries such as Morocco that are thousands\n5.5. Importance of SEVIRI channels for estimating SSI\nOur study is the first, to our knowledge, to quantify how relevant the individual channels of a geostationary imager are for accurate SSI retrieval. As the channels relate to different wavelength bands, they differ in their relative importance for capturing atmospheric composition aspects and surface properties [35]. For example, the visible VIS006 and VIS008 are more relevant for cloud opacity due to reflectivity whereas WV062 and WV073 mainly sense tropospheric water vapor. We quantified the relevance of the individual SEVIRI channels in an observations-based, data-driven manner based on the permutation feature importance of the predictor variables of each of our five SSI retrieval models. Permutation feature importance methods assess the importance of each predictor variable (feature) in a machine learning model based on how much the predictor variable contributes to the model's performance [49]. Permutation feature importance quanti-fies how the model performance changes when the values of a predictor variable are randomly permuted while keeping the values of the other predictor variables unchanged. If the random shuffling leads to a significant drop in model accuracy, the predictor variable whose values were shuffled is important for the model's performance. After permuting a predictor variable over the entire validation set, we calculated the model performance in terms of the mean absolute error (MAE) and compared it to the model performance without permutation. The 15x15 grids represent a single feature per channel in the feature importance.\nThe permutation feature importances are shown in Figure 8. Shuffling a predictor variable that has no effect on the retrieval model's performance, such as WV062, leaves the MAE practically unchanged. Shuffling features essential to the retrieval model \u2013 such as the VIS006 channel and the SZA causes large performance decreases of around 100 and 200 W/m\u00b2 in MAE, respectively. The predictor variables latitude, longitude, azimuth, DEM and day of the year were left out from Figure 8 as permutation feature importance showed they had no significant effect on the model performance. The emulator effectively disregards the VIS008 channel. However, the other deep learning retrieval models retrieve information and gain performance from the VIS008 channel. The emulator shows the lowest feature importance for all channels but attributes the largest importance to the SZA, compared to the other models, which suggests it does not yet make optimal use of the information contained in the SEVIRI channels.\nFigures B.10 and B.11 illustrate predictor importance for clear-sky and cloudy conditions. As expected, our SSI retrieval models rely mostly on SZA in clear-sky conditions, because the SZA includes the majority of information to estimate SSI without cloud attenuation. In cloudy conditions, the visible, near-infrared and infrared channels gain importance. For model E (\"Trained on DWD\"), the IR087 channel plays a significant role in the clear-sky conditions compared to the other retrieval models. IR087, and a combination of IR108 and IR120, are important for distinguishing ice clouds from water clouds [35] and may be helpful in distinguishing snow cover from clouds in clear-sky conditions. We expect that a data-driven evaluation of channel importance can contribute to further improvement of radiative-transfer based models."}, {"title": "6. Conclusions", "content": "Our study introduced the first machine-learning-based satellite retrieval for instantaneous surface solar irradiance and demonstrated its capability to provide accurate and generalizable SSI estimates across Europe. Our retrieval models were trained on multiple years of Meteosat SEVIRI observations in eleven visible and infrared channels. Heliosat SSI estimates and SSI from ground station networks were used as target variables in the machine learning model development. Instantaneous SSI is not averaged in time and primarily of interest in short-term forecasting, such as intra-hour solar forecasts for applications in solar energy production and building control. Our study is the first to emulate a"}]}