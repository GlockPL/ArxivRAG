{"title": "GESUBNET: GENE INTERACTION INFERENCE FOR DISEASE SUBTYPE NETWORK GENERATION", "authors": ["Ziwei Yang", "Zheng Chen", "Xin Liu", "Rikuto Kotoge", "Peng Chen", "Yasuko Matsubara", "Yasushi Sakurai", "Jimeng Sun"], "abstract": "Retrieving gene functional networks from knowledge databases presents a challenge due to the mismatch between disease networks and subtype-specific variations. Current solutions, including statistical and deep learning methods, often fail to effectively integrate gene interaction knowledge from databases or explicitly learn subtype-specific interactions. To address this mismatch, we propose GenSubNet, which learns a unified representation capable of predicting gene interactions while distinguishing between different disease subtypes. Graphs generated by such representations can be considered subtype-specific networks. GenSubNet is a multi-step representation learning framework with three modules: First, a deep generative model learns distinct disease subtypes from patient gene expression profiles. Second, a graph neural network captures representations of prior gene networks from knowledge databases, ensuring accurate physical gene interactions. Finally, we integrate these two representations using an inference loss that leverages graph generation capabilities, conditioned on the patient separation loss, to refine subtype-specific information in the learned representation. GenSubNet consistently outperforms traditional methods, with average improvements of 30.6%, 21.0%, 20.1%, and 56.6% across four graph evaluation metrics, averaged over four cancer datasets. Particularly, we conduct a biological simulation experiment to assess how the behavior of selected genes from over 11,000 candidates affects subtypes or patient distributions. The results show that the generated network has the potential to identify subtype-specific genes with an 83% likelihood of impacting patient distribution shifts.", "sections": [{"title": "INTRODUCTION", "content": "Biological knowledge base such as STRING (Szklarczyk et al., 2023) and KEGG (Kanehisa & Goto, 2000), and web-lab experimental datasets such as gene expression data are crucial for understanding disease-gene association. While the knowledge bases are comprehensive, they often lack specificity for disease subtypes. This work introduces a deep learning method to integrate general knowledge bases with disease-subtype specific experimental data to create more targeted knowledge graphs.\nDecades of research have generated extensive disease-gene association data, compiled into various biological knowledge databases (Goh et al., 2007b; Szklarczyk et al., 2023; Kanehisa & Goto, 2000). These databases integrate known and predicted gene interactions, forming gene functional networks that describe how gene behaviors relate to disease processes. They support disease research by interpreting experimental results (Vella et al., 2017), facilitating biomarker discovery, and enabling personalized treatment (Goossens et al., 2015)."}, {"title": "PRELIMINARY AND PROBLEM SETTING", "content": ""}, {"title": "BACKGROUND: CANCER SUBTYPE", "content": "Cancer is a major public health concern with increasing incidence and leading to mortality. The National Cancer Institute (NCI) reports that the high costs of cancer care have been projected to grow to $246.6 billion by 2030 (COS, 2023). A key driver of these high costs and morbidity is cancer's inherent heterogeneity. Each cancer type is made up of multiple subtypes, characterized by distinct biochemical mechanisms, requiring specific therapeutic approaches (Balmain et al., 2003). While these subtypes may differ biochemically, they often share similar morphological traits, such as the physical structure and form of the organism (Yang et al., 2023), complicating precise diagnosis and treatment responses. This complexity highlights the need for deeper research into gene networks specific to cancer subtypes. However, as shown in Figure 1, current databases like STRING provide only broad cancer gene networks without distinguishing between subtypes such as Luminal A, Luminal B, and Basal-like in breast cancer. This limitation in specificity creates a gap in effectively targeting treatments based on unique subtype characteristics. Our paper addresses this problem by focusing on advancing research and tools that differentiate these subtypes at a more granular level."}, {"title": "PROBLEM SETTING", "content": "Definition 1 (Gene expression data). The fundamental entity in gene expression profile data is the individual patient. Each patient profile comprises tens of thousands of genes with measured features.\nLet X = {x^(m)}^M_{m=1} denote a dataset of M patients. Each patient can be represented as N sequence"}, {"title": "GESUBNET", "content": ""}, {"title": "FRAMEWORK", "content": "GenSubNet consists of three modules: patient sample representation learning module (Patient-M), graph representation learning module (Graph-M), and network inference module (Infer-M).\n\u2022 Patient-M: This module sets up a cancer subtyping task, aiming to project patient gene expression profiles into a latent representation Zp, which can distinguish subtypes. This is typically an unsupervised learning task (Withnell et al., 2021; Yang et al., 2021b;a; 2023). GenSubNet employs a Vector Quantized-Variational AutoEncoder (VQ-VAE) (Van Den Oord et al., 2017) for two purposes: (i) to model this discriminative latent space using a flexible categorical distribution (Chen et al., 2023a), and (ii) to use the decoder as a key component of Infer-M.\n\u2022 Graph-M: This module forms a link prediction task, leveraging both knowledge databases and gene expression data to learn Zg. The goal is to train a well-performed GNN autorencoder, where the encoder learns holistic gene interactions, and the decoder is used to generate new graphs. Since we focus on interactions, GenSubNet employs Neo-GNN (Yun et al., 2021), which combines structural information with node representations to prevent over-smoothing of node features.\n\u2022 Infer-M: This module involves a novel objective function that integrates Zp and Zg. GenSubNet uses the information from Patient-M, the decoder, and the reconstruction loss to optimize the prior knowledge in the gene network, i.e., the GNN encoder, for generating subtype-specific networks."}, {"title": "SUBTYPE GENE NETWORK INFERENCE", "content": "Gene Expression Representation Learning - Patient-M Given a gene expression dataset X \u2208 R^{M\u00d7N}, we first encode the gene expression sequence to a low-dimensional embedding Ze \u2208 R^{M\u00d7D} through linear layers with ReLU activation function:Ze = ReLU(Linear(X)), where D is the dimension of Ze. We apply a Batch Normalization operation to prevent overfitting the limited patient gene expression samples. The Ze is then projected along the D-axis into a set of feature vectors Ze\u2208 R^{M\u00d7D\u00d7S}, where S denotes the vector dimension. Then, we project Z\u025b into a discrete codebook This involves encoding each dimension of gene features into a code, resulting in Zp The codebook consists of K latent vectors P1:K, which defines a K-way categorical distribution. The projection is conducted using the nearest neighbor search. Then, a decoder, consisting of linear layers with ReLU activations, reconstructs the original gene expression profiles, X \u2208 R^{M\u00d7N}.\nGene Interactions Representation Learning - Graph-M. Given general graphs G represented by an adjacency matrix A and gene expression data X, we learn structural feature representations X' \u2208 R^{v\u00d7u} using two MLPs: X' = MLP_{node}(\u03a3^K_{j=1} MLP_{edge}(A_{ij}), X), where the first MLP handles edges and the second handles nodes. Next, we encode X' with A to obtain graph representations Zg \u2208 R^{N\u00d7D}. The GNN decoder computes similarity scores between paired node embeddings by first computing the element-wise product of Zg(i) and Zg(j). The resulting D-dimensional product is then aggregated into a single value as the similarity score. Finally, we train a binary classification MLP to perform the link prediction task: Eij := 1 if Similarity Score \u2265 0.5 else 0, where 1 indicates the presence of a link between node vi and vj, and 0 indicates the absence of a link. We use the predicted result Eij to guide Graph-M in learning prior gene interaction knowledge.\nSubtype Network Inference - Infer-M. This module integrates information from both Patient-M and Graph-M to optimize the prior cancer network and generate subtype-specific networks. We propose an objective function that uses Graph-M's graph generation capabilities, conditioned on the patient separation loss in Patient-M. GenSubNet follows three independent training phases.\nRecall that we first train a well-initialized Patient-M to learn Zp using gene expression profiles X. This captures distinct subtype information through the following loss function:\nL(\u03a6; x) := -E_{q_{\u03a6}(ze|x)} [log p_{\u0398} (x|Z_{q})]  (1)"}, {"title": "", "content": "where \u03a6 represents the parameters of the encoder and decoder.\nNext, we implement Graph-M to map predefined gene interactions for a given cancer into Zg:\nL(\u03b8; \u03c9) := 1/E \u03a3^E_{i=1} [h_{e} log(h_{e}(\u03c9; z_{e} (\u03b8))) + (1 \u2013 h_{e}) log(1 \u2013 h_{e}(\u03c9; z_{e} (\u03b8)))]  (2)\nwhere \u03b8 and \u03c9 are the parameters of the encoder and decoder in the GNNs, and he represents the ground truth for the presence of a gene interaction. After training L(\u03a6; x) and L(\u03b8; \u03c9), we first fix the model parameters \u03a6 and \u03c9, and reconstruct a new gene expression profile via matrix multiplication: X' = Z_{p}Z_{g}. The reconstruction error between the integrated X' and the original patient gene expression profile X is used to optimize the parameters @ of the graph encoder by:\nL(\u0398; x) = -E_{q_{\u03b8} (z_{g}|G)} [log p_{\u03b8} (x|x')]  (3)\nHere, the graph encoder conditions the reconstruction of patient or subtype-specific gene expression profiles. This ensures that graph representations capture the subtle characteristics of each patient's gene expression profile, inferring the newly generated links/interactions more relevant to subtypes."}, {"title": "EXPERIMENTS", "content": ""}, {"title": "DATASET AND PREPROCESSING", "content": "Cancer gene expression dataset. We collected the gene expression datasets from the world's largest cancer gene information database, The Cancer Genome Atlas (TCGA) (The Cancer Genome Atlas Research Network, 2013), across four cancer types: breast invasive carcinoma (BRCA) (Sharma et al., 2010), glioblastoma multiforme (GBM) (Urba\u0144ska et al., 2014), brain lower grade glioma (LGG) (Forst et al., 2014), and ovarian serous cystadenocarcinoma (OV) (Jayson et al., 2014).\nPreprocessing: TCGA collected cancer samples from various experimental platforms with different patient information, such as gene sequencing results, and lacked alignments. First, we removed the unmatched gene IDs across cancer samples to ensure platform independence. Then, we identified and eliminated genes with zero expression (based on a threshold of more than 10% of samples) or missing values. Finally, we converted the scaled estimates in the original gene-level RSEM (RNA-Seq by expectation maximization) files to FPKM (fragments per kilo-million base) mapped reads data.\nGene network dataset. We collected gene functional network resources corresponding to these four cancer types from four well-used knowledge databases, including KEGG (Kanehisa & Goto, 2000), STRING (Szklarczyk et al., 2015), InterPro (Paysan-Lafosse et al., 2023), and Monarch (Mungall et al., 2017).\n- Preprocessing: We searched and downloaded raw network data through website APIs. We mapped the gene IDs in the expression dataset to the standard format of Entrez Gene IDs (Maglott et al., 2010) in the networks. We stored gene interactions with the shared gene IDs across both datasets. Finally, we reconstructed the raw data as a binary matrix to initialize the gene graph construction."}, {"title": "EXPERIMENT-I: NETWORK INFERENCE", "content": "Objective: This experiment evaluates the effectiveness of subtype-specific networks, following our Hypothesis-1: (1) |G|y < |G|, ensuring the generated network is sparse compared to the original; (2) each subtype network exhibits structural differences from the others.\nSetup and Metrics: We train GenSubNet for each cancer (the parameter settings can be found in Appendix D), and then evaluate the generated graphs for subtypes on two factors:\n\u2022 Sparsity Assessment: we utilize the Coefficient of Degree Variation (CDV) (Pr\u017eulj, 2007) to measure the variability in gene nodes within a network. A higher CDV value indicates that most genes have very few interactions (edges). Thus, GenSubNet infers that the network becomes sparser because only a few active genes dominate the interactions in this subtype network.\n\u2022 Graph Structural Differences: we employ the Graph Edit Distance (GED) (Gao et al., 2010) and the DeltCon Similarity (DCS) (Koutra et al., 2013) to measure structural differences in gene networks. GED captures local changes in gene interactions, while DCS evaluates global structural similarities. A high GED value indicates significant differences in gene interactions. Conversely, a high DCS implies high similarity.\nResults. GenSubNet significantly outperforms all baseline methods in terms of GED, DCS, and CDV metrics across four cancer types. Compared with the second-best baseline, CSGNN, GenSubNet achieves improvements of 35.8%/32.4%/20.2%/34.1% in terms of GED across all four tasks. Additionally, it delivers a relative reduction of 29.8%/13.5%/21.6%/19.3% in terms of DCS. For CDV, the improvements are 33.4%/13.7%/17.9%/15.3%, respectively. In summary, when evaluating BRCA, GBM, LGG, and OV, GenSubNet consistently achieves lower DCS scores and higher GED and CDV scores. This indicates that the generated subtype-specific gene networks are sparse but structurally unique, i.e., they are significantly different from each other. The OV results are apparently unsatisfactory, but this aligns with existing knowledge that OV is a challenging cancer type due to the limited available samples and the lack of information on their pathogenic mechanisms in existing knowledge databases."}, {"title": "EXPERIMENT-II: BIOLOGICAL MEANINGFULNESS", "content": "Objective: While three graph metrics show the statistical significance of the generated network, this experiment further evaluates their biological relevance, following our Expectation-2. (1) Instead of structural differences, we further assess whether each network shows biologically functional differences from other networks. (2) We examine whether the generated networks have the potential to narrow down key genes that contribute more specifically to their respective subtypes.\nSetup and Metrics: We hence conduct two experiments as follows:"}, {"title": "CONCLUSIONS", "content": "This paper introduced GenSubNet, a framework for inferring disease subtype-specific gene networks. GenSubNet includes sample and gene embedding learning modules that capture the characteristics of both patients and the prior gene graph. These embeddings are then utilized to reconstruct the input gene profile in the network inference module. This approach incorporates patient group information into the updated gene embeddings, enabling more accurate gene network inference specific to patient groups. As a result, GenSubNet offers a unified framework for group-specific gene network inference on real-world clinical data. Importantly, we demonstrated the reliability of GenSubNet through a series of biological validations. We believe that GenSubNet will be a valuable tool for disease research and other gene function-related applications."}]}