{"title": "Clinnova Federated Learning Proof of Concept: Key Takeaways from a Cross-border Collaboration", "authors": ["Julia Alekseenko", "Bram Stieltjes", "Michael Bach", "Melanie Boerries", "Oliver Opitz", "Alexandros Karargyris", "Nicolas Padoy"], "abstract": "Clinnova, a collaborative initiative involving France, Germany, Switzerland, and Luxembourg, is dedicated to unlocking the power of precision medicine through data federation, standardization, and interoperability. This European Greater Region initiative seeks to create an interoperable European standard using artificial intelligence (AI) and data science to enhance healthcare outcomes and efficiency. Key components include multidisciplinary research centers, a federated biobanking strategy, a digital health innovation platform, and a federated AI strategy. It targets inflammatory bowel disease, rheumatoid diseases, and multiple sclerosis (MS), emphasizing data quality to develop AI algorithms for personalized treatment and translational research.\nThe IHU Strasbourg (Institute of Minimal-invasive Surgery) has the lead in this initiative to develop the federated learning (FL) proof of concept (POC) that will serve as a foundation for advancing AI in healthcare. At its core, Clinnova-MS aims to enhance MS patient care by using FL to develop more accurate models that detect disease progression, guide interventions, and validate digital biomarkers across multiple sites. This technical report presents insights and key takeaways from the first cross-border federated POC on MS segmentation of MRI images within the Clinnova framework. While our work marks a significant milestone in advancing MS segmentation through cross-border collaboration, it also underscores the importance of addressing technical, logistical, and ethical considerations to realize the full potential of FL in healthcare settings.", "sections": [{"title": "I. INTRODUCTION", "content": "The European Greater Region initiative, involving Grand Est (France), Saarland and Baden-W\u00fcrttemberg (Germany), Basel (Switzerland), and Luxembourg, seeks to develop a sovereign, open, and interoperable European standard to harness AI and data science in healthcare. In particular, this initiative focuses on improving patient outcomes and healthcare efficiency through personalized, sustainable, and preventive solutions. By prioritizing data quality and uniformity, the initiative strives to develop AI algorithms capable of guiding personalized treatment decisions and accelerating translational research into disease etiology, ultimately enhancing patient care. Central to this initiative is the integration of Federated Learning (FL), a groundbreaking approach to Al model training. Through the use of FL technology, Clinnova intends to analyze data from various sources, enabling the efficient training of AI algorithms.\nUnlike traditional machine learning, which centralizes data for model training, FL enables model training across decentralized clients or centers holding local data samples [21]. This approach maintains data privacy by ensuring sensitive information remains within its respective local environment, addressing privacy and data ownership concerns.\nFL involves several key steps:\nLocal Model Training: Local models are trained exclusively on each participating site's own data.\nLocal Model Updates: After local training, only model updates (e.g., weights) are transmitted to a central server.\nAggregation: The central server aggregates the updates to create a new global model using federated averaging. This updated model is then sent back to each site to start a new round of local training.\nThe Clinnova collaboration exploits this privacy-preserving concept of training to implement, among others, the Clinnova-MS study. This study aims to establish a prospective cohort of multiple sclerosis (MS) patients to study this disorder. Within this study, FL facilitates collaborative AI model training across decentralized data sources, enhancing the ability to develop personalized treatment strategies, identify early MS indicators, and validate digital biomarkers.\nThis report emphasizes the FL aspect of the Clinnova initiative, detailing the development of two proofs of concept (POCs) as an effort to implement the cross-border collaboration. The first proof of concept (POC1) focuses on deploying a functional virtual infrastructure for FL across multiple centers (clients) and tests this infrastructure using public data. The second proof of concept (POC2) applies this infrastructure to an MS use case using a real, geographically-distributed implementation, a key research focus of Clinnova. The report also addresses practical technical solutions and crucial considerations raised during our work on the POCS."}, {"title": "II. MOTIVATION", "content": "As part of the cross-border collaborative effort to create the European Valley of Data and AI for Health, the following elements will be developed in Clinnova:\nA network of multidisciplinary translational research centers of excellence focused on autoimmune, inflammatory and cancer diseases.\nA federated biobanking strategy allowing to achieve unsurpassed homogeneity for the processing of biological samples collected in the different regions.\nA platform for innovation in digital health based on interoperable data infrastructures established in the different regions.\nA federated artificial intelligence strategy to enable algorithm training on a massive amount of learning data that are stored in compliance with a shared ethical and regulatory framework.\nThe IHU focuses on the FL aspect as a key direction of this initiative and leads the implementation of the FL solution. In"}, {"title": "III FL System Elements", "content": null}, {"title": "III-A Platform", "content": "sciCORE+ [20] is a secure research platform that offers a robust computing environment, empowering users to seamlessly transfer, store, manage, and analyze sensitive research data. sciCORE+ offers a scalable OpenStack infrastructure, combining the computing power of a midsize high-performance computing (HPC) system. Equipped with multi-CPU and multi-GPU compute nodes, it provides a versatile environment to accommodate diverse computational workloads. Moreover, sciCORE+ prioritizes data security by offering support for data encryption, secure backup solutions, and private-cloud environments.\nThe SciCOREmed environment is utilized as the pre-made solution offered by University of Basel, Switzerland. It has straightforward prerequisites for parties to join it, including Terms of Use, 2FA-SSH (maintenance access), HTTPS, and other protocols (service interoperability)."}, {"title": "III-B FL Framework", "content": "We employ NVIDIA FLARE [17] as our FL framework due to its established familiarity among several participating centers involved in the POC development. This pre-existing familiarity with FLARE significantly accelerated the development process, as it streamlined implementation and reduced the learning curve for the involved teams. FLARE's robust features, including its support for various machine learning and deep learning pipelines, make it exceptionally well-suited for our requirements. Its flexibility and scalability enable seamless integration with diverse data sources and facilitate the development of complex models. Additionally, FLARE's strong community support and comprehensive documentation further enhance its effectiveness."}, {"title": "III-C Important Considerations", "content": "Future Challenges: Although sciCORE+ is a viable solution for the POCs, there might be a need to develop a new platform in the future. This could be driven by several factors, such as its inability to adapt to all the requirements that may arise as the project progresses. Indeed, while for POC 1, the platform fully supports the entire infrastructure by simulating a real FL scenario, for POC 2 this platform is used only for hosting an aggregator to provide a secure connection and aggregation; the question of where and how to better host it could arise as well.\nOnboarding: The introduction of new technologies to users may demand sufficient training and support to ensure seamless adoption. Users might encounter difficulties in navigating the platform, efficiently managing resources, or resolving technical issues without appropriate training and guidance.\nTeam FL Expertise: Effective experiment management in FL relies heavily on center personnel possessing a strong understanding of FL concepts. Ideally, this should be coupled with familiarity with a specific FL framework. It is important to acknowledge that there might be disagreements regarding the preferred FL framework. Reaching a consensus on a suitable framework (or support of multiple options) is essential."}, {"title": "IV Proof of Concept 1", "content": null}, {"title": "IV-A Virtual Infrastructure", "content": "sciCORE+ provides tenants for each client with virtual services for computing, networking, and storage capacity. The decision to utilize virtual services for POC 1 is based on several factors:\nRapid Deployment: Virtual services facilitate fast provisioning and deployment, allowing for the rapid setup and configuration of the initial prototype. This expedites the development cycle, enabling quicker iterations and testing of diverse features and functionalities.\nIsolation: Each tenant receives its dedicated virtual environment, ensuring robust isolation and security among different clients. This setup closely mirrors the real-world FL environment, where data privacy and security are paramount."}, {"title": "IV-B Prostate Segmentation Use Case", "content": "To validate the feasibility of our developed infrastructure for multi-centric research, we aim to conduct experiments using real-world multi-centric public data in an FL fashion. Given the availability of such data, we use a widely recognized prostate dataset (detailed later in IV-C) as an ideal candidate for our test experiments and an important use case.\nProstate cancer (CaP) is a significant global health issue, and accurate segmentation of prostate images using magnetic resonance imaging (MRI) is essential for diagnosing and localizing this disease. According to Ferlay et al. [2], prostate cancer (CaP) is a major concern, ranking among the top five cancers in terms of both incidence and mortality. It is the most commonly diagnosed cancer in men, with approximately 1.6 million new cases reported globally in 2015 [14]. Magnetic resonance imaging (MRI) plays a crucial role in diagnosing and localizing CaP."}, {"title": "IV-C Dataset", "content": "To perform experiments as part of POC 1, we utilize a public multi-site dataset for prostate MRI segmentation [6], [19], [1].\nThis dataset includes prostate T2-weighted MRI images and corresponding segmentation masks. The split between three clients (tenants) and public data is presented in Table I.\nIn the data preparation phase, each client starts by downloading the dataset from the source. The dataset is then cleaned to remove problematic cases, such as missing slices or mismatched images and labels. Following this, thresholding is applied to combine two label values into a single mask of the prostate.\nThe preprocessing phase involves a series of normalization steps. First, voxel normalization is performed to rescale MRIs to a resolution of 0.30x0.30x1.00 (mm\u00b3). The orientation of the input image is then adjusted to the \u201cRAS\u201d (Right-Anterior-Superior) axis codes. Finally, Z-score normalization is applied to standardize the intensity values across the dataset."}, {"title": "IV-D Implementation Details", "content": "Network Architectures: We use U-Net [16] as our segmentation baseline. The accuracy of the segmentation model is measured using the average Dice score.\nFederated Algorithms: The following algorithms are evaluated:\nFedAvg: The Federated Averaging (FedAvg) algorithm conducts multiple local stochastic gradient updates at client nodes and averaging of the model parameters at the server [12].\nFedProx: This is a generalization of FedAvg that incorporates modifications to better handle data and system heterogeneity. Clients in FedProx optimize a regularized loss function that includes a proximal term [8].\nDitto: The algorithm focuses on learning personalized models for each client. When the regularization hyper-parameter is zero, Ditto reduces to learning separate local models, whereas FedProx would reduce to FedAvg [7]."}, {"title": "V Proof of Concept 2", "content": null}, {"title": "V-A Distributed Infrastructure", "content": "For POC 2, the FL infrastructure is extended to a real-world geographically-distributed scenario, ensuring secure data handling and efficient computing infrastructure across clients (as shown in Figure 1). This expansion included:\nNew Client Participation: Freiburg has joined the project, eliminating the need for a mock tenant as in POC 1.\nDecentralized Control: In contrast to POC 1, each center in the extended POC 2 retains autonomy and control over its resources.\nResource Allocation: Each center is equipped with its own resources, such as GPUs, CPU, and storage space."}, {"title": "V-B Multiple Sclerosis Use Case", "content": "Multiple sclerosis (MS) is a chronic autoimmune disease of the central nervous system (CNS) characterized by inflammation, demyelination, and neurodegeneration. In MS, the immune system mistakenly attacks the myelin sheath, a fatty substance that surrounds and insulates nerve fibers in the brain, spinal cord, and optic nerves [11].\nDespite significant advancements in MS research, many aspects of the disease remain poorly understood, including its etiology, heterogeneity, progression, and optimal treatment strategies. Challenges persist in accurately diagnosing MS, predicting disease course, and developing targeted therapies that effectively halt or reverse disease progression without significant side effects. Furthermore, there is a need for biomarkers that can reliably monitor disease activity and response to treatment, as well as tools for personalized medicine approaches tailored to individual patient characteristics [3].\nFor POC 2, we strategically select a publicly available dataset that directly aligns with Clinnova's core objective of tackling MS. This dataset, the Shift Benchmark on Multiple Sclerosis lesion segmentation data [10], [9], provides an ideal case study to evaluate the effectiveness of FL models within our research framework.\nThe task at hand involves segmenting MS in MRIs, a critical aspect for understanding disease progression and treatment effectiveness. Accurate MS segmentation enables precise analysis of disease burden, assisting clinicians in treatment planning and monitoring. Given the variability in MS charac-"}, {"title": "V-C Dataset", "content": "The Shift Benchmark on Multiple Sclerosis lesion segmentation dataset provides the following characteristics:\nMulti-center: Data collected from multiple medical centers (Rennes, Bordeaux, Lyon, Brest), providing diverse perspectives and insights into lesion segmentation.\nMulti-modality: Incorporates data from various imaging modalities such as FLAIR and T1, enriching the dataset with different imaging perspectives and enhancing segmentation accuracy.\nPublic: Accessible to the research community, encouraging collaboration, transparency, and advancement in segmentation research.\nLimitations of the dataset include:"}, {"title": "V-D Implementation Details", "content": "Network Architectures: Our FL implementation utilizes well-established segmentation models from the literature: U-Net [16], SegResNet [13], Attention U-Net [15], Swin UNETR [4], and UNETR [5]. The accuracy of the segmentation models is measured using the average Dice score.\nFederated Algorithm: FedAvg [12] is an optimization strategy for MS experiments. While we recognize its limitations, particularly with strong non-IID data distributions, this choice remains optimal for POC 2 to maintain a reasonable number of experiments. Also, given that Basel and Freiburg share data from the same pool, we believe the non-IID problems are not significant."}, {"title": "VI Collaborative Network", "content": null}, {"title": "VI-A Development of the Collaboration", "content": "Participating Centers: The Clinnova POCs involve three healthcare institutions located in France (Strasbourg), Germany (Freiburg), and Switzerland (Basel).\nProcesses: Regular communication is maintained through monthly video conferences and a shared project collaborative platform. Roles and responsibilities are clearly defined in a project charter, outlining each center's obligations and contributions. Each center appoints a center coordinator who ensures timely communication and execution of tasks."}, {"title": "VI-B Important Considerations", "content": "Communication and Coordination:\nScheduling Conflicts: Monthly video conferences can lead to scheduling conflicts, making it difficult for all participants to attend regularly.\nTrust and Collaboration Among Partners:\nBuilding Trust: Establishing trust with new centers can be time-consuming, particularly when there is no prior working relationship.\nAlignment of Objectives: Differing priorities and objectives among partners can create misalignment.\nResource Allocation: Uneven distribution of resources, such as funding, technology, and personnel, can create disparities in contributions and expectations, leading to tension and dissatisfaction among centers.\nKnowledge Sharing and Capacity Building:\nResistance to Change: Resistance to adopting new technologies or methodologies for FL may hinder capacity building efforts, especially among centers with established practices."}, {"title": "VII Evaluations and Experiments", "content": null}, {"title": "A. Proof of Concept 1", "content": "Client Resource Allocation Experiment:\nThe crucial part of successfully running the experiments is providing efficient computational resources. While storage is typically less critical since sites have their own infrastructure, difficulties can arise with computational power. In this set of experiments presented in Table III, we focus on testing various setups for allocating computational resources to determine how these allocations affect the overall performance of the FL federation."}, {"title": "Performance Experiment:", "content": "The initial results, as shown in Table VI, are promising. Notably, the highest average Dice score achieved is 0.609. Analyzing the results per client reveals even higher scores, except for Strasbourg, which may be affected by the dataset's complexity, as it comprises two distinct parts [6]. FedAvg is the most effective aggregation algorithm, though Ditto also shows potential. Conversely, FedProx underperformed, which is surprising given its purpose of addressing heterogeneity. Fine-tuning the algorithm's parameters might enhance its performance."}, {"title": "Infrastructure Aspects:", "content": "When building a virtual FL infrastructure for POC 1, the following aspects were discussed and evaluated:\nResource Allocation: Considering different resource allocation strategies to optimize the utilization of GPUs, CPUs, and storage space among tenants. This could provide practical guidelines for clients joining during POC 2, helping them navigate resource allocation for further experiments.\nPerformance Benchmarking: Benchmarking the performance of the virtual setup under varying workloads to assess its computational capabilities."}, {"title": "Security:", "content": "Analyzing security levels to identify potential vulnerabilities in the infrastructure and evaluating the effectiveness of existing security measures.\nScalability: Assessing the ability of the infrastructure to handle additional computational workloads.\nFault Tolerance: Evaluating the fault tolerance capabilities of the infrastructure and assessing its resilience to failures and disruptions.\nThe conclusions drawn from these evaluations include:\nOptimal resource allocation strategies were identified, leading to improved utilization of computational resources for further experiments in POC 2. As shown in Tables IV and V, we focused on the computational resources aspect. Before integrating a new client into the federation, we discuss various possibilities, such as whether the client has GPUs or only CPUs, the potential configurations, whether the resources can be fully dedicated to the FL experiment, whether multi-GPU support is available, and the storage requirements. Our best strategy is to maximize computational performance at each site by analyzing the resources and striving to balance them among the clients.\nThe infrastructure demonstrated good performance under varying workloads related to MRI data. Initially, we handled preprocessing tasks, such as organizing and normalizing numerous MRI scans and slices. Following this, we addressed more complex tasks, including segmentation of the MRI data. This range from basic preprocessing to advanced segmentation highlights the infrastructure's capability to efficiently manage both simple and complex computational tasks.\nSecurity assessments revealed potential vulnerabilities, such as poisoning or malicious clients, insufficient encryption of data in transit, and inadequate authentication mechanisms. These issues should be taken into consideration when dealing with real private data, enhancing the overall security of the proposed solution.\nScalability evaluation showed that the infrastructure could support a high number of tenants, with minimal impact on performance. We replicated multiple instances within each tenant, evaluating the communication speed between the server and tenants, as well as the ease of managing the federation. Both the framework and virtual infrastructure remained stable, with no limitations observed in this regard.\nFault tolerance evaluations demonstrated the platform's resilience to some failures and network disruptions. Generally, the platform handled long experiments well, and in the event of failures, the ability to continue the experiment was supported. If a server fails, the clients automatically reconnect until the connection is successful, requiring only the server to be restarted, not each individual client. If a client fails, it needs to re-initiate the connection to the server, while the rest of the federation can either wait for the connection or continue the experiment. By default, the virtual environment is quite manageable in the face of network failures. As such, only some common cases were artificially tested."}, {"title": "B. Proof of Concept 2", "content": "Performance Experiment:\nBased on the provided performance metrics for various segmentation models across different locations for the FLAIR sequence (see results in TableVII), we conclude that among the models evaluated (U-Net, SegResNet, Attention U-Net, SwinUNETR, and UNETR), SegResNet consistently achieves the highest Dice Score across all clients, with values ranging from 0.601 to 0.648.\nBased on the provided Dice Scores for FLAIR + T1 lesion segmentation across different clients (see results in Table VIII), we notice that across all clients, SegResNet also achieves the highest Dice Score, followed closely by SwinUNETR and Attention U-Net. Across all models, the inclusion of T1 contrasts alongside FLAIR generally leads to a slight improvement in Dice Scores. There are minor fluctuations in performance across different clients, but the overall trends are consistent.\nGlobal vs Local Experiment:\nFrom the provided experiments comparing the SegResNet model trained and evaluated globally with FLAIR + T1 data against locally trained and evaluated models in Basel, Freiburg, and Strasbourg (see the results in Table IX), we conclude the following:\nDice Score: The SegResNet model trained and evaluated globally achieves higher Dice Scores compared to locally trained models across all three clients. For example, in Basel, the global SegResNet achieves a Dice"}, {"title": "Client Data Quantity Experiment:", "content": "Based on the experiment comparing a global FL model and locally trained models across different client data quantities with FLAIR + T1 data from Basel, Freiburg, and Strasbourg (see results in Table X), the following observations are made:\nEffect of Client Data Quantity on Dice Score: In the global setting, as the client data quantity increases from 20% to 50%, there is a slight improvement in the Dice coefficient across all locations (Basel: 0.598 to 0.618, Freiburg: 0.655 to 0.664, Strasbourg: 0.603 to 0.641). In the local setting, there is also an increase in the Dice coefficient with increasing client data quantity, but the values are consistently lower compared to the global (FL) setting for all client sizes (e.g., Basel: 0.475 for 20%, 0.522 for 50%, 0.365 for 100%).\nVariability Across Data Quantities: Generally, there is moderate variability in Dice scores across different data quantities, with slightly higher standard deviation values observed in the local model compared to the global model."}, {"title": "Communication Experiment:", "content": "We briefly present the waiting times experienced by clients, highlighting the duration between the completion of tasks by one client and the initiation of tasks by subsequent clients. The term Time taken (per 1 round) refers to the duration it takes for a single client to complete one round of training during the federated learning process. Waiting time, on the other hand, refers to the idle time a client experiences while waiting for other clients to finish their training round before the next round can begin.\nClient-Basel:\nTime taken (per 1 round): \u2248 4.08 min\nClient-Freiburg:\nTime taken (per 1 round): \u2248 5.47 min\nClient-Strasbourg:\nTime taken (per 1 round): \u2248 1.54 min\nWaiting Times:\nClient-Basel (After Client-Strasbourg):\nWaiting time: \u2248 2.54 min\nClient-Freiburg (After Client-Basel):\nWaiting time: \u2248 1.39 min\nIn analyzing the performance across Basel, Freiburg, and Strasbourg, notable differences emerge in training times. Client-Strasbourg demonstrates the shortest time, implying potentially superior computational resources. Conversely, Client-Freiburg exhibits the longest training time, hinting at potential resource constraints or computational overhead. Additionally, the waiting times between sequential training rounds highlight the coordination and synchronization efforts inherent in FL setups."}, {"title": "VIII Discussion and Conclusions", "content": "The Clinnova-MS initiative, which promotes cross-border collaboration for personalized MS treatment, faces a unique challenge: utilizing geographically-distributed data while preserving privacy. FL emerges as a powerful tool to address this challenge and unlock the potential of collaborative research within Clinnova-MS.\nUnder the scope of building POC 1, we focused on establishing the collaborative network between centers and creating the initial virtual infrastructure for further FL experiments. We tested it on the segmentation problem of the prostate in MRIs to assess its functionality and potential issues. In POC 2, we extended this work to real experiments on an MS use case in a geographically distributed setup. Throughout this process, we highlighted the main advantages and challenges we encountered.\nAdvantages of FL for Clinnova-MS:\nEnhanced Collaboration:: FL fosters collaboration among multiple healthcare institutions and research centers, facilitating knowledge sharing and joint research efforts. The successful implementation of the POCs for FL within Clinnova-MS lays the groundwork for further collaboration.\nContinuous Improvement: FL enables continuous learning through iterative model updates based on new data"}, {"title": null, "content": "from participating institutions. This allows the collaborative model in Clinnova-MS to continuously adapt and improve over time, reflecting the latest medical advancements and patient data.\nCollective Power: FL allows researchers to leverage the collective power of computing resources. This distributed learning approach can significantly accelerate the training of complex models on massive and geographically-dispersed datasets, critical for identifying subtle patterns and developing personalized treatment plans in Clinnova-MS.\nReduced Data Movement and Bandwidth Constraints: By training models locally, FL minimizes data movement across borders. This not only enhances privacy but also addresses potential bandwidth limitations that could hinder large-scale data transfers in a cross-border initiative like Clinnova-MS.\nChallenges and Limitations: Despite its advantages, FL also comes with its set of challenges and limitations.\nInitialization: One significant challenge is the initial setup, which can be labor-intensive and requires careful coordination among participating centers. Initiating and coordinating a federation with diverse regulations could be difficult and requires trustworthy communication and compromises. Established contacts between centers prior to building a federation enable building upon an established foundation of trust.\nFamiliarity with FL: Additional time and resources may be required to educate the centers about FL concepts and to ensure that they understand the implications and benefits of participating in a federated setup. Having prior familiarity with the concepts, ideally with experienced personnel, is considered advantageous.\nData Considerations: Beyond the challenge posed by the sensitivity of the processed data, which mandates robust governance mechanisms to safeguard against unauthorized access and ensure compliance with regulatory requirements (a concern we sidestepped by utilizing a public dataset), there are still other aspects to address. When initiating FL workloads, structured data storage plays a crucial role in facilitating efficient data access. By structuring the data, it becomes easier to locate, retrieve, and manipulate specific data elements needed for FL tasks. Furthermore, structured data storage enhances data consistency and integrity, ensuring that the data used for FL tasks is reliable and accurate.\nClient Performance and Efficiency: An analysis of client performance and efficiency in FL experiments reveals the importance of optimizing task distribution and coordination. Disparities in computational capabilities among participating clients highlight the need for efficient resource allocation strategies. By minimizing waiting times and maximizing utilization rates, FL can harness the collective computational power of distributed devices to achieve superior model performance.\nIn conclusion, while FL offers huge potential for advancing healthcare research and personalized treatment initiatives, its effective implementation demands a multifaceted approach that addresses both its benefits and challenges comprehensively. By doing so, healthcare organizations can harness the full capabilities of FL while protecting patient privacy and data security, ultimately driving innovation and improving patient outcomes in the Clinnova-MS initiative and beyond."}]}