{"title": "Improved YOLOv7 model for insulator defect detection", "authors": ["Zhenyue Wang", "Guowu Yuan", "Hao Zhou", "Yi Ma", "Yutang Ma", "Dong Chen"], "abstract": "Insulators are crucial insulation components and structural supports in power grids, playing a vital role in the transmission lines. Due to temperature fluctuations, internal stress, or damage from hail, insulators are prone to injury. Automatic detection of damaged insulators faces challenges such as diverse types, small defect targets, and complex backgrounds and shapes. Most research for detecting insulator defects has focused on a single defect type or a specific material. However, the insulators in the grid's transmission lines have different colors and materials. Various insulator defects coexist, and the existing methods have difficulty meeting the practical application requirements. Current methods suffer from low detection accuracy and mAP0.5 cannot meet application requirements. This paper proposes an improved you only look once version 7 (YOLOv7) model for multi-type insulator defect detection. First, our model replaces the spatial pyramid pooling cross stage partial network (SPPCSPC) module with the receptive filed block (RFB) module to enhance the network's feature extraction capability. Second, a coordinate attention (CA) mechanism is introduced into the head part to enhance the network's feature representation ability and to improve detection accuracy. Third, a wise intersection over union (WIoU) loss function is employed to address the low-quality samples hindering model generalization during training, thereby improving the model's overall performance. The experimental results indicate that the proposed model exhibits enhancements across various performance metrics. Specifically, there is a 1.6% advancement in mAP_0.5, a corresponding 1.6% enhancement in mAP_0.5:0.95, a 1.3% elevation in precision, and a 1% increase in recall. Moreover, the model achieves parameter reduction by 3.2 million, leading to a decrease of 2.5 GFLOPS in computational cost. Notably, there is also an improvement of 2.81 milliseconds in single-image detection speed. This improved model can detect insulator defects for diverse materials, color insulators, and partial damage shapes in complex backgrounds.", "sections": [{"title": "1. Introduction", "content": "Insulators are essential components of power transmission lines, playing a crucial role in insulation and structural support and ensuring the safety of transmission lines. In complex terrain and harsh environments, most transmission lines are subjected to physical and chemical erosion over time, making them prone to defects such as self-explosion and damage. Regular inspections are"}, {"title": "2. Dataset", "content": "Yunnan Power Grid Co., Ltd. provides the insulator defect dataset, and drones capture the sample images. We classify the insulator sample images into three categories: normal, self-explosion defects, and partial damage defects, with 1000 images for each type. Because the sample images have large sizes with a resolution of 4000 \u00d7 3000 pixels and the detected insulator is only a tiny proportion of the whole image, it isn't easy to see the actual label after detection. In Figure 1, we only intercepted the defective part of the insulator and magnified it for clear display in the paper."}, {"title": "3. Proposed method", "content": "To tackle the complexities arising from the diverse materials, colors, intricate backgrounds, and varied damage shapes observed in insulators, we propose an enhanced model built upon the YOLOv7 framework. Within this model, the SPPCSPC module undergoes substitution with the RFB module, thereby augmenting the network's feature extraction capacity. Additionally, we integrate the coordinate attention (CA) mechanism into the head segment to enhance detection precision concerning small-scale self-explosion defects and partial damage instances, thus bolstering the network's feature representation capabilities. Furthermore, the WIoU loss function is introduced to mitigate the impact of low-quality samples on the model's training process, thereby enhancing its generalization performance. These enhancements are elaborated upon extensively in sections 3.2-3.4."}, {"title": "3.1. Improved YOLOv7 model", "content": "Figure 2 shows the improved YOLOv7 model, where the two red boxes indicate the modified parts in the original model. Specifically, Section 3.2 explains the receptive filed block (RFB) module, Section 3.3 describes the CA mechanism, and Section 3.4 presents the WIoU loss function."}, {"title": "3.2. Receptive field block (RFB)", "content": "Given the diverse materials and colors of insulators, along with the intricate backgrounds and shapes of partial damage, we opt to replace the SPPCSPC module found in the original YOLOv7 model with the RFB module to augment the network's feature extraction capabilities. While the SPPCSPC module was initially introduced within the YOLOv7 model, the RFB module takes a different approach. It employs multiple branch convolutional layers, utilizing convolutional kernels of various sizes to achieve superior performance. This approach aims to mimic the receptive fields of human vision, thereby enhancing the network's feature extraction prowess.\nInspired by the Inception concept [28], the RFB module distinguishes itself by incorporating a regular convolution followed by a dilated convolution [29] within each branch. Notably, the main convolutional kernel sizes and dilated factors vary across branches, contributing to a diverse range of feature extraction capabilities. The dilated convolution expands the receptive field while keeping the parameter count constant, facilitating the extraction of higher-resolution features. The RFB module is visually depicted in Figure 3."}, {"title": "3.3.CA mechanism", "content": "This study integrates a coordinate attention (CA) mechanism into the head section to mitigate the issue of missing small-scale self-blasts and damaged insulators. This mechanism effectively captures channel relationships and long-term dependencies by leveraging precise positional information. The CA mechanism operates through two primary steps: embedding coordinating information and generating coordinating attention. The CA attention block is illustrated in Figure 4.\nThe process of embedding coordinate information aims to tackle the challenge of condensing global spatial information into a single channel descriptor during global pooling, which can lead to the loss of positional details. To address this issue, the embedding step divides global pooling into horizontal and vertical direction encoding for each channel individually, as depicted in Eq (1). This transformation effectively converts the pooling operation into a one-to-one feature encoding process, enabling the attention module to capture a comprehensive global receptive field while preserving precise positional information. This module helps the network accurately localize the target of"}, {"title": "3.4. WIoUv3 loss function", "content": "To mitigate the impact of low-quality samples on the model's training and generalization ability,"}, {"title": "4. Experiment and analysis", "content": "Yunnan Power Grid Co., Ltd. provided the insulation defect dataset. It consists of 3000 sample images, with 1000 images for each of the three categories: normal, self-explosion missing, and partial damage. These 3000 images were randomly divided into training, validation, and test sets in a ratio of 6:2:2. The images are all taken by drones with a resolution of 4000 \u00d7 3000 per image. Since each image has multiple labels, the real label for each type is around 1600. The images in the dataset are all original images, without data augmentation and preprocessing."}, {"title": "4.1. Experimental environment", "content": "The experimental hardware and software utilized in this study comprises an i7-10700K CPU, a 32GB RAM and a NVIDIA RTX2080Ti GPU. The software environment was Windows 10, CUDA 10.2, PyTorch 1.10.0 and PyCharm Community Edition 2021.3."}, {"title": "4.2. Experimental evaluation indicators", "content": "The ablation experiments in this study utilized seven evaluation metrics: precision, recall, mAP_0.5, mAP_0.5:0.95, parameters, GFLOPS, and speed. The comparative experiments employed five evaluation metrics: precision, recall, mAP_0.5, mAP_0.5:0.95, and speed. The definitions of these metrics can be found in the reference [30]."}, {"title": "4.3. Experimental results and analysis", "content": ""}, {"title": "4.3.1. Model training comparison", "content": "The experiment was carried out over 100 training epochs. Figures 6, 7, 8 and 9 show the comparison results of mAP.0.5, mAP0.5:0.95, precision, and recall during the training process,"}, {"title": "4.3.2. Detection result", "content": "Figure 10 displays the detection results of the original YOLOv7 model. Subfigures (a), (b) and (c) correspond to partial damage detection, while subfigures (d), (e) and (f) correspond to self-explosion defect. On the other hand, each corresponding subfigures in Figure 11 display the detection results of our improved YOLOv7 model."}, {"title": "4.3.3. Ablation experiments", "content": "The ablation experiments are performed to illustrate the efficacy of our enhancement. Table 1 presents the results."}, {"title": "4.3.4. Attention visual comparison", "content": "To demonstrate that coordinate attention can better address the issue of small-scale insulator self-bursting and damage, we conducted a visual comparison between the improved model's CA and the attention of the original model. This comparison is shown in Figure 12."}, {"title": "4.3.5. Comparative experiments with other attention mechanisms", "content": "To verify the effectiveness of our attention mechanism, we added other attention mechanisms to the same branch of the original model for comparison."}, {"title": "4.3.6. Comparative experiments with other IoU loss functions", "content": "We conduct comparative experiments with other loss functions to verify the effectiveness of the WIoUv3 loss function. Total loss is the sum of box_loss, obj_class, and cls_loss."}, {"title": "4.3.7. Experimental comparison with different models", "content": "The comparison experiment with the mainstream model has been implemented, which has verified the progressiveness of our improved model. YOLOv8, YOLOv6, and YOLOv5 have multiple versions with varying network depths and widths. Due to constraints in our GPU resources, we selected a subset of versions (m versions) of YOLOv8, YOLOv6, and YOLOv5 for comparison. The performance of other versions can be estimated proportionally. The outcomes of the comparative experiments are presented in Table 3."}, {"title": "4.3.8. Detection results for various defect types", "content": "Table 4 compares defect detection results between the Yolov7 and our improved model for each category."}, {"title": "5. Conclusion", "content": "In this study, we propose an enhanced model based on YOLOv7 for detecting various types of insulator defects. Our model can automatically detect aerial images of normal, self-exploded missing, and partially damaged insulators, reducing the workload of insulator inspection and improving inspection efficiency.\nThree difficulties exist in insulator defect detection: the diversity of insulator materials and colors, complex backgrounds, and diverse damages. This study uses the RFB module to enhance the network's feature extraction capability, incorporates the CA mechanism to improve small target detection, and introduces the WIoU loss function to address low-quality samples hindering model"}]}