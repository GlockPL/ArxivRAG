{"title": "A Multi-Modal Non-Invasive Deep Learning Framework for Progressive Prediction of Seizures", "authors": ["Ali Saeizadeh", "Douglas Schonholtz", "Joseph S. Neimat", "Pedram Johari", "Tommaso Melodia"], "abstract": "This paper introduces an innovative framework designed for progressive (granular in time to onset) prediction of seizures through the utilization of a Deep Learning (DL) methodology based on non-invasive multi-modal sensor networks. Epilepsy, a debilitating neurological condition, affects an estimated 65 million individuals globally, with a substantial proportion facing drug-resistant epilepsy despite pharmacological interventions. To address this challenge, we advocate for predictive systems that provide timely alerts to individuals at risk, enabling them to take precautionary actions. Our framework employs advanced DL techniques and uses personalized data from a network of non-invasive electroencephalogram (EEG) and electrocardiogram (ECG) sensors, thereby enhancing prediction accuracy. The algorithms are optimized for real-time processing on edge devices, mitigating privacy concerns and minimizing data transmission overhead inherent in cloud-based solutions, ultimately preserving battery energy. Additionally, our system predicts the countdown time to seizures (with 15-minute intervals up to an hour prior to the onset), offering critical lead time for preventive actions. Our multi-modal model achieves 95% sensitivity, 98% specificity, and 97% accuracy, averaged among 29 patients.", "sections": [{"title": "I. INTRODUCTION", "content": "Epilepsy is one of the most common and deadly neurological diseases with around 50 million people diagnosed worldwide and a risk of death three times higher than the general population [1]. In the U.S. alone, 150,000 people are diagnosed with epilepsy every year and about 2.3 million adults and more than 450,000 children and adolescents currently live with this life-crippling condition. $15.5B is the U.S. estimate in annual medical expenditures and lost or reduced earning and productivity due to epilepsy [2]. Although most patients diagnosed with epilepsy respond well to pharmaceutical drugs to treat epilepsy, there is still a large 30% to 40% of patients that suffer from drug resistant epilepsy and cannot be treated with traditional drugs [3]. Therefore, there is a clear need for epilepsy treatment that goes beyond pharmacological solutions.\nSeizure identification and prediction can promise substantial treatment benefits for patients suffering from epilepsy. Seizure identification has, for more than a decade, been incorporated in neuromodulation devices with considerable success [4-6]. The benefits are twofold: (i) the systems have been designed to initiate stimulation in response to signal changes in EEG (as in the Responsive Neurostimulation (RNS) device) [4, 6] or in ECG (as with recent Vagus Nerve Stimulation (VNS) devices) [5]. In both cases, this has proved an effective strategy to achieve seizure reduction; (ii) the institution of seizure detection and long-term tracking, as in the RNS device, has provided an objective measure of treatment success, or lack thereof. This is true not just for the stimulation provided by the device itself, but also for changes in medication or the implementation of other medical and surgical treatments [7]. Seizure prediction, however, opens novel treatment opportunities. By anticipating probability of seizure, future devices may alter their stimulation pattern or amplitude to reduce this probability, perhaps ultimately preventing seizures altogether. Novel devices that inform the patient of this increased probability may enable patients to alert care-givers or avoid activities that could be dangerous during seizure.\nTwo persisting challenges in seizure prediction are (i) training datasets are largely imbalanced due to the scarce occurrence of seizure vs non-seizure periods; and (ii) classifying the per-seizure and non-seizure indicators with high accuracy long in advance of the seizure onset (up to 1-hour) is not trivial. The first challenge arises due to the infrequency of"}, {"title": "II. SYSTEM OVERVIEW", "content": "seizures in patient recordings, making data-driven methods prone to bias. Prior research has addressed this issue through under-sampling the non-seizure periods. On the second note, for the pre-seizure samples that are further in advance of the onset (one hour), the classification often leads to larger false negatives (low sensitivity), while for the non-seizure samples the false positive tends to be larger as it gets closer to the pre-seizure period (low specificity).\nAlthough a multitude of studies have utilized individual biological time-series signals such as EEG, intracranial electroencephalogram (iEEG), or ECG to develop DL-based solutions for seizure prediction [8-10], the potential advantages of integrating multiple modalities remain largely unexplored. The implementation of a multi-modal approach could potentially enhance the robustness of the prediction models, thereby reducing variance and improving overall performance [11].\nIn this study we leverage the synergy of non-invasive EEG and ECG signals to enhance the accuracy of seizure prediction. This combined approach not only holds promise for advancing the development of next-generation closed-loop neuromodulation systems, but also aligns with the growing ubiquity of wearable devices. The latter could further enable the integration of non-invasive cardiac-based signals into seizure prediction systems, thereby broadening the scope and effectiveness of these technologies [12, 13]. Furthermore, for the first time, we implement a multi-class prediction algorithm that can predict the seizure in a progressive fashion, i.e., in 15 min time intervals prior to the seizure onset, and up to one hour in advance.\nWe address the aforementioned challenges by introducing a personalized framework for multi-modal seizure prediction, using non-invasive EEG and ECG signals. We design a DL algorithm to process both types of sensor readings, and we study efficient methods for integrating the multi-modal classifications derived from each sensor to achieve the highest level of accuracy. This integration aims at classifying progressive pre-seizure (preictal) periods -divided in 15 min time intervals within an hour-, and the non-seizure (interictal) period.\nAs shown in Fig. 1, the proposed solution consists a BAN of both wearable and implantable nodes performing multiple functions, such as sensing, computation, communication, and actuation. The system operates in a closed-loop configuration, utilizing sensors to monitor physiological signals, processing these signals with DL capabilities, and providing feedback to an implanted DBS or a preemptive alert system. The gateway device acts as an interface for the patient to interact with the system, offering continuous brain activity monitoring, seizure alerts, and the ability to adjust DBS settings. This setup ensures that both the patient and medical professionals can access and manage the therapy remotely, enhancing the system's efficiency and responsiveness.\nBAN consists of four key components: the EEG classifier, ECG classifiers, gateway, and DBS implant. The EEG and ECG nodes locally process sensor data using DL algorithms"}, {"title": "III. DL-BASED SEIZURE PREDICTION", "content": "In this paper, we leverage a comprehensive dataset produced as part of the EPILEPSIAE project [15]. This dataset contains a wide variety of biosignals collected from 275 patients diagnosed with focal epilepsy. The data, gathered between 2009 and 2012 from three esteemed European centers, is characterized by continuous long-term recordings, averaging 165 hours per patient and an average of 9.8 seizures per patient. Among the 275 patients, 29 have non-invasive data comprising both single-channel ECG recordings from the chest and surface EEG data in the 10-20 system. In our study, we utilize all the available data from these 29 patients to ensure a comprehensive analysis of seizure prediction using non-invasive methods. While the influence of noise in EEG and ECG signals generated by daily activities on detection results is acknowledged, this aspect will be investigated in future work.\nAs our focus in this paper in on predicting seizure, we ignore seizure (ictal) periods during which a seizure is occurring. Then, we define five labels for the periods of the recordings, 4 of which are the labels for the pre-seizure (preictal) intervals with specific periods of time prior to a seizure, which are set to 15, 30, 45, or 60 minutes before seizure onset. The last label, indicates the non-seizure (interictal) class, associated to the periods which are neither in the ictal period nor close to it (the threshold is set to be over an hour in advance of the onset). Utilizing an end-to-end model enables us to avoid the overhead associated with data pre-processing, thereby optimizing power"}, {"title": "A. Deep Learning Model", "content": "consumption and minimizing the physical size of the system. Our objective for the prediction model is to maintain lightness of the model, so it can be embedded on a wearable/implantable medical device.\nOur ECG/EEG analysis methodology, illustrated in Fig. 2, starts with batch normalization of raw samples. These samples are then processed through four 1-D CNN and Max-pooling blocks for feature extraction, where the number of channels in each block matches the number of input channels. The extracted features are flattened and passed through three dense layers for binary classification, utilizing ReLU and SoftMax activation functions to get the probabilities (PEEG and PECG) for each class as shown in (1). Despite achieving high accuracy, the model is designed to minimize the number of weights and biases, thereby reducing computational cost and making it suitable for wearable devices.\n\n$P_{EEG}(Y = k | X_{EEG}, W_{EEG}),$\n$P_{ECG}(Y = k | X_{ECG}, W_{ECG}),$\n$k \\in \\{0 \u2013 15, 15 \u2013 30, 30 \u2013 45, 45 \u2013 60, > 90\\} minutes$  (1)\nWe individually train the ECG and EEG models for each patient using the Focal Loss function, as introduced by [16] and utilized in our prior work [14] to find the optimal weights and biases, WECG and WEEG. This loss function effectively addresses data imbalance, thereby enhancing the performance of the models. Additionally, a logistic regression model is trained concurrently with the deep learning models."}, {"title": "B. Combiner Model", "content": "To integrate the results, we extract the Softmax layers' outputs from the EEG and ECG models, containing the probabilities associated with the predicted labels. These probabilities are then fed into a dedicated logistic regression model, referred to as the combiner model, to yield the final results. The combiner model takes 10 inputs\u2014five probabilities from each model (PECG and PEEG) in (2). The probabilities are provided with four-digit precision to remain within the bandwidth constraints of the BAN system during both training and operation.\n$X = [P_{EEG}(Y = k | X_{EEG}, W_{EEG}),$\n$P_{ECG}(Y=k | X_{ECG}, W_{ECG})]$  (2)\nX undergoes training to optimize its weights, ensuring the best possible combination of results Logistic Regression output. The logistic regression probability for class k is:\n$P_{LR}(Y=k | X) = \\frac{e^{W_kX+b_k}}{\\Sigma_{j=1}^{K} e^{W_jX+b_j}}$  (3)\nwhere wk and be are the weight vector and bias for class k. The final predicted class \u0176 is:\n$\\hat{Y} = arg \\space max_{k} P_{LR}(Y = k | X)$  (4)"}, {"title": "IV. EXPERIMENTAL RESULTS", "content": "All reported results are evaluated using 5-fold cross-validation. In each fold, the dataset is split into 80% for training and 20% for testing, with 10% of the training set further allocated for validation. The performance metrics represent the average efficacy of the model across all folds, specifically on the testing datasets. This comprehensive approach ensures a robust assessment of the model's performance across varying data subsets.\nThe averaged normalized confusion matrices among all the patients, shown in Fig. 3, include the ECG, EEG, and combined models. As observed, the system demonstrates strong performance on non-seizure samples (associated to the \u201c90\u2264\u201d class). Although the model exhibits lower accuracy for each pre-seizure class (divided in 15 min time intervals), it is evident that most errors occur with adjacent labels. This suggests that adjacent classes can contribute in boosting the accuracy of one another.\nTo assess the effectiveness of our model in binary classification, particularly in identifying whether a patient is within 60 minutes of seizure onset, we classify all labels under 60 minutes as pre-seizure and all others as non-seizure. We utilize a range of metrics for a comprehensive analysis, including sensitivity, specificity, and accuracy, as depicted in Fig. 4. The results presented are averaged across all patients. Additionally, we plotted the accuracy trend for binary classification over\ntime in Fig. 5, demonstrating the expected improvement in accuracy as the predicted time of seizure onset approaches."}, {"title": "V. CONCLUSION", "content": "In conclusion, this paper introduces a robust system for seizure prediction utilizing sensor networks, DL models, and advanced data curation techniques. The architecture incorporates EEG and ECG classifiers, connected to a gateway for real-time decision-making. Leveraging a large-scale dataset from the EPILEPSIAE project, the system addresses class imbalance challenges through a focal loss function in the DL model. The proposed sensor network, provides a framework to interconnect wearable, implantable, and brain-stimulator nodes, forming a closed-loop system for effective monitoring and intervention. Additionally, our system is capable to predict the time to seizures in multiple classes (with 15 minutes intervals up to an hour prior to the onset), offering critical lead time for preventive actions. Experimental results showcase the system's outstanding sensitivity, specificity, and accuracy (>97%) compared to the state-of-the-art."}]}