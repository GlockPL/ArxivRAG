{"title": "Identification and Localization of Cometary Activity in Solar System Objects with Machine Learning", "authors": ["Bryce T. Bolin", "Michael W. Coughlin"], "abstract": "In this chapter, we will discuss the use of Machine Learning methods for the identification and localization of cometary activity for Solar System objects in ground and in space-based wide-field all-sky surveys. We will begin the chapter by discussing the challenges of identifying known and unknown active, extended Solar System objects in the presence of stellar-type sources and the application of classical pre-ML identification techniques and their limitations. We will then transition to the discussion of implementing ML techniques to address the challenge of extended object identification. We will finish with prospective future methods and the application to future surveys such as the Vera C. Rubin Observatory.", "sections": [{"title": "1. Introduction to the identification of cometary activity in Solar System objects", "content": "Current and next-generation all-sky surveys provide unprecedented opportunities for the discovery of solar system asteroids and comets (Jedicke et al., 2016; Bauer et al., 2022). Contemporary asteroid surveys employ a variety of algorithms and pipelines to detect and identify moving objects in their image data such as the association of two or more detections taken in a sequence called \u201ctracklets\u201d (e.g. Jedicke et al., 2015) or through the shifting and stacking of multiple images together (e.g. Whidden et al., 2019; Bolin et al., 2020). This involves taking multiple images to detect an object more than once within a short enough time for the detections to be linked. The actual linkage of detection can include decision trees or the connection of several detections together within similar co-moving velocities (Kubica et al., 2005; Masci et al., 2019).\nMultiple detection linking algorithms can link the detections of both point-source, asteroidal detections and those that are extended, as for comets. Even for comets, whose detections have a large, extended appearance, multiple detections can be linked as for point sources if the measurement of the comet's position relative to the moving frame of the object is consistent from detection to detection (Denneau et al., 2013). However, in some survey imaging pipelines, extended objects, defined as having a width more expansive than the measured width for known point sources, can be flagged as potential outliers and removed from further processing (Duev et al., 2019). The similarities between extended objects and common telescope/detector artifacts can cause the source detection pipeline to fail; therefore, the flagging and removal of extended objects can be motivated by the need to keep the false positives at manageable levels for vetting by human eyes. As a result, the detection and discovery of comets by all-sky surveys can depend not only on the ability of the algorithms to link the detection of comets from multiple images but also on the base level of extraction of detections on a per-image basis.\nThe ability to detect comets can vary from survey to survey due to the ability to detect extended objects. For example, the image processing pipeline for the ZTF survey rejects extended objects due to the contamination of artifacts (Masci et al., 2019). Therefore, the detection of comets is significantly limited in surveys such as ZTF using the standard data pipeline. Furthermore, the ability to link comet detections can be substantially different than the detection and linking of asteroidal or point-source-like detections. The detection and discovery of comets may require their detection to be non-extended to avoid being flagged as an artifact. Examples of such cases are where the appearance of a comet is non-extended, either by its extent not being detectable given the seeing conditions at the observing location of the survey (typically 1-2 arcseconds Jedicke et al., 2015) or by being discovered as a bare nucleus before their activity starts (e.g., Cheng and Wu, 2022). In this review chapter, we will focus on identifying comets as truly extended sources, i.e., that have morphological features that are recognized as extended at the resolution of the survey. We will describe classical methods of identifying comets in astronomical survey data as well as by follow-up data. We will also describe recent advances in machine learning techniques applied to observations of comets that assist in their recognition as extended cometary sources versus being asteroidal, focusing on advancements in Deep Learning. Lastly, we will describe techniques that are being mastered for near-future use for the detection and discovery of comets in astronomical surveys such as the forthcoming Vera C. Rubin Observatory's Legacy Survey of Space and Time (LSST, Schwamb et al., 2023)."}, {"title": "2. Review of classical comet detection methods and strategies", "content": "We will start this review with an overview of contemporary methods for finding comets in astronomical surveys and follow-up data. We will start this section with a brief discussion of \"classical\" comet detection methods, i.e., those not based on machine learning or Deep Learning methods. We refer to these methods as classical since they were, in principle, accessible before the wide-scale adoption of computational methods in astronomy, i.e., when the discovery of comets occurred by recognition of an extended object by the human eye (Festou et al., 1993). However, for this review, we set a lower bound to the time covered by classical comet identification methods to the early to late 1990s when consumer-grade charge-coupled devices (CCDs) became widely accessible for use in astronomical surveys. We will transition from classical methods to methods based on characterizing individual detections to data science and machine learning-driven methods, which became more prevalent in the 2010s."}, {"title": "2.1. Serendipitous identification of cometary activity of unknown objects", "content": "The first discovery of a comet as an unknown object with an automated asteroid detection pipeline was made in 1992 of C/1992 J1 (Spacewatch) by the Spacewatch survey (Scotti et al., 1992). Spacewatch was one of the first surveys to use an automated pipeline for the detection of asteroids in CCD observations, while the telescope was used in drift scan mode (Jedicke et al., 2015). Several asteroid surveys using CCD technology began after Spacewatch such as the Catalina Sky Survey, Lincoln Near-Earth"}, {"title": "2.2. Identification of cometary activity in known objects", "content": "As described above, the discovery of cometary activity can be decoupled from the initial recognition of a solar system object, i.e., it will be recognized as a candidate asteroid detection agnostic of its activity. A known candidate orbit is the main product of a series of observations of an asteroid candidate. Even if the detection of a candidate comet's activity is not known, the orbit resulting from the observations can provide clues as to its cometary nature. A clue to the cometary nature of a comet candidate can be deduced from the known orbit such as having a Tisserand parameter significantly less than 3 (for a review of the Tisserand parameter and its significance to comets, please see Fraser et al., 2022). In addition, having an eccentricity of \u22651 or retrograde inclination may suggest that an asteroidal object has a cometary origin versus an asteroidal one. This is because most observed asteroids, such as those in the Main Belt, have an eccentricity less than 0.3 and an inclination less than 17 degrees (e.g., Bolin et al., 2017, 2018)\nComets which from their orbital properties provide clues of cometary origins may encourage follow-observations that are deeper in limiting magnitude and sensitivity which may result in the detection of cometary activity. A recent example is in the discovery of C/2022 E (ZTF) (Bolin et al., 2022b) which, while possessing evident activity in subsequent observations, had an asteroidal appearance in the discovery images taken by ZTF. Subsequent observations taken by amateur astronomers specializing in the follow-up of comets, as well as in subsequent observations by ZTF, showed evidence of cometary activity in the form of a tail and coma (Sato et al., 2022; Bolin et al., 2024b,, Fig. 1). Clues to its cometary origin, which inspired follow-up"}, {"title": "3. Review of cometary detections methods based on measurements of the individual detections", "content": "Next, we discuss detecting cometary activity by inspecting objects on an individual image basis. Previous techniques relied on identifying comets following the linkage of multiple detections of objects taken in multiple images. The next set of techniques relies on the previous knowledge of the location of a known object in CCD images and inspects each detection individually."}, {"title": "3.1. Identification of comets through spread function parameter analysis", "content": "Extended objects in astronomical images, whether in-ground or space-based observations, are defined by their extent relative to the typical width of unresolved detections. In images taken by single-dish telescopes, the width of the point spread function (PSF), the detection of a point or unresolved source, is set by the diffraction limits of the telescope optics, directly proportional to the observed wavelength and inversely proportional to the diameter of the telescope (Born and Wolf, 1999). In CCD detections, the PSF can be super-sampled, that is, when the scale of the individual pixels is less than the critical sample rate, and sub-sampled if the pixel scale is larger than the critical sampled rate (Howell, 2000).\nDetecting extended cometary features such as a tail or coma depends on their angular size, which is significantly larger than the imager's resolution. Even when observing with a telescope that enables resolving objects at a diffraction limit smaller than the angular scale of an extended comet, the extendedness may not be resolved if the effective resolution of the images is too coarse due to pixel size. Additionally, the resolution is often limited by the quality of atmospheric seeing when observing from the ground (typically ~1 arcsecond at most professional observing sites) rather than being limited by the inherent diffraction limit of the telescope's optics.\nSeveral attempts have been made to identify comets by quantification of the quality and extendedness of their PSFs. The quality of a PSF is roughly indicated by the reliability of PSF shape measurements made of asteroid detections by imaging pipelines (e.g., as for Pan-STARRS, see Chambers et al., 2016). For the identification of comet candidates, the measured size of the PDF is compared to the expected PSF size for a non-resolved, point-like source. Active comet candidates are more likely to have PSFs that are significantly more extended than compared to stellar-like sources (top panel of Fig. 2). Studies of the detection of comets at Palomar observatory and with Pan-STARRS found a significant correlation between parameters describing the extent and quality of PSF for comets when compared to asteroidal detections (see Fig. 2) (Waszczak et al., 2013; Hsieh et al., 2015). This method resulted in the discovery of numerous comets with Pan-STARRS, including several Main Belt comets/Active asteroids (e.g., Bolin et al., 2013; Hill et al., 2013)."}, {"title": "3.2. Identification of cometary activity by detection of comae and azimuthal variations", "content": "While the PSF extendedness method provides a straightforward and intuitive method for flagging comet candidates by their candidate extendedness when compared to reference point-source PSFs, this comparison is not based on the observed attributes of comets. Comets that can have azimuthal asymmetry due to the presence of tails or a central extended compact coma that may not be easily represented by a PSF (e.g., Bolin and Lisse, 2020; Bolin et al., 2021). Improvements to searching for cometary signatures in candidate comet detections can be made by searching for azimuthal asymmetry and the presence of a coma with special aperture functions designed to detect these properties.\nSonnett et al. (2011) were the first to apply the azimuthal asymmetry and coma search technique to ~1000 asteroids detected by the Thousand Asteroid Lightcurve Survey taken with the Canada France Hawaii Telescope (Masiero et al., 2009). They used a scheme shown in Fig. 3 that divides an annulus outside the extent of the central coma into 18 sections. The section containing part(s) of a candidate comet's tail will be measured to have a higher flux than the other surrounding sections. Sonnett et al. (2011) used this technique to set a 90% confidence upper limit to the number of Main Belt comets larger than 150 m to be ~400,000.\nChandler et al. (2021) and Ferellec et al. (2023) used similar azimuthal and coma detection techniques applied to comet candidates observed by the Blanco 4.0-m/Dark Energy Camera and the Isaac Newton Telescope/Wide Field Camera. Chandler et al. (2021) identified activity in asteroid (248370) 2005 QN173 using this technique finding evidence of its recurrent activity throughout its orbit. Ferellec et al. (2023) detected an elevated coma and azimuthal asymmetric flux for the Belt asteroid (279870) 2001 NL19 and set an upper limit to the occurrence rate of Main Belt comets of 1:500."}, {"title": "3.3. Detection of cometary activity through sporadic, significant deviations from phase curve brightness", "content": "The brightness of asteroids or bare, inactive comet nuclei follow a steady phase function determined by heliocentric, geocentric, and phase angle parameters (Bowell et al., 1988; Muinonen et al., 2010). The phase function predicts an asteroid's brightness will increase as it gets closer to the Earth, the Sun, and for a smaller phase angle. In general, this phase function is described by a smooth change in brightness for distant asteroids as their"}, {"title": "4. Review of cometary detection methods based on machine learning methods", "content": "The next set of methods is based on the growing set of techniques related to Machine Learning (ML). Carruba et al. have already described many of the core algorithms behind these techniques in Chapter 1 of this volume. We will, therefore, provide an overview of ML-based comet discovery techniques, highlighting where many of these algorithms have been implemented to find comets. Methods such as crowdsourcing used to find comets, while formidable, are outside the scope of this chapter."}, {"title": "4.1. Identification of cometary objects with convolutional neural networks", "content": "Fully-connected neural networks (NNs) have been used in machine vision applications such as in image and facial recognition applications (e.g., Bengio, 2009). Applications of NNs adjacent to the recognition of comets include the Morpheus network, a network designed to identify extragalactic sources in Hubble Space Telescope image data (Hausen and Robertson, 2020). The training of NNs usually involves training with a gradient descent-like algorithm to converge on minimum-cost function trained model (e.g., Kolen and Kremer, 2001). Fully connected networks are computationally expensive to train and run since they require weights for every hidden layer. However, convolutional neural networks (CNNs) provide a possible workaround by downscaling the first connected layer through convolution and max pooling (see Section 3 of Chapter 1 of this volume for details). This provides an order of magnitude fewer parameters to train and a corresponding considerable speed up in training and reduction in run time while maintaining accurate results compared to fully connected networks."}, {"title": "4.1.1. training of comet identification convolutional neural network models", "content": "Previous comet-recognition methods using CNNs relied on a two-stage process combining classical moving object detection methods with CNNS (Chyba Rabeendran and Denneau, 2021). The Tails network by Duev et al. (2021) is the first example to use a CNN trained on comet data to identify comets on a per-image basis. The architecture of the Tails network is provided below in Fig. 5. The training set consisted of ~3,000 image examples of comets with identifiable cometary morphology; an example can be found in Fig. 6. Each training example consisted of a science image, a reference image consisting of deep stacks of previous images, and an image consisting of the difference between the two. Approximately 20,000 negative examples of point source-like detections, internal reflection artifacts, hot pixels, and diffraction spikes were used as negative examples. The training set was refined with several instances of active learning. Active learning is an interactive form of machine learning in which the user manually labels data to improve the"}, {"title": "4.1.2. Performance of convolutional neural networks to identify comets", "content": "The performance of the Tails network with false positive and false negative rates as a function of the comet probability score is shown in Fig. 7; both false positive and false negative rates are below 2%. Tails has been run on the ZTF twilight survey data taken since 2019 September (Bolin et al., 2022a, 2023). The ZTF twilight survey consists of ~50 images taken during both evening and morning nautical to astronomical twilight on a nightly basis with Sun-centric distances of 30-60 degrees (Bolin et al., 2022a, 2024a). These near-Sun observations enable the detection of asteroids located inside the orbit of the Earth and Venus as well as of comets (Bolin et al., 2024a). It takes several hours of wall time on a 32-core machine to process a nightly data set. The output with comet probability scores, science, reference, and difference images are output to the Fritz user interface (see Fig. 8) (Coughlin et al., 2023).\nThe first discovery of a comet made by AI-assisted methods through Tails was made in 2020 October of comet C/2020 T2 (Palomar) as seen in Fig. 9 (Duev et al., 2020). C/2020 T2 exhibits clear cometary features such as a tail"}, {"title": "4.2. Other applications of machine learning used to find comets and future developments", "content": "Machine learning methods are becoming increasingly used in the detection and discovery of comets that have come out after the development of CNN-based methods like Tails (e.g., Ro\u017cek et al., 2023; Sedaghat et al., 2024). Future developments and improvements to CCN-based methods like Tails include the use of multiple-input CNNs, such as the BTSBot, implemented for identifying supernovae in ZTF images (Rehemtulla et al., 2023). Multiple input methods combine additional features that can be used to enhance the identification of comets, such as orbital information and PSF-based information described in previous sections. By combining both CNN and other feature information, the accuracy of comet identification can be increased, which will be necessary for future surveys such as LSST."}]}