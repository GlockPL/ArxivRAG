{"title": "EEG-DIF: Early Warning of Epileptic Seizures through Generative Diffusion Model-based Multi-channel EEG Signals Forecasting", "authors": ["Zekun Jiang", "Wei Dai", "Qu Wei", "Ziyuan Qin", "Kang Li", "Le Zhang"], "abstract": "Multi-channel EEG signals are commonly used for diagnosis and assessment of diseases such as epilepsy. Currently, various EEG diagnostic algorithms based on deep learning have been developed. However, most research efforts focus solely on diagnosing and classifying current signal data, but not consider the prediction of future trends for early warning.\nAdditionally, since multi-channel EEG can be essentially regarded as the spatio-temporal signal data received by detectors at different locations in the brain, how to construct spatio-temporal information representations of EEG signals to facilitate future trend prediction for multi-channel EEG becomes an important problem. This study proposes a multi-signal prediction algorithm based on generative diffusion models (EEG-DIF), which transforms the multi-signal forecasting task into an image completion task, allowing for comprehensive representation and learning of the spatio-temporal correlations and future developmental patterns of multi-channel EEG signals.\nHere, we employ a publicly available epilepsy EEG dataset to construct and validate the EEG-DIF. The results demonstrate that our method can accurately predict future trends for multi-channel EEG signals simultaneously. Furthermore, the early warning accuracy for epilepsy seizures based on the generated EEG data reaches 0.89. In general, EEG-DIF provides a novel approach for characterizing multi-channel EEG signals and an innovative early warning algorithm for epilepsy seizures, aiding in optimizing and enhancing the clinical diagnosis process.", "sections": [{"title": "1 INTRODUCTION", "content": "Epilepsy, or a seizure disorder, is a chronic disease that affects around 50 million people of all ages globally, ranking it among the most common neurological disorders in the world [1]. Epileptic seizures are typically sudden and characterized by abrupt bursts of abnormal electrical activity in the brain, potentially leading to numerous negative consequences, such as injuries resulting from sudden loss of consciousness and the development of long-term anxiety and depression. These effects can be both immediate and lasting, seriously compromising the physical and mental health as well as the quality of life of patients, and may even lead to death [2]. Besides surgical treatment, antiepileptic drugs (AEDs) can control seizures to a certain extent, but they still have limitations. According to the World Health Organization (WHO), these AEDS fail in about 30% of patients suffering from seizure disorders [3, 4]. For this reason, predicting and providing early warnings of seizures is becoming crucial for implementing early interventions to protect patients from severe consequences.\nElectroencephalography (EEG) is considered as one of the most effective and consistent predictors to monitor epileptic seizures [5]. It typically involves placing multiple electrodes on the patient's scalp to collect real-time electrical activity signals from various brain regions, which are then used to detect abnormal activities. It has been demonstrated that EEG features, such as rapid spiking waves, can serve as indicators of epileptic seizures [6]; therefore, in theory, multi-channel EEG signals can provide insights on seizure early warning.\nArtificial intelligence (AI) technology, especially advanced deep learning methods, has brought technological innovations to the intelligent diagnosis and prediction of EEG signals [7, 8]. However, there are still several technical challenges in the field of EEG analysis that affect the clinical implementation of EEG-based deep learning models.\nFirstly, multi-channel EEG signals can essentially be considered as multi-source spatiotemporal signal data received by multiple detectors located in different brain regions, encompassing both temporal and spatial information. Current research methods often focus only on temporal correlations while neglecting spatial connections [9, 10]. Therefore, how to comprehensively characterize the spatio-temporal relationships for multi-channel EEG signals to build up a superior deep learning model is becoming a critical challenge that needs to be addressed in the current field.\nSecondly, classical deep learning methods used for EEG signals forecasting, such as the commonly used LSTM algorithm, typically predict the future pattern of only one channel signal per model [11-"}, {"title": "2 RELATED WORK", "content": "EEG signals are formed by real-time detection of electrical signals from detectors located in different brain regions. In addition to temporal characteristics, they also have spatial correlations and can be considered as spatio-temporal data. Therefore, how to represent the spatio-temporal relationships of EEG signals is crucial for us to develop deep learning based predictive models [20-26].\nMost current studies are exploring the spatio-temporal representation learning of EEG signals [27-32]. Generally, there are two main approaches for representation learning: one is converting EEG signals into two-dimensional or three-dimensional images, then modeling them using CNN or CNN-LSTM networks [27-29]; the other is constructing a graph structure between different EEG signals and then developing Graph Neural Network models [31, 32].\nThese spatio-temporal representation learning algorithms mainly rely on the transformed data forms and do not focus much on the spatio-temporal correlations between different channels and time points of EEG signals during the learning process. Therefore, it is essential to develop a novel algorithm for spatio-temporal representation learning using EEG signals."}, {"title": "2.2 Multi-channel EEG signals forecasting", "content": "Sequence signal forecasting is an important research direction, but most previous studies could only predict a single channel signal, such as LSTM and other RNN algorithms [33-35]. The emergence of generative Al algorithms, such as GANs and Diffusion models, has made the generation and forecasting of multi-channel signals possible. However, current generative AI research based on EEG mainly focuses on data augmentation tasks. For example, Xu et al. [36] have developed a GAN-based multi-channel synthetic algorithm to enhance the EEG prediction for epileptic seizures, mainly overcome the data insufficiency. Also, Shu et al. [18] have introduced a promising method called DiffEEG for EEG data augmentation by using a diffusion model. Their work compares pseudo-data generated by DiffEEG with that from classical augmentation techniques, through MLP, CNN, and Transformer classifiers, and the same classifiers demonstrate superior results with DiffEEG generated data.\nIt is evident that current related works primarily emphasize improving multi-channel EEG data augmentation techniques to enhance model performance, while also demonstrating the potential of using generative AI approaches for modeling. However, these studies lack research on the generation and prediction of future trends in multi-channel EEG signals. Since there is a strong correlation between multi-channel EEG signals, it is essential to develop a model capable of simultaneously predicting various interrelated signals. Moreover, because the task of multi-channel signal forecasting presents greater difficulty and challenges, it urgently requests the development of novel algorithms to address these issues."}, {"title": "2.3 Early warning of seizures using EEG signals", "content": "Applications of seizure early warning using EEG signals represent a relatively new field of research, while more research has been conducted on seizure detection using EEG data. For instance, Nallur et al. [15] developed an early warning system that combines the African Vultures Optimization Algorithm for feature selection with channel and spatial attention. This system is trained with selected preictal data for future seizure prediction. Also, Xie et al. [32]. explored seizure brain connectivity using a spatial-temporal graph neural network (GNN) method, demonstrating the potential of GNN-extracted features in seizure detection and prediction when processed with MLP layers. Additionally, Zhou et al. [37] proposed GlepNet method, which combines a temporal convolutional layer with a multi-head attention mechanism to capture spatial-temporal information within preictal EEG signals, showing promising results across various seizure datasets. Furthermore, Li et al. introduced GGN and Transformer model for epileptic seizure detection [31] and Cho et al. proved potential of treating EEG signals as multi-channel images [14].\nIn summary, most of the studies we reviewed focus on the current epileptic seizures' detection, but they remain a significant gap in providing early warnings for seizures. Since the few existing works [32] on future prediction of seizures have not been tested on future-generated signal data, it lacks experimental evidence."}, {"title": "2.4 Key contributions", "content": "To address the aforementioned technical challenges, we propose three innovative solutions and develop a novel early warning algorithm for epileptic seizures. This algorithm, named EEG-DIF, leverages a generative diffusion model to forecast multi-channel EEG signals. Our main contributions are listed as follows:\n1. We present a novel view by transforming multi-signal forecasting into image completion tasks, which helps us to represent and mine the spatio-temporal relationships for multi-channel EEG signals, enhancing signal generation and prediction tasks.\n2. We propose a novel and efficient multi-signal forecasting algorithm by using diffusion model to simultaneously predict future trends for multi-channel EEG signals.\n3. We integrate a CNN-LSTM classifier into the backend of EEG-DIF and develop an early warning diagnostic model for epileptic seizures based on the generated EEG signals, providing accurate early seizure predictions."}, {"title": "3 METHODS AND DATA", "content": "Before introducing the specific solutions, we first present the workflow of the EEG-DIF algorithm by Figure 1. Briefly, we convert multi-channel signals into two-dimensional images and train an image completion model [38, 39] based on the generative diffusion model to fully characterize the spatio-temporal relationships of multi-channel EEG signals. When new multi-channel signal data is received, it is converted into two-dimensional images and merged with noise tensors of the same dimensions along the time axis. The trained diffusion model is then used to denoise the noisy parts of the images, achieving future trend prediction for multiple signals. Based on the generated future signal data, we construct an epileptic seizure diagnostic model to have accurate early seizure warnings.\nAlgorithms 1-4 represent the four main stages of the EEG-DIF algorithm during the training and inference phases. Each of these stages will be detailed in the following subsections."}, {"title": "3.1 Translating multi-signal forecasting into image completion", "content": "The foundation of EEG-DIF involves translating the multi-signal prediction task into an image completion task, which converts a set of one-dimensional signals into a two-dimensional waveform image as Algorithm 1 of Figure 1.\n$S'_{i,j} = \\frac{S_{i,j} - min(S_i)}{max(S_i) - min(S_i)}$ (1)\nFirst, we use Equation 1 to rescale each original signal channel $S_i$ by applying min-max normalization[40-46], bringing it into the"}, {"title": "3.2 EEG-DIF model training", "content": "Based on the obtained signal image data $I(j,i)$, we train the EEG-DIF model by Algorithm 2 of Figure 1.\nThe EEG-DIF algorithm employs a Denoising Diffusion Implicit Model (DDIM) [47] with backbone of U-Net [48]. The training of EEG-DIF follows the generative diffusion model training routine, with several modifications to the training loop.\n$q(x_t, x_{t-1}, x_0) = q_t (x_{t-1} |x_t, x_0) q(x_t |x_0)$\n$q(x_{t-1})$ (3)\nIn the forward/noising process, the noisy image $x_t$ is obtained from the original signal image $X$ by using Equation 3. Rather than adding Gaussian noise [49-52] to the entire image, EEG-DIF applies noise addition only to the bottom half of the signal image, which essentially means adding noise starting from a fixed point on the timeline. This non-Markovian process is formulated using Bayes' rule [47], where each intermediate variable $x_t$ is dependent on the variable $X_{t-1}$ at the next time step and the data $x$ at original time point, with the variability of the process controlled by the parameter $\\sigma$.\n$x_{t-1} = \\sqrt{\\alpha_t} (x_t - \\sqrt{1 - \\alpha_t} \\sigma_t \\epsilon_{\\theta}(x_t)) + \\sqrt{1 - \\alpha_t - \\sigma_t^2} (x_t) + \\sigma_t\\epsilon_t$ (4)\nSubsequently, during the reversed/denoising process, the EEG-DIF model learns and fits Equation 4, gradually reconstructing the data from its noisy state $x_T$ to an intermediate state $X_{t-1}$, and finally restoring it to the original data $X$."}, {"title": "3.3 EEG-DIF model inference", "content": "Based on the trained EEG-DIF model, EEG-DIF inference is implemented upon receiving new multi-channel EEG signals, as shown in Algorithm 3 of Figure 1.\nSpecifically, we first use Equations 1-2 to convert the incoming signal data $S$ into normalized signal data $S'$ and a signal image $I$. Then, based on Equation 3, we concatenate the signal image with the generated Gaussian noise image to obtain the original noisy image $x_T$, where the noise is generated according to the shape of the signal image tensor along the time dimension.\nSubsequently, $X_T$ is input into the EEG-DIF model, which uses the learned rules to apply Equation 4 to reconstruct the noisy region, obtaining a new image $X$. Based on this inference method, the gradually noised image can be continuously reconstructed and completed to obtain a generated image $I_{new}$ with sufficient time length.\nFinally, using the corresponding relationship described by Equation 2, we can obtain the new multi-channel EEG signal data $S'_{new}$ from the generated image $I_{new}$. Using the stored min-max values from Equation 1, each channel signal of $S'_{new}$ is restored to its original scale to have the final EEG signals $S_{new}$.\nAs illustrated in Algorithm 3 of Figure 1, the real-time received EEG signals can be used to generate multi-channel signal data to reflect future trends by implementing EEG-DIF inference. Additionally, by setting appropriate training and inference parameters, EEG-DIF theoretically allows for the prediction of signals of any number of channels and any length of time."}, {"title": "3.4 Early warning of epileptic seizures", "content": "Based on the aforementioned operations, future signal data can be generated from the currently received signals. As shown in Algorithm 4 of Figure 1, the generated signals are used as inputs for an epileptic seizure detection algorithm, forming an epilepsy early-warning system.\nThis study integrates a CNN-LSTM classifier [53, 54] into EEG-DIF framework for epileptic seizure diagnosis. The CNN-LSTM model is composed of two convolutional layers and an LSTM network.\n$Y = CNNLSTM(S_{new})$ (5)\nHere, by using Equation 5, the generated EEG signals $S_{new}$ is input into the CNN-LSTM model, which outputs whether an epileptic seizure will occur, thereby achieving early warning of epileptic seizures."}, {"title": "3.5 Datasets", "content": "In the study, to comprehensively evaluate the effectiveness of our method, we used an open Siena Scalp EEG Database [55, 56] from PhysioNet (https://physionet.org/content/siena-scalp-eeg/1.0.0/) to construct and test the EEG-DIF generation and early-warning model. This dataset is acquired from the Unit of Neurology and Neurophysiology of the University of Siena, containing EEG data from 14 patients-9 males and 5 females across various age ranges with a sampling rate of 512Hz. Each patient includes multiple EEG electrode signals and one or two EKG signals, with electrodes arranged according to the international 10-20 system. Patient information includes epilepsy classification according to the criteria"}, {"title": "3.6 Evaluation metrics", "content": "To evaluate the prediction accuracy and goodness of fit for the multi-signal forecasting algorithm, we employ the mean absolute error (MAE), mean square error (MSE), root mean square error (RMSE), and the coefficient of determination (R2) to quantify the predictive error and the proportion of variance explained.\nMAE, MSE, and RMSE are used to evaluate the degree of regression fit, with smaller values indicating better performance; R2 is used to explain the proportion of variance, and typically, the closer the value is to 1, the better.\nWe employ t-test (P<0.05) to indicate a significant difference between different regression performances[57-59]. Additionally, we conduct qualitative analysis and visualization in the form of heatmaps and signal curve plots, providing a comprehensive understanding of our model.\nFor the evaluation of classification diagnostics, we conduct a quantitative analysis using the Receiver Operating Characteristic"}, {"title": "4 RESULTS", "content": "EEG signals using our method (P<0.001), as demonstrated by quantitative metrics and statistical analysis."}, {"title": "4.2 Forecasting performance for Multi-channel EEG signals", "content": "The trained EEG-DIF model can simultaneously predict the future trends of multiple EEG signal channels. To evaluate its forecasting performance on each channel, Table 2 presents the quantitative evaluation metrics of EEG-DIF on 16 EEG channels from test patients and compares them with the classical LSTM method, demonstrating the advance of our approach for multi-channel signal forecasting."}, {"title": "4.3 Early warning performance for epileptic seizures", "content": "To evaluate the feasibility and potential of our method for early epilepsy diagnosis prediction, we construct the CNN-LSTM diagnostic model based on the training dataset (400 samples) and assess its diagnostic performance on 100 signal data generated by EEG-DIF prediction. Additionally, we compare its performance with the classical classification algorithms, including Logistic Regression (LR), XGBoost, Random Forest (RF), and Support Vector Machine (SVM)."}, {"title": "5 DISCUSSION AND CONCLUSION", "content": "Here, we propose a novel early warning algorithm and system for epileptic seizures based on spatio-temporal representation and future forecasting of multi-channel EEG signals, named EEG-DIF. This algorithm uses a Diffusion model to predict future trend for any number of channel signals by completing signal image inpainting. Simultaneously, it implements early diagnostic classification based on the generated future signal data. The EEG-DIF demonstrates excellent signal forecasting and epileptic seizure diagnosis performance on public epilepsy datasets.\nExtensive experiments demonstrate that EEG-DIF addresses key technical issues in the field from the following three aspects:\nFirstly, as shown in Figure 2 and Table 1, converting multi-channel signal forecasting into an image completion task offers significant spatio-temporal representation advantages. During the image completion process, the relationships between pixels in different dimensions of the signal image are fully learned, meaning the correlations between different channels and time points in the EEG signals are captured. Through this method, we can obtain and mine the spatio-temporal information of multi-channel EEG signals, providing a novel research approach to address the spatio-temporal representation problem for EEG signals.\nSecondly, EEG-DIF provides an effective solution to predict and generate signals from multiple channels with a single model. As shown in Table 2, even when predicting 16 signals simultaneously, EEG-DIF exhibits superior prediction performance compared to LSTM-based single-channel prediction method, with a significant improvement in average prediction performance. There are also two signals (F3 and F7) that are less satisfactory by using R2 metric. However, as shown in Figure 3, despite the noticeable amplitude changes in the prediction results, EEG-DIF can still accurately predict the signal trends and significant peaks within the next minute. Since These the signal trends and significant peaks are closely related to epileptic seizures [6, 56], it demonstrates that the generated data can provide valuable information for seizure diagnosis. By the way, we suspect that the changes in the amplitude of the predicted signals may result from the rescaling of the min-max normalization recovery process.\nThirdly, as illustrated in Figure 4 and Table 3, our method can directly diagnose epileptic seizures based on the generated future signal data. In other words, it can predict whether seizures will occur in the near future, addressing the challenge of early warning for epileptic seizures. Furthermore, Figure 4 and Table 3 turn out that CNN-LSTM is an effective method for EEG signal classification, demonstrating higher accuracy and AUC than other algorithms, thus providing experimental evidence for early seizure warning.\nWe also indicate the limitations of current method, primarily concerning EEG-DIF's inability to achieve highly accurate future predictions for all 16 different signals, with relatively poor evaluation metrics for some individual signals. We believe this might be related to the order of signal channels in the signal image. Changing the order of the signal channels might improve predictive performance. In future research, we will further explore the relationship between the signal arrangement order in the signal"}]}