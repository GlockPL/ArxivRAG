{"title": "Multimodal Stock Price Prediction", "authors": ["Furkan Karada\u015f", "Bahaeddin Eravc\u0131", "Ahmet Murat \u00d6zbayo\u011flu"], "abstract": "In an era where financial markets are heavily influenced by many static and dynamic factors, it has become increasingly critical to carefully integrate diverse data sources with machine learning for accurate stock price prediction. This paper explores a multimodal machine learning approach for stock price prediction by combining data from diverse sources, including traditional financial metrics, tweets, and news articles. We capture real-time market dynamics and investor mood through sentiment analysis on these textual data using both ChatGPT-40 and FinBERT models. We look at how these integrated data streams augment predictions made with a standard Long Short-Term Memory (LSTM model) to illustrate the extent of performance gains. Our study's results indicate that incorporating the mentioned data sources considerably increases the forecast effectiveness of the reference model by up to 5%. We also provide insights into the individual and combined predictive capacities of these modalities, highlighting the substantial impact of incorporating sentiment analysis from tweets and news articles. This research offers a systematic and effective framework for applying multimodal data analytics techniques in financial time series forecasting that provides a new view for investors to leverage data for decision-making.", "sections": [{"title": "INTRODUCTION", "content": "In the modern world of finance today, investors and fund managers find themselves confronting considerable challenges in making the most appropriate investment decisions possible in complicated and dynamic environments. From immediate-impact global economic events to political development market reflections and transformative industrial changes brought about by technological advancement, there have been so many continuous influences on financial markets that make predicting investments all the more difficult. Because of these reasons, traditional analysis methods often fail, and investors latch on to promising tools and frameworks that offer accurate and reliable forecasting.\nDas et al. (Das, Behera, & Rath, 2018) and Peng et al. (Peng & Jiang, 2015) have focused on individual tweet content to predict stock prices using social media sentiment. This work is outstanding in terms of including broader data sources, news articles, and tweet sentiment data. However, unlike these studies, we enrich our sentiment analysis by incorporating engagement metrics such as tweet likes, retweets, comments and the tweeter's follower count into our feature extraction process. These processes provide a much more detailed view of market sentiment.\nThis study focuses on multimodal stock price prediction by integrating traditional financial metrics with data acquired from tweets from Twitter (now X.com) and news articles from The New York Times. We aim to capture real-time market dynamics and gauge investor sentiment by analyzing these data sources. Tweets provide non-moderated, real-time insights from the public, while news articles from The New York Times offer moderated, expert information. To measure market sentiment and excitement, we conducted sentiment analysis using both ChatGPT-40 and FinBERT to include (Araci, 2019). ChatGPT-4o is a recent, large-scale language model, whereas FinBERT is a specialized, smaller model tailored for financial text analysis. Our study evaluates the predictive models on three stocks representing various market states, including bull, bear, and neutral markets. We compare results from these integrated data sources with predictions made by a standard Long-Short-Term Memory (LSTM) model utilizing only price data as input. Then, we highlight the performance enhancements achieved through data diversity and advanced sentiment analysis."}, {"title": "RELATED WORKS", "content": "Deep learning-based machine learning methods are successfully applied in various fields, such as medicine, computer vision, and telecommunications (Ahmedt-Aristizabal, Armin, Denman, Fookes, & Petersson, 2021). Due to their success in these areas, machine learning and deep learning have recently become popular among the methods used in finance, especially in financial forecasting. The application of machine learning and artificial intelligence techniques to financial data analysis and statistical analyses of temporal data (Boginski, Butenko, & Pardalos, 2005; Keskin, Yilmaz, & Ozbayoglu, 2021; Sezer, Gudelek, & Ozbayoglu, 2020; Tsay, 2005) provides investors with insights and recommendations when forming their portfolios.\nLSTM (Hochreiter, 1997) is a variant of RNN capable of retaining short-term and long-term information. Deep learning researchers frequently choose LSTM networks for sequence learning. These models are mainly applied to time-series data and are employed across various domains, including Natural Language Processing (NLP), language modelling, translation, speech recognition, sentiment analysis, predictive analytics, and financial time series analysis (Gao, Chai, & Liu, 2017; Greff, Srivastava, Koutn\u00edk, Steunebrink, & Schmidhuber, 2016; Wu, 2016).\nA review of studies in the literature highlights the complexity and dynamism of financial markets, emphasizing that analyses based on a single feature can be misleading (Saha, Gao, & Gerlach, 2022). Pearson correlation reveals linear relationships but overlooks the diversity of financial data across different times. A single feature usually gives only a particular indication, while the interaction of several factors shapes financial markets. For example, focusing solely on stock prices can lead to paying attention to significant aspects such as the company's financial condition, management quality, industry trends, economic conditions, and competition.\nWang et al. (Wang, Yu, & Shen, 2020) utilize online financial reviews to determine the daily sentiment for each stock, finding a strong correlation between positive sentiment and an increase in the closing stock price. Akita et al. (Akita, Yoshihara, Matsubara, & Uehara, 2016) present a method for predicting stock prices using financial data metrics and text-based information. It introduces a strategy for forecasting stock prices that involves using distributed representations of news articles and examining the relationships between various companies operating within the same industry. Lavrenko et al. (Lavrenko et al., 2000) integrated stock price trends with financial news articles to predict market directions based on news content before these trends materialized. Another study analysed newspaper articles' sentiment added to the dataset and concluded that incorporating a sentiment-measuring feature improved model performance for the testing dataset (Forecast, 2021).\nBesides news articles, social media is used in an array of studies (Cam, Cam, Demirel, & Ahmed, 2024; Das et al., 2018; Peng & Jiang, 2015). These implemented sentiment analyses on crawled tweets from Twitter along with stock data for forecasting in the stock market and concatenated with price data. While social media data, specifically tweets, has been incorporated into stock market forecasting models, these studies have typically limited their sentiment analysis to the textual content of tweets themselves. Recent studies (Avramelou, Nousi, Passalis, & Tefas, 2024; Farimani, Jahan, & Fard, 2024; Taylor & Ng, 2024) examined multimodal deep learning for predicting financial markets, each using distinct methods and data types. Avramelou et al. (Avramelou et al., 2024) present a novel multimodal approach for deep reinforcement learning in financial trading. This specifically addresses the challenge of effectively combining diverse online data sources like news articles and social media websites. Their approach leverages embeddings to merge price and sentiment data, allowing the model to discover the best combinations of these elements for enhanced trading decisions. Taylor et al. (Taylor & Ng, 2024) explore a multimodal approach to stock price prediction, integrating news headlines and article sources with stock price percentage change data. Their study mainly examines how percentage change compares to raw price values in effectiveness, while also exploring how different combinations of these data types contribute to prediction accuracy. Farimani et al. (Farimani et al., 2024) propose an adaptive"}, {"title": "METHOD", "content": "multimodal learning model for market price prediction, leveraging diverse data modalities to address the financial time series. The data sources for their models fetched from news content, sentiment from specialized newsgroups, and technical indicators."}, {"title": "Dataset", "content": "The dataset for this study comprises three selected stocks: Walmart Inc., Walt Disney Co., and Microsoft. Despite analyzing a few stocks, we ensured a more representative dataset by selecting companies with significantly different market capitalizations, sectors, and behaviors in market states. Table 1 lists each stock's sector information, market state, and capitalization.\nWith their different market conditions, these stocks represent bull, bear, and neutral states. Bull market stocks include rising prices and investors' confidence while falling prices and economic challenges characterize bear market stocks. Neutral market stocks have a stable nature with a moderate fluctuation in price to give a balanced perspective. These stocks represent various market dynamics and how those dynamics may play into investment strategy. We collected comprehensive financial data for each company from Yahoo Finance, including historical price movements and other relevant financial indicators. The data gathered for each stock ranges from 2018 to 2023. The parameters chosen for analysis are Date, Open, High, Low, Close, Adjusted Close, and Volume.\nWe collected tweets relevant to each stock to understand public opinion on market dynamics by filtering for specific keywords. Keywords included the company name or stock ticker symbol, such as \"Microsoft or MSFT.\" We required each tweet to have at least 100 likes to prioritize tweets with higher engagement. Table 2 shows the total number of tweets for each stock. These tweets and the stock price data were gathered from 2018 to 2024.\nWe included another data source for analyzing market insights with expert and moderated opinions to augment our market understanding. We collected news articles from The New York Times using its API to access news articles about each stock's significant events and developments that may affect market sentiment or stock performance. We filtered the news articles using the exact keywords used for the tweets. Table 3 presents the total number of news articles for each stock collected over the same period as the tweet data."}, {"title": "Preprocessing Data", "content": "In the preprocessing data phase, due to the non- uniform range of values in the historical trading data, Min-Max normalization will be applied to scale the data to a range between 0 and 1 before inputting it into the LSTM model.\nWe cleaned the data using various techniques to ensure the quality and relevance of text within tweets and news articles. This step removed unnecessary content or text around URLs, hashtags, mentions, reserved words, emojis, and smileys. Additionally, we eliminated stop words, punctuation, special characters, and numbers, as they do not contribute meaningful information to the text. Further, we removed any extra spaces while converting all text to lowercase. These steps were essential for the dataset, making it suitable for the subsequent analysis.\nTo address missing data, we applied a data-filling method to ensure the continuity and completeness of the dataset. Using forward-filling techniques, we effectively imputed missing values while preserving the dataset's integrity."}, {"title": "Feature Extraction", "content": "Firstly, we selected two models to analyse the sentiment of the tweets and news: FinBERT (Araci, 2019) and ChatGPT-4o. These two models bring significant innovations to natural language processing (NLP). FinBERT is an adaptation of the BERT architecture and is specifically trained to process financial texts, which means it allows better and quicker insights from financial documents like market analyses. The other model is ChatGPT-40, which is a general language model used to answer many different kinds of questions effectively. Besides FinBERT, it is trained not only on financial data but in more and larger open-source data for human interaction; hence, it will generate creative solutions during conversations. Each tweet was input into these models to assess its sentiment, assigning a score ranging from -1 to 1. A score of -1 represents a highly negative sentiment, 0 signifies a neutral sentiment, and 1 denotes a highly positive sentiment. Additionally, the models provided an accuracy percentage for the sentiment evaluation, allowing us to quantify the models' confidence in classifying sentiment accurately.\nFurthermore, we introduced a weighted sentiment score to enhance our sentiment analysis. This method considers not only the sentiment score of each tweet but also additional engagement metrics: likes, retweets, and comments for tweets, along with the follower count of the user who posted the tweet. We defined the tweet interaction $(T_i)$ such that\n$T_i = \\alpha * T_r + \\beta * T_l + \\gamma * T_c$ (1)\nwhere T,, number of retweets for the tweet, T\u2081, number of likes for the tweet, T\\,, and number of comments for the tweet and also \u03b1, \u03b2, \u03b3 are hyperparameters reflecting the weights assigned to each metric. In this study, we set these parameters to 0.3 as an initial estimate without any optimization.\nTo account for the impact of the user who posted the tweet, we calculated the user influence $(U_i)$ based on their follower count, capturing the potential reach of their messages. This is expressed as\n$U_i = \\delta * F_c$ (2)\nwhere Fc number of followers for the user who posted the tweet, \u03b4 is a hyperparameter determining the influence of follower counts, chosen as 0.1 in this study.\nThe sentiment (S) is derived by multiplying the sentiment label (S\u2081) with the accuracy percentage of the sentiment classification (S\u00bf), ensuring that the calculated sentiment reflects both its evaluated value and the confidence level.\n$S = S_l * S_c$ (3)\nTotal tweet interaction (TT;) aggregates the total engagement across retweets, likes, and comments to assess each tweet's overall impact\n$TT_i = T_r + T_l + T_c$ (4)\nwhere T,, number of retweets for the tweet, T\u2081, number of likes for the tweet, T\u00bf, number of comments for the tweet.\nBy employing these comprehensive formulas, we could reflect not just the content of the tweets but also their potential influence and effectiveness within the social media landscape. The weighted sentiment (WS) formula integrates all these factors and is calculated as follows:\n$WS = \\frac{T_i * U_i * S}{TT_i}$ (5)\nOur approach incorporates weighted sentiment analysis, which augments tweet sentiments by considering tweet engagement (retweets, likes, comments) and user influence (follower count). This is represented by the hyperparameters \u03b1, \u03b2, \u03b3, and \u03b4 which are tuned to optimize model performance and provide a more nuanced assessment of market sentiment, as high engagement and influential users are weighted more heavily. This approach is expected to more accurately reflect the true impact of the influence and engagement of tweets on stock prices compared to just tweet content's sentiment.\nTo enhance our dataset, we incorporated financial technical indicators and sentiment analysis. These features include the Relative Strength Index (RSI) and the Simple Moving Average (SMA), both of popular in financial analysis. The RSI measures the speed and change of price movements to determine whether a stock is overbought or oversold, while the SMA smooths price data to help identify trends over specified time periods.\nTo integrate the news articles, tweets, and price data, we faced the challenge of aligning datasets that operate on different timeframes. Given that the price data is recorded daily, while there can be hundreds of tweets and news articles within a single day, we needed to synchronize these varying data frequencies. We calculated the average sentiment label and accuracy percentage for all tweets and news articles generated daily to achieve this. Additionally, we included the number of tweets and news articles for the respective day in the dataset. This approach allowed us to convert all data into a daily format,"}, {"title": "Model", "content": "Our predictive model uses a standard Long-Short- Term Memory (LSTM) architecture, chosen specifically for its general applicability in handling sequential data and its robustness in time series forecasting. We focused on predicting stock closing prices, which are crucial indicators in financial decision-making.\nThe LSTM model consists of a single layer with 256 units. We employed the ReLU activation function and the Adam optimizer with a learning rate 0.001. To optimize computational resources and facilitate effective learning, we selected a batch size of 128. The model was trained over 100 epochs."}, {"title": "PERFORMANCE EVALUATION AND DISCUSSIONS", "content": null}, {"title": "Training Strategy", "content": "Our model was trained using data from 2018 to 2022, while data from 2023 was reserved for testing. This temporal split allows the model to learn from a substantial period of historical data before being evaluated on more recent data patterns and unseen market dynamics. We selected the Mean Squared Error (MSE) for the loss function. To enhance the reliability of our findings, we trained the model 10 times for both the training and testing phases and then averaged the results. This iterative approach minimizes the effects of any random variances or anomalies in the data, ensuring that the performance metrics reflect a more stable and generalized model performance."}, {"title": "Computational Model Performance", "content": "In evaluating the performance of our model, designed to predict stock closing prices, we utilized two key metrics: R-squared (R2) and Mean Absolute Error (MAE). A separate model was trained and tested independently for each stock to account for different equities' unique characteristics and behaviours. Both metrics were calculated using the predicted and actual closing prices.\nTable 4 presents the performance of stock price prediction models using FinBERT sentiment analysis, evaluated across various feature combinations.\nFor Walmart, the combination of price data with RSI and SMA yielded the best results (R2 = 0.9282, MAE = 0.0181). Similar observations were made for Microsoft. The highest performance was achieved using price data combined with RSI and SMA (R2 =\n0.9644, MAE = 0.0196).\nIn contrast, incorporating sentiment features improved model performance for Walt Disney Co. predictions. For instance, the model that combined price data with the weighted sentiment score of tweets achieved higher R2 scores (R2 = 0.9086, MAE =\n0.0150) than just using price data (R2 = 0.8915, MAE\n=\n0.0166), suggesting that sentiment data captures valuable information about market perceptions and investor sentiment specific to Walt Disney.\nIt should be noticed that for Microsoft, the model with combined data achieved better results with tweets, news articles, and technical indicators (R2 =\n0.9640, MAE = 0.0193) compared to using only price data (R2 = 0.9497, MAE = 0.0233). This highlights the significance of sentiment analysis for Microsoft's stock predictions. Sentiment data can be beneficial when combined with price data, enhancing the model's ability to capture market trends more effectively.\nTable 5 summarizes the performance of models utilizing ChatGPT-40 sentiment analysis features across different stocks, revealing notable variations depending on the features used.\nFor Walmart, the best results were again achieved with technical indicators like RSI and SMA (R2 = 0.9423, MAE = 0.0155). Despite this being the optimal outcome, when tweet sentiment data and technical indicators are added, it yields better results (R2 = 0.9352, MAE = 0.0167). than using only price data (R2 = 0.8918, MAE = 0.0226). For Walt Disney, it was observed that using only price data was more effective than including other features, such as sentiment features from tweets, for improving the overall model performance. The model performed best for Microsoft using traditional technical indicators with tweet sentiment data (R2 = 0.9588, MAE = 0.0211).\nBoth demonstrated strong performance when comparing the FinBERT and ChatGPT-40 sentiment analysis features. These indicators consistently led to predictive performance across all stocks in both models. Adding sentiment data, like news and tweets, contributed positively in both models, though the improvements were modest. For stocks like Walt Disney, sentiment features provided slight enhancements in the score, but the overall impact of sentiment data was similar in both models. FinBERT and ChatGPT-40 performed well, with technical indicators playing the dominant role and sentiment features adding subtle yet consistent value."}, {"title": "Market Simulation", "content": "We implemented real-world stock trading using the strategy outlined by Lavrenko et al. (Lavrenko et al., 2000), which is defined as follows\n$gain_{cn}(t) = \\frac{closing_{pred}(t) - opening_{true}(t)}{opening_{true}(t)}$ (6)\n$gain_{rcn}(t) =  \\frac{buy \\rightarrow sell (r_{cm}(t) > 0)}{sell \\rightarrow buy (r_{cn}(t) < 0)}$ (7)\nwhere buy \u2190 sell denotes a transaction purchasing stocks at the opening price, and sell \u2192 buy denotes a transaction selling at the opening price. Furthermore, shares are purchased at the closing price if the opening price decreases by 2% relative to the predicted closing price. In other cases, if a profit of 2% is achieved based on the price at which the stock was initially bought, shares are sold at either the opening or closing price, depending on which offers the realized gain.\nThe market simulation results in Table 6 illustrate the percentage gains achieved in various feature combinations, starting with an initial capital of 1 million dollars for each stock. The table shows the results of the profit we made at the end of the year.\nPrices and news articles features achieved the highest score, 12.3973%, for Walmart using FinBERT sentiment. For Walt Disney, we observe that the tweets obtained the highest score, 1.61629% when weighted sentiment analysis was used, which was done using FinBERT sentiment analysis. When we look at the Microsoft results, tweets, news articles, and technical indicators, we see that they reached a peak score of 42.1134% with sentiment analysis using FinBERT.\nThese results demonstrate that incorporating technical indicators and sentiment analysis leads to higher returns than price data. In particular, adding features such as RSI, SMA, and sentiment data (especially news articles and tweets) has been observed to improve model performance consistently. When technical indicators and sentiment analysis features are added to price data, the results show improved returns across all three stocks. While price data provides a strong baseline, combining technical indicators and sentiment analysis allows the models to capture market trends more effectively and generate higher profits. Thus, enhancing the models with these additional features proves to be a more effective strategy for maximizing gains in the simulation."}, {"title": "CONCLUSIONS", "content": "This paper demonstrates the advantages of a multimodal approach to stock price prediction, effectively combining traditional financial metrics with sentiment analysis from tweets and news articles.\nTo evaluate the effectiveness of our approach, we conducted experiments using market simulation techniques. The results revealed that incorporating sentiment analysis of textual data (tweets and news articles) into the model improved its performance compared to using price data alone.\nThis paper has demonstrated how the use of traditional financial data in conjunction with multiple sources of text-based data, like tweets or news articles, will lead to more accurate financial forecasting. By using insights from sentiment analysis of text-based resources like tweets and news, this study also emphasizes how crucial it is to comprehend market sentiment and how it affects changes in stock prices.\nIn other words, a multimodal approach to financial data analysis can enhance prediction accuracy and result in more effective trading strategies.\nTo improve profit-making capacities, we want to include macroeconomic information in future work, such as GDP growth rates, inflation rates, and unemployment statistics."}, {"title": "APPENDIX", "content": "We used a specific prompt to fetch the sentiment in tweets and news articles from ChatGPT-40. Below is the prompt used to guide the ChatGPT-40:\n\"You are an experienced financial analyst tasked with analyzing tweets and news related to a specific stock to gauge the overall sentiment and potential impact on the stock's price.\nFor each given tweet or news snippet about the target stock, please:"}, {"title": null, "content": "Carefully consider the sentiment expressed, looking at factors like:\nPositive or negative language and tone\nMentions of financial performance,\nprofits/losses, business\ndevelopments\nDiscussion of stock price\nmovements, investor confidence\nOverall implications of the content\nfor the stock\nBased on your analysis, provide the sentiment label (positive, negative, or neutral) and a sentiment score (between 0 and 1) representing the probability of the sentiment label (e.g., a score of 0.8 for a negative label means there is an 80% probability that the tweet is negative).\nProvide the sentiment score for each text item, along with a one-sentence explanation for your score.\nPlease look at the 'Content' column and analyze each row. Then, add columns for sentiment label and scoring (between 0 and 1) in the file.\nFinally, please summarize your findings with:\nThe average sentiment score across all the tweets/news\nA brief paragraph highlighting the key positive and negative drivers of sentiment based on the text provided. What are the main factors influencing the overall sentiment?\nRemember to consider the financial and investing context carefully, not just generic sentiment. Focus on how the information may impact the stock and investor perceptions.\nYou should add the sentiment label and score in the current file for me.\""}]}