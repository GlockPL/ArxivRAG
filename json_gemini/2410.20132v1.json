{"title": "On-Site Precise Screening of SARS-CoV-2 Systems Using a Channel-Wise Attention-Based PLS-1D-CNN Model with Limited Infrared Signatures", "authors": ["Wenwen Zhang", "Zhouzhuo Tang", "Yingmei Feng", "Xia Yu", "Qi Jie Wang", "Zhiping Lin"], "abstract": "During the early stages of respiratory virus outbreaks, such as severe acute respiratory syndrome coronavirus 2 (SARS-CoV-2), the efficient utilize of limited nasopharyngeal swabs for rapid and accurate screening is crucial for public health. In this study, we present a methodology that integrates attenuated total reflection-Fourier transform infrared spectroscopy (ATR-FTIR) with the adaptive iteratively reweighted penalized least squares (airPLS) preprocessing algorithm and a channel-wise attention-based partial least squares one-dimensional convolutional neural network (PLS-1D-CNN) model, enabling accurate screening of infected individuals within 10 minutes. Two cohorts of nasopharyngeal swab samples, comprising 126 and 112 samples from suspected SARS-CoV-2 Omicron variant cases, were collected at Beijing You'an Hospital for verification. Given that ATR-FTIR spectra are highly sensitive to variations in experimental conditions, which can affect their quality, we propose a biomolecular importance (BMI) evaluation method to assess signal quality across different conditions, validated by comparing BMI with PLS-GBM and PLS-RF results. For the ATR-FTIR signals in cohort 2, which exhibited a higher BMI, airPLS was utilized for signal preprocessing, followed by the application of the channel-wise attention-based PLS-1D-CNN model for screening. The experimental results demonstrate that our model outperforms recently reported methods in the field of respiratory virus spectrum detection, achieving a recognition screening accuracy of 96.48%, a sensitivity of 96.24%, a specificity of 97.14%, an F1-score of 96.12%, and an AUC of 0.99. It meets the World Health Organization (WHO) recommended criteria for an acceptable product: sensitivity of 95.00% or greater and specificity of 97.00% or greater for testing prior SARS-CoV-2 infection in moderate to high volume scenarios.", "sections": [{"title": "I. INTRODUCTION", "content": "Respiratory viruses, such as severe acute respiratory syndrome coronavirus 2 (SARS-CoV-2), are frequently highly contagious, spread rapidly, and possess diverse transmission routes [1], [2]. The transmission routes of the SARS-CoV-2 virus primarily include respiratory, aerosol, and contact transmission [3]\u2013[6]. Since the outbreak of (Coronavirus Disease 2019) COVID-19 in December 2019, a variety of techniques have been employed to screen individuals infected with coronavirus. These techniques include nucleic acid testing using methods such as reverse transcription-quantitative polymerase chain reaction (RT-qPCR), constant temperature amplification, sequencing, and clustered regularly interspaced short palindromic repeats (CRISPR) for nucleic acid detection [7], [8], as well as antigen testing [9], antibody testing [10], [11], lung computed tomography (CT) examination [12], and routine blood examination [13].\nThe RT-qPCR method, renowned for its exceptional specificity and sensitivity, stands as the gold standard for detecting SARS-CoV-2 [14]\u2013[17]. However, this approach is limited by the requirement for expensive qPCR instruments and skilled operators. Additionally, the intricate detection process contributes to a time-consuming procedure [18], with current test result retrieval taking at least six hours, or even extending until the following day. Testing is confined to designated laboratories, with on-site real-time testing currently unavailable. Antigen self-testing serves as a valuable supplementary method for SARS-CoV-2 screening, effectively reducing the burden on medical resources [19], [20]. The production cost per unit of antigen self-test reagents is approximately $0.415, and they are consumables that cannot be reused. This cost becomes significant when used for large-scale populations. Furthermore, antigen tests have the limitation of relatively low specificity and sensitivity. Lung CT is considered the gold standard imaging modality for diagnosing COVID-19 and is a primary method used for screening patients with COVID-19 [21], [22]. While imaging diagnosis shows higher sensitivity than nucleic acid testing, it also relies on evaluation by a professional doctor and typically takes 6 to 8 hours to receive the report. The limited availability of CT equipment"}, {"title": "II. RELATED WORK", "content": "Currently, researchers and medical device technology com-panies worldwide are collaborating to develop a cost-effective,reusable diagnostic system capable of rapidly and accuratelyscreening large populations on site. For instance, Tabrizi et al.developed a novel, low-cost handheld impedimetric biosensorusing bio-ready electrodes functionalized with SARS-CoV-2antibodies for precise detection of SARS-CoV-2 infections[24]. Wang et al. fabricated a low-cost planar fully depletedsilicon-on-insulator (FDSOI) p-channel Schottky barrier (SB)metal-oxide-semiconductor field-effect transistor (MOSFET)for detecting virus ORFlab ribonucleic acid (RNA) genes [25].Quijano-Rubio et al. developed protein-based biosensors to detect coronaviruses directly in patient samples without the needfor genetic amplification. These biosensors produce light uponinteracting with viral protein components or targeted COVID-19 antibodies, facilitating the detection of the SARS-CoV-2virus [26]. Perdomo et al. designed a portable bio-nanosensingelectrode device that measures the electrochemical impedance spectra of a disposable, bio-modified screen-printed carbon-based working electrode (SPCE), detecting changes in the con-centration of SARS-CoV-2 antigen molecules within a minute fluid sample on its surface for SARS-CoV-2 detection [27]. However, this device necessitates a sub-microliter fluid sample for testing. The process of obtaining and preparing suchsamples, particularly in non-laboratory settings, may present practical challenges and potentially affect the reliability of theresults.\nDiffering from traditional contact-based tests, non-contactauscultation has garnered considerable interest among re-searchers [28], [29]. For instance, to address the challengesposed by PCR testing, which requires point-to-point sam-pling of nasopharyngeal swab samples, Li et al. developeda compact and multifunctional pathogenic infection diagnosis system. This system not only diagnoses SARS-CoV-2 infection but also assesses symptom severity through breath and exhalation analysis [30]. Zhu et al. proposed a non-contact approach that integrates modulation spectrum and linear pre-diction speech features, utilizing speech signals recorded athome with a portable device for detecting SARS-CoV-2 in-fections [31]. Similarly, Aytekin et al. introduced a novelmethod employing a deep learning model called hierarchi-cal spectrogram transformers to analyze recorded respiratorysounds for diagnosing coronavirus infections [32]. However,the effectiveness of the hierarchical spectrogram transformer(HST) model heavily relies on the quality and quantity of"}, {"title": "A. contact-based methodology", "content": ""}, {"title": "B. non-contact-based methodology", "content": ""}, {"title": "III. ACQUISITION OF ATR-FTIR SPECTRA FROM NASOPHARYNGEAL SWABS IN SUSPECTED SARS-COV-2 CASES", "content": "This study received ethical approval from the Ethics Com-mittee of Beijing Youan Hospital, Capital Medical University(approval number: #2022-040). All research activities wereconducted in accordance with the approved protocol andadhered to the principles of the China Food and Drug Admin-istration/Good Clinical Practice (CFDA/GCP) and the HelsinkiDeclaration. In early 2023, two cohorts of nasopharyngealswab samples were collected from patients potentially infectedwith the SARS-CoV-2 Omicron variant at Beijing Youan Hos-pital. Utilizing RT-qPCR as the gold standard, we categorizedall swabs, assigning each sample a true positive or negativelabel. Cohort 1 consisted of 126 nasopharyngeal swabs, with66 testing positive for COVID-19 and 60 testing negative.In cohort 2, 112 nasopharyngeal swabs were analyzed, with53 samples confirmed positive and 59 confirmed negative.The primary experimental procedures for collecting ATR-FTIRspectra from nasopharyngeal swabs are illustrated in Fig. 1.The detailed processes for obtaining ATR-FTIR spectra frompharyngeal swab samples in both cohorts are described below.\n1) Swab samples were stored in sterile tubes filled withviral transport medium (VTM) and placed in a freezerat -80 \u00b0C. These procedures are illustrated in Fig. 1(a) and (b). Prior to collecting ATR-FTIR spectra fromnasopharyngeal swabs, the swab samples were thawedand briefly vortexed.\n2) For nasopharyngeal swabs in cohort 1, an aliquot of 4\u00b5L of the solution was directly pipetted onto the ATRcrystal and dried at room temperature for approximately10 minutes. Alternatively, to expedite drying, approxi-mately 10 \u00b5L of each sample could be dispensed ontoan aluminum foil-covered glass slide, as depicted in Fig.1 (e), and then placed inside a drying box as shown inFig. 1 (f) for about 2 to 3 minutes to ensure thoroughdrying.\n3) For nasopharyngeal swabs in cohort 2, ultrafiltration centrifugation was employed to filter micromolecule compounds from VTM and concentrate biomoleculesfrom the biological samples as shown in Fig. 1 (c).Initially, 400 \u00b5L of the samples were transferred into anultrafiltration tube with a nominal molecular weight limitof 50 kDa and centrifuged at 14,000\u00d7g for 5 minutesat 4 \u00b0C, resulting in a final volume of concentratedsolution of approximately 30 \u00b5L. The concentrated so-lution, obtained after the separation of viruses and otherbiomacromolecules through ultrafiltration, is depictedin Fig. 1 (d). Subsequently, this concentrated solutionunderwent a drying process analogous to that describedfor cohort 1.\n4) The ATR-FTIR spectral data were collected by placingaluminum foil with the dried sample on the crystal ofa Bruker Alpha II FTIR spectrometer (Bruker OpticsGmbH, Ettlingen, Germany), equipped with a platinumATR module (Fig. 1 (g)). The spectral resolution wasset to 2 cm\u00af\u00b9, capturing wave numbers from 4000 to400 cm\u00af\u00b9 over approximately 2 minutes, with 64 scansperformed for both the background and samples.\n5) After each measurement, the ATR crystal was cleanedwith MilliQ water and ethanol. Each sample was measured three times, and the mean value was calculated asthe spectral value, with any abnormal signals removed.The entitle sample-to-result process can be completedwithin 10 minutes."}, {"title": "IV. MAIN ABSORPTION PEAK BAND ASSIGNMENTS AND AIRPLS BASELINE CORRECTION", "content": "The ATR-FTIR spectral signals derived from two cohorts ofpharyngeal swab samples, spanning the truncated wavenumber"}, {"title": "A. Infrared absorption bands and spectral interpretation", "content": "range of 1800 to 900 cm-\u00b9 and recognized as the biofingerprint, are visualized in Fig. 2 (a) and Fig. 2 (c). Theselected wavenumber range of 1800 to 900 cm\u00af\u00b9 includes key biomarkers crucial for the primary classification of viralmolecules, such as lipids (peak at 1750 cm\u00af\u00b9 ($\\nu$(C=C)), 1736($\\nu$(C=O stretching)) ), amide I (peak at 1685 cm\u00af\u00b9 (disorderstructure-non-hydrogen bonded), 1659 cm\u00af\u00b9), amide II (peakat 1549 cm\u00af\u00b9, 1517cm\u00af\u00b9) amide III (peak at 1307 cm\u00af\u00b9,1260~1250 cm\u00af\u00b9), nucleic acids (peak at 1224 ($\\nu$(asymmetricPO2 streching)), 1087 (peak at $\\nu$(symmetric PO2 streching))and carbohydrates (peak at 1150 ($\\nu$ (C-O) stretching)) [41].It is important to note that the infrared absorption range ofspecific molecular chemical bonds or functional groups canvary in different measurement conditions. It is important to note that the infrared absorption range ofspecific molecular chemical bonds or functional groups canvary in different measurement conditions.\nat ultra-low concentrations, particularly the amide bands of proteins. Consequently, only certain absorption peaks of nucleic acids and carbohydrates are visible in the 1100~900 cm-\u00b9band.\nThe spectra of concentrated samples after ultrafiltration in cohort 2 revealed the main infrared absorption peaks characteristic of typical biological samples. In accordance with TableI, Amide I, Amide II, Amide III and carbohydrates ($\\nu$ (C-Ostretching coupled with C-O bending of the C-OH)) exhibitabsorption peaks at approximate wave numbers of 1651 cm\u00af\u00b9,1541 cm\u00af\u00b9, 1315 cm\u00af\u00b9, 1045 cm\u00af\u00b9 and 994 cm\u00af\u00b9, respectively,within the spectral curves. Due to the inherently low levels ofthe free component in the swab samples and the presence ofother substances in saliva, such as cell debris, bacteria, throatsecretions, or traces of blood, lipids ($\\nu$(C=C)), DNA and RNA"}, {"title": "B. AirPLS preprocessing method for spectra baseline correction", "content": "Prior to using raw spectra for analysis such as featureextraction and recognition, baseline correction is a criticalstep in preprocessing infrared absorption spectra, primarilyemployed to remove background signals arising from theabsorption of substances not under analysis from the spectra.In our study, we utilize the airPLS method for performingbaseline correction on ATR-FTIR spectra of both positive andnegative samples.  After removingthe background noise, the spectral signals show smootherprofile, with the absorption intensity of spectral signals fromboth positive and negative samples being more concentrated.\nTo visually represent the separability of high-dimensionaldata samples, we use t-distributed stochastic neighbor embed-ding (t-SNE) to reduce the 874-dimensional spectral featuresto two dimensions. The distributions resulting from dimen-sionality reduction of the raw spectral signal and the airPLSbaseline-corrected spectral signal for cohort 1 and cohort 2 arespectively. Althoughthe airPLS algorithm effectively corrects the spectral baselineand eliminates drift caused by background noise, sample surface characteristics, or other external factors, it does notsignificantly enhance the separability between positive andnegative samples. This highlights the significance of extractingvaluable feature information from infrared spectrum data ofviruses to achieve high classification accuracy."}, {"title": "V. CHANNEL-WISE ATTENTION-BASED PLS-1D-CNN MODEL, BMI EVALUATION METHOD, AND EXPERIMENTS", "content": "We were inspired by the PLS algorithm's capability toanalyze datasets with a sample size much smaller than thenumber of feature attributes, making it ideal for processing small-sample data. Additionally, the 1D-CNN model excels atautomatically extracting detailed feature information from one-dimensional signals such as infrared spectra and audio signals.Consequently, combining both methods proves particularlyeffective for analyzing limited virus sample spectra, especiallyduring the early stages. By leveraging the strengths of bothapproaches, we developed the channel-wise attention-basedPLS-1D-CNN model for identifying infrared spectrum signalspost-airPLS baseline correction. This model comprises thePLS submodel and the 1D-CNN with channel-wise attentionsubmodel.\n1) PLS submodel: the PLS submodel serves as a su-pervised feature transformation and dimensionality reductionmethod. Its key advantage lies in its ability to transformfeatures into a low-dimensional space, effectively addressingmulticollinearity and high correlation in spectral data whilepreserving the most pertinent information for classification labels. The 1D-CNN submodel with channel-wise attentionis further employed for extracting higher-level features toenhance sample classification.  During the implementation of thechannel-wise attention-based PLS-1D-CNN model, we adopt"}, {"title": "A. Architecture of channel-wise attention-based PLS-1D-CNN model and Spectral Quality Evaluation of Two Cohorts Using the BMI Method", "content": ""}, {"title": "Algorithm 1: PLS algorithm for feature extraction of spectral signals from pharyngeal swabs", "content": "Input: Training spectra $X_{train}$; labels $Y_{train}$; number of components N; test spectra $X_{test}$; tolerance $\\epsilon$\nOutput: Scores for training spectra $T_{train}$; scores for test spectra $T_{test}$; weight matrix $W_L$; regression coefficients B\n1 Compute the mean of $X_{train}$: $\\overline{X_{train}}$;\n2 Center $X_{train}$ by subtracting $\\overline{X_{train}}$ from each row: $X_{train} \\leftarrow X_{train} - \\overline{X_{train}}$;\n3 Initialize $T_{train}$, P, Q, $W_L$ as zero matrices;\n4 Set $X_{residual} \\leftarrow X_{train}$ and $Y_{residual} \\leftarrow Y_{train}$;\n5 for $i = 1$ to N do\n6   Initialize u as the first column of $Y_{residual}$;\n7   repeat\n8    $w \\leftarrow (X^T_{residual}u)/||X^T_{residual}u||$;\n9    $t \\leftarrow (X_{residual}w)/||X_{residual}w||$;\n10    $q \\leftarrow (Y^T_{residual}t)/||Y^T_{residual}t||$;\n11    $U_{new} \\leftarrow Y_{residual}q$;\n12    $\\delta \\leftarrow ||u - U_{new}||$;\n13    $u \\leftarrow U_{new}$;\n14   until $\\delta < \\epsilon$;\n15   $T_{train}[:, i] \\leftarrow t$;\n16   $P[:, i] \\leftarrow (X^T_{residual}t)/(t^Tt)$;\n17   $Q[:, i] \\leftarrow q$;\n18   $W_L [:, i] \\leftarrow w$;\n19   $X_{residual} \\leftarrow X_{residual} - t(P[:, i])^T$;\n20   $Y_{residual} \\leftarrow Y_{residual} \u2013 tq$;\n21 end\n22 Center $X_{test}$ using $\\overline{X_{train}}$;\n23 $X_{test} \\leftarrow X_{test} \u2013 \\overline{X_{train}}$;\n24 Project test data onto PLS components: $T_{test} \\leftarrow X_{test} W_L$;\n25 Compute regression coefficients: $B = W_L(P^TW_L)^{-1}Q^T$;\n26 return $T_{train}, T_{test}, W_L, B$;"}, {"title": "Algorithm 2: Algorithm for deriving BMI index from PLS", "content": "Input: Weight matrix $W_L$; training scores $T_{train}$; loading matrix for the response matrix Q; number of spectral features M; number of components N; set of wavenumbers within the biomolecular ranges $S_{BR}$; set cardinality K\nOutput: Variable importance of projection scores V; biomolecular importance BMI\n1 Compute the sum of squares explained by the i-th component:\n2 for $i = 1$ to N do\n3  $SS(i) \\leftarrow Q[:, i]^2T_{train} [:, i]^T T_{train} [:, i]$;\n4 end\n5 Compute variable importance of projection scores:\n6 for $j = 1$ to M do\n7  $V(j) \\leftarrow \\frac{M \\sum_{i=1}^N [SS(i)(W_L (i,j)/||W_L (i,:) ||)^2]}{\\sum_{i=1}^N SS(i)}$;\n8 end\n9 Compute biomolecular importance: $BMI \\leftarrow \\sqrt{\\frac{1}{K} \\sum_{v \\in S_{BR}} V[v]^2}$\n10 return V, BMI;"}, {"title": "1) PLS submodel:", "content": "Notably, the three amide bands of proteins exhibit the mostconsiderable difference between the two cohorts, likely dueto the interference caused by high salt concentrations fromviral transport medium (VTM) in the non-ultrafiltered cohort1, which results in substantial overlap of absorption peakswith the amide bands. In contrast, the ultrafiltration procedureapplied in cohort 2 facilitates the identification of proteins athigher abundances in the spectra, providing more insightful information. Proteins present in nasopharyngeal swabs, suchas the SARS-CoV-2 spike glycoprotein (S protein), mucoprotein, albumin, and immunoglobulin G (IgG), demonstrate changes in both content and secondary structure in response to viral infection, thereby enhancing the distinction betweenthe spectra of infected and non-infected samples [45], [48].The contributions of nucleic acids and carbohydrates are likelyattributable to SARS-CoV-2 RNA and highly glycosylated Sproteins [47]. Compared to other biomolecules, lipids displaylower BMI values in both cohorts (44.34% in cohort 1 and37.62% in cohort 2). This aligns with previous studies thatobserved no significant absorbance changes in lipids [44].\nBased on the above analysis, we selected the spectra fromcohort 2, which exhibited higher BMI values for biomoleculesin the features extracted by the PLS submodel, as the focusfor subsequent model analysis."}, {"title": "2) Quantification of biomolecular importance map in PLS feature extraction submodel across two cohorts:", "content": "To investigate the significance of specific spectral bands in the PLS submodel extracted spectral signal for effective classification, we introduced the BMI evaluation method to interpret, thereby facilitating the selection of higher-quality spectra and standardizes experimental procedures, ensuring the collection of consistent, high-quality spectral signals.\nIntuitively, we can consider employing a unified feature extractor in conjunction with classification methods, such as partial least squares-random forest (PLS-RF) and partial least squares-gradient boosting machine (PLS-GBM), to evaluate recognition accuracy, specificity, and sensitivity across both cohorts. By comparing these performance metrics, we were able to select higher-quality ATR-FTIR spectral signals from the two cohorts"}, {"title": "3) 1D-CNN with channel-wise attention submodel:", "content": "the widely used 2D-CNN is not suitable for direct application to one-dimensional signals, such as ATR-FTIR spectral signals. Therefore, we designed a 1D-CNN with channel-wise attentionsubmodel, as depicted in Fig. 5, to identify positive and neg-ative spectral signals. It consists of three convolutional layers,one channel-wise attention module, and two fully connected layers. The experimental parameters for each convolutional layers are as follows: 1) input spectral signal size: 1\u00d724;number of input channels: 1. 2) First convolutional layer:kernel length: 3; stride: 1; number of ouput channels: 16;padding: same (to keep the input and output sizes consistent); and the size of the feature map output by this layer: 16@1\u00d724.3) Second convolutional layer: kernel length: 3; stride: 1;number of ouput channels: 32; padding: same; and the sizeof the feature map output by this layer: 32@1\u00d724. 4) Third"}, {"title": "Algorithm 2: Algorithm for deriving BMI index from PLS", "content": "As shown in Fig. 8 (a) and (b), we normalized the VIP scoresto a range of 0 to 1 to ensure a fair comparison betweenthe two cohorts under consistent criteria. Biomolecules, in-\nwhere $\\nu$ denotes the variable of wavenumber, while $S_{BR}$ denotes the set of wavenumbers within the biomolecular ranges, with $K$ indicating the cardinality of the set $S_{BR}$. The BMIranges from 0 to 1, with higher values signifying a greatercontribution of the biomolecule to the spectral classificationbetween SARS-CoV-2 infected and non-infected samples."}, {"title": "3) 1D-CNN with channel-wise attention submodel:", "content": "convolutional layer: kernel length: 3; stride: 1; number ofouput channels: 64; padding: same; and the size of the featuremap output by this layer: 64@1\u00d724. The output feature mapsof 64 different channels, each with a length of 24, are fedinto the channel-wise attention module. The Ttrain featuremaps, now weighted by channel, are then passed as inputto the fully connected network in the subsequent classifier. The detailed architecture of channel-wise attention moduleare depicted in Fig. 6. The detailed implementation processis as follow: 1) squeeze operation: The spectral feature mapoutput by the aforementioned CNN module, with dimensions of $H_3 \u00d7 W_3 \u00d7 C_3 = 1 \u00d7 24 \u00d7 64$, is pooled on each channel using both maximum pooling and average pooling, whereH3 and W3 denote the dimensions of each feature layer, representing its length and width, while C3 denotes the numberof feature channels. The resulting data vector for the maxpooling operation, denoted as vmax, and the average poolingoperation, denoted as vavg, both have a size of 1\u00d71\u00d764, theexpression for calculating the element in the i-th channel isas follows:\n$V_{avgi} = F_{sq1}(u_i) = \\frac{1}{W}\\sum_{j=1}^W u_i(j)$ (6)\n$U_{maxi} = F_{sq2}(u_i) = \\underset{j=1,...,W}{max} u_i(j)$ (7)\nwhere ui denotes the feature vector of the i-th channel outputby the CNN module, ui(j) denotes its j-th element (wherej = 1,2,\u2026, W, and W = W3 = 24). The purpose of thesqueeze operation is to embed the global information of each channel in the feature map. 2) Excitation operation: to limitmodel complexity and improve generalization, it comprises two fully connected layers. The first fully connected layerachieves dimensionality reduction with a reduction ratio r,set to 16, while the second fully connected layer increasesdimensionality by the same ratio r. Then, the sigmoid function is applied to obtain the weight value for each channel. The expressions for calculating the weight vector wavg from average pooling and wmax from maximum pooling are as follows:\n$w_{avg} = F_{ex1}(v, W_e) = \\sigma(W_{e2}\\delta(W_{e1}v_{avg}))$ (8)\n$W_{max} = F_{ex2}(v, W_e) = \\sigma(W_{e2}\\delta(W_{e1}V_{max}))$ (9)\n$W_{total} = W_{max} + W_{avg}$ (10)\n$t_{train}: = F_{scale}(W_{totali}, t_{train_i}) = W_{total}:t_{train};$ (11)\nwhere $\\delta$ denotes the ReLU activation function, and $\\sigma$ denotes the sigmoid activation function. The matrices $W_{e1} \u2208 \\mathbb{R}^{\\frac{C_3}{r}\u00d7C_3}$ and $W_{e2} \u2208 \\mathbb{R}^{C_3\u00d7\\frac{C_3}{r}}$ denote the weight matrices of the first and second fully connected layers, respectively. The vectorv, obtained through the aforementioned squeeze operation,corresponds to either the maximum pooling method (vmax) orthe average pooling method (vavg). We denotes the weight co-efficient matrix. Subsequently, the previously acquired weightvectors wmax and wavg are summed and then channel-wise multiplied with the input spectral feature Ttrain. This processyields the final spectral feature map, denoted as $\\widehat{Ttrain}$, withdimensions 1 \u00d7 24 \u00d7 64. The calculation expression for thei-th channel feature map, denoted as ttrain, is as follows:"}, {"title": "B. Experimental results with the channel-wise attention-based PLS-1D-CNN model for screening infected individuals and conducting comparative experiments and analysis", "content": "To validate the ability of theintroduced channel-wise attention-based PLS-1D-CNN modelto accurately distinguish ATR-FTIR spectral signals frompositive and negative samples, especially with limited samplesizes. We employed the proposed channel-wise attention-based PLS-1D-CNN model to classify the spectral signals ofnasopharyngeal swabs collected in collaboration with BeijingYouan Hospital into negative and positive categories. A five-fold cross-validation approach are employed during the modelimplementation. This involved using 80% of spectral signaldataset for training and reserving 20% for evaluating thethe model's performance. 80% of the spectral signals, afterbaseline correction using the airPLS algorithm as depicted inFig. 3, are directly input into the channel-wise PLS-1D-CNNmodel as the training set. The model outputs the correspondingtrue negative or positive label for training purposes."}, {"title": "1) Experiment and results:", "content": "To further demonstrate that the PLS submodel can effectively reduce the dimensionality of spectral data while extracting highly informative features correlated with the target variable, enhancing the recognition ability of infrared spectral signals for distinguishing between positive and negative nasopharyngeal swabs, we conducted an ablation experiment. In this experiment, we directly utilized the 874-dimensional ATR-FTIR spectral signal, after baseline correction with the airPLS algorithm, as the input for the 1D-CNN submodel."}, {"title": "4) Analysis and conclusion from experiments:", "content": "In summary,while the MRMR method combined with an SVM classifierachieves a high specificity of 96.56% and a sensitivity of91.33%, and the chi-square test method with an SVM classifierreaches a specificity of 96.00% and a sensitivity of 91.62%,both fall slightly short of the World Health Organization(WHO) recommended standards [54], which require point-of-care tests for prior SARS-CoV-2 infection to have a sen-sitivity above 90.00% and a specificity exceeding 97.00%.In contrast, our proposed channel-wise attention-based PLS-1D-CNN model demonstrates superior performance, achievingan accuracy of 96.48%, sensitivity of 96.24%, specificity of97.14%, F1-score of 96.12%, and an AUC score of 0.99.It not only meets the WHO's point-of-care testing standardsbut also satisfies the more stringent requirement of 95%sensitivity and 97% specificity for testing prior SARS-CoV-2infection in moderate to high-volume scenarios. The proposedscreening system leverages spectra from a limited number ofcollected nasopharyngeal swab samples to directly construct a model"}, {"title": "2) Comparative experiments:", "content": "To verify the superior per-formance of the channel-wise attention-based PLS-1D-CNNmodel proposed in this study for distinguishing the infraredspectral signals of nasopharyngeal swabs from patients in-fected with SARS-CoV-2 and those not infected, we comparedour model with various respiratory virus spectrum classifica-"}, {"title": "VI. CONCLUSION", "content": "In this study, we developed a system that combines ATR-FTIR with airPLS preprocessing and a channel-wise attention-based PLS-1D-CNN model to accurately identify SARS-CoV-2 infections within 10 minutes, using a limited num-ber of nasopharyngeal swabs from suspected patients. Given that ATR-FTIR spectra are highly susceptible to variations in experimental conditions, which can affect their quality, we proposed a biomolecular importance (BMI) evaluation method to quantitatively assess the significance of virus-related biomolecules in distinguishing high-quality spectral signals collected under different conditions. This approach reveals the underlying biological correlations, facilitating the selection of superior spectra and standardizing experimental procedures to ensure consistent and reliable signal collection. Additionally, the proposed channel-wise attention-based PLS-1D-CNN model integrates the linear feature extraction capa-bility of PLS, effectively handling multicollinearity and high correlation in spectral data by transforming features into a low-dimensional space that retains the most relevant informa-tion for classification labels, while leveraging the nonlinear feature learning ability of CNN. Furthermore, the channel-wise attention mechanism dynamically adjusts each feature channel's importance, ensuring the model focuses on the most relevant features, thereby enhancing both feature selection and classification performance.\nExperimental verification on nasopharyngeal swabs col-lected in Beijing Youan Hospital from suspected SARS-CoV-2 patients validated our model's superior performance. It outper-formed various classifiers such as LDA, SVM, GBM, and RF combined with feature extractors like SPA, MRMR, reliefF, chi-square test, and PLS, as reported in recent literature. This proposed screening system shows promise for early detection of new respiratory viruses and is potentially well-suited for large-scale screening at critical locations such as airports, hospitals, schools, and train stations.\nIn our future work, we have identified two directions to pursue. Firstly, we will collect more spectral signals from nasopharyngeal swabs of SARS-CoV-2 patients, further val-idating the stability and consistency of the proposed channel-wise attention-based PLS-1D-CNN model. Secondly, we will enhance the model's functionality to include the identification of specific types of SARS-CoV-2 infection within the detected positive cases."}]}