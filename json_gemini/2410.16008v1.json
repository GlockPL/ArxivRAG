{"title": "Resilient Temporal GCN for Smart Grid State Estimation Under Topology Inaccuracies", "authors": ["Seyed Hamed Haghshenas", "Mia Naeini"], "abstract": "State Estimation is a crucial task in power systems. Graph Neural Networks have demonstrated significant potential in state estimation for power systems by effectively analyzing measurement data and capturing the complex interactions and interrelations among the measurements through the system's graph structure. However, the information about the system's graph structure may be inaccurate due to noise, attack or lack of accurate information about the topology of the system. This paper studies these scenarios under topology uncertainties and evaluates the impact of the topology uncertainties on the performance of a Temporal Graph Convolutional Network (TGCN) for state estimation in power systems. In order to make the model resilient to topology uncertainties, modifications in the TGCN model are proposed to incorporate a knowledge graph, generated based on the measurement data. This knowledge graph supports the assumed uncertain system graph. Two variations of the TGCN architecture are introduced to integrate the knowledge graph, and their performances are evaluated and compared to demonstrate improved resilience against topology uncertainties. The evaluation results indicate that while the two proposed architecture show different performance, they both improve the performance of the TGCN state estimation under topology uncertainties.", "sections": [{"title": "I. INTRODUCTION", "content": "State Estimation (SE) is a critical function in power systems, essential for effective monitoring, planning, and operations. With the large deployment of measurement devices, such as Phasor Measurement Units (PMUs), vast amount of data is generated that are being utilized through data-driven methods for SE [4]-[6] to complement the conventional model-based SE techniques [1], [2]. Recently, machine learning (ML) models for SE have gained significant attention.\nGiven that measurement data from power systems inherently possess structures due to the underlying physical network of the system and physics of the electricity, Graph Neural Networks (GNNs) have been particularly effective. In GNN models, both the measurement data and the system's graph are essential components for constructing the model. The mea- surement data provides information on the state of the power system, while the graph represents the system's topology, specifying how different nodes (such as buses, substations, and generators) are interacting. This combination allows GNN models to effectively capture and leverage the complex interac- tions and dependencies inherent in the power system, leading to more accurate and robust state estimation.\nIn GNN, both the measurement data and the system's graph are vulnerable to inaccuracies caused by noise, attacks, or system failures. While numerous studies have assessed the impact of noise and cyber attacks, such as False Data Injection Attacks (FDIAs), in the system measurements on SE models [11], the effects of uncertainties in the system's graph infor- mation due to noise, attacks or failures remain underexplored and inadequately addressed. While topology uncertainties can affect the links, nodes, and connection weights within the graph, this paper primarily focuses on uncertainties impacting the links. Such uncertainties may arise from noise that alters the perceived status of a link to either up or down in the system's topology, or from deliberate attacks on topology information designed to mislead GNN models.\nThis paper aims to study the effects of the aforementioned topology uncertainties on a specific Temporal Graph Convo- lutional Network (TGCN) model for SE in power systems initially presented in [10]. Next, in order to make the model resilient to topology uncertainties, modifications in the TGCN model are proposed to incorporate a knowledge graph, gener- ated based on the measurement data. This knowledge graph supports the assumed uncertain system graph. Three methods for defining the knowledge graph are explored in the design of the resilient TGCN. Additionally, two variations of the TGCN architecture are introduced for integrating the knowledge graph in the model. The performance of the proposed resilient TGCN models is evaluated across the two architecture variations and the three knowledge graph designs and compared with the original TGCN model for SE under topology uncertainties. The results demonstrate that while all the studied variations improve the TGCN's performance under topology uncertain- ties, certain configurations offer greater improvement.\nOur main contributions are summarized as follows:\n\u2022\tThe effects of topology uncertainties in the form of link removal and link addition are evaluated for the TGCN- based SE initially proposed in [15].\n\u2022\tA resilient TGCN model, namely, Knowledge Graph Infused Model (KGIM) SE, is proposed based on in- tegrating a measurement-based knowledge graph into the original TGCN model. This model augments the uncertain graph with the knowledge graph, which im- proves message passing within the TGCN, improving the performance under topology uncertainties.\n\u2022\tA variation of the KGIM, called the Parallel Knowledge Graph Infused Model (PKGIM), is designed to integrate"}, {"title": "II. RELATED WORK", "content": "SE is a crucial function that enhances situational aware- ness, ensuring the efficient and reliable operation of power systems. Conventional SE methods are generally physics- based models that rely heavily on the system model [1]\u2013[3]. Recently, research on data-driven SE [4]\u2013[6] has grown, aim- ing to complement and enhance the conventional techniques. These approaches often use ML to process the abundance of measurement data from these systems and improve SE performance under system model changes [7], [8], missing or inaccurate information [9], and physical and cyber stresses [17], [21]. Among various ML techniques GNNs are gaining more attentions recently due to their abilities in capturing the underlying interactions among the measurement data from the power systems [11]-[14]. While numerous studies have evaluated the effects of noise and cyber attacks, such as FDIA, on power system measurements and SE models [11]\u2013 [15], [18], [19], research on the impact of uncertainties in the system's graph on GNN models remains limited. For instance, recent works in [22]-[24], [26] have assessed the vulnerability of general GNN models to topology information attack and noise; showing that adding or removing links can significantly degrade GNN performance in tasks such as node classification, graph representation learning and link prediction in applications including social network [36], citation network [22], [26], [34], water systems [35] and energy management systems [16]. Some of such studies are focused more on topology attack detection [20], [35] and some focused on developing defense against topology attacks [23]-[25] and mitigating the impact of topology noise in GNNs [26]\u2013[28].\nIn power systems, the works presented in [15], [16], [29]\u2013 [32] studied the effects of topology noise and attacks on various functions, such as SE and cyber stress detection. For instance, the work presented in [16] examines the impact of topology poisoning attacks on the economic operation of smart grids, particularly optimal power flow. The impact of topology noise or attack on SE was investigated in [15]. In this study, a temporal GNN framework is used to perform the SE task in the presence of topology noise, such as missing or extra links in the topology. According to [15] topology noise or attack in power systems can be modeled as FDI attacks on topology information. For instance, in [9], a Graph Signal Processing (GSP) technique was used to detect and locate topology attack in power systems. This GSP-based technique relies on local and global smoothness features of the graph signals, which enables detecting and locating FDI attacks on the graph's topology.\nOther studies on graph topology attacks, such as [30], examine how man-in-the-middle attacks manipulate meter and network switch data to mislead the control center. To defend against such attacks, [30] proposes securing a subset of meters that are critical to the grid's observability. This approach is known as \u201ccover-up-strategy\u201d which involves protecting specific line flow meters and bus injection meters to ensure that attacks will be detected. The study presented in [31] explores an advanced persistent threat scenario, where attackers gradually alter the power grid's topology to disrupt SE. It proposes a detection method based on the expected energy of normalized residues and a paired t-test. This method is designed to detect the cumulative effect of multiple small perturbations, identifying anomalies over several SE cycles.\nThe authors in [29] introduce a time-synchronized GNN- based SE framework that exploits a GCN to aggregate infor- mation from neighboring nodes and a GAT to focus on im- portant neighboring information by adjusting their weight.The GAT layer helps the GNN model adapt to topology changes by prioritizing the most relevant neighboring nodes, thus making the model more resilient to changes in the system topology.\nCreating and utilizing a knowledge graph based on system measurements is another approach that has been used in topology noise and abnormality detection in GNNs [38] and fault diagnosis [37] in power systems. This approach involves developing a structured representation of information as a net- work of entities and their relationships. For example, in [38], knowledge graphs derived from system measurements serve as the sole input to a GNN for distinguishing between the original and noisy grid topologies. In another study [37], knowledge graphs are constructed using extensive data from power system measurements to identify and diagnose faults within electrical power systems. By leveraging these information-based graphs, this work aims to enhance the accuracy and effectiveness of fault detection and diagnosis processes.\nThe most similar work to the current paper is presented in [32], which proposes a robust SE method for distribution networks with inaccurate topology information. In the latter model, a knowledge graph derived using an aggregated k- nearest neighbor approach and the original inaccurate graphs are input into an adaptive multi-channel GAT model to fuse graph embeddings. While our proposed model also incorpo- rates a knowledge graph into the SE framework, it differs in its GNN-based models, including the architecture, fusion process, and knowledge graph derivation. Furthermore, [32] evaluates"}, {"title": "III. PROBLEM FORMULATION", "content": "=\nIn this paper, the physical structure of the power system is represented as a graph G = (V,E), where V is the set of vertices representing the buses (total N buses), and E = {eij : (i, j) \u2208 V \u00d7 V} is the set of edges (total M edges) representing the transmission lines of the power system. The connectivity in the graph can be captured in the adjacency matrix, A = [aij], where aij = 1 for eij \u2208 E and zero, otherwise. A graph signal at time instancet is denoted by S(n,t) and is defined by assigning values corresponding to the attributes of interest to each node, n \u2208 V in the graph, thereby establishing a signal over the domain V. Various attributes can be associated with each bus, for instance, the bus voltage magnitude and phase angle, real and reactive power injections, injected bus current magnitude and angle, and frequency. This work considers the phase angle at the buses as a time-varying graph signal. It is assumed that the measurements are available at all the buses of the system through PMUs."}, {"title": "A. Power Systems as Graphs", "content": "=\nIn this paper, the physical structure of the power system is represented as a graph G = (V,E), where V is the set of vertices representing the buses (total N buses), and E = {eij : (i, j) \u2208 V \u00d7 V} is the set of edges (total M edges) representing the transmission lines of the power system. The connectivity in the graph can be captured in the adjacency matrix, A = [aij], where aij = 1 for eij \u2208 E and zero, otherwise. A graph signal at time instancet is denoted by S(n,t) and is defined by assigning values corresponding to the attributes of interest to each node, n \u2208 V in the graph, thereby establishing a signal over the domain V. Various attributes can be associated with each bus, for instance, the bus voltage magnitude and phase angle, real and reactive power injections, injected bus current magnitude and angle, and frequency. This work considers the phase angle at the buses as a time-varying graph signal. It is assumed that the measurements are available at all the buses of the system through PMUs."}, {"title": "B. Topology Inaccuracies", "content": "As discussed earlier, in graph-aware analysis of data from power systems, the system's graph information is a crucial component of the model; however, it is vulnerable to in- accuracies caused by noise, attacks, or missing information. Specifically, noise in topology information can arise from limited observability in the system due to missing, failed, or malfunctioning sensing and monitoring devices, as well as from failed or noisy communication links that cannot accurately capture the true state of system components (e.g., unrecorded transmission line trips). Such inaccuracies are random in nature. On the other hand, attacks on topology information involve the deliberate injection of incorrect data about the components or their connections within the system's graph that can mislead GNN and GSP-based models.\nIn this work, the notation G' = (V', E') is used to represent the inaccurate topology, as opposed to the true system topology G = (V,E) defined earlier. While both node and edge infor- mation are vulnerable to inaccuracies due to noise or attack, this work focuses specifically on inaccuracies in the graph's links. It is assumed that E' differs from E by the presence of a few extra or missing links. Furthermore, it is assumed that there are either extra links or missing links, but not both simultaneously. Exploring the impact of having both missing and extra links in the topology could be a potential direction for future research. Here, ef denotes an extra edge mistakenly present between nodes i and j, and e denotes a missing edge that originally existed between nodes i and j in the graph. In this model with inaccurate topology information, the adjacency"}, {"title": "C. A Review of TGCN Model for State Estimation", "content": "This study builds upon the TGCN framework, first in- troduced in [10]. In this section, a brief overview of the framework is presented to set the stage for the following sections, where the effects of uncertain topology on SE using TGCN is studied. In this study, phase angle xn, defines the state of node n and the system state for all the nodes at time t is denoted by Xt := [xn,t]T, which is a vector of size N. The model performs one-step-ahead state prediction by capturing both the spatial and temporal interactions in the data through message passing within neighborhoods and a Gated Recurrent Unit (GRU), respectively.\nAs such, the TGCN framework comprises two layers. The first layer is a graph convolution layer that utilizes a message passing framework to effectively capture the system's structure and interactions among its components. The graph convolution layer can be formulated as $H^{l+1} = \\sigma(\\tilde{D}^{-\\frac{1}{2}}\\tilde{A}\\tilde{D}^{-\\frac{1}{2}}HW_l)$, where $\\tilde{A} := A+I_N$, with A representing the adjacency matrix and $I_N$ being the identity matrix of size N. Additionally, $\\tilde{D} := I_N \\Sigma\\tilde{A}_{ij}$ serves as the degree matrix. Here, $\\sigma(\\cdot)$ denotes the sigmoid activation function, and $H^l$ represents the output of layer l with weights $W_l$. In graph convolution layer, the number of layers, l, is set to two with the output layer corresponding to l = 2. The second layer of the TGCN framework is a GRU layer, which is responsible for capturing temporal dependencies within the time-series data. Stacking the GRU model with the GCN forms a temporal GCN, initially introduced in [33]. The TGCN procedure can be outlined as follows."}, {"title": "IV. RESILIENT TGCN FRAMEWORK", "content": "The experiments indicate that the TGCN framework is sen- sitive to the system's topology, and inaccuracies in topology information can lead to performance degradation in SE. These findings are illustrated under both the original topology and inaccurate topologies with missing or extra links in Figures 3-5 of Section V, where they are discussed in detail. In this section, the goal is to revise the reviewed TGCN framework to develop a resilient TGCN for SE that can withstand topology inaccuracies. Specifically, two variations of the model are introduced: Knowledge Graph Infused Model (KGIM) and Parallel Knowledge Graph Infused Model (PKGIM). Both models incorporate a knowledge graph, generated from the measurement data, to supplement the potentially inaccurate system topology used in the model. As such, next, the knowl- edge graph is introduced, followed by two subsections that discuss the KGIM and PKGIM models."}, {"title": "A. Knowledge Graph", "content": "Although the true system topology may not be available, the relationships and interactions among measurements can be learned directly from the data. The goal here is to design a knowledge graph based on system measurements to enhance spatial information processing and learning in the GNN with possibly inaccurate graph input. The knowledge graph is denoted by Gk = (Vk, Ek) with an adjacency matrix Ak. Here, in designing the knowledge graph, it is assumed that the focus is to learn the connections among the known nodes; as such Vk = V. The learned links between nodes can capture various relationships, such as similarity or correlation among node attributes. Several approaches can be used to define the knowledge graph. Three of these methods are discussed below.\n1) Cosine Similarity-based Knowledge Graph: A knowl- edge graph can be defined based on the similarity among the measurement attributes at the nodes of the system. Here, cosine similarity between nodes i and j attributes i.e., phase angles, defined as $S_{ji} = \\frac{v_i v_j}{||v_i||||v_j||}$, can be exploited to build the knowledge graph, where vi represents the attributes of node i. However, using the sij values alone to define connections in the knowledge graph results in a dense graph with numerous connections of varying similarity weights. To address this, a threshold is necessary to filter out connections with lower similarity values. Specifically, the mean similarity value over all links, denoted as 5, is used to set the threshold, defined as T = a\u0161. Various a values ranging from 0.75 to 2.75 were tested to fine-tune the knowledge graph, ensuring that the three different approaches of designing knowledge graph produced a similar number of links. The value a = 2.17 was found to be effective in achieving this balance.\n2) Correlation-based Knowledge Graph: The knowl- edge graph can also be defined based on the correla- tion among the measurements at the nodes of the sys- tem. Specifically, the Pearson correlation, defined as $C_{ji} = \\frac{(v_i - \\bar{v}_i)(v_j - \\bar{v}_j)}{\\sqrt{(v_i - \\bar{v}_i)^2(v_j - \\bar{v}_j)^2}}$ can be used to define the"}, {"title": "B. Knowledge Graph Infused Model (KGIM) for SE", "content": "The KGIM variation of the TGCN model for SE includes an additional module for generating the knowledge graph using one of the previously mentioned approaches. This knowledge"}, {"title": "C. Parallel Knowledge Graph Infused Model (PKGIM) for SE", "content": "The KGIM model, introduced in the previous subsection, integrates the knowledge graph directly with the initial input topology enabling temporal and spatial learning on the com- bined topology. In the next model, named PKGIM, the learning process is performed separately and in parallel on the initial topology and the knowledge graph and then the resulting node embeddings are fused into a consolidated state estimate. As the initial input topology is assumed to be close to the true system topology (with inaccuracies affecting only a small number of links), this model allows leveraging the structural information of the initial topology for SE before integrating the knowledge graph; thereby utilizing the graph's structural details more ef- fectively. Figure 2 provides an overview of the PKGIM model. The aggregation module plays a crucial role in supporting the TGCN against potential topology inaccuracies by combining the trained node embeddings from both the original graph and the knowledge graph. In the following, three approaches for designing aggregation module are discussed. The goal of these designs is to utilize and merge the embeddings from the two graphs through feature learning.\n1) Single-Layer Perceptron (SLP) Aggregation: In the first design for the aggregation module, a simple SLP is utilized as described below.\n$Y_t = \\sigma(W_3((W_1X_{1,t})||(W_2X_{2,t}))) \\\\$ \nAs shown in equation (5), initially two linear transforma- tions are applied separately to the trained node embeddings from each channel of PKGIM, denoted as X1,t and X2,t.\nThese are then concatenated to produce a new embedding with normalized values. The concatenated embedding matrix is then passed through another linear transformation layer, where it is multiplied by W3, followed by a ReLU activation function,\n\n\\sigma(.). This process results in a weighted output Yt, which consists of aggregated node embeddings bounded by the range determined by the ReLU function.\n2) Multi-Layer Perceptron (MLP) Aggregation: Another aggregation method used in the TGCN framework involves applying an MLP as discussed below.\n$Y_t = W_2(\\sigma(W_1(X_{1,t}||X_{2,t}))) \\\\$\n\nA significant difference between SLP and MLP aggregation methods is how the initial linear transformation layer is implemented in the architecture. Here, X1,t and X2,t denote the trained node embeddings of the original and knowledge graphs, respectively, while Y represents the aggregated em- beddings. We utilize the ReLU activation function, denoted by \u03c3(.), and W\u2081 and W2 referring to the weight matrices used for the linear transformation of the graph features at each layer. Initially, this method concatenates X1,t and X2,t of both the original and knowledge graphs. The concatenated embeddings then undergo a linear transformation, multiplied by W\u2081, followed by the \u03c3(.) activation function. The final linear transformation layer assigns weighted values W\u2082 to the new embedding matrix from the previous layer, highlighting the importance of specific nodes relative to others. This architecture allows the MLP to process the input without requiring explicit normalization at the output.\n3) Attention Aggregation: The final data-driven aggregation method implemented in our SE model is \"Attention Aggre- gation\". This method merges node embeddings using learned weights derived from the embeddings, refined through multiple iterations. The process in this model is formulated as:\n$W = \\sigma(W(X_{1,t}||X_{2,t})) $\n$Y_t = W^T X_{cat} $\n\nIn equation (7), the weight matrix W is learned iteratively in the initial layer of the attention aggregation model. First, the trained node embeddings from the original and knowledge graphs, X1,t and X2,t, are concatenated. These concatenated embeddings are then linearly transformed by multiplying with W, followed by applying a SoftMax activation function \u03c3(.).\nThis process results in a weighted matrix that integrates fea- tures from both graphs. In the subsequent layer, the weighted"}, {"title": "V. PERFORMANCE EVALUATION", "content": "This section evaluates the performance of the resilient TGCN framework in scenarios involving topology inaccura- cies, such as missing or additional edges in different parts of the system's topology."}, {"title": "A. Data Generation and Data Preparation", "content": "Here, the IEEE 118 bus system is utilized to generate a large dataset of synthesized PMU time-series through simu- lations with MATPOWER [40]. Following the methodology in [10], the dynamics and temporal aspects are incorporated using load profiles from the New York Independent System Operator (NYISO) [41], sampled at 30 Hz. The simulated state variables include time-series data for bus phase angles. The IEEE 118 bus system has 186 transmission lines and 7 dual links connecting the buses, resulting in a total of 179 links when treating each dual link as individual links. The topology inaccuracy scenarios involving missing and extra edges are structured as follows: (1) Incorrect Missing Edge Scenario: For each node (bus), one connected line is removed at a time to form G'. The performance of the TGCN framework is averaged over all missing line scenarios for each node, covering the entire system. (2) Incorrect Extra Edge Scenario: In each scenario, an additional line is introduced between the target bus and a nearby bus within a radius R. The radius R = 500 is considered based on geographical coordinates, ensuring proximity between the target and new neighboring buses. This results in 406 inaccurate topologies, each differing from the original by the addition of a single extra link in the bus network graph. The TGCN's performance with G' is averaged over all extra line scenarios at each node."}, {"title": "B. Performance of the Proposed Resilient TGCN", "content": "In this section, first, the performance of KGIM is evaluated and presented. Figure 3 shows the KGIM performance under the two aforementioned inaccurate topology scenarios. The model's performance is evaluated using Root Mean Square Error (RMSE) as the key metric to measure prediction accu- racy. The red line in the plots represent the original TGCN SE model's performance for different inaccurate topology scenarios and the yellow point indicates the average RMSE of the original TGCN SE model with true topology."}, {"title": "VI. CONCLUSION", "content": "The vulnerability of GCN-based models to noise in underly- ing graph topology is a critical concern, especially when these models support vital functions like state estimation in power systems. This study aimed to introduce and evaluate various re- silience methods to protect GNN-based SE frameworks against different inaccurate topology scenarios, including missing and extra links in the power system graph due to inaccurate data or deliberate adversarial attacks. In this study, two distinct resilient models proposed and designed not only to safeguard but also to enhance the performance of a GNN-based SE frameworks. Central to these models is the integration of an additional graph, known as the knowledge graph, created based on the PMU data. Three methods utilized to generate the knowledge graph: two statistical methods\u2014cosine similarity and Pearson correlation analysis\u2014and a data-driven method utilizing the GAT model. Using the IEEE 118 bus system as the test case, the performance of a temporal GCN SE model analyzed, which incorporates message-passing framework and GRU model for spatial and temporal processing in smart grids. Our findings indicate the effectiveness of these methods in fortifying the TGCN model against various uncertainties in power network. It is quantitatively determined which resilient model outperformed other in terms of mitigating the impact of inaccurate topology. Additionally, the effectiveness and potential of each knowledge graph generated in this study were evaluated and compared within each resilient model, based on the numerical results obtained."}]}