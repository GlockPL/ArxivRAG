{"title": "Modeling Image Tone Dichotomy with the Power Function", "authors": ["Axel Martinez", "Gustavo Olague", "Emilio Hernandez"], "abstract": "The primary purpose of this paper is to present the concept of dichotomy in image illumination modeling based on the power function. In particular, we review several mathematical properties of the power function to identify the limitations and propose a new mathematical model capable of abstracting illumination dichotomy. The simplicity of the equation opens new avenues for classical and modern image analysis and processing. The article provides practical and illustrative image examples to explain how the new model manages dichotomy in image perception. The article shows dichotomy image space as a viable way to extract rich information from images despite poor contrast linked to tone, lightness, and color perception. Moreover, a comparison with state-of-the-art methods in image enhancement provides evidence of the method's value.", "sections": [{"title": "1. Introduction", "content": "Photography means \"drawing with light,\u201d derived from the Greek photo, which means light, and graph, which means to draw. Light is the most critical variable when conceiving a mathematical model, but it is still daunting how difficult it is to encapsulate their meaning. Light permeates analog and digital photography through the concepts of brightness, lightness, and lu-"}, {"title": "", "content": "minance, affecting tone and other attributes of color appearance. Classical approaches to regulate the amount of light in an image are made through gamma correction or gamma, a nonlinear operation used to encode or decode luminance, and defined by the following power law expression:\n$V_{out} = AV_{in}^{\\gamma}$,\nwhere the non-negative real input value $V_{in}$ is raised to the power $\\gamma$ and multiplied by a constant $A$ to get the output $V_{out}$. Usually, $A = 1$ and domain and codomain are in the range {0...1}.\nThere are two power-law effects on an image: 1) encoding gamma if $\\gamma < 1$ with a compressive nonlinear result known as gamma compression, and 2) decoding gamma if $\\gamma > 1$ whose expansive nonlinear result derives the name gamma expansion. Both effects intend to improve human perception of brightness or lightness under common illumination conditions. This empirical relationship and its theory is known as Steven's power law, named after psychophysicist Stanley Smith Stevens [1] and has a close relationship with Weber-Fechner logarithmic function [2]. The aim is to make apparent significant individual differences in data. We keep on with the power function, although anyone with mathematical knowledge could easily derive the results exposed in this article for other functions. The goal in this paper is to present a new mathematical modeling based on the power function, which extends the capacities to represent image content from the viewpoint of tone perception and invariant information extraction. Application of gamma correction have been instrumental in many technologies such as: CRT (cathode ray tubes) of television, modern display devices, and computer graphics [3]. In fact, the application in film photography known as sensitometry has its origin in the work of Ferdinand Hurter and Vero Charles Driffield (circa 1976) and the density-exposure curve, characteristic curve or H&D curve [4].\nThe relevance of the power law for lightness modeling attracts the interest of scientists and engineers. For example, Gopalan and Arathy describe a fuzzy approach for image enhancement considering underexposed and overexposed regions [5]. The aim was to manipulate image properties like intensity, contrast, and number of gray levels through fuzzy sets. Yelmanov and Romanyshyn also work on the image enhancement problem [6]. This work applies an adaptive power-law image intensity transformation for real-time video sequences. Huang et al. introduced efficient contrast enhancement methods based on adaptive gamma correction with weighting"}, {"title": "", "content": "distribution [7]. The method modifies histograms to improve the brightness of dimmed images. In the work of Rahman et al., the goal is also image enhancement while attempting to manipulate image information through an adaptive gamma correction [8]. The authors highlight the limitations of image-capturing devices, producing that image quality may be degraded, and multiple factors that compromise the user's expectation of clear and soothing views. Hence, based on adaptive gamma correction, the proposed algorithm improves image contrast and produces natural illumination. Wang et al. apply gamma correction in combination with deep neural networks for low-light image enhancement [9]. Authors argue that exponential functions are computationally demanding and propose a simplification through Taylor expansion when integrating the operation within the network layers. As we can appreciate, all reviewed works on image enhancement through the power law attempt to obtain visually pleasing images, mainly when there is low-light image exposure. Such methods look for an optimal parameter without considering that extracting visual information requires multiple values, each improving a particular case: underexposed, overexposed, or a combination of both, regardless of image semantics. In another work, Moroz et al. present power function algorithms implemented in hardware [10]. That work highlights the critical importance of efficient hardware implementation of power functions for tasks such as accelerators of neural networks, power electronics, machine learning, computer vision, and intelligent robotic systems.\nIn a different research trend, scientists highlight the idea of dichotomy in image analysis. For example, Blakeslee and McCourt [11] criticize the theoretical approaches to lightness and perception presented by Gilchrist [12]. We observe that new mathematical reasoning about lightness, brightness, and contrast is necessary, and the present article aims to open new research avenues not only for the physics of image formation but also from the neuroscientific viewpoint. Indeed, there is only one work in computer vision where scientists use the term dichotomous for image segmentation based on empirical reasoning applying implicit modeling through a database [13]. There is no formal definition of the concept nor mathematical reasoning to describe dichotomy in image analysis in general. Other efforts to understand dichotomy from a mathematical perspective include the work of Brill and Carter, where they revisited the dichotomy between the logarithmic and power-law models of lightness perception [14]. The work highlights the necessity of a new luminance scale-invariance to describe the equality of lightness differences correctly. Finally, Bi et al. proposed the existence of mechanisms in the natural"}, {"title": "", "content": "visual system to comprehend central-peripheral dichotomy [15]. This article aims to present a mathematical analysis of tone image dichotomy that can be helpful not only in color but in time and space, as well as for practical photography and as a tool for studying natural and artificial systems. The main contributions of this article are:\n1. The introduction of the concept of image tone dichotomy for computational photography.\n2. The proposal of a mathematical model helpful to improve image information that is underexposed, overexposed, and a mixture of both cases where, in this last case, the dichotomy is more apparent.\n3. The derivation of properties for image tone dichotomy following deductive reasoning with practical implications.\n4. The reasoning for building image dichotomy space to extract illumination information is similar to scale space theory.\n5. Illustrative examples to improve image information whose photographs were badly exposed independently of aperture, shutter speed, and ISO.\n6. A comparison with state-of-the-art image enhancement methods shows the proposal obtains consistent best values in a standard test.\nOrganization of the paper.\nIn Section 2, we present the power function and the properties necessary to understand the mathematical reasoning. The main achievement of this work is in Section 3. The concept of an image as the graph of a function [16] serves to understand the analysis of tone dichotomy through gamma correction. The Theorem 1 and Lemmas 6 to 14 provide the necessary tools to implement practical results. Section 4 offers three examples of underexposed, overexposed, and a mixture of both problems to illustrate the ability to extract visual information from images with poor contrast. We provide a complete test using two standard metrics on a low-light image enhancement problem to show that the proposed approach outperforms state-of-the-art methods. Finally, we close the paper with a discussion about the implications of this work in image formation, as well as a conclusion and future work."}, {"title": "2. Preliminaries and Auxiliary Results", "content": "The power function is part of algebraic-real functions subdivided into rational and irrational functions [17]. The power function basic equation is:\n$f(x) = ax^n  n = 1, 2, 3, ...$\nHowever, the most general algebraic power functions are written as follows:\n$f(x) = x^{\\frac{m}{n}}$,\nnote that such an equation could be interpreted as the n-th root of the m-th power:\n$f(x) = x^{\\frac{m}{n}} = \\sqrt[n]{x^m}$"}, {"title": "3. Dichotomy in Tone Image Analysis and Processing", "content": "The meaning of dichotomy is commonly and often confused. People generally use the term to talk about the division into two mutually exclusive or contradictory groups. Curiously, the word is found in the company of the term false, creating the meaning of a false dichotomy, which refers to the situation when someone is given only two choices when, in reality, there are many more available. The correct meaning of dichotomy proceeds etymologically speaking from the prefix \"di,\u201d which means split into two or more, like in divide, which means to split into parts; dialogue implies a conversation between two or more people; and diverse, which, signifies varied or different-finally, the greek word \"tomy\" meaning cutting, incision. The following section will introduce a new mathematical model to manage tone and light to emphasize contrast. Before continuing with the mathematical analysis, let us introduce the concepts of contrast and tone.\nContrast refers to the relative brightness of any point in a color space, normalized to 0 for darkest black and 1 for lightest white. It is the difference in the luminance of a color that enables us to see the contrast. Regarding human perception, a difference in luminance matters more than a color difference. Tone, on the other hand, is simply a combination of color or a greyed-down hue. If a hue is mixed only with white or black, it stays a pure tint or shade. Hence, tone refers to the brightness levels in the photograph, from solid black to pure white. Shadows are dark tones, and highlights are bright tones.\nDefinition 1. [Image as the graph of a function]. Let $f$ be a function $f:U\\subset R^2 \\rightarrow R$. The graph or image $I$ of $f$ is the subset of $R^3$ that consists of the points $(x,y, f(x,y))$, in which the ordered pair $(x,y)$ is a point in $U$ and that $f(x,y)$ is the value at that point. Symbolically, the image $I = \\{(x, y, f(x, y)) \\in R^3|(x, y) \\in U\\}$."}, {"title": "", "content": "Definition 2. [Gamma correction] Given an input image $I$ with values $f_{in}(x, y)$ and the transformed image $I'$ with output values $f_{out}(x,y)$. Usually, the relationship follows a power law.\n$f_{out}(x, y) = f_{in}(x, y)^\\gamma 0 \\le f_{in} \\le 1$\nThe image increases the contrast in dark areas and loses it in light areas when $\\gamma < 1$, while for $\\gamma > 1$, the image rises its contrast in light areas and decreases it in dark places.\nThe result presents a difficulty in handling the dynamic range to adequately express the issue of tonal contrast. Note that the following lemmas associated to gamma correction depend on $\\gamma$.\nLemma 1. For any value of $\\gamma \\in (0,\\infty)$, it holds that:\n$f_{out}(x, y) = 0^\\gamma = 0$ and $f_{out}(x, y) = 1^\\gamma = 1$\nLemma 2. Let the range of values for the exponent be $0 < \\gamma < 1$, values of $f_{in}(x, y)$ close to 0 result in output values that change rapidly, while for values $f_{in}(x, y)$ close to 1; its change in the output values is small.\nLemma 3. Let the range of values for the exponent be $\\gamma > 1$, values of $f_{in}(x, y)$ close to 0 result in slowly changing output values, while for values $f_{in}(x, y)$ near 1; its change in output values is significant.\nLemma 4. For $\\gamma = 0$, there are no changes in the output values.\n$f_{out}(x, y) = f_{in}(x, y)^0 = 1$\nLemma 5. For $\\gamma \\rightarrow \\infty$, the values of $f_{in}(x,y)$ are defined by:\n$\\lim_{\\gamma\\rightarrow \\infty} f_{in}(x, y)^\\gamma = \\begin{cases} 0 & 0 \\le f_{in}(x, y) < 1\\\\ 1 & f_{in}(x,y) = 1 \\end{cases}$"}, {"title": "", "content": "Theorem 1. [Dichotomy function]. Given an image $I$ and a transformation function $f_{out}(x,y) = f_{in}(x,y)^{\\gamma_n}$, a reference function is calculated from the identity $\\gamma_0 = 1$, in addition to a contrasted image which is obtained with a $\\gamma_n \\neq 1$. The term $f_{in}(x,y)^{1} = f_{in}(x,y)$ represents the identity, while $f_{in}(x,y)^{\\gamma_n}$ are the $n$ different $\\gamma\\in \\{R^+U0\\}$ corrections applied to the input value. The difference between the contrasted function and the reference function $f_{out} = k|f_{in}(x, y)^{\\gamma_n} - f_{in}(x,y)|$ produces a function with a dichotomous behavior that magnifies the contrast produced by the transformation function, where k is a scale factor to normalize the output between $0 < f_{out}(x, y) \\le 1$.\nProof of Theorem 1. The application of the absolute value helps to calculate the actual distance from the reference function, although other approaches, such as the Euclidean distance, could be applied. Therefore, the resulting equation maximizes the difference of contrasts $DoC$ with two main slopes (positive and negative) and a unique inflection point where the maximum contrast located at $d_{max}$ is $DoC_{max} = max(f(x, y)^{\\gamma_n}-1)\\forall{\\gamma_n}$.\nIn the following we restrict the domain of definition. Properties of\n$f(x) = |x^{\\gamma} - x|$\nLemma 1. For any value of \u03b3 \u2208 (0,\u221e), it holds that:\nRegarding particular values, note that all power functions with n integer have\na zero value of x = 0. There are no discontinuities or poles. Also, there are\nno extreme values when n is odd; for n even, there is a minimum at x = 0\nfor a > 0. Also, there is no inflection point for n even, with a saddle point\nat x = 0 when n is odd.\nProperties of Equation (3)"}, {"title": "", "content": "Periodicity:\nDomain of definition:\nRange of values:\nn even\nn odd\nQuadrant:\nn even a > 0:\nn odd a > 0:\nMonotonicity:\nn even a > 0:\nn odd a > 0:\nAsymptotes:\nn even a > 0:\nn odd a > 0:\nSymmetries:\nn even\nn odd\nNone\n\u2212\u221e < x < \u221e\na > 0: 0 \u2264 f(x) < \u221e\na \u2260 0: \u2212\u221e < f(x) < \u221e\nfirst and second quadrants\nfirst and third quadrants\nx \u2265 0 strictly monotonically increasing\nstrictly monotonically increasing\nf(x) \u2192 +\u221e for x \u2192 \u00b1\u221e\nf(x) \u2192 \u00b1\u221e for x \u2192 \u00b1\u221e\nmirror symmetry about x = 0\npoint symmetry about x = 0, f(x) = 0\nwhere k is a scale factor to normalize the output between 0 < fout(x, y) \u2264 1.."}, {"title": "", "content": "Proof of Theorem 1. The application of the absolute value helps to calculate\nthe actual distance from the reference function, although other approaches,\nsuch as the Euclidean distance, could be applied. Therefore, the resulting\nequation maximizes the difference of contrasts DoC with two main slopes\n(positive and negative) and a unique inflection point where the maximum\ncontrast located at dmax is DoCmax = max(f(x, y)\u03b3n\u22121)\u2200n.\nIn the following we restrict the domain of definition. Properties of\nPeriodicity: None\nDomain of definition: 0 \u2264 x \u2264 1\nRange of values: 0 \u2264 f(x) < 1\nQuadrant: first quadrant\nMonotonicity: x < dmax strictly monotonically increasing\nx > dmax: strictly monotonically decreasing\nAsymptotes: None"}, {"title": "", "content": "Remark 4. About the particular values, note that the function has two zeros\nat x = {0,1}, one pole at x = 0, and there are no discontinuities. However,\nthere is one extreme value which is a maximum at x = dmax and issues with\nthe point of inflection or saddle points highlighted in the previous section\nbut which are mimimized by the scale factor k.\nIn the following and for simplicity, the function applied to the image is\ngiven by:\n$f_{out}(x, y; \\gamma) = |f_{in}(x, y) - f_{in}(x,y)^\\gamma| = \\begin{cases} f_{in}(x, y) - f_{in}(x, y)^\\gamma & 0 \\le \\gamma \\le 1 \\\\ f_{in}(x, y)^\\gamma - f_{in}(x, y) & \\gamma>1 \\end{cases}$"}, {"title": "", "content": "The reciprocal of the image (see Definition 1) is:\n$\\frac{1}{f_{out}(x, y; \\gamma)} = \\begin{cases} \\frac{1}{f_{in}(x, y) - f_{in}(x, y)^\\gamma} & 0 \\le \\gamma \\le 1 \\\\ \\frac{1}{f_{in}(x, y)^\\gamma - f_{in}(x, y)} & \\gamma>1 \\end{cases}$;\nnote that $f_{in}(x, y) \\neq \\{0,1\\}$.\nIn the following all properties are given using Equation (8):\nRecursion relation for \u03b3 = 2, 3, 4, ...\n$x^{\\gamma} - x = x(1 - x^{\\gamma-1})$\nThe sum of two polynomials, or the \u03b3 root of the n power, with 0 \u2264 \u03b3 \u2264 1:\n$a(x^{\\gamma} - x) +b(x^{\\gamma} - x) = (a + b)(x^{\\gamma} - x)$\nwith \u03b3 > 1:\n$a(x - x^{\\gamma}) \\pm b(x - x^{\\gamma}) = (a \\pm b)(x - x^{\\gamma})$\nProduct of two polynomials, or the \u03b3 root of the n power, with 0 \u2264 \u03b3 \u2264 1:\n$a(x^{\\gamma} - x)^c \\times b(x^{\\gamma} - x)^d = (ab)(x^{\\gamma} - x)^{c+d}$"}, {"title": "", "content": "with \u03b3 > 1:\n$a(x - x^{\\gamma})^c \\times b(x - x^{\\gamma})^d = (ab)(x - x^{\\gamma})^{c+d}$\nThe first derivative for 0 \u2264 \u03b3 \u2264 1:\n$\\frac{d}{dx}(x^{\\gamma} - x) = \\gamma x^{\\gamma-1} - 1$,\nwith \u03b3 > 1:\n$\\frac{d}{da}(x - x^{\\gamma}) = 1 - \\gamma x^{\\gamma-1}$.\nThe k-th derivative for 0 \u2264 \u03b3 \u2264 1:\n$\\frac{d^ky}{dx^k} \\begin{cases} \\gamma x^{\\gamma-1} -1 & k=1\\\\ \\prod_{i=0}^{i=k} (\\gamma - i) x^{\\gamma-k} & k>1\\end{cases}$\nwith \u03b3 > 1:"}, {"title": "", "content": "$\\frac{d^ky}{dx^k} = \\begin{cases} 1- \\gamma x^{\\gamma-1} & k = 1\\\\ -\\prod_{i=0}^{i=k} (\\gamma - i) x^{\\gamma-k} & k>1 \\end{cases}$\nThe primitive with 0 < \u03b3 < 1:\n$\\int_0^x (t^{\\gamma} - t) dt = \\frac{1}{\\gamma+1} \\frac{x^{\\gamma+1}}{2} - \\frac{1}{2} x^2$\nwith \u03b3 > 1:\n$\\int_0^x (t - t^{\\gamma}) dt = \\frac{1}{2} x^2 - \\frac{1}{\\gamma+1} x^{\\gamma+1}$\nFinally, the following lemmas and theorems result from Theorem 1.\nLemma 6. According to the term $f_{out}(x,y) = f_{in}(x,y)^\\gamma - f_{in}(x,y)$ when $\\gamma = 0$, $f_{out}$ is the inverse of the image:\n$f_{out}(x, y) = f_{in}(x, y)^0 - f_{in}(x, y) = 1 - f_{in}(x, y)$"}, {"title": "", "content": "Lemma 7. According to the term $f_{out}(x,y) = f_{in}(x,y) - f_{in}(x, y)^{\\gamma}$ when $\\gamma = \\infty$, $f_{out}$ behaves like the reference image $f_{in}$ except when $f_{in} = 1$\n$\\lim_{\\gamma\\rightarrow \\infty} (f_{in}(x, y) - f_{in}(x, y)^\\gamma) = \\begin{cases} f_{in} & 0 \\le f_{in} < 1\\\\ 0 & f_{in} = 1 \\end{cases}$\nNote that lemma 5 helps to understand this result.\nLemma 8. The transformation function $f_{out}$ has two roots in $f_{in} \\in [0,1]$. These roots are found at the values $f_{in} = 0$ and $f_{in} = 1$ for $\\gamma\\in R^+$. The proof is in lemma 1.\nLemma 9. One local maximum or inflection point $d_{max}$ exists for 0 < \u03b3 < \u221e\nin the domain x \u2208 [0,1]. Let dmax be the value of fmax(x)whenf' = 0, hence\nits slope is 0 and lacks contrast. In the interval x \u2208 [0,dmax), the slope\nis always positive f'(x) > 0, while in the domain x \u2208 (dmax,1] its slope is\nnegative f'(x) < 0. Considering that m = f'(x):\nm =\nLemma 10. Since the function is highly nonlinear, the slope can be obtained\npointwise (numerically) or in the region with the highest gradient magnitude\n(m+ and m\u00af). Specifically, using finite differences for 0 < \u03b3 < 1:\n$f'(x) = \\lim_{\\Delta x \\rightarrow 0} \\frac{x^{\\gamma} + \\Delta x}{\\Delta x}$\nwhile for \u03b3 > 1:\n$f'(x) = \\lim_{\\Delta x \\rightarrow 0} \\frac{x^{\\gamma} + \\Delta x - (x + \\Delta x)^{\\gamma}}{\\Delta x}$"}, {"title": "", "content": "Lemma 11. Regionally and considering that the dichotomy function given\nby Theorem 1 depends on dmax, the area under the curve of R+ and R_ also\ndepends on dmax implying that the smaller the value of its area, the greater\nits contrast. Hence, For 0 < \u03b3 < 1, the positive region R+(x) is:\nR+(x) = (x\u03b3\u2212x)dx = \u2212d\u03b3+1max\u03b3+1 \u2212d2max2\nAnd its negative region R\u2212(x) is:\nR\u2212(x) = (x \u2212 x\u03b3)dx = 12(1 \u2212 d2max) \u2212d\u03b3+1max\u03b3+1 \u03b3+1 .\nLemma 12. The area under the curve of function f(x) for \u03b3\u2208 [0,\u221e) is\nless than or equal to Gamma correction evaluated in \u03b30 = 1 or the reference\nfunction in the image, hence xy=1:\nf(x)dx = R++R\u2212 < xdx = 0.5"}, {"title": "", "content": "Lemma 13. According to Lemma 6, \u03b3 = 0 in the domain x \u2208 [0,1], the\nslope m\u2212 is linearly negative with value m\u2212 = \u22121, R+ = 0, and R\u2212 = 0.5.\nSimilarly after Lemma 7 for \u03b3 = \u221e in the domain x \u2208 [0,1), the value of the\nslope m+ = 1, R+ = 0.5, and R\u2212 = 0. Note that for \u03b3 = 2, the magnitudes\nof the positive regions R+ and negative regions R\u2212 are symmetric at x = 0.5.\nLemma 14. The calculation of k for all \u03b3 > 0 is defined as:\nk =1/max(f(x; \u03b3))\nFinally, an important property with practical applications of Theorem 1\nis the calculation of the inverse. However, the inverse function is difficult\nto obtain in general. Here, we propose two different methods based on the\ngolden-section search for real numbers, and mapping the output function\nwith look-up tables in the case of integers.\n\u2022 case 1: For all \u03b3 \u2208 (0,\u221e), the values of fin can be recalculated from the\nvalues of fout even though the function is not invertible in many cases.\nKnowing \u03b3, all values from fout can be mapped to fin. However, the\nfunction has two roots at 0 and 1, and a local maximum dmax \u2208 (0,1)."}, {"title": "", "content": "Given the orientation of the slope m it is possible to know in which\nregion of the function fin belongs. Hence, any recursive numerical\nmethod can approximate the value fin. Let a = 0 and b = dmax be\ntwo extreme values within the region C+, or let a = dmax and b = 1\nbe two extreme values within the region C\u2212. Therefore, the goal is to\nminimize fout < e while using the function fout(x) = |x\u03b3 \u2212 x|, and the\nupdated values a, b are:\nc = b \u2212 (b \u2212 a)/\u03c6 and d = a + (b \u2212 a)/\u03c6,\nwhere \u03c6 = 1+\u221a52 ; moreover, the approximation functions are given\nby:\nNote that lemma 5 helps to understand this result.\nLemma 8. The transformation function fout has two roots in fin \u2208 [0,1].\nThese roots are found at the values fin = 0 and fin = 1 for \u03b3\u2208 R+. The\nproof is in lemma 1."}, {"title": "4. Results", "content": "In this section we present three examples to illustrate the model capacity from the viewpoint of tone and contrast. Since contrast, lightness, and color perception are affected by the context of the nearby colors and other features within a picture independently of the media. Predicting contrast is challenging and disposing of a mathematical relationship is key to emphasize the image content. Note that the proposed model does not corrupt the data only change the representation. Digital photography exposure relates to the amount of light that enters the sensor. A properly exposed photograph must accurately reflect the brightness levels into the sensor. Figure 1 shows an underexposed image that does not receive enough light. The picture is too dark. The details in the low light are invisible since the light was insufficient. The image is full of dark regions that almost reach pure black. Figure 2 shows an overexposed image that received too much light. The image is too bright, and details in the highlights are missing. Photographers say that light regions are burned because they contain only pure white. Note that pure white and black cases prevent us from recovering information. A photograph must constantly be correctly exposed to the shot.\nNevertheless, suppose it is impossible to have a correct exposure while shooting or because the image was already taken, like in a space mission. In that case, our analysis allows us to make image variations to enhance contrast information and correctly recover the information in the shoot despite exposition issues. Figure 3 presents a photograph combining underexposed and overexposed images. It is remarkable how well our model recovers information in the foreground without sacrificing that in the background. The results presented here aim to help us realize the importance of mastering tone to create impactful pieces that evoke strong emotions.\nAs we can appreciate, tone is a vital tool to produce contrast within a photograph, and the model introduced in this article helps create a sense of opposition and tension between different image regions to place our focus correctly on particular parts of the photograph."}, {"title": "4.1. Analysis of Theorem and Lemmas in the Three Typical Problems", "content": "In the following, we relate the theorem and lemmas with the three photographs from two viewpoints. First, we explain the theorem and lemmas sequentially while relating them to all three figures. Second, we explain the theorem and lemmas for each photograph.\n\u2022 Theorem 1 is visible in each figure's third row of images where m+ and m_ describe the type of region to which each pixel value belongs. For example, in the image of the third row and the second column, the mapping for each pixel is classified as red, which means that the pixel belongs to the class whose growth has a positive orientation (m+). On the other hand, if the value is blue (m_), the pixel belongs to the region with a negative orientation. Therefore, dichotomy appears since two different behaviors (given by their orientations) appear in the same image. The transformation helps to highlight the image display and extract information since the contrast is maximized for each region independently without changing the input information. Given the conditions of spatial illumination and naturalness of the input image, along with a correct gamma value, characteristics of the physics of light can be highlighted. An example is Figure 3; the image in the second row and first column shows a colored heron. Note the chromatic aberration that occurs at the edge of the bird at its extreme part: the external part of the body, neck, and head. On the other hand, in the adjacent figure, the same row, but in its grayscale version, the edges of the bird concerning its background are accentuated, allowing it to separate the object from the background in a more defined way.\nThe value of theorem lies in the fact that the information contained in the image does not change geometrically but punctually since the calculations are given by the parameter y, meaning that the function only works with the remainder between the input pixel values and the corrected pixel values (obtained after applying the gamma correction)."}, {"title": "", "content": "Therefore, the resulting (contrasted) image is invertible by obtaining its original input values.\nLemma 6, when \u03b3 = 0, the image has an inverse slope so that the entire image would correspond to its negative fout = 1 fin. The analysis did not include this particular case since it does not present a dichotomy but a change in the slope of the input values, although it is modelable in fout. However, note that the m_ regions of the three proposed figures contain regions with negative slopes; the only change is the slope's magnitude.\nLemma 7, when \u03b3 = \u221e, represents the opposite case of Lemma 6. The input values stay still since the values after applying the power function tend to zero, so the output image would correspond to the input image except for pure white since these values will change to pure black.\nLemma 8, considering that there is a local maximum within the luminance range, the value of the function is 0 when it is pure white or pure black. None of the three images in the figures contain pure blacks or pure whites since there is no value to transform, just like the traditional gamma correction. However, a particular case occurs with the binary input images, whose output would be 0 for any \u03b3 \u2208 (0,\u221e). For image handling, \u03b3 = 0 can be used by inverting the values in the negative of the input image."}, {"title": "", "content": "Lemma 9 directly applies in the three figures (m+ and m-), whose simplest case is the grayscale version. The red areas have a positive slope, contrasting the image ascendingly. On the other hand, in the blue regions, their slope is negative; this means that the transformation would be equivalent to the image's negative. When the image is in color, the transformation applied to each color channel produces a similar behavior. In the red channel, m+ is positive and ascending while m_ is negative and descending, and similarly for the green and blue channels. When m+ is yellow, the red and green channels are ascending, and the blue is descending, while magenta m+ corresponds to red and blue ascending, and m- corresponds to green descending. When the color is cyan, the green and blue channels are ascending, and the red is descending, while the white color means that it is ascending in the three channels and black means that all the channels are descending. Note that the negative slope is related to lemma 6, and the positive slope is related to lemma 7. The differences in values at the edges can be accentuated or diminished with the gamma value for images that are underexposed, overexposed, or both cases.\nConsidering Lemma 10, while it is difficult to approximate an appropriate gamma value to contrast a given image, one can numerically calculate the slope values m+ or m_ for a given gamma value. For example, in Figure 3, the overexposed region (image background) pixel values are very different from the heron, while the bird has similar values considering an underexposed region. Using a gamma value such that DoCmax is between both regions will easily allow the contrast of both areas."}, {"title": "", "content": "Considering Lemma 11, and since the objective is to contrast the information content of the image, it is required to increase the magnitude of the slope, either positive or negative, with the input slope (the reference image has m = 1). The local maximum is found in the range [0, 1) in \u03b3\u2208 [0,\u221e) and depends on the image exposure type as well as the magnitude of the slope. For example, for figure 1, a \u03b3 = 0.5 was used, meaning that dmax = 0.25, fout(0.25) = 0.25 (corresponding to a pixel value with a depth of 8 bits of 67.5), and a k = 1/0.25 = 4 (Lemma 14). Under these parameters, it is possible to verify that calculating the integrals R+ and R_ produces that region R+ will grow faster than R_; in other words, m+ has a greater magnitude than m_. \nRegarding Lemmas 12 and 13, for any image containing integer or real pixel values, the output fout will have the same range as fin for any positive gamma value, including 0. As is well known, power functions are non-linear; however, fout has symmetric behavior when \u03b3 = 2. This means that dmax = 0.5 (corresponding to the value"}]}