{"title": "ZODIAC: A CARDIOLOGIST-LEVEL LLM FRAMEWORK FOR MULTI-AGENT DIAGNOSTICS", "authors": ["Yuan Zhou", "Peng Zhang", "Mengya Song", "Alice Zheng", "Yiwen Lu", "Zhiheng Liu", "Yong Chen", "Zhaohan Xi"], "abstract": "Large language models (LLMs) have demonstrated remarkable progress in health- care. However, a significant gap remains regarding LLMs' professionalism in domain-specific clinical practices, limiting their application in real-world diag- nostics. In this work, we introduce ZODIAC, an LLM-powered framework with cardiologist-level professionalism designed to engage LLMs in cardiological di- agnostics. ZODIAC assists cardiologists by extracting clinically relevant char- acteristics from patient data, detecting significant arrhythmias, and generating preliminary reports for the review and refinement by cardiologists. To achieve cardiologist-level professionalism, ZODIAC is built on a multi-agent collabora- tion framework, enabling the processing of patient data across multiple modalities. Each LLM agent is fine-tuned using real-world patient data adjudicated by cardi- ologists, reinforcing the model's professionalism. ZODIAC undergoes rigorous clinical validation with independent cardiologists, evaluated across eight metrics that measure clinical effectiveness and address security concerns. Results show that ZODIAC outperforms industry-leading models, including OpenAI's GPT-40, Meta's Llama-3.1-405B, and Google's Gemini-pro, as well as medical-specialist LLMs like Microsoft's BioGPT. ZODIAC demonstrates the transformative poten- tial of specialized LLMs in healthcare by delivering domain-specific solutions that meet the stringent demands of medical practice. Notably, ZODIAC has been successfully integrated into electrocardiography (ECG) devices, exemplifying the growing trend of embedding LLMs into Software-as-Medical-Device (SaMD).", "sections": [{"title": "1 INTRODUCTION", "content": "As technology continues to revolutionize healthcare, artificial intelligence (AI) has emerged as a crucial component of medical devices, driving the expansion of digital health in clinical practice (FDA, 2020). Among the most promising AI advancements, large language models (LLMs) are unlocking new possibilities in digital health. With their human-like conversational skills and vast pre-trained knowledge, LLMs are increasingly being adopted as clinical support tools by industry leaders, evolving into specialized clinical agents (Boonstra et al., 2024; Gala & Makaryus, 2023; Xu et al., 2024). This evolution has given rise to industrial products such as Microsoft's BioGPT (Luo et al., 2022), Google's Med-Gemini (Saab et al., 2024) and Med-PaLM (Tu et al., 2024), as well as a range of open-source medical specialist LLMs (Chen et al., 2023a; 2024b; ContactDoctor, 2024; Wang et al., 2024c) built on Meta's Llama (Touvron et al., 2023).\nDespite these advancements, integrating LLMs into real-world healthcare practice remains in its early stages, where a significant gap exists in their professionalism (Davenport & Kalakota, 2019; Asan et al., 2020; Weber et al., 2024; Quinn et al., 2022). Bridging these gaps is critical, especially when deploying LLMs in healthcare settings governed by the FDA's Software-as-a-Medical-Device (SaMD) regulations (FDA, 2018). These regulations require software to demonstrate expert-level"}, {"title": "2 RELATED WORK", "content": "LLMs in Clinical Diagnostics. LLMs have shown considerable progress in processing and inter- preting vast amounts of unstructured medical data, such as patient records, medical literature, and diagnostic reports. For example, Han et al. (2024) introduced a system that automatically summa- rizes clinical notes during interactions between patients and clinicians, while Ahsan et al. (2023) explored the role of LLMs in retrieving key evidence from electronic health records (EHRs). De- spite these successes, concerns persist regarding LLMs' domain-specific expertise and professional performance in high-stakes, life-critical clinical settings (Nashwan & AbuJaber, 2023; Jahan et al., 2024; Wang et al., 2024a; Li et al., 2024). This work addresses these concerns by designing and validating ZODIAC through our design and experiments specifically for cardiological diagnostics.\nMulti-Agent Frameworks. Multi-agent frameworks have been extensively studied to enhance LLM capabilities in handling complex tasks and managing distributed processes (Wang et al., 2024b; Hong et al., 2023; Du et al., 2023; Chan et al., 2023). In healthcare, where collaboration across different expertise is essential, multi-agent frameworks have shown their potential in optimizing patient management, coordinating care between various agents (e.g., doctors, nurses, administra- tive systems), and supporting decision-making processes (Furmankiewicz et al., 2014; Jemal et al., 2014; Shakshuki & Reid, 2015). Recent studies have also focused on leveraging multi-LLM agents to reduce manual tasks in healthcare workflows. For instance, Chen et al. (2024a) employed Chat- GPT in distinct roles within a coordinated workflow, to automate tasks like database mining and drug repurposing, while ensuring quality control through role-based collaboration.\nCardiological Diagnostic Systems. Current cardiological diagnostic systems primarily depend on rule-based algorithms or single-agent approaches for identifying cardiovascular risk factors or pre- dicting cardiac events (Goff Jr et al., 2014; Sud et al., 2022; Olesen et al., 2012). In recent years, deep learning models have been introduced into cardiology (Hannun et al., 2019; Acharya et al., 2019). However, there remains a significant gap in incorporating recent LLMs into cardiological diagnostics-a gap that this work addresses significantly."}, {"title": "3 PROBLEM FORMULATION FROM CARDIOLOGIST-LEVEL DIAGNOSTICS", "content": "This section outlines how ZODIAC is aligned with cardiological diagnostics. Section 3.1 defines the task of cardiological diagnostics and its key components. Section 3.2 introduces the multimodal data"}, {"title": "3.1 THE DIAGNOSTIC TASK AND ITS KEY COMPONENTS", "content": "The focus of this paper is the detection of clinically significant arrhythmias using patient data. We categorize the key components into two main categories: patient data and diagnostic outputs.\nPatient Data is comprised of three sections: (1) Biostatistical information (B) provides background details about the patient such as date of birth, gender, and age group. (2) Metrics (M) summarize cardiological attributes and their corresponding values presented in a tabular format, providing an overview of 24-hour monitored statistics for the patient. For example, AF Burden: 12% indicates that the patient experienced atrial fibrillation for 12% of the whole monitoring period. (3) Tracings (T) includes ECG images depicting clinically significant arrhythmias such as AFib/Flutter (Atrial Fibrillation / Atrial Flutter), Pause, VT (Ventricular Tachycardia), SVT (Supraventricular Tachycar- dia), and AV Block (Atrioventricular Block). T presents a concise but representative segment of the 24-hour monitoring, such as a 10-second strip highlighting the highest degree of AV block.\nDiagnostic Outputs is comprised of two elements: clinical Findings (F) and Interpretation (I), both presented as expert-crafted natural language statements by cardiologists. Foutlines key ob- servations directly from clinically relevant characteristics, while I provides the final diagnostics, interpreting these findings. For example, the finding PR Interval is 210 milliseconds in the ECG tracings leads to the interpretation: The PR interval is slightly prolonged, suggesting a first-degree AV block.\nOnce F and I are completed by cardiologists (or by ZODIAC), a clinical end-of-study report is generated for the patient, including (B, M, T, F, I), as illustrated in the right part of Figure 2."}, {"title": "3.2 CARDIOLOGICAL DIAGNOSTICS WITH MULTIMODAL DATA", "content": "Cardiological diagnostics follows a process: (B,M,T) \u2192 F \u2192 I. In addition, the final interpre- tation is guided by clinical guidelines, denoted as G, which are consensus-based recommendations designed to support healthcare providers in making evidence-based decisions (detailed in D).\nA cardiologist begins by reviewing the patient's data (B, M, T) to identify clinically relevant char- acteristics, such as the PR interval, which are key for diagnosing arrhythmias. These identified char- acteristics are then summarized into natural language statements, referred to as findings F, which integrate insights from both tabular metrics M and image-based ECG tracings T. For example,"}, {"title": "3.3 PROBLEM FORMULATION IN ZODIAC", "content": "As illustrated in Figure 2, ZODIAC represents the diagnostic process through a multi-agent collab- oration. Each LLM agent is tasked with a specific stage in the diagnostic workflow, enhancing the system's ability to identify hybrid characteristics across multiple modalities. ZODIAC is composed of three agents:\n1. Metrics-to-Findings Agent (0M2F): A table-to-text LLM that extracts key characteristics from tabular metrics (M), while incorporating patient biostatistics from B to generate clinical findings.\n2. Tracings-to-Findings Agent (0T2F): An image-to-text LLM that identifies key factors from ECG tracings (T), integrates relevant information from B, and produces clinical findings.\n3. Findings-to-Interpretation Agent (0F21): A text-based LLM that synthesizes findings (F) from both the OM2F and 0T2F, applies clinical guidelines from G, and generates the interpretation (I).\nFormally, the process of ZODIAC is formulated as:\nI\u2190 OF21 (F,G) s.t. F\u2190 0M2F (M, B) U0T2F(T, B)  (1)\nIn this process, OM2F and OT2F independently generate clinical findings based on M and T, respec- tively, which are then combined to form F. This approach adheres to cardiological diagnostics as each finding in F corresponds to evidence derived from a specific modality \u2013 either metrics or ECG tracings."}, {"title": "4 DESIGN, DEVELOPMENT, AND DEPLOYMENT OF ZODIAC", "content": "This section details how ZODIAC achieves cardiologist-level expertise, as well as its compliance with Software-as-a-Medical-Device (SaMD) regulations. We begin by discussing the process of real-world data collection and the professionalism-incorporated curation, outlined in Section 4.1. Next, we introduce the instruction fine-tuning in Section 4.2, where the curated data is used to im- bue the LLM agents with domain-specific expertise. During inference, as described in Section 4.3, we leverage in-context learning and fact-checking to enhance diagnostic professionalism through collaborative multi-agent interactions. Finally, we present our approach to SaMD-compliant deploy- ment in Section 4.4."}, {"title": "4.1 DATA COLLECTION AND PROFESSIONALISM-INCORPORATED CURATION", "content": "Our data is characterized as real, representative, and professionalism-incorporated.\nReal-World Patient Data. Instead of relying on public benchmarks from third-party or synthetic data-which often raise concerns about trustworthiness or misalignment with specific clinical appli- cations (Chouffani El Fassi et al., 2024; Fehr et al., 2024; Youssef et al., 2024)\u2014we utilized ECG data sourced from our collaborating healthcare institutions\u00b9 under an IRB-approved protocol, with removed patient identifiers to ensure privacy protection. The raw data collection consists of tabular metrics (M) and ECG tracings (T), as depicted in the left part of Figure 2. To ensure the clinical relevance, we engaged five independent cardiologists to review the data, resulting in a final dataset of 2,000+ patients. Of these, 5% were used for clinical validation (Section 5), while the remainder were used for fine-tuning (Section 4.2).\nRepresentative Groups. Following FDA's guideline (Food et al., 2021), it is crucial to include representative data, not simply to amass large volumes. Our dataset encompasses comprehensive ar- rhythmia types and ensures balanced representation across age and gender demographics, as detailed in Figure 3-(d)."}, {"title": "4.2 INSTRUCTION FINE-TUNING", "content": "Utilizing cardiologist-adjudicated data, we apply instruction fine-tuning to instill cardiologist-level professionalism into agents OM2F, OT2F, and OF21. For OM2F, we selected Llama-3.1-8B as the base model, LLaVA-v1.5-13B for OT2F, and another Llama-3.1-8B for 0F21. Each base model is fine- tuned individually, tailored to its specific task using relevant portions of cardiologist-adjudicated data. For instance, as shown in Figure 3-(a)(c), we fine-tune OM2F by utilizing system prompts from (a) and cardiologist-adjudicated texts in the format presented in (c), aligning with the metric-to- findings task handled by OM2F. Let @agent denote the trainable parameters of any LLM agent, with X and Y representing the instructional input and the corresponding LLM responses for one patient, respectively. Given the cardiologist-adjudicated data D, the tuning process can be formulated as follows:\n0*Agent = arg min E(X,Y)EDL(@Agent (X), Y)  (2)\nAgent\nThe goal of instruction fine-tuning in Eq. 2 is to minimize the mean of the summed loss by E(L(\u00b7, \u00b7)) given each pair of (X, Y) within D. Specifically, when dagent is 0M2F, we have X = (M,B) and Y = F. For 0T2F, X = (T, B) and Y = F. Lastly, for 0F21, X = (F,G) and Y = I."}, {"title": "4.3 INFERENCE WITH IN-CONTEXT LEARNING AND FACT-CHECKING", "content": "As outlined in Section 3.3, ZODIAC's inference process involves a multi-agent approach using the trained agents OM2F, OT2F, and 0F21. First, OM2F processes patient metrics (M) and OT2F handles ECG tracings (T), together generating findings (F). These findings are then interpreted by OF21 as the diagnostic interpretation (I). Each agent leverages in-context learning to enhance diagnostic accuracy, with fact-checking applied at the final step for backward self-correction.\nIn-Context Learning. For each fine-tuned LLM agent, we implement in-context learning using a set of demonstrations (or \u201cdemos\") containing cardiologist-adjudicated findings and interpretation. The content of each demo is tailored to the specific LLM agent. For instance, demos for OM2F include cardiologist-adjudicated findings, as shown in Figure 3-(b). To ensure that each demo is relevant to the target patient's case, we categorize the patient data by gender, age group, and arrhythmia class, following the subgrouping presented in Figure 3-(d). We then select three demos that match the pa- tient's gender, age group, and arrhythmia class. During inference, the input prompt is a combination of contents shown in Figure 3-(a)(b)(c).\nFact-Checking. Fact-checking occurs after 0F21 generates the final interpretation (I). ZODIAC applies cardiological guidelines (G) to verify whether the findings (F) correctly lead to the inter- pretation (1) that aligns with G. Since F and I are itemized lists, it is convenient to match each item independently. If discrepancies are identified based on G, ZODIAC automatically prompts the corresponding agent to regenerate specific items in For I using instructions derived from G. Due to space constraints, the example of G and the fact-checking process are provided in Appendix D.\""}, {"title": "4.4 TOWARDS IN-HOSPITAL DEPLOYMENT", "content": "In line with SaMD (FDA, 2018), ZODIAC represents an important milestone in building professional LLMs in today's standard clinical workflow. It has been deployed on Amazon AWS as the backend and connected to the in-hospital frontend to assist cardiologists by providing preliminary reports. As shown in Figure 4, cardiologists or their assistants can upload patient data, including monitored met- rics and ECG tracings from wearable patches (Steinhubl et al., 2018) or Holters (Kim et al., 2009). This data is routed through AWS API Gateway, triggering AWS Lambda to invoke SageMaker, where ZODIAC is hosted. On AWS SageMaker, ZODIAC generates preliminary reports, including findings and interpretation based on the data, and performs fact-checking to ensure accuracy before finalizing the reports. These reports are then returned to the cardiologists, who can use them as a foundation to finalize their diagnoses, thus enhancing workflow efficiency and improving diagnostic accuracy."}, {"title": "5 EXPERIMENTAL RESULTS", "content": "Our experiments are designed to align with real-world clinical validation with the following settings:"}, {"title": "5.1 CLINICAL VALIDATION SETTING", "content": "Evaluation Metrics: As detailed in Table 1, we consider eight evaluation metrics commonly used among clinical validations (Tierney et al., 2024; Sallam et al., 2024). Metrics (a)-(e) evaluate the quality of generated outputs from a clinical perspective, while metrics (f)-(h) address potential secu- rity concerns. Each metric is rated on a scale from 1 to 5, reflecting varying degrees of alignment with ideal clinical standards.\nHuman Validation: Involving human experts in the validation is critical for enhancing the credibil- ity and acceptance of advanced techniques (Tierney et al., 2024; Sallam et al., 2024). To this end,"}, {"title": "5.2 DIAGNOSTIC PERFORMANCE COMPARISON WITH OTHER LLM PRODUCTS", "content": "Comprehensive evaluations in Table 2 highlight the remarkable capabilities of ZODIAC. With fewer than 30B parameters (as noted in Section 4.2), ZODIAC outperforms larger models like Llama-3.1- 405B and advanced industrial products such as GPT-40 and Gemini-Pro, particularly in clinical professionalism (e.g., 4.9 CPH) and security assurance (e.g., 5.0 FFB). Additionally, ZODIAC ex-"}, {"title": "5.3 EVALUATING DIAGNOSTIC CONSISTENCY VIA SUBGROUP ANALYSIS", "content": "Subgroup analysis is important in clinical validation to evaluate whether a model demonstrates con- sistent effectiveness across diverse populations (Cook et al., 2004; Rothwell, 2005; Sun et al., 2014). Since our dataset includes various arrhythmia classes, age groups, and genders, we perform evalu- ations within these subgroups. Figure 6-(a)(b)(c) present results segmented by arrhythmia classes, with additional breakdowns by age and gender shown in Figure 14.\nObserve that some industrial products exhibit obviously biased performance across arrhythmias. For example, GPT-40 presents less accuracy (ACC) and completeness (CPL) when diagnosing life- threatening arrhythmias, while Gemini-Pro shows an increase in hallucinations (less FFH) in normal cases, implying imbalances in their pre-trained knowledge. In contrast, ZODIAC delivers consistent performance across all arrhythmia groups, underscoring the importance of data-driven professional- ism by incorporating diverse and representative patient cases, as shown in Figure 3-(d)."}, {"title": "5.4 ABLATION STUDY AND DIAGNOSTIC PROPERTIES OF ZODIAC", "content": "Ablation Study. We evaluate how removing key components from ZODIAC affects its performance. Figure 6-(d) compares ZODIAC with three baselines: without fine-tuning, without in-context learn- ing, and without fact-checking. Notably, fine-tuning has the greatest impact on diagnostic perfor- mance across all metrics, followed by in-context learning, demonstrating the importance of using fine-tuning to permanently embed domain expertise into the LLMs' parameters. Without fine-tuning, in-context learning can still guide the model toward proficiency, but with more limited improvements. We also notice that adding fact-checking improves security-related performance (e.g., FFH, FFB), highlighting the need to integrate clinical guidelines for safe and responsible diagnostics.\nSingle-Agent Performance. We evaluate a single-agent variant of ZODIAC. To ensure an equivalent scale, we use the same vision-based LLM, LLaVA, as used in OT2F but with 34B parameters (com- pared to 0T2F'S 13B), applying the same tuning and inference techniques to perform tasks originally distributed among multiple agents. However, as shown in Figure 7-(b), we observe clear limitations in performance (e.g., ACC, ORG, SCI, and FFH) for the single-agent ZODIAC. It is important to note that the multi-agent ZODIAC, as described in Section 4.2, comprises fewer parameters in to- tal (30B). This highlights the limited ability of a single LLM to manage various stages of the task, particularly when dealing with different modalities (e.g., table, image, text) and domain-specific expertise. These findings underscore the importance of using collaborative models, especially for complex tasks, as they enhance task-specific proficiency and prevent overloading a single model.\nDiagnostic Lability. To evaluate the stability of diagnostic outputs, we check if LLMs produce consistent texts (findings and interpretation) across multiple runs. For each patient sample, we run LLMs (ZODIAC or baselines) 10 times. We then convert the generated texts into embeddings using a sentence transformer (Reimers & Gurevych, 2019) and calculate variance of pairwise co- sine similarities. The variance serves as the stability score for each patient. Figure 7-(a) shows the stability scores across all patients, and we observe that ZODIAC demonstrates the most stable performance in generating consistent texts over multiple runs. We attribute this stability to the cardiologist-adjudicated texts with consistent structure and content. Through fine-tuning, ZODIAC achieves highly stable outputs with minimal variability across different executions. This level of sta- bility is crucial for ensuring reliability in patient care and building trust among healthcare providers."}, {"title": "6 FUTURE WORK", "content": "ZODIAC serves as our minimum viable product (MVP) toward functional completeness. Building on ZODIAC, future work focused on security, trustworthiness, and transparency is crucial for ensuring long-term success in a competitive market.\nAs emphasized by FDA's guiding principles (FDA, 2024), securing the development and deploy- ment of LLMs is as important as achieving functional effectiveness. While our current evaluation addresses security-focused metrics, the next phase will prioritize further development of security measures to enhance trust. This will involve investigating third-party adversarial influences in data, identifying inherent weaknesses in LLMs that could lead to vulnerabilities (e.g., backdoors), propos- ing defensive strategies to safeguard ZODIAC in life-critical diagnostic applications, and promoting transparency to foster human understanding and effective collaboration in human-machine intelli- gence."}, {"title": "7 CONCLUSION", "content": "We present ZODIAC, an LLM-powered, multi-agent framework designed for cardiologist-level di- agnostics. ZODIAC aims to bridge the gap between clinicians and LLMs in the field of cardiology. Leveraging real-world, cardiologist-adjudicated data and techniques including instruction tuning, in-context learning, and fact-checking, ZODIAC is enhanced to deliver diagnoses with the expertise of human specialists. Through clinical validation, we demonstrate that ZODIAC produces leading performance across patients of different genders, age groups, and arrhythmia classes. In conclu- sion, ZODIAC represent a significant step toward developing clinically viable LLM-based diagnostic tools."}, {"title": "B ADDITIONAL PROMPTS", "content": "Corresponding to Figure 3-(a)(b)(c), we provide the prompts used for agents 0T2F and OF21 in Figure 9."}, {"title": "C DETAILS ABOUT ARRHYTHMIA CLASSES", "content": "In this work, we categorize arrhythmias into three subgroups:\nClass I - Normal Arrhythmias: Also known as benign or physiological arrhythmias, these irreg- ular heart rhythms can occur in healthy individuals and typically do not lead to serious health issues. They are generally considered harmless and may not require treatment. In our patient data, Class I arrhythmias include Sinus Bradycardia, Sinus Tachycardia, and Sinus Arrhythmia.\nClass II Clinically Significant Arrhythmias: These arrhythmias involve abnormal heart rhythms that can cause symptoms, lead to complications, or require medical intervention. They may disrupt the heart's ability to pump blood effectively, increasing the risk of serious events such as stroke, heart failure, or sudden cardiac death. In our patient data, Class II arrhythmias include Pause (\u00a13s), Ventricular Premature Beat (PVC), and Atrial Fibrillation (AF).\nClass III - Life-Threatening Arrhythmias: These abnormal heart rhythms can result in severe consequences, such as cardiac arrest, stroke, or sudden cardiac death, requiring immediate medi- cal attention and often emergency intervention. In our patient data, Class III arrhythmias include Ventricular Flutter (VF), Complete Heart Block (Third-Degree AV Block), Atrial Fibrillation (AFib) with Rapid Ventricular Response, Prolonged Pause, Atrial Flutter (AFL), Ventricular Tachycardia (VT), and Supraventricular Tachycardia (SVT).\nIn our experiments, we use these arrhythmia classes (I, II, III) for subgroup analysis rather than specific arrhythmias to avoid the limitations of small patient sample sizes for individual conditions. Subgroup analysis based on arrhythmia classes provides a comprehensive view of the LLMs' diag- nostic capabilities across different levels of urgency, offering valuable insights for data collection and performance improvement toward more balanced diagnostics."}, {"title": "D FACT CHECKING USING CLINICAL GUIDELINE", "content": "Clinical guidelines are systematically developed statements designed to assist healthcare providers and patients in making decisions about appropriate health care for specific clinical circumstances. These guidelines are based on the best available evidence and aim to standardize care, improve the quality of treatment, and ensure patient safety. For example, a section of clinical guidelines about PR Interval is provided in Figure 10."}, {"title": "E SUPPLEMENTARY EXPERIMENTAL RESULTS", "content": "Case Study. In line with Figure 5, we present diagnostic outputs from other LLMs using the same patient data, as shown in Figures 11 to 13. Unlike ZODIAC (Figure 5), industrial LLMs tend to produce redundant statements regarding key clinical findings and interpretations, making it difficult for cardiologists to quickly identify key information and make revisions. For example, GPT-40 provides the statement \"there were no occurrences of atrial fibrillation or atrial flutter,\" which could be more succinctly expressed as \u201cAF/AFL: not present\"\nMoreover, industrial LLMs may present statistical findings without supportive evidence. For in- stance, Llama-3.1-405B states \u201cVT: not presen\u201d without providing evidence-based interpretation to substantiate the claim, undermining the trustworthiness of the information for cardiologists."}]}