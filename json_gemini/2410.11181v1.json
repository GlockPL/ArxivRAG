{"title": "DARNet: Dual Attention Refinement Network with Spatiotemporal Construction for Auditory Attention Detection", "authors": ["Sheng Yan", "Cunhang Fan", "Hongyu Zhang", "Xiaoke Yang", "Jianhua Tao", "Zhao Lv"], "abstract": "At a cocktail party, humans exhibit an impressive ability to direct their attention. The auditory attention detection (AAD) approach seeks to identify the attended speaker by analyzing brain signals, such as EEG signals. However, current AAD algorithms overlook the spatial distribution information within EEG signals and lack the ability to capture long-range latent dependencies, limiting the model's ability to decode brain activity. To address these issues, this paper proposes a dual attention refinement network with spatiotemporal construction for AAD, named DARNet, which consists of the spatiotemporal construction module, dual attention refinement module, and feature fusion & classifier module. Specifically, the spatiotemporal construction module aims to construct more expressive spatiotemporal feature representations, by capturing the spatial distribution characteristics of EEG signals. The dual attention refinement module aims to extract different levels of temporal patterns in EEG signals and enhance the model's ability to capture long-range latent dependencies. The feature fusion & classifier module aims to aggregate temporal patterns and dependencies from different levels and obtain the final classification results. The experimental results indicate that compared to the state-of-the-art models, DARNet achieves an average classification accuracy improvement of 5.9% for 0.1s, 4.6% for 1s, and 3.9% for 2s on the DTU dataset. While maintaining excellent classification performance, DARNet significantly reduces the number of required parameters. Compared to the state-of-the-art models, DARNet reduces the parameter count by 91%. Code is available at: https://github.com/fchest/DARNet.git.", "sections": [{"title": "Introduction", "content": "The auditory attention detection (AAD) aims to study human auditory attention tendencies by analyzing brain signals [1, 2, 3]. The auditory attention refers to the ability of individuals to isolate or concentrate on specific sounds, which aids them in focusing on a single speaker amidst a multi-speaker environment, a scenario commonly referred to as the \"cocktail party scenario\" [4]. However, this ability may diminish or even completely disappear for individuals with impairment. Therefore, finding solutions to assist these individuals in overcoming this challenge has become an urgent matter.\nMesgarani and Chang [5] have demonstrated a close connection between auditory attention and brain activity, which indicates that researchers can study auditory attention by analyzing brain activity. Following this concept, many methods such as electrocorticography (ECOG) [5], magnetoencephalog-raphy [6, 7], and electroencephalography (EEG) [8, 9] have been used to implement auditory attention detection. Among these methods, EEG-based approaches are widely applied in AAD due to their high temporal resolution, non-invasive mode, and excellent maneuverability [9, 10, 11].\nAccording to the conclusions of Mesgarani and Chang [5], previous studies have utilized stimulus-reconstruction or speech envelope reconstruction methods, which necessitate clean auditory stimuli as input [12, 13]. However, in most real-world scenarios, environments consist of multiple sounds simultaneously. Listeners are exposed to a mixture of these sounds, posing a challenge in obtaining clean auditory stimuli. Therefore, in recent years, the academic community has increasingly focused solely on utilizing EEG signals as input for AAD research [14, 15, 16]. The research method proposed in this paper also exclusively utilizes EEG signals.\nTraditional AAD tasks relied on linear models to process EEG signals [17, 18]. However, brain activity is inherently nonlinear, posing challenges for linear models in capturing this complexity. Consequently, they necessitate longer decision windows to extract brain activity features [19]. Some previous studies have indicated that decent decoding performance can be achieved by analyzing different spatial distribution features within each frequency band. These studies project the extracted differential entropy (DE) values onto 2D topological maps and decode them with convolutional neural networks [20, 15]. However, EEG signals are fundamentally time-series data, these methods overlook the dynamic temporal patterns of EEG signals. Other studies analyze EEG signals only in the time domain. For instance, they use long short-term memory (LSTM) networks to capture dependencies within EEG signals and achieve decent decoding performance [2]. However, these studies only focus on the temporal information within EEG signals, neglecting the spatial distribution features, which reflect the dynamic patterns of different brain regions when receiving, processing, and responding to auditory stimuli. Meanwhile, numerous noise points and outliers make it difficult to capture long-range latent dependencies.\nTo address these issues, this paper proposes a dual attention refinement network with spatiotemporal construction for AAD, named DARNet, which effectively captures the spatiotemporal features and long-range latent dependencies of EEG signals. Specifically, our model consists of three modules: (1) Spatiotemporal Construction Module. The spatiotemporal construction module employs a temporal convolutional layer and a spatial convolutional layer. The temporal convolutional layer effectively captures the temporal dynamic features of EEG signals, and the spatial convolutional layer captures the spatial distribution features among different channels, thereby constructing a robust embedding for the next layer. (2) Dual Attention Refinement Module. The dual-layer self-attention refinement module consists of two layers, each comprising a multi-head self-attention and a refinement layer. This design is intended to capture long-range latent dependencies and deeper sequence patterns in EEG signals. (3) Feature Fusion & Classifier Module. The attention features generated by the dual-layer self-attention refinement module, comprising both shallow and deep levels, are fed into the feature fusion module to obtain richer representations, enhancing the model's robustness and generalization. The fused features are input into a classifier to predict the auditory attention tendencies of the subjects.\nTo this end, We evaluated the decoding performance of DARNet on three datasets: DTU, KUL, and MM-AAD. The results demonstrate that DARNet outperforms the current state-of-the-art model on all three datasets. The main contributions of this paper are summarized as follows:\n\u2022 We propose a novel auditory attention decoding architecture, which consists of a spatiotem-poral construction module, a dual attention refinement module, and a feature fusion module. This architecture could fully leverage the spatiotemporal features and capture long-range latent dependencies of EEG signals.\n\u2022 The DARNet achieves remarkable decoding accuracy within very short decision windows, surpassing the current state-of-the-art (SOTA) model by 5.9% on the DTU dataset and 4.9% on the KUL dataset, all under a 0.1-second decision window. Furthermore, compared to the current state-of-the-art model with 0.91 million training parameters, DARNet achieves further parameter reduction, requiring only 0.78 million parameters."}, {"title": "Methodology", "content": "The previous AAD methods overlooked the influence of spatial distribution characteristics on de-coding performance and struggled to capture the long-range dependencies in EEG signals [14, 20]. To address these issues, we proposed DARNet, which consists of a spatiotemporal construction module, a dual attention refinement module, and a feature fusion & classifier module, see Figure 1. Our proposed DARNet effectively captures the spatiotemporal features of EEG signals and has the capability to capture long-range latent dependencies in EEG signals.\nBy employing a moving window on the EEG data, we obtain a series of decision windows, each containing a small duration of EEG signals. Let $R = [r_1, ..., r_i, ..., r_n] \\in R^{T\\times N}$ represents the EEG signals of a decision window, where $r_i \\in R^{N\\times 1}$ represents the EEG data at the i-th time point within a decision window, contains N channels. Here N represents the number of EEG channels and T denotes the length of the decision window. Before inputting EEG data into the DARNet, we employ a common spatial patterns (CSP) algorithm to extract raw features from the EEG data under different brain states [21, 22].\n$E = CSP(R) \\in R^{c_{\\text{in}}\\times T}$                                                                     (1)\nwhere $CSP(\\cdot)$ represents the CSP algorithm, $E \\in R^{N\\times T}$ represents the processed EEG signal. $c_{\\text{in}}$ is the components of the CSP algorithm and T denotes the length of the decision window."}, {"title": "Spatiotemporal Construction Module", "content": "EEG signals record the brain's neuronal electrical activity, varying over time and reflecting activity patterns and connectivity across brain regions [23]. By constructing spatiotemporal features from EEG signals, it's possible to analyze the brain's response patterns to auditory stimuli. However, previous studies only focused on local temporal patterns in EEG data, overlooking the spatial distribution features. Therefore, in addition to the conventional use of temporal filters, we introduced a spatial filter [24] to construct the spatiotemporal features of EEG signals.\nFirstly, we use temporal convolution layers to capture the instantaneous changes in EEG signals, thereby constructing the temporal patterns $E_t$ of the EEG signals. It can be formulated as follows:\n$E_t = GELU(\\text{TemporalConv2d}(E)) \\in R^{\\text{4dmodel}\\times c_{\\text{in}}\\times T}$                                         (2)\nwhere $\\text{TemporalConv2d}(\\cdot)$ performs an 2-D convolutional filters (kernel size=1 \u00d7 8) on time dimension with $GELU(\\cdot)$ activation function. dmodel represents the embedding dimension.\nSubsequently, we employ a spatial convolutional layer with a receptive field spanning all channels to capture the spatial distribution features S of EEG signals across different channels, thereby aiding the model in comprehensively understanding the brain's activity patterns in response to various auditory stimuli.\n$S = GELU(\\text{SpatialConv2d}(E_t)) \\in R^{\\text{dmodel} \\times T}$                                                                      (3)\nwhere $\\text{SpatialConv2d}(\\cdot)$ performs an 2-D convolutional filters with a $c_{\\text{in}} \\times 1$ kernel size on spatial dimension. By doing so, we not only capture the temporal patterns in EEG signals but also integrate the spatial distribution characteristics of EEG signals, thereby constructing input embedding S containing comprehensive spatiotemporal information for the next layer. This integrated input better reflects the complex features within EEG signals, providing richer information for subsequent analysis and processing."}, {"title": "Dual Attention Refinement Module", "content": "Previous psycho-acoustic research has demonstrated that human attention is a dynamic and time-related activity [25, 26]. The brain activity from the preceding moment can profoundly influence subsequent brain activity [27]. However, previous AAD algorithms were hindered by model depth and the noise and outliers in EEG data, making them ineffective at capturing the long-range latent dependencies in EEG signals.\nTo address this issue, we proposed a dual self-attention mechanism, which has greater potential for capturing long-range latent dependencies and deeper sequence patterns in EEG signals. Inspired by Zhou et al. [28], Yu et al. [29], We introduced a self-attention refinement operation, which refines the dominant temporal features through convolution and pooling operations, compressing the original EEG series of length T to half its length. This self-attention refinement operation reduces the impact of noise and outliers, while also decreasing the model's parameter count. This enhances the model's generalization and robustness. The single-layer attention refinement module can be formulated as follows:\n$F = MaxPool(ELU(Conv1d(MultiHeadAttention(x))))$                                                                        (4)\nwhere $MultiHeadAttention(\\cdot)$ denotes multi-head self-attention algorithm [30], $Conv1d(\\cdot)$ represents an 1-D convolutional filters (kernel width=3) on time dimension. The $ELU(\\cdot)$ is the activation function proposed by Clevert et al. [31], $MaxPool(\\cdot)$ denotes a max-pooling layer with stride 2.\nBefore applying the temporal attention feature extraction module, we add the absolute positional embedding [30] to the input embedding S as follows:\n$S_i = S_i + P_i$                                                                                                 (5)\nwhere $s_i$ represents the embedding vector of the ith time step, $p_i \\in R^{dmodel}$ represents ith time step position.\nTo obtain different levels of temporal features from EEG signals and to capture the long-range latent dependencies, we stacked two of the above attention refinement extraction modules.\n$F\u2081 = MaxPool(ELU(Conv1d(MultiHeadAttention(S)))) \\in R^{dmodel\\times \\frac{T}{4}}$                                           (6)\n$F2 = MaxPool(ELU(Conv1d(MultiHeadAttention(F_1)))) \\in R^{dmodel\\times \\frac{T}{2}}$                                           (7)\nwhere F1 and F2 contain different levels of dependencies and temporal patterns in the EEG signals, respectively."}, {"title": "Feature Fusion & Classifier Module", "content": "Features at different levels can reflect various characteristics of the pattern. By optimizing and combining these different features, it preserves effective discriminative information from features\nat different levels while also to some extent eliminating redundant information [32]. Therefore, we designed a feature fusion module as follows:\nFirst, we project the features F\u2081 and F\u2082 into the same dimension.\n$\\bar{F_1} = Linear(AdaptiveAvgPool(F_1)) \\in R^4$                                                                        (8)\n$\\bar{F_2} = Linear(AdaptiveAvgPool(F_2)) \\in R^4$                                                                        (9)\nwhere $AdaptiveAvgPool(\\cdot)$ denotes an adaptive average pooling layer, Linear denotes a linear layer.\nSecond, We concatenate feature $\\bar{F_1}$ and $\\bar{F_2}$ to obtain the fused feature vector $F$.\n$F = [\\bar{F_1}, \\bar{F_2}]$                                                                                                  (10)\nFinally, we employ a fully connected layer to obtain the final auditory attention prediction.\n$p = w(F + b)$                                                                                                (11)\nwhere w and b are the weight and the bias of the fully connected layer, p denotes the predicted direction label. In the training stage, we employ the cross entropy loss function to supervise the network training."}, {"title": "Experiments", "content": "In this section, we conduct experiments on three publicly available datasets, namely KUL [33, 34], DTU [35, 36] and MM-AAD [20], which are commonly used in auditory attention detection to evaluate the effectiveness of our DARNet. KUL and DTU only contain EEG data of the auditory stimulus scenes. MM-AAD contains EEG data of the audio-only scene and the audio-visual scene. We summarize the details of the above datasets in Table 1.\n1) KUL Dataset: In this dataset, 64-channel EEG data were collected from 16 normal-hearing subjects using a BioSemi ActiveTwo device at a sampling rate of 8,192 Hz in a soundproof room. Each subject was instructed to focus on one of two simultaneous speakers. The auditory stimuli were filtered at 4kHz and set at 60dB through in-ear headphones, which contain four Dutch short stories, narrated by three male Flemish speakers. Two listening conditions were employed: dichotic (dry) presentation with one speaker per ear, and head-related transfer function (HRTF) filtered presentation, simulating speech from 90\u00b0 left or right. Each subject listened to 8 trials, which lasted 6 minutes.\n2) DTU Dataset: In this dataset, 64-channel EEG data were collected from 18 normal-hearing subjects using a BioSemi ActiveTwo device at a sampling rate of 512 Hz. Each subject was instructed to focus on one of two simultaneous speakers, who presented at 60\u00b0 relative to the subject. The auditory stimuli were set at 60dB through ER-2 earphones, which contain Danish audiobooks, narrated by three male speakers and three female speakers. Each subject listened to 60 trials, which lasted 50 seconds.\n3) MM-AAD Dataset: In this dataset, 32-channel EEG data were collected from 50 normal-hearing subjects (34 males and 16 females) at a sampling rate of 4kHz, following the 10/20 international system. Each subject was exposed to both audio-only and audio-visual stimuli. They were instructed to focus on one of two simultaneous speakers, who presented at left or right spatial direction relative to the subject. The auditory stimuli comprised 40 classic Chinese stories narrated by both male and female speakers. Each subject listened to 20 trials, which lasted 165 seconds."}, {"title": "Data Processing", "content": "To fairly compare the performance of the proposed DARNet model, specific preprocessing steps are applied to each dataset (KUL, DTU, and MM-AAD). For the KUL dataset, the EEG data were firstly re-referenced to the average response of mastoid electrodes, then bandpass filtered between 0.1 Hz"}, {"title": "Implement Details", "content": "In previous AAD research, the accuracy of auditory attention prediction classification has been used as a benchmark for model performance. We followed this convention and evaluated our proposed DARNet on the KUL, DTU, and MM-AAD datasets. As follows, we take the KUL dataset with a 1-second decision window as an example to illustrate implementation details, including training settings and network configuration.\nFirstly, we set the proportions of the training, validation, and test sets to 8:1:1. For each subject of the KUL dataset, we get 4,600 decision windows for training, 576 decision windows for validation, and 576 decision windows for testing. Meanwhile, we set the batch size to 32, the maximum number of epochs to 100, and employ an early stopping strategy. Training will stop if the loss function value on the validation set does not decrease for 10 consecutive epochs. Additionally, we utilize the Adam optimizer with a learning rate of 5e-4 and weight decay of 3e-4 to train the model. The DARNet is performed using PyTorch.\nBefore inputting EEG data into the DARNet, we employ the CSP algorithm to extract raw features $E\\in R^{128\\times64}$ from the EEG data. The data is transposed and expanded, represented as $E' \\in [R^{1\\times 64 \\times 128}$. Then, through the spatiotemporal construction module (Cin is set to 16), we can get embedding data $S\\in R^{16\\times 1\\times 128}$. After dimensionality reduction, transposition, and the addition of absolute positional embedding, the data is fed into the dual attention refinement module, resulting in two distinct level features, $F\u2081 \\in R^{16\\times 64}$ and $F2 \\in R^{16\\times 32}$. The $F\u2081$ and $F2$ are sent to the feature fusion module, where they undergo global average pooling and dimensionality reduction via a fully connected (FC) layer (input: 16, output: 4) before being concatenated to obtain the fused feature, $F\\in R^8$. Finally, F is passed through another fc layer (input: 8, output:2) to obtain the final auditory attention prediction $p\\in R^2$."}, {"title": "Result", "content": ""}, {"title": "Performance of DARNet", "content": "To evaluate the performance of DARNet, we conducted comprehensive experiments under decision windows of 0.1-second, 1-second, and 2-second, respectively, as shown in Figure 2. Additionally, We compared our DARNet with other advanced models, as shown in Table 2. The results are replicated from the corresponding papers.\nDARNet has outperformed the current state-of-the-art models on the KUL, DTU, and MM-AAD datasets, achieving further enhancements in performance. On the KUL dataset, the DARNet achieves\naverage accuracies of 91.6% (SD: 4.83%), 96.2% (SD: 3.04%), 97.2% (SD: 2.50%) under 0.1-second, 1-second and 2-second decision window, respectively. On the DTU dataset, the DARNet achieves\naverage accuracies of 79.5% (SD: 5.84%) for 0.1-second decision window, 87.8% (SD: 6.02%) for\n1-second decision window, 89.9% (SD: 5.03%) for 2-second decision window, respectively. On the\nMM-AAD dataset, the DARNet also demonstrates outstanding decoding accuracies of 94.9% (SD:\n4.  79%) for 0.1-second, 96.0% (SD: 4.00%) for 1-second, 96.5% (SD: 3.59%) for 2-second in the\naudio-only scene, and 95.8% (SD: 4.04%) for 0.1-second, 96.4% (SD: 3.72%) for 1-second, 96.8%\n(SD: 3.44%) for 2-second in the audio-visual scene.\nOverall, DARNet's decoding accuracy increases with larger decision windows, consistent with prior research [15, 14]. This is because longer decision windows provide more information for the model to make judgments while also mitigating the impact of individual outliers on the predictions. However, DARNet still maintains excellent performance under the 0.1-second decision window. Additionally, we observe that in the MM-AAD dataset, performance is better in the audio-visual condition compared to the audio-only condition in two different scenarios. We attribute this improvement to the visual cues aiding humans in localizing sound sources."}, {"title": "Ablation Study", "content": "We conducted comprehensive ablation experiments by removing the spatial feature extraction module, the temporal feature extraction module, and the feature fusion module. Additionally, we supplemented our study with ablation experiments using a single-layer attention refinement module on the KUL and DTU dataset, referred to as single-DARNet. All experimental conditions remained the same as in previous settings. Additionally, we ensured that all model network parameters were fully optimized to guarantee that the model's performance reached its best under each condition, whether a module was removed or added. The results of the ablation experiments are shown in Table 3.\nExperimental results show that on the DTU dataset, after removing the spatial feature extraction module from DARNet, the average accuracy decreased by 10.1% under a 0.1s decision window, 13.1% under a 1s decision window, and 12.0% under a 2s decision window. After removing the temporal feature extraction module, the average accuracy for the 0.1s, 1s, and 2s decision windows decreased by 10.9%, 14.2%, and 11.9%, respectively. After removing the feature fusion module, the average accuracy decreased by 2.5% under a 0.1s decision window, 1.6% under a 1s decision window, and 1.4% under a 2s decision window. On the KUL dataset and the MM-AAD dataset, removing the aforementioned modules also resulted in similar trends of decreased average accuracy."}, {"title": "Discussion", "content": ""}, {"title": "Comparative Analysis", "content": "To further evaluate the performance of our proposed DARNet, we compared it with other advanced AAD models, as shown in Table 2. The results indicate that our DARNet has achieved a significant improvement over the current state-of-the-art results."}, {"title": "Ablation Analysis", "content": "As shown in Table 3 and Figure 3, compared with removing the spatial feature extraction step, removing the temporal feature extraction step, removing the feature fusion module, and using a single-layer attention refinement module, we believe DARNet performs excellently for the following reasons:\n1. Integrating multiple sources of information: DARNet integrates temporal and spatial distribution features from EEG signals, constructing richer and more robust spatiotemporal features. This enables the model to comprehensively understand the spatiotemporal information within EEG signals, thereby enhancing the understanding of brain activity. In contrast, removing any single feature may lead to information loss or the inability to capture the transient changes in EEG signals, thereby impacting the model's performance.\n2. Comprehensive capture of temporal dependencies: The dual attention refinement module and feature fusion module of DARNet comprehensively capture temporal patterns and dependencies at different levels, enabling the model to better understand the temporal dynamics within EEG signals. This holistic consideration of features at different time scales is crucial for the analysis of EEG data.\n3. Robust feature representation: Despite observing that removing the feature fusion module did not lead to a significant decrease in accuracy across the three datasets, the performance variability of DARNet increases substantially. We believe that the feature fusion module integrates temporal patterns and dependencies at different levels, enabling the model to better understand and utilize the complex relationships within the data, thus enhancing the robustness and generalization of the model."}, {"title": "Computational Cost", "content": "We compare the training parameter counts of our DARNet, SSF-CNN [37], MBSSFCC [15], and DBPNet [20], with the results shown in Table 4. The parameter count of DARNet is 51.6 times lower than that of SSF-CNN, 1331.5 times lower than that of MBSSFCC, and 0.91 times lower than that of DBPNet. Compared to other models, DARNet demonstrates superior parameter efficiency. Despite having fewer parameters, DARNet maintains good performance, indicating its ability to be applied in resource-constrained environments for AAD analysis, thus demonstrating practical utility."}, {"title": "Conclusion", "content": "In this paper, we propose the DARNet, a novel dual attention refinement network with spatiotem-poral construction for auditory attention detection. By employing spatial convolution operations across all channels, DARNet effectively leverages the spatial information embedded in EEG signals, thereby constructing a more robust spatiotemporal feature. Additionally, DARNet integrates dual attention refinement and feature fusion techniques to comprehensively capture temporal patterns and dependencies at various levels, enhancing the model's ability to capture the temporal dynamics within EEG signals. We evaluate the performance of DARNet on three datasets: KUL, DTU, and MM-AAD. DARNet achieves a decoding accuracy of 96.2% on the 1-second decision window of the KUL dataset and 87.8% on the 1-second decision window of the DTU dataset, demonstrating significant improvements compared to current state-of-the-art models. The experimental results validate the effectiveness and efficiency of the DARNet architecture, indicating its potential for practical applications. In future research, we plan to further explore DARNet's performance on cross-subject tasks to verify its generalization and robustness."}]}