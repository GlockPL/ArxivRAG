{"title": "DuMapper: Towards Automatic Verification of Large-Scale POIs with Street Views at Baidu Maps", "authors": ["Miao Fan", "Jizhou Huang", "Haifeng Wang"], "abstract": "With the increased popularity of mobile devices, Web mapping services have become an indispensable tool in our daily lives. To provide user-satisfied services, such as location searches, the point of interest (POI) database is the fundamental infrastructure, as it archives multimodal information on billions of geographic locations closely related to people's lives, such as a shop or a bank. Therefore, verifying the correctness of a large-scale POI database is vital. To achieve this goal, many industrial companies adopt volunteered geographic information (VGI) platforms that enable thousands of crowdworkers and expert mappers to verify POIs seamlessly; but to do so, they have to spend millions of dollars every year. To save the tremendous labor costs, we devised DuMapper, an automatic system for large-scale POI verification with the multimodal street-view data at Baidu Maps. This paper presents not only DuMapper I, which imitates the process of POI verification conducted by expert mappers, but also proposes DuMapper II, a highly efficient framework to accelerate POI verification by means of deep multi-modal embedding and approximate nearest neighbor (ANN) search. DuMapper II takes the signboard image and the coordinates of a real-world place as input to generate a low-dimensional vector, which can be leveraged by ANN algorithms to conduct a more accurate search through billions of archived POIs in the database for verification within milliseconds. Compared with DuMapper I, experimental results demonstrate that DuMapper II can significantly increase the throughput of POI verification by 50 times. DuMapper has already been deployed in production since June 2018, which dramatically improves the productivity and efficiency of POI verification at Baidu Maps. As of December 31, 2021, it has enacted over 405 million iterations of POI verification within a 3.5-year period, representing an approximate workload of 800 high-performance expert mappers.", "sections": [{"title": "1 INTRODUCTION", "content": "Ubiquitous mobile devices have greatly stimulated people's demand for location-based services [26, 35], which consist of the capability to provide services to a user based on information about a given location. It makes Web mapping services [5, 12, 21, 22, 24] become indispensable tools in our daily lives as more than 90% of mobile owners have utilized them at least once to retrieve places they were interested in [37]. In order to provide user-satisfied search results in Web mapping services (see Figure 1), point of interest (POI) databases [7, 27] are the fundamental infrastructures mainly because they can archive the multimodal information, such as the signboard (image), the name (text), and coordinates (numbers) on billions of real-world places, such as shops or banks, which are closely related to people's lives. Therefore, it plays a vital role in Web mapping services to keep verifying the correctness of a large-scale POI database [6, 45].\nHowever, it is challenging to keep a POI database in sync with the real-world counterparts, due to the dynamic nature of business changes and innovations. To ensure both the quantity and quality [39] of the POI database, most industrial companies adopt volunteered geographic information (VGI) platforms [8, 14, 18, 25], as illustrated by Figure 2a, which enable thousands of crowdworkers and expert mappers to verify POIs seamlessly. To be specific, crowdworkers are responsible for spotting POIs and submitting their street-view photos [2, 15, 31] with coordinates to VGI platforms. Subsequently, expert mappers are in charge of retrieving a group of archived POIs close to each pair of crowdworker-submitted coordinates from the POI database. Then, they choose the same POI that appears in the street-view photo based on their knowledge and mapping expertise. To verify the correctness of a large-scale POI database, VGI platforms require tremendous labor costs. As both crowdworkers and expert mappers should be paid monthly, Web mapping services, such as Baidu Maps, had to spend millions of dollars every year in the past on the task of POI verification.\nInspired by the recent breakthroughs on computer vision [13, 41] and information retrieval with deep neural networks [28, 33], we"}, {"title": "2 RELATED WORK", "content": "In this section, we give an overview of the related work on POI verification in Web mapping services. Given that POI verification is the key task of POI database construction, and that constructing a POI database canonically relies on VGI systems, we will focus here on the two research themes: volunteered geographical information and POI database construction."}, {"title": "2.1 Volunteered Geographical Information", "content": "Volunteered geographical information (VGI) systems encourage the aid of volunteers to generate maps. It involves crowdsourcing workers in producing a highly detailed world map which was only followed by mapping agencies and other government authorities. A representative example of VGI is OpenStreetMap [20], an open and collaborative platform where anyone can contribute and edit POIs. Several studies [11, 20] state that OpenStreetMap can lead to high completeness and correctness but a fair position accuracy. Although OpenStreetMap follows the collaborative paradigm on"}, {"title": "2.2 POI Database Construction", "content": "Over the past decades, OpenStreetMap [20] and Wikimapia [1] have been the representative POI databases mainly established by VGI systems, wherein hundreds of thousands of contributors have collected millions of points of interest, including towns, restaurants, lakes, and tourist attractions. Given that crowdsourcing is their major force for POI generation, the confidence in POI data quality from user-generated content has always been an essential issue on POI database construction by means of VGI systems.\nTo increase the credibility of information sources for POI generation, several studies [6, 7, 38] have been focused on location entity extraction from unstructured Web pages, such as Internet news and official websites. It is because many location entities prefer to publish the business information on their official websites or Internet news in a timely fashion, demonstrating that they are valuable data sources for large-scale extraction of POI information. With the help of Web crawling [32] and information extraction [10, 23] techniques, a POI database can be automatically constructed. Although obtaining POI data from the Internet solves the problem of information credibility to a certain extent, data coverage can become another problem.\nCompared with the text information of POIs on the Web, the signboards appearing in the street-view photos are more widely distributed across the world. Motivated by the broad availability of geo-tagged street-view photos, recent studies [15, 36] proposed a new task on map maintenance via automatically detecting POIs from street views. The new task generally makes the update process of POI databases more proactive because it gives us the same view as we would see on the street in the real world. To be specific, the street-level imagery has a distinctive strength in POI database construction, as not only does the signboard image in the street-view photo imply the existence of a POI, but also the name, location, and address extracted from the street-view data can be used to fill in the POI database.\nAlthough we initially devised DuMapper I, which partly adopts the approaches [15, 36] on POI verification with street views, it still lacks efficiency as the dynamic group of candidate POIs are hardly pre-indexed. Therefore, we further contribute DuMapper II to both research and industrial communities, which revolutionizes the method of obtaining large-scale POI verification by neural information retrieval [19, 33] and greatly improves the efficiency of automatic POI verification with the multimodal street-view data."}, {"title": "3 DuMapper I", "content": "DuMapper I imitates the work method conducted by expert mappers for automatic POI verification at Baidu Maps. As illustrated by Figure 3, it decouples the street-view data into two parts: the coordinates where the street-view photo was taken, as well as the signboards in this photo and then it adopts a three-stage pipeline (i.e., geo-spatial index, optical character recognition, and candidate POI rank) to successively deal with the coordinates and signboard images for automatic POI verification."}, {"title": "3.1 Geo-Spatial Index", "content": "3.1.1 Problem Statement. The key challenge of DuMapper I is how to accurately find the only one POI which appears in the street-view photo from billions of archived POIs at Baidu Maps. On the one hand, the time complexity is extremely high to compare a signboard image one-by-one with the photos of large-scale POIs in the database. On the other hand, the coordinates just show the exact location where the crowdworkers submitted street-view photos but cannot be used directly to find the location of the target POI, as there is also a distance between these two locations which is difficult to measure precisely. Therefore, it becomes the first problem of DuMapper I to choose to which kind of data to narrow the scope of POI retrieval."}, {"title": "3.1.2 Practical Solution", "content": "To address the problem, we decide to use the coordinates as the geo-spatial index to narrow the scope of POI retrieval. The main reasons for this practical solution are two-fold. On the one hand, the coordinate features are more lightweight compared with the features of the signboard images, and the space and time consumption of the index are less. On the other hand, POI images can provide more accurate matching features than coordinates and are more suitable for ranking modules. We leverage ArangoDB to support geo-spatial index, which supersedes other geo-index implementations with the aid of Google S2 geocoding method [9]. This index assumes coordinates with the latitude between -90 and 90 degrees, as well as the longitude between -180 and 180 degrees, and it will ignore all the archived POIs whose spatial distance from the query coordinates is greater than r kilometres."}, {"title": "3.2 Optical Character Recognition", "content": "3.2.1 Problem Statement. After we have obtained thousands of candidate POIs via narrowing the search scope by the geo-spatial index, how to select only one accurate POI from these candidate POIs becomes one of the key problems of ranking. Although the signboard contains rich image and text information compared with coordinates, it is a difficult problem to extract key features for POI ranking, due to the limitations of shooting angle, illumination, etc. These extracted key features can be the name of POI or even the outline information of some signboard images. Therefore, whether to choose text or image features as the evidence for POI ranking and how to extract the corresponding features have become the key issues at this stage."}, {"title": "3.2.2 Practical Solution", "content": "We consider text information to be less susceptible to the shooting angle and illumination change. After we decide to adopt text as the key evidence for ranking, how to extract the textual names of POIs from the signboard images becomes the primary problem. To address the issue, optical character recognition (OCR) is a well-studied technique wherein powerful algorithms already exist. However, the street-view photos taken by portable camera devices do not only contain the signboards of POIs. Therefore, we adopt the conventional steps of text extraction from natural scene images [46] as the practical solution to key evidence generation before POI ranking, which is generally composed of three stages: (1) signboard detection and localization; (2) text enhancement and segmentation; and (3) optical character recognition."}, {"title": "3.3 Candidate POI Rank", "content": "3.3.1 Problem Statement. Given that the results of OCR have a certain probability of being wrong, the problems faced by this module are also different. On the one hand, we need to figure out the way to correct the POI name that was incorrectly recognized from a signboard image. On the other hand, multiple POIs with the same name may also be selected from the set of candidate POIs retrieved by GSI, even if the POI name is correctly extracted by OCR from a signboard image. Therefore, how to further deal with the duplicate name problem is also one of the issues of this stage."}, {"title": "3.3.2 Practical Solution", "content": "The key to reducing the mistakenly recognized samples of OCR is to find the patterns whereby it goes wrong. However, an off-the-shelf OCR software is usually a black box to us: We can only observe its inputs and outputs. Therefore, we decide to train an error correction model to refine the POI names generated by OCR. In order to obtain a large amount of parallel corpus for training, we use the off-the-shelf OCR software to scan all the archived POIs which contain signboard images. As we also know the correct names of those POIs, a seq2seq model [16] can be established for the task of error correction of POI names, with the capability of modelling the frequent patterns on the defects of OCR, based on massively parallel corpora. In this way, the refined name of the recognized POI from signboard images can be used to compute the similarities with the names of candidate POIs. For the problem of duplicated names in the set of candidate POIs, we introduce the outline features of signboard images into the ranking model to distinguish POIs just when the ranked POIs at the top contain the same name, so as to significantly reduce unnecessary feature computations."}, {"title": "4 DuMapper II", "content": "Although DuMapper I has automated the work of expert mappers at VGI platforms, the efficiency bottleneck of this original framework still exists. The main reason is that the group of candidate POIs"}, {"title": "4.1 Deep Multimodal Embedding", "content": "4.1.1 Problem Statement. The major challenge of DuMapper I, which limits the efficiency of automatic POI verification, is the serial computing mode of three different modal features, including the coordinates, the signboard image, and the text name of a POI. Therefore, the first and most critical step of DuMapper II is to fuse the features of the above three different modalities at the same time. In this way, each archived POI in the database can be represented by a multimodal feature and pre-indexed by some kind of data structure (such as trees or graphs) for efficient search. Even if the crowdworkers daily submit millions of requests on POI verification, DuMapper II can easily handle this huge volume of requests. In order to achieve this goal, we need to design an encoding mechanism for the multimodal features of a POI."}, {"title": "4.1.2 Practical Solution", "content": "The street-view data submitted by crowdworkers mainly contain the signboard images of POIs along with their coordinates. A pair of coordinates is conventionally a two-dimensional vector. It contains the longitude (x) and the latitude (y), where the numerical range of longitude is (-180.000000, 180.000000) and that of latitude is (-90.000000, 90.000000). However, a signboard image is usually stored by a matrix or even a tensor. Thus, the cross-modal data with two different dimensions cannot be directly merged. To address this issue, we build a neural model that takes the signboard image, as well as the coordinates of a POI, as input and learns to generate its multimodal vector representation. In this way, not only the archived POIs in the database, but also the real-world places captured by crowdworkers, can be mapped into the same low-dimensional space.\nAs one of the inputs of the neural model, we use a canonical CNN (convolutional neural net) [29] to extract the feature matrix (G') from the raw data (denoted by Z) of the signboard image, as follows:\n$G' = CNN(Z),$\\nwhere $G' \\in \\mathbb{R}^{l \\times d}$\\nFor the other source of input, i.e., the coordinates (x, y), we first use the Geohash algorithm [34] to map the coordinates to a discrete vector space (denoted by i' \u2208 R\u00b9):\n$i' = GeoHash(x, y),$\\nand we further expand each dimension of i' to a random embedding:\n$I' = GeoEmb(i'),$\\nwhere $I'\\in \\mathbb{R}^{l \\times d}$\\nThen we devise a cross-attention neural network to fuse the two kinds of features:\n$I = Softmax(\\frac{QK^{T}}{\\sqrt{d}})V, $"}, {"title": "4.2 Approximate Nearest Neighbor Search", "content": "4.2.1 Problem Statement. The original task of this step is to find the target POI through the archived POIs in the database queried by the POI in the street-view photo. However, after we have obtained the neural model for the multimodal embedding of POIs, both the POI in the street-view photo and the archived POIs can be represented by low-dimensional vectors, which are projected into the same geometric space. Thus, the problem of this step can be stated as a formal expression that, given a set of POI embeddings from the database (denoted by P), we need to build a data structure that returns the nearest neighbor $p \\in P$ of any query POI (denoted by q) in the street-view data."}, {"title": "4.2.2 Practical Solution", "content": "A simple solution to this problem would store the set P in memory, compute all distances D(q, p) for p\u2208 P, and select the point p with the minimum distance. Obviously, it is impractical to calculate all the n distances, as they require at least n operations. Since, in POI databases, n can be as large as 109, it was necessary to develop faster methods that can find the nearest POI without explicitly computing all distances from the query POI in the street-view photo. To address the issue, we use Milvus\u00b2 as the vector database to build an efficient index for scalable similarity search. Moreover, ANNOY\u00b3 is adopted as the index approach because it can divide the embedding space into multiple subspaces and store the vectors of archived POIs in a tree structure. To be specific, ANNOY allows the query vector to follow the tree structure to keep finding the subspace which is closest to the target vector. Then, we just need to compare the distances between the query vector and all the vectors in the subspace, which is on a leaf node of the tree, to obtain the target POI. As a result, the lookup complexity can be reduced logarithmically."}, {"title": "5 EXPERIMENTS", "content": "As an intelligent agent for industrial use of automatic POI verification, DuMapper needs to be tested thoroughly, regardless of offline or online status. In this section, we will report the results of extensive experiments wherein the performance of several frameworks on POI verification was evaluated by multiple metrics."}, {"title": "5.1 Comparison Frameworks", "content": "Besides the VGI platform supported by expert mappers, there are two versions of DuMapper for POI verification at Baidu Maps. For each version, we have optimized and upgraded it appropriately. Therefore, a total of five different frameworks were involved in the experimental evaluation."}, {"title": "5.1.1 Expert Mapper (VGI)", "content": "In order to obtain a benchmark assessment on both accuracy and efficiency of POI verification conducted by a professional worker, we monitored the production capacity of more than 100 expert mappers employed by Baidu Maps over 2 weeks and report the average performance of one expert. As expert mappers do not need to participate in the offline evaluation, the results of the assessment will serve as comparison data in the online A/B test for automatic POI verification."}, {"title": "5.1.2 DuMapper I", "content": "This is the first automatic framework adopted by Baidu Maps for automatic POI verification. It imitates the workflow conducted by expert mappers and adopts a three-stage pipeline, i.e., geo-spatial index (GSI), optical character recognition (OCR), and candidate POI rank (CPR), to deal with the coordinates, as well as the signboard images, in street-view data, for the task of automatic POI verification."}, {"title": "5.1.3 DuMapper I*", "content": "Inspired by the recent work on automatic POI verification with street views [15, 36], DuMapper I* further leverages the matching feature of signboard images, which may facilitate POI search by the additional information. Superior to DuMapper I, it upgrades the CPR module via extending the modality of ranking features and is regarded as the state-of-the-art framework on automatic POI verification."}, {"title": "5.1.4 DuMapper II", "content": "This is a novel framework contributed by this paper for automatic POI verification. It revolutionizes the method of DuMapper I which only imitates the workflow conducted by expert mappers. To increase the productivity of POI verification, DuMapper II is composed of two advanced modules: projecting all the archived POIs into the same vector space by deep multimodal embedding (DME), and directly obtaining the nearest POI for verification via an approximate nearest neighbor (ANN) search."}, {"title": "5.1.5 DuMapper II*", "content": "Although DuMapper II is extremely efficient with the aid of ANN search, it is prone to reduce the accuracy of POI retrieval if we just set the number of nearest neighbor to 1. As an industrial framework for automatic POI verification, accuracy is the most important indicator. Therefore, we made a trade-off between accuracy and efficiency of DuMapper II and further proposed DuMapper II*. The number of nearest neighbors is set to 10"}, {"title": "5.2 Offline Assessment", "content": "5.2.1 Real-world Dataset. The VGI platform was the mainstream source to keep the POI database of Baidu Maps in sync with its real-world counterparts. Large-scale street-view data have been submitted by thousands of crowdworkers over years. For offline assessment, we randomly sampled a real-world dataset from the POI database, where each instance of data is mainly composed of the identifier of a POI and the signboard images of the POI, as well as the coordinates where the signboard images were taken. Table 1 shows statistics of the real-world dataset for the offline assessment of automatic POI verification at Baidu Maps. There are three subsets in the dataset, which are separately leveraged for the purpose of model training (abbr. Train), hyper-parameter tuning (abbr. Valid), and performance testing (abbr. Test)."}, {"title": "5.2.2 Evaluation Metrics", "content": "For each signboard image with coordinates, the task of POI verification is to find the exact POI through the large-scale POI database with the highest probability. It leads us to use SR@K as the metric to evaluate the success rate of ranking the target POI in top K predictions. Although SR@1 is the desired measurement which is also mainly concerned with online testing, we still decide to determine the results of the offline assessment on SR@3 and SR@5. The purpose of this is to know the proportion of target POI ranked from second to fifth, so as to guide our optimization direction of automatic POI verification."}, {"title": "5.2.3 Analysis of Experimental Results", "content": "Table 2 reports the experimental results of the offline evaluations on different frameworks for POI verification at Baidu Maps. All the automatic frameworks are trained and validated, as well as tested by the real-world dataset shown by Table 1 and measured by SR@K. From the results of offline assessments, we can see that 2nd-generation DuMappers (i.e., DuMapper II and DuMapper II*) generally perform better than those of 1st-generation. Compared with DuMapper I, the state-of-art framework DuMapper I* obtains significant improvements by 9.24% SR@1, 9.08% SR@3, and 7.69% SR@5, indicating that the features of signboard images play a huge role in automatic POI verification. Though DuMapper II outperforms DuMapper I*, there exists a gap between the result on SR@1 and SR@3 in DuMapper II. It indicates that over 5% ground-truth POI ranked second and third. Therefore, the re-ranking module in DuMapper II* further improves the accuracy of DuMapper II and achieves the highest SR@1 of 91.74%."}, {"title": "5.3 Online A/B Testing", "content": "5.3.1 Traffic of Street-view Data. We have updated the workflow of POI verification at Baidu Maps multiple times. For each time, we would routinely deploy the new framework online and make it randomly serve 10% traffic of the street-view data submitted by thousands of crowdworkers. During the period of A/B testing, the performance of the new framework would be monitored and compared with the performance of the framework that has already been launched to production. This period conventionally lasts for at least one week. Even if the results of A/B testing show that the new framework can outperform the one in production, we still need to keep an eye on the performance of the new framework when it begins to serve the full traffic of street-view data for some time, in case of the bias on traffic sampling."}, {"title": "5.3.2 Evaluation Metrics", "content": "As an industrial framework for automatic POI verification, accuracy is the most important indicator which is equivalent to SR@1. After all, what is ultimately required by the users who daily use Web mapping services is the correctness of POI information. While trying to ensure the accuracy of POI information, we also hope to reduce costs and increase efficiency. Therefore, the other one of the critical objectives of the task of POI verification is to increase its throughput. To quantify this throughput, we borrow the QPS (query per second) indicator from information retrieval systems. The indicator implies the efficiency of an automatic POI verification framework, representing how many POI verification requests the framework can handle per second on average."}, {"title": "5.3.3 Analysis of Experimental Results", "content": "Table 3 shows the experimental results of the online A/B testing on different frameworks for automatic POI verification. All the frameworks are tested by the real traffic of the street-view data submitted by the crowdworkers at Baidu Maps. Although accuracy is the most important indicator, which is equivalent to SR@1, QPS is another key objective to reduce costs and increase efficiency. Therefore, the other one of the critical objectives of POI verification task is to increase its throughput. From the results of online testing, we can first figure out that an expert mapper performs the highest accuracy of 94.52%, without a doubt, but dramatically slower than automatic systems. DuMapper II owns the highest QPS of 152.49, which is 50 times of the efficiency of DuMapper I. The throughput of the automatic POI verification framework tends to be significantly reduced by the re-ranking module which is widely adopted by DuMapper I, I*, and II*; however, the module can help increase the accuracy. Therefore, we made a trade-off between accuracy and efficiency in DuMapper II* by reusing the multimodal ranking module in DuMapper I* as the final decision step for POI verification and achieved the highest accuracy among all the automatic POI verification frameworks. Even so, the efficiency of DuMapper II* can still be at least doubled, since the number of POIs used for re-ranking is fixed and controllable."}, {"title": "6 CONCLUSION", "content": "In this paper, we present DuMapper, an automatic system for large-scale POI verification with the multimodal street-view data at Baidu Maps. Our critical contributions to both research and industrial communities are listed as follows.\nPotential impact: DuMapper is designed to be an intelligent agent that can continuously verify POIs with the multimodal street-view data at the VGI platform in place of thousands of expert mappers. It plays a vital role in Web mapping services to keep a large-scale POI database in sync with its real-world counterparts.\nNovelty: DuMapper II revolutionizes the original way of enacting automatic POI verification, i.e., DuMapper I, which just imitates the workflow conducted by expert mappers. DuMapper II is a highly efficient framework, which is mainly composed of two advanced modules; (1) A deep multimodal embedding module (DME), which can take the signboard image and the coordinates of a POI from the street-view data as input and generate a multimodal vector representation; and (2) An approximate nearest neighbor (ANN) search module, which takes advantages of ANN algorithms to conduct a more accurate search through billions of archived POI embeddings in the database for verification within milliseconds.\nTechnical quality: Extensive assessments have been conducted both offline and online. Compared with DuMapper I, experimental results demonstrate that DuMapper II can significantly increase the throughput of automatic POI verification by 50 times.\nScalability: The performance of DuMapper is equivalent to the workload of 800 high-performance expert mappers.\nReproducibility: We have released the source code of DuMapper II to ensure the reproducibility of this work."}, {"title": "7 FUTURE WORK", "content": "POI verification is not the only way to maintain a POI database's correctness. Statistics show that the attributes of 74.5% POIs at Baidu Maps have been updated in the year 2020 [38]. Therefore, besides automatic POI verification, it is also important to explore automatic methods for effectively adding, deleting, and updating POIs. As such, we could provide users with up-to-date POI information to help them make informed decisions about local businesses.\nIn the future, we plan to extend the capability of DuMapper to maintain the correctness of the large-scale POI database at Baidu Maps from three perspectives, as follows.\nAutomatic POI addition: If a real-world counterpart cannot be found in the database, it is most likely a newly-established POI. Furthermore, to add the POI into the database, DuMapper should recognize the name from its signboard image and calculate the exact coordinates of this POI with the street-view imagery.\nAutomatic POI deletion: Once the coordinates of a newly-added POI are occupied by a certain archived POI in the database, it is very likely that the archived POI has been closed down. DuMapper should be able to delete this archived POI from the database by analyzing the street views submitted by crowdworkers.\nAutomatic POI updates: The attributes of a POI, such as its business hours or contact details, may be changed over time. These kinds of information may also appear in the street views in the form of sticker ads. Therefore, we need to extend the capability of DuMapper in extracting more attributes of real-world counterparts from street views [42\u201344]."}]}