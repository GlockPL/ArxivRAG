{"title": "Machine Learning-Based Reward-Driven Tuning of Scanning Probe\nMicroscopy: Towards Fully Automated Microscopy", "authors": ["Yu Liu", "Roger Proksch", "Jason Bemis", "Utkarsh Pratiush", "Astita Dubey", "Mahshid Ahmadi", "Reece Emery", "Philip D. Rack", "Yu-Chen Liu", "Jan-Chi Yang", "Sergei V. Kalinin"], "abstract": "Since the dawn of scanning probe microscopy (SPM), tapping or intermittent contact mode has\nbeen one of the most widely used imaging modes. Manual optimization of tapping mode not only\ntakes a lot of instrument and operator time, but also often leads to frequent probe and sample\ndamage, poor image quality and reproducibility issues for new types of samples or inexperienced\nusers. Despite wide use, optimization of tapping mode imaging is an extremely hard problem, ill-\nsuited to either classical control methods or machine learning. Here we introduce a reward-\ndriven workflow to automate the optimization of SPM in the tapping mode. The reward function\nis defined based on multiple channels with physical and empirical knowledge of good scans\nencoded, representing a sample-agnostic measure of image quality and imitating the decision-\nmaking logic employed by human operators. This automated workflow gives optimal scanning\nparameters for different probes and samples and gives high-quality SPM images consistently in\nthe attractive mode. This study broadens the application and accessibility of SPM and opens the\ndoor for fully automated SPM.", "sections": [{"title": "Introduction", "content": "Scanning probe microscopy (SPM) has revolutionized our understanding of the\nnanoworld, providing unprecedented insights into the structure and properties of materials at the\nnanoscale. This powerful technique allows for structural imaging in diverse environments,\nincluding ambient conditions, liquids, and vacuum, making it versatile for various applications\n[1-3]. Over the years, SPM has evolved significantly, building upon the initial contact and non-\ncontact modes [4, 5] to yield a broad array of advanced imaging modes. These advancements\nhave been driven by continuous improvements in hardware and electronics, culminating in the\nability to achieve atomic resolution imaging even in ambient conditions [6].\n\nTopographic imaging in SPM not only reveals the surface morphology but also provides\nadditional information through various signal channels. For instance, in the basic tapping mode\nwith periodic drive, phase signals can be obtained and offer insights into material properties and\ninteractions [7, 8]. Moreover, SPM's versatility is further enhanced by the introduction of multi-\nfrequency modes, as demonstrated in [9, 10]. These modes enable the simultaneous acquisition\nof multiple data channels, enriching our understanding of the sample's properties.\n\nThe range of functional imaging modes available in SPM is broad and encompasses\nvarious physical properties, such as magnetic [5, 11, 12], mechanical [4, 5], biological [3, 13-15],\nferroelectric [16], and electrical characteristics [5, 17]. Each of these modes allows researchers to\nprobe different aspects of the sample, providing a comprehensive view of its functional behavior.\nHowever, the effectiveness and reliability of these functional imaging modes are critically\ndependent on the quality of topographic imaging. Operators must simultaneously achieve\nmultiple objectives, including optimizing image stability, enhancing resolution, and minimizing\nboth reversible and irreversible changes in the probe and sample states. Achieving these goals is\na complex and time-consuming process that requires significant expertise. The success of SPM\nimaging heavily depends on the operator's skill and experience, often leading to irreproducible\nresults when different operators or probes are involved. For example, when imaging hard\nsamples like crystals and ceramics [3, 18-20], a set of inappropriate scanning parameters can lead\nto fast probe degradation and poor image quality. On soft samples such as soft matters and liquid\nsamples [2, 14, 15, 21-23], non-optimal scanning parameters lead to irreversible sample damage\nand poor image quality. This challenge is particularly pronounced when dealing with soft\nsystems, nanoparticles, molecules, high-resolution imaging, and imaging in liquids.\nTransitioning from robust calibration on hard samples to these more delicate and complex\nsystems requires meticulous optimization.\n\nOne of the most widely used SPM imaging modes is tapping mode [24, 25], also known\nas intermittent contact (AC) or amplitude-modulated (AM) mode. In tapping mode, the\ncantilever is driven at or near its lowest resonance frequency. The amplitude and phase of its\noscillations are detected using a lock-in amplifier. As the tip approaches the surface, the tip-\nsurface interactions dampen the cantilever's amplitude, which can then be used as a feedback\nsignal for topographic imaging. A key advantage of tapping mode is its ability to significantly"}, {"title": "", "content": "reduce tip and surface damage, making it suitable for imaging much softer samples compared to\ncontact mode.\n\nOptimizing the scanning parameters in tapping mode is a very difficult task. This is ill-\nsuited to machine learning methods, as all surfaces are different and hence the classical\nsupervised ML paradigm is poorly applicable [26]. This problem is equally complex for classical\ncontrol methods, as it is not clear how the cantilever dynamics translate into image quality. Each\nsample's unique topography, mechanical properties, and environmental interactions contribute to\na complex, high-dimensional parameter space that defies straightforward modeling or control.\nTraditional approaches struggle with this variability, often resulting in suboptimal imaging\nconditions that can lead to poor resolution, increased noise, or even damage to the sample and\nthe probe [27, 28]. At the same time, we note that human operators learn to optimize the\nscanning conditions, and this knowledge is transferable between different materials and\ninstruments. Skilled operators can intuitively adjust parameters based on their knowledge and\nexperience, achieving high-quality imaging through iterative experimentation and fine-tuning.\nHence, we seek to develop an approach that allows transferring the human operator decision-\nmaking principles to machine learning workflows. By incorporating human expertise into a\nreward-driven machine learning framework, we aim to automate the optimization process,\nensuring consistent, high-quality imaging across diverse samples and conditions, while reducing\nthe dependency on operator expertise and minimizing the risk of errors.\n\nIn this work, we demonstrate that reward-driven, rather than data-driven, machine\nlearning methods can effectively automate the optimization of SPM imaging for various samples,\nprobes, and microscopes in a traceable manner with minimal requirement of computation power\nthat can be fulfilled on a local computer without use of graphic processing unit (GPU), which\nmakes it widely accessible. The key innovation in our approach is the introduction of a reward\nfunction that transforms the tuning problem into a classical optimization task. This reward\nfunction is based on the trace and retrace scan lines of height and phase channels, incorporating\nboth physical and empirical knowledge of high-quality scans. Essentially, the reward function\nemulates human expertise, guiding the machine learning algorithm to optimize imaging\nparameters and consistently achieve the best possible image quality. Despite its apparent\nsimplicity, this solution has eluded the microscopy community for four decades. By leveraging\nmachine learning, we aim to standardize and streamline the optimization process, reducing\ndependency on operator expertise and improving the reproducibility of SPM imaging."}, {"title": "Reward function-based optimization", "content": "The key aspect of any microscopy experiment is the optimization of image conditions,\nwhich typically represents a considerable fraction of the instrument time and effort of the human\noperator. During this process, the operator tunes the parameters while simultaneously assessing\nthe quality of the data streaming from the instrument. This tuning of imaging conditions in any\nmicroscopy mode can be generally represented as an optimization problem within the parameter"}, {"title": "", "content": "space of the instrument controls, which are typically well known and provided by the\nmanufacturer. However, defining image quality presents a very complex problem. For atomically\nresolved imaging in electron microscopy [29] or scanning tunneling microscopy [30], the shape\nof atomic columns or the presence and intensity of lattice peaks in Fourier transforms offer\nnatural optimization targets [31]. With the optimization target and parameter space defined, this\nbecomes a classical optimization problem.\n\nIn non-atomically resolved imaging, unambiguous measures of image resolution or\nquality are absent. Furthermore, these cannot be defined using classical machine learning\napproaches since each topographic image is different and hence unique with respect to previous\nexamples. While supervised ML workflows can be built for mature fields such as semiconductor\nimaging, this paradigm is limited for open-ended research problems. Additionally, descriptive\nstatistics-based measures tend not to be robust with respect to noise and scan instabilities.\nPrevious attempts at automatically tuning SPM have focused on adjusting the PI (proportional-\nintegral) feedback parameters by defining reward functions based on the alignment of the trace\nand retrace of the height channel. However, these approaches usually result in scanning\nparameters that lead to rapid probe and sample degradation.\n\nDespite these challenges, human operators learn to optimize scanning conditions through\nexperience acquired on different samples. They intuitively adjust parameters based on real-time\nfeedback from the instrument and their accumulated knowledge of how different settings affect\nimage quality. This ability to adapt and fine-tune parameters through iterative experimentation\nenables skilled operators to achieve high-quality imaging even under varying and challenging\nconditions.\n\nTherefore, the key challenge in automating the optimization of the tapping mode (TM) is\nto find a reward function that works universally across different probes, materials, topologies,\nand operational environments. Here we design such a reward function based on trace and retrace\nscan lines that incorporates both physics-based knowledge and empirical insights. Compared to\nreward functions defined based on entire images, those based on scan lines are approximately\n100 times faster, depending on the number of pixels in the scan. This significant speed advantage\nmakes the optimization process practical for real-time operation. By focusing on the critical\nfeatures of scan lines, such as the alignment and consistency between trace and retrace lines, we\naim to develop a robust and efficient optimization framework that can consistently yield high-\nquality imaging across a wide range of conditions."}, {"title": "Imaging regimes for TM AFM", "content": "Depending on probe types, samples, and setup parameters, SPM can operate in either\nattractive or repulsive mode [8]. In attractive mode, the microscope tip operates predominantly\nunder long-range attractive forces, such as van der Waals (vdW) interactions, without physical\ncontact. This allows high-resolution imaging while minimizing deformation and damage of\nprobes and samples. Conditions that favor attractive mode include small amplitudes, larger and\nless sharp tips, and slower but more sensitive and higher quality factors. Probes often transition\nfrom repulsive to mixed to attractive mode as they wear and the balance of vdW and adhesive\nforces changes. This mode excels in achieving high resolution, preserving the integrity of\ndelicate materials like biomolecules [32], and is ideal for imaging soft or loosely bound\nmaterials. However, it requires precise control of the tip-sample distance, necessitating\nmeticulous calibration and stability. In the operation of SPM, attractive mode is usually\ncharacterized by phases above the free-air phase, which is the measured phase when the probe is\nvery far away from the sample surface."}, {"title": "", "content": "In contrast, large amplitudes, sharp tips and lower quality factors favor a net-repulsive\ninteraction - where strong, short range repulsive forces dominate. In repulsive mode, the tip\nintermittently contacts the sample surface, resulting in predominantly short-range repulsive\nforces, including mechanical contact and repulsive vdW forces [8]. This mode provides\nenhanced sensitivity for measuring mechanical properties, such as stiffness and viscoelasticity,\nand offers better contrast, making it easier to distinguish different materials or features.\nHowever, the physical contact can lead to sample and probe deformation or damage, reducing\nimage resolution and potentially causing irreversible changes to the probe and sample. While\nrepulsive mode is advantageous for mechanical property measurements, it comes with the trade-\noff of potential sample alteration and reduced resolution. SPM is operated in the repulsive mode\nwhen the measured phases are below the free-air phase.\n\nBecause of the tip-shape dependence discussed above, if a probe is initially imaging in\nrepulsive mode, it will often transition from repulsive to mixed to attractive mode as they wear\nand the balance of vdW and adhesive forces changes. The transition between attractive and\nrepulsive modes can result in high transitory forces [33] and is indicated by phases jumping\nacross the free-air phase.\n\nIn this work, we focus on optimizing tip wear while still obtaining high spatial resolution.\nThis requires a stable and robust approach to parameter tuning that can adapt to the varying\nconditions of different samples and imaging modes. Our goal is to develop a method that ensures\nconsistent high-quality imaging across diverse applications, minimizing the trade-offs between\nresolution, sensitivity, and sample integrity. By leveraging a reward-driven machine learning\nframework, we aim to emulate the adaptive expertise of human operators, providing a scalable\nsolution to the complex optimization problem in SPM imaging. This approach promises to\nenhance the efficiency, reliability and autonomy of SPM, making it more accessible and\neffective for a wide range of scientific and industrial applications."}, {"title": "Define the parameter space and reward function", "content": "Below we discuss the relationship between different SPM modes, scan quality,\nsafety of the sample and probe, and the tip-sample distance. In SPM, the tip-sample distance is\ncontrolled by the ratio between the setpoint amplitude ($A_{setpoint}$) and free-air amplitude ($A_{drive}$,"}, {"title": "", "content": "also known as free amplitude) so the discussion of the physical mechanisms will be guided by\nthe ratio of setpoint amplitude and free-air amplitude.\n\nWhen the tip is far away from the sample surface (large $A_{setpoint}/A_{drive}$), there are no forces\nbetween tip and sample. Consequently, the probe is oscillating far above the sample surface\ninstead of following the surface profile, leading to phases close to the free-air phase and random\nheight traces as shown in Figure 2c, subjected to either small drift or other noise in the signal.\n\nAs the tip gets closer to the sample surface (smaller $A_{setpoint}/A_{drive}$), SPM works in the\nattractive mode and there are typically long-range attractive forces arising between the tip and\nsurface. This attractive force will decrease the amplitude of the cantilever to the setpoint\namplitude at a fixed tip-sample distance, as shown in Figure 2d. As a result, the trace and retrace\nlines follow closely the sample surface profile with reasonably high spatial resolution and the\nphases are above the free-air phase. In addition, the force between the tip and sample is kept at a\nsmall, net-attractive value and that helps minimize tip and sample damage. This mode is the goal\nfor this work.\n\nWhen the tip gets even closer to the sample surface (smaller $A_{setpoint}/A_{drive}$), SPM jumps\nbetween attractive mode and repulsive mode as the interaction between the tip and sample jumps\nbetween the long-range attractive forces and short-range repulsive forces. Consequently, there\nare sudden jumps in the phase traces across the free-air phase in this crossover mode, as shown\nin Figure 2b. A previous study showed that the transition between attractive and repulsive mode\ncan result in very high transitory forces between the tip and the sample [33] .As a result, the trace\nand retrace lines match poorly due to the high transitory forces when the phase jumps occur in\nFigure 2e.\n\nWhen $A_{setpoint}/A_{drive}$ is further decreased, the interaction between the tip and sample is\nmore likely to be completely dominated by the short-range repulsive forces. In this mode, the\nphases are below the free-air phase most of time. The spatial resolution is suppressed and the tip\nwears off quickly due to the large forces between the tip and sample, as shown in Figure 2f.\n\nBased on the basic physical principles of SPM discussed above, we define the reward\nfunction based on four components derived from the trace and retrace scan lines of the height\nand phase channels. The height alignment term quantifies the agreement between the trace and\nretrace lines in the height channel. The phase term measures if the probe is operating in the\nattractive mode by detecting the presence of phase angles below the free-air phase. The distance\nterm favors lower probe heights to make sure the probe is as close to the sample surface as\npossible. Finally, the contrast term tries to maximize the amount of information acquired by\nfavoring a large contrast in the height channels. Assembling all these components together, we\ndefine the reward function based on a pair of trace and retrace lines of height and phase channels\nas following equation:\n\n$Rewards = -log(|h_{trace} \u2013 h_{retrace}|) \u00d7log(N_{e<0 free}/N_{e>0free}) \u00d7 log(h_{min}\n\u2013 h_{global min}) + log(otraces)$                                                                                           (1)"}, {"title": "", "content": "where $h_{trace}$ and $h_{retrace}$ are the trace and retrace height scan lines, $N_{e<0 free}$ and $N_{e>0free}$ are\nthe number of pixels in the phase scan lines below (repulsive mode) and above (attractive mode)\nthe free phase angles, $h_{min}$ is the lowest probe position of current trace and retrace height lines\nwhile $h_{global min}$ is the global lowest probe position computed based on all the acquired scan\nlines, $otraces$ is the standard deviation of the height lines to represent the contrast.\n\nWhen the probe is far away from the sample surface and only very weakly interacting\nwith the sample, the traces will be dominated by cantilever sensor noise. Sensor noise will\ngenerally have little or no correlation between trace and retrace. The resulting height traces agree\npoorly with each other and the distance between the probe and sample is large as shown in\nFigure 2c. Therefore, both the height alignment term and distance term give bad reward values to\nsignal a bad scan. In the attractive mode, every component in our reward function gives good\nrewards as the height traces align well, the phases are consistently above the free-air phase, the\nprobe is close to the sample surface, and there is a reasonable amount of contrast, as shown in\nFigure 2d. In the crossover mode as shown in Figure 2e, the phases below the free-air phase\nleads to a bad reward in the phase term. In the repulsive mode as shown in Figure 2f, most of the\npixels in the scan lines show phases below the free-air phase, giving a very small reward to\nprevent the SPM from working in this mode.\n\nIn summary, our proposed reward function accurately distinguishes between a set of good\ntopography scanning parameters in the attractive mode from bad parameters in other modes. In\naddition, it also leaves the flexibility to adjust the weight of different components to fine-tune for\ndifferent applications."}, {"title": "Reward based optimization and results", "content": "We employed Bayesian optimization (BO) to optimize the scanning parameters, focusing\non two key parameters: free-air amplitude and setpoint, under consistent conditions. In addition\nto the physical knowledge about SPM that we encoded into the reward function, we found it\nnecessary to guide the optimization process with human empirical knowledge, especially on\ndefining the parameter space.\n\nTo set up a high-resolution scan in the attractive mode, human operators usually start\nwith a small driving voltage and a large setpoint that ensures gentle force between the probe and\nsample. The smallest free amplitude can be estimated by the roughness of the sample in the\ngiven scan size. Then the setpoint is decreased from a large starting value until the trace and\nretrace lines agree with each other and thus follow the corrugation of the sample surface. Once\nthe free-air amplitude and setpoint are determined, human operators can also increase the integral\ngain (I gain) as high as possible without the PI loop becoming unstable and oscillatory.\n\nInitially, we defined the parameter space based on the type of probe and the estimated\nroughness of the sample in the given scan size. For instance, with the Tap300G probe and TiO2\nnanoparticles, the free-air amplitude was constrained between 0.15 nm and 5.9 nm, and the\nsetpoint ranged between 10% and 90% of the free-air amplitude.\n\nOnce the parameter space was established, we randomly sampled 10 points within this\nspace to serve as the initial seeding points. The microscope was then controlled via code to\nmeasure the scan lines at these parameters, from which the reward function could be computed,\nas illustrated in Figure 3a. Using the reward values from these seeding points, we fitted an initial\nGaussian process (GP) model. This model predicted the distribution and uncertainty of the\nreward function across the entire parameter space. Subsequently, the acquisition of expected\nimprovement (EI) was computed based on these predictions and uncertainties as shown in Figure\n3b-c, determining the next set of parameters to be measured by maximizing the El acquisition\nfunction.\n\nTo account for human empirical knowledge of starting the optimization with small free-\nair amplitude and large setpoint, we masked the acquisition function in the parameter space to\nenhance the preference on the parameters with smaller free-air amplitude and larger setpoint, as\nshown in Figure 4c. The scanning parameters were then updated to the new set without\ninterrupting the scan. The reward value for these new parameters was calculated from the newly"}, {"title": "", "content": "acquired trace and retrace scan lines. This new parameters-reward pair was added to the\npreviously collected data to retrain and update the GP model. This iterating process of measuring\nand fitting was repeated until the maximum number of exploration steps was reached or the scan\nquality became satisfactory.\n\nFinally, the optimized parameters were used to conduct a full scan to ensure they\nproduced a high-quality image for the entire scan area. As demonstrated in Figures 3e-f, the\noptimized scanning parameters, determined after 10 seeding steps and 30 exploration steps,\nyielded high-resolution images with stable operation in the attractive mode. In addition, because\nthe scanning parameters were updated in a non-interruption manner, the optimization was\nfinished within the time of two scans."}, {"title": "More challenging samples \u2013 water droplets", "content": "After verifying the functionality of our reward-driven optimization workflow on the TiO2\nnanoparticles, we switched to a water droplet sample to challenge our reward-driven workflow.\nThe water droplet on a mica substrate serves as an excellent testing sample for our autonomous\noptimization workflow. First, the image quality of water droplets is highly sensitive to the tip-\nsample distance. If the distance is too large, the probe cannot accurately follow the height profile\nof droplets. Conversely, if the tip-sample distance is too small, a liquid bridge forms between the\ntip and the droplet, resulting in distortions in the image. More importantly, tuning the scanning\nparameters for water droplets is challenging even for experienced SPM operators, as the optimal\nsetpoint amplitude and free-air amplitude are confined to a narrow region in the parameter space.\n\nDespite these challenges, we were able to find the optimal scanning parameters that give\nhigh-quality TM scans of water droplets with our autonomous workflow as shown in Figure 4e-f\nThe sharp images of small droplets indicate a high spatial resolution in the image. The smooth\nimage of the large droplets in the height map together with the phase map above the free-phase\nreveals that the probe works in the net-attractive mode across the whole image and closely\nfollows the height profile of the droplets without distortion."}, {"title": "Conclusion", "content": "Our reward-driven automatic optimization of SPM in tapping mode represents a\nsignificant advancement for the SPM community. This method not only drastically reduces the\ninstrument time required to tune different probes on various samples but also ensures the\nacquisition of high-quality and highly reproducible SPM images. This automation increases the\napplication and accessibility of SPM by eliminating the need for extensive manual tuning. Our\nstudy lays the groundwork for automating more complex SPM tasks, such as automating more\nadvanced imaging modes and achieving atomic resolution in ambient environments.\n\nMoreover, the broader applicability of this reward-driven optimization workflow across\nthe microscopy community has the potential to transform traditionally complex human-led tasks\ninto streamlined, machine learning-based optimization processes. This shift is crucial for the\nfurther automation of microscopy, addressing one of the last significant barriers to fully\nautomated microscopes.\n\nFinally, we anticipate that our workflow will have a profound impact on open science in\nmicroscopy. While sharing microscope data alone has provided limited benefits due to the\ndiversity of tasks and applications, the sharing of reward functions introduces a new paradigm.\nThis approach fosters a more integrated and collaborative community, enhancing the\nreproducibility and efficiency of microscopy research.\n\nThis comprehensive solution not only democratizes access to high-quality SPM imaging\nbut also propels the field towards a future where automated, intelligent systems are the norm,\nsignificantly advancing both research and industrial applications."}, {"title": "Methods", "content": null}, {"title": "Technical settings", "content": "For the implementation in this paper, we made it light enough to run on a local computer\nwith central process unit (CPU) only. Optimization of scanning parameters in the tapping mode\nrequires an interface library to directly control the SPM and availability of sufficiently high\ncomputational power to support the optimization algorithms. Previously, we have developed a\nPython interface library to control the automation of a Jupiter SPM system manufactured by\nOxford Instrument Asylum Research from a local computer without GPU. Connection with HPC\nwill allow more complicated optimization scheme and we have solutions for that [34]. This\nlibrary not only enables operating the SPM system remotely with code the same way as human\noperators, but it also has access to the intermediate data like trace and retrace scan lines in all the\nchannels."}, {"title": "Samples", "content": "The (CrVTaW)xM01-x thin film was grown via de magnetron co-sputtering from a 50 mm\ndiameter Mo and an equiatomic CrVTaW target at 500\u00b0C substrate temperature. The system was\npumped to ~ 3x10-7 Torr and backfilled with Ar to 5 mTorr and the sputtering powers (200 W for\nCrVTaW and 100 W for Mo) were adjusted to give approximately equivalent sputtering rates (10\nnm/min determined via x-ray reflectance) of the two targets at the substrate center. The pseudo\nbinary (CrVTaW)xM01-x composition varies from 15 <x <88 at. % across the 100 mm diameter\nsubstrate with a roughly linear composition gradient.\n\nThe PbTiO3 (PTO) thin films were grown on La0.7Sr0.3MnO3 (LSMO) buffered (110)-oriented\nSrTiO3 (STO) single crystal substrates using pulsed laser deposition (PLD) with a KrF excimer\nlaser (\u03bb = 248 nm). The LSMO/PTO layers were deposited at temperatures of 700 \u00b0C/690 \u00b0C\nwith oxygen pressures of 100 mtorr/150 mtorr, respectively. After deposition, the samples were\ncooled to room temperature under an oxygen pressure of 700 Torr. The thicknesses of the PTO\nand LSMO layers are approximately 150 nm and 30 nm, respectively.\n\nPb0.995(Zr0.45Ti0.55)0.99Nb0.01O3 films were grown by pulsed laser deposition using a KrF excimer\nlaser from a ceramic target onto a SrRuO3-electroded (001) SrTiO3 single crystal. The SrRuO3\nfilm was grown from a target from Kojundo Chemical Lab. Co. Ltd., using a laser energy density\nof 1.5 J/cm\u00b2, a substrate temperature of 660\u00b0C, an oxygen pressure of 120 mTorr, a target-to-\nsubstrate distance of 6.7 mm, and a frequency of 5 Hz. The SrRuO3 film thickness was around\n50 nm. The PZT film was grown from a target with 20% excess PbO to compensate for lead loss\nduring growth, using a laser energy density of 1.5 J/cm\u00b2, a substrate temperature of 630\u00b0C, an\noxygen pressure of 120 mTorr, a target-to-substrate distance of 6.2 mm, and a frequency of 5 Hz.\nThe PZT film thickness was around147 nm.\n\nTiO2 NPs were synthesized via a modified solvothermal method. Titanium tetraisopropoxide\n(TTIP, 99.95%, Sigma Aldrich) served as the titanium precursor, and anhydrous ethanol was\nutilized as the solvent. In a standard synthesis, 0.1 M of TTIP was combined with 50 mL of"}, {"title": "", "content": "ethanol and stirred uniformly for one hour. Subsequently, a mixture of 50 mL ethanol and\ndeionized water in a 1:1 ratio was added to the solution, followed by vigorous stirring for another\nhour. To induce rapid hydrolysis, a few drops of pH 4.0 H2SO4 were introduced. The resulting\nwhite solution was then placed in a tightly sealed reagent bottle and subjected to solvothermal\ngrowth at 90\u00b0C for 12 hours. The final products were centrifuged and washed several times with\nde-ionized water to eliminate any bound sulfate ions. The resulting NPs were dried and annealed\nat varying temperatures (400 \u00b0C) for one hour. These obtained NPs were characterized by X-ray\ndiffraction and scanning electron microscopy for their structure evaluation.\n\nThe Cs3Bi2I9 (CBI) microcrystals (MCs) were synthesized through a solvent-free\nmechanochemical activation method, as detailed elsewhere [35]. In this procedure, the precursors\ncesium iodide (CsI; Aldrich, 99.999% ultra-dry, metals basis), bismuth iodide (BiI3; Sigma-\nAldrich, 98%), were ground for 15 minutes under ambient conditions using a mortar-pestle. The\nresultant powder was then washed three times with a mixture of dimethyl formamide (DMF) and\ndimethyl sulfoxide (DMSO) solution. Afterwards chloroform (CHCl3) was utilized as an\nantisolvent to obtain orange microcrystals. The MCs were characterized by X-ray diffraction and\nscanning electron microscopy for their structure evaluation.\n\nThe preparation of CaCl2-solution droplets on mica substrate follows the recipe described in\n[22]."}, {"title": "SPM setup", "content": "All the tapping mode SPM measurements were performed on a Jupiter SPM system\nmanufactured by Oxford Instruments Asylum Research. The probes tested include\nASYELEC.01-R2 and AC 160TS-R3 from Asylum Research, Multi75G and TAP300G from\nBudgetSensor, and AD-2.8-AS diamond probe from Adama Innovations."}, {"title": "Code Implementation", "content": "Botorch [36] was utilized as the Bayesian optimization framework, employing the Expected\nImprovement (EI) acquisition function. The surrogate Gaussian Process (GP) model was\nincorporated using gpytorch [37]. In the optimization of two scanning parameters described in\nthis paper, we sampled the reward function in a parameter space with 100 x 100 pixels. All the\nparameters are normalized to be within (0, 1)"}]}