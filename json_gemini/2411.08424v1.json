{"title": "A Heterogeneous Graph Neural Network Fusing Functional and Structural Connectivity for MCI Diagnosis", "authors": ["Feiyu Yin", "Yu Lei", "Siyuan Dai", "Wenwen Zeng", "Guoqing Wu", "Liang Zhan", "Jinhua Yu"], "abstract": "Brain connectivity alternations associated with brain disorders have been widely reported in resting-state functional imaging (rs-fMRI) and diffusion tensor imaging (DTI). While many dual-modal fusion methods based on graph neural networks (GNNs) have been proposed, they generally follow homogenous fusion ways ignoring rich heterogeneity of dual-modal information. To address this issue, we propose a novel method that integrates functional and structural connectivity based on heterogeneous graph neural networks (HGNNs) to better leverage the rich heterogeneity in dual-modal images. We firstly use blood oxygen level dependency and whiter matter structure information provided by rs-fMRI and DTI to establish homo-meta-path, capturing node relationships within the same modality. At the same time, we propose to establish hetero-meta-path based on structure-function coupling and brain community searching to capture relations among cross-modal nodes. Secondly, we further introduce a heterogeneous graph pooling strategy that automatically balances homo- and hetero-meta-path, effectively leveraging heterogeneous information and preventing feature confusion after pooling. Thirdly, based on the flexibility of heterogeneous graphs, we propose a heterogeneous graph data augmentation approach that can conveniently address the sample imbalance issue commonly seen in clinical diagnosis. We evaluate our method on ADNI-3 dataset for mild cognitive impairment (MCI) diagnosis. Experimental results indicate the proposed method is effective and superior to other algorithms, with a mean classification accuracy of 93.3%.", "sections": [{"title": "I. INTRODUCTION", "content": "MAGNETIC Resonance Imaging (MRI) has emerged as a valuable tool in neuroscience, offering deeper objective insights into neurological disorders and their underlying mechanisms. Previous researches have demonstrated the valuable contributions of resting-state functional MRI (rs-fMRI) and Diffusion Tensor Imaging (DTI) among multiple MRI modalities in understanding brain structure and function [1], [2]. Specifically, brain functional connectivity (FC) constructed from rs-fMRI imaging can capture spontaneous neuronal activity and reveal intrinsic connections between brain regions [3], [4] while brain structural connectivity (SC) constructed from DTI imaging is able to provide crucial insights into the integrity of white matter structures and the identification of neural fiber abnormalities [5], [6]. In recent years, many studies find that alterations in neuronal functioning are directly related to alterations in white matter structure [7], [8], which has given rise to a lot of work on dual-modal fusion of FC and SC.\nSince FC and SC can be conveniently described by graphs, framework based on graph neural networks (GNNs) have become a popular choice to identify brain disorders combining dual-modal information [9]\u2013[12]. There are mainly two popular ways to fuse dual-modal information with GNNs, which are feature-level fusion and connectivity-level fusion. Specifically, in feature-level fusion, the same backbone is applied to different modalities to extract functional and structural features separately, then features are concatenated or weighted summed together as the fused feature for further analysis. While in connectivity-level fusion, usually a summative homogeneous graph (i.e., graph that have only one type of node and one type of edge) will be constructed based on fused structural-functional connectivity, and the fused structure-function features will be extracted from the summative graph. While these approaches are able to fuse dual-modal features, there is more information of connectivity yet to be explored. Firstly, there is no feature interaction in the above feature fusion methods, which leads to insufficient feature learning and reduced classification performance. Although connectivity-level fusion provides more consistent feature embedding than feature-level fusion, the summative graphs constructed in homogeneous way may disrupt the inherent heterogeneity between FC and SC, such as differences in feature spaces and graph topologies. These problems urge a new dual-modal fusion approach to better synthesize the information from FC and SC to identity brain disorders.\nHeterogeneous graph (HG) provides new ways of describing the complex connectivity in real world [13], which drives the development of heterogeneous graph neural networks (HGNNs) in fields such as social network analysis and bioinformatics [13], [14]. Considering that integrating FC and SC into HG can effectively preserve the heterogeneous information in the two modalities, we pursue a new dual-modal fusion method based on HG in present work. There are several challenges needed to be addressed yet. Specifically, i) different types of relations in HG are usually defined through meta-path which is semantic dependent [15], [16], meaning that meta-path needs to follow the inherent connectivity within the modality as well as to reveal interactive connectivity between modalities. ii) Pooling strategies for HGs need to cope with more complex relations, and directly applying pooling strategies designed for homogeneous graphs [17], [18] can lead to feature confusion among different types of nodes in HGs. iii) Differences in the incidence of various brain diseases lead to sample imbalance, which in turn affects the classification performance of graph networks.\nTherefore, we propose several effective mechanisms to address these challenges. Firstly, in constructing HG, in order to capture node relationships within rs-fMRI or DTI modality and relationships among cross-modal node pairs, we propose to define homo-meta-path and hetero-meta-path. Based on existing rs-fMRI and DTI studies, we naturally utilize blood oxygen level dependency information to construct FC and white matter fibers to construct SC, which serve as homo-meta-paths. On the other hand, we propose to establish hetero-meta-path from node-level and community-level based on structure-functional coupling [19] and brain community searching [20] to capture cross-modal relationships. Secondly, as existing fusion methods based on GNNs are not capable for HGs, we introduce a novel HG pooling strategy that not only comprehensively considers heterogeneous topology but also can avoid feature confusion among different types of nodes. Thirdly, to address the common issue of sample imbalance in brain disorder datasets, we propose a novel HG augmentation method leveraging the adaptability of HG.\nThe main contributions of our present work can be summarized as follows:\n1) We propose a novel HGNN to fuse rs-fMRI and DTI information for MCI diagnosis. In constructing HG, we propose to establish homo-meta-path reflecting unimodal connectivity and hetero-meta-path reflecting dual-modal inter-relations, where structure-function coupling and brain community searching are used in establishing hetero-meta-path.\n2) We introduce a novel HG pooling strategy which can automatically balance homo- and hetero-meta-path, effectively leveraging heterogeneous information and preventing feature confusion after pooling.\n3) We propose an HG augmentation method leveraging the adaptability of HG to address the issue of sample imbalance, which is a common factor that affects the performance of diagnostic model in classification of brain disorders.\nThe proposed method is validated using a mild cognitive impairment (MCI) dataset sampled from ADNI-3 dataset. Experimental results indicate that our method can achieve remarkable performance for MCI identification.\nThe structure of this paper is organized as follows. Section II introduces the most relevant concepts. In Section III, we introduce materials used in this work. Section IV introduces details of proposed method. In Section V, we introduce experimental settings, state-of-the-art methods and present experimental results. Section VI discusses the influence of proposed key mechanisms in our method. We conclude this letter in Section VII."}, {"title": "II. BACKGROUND", "content": "1) Heterogeneous Graph [21]: A HG denoted as $\\mathcal{G} = {\\mathcal{V}, \\mathcal{E}}$ consists of a node set $\\mathcal{V}$ and an edge set $\\mathcal{E}$, respectively. Considering that different node types and edge types exit in HG, the set $\\mathcal{N}$ of node types and a set $\\mathcal{E}$ of edge types need to be predefined. Then we can build mapping function between nodes and node types as $\\phi: \\mathcal{V} \\rightarrow \\mathcal{N}$, and mapping function between edges and edge types as $\\psi: \\mathcal{E} \\rightarrow \\mathcal{E}$. It's significant to stress that $|\\mathcal{N}| + |\\mathcal{E}| > 2$.\n2) Meta-path [22]: A meta-path $\\Phi$ is defined as a path in a form of $\\mathcal{N}_{1} \\stackrel{\\mathcal{R}_{1}}{\\longrightarrow} \\mathcal{N}_{2} \\stackrel{\\mathcal{R}_{2}}{\\longrightarrow} ...\\stackrel{\\mathcal{R}_{i}}{\\longrightarrow} \\mathcal{N}_{i+1}$, which describes a composite relation $\\mathcal{R} = \\mathcal{R}_{1} \\circ \\mathcal{R}_{2} \\circ \\cdot\\cdot\\cdot \\circ \\mathcal{R}_{i}$ between node types $\\mathcal{N}_{1}$ and $\\mathcal{N}_{i+1}$. Given a meta-path $\\Phi$, there exists a set of meta-path based neighbors which can reveal diverse structure and rich semantic information in HG. Take a node $v_i$ and a meta-path $\\Phi$ for example, the meta-path based neighbors of node $v_i$ are defined as the set of nodes which connect with node $v_i$ via meta-path $\\Phi$. Note that the node's neighbors include itself.\nHAN [23] was first proposed in the field of social network analysis based on the hierarchical attention, including node-level and semantic-level attentions to extract the heterogeneity and rich semantic information from heterogeneous graph.\nFor a node $v_i$ in a HG, we denote its node feature of the $l$-th layer as $h^{(l)}_{v_i}$, the node-level and semantic-level attentions for meta-path $\\phi_p$ as $\\alpha^{(l)}_{ij}$ and $\\beta^{(l)}_{p}$. Then, the updated node feature $h^{(l+1)}_{v_i}$ can be calculated as:\n$h_{v_i}^{(l+1)} = \\sum_{p=1}^{K} \\beta_p^{(l)} (\\sum_{v_j \\in N_{\\phi_p}^{i}} \\alpha_{ij}^{(l)} W_{\\phi_p}^{(l)} h_{v_j}^{(l)})$\n(2) where $h^{(l+1)}_{v_i} = \\sum_{p=1}^{K} \\beta_p^{(l)} h_{\\phi_p}^{(l)}$, suppose we denote $\\hat{h}_{v_j}^{(l)} = W_{\\phi_p}^{(l)} h_{v_j}^{(l)}$, then $\\alpha_{ij}^{(l)}$ and $\\beta^{(l)}_{p}$ can be computed as:\n$\\alpha_{ij}^{(l)} = softmax_j (a(\\hat{h}_{v_i}^{(l)},\\hat{h}_{v_j}^{(l)}))$, $\\beta_{\\phi_p}^{(l)} = \\frac{1}{|V|} \\sum_{v_i \\in V} softmax_{\\phi} (q \\tanh (W h_{\\phi_p}^{(l)} + b))$"}, {"title": "III. MATERIALS", "content": "In this study, dataset of MCI is collected from ADNI-3 with 409 subjects, including 100 MCI, 48 early MCI (EMCI), 21 late MCI (LMCI) and 240 normal controls (NC). Every subject included has dual-modal data (i.e., rs-fMRI and DTI). Demographic details of used subjects are shown in Table II.\nFor rs-fMRI data, the raw rs-fMRI images are preprocessed by Data Processing Analysis for Brain Imaging (DPABI) [24]. Specifically, 1) the first ten rs-fMRI volumes are discarded as temporal noise. 2) Head movement correction, spatial normalize and smooth filtering are applied furtherly. 3) The Automated Anatomical Labeling (AAL) template is used to segment brain space into 90 brain regions of interest (ROI). 4) Mean time series are extracted for each ROI.\nFor DTI data, the raw DTI images are processed by the pipeline for analyzing brain diffusion images (PANDA) [25], respectively. 1) Diffusion metrics are calculated to generate fractional anisotropy (FA) maps. 2) AAL template is used to segment brain space in the FA maps into 90 brain ROIs for further radiomic feature extraction. 3) Deterministic fiber tractography is employed to track white matter fibers. Through the above process, we obtain 90 ROIs with radiomic features [26] for each subject."}, {"title": "IV. METHODS", "content": "In present work, we propose a novel HGNN to fuse dual-modal information. We define meta-paths in the fused GH as $\\Phi_1: N_f \\rightarrow N_f$, $\\Phi_2 : N_a \\rightarrow N_a$, $\\Phi_3 : N_f \\rightarrow N_a$, and $\\Phi_4 : N_a \\rightarrow N_f$, where homo-meta-paths $\\Phi_1$, $\\Phi_2$ are edges of FC or SC, and hetero-meta-paths $\\Phi_3$, $\\Phi_4$ are edges between FC and SC. Then the augmented GH is generated with reconstructed $\\Phi_1$ and preserved $\\Phi_2$. Both GH and \u011cH are fed into backbone consisted of HAN, HG pooling and readout layers to extract dual-modal features. Finally, a multilayer perception (MLP) is designed to perform classification with dual-modal features. Detailed overview of proposed framework is demonstrated in Fig. 1.\nWe propose to construct a subject-level heterogeneous graph $G_H = {X_H, A_H}$ for each subject and perform graph-level classification, and the core works are extracting node features for both modalities and establishing meta-paths. Specifically, we first extract node features and construct edges of $\\Phi_1$ and $\\Phi_2$ in each modality, then we construct edges of $\\Phi_3$ and $\\Phi_4$ from node-level and community-level. Detailed technics are summarized as follows:\n1) Construction of homo-meta-path: For rs-fMRI images, we denote the mean time-series of the i-th ROI as $TS^{mean}_i \\in \\mathbb{R}^{1\\times D}$. We consider each ROI as a node and $TS^{mean}_i$ of corresponding ROI as its node feature $X_{f_i}$, where $X_{f_i}$ is the i-th row vector of $X_f \\in \\mathbb{R}^{N_f \\times D}$. Subsequently, we calculate the Pearson correlation coefficient values between $TS^{mean}_i$ of ROIs to build a FC for each subject. After filtering out edges with attributes lower than 0.2, FC is normalized to obtain $A_f \\in \\mathbb{R}^{N_f \\times N_f}$ corresponding to $\\Phi_1 : N_f \\rightarrow N_f$. $G_f$ is used to describe both $X_f$ and $A_f$ for convenience.\nFor DTI images, we treat each ROI as a node with extracted radiomic features [26] from FA maps as node feature $X_{d_i}$, where $X_{d_i}$ is the i-th row vector of $X_d \\in \\mathbb{R}^{N_d \\times D}$. Subsequently, we track white matter fibers connecting ROIs to build a SC. After filtering out edges with attributes lower than 5, SC is normalized to obtain $A_d \\in \\mathbb{R}^{N_d \\times N_d}$ corresponding to $\\Phi_2: N_a \\rightarrow N_a$. $G_d$ is used to describe both $X_d$ and $A_d$ for convenience.\n2) Construction of hetero-meta-path: In constructing node-level hetero-meta-path, we measure the similarity of connection patterns of cross-modal node pairs as the strength of their structure-function coupling. Specifically, for a node $v_i \\in G = {X, A}$, we refer the i-th row vector $A^i$ of A to its connection pattern. Then, for a cross-modal node pair $(v_{f_i}, v_{d_j})$, supposing $\\epsilon_{ij}$ denotes the similarity value of their connection patterns, we can obtain a series of $\\epsilon_{ij}$ for node $v_{f_i}$ denoted as a vector $\\mathbf{E_{f_i}}$. Considered of sparsity, we only construct edges between cross-modal node pairs with most similar connection patterns, which is formulated as:\n$A_{ij}^{(node)} = \\begin{cases} \\epsilon_{ij}, & j \\in TopK_i (\\mathbf{E}), i=1,2,..., N_f, \\cr 0, & else \\end{cases}$\nwhere K equals to 8 in our work to filter out edges with less structure-function coupling strength, $A_{fd}$ corresponds to $\\Phi_3$. As for community-level hetero-meta-path, we suggest that brain regions with cooperative interactions may form a closed induced subgraph in both $G_f$ and $G_d$. Technically, we denote a"}, {"title": "B. Heterogeneous Graph Augmentation", "content": "The abundant heterogeneity of the HG provides ample possibilities from the perspective of construction, which provides convenience for augmentation. Therefore, we propose to dynamically reconstruct FC to obtain $\\Phi_1$, then $\\Phi_3$, $\\Phi_4$ will naturally update along with $\\Phi_1$. While $\\Phi_2$ is fixed as structural constraint to maintain the semantic consistency of HGs before and after augmentation.\nSpecifically, in reconstructing FC, we apply the sliding window method to the mean time-series of each ROI to obtain a series of dynamic window time-series with total number $N_{win}$. Then, we calculate the Pearson correlation coefficient values among the dynamic window time-series of the w-th window to build a local dynamic FC, denoted as $FC^w$.\nTo ensure the consistency in HG construction method, we need to summarize the entire series of $FC^w$ into one global dynamic FC, denoted as $FC_G$. To preserve key dynamic features from all the $FC^w$, we search shared induced subgraph $g$ consisted of three nodes which contains edge $e_{ij}$ and exists in each $FC^w$, and summarize it into $FC_G$. However, the topology of $g$ varies based on total number of edges within it, which can be denoted as $g^{(n)}$, where n is the number of edges. Apparently, the importance of $g^{(n)}$ varies along with its topology, which directly influences the richness of feature interaction within it. Therefore, we set different attention weights for different $g^{(n)}$. Then, we can calculate the attributes of $e_{ij}$ in $FC_G$, which is formulated as:\n$FCG_{ij} = \\alpha \\cdot f_{g^{(n)}}$ where $\\alpha \\in \\mathbb{R}^{3\\times 1}$ is the attention weight vector, and $f_{g^{(n)}} \\in \\mathbb{R}^{3\\times 1}$ is the vector of frequency of occurrence of different $g^{(n)}$. We set $\\alpha = [0.01, 0.02, 0.1]$ in present work, which is inversely proportional to the frequency of occurrence of corresponding $g^{(n)}$. Subsequently, we filter out edges with attributes lower than 0.4 to ensure the sparsity of $FC_G$.\nFinally, we consider edges in $FC_G$ as $\\Phi_1$ corresponding to $\\hat{A}_f \\in \\mathbb{R}^{N_f \\times N_f}$. With $\\Phi_2$ fixed, we can update $\\Phi_3$ and $\\Phi_4$ following (5)-(7). Then the augmented $G_H$ can be constructed following (8)-(9). We sent $G_H$ and $\\hat{G}_H$ in pair into the backbone to avoid data leakage."}, {"title": "C. Heterogeneous Graph Pooling", "content": "We introduce a heterogeneous graph pooling strategy [27] into our framework to better leverage heterogeneous information and avoid feature confusion. Specifically, we calculate initial pooling score matrices considering both heterogeneous topology and node features. Then, we summarize the initial pooling matrices by a dense layer to avoid feature confusion among different kinds of nodes.\nTechnically, taking a subject-level HG with initial adjacency matrix $A_H^{(0)} \\in \\mathbb{R}^{N \\times N}$ and feature matrix $X_H^{(0)} \\in \\mathbb{R}^{N \\times D}$ for example, where $N = N_f + N_a$ is the total number of nodes. We denote the output by the $l$-th layer as $A_H^{(l)} \\in \\mathbb{R}^{N^{(l)} \\times N^{(l)}}$ and $X_H^{(l)} \\in \\mathbb{R}^{N^{(l)} \\times D}$. Different from the original method, we propose to apply a HAN layer to $A_H^{(l)}$ and $X_H^{(l)}$ to learn pooling score matrices for different types of nodes separately, which not only considers heterogeneous node features and topology but also can apply different pooling ratios to different types of nodes. Taking the pooling for nodes of rs-fMRI modality for instance, we calculate the initial pooling score matrix $S_f^{(l)}$ as:\n$S_f^{(l)} = HAN(A_f^{(l)}, X_f^{(l)}; \\Theta)$. However, directly applying $S_f^{(l)}$ to $A_f^{(l)}$ and $X_f^{(l)}$ will lead to feature confusion. Therefore, we need to summarize $S_f^{(l)}$ into $D_f^{(l)}$ with node-specific pooling information as:\n$D_f^{(l)} = softmax(W_f^{(l)}S_f^{(l)} + B_f^{(l)})$, where $W_f^{(l)} \\in \\mathbb{R}^{(N_f^{(l+1)} \\times N_f^{(l)})}$ and $B_f^{(l)} \\in \\mathbb{R}^{(N_f^{(l+1)} \\times N_f^{(l)})}$. To avoid extra dimensional operations, we apply zero paddings to the first dimension of $D_f^{(l)}$ to obtain the final pooling score matrix $P_f^{(l)}$, which is formulated as:\n$P_f^{(l)} = \\begin{pmatrix} D_f^{(l)} \\\\ O \\end{pmatrix}$, where $O \\in \\mathbb{R}^{(N_d^{(l+1)} \\times N_f^{(l)})}$ and $P_f^{(l)} \\in \\mathbb{R}^{(N^{(l)} \\times N_f^{(l)})}$. Finally, we apply $P_f^{(l)}$, $P_d^{(l)}$ to $A_H^{(l)}$ and $X_H^{(l)}$ to accomplish HG pooling:\n$A_H^{(l+1)} = \\begin{pmatrix} P_f^{(l)} A_f^{(l)} (P_f^{(l)})^T & P_f^{(l)} A_{fd}^{(l)} (P_d^{(l)})^T \\\\ P_d^{(l)} (A_{fd}^{(l)})^T (P_f^{(l)})^T & P_d^{(l)} A_d^{(l)} (P_d^{(l)})^T \\end{pmatrix}$, $X_H^{(l+1)} = \\begin{pmatrix} P_f^{(l)} X_f^{(l)} \\\\ P_d^{(l)} X_d^{(l)} \\end{pmatrix}$"}, {"title": "V. EXPERIMENTS AND RESULTS", "content": "We conduct performance evaluation experiments with state-of-the-art related works on the performance on MCI identification and ablation experiments to verify the effect of proposed mechanisms. In our experiments, backbone consists of three HAN layers, three HG pooling layers and three readout layers. PairNorm [28] strategy is introduced to tackling the oversmoothing during training. Readout layer concatenates the max and mean values of node features to obtain graph embeddings. We concatenate graph embeddings of three readout layers as the input for MLP to perform classification.\nAdam optimizer is used to optimize our network with initial learning rate $1 \\times 10^{-4}$ and initial weight decay $1 \\times 10^{-4}$. A cosine annealing strategy [29] is introduced during training. We set the number of attention heads in HAN layers to 8, the dimension of hidden layers to 128, the pooling ratio of pooling layers to 0.8, the dropout rate to 0.45, the number of total epochs to 200, and the batch size to 32. Based on the 5-fold cross-validation strategy, prediction accuracy (ACC), sensitivity (SEN), specificity (SPE) and area under the curve (AUC) are calculated as evaluation metrics."}, {"title": "A. Performance Evaluation", "content": "In Table III, we compare our method with eight related state-of-the-art (SOTA) methods published after 2021 on the classification performance of MCI, which include: \nMMTGCN [30], BFN [31], dEC+cwGAT [32], MGCA-RAFFNet [33]. These methods are among SOTA methods using single rs-fMRI modality. BFN and dEC+cwGAT propose to estimate more effective brain functional network to learn more efficient features from rs-fMRI. While MMTGCN and MGCA-RAFFNet attempt to apply multiple brain parcellation templates to obtain different ROIs to construct various brain FC, which can reduce the impact of selection of brain parcellation template on GNN as well as explore the influence of different brain parcellation templates on brain disorder diagnosis.\nAdaptive dFC [34], Cross-GNN [35], SAC-GCN [36], MMP-GCN [9]. These methods are among SOTA methods leveraging dual-modal information. Adaptive dFC follows the connectivity-level fusion way, assigning different penalty parameters to FC based on DTI tractography to estimate more effective dynamic FC. MMP-GCN also proposes constructing FC with a DTI strength penalty term to fuse dual-modal information on connectivity-level. Cross-GNN and SAC-GCN follow feature-level fusion way, where effective mechanisms are proposed to encode feature embeddings in each modality.\nAlthough SOTA methods using single fMRI modality have achieved good performance, the ACC is still limited because of insufficient features learning with single modality. Table III shows their ACC ranges from 82.0% to 92.2%. We notice that various dual-modal fusion methods are also studied, and their experimental results show that use dual-modal data can improve the classification performance of MCI. Table III shows their ACC ranges from 82.6% to 93.0%. However, compared to our method, the ignorance of the heterogeneity of dual-modal data still limits their performance.\nBesides, in related works we notice that the imbalance of datasets may lead to imbalanced SEN and SPE resulted in significant negative impact on the final classification performance. Hence, we propose the HG augmentation method to address this problem. As demonstrated in Table III, with HG augmentation method involved, we can achieve more balanced SEN and SPE than related works, which improves the overall classification performance, indicating that our augmentation method can generate new data with trustworthy distributions and effectively boost classification performance."}, {"title": "B. Ablation Study", "content": "We further verify the effectiveness of proposed key mechanisms through ablation study in Table IV. The competing methods in the ablation study are listed as follows:\n1) baseline: $\\Phi_3$ and $\\Phi_4$ consist of only node-level hetero-meta-path, and only HAN layers are used to extract features.\n2) baseline + HG pooling (baseline+pool): This method further involves HG pooling strategy into the backbone.\n3) baseline + HG pooling + community-level hetero-meta-path (baseline+pool+commu): $\\Phi_3$ and $\\Phi_4$ consist of both node-level and community-level hetero-meta-path in this method, and HG pooling strategy is involved in the backbone.\n4) baseline + HG pooling + community-level hetero-meta-path + HG augmentation (baseline+pool+commu+aug): HG augmentation method is further involved in this method to balance dataset.\nFirst, we verify the effectiveness of the HG pooling strategy. With additional pooling layers, mean ACC improves 11.5% compared to the baseline and mean SEN has a considerable improvement of 20.1% in four classification tasks. Next, we verify the effect of the community-level hetero-meta-path. Results of the ablation study show that the community-level hetero-meta-path can effectively improve mean ACC and SEN of 7.3% and 18.1% in four classification tasks.\nHowever, it's significant to notice that pooling strategy and community-level hetero-meta-path cannot balance SEN and SPE if the original dataset itself is imbalanced. Take the NC vs. MCI task for instance, dataset of this task suffers from sample imbalance issue with positive and negative sample ratio of 1:2.4. Therefore, we enhance MCI subjects from 100 cases to 200 cases to balance enhanced datasets. According to the results of ablation study, SEN and SPE in NC vs. MCI task both reach over 90% after augmentation, which brings great improvement of ACC and AUC as well. Table IV shows that mean SEN and SPE improve 9.0% and 2.7% in four classification tasks with HG augmentation strategy involved, which indicates that our augmentation method can generate new data with trustworthy distributions. To further discover the influence of different augmentation ratios, we draw the ROC"}, {"title": "VI. DISCUSSION", "content": "Previous studies on structure-function coupling have pointed out that structure-function relationship may itself be gradually decoupling from unimodal to transmodal cortex [37], [38]. This phenomenon can be a great challenge for connectivity-level dual-modal fusion methods based on GNNs, since their fused connectivity can be significantly affected by structure-function decoupling. Therefore, we propose to analyze the meta-paths of HG constructed in present work to find out the impact of them on the phenomenon of structure-function decoupling in the transmodal cortex.\nIn Fig. 9, we visualize meta-paths of our HGs within transmodal cortex consisted of the default mode and fronto-parietal functional networks [39]. We can notice that with only homo-meta-path, the connection patterns of edges in rs-fMRI and DTI modalities are quite different, which indicates that brain structure and function relations are decoupling in transmodal cortex. While with hetero-meta-path $\\Phi_3$ and $\\Phi_4$ involved, brain regions that are particularly separated in DTI modality can be linked together through cross-modal edges, which indicates that our HG-based method can alleviate structure-function decoupling within transmodal cortex.\nIn Fig. 10, we visualize the topology of HG constructed with only node-level hetero-meta-path, HG constructed with both hetero-meta-paths, and their corresponding adjacency matrices.\nIn Fig. 10a, we can notice that edges of $\\Phi_3$ and $\\Phi_4$ significantly increase when community-level hetero-meta-path is involved, which greatly enriches the heterogeneity of HG. Besides, we notice that when there is only node-level hetero-meta-path, edges of $\\Phi_3$ will only connect with nodes with high degrees in DTI modality. While with community-level hetero-meta-path established, edges of $\\Phi_3$ will spread to nodes with less degrees. This phenomenon is more obvious in Fig. 10b, where only striped connectivity exists in $\\Phi_3$ and $\\Phi_4$ with only node-level hetero-meta-path, while the involvement of community-level hetero-meta-path creates more centrally symmetric scatter connectivity. Considering of structure-function decoupling, it is nature that node-level hetero-meta-path can only capture relations within brain regions with strong structure-function coupling. On the other hand, community-level hetero-meta-path concentrated on shared brain communities can avoid being disturbed by structure-function decoupling, which can increase the diversity of heterogeneous connectivity."}, {"title": "C. Analysis of Heterogeneous Graph Augmentation", "content": "In Fig. 11, We visualize the topologies of GH, $\\hat{G}_H$, AH, and $\\hat{A}_H$. From the comparison of topology of Gh and $\\hat{G}_H$, we can notice that while there are differences in details, the primary topology of HG still preserves after augmentation. The comparison of AH and $\\hat{A}_H$ provides another intuitive perspective of the change in data distribution. In the upper-left corner of AH, we notice important topological features are retained with undergoing changes in details. On the other hand, thanks to the retention of $\\Phi_2$, updated $\\Phi_3$ and $\\Phi_4$ still preserve important topological features as shown in $\\hat{A}_H$.\nAbove analysis illustrates that proposed HG data augmentation method can generate new HGs with trustworthy distributions and retain important topological features."}, {"title": "D. Most Discriminative ROls and Connectivity", "content": "Considering that the first pooling layer is directly associated with actual brain regions, we analyze the output of the first pooling layer to identify the important brain regions and connectivity on which the modal relies during inference. The visualization results are shown in Fig. 12.\nBased on the output of the first pooling layer, we select ROIS that are not clustered into same class as most discriminative regions in rs-fMRI and DTI modalities and use the clustered classes after pooling layer to describe their connectivity. We notice that some ROIs are important in each classification task. For instance, the middle frontal gyrus (MFG) is selected in rs-fMRI modality for every classification task. Previous studies indicate that MFG is one key region of the default mode network invovled many neurophysiological processes of cognitive and emotional function [40]. Other significant brain regions which has been demonstrated to be assosicated with cognitive like superior frontal gyrus (SFG) and middle temporal gyrus (MTG) [33], [40] are also selected by our model. Besides, regions from limbic system like amygdala (AMYG) and hippocampus (HIP) are selected as well.\nOn the other hand, we notice that more brain regions from basal ganglia (BG) are selected in DTI than rs-fMRI modality, such as caudate nucleus (CAU) and lenticular nucleus, pallidum (PAL). Previous studies stress that white matter features provided by DTI images can help locate structural changes of BG [41], while fMRI are based on cortical signal resulted in more emphasis on the cortex rather than BG. This difference in selected brain regions in our work affirms the conclusion of previous studies."}, {"title": "VII. CONCLUSION", "content": "In this paper, we propose a HG-based dual-modal fusion method. We define homo- and hetero-meta-path based on domain knowledge to capture important relations, and establish hetero-meta-path from node-level and community-level. We propose HG pooling strategy to better leverage heterogeneous information and avoid feature confusion. A HG augmentation strategy is proposed to address the problem of sample imbalance. We conduct a series of experiments on ANDI-3 dataset, and the results indicate that our method is superior to existing SOTA methods. Furthermore, ablation experiments and discussion show that proposed method has promising generalization ability and clinical interpretability. In the future, we will further discover HG construction method and apply proposed method to other types of brain disorders."}]}