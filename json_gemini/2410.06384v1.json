{"title": "Validation of the Scientific Literature via Chemputation Augmented by Large Language Models", "authors": ["Sebastian Pagel", "Michael Jirasek", "Leroy Cronin"], "abstract": "Chemputation is the process of programming chemical robots to do experiments using a universal symbolic language, but the literature can be error prone and hard to read due to ambiguities. Large Language Models (LLMs) have demonstrated remarkable capabilities in various domains, including natural language processing, robotic control, and more recently, chemistry. Despite significant advancements in standardizing the reporting and collection of synthetic chemistry data, the automatic reproduction of reported syntheses remains a labour-intensive task. In this work, we introduce an LLM-based chemical research agent workflow designed for the automatic validation of synthetic literature procedures. Our workflow can autonomously extract synthetic procedures and analytical data from extensive documents, translate these procedures into universal XDL code, simulate the execution of the procedure in a hardware-specific setup, and ultimately execute the procedure on an XDL-controlled robotic system for synthetic chemistry. This demonstrates the potential of LLM-based workflows for autonomous chemical synthesis with Chemputers. Due to the abstraction of XDL this approach is safe, secure, and scalable since hallucinations will not be chemputable and the XDL can be both verified and encrypted. Unlike previous efforts, which either addressed only a limited portion of the workflow, relied on inflexible hard-coded rules, or lacked validation in physical systems, our approach provides four realistic examples of syntheses directly executed from synthetic literature. We anticipate that our workflow will significantly enhance automation in robotically driven", "sections": [{"title": "Introduction", "content": "More than 65 million chemical reactions have been published in research papers and patents to date.\u00b9 While being important cornerstone, databases like Reaxys, and the Open Reaction Database (ORD)2 that attempt to capture this vast stream of data, are not sufficient to tackle the rapid validation and reproduction of reported data. Moreover, almost 30 million new reactions have been added to the Reaxys database since 2014 alone, highlighting the need for improved ways of rapidly validating chemical reaction data beyond standardization of reporting practices and manual labour. Whereas 30 million data points might seem negligible in times when Video Generation Models and LLMs are trained on billions of examples.4,5 This means the necessity of manual validation of chemical reactions creates an almost insurmountable challenge. Aside from the resource and time challenges associated with performing chemical reactions, finding missing parameters and reporting ambiguities, there are a vast number of esoteric experimental set ups and language variations reported. There is also an enormous backlog of unverified procedures with numerous new ones being reported every day which intensifies the problem. Commercial and Open-Source LLMs like GPT-4, or Llama have shown impressive abilities for textual comprehension and understanding ambiguous textual data. 5,6 Beyond pure text comprehension it was shown that these models exhibit excellent few-, one-, and zero-shot prediction abilities on unseen tasks without the need to finetune on specific tasks (in-context or gradient-free learning). 7,8 Furthermore, a plethora of prompting techniques has been developed, further improving the prediction abilities of these models.9\u201312 This has led to vast amounts of research far beyond the field of Natural Language Processing into chemical research.13\u201315 While machine-learning algorithms have been extensively contributed to advances in chemistry research, 16-20 the introduction of LLM as chemical agents has shown promising results to further automate chemical decision-making and experimentation and the orchestrator behind self-driving laboratories.21-24"}, {"title": "Results", "content": "Extracting synthesis information from chemistry literature\nThe vast amounts of data contained in scientific publications, regarding compound properties, reactivity, reaction execution and product analysis can be spread over 10s to 100s of pages typically divided into main publication article and supporting information. While the main publication usually"}, {"title": "Precise and executable XDL procedures via validity check, discrepancy analysis, and hardware-constrained simulation", "content": "While extraction of relevant data from largely unstructured literature procedures and sanitisation of procedures are a significant step in automating chemical synthesis validation, accurate translation of literature procedures into unambiguously executable robotic instructions remains a challenge. The Chemical Descriptor Language XDL has been used to unambiguously, and reproducibly execute and share chemical reactions in a hardware-agnostic manner25-29. While translation from literature procedures to XDL has been presented before,22,25 there remains a significant bottleneck in the accurate translation and automatic validation of these translated procedures. Whereas syntax errors have been used before to iteratively improve upon previously generated XDL instructions, 22 we found that a substantial proportion of translated procedures remained syntactically erroneous, had missing steps and were not sufficiently validated on a realistic robotic setup. To improve upon these shortcomings, we implemented a validation pipeline that first creates valid XDL with error feedback from a XDL-parser that can simultaneously find all syntactic errors in a given XDL. The XDL is then scrutinised by a critique-agent instructed to find any discrepancies in steps in the XDL that were mentioned in the literature procedure and implement them subsequently (typically referred to LLM-as-a-judge30). Finally, the generated XDL is mapped to a predefined robotic platform (Chemputer, SI section 6) and the execution of these steps is executed in simulation, constrained by the robotic platform (Figure 4A). The XDL parser captures syntactical issues, ill-defined physical units (e.g. temperature, and pressure units), and missing hardware or chemical reagents. Simulation of the physical execution was tested via computational simulation of the produced procedure, capturing errors such as invalid temperature or rotation speed ranges. While these checks help ensure the executability of a translated procedure, they do not ensure the completeness or accuracy of the translated procedure. Importantly, the critique-agent proves to be a vital part of the accurate translation of syntactic procedures, identifying missing or miss ordered steps. Examples for each of"}, {"title": "Using long-term memory storages and past experiments to learn from experience", "content": "Though reported synthetic procedures usually contain sufficient information for an expert chemist to infer implicitly assumed information, autonomously identifying missing or assumed information can pose a significant problem in autonomous synthesis execution. To tackle this problem, we equipped"}, {"title": "Systematically improving XDL by identifying not executable synthetic steps", "content": "Though a wide variety of reactions have been demonstrated to be executable using XDL procedures, XDL is still actively developed to add support of an increasing number of synthetic operations. Additionally, while most newly published procedures will not contain logically new steps, synthetic chemistry itself is changing as well requiring new synthetic steps. To identify and suggest new steps that should be added to the XDL standard, the critique-agent described above, was additionally to identify missing steps and instructed to identify steps that are currently not executable within XDL during translation of synthetic procedures. Steps that were identified as not executable were collected, clustered, and analysed to provide suggestions for new XDL steps (Figure 6A and B). Suggested XDL steps can then be analysed and finally integrated based on urgency and ease of integration for the next version of XDL. To provide a roadmap to systematically improve XDL and make it universally applicable, 350 as not executable marked steps were analysed which were collected throughout this work. The steps were clustered resulting in 26 new feature suggestions for future generations of XDL showcasing how this workflow can be used to systematically identify relevant new step"}, {"title": "Paper to Molecule", "content": "To showcase the capabilities of ACRA in helping to automate chemical synthetic literature validation all the way from parsing a literature source to executing a synthetic procedure, we tested it on two English synthetic procedures, one German synthetic procedure, as well as one scientific publication, covering a variety of document types and use cases. The two English procedures detailed the synthesis of p-toluenesulfonate32 and 2-Methyl-2-(3-oxopentyl)-1,3-cyclohexanedione33 and were translated into 23 and 20-step XDL procedures respectively. In the first, refluxing temperatures were correctly assigned, and volumes for adjustment of pH estimated since no adjustment of pH step was implemented in XDL version for this study. Though the estimation of the addition of volumes for adjustment of pH might be quite sensitive to errors, ACRA notably labelled the step adjustment of the pH as a not exactly executable step, as described above. The German synthetic procedure described the synthesis of 3-Methoxy-3-oxopropanoic acid. During the translation, all chemical names, as well as the synthetic procedure, were correctly translated. Additionally, the procedure specified lifting the reaction vessel halfway from the oil bath which is not a directly executable step in XDL. ACRA reasoned that the reaction vessel, cannot be lifted [from the heating vessel] and instead reduced the temperature from 65\u00b0C to 50\u00b0C, accurately interpreting"}, {"title": "Conclusion", "content": "In this work, we demonstrated how LLM can be used to autonomously validate chemical synthesis literature from parsing of a literature text to final execution of the synthesis. Importantly, we showed how syntactic validation of generated protocols for the robotic execution of synthesis procedures in the XDL is not sufficient for the accurate translation of literature procedures. Whilst simulating a chemical reaction at an atomistic scale remains a challenge to be conquered, we demonstrate, how simulation of the robotic execution in a hardware-constrained manner can be used to generate hardware-specific XDL procedures that are directly executable. We hypothesize that this concept can be further developed to integrate more simulation data in LLM-based validation workflows and lead to even improved efficiency and accuracy, ultimately helping to run entire laboratories with LLM-based agentic systems as their brains."}, {"title": "Methods", "content": "The critique-, XDL-, and procedure-agents used GPT4o for all prompts. Only the scraping-agent used GPT4o-mini for the reduced cost, and increased token-output size. All embeddings were generated with the OpenAI model text-embedding-large. All code was written in Python3 with standard libraries apart from the XDL and Chemputer-specific libraries. The default XDL library (https://gitlab.com/croningroup/chemputer/xdl) was modified to capture all syntactic errors in parallel. The ChemputerXDL was modified to automatically map generated XDLs to a predefined hardware graph. XDL files (.xdl) and Chemputer graph files (.json) can be viewed and edited with the ChemIDE app on https://croningroup.gitlab.io/chemputer/xdlapp/. The XDL software standard is linked here: https://croningroup.gitlab.io/chemputer/xdl/standard/index.html. All XDL and Chemputer specific software packages can be made available upon reasonable request."}, {"title": "Data Availability", "content": "The code written for the implementation of ACRA will be available after publication in a peer reviewed journal at https://github.com/croningp/acra."}]}