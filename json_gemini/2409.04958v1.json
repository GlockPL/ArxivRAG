{"title": "DDNet: Deformable Convolution and Dense FPN for Surface Defect Detection in Recycled Books", "authors": ["Jun Yu", "WenJian Wang"], "abstract": "Recycled and recirculated books, such as ancient texts and reused textbooks, hold significant value in the second-hand goods market, with their worth largely dependent on surface preservation. However, accurately assessing surface defects is challenging due to the wide variations in shape, size, and the often imprecise detection of defects. To address these issues, we propose DDNet, an innovative detection model designed to enhance defect localization and classification. DDNet introduces a surface defect feature extraction module based on a deformable convolution operator (DC) and a densely connected FPN module (DFPN). The DC module dynamically adjusts the convolution grid to better align with object contours, capturing subtle shape variations and improving boundary delineation and prediction accuracy. Meanwhile, DFPN leverages dense skip connections to enhance feature fusion, constructing a hierarchical structure that generates multi-resolution, high-fidelity feature maps, thus effectively detecting defects of various sizes. In addition to the model, we present a comprehensive dataset specifically curated for surface defect detection in recycled and recirculated books. This dataset encompasses a diverse range of defect types, shapes, and sizes, making it ideal for evaluating the robustness and effectiveness of defect detection models. Through extensive evaluations, DDNet achieves precise localization and classification of surface defects, recording a mAP value of 46.7% on our proprietary dataset-an improvement of 14.2% over the baseline model-demonstrating its superior detection capabilities.", "sections": [{"title": "I. INTRODUCTION", "content": "The market for recycled and recirculated books [1], [2] has gained significant popularity due to its diverse collections and unique value. These books not only carry economic significance but also play a crucial role in the dissemination of knowledge and the preservation of cultural heritage. However, beyond their content, the value of these books is heavily influenced by their physical condition. Traditional manual inspection methods, being both inefficient and subjective, struggle to meet the growing market demand. To address these challenges, this study proposes the use of computer vision technology not only to automatically detect surface defects in second-hand books but also to incorporate re-identification techniques [3]-[5]. By implementing re-identification, the system can accurately match and track individual books across various stages of circulation, ensuring consistent quality assessments and enhancing both detection accuracy and operational efficiency.\nDefect detection is essential in modern industrial production and quality control. Machine vision, with its non-contact, non-destructive nature and ability to operate efficiently under harsh conditions, is increasingly important in automated production and intelligent pricing. Surface defect detection can be categorized into traditional methods and deep learning-based approaches. Traditional methods, including transform domain analysis [6], statistical techniques [7], [8], and machine learning [9]\u2013[11], rely on image processing and manually designed features. While effective in simple environments, these methods often struggle with complex scenarios. In contrast, deep learning has significantly improved defect detection. Deep learning models automatically extract features, enhancing accuracy and generalization for diverse defects. These methods are typically divided into two categories: two-stage networks, like Faster R-CNN, which offer higher accuracy but are computationally intensive, and single-stage networks, like YOLO and SSD, which are more efficient and suitable for real-time applications.\nRecently, the application of diffusion models [12], [13] has further advanced defect detection capabilities. Diffusion mod-els, with their iterative approach to refining images through noise addition and removal, can generate highly detailed and accurate representations of defects. This method not only improves the model's ability to detect subtle and complex defects but also enhances the robustness of the detection process under varying conditions. By combining diffusion models with traditional deep learning techniques, the defect"}, {"title": "II. PROPOSED METHOD", "content": "The DDNet framework, as illustrated in Fig. 2, comprises four key components: the feature extraction network, the DC module, the DFPN module, and the decoupled detection head.\nFirst, the Darknet backbone is employed to extract multi-resolution feature maps, incorporating DC to effectively adapt to defects of various shapes and sizes. Next, the DFPN module generates and concatenates multi-level feature maps, thereby enhancing the semantic richness of the extracted features. During forward propagation, network parameters are optimized through loss calculation and back-propagation. Finally, the decoupled detection head is responsible for target localization and classification, utilizing dense skip connections to fuse multi-scale features. This ensures the precise detection of surface defects in recycled and recirculated books. This architecture enables DDNet to effectively address the challenges of detecting defects with varying shapes, sizes, and locations, delivering robust and accurate results."}, {"title": "B. Feature Extraction via Deformable Convolution Operator", "content": "In the detection of surface defects in recirculated books, it is a challenge to identify complex geometric deformations in images. Traditional methods such as SIFT, ORB, DPM and HOG are limited by artificially designed features and have difficulty in handling complex geometric deformations. Although convolutional neural networks (CNNs) are powerful, their fixed geometric structure limits the modeling of geometric deformations.\nTo solve this problem, DC is used to replace part of ordinary convolution. For tiny surface defects such as dirt, holes, wrinkles or cracks, traditional convolution kernels may lose key feature information. Deformable convolution learns the offset size by adding an offset field, allowing dynamic adjustment of the sampling position, thereby improving the flexibility and accuracy of feature extraction.\nThe calculation formula of deformable convolution is as follows:\n$y(Po) = \\sum_{Pn\\in R} w(pn) x(Po + Pn + \\Delta pn).$ \nWhere, $\\Delta p_n$ is the offset, which enables the convolution operation to better adapt to changes in target shape and size. The sampling position of traditional convolution is fixed, while deformable convolution can dynamically adjust its receptive field, improving robustness and adaptability, and is particularly suitable for processing complex and irregular target features."}, {"title": "C. FPN with Dense Connections", "content": "In convolutional neural networks, feature maps become increasingly abstract from the bottom to the top layers, with higher layers containing richer semantic information. Integrating high-level information back to lower layers can enhance multi-scale feature extraction and improve defect detection across various scales. Given the diverse scale and shape of defects, leveraging multi-scale features is crucial for robust and accurate detection. However, the Path Aggregation Feature Pyramid Network (PAFPN) used in YOLOv8 has limitations in feature reuse and multi-scale fusion.\nTo overcome these limitations, we propose a Dense Feature Pyramid Network (DFPN) with a dense connection strategy. DFPN connects feature maps at each scale with others from both higher and lower levels, enriching feature maps for subsequent detection stages. Fig. 2 (b) illustrates the DFPN structure, which enhances feature transfer and improves defect identification in old book images.\nIn DFPN, feature maps at a specific level in the network are classified as feature layers of the same stage. We use C* (C1-C5) to represent the feature maps of different sizes generated by the backbone network (CSPDarkNet-53); P* (P1-P5) to represent the feature layers integrated through operations such as lateral connection and upsampling; and N* (N1-N5) to represent the enhanced feature layers obtained by dense connection through the proposed DFPN.\nBased on C\u2081 to C5, DFPN first performs a 1\u00d71 convolution operation on C\u2081 to ensure the consistency of the number of channels in the fusion feature layer, and then fuses it with the upsampled feature map of Ci+1 by element-wise addition to generate a new feature map P\u2081. Then, the Pi-1 layer feature is downsampled and connected to the Pi layer feature map by tensor to obtain the preliminary fused feature map Ni. Finally, in order to further improve the expressiveness of the features, DFPN fuses the generated Ni feature map with all previous feature maps N1-Ni-1 by dense connection. Specifically, for each feature map N1-Ni-1, use the scale of other feature maps downsampled to the same spatial size as N\u2081, and then merge them by tensor concatenation to generate a richer feature map and send it to the detection head."}, {"title": "III. EXPERIMENTS", "content": "The quality of images significantly influences the perfor-mance of surface defect detectors for recycled and recirculated books. To address the challenges posed by factors such as envi-ronment, lighting, noise, and camera variations, we developed the SHBD dataset, the first dataset focused on surface defect detection in these books. This dataset supports classification, object detection, and semantic segmentation tasks.\nThe SHBD dataset includes 6,366 images annotated for training, validation, and testing. It features six primary defect types: Vitium refers to missing book edges, corners or pages; Defaced may be water stains or oil stains; Crease indicates creases/cracks, a dog-ear or crack in a book page; Patch involves the use of adhesive or tape to repair a portion; Signature includes a collection, library, or sales seal; Inkiness includes a signature, note, or other trace of ink.\nDefects may appear on various parts of the book, including covers and pages, and images can contain multiple defects. Analysis of this dataset provides insights into defect characteristics and advances inspection technology. The DC and DFPN in DDNet are specifically designed for these data features."}, {"title": "B. Ablation experiment", "content": "Table I summarizes the results of each phase of this study Initially, we compared the performance of YOLOv5"}, {"title": "C. Discussion", "content": "a) Optimization of adding DC layers to the backbone : To enhance the network's adaptability to various surface defects in reused books, we integrate the DC module into the CSPDarkNet backbone of YOLOv8.  show that the best detection performance is achieved when the DC module is added in the last two stages, achieving a balance between improving model adaptability and minimizing computational overhead.\nb) The challenge of accurately detecting defects: Al-though the model has achieved significant progress in overall performance, there are still issues with the detection accuracy of certain defects.\nLow contrast between the defect and the background  complicates detection, indicating a need for improved handling of low-contrast features in the model. Blurred boundaries between adjacent defects  often lead to misidentification of multiple defects as a single one. This suggests that the model may need further opti-mization when dealing with blurred boundaries or overlapping defects.\nInconsistencies in dataset annotations , such as missing labels for detected defects, can affect training effectiveness and overall model performance."}, {"title": "IV. CONCLUSION", "content": "This study introduces DDNet, a novel model for detecting surface defects in recycled and recirculated books, utilizing de-formable convolutions and dense skip connections to improve feature extraction and boundary accuracy. DDNet's precise localization and classification capabilities are demonstrated by a 14.2% improvement in mAP over baseline models. Future work will aim to enhance model generalization for rare defects, investigate advanced data augmentation and semi-supervised learning techniques, and assess DDNet's effectiveness in real-world book recycling and sales scenarios"}]}