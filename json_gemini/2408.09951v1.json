{"title": "Principle Driven Parameterized Fiber Model based on GPT-PINN Neural Network", "authors": ["YUBIN ZANG", "BOYU HUA", "ZHENZHOU TANG", "ZHIPENG LIN", "FANGZHENG ZHANG", "SIMIN LI", "ZUXING ZHANG", "HONGWEI CHEN"], "abstract": "In cater the need of Beyond 5G communications, large numbers of data driven artificial intelligence based fiber models has been put forward as to utilize artificial intelligence's regression ability to predict pulse evolution in fiber transmission at a much faster speed compared with the traditional split step Fourier method. In order to increase the physical interpretabiliy, principle driven fiber models have been proposed which inserts the Nonlinear Schodinger Equation into their loss functions. However, regardless of either principle driven or data driven models, they need to be re-trained the whole model under different transmission conditions. Unfortunately, this situation can be unavoidable when conducting the fiber communication optimization work. If the scale of different transmission conditions is large, then the whole model needs to be retrained large numbers of time with relatively large scale of parameters which may consume higher time costs. Computing efficiency will be dragged down as well. In order to address this problem, we propose the principle driven parameterized fiber model in this manuscript. This model breaks down the predicted NLSE solution with respect to one set of transmission condition into the linear combination of several eigen solutions which were outputted by each pre-trained principle driven fiber model via the reduced basis method. Therefore, the model can greatly alleviate the heavy burden of re-training since only the linear combination coefficients need to be found when changing the transmission condition. Not only strong physical interpretability can the model posses, but also higher computing efficiency can be obtained. The model's performance was demonstrated by the pulses with different shapes under 1000 different transmission conditions over the maximum 100 km fiber. The model's computational complexity is 0.0113% of split step Fourier method and 1% of the previously proposed principle driven fiber model.", "sections": [{"title": "1. Introduction", "content": "The rapidly developing artificially intelligence(AI) has profoundly and broadly changed the way of scientific researching [1-4]. There is no exception for fields of fiber modeling. In traditional fiber optics, fiber transmission properties are accurately described by Nonlinear Schr\u00f6dinger Equations (NLSE) [5]. In order to solve it numerically, Split Step Fourier Method (SSFM) was put forward [6-7]. By taking the thoughts of 'differentiation' and 'decoupling' like other partial differential equations (PDE) solver, it firstly divides the whole fiber into multiple basic computing segments. In each segment, effects like attenuation, dispersion and nonlinearity can be viewed as separately affecting the pulse transmission. The final results can be obtained by finishing each segment's computing step by step. Though this method has become the most frequently adopted method in conventional fiber models thanks to its validity and accuracy, both disadvantages in computing speed and complexity uniformity under different circumstances can not be neglected.\nMany researchers have proposed several new fiber models with the help of Al in order to address the above drawbacks of conventional models. Among them are BiLSTM model [8],\nGAN model [9-10], Multi-head Attention model [11-12] and etc. Most of these new Al based fiber models are data driven models in which large scale of data are collected in advance to catalyze the neural network to bridge the connection between waveform before and after transmission. In this case, these data driven models can posses high computing speed but discard the whole models from their physical backgrounds. Therefore, it will be convenient to utilized data driven fiber models for fiber transmission signal predicting under the condition that both signals before fiber transmission and after fiber transmission are easy to be collected. Without these data, these data driven models can no longer be effectively trained.\nIn order to improve the model's physical interpreter and the reliability on the pre-collected signals after the transmission, principle driven fiber transmission models were proposed [13- 14]. Different from viewing the fiber transmission task as a pure mathematical regression work, these models utilize NLSE and its related constraints as loss functions. These models will then be optimized under the guidance of NLSE-related loss functions so that outputs in each training epoch will be checked the consistency of NLSE and its constraints. As a result, these models can not only obtain high physical interpretability, but also can be effectively trained even without the pre-collected transmitted data.\nWhen dealing with the fiber transmission prediction for determined condition, both data driven and principle driven models are convenience and performs higher computing efficiency. However, in the next generation communications, fiber transmission system optimization work must be done where different transmission conditions can not be avoided. The typical characteristics of different transmission conditions is that parameters like fiber attenuation, dispersion or nonlinearity may vary. Under this circumstance, either data driven or principle driven models must be wholly retrained since the transmitted data may differ for data driven models and the coefficients in NLSE may vary for principle driven models. When the scale of different transmission conditions are larger, longer time will be consumed for re- training the whole AI based models which can greatly decrease the computing efficiency.\nIn order to both shorten the time of retraining and maintain the physical interpretabiliy, we propose the novelty parameterized principle driven fiber transmission model under the intuition of the generative pre-trained physics informed neural network (GPT-PINN) [15] in this manuscript. Unlike the previously proposed principle driven fiber model which deals with NLSE containing the constant parameter, this model performs as a solver for NLSE containing varying parameters including attenuation, dispersion, nonlinearity for different transmission conditions. This model views the predicted NLSE solution with respect to one set of parameter values being the results of several linearly combined eigen solutions which are outputted by the previously proposed principle driven models [11]. Therefore, only the combination ratio needs to be found for different circumstances. In this way, this model can save large amounts of time for retraining and computing complexity.\nThe manuscript will be developed into four main parts. All backgrounds of the fiber transmission models and the motivations of proposing this model will be described in the introduction part. Then, both theoretic principles, components, structures and computing flows of the parameterized fiber transmission model will be illustrated in detail in the second part. In order to demonstrates both model's predicting performances and gain in computational complexity, different tasks including single pulse input and multiple pluses input with different shapes will be illustrated. All results including the model's training behavior, predicting accuracy, application generalization and complexity comparisons will be shown and analyzed. Conclusions and further discussions will be developed in the last part."}, {"title": "2. Model Structures and Configurations", "content": ""}, {"title": "2.1 Fiber Propagation Characteristics", "content": "The propagation mechanism of optical fiber links is subject to the electromagnetic properties of light waves and the physical properties of optical fibers. When a waveform propagates in an optical fiber, it will be affected by factors such as loss, dispersion and nonlinearity in the optical fiber which can cause broadening and distortion.\nLoss is one of the most common factors that can affect the evolution of the waveform inputs. Waveform's energy or power will decrease when propagating alongside the fiber. Dispersion, strictly speaking, chromatic dispersion, is the another factor affecting the evolution of the transmitted waveforms. The essence of chromatic dispersion is that different frequency components of one waveform will propagate at different group velocities through fiber which will finally cause waveform distortion at the end of fiber. The nonlinear effect is another important factors that can affect the waveform's shape. This effect is closely related with waveform's power, fiber's nonlinearity. Together with dispersion, this effect will make the waveform distort in a sophisticated way.\nThough multiple effects can cause profound influences on sophisticated waveform evolution in the fiber, this process obey the Nonlinear Schr\u00f6dinger Equation (NLSE) according to the theory of fiber optics.\n$\\frac{\\partial\\psi}{\\partial\\zeta}+\u0456\u03ba\u2081A\\frac{\\partial\u00b2\\psi}{\\partial\\tau\u00b2}+\u03ba\u2081A\\frac{\\partial\u00b3\\psi}{\\partial\\tau\u00b3}+\u0456\u03ba\u2081A|\u03c8|\u00b2\u03c8=0$ (1)\n$A=\\frac{L}{AL_{NL}},A_\u2081=-\\frac{sign(\u03b2\u2082)}{2} ,A_\u2082=\\frac{\u03b2L}{6T\u2080},A_\u2083=\\frac{\u03b3L}{\u03b4T\u2080}$ (2)\n$z=\\frac{L}{L_{max}}, \u03b6=\\frac{z}{L_{max}}, \u03c4=\\frac{t}{T_0}, \u03b6=\\frac{t}{T_{0T}}$ (3)\nwhere \u03a8=Y(T,z) is the solution of Eq. (1) whose diagram is a complex surface while y=y(t,\u03b6) represents the normalized solution. To represents the full width of which the corresponding value equals 1/e of the pulse peak. a represents power attenuation per distance. \u1e9e2 and \u1e9e3 is the second and third order propagation constant which reflects dispersion and high order dispersion effects in the fiber respectively. y represents nonlinear coefficient. n2, wc, c and Aeff denotes nonlinear refractive index, central angular frequency of light, speed of light and effective cross-sectional area respectively."}, {"title": "2.2 Split Step Fourier Method", "content": "Since the NLSE is a partial differential equation, there is no analytical solution in most cases. In the actual modeling process, researchers often use the split-step Fourier method (SSFM) to numerically solve Eq. (1). SSFM belongs to forward iterative finite element methods. The idea of the method is to decompose a long transmission optical fiber into several computational finite elements called computing segment. In each segment, dispersion and non-linearity can be considered uncoupled so that these two effects act on the transmission signal in the optical fiber respectively. Under this circumstance, Eq. (1) can be written in operator form: Dispersion of the first half segment is firstly calculated. Waveform is transformed from time domain to frequency domain via Fast Fourier Transform (FFT). Then, quadrature phase shift term is multiplicated, and the whole waveform will be transformed from frequency domain back into the time domain via Inverse Fourier Transform (IFFT). The calculation of the nonlinear effect of the segment is calculated as the second part. Finally, dispersion of the second half of the segment is calculated which adopts the same procedures like the first half. This process is repeated segment by segment. Final results can be obtained when all segments are calculated.\nIt can be concluded from the above analysis that though SSFM has been most commonly used as the numerical solver of NLSE, its calculation accuracy strongly relates with the length of the segment. If the segment's length is determined too large, then the decouple approximation between dispersion and nonlinarity will cause large error in final results. If the segement's length is determined too small, then longer time will be consumed for calculation. Besides, it can also be seen that the complexity of the algorithm changes with the parameters of the specific optical fiber channel. When facing long-distance, high-power, and special optical fiber channels, the algorithm shows higher computing complexity and lower computational efficiency."}, {"title": "2.3 Principle Driven Fiber Model", "content": "In order to overcome the drawbacks of SSFM without losing the physical interpretabiliy like most data-driven AI based fiber models, the principle driven fiber model based on the physics informed neural network (PINN) have been put forward. It views Al as a powerful equation solver for NLSE which is essentially different from other data driven fiber models."}, {"title": "2.4 Reduced Basis Expansion Method", "content": "Reduced basis expansion method is probably one of the most feasible methods for further developing the more universal solutions based on several pre-predicted solutions. The thinking behind the reduced basis expansion method stems from the knowledge of basis expansion. Looking back towards either linear algebra or signal processing theories, basis expansion always performs an important role in decomposing one sophisticated generalized object into several simple but typical selected components. As can be seen from Fig. 2, vectors can be decomposed into coordinate basis in analytic geometry; periodic signals can be decomposed into several sine or cosine functions in Fourier series; optical field distribution at the cross section of fiber can be decomposed into multiple modes in the theory of electromagnetic field. The common idea behind is to utilize the linear combinations of basis, either finite or infinite, to express the universal or general object. Similarly, the reduced basis expansion method views the universal solutions of parameterized NLSE as the linear combinations of several typically selected special solutions called 'eigen solutions'. Under this circumstance, both linear combination coefficients and the typically selected eigen solutions need to be found in order to obtain the universal solutions of parameterized NLSE."}, {"title": "2.5 Parameterized Principle Driven Fiber Models", "content": "As is illustrated above, the parameterized principle driven fiber model consists of both the principle driven fiber model and the reduced basis expansion method. For the training of this parameterized model, the reduced basis expansion method plays the role of finding the eigen solutions and the linear combination coefficients. For each eigen solution except the first, those set of parameters whose errors are the largest is utilized to train the principle fiber model. Then, the predicted solution will become the new eigen solution together with previous eigen solutions to train the best linear combination coefficients in order to minimize the overall loss towards the whole parameter space shown in Eq. (10) so as to reach the best approximation of the universal solution of the parameterized NLSE.\nWithout losing the generality, pulses with Gaussian, Sech and SuperGaussian shape are utilized to demonstrate the parameterized principle driven fiber model. For the disecretized of the independent variables (t, \u03b6), t ranges from -1 to 1 with 100 points while \u03b6 ranges from 0 to 1 with 101 points. The initial condition is also discretized into 100 points. For the parameterized space of the fiber, both attenuation, dispersion, either second-order or third- order and non-linearity can be ranged freely. All ranges and discretized points can be found in Table 1."}, {"title": "3. Simulation results and analysis", "content": ""}, {"title": "3.1 Training of the Principle Driven Fiber Model", "content": "The training of the principle driven fiber model aims at obtaining eigen solutions for the parameterized NLSE. Apart from the first set of parameters which is specified in advance, other sets of parameters come from the cases whose error is the largest error. For the training of the principle driven model, adaptive stochastic gradient descend method (ADAM) [16] is utilized as to better training the model. The adaptive learning rate controlled by the decaying coefficient in the method can let the model quickly find the local minimum area at first and prematurely search for the local minima at the final few epochs"}, {"title": "3.2 Training of the Reduced Basis Expansion", "content": "After the principle driven model is appropriately trained, the solution of this set of parameters will form new eigen solution. The linear combination coefficients will be trained as to find the best linear combinations of all eigen solutions obtained to in the current stage approximate the solutions with respect to other sets of parameters."}, {"title": "3.3 Performances of the Parameterized Fiber Model", "content": "The final parameterized principle driven fiber model utilizes the predicted solutions from the previously principle driven fiber models to form the final universal solutions with respect to the whole parameter space shown and depicted in both Table 1 and Fig. 4. Since single pulse with Gaussian, Sech and SuperGaussian are all utilized for demonstration, Fig. 5 shows the model's outputs for randomly selected 6 sets of parameters in the parameter space for the input of the single pulse with all three shapes. It can be concluded though approximation error exists, the reduced basis expansion method can still find the best linear coefficients to well organize the eigen solutions to form the final solutions for different transmission parameters so that the prediction accuracy can still remain high."}, {"title": "3.4 Parameterized Fiber Model's training and testing performances for multiple pulses input", "content": "Though detailed training and testing performances of the model are illustrated and shown in detail for single pulse input, the prediction of multiple pulses input are also conducted whose configurations can be found in Table 1 and Table 2.\nLike single pulse input, convergence performances for finding 10 eigen solutions when multiple Gaussian pulses being inputted are shown in Table 5. When compared with Table 4, it can be obviously found that the overall average number of epochs that can meet the stop criterion is larger for multiple pulses input. It is because multiple pulses posses more sophisticated waveform evolutions than single pulse thus will increase the difficulty for the principle model to converge to the expected state."}, {"title": "3.5 Computational Complexity Comparison", "content": "Two companions of computational complexity should be conducted as to not only highlight the model's prominent advantages in fast predicting, but also reveal the time distribution differences of the whole model training and testing over different initial conditions. For the comparison of training and testing time distributions on different initial conditions, direct computing time is selected as the standard since the model is trained on Tesla T4 TPU all for those six different initial conditions. For the comparison of different methods in computational complexity, the scale of multiplication and addition (MAC) is calculated since different model tend to be operated on different hardware platforms."}, {"title": "4. Conclusions and discussions", "content": "In this manuscript, the parameterized principle driven fiber model is proposed. By taken into the use of both previously proposed fiber model to obtain the basis and the reduced basis expansion method to linearly combine those basis as to approximate the universal solution, any solutions with respect to the parameter space can be expressed in a relatively high accuracy.\nBoth signal pulse input and multiple pulse input are utilized to demonstrate the fidelity of the model. As can be seen from the section of simulation results and analysis, the predictions reaches relatively good acceptable levels though the prediction errors are relatively higher for multiple pulses input due to the pulses changing characteristics according to the analysis.\nSeveral prominent advantages can be obtained when taking the model into use. First, this model can keep the better balance between prediction accuracy and physical backgrounds since it takes NLSE to design its loss function. Second, compared with other data driven models, this model can still be effectively trained without the needs to collect large scale of transmitted signals before hand. Last but not least, this model can solve pulse transmission at different fiber conditions all without retraining the whole model. By numerically analysis, when completing the task containing 1000 parameters with 10 maximum basis, this model can save 90% computational complexity compared with the previously proposed fiber model, not to mention that of SSFM. Future research plan will to further generalize this model into multi-mode fibers etc."}]}