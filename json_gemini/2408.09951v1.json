[{"title": "Principle Driven Parameterized Fiber Model based on GPT-PINN Neural Network", "authors": ["YUBIN ZANG", "BOYU HUA", "ZHENZHOU TANG", "ZHIPENG LIN", "FANGZHENG ZHANG", "SIMIN LI", "ZUXING ZHANG", "HONGWEI CHEN"], "abstract": "In cater the need of Beyond 5G communications, large numbers of data driven artificial intelligence based fiber models has been put forward as to utilize artificial intelligence's regression ability to predict pulse evolution in fiber transmission at a much faster speed compared with the traditional split step Fourier method. In order to increase the physical interpretabiliy, principle driven fiber models have been proposed which inserts the Nonlinear Schodinger Equation into their loss functions. However, regardless of either principle driven or data driven models, they need to be re-trained the whole model under different transmission conditions. Unfortunately, this situation can be unavoidable when conducting the fiber communication optimization work. If the scale of different transmission conditions is large, then the whole model needs to be retrained large numbers of time with relatively large scale of parameters which may consume higher time costs. Computing efficiency will be dragged down as well. In order to address this problem, we propose the principle driven parameterized fiber model in this manuscript. This model breaks down the predicted NLSE solution with respect to one set of transmission condition into the linear combination of several eigen solutions which were outputted by each pre-trained principle driven fiber model via the reduced basis method. Therefore, the model can greatly alleviate the heavy burden of re-training since only the linear combination coefficients need to be found when changing the transmission condition. Not only strong physical interpretability can the model posses, but also higher computing efficiency can be obtained. The model's performance was demonstrated by the pulses with different shapes under 1000 different transmission conditions over the maximum 100 km fiber. The model's computational complexity is 0.0113% of split step Fourier method and 1% of the previously proposed principle driven fiber model.", "sections": [{"title": "1. Introduction", "content": "The rapidly developing artificially intelligence(AI) has profoundly and broadly changed the way of scientific researching [1-4]. There is no exception for fields of fiber modeling. In traditional fiber optics, fiber transmission properties are accurately described by Nonlinear Schr\u00f6dinger Equations (NLSE) [5]. In order to solve it numerically, Split Step Fourier Method (SSFM) was put forward [6-7]. By taking the thoughts of 'differentiation' and 'decoupling' like other partial differential equations (PDE) solver, it firstly divides the whole fiber into multiple basic computing segments. In each segment, effects like attenuation, dispersion and nonlinearity can be viewed as separately affecting the pulse transmission. The final results can be obtained by finishing each segment's computing step by step. Though this method has become the most frequently adopted method in conventional fiber models thanks to its validity and accuracy, both disadvantages in computing speed and complexity uniformity under different circumstances can not be neglected."}, {"title": null, "content": "Many researchers have proposed several new fiber models with the help of Al in order to address the above drawbacks of conventional models. Among them are BiLSTM model [8], GAN model [9-10], Multi-head Attention model [11-12] and etc. Most of these new Al based fiber models are data driven models in which large scale of data are collected in advance to catalyze the neural network to bridge the connection between waveform before and after transmission. In this case, these data driven models can posses high computing speed but discard the whole models from their physical backgrounds. Therefore, it will be convenient to utilized data driven fiber models for fiber transmission signal predicting under the condition that both signals before fiber transmission and after fiber transmission are easy to be collected. Without these data, these data driven models can no longer be effectively trained.\nIn order to improve the model's physical interpreter and the reliability on the pre-collected signals after the transmission, principle driven fiber transmission models were proposed [13- 14]. Different from viewing the fiber transmission task as a pure mathematical regression work, these models utilize NLSE and its related constraints as loss functions. These models will then be optimized under the guidance of NLSE-related loss functions so that outputs in each training epoch will be checked the consistency of NLSE and its constraints. As a result, these models can not only obtain high physical interpretability, but also can be effectively trained even without the pre-collected transmitted data.\nWhen dealing with the fiber transmission prediction for determined condition, both data driven and principle driven models are convenience and performs higher computing efficiency. However, in the next generation communications, fiber transmission system optimization work must be done where different transmission conditions can not be avoided. The typical characteristics of different transmission conditions is that parameters like fiber attenuation, dispersion or nonlinearity may vary. Under this circumstance, either data driven or principle driven models must be wholly retrained since the transmitted data may differ for data driven models and the coefficients in NLSE may vary for principle driven models. When the scale of different transmission conditions are larger, longer time will be consumed for re- training the whole AI based models which can greatly decrease the computing efficiency.\nIn order to both shorten the time of retraining and maintain the physical interpretabiliy, we propose the novelty parameterized principle driven fiber transmission model under the intuition of the generative pre-trained physics informed neural network (GPT-PINN) [15] in this manuscript. Unlike the previously proposed principle driven fiber model which deals with NLSE containing the constant parameter, this model performs as a solver for NLSE containing varying parameters including attenuation, dispersion, nonlinearity for different transmission conditions. This model views the predicted NLSE solution with respect to one set of parameter values being the results of several linearly combined eigen solutions which are outputted by the previously proposed principle driven models [11]. Therefore, only the combination ratio needs to be found for different circumstances. In this way, this model can save large amounts of time for retraining and computing complexity.\nThe manuscript will be developed into four main parts. All backgrounds of the fiber transmission models and the motivations of proposing this model will be described in the introduction part. Then, both theoretic principles, components, structures and computing flows of the parameterized fiber transmission model will be illustrated in detail in the second part. In order to demonstrates both model's predicting performances and gain in computational complexity, different tasks including single pulse input and multiple pluses input with different shapes will be illustrated. All results including the model's training behavior, predicting accuracy, application generalization and complexity comparisons will be shown and analyzed. Conclusions and further discussions will be developed in the last part."}, {"title": "2. Model Structures and Configurations", "content": null}, {"title": "2.1 Fiber Propagation Characteristics", "content": "The propagation mechanism of optical fiber links is subject to the electromagnetic properties of light waves and the physical properties of optical fibers. When a waveform propagates in an optical fiber, it will be affected by factors such as loss, dispersion and nonlinearity in the optical fiber which can cause broadening and distortion.\nLoss is one of the most common factors that can affect the evolution of the waveform inputs. Waveform's energy or power will decrease when propagating alongside the fiber. Dispersion, strictly speaking, chromatic dispersion, is the another factor affecting the evolution of the transmitted waveforms. The essence of chromatic dispersion is that different frequency components of one waveform will propagate at different group velocities through fiber which will finally cause waveform distortion at the end of fiber. The nonlinear effect is another important factors that can affect the waveform's shape. This effect is closely related with waveform's power, fiber's nonlinearity. Together with dispersion, this effect will make the waveform distort in a sophisticated way.\nThough multiple effects can cause profound influences on sophisticated waveform evolution in the fiber, this process obey the Nonlinear Schr\u00f6dinger Equation (NLSE) according to the theory of fiber optics.\n$\\frac{{\\partial \\psi }}{{\\partial \\zeta }} + i{\\kappa _1}{A_2}\\frac{{\\partial {\\psi }}}{{\\partial {\\tau ^2}}} + {\\kappa _1}{A_3}\\frac{{\\partial \\psi }}{{\\partial {\\tau ^3}}} + i{\\kappa _1}{A_4}{\\left| {\\psi } \\right|^2}\\psi  = 0$\n(1)\n${A_1} = 1 {A_2} = {A_L}\\frac{{sign({\\beta _2})}}{2}\\frac{z}{{{L_D}}} {A_3} = {A_L}\\frac{{{\\beta _3}}}{{6{T_0}\\left| {{\\beta _2}} \\right|}}\\frac{z}{{{L_D}}} {A_4} = {A_L}\\frac{{\\beta {L_D}}}{{{T_0}}}\\frac{z}{{{L_{NL}}}}$\n(2)\n$z = {L_{\\max }}\\frac{{\\hat z}}{{{\\kappa _1}}} \\tau  = {T_{\\max }}\\hat \\tau {L_D} = \\frac{{T_0^2}}{{\\left| {{\\beta _2}} \\right|}}{L_{NL}} = \\frac{1}{{{\\kappa _2}{P_0}}}$\n(3)\n$\\gamma  = \\frac{{{n_2}{\\omega _0}}}{{c{A_{eff}}}}\\gamma  = {P_0}{L_{NL}} {L_D} = \\frac{{T_0^2}}{{\\left| {{\\beta _2}} \\right|}}{L_A} = \\frac{1}{\\alpha }$\n$\\hat \\psi  = \\sqrt {\\frac{{{P_0}}}{{{P_0}}}} \\psi \\frac{z}{{{L_{NL}}}} = {P_0}{L_{NL}}$ where $\\Psi  = \\Psi (T,z)$ is the solution of Eq. (1) whose diagram is a complex surface while $y = y(t,\\zeta )$ represents the normalized solution. To represents the full width of which the corresponding value equals 1/e of the pulse peak. a represents power attenuation per distance. $\\beta_2$ and $\\beta_3$ is the second and third order propagation constant which reflects dispersion and high order dispersion effects in the fiber respectively. y represents nonlinear coefficient. $n_2$, $w_c$, c and Aeff denotes nonlinear refractive index, central angular frequency of light, speed of light and effective cross-sectional area respectively."}, {"title": "2.2 Split Step Fourier Method", "content": "Since the NLSE is a partial differential equation, there is no analytical solution in most cases. In the actual modeling process, researchers often use the split-step Fourier method (SSFM) to numerically solve Eq. (1). SSFM belongs to forward iterative finite element methods. The idea of the method is to decompose a long transmission optical fiber into several computational finite elements called computing segment. In each segment, dispersion and non-linearity can be considered uncoupled so that these two effects act on the transmission signal in the optical fiber respectively. Under this circumstance, Eq. (1) can be written in operator form: Dispersion of the first half segment is firstly calculated. Waveform is transformed from time domain to frequency domain via Fast Fourier Transform (FFT). Then, quadrature phase shift term is multiplicated, and the whole waveform will be transformed from frequency domain back into the time domain via Inverse Fourier Transform (IFFT). The calculation of the nonlinear effect of the segment is calculated as the second part. Finally, dispersion of the second half of the segment is calculated which adopts the same procedures"}, {"title": null, "content": "like the first half. This process is repeated segment by segment. Final results can be obtained when all segments are calculated.\nIt can be concluded from the above analysis that though SSFM has been most commonly used as the numerical solver of NLSE, its calculation accuracy strongly relates with the length of the segment. If the segment's length is determined too large, then the decouple approximation between dispersion and nonlinarity will cause large error in final results. If the segement's length is determined too small, then longer time will be consumed for calculation. Besides, it can also be seen that the complexity of the algorithm changes with the parameters of the specific optical fiber channel. When facing long-distance, high-power, and special optical fiber channels, the algorithm shows higher computing complexity and lower computational efficiency."}, {"title": "2.3 Principle Driven Fiber Model", "content": "In order to overcome the drawbacks of SSFM without losing the physical interpretabiliy like most data-driven AI based fiber models, the principle driven fiber model based on the physics informed neural network (PINN) have been put forward. It views Al as a powerful equation solver for NLSE which is essentially different from other data driven fiber models."}, {"title": null, "content": "The universal structure of the principle driven fiber model is a multi-layer neural network containing one input layer, several hidden layers and one output layer as is shown in Fig. 1. As can be observed from Eq. (1)-(3), both variables (t,) span a plane which contentiously takes value from $R^2$ space. However, the principle driven fiber model can only execute the computing point by point. Therefore, the continuous two-dimensional plane spanned by (t,) needs to be discretized before entering into the principle driven fiber model. Under this circumstance, there are two input neurons in the model with one takes the discrete t value and the other takes the discrete (value. Hidden layers are responsible for mapping the inputs into the corresponding solution value y. Since the solution value is a complex number, there are two neurons in the output layer of the fiber model with one outputting the real part and the other outputting the imaginary part. The computations between each layer is linear multiplications and Tanh() activations.\nUnlike data driven models, loss function is crucial and should be carefully designed in the principle fiber model since it directly relates with the training converging performance. The basic idea of loss function determination is to check the distance between the model's prediction and the NLSE solution by substituting the model prediction into the NLSE and calculate the residual error. In this case, NLSE residual error becomes one part of the loss"}, {"title": null, "content": "function. Apart from this, the input waveform, as the initial condition, also affects the fiber transmission. Therefore, the normalized mean square error between model's prediction when equals zero and the original input waveform should be formed as the second part of the loss function. In this way, the loss function of the principle driven fiber model can be determined as\n${L_F} = \\frac{1}{{{N_E}}}\\sum\\limits_{k = 1}^{{N_E}} {\\left| {\\frac{{\\partial {\\psi ^{pred}}}}{{\\partial {\\zeta _k}}} + i{\\kappa _1}{A_2}\\frac{{\\partial {\\psi ^{pred}}}}{{\\partial {{\\hat \\tau }^2}}} + {\\kappa _1}{A_3}\\frac{{\\partial {\\psi ^{pred}}}}{{\\partial {{\\hat \\tau }^3}}} + i{\\kappa _1}{A_4}{{\\left| {{\\psi ^{pred}}} \\right|}^2}{\\psi ^{pred}}} \\right|}  + \\frac{1}{{{N_{ini}}}}\\sum\\limits_{k = 1}^{{N_{ini}}}} {{{\\left| {{\\psi ^{pred}}(\\zeta  = 0,t) - \\psi (\\zeta  = 0,t)} \\right|}^2}}$\n(4)\nwhere ${L_F}$ represents the loss function of the principle fiber model. $\\psi^{pred}$ represents the prediction of the model and it consists of the real part and imaginary part which can be expressed as $\\psi^{pred}=\\psi^{pred}_R+i\\psi^{pred}_I$. In this way, Eq. (4) can be further described as\n$L = \\frac{1}{{{N_E}}}\\sum\\limits_{k = 1}^{{N_E}} {\\left| {\\frac{{\\partial {\\psi _{Rk}^{pred}}}}{{\\partial {\\zeta _k}}} - {\\kappa _1}{A_2}\\frac{{\\partial {\\psi _{Ik}^{pred}}}}{{\\partial {{\\hat \\tau }^2}}} + {\\kappa _1}{A_3}\\frac{{\\partial {\\psi _{Ik}^{pred}}}}{{\\partial {{\\hat \\tau }^3}}} + {\\kappa _1}{A_4}\\left[ {{{\\left( {\\psi _{Rk}^{pred}} \\right)}^2} + {{\\left( {\\psi _{Ik}^{pred}} \\right)}^2}} \\right]{\\psi _{Rk}^{pred}}} \\right|}  + \\frac{1}{{{N_E}}}\\sum\\limits_{k = 1}^{{N_E}} {\\left| {\\frac{{\\partial {\\psi _{Ik}^{pred}}}}{{\\partial {\\zeta _k}}} + {\\kappa _1}{A_2}\\frac{{\\partial {\\psi _{Rk}^{pred}}}}{{\\partial {{\\hat \\tau }^2}}} + {\\kappa _1}{A_3}\\frac{{\\partial {\\psi _{Rk}^{pred}}}}{{\\partial {{\\hat \\tau }^3}}} + {\\kappa _1}{A_4}\\left[ {{{\\left( {\\psi _{Rk}^{pred}} \\right)}^2} + {{\\left( {\\psi _{Ik}^{pred}} \\right)}^2}} \\right]{\\psi _{Ik}^{pred}}} \\right|}  + \\frac{1}{{{N_{ini}}}}\\sum\\limits_{k = 1}^{{N_{ini}}}} {{{\\left| {\\psi _{Rk}^{pred}(\\zeta  = 0,t) - {\\psi _R}(\\zeta  = 0,t)} \\right|}^2}}  + \\frac{1}{{{N_{ini}}}}\\sum\\limits_{k = 1}^{{N_{ini}}}} {{{\\left| {\\psi _{Ik}^{pred}(\\zeta  = 0,t) - {\\psi _I}(\\zeta  = 0,t)} \\right|}^2}}$\n(5)\nThe hyper-parameters in the principle driven fiber model includes the number of hidden layers, the scale of neurons in each layer etc which should be determined in advance based on the extent of complexity of the task.\nIn all, the principle fiber model proposed before indeed can posses great prediction accuracy without losing too much physical background. However, it is still inconvenient when parameters such as either attenuation, dispersion or non-linearity changes because the whole model needs to be re-trained and can cost large amount of time. Therefore, actions should be taken to develop more universal solutions of the parameterized NLSE on the basis of the prediction of the proposed principle driven fiber model."}, {"title": "2.4 Reduced Basis Expansion Method", "content": "Reduced basis expansion method is probably one of the most feasible methods for further developing the more universal solutions based on several pre-predicted solutions. The thinking behind the reduced basis expansion method stems from the knowledge of basis expansion. Looking back towards either linear algebra or signal processing theories, basis expansion always performs an important role in decomposing one sophisticated generalized object into several simple but typical selected components. As can be seen from Fig. 2, vectors can be decomposed into coordinate basis in analytic geometry; periodic signals can be decomposed into several sine or cosine functions in Fourier series; optical field distribution at the cross section of fiber can be decomposed into multiple modes in the theory of electromagnetic field. The common idea behind is to utilize the linear combinations of basis,"}, {"title": null, "content": "either finite or infinite, to express the universal or general object. Similarly, the reduced basis expansion method views the universal solutions of parameterized NLSE as the linear combinations of several typically selected special solutions called 'eigen solutions'. Under this circumstance, both linear combination coefficients and the typically selected eigen solutions need to be found in order to obtain the universal solutions of parameterized NLSE."}, {"title": null, "content": "Unlike the conventional basis expansion method as the examples illustrated above that all basis shall meet the criterion of orthogonality and completeness, the eigen solutions from the reduced basis expansion method are always non-orthogonal and finite scaled which means that no universal solutions can be perfectly and accurately forms by using eigen solutions without any approximation errors. Nonetheless, the reduced basis expansion method is still effective as long as the errors of the linearly expressed universal solutions are acceptable. In another word, if both eigen solutions and linear combination coefficients can be appropriately found, then this method would be a relatively good approximation of the theoretic universal solutions of parameterized NLSE.\nGreedy algorithm is used to find both eigen solutions and linear combination coefficients in the reduced basis expansion method. At the start of greedy algorithm, one set of values in the parameter space of the parameterized NLSE is pre-determined. Then, the principle driven fiber model is trained to find the predicted solution of NLSE with this set of parameters. The predicted solution of this well trained principle driven model forms as the first eigen solution. Then, this eigen solution is utilized to approximate all solutions stems from the parameterized NLSE in the parameter space. The criterion for approximation performance by using the first eigen solution is to substitute the approximation results into both NLSE and initial condition to calculate the errors. Afterwards, the set of parameters whose error is the largest is utilized to train the principle driven fiber model to find the second eigen solution. The second eigen solution will together with the first eigen solution to find the best coefficients which can result in the minimum errors for all solutions with respect to the parameter space of the parameterized NLSE. The process repeats unless the acceptable approximation of the universal solutions are found.\nTwo important information should be taken extra attention. First, gradient descend method is utilized to find the combination coefficients after each eigen solution is found. Therefore, both values and gradients of the loss function of approximation results with respect to the linear combination coefficients should be mathematically defined and calculated. Second, if"}, {"title": null, "content": "one set of parameter is chosen to be the resource to find the eigen solution, then this set of parameter will no longer exist in the parameter space for testing the approximation performance since the eigen solution alone is the best approximation for itself.\nUnder the procedures illustrated above, for the p-th iteration, the approximated universal solutions of the parameterized NLSE can be expressed as\n${\\psi ^{pred}} = \\sum\\limits_{m = 1}^{{N_b}} {{c_m}\\psi _{Rm}^{pred}} = \\sum\\limits_{m = 1}^{{N_b}} {{c_m}\\psi _{Rm}^{pred} + i} \\sum\\limits_{m = 1}^{{N_b}} {{c_m}\\psi _{Im}^{pred}}$\n(6)\nin which c represents the linear combination coefficients and take real values. By substitution Eq. (6) into Eq. (4), the loss function for the parameterized NLSE can be found.\n${L_{PF}} = \\sum\\limits_{k = 1}^{{N_E}} {\\left| {\\frac{{\\partial \\sum\\limits_{m = 1}^{{N_b}} {{c_m}\\psi _{Rm,k}^{pred}} }}{{\\partial {\\zeta _k}}} - {\\kappa _1}{A_2}\\frac{{\\partial \\sum\\limits_{m = 1}^{{N_b}} {{c_m}\\psi _{Im,k}^{pred}} }}{{\\partial {{\\hat \\tau }^2}}} + {\\kappa _1}{A_3}\\frac{{\\partial \\sum\\limits_{m = 1}^{{N_b}} {{c_m}\\psi _{Im,k}^{pred}} }}{{\\partial {{\\hat \\tau }^3}}} + {\\kappa _1}{A_4}\\left[ {{{\\left( {\\sum\\limits_{m = 1}^{{N_b}} {{c_m}\\psi _{Rm,k}^{pred}} } \\right)}^2} + {{\\left( {\\sum\\limits_{m = 1}^{{N_b}} {{c_m}\\psi _{Im,k}^{pred}} } \\right)}^2}} \\right]\\sum\\limits_{m = 1}^{{N_b}} {{c_m}\\psi _{Rm,k}^{pred}} } \\right|}  + \\sum\\limits_{k = 1}^{{N_E}} {\\left| {\\frac{{\\partial \\sum\\limits_{m = 1}^{{N_b}} {{c_m}\\psi _{Im,k}^{pred}} }}{{\\partial {\\zeta _k}}} + {\\kappa _1}{A_2}\\frac{{\\partial \\sum\\limits_{m = 1}^{{N_b}} {{c_m}\\psi _{Rm,k}^{pred}} }}{{\\partial {{\\hat \\tau }^2}}} + {\\kappa _1}{A_3}\\frac{{\\partial \\sum\\limits_{m = 1}^{{N_b}} {{c_m}\\psi _{Rm,k}^{pred}} }}{{\\partial {{\\hat \\tau }^3}}} + {\\kappa _1}{A_4}\\left[ {{{\\left( {\\sum\\limits_{m = 1}^{{N_b}} {{c_m}\\psi _{Rm,k}^{pred}} } \\right)}^2} + {{\\left( {\\sum\\limits_{m = 1}^{{N_b}} {{c_m}\\psi _{Im,k}^{pred}} } \\right)}^2}} \\right]\\sum\\limits_{m = 1}^{{N_b}} {{c_m}\\psi _{Im,k}^{pred}} } \\right|}  + \\frac{1}{{{N_{ini}}}}\\sum\\limits_{k = 1}^{{N_{ini}}}} {{{\\left| {\\sum\\limits_{m = 1}^{{N_b}} {{c_m}\\psi _{Rm,k}^{pred}} (\\zeta  = 0,t) - {\\psi _R}(\\zeta  = 0,t)} \\right|}^2}}  + \\frac{1}{{{N_{ini}}}}\\sum\\limits_{k = 1}^{{N_{ini}}}} {{{\\left| {\\sum\\limits_{m = 1}^{{N_b}} {{c_m}\\psi _{Im,k}^{pred}} (\\zeta  = 0,t) - {\\psi _I}(\\zeta  = 0,t)} \\right|}^2}}$\n(7)\nBy taking the derivatives of LPF with respect to the m-th linear combination coefficient, one can easily find the gradient which is shown in Eq. (9).\n${\\nabla ({L_{PF}})_l} = \\sum\\limits_{k = 1}^{{N_E}} {\\left| {\\frac{{\\partial {\\psi _{Rl,k}^{pred}}}}{{\\partial {\\zeta _k}}} - {\\kappa _1}{A_2}\\frac{{\\partial {\\psi _{Il,k}^{pred}}}}{{\\partial {{\\hat \\tau }^2}}} + {\\kappa _1}{A_3}\\frac{{\\partial {\\psi _{Il,k}^{pred}}}}{{\\partial {{\\hat \\tau }^3}}} + {\\kappa _1}{A_4}\\sum\\limits_{m = 1}^{{N_b}} {{c_m}} \\left[ {{{\\left( {\\psi _{Rm,k}^{pred}} \\right)}^2} + {{\\left( {\\psi _{Im,k}^{pred}} \\right)}^2}} \\right]{\\psi _{Rl,k}^{pred}}} \\right|}  + {\\kappa _1}{A_4}\\left| {\\sum\\limits_{m = 1}^{{N_b}} {{c_m}} \\left[ {{{\\left( {\\psi _{Rl,k}^{pred}} \\right)}^2} + {{\\left( {\\psi _{Il,k}^{pred}} \\right)}^2}} \\right]{\\psi _{Il,k}^{pred}}} \\right| + \\sum\\limits_{k = 1}^{{N_E}} {\\left| {\\frac{{\\partial {\\psi _{Il,k}^{pred}}}}{{\\partial {\\zeta _k}}} + {\\kappa _1}{A_2}\\frac{{\\partial {\\psi _{Rl,k}^{pred}}}}{{\\partial {{\\hat \\tau }^2}}} + {\\kappa _1}{A_3}\\frac{{\\partial {\\psi _{Rl,k}^{pred}}}}{{\\partial {{\\hat \\tau }^3}}} + {\\kappa _1}{A_4}\\sum\\limits_{m = 1}^{{N_b}} {{c_m}} \\left[ {{{\\left( {\\psi _{Rl,k}^{pred}} \\right)}^2} + {{\\left( {\\psi _{Il,k}^{pred}} \\right)}^2}} \\right]{\\psi _{Il,k}^{pred}}} \\right|}  + 2\\sum\\limits_{k = 1}^{{N_{ini}}}} {\\psi _{Rl,k}^{pred}} (\\zeta  = 0,t) - {\\psi _R}(\\zeta  = 0,t) + 2\\sum\\limits_{k = 1}^{{N_{ini}}}} {\\psi _{Il,k}^{pred}} (\\zeta  = 0,t) - {\\psi _I}(\\zeta  = 0,t)$   (8)\nThen the linear combination coefficient can be updated by utilizing Eq. (8) as\n${c_m} = {c_m} - lr \\times {({\\nabla _{{L_{PF}}}})_l}$    (9)"}, {"title": "2.5 Parameterized Principle Driven Fiber Models", "content": "As is illustrated above, the parameterized principle driven fiber model consists of both the principle driven fiber model and the reduced basis expansion method. For the training of this parameterized model, the reduced basis expansion method plays the role of finding the eigen solutions and the linear combination coefficients. For each eigen solution except the first, those set of parameters whose errors are the largest is utilized to train the principle fiber model. Then, the predicted solution will become the new eigen solution together with previous eigen solutions to train the best linear combination coefficients in order to minimize the overall loss towards the whole parameter space shown in Eq. (10) so as to reach the best approximation of the universal solution of the parameterized NLSE.\nWithout losing the generality, pulses with Gaussian, Sech and SuperGaussian shape are utilized to demonstrate the parameterized principle driven fiber model. For the disecretized of the independent variables (t, (), t ranges from -1 to 1 with 100 points while (ranges from 0 to 1 with 101 points. The initial condition is also discretized into 100 points. For the parameterized space of the fiber, both attenuation, dispersion, either second-order or third- order and non-linearity can be ranged freely."}, {"title": "3. Simulation results and analysis", "content": null}, {"title": "3.1 Training of the Principle Driven Fiber Model", "content": "The training of the principle driven fiber model aims at obtaining eigen solutions for the parameterized NLSE. Apart from the first set of parameters which is specified in advance, other sets of parameters come from the cases whose error is the largest error. For the training of the principle driven model, adaptive stochastic gradient descend method (ADAM) [16] is utilized as to better training the model. The adaptive learning rate controlled by the decaying coefficient in the method can let the model quickly find the local minimum area at first and prematurely search for the local minima at the final few epochs"}, {"title": "3.2 Training of the Reduced Basis Expansion", "content": "After the principle driven model is appropriately trained, the solution of this set of parameters will form new eigen solution. The linear combination coefficients will be trained as to find the best linear combinations of all eigen solutions obtained to in the current stage approximate the solutions with respect to other sets of parameters."}, {"title": null, "content": "Fig. 4(a) shows ten sets of parameters utilized to find the corresponding eigen solutions while Fig. 4(b) shows the model's convergence situation with respect to the different numbers of eigen solutions for the single Gaussian pulse as input. 10 different colors in both subfigures mark the corresponding order of the 10 eigen solutions. In total two important conclusions can be drawn. First, the prediction loss indeed decreases as the number of eigen solutions increases. This is in consistent with the trend that more meticulous approximation can be reached when the number of basis increases according to the reduced basis expansion method. Second, the pace of convergence tends to slow down when adding more eigen solutions. This phenomenon can also be explained when conducting analogy work towards Fourier series that the latter-added eigen solutions perform as higher-order components which make less contributions than those first few eigen solutions. Besides, other interesting fact can also be found by carefully observing the upper Fig. 4(a) that most of the parameters selected for training of the eigen solutions are located at the boundary of the whole parameter space such as the 3rd and 9th set of parameters. This is because boundary of the parameter space represents relatively extreme transmission conditions which can cause larger difficulty for the principle driven fiber model to converge."}, {"title": "3.3 Performances of the Parameterized Fiber Model", "content": "The final parameterized principle driven fiber model utilizes the predicted solutions from the previously principle driven fiber models to form the final universal solutions with respect to the whole parameter space shown and depicted in both Table 1 and Fig. 4. Since single pulse with Gaussian, Sech and SuperGaussian are all utilized for demonstration, Fig. 5 shows the model's outputs for randomly selected 6 sets of parameters in the parameter space for the input of the single pulse with all three shapes. It can be concluded though approximation error exists, the reduced basis expansion method can still find the best linear coefficients to well organize the eigen solutions to form the final solutions for different transmission parameters so that the prediction accuracy can still remain high."}, {"title": "3.4 Parameterized Fiber Model's training and testing performances for multiple pulses input", "content": "Though detailed training and testing performances of the model are illustrated and shown in detail for single pulse input, the prediction of multiple pulses input are also conducted whose configurations can be found in Table 1 and Table 2.\nLike single pulse input, convergence performances for finding 10 eigen solutions when multiple Gaussian pulses being inputted are shown in Table 5. When compared with Table 4, it can be obviously found that the overall average number of epochs that can meet the stop criterion is larger for multiple pulses input. It is because multiple pulses posses more sophisticated waveform evolutions than single pulse thus will increase the difficulty for the principle model to converge to the expected state."}, {"title": "3.5 Computational Complexity Comparison", "content": "Two companions of computational complexity should be conducted as to not only highlight the model's prominent advantages in fast predicting, but also reveal the time distribution differences of the whole model training and testing over different initial conditions. For the comparison of training and testing time distributions on different initial conditions, direct computing time is selected as the standard since the model is trained on Tesla T4 TPU all for those six different initial conditions. For the comparison of different methods in computational complexity, the scale of multiplication and addition (MAC) is calculated since different model tend to be operated on different hardware platforms."}, {"title": null, "content": "The computation complexity calculation and comparison of SSFM, the previously proposed principle driven fiber model and the parameterized fiber model proposed in this manuscript are conducted as well. Before comparison, several assumptions should be made. The task for calculate is a parameterized NLSE whose scale of parameter space equals N. Both coordinates of time and distance are discretized into $M_t$ and $M_{\\zeta}$ respectively. The longest transmission distance is $L_{max}$. For comparison fairness, both principle driven fiber model and the inserted fiber model inside the parameterized model posses K hidden layers, each layer contains P neurons. For the parameterized fiber model, the maximum basis is determined to be $N_b$. The length of computational unit equal $L_u$. Under these assumptions, the computational complexity of SSFM can be calculated as\n${C_{SSFM}} = \\frac{{{L_{max}"}]}, {}]