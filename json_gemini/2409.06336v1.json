{"title": "Towards Agentic AI on Particle Accelerators", "authors": ["Antonin Sulc", "Raimund Kammering", "Hayden Houscher", "Thorsten Hellert", "Jason St. John"], "abstract": "As particle accelerators grow in complexity, traditional control methods face increasing challenges in achieving optimal performance. This paper envisions a paradigm shift: a decentralized multi-agent framework for accelerator control, powered by Large Language Models (LLMs) and distributed among autonomous agents. We present a proposition of a self-improving decentralized system where intelligent agents handle high-level tasks and communication and each agent is specialized control individual accelerator components.\nThis approach raises some questions: What are the future applications of AI in particle accelerators? How can we implement an autonomous complex system such as a particle accelerator where agents gradually improve through experience and human feedback? What are the implications of integrating a human-in-the-loop component for labeling operational data and providing expert guidance? We show two examples, where we demonstrate viability of such architecture.", "sections": [{"title": "1 Introduction", "content": "Particle accelerator operation involves a complex interplay of interrelated systems, each requiring pre-cise control and optimization. Traditionally, these systems have been managed through a combination of human expertise and highly specialized algorithms with recent developments including machine learning techniques [7] where some are successfully deployed in operation like e.g. [11, 8, 29].\nMost of these algorithms are designed to operate in a narrow domain of accelerator functionality. The systems have noise, tight operational limits, and deterministic interplay through the control system to ensure human and equipment safety, preventing scenarios that could lead to hazardous conditions or equipment damage. While effective, this approach can sometimes struggle to achieve optimal overall performance due to the challenges of integrating these disparate systems. Even when a sufficiently comprehensive model of the facility is constructed, it can be highly sensitive and prone to problems as the accelerator transitions through different states or experiences drifts and thus requires human intervention for setup and ongoing maintenance.\nThis paper proposes a paradigm shift in accelerator control systems, envisioning a future where self-improving agents control separated sub-components using algorithms that inform operators of significant events. In this framework, we show how autonomous agents controlled by LLMs serve not only in the creation and retrieval of accelerator operation documentation but also as high-level coordinators, handling complex tasks such as the interpretation of the machine state from analyzing control system channels or inter-agent communication with a degree of autonomy in decision-making"}, {"title": "2 Related Work", "content": "Machine learning techniques have increasingly been applied to various aspects of accelerator physics in recent years. Edelen et al. [7] provide a comprehensive review of machine learning applications in particle accelerators, covering areas such as beam diagnostics, control systems, and performance optimization."}, {"title": "2.1 Agentic AI and LLMs in Complex Reasoning Tasks", "content": "There is a rise of agentic AI that has demonstrated remarkable capabilities in complex reasoning tasks [2]. According to [27], an effective agent in an agentic system should possess autonomy to operate independently, reactivity to respond to environmental changes, and proactiveness to take initiative in pursuing its objectives, enabling it to function intelligently and adaptively in complex environments. We will highlight the most relevant works that align with our problem.\nYao et al. [28] introduced the ReAct framework, which showed how LLMs can effectively combine reasoning and acting in multi-step tasks and is widely used to operate in complex multi-step reasoning.\nThe field of use of AI agents to effectively engage with their environment and complete a wide array of tasks has been gaining more and more popularity. Park et al. [19] introduce generative agents that use LLMs to simulate human behavior in interactive environments, showcasing how LLMs can be utilized to model intricate multi-agent interactions and environmental complexities. Wang et al. [25] uses an LLM-powered agent to autonomously explore, acquire skills, and make dis-coveries in unfamiliar environments using components like an automatic curriculum and skill library. AgentVerse [3] shows a framework for collaborative groups of LLM-powered expert agents, showing improved performance over single agents in various tasks. This multi-agent approach leverages LLMs for high-level tasks while enabling specialized components to work together autonomously on complex problems. AutoGen [26] framework allows building LLM applications using multiple"}, {"title": "2.2 LLMs as Assistants in Operations", "content": "Carrasco et al. [2] explores fine-tuned LLMs for autonomous spacecraft control in simulations, showing their efficacy in handling language-based inputs and outputs. It shows the potential of using LLMs for complex tasks like accelerator control.\nIn accelerators, Mayet's [18] GAIA system uses LLMs with the ReAct framework [28] to assist in operations by integrating multiple expert tools e.g. knowledge retrieval, machine control, and Python script generation for autonomous and semi-autonomous management of complex accelerator environments.\nIn [24] they show joint efforts across particle accelerator facilities to utilize Retrieval Augmented Generation (RAG) models and other AI techniques for enhancing eLogs usability and automation, aiming to unlock operational insights and improve data accessibility."}, {"title": "3 Features of the System", "content": "Four key aspects of agents can significantly enhance operational effectiveness. First, operating particle accelerators is complex and requires extensive human expertise. We suggest that agents can gradually improve through experience [23] where the system incorporates continuous learning from operational data and learns based on outcomes or from \"human-in-the-loop\". It can be an important step forward since most of these particle accelerators operate in already high reliabilities above 90%.\nSecond, the potential to uncover causal relationships in accelerator operations by adding Reasoning Agents [10]. LLM-powered agents can provide a human-readable interface to complex machine operations, enabling faster exploration of causal connections via reasoning about the information available (or gradually reasoning about it via ReAct [28]). By integrating agents designed to reveal casual relationships, we aim to enhance system interpretability and streamline diagnostics. This approach could reduce the learning curve for new operators and offer valuable insights to experienced physicists, leading to more efficient accelerator management.\nThe third key component is agent autonomy implementable via rules, decision trees, or language models. LLMs are currently preferred due to their natural language interface and intelligent decision-making. LLM high computational needs may cause delays, limiting use in real-time control. The choice of autonomy implementation thus requires balancing LLMs' flexibility against performance needs in time-sensitive applications.\nLastly, other interesting examples of agents can be: planning agent [17] to execute and run complex plans with standard tools, such as to execute tasks at e.g. European XFEL defined in Taskomat [9] or [1] at Fermi, coding agents [21], and data scientist agents [16] to summarize."}, {"title": "4 Examples", "content": "In this section, we present two examples, where the aforementioned features can be directly applicable by integrating them into the control systems like [12, 4, 20] and enhancing operational efficiency and stability: the Advanced Light Source (ALS) orbit feedback system and the European XFEL longitudinal feedback manager."}, {"title": "4.1 ALS Example: Orbit Feedback", "content": "Maintaining precise control over the beam orbit through orbit feedback systems is crucial for the stable operation of a storage ring. However, this task can be complicated in practice by machine drifts caused by environmental factors or by maintenance activities that alter the operational characteristics of specific sections of the ring. Under the current operational paradigm, when the orbit feedback system fails to converge during user operation, a physicist must intervene. This process typically involves a detailed analysis of the situation, comparing current conditions with previous runs, and relying heavily on experience to make a judgment call on how to adjust the system for optimal performance.\nAs illustrated in Fig. 2, in our envisioned framework, this diagnostic role would be managed by a specialized feedback agent. Upon detecting abnormal behavior, the agent would identify the underperforming area and consult the logbook agent for recent events that could explain the issue. For instance, if maintenance work had occurred in the affected sector, the logbook agent would provide this information. The feedback agent would then draft a report outlining the problem, its likely root cause, and a suggested course of action, which would be sent to the control room for review."}, {"title": "4.2 European XFEL Longitudinal Feedback Manager", "content": "The particle beam in a linear accelerator, like the European XFEL, is stabilized within well-defined, narrow parameter spaces through the use of various feedback loops. To effectively orchestrate the complex interplay of these feedback loops, expert systems are often employed [15, 5], which encapsulate the logic of this interaction in software. A Feedback Agent can be trained to learn the possible and desired states, illustrated in Fig. 3. In the next step, such an agent would initially be able to assist the operator as a kind of recommender system and, potentially, could take over the entire operation of all longitudinal feedback loops in a later step.\nExamples of additional agents can be: Orbit Feedback Agent for controlling transversal beam parameters; Undulator Agents for optimizing photon beam production; Beamline Agents overseeing experimental stations; and Feedback Coordination Agent acting as a central coordinator to orchestrate overall feedback operation. Each agent functions as a recommender system, assisting human operators in decision-making. As confidence in their performance grows, they could potentially take over the entire operation of individual feedback, e.g. through [23]. Crucially, these agents maintain constant communication with each other. Before implementing any changes, each agent informs the others of its intended actions. This allows for a collective evaluation of the proposed changes, ensuring that they don't lead to suboptimal or dangerous configurations."}, {"title": "5 Conclusion", "content": "This paper proposes a paradigm shift in particle accelerator control through a decentralized multi-agent framework powered by LLMs. By integrating AI agents for high-level tasks and specialized agents for component management, we address the increasing complexity of modern accelerator systems.\nTwo examples demonstrate the potential of AI agents in assisting complex accelerator tasks, open-ing the way for higher autonomy. While this approach offers exciting possibilities for improved performance, our practical examples support a vision for more intelligent and adaptive accelerator operations."}]}