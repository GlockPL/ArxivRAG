{"title": "Exploring a Physics-Informed Decision Transformer for Distribution System Restoration: Methodology and Performance Analysis", "authors": ["Hong Zhao", "Jin Wei-Kocsis", "Adel Heidari Akhijahani", "Karen L Butler-Purry"], "abstract": "Driven by advancements in sensing and computing, deep reinforcement learning (DRL)-based methods have demonstrated significant potential in effectively tackling distribution system restoration (DSR) challenges under uncertain operational scenarios. However, the data-intensive nature of DRL poses obstacles in achieving satisfactory DSR solutions for large- scale, complex distribution systems. Inspired by the transformative impact of emerging foundation models, including large language models (LLMs), across various domains, this paper explores an innovative approach harnessing LLMs' powerful computing capabilities to address scalability challenges inherent in conventional DRL methods for solving DSR. To our knowledge, this study represents the first exploration of foundation models, including LLMs, in revolutionizing conventional DRL applications in power system operations. Our contributions are twofold: 1) introducing a novel LLM-powered Physics-Informed Decision Transformer (PIDT) framework that leverages LLMs to transform conventional DRL methods for DSR operations, and 2) conducting comparative studies to assess the performance of the proposed LLM-powered PIDT framework at its initial development stage for solving DSR problems. While our primary focus in this paper is on DSR operations, the proposed PIDT framework can be generalized to optimize sequential decision- making across various power system operations.", "sections": [{"title": "I. INTRODUCTION", "content": "In recent years, reliance on a stable and continuous power supply reaching unprecedented levels across all sectors of industry and daily life. Consequently, a reliable and resilient power supply has become paramount for various critical infrastructures such as hospitals, transportation systems, communication networks, and manufacturing facilities. At the same time, the increasing frequency and severity of extreme events, such as extreme weather, natural disasters, and cyber- attacks, pose critical challenges for maintaining the resilience and reliability of modern power systems. For instance, in February 2021, severe winter storms in Texas caused a massive electricity system outage, resulting in at least 57 deaths and over $195 billion in property damage, according to a report by the University of Texas at Austin [1]. These challenges highlight the urgent need to enhance the resilience of power grids to ensure they can withstand and recover from severe disruptions. Given that the distribution system serves as a crucial link in the power delivery process from the transmission grid to end-users, research into resiliency in distribution systems is pivotal for enhancing grid resilience and mitigating the impacts of power outages.\nOne key indicator of resiliency in distribution systems is the ability to restore service to critical loads after disruptions on the main grid [2]. Following power outages, distribution system restoration (DSR) aims to rapidly restore affected loads by leveraging advanced emerging controls once the outages are isolated. Forming microgrids (MGs) with dynamic boundaries as a service restoration strategy is a promising solution for enabling effective DSR [3-5]. By incorporating various energy sources, distributed generators (DGs), along with remotely controlled switches, a distribution system can be partitioned into multiple self-sufficient MGs. This approach enhances the system's restoration capability and maintains power supply continuity to critical loads, thereby significantly improving overall grid resilience. In this paper, we focus on advancing the DSR solution through sequential formation of MGs with dynamic boundaries, for enhancing resiliency of distribution systems.\nThe existing methods for solving DSR problems can be generally group into four categories: 1) mathematical programming methods, such as mixed-integer programming (MIP)-based methods. These methods formulate the DSR problems as mixed-integer linear or non-linear programming problems and solve them using off-the-shelf solvers [6-9,28]. While these methods ensure optimality of DSR solutions, they typically require accurate physical models of the distribution systems, which are not always available in dynamic and uncertain operation scenarios. Additionally, the computational complexity can increase dramatically with the number of controllable components, which limit the scalability of the solutions; 2) heuristic methods. These methods leverage algorithms, such as genetic algorithms, Tabu search, and greedy algorithms, to search for satisfactory solutions [10-12]. Compared to mathematical programming, heuristic methods are capable of handling dynamic and uncertain operation environment. However, these methods also face the scalability issues for large-scale distribution systems. Additionally, the quality of the solutions can be sensitive to the hyperparameters"}, {"title": "II. PROBLEM SETTINGS", "content": "In our work, we formulate the DSR problem as an MDP within DRL framework. Table I shows the definitions of the parameters and variables that will be used in this paper.\nA. DSR Problem Modeling\nIn the initial stage of this research, the proposed Distribution System Restoration (DSR) method is modeled as a sequential decision-making process involving sequences of control actions on switches to restore loads to their normal operational states. These sequences of switching actions, referred to as energization paths, are each associated with a single active distributed generator (DG). Specifically, each energization path begins at the switch connected to the associated DG and aims to maximize load restoration by forming multiple microgrids, while ensuring compliance with all operational and physical constraints. Additionally, to reduce the space of control actions in the modeling, we adopt the concept of node cell as introduced in [28]. A node cell is defined as a set of nodes that are interconnected directly by non-switchable lines. Consequently, all the lines and loads within a node cell will be energized simultaneously. Furthermore, in our current work, the constraints include: 1) the voltage limits, 2) power flow constraints, 3) DGs' generation capacities, and 4) topological constraints including prevention of loop formation and ensuring no node cell is visited more than once.\nB. DSR Problem Formulation within a DRL Framework\nWe further formulate the sequential decision-making process for energization paths in the DSR problem model as an MDP"}, {"title": "III. PROPOSED LLM-POWERED PIDT FRAMEWORK FOR DSR DECISION MAKINGS", "content": "We continue to introduce our proposed innovative LLM- powered PIDT framework that transforms our formulated DRL framework by exploring the powerful computing capabilities of LLMs. Figure. 1 illustrates the overview structure our proposed PIDT framework. As shown in Fig. 1, our proposed PIDT framework mainly consists of: 1) an encoder that consists of linear layers followed by an embedding layer; 2) a GPT-based causal transformer with a causal self-attention mask; and 3) a decoder. The encoder is developed to take a trajectory of rewards, states, and actions as input, and process the trajectory to generate token embeddings that will be fed into the GPT- based causal transformer model for further processing. To achieve this, the trajectory input $\\hat{\\tau}_{t-k:t}$ of length T of the encoder is formulated as $\\hat{\\tau}_{t-k:t} = \\{R_k, S_k, a_k, R_{k+1}, S_{k+1}, a_{k+1}, \\dots, R_{t-1}, S_{t-1}, a_{t-1}, R_t, S_t$ as illustrated in Fig. 1, which is different from the trajectory formulated in the original DRL framework that is described in previous section. To appropriately formulate the trajectory input, it is essential to define a physics-informed return-to-go reward $R_t$ such that 1) the trajectory $\\hat{\\tau}_{t-k:t}$ can be effectively processed by the GPT-based causal transformer, and 2) the objective and physical/operational constraints for DSR are accurately characterized. To achieve this, we formulate $R_t$ by transforming the reward $r_t$ for the original DRL framework, which is defined in Eq. (1), by defining the desired target return as $R^* = \\Sigma_{t=1}^T(\\Sigma_{i \\in L} P_{l,t})$, where is $P_{l,t}$ is nominal active power of Load i at time t. Based on $R^*$ and $r_t$ defined in Eq. (1), we are able to represent $R_t$ in training and inference procedures as follows:\n1) Training Procedure:\n$R_t = \\Sigma_{i=t}^T r_i$\n2) Inference Procedure:\n$R_0 = R_1 = R^*$\n$R_t = R^* - \\Sigma_{i=1}^{t-1} r_i$\nWhere t = 2, ...T. After projecting the trajectory $\\hat{\\tau}_{t-k:t}$ to the embedding dimension, the encoder forwards the token embeddings for $\\hat{\\tau}_{t-k:t}$ to GPT-based casual transformer that is designed to generate a deterministic action at time t such that $a_t = \\hat{\\pi}(\\hat{\\tau}_{t-k:t})$, as shown in Fig. 1. The policy $\\hat{\\pi}$ within our PIDT framework is parameterized by the GPT-based casual transformer where the action sequences are generated via autoregressive modeling. The policy $\\hat{\\pi}$ is trained by minimizing the cross-entropy loss between the predicted actions and the ground-truth actions in a sampled batch of trajectory data. The output of the GPT-based casual transformer is fed to the decoder that projects the token embeddings of the predicted trajectory back to the original action space, resulting in the final predicted control actions on the operational switches for DSR.\nModel Training. The overall training procedure is described as follows:\n1) We prepare a dataset D consisting of \"offline\" trajectories for DSR operations on the targeted distribution system. These trajectories can be collected from experts in power system domain or can be collected from simple off-line random walks to generate the sequences of control actions applied to the operable switches. These trajectories do not need to be optimal.\n2) The minibatches of sequence length K from the dataset D will be fed to the PIDT framework to make decision on switching actions, and parameters of the PIDT framework will be updated according to the cross-entropy loss.\n3) Repeat M episodes for Step 2.\nThe procedure is shown in Algorithm 1.\nModel Inference. The overall inference procedure is shown in Algorithm 2. It is worth noting that we always keep only the last K time steps in the trajectory."}, {"title": "IV. PERFORMANCE EVALUATIONS", "content": "In this section, we evaluate the performance of our proposed PIDT framework in two case studies with the modified IEEE 13-bus system [29] and the modified IEEE 123-bus system [29], respectively. To evaluate the performance of the PIDT framework, we compare it with two benchmark DRLs, the PPO algorithm [30], and the A2C algorithm [31], in the DSR operation.\nA. Modified IEEE 13-Bus Test System\nIn this case study, we use a modified IEEE 13-bus test system that is available in the Open Distribution Simulator Software (OpenDSS). The system topology and its corresponding node- cell graph are shown in Fig. 2. As illustrated in Fig. 2, in this system, there is a substation located in a \u201csourcebus\" that is connected to Bus Node 650, with an additional bus node (namely Bus Node 670) that connects between Bus Node 632 and 670. After reformed into node cells, there will be a total of node cells to be energized.\nAdditionally, based on objective and physical/operational constraints for the DSR operation, the ground-truth energization path in this case is determined as (Node 0) \u2192 (Node 1) \u2192 (Node 3) \u2192 (Node 4). And the corresponding final restored power should be 3006.509kW, which is considered as the objective of the DSR operation and is also the desired target return in our PIDT method. The learning curves for the average return of the first 1500 gradient updates by using our PIDT method as well as the other two benchmark DRL methods are shown are shown in Fig. 3. Further details about the evaluation results of the three methods are shown in Table II. Additionally, a bar char in Fig. 4 shows more insights of the simulation results, which presents the distribution of power restoration levels in the 50 independent trials using the three methods, respectively.\nFrom Figs. 3 and 4 and Table II, we observe that during the learning process, the A2C method demonstrates the quickest convergence and achieves the highest training return. However, it typically settles for a suboptimal solution, maintaining power restoration within the range of [1000, 3006] kW for the majority of trials. In contrast, our method, while not showing the fastest convergence or the highest training return, achieves optimal solutions in 42 out of 50 independent trials. This is reasonable since the return-to-go reward defined in our proposed PIDT method is different from the rewards in conventional DRL. Additionally, from the simulation results, we can also see that the performance of the PPO method falls between that of A2C and our PIDT methods.\nB. Modified IEEE 123-Bus Test System\nIn this case study, we evaluate the performance of our PIDT method by comparing with the PPO- and A2C-based benchmark DRL methods in DSR operations for a modified 123-bus test system. The system topology and its corresponding node cell graph are shown in Fig. 5. As shown in Fig. 5, in the modified 123-bus test system, there are five energy sources in the system, two of which are substations located in Bus Nodes 150 and 350, and the three other sources are distributed generators (DGs) located in Bus Nodes 95, 250 and 450. Additionally, the system has a total of 15 node cells to be energized. We also incorporate the modification on the energization ability to the DG in Bus 250, such that this DG can only fully energize loads in Node Cell 3 and Node Cell 2. The DG will be automatically shut down if it tries to energize more loads other than those in Node Cell 3 and Node Cell 2.\nThe actual total power of the system, if all the loads are powered properly, would be 3350.757 kW, which is considered as the objective of the DSR operation and is also the desired target return in our PIDT method. An expected optimal solution would power all the loads properly. However, due to the large0- scale and complex topology of the modified IEEE 123-bus test system, a simple optimal solution to power all the loads is very challenging. The learning curve of the first 6000 gradient updates using our PIDT method and the two benchmark DRL methods are shown in Fig. 6. As shown in Fig. 6, for the modified IEEE 123-bus system that has large-scale and complex topology, our method outperforms the other two methods in convergence rate and convergence reward in general. Further details about the evaluation results of the 3 methods are presented in Table III. As shown in Table III, our proposed PIDT method can achieve near- optimal solutions in 30 of the 50 independent trial, which outperforms the PPO and A2C methods (in this case study, the near-optimal solutions are defined as the solutions whose final restored power is more than 3000kW).\nFurthermore, Fig. 7 provides deeper insights into the simulation results shown in Table III by illustrating the distribution of power restoration levels across 50 independent trials using the three methods. It reveals that our method achieves near-optimal power restoration in 30 trials and between 2000 kW to 3000 kW in the remaining 20 trials. In contrast, the solutions generated by the A2C-based method predominantly fall within the range of 0 kW to 1000 kW. The PPO-based method shows a more varied distribution across all three ranges, with 12 trials achieving near-optimal results. These findings underscore the superior performance of our method over the other two conventional DRL methods."}, {"title": "V. CONCLUSIONS", "content": "While different DRL-based approaches have been developed for effectively addressing DSR challenges amidst uncertain operational conditions, the data-intensive nature of DRL presents barriers to achieving robust solutions for large-scale, complex distribution systems. This paper explores an innovative strategy inspired by the transformative impact of emerging foundation models, such as LLMs, across diverse domains. Specifically, we present a first-ever effort on exploring LLMs' powerful computing capabilities to tackle scalability challenges inherent in traditional DRL methods for DSR operations.\nThis study marks the pioneering application of foundation models, including LLMs, to revolutionize conventional DRL practices in power system operations. Our contributions are twofold: 1) introducing a novel PIDT framework that explore LLMs to transform conventional DRL methods for DSR operations, and 2) conducting comparative studies to analyze the performance of the LLM-powered PIDT framework in its initial development stage for solving DSR problem. Simulation results underscore the effectiveness of our proposed PIDT method in resolving DSR problems within large-scale distribution systems. In our ongoing work, we are leveraging the insights gained from our current initial-stage development to further enhance the scalability and resilience of our proposed PIDT method. While our primary focus in this paper lies in DSR, the proposed PIDT framework demonstrates potential applicability in optimizing sequential decision-making across a spectrum of power system operations."}, {"title": "APPENDIX", "content": "A. Example solutions for the case study with modified IEEE 13- bus test system\nThe step-by-Step illustrations on an optimal solution of the sequence of control actions generated by our method for the DSR operation in the modified 13-bus test system. are shown in Fig. 8, which also represents most of the solutions generated by our method.\nAdditionally, Fig. 9 illustrates one representative suboptimal solution generated by our PIDT method. As part of our ongoing work, we are actively investigating these suboptimal solutions, which will give us valuable insights on improving our current initial-stage efforts.\nB. Example solutions for the case study with modified IEEE 123-bus test system\nThe step-by-Step illustrations on a near-optimal solution of the sequence of control actions generated by our method for the DSR operation in the modified 123-bus test system. are shown in Fig. 10. By following this switching sequence, all the loads in the system will be energized, achieving a final restored power of 3348.504kW. Additionally, Fig. 11 shows an example sub- optimal solution on switching sequence, generated from our method, for DSR operation in the modified IEEE 123-bus system. As shown in Fig. 11, the suboptimal solution cannot energize all the loads in the system. From Fig. 11, we can also observe that one reason that this solution fails to energize all the loads is that the energization paths formed from the control sequence cannot traverse all the node cells in the system. The final restored power of this example solution is 2843.730kW. In our ongoing work, we are exploring the strategy to improve the capability of our initial version of the PIDT method in addressing DSR problem in large-scale distribution system including the modified IEEE 123-bus system."}]}