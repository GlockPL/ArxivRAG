{"title": "THREE-DIMENSIONAL DIFFUSION-WEIGHTED MULTI-SLAB MRI WITH SLICE\nPROFILE COMPENSATION USING DEEP ENERGY MODEL", "authors": ["Reza Ghorbani", "Jyothi Rikhab Chand", "Chu-Yu Lee", "Mathews Jacob", "Merry Mani"], "abstract": "Three-dimensional (3D) multi-slab acquisition is a technique\nfrequently employed in high-resolution diffusion-weighted\nMRI in order to achieve the best signal-to-noise ratio (SNR)\nefficiency. However, this technique is limited by slab bound-\nary artifacts that cause intensity fluctuations and aliasing\nbetween slabs which reduces the accuracy of anatomical\nimaging. Addressing this issue is crucial for advancing\ndiffusion MRI quality and making high-resolution imag-\ning more feasible for clinical and research applications. In\nthis work, we propose a regularized slab profile encoding\n(PEN) method within a Plug-and-Play ADMM framework,\nincorporating multi-scale energy (MuSE) regularization to\neffectively improve the slab combined reconstruction. Exper-\nimental results demonstrate that the proposed method signif-\nicantly improves image quality compared to non-regularized\nand TV-regularized PEN approaches. The regularized PEN\nframework provides a more robust and efficient solution\nfor high-resolution 3D diffusion MRI, potentially enabling\nclearer, more reliable anatomical imaging across various ap-\nplications.", "sections": [{"title": "1. INTRODUCTION", "content": "Three-dimensional multislab (3D multislab) acquisition has\nbeen employed in high resolution diffusion imaging as a\nsignal-to-noise ratio (SNR) efficient alternative. In this ap-\nproach, the entire 3D volume is segmented into multiple 3D\nsub-volumes along the slice direction, with each sub-volume\nreferred to as a slab, where the slabs are independently ex-\ncited and encoded [1]. However, the higher SNR efficiency\noffered by 3D multislab acquisition can be compromised by\nslab boundary artifacts, which result from imperfections in\nthe radio frequency (RF) pulse profiles. The truncation of\nRF pulses leads to a slab-selective excitation profile that only\napproximates the ideal rectangular slab profile. This approx-\nimation introduces variations in the magnitude of the main"}, {"title": null, "content": "lobe, along with nonzero transition bands and side lobes,\ncontributing to the artifacts. The magnitude variation within\nthe main lobe of the slab excitation profile results in signal\nintensity fluctuations in the reformatted image along the slab\ndirection. Additionally, the presence of nonzero transition\nbands and side lobes causes the excitation profile to extend\nbeyond the intended slab thickness, leading to two issues:\nfirst, slab crosstalk, where the imperfect slab profile excites\nportions of adjacent slabs, and second, aliasing artifacts.\nSome earlier approaches mitigate slab boundary artifacts\nby oversampling in the slice direction, overlapping adjacent\nslabs, and combining the overlapped slices during reconstruc-\ntion through methods such as averaging or cropping. Slab\nprofile encoding (PEN) is a recent approach that poses the\nslab boundary artifact correction similar to a standard MRI\nparallel imaging inverse problem without the need for over-\nsampling. In this approach, corrected image is estimated from\na linear system of of slab profile weighted images, where\nthe slab profiles are assumed to be known from calibration\nscans and captures the side lobes and the uneven excitation\nprofiles[2].\nSlab over-sampling and overlap leads to increased scan-\ntime, thus reducing the SNR-efficiency of 3D multislab meth-\nods and restricting its utilization in high angular resolution ap-\nplications. Correction of slab boundary artifacts from under-\nsampled 3D volumes helps to overcome this limitation. Here,\nwe develop a regularized PEN reconstruction that can perform\nslab boundary artifact correction from fewer samples. We\nformulate the regularized PEN as an iterative reconstruction\nthat is solved in a Alternating Direction Method of Multipliers\n(ADMM) framework.\nPlug-and-Play ADMM is a widely adopted algorithm for\naddressing constrained optimization problems, particularly\nin image restoration tasks. One of its key advantages is its\nmodular design, which enables the integration of any stan-\ndard image denoising algorithm into a subproblem within\nthe ADMM framework. Common image regularization em-\nployed in under-sampled recovery are Total Variation de-\nnoising or other pre-learned plug-and-play denoising. A\nproblem with standard plug-and-play denoisers is the ab-\nsence of convergence guarantees[3]. The recently proposed\nmulti-scale energy (MuSE) framework ensures convergence\nguarantees while matching the performance of state of the"}, {"title": "2. METHODS", "content": "In this work, we present a Plug-and-Play ADMM approach\nto solve the regularized slab profile encoding problem. Our\nmethod leverages the properties of the MuSE regularization\nto correct the sharp transitions at slab boundaries caused by\nthe non-regularized PEN approach. The following sections\nwill discuss three key elements of our proposed method: the\nregularized objective function, the MuSE regularization, and\nthe plug and play ADMM optimization framework."}, {"title": "2.1. Problem Formulation", "content": "Figure 1 illustrates the origin of the slab boundary artifact\nin a 3D multislab acquisition setup, where multiple slabs are\nacquired to cover the entire field of view (FOV). The ideal ex-\ncitation thickness for each slab is denoted as AFOV. If the\nexcited area from the imperfect RF pulse exceeds AFOVz,\naliasing will occur, where the signal at a given voxel within\nthe intended thickness will receive contributions from loca-\ntions outside the intended thickness \u25b3FOVz.\nIn the case of no over-sampling, the aliasing can be mod-\neled mathematically as follows. Denoting Ik (z) as the aliased\nsignal measured at a voxel location z for slab k, Ik (z) is given\nby:\n$I_k(z) = \\sum_{m=0}^{N_{slab}-1} \\sum S_k(z + m\\triangle FOV_z) p(z + m\\triangle FOV_z)$ (1)\nfor all k, 1 \u2264 k \u2264 Nslab, where FOV is the full field of\nview along the slab direction, Nslab is the total number of\nslabs required to cover the full FOV, Sk is the pre-calibrated\nexcitation profile of slab k, and p is the unaliased 3D image\nvolume that extends the full FOV, which needs to estimated."}, {"title": null, "content": "The reconstruction problem in (1), in the presence of\nGaussian noise n, can be compactly represented in matrix\nnotation as:\ny = \u0391\u03c1 + n (2)\nwhere y is the measurement vector of the slab weighted im-\nages concatenated from all slabs 1 \u2264 k \u2264 Nslab, and A is\nthe corresponding PEN operator that multiples the unaliased\nimage volume with the slab profile weight at each voxel for\na given slab k. In the maximum-a-posteriori (MAP) frame-\nwork, the goal of the inverse problem is to maximize the pos-\nterior probability:\n\u03c1 = arg max p(py)\n= arg min $|| Ap - y|| - log p(p)$ (3)\nwhere the second equation also includes a log-prior term that\nserves as a regularization. While classical methods employ\nTV, low-rank priors etc as regularization, recent methods\nuse data-driven deep-learned priors as regularization. In this\nwork, we employ a CNN-based prior represented as:\nPo(\u03c1) = $\\frac{1}{Z_e}$exp(-$E_\\theta(\u03c1)$) (4)\nHere @ denotes the parameters of the CNN, Eo(p) denotes\nthe energy function that is modeled by the CNN, and Ze is\nan unknown normalization constant. Given noise-free train-\ning data, the log-prior can be learned in a data-driven fashion\nusing denoising score matching (DSM) as described in [5].\nThe advantage of using DSM is that the gradient of the en-\nergy function is not dependent on the normalization constant,\nwhich is hard to evaluate."}, {"title": "2.2. Energy Model in Multiple Dimensions", "content": "Our goal is to minimize the residual artifacts in the slab\nboundaries while combining slab profile weighted images,\nwhich occur in the slice direction. Noise-free training data\nin this context is rare. Hence we train the CNN denoiser on\naxial slices without slab correction. The learned denoiser is\nthen applied in the slices in the slab direction to remove noise\nwhile slab combination. The energy is computed along three\nspatial directions x, y, and z of the MRI volume, as follows:\n\u03b5(\u03c1) = $(\u03a3\u03b5 [C_x(\u03c1)] + \u03a3\u03b5 [C_y(\u03c1)] + \u03a3\u03b5 [C_z(\u03c1)])/3$ (5)\nHere Cx, Cy, Cz are slice extraction operators along the\nx, y, z directions, respectively. Because the extracted slices\nfor a specific direction do not overlap, we have \u2211 \u0421TCxp =\np, which is also true for the other directions. The energy gra-\ndient or score Ho(x) can be calculated using the chain rule or\nusing PyTorch's built-in autograd function."}, {"title": "2.3. MAP estimate using ADMM", "content": "By substituting (5) in (4), equation (3) will be as follows:\narg min min $|| Ap - y||^2 + \u03bb\u03b5(\u03c1)$ (6)\nTo solve (6) using ADMM, we start by defining an auxiliary\nvariables v, and rewrite the cost function of (6) using this\nauxiliary variables as:\narg min $|| Ap - y||^2 + \u03bb\u03b5(v)$ s.t.v = \u03c1 (7)\nThe augmented Lagrangian corresponding to the above con-\nstrained optimization problem is given by:\nL(p,v) = $||\u0391\u03c1-y||^2+\u03bb\u03b5(v) + \\frac{\u03b2}{2}||v-\u03c1||^2+ (\\gamma,v-p)$ (8)\nwhere y is the Lagrange multiplier and \u1e9e > 0. To solve (8),\neach variable is sequentially updated by solving a set of sub-\nproblems, during which the other variables are kept fixed:\n\u03c1\u03b7+1 = $\\frac{\u03b2}{2}$min $|| A(p)-y||+\\frac{\u03b2}{2}||p-(\\frac{vn+1}{\u03b2}+v^n) ||^2$ (9.1)\nvn+1 = arg min \u03bb\u03b5(v) + $||v-(\\frac{\u03c1\u03b7+1}{\u03b2}) ||^2$ (9.2)\n\u03b3\u03b7+1 = \u03b3\u03b7 + \u03b2 (vn+1 \u2013 \u03c1\u03b7+1) (9.3)\nWe solve (9.2) using steepest descent."}, {"title": "3. IMPLEMENTATION DETAILS", "content": "3.1. Dataset\nIn-vivo 3D-multislab diffusion MRI data was acquired with 8\nslabs to cover the whole brain. Each slab covers 20 mm with\n7 mm overlap. 10 diffusion weighted volumes and one non-\ndiffusion weighted volume were collected with the follow-\ning acquisition parameters: FOV(x-y): 210 mm, matrix size:\n210\u00d7210, echo time (TE) = 70ms, repetition time (TR)=2s,\nusing a 44-channel head coil. Other parameters include a par-\ntial Fourier of 0.7 and in-plane acceleration of 3. A 2D nav-\nigator echo was acquired during each TR, which was used\nin a phase-compensated iterative SENSE reconstruction[6].\nThe images generated from the SENSE reconstruction of the\n8 slabs were used for testing the proposed method."}, {"title": "3.2. Architecture and Training of Neural Network", "content": "Noting that for the energy and score calculation, complex\nimages represent as two-channel images (real and imaginary\nchannels), we model the energy Eo : Cm \u2192 R+ used in this\npaper as:\n$E_\\theta(\u03c1) = \\frac{1}{2}||\u03c1 \u2013 \u03c8_\u03b8(\u03c1)||^2$, (9)"}, {"title": null, "content": "where, as we mentioned earlier, & denotes the parameters of\nthe energy function, and \u03c8\u03bf(\u00b7) : Cm \u2192 Cm is a CNN net-\nwork. If We can be viewed as a denoiser, therefore, the energy\ncan be interpreted as the magnitude of noise in the image p.\nWe represent \u03c8\u03bf(\u03c1) using a deep DRUNet [7]. The four\ndownscaling and upscaling layers in DRUNet, which in-\nclude 64, 128, 256, and 512 channels, resemble a U-Net in\nconstruction. However, DRUNet differs from U-Net in that\neach downscaling and upscaling layer has four extra residual\nblocks. Between the 2\u00d72 transposed convolution upscaling\noperation and the 2\u00d72 strided convolution downscaling oper-\nation, each layer has a skip connection. Then, we pre-trained\nthe parameters of Ee(p) by selecting the standard deviations\nfrom a uniform distribution with a range of 0 to 0.1."}, {"title": "4. EXPERIMENTS AND RESULTS", "content": "To test the performance of the proposed method, we com-\npare it with the non-regularized PEN which is the baseline\nmethod without regularization. Also we compare our method\nwith the TV-regularized PEN which incorporates the well-\nknown Total Variation denoising to address artifacts. The TV-\nregularization was also implemented using the plug-and-play\nADMM and regularization was applied in the axial, coronal\nand sagittal planes."}, {"title": "5. CONCLUSION", "content": "In this study, we developed a regularized slab profile encoding\n(PEN) framework for three-dimensional diffusion-weighted"}, {"title": null, "content": "multi-slab MRI reconstruction, utilizing a Plug-and-Play\nADMM approach with MuSE regularization. Our approach\neffectively denoises the reconstructed images making it a\nmore robust option for high-resolution, SNR-efficient diffu-\nsion MRI applications. The residual slab boundary artifacts in\nthe regularized and non-regularized reconstructions indicates\nan imperfect slab profile in the data consistency term, which\ncan only be corrected by better design of RF pulses."}, {"title": "6. COMPLIANCE WITH ETHICAL STANDARDS", "content": "The data in this research study was acquired on a 3T GE Pre-\nmier MRI scanner from a normal volunteer at the University\nof Iowa (UI). This study was approved by the institutional re-\nview board (IRB) at UI, and informed written consent was\nobtained from the volunteer prior to scanning."}]}