{"title": "Analyzing Narrative Processing in Large Language Models (LLMs): Using GPT4 to test BERT", "authors": ["Patrick Krauss", "Jannik H\u00f6sch", "Claus Metzner", "Andreas Maier", "Peter Uhrig", "Achim Schilling"], "abstract": "The ability to transmit and receive complex information via language is unique to humans and is the basis of traditions, culture and versatile social interactions. Through the disruptive introduction of transformer based large language models (LLMs) humans are not the only entity to \"understand\" and produce language any more. In the present study, we have performed the first steps to use LLMs as a model to understand fundamental mechanisms of language processing in neural networks, in order to make predictions and generate hypotheses on how the human brain does language processing. Thus, we have used ChatGPT to generate seven different stylistic variations of ten different narratives (Aesop's fables). We used these stories as input for the open source LLM BERT and have analyzed the activation patterns of the hidden units of BERT using multi-dimensional scaling and cluster analysis. We found that the activation vectors of the hidden units cluster according to stylistic variations in earlier layers of BERT (1) than narrative content (4-5). Despite the fact that BERT consists of 12 identical building blocks that are stacked and trained on large text corpora, the different layers perform different tasks. This is a very useful model of the human brain, where self-similar structures, i.e. different areas of the cerebral cortex, can have different functions and are therefore well suited to processing language in a very efficient way. The proposed approach has the potential to open the black box of LLMs on the one hand, and might be a further step to unravel the neural processes underlying human language processing and cognition in general.", "sections": [{"title": "INTRODUCTION", "content": "What are the minimum requirements of a system that is able to understand and produce language, and what are the underlying mechanisms? This question is not just scientifically interesting but also crucial in order to build and understand artificial general intelligence (AGI) systems [1], [2]. Thus, the focus on language processing makes sense as language is the basis of any kind of traditions, culture, or science [3], [4]. Although some animal species such as toothed whales have sophisticated communication systems [5], [6], a complex language, which could be used to express any kind of idea is unique to the human species [7]. Thus, language is the ideal starting point when trying to understand the basis of general intelligence. Already in 1950, Alan Turing wondered in his seminal paper \"Can Machines think?\" [8] and invented an intelligence test for computers based on language skills which he originally called \"Imitation Game\", and which is nowadays known as the \"Turing-test\" [8]\u2013[10]. A simplified version of the Turing test proposes that a computer is intelligent, if it is able to pretend to be a human and fooling a real human examiner [10], [11]. Nevertheless, John Searle pointed out in 1980 that language processing is at most the basis of general intelligence but that fluent communication is not the same as real understanding. This insight he gained from a thought experiment called the \"Chinese room\", where he argued that fluent communication is possible by just looking up input messages and finding a matching output message. This procedure does not require any real understanding of the messages [12]. Nevertheless, language is the basis of any complex culture and intelligence in humans [13], [14]. Thus, a lot of effort is put in researching language processing.\nThe topic is approached from two sides. On the one hand, cognitive neuroscience takes advantage of the improving neuroimaging techniques, to investigate language processing in the human brain [15]. The improved measurement devices in combination with the computing power and storage space of modern computer enable us to apply new measurement paradigms. Thus, artificial language stimuli based on the repetitive presentation of single words or sentences [15] are replaced by the presentation of natural language resp. speech (see e.g. [16]\u2013[20]). Unfortunately, this data driven approach reaches its limits in explaining how language is processed in the human brain [21]. This fact is emphasized by the study of Jonas and Kording, who applied modern evaluation techniques used in cognitive neuroscience research with the purpose to explain the function of a simple microprocessor [22]. These experiments served as a cross-check of current neuroscience research. However, the authors showed that the methods and the approach were not sufficient to unravel the processing principles of the microprocessor. The conclusion that our current experimental paradigms and evaluation techniques are not well suited to understand a simple microprocessor, and thus are trivially also not well suited to investigate our brain, with its approx. 86 billion neurons [23], [24], suggests that we need a different approach to unravel the mechanisms of language processing in the brain.\nUsing artificial neural networks such as LLMs as model systems is very promising, because LLMs are already capable of performing complex cognitive tasks, and have the decisive advantage that their internal states and parameters can be read out with arbitrary precision at any time which is impossible for living brains. In a second step, these neural networks can be made more and more biologically plausible (see e.g. [24]\u2013[27]), i.e. brain constrained [28]. This approach is called Cognitive Computational Neuroscience (CCN, [29]) and is applied in different areas of cognitive science (see e.g. [21], [30]\u2013[33]). Using LLMs as model systems to understand the principles of language processing has not just the advantage that one might learn something about the human brain but the research strand might also help to partly open the black box of machine learning and artificial intelligence [34].\nIn the present study, we have used the LLM BERT (Bidi-rectional Encoder Representations from Transformers) [35] as model system and used a second LLM (ChatGPT, [36]) to generate suitable input data. BERT is a large language model developed and made open source by Google AI in 2018 and is based on the transformer architecture developed by Vaswani et al. one year earlier [37]. However, BERT consists only of the encoder part of the transformer network proposed by Vaswani and coworkers [35], [37]. In contrast to language models such as ELMO [38], BERT is not a feature based approach but a fine-tuning approach, which means that BERT is trained in two steps: the pre-training step and the fine-tuning step. In the pre-training phase BERT is trained on huge unlabeled text corpora on the masked language task - where BERT has to predict ran-domly masked tokens- and the next sentence prediction tasks -where BERT must predict the following sentence [35]. In the fine tuning step an additional layer is trained supervisedly on task specific labeled data [35]. As input BERT gets a 512-dimensional vector (number of tokens) of 768-dimensional \"WordPiece\" embedding vectors [39] representing the input words [35]. The first token fed to the network is always a so called CLS (class) token, which can be regarded as storage unit of the context information [35]. The BERT model itself consists of 12 stacked transformer (encoder) blocks (multi-attention head + dense layer) and each multi-attention head consists of 12 attention heads (for further information see [35]). The whole model sums up to 110 Million trainable pa-rameters [35]. In the present study, we investigated the hidden activations of the BERT units in order to draw conclusions on how and where BERT processes different writing styles as well as different narratives (semantic content). Thus, we extracted the hidden activations of all 12 transformer blocks and projected them using multi-dimensional scaling (MDS see also [40]\u2013[42]). Furthermore, we quantified the degree of separation (clustering) of the neuron activations using the label-free EDD-value (entropy of distance distribution, [43]) and the generalized discrimination value (GDV, [40], [43]\u2013[47]). Surprisingly, we found that in the first transformer block, the neural activations cluster according to writing styles. In the later blocks (4-5) the clustering reflects narrative content. This finding provides evidence that there is some specialization in the neural network, which is not an intrinsic property of the architecture. We propose these findings as a starting point to further investigate language processing in LLMs in order to compare these findings to neural data on the one hand (as proposed by [29]) and, on the other hand to open the black box of LLMs in order to generate explainable AI [34]."}, {"title": "METHODS", "content": "As the number of input tokens of BERT is limited to 512, we have used short fables (Aesop's Fables: For the Instruction and Improvement of Youth, [48]) as input tokens for BERT with a maximum of approx. 400 words. The original fables we used are shown in the first column of Table I. To generate stylistic variations of these fables we used the ChatGPT chatbot interface with the GPT4 backend [49]. The procedure of generating 6 different stylistic variations (7 including the original story) of the fables was achieved in a three step process (see Table I second column):\n1) Initial Prompt: First, the initial prompt containing the information on the general task is send to GPT4: \"Hello I have a fable that I'd like to present in different narrative styles. My request is for you to creatively rephrase the fable into each of these styles. Please maintain the core message of the fable in each variation but feel free to be creative with the settings and styles.\"\n2) After that, the fable is presented to GPT4.\n3) The third prompt contains the information on the writing style GPT4 should use to rephrase the fable: \"Rephrase the fable...\" (Table I third column). The rephrased fable is double-checked to be sure that the fable does fulfill all needed requirements (length, content etc.)."}, {"title": "A. Computational resources and programming libraries", "content": "All simulations were run on a standard personal computer. The evaluation software was based on Python 3.10 [50]. For matrix operations the numpy-library [51] was used and data visualization was done using MatplotLib [52] and the pylustrator library [53]. The dimensionality reduction through multi-dimensional scaling (MDS) and the principal component analysis (PCA) were done using the scikit learn library [54], [55]."}, {"title": "Analysis of hidden activations and data visualization", "content": "The created variations are presented to the non-fine-tuned base version of BERT (12 transformer blocks, 12 attention heads each, 110 Million parameters, [35]), which has already been evaluated in earlier studies (see [56]). Thus, the fables were transformed to input token sequences using the BERT tokenizer [35], [39] and fed including the additional CLS token to BERT. In this study, we evaluated exclusively the CLS token across the different LLM attention layers. To access the neuron activations (values of CLS token) across the 12 transformer blocks we used the transformers library [57]."}, {"title": "RESULTS", "content": "The variance of the CLS tokens for different narratives and writing styles increases as a function of the transformer blocks (i.e. higher/later transformer blocks correspond to higher vari-ance of CLS tokens), but no clear cluster of CLS tokens emerge. This is emphasized by the fact that the label-free EDD value [43] is near 1 (> 0.847) for all transformer blocks (block 1-12, see Fig. 1, input data used for EDD function is shown in Fig. 2 and 3, EDD value is independent from pre-defined labels). Nevertheless, the fact that the EDD value is slightly smaller for early transformer blocks (1-4) demonstrates that the CLS tokens are forming weak, partial clusters in early transformer blocks. However, for later transformer blocks the EDD value and the average Euclidean distance between CLS tokens increase, which means that the CLS tokens are distributed more uniformly over the space of all possible CLS tokens. That does not mean that the CLS tokens are not ordered according to certain pre-defined labels such as content or writing style of the fables.\nIndeed, the CLS tokens cluster according to the semantic content of the stories (10 different narratives in Table I column 1). Thus, the separation of the CLS tokens according to the semantic content (see Fig. 2) is best after transformer blocks 4 and 5, indicated by a minimum of the layer-dependent GDV values (Fig. 4 d). Therefore, one could assume a central role of these transformer blocks in processing the plot of the input text. Indeed, the GDV decreases again in blocks 10-12, which might be caused by the fact that the last blocks merge the information on style and content.\nIn contrast to the findings on semantics shown above, the clustering of the CLS token according to the 7 different writing styles (see Table I, for CLS projections see fig 3) is significantly different. The minimum GDV value, which refers to the best clustering, is measured directly after the first transformer block (see Fig. 4 h). Starting from block 1 the GDV increases until block 7 indicating maximum class separation or clustering, and then decreases again (see Fig. 4 d).\nThe fact that semantic content and the writing style are represented in different transformer blocks suggest that cer-tain transformer blocks are specialized on processing certain properties of language. However, in the last attention blocks of BERT, the CLS tokens cluster according to content as well as style, so that in both cases the GDV decreases again in the last transformer blocks (see Fig. 4 d, h)."}, {"title": "DISCUSSION", "content": "In the present study, we have shown the specialization of different transformer blocks of BERT [35] on certain properties of natural language. We have used ChatGPT [49] to generate 7 different stylistic variations of 10 different fables [48]. We have used these 70 narratives (Table I) to investigate the BERT-generated representations of these narratives in the context of semantic content as well as writing style. We have found that writing style is processed in earlier transformer blocks (block: 1) than the semantic content (block: 4-5), which means that the transformer blocks of BERT are specialized to perform certain tasks of language processing. Additionally, we have shown that the clustering of the CLS tokens according to style and content gets better for the last transformer blocks. The fact that the GDV values increase as a function of the transformer blocks starting from a local minimum value (4-5 for semantics, 1 for style) but decreases again for the last blocks is an interesting finding, which has to be investigated in further studies. Nevertheless, these findings might fit to previous findings by Liu and co-workers ( [58], explained in detail below).\nTo the best of our knowledge, this study is the first to use a LLM (GPT4) to systematically generate stylistic variations of narratives in order to unravel the mechanisms in the hidden transformer blocks of another LLM (BERT). The relevance of investigating the function of LLMs in order to improve them on the one hand and to use them as a model for the brain on the other hand (see also [29], [59], [60]) is emphasized by the fact that in recent years many high-rank studies occurred trying to unravel the 'black box' of different LLMs (see e.g. [58], [61]\u2013[66]). In these studies, the hidden representations of different LLMs and neural machine translation models (NMT) were analyzed regarding semantic [58], [63]\u2013[65] and syntactic processing [62]. However, in most cases so called \"probes\" -neural networks specifically trained on decoding information in hidden units of LLMs [67], [68] were used to quantify the information content (semantic and syntactic) of the hidden representations [61], [62]. Thus, it is sometimes difficult to disentangle the true representations and the content added through the trained probes. In our study, we used exclusively well-defined and established statistical measures such as the generalized discrimination value (GDV, [40]) to investigate information processing in the hidden transformer blocks, a fact that limits the comparability between ours and other recent studies. Nevertheless, Liu et al. showed that in contrast to recurrent neural networks in transformer based language models (such as BERT) the transferability of contextual word representations, i.e. the possibility to use the representations of pre-trained LLMs for many different downstream tasks [69] is best in the middle transformer blocks [58]. This finding fits to our finding that the GDV for narrative content has a minimum in the middle layers of BERT (Fig. 4 d), which means that there is the maximum class separation between the BERT-representations of the different narratives with different semantic content [58]. The major advantage of our method is that for the calculation of the GDV value the network does not have to be trained on a certain downstream task."}, {"title": "Conclusion", "content": "In summary, we showed an innovative approach to analyzing the processing principles of LLMs using input narratives from another LLM and calculating the GDV for semantic and stylistic differences in certain narratives. Our method is applicable to all pre-trained language models and does not rely on specialized downstream tasks. We hope that the our novel approach of systematically varying narratives using LLMs is useful for further attempts to open the black box of LLMs and to compare there internal mechanisms and principles to those of the human brain, i.e. to follow the route of the cognitive computational neuroscience approach (CCN, [29])."}]}