{"title": "Determination of galaxy photometric redshifts using Conditional Generative Adversarial Networks (CGANs)", "authors": ["M. Garcia-Fernandez1a"], "abstract": "Accurate and reliable photometric redshifts determination is one of the key aspects for wide-field photometric surveys. Determination of photometric redshift for galaxies, has been traditionally solved by use of machine-learning and artificial intelligence techniques trained on a calibration sample of galaxies, where both photometry and spectrometry are determined. On this paper, we present a new algorithmic approach for determining photometric redshifts of galaxies using Conditional Generative Adversarial Networks (CGANs). Proposed CGAN implementation, approaches photometric redshift determination as a probabilistic regression, where instead of determining a single value for the estimated redshift of the galaxy, a full probability density is computed. The methodology proposed, is tested with data from Dark Energy Survey (DES) Y1 data and compared with other existing algorithm such as a Random Forest regressor.", "sections": [{"title": "1. Introduction", "content": "Wide-field photometric surveys have been a major source for experimental results for Observational Cosmology. Among many of the present and future photometric surveys we can find: DES\u00b2, LSST\u00b3, PAU4, J-PAS5 and Euclid6.\nOne of the key aspects of wide-fied photometric surveys is the reliable determination of the redshift of the galaxies. At photometric surveys, the redshift of galaxy spectra is inferred by measuring the brightness of galaxies at broad-band filters instead of determining the Doppler shift of their spectra with a high-resolution spectrometer.\nThe usual approach for translating from the brightness measured at the broad-band filters to a redshift that is the closest as possible to the potential actual spectroscopic redshift, the use of machine-learning and artificial intelligence techniques are used. These techniques, make use of a calibration sample of galaxies with known both the photometry and the high-resolution spectra. This calibration sample, is used by the machine-learning algorithms as a source for indenfying and discovering patterns relating the brightness at the different broad-band filters with the spectroscopic redshift.\nPrevious machine-learning algorithms for photometric redshift determination have included: template-fitting (Schaap and van de Weygaert, 2000; Bolzonella et al., 2011; Ben\u00edtez, 2011; Arnouts and Ilbert, 2011; Laur et al., 2022), neural networks (Collister and Lahav, 2004; Sadeh et al., 2016; Mahmud Pathi et al., 2024; Hoyle, 2016; Chunduri and Mahesh, 2023; Carrasco Kind and Brunner, 2013; Almosallam et al., 2016; Cavuoti et al., 2017), boosted decision trees (Gerdes et al., 2010)-, convolutional neural networks (D'Isanto and Polsterer, 2018; Schuldt et al., 2021), bayesian neural networks (Lima et al., 2022), random forest (Lu et al., 2023), recurrent neural networs (Luo et al., 2024) and nearest neighbours (Graham et al., 2018). A good systematic review on the different types of photometric redshift algorithms can be found at S\u00e1nchez et al. (2014); Salvato et al. (2019) and Newman and Gruen (2022).\nAs it can be identified at literature review, the most widely used machine-learning technique at photometric redshift estimation are neural networks at their many flavours (dense, recurrent and convolutional), with a strong presence of feed-forward neural networks composed by dense layers. Feed-forward neural networks composed by dense layers are a great computational tech-"}, {"title": "2. Methodology", "content": "Let x be a sample of photometric data from magnitudes measured at broad-band pass filters for the i-th galaxy of some data and yi its corresponding known spectroscopic redshift, such that {(xi, Yi)} train constitutes the data training set. Let zi be a vector of randomly-generated numbers7, associated to the i \u2013 th galaxy.\nThe generator network G constitutes a function such that \u0177\u2081 = G(zi|xi; \u03b8G), where \u0177 is the estimated photometric redshift for the set of magnitudes xi and Og are the weights defining the generator neural network. On the other side, the discriminator network D provides a function such that di = D(\u0177i; 0D) -with d\u2081 \u2208 [0, 1]- is a classifier that identifies if \u0177\u2081 is a real data from the training sample or a synthetic-generated data produced by the generator network and Op are the weights defining the discriminator network.\nThe process of training a GAN network constitutes a min-max problem such that mine, maxe\u0189 V (D, G). The choice of the function V(D,G) is a vast problem within the field of Computer Science. As demonstrated by Nowozin et al. (2016), any GAN can can be interpreted as a special type of variational divergence estimation. Thus, the function V (G, D) can be placed on the most generic formulation as\nV(D, G) = Ex~pa(x) [Ey~pa(y)[gf(D(y|x))] + Ezpz(z) [-f*(gf(D(G(z|x))))]],\nTaking this into account, the loss function to be minimized for the discriminator network is given by\nLD(OD) = -1/Nbatch \u03a3 [9f(D(Yixi; OD) - f*(gf(D(G(zi|xi); \u03b8G)|xi;0)]"}, {"title": "3. Data Analysis", "content": "Proposed CGAN was tested at DES-Y1 data spectroscopy-matched with SDSS galaxies. Data was taken from the public data releases DR1 (Abbott et al., 2018; Drlica-Wagner et al., 2018) from The Dark Energy Survey Collaboration that are available at the NCSA repository.\nCode for the CGAN was implemented under Python using PyTorch10 (Paszke et al., 2019), whereas code for the Random Forest Regressor was implemented using Scikit-Learn11 (Pedregosa et al., 2011). Full code of this analysis can be found at author's GitHub repository12.\nFrom the DES-Y1 proposed sample, we take the Stripe-82 subset of galaxies with matched spectroscopic redshift from SDSS. For consideration of the sample, we restrict ourselves to the galaxies with spectroscopic redshift"}, {"title": "4. Conclusions", "content": "On this paper, it was presented a new machine-learning technique for photometric redshift estimation using Conditional Generative Adversarial Networks (CGANs), was presented. Propsed CGAN techique was tested using Dark Energy Survey Y1 data and compared with the classic machine-learning technique the Random Forest Regressor.\nResults obtained at CGAN approach, exhibit a similar performance for determining the mean photometric redshift as the Random Forest Classifier. Whereas Random Forest Regressor can only provide a the expected redshift for each individual galaxy, the proposed CGAN approach is able to provide a full probability density function. This additional capability of the CGAN, allows for a better control for the impact of thick tails of the distribution, making this type of photometric redshift algorithmic approach more suitable for cosmological probes that are specially sensitive to thick tails at photometric redshifts -such as number-counts magnification-.\nIn addition to the value added, CGAN demonstrates a superior computing performance over Random Forest Regressor, as modern Deep Learning frameworks -such as PyTorch-, have a strong parallelization optimization for the determination of the weights of the tensors defining the neural networks, whereas algorithms such as the Random Forest Regressor are not parallelization. This, makes the CGAN approach superior from the computing performance point of view, which is specially suitable for large Cosmology surveys."}]}