{"title": "IceCloudNet: 3D reconstruction of cloud ice from Meteosat SEVIRI", "authors": ["Kai Jeggle", "Mikolaj Czerkawski", "Federico Serva", "Bertrand Le Saux", "David Neubauer", "Ulrike Lohmann"], "abstract": "IceCloudNet is a novel method based on machine learning able to predict high- quality vertically resolved cloud ice water contents (IWC) and ice crystal number concentrations (Nice). The predictions come at the spatio-temporal coverage and resolution of geostationary satellite observations (SEVIRI) and the vertical resolution of active satellite retrievals (DARDAR). IceCloudNet consists of a ConvNeXt-based U-Net and a 3D PatchGAN discriminator model and is trained by predicting DARDAR profiles from co-located SEVIRI images. Despite the sparse availability of DARDAR data due to its narrow overpass, IceCloudNet is able to predict cloud occurrence, spatial structure, and microphysical properties with high precision. The model has been applied to ten years of SEVIRI data, producing a dataset of vertically resolved IWC and Nice of clouds containing ice with a 3 km\u00d73 km\u00d7240 m\u00d715 minute resolution in a spatial domain of 30\u00b0W to 30\u00b0E and 30\u00b0S to 30\u00b0N. The produced dataset increases the availability of vertical cloud profiles, for the period when DARDAR is available, by more than six orders of magnitude and moreover, IceCloudNet is able to produce vertical cloud profiles beyond the lifetime of the recently ended satellite missions underlying DARDAR.", "sections": [{"title": "Introduction", "content": "Clouds containing ice in the tropics cover over 20 % of Earth's surface at any moment (Heymsfield et al. 2017). These clouds can be categorised into two temperature-based regimes: cirrus clouds occur at temperatures below -38\u00b0C containing only ice crystals and mixed-phase clouds that occur between 0\u00b0C and -38\u00b0C and may simultaneously contain supercooled cloud droplets and ice crystals (Lohmann et al. 2016). Mixed-phase clouds are mainly formed by mid-level or deep convection in the tropics. In the case of deep convection, cirrus clouds can form at the top of convective towers with the typical anvil shape. Cirrus clouds can also form directly from the vapor phase at high altitudes and temperatures below -38\u00b0C (in situ cirrus), e.g. caused by gravity waves (Gasparini et al. 2023). All clouds exert a radiative effect by modulating the incoming solar and outgoing terrestrial radiation (Liou 1986). The radiative effect is driven by the microphysical properties of the cloud and its macrophysical structure. Cirrus clouds are typically thinner and have on average a warming effect (Heymsfield et al. 2017), while mixed-phase clouds are thicker and usually exert a cooling effect (L'Ecuyer et al. 2019). Due to their radiative effect, their impact on global circulation and regional precipitation, tropical clouds containing ice are of a large climatological significance. Mesoscale convective systems (MCSs) for instance, which consist of multiple convective cores and corresponding anvil clouds, are responsible for the majority of precipitation in the tropics (Feng et al. 2021). Despite the climatological significance of cirrus and mixed-phase clouds in the tropics, there are gaps in our understanding of cloud formation and evolution, which lead to large uncertainties in climate projections Forster et al. (2021). The cloud response of anvils in a warming climate, for instance, represents the largest uncertainty of all cloud feedbacks (Sherwood et al. 2020; Forster et al. 2021) and has recently gained momentum in the research community (McKim et al. 2024; Sokol et al. 2024). Cloud ice properties are projected to change in a warming climate and may amplify or dampen global warming (Lohmann and Neubauer 2018). For a comprehensive review of tropical cirrus clouds we refer to Gasparini et al. (2023). A main challenge of studying clouds are processes that act on a wide range of spatio-temporal scales. The evolution of anvil cirrus, for instance, depends on mesoscale and cloud-scale circulations driven by radiative and latent heatings, which in turn depend on microphysical properties. As a result, anvil cirrus can exert a cooling or warming effect, depending on their life cycle. To improve process understanding, which is key to reduce uncertainties, it is necessary to exert a perspective on formation and evolution when studying clouds (Heymsfield et al. 2017; Gasparini et al. 2023) in contrast to studying individual temporal snapshots of clouds, which is usually done in observational studies. To study cloud formation and development holistically, a three-dimensional spatial view is required to follow the structural cloud evolution, in addition to the evolutionary perspective.\nKey microphysical properties to characterize cirrus and mixed-phase clouds are ice water content (IWC) and ice crystal number concentration (Nice), which denote the ice mass and ice crystal number concentration per unit volume of air respectively. Given IWC and Nice also the effective particle radius of ice crystals can be calculated. IWC and effective particle radius are mainly determining the radiative properties of a cloud. Nice on the other hand can provide insight into aerosol-cirrus interactions (Gryspeerdt et al. 2018b; Mitchell et al. 2018) and ice nucleation pathways (Gryspeerdt et al. 2018a).\nSatellite-based remote sensing retrievals are mainly used for studying clouds, next to modelling and in-situ studies. We focus in this study on two of the main types of satellite retrievals used for studying clouds. On the one hand, multiple studies (e.g. Kr\u00e4mer et al. 2016; Sourdeval et al. 2020) have used polar-orbiting active satellite instruments like CALIPSO\u2019s lidar (Winker et al. 2009) and CloudSat's radar (Stephens et al. 2002) to analyze microphysical properties of ice clouds. In this work, we will use the DARDAR (raDAR/liDAR) (Delano\u00eb and Hogan 2008; Cazenave et al. 2019) dataset which combines the CALIPSO and CloudSat instruments to retrieve cloud profiles of IWC and in its extension, DARDAR-Nice, also Nice (Sourdeval et al. 2018). On the other hand, passive geostationary satellite instruments such as the Spinning Enhanced Visible and Infrared Imager (SEVIRI) onboard the Meteosat satellites (Aminou 2002) enable a perspective on the temporal evolution of clouds. Such instruments retrieve a top-down 2D view of Earth's surface every 15 minutes by measuring the reflected solar radiation and emitted longwave radiation and hence enable a long-term view on clouds with a high spatio-temporal resolution and coverage.\nMachine learning (ML) has evolved has a powerful tool to extract information and knowledge from earth observation data (Tuia et al. 2024). Previous studies have employed ML models of various complexity to predict actively sensed retrievals from geostationary satellite data. Kox et al. (2014) have used a simple fully connected neural network and Amell et al. (2022) a convolutional neural network (CNN) to predict ice water path (IWP), which is the vertically integrated IWC, from SEVIRI. Amell et al. (2023) extended the approach to also predict IWC from a single infrared (IR) channel globally by combining multiple geostationary satellites with a 1 km vertical resolution. Leinonen et al. (2019) applied a generative adversarial network (GAN) based approach to reconstruct vertical cloud profiles from polar-orbiting satellite instruments (MODIS)."}, {"title": "Data", "content": "The dataset utilized for training and validating IceCloudNet comprises six years (2007-2012) of multi-spectral images from Meteosat Second Generation (MSG) SEVIRI and vertically-resolved DARDAR IWC and Nice swaths, where the former is used as input for IceCloudNet and the latter as prediction targets.\nAll available SEVIRI channels in the visible and IR spectrum are used as input for IceCloudNet. The three visible channels are dependent on the scattering of solar radiation and are hence only available for daytime predictions. The eight IR channels are sensitive to thermal emission of the observed atmosphere and surface and are thus available during day and night. The fact that different channels are sensitive to different penetration depths (visible) and emission levels (IR) motivates the use of all available channels as input to IceCloudNet.\nFor the IWC retrievals, the latest version (v3) of DARDAR is employed (Cazenave et al. 2019), and for Nice, its extension DARDAR-Nice (Sourdeval et al. 2018) in its second version is utilized. Throughout this study, we use Nice with effective radii > 5 \u00b5m. Both IWC and Nice have been thoroughly validated and, despite the intrinsic uncertainties of satellite retrievals, show good agreement with in-situ measurements (Kr\u00e4mer et al. 2020; Cazenave et al. 2019; Sourdeval et al. 2018). DARDAR has a resolution along the satellite overpass of 1.2 km at the surface with an observation every 0.16 seconds. For every DARDAR overpass, we identify and co-locate the matching SEVIRI image by calculating the minimum difference between DARDAR and SEVIRI observation times. Given the 15-minute temporal resolution of SEVIRI and the actual observation time being 12.5 minutes, the maximum difference between co-located SEVIRI and DARDAR observations is 6.25 minutes. While this timescale is tolerable for most cloud processes, it introduces a bias in our co-located data. Once co-located, the DARDAR data is resampled and averaged to the 3 km x 3 km native resolution of SEVIRI. Due to the temporal sampling every 15 minutes and the long revisiting times of DARDAR, any SEVIRI image contains at most one DARDAR overpass, resulting in a minor fraction of a given SEVIRI image that can be co-located with DARDAR data. Note that many SEVIRI images do not contain any DARDAR overpass.\nWe chose a domain from 30\u00b0W to 30\u00b0E and 30\u00b0S to 30\u00b0N, resulting in 1984\u00d71792 pixels per SEVIRI image in its native resolution. The reason for choosing this domain is two-fold: on the one hand, the resolution of SEVIRI is still high, even at the edges of the domain, given its proximity to the nadir viewpoint with an average horizontal resolution of 10.4 km\u00b2; on the other hand, the tropics are an interesting area given the high uncertainties associated with the development of convective clouds and anvil cirrus (Gasparini et al. 2023). In the vertical dimension, we limit the dataset to altitudes between 4000 m and 17000 m resulting in 55 equally spaced vertical levels at a resolution of 240 m. This covers the whole range of cloud ice occurrence for the given latitudes.\nFor training and validating the neural network, we create patches with DARDAR overpasses at its center with a size of 256\u00d7256 pixels, which corresponds to 768 km x 768 km, resulting in 89,229 patches for the years 2007-2012. This patch size strikes a balance between capturing cloud scenes from small to mesoscale systems in the same patch while still being computationally feasible. Formally, our dataset is described as:\nHandling sunglint is a common challenge for satellite retrievals, as it can introduce artifacts over open water in the visible channels. However, due to the small viewing angles of SEVIRI in the region of interest, only limited areas are affected by sunglint. Furthermore, since ML models have demonstrated the ability to distinguish between clouds and sunglint based on their differing spatial patterns, we do not explicitly address sunglint in this study (Schr\u00f6der et al. 2002)."}, {"title": "Training and test datasets", "content": "\u2022 $X \\in \\mathbb{R}^{89229 \\times 256 \\times 256 \\times 11}$ for the eight IR and three visible channels of SEVIRI.\n\u2022 $X_{meta} \\in \\mathbb{Z}^{89229 \\times 5}$ for latitude, longitude, month, the binary day/night mask, and the land/water mask (coast, sea, land).\n\u2022 $Y_{masked} \\in \\mathbb{R}^{89229 \\times 256 \\times 256 \\times 55 \\times 2}$ for IWC and Nice DARDAR retrievals. Note, that while being on a 256x256 grid, only a small subset of the grid points contain data, i.e. along the DARDAR overpass, which is represented as the variable M.\n\u2022 $M = \\mathbb{Z}^{89229 \\times 256x256 \\times 1}$ for the binary overpass mask indicating the location of the satellite overpass."}, {"title": "Inference dataset", "content": "Once trained and validated on the co-located SEVIRI and DARDAR data that is described in the previous section, IceCloudNet is able to predict vertical cloud profiles and their corresponding IWC and Nice properties for all available SEVIRI observations in the domain that the model was trained on, i.e. independent of the availability of DARDAR overpasses. Complementing this paper are IceCloudNet predictions for IWC and Nice for the years 2007 - 2017 on the native SEVIRI horizontal resolution, 240 m vertical resolution, and 15-minute temporal resolution for the domain from 30\u00b0W to 30\u00b0E and 30\u00b0S to 30\u00b0N (https://www.wdc-climate.de/ui/entry? acronym=IceCloudNet_3Drecon). The trained IceCloudNet model can be used to create custom predictions outside this time range as well. The predictions are made by first splitting a SEVIRI image into quadratic patches of 256\u00d7256 pixel, followed by predicting the vertical profiles, and in the last step stitching the patches back together to the original image. The produced dataset increases the availability of vertical cloud profiles for years where DARDAR data are available by a factor of 1.8 \u00d7 106 and especially enhances the ability to study the temporal evolution of clouds by reducing the revisit time of 16 days by DARDAR to 15 minutes. The DARDAR data set is now discontinued, since the underlying satellite missions are not operational anymore and it also contains large gaps, caused by the CloudSat battery anomaly. For these periods, IceCloudNet enables an unprecedented opportunity to obtain vertical cloud profiles containing information about IWC and Nice from geostationary satellite data."}, {"title": "Methodology", "content": ""}, {"title": "Problem setting", "content": "The outlined task can be formally described as learning a mapping $f : \\mathcal{X} = \\mathbb{R}^{256 \\times 256 \\times 11} \\rightarrow \\mathcal{Y} = \\mathbb{R}^{256 \\times 256 \\times 55 \\times 2}$, where $x \\in \\mathcal{X}$ represents SEVIRI channels and $y \\in \\mathcal{Y}$ the IWC and $N_{ice}$ of clouds containing ice. Note that at training time, a prediction $\\hat{y} \\in \\mathcal{Y}$ is masked to a narrow swath $\\hat{y}_{masked}$ using the corresponding overpass mask $m \\in \\mathcal{M}$\n$\\hat{y}_{masked} = m \\odot \\hat{y}$\nand the model is optimized on the masked data only. Despite the high level of sparsity in the ground truth data, IceCloudNet is capable of learning to translate SEVIRI input into vertical cloud profile across the full spatial coverage from only partial observations of the output."}, {"title": "IceCloudNet architecture", "content": "The IceCloudNet model architecture consists of three main building blocks: A meta-data embed- der $\\mathcal{E}$ that encodes static information such as location and temporal information (1), a ConvNeXt-based U-Net $\\mathcal{U}$ which takes SEVIRI patches as input and generates three-dimensional cubes of IWC and $N_{ice}$ via two prediction heads (2), and a 3D-CNN-based discriminator $\\mathcal{D}$ model acting as a learned similarity measure aimed at reducing the commonly observed blurring effect of models trained on pixel-based losses and thus leading to more accurate predictions (3). IceCloudNet architecture and the losses used to train it are visualized in Fig. 3."}, {"title": "META DATA EMBEDDING", "content": "Cloud properties are subject to diurnal and seasonal cycles, that may depend on the location and Earth's surface type. Thus, we use a meta-data embedder $\\mathcal{E}$ that conditions predictions on the static information $x_{meta}$ for each patch."}, {"title": "CONVNEXT U-NET", "content": "The backbone of IceCloudNet follows a U-Net (Ronneberger et al. 2015) topology (encoder- decoder architecture with additional skip connections at different downsampling levels), similar to the models used in recent work on denoising diffusion models (Bansal et al. 2023; Ho et al. 2020a). More precisely, the exact topology is derived from the one used in the seminal denoising diffusion probabilistic models (DDPM) paper (Ho et al. 2020a), and, like in the implementation of cold diffusion (Bansal et al. 2023), using ConvNeXt blocks (Liu et al. 2022), which have been shown to outperform traditional ResNet blocks (He et al. 2015). ConvNeXt blocks use a larger kernel size in the first layer, increase the number of hidden channels considerably, and replace all rectified linear unit (ReLU) activations with a single Gaussian error linear unit (GELU) placed before the last layer. Each upsampling and downsampling module consists of 2 ConvNeXt blocks, followed by self-attention.\nThe main U-Net backbone is hence used to model the transformation function $\\mathcal{U}$ from the input SEVIRI channels $x$, conditioned on $x_{meta}$, to the target $y$ related to the cloud ice properties of interest:"}, {"title": null, "content": "$\\hat{y} = \\mathcal{U}(x, \\mathcal{E} (x_{meta}))$\nThe final 3D cloud profile predictions $\\hat{y}$ for IWC and $N_{ice}$ are derived via two identical prediction heads, each consisting of a single ConvNeXt block followed by a Conv2d layer with kernel size 1 and a ReLU activation (which forces the predicted output to be non-negative, as is desired for these physical properties). The 3D output is achieved by treating the channel dimension of the final Conv2d as the vertical dimension.\nThe experimentation process involved tests with 3D convolutions in the decoding arm of the U-Net, but superior results were achieved with the described approach at a lower computational cost. We use the mean absolute error ($l_1$) as a metric to assess the similarity between $\\hat{y}_{masked}$ and $y_{masked}$ during training, resulting in the following regression loss $\\mathcal{L}_R$:\n$\\mathcal{L}_R = \\mathcal{L}_{Nice} + \\mathcal{L}_{IWC} = l_1 \\left(m \\odot \\hat{y}^{IWC}, m \\odot y^{IWC}\\right) + l_1 \\left(m \\odot \\hat{y}^{Nice}, m \\odot y^{Nice}\\right)$\nWhile $l_1$ produces less blurring compared to using a root mean squared error ($l_2$), it is widely acknowledged that pixel-based losses, especially for CNN-based architectures, produce blurry outputs (Larsen et al. 2016), which motivates the extension of the objective to include an adversarial term as described below."}, {"title": "DISCRIMINATOR", "content": "Apart from the $l_1$ objective, we incorporate an adversarial training procedure with a patch-based discriminator $\\mathcal{D}$ (Isola et al. 2018) that is tasked to distinguish real cloud profiles (DARDAR) from reconstructed cloud profiles (U-Net predictions). The discriminator model acts as a learned metric that evaluates the similarity between predictions and reference data. The discriminator $\\mathcal{D}$ employed here is based on a PatchGAN (Isola et al. 2018) architecture, expanded to 3D convolutions and is conditioned on SEVIRI images. This idea is inspired by VAE-GAN (Larsen et al. 2016) where a variational auto encoder (VAE) functioning as an image generator produces images of higher quality when trained in an adversarial fashion. A similar approach was applied in a 3D setting by Buhmann et al. (2021) to simulate sparse particle showers.\nThe discriminator model $\\mathcal{D}$ is optimized with a Wasserstein loss (Arjovsky et al. 2017) where\n$\\mathcal{L}_D = \\mathcal{D}(x, m \\odot \\hat{y}) \u2013 \\mathcal{D}(x, m \\odot y)$\nis the minimisation objective for $\\mathcal{D}$ during training and the main model is optimized with the loss of $\\mathcal{L}_G$ (an extended version of the regression loss $\\mathcal{L}_R$):\n$\\mathcal{L}_G = (\\mathcal{L}_{Nice} + \\mathcal{L}_{IWC}) \u2013 \\lambda \\mathcal{D}(x, m \\odot \\hat{y})$\nWe follow the adaptive weighting approach used in Esser et al. (2021) to dynamically adjust the discriminator weight $\\lambda$. IceCloudNet is trained end-to-end where $\\mathcal{U}$ minimizes $\\mathcal{L}_G$ and $\\mathcal{D}$ minimises $\\mathcal{L}_D$. To create 3D cloud profiles during inference, only $\\mathcal{E}$ and $\\mathcal{U}$ are needed:\n$\\hat{y} = \\mathcal{U}(x, \\mathcal{E} (x_{meta}))$"}, {"title": "Experimental setup", "content": "Data for the year 2010 is used as an independent test set. The remaining years are used for training, where 10 % of patches are used as validation data for evaluating architectural choices and hyperparameters. In order to prevent spatiotemporal autocorrelation in training and validation splits, data from the same day will be assigned to only one split. Patches without any cloud ice in the DARDAR overpass are not used for training along with patches containing missing SEVIRI data. At test time, all patches are evaluated.\nSince the target variables span multiple orders of magnitude, they are logarithmically ($log(\\epsilon+x)$, with $\\epsilon$ = 1) transformed. Before the logarithmic transformation IWC values are scaled by 107 and Nice by 10-2. SEVIRI channels are normalized by their mean and standard deviation calculated on the training dataset. SEVIRI's visible channels are only available during the day, they are hence masked for nighttime predictions.\nWe apply a random number of 90\u00b0 rotations (with uniform probability) for data augmentation and train IceCloudNet for 100 epochs and batch size 64 using the Adam optimizer and learning rate of 10-6. For regularization stochastic depth dropout (Huang et al. 2016) with a dropout probability of 25 % is applied.\nDue to the size of the network and dataset, a full-scale hyperparameter search for the model architecture is not computationally feasible. IceCloudNet consists of 25.1 million parameters in total, of which 15 million are for the U-Net, 11 million for the PatchGAN discriminator and 0.1 million for the positional embedding. For each component, an experiment with a decreased and increased number of parameters was conducted. The chosen setup outperformed the downsized model and is on-par with the larger model."}, {"title": "Results and Evaluation", "content": "In this section, IceCloudNet is thoroughly evaluated and the strengths and shortcomings of its predictions are presented in detail. The evaluation of IceCloudNet poses two main challenges: First, the sparse availability of DARDAR reference data constrains the quantitative evaluation of the predictions to locations covered by the satellite overpass. Second, pixel-based evaluation metrics, which are commonly employed for ML model evaluation, are not completely aligned with the quality of the predictions. To illustrate this, a prediction of a thin cloud shifted by one height level should intuitively be considered a better prediction than not predicting that cloud at all. However, a pixel-based loss would result in a smaller error for the prediction with no cloud present than for the prediction of the shifted cloud.\nTo tackle these challenges, IceCloudNet predictions are evaluated in the following along three spatial abstraction levels:\n1.  Pixel-based: Metrics calculated per pixel for IceCloudNet predictions against DARDAR reference data. This is only possible along the satellite overpasses. One pixel represents a single data point in a satellite overpass with a dimension of 3 km x 3 km x 240 m.\n2.  Overpass-based: Averaged values or engineered metrics along the overpass, such as zonal means or cloud cover along the overpass.\n3.  Full domain: Here, no DARDAR reference data are available, and we are limited to evaluating the distribution statistics of IceCloudNet predictions. By using a whole year of data for evaluation, we can assume that the predictions of the whole spatial domain of IceCloudNet should follow a distribution similar to DARDAR overpasses, thus providing a sanity check for our predictions.\nIn the following, we first assess the ability of IceCloudNet to correctly represent the occurrence of cloud ice in the three-dimensional space (subsection 4a) and second, its ability to correctly determine the magnitude of cloud ice, namely IWC and Nice (subsection 4b). All evaluations shown in this section have been conducted on the year 2010, which IceCloudNet had no exposure to during training, i.e. the independent test dataset. In subsection 4c)IceCloudNet predictions are compared to ground-based observations in two representative case studies."}, {"title": "Cloud occurence evaluation", "content": "Pixel-based performance on the independent test set is reported in Table 1. IceCloudNet is able to achieve an accuracy of 96 % in predicting which pixels contain a cloud and which do not. Since 92% of the pixels in our dataset do not contain a cloud, considering the accuracy itself does not provide a balanced perspective. Better suited for evaluating the ability to predict a cloud in a given pixel are precision and recall. Precision is a metric that measures the fraction of positive predictions (in this case, cloudy) that are also positive in the ground truth dataset. On the other hand, recall calculates the proportion of all positive cases in the ground truth dataset that were correctly predicted as positive. Even at the pixel level, IceCloudNet is able to predict the occurrence of clouds containing ice crystals with precision and recall of 78 % and 75 %, respectively.\nIt is worth noting that the performance for nighttime observation slightly outperforms daytime predictions, despite daytime predictions having additional input channels in the visible spectrum that provide additional information about cloud extent and optical thickness. We hypothesize that the worse performance during the day is due to solar radiation that interferes with the lidar instrument of CALIPSO introducing higher retrieval uncertainties (Hunt et al. 2009), meaning that there could be a compensating effect between additional information from visible SEVIRI channels and deteriorated quality of DARDAR retrievals during the day.\nIn this work, we forego the comparison with simpler models which do not capitalize on spa- tial dependencies in the input data, since earlier works have shown that CNN-based approaches outperform those simpler model architectures (Amell et al. 2022; Jeggle et al. 2023a).\nSince IceCloudNet predictions are vertically resolved, we are interested in its ability to represent cloud ice occurrence for different height levels and if its performance differs depending on the height. The skill to correctly predict the occurrence of cloud ice is highest between 5 km and 14 km. For thin cirrus occurring above 15 km the precision and recall metrics drop slightly, yet still 70 % of predicted cloud pixels are correctly predicted at its minimum performance. We assume that the main reason for the worsening of the performance at high altitudes is that passive imagers such as SEVIRI are known to have a limited sensitivity to thin cirrus clouds (e.g. Holz et al. 2008; Ackerman et al. 2008), which dominate at these heights (Kr\u00e4mer et al. 2020; Gasparini et al. 2023). IceCloudNet also struggles to accurately represent clouds at heights below 6000 m. We assume that this is mainly due to the fact that those lower clouds are often masked by higher cloud layers in the underlying SEVIRI data. For daytime data (B), where visible channels are available for IceCloudNet predictions, recall at lower altitudes is better. Visible channels are sensitive to cloud albedo, which is typically higher for clouds at lower altitudes, explaining the increased performance at lower altitudes. The opposite effect is observed for nighttime data (C), where the recall curve declines more for altitudes below 8 km. Another potential cause for the decreased performance at low altitudes could be due to the inherent uncertainties behind the cloud phase retrieval in DARDAR since both liquid and ice phases can occur at these heights. For high altitudes, on the contrary, it can be observed that both recall and precision have higher values for nighttime data. Since high cirrus clouds are typically semi-transparent to solar radiation, visible channels provide less added value, but the increased retrieval uncertainty of DARDAR data due to solar radiation is affecting the data quality of the reference data during training and hence the prediction performance."}, {"title": "Cloud ice evaluation", "content": "IceCloudNet predictions achieve an R2 of 0.69 and 0.54 for IWC and Nice, respectively (Table 1). Fig 6 visualizes the reference in-cloud IWC (A) and Nice (B) of DARDAR against the predictions of IceCloudNet. IceCloudNet generally tends to slightly underestimate IWC and Nice with a mean absolute error in logarithmic space of 0.52 (IWC) and 0.54 (Nice), meaning that on average IceCloudNet predictions are off by approximately half an order of magnitude. Fig. 6 shows that the underestimation occurs at the lower end of the data distributions, that is, for IWC < 5\u00d710-6 kg m-3 and Nice < 2\u00d7104 m\u22123. For IWC and Nice 75 % of DARDAR in-cloud data are above these thresholds. We assume that the IWC prediction performance is outperforming Nice predictions due to stronger sensitivity of the cirrus radiative effects to IWC than to Nice, and hence an increase in the signal in the SEVIRI data.\nSimilar to the cloud occurrence performance (Fig. 4), the ability to correctly quantify micro- physical properties is dependent on altitude and time of day. It can be seen that throughout the atmospheric column IceCloudNet closely reproduces the median and quartile values for both IWC (A) and Nice (D) with mean deviations of the median of 0.006 and 0.04 orders of magnitude, respectively. As for the cloud occurrence performance, the deviations are largest for high altitudes, i.e. > 16 km during the night (C, F) and > 15 km during the day (B, E). Given the decreased occurrence of high cirrus during the day (Fig. 4), the lower performance of IceCloudNet during the day at high altitudes only slightly impacts its overall performance. Despite the additional information from visible channels during the day, no performance improvement can be observed at lower altitudes for daytime predictions in the median and quartile values. When considering R2 as a function of altitude (Fig. 4 A,B,C), a slightly improved performance can be observed during the day for altitudes below 8 km.\nZonal mean plots provide a big picture view on IceCloudNet's performance for different latitudes over the area of interest. It can be seen that IceCloudNet is able to reproduce the spatial patterns of DARDAR data, but underestimates IWC and Nice across the whole spatial domain. Both, the vertical distribution of the microphysical properties as well as the zonal distribution is well captured by IceCloudNet. Consistent with the results shown above, the largest deviation from the reference data can be observed at altitudes below 8 km for IWC (0.5 orders of magnitude) and 9 km for Nice (0.75 orders of magnitude), as well as for altitudes above 14 km. We note that the representation of zonal mean IWC and Nice is not directly comparable here, given that the former is calculated as grid-mean and the latter as in-cloud mean as often done in climate models (e.g. Lohmann et al. 2020).\nIn order to view the regional distribution of DARDAR and IceCloudNet, we calculate IWP by integrating the IWC predictions and average it onto 5\u00b0\u00d75\u00b0 gridboxes. For Nice a vertical integration is not useful, we instead calculate the in-cloud mean for altitudes between 10 km and 12 km to analyses spatial patterns."}, {"title": "Case Studies", "content": ""}, {"title": "Possible applications of IceCloudNet", "content": "In this section, a few exemplary use cases for the vertically and temporally resolved cloud ice reconstructions by IceCloudNet are outlined. IceCloudNet expands DARDAR observations in the spatial domain from cross sections (overpasses) to fully resolved three-dimensional cubes and from temporal snapshots to time-series data with a 15 minute resolution. It is thus now possible to take a perspective on the formation and temporal evolution of tropical mixed-phase and cirrus clouds."}, {"title": null, "content": "(i) Cloud ice origin has been established as a way to classify cirrus clouds (Kr\u00e4mer et al. 2016) where in-situ cirrus form directly in the ice phase and liquid-origin cirrus are lifted to cirrus level from the mixed-phase regime. Using only Eulerian snapshots of active satellite instruments wrongly classifies anvil cirrus as in-situ (Gasparini et al. 2018). Wernli et al. (2016) applied an Lagrangian approach to study cirrus ice origin using backward trajectories of reanalysis data. With IceCloudNet it is now possible to move from reanalysis data to observational grade data and study cirrus ice origin in a Lagrangian setting."}, {"title": null, "content": "(ii) Aerosols acting as ice nucleating particles (INPs) can influence the ice crystal formation mechanism and hence the cloud microphysical properties and radiative properties of cirrus and mixed-phase clouds. It remains a major subject of ongoing studies (Kanji et al. 2017) which aerosols can act as INPs, in which region, and which clouds are more sensitive to INP availability. Froyd et al. (2022) analysed the INP impact on cirrus properties where the authors combined trajectories of aerosols with microphysical modeling of cirrus clouds. A similar approach could be applied to the IceCloudNet dataset by co-locating aerosol trajectories and analyzing the predicted cloud ice properties of IceCloudNet's IWC and Nice along trajectories."}, {"title": null, "content": "(iii) Meteorological properties such as temperature and updraft velocities are mainly determin- ing the cloud ice properties. Jeggle et al. (2023b) combined backward trajectories of reanalysis data with DARD"}]}