{"title": "Using large language models for parametric shape optimization", "authors": ["Xinxin Zhang", "Zhuoqun Xu", "Guangpu Zhu", "Chien Ming Jonathan Tay", "Yongdong Cui", "Boo Cheong Khoo", "Lailai Zhu"], "abstract": "Recent advanced large language models (LLMs) have showcased their emergent capability of in-context learning, facilitating intelligent decision-making through natural language prompts without retraining. This new machine learning paradigm has shown promise in various fields, including general control and optimization problems. Inspired by these advancements, we explore the potential of LLMs for a specific and essential engineering task: parametric shape optimization (PSO). We develop an optimization framework, LLM-PSO, that leverages an LLM to determine the optimal shape of parameterized engineering designs in the spirit of evolutionary strategies. Utilizing the \"Claude 3.5 Sonnet\" LLM, we evaluate LLM-PSO on two benchmark flow optimization problems, specifically aiming to identify drag-minimizing profiles for 1) a two-dimensional airfoil in laminar flow, and 2) a three-dimensional axisymmetric body in Stokes flow. In both cases, LLM-PSO successfully identifies optimal shapes in agreement with benchmark solutions. Besides, it generally converges faster than other classical optimization algorithms. Our preliminary exploration may inspire further investigations into harnessing LLMs for shape optimization and engineering design more broadly.", "sections": [{"title": "I. INTRODUCTION", "content": "Shape optimization is a field of mathematical and computational design aimed at determining the best geometric configuration of a domain to optimize a given objective while satisfying constraints. It finds applications across engineering and science, from aerodynamic design [1] to structural analysis [2, 3], where efficient and innovative shapes are crucial for performance enhancement. By leveraging tools such as numerical simulations, optimization algorithms, and sensitivity analysis, shape optimization provides a systematic approach to addressing complex real-world design problem [4, 5].\nA central branch of this field is parametric shape optimization (PSO), which represents the shape of a target design using a finite set of predefined parameters [6]. This method streamlines shape representations by condensing them into a manageable number of variables, thereby facilitating efficient optimization through various algorithms. Typically, these optimization algorithms are categorized into two groups: gradient-based and non-gradient-based [7].\nGradient-based methods involve computing the first-order or higher-order derivatives of performance metrics relative to shape parameters. These derivatives are utilized to guide the search direction towards an improved geometric configuration. Notable applications include using the steepest descent algorithm for optimizing hydraulic axisymmetric bodies in laminar flows [8], sequential linear programming for reducing stress concentrations in shoulder fillets [9], quasi-Newton methods for aerodynamic wing design [10], and sequential quadratic programming for shape optimization in various contexts such as solid shell structures [11], cooling films [12], and solar reactors [13].\nAlternatively, non-gradient-based heuristic algorithms also have shown significant potential for optimization [14]. They typically employ populations of candidate solutions to globally explore the solution space, iteratively evolving them through nature-inspired processes. As arguably the most common heuristic method, genetics algorithm (GA) mimics the evolutionary process of species and has proven effective in various shape optimization tasks. Applications of GAs span from optimizing the structural integrity of spanners and flanges for enhanced stress distribution [15], to improving the acoustic performance of sound absorbers [16], and advancing the design of robotic arms for increased maneuverability [17]. Other notable heuristic methods include simulated annealing [18], ant colony optimization [19], bat algorithm [20], sequential harmony search [21], and imperialist competitive algorithm [22], among many others.\nWith the advent and subsequent popularity of machine learning (ML) algorithms, their applications in shape optimization have garnered significant attention [23]. Among ML paradigms, supervised learning, trained on labeled datasets, has been extensively utilized to develop surrogate models that accelerate shape optimization at substantially reduced costs. Examples include minimizing wind effects on civil structures [24], reducing hydraulic drag on symmetric bodies [8], and enhancing the energy efficiency of bidirectional impulse turbines [25]. Leveraging inherent data structures without requiring explicit labels, unsupervised learning facilitates the reduced-order modeling of shape-induced physical fields [26, 27] or the shape itself [28], thereby enhancing optimization efficiency. Additionally, reinforcement learning (RL), a popular ML paradigm known for applications in robotic control [29] and gaming [30], has also been applied to shape optimization. For instance, [31] reports on optimizing missile control surfaces using RL,"}, {"title": "II. RELATED WORKS", "content": "LLMs open up new possibilities for addressing domain-specific challenges, including those in fluid mechanics and mechanics more broadly. For instance, [43] introduced MechGPT, a foundational model for mechanical and material science that can articulate related knowledge using natural language inputs. Similarly, [44] proposed a ChatGPT-assisted framework that enables the use of natural language descriptions to guide research tasks exemplified by airfoil shape optimization and physics-informed neural network training. Furthermore, Kim et al. [45] prompted ChatGPT-4 to generate MATLAB code for solving a two-dimensional seepage flow problem using a finite-difference method. Extending the scope further, MetaOpenFOAM [46] leveraged multi-agent LLM collaboration to streamline computational fluid dynamics tasks, covering mesh preprocessing, simulation, and post-processing.\nIn addition to serving as assistants to existing tools, LLMs can be directly utilized for scientific exploration, such as performing symbolic regression to derive the Navier-Stokes equations [47] and predicting flow fields by leveraging their temporal autoregressive capabilities [48]. Collectively, these research efforts highlight the burgeoning applicability of LLMs in fluid mechanics and general mechanical applications."}, {"title": "A. LLM for mechanics", "content": null}, {"title": "B. LLM for general optimization", "content": "LLMs excel at decision-making by interpreting textual input, thereby supporting the solution of general optimization problems. For example, Guo et al. [40] directly prompted LLMs to mimic classic optimization algorithms such as gradient descent and hill climbing for the minimizing the values of least squares functions. Similarly, Google DeepMind [41] iteratively prompted LLMs to generate new solutions based on previous solutions and evaluations at each optimization step, achieving optimal parameter estimation for linear regression and determining the shortest path in the traveling salesman problem. Similar applications include LLM-based hyperparameter tuning [42] and supply chain optimization [49]. Furthermore, Liu et al. [50] combined LLMs with GAs, employing LLMs as the evolutionary operator, which demonstrated better performance compared to [41] in traveling salesman problems. Various approaches to leveraging LLMs to enhance classical optimization algorithms, such as evolutionary strategies [51, 52], Bayesian optimization [53], and guided local search [54], have also been explored. Moreover, LLMs have been employed to generate and design new optimization algorithms [55-58]. However, these applications primarily address general mathematical optimization problems and have not yet explored the potential of LLMs for shape optimization or broader engineering design."}, {"title": "C. Generative AI for engineering design", "content": "As a broader category encompassing LLMs, generative artificial intelligence (AI) has already harnesses its powerful generative capacity for optimizing engineering design [59]. By acting as a robust shape generator, generative AI has demonstrated its potential to improve design efficiency and foster innovation. Common generative AI models used in engineering design include generative adversarial networks (GANs) and diffusion models [60]. For instance, GANs have been applied to aerodynamic optimization [1, 61, 62] and building layout design [63]. More recently, diffusion models, notably Shap-E [64], have supported applications like automated vehicle design via natural language description [65, 66]. Similar research includes diffusion-based models for the mechanical structures optimization [67], building interior design [68], and airfoil shape optimization [69]."}, {"title": "D. Attempting LLMs for shape optimization", "content": "In summary, LLMs serve as decision-makers for addressing general-purpose optimization problems. Concurrently, their siblings-GANs and diffusion models-have been adopted in engineering design, invoking us to contempt whether LLMs possess similar potential. Hence, we attempt here exploring LLMs' decision-making abilities for a specific design task-parametric shape optimization."}, {"title": "III. METHODOLOGY", "content": "Inspired by [52] that employs LLMs for optimization in the spirit of evolutionary strategy, we introduce an LLM-based optimization framework named LLM-PSO. This framework is developed to address parametric shape optimization problems. For our implementation, we use the LLM \"claude-3-5-sonnet-20240620\" developed by Anthropic. Before delving into the details of LLM-PSO, we first define the optimization problem. A particular design is geometrically parametrized by a vector x, which encodes all optimizable design variables. Using LLM-PSO, we seek the optimal design\n$x^* = argmax_X F(x),$                                                                                                         (1)\nwhich maximizes the objective function F(x) indicating the design performance."}, {"title": "A. Workflow of LLM-PSO", "content": "In the vein of evolutionary strategies [70], LLM-PSO functions by evolving a population of N designs {x} generation by generation. Its workflow is demonstrated in Fig. 1. For simplicity, we assume that the design vectors within one generation follows an N-dimensional Gaussian distribution with a mean $\\bar{x}$ and fixed variance matrix \u03c3\u00b2I, i.e.,\n$x \\sim \\mathcal{N}(\\bar{x}, \\sigma^2I).$                                                                                (2)\nWe start the optimization by initializing the first $n_{ini}$ generations of design vectors. These generations are sampled from the afore-mentioned Gaussian distribution, with its mean $\\bar{x}$ seeded randomly within a range specific to case. Then we evaluate the objective function F(x), i.e., the performance for each initial design x, and store the design-performance pair, [x, F(x)], of all such designs in a record buffer.\nSubsequently, LLM guides the searching of the optimal design. First, we prepare a prompt (see Sec. III A 1) that encompasses selected design-performance records from the buffer; the selection strategy is detailed in Sec. III A 2. The prompt demonstrates these selections to the LLM, which returns a mean $\\bar{x}_{LLM}$ for the next generation. Then, resampling from the Gaussian distribution with this mean $\\bar{x}_{LLM}$ yields a new generation of designs. Next, we assess these designs' performance and append the paired design-performance data to the record buffer. The augmented buffer contributes to the prompt preparation for the following generation, thus beginning a new iteration."}, {"title": "1. Overview of the prompt", "content": "We develop for LLM-PSO a few-shot prompting architecture consisting of five parts:\n1. Assign the task of evolutionary optimization to the LLM;"}, {"title": "2. Strategy of records selection", "content": "Design-performance records are selectively included in the fourth part of the prompt, expressed in natural language. The selection process is as follows. Firstly, we sort the designs within each generation in ascending order based on their objective functions F(x). Next, we rank the generations in ascending order according to the best design (i.e., the one with the highest F(x)) in each generation. We then identify the top-ranking T generations and the most recent R generations, removing overlaps. For each of these identified generations, only the top-ranking M designs are selected to be included in the prompt."}, {"title": "B. Other details", "content": "Due to the limitations of LLMs in handling floating-point numbers effectively, we transform the values within the design vectors into integers [38, 52] ranged from 0 to 1000 before querying the LLM. To further ensure the stability of the outputs, we set the temperature parameter to 0, thereby forcing the LLM to generate deterministic results by consistently selecting the highest-probability output."}, {"title": "IV. RESULTS AND OBSERVATIONS", "content": "We employ LLM-PSO to tackle two representative optimization tasks in fluid dynamics and benchmark our results against those obtained using other algorithms. Specifically, we seek the optimal shapes of a two-dimensional (2D) airfoil and a three-dimensional (3D) axisymmetric body in fluid flow."}, {"title": "A. Two-dimensional airfoil shape optimization", "content": "We apply our strategy to a classical setting-optimizing the shape of a 2D airfoil to maximize its aerodynamic performance at a moderate Reynolds (Re) number. This problem [32] was previously addressed using RL. In our study, we adopt the same setting but replace the RL-based optimizer with our LLM-based version, LLM-PSO."}, {"title": "1. Shape parametrization", "content": "We parameterize the airfoil profile by a B\u00e9zier curve connecting four control points indexed i \u2208 {0,1,2,3}. The i-th point is characterized by its Cartesian coordinates (xi, Yi) and a sharpness factor ei (see SI) of the B\u00e9zier curve at this point. Here, the coordinates have been non-dimensionalized by a characteristic length l; the same applies to other coordinates or length scales from hereinafter.\nWe then introduce a polar coordinate system (p, 0) equally partitioned into four sectors in analogous to a pie chart, see Fig. 3(a). Each control point, for example the i-th with coordinates (pi, \u03b8i), is restricted exclusively to one distinct sector, namely, $\\theta_i \\in [-\\frac{\\pi}{4}+i\\frac{\\pi}{2}, \\frac{\\pi}{4}+i\\frac{\\pi}{2}]$. This restriction is imposed to reduce the occurrence of entangled airfoil profiles. Here, $p_i = \\sqrt{x_i^2 + y_i^2}$ and $(x_i, Y_i) = p_i (cos \\theta_i, sin \\theta_i)$. Further, (pi, \u03b8i, ei) is transformed to a three-element vector (pi, qi,mi) \u2208 [\u22121,1]3,"}, {"title": "2. Optimization setup", "content": "Using an open-source finite-element-method solver, FEniCS [71] for partial differential equations, we solve the dimensionless Navier-Stokes equation to evaluate an airfoil's aerodynamic performance (see SI). Specifically, we focus on the ratio, fL/fD, of its aerodynamic lift fL to drag fp. In this study, we fix the Reynolds number to Re = 100, with 2l serving as the characteristic length scale. At this Reynolds number, the flow past an airfoil is typically unsteady and periodic. To faithfully evaluate the performance, a simulation is first run to reach a time-periodic state. We then extract the time-averaged lift-to-drag ratio (fL/fD) as the performance indicator."}, {"title": "3. Optimal airfoil profiles", "content": "In the optimization, we fix certain control points and free the remaining nf points for optimization. Because each free point has three degrees of freedom (DOFs), the total number of optimization DOFs varies from three to"}, {"title": "B. Drag minimization of a revolved body in Stokes flow", "content": "Now, we apply LLM-PSO to seek the optimal profile of a 3D axisymmetric body for minimizing its hydrodynamic drag in Stokes flow. This optimization problem has been addressed theoretically by fixing the volume V [72] or surface area S [73] of the body. The resulting optimal profiles can be used to validate our optimal solutions. Besides, we will use the classical genetic algorithm (GA) to conduct the optimization, considering that LLM-PSO is inspired by the principles of evolutionary algorithms.\nTo be general, we describe the optimization problem in the dimensionless form, choosing l = $(\\frac{3V_o}{4\\pi})^{1/3}$ as the characteristic length scale for the case when the prescribed volume is Vo. In the alternative scenario where the surface area is fixed at So, we adopt l = $(\\frac{S_o}{4\\pi})^{1/2}$. In both cases, l represents the radius of a sphere with the specified volume Vo or area So."}, {"title": "1. Shape parametrization", "content": "As shown in Fig. 4(a), the axisymmetric 3D body \u03a9 is characterized by a 2D profile in the rz-plane. The z-"}, {"title": "2. Optimization setup", "content": "We perform two types of shape optimization to minimize the drag D over the body, either with a constraint on its volume V [72] or surface area S [73]. To calculate the drag D, we numerically solve the axisymmetric Stokes equation using the PDE mode of COMSOL Multiphysics 5.5 (I-Math, Singapore). We discretize a square computational domain sized 1000l by approximately 26000 triangular Taylor-Hood elements, with local refinement near the body surface. We impose no-slip boundary condition at the body surface, a uniform velocity at the inlet, and a zero-pressure at the outlet."}, {"title": "3. Optimal profiles", "content": "Using the algorithm and fixing either the area or the volume of the body of revolution, we determine its drag-minimizing profiles for mode numbers K \u2208 [2, 6]. Their drags, normalized by the reference drag of a sphere with the same area or volume, are denoted as Dr, as presented in Fig. 4(b) for the area-fixed case and Fig. 4(c) for the volume-fixed case, respectively. As indicated, the mini-"}, {"title": "V. CONCLUSIONS AND DISCUSSIONS", "content": "We have developed a novel LLM-based framework LLM-PSO that marries generative AI with evolutionary strategy for parametric shape optimization. This framework leverages the emerging ICL capacity of LLMs to assist decision-making. To demonstrate its effectiveness, we employed LLM-PSO to identify drag-minimizing profiles of a 2D airfoil in laminar flow and a 3D axisymmetric body in Stokes flow. In both cases, LLM-PSO successfully determined optimal shapes that align with established benchmark profiles.\nWe acknowledge that certain hyperparameters of LLM-PSO have not been thoroughly investigated. For instance, the number of top-ranking designs M displayed in each generation warrants additional test. Further fine-tuning these hyperparameters may enhance the optimization performance of LLM-PSO.\nBased on the current success of LLM-PSO, we point several potential research directions: 1) Improving the current LLM-PSO to address shape optimization with high DOFs; 2) Employing fine-tuning techniques to enhance the optimization capabilities of LLMs; 3) Combining other advanced optimization algorithm with LLMs to achieve synergistic enhancement in performance."}]}