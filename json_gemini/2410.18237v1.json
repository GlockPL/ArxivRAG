{"title": "Bayesian optimization for robust robotic grasping using a sensorized compliant hand", "authors": ["Juan G. Lechuz-Sierra", "Ana Elvira H. Martin", "Ashok M. Sundaram", "Ruben Martinez-Cantin", "M\u00e1ximo A. Roa"], "abstract": "One of the first tasks we learn as children is to grasp objects based on our tactile perception. Incorporating such skill in robots will enable multiple applications, such as increasing flexibility in industrial processes or providing assistance to people with physical disabilities. However, the difficulty lies in adapting the grasping strategies to a large variety of tasks and objects, which can often be unknown. The brute-force solution is to learn new grasps by trial and error, which is inefficient and ineffective. In contrast, Bayesian optimization applies active learning by adding information to the approximation of an optimal grasp. This paper proposes the use of Bayesian optimization techniques to safely perform robotic grasping. We analyze different grasp metrics to provide realistic grasp optimization in a real system including tactile sensors. An experimental evaluation in the robotic system shows the usefulness of the method for performing unknown object grasping even in the presence of noise and uncertainty inherent to a real-world environment.", "sections": [{"title": "I. INTRODUCTION", "content": "ARLY work on robotic grasp prediction, including the work carried out by Miller et al. in [1], was based on deterministic models with programmed grasping sequences constrained by the need of having a precise geometric and physical model of the object to be grasped. Later works have shifted the focus to more data-driven and adaptive grasping strategies, which are more flexible, robust and reliable, such as the approach by Yang et al. [2] or the Dex-Net system developed in [3] by Mahler et al. However, these approaches are not without drawbacks since they are computationally expensive and require large amounts of data to be trained. On the other hand, to enhance the efficiency and adaptability of a grasping method it is crucial to make it transferable to any object, even without previous knowledge of its characteristics. A simple solution to address the grasping of an unknown object could be to learn new grasps by trial-and-error methods, which can be highly inefficient and computationally demanding. In this line, different model-free approaches like the work carried out by Mahler et al. [4] and Yi et al. [5] have been proposed, planning the grasp based on visual and tactile feedback and statistical foundations with greater interpretability than deep learning approaches. Among them, Bayesian Optimization (BO) [6] has the capacity to leverage online grasp memory, making it a powerful tool for creating versatile robotic grasping systems. It is the most sample efficient global optimization method, reducing the number of trials required to find an optimal grasp, balancing between exploring new configurations and exploiting the learned probabilistic features that describe the process, while handling the uncertainty inherent in robotic perception and control. In particular, working with an approach based solely on tactile detection, with no external sensor for shape recognition, allows us to confront BO with the uncertainty introduced by realistic sensors, for analytically measuring the stability of the grasp. Nevertheless, its sample efficiency makes it suitable to deal with general black-box functions that may include visual feedback to ensure robustness.\nIn this work, a BO approach based on tactile feedback is used to handle complexity and uncertainty introduced by a real-world setup (Fig. 1C), proving the generality of the method to obtain robust and safe grasps when dealing with diverse objects and end-effectors just by using the knowledge from previous trials. The specific contributions of this paper are:\n\u2022 An exploration system for robotic grasping in 3D space based on BO, applied to a robotic hand endowed with tactile sensors.\n\u2022 The development of new heuristics that improve the convergence of the grasp evaluation function, increasing the applicability and task success in real environments."}, {"title": "II. RELATED WORK", "content": "Robotic grasping has greatly evolved from only relying on pre-programmed sequences, such as the work by Miller et al. in [1], where the modeling of the object as a shape primitive allows the selection of a starting grasp position. To compensate the lack of precision and adaptability of such approaches, learning-based methods have lately received increased attention. Data-driven strategies have shown improved robustness through the use of extensive real-world data. This is the case of the Dex-Net system developed by Mahler et al. in [3], where sets of point-clouds were used to learn the properties of the object. Although that work was focused on reducing the required data to train, deep learning methods are still computationally expensive. To reduce this training time, Yan et al. [7] proposed to use explicit ensemble methods. However, deep-learning-based methods fail to generalize to new objects different from those trained on. Model-free approaches have been explored to facilitate the grasping of previously unknown objects. They rely on exploring grasp possibilities and object shape, according to probabilistic foundations. In the case of Mahler et al. [4], grasp planning is addressed in 2D using visual data only. On the other hand, Yi et al. [5] used tactile feedback to reduce the object surface uncertainty.\nTo improve the efficiency of exploration and grasp sam- pling, Bayesian Optimization has emerged as a promising technique with a sequential strategy for addressing systematic uncertainties while providing an effective solution in many robotics and reinforcement learning problems, such as robotic walking [8], adaptive control [9], and path planning [10]. Its effectiveness in robotic grasping was first studied in the work of Daniel et al. [11], where a human acted as an expert to evaluate grasps. Later, Nogueira et al. [12] introduced the unscented transformation as a system to propagate the noise distribution through decisions, enabling the identification of optimal and safe grasps, with no human needed in the loop. The work was later continued by Castanheira et al. in [13], where a haptic exploration strategy combining BO with a collision penalty heuristic is proposed, accelerating the method's convergence. Another important contribution was made by De Farias et al. in [14], introducing object shape representation and tactile exploration into the grasp planning process, achieving stable grasps with a high probability of success. Recently, our contribution with Herrera et al. [15], compared different parameterizations of the grasp to be used with BO, as well as BO algorithm variants to obtain multi- ple grasp solutions. Compared to previous work, this work confronts the probabilistic nature of BO directly with the uncertainty introduced by real tactile sensors, which makes contact points-based metrics less reliable.\nTactile sensing has been utilized in intelligent robotics for slip detection [16], manipulation [17] and object properties perception [18], emulating human capabilities by multi- modal signal measurement, such as in the sensors used in this work with tri-axis force measurements. In addition, a tridactyl under-actuated soft hand has been used, which, while increasing the grasping capabilities [19], decreases the mea- surement accuracy, due to the positional error introduced when computing the analytical metrics. This increases complexity compared to grasping with pincer-like grippers used in other grasping approaches so far."}, {"title": "III. BAYESIAN OPTIMIZATION", "content": "This section explains the mathematical background allowing BO to efficiently tackle the global optimization of black-box functions, e.g. grasping an object. More details about the notation, implementation and pseudo-code can be found in the literature [6], [20].\nFormally, BO finds the optimum of an unknown real-valued function $f : X \\rightarrow R$, where $X C R^d$ is a compact space, in our case corresponding to the space of parameters describing the end-effector pose. The algorithm selects the best query point $x \\in X$ to evaluate each iteration with outcome $Yi = f (xi)+n$, where \u03b7 is zero-mean noise with variance $\u03c3^2_n$, finding an optimum $x^*$ so that $|y^*-Y_n|$ is minimum for the considered budget.\nBO is composed of two main ingredients. The first one is a probabilistic surrogate model, which is a distribution over the family of functions $P(f)$, where f belongs, built by incrementally sampling over X. As implemented in BayesOpt [20] we consider the probabilistic model as a Gaussian process GP(x|\u03bc,\u03c32,\u03b8) with inputs x \u2208 X, scalar outputs y \u2208 R and an associated kernel or covariance function k with hy- perparameters \u03b8, estimated using Monte Carlo Markov Chain (MCMC) algorithm resulting in samples {\u03b8i}m i=1. Given a set of observations Dn = (x1:n, Y1:n) at step n, then the prediction of the GP Yn+1 = \u0177(xn+1) at a new query point xn+1, with kernel ki conditioned on the i-th hyperparameter sample ki = k(,\u03b8i) is normally distributed, \u0177(xn+1) ~ \u03a3m i=1N(\u03bci, \u03c32|xn+1), where:\n$\\mu_{i}(x_{n+1}) = k_{i}(x_{n+1}, X)K_{i}^{-1}y$ (1)\n$\u03c3_{i}^{2}(x_{n+1}) = k_{i}(x_{n+1},x_{n+1}) - k_{i}(x_{n+1}, X)^{T}K_{i}^{-1}k_{i}(X, x_{n+1})$ (2)\nwhere $k_{i}(x_{n+1}, X) = [k_{i}(x_{n+1},x_{j})]_{x \\epsilon X}$ and $K = [k_{i}(x_{j}, x_{l})]_{xj,xl \\epsilon X} + \\sigma^{2}_{n}I$ being $\u03c3^{2}_{n}$ of the noise, with \u03bci and \u03c32i representing the prediction and uncertainty of the model at xn+1.\nThe second one is an acquisition function a(x,p(f)). It considers the predictive distribution for each point in X to select the next point at each iteration. The criteria used to perform this task is the Expected Improvement criterion (EI), which, given a set of observations Dn = (X, y) at step n and considering the expectation over the predictive distribution, can be computed as:\n$EI(x) = E_{\\hat{y}|D_{n}, \\theta, x}[max(0, \\hat{y}(x) - \\rho)]$\\\n$=\\sum_{i=1}^{m}[(\\mu_{i}(x) - \\rho)\\Phi(z_{i}) + \\sigma_{i}(x)\\phi(z_{i})]$ (3)"}, {"title": "IV. GRASP EVALUATION", "content": "Bringing the iterative process of BO to robotic grasping terms, in the first step of the optimization, the grasping process is fed with an initial set of samples X of the grasp pose. For the selected set of samples, the grasping process takes place, updating the probabilistic model and the acquisition function with the grasp quality computed for each of the samples. In the remaining iterations, the pose of the hand that maximizes the acquisition function is computed and each time a new target pose is received, the hand is placed in the new location using position control, and force-controlled to grasp the object, and a new evaluation of the function developed below is carried out. We optimize {x, y, z} coordinates of the hand palm based on the bounding box of the object plus the finger size in each direction. We also optimize the roll angle. Pitch and yaw are computed to align with the object center [21]. It is important to mention that this 4D problem is higher than in previous research with 2D [12] or 3D [13] parametrizations.\nThe following section introduces all the processes that allow the method to be transferred from a limited simulation (Fig. 1A) to the real system (setups in Figs. 1B and 1C).\nFor finding potential grasp candidates, we freely sample the space around the object to retrieve potential grasping poses. However, this means that some hand-palm poses and robot configurations can be unfeasible for different reasons.\nAs a first step to evaluate the grasping poses provided by the acquisition function of the BO, the reachability of such pose is checked by comparing it with a Capability Map [22], whose cells have an associated index representing the dexterity of the robot in that location. Once this check has been passed, we compute the robot inverse kinematics to provide a specific robot joint configuration.\nAnother type of unfeasible grasping pose occurs when the robot is in collision with either the object or the workbench. A possible collision with the workbench is handled by clas- sifying the grasp as invalid, assigning a grasp quality equal to 0, thus moving the acquisition function away from poses similar to this one. For collisions between hand and object, an Approximation Reward (AR) is used to differentiate them from collisions with the workbench or from poses that do not even touch the object, thus guiding the search toward regions that are worth exploring. Inspired by the Collision Penalty (CP) in [13], this AR brings the optimization closer to the object while avoiding those poses in which object and hand collide, assigning a higher value to the lower level of penetration of the hand into the object, as follows:\n$AR(n_{j}) = \\begin{cases} Se^{-An_{j}}, & \\text{if } n_{j} > 0 \\\\ 0, & \\text{if } n_{j} = 0 \\end{cases}$ (4)"}, {"title": "B. Absence of force closure", "content": "In a typical grasp planning approach, when the grasp generated after the hand closes around the object does not lead to force closure, the grasp quality is equal to 0 to feed the optimization. However, taking as inspiration the AR, a Contact Reward (CR) has been implemented to improve the method's convergence. This CR is defined as:\n$CR(n_{c}) = 1 - e^{-An_{c}}$ (5)\nwhere ne is the number of contact points at the hand's fingertips and A has the same purpose as in Eq. 4. In this way, the acquisition function is directed towards positions where there is a higher number of fingertip contacts with the object."}, {"title": "C. Grasp quality computation", "content": "When an iteration results in a grasp with force closure, the quality of the grasp is computed. Several works [23], [24] have concluded that the use of a combined metric is advantageous for finding an optimal realistic grasp. Based on these works, the following metrics were studied: to consider the hand configuration, the Uniformity of the transformation in the velocity domain from the finger joints to the object is computed using the condition number of the Jacobian matrix (Quni) [25]; the Grasp Isotropy Index (Qiso) [26] is computed from the singular values of the Grasp matrix to indicate an isotropic contribution of contact forces to the applied wrench; further analysis of the contact forces is performed using the wrenches that the grasp can resist, known as Grasp Wrench Space (GWS), by considering the Largest-minimum resisted wrench (Qe) [27] and the Volume of this GWS (Qv) [28]. From experiments in sec. V-A and V-C, weights were assigned to each metric, obtaining the combined metric in Eq. 6, where \u03a34 i=1 Wi = 1. Weights can also be optimized by other methods making Qm more robust.\n$Q_{m} = w_{1} * Q_{iso} + w_{2} * Q_{e} + w_{3} * Q_{v} + w_{4} * Q_{uni}$ (6)"}, {"title": "V. EXPERIMENTAL RESULTS", "content": "In this section, we present the experiments conducted in simulation and with the real robot. The simulation was im- plemented using PyBullet, and the objects considered (Fig. 3) were selected from the publicly available YCB object set [29]."}, {"title": "A. Ablation study", "content": "For establishing a baseline for comparison, we use the free-hand simulation from [15], tested in the CLASH hand with w2 = 1. The baseline is presented with a dashed line in Fig. 4 and in Table I, showing BO's ease in finding feasible grasps with great outcome values. The corresponding evaluation function has the form presented in Eq. 8, where Qf is a binary index indicating the force closure condition in this experimental case.\n$Y_{simple} = Q_{c} * Q_{f} * Q_{m}(W_{2} = 1)$ (8)\nThe following experiments show a comparison between the results obtained using different implementations of the grasp evaluation function on the complete robot model simulation, shown in Fig. 1B. As in the previous case, we use w\u2082 = 1, with 20 initial samples and 50 BO iterations to optimize with each evaluation function. The plots include a comparison of the outcomes obtained in Eq. 8, as a common metric, with the grasps found by each evaluation function in 10 optimizations, and the shaded area represents the 95% confidence interval.\nWhen adding the arm and the workbench in the simulation, the obtained metric values are much lower than in the case of the free-hand simulation, as observed in Table I and the orange line in Fig. 4. The reachability of the grasping pose and the collisions detected when including the arm and the workbench result in a higher number of grasping poses evaluated as 0. We also added the AR value to the evaluation function, leading to Eq. 9. Throughout all the experimentation, the tuning parameter was set to \u03bb = 0.1, and a coefficient \u03b1 = 0.1 was used, resulting in AR values between 0 and 0.1, being substantially lower than those provided by the grasp metric, which has been normalized between 0 and 1.\n$Y_{AR} = Q_{c} * Q_{f} * (Q_{m}(W_{2} = 1) + \\alpha AR)$ (9)\nTable I shows how both mean and maximum outcomes increase with the addition of AR, and in Fig. 4 we can see how active learning reaches much higher values already in the first iterations. The comparison between the results obtained by applying the CP [13] and the AR proposed in this work demonstrates how assigning a higher value to AR the lower the degree of collision with the object drives the acquisition function towards near-object poses, improving convergence while preventing collisions.\nIn the next step of the experimentation, we added CR, resulting in Eq. 7, again with w2 = 1. The results of Fig. 4 and Table I show the greater convergence of the method when including this coefficient. Table II shows the results obtained on more complex objects, with ygr greater than 0.5."}, {"title": "B. Real-world setup", "content": "Our robot setup, presented in Fig. 1C consists of a 7 degrees of freedom LWR arm [30] and a three-fingered CLASH hand [31], with variable stiffness in the fingers and including a grid of 4x4 haptic sensors XELA uSkin Patch [32] on the fingertips, measuring force in three axes. Together with the finger coupling, CLASH variable stiffness allows greater adaptability in grasps with different types of objects, in which a lower tendon pretension can prevent the slippage of a curved object or deformation of objects of low consistency when pressure is exerted. The contact point analysis requires the computation of the pose of each sensor using the kinematics of the arm-hand assembly. For this purpose, the hand has been considered fully actuated, which does not correspond to reality, but sill provides a very good estimation of the finger poses. Carrying out the real experimentation with an under- actuated hand adds more error to the calculations performed to evaluate the grasp. The tendon-driven fingers make it difficult to obtain an accurate joint position, which translates into another source of uncertainty that BO has to handle. The CLASH hand provides interfaces to control the finger's stiffness and joint positions independently, and the LWR arm provides interfaces for both Cartesian and joint impedance control. These controllers run on a Linux real-time machine, while other software components, including BayesOpt and the Pybullet simulation for collision avoidance, are executed in a separate Linux PC with an Intel Xeon E5-1630 v4 CPU @ 3.70GHz and an NVIDIA Quadro K620 GPU.\nOne restriction of performing movements on the real arm is that most grasping poses result in collisions when the hand approaches the target directly. To solve this type of collision a pre-grasp position is established, several centimeters away from the target position in the local Z-axis of the hand, from which the hand approaches the object safely every iteration. Additional information on the implementation problems ad- dressed can be found in [21]."}, {"title": "C. Simulation vs. real robot", "content": "To verify the portability of the method to the real robot, in this experiment different grasping poses were obtained in simulation using each of the implemented metrics and three different objects, and then tested on the real robot. The number of successful grasps in 5 optimizations, using the same number of iterations as in the previous experiments, was obtained for each metric and object, to compare the metrics' effectivenes. The outcomes have been plotted in Fig. 6 with their 95% confidence intervals, representing the learning differences of each metric. To evaluate grasp success, the object was lifted several centimeters from the table and held in that position for a period of 5 seconds. A binary score (success or fail) was recorded for each optimal grasp pose. A grasp execution was considered a failure if the object fell or slipped during its lift motion, touching the workbench. The results obtained in this experiment are shown in Table IV.\nWe can observe mean ygr outcomes greater than 0.5 in most of the cases. This is especially interesting in the case of Qv (W3 = 1), which only obtained 33.3% effective grasps in the total evaluated. Both Qe and Qiso are metrics based on GWS properties, which makes them very sensitive to positional errors [33] becoming less accurate when working with sparse and noisy sensor information from the real robot. However, Qe is more effective, since it focuses on the maximum force that the grasp can resist and not on the whole wrench space. As seen in Fig. 6, the more complex shape of the object slows down the convergence. However, in most of the cases, the metrics reach an average ygr outcome greater than 0.5, and the percentage of effective grasps is 65% of the 20 performed per object. In this figure, the blue line corresponding to Qiso (W\u2081 = 1) reaches the highest outcomes, however, only 2 of the 5 grasps performed succeeded in lifting the mug (Fig. 6b). This indicates a more symmetrical distribution of forces and torques around the object, as in Figs. 7E and 7G, is not always a sufficient condition to obtain an optimal grasp when faced with the uncertainty introduced by positional errors and an unknown friction coefficient. Although Fig. 6a shows very similar learning in all metrics when grasping the Pringles can, in the optimal grasps shown in Fig. 7 we can observe certain trends related to the computation of each metric. While the other metrics focused on exploring the top, Quni (W4 = 1) found side grasps in which the hand grasped the can very robustly (Fig. 7D). Since CLASH only has tactile sensors on the fingertips, when the Pringles are grasped from above in a sufficiently symmetrical configuration of the fingers, the direction of the contact forces results in a stable grasp according to Qu, Qiso and Q. However, in our setup, a grasp with the hand wrapped around the can has similar contact points to a grasp touching the can from the side. Considering contact points only on the distal phalanges, and not in the proximals too, causes information to be lost in the analysis. Since objects are not static in the real world, Figs. 7M and 7N show grasps in which the object slipped from the hand when pressure was exerted. Figs. 70 and 7P show cases where the hand was located far away from the object and the force closure calculation was wrong. On the other hand, Fig. 7F shows a case in which the object's movement when exerting pressure favored the grasp since the mug was pushed inside the hand. Fig. 7H is another example of how the result obtained by Quni wrapped around the mug to a greater extent. In the case of the Lego toy, two types of successful grasps can be observed: the ones in which one or more of the fingers were stuck on the toy's head, such as those shown in Figs. 7J and 7L, and those grasps in which the fingers made contact on the edges of the object as shown in Figs. 71 and 7K. It can also be seen how variable stiffness has increased adaptability to curved surfaces, as in Figs. 7C and 7H."}, {"title": "D. Optimization in real environment", "content": "In the following experiments, 5 initial samples and 25 BO iterations were performed directly on the real robot, using as evaluation function Eq. 7. The weights in Eq. 6 were computed as the successful grasps obtained with each corresponding metric in sec. V-C, divided by the total number of successful grasps. Collisions and reachability were computed in simula- tion but the quality of the grasp was obtained from the sensors and measurements provided by the robotic system. Table V shows the number of successful grasps in 5 optimizations and the outcomes obtained, which were also represented in Fig. 9 with their 95% confidence intervals.\nIn the first optimizations, the importance of the initial samples to conform a well-informed prior can be observed, especially when a reduced number of iterations is considered. In the case of the Pringles can, when a high outcome side grasp was found in the initial samples, the search was focused on that area, more related to greater outcomes in Quni, resulting in a grasp like the one in Fig. 8A. High outcomes in the upper area of the Pringles focused the rest of the search on grasps related to Qe or Qiso, like the one in Fig. 8B. Although the search space is unconstrained, addressing the learning with heuristics focused on improving the prior can be a good solution for the convergence of the method in areas of interest.\nWhen working with an underactuated hand of variable stiff- ness, conventional analytical metrics become more inaccurate as they do not take into account positional errors due to dif- ferences in tendon pretension. The force closure computation proved to be insufficient to deal with these errors. Several false good grasps were observed throughout the iterations, two of which are shown in Figs. 8C and 8D. In general, the use of the GWS to classify the grasp has been proven to have a considerable error due to the uncertainty of the measurements taken for its calculation. Except for Qe, none of the metrics considered guarantees the force closure condition in the grasp. Since Qiso and Quni by their definition give rise to more symmetric contact point distributions surrounding the object, Qv is the one with the highest risk of obtaining high values for ineffective grasps such as in Fig. 8H. Even so, Bayesian optimization has been shown to deal positively with these difficulties, achieving a 70% success rate in the optimization of the grasp performed completely on the real robot, as indicated in Table V. Note also that although in 30% of the cases the optimal grasp was not successful, in all cases BayesOpt found other feasible and robust grasps assigned with lower metric values. However, the advantages and disadvantages of each of the metrics have been slightly compensated by using Qm to observe a greater variety in the obtained grasps.\nFig. 9 shows faster learning, with higher outcomes for the mug case. The size of the Pringles can, especially in its Z-axis, reduces the convergence of the method but allows obtaining lateral clamp-like grasps. The exploration of the mug gave results that were as successful as those observed in Figs. 8E to G, with more significant variations in the roll angle.\nAlthough the results obtained in [34] give evidence of the effectiveness of their method, they are subject to a prior learning several orders of magnitude higher than the number of trials used in this work to obtain a robust grasp. Moreover, in our case the learning is performed online for any new object. On the other hand, the grasp planner proposed in [3] presents very competitive planning times of less than one second, but which, again, need prior training with large datasets directly affecting the accuracy of the method. The convergence times presented in table III depend on both software and hardware experimental conditions and still do not exceed one minute of learning in any case, improving also the results obtained with other model-free approaches such as the one presented in [4]."}, {"title": "VI. CONCLUSIONS", "content": "This work has presented a practical application of BO to the tactile exploration of objects in real environments. It has also shown the effectiveness of BO for grasping diverse and previously unknown objects in a robust and secure manner, using tactile exploration with real-life noise conditions. By conducting comprehensive experiments in simulated and real robotic environments, we have gained valuable insights into the adaptability and performance of this approach in a real setting, accounting for uncertainties and technical complexi- ties.\nThe use of BO allows the addition of different metrics and heuristics to the grasp evaluation function to deal with diverse environments, without compromising the number of iterations needed. Among these heuristics, an Approximation Reward AR, a variation to the classical Collision Penalty CP, has been proposed to force the search algorithm to move away from possible collision, and a Contact Reward CR has also been included to bring the search closer to more feasible grasping configurations, thus accelerating convergence.\nOur consideration of various grasp quality metrics has shed light on their practical utility when applied to a real system, and how they affect the results obtained in BO, which worked significantly well when using noisy measurements to evaluate each grasp trial.\nThe use of a variable stiffness hand has been beneficial, since its great adaptability allows to avoid slipping and to grasp curved surfaces robustly. Our next steps include the consideration of metrics and a grasp parameterization that better exploits the characteristics of a variable stiffness hand."}]}