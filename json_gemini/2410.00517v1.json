{"title": "Human-Robot Collaborative Minimum Time Search through Sub-priors in Ant Colony Optimization", "authors": ["Oscar Gilt", "Alberto Sanfeliu"], "abstract": "Human-Robot Collaboration (HRC) has evolved\ninto a highly promising issue owing to the latest breakthroughs\nin Artificial Intelligence (AI) and Human-Robot Interaction\n(HRI), among other reasons. This emerging growth increases\nthe need to design multi-agent algorithms that can manage\nalso human preferences. This paper presents an extension of\nthe Ant Colony Optimization (ACO) meta-heuristic to solve the\nMinimum Time Search (MTS) task, in the case where humans\nand robots perform an object searching task together. The\nproposed model consists of two main blocks. The first one is\na convolutional neural network (CNN) that provides the prior\nprobabilities about where an object may be from a segmented\nimage. The second one is the Sub-prior MTS-ACO algorithm\n(SP-MTS-ACO), which takes as inputs the prior probabilities\nand the particular search preferences of the agents in different\nsub-priors to generate search plans for all agents. The model\nhas been tested in real experiments for the joint search of an\nobject through a Vizanti web-based visualization in a tablet\ncomputer. The designed interface allows the communication\nbetween a human and our humanoid robot named IVO. The\nobtained results show an improvement in the search perception\nof the users without loss of efficiency.", "sections": [{"title": "I. INTRODUCTION", "content": "For thousands of years, mankind has relied on collab-\noration between individuals to perform tasks as optimally\nas possible in a wide variety of situations. Actually, the\nincreasing use of robots in a wide variety of settings to\nperform a multitude of tasks such as, for instance, in as-\nsistive robotics [1] or educational robotics [2], enhances the\nusefulness of improving Human-Robot Interaction (HRI) and\nHuman-Robot Collaboration (HRC) systems [3].\nSocial-aware robot navigation [4] and path planning algo-\nrithms become requirements for HRC in cases where robot\nnavigation is involved. In these cases, the communication\nbetween a robot and humans can be implicit or explicit and\nthe participants can take different roles to accomplish the\ntask. Side-by-side navigation [5], human-robot handover [6]\nand object transportation [7] are typical cases that involve\nimplicit or explicit communication between agents.\nHowever, there is a lack of HRC in most multi-agent\nsystems that play an essential role in areas like Search and\nRescue (SAR) [8], where a collaborative group of robots tries\nto find a target in an environment. These environments can\nrequire different types of robots like unmanned underwater\nvehicles (UUVs) [9], unmanned aerial vehicles (UAVs) [10],\nor unmanned ground vehicles (UGVs). Very few approaches\ninclude this collaboration in the task [11], [12].\nThis work tackles the human-robot collaborative search of\nan object in urban environments from the point of view of\nProbabilistic Search (PS) and the Optimal Search Theory\n[13]. To achieve this end, the approach presented in this\nwork is based on the Ant Colony Optimization (ACO) meta-\nheuristic, used by [14] to solve the Minimum Time Search\n(MTS) problem minimizing the Expected Time (ET) to find\nan object. The human preferences in the task are taken\ninto account through a Human-Informed Robot Planning\nsystem to obtain plans for all agents. Different approaches\nto solving other tasks have demonstrated to benefit of this\ntype of planning [15], [16]. To simplify the problem in\nthis work, the implementation of the algorithm supposes the\nsame dynamical and sensorial capabilities for all agents but\ndifferent preferences.\nThe main novelties and contributions of this work are:\n\u2022\nA new version of an MTS-ACO algorithm has been\ndeveloped that takes into account learned human pref-\nerences to create search plans and allows adaptation\nto particular humans with a novel Human-Informed\nPlanning using sub-priors.\n\u2022\nA Probabilistic Map Predictor based on a Convolutional\nNeural Network (CNN) has been developed that can\nlearn about the most likely areas where people would\nlook for lost objects using small datasets.\n\u2022\nA HRC system through an interface to ensure commu-\nnication between multiple agents and devices.\n\u2022\nAn evaluation of a real case of HRC between a person\nand a robot to test the viability of the proposed methods\nand measure the participants' perception."}, {"title": "II. BACKGROUND", "content": "In this section, the ACO meta-heuristic, which is used for\nthe approach presented here, is briefly explained.\nA. The ACO Meta-heuristic\nACO is a bio-inspired meta-heuristic that was proposed by\nM. Dorigo [17] to solve combinatorial NP-hard optimization\nproblems. It has been widely used to solve the Travelling\nSalesman Problem (TSP), an NP-hard optimization problem.\nThe algorithm simulates the foraging strategy of ants through\na mathematical model. Ants try different routes in a graph,\nG = (C, L), to find food in the set of nodes C and deposit\npheromones, $\\tau_{ij}$, each time they take an arc (i,j) that\nconnects nodes i and j and compounds the set L. For each\nant, pheromones increase the probability of choosing the\nshorter arcs so, arcs with more pheromones are going to be\nmore visited. After a while, most of the ants travel through\nthe shorter or optimal route. Also, there is a pheromone\nevaporation rate, $\\rho$, that allows to find new better routes.\n$\\tau_{ij} \\leftarrow (1 - \\rho)\\tau_{ij} \\forall(i, j) \\in L$\nAdditionally, ACO includes a heuristic $\\eta_{ij}$, to encourage\nthe best arcs during specific optimization processes. Taking\ninto account the pheromones and the heuristic, the probabil-\nity of an ant k to choose an arc (i, j) is:\n$P_{ij}^{k} = \\frac{[\\tau_{ij}]^{\\alpha}[\\eta_{ij}]^{\\beta}}{\\sum_{l \\in C_{i}} [\\tau_{il}]^{\\alpha} [\\eta_{il}]^{\\beta}}$\nwhere $C_{i}$ is the number of available nodes from node i\nand the parameters $\\alpha$ and $\\beta$ set the relative influence of the\npheromones and the heuristic.\nThere are different ACO algorithms [18] designed to\nimprove the optimization aspects. Some approaches, like Ant\nSystem (AS), MAX-MIN Ant System (MMAS) [19], and\nAnt Colony System (ACS) have been designed to optimize\nin discrete spaces using graphs. Other approaches, such as\nthe ACO for continuous domains (ACOR) can be used in\ncontinuous spaces. This work is centered on the MMAS\nalgorithm due to the promising results obtained with UAVs\n[14].\nEach approach has different equations to deposit\npheromones. The rule used to deposit pheromones after the\nevaporation in MMAS is:\n$\\tau_{ij} \\leftarrow \\tau_{ij} + \\Delta \\tau_{ij}^{best}$\nwhere $\\Delta \\tau_{ij}^{best} = 1/C_{b}$ is the pheromone applied to the arcs\nof the path with the minimum value for the cost function,\n$C_{b}$. In each optimization iteration, a group of ants produces\ndifferent paths with different costs. The pheromone update\ncan be randomly performed using the best iteration cost or\nthe best-so-far cost."}, {"title": "III. RELATED WORK", "content": "In this section, an overview of the relevant topics related\nto this work is provided. These topics are a description\nof Probabilistic Optimal Search and different methods for\nHuman-Robot Collaborative Search.\nA. PS algorithms\nPS is an area that considers probabilistic maps of the\nenvironment to find a target [13]. It has been broadly applied\nfor military purposes and in SAR to find lost people using\nUAVs or UGVs. In [20], a Bayesian perspective with a\ngreedy algorithm is proposed for maritime environments.\nMost models have adopted this Bayesian outlook using\ndifferent optimization algorithms [21], [22], [14], [23]. The\noptimization utility functions used by these methods are\nnormally the \"cumulative\u201d probability of detection or the\nExpected Time (ET) to find the target. Sometimes other\nfunctions as the expended energy or the collisions are also\nused. When ET is the main criterion, the search is a MTS\nproblem.\nB. Human-Robot Collaborative Search\nSome approaches consider HRC to find objects or people.\nIn SAR, human-robot teams normally use these approaches\nto search for lost people. In [24], a web interface is used\nto manage the search task assignment for the teams. This\ninterface offers autonomous partitioning to assign tasks and\nallows the users to change it. In [25], UAVs search for\npeople in disaster environments with 2 systems, one is\nsemi-autonomous and another one is totally autonomous.\nIn the semi-autonomous system, a Human-Informed Robot\nPlanning is performed where the human preferences can\nmodify the plan of the robot.\nSpecifically, in [12], a robot and a person share a task\nrepresentation through an interface in a smartphone [26] to\nperform the search together. The approach uses different\nSocial Reward Sources to enable the HRI during the task.\nThese rewards are used to construct an objective function\noptimized with a Monte Carlo Tree Search planner that uses\nRapidly Random Trees for each agent and it works online.\nThis approach considers only uniform probability maps and\ndoes not consider segmented areas or the ET as a criterion.\nUnlike our approach, the aforementioned methods do not\ncombine previous knowledge about where the object could\nbe lost, individual human preferences and the ET criterion."}, {"title": "IV. OUR APPROACH", "content": "A. Problem Formulation\nThis approach is focused on the human-robot collaborative\nsearch for a lost object outdoors. The prior information used\nto find the object is a segmented top-view image where\napproximately equidistant nodes are sampled to build a graph\nG, considering the map obstacles. To sample the nodes, the\nspace is divided into a grid of squares. The nodes are sampled\nat the centroid of the squares if there is no obstacle within 40\ncm, otherwise, they are sampled at the centroid of the area\nnot covered by the obstacle in that square or at a vertex of"}, {"title": "V. SIMULATIONS AND REAL-LIFE\nEXPERIMENTS", "content": "A. Sub-prior MTS-ACO Results\nThe Sub-prior MTS-ACO model has been validated\nthrough simulations in different maps using the MMAS\nalgorithm and 2 heuristic functions: The one used to solve\nthe TSP problem, $\\eta_{TSP} = \\frac{1}{d_{ij}}$, that depends on the\ndistance between nodes and the one used in [14], $\\eta_{MTS}$,\nthat considers regions of probability in different directions.\nThe comparison between heuristics has been performed in 2\ndifferent maps, M1 and M2. The metrics\nused to compare the heuristics are the ET, the CT, and\nthe Path Distance (PD). The comparison is also performed\nconsidering sub-priors and non-sub-priors.\nThe mean results of 10 trials show that the\nTSP heuristic outperforms the MTS heuristic in uniform\nprobability maps in terms of ET. The MTS heuristic only\ngives slightly better results in the case where the probability\nis concentrated in 2 gaussians and the map has no obstacles\n(M1). In all the cases, the CT is much lower for the\nTSP heuristic because it is not necessary to compute the\nheuristic for each optimization step and the PD is also lower.\nFor these reasons, the TSP heuristic is chosen to perform\nreal-life experiments. The results in CT are shown without\nparallelization of the algorithm.\nThe sub-priors in the uniform probability map are\n$p(x)/2$. In the gaussian probability map, each sub-prior\nis a 2D gaussian assigned to the closest agent. When the\nsub-priors are used, the results show a small increase in\nET and CT. In the case of the 2 gaussians in M1, the\nET is lower because the gaussians are associated with the\nclosest agent. If the agents' sub-priors are exchanged the ET\nincreases a lot. These cases are sub-optimal compared to use\nonly the MMAS due to the optimal is conditioned and the\noptimal EST is not exactly the optimal ET. Nevertheless, the\nsub-priors enable to take humans preferences into account\nwithout affect too much the performance.\nB. Real-life Experiments\nTo check the feasibility of this approach in a real system\nand the ability to manage human preferences in a searching\ntask, real-life outdoor experiments have been performed. The\nexperiment is a searching task between our humanoid IVO\nrobot and a person where they have to find a figure made\nup of 3 Parcheesi tiles in the ground. IVO is\nan urban land-based robot designed to interact with humans\nin tasks that involve object manipulation and navigation."}, {"title": "VI. CONCLUSIONS", "content": "The sub-prior MTS-ACO has been presented as a feasible\nsolution to incorporate human preferences for the search task\nin real experiments with a robot and a person. The results\nshow that the algorithm can leverage the prior knowledge\nwith the particular preferences of other agents to create\noptimal plans. Moreover, an interface to obtain a dataset that\nallows learning probability maps of the search area using a\nbasic segmented map has been proposed. A small obtained\ndataset has been enough to train a CNN with a low MSE. As\na third contribution, a Vizanti interface has been presented\nto enable HRC during the search task."}, {"title": "C. User's Study", "content": "A User's Study has been performed to test the next hypotheses:\n\u2022\nH1 - \"Participants' perception of IVO changes in the\nsecond search with respect to the first one.\u201d\n\u2022\nH2 - \"The HRC in the planning process to obtain the\nsearch paths improves the participants' search experi-\nence.\u201d\nBoth hypotheses are conditioned to the fact that the order\nof the search phases is the same for all participants. Experi-\nments where the order of the search is randomly taken could\nproduce different results.\nTo obtain the participants' information and test the hy-\npotheses a questionnaire in Spanish and English has been\npresented with 5 sections:\n\u2022 Demographic Data: In this section, the participant's\nname, academic level and age are taken. After the\nexperiment, the data is anonymized. The average age\nof participants was 28,19 years old with a standard\ndeviation of 4.35 years.\n\u2022\nIVO perception after the first search: This section\nevaluates the robot's perception of the participant after\nthe first search. To evaluate the perception, questions\nfrom [29] and [30] have been taken in a 7-point Likert\nscale to evaluate 4 attributes: Warmth, Competence,\nDiscomfort and Anthropomorphism.\n\u2022\nIVO perception after the second search: This section\nevaluates the robot's perception of the participant after\nthe second search. The questions are the same as in the\nprevious section.\n\u2022 Interface perception: The fourth section evaluates the\ninterface perception using the System Usability Scale\n(SUS) [31].\n\u2022 Preferred method: At the end of the questionnaire,\nthere is a last question to select one of the 2 search\nmethods as the preferred one.\nTo test the hypotheses, the second and third section\nresults are compared. The average Cronbach's alpha ob-\ntained for the attributes Warmth, Competence, Discomfort\nand Anthropomorphism in these sections is respectively"}]}