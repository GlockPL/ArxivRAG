{"title": "Geometric Feature Enhanced Knowledge Graph Embedding and Spatial Reasoning", "authors": ["Lei Hu", "Wenwen Li", "Yunqiang Zhu"], "abstract": "Geospatial Knowledge Graphs (GeoKGs) model geoentities (e.g., places and natural features) and spatial relationships in an interconnected manner, providing strong knowledge support for geographic applications, including data retrieval, question-answering, and spatial reasoning. However, existing methods for mining and reasoning from GeoKGs, such as popular knowledge graph embedding (KGE) techniques, lack geographic awareness. This study aims to enhance general-purpose KGE by developing new strategies and integrating geometric features of spatial relations, including topology, direction, and distance, to infuse the embedding process with geographic intuition. The new model is tested on downstream link prediction tasks, and the results show that the inclusion of geometric features, particularly topology and direction, improves prediction accuracy for both geoentities and spatial relations. Our research offers new perspectives for integrating spatial concepts and principles into the GeoKG mining process, providing customized GeoAI solutions for geospatial challenges.", "sections": [{"title": "1 Introduction", "content": "Geospatial Knowledge Graphs (GeoKGs) as a semantic network, can link multi-source geospatial data, which is essential for geospatial tasks including near real-time disaster response, urban planning, and various applications scenarios involving spatial retrieval, question-answering and reasoning [6]. While current, rapidly evolving Large Language Models (LLMs) excel in language understanding and can perform similar tasks, they lack geographic awareness and are prone to generating inaccurate answers due to their generative nature [11]. GeoKGs built with geospatial data from authoritative sources, present a trustworthy GeoAI solution for geospatial knowledge users, making them ideal for high-stakes spatial decision-making [5, 7].\nKGs typically face issues of incompleteness [3], and GeoKGs are no exception. Automated KG completion has become a desirable solution for enriching the information and knowledge contained within the KG, and link prediction is a typical task to achieve this goal by predicting missing triplets based on existing entities and relationships in the KG. In recent years, knowledge graph embedding (KGE) has proven to be the state-of-the-art method for link prediction [14]. It transforms a large number of entities and relations represented symbolically in the KG into numeric vectors in a low-dimensional space for efficient computation and reasoning while preserving the structure of the KG.\nDespite the rapid progress in KGE, challenges remain in applying general-purpose embedding models on geographic entities and their relations. Geographic entities (e.g., a place or a road) are usually contained in a geometric configuration represented by points, lines, or polygons, and the relationships between them typically have spatial properties. The current training paradigm of KGE, relying solely on the semantic structure of triplets, fails to recognize important geometric features, such as directions, distance, and topology. As a result, the selection of candidates in downstream link prediction tasks may not align with geographic intuition, negatively affecting the prediction accuracy. For example, relations that should be identified as \"cross,\u201d \u201cspan,\u201d or \u201cflow through\u201d may instead be predicted as \"far.\"\nTo address this challenge, we propose a method to inject geographic geometric features into the KGE process. By narrowing the distance between spatial relation terms and their corresponding geometric features in the embedding space, terms that describe the same geometric configuration but with different linguistic conventions will become closer to each other, as demonstrated in Figure 1. This enhancement boosts the validity of the KGE applied in GeoKGs."}, {"title": "2 Data and Methodology", "content": "Before injecting geographic geometric features into the GeoKG embedding process, we first constructed a GeoKG containing geographic entities and their spatial relations by mining relevant information from Wikipedia pages covering three states: Arizona, Utah, and Colorado. GPT-4 is utilized in the automated construction of GeoKG as described in [2], and based on this, we selected 78 spatial relation terms and their associated triplets for the experiment. We then obtained the footprints of geographic entities from OpenStreetMap [10], and computed the geometric features including topology, direction, and distance between each pair of geographic entities in PostgreSQL. These geometric features of spatial relations are summarized in Table 1. Note that we compute distance and direction based on the centroid of the footprints, with distance calculated using an isometric projection."}, {"title": "2.2 Model construction", "content": "We explore the role of geometric feature incorporation using the well-performing baseline KGE method, the Hierarchy-Aware Knowledge Graph Embedding (HAKE) model, which has shown strong performance due to its multilevel portrayal of entities in the KG [15]. We denote the vectors of spatial relations terms in GeoKG as Rt and actual geometric features, calculated based on the footprints, as Rg.\nBuilding on this, we developed a new distance function that can narrow the distance between R\u0127 and Rg, as shown in Equation 1,\n$d_{R_t}(R_g) = d_{R_{t,m}}(R_{g,m}) + \\lambda d_{R_{t,p}}(R_{g,p})$\n$d_{R_{t,m}}(R_{g,m}) = ||R_{t,m} - R_{g,m}||_2$\n$d_{R_{t,p}}(R_{g,p}) = || sin((R_{t,p} \u2013 R_{g,p})/2)||_1$"}, {"title": "2.3 Experiment settings", "content": "We allocate the training, validation, and test sets in an approximate 87:3:10 ratio and utilize the Adam algorithm [4] to optimize the loss function. We set the dimensions of the phase and modulus embeddings all to 200, with \u03b3 = 0.01, lr = 0.01, and neg_rate = 5. All results were trained for 1000 epochs. We set link prediction as the downstream task to evaluate the model performance, where for any two elements of a triplet (h, Rt, t), we compute the HAKE distance function and rank the results in ascending order to predict the third element; a smaller distance function indicates a higher ranking of the prediction result. In experiments, we employ a filtered setting to exclude training triplets from the prediction outcomes, ensuring an unbiased evaluation. We apply the Mean Reciprocal Rank (MRR) and Hits@N metrics for assessment, where a higher MRR signifies better ranking performance and a higher Hits@N indicates a greater proportion of correct predictions among the top N predicted results."}, {"title": "3 Result", "content": "During the KGE process, we incorporated the geometric features of spatial relations, including topology, direction, and distance, along with triplet information based on the HAKE model (*). As shown in Table 2, the results demonstrated that the geometric features enhance the link prediction performance for the GeoKG.\nSpecifically, for predicting geographic entities, both topology and direction are important as single features. When considering composite features, the simultaneous inclusion of almost any two features typically results in varying degrees of improvement compared to adding a single feature alone. When all three features are included, the geographic entity prediction achieves its best performance. For predicting spatial relation terms, the topology feature is the most important, a finding that is consistent with previous spatial cognitive research [1, 12], but adding direction and distance to this does not seem to further enhance the relation prediction. Overall, the simultaneous inclusion of topology, direction, and distance features enhances the KGE model, with topology and direction being the most important features. To explore the generalizability of the present results, we manually discriminate the main geometric features of the spatial relation terms in the experimental dataset, and a term may be associated with more than one feature, e.g., we manually consider that the term \"surround\" is related to both topology and distance. Statistically, the number of triplets related to topology, direction, and distance in our GeoKG dataset is in the ratio of 69:17:14. The prevalence of spatial relation terms with topology features in the dataset may also explain the primary enhancement of KGE by topology information. If the GeoKG primarily describes relations of distance or direction, the enhancement effects on the model by a single feature may vary.\nAs demonstrated in Table 3, we predicted the head geographic entities in triplets (?, adjacent to, Phoenix (AZ)) and (?, proximity, Phoenix (AZ)) using both the HAKE model and the geometric feature-enhanced HAKE (Topo+Dir+Dis*). The inclusion of geometric features helps exclude inappropriate entities, such as \"Douglas, Arizona\" and \"Interstate 19,\" from the predictions made by the HAKE model under specified spatial relations. In fact, they are not \"adjacent to\" or in \"proximity\" to Phoenix, Arizona. Additionally, the geometric feature-enhanced model facilitates the prediction of new relevant geographic entities, including \"Arizona State Route 202\" and \"Interstate 10 in Arizona\" for the relation \"adjacent to,\" and \"Avondale, Arizona,\u201d \u201cCentral Arizona Project,\" and the relatively nearby \"Casa Grande, Arizona\" for the relation \"proximity,\" thereby enhancing the geographical accuracy of link prediction.\""}, {"title": "4 Conclusion and discussion", "content": "In this research, we propose a geometric feature-enhanced GeoKG embedding method for spatial reasoning. By injecting geometric features of spatial relations into the KGE process, our results show an enhancement effect on the prediction of both geographic entities and spatial relation terms in the link prediction task, leading to outcomes that are more consistent with geographic expectations.\nBuilding upon these promising results, our research holds important implications for GeoAI research. First, the enhancement of KGE with geometric features automatically establishes mappings"}]}