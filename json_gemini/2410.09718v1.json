{"title": "A Tidal Current Speed Forecasting Model based on Multiple Periodicity Learning", "authors": ["Tengfei Cheng", "Yunxuan Dong", "Yangdi Huang"], "abstract": "Tidal energy is one of the key components in increasing the penetration rate of renewable energy. The penetration of tidal energy in the electrical grid depends on the accuracy of tidal current speed forecasting. Modeling inaccuracies hinder forecast accuracy. Previous research has primarily used physical models to forecast tidal current speed. However, tidal current variations influenced by the orbital periods of celestial bodies make accurate physical modeling challenging. Researching the multiple periodicity of tides is crucial for accurately forecasting tidal current speed. In this article, we propose the Wavelet-Enhanced Convolutional Network (WCN) to learn multiple periodicity. The framework embeds intra-period and inter-period variations of one-dimensional tidal current data into the rows and columns of a two-dimensional tensor. Then, the two-dimensional variations of the sequence can be processed by convolutional kernels. We integrate a time-frequency analysis method into the framework to further address local periodic features. Additionally, to enhance the framework's stability, we optimize the framework's hyperparameters with the Tree-structured Parzen Estimator algorithm. The proposed framework avoids the lack of learning multiple periodicity. Compared with benchmarks, the proposed framework reduces the mean absolute error and mean square error in 10-step forecasting by, at most, 90.36% and 97.56%, respectively.", "sections": [{"title": "1. Introduction", "content": ""}, {"title": "1.1. Background", "content": "The development of renewable energy can promote emis-\nsion reduction [1]. Tidal energy is considered one of the\nmost competitive forms of renewable energy [2].\nTidal energy attracts the attention of many coastal coun-\ntries [3], especially the UK. The potential of tidal energy lies\nin three aspects: cost-effectiveness, stability, and predictabil-\nity. As tidal energy gains more attention, its cost-effectiveness\nis expected to improve, as shown in Figure 1. Tidal energy\nmay replace other renewable energies when the Levelized\nCost of Energy (LCOE) falls below \u00a349-55/MWh (expected\nby 2050) [4]. Additionally, tidal energy offers high stability,\nwhich is crucial for the economic feasibility of any renewable\nenergy project [5]. Therefore, the introduction of tidal energy\ncan enhance grid stability. Moreover, tidal energy provides\nthe advantage of predictability over large time scales. Con-\nsequently, tidal energy is an excellent choice as a base-load\nenergy supply [2].\nTidal current turbines generate electricity using the ki-\nnetic energy of tidal currents, like wind turbines use the\nkinetic energy of air [6]. Therefore, fluctuations in Tidal\nCurrent Speed (TCS) reduce grid stability [7]. Enhancing\nthe accuracy of short-term forecasting helps mitigate the im-\npact of TCS fluctuations on grid stability, thereby increasing\nthe penetration of tidal energy into the grid [8]. Research\n[9] proposes to explore the statistical properties of real-life\ntime series and design customized deep learning models for\nhigh-performance time series forecasting. The research on\nstatistical properties of time series inspires us to explore the\nmultiple periodicity within the TCS series. We increase the\nconsideration of the statistical properties of TCS to improve\nthe accuracy of TCSF."}, {"title": "1.2. Literature review", "content": "Previous research focused on employing various mod-\nels for TCSF. Existing tidal current forecasting models are\ndivided into five categories: tidal harmonic models, physi-\ncal models, statistical models, traditional machine learning\nmodels, and deep learning models. The summary of the\nadvantages and disadvantages of the mentioned models are\nlisted in Table 1.\nTidal harmonic models In 1883, Sir G. H. Darwin pro-\nposed the harmonic analysis method [10]. He stated, \u201cThe\ntidal oscillations of the ocean can be represented as the sum\nof several simple harmonic motions.\u201d The harmonic analysis\nmethod was later developed by Doodson, who established\nthe famous tidal harmonic component theory. Harmonic\nmodels rely on parameter estimation. Doodson continued\nthis research and proposed estimating the parameters of the\nharmonic model with the least squares method [11]. Earlier\ntechnologies did not allow equipment to measure TCS. Re-\nsearch [12] applied harmonic models for TCSF latter. The\nharmonic model takes into account the multiple periodicity\nof TCS. However, the harmonic model cannot adapt to the\nlocal periodic changes of TCS. There were more models for\nTCSF as computing power increased.\nPhysical models The emergence of supercomputers\nbrought advancements to physical models. Based on differ-\nential equations, physical models use two-dimensional or\nthree-dimensional hydrodynamic models to make forecasts\n[13]. Physical models can adapt to the non-stationarity of\nTCS. However, modeling with differential equations depends\non physical knowledge. Additionally, solving these equations\nrequires continuous measurement of boundary conditions.\nTherefore, data-driven models are needed for TCSF.\nStatistical models Statistical models are suitable as a data-\ndriven approach for TCSF. They avoid modeling based on\nspecific TCS measurement locations. However, statistical\nmodels rely on strict stationarity assumptions. Therefore,\nstatistical methods have some limitations and they have\nrelatively high requirements in terms of data size, stability of\ntime series, data distribution, and so on [14].\nMachine learning models With the rise of artificial in-\ntelligence technology, a large number of forecasting methods\nbased on machine learning technology have emerged [15].\nResearch [16, 17, 18] indicates that machine learning models"}, {"title": "1.3. Research gaps and proposed solution", "content": "Existing research still has limitations. The first is the\nlack of consideration for multiple periodicity. Tidal current\ntime series demonstrate multiple periodicity [21]. These\ntime series include multiple periodic components, covering\nboth astronomical cycles and local periods. Astronomical\ncycles include diurnal and semi-diurnal tides, among others.\nIn addition to astronomical cycles, there are also local peri-\nodicities in tidal currents, manifested as local variations. For\nexample, interactions between tides and waves cause local\nchanges [22]. Multiple overlapping and interacting cycles\ncomplicate the model of tidal current time series. Multiple\nperiodicity presents an obstacle to TCSF. Secondly, existing\nresearch lacks deep learning models designed for tidal cur-\nrent time series. Therefore, using deep learning methods to\nconsider the multiple periodicity in tidal current time series\nhas sparked our research interest.\nWe are inspired by the TimesNet model proposed by\nWu et al. [23]. The model focuses on multiple periodicity.\nThe model uses the Fast Fourier Transform (FFT) to extract\nmultiple periods from the time series. Based on the periods,\nthe model transforms each 1D sequence into a 2D tensor.\nThen, the model uses visual backbone networks to capture\nthe 2D variations in the time series. However, the framework\nlacks consideration for the local periodicity of tidal currents.\nResearch [24] used time series decomposition methods to han-\ndle time series. The research inspired us: Discrete Wavelet\nTransform (DWT) can provide local information on signals in\nboth time and frequency domains. We can handle the series\nat different scales to capture local periodicity. Additionally,\nthe DWT module helps address local periodicity. The key\nchallenge lies in integrating local periodicity into the learning\nof multiple periodicity. We propose a framework, Wavelet-\nEnhanced Convolutional Network (WCN), to address the\naforementioned challenges. We use an improved wavelet to\nextract periodic features rather than for time series decom-\nposition. Finally, we consider the forecasting process to be\nan optimization problem. However, as the dimensionality\nof hyperparameters increases, the Gaussian model becomes\nincreasingly complex. The Tree-structured Parzen Estimator\n(TPE) algorithm optimizes hyperparameters to handle the\nhigh dimensionality of the hyperparameter space [25]."}, {"title": "1.4. Novelty and contributions", "content": "Overall, the contributions of this paper are as follows:\n\u2022 We designed a time series forecasting framework for\nlearning multiple periodicity. The framework outper-\nforms existing models in terms of metrics.\n\u2022 We use DWT to account for local periodicity, aiming\nfor better performance in multiple periodicity learning.\nExperiments validate the framework's performance.\n\u2022 We use TPE for hyperparameter optimization to im-\nprove forecasting accuracy. Ablation experiments\ndemonstrate the effectiveness of the method.\n\u2022 We design a novel framework for forecasting tidal\ncurrent speed. The framework can contribute to ad-\nvancements in the field of tidal energy."}, {"title": "1.5. Paper organization", "content": "This research is organized as follows: Section 2 shows\nthe description of the multiple periodicity and the proposed\nframework. Section 3 presents case studies on the wind farm\ndata. Section 4 gives the conclusions and future works."}, {"title": "2. Methodology", "content": "We construct a framework that considers the multiple pe-\nriodicity of TCS. Section 2.1 shows the process of extracting\nperiods using the improved wavelet. The periods extracted\nby DWT are used for the predictor. Section 2.2 shows the\npredictor used in this research. Section 2.3 shows the process\nof hyperparameter optimization.\nWithout loss of generality, a multivariate time series\nX1D = [x1,x2,...,x\u201d,\u2026\u2026\u2026 ,xN] is defined, where X1D is a\ntwo-dimensional array of shape (T, N). The shape of (T, N)\nrepresents N time series, each with T sampling points. x\"\ndenotes the n-th time series, x\" = {x^ (1), x^(2),...,x\" (T)}.\""}, {"title": "2.1. Multi-scale time series analysis", "content": "Multiple periodicity fundamentally arises from different\ninherent properties within the time series. The local peri-\nodicity of TCS is an intrinsic property in tidal current time\nseries. We can analyze time series at multiple scales. We\ncan identify information in both time and frequency domains.\nThe approach is used to identify local periodicity. Therefore,\nwe use the improved wavelet to extract periods for multi-scale\ntime series analysis. We present the process of extracting\nperiods.\nDiscrete Wavelet Transform (DWT) is first performed on\nthe time series x\". The DWT uses a set of high-pass filters h\nand low-pass filters g to decompose the time series signal into\ndifferent resolutions. As the decomposition levels increase,\nthe frequency resolution of the original signal increases. At\nthe j-th level, the outputs of the high-pass and low-pass filters\nare represented as detail coefficients cD and approximation\ncoefficients cA, respectively. The detail coefficients describe\nshort-term changes in the series, while the approximation\ncoefficients describe the long-term trends of the signal. The"}, {"title": "2.2. Tidal current speed predictor", "content": "We use WCN to forecast after we obtain the periodic\ninformation. Existing methods have limitations in capturing\nmultiple periodicity. Existing methods are either limited\nby one-dimensional input sequences, making it difficult to\ncapture multiple periodicities, or require complex feature\nengineering [27]. This research employs the WCN framework\nto model tidal current time series, as it can fully utilize\nperiodic information for forecasting. The WCN framework\nuses the TimesNet model proposed by Wu et al. as the"}, {"title": "2.3. The process of hyperparameter optimization", "content": "We recognize the importance of selecting optimal hy-\nperparameters. To achieve this, we use the Tree-structured\nParzen Estimator (TPE). TPE is a variant of Bayesian opti-\nmization suitable for high-dimensional and discrete parameter\nspaces. Unlike traditional Bayesian methods that rely on\nGaussian processes, TPE improves efficiency by constructing\nprobability density functions in the hyperparameter search\nspace using Parzen window density estimation [32]. Next,\nwe transform the forecasting problem into an optimization\nprocess, with the design of the objective function discussed\nin Section 2.3.1 and the application of TPE in Section 2.3.2."}, {"title": "2.3.1. Objection function design", "content": "Typically, multi-step time series forecasting aimss to\nminimize the Mean Squared Error (MSE). We define the"}, {"title": "2.3.2. Implement of TPE", "content": "TPE continuously searches for the optimal solution of\nthe objective function in a tree-structured parameter space.\nHere, w represents any hyperparameter combination within\nthe hyperparameter search space @space, and y is the loss\nfunction value under that hyperparameter combination. The\noptimization process of TPE is illustrated in Algorithm 1,\nwhich involves four main steps:\nInitial distribution definition Perform a random search\nin the initial iteration phase to help establish the initial\nprobability distribution.\nObservation splitting Divide the hyperparameter combi-\nnations into two groups based on their performance metrics.\nThe first group includes \"good\" configurations, denoted as\nx(w), and the second group includes \"bad\" configurations,\ndenoted as \u03b3(\u03c9). The performance threshold y* distin-\nguishes two groups. The groups are updated after evaluating\nthe performance of new hyperparameter combinations.\nProbability modeling Use Parzen window estimation to\nbuild probability density functions for the configurations\ny(w) and \u03b3(\u03c9). Specifically, p(w | y < y*) is used for\n\"good\" configurations, and p(w | y \u2265 y*) is used for \"bad\"\nconfigurations.\nSampling strategy In each iteration, select new hyper-\nparameter combinations for evaluation based on the current\nprobability density distributions. The selection strategy max-\nimizes the Expected Improvement (EI), representing the\nlikelihood that a new hyperparameter configuration will fur-\nther reduce the loss, given the current best loss function value.\nIt is calculated as follows:\n$\\operatorname{EI}(\\omega)=\\frac{\\chi(\\omega)}{\\gamma(\\omega)}$\nThe hyperparameters that maximize EI are selected as the\nnext set of search values, and the process returns to step 2 for\niteration.\nOutput When the stopping criteria for iteration are met,\noutput the best hyperparameter combination @best"}, {"title": "3. Experiment design", "content": ""}, {"title": "3.1. Data description and preprocessing", "content": "The Orkney Islands in the United Kingdom, located in\nthe North Atlantic north of Scotland, are renowned for their\nabundant tidal energy resources and are known as an \"eco-\nlogical paradise\" in the marine energy sector. Their unique\ngeographical location provides real marine environmental\nconditions for the tidal energy test site at the European Ma-\nrine Energy Centre, including various factors such as tides,\nocean currents, and water depth. These data are crucial for\nverifying the performance of tidal energy technology in actual\nenvironments.\nThe tidal data used in this paper were obtained from\nReDAPT project, originating from a tidal energy test site near\nthe Fall of Warness on one of the Orkney Islands. The location\ncan be seen in Figure 6. The TCS data were collected from\nfour-beam Acoustic Doppler Current Profilers instruments\ndeployed on the seabed gravity mooring frames at the tidal\nenergy test site. We select the TCS in the X, Y, and Z\ndirections to perform multi-level forecasting at depths of\n22m, 23m, and 24m below sea level. The recording span is 7\ndays, with data collected every 1s.\nThe original data are stored using.mat file format. We\nfirst perform preprocessing. Due to malfunctions in reading\ninstruments or interruptions caused by sudden movements\nnear recording sensors, the data contain missing values and\noutliers. For non-continuous missing values, the average\nof neighboring time points is used for replacement, while\ncontinuous missing values are directly replaced with 0.01.\nOne method to remove outliers is to pre-filter high-frequency\ncontent in the data [16]. This research uses an adaptive filter\nto remove high-frequency noise and erroneous data from the\ndataset. Table 2 shows statistics of the data at different water\ndepths.\nWe split the data into training, testing, and validation sets\nwith proportions of 70%, 20%, and 10%, respectively. The\nvalidation set is designed to adjust the hyperparameters. We\nselect TCS for a case study to provide a practical dataset and\nmethod application example."}, {"title": "3.2. Evaluation metrics", "content": "This subsection describes the performance metrics\nadopted to evaluate the forecasting capabilities of the pro-\nposed framework. Specifically, Mean Absolute Error (MAE),\nMean Square Error (MSE), Root Mean Square Error (RMSE),\nMean Absolute Percentage Error (MAPE) are used as follows:"}, {"title": "3.3. Performance comparisons of different models", "content": "We conduct a comparative analysis against existing meth-\nods.\nBaselines We select the following models as baselines:\nXGBoost[33], LSTM[34], GRU[35], Transformer, Reformer,\niTransformer, Autoformer, Pyraformer, DLinear, FEDformer\nand FiLM. Some of the comparison models' selection and\nhyperparameter design refer to the work [36].\nIn this research, we design experiments to analyze the\ninteraction between multiple periodicity and forecasting accu-\nracy in multi-step forecasting. The evaluation first examines"}, {"title": "3.4. Ablation studies", "content": "We conduct ablation experiments on the WCN frame-\nwork to determine the impact of individual components on\nthe framework's forecasting performance. Specifically, we\nexamine the effects of the DWT and TPE modules."}, {"title": "3.4.1. Ablation study of the DWT module", "content": "First, we validate the impact of the DWT module on\nforecasting performance. The DWT module was ablated.\nWe used data at 23m below sea level to compare model\nperformance across different output steps. The WCN without\nthe DWT module uses the Fast Fourier Transform (FFT) to\nlearn the periodic features of the sequence, which we refer\nto as WCN-FFT. Since the DWT module captures the local\nperiodicity within the sequence, replacing it increases the\nforecasting error metrics for WCN-FFT. The results demon-\nstrate the advantage of the DWT module in learning multiple\nperiodicity. Figure 8 shows the performance differences\nbetween the two periodicity-capturing methods.\nTo further verify the framework's ability to capture local\nperiodicity, we added sinusoidal local periodicity to the\noriginal data. To control locality, a Gaussian window function\nwas used. The Gaussian window was generated based on the\nrelationship between time, the center offset, and the window\nwidth. Then, the Gaussian window was multiplied by a sine\nwave to create a locally periodic signal, which was added to\nthe original time series data, resulting in a new dataset named\n23mnew. Next, the WCN and WCN-FFT models are used to\nforecast both the original and new datasets. Moreover, we\noptimize the hyperparameters for each model separately. The\nperformance metrics for forecasting are shown in Table 5.\nThe results indicate that the WCN-FFT model exhibits\na decrease in prediction accuracy when dealing with data\ncontaining stronger local periodicity (23mnew). In contrast,\nthe WCN framework improves prediction accuracy when\nhandling the 23mnew data. The results validate the role of the\nDWT module."}, {"title": "3.4.2. Ablation study of the TPE module", "content": "After analyzing the contribution of the DWT module to the\nframework's predictive accuracy, we conducted the following\ncomparative experiment to analyze further the impact of the\nhyperparameter optimization method on forecasting results:\n\u2022 Using Random Sampler (i.e., WCN-RS): We replaced\nthe TPE parameter optimization method in the model\nwith a random sampling method, which randomly\nselects hyperparameter values. The results showed a\ndecline in predictive performance, indicating that the\nrandom sampling method could not effectively search\nfor the optimal hyperparameter combination, thereby\nreducing the model's generalization performance.\n\u2022 Using Default Parameter Combinations (i.e., WCN w/o\nTPE): We replaced the TPE parameter optimization\nmethod in the model with default parameter combina-\ntions. The results also showed a decline in forecasting\nperformance, suggesting that the default parameter\ncombinations could not adapt to different datasets and\nscenarios, limiting the model's flexibility.\nTable 6 presents the forecasting performance of the model\nunder different hyperparameter optimization methods. The\nresults show that the model achieved the lowest metric values\nusing the TPE parameter optimization method. The results\nconfirm the effectiveness of the proposed method."}, {"title": "4. Conclusion", "content": "In this research, we developed a multiple periodicity\nlearning framework that is capable of learning local peri-\nodicity. We use the improved wavelet to extract periods\nfor forecasting and integrate the TPE algorithm to optimize\nhyperparameters, forming the Wavelet-Enhanced Convolu-"}]}