{"title": "Multi-task Neural Networks for Pain Intensity\nEstimation using Electrocardiogram and\nDemographic Factors", "authors": ["Stefanos Gkikas", "Chariklia Chatzaki", "Manolis Tsiknakis"], "abstract": "Pain is a complex phenomenon which is manifested and ex-\npressed by patients in various forms. The immediate and objective recog-\nnition of it is a great of importance in order to attain a reliable and unbi-\nased healthcare system. In this work, we elaborate electrocardiography\nsignals revealing the existence of variations in pain perception among\ndifferent demographic groups. We exploit this insight by introducing a\nnovel multi-task neural network for automatic pain estimation utilizing\nthe age and the gender information of each individual, and show its ad-\nvantages compared to other approaches.", "sections": [{"title": "1 Introduction", "content": "Pain according to Williams and Craig [3] is \"a distressing experience associated\nwith actual or potential tissue damage with sensory, emotional, cognitive and\nsocial components\". As a biological mechanism, pain facilitates the identifica-\ntion of harmful situations by the activation of primary sensory neurons releasing\nprostanoids molecules and growth factors in the spinal cord [19]. The two main\ntypes of pain are acute and chronic, where their main difference is related to the\nduration; the pain is considered as acute when is present less than three months\nand probably accompanied with clear physiological damage, while chronic when\npersist beyond the normal healing time [23]. Pain affects people in a major\ndegree, provoking a plethora of daily life challenges, especially in chronic pain\ncondition, which often leads to mental health problems e.g. anxiety, depression\nand sleep related problems [13]. In addition, there are various collateral nega-\ntive effects, associated with opioid and drug overuse, addiction and poor social\nbehavior relationships [19]. Pain is a serious issue concerns the whole society,\nsince the consequences of it constitute clinical, economic and social constraints\n[6]. Especially in health care systems, more than 50% of the patients in hospitals\nare experience painful conditions, requiring large resources of medical and nurs-ning stuff [5]. An important body of research indicates discrepancies regarding to"}, {"title": "2 Related Work", "content": "An important number of published research studies, founded on the utilization\nof biosignals in order to analyse the pain manifestation [25][13]. A major reason\nof the preference of biosignals instead of vision modalities e.g. facial expressions,\nis related to circumstances where subdued lightning, facial occlusions or even\nface absence occur, especially in clinical settings where the conditions are far\nfrom being perfect. Furthermore, in several occasions people exhibit exaggerated\nsymptoms through facial expressions and body posture in order to elicit self-interest [18].\nUtilizing ECG, EMG and electrodermal activity (EDA), researchers in [12],\nextracted various handcrafted features including skewness, standard deviation"}, {"title": "3 Methods", "content": "This section describes the employed pain database, the signal processing algo-\nrithm and feature extraction method, as well as the design of the multi-task\nneural network."}, {"title": "3.1 Dataset details", "content": "In this study we employed the publicly available Bio Vid Heat Pain Database\n[24], which combines (1) frontal facial videos, (2) electrocardiogram, (3) elec-"}, {"title": "3.2 ECG processing and feature extraction", "content": "An ECG signal reflects the electrical activity of the heart during time, where\ncardiac muscles depolarize and repolarize during a cardiac cycle. The cardiac\ncycle describes the undergoing activity from the beginning of one heartbeat to the\nbeginning of the next, which in an ECG complex consists of a PQRST complex.\nThe P wave indicates atrial depolarization, while the QRS complex represents\nventricular depolarization and contraction. The T wave describes repolarization\nof ventricles. Consequently, the ECG analysis prerequisites the decomposition of\nthe PQRST complex (see Fig. 1). By the accurate detection of R wave, which is\nthe most prevalent peak in the complex, we are capable to calculate the heart rate\n(HR) and the heart rate variability (HRV), which is related with the time interval\nbetween consecutive R waves, called as RR interval or Interbeat interval. In this\nstudy, we adopt the Pan-Tompkins Algorithm [16] for the QRS detection. The\nspecific algorithm is widely used and evaluated over the years, with the results\nsupporting its efficiency even in noisy and low-quality data [7]. The synthesis\nof the algorithm emerges in two stages: the pre-processing and the decision; the\npre-processing deals with removing noise and artifacts, as well as smoothing the\nsignal and increasing the QRS slope, while the decision, encompass the initial\nQRS detection based on adaptive thresholds, a search back for missed QRS\ncomplexes, and a process for T wave discrimination. The basic flow diagram of\nPan-Tompkins algorithm as well as the pre-process procedure applied in raw\nECG presented in Fig. 2 and Fig. 3 respectively.\nFollowing the accurate detection of R waves, the inter-beat intervals (IBIs)\nwere estimated, and the most important relevant features were extracted. Partic-ularly, the mean of IBIs, the root mean square of successive differences (RMSSD),\nthe standard deviation of IBIs (SDNN), the slope of the linear regression of IBIs,\nthe ratio of SDNN to RMSSD, and the heartbeat rate, were calculated as in de-tail described in our previous work [8]."}, {"title": "3.3 Neural network", "content": "Our proposed neural network trained in two different settings; with single-task\nlearning (STL) and multi-task learning (MTL), where the latter beyond the pain\nestimation it involves the simultaneous training of age and/or gender estimation.\nSingle-task neural network The proposed neural network consists of two\nsub-networks; the encoder which is mapping the original feature vectors into a\nhigher dimensional space, and the task-specific classifier. Our method employs\nfully-connected (FC) layers for both the encoder and the classifier, each one\ndefined as follows:\n$Zi(8) = bi + \\sum_{j=1}^{Nin} Wij8j $ for $i = 1,.., Nout $(1)\nwhere $z_i$ is the outcome of the linear aggregation of incoming inputs $s_j$, and each\ninput is weighted by $W_{ij}$ and biased by $b_i$. Every layer of the encoder is followed\nby a nonlinear activation function, namely rectified linear unit (ReLU) defined\nas:\n$\\sigma(z) = \\begin{cases}\n1, z \\geq 0 \\\\\n0, z<0\n\\end{cases}$(2)\nwhile the classifier' layers are connected without nonlinearity. The encoder con-sists of 4 FC layers with 256, 512, 1024 and 1024 neurons respectively, while the\nclassifier consists of 2 layers with 1024 and n neurons, where n is the number of\nthe corresponding pain classes. In table 1, we list the hyper-parameters of our\nnetwork.\nMulti-task neural network The specific machine learning method is founded\non the principle of sharing representations between related tasks, enabling the\nmodel to generalize better on the original task, i.e. pain estimation. In this"}, {"title": "4 Experiments and results", "content": "4.1 Demographic groups\nUtilizing the single-task neural network (ST-NN) we conducted the first body of\nexperiments related to the influence of demographic factors. Specifically, adopt-\ning the idea of [8] we developed five schemes; (1) basic scheme, utilizing all the\nsubjects of the database, (2) gender scheme, dividing the subjects into males\nand females, (3) age scheme, based on the subjects' age forming three groups\ni.e. 20-35, 36-50, 51-65, and (4) gender-age scheme combining the gender and\nage of the subjects, creating six groups i.e. Males 20-35, Females 20-35, Males\n36-50, Females 36-50, Males 51-65, Females 51-65. We note that all the exper-iments of this study conducted in binary and multi-class classification settings.\nIn particular: (1) NP vs P1, (2) NP vs P2, (3) NP vs P3, (4) NP vs P4 regarding\nthe binary classification and finally (5) multi-class pain classification, utilizing\nall the available pain classes of the database.\nTable 2 presents the classification results of Basic scheme, utilizing all the sub-jects of the database. For the multi-class pain classification we achieved 29.43%,\nwhile the accuracy on NP vs P1 attained 61.15% and reaching up to 68.82% on\nNP vs P4. We observe that as the pain intensity raise, the performance scores\nincreased as well, revealing the challenges to recognise the low magnitude of pain\nseverity. According to the gender scheme (see Table 3) there are clear differences\namong males and females, especially in higher pain intensities. Specifically, in"}, {"title": "4.2 Augmentation of feature vectors", "content": "Based on the observations from the previous section regarding the influence\nof demographic factors in pain manifestation, we investigate the functional ex-ploiation of subjects' demographic information. We conducted a set of exper-iments utilizing the ST-NN and the feature vectors which augmented by the\nexpansion of them with demographic elements. Specifically, the original feature\nvectors, consisting of six features (see 3.2), expanding by an additional feature\n(i.e. the subjects' gender or age), or two additional features (the subjects' gen-der and age). In this manner, utilizing the new set of features we carried out\nthe identical experiments related to pain estimation tasks. Table 6 presents the\nclassification results, where we observe increased performances adopting the ap-proach of augmented feature vectors. In particular, the most effected type of\naugmentation is the combination of Gender and Age feature, which improved\nthe mean pain estimation performance by 0.55%, while the utilization of them\nindividually, enhanced the classification accuracy, but in a lower degree."}, {"title": "4.3 Multi-Task Neural Network", "content": "The final set of experiments conducted in a multi-task learning manner, utiliz-ing the proposed MT-NN described in 3.3. The classification performances of\nMT-NN with the additional tasks of (1) gender estimation, (2) age estimation\nand (3) gender & age estimation simultaneously, are presented in Table 7. The\nresults of the previous approaches based on the ST-NN method, are presented\nas well in Table 7. We observe that the additional task of gender estimation\nperformed inferior compared to others tasks, while the combination of gender &\nage achieved the highest performance in four of the five tasks. Specifically, in the\nmulti-class classification attained 30.24%, while in NP vs P1 62.82% which are\nthe greatest results compared to every presented method in this study. Similarly,\nin NP vs P3 and NP vs P4 outperformed the gender and age additional tasks,\nhowever underperformed to ST-NN approaches with the augmented features.\nFinally, in NP vs P2 the additional task of age estimation performed superior\nachieving 63.97%, which is also the highest attained result in this study.\nRegarding the overall achieved performances of MT-NN compared to the ST-NN approaches (i.e. original features vectors and augmented feature vectors),\nwe observe an increase of 0.71% and 0.39% respectively, in relation to the mean\npain estimation accuracy of all tasks. Figure 6 illustrate the comparison of every\nneural network approach presented in this study, according to multi-class and\nbinary classification tasks as well."}, {"title": "4.4 Comparison with existing methods", "content": "Finally, in this section we compare our accomplished results utilizing the MT-NN\nemployed the additional tasks of gender and age estimation, with corresponding\nstudies which utilized the electrocardiography signals of the Part A of Bio Vid"}, {"title": "5 Conclusion", "content": "This work explored the application of multi-task learning neural networks for\nautomatic pain estimation based on electrocardiography signals. Utilizing the\nPan-Tompkins algorithm for the detection of QRS complexes we extracted es-sential features related to IBIs. Several experiments conducted in order to in-vestigate the relation of gender and age with the pain manifestation, revealing\nthe great influence of them to pain perception. Furthermore, we proposed two\nmethods in order to exploit the demographic information enhancing the pain"}, {"title": "$Ltotal = [ew1LPain + W1]C1 + [ew2LAge + W2]C2 + [ew3LGender + W3]C3 (3)$", "content": ""}, {"title": "$LD = - \\sum_{SED}^{Nout}p(ixs) log[q(i|xs)]$", "content": "(4)"}, {"title": "6 S. Gkikas et al.", "content": ""}]}