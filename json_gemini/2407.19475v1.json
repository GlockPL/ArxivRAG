{"title": "Multi-task Neural Networks for Pain Intensity Estimation using Electrocardiogram and Demographic Factors", "authors": ["Stefanos Gkikas", "Chariklia Chatzaki", "Manolis Tsiknakis"], "abstract": "Pain is a complex phenomenon which is manifested and expressed by patients in various forms. The immediate and objective recognition of it is a great of importance in order to attain a reliable and unbiased healthcare system. In this work, we elaborate electrocardiography signals revealing the existence of variations in pain perception among different demographic groups. We exploit this insight by introducing a novel multi-task neural network for automatic pain estimation utilizing the age and the gender information of each individual, and show its advantages compared to other approaches.", "sections": [{"title": "Introduction", "content": "Pain according to Williams and Craig [3] is \"a distressing experience associated with actual or potential tissue damage with sensory, emotional, cognitive and social components\". As a biological mechanism, pain facilitates the identification of harmful situations by the activation of primary sensory neurons releasing prostanoids molecules and growth factors in the spinal cord [19]. The two main types of pain are acute and chronic, where their main difference is related to the duration; the pain is considered as acute when is present less than three months and probably accompanied with clear physiological damage, while chronic when persist beyond the normal healing time [23]. Pain affects people in a major degree, provoking a plethora of daily life challenges, especially in chronic pain condition, which often leads to mental health problems e.g. anxiety, depression and sleep related problems [13]. In addition, there are various collateral negative effects, associated with opioid and drug overuse, addiction and poor social behavior relationships [19]. Pain is a serious issue concerns the whole society, since the consequences of it constitute clinical, economic and social constraints [6]. Especially in health care systems, more than 50% of the patients in hospitals are experience painful conditions, requiring large resources of medical and nursing stuff [5]. An important body of research indicates discrepancies regarding to"}, {"title": "Related Work", "content": "An important number of published research studies, founded on the utilization of biosignals in order to analyse the pain manifestation [25][13]. A major reason of the preference of biosignals instead of vision modalities e.g. facial expressions, is related to circumstances where subdued lightning, facial occlusions or even face absence occur, especially in clinical settings where the conditions are far from being perfect. Furthermore, in several occasions people exhibit exaggerated symptoms through facial expressions and body posture in order to elicit self-interest [18].\nUtilizing ECG, EMG and electrodermal activity (EDA), researchers in [12], extracted various handcrafted features including skewness, standard deviation"}, {"title": "Methods", "content": "This section describes the employed pain database, the signal processing algorithm and feature extraction method, as well as the design of the multi-task neural network."}, {"title": "Dataset details", "content": "In this study we employed the publicly available Bio Vid Heat Pain Database [24], which combines (1) frontal facial videos, (2) electrocardiogram, (3) elec-"}, {"title": "ECG processing and feature extraction", "content": "An ECG signal reflects the electrical activity of the heart during time, where cardiac muscles depolarize and repolarize during a cardiac cycle. The cardiac cycle describes the undergoing activity from the beginning of one heartbeat to the beginning of the next, which in an ECG complex consists of a PQRST complex. The P wave indicates atrial depolarization, while the QRS complex represents ventricular depolarization and contraction. The T wave describes repolarization of ventricles. Consequently, the ECG analysis prerequisites the decomposition of the PQRST complex. By the accurate detection of R wave, which is the most prevalent peak in the complex, we are capable to calculate the heart rate (HR) and the heart rate variability (HRV), which is related with the time interval between consecutive R waves, called as RR interval or Interbeat interval. In this study, we adopt the Pan-Tompkins Algorithm [16] for the QRS detection. The specific algorithm is widely used and evaluated over the years, with the results supporting its efficiency even in noisy and low-quality data [7]. The synthesis of the algorithm emerges in two stages: the pre-processing and the decision; the pre-processing deals with removing noise and artifacts, as well as smoothing the signal and increasing the QRS slope, while the decision, encompass the initial QRS detection based on adaptive thresholds, a search back for missed QRS complexes, and a process for T wave discrimination. The basic flow diagram of Pan-Tompkins algorithm as well as the pre-process procedure applied in raw ECG presented in Fig. 2 and Fig. 3 respectively.\nFollowing the accurate detection of R waves, the inter-beat intervals (IBIs) were estimated, and the most important relevant features were extracted. Particularly, the mean of IBIs, the root mean square of successive differences (RMSSD), the standard deviation of IBIs (SDNN), the slope of the linear regression of IBIs, the ratio of SDNN to RMSSD, and the heartbeat rate, were calculated as in detail described in our previous work [8]."}, {"title": "Neural network", "content": "Our proposed neural network trained in two different settings; with single-task learning (STL) and multi-task learning (MTL), where the latter beyond the pain estimation it involves the simultaneous training of age and/or gender estimation."}, {"title": "Single-task neural network", "content": "The proposed neural network consists of two sub-networks; the encoder which is mapping the original feature vectors into a higher dimensional space, and the task-specific classifier. Our method employs fully-connected (FC) layers for both the encoder and the classifier, each one defined as follows:\n$Zi(8) = bi + \\sum_{j=1}^{Nin} Wij8j$ for $i = 1,.., Nout$ (1)\nwhere zi is the outcome of the linear aggregation of incoming inputs sj, and each input is weighted by Wij and biased by bi. Every layer of the encoder is followed by a nonlinear activation function, namely rectified linear unit (ReLU) defined as:\n$\\sigma(z) = \\begin{cases}\n1, z \\geq 0 \\\\\n0, z<0\n\\end{cases}$ (2)\nwhile the classifier' layers are connected without nonlinearity. The encoder consists of 4 FC layers with 256, 512, 1024 and 1024 neurons respectively, while the classifier consists of 2 layers with 1024 and n neurons, where n is the number of the corresponding pain classes. In table 1, we list the hyper-parameters of our network."}, {"title": "Multi-task neural network", "content": "The specific machine learning method is founded on the principle of sharing representations between related tasks, enabling the model to generalize better on the original task, i.e. pain estimation. In this"}, {"title": "Experiments and results", "content": ""}, {"title": "Demographic groups", "content": "Utilizing the single-task neural network (ST-NN) we conducted the first body of experiments related to the influence of demographic factors. Specifically, adopting the idea of [8] we developed five schemes; (1) basic scheme, utilizing all the subjects of the database, (2) gender scheme, dividing the subjects into males and females, (3) age scheme, based on the subjects' age forming three groups i.e. 20-35, 36-50, 51-65, and (4) gender-age scheme combining the gender and age of the subjects, creating six groups i.e. Males 20-35, Females 20-35, Males 36-50, Females 36-50, Males 51-65, Females 51-65. We note that all the experiments of this study conducted in binary and multi-class classification settings. In particular: (1) NP vs P1, (2) NP vs P2, (3) NP vs P3, (4) NP vs P4 regarding the binary classification and finally (5) multi-class pain classification, utilizing all the available pain classes of the database.\nTable 2 presents the classification results of Basic scheme, utilizing all the subjects of the database. For the multi-class pain classification we achieved 29.43%, while the accuracy on NP vs P1 attained 61.15% and reaching up to 68.82% on NP vs P4. We observe that as the pain intensity raise, the performance scores increased as well, revealing the challenges to recognise the low magnitude of pain severity. According to the gender scheme (see Table 3) there are clear differences among males and females, especially in higher pain intensities. Specifically, in"}, {"title": "Augmentation of feature vectors", "content": "Based on the observations from the previous section regarding the influence of demographic factors in pain manifestation, we investigate the functional exploitation of subjects' demographic information. We conducted a set of experiments utilizing the ST-NN and the feature vectors which augmented by the expansion of them with demographic elements. Specifically, the original feature vectors, consisting of six features (see 3.2), expanding by an additional feature (i.e. the subjects' gender or age), or two additional features (the subjects' gender and age). In this manner, utilizing the new set of features we carried out the identical experiments related to pain estimation tasks. Table 6 presents the classification results, where we observe increased performances adopting the approach of augmented feature vectors. In particular, the most effected type of augmentation is the combination of Gender and Age feature, which improved the mean pain estimation performance by 0.55%, while the utilization of them individually, enhanced the classification accuracy, but in a lower degree."}, {"title": "Multi-Task Neural Network", "content": "The final set of experiments conducted in a multi-task learning manner, utilizing the proposed MT-NN described in 3.3. The classification performances of MT-NN with the additional tasks of (1) gender estimation, (2) age estimation and (3) gender & age estimation simultaneously, are presented in Table 7. The results of the previous approaches based on the ST-NN method, are presented as well in Table 7. We observe that the additional task of gender estimation performed inferior compared to others tasks, while the combination of gender & age achieved the highest performance in four of the five tasks. Specifically, in the multi-class classification attained 30.24%, while in NP vs P1 62.82% which are the greatest results compared to every presented method in this study. Similarly, in NP vs P3 and NP vs P4 outperformed the gender and age additional tasks, however underperformed to ST-NN approaches with the augmented features. Finally, in NP vs P2 the additional task of age estimation performed superior achieving 63.97%, which is also the highest attained result in this study.\nRegarding the overall achieved performances of MT-NN compared to the ST-NN approaches (i.e. original features vectors and augmented feature vectors), we observe an increase of 0.71% and 0.39% respectively, in relation to the mean pain estimation accuracy of all tasks. Figure 6 illustrate the comparison of every neural network approach presented in this study, according to multi-class and binary classification tasks as well."}, {"title": "Comparison with existing methods", "content": "Finally, in this section we compare our accomplished results utilizing the MT-NN employed the additional tasks of gender and age estimation, with corresponding studies which utilized the electrocardiography signals of the Part A of Bio Vid"}, {"title": "Conclusion", "content": "This work explored the application of multi-task learning neural networks for automatic pain estimation based on electrocardiography signals. Utilizing the Pan-Tompkins algorithm for the detection of QRS complexes we extracted essential features related to IBIs. Several experiments conducted in order to investigate the relation of gender and age with the pain manifestation, revealing the great influence of them to pain perception. Furthermore, we proposed two methods in order to exploit the demographic information enhancing the pain"}]}