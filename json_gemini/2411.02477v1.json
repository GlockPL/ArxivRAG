{"title": "Building a Synthetic Vascular Model: Evaluation in an Intracranial Aneurysms Detection Scenario", "authors": ["Rafic Nader", "Florent Autrusseau", "Vincent L'Allinec", "Romain Bourcier"], "abstract": "We hereby present a full synthetic model, able to mimic the various constituents of the cerebral vascular tree, including the cerebral arteries, bifurcations and intracranial aneurysms. This model intends to provide a substantial dataset of brain arteries which could be used by a 3D convolutional neural network to efficiently detect Intra-Cranial Aneurysms. The cerebral aneurysms most often occur on a particular structure of the vascular tree named the Circle of Willis. Various studies have been conducted to detect and monitor the aneurysms and those based on Deep Learning achieve the best performance. Specifically, in this work, we propose a full synthetic 3D model able to mimic the brain vasculature as acquired by Magnetic Resonance Angiography, Time Of Flight principle. Among the various MRI modalities, this latter allows for a good rendering of the blood vessels and is non-invasive. Our model has been designed to simultaneously mimic the arteries' geometry, the aneurysm shape, and the background noise. The vascular tree geometry is modeled thanks to an interpolation with 3D Spline functions, and the statistical properties of the background noise is collected from angiography acquisitions and reproduced within the model. In this work, we thoroughly describe the synthetic vasculature model, we build up a neural network designed for aneurysm segmentation and detection, finally, we carry out an in-depth evaluation of the performance gap gained thanks to the synthetic model data augmentation.", "sections": [{"title": "I. INTRODUCTION", "content": "THIS work has been carried out in the context of a wide medical research project in which neuroradiologists intend to estimate the risk of occurrence and/or rupture of Intra-Cranial Aneurysms (ICA) [1]. The advent of ICA formation results from various factors, among which the genetic risk seems predominant [2]. However, it is commonly accepted among physicians that the geometric disposition of the cerebral vascular tree might explain why a weakened vessel wall (due to genetic or environmental factors) might give rise to an aneurysm. Untreated brain aneurysms pose a significant risk of rupture, which can result in a hemorrhagic stroke. In fact, this rupture can potentially lead to the patient's death in as much as 50% of all cases. Magnetic Resonance Angiography (MRA), Time of Flight (TOF) modality is frequently used for aneurysms detection [3]. Unlike other methods like Digital Subtraction Angiography (DSA) and Computed Tomographic Angiography (CTA), TOF is radiation-free and doesn't require the administration of a contrast agent [4]. Given the mounting workload and the demanding nature of the detection process undertaken by radiologists, there is an increasing need for an automated tool to detect and monitor aneurysms at an early stage. Prior to the widespread adoption of Deep Learning (DL), research studies employed imaging filters or traditional machine learning techniques to detect aneurysms [5], [6]. Recent advances in artificial intelligence, particularly those involving deep Convolutional Neural Networks (CNNs), have significantly enhanced the development of automatic tools in the field of medical imaging [7]. To date, several deep learning based approaches have been proposed for ICA segmentation and/or detection [8]\u2013[11]. The ADAM Challenge compared 11 different DL approaches for detecting or/and segmenting ICAs on TOFs. The best algorithm, [12] achieved notable results, with an average sensitivity of 0.67 and a false positive rate of 0.13. It is important to note that a majority of the existing methods have been formulated using private clinical data that comes with meticulously refined manual annotations. Indeed, one of the obstacles in developing deep learning methods for medical imaging applications is the lack of large annotated datasets, particularly for the segmentation task. To mitigate this, Di Noto et al. [13] proposed the use of \u201cweak\u201d annotations and they obtained good results with an average lesion sensitivity of 0.83 and a false positive rate of 0.8. Other studies adopt non-voxel-based methods, such as mesh convolutional neural networks [14], to overcome limitations related to modality and scan acquisition parameters.\nThe rationale behind our work is to try to reduce as much as possible, or even to free oneself from any manual labeling. In other words, we expect that using several hundreds or even thousands of modeled bifurcation to train a network might provide better performances than using only a couple of hundreds actual TOF segmentations. Unlike previous works, in our approach, we investigate the brain aneurysm detection task by exploiting synthetic data. While data augmentation stands out as a well-known technique for augmenting the number of data samples, its application requires careful consideration. In the context of medical images, such image manipulations might tamper with the geometrical or statistical properties in an undesirable way, i.e. render the augmented images too distant from their corresponding ground truth."}, {"title": "II. MATERIAL AND METHOD", "content": "Unlike the previous model, proposed in [21], here we intend to come up with a full synthetic model of 3D cropped TOF portions, including not only the bifurcation of interest, but also its whole neighborhood\u00b9. Hence, we propose a completely new method here. Within a 3D cropped portion of a MRA volume, we collect the 3D coordinates of the arteries' skeleton (centerline of the 3D tubes), and we further fit those centerlines using 3D splines. It is quite vastly admitted that there can be a significant structural variability in the vasculature of individuals [22]. Indeed, one can find relatively strong variations among the shape of the Circle of Willis (CoW) (some arteries and bifurcations may be missing for some patients, or even some extra bifurcations could be present for others), and the anatomical properties of the cerebral arteries can also strongly differ from one person to another. The arteries' angles, their tortuosity, diameters or even their geodesic length can significantly differ.\nSuch an important variability can make the task quite difficult for neural networks to properly recognize and/or segment the bifurcations/arteries of interest. That is why our aim here is to propose a model being able to generate a vast amount of highly similar arteries, while adjusting at will the geometric features and the grey level amplitude of the vasculature, or even the statistical properties of the"}, {"title": "A. Modeling the arterial geometry", "content": "As a very first step, we extract a 3D graph from the segmented TOF volume (interested reader may refer to [23] for further details on the graph method being used). Obviously, any other 3D graph method, such as the one presented in [24] could be used. Such a graph is simply composed of 3D branches and nodes. A node is a branch extremity, i.e. either a bifurcation or a branch end point. From a binary segmented vasculature, the 3D graph allows to locate a given bifurcation among the ones composing the CoW and to extract a whole 3D crop around the 3D coordinates of the bifurcation node. The bifurcations of interest are automatically located thanks to the works from [25]. A 3D patch is cropped around the (x, y, z) coordinates of the detected bifurcation of interest (i.e. bifurcation forming the CoW). Within this cropped portion of the segmented TOF, the set of all coordinates along the branches are collected and curve fitting is used to represent the points using 3D splines functions [26].\nSpline functions can be represented by three different features: i) the knot-points, defining the intervals of the chunks on which the polynomials are defined, ii) the B-Splines' (or polynomials') coefficients, and iii) the order of the spline, (i.e. the degree to which the fit was performed). Once these parameters have been collected for each 3D branch composing the bifurcation, they can thus be easily modified in order to distort the centerline coordinates. Specifically, in this model, we only alter the polynomials coefficients.\nOnce the centerlines have been tweaked via the spline function alteration, we shall collect the diameters of all arteries being accounted for within the 3D crop. This can easily be handled by using our previous vascular tree characterization tool [23]. Each centerline (morphological skeleton) being first tweaked by the spline alteration, can thus go through a convolution with a spherical kernel which size is adapted to the corresponding observed diameter. We then thicken each artery according to its anatomical property.\nBesides the convolution with a spherical kernel, that is needed to set the artery's thickness, our method allows to set a target grey level amplitude. We simply multiply the binary envelope of the modeled vasculature by the desired target grey level. Moreover, for the thickened artery to have a realistic shape, it is important that the convolution kernel is not perfectly spherical. We hence apply elastic deformations to avoid producing a perfectly tubular modeled artery."}, {"title": "B. Modeling and adjoining the aneurysm", "content": "Once the bifurcation has properly been modeled, a synthetic aneurysm can finally be incorporated. A simple 3D sphere is first created and then distorted using elastic deformations. We use the geometric distortions from [27] (with $\\sigma\\in [0,6]$ and a 3 \u00d7 3 deformation grid). Further, the ICA center is aligned onto the bisector between the two daughter arteries. Figure 4 shows a configuration of aneurysm positioning.\nThe distance between point C and A being H + r, we can easily compute H, as follows:\n$\\tan \\theta = \\frac{R}{L}$ (1)\n$L = \\sqrt{H^2 - R^2}$ (2)\nHence,\n$\\sqrt{H^2 - R^2} = \\frac{R}{\\tan \\theta}$ (3)\nand, thus:\n$H = \\sqrt{(\\frac{R}{\\tan \\frac{\\theta}{2}})^2 + R^2}$ (4)\nThen, considering a growth parameter (\u03b3), being applied to modulate the distance H, the distance from the aneurysm center to the bifurcation node has been computed as in Eq. 5 below.\n$D = \\gamma*r + \\sqrt{(\\frac{R}{\\tan (\\Theta/2)})^2 + R^2}$ (5)\nwhere r is the ICA radius, R is the radius of the bifurcation branches, and \u0398 stands for the angle formed by the two daughter arteries (we assume \u03b8 = \u0398/2). Thanks to the growth parameter (\u03b3), we can automatically adjust the shift from the aneurysm center and the vessel wall where the daughter arteries split. Hence, we can model various states of growth for a given aneurysm (i.e. a neck being more or less present).\nIn the forthcoming experiments, the various parameters of the synthetic model were chosen, in such a way to best represent the anatomical properties of the vasculature, i.e. we have conducted a thorough evaluation of both the modeled bifurcations and the aneurysm sacs. Concerning the bifurcations, we ensured that the order of magnitude of the angles, diameters and tortuosities were respected by the model. As for the aneurysms, various geometric features were compared, such as the volume, surface, sphericity, elongation and flatness. This analysis led us to determine the model parameters as follows: The ICAs radii were chosen such that r\u2208 [0.4, 2.0] mm, the ICA growth parameter was in the range \u03b3\u2208 [0.7, 1.0], the spherical ICA was deformed with \u03c3\u2208 [1.0, 4.0], and the B-Spline coefficients was set to 2."}, {"title": "C. Modeling the surrounding brain matters", "content": "Now that we have been through the details of the shape modeling, let us next present the second part of the synthetic model: the brain, composed of fluids and white/gray matters, all these, being affected by a reconstruction background noise.\n1) Collecting the target statistics: As can be observed on Fig. 2, for the background generation (brain and noise), the cropped TOF patch first goes through a separation of the various brain components. In fact, based on the same rationale that was previously used (section II-A) to model the arteries, we can easily imagine to include the various brain matters within the model. Indeed, the cerebral arteries are surrounded by various matters, each one having a particular radio-opacity, i.e. a different gray level. The white/gray matter, when acquired through MRA appears with relatively high gray levels, the Cerebro-Spinal Fluids (CSF), the ventricle or the Corpus Callosum are commonly displayed with much lower luminances. However, unlike our previous study [21], the"}, {"title": "2) Noise generation", "content": "When a Gaussian blur is being applied onto an input image I(x, y) its filtered version becomes:\n$O(x,y) = \\sum_{i=-\\infty}^{\\infty} \\sum_{j=18}^{00} \\frac{1}{2\\pi \\sigma_G} e^{\\frac{-i^2+j^2}{2 \\sigma_G^2}} I(x + i, y + j)$ (6)\nThe Bienaym\u00e9's identity states that\n$\\operatorname{Var} (\\sum_{i=1}^n X_i) = \\sum_{i=1}^n \\operatorname{Var}(X_i) + \\sum_{i,j=1,1\\neq j}^n \\operatorname{Cov}(X_i, X_j)$ (7)\nThus, the variance of a linear combination is:\n$\\operatorname{Var} (\\sum_{i=1}^n C_iX_i) = \\sum_{i=1}^n \\operatorname{Var}(X_i) + 2\\times\\sum_{i,j=1,i (\\sum\\sum^\\frac{1}{2 \\pi {\\sigma_G}^2} e^{\\frac{i^2+j^2}{2 {\\sigma_G}^2}} d_i.d_j$ (11)\n$\\sigma_f \\approx \\frac{{\\sigma}_0}{2 {\\sigma_G}^2 \\pi}$ (12)\nIn summary, when an image composed of Gaussian noise of standard deviation \u03c3\u2080 is being filtered by a Gaussian filter of standard deviation \u03c3g, the so-obtained filtered image has a standard deviation of according to the Eq. 12.\nHowever, for our particular purpose, we intend to determine which Gaussian filter (of standard deviation \u03c3g) shall be used"}, {"title": "D. Model examples", "content": "Concerning the bifurcation model only (i.e. no adjoined aneurysm),\nBesides the bifurcations themselves, it is crucial for the aneurysm to be accurately modeled and most importantly well positioned onto the bifurcation artery wall.\nIt is important to note that, so far, the synthetic aneurysm model can only reproduce the unruptured and untreated aneurysm. Indeed, ruptured or treated aneurysm presents significant differences, treated aneurysms are radiolucent (hypointense signal), and can easily be mistaken by surrounding fluids, whereas ruptured aneurysms present very different shapes (higher order spherical aberrations, larger elongation, etc.).\nNaturally, a simple visual inspection by itself (as in Fig. 6) is not sufficient to accurately estimate the faithfulness of the synthetic model. Hence, we also provide a quantitative (objective) assessment of the modeled bifurcations.\nWe show on Figure 6 the distribution of two distinct objective quality assessment metrics from 1000 patches (2D slices randomly extracted from 150 TOF volumes).\nOverall, 9 metrics have been tested (MSE, PSNR, NRMSE, NMI, SSIM, VI, NQM, VIF and UQI) [29], [30], but most exhibited similar behaviour, and hence, we only present the results for PSNR and VIF (which was proven to perform better on MRI/CTA acquisitions [29], [31]). Each sub-plot in Figure 6 presents, along the x-axis i) the comparison between distinct patients, ii) the comparison between a given ground truth patch and its modeled version, and iii) the"}, {"title": "E. Applications of such a synthetic model", "content": "Such synthetic images could be very useful for a large range of scenarios:\n1) In a medical center having few images, one could imagine generating a massive training dataset targeting the features of the MRA acquisitions.\n2) The synthetic model can be exploited for other computer vision / pattern recognition tasks, such as vasculature segmentation, bifurcations detection/classification, or even stenosis/thrombosis detection.\n3) If a new MRA scanner was being brought to the market (higher magnetic field, better resolution,...), we could promptly provide a massive annotated dataset, without resorting to tedious manual annotations from expert.\n4) The model can provide a relatively easy adaptation to other imaging devices (such as DSA or CTA).\n5) Ultimately, such a model could be used to detect aneurysms on a healthy dataset (where no patient actually bears an aneurysm)."}, {"title": "III. EXPERIMENTAL RESULTS", "content": "The main purpose of this synthetic model is actually to be able to effortlessly build up significant images datasets in order to efficiently train convolutional neural networks for pattern recognition tasks. In this section, we present experimental results related to the use of synthetic images as a source of data augmentation within an intracranial aneurysm detection scenario. Indeed the synthetic model is used to generate a substantial training dataset to feed a 3D U-Net model. Fig. 7 shows an overview of the entire aneurysm detection process. The U-Net is trained on both the synthetically generated images and some actual TOF acquired from patients with aneurysm\u00b2. The trained U-Net model is then applied onto some extracted bifurcations during the inference phase.\nWe will first introduce the Deep Learning based method being used, along with the corresponding dataset, the training strategy and the evaluation approach. Finally, we will evaluate the efficiency of our approach, and estimate the benefit of adjoining synthetic images for the CNN training step."}, {"title": "A. DL based detection of intracranial aneurysms", "content": "1) Dataset: For this study, a total of 190 TOFs scans of unruptured intracranial aneurysms were collected from over thirty different French institutions\u00b3. Furthermore, 14 additional TOF images not containing any aneurysm were included in the test set to evaluate the performances of the developed model.\nOverall 254 aneurysms are included in this study (presenting a mean radius of 2.49\u00b10.82 mm)."}, {"title": "4) Evaluation approach", "content": "To validate the possible improvements brought by the use of the synthetic model, we have conducted three separate experiments. In the first experiment (Exp.#1), we have trained a baseline model using actual TOFs patches. To assess the performance of our model, we employed a four fold cross-validation approach. The dataset was split into four folds with each fold containing 27 samples. During each cross-validation split, three folds (81 samples) were exploited to train the model, while the remaining fold (27 samples) was used for validation purposes and for hyperparameter optimization. This process was repeated four times, to ensure that all 108 TOFs were ultimately used for evaluation. In the second experiment (Exp.#2), we trained another segmentation network but augmentating the training dataset with 998 synthetic patches. Similarly, we evaluated the performance of the model using the same cross-validation split. In Exp.#3, the training dataset of actual TOF patches was augmented using traditional data augmentation operations, namely rotations within the interval [-15\u00b0, +15\u00b0] and (90\u00b0, 180\u00b0, 270\u00b0), as well as horizontal and vertical flipping. Following the training phase, the model evaluation employs the holdout test set using the four-fold models. Subsequently, the resulting predictions from these four models were averaged to derive the final predictions. In the inference phase, for the three mentioned experiments, we adopt a prior anatomical selection of patches. We only retain the patches being centered onto all the bifurcations of the cerebral vasculature. By focusing on patches centered around the cerebral artery bifurcations, the inference process aims to target the regions being most susceptible to witness an aneurysm development. This approach is based on the anatomical knowledge of aneurysm occurrence, enhancing the accuracy of the results. Hence, as previously explained, to select the corresponding patches, an automated vessel segmentation step was performed using a pre-trained U-Net segmentation algorithm. The details of the specific pre-trained network can be found in [25]. Then, a 3D undirected graph [23] is generated from the extracted skeleton to extract the corresponding bifurcations.\nFor all the experiments, we have analyzed the lesion-level sensitivity and the false positive rate (number of false positive per TOF). The lesion-level sensitivity quantifies the proportion of true aneurysms correctly identified by our method, while the false positive count per TOF provides insights about the method possibly producing an excessive number of false identifications, which could lead to an unnecessary burden for the neuroradiologists. To compute the detection performance evaluation metrics, we consider each segmented connected component issued from the binary output of the U-Net as a potentially detected object. Each connected component whose center of mass falls no farther away from the maximum radius of a true aneurysm mask, is thus considered as a true positive detection. Otherwise, it is regarded as a false positive detection.\nIn addition, we applied the evaluation protocol for assessing the segmentation performance of true (ICAs) as described in the ADAM challenge [11]. This protocol focuses on evaluating the segmentation metrics only for the true detected ICAs, excluding any false positives, to simulate how the tool could be practically used by neuroradiologists."}, {"title": "B. Performance analysis", "content": "Let us now examine the performances of our proposed method on the test set, in terms of global detection rate as well as on a per-bifurcation scenario.\n1) Overall detection performance: As previously mentioned, the study compares the performances of three CNN training approaches. In Exp.#1, the CNN which is exclusively trained onto real data, successfully identified a total of 96 aneurysms within a dataset containing 127 instances, which corresponds to a lesion-level sensitivity of 75.60%. In contrast, Exp.#2 involves training the same CNN using a combination of real data patches and VaMos data patches. Notably, this sensitivity further improved to 88.97% for Exp.#2 with 113 detected aneurysms. Meanwhile, when considering traditional data augmentation techniques in Exp.#3, the CNN identifies 104 aneurysms which corresponds to a lesion-level sensitivity of 81.88%.\n2) False detections: These results show a high diagnosis performance, with lesion-wise sensitivity notably improving by incorporating synthetic patches, reaching 89% on the test set. The synthetic data proved useful as a complementary tool to reduce the missed aneurysms rate. However, obtaining a high sensitivity may unfortunately lead to a slightly higher false-positive detection rate. Overall, the network exhibits an average false positive rate of 0.22 in Exp.#1, whereas when incorporating synthetic patches, the false positive rate reaches 0.40. Similarly, traditional data augmentation techniques employed in Exp.#3 were associated with an increase of FP rate (0.36). The increase in the false positive rate upon integrating synthetic patches, along with the significant sensitivity gain, emphasizes the importance of adopting Exp.#2. This illustrates the trade-off between sensitivity and false positive rate and highlights the added value of the synthetic data augmentation.\nBased on a thorough visual inspection of the false-positive detections, we have identified various reasons for these FP, including 1) The complex anatomy of the internal carotid artery, with sometimes rather strong variations in vessel diameter, a high tortuosity, and a significant bending, right below the ophtalmic artery that can be confused with a large aneurysm; 2) Brain arteries are susceptible to flow-related changes due to factors such as atherosclerosis (calcified plaque) or stenosis. These conditions can alter blood flow patterns and vessel appearance, potentially leading aneurysm-like vessels shapes, and hence, false-positives. 3) At the emergence of a daughter artery on a bifurcation, at the very basis of the artery, an outpouching can be formed. In other words, the artery stars with a conic shape, exhibiting a broad base located at the bifurcation. This is clinically referred to as an infundibulum [34]. Sometimes, such uncommon shapes can be mistakenly detected as being an aneurysm. 4) Our vascular model has been designed in such a way to model thrombosed aneurysms. Indeed, we have noticed that for the larger circular aneurysms, a thrombosis often appears nearby the ICA center; the blood flow may circulate along the aneurysm walls, forming some sort of vortex, and hence, leading to a slower blood displacement toward the center (inducing a more radio-opaque area). Unfortunately, such a phenomenon can also occur along the Internal Carotid Artery, thus leading to false positive detections.\n3) Impact of aneurysms size and locations: The performance variability when considering aneurysm size, is depicted in Table V. Exp.#1 yielded a detection rate of 0.5106 for very small aneurysms (less than 2 mm), while Exp.#2 achieved an improved rate of 0.7659 and Exp.#3 exhibited a detection rate of 0.6382 The CNN was able to detect a greater proportion of aneurysms falling within the size range of 2 mm to 3 mm. This trend was observed in the three experiments, with a notable increase observed for Exp.#2 (0.8840 and 0.9130 versus 0.9565). All methodologies, however, demonstrated a detection rate of 1 for aneurysms with a radius exceeding 3 mm.\nRegarding the impact of aneurysm location, Fig. 8 depicts the number of missed aneurysms per bifurcation of interest. Specifically, in Exp.#1, the CNN missed a higher number of aneurysms located along the Middle Cerebral Artery (MCA) (G-H bifurcations), as well as along the Internal Carotid Artery, with a significant concentration in the bifurcation segment separating this artery into the smaller Ophthalmic Artery (OA) (labels K & L). Additionally, missed aneurysms are observed within the branches of the Anterior Cerebral Artery (ACA) and the Posterior Communicating Artery (PCOM), which corresponds to bifurcations (E, F, I & J).\nIn contrast, for Exp.#2, there is a substantial decrease in the number of missed aneurysms within the three locations cited below. The impact of the aneurysm location on the detection rates for the three experiments is presented in Table VI. One can notice on this Table that for each bifurcation label, the amount of collected aneurysms matches remarkably well the percentages of occurrences as previously described on Fig. 1. Hence anatomically, we are able to collect fewer aneurysms onto certain bifurcations. Moreover, it is important to highlight that fewer synthetic aneurysms can be modeled onto the bifurcations labeled C, D, N and O (c.f., Table III) as, quite often, during the angiography exam, these bifurcations (at the farther ends of the MRA 3D stack) may be cropped out of the acquisition area.\n4) Segmentation performance of true ICAs: Fig. 9 displays the distribution of Dice score for the detected aneurysms within the three experiments #1, #2 and #3. The average Dice score for Exp.#1 is 0.7585 (\u00b10.13) which indicates a fairly good similarity with the actual aneurysms masks. Exp.#2 and Exp.#3 achieve a comparable Dice score of 0.7613 (\u00b10.12) and 0.77 (\u00b10.11). It is important to note that a direct comparison between the three Dice coefficients is to be considered carefully, as the number of detected aneurysms differs between the experiments.\n5) Ablation study: To validate the various constituents of VaMos, we performed an ablation study on the aneurysm detection task, using different configurations.\nIn order to assess the impact of the noise on the overall detection performances, we have modeled the same augmented ICA patches but with different noise distributions [35]: Gaussian, Perlin and Rician. The results of our experiments are summarized in Table VII. Although Gaussian and Rician displayed similar effectiveness, Gaussian noise demonstrated a marginally higher sensitivity and a slightly better false positive detections. Perlin noise, on the other hand, demonstrated lower sensitivity (81%) and a higher false positive rate (0.56 per case). Given these factors, Gaussian noise is deemed more advantageous for our specific task of data augmentation.\nFurthermore, we compared the performance of the detection network using increased number of (VaMos) augmented patches size: A1 (334 patches), A2 (622 patches) and A3 (998 patches). Obviously, for all three configurations, the test was conducted on the holdout test data. As illustrated in Table VII, the addition of synthetic patches consistently improves sensitivity. This suggests that the model becomes better at identifying true positives with more diverse training data. The initial spike in false positives with (TOF+A1) indicates that while synthetic patches help in identifying more true positives, they also introduce noise, leading to more false positives. However, with further augmentation (TOF+A2 and TOF+A3), the model seems to learn to better distinguish between true positives and false positives, as witnessed by the reduction in FP/case.\n6) Comparison with nnU-Net: We have assessed the effectiveness of our method on the traditional detection task by comparing it with the fully automated state-of-the-art baseline, nnU-Net [36]. nnU-Net is a self-configuring deep learning framework designed for biomedical image segmentation that automatically adapts its architecture and hyperparameters to optimize performance for different datasets. To ensure a fair comparison and reproducibility of the results, we employed 4-fold cross-validation. Our method showed competitive performance achieving a sensitivity of 89% associated with a FP/case of 0.4. In comparison, nnU-Net achieves a sensitivity of 82% with a lower FP/case of 0.125. Table VIII illustrates the reason for our higher sensitivity, which is attributed to higher detection of small aneurysms (15 % increase). VaMos introduces variability in small aneurysms. Such a shape variability cannot be produced by traditional augmentation, and hence cannot be considered within nnU-Net."}, {"title": "IV. DISCUSSION AND CONCLUSION", "content": "In this section, we analyze the contribution brought by the synthetic vasculature model, being able to faithfully counterfeit (while cleverly altering) portions of TOF images. Indeed, the synthetic model is composed of various processes, including a meticulous modeling of the cerebral arteries and bifurcations geometry, alongside the introduction of surrounding noise and finally, embedding aneurysms of various sizes and shapes. Our goal is to provide a substantial dataset that may improve the performances of several deep learning tasks including the segmentation or detection of the cerebral aneurysms. A salient highlight of our work is the successful generation of synthetic aneurysms with varying sizes, shapes, and locations. These artificial aneurysmal sacs have been integrated into modeled MRA scans originally lacking any aneurysm, thus resulting in an augmented dataset that aligns more closely with real-world scenarios. The important focal point of this approach is the strategic positioning of cerebral aneurysms within the Circle of Willis, enhancing the fidelity of the simulated model.\nAs the main finding of this study, the CNN trained using a combination of both genuine and synthetic patches led to a significantly improved sensitivity in detecting intracranial aneurysms compared to a CNN trained solely on TOF data and/or augmented with traditional data augmentation techniques. While the network missed 24.4% of the lesions on the test data in Exp.#1, including the VaMos patches during the training step significantly improved the ICA detection performances of the CNN. Indeed, the network missed a smaller portion of aneurysms (only 11%) on the test set. Only 14 aneurysms were missed in Exp.#2: eleven were tiny aneurysms, two exhibited uncommon shapes (high order spherical aberrations), and finally, one was presenting a shape strongly similar to an infundibulum (no clearly delineated aneurysm neck). Traditional data augmentation techniques led to a modest increase in sensitivity (4%) compared to the significant improvement seen with VaMos (13%). This disparity highlights the limitations of traditional methods. These conventional techniques mainly improve the model's ability to generalize from existing data but fail to introduce substantial diversity in critical anatomical features like aneurysm shape and size. Consequently, they are less effective in training models to identify a wide variety of aneurysms across different patients. On the other hand, advanced generation models like VaMos generate more complex and varied synthetic examples, incorporating significant variations in aneurysm characteristics, which enhances the model's performance.\nThis research has successfully achieved a high level of detection sensitivity, showcasing its potential as supplementary tool for neuroradiologists to address the issue of overlooked aneurysms. Nevertheless, it is important to note that the integration of synthetic patches, while effective in boosting sensitivity, can potentially contribute to a slightly increased false-positive rate. This issue might arise if the synthetic patches actually introduce irregular aneurysms shapes that do not very faithfully reflect the genuine aneurysm sacs as acquired on TOFs. However, the training methodology, employed alongside with a judicious selection of the synthetic model parameters has yielded an improved detection performance while maintaining an acceptable rate of false-positive detections. Specifically, the false-positive detection rate stood at 0.40 within Exp.#2, in contrast to 0.22 in Exp.#1. While the increase in the FP from 0.22 to 0.4 represents an 18% absolute increase, this is often considered reasonable within the healthcare context. False positives primarily lead to additional diagnostic procedures, which, although not ideal, are less harmful compared to the risks associated with undetected aneurysms. The ability to maintain a minimal count of false-positive detection rate can also be explained by 2 factors: To begin with, the use of a prior selection of patches (3D undirected graph generated from the skeleton, as explained in sec. III-A.4) during the inference phase by extracting patches around vascular bifurcations. Consequently, this approach minimizes the susceptibility of the algorithm to confuse non-vessel structures and reduces the likelihood of incorrect predictions. Furthermore, the final prediction on the test set is derived by aggregating the probabilities obtained from 4 cross validation models. This strategy enhances the overall robustness of the model's predictions. Moreover, the mean Dice score index of true ICAs is 0.76 which is relatively high. This suggests that this automatic segmentation method performs at a similar level to manual segmentation once the true ICA has been correctly identified. The automatic segmentation could save time and effort in the analysis of medical imaging data and potentially improve the efficiency in diagnosing and analyzing ICAs.\nRegarding the aneurysm size, our analysis demonstrated that there were no significant discrepancy in sensitivity for large aneurysms. Indeed, the sensitivity reached 100% for aneurysms having a radius larger than 3 mm for all experiments. The CNN achieved an overall sensitivity of 51.06% for detecting aneurysms being smaller than 2 mm in Exp.#1, which complies with common findings in state-of-the-art aneurysm detection studies. For such small aneurysms, the sensitivity may increase with the number of training cases involved. Notably, in Exp.#2, the sensitivity value increased to 76.59% by training the model with small sizes synthetic aneurysms. Nevertheless, enhancing the diagnostic performance of the model in detecting small aneurysms may need further exploration and training with a larger set of synthetic cases representing small aneurysms.\nWith regard to the sensitivity at different locations, the Exp.#2 achieved better performances than Exp.#3 for aneurysms situated onto the bifurcations G-H, E-F-I-J. It is important to note that this sensitivity increase appears to be more strongly linked to the size of aneurysms in these specific locations rather than solely on the location itself. In fact, the detection rates stratified according to aneurysm location and size were compared using Fishers' exact test. No significant difference was found between different locations (p-value=0.69). However, the statistical analysis revealed a significant difference in aneurysm detection rates when stratified by different sizes (p-value=0.005).\nIndeed, it is important to interpret the sensitivity values for the categories C-D and M-N-O with careful consideration. Particularly so, as the dataset comprises only few aneurysms in those locations compared to other locations. For future investigations, it could be valuable to explore the CNN efficiency with a larger population, i.e., incorporating more aneurysms located in regions such as M-N-O, and C-D.\nThis study has been conducted on TOF acquisitions only, however, the model is, in its very nature, quite flexible and"}]}