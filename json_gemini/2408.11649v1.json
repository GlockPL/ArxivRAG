{"title": "Video-to-Text Pedestrian Monitoring (VTPM): Leveraging Computer Vision and Large Language Models for Privacy-Preserve Pedestrian Activity Monitoring at Intersections", "authors": ["Ahmed S. Abdelrahman", "Mohamed Abdel-Aty", "Dongdong Wang"], "abstract": "Computer vision has advanced research methodologies, enhancing system services across various fields. It is a core component in traffic monitoring systems for improving road safety; however, these monitoring systems don't preserve the privacy of pedestrians who appear in the videos, potentially revealing their identities. Addressing this issue, our paper introduces Video-to-Text Pedestrian Monitoring (VTPM), which monitors pedestrian movements at intersections and generates real-time textual reports, including traffic signal and weather information. VTPM uses computer vision models for pedestrian detection and tracking, achieving a latency of 0.05 seconds per video frame. Additionally, it detects crossing violations with 90.2% accuracy by incorporating traffic signal data. The proposed framework is equipped with Phi-3 mini-4k to generate real-time textual reports of pedestrian activity while stating safety concerns like crossing violations, conflicts, and the impact of weather on their behavior with latency of 0.33 seconds. To enhance comprehensive analysis of the generated textual reports, Phi-3 medium is fine-tuned for historical analysis of these generated textual reports. This fine-tuning enables more reliable analysis about the pedestrian safety at intersections, effectively detecting patterns and safety critical events. The proposed VTPM offers a more efficient alternative to video footage by using textual reports reducing memory usage, saving up to 253 million percent, eliminating privacy issues, and enabling comprehensive interactive historical analysis.\nKeywords: Pedestrian Privacy-Preserve, Large Language Models, Real-time Monitoring Systems.", "sections": [{"title": "1. Introduction", "content": "Intelligent systems powered by Artificial Intelligence (AI) are revolutionizing the field of traffic safety and transportation, and their impact on pedestrian safety is particularly significant (Gangwani and Gangwani, 2021). Pedestrian safety holds a critical place in the broader context of traffic safety and transportation planning (El Hamdani et al., 2020). As cities expand and transportation networks become more complex, the importance of safeguarding pedestrians, often the most vulnerable road users (WHO, 2013), cannot be overstated. Ensuring pedestrian safety is not just a matter of reducing fatalities and injuries but also a foundational element in the pursuit of sustainable urban living and mobility (Aceves-Gonz\u00e1lez et al., 2020). Globally, pedestrian safety is a pressing concern, given the alarming statistics of accidents, where in 2020, the United States experienced 6,516 pedestrian deaths due to traffic accidents, marking a 3.9% rise from the 6,272 fatalities recorded in 2019. Additionally, approximately 54,769 pedestrians sustained injuries, according to the National Highway Traffic Safety Administration (NHTSA, 2022). Pedestrian fatalities represent 17% of all traffic fatalities, with an increase of 53% in 2018 compared to 2009 (GHSA, 2020). Pedestrians constitute a significant percentage of traffic fatalities worldwide (Zegeer and Bushell, 2012), highlighting the urgent need for comprehensive safety measures. This situation demands a multifaceted approach, integrating engineering, education, and enforcement to create safer urban environments.\nIn the pursuit of enhancing pedestrian safety and creating more efficient transportation systems, the integration of intelligent systems powered by AI is emerging as a game-changer. As cities continue to grow and urbanize, the complexities of managing pedestrian traffic and ensuring their safety on our roads have become increasingly challenging (Cervero et al., 2017). Fortunately, AI-driven technologies offer promising solutions to address these challenges, ushering in a new era of intelligent transportation systems (De Souza et al., 2018; El Hamdani et al., 2020). Many systems have been addressing pedestrian safety by monitoring their movements and actions at roads especially at intersections, where it is the road junction that captures all road users (Eom and Kim, 2020). These systems monitor pedestrian activity and estimate any safety related concerns, since they are vulnerable to any interaction with other motorized vehicles (Miranda-Moreno et al., 2011). Among various sensors integrated at intersections to monitor pedestrian activity, cameras is the most dominant sensor for this purpose (Mirhashemi et al., 2022). Surveillance cameras are installed at intersections to monitor pedestrians and their activity"}, {"title": "2. Related Work", "content": "Visual privacy-preserving methods hide some of the original information in line with regulatory data protection laws and individual privacy needs. Image filtering techniques such as blurring (Frome et al., 2009) and pixelation (Boyle et al., 2000) are widely used to improve privacy. The person can be easily identified using visual ques, such as clothing information even if face is completely covered with black box. Visual data should obfuscate all private information to provide complete privacy. Zheng et al. (Zhang et al., 2010) introduces a system that protects privacy in video surveillance by encrypting pedestrians' faces/heads. Utilizing a two-state Markov chain for tracking and elliptical head contour detection, the system obscures faces with a unique encryption code. This allows authorized personnel to selectively reveal identities while maintaining privacy for others. Sun et al. (2018) presents a technique to protect privacy in social media photos by generating realistic head inpainting. This method uses facial landmarks to inpaint new heads that blend seamlessly with the background, outperforming traditional blurring and blacking out methods in both natural appearance and identity obfuscation.\nAlthough face blurring techniques are useful and can blurry the faces, blurring only the face might not be insufficient for privacy preservation because they fail to completely obfuscate identity information (Agarwal et al., 2021). Even if advanced techniques are used for face blurring still the pedestrian can be identified from his personal appearance (Brkic et al., 2017). As such others investigated other possibilities by mask the human body with an avatar representation. Kunchala et al. (2023) introduced a framework that uses 3D avatar reconstruction and digital in-painting to anonymize pedestrians in video data. This method preserves pose, shape, and background context while enhancing privacy compared to traditional blurring and"}, {"title": "3. Methodology", "content": "In this paper, Video-to-Text Pedestrian Monitoring (VTPM) is introduced to address the key issues related to camera surveillance for monitoring pedestrian activity, particularly at"}, {"title": "3.1 VTPM Pipeline", "content": "VTPM pipeline consists of three primary components, as represented in Fig. 1. The first component is pedestrian activity monitoring, which utilizes state-of-the-art deep learning and computer vision techniques and models to observe pedestrian activity and the interactions between pedestrians and turning vehicles. These interactions with vehicles that are turning, particularly to the right, are frequently the cause of most pedestrian-vehicle near-miss incidents, potentially leading to significant accidents (Buch and Jensen, 2017; Chen et al., 2022). Such incidents often occur when distracted drivers fail to notice pedestrians crossing during their right turn, despite pedestrians proceeding based on the controlled system's go-ahead during their designated crossing phase. This is the critical moment when most near misses occur between turning vehicles and pedestrians. It is important to note that this problem of hazardous interactions also extends to autonomous vehicles (AVs), where the engagements between pedestrians and right-turning AVs pose the greatest danger (Alozi and Hussein, 2023), primarily due to either pedestrians violating crossing rules or the limitations of the AVs' perception systems in detecting and predicting pedestrian crossings. To capture the pedestrian activity at the waiting area at the intersection and their interactions with right-turning vehicles, a camera is placed on the mast arm of the traffic pole to monitor the ongoing events."}, {"title": "3.2 Monitor: Pedestrian Activity Monitoring", "content": "Monitoring activity of pedestrians requires two essential blocks, detection and tracking, to be able to track each pedestrian and extract their corresponding trajectory to estimate the speed and heading. Additionally, for calculating surrogate safety measures (SSM) between pedestrians and right-turning vehicles, which is the main cause of pedestrian-vehicles crashes, vehicle detection and tracking is also required. After investigating state-of-the-art deep learning models and computer vision techniques and conducted comparisons among many object detection models, RT-DETR is the best candidate for object detection. RT-DETR is the improved model architecture of DETR and its large model has achieved the highest average precision score (AP) and processing speed on COCO val2017 outperforming the state-of-the-art YOLO detectors and DETRs in both speed and accuracy (Zhao et al., 2024). For tracking, bytetrack is the fittest tracking algorithm for this system, since it has achieved higher performance metric than many other tracking methods on MOT17, MOT20, and Multiple Object Tracking in Highway Videos (Abouelyazid, 2023; Zhang et al., 2022). RT-DETR and ByteTrack will be used to monitor the movements of pedestrians at intersections and right-turning vehicles to extract their corresponding trajectories."}, {"title": "3.2.1 Conflict Analysis using Surrogate Safety Measure", "content": "By extracting the trajectories of the pedestrians and right-turning vehicles, Surrogate Safety Measures (SSMs) can be derived, and in this work, we will specifically focus on the Time to Collision (TTC) metric (Lee, 1976). The decision to use only TTC is motivated by the need to maintain the monitoring system and report generation processes in real-time, as calculating multiple SSMs requires significant computational resources. TTC is calculated when there is a potential interaction between pedestrians and right-turning vehicles, estimating the time remaining before a collision would occur if the current trajectories continued unchanged. By analyzing TTC, we can identify and highlight any recurring safety concerns at the intersection involving pedestrians and right-turning vehicles (Hagiwara et al., 2008; Vogel, 2003; Xin et al., 2021). The values of TTC are categorized as follows: less than 1.5 seconds: serious conflict, between 1.5 and 3 seconds: slight conflict, more than 3 seconds no conflict. TTC provides"}, {"title": "3.2.2 Crossing Violation Detection", "content": "One of the critical safety events to capture is pedestrian crossing violations at signalized intersections. These violations expose pedestrians to conflicts with approaching vehicles, potentially leading to serious crashes (Zhang et al., 2021). To determine if a pedestrian crossed during the designated signal phase, pedestrian phase signal timings will be imported via the Automated Traffic Signal Performance Measures (ATSPM) API provided by FDOT services. ATSPM provides the start and end times of the pedestrian signal phase. Fig. 2 illustrates the detection process for crossing violations: if a pedestrian crosses during the pedestrian phase, it is considered a safe crossing. However, if the pedestrian crosses outside the designated phase, it is identified as a crossing violation. This information is essential for analyzing pedestrian safety and implementing measures to reduce potential conflicts and accidents."}, {"title": "3.3 Reporter: Pedestrian Activity Report Generation", "content": "To generate real-time reports on pedestrian activity, fast large language models (LLMs) are essential. Although there are many relatively small LLMs available, not all achieve high performance on well-known benchmarks such as the Measuring Massive Multitask Language Understanding (MMLU) dataset (Hendrycks et al., 2020). Several small in size LLMs were selected for testing their inference speed (tokens/second) and reasoning quality (MMLU score). As shown in Fig. 3, the phi3-mini LLM stands out as the most capable among the small LLMs, with a context window of 4k, which is sufficient for generating reports on pedestrian activity. Notably, this powerful yet compact LLM, with its high reasoning score compared to larger"}, {"title": "3.4 Analyzer: Historical Analysis", "content": "For comprehensive historical analysis of the generated pedestrian activity reports, an LLM with long context window is required with high reasoning capabilities to process large number of reports and extract anomalies, patterns, safety concerns, and other insights. Choosing the best LLM for this task involves comparing various large models based on their performance and capabilities. Fig. 4 presents the conducted comparison between eight LLMs, showing that the Phi-3 medium LLM achieves a high reasoning score on the MMLU benchmark more than most of the other LLMs while offering the longest context window among the models tested. This makes Phi-3 medium particularly suitable for in-depth historical analysis, as it can effectively handle extensive database and provide meaningful insights and patterns."}, {"title": "3.5 LLM Fine Tuning", "content": "LLMs are trained on general knowledge to excel in many tasks, however, being more domain specific is needed to make the LLM more familiar with traffic safety and pedestrian safety domain. Therefore, a custom dataset has been gathered including information and extracted from conducted studies and analysis on traffic safety at intersections. Due to the large size of Phi-3 mini and Phi-3 medium models, full fine-tuning is computationally intensive. A more efficient method is Adapter-Based Performance Efficient Fine-Tuning (PEFT), specifically the low-rank adaptation (LoRA) technique (Hu et al., 2021). LoRA performs as well as or better than full fine-tuning and prevents overfitting and catastrophic forgetting (Biderman et al., 2024). To further reduce computational demands, quantization is used, converting model parameters from higher bit-width formats to lower ones, like 8-bit integers. This approach, combined with LoRA, is known as QLoRA (Quantized Low-Rank Adapter). QLoRA uses 4-bit NormalFloat (NF4) and double quantization, significantly reducing memory usage without sacrificing performance (Dettmers et al., 2024). Fig. 5. illustrates the QLoRA fine-tuning process for the LLMs. The process begins with loading a JSON database of question-and-answer pairs from over 200 studies. The base model is then loaded and the dataset tokenized. The model is quantized from FP32 to NF4, and LoRA parameters are set for fine-tuning. During this process, the base model's parameters remain unchanged, and only the adapters are updated. After finishing the fine-tuning, the LoRA adapters will be merged with the base LLM to be ready for deployment. The fine-tuning process through QLoRA is conducted on an Nvidia A10G 24 GB GPU and took approximately 25 minutes to fine-tune Phi-3-mini and 1.22 hours to finish fine-tuning Phi-3- medium."}, {"title": "4. Results", "content": "4.1 Experiment Results of the Pedestrian Activity Monitoring and Reporting\nThis section provides the analysis of pedestrian activity monitoring over a 4-hour video stream (2 hours in daytime and 2 hours in nighttime), capturing the movements of 73 pedestrians, and generating textual reports about their activity every hour as shown in Fig. 6. The analysis revealed numerous instances of crossing violations. While most of these violations did not lead to conflicts, there was one significant incident involving a pedestrian and a right-turning vehicle, where the pedestrian was at fault for crossing before the pedestrian signal was activated. Using the coding capabilities of the Phi-3-medium LLM, it generated the charts shown in Fig. 7 and Fig. 8. These charts analyze the generated reports of the pedestrian activity, highlighting safety- critical events and providing informative visualization of pedestrian activity at intersection. Additionally, they show the percentages of crossing violations versus safe crossings per crosswalk, breaking down the activity by direction. As shown in Fig. 7, crosswalk A experienced higher pedestrian traffic compared to crosswalk B. However, crosswalk B exhibited a significantly higher rate of crossing violations, with 72.2% of cases being violations, compared to only 18.2% at crosswalk A. This high percentage of violations at crosswalk B was primarily due to an hour of rainfall, which influenced pedestrians to violate the signal and cross. This analysis underscores the importance of targeted interventions to improve pedestrian safety, particularly at crosswalk B. Furthermore, most of the crossing violations happened during nighttime with 76% compared to 24% during daytime, and raining influence pedestrians to violate the signal, as visualized in the generated charts in Fig. 8."}, {"title": "4.2 Human Evaluation of Analytical Text Generation by LLM", "content": "To ensure that the fine-tuned Phi-3 medium (The Analyzer) is capable of analyzing the generated reports by the Reporter as shown in Fig. 6 reflecting the traffic safety concerns of the pedestrian activity, a historical analysis was conducted using data of another day capturing the pedestrian activity over 15 hours (8 am to 11 pm) with varying rain intensities. This analysis aimed to assess the influence of weather on pedestrian behavior and evaluate the system's ability to identify critical safety conditions. The goal was to verify the reasoning and summarization capabilities of the Analyzer in comparison to the base model and other high-performing LLMs. From the previously shown Fig. 4, Llama3 70B achieved the highest MMLU score, followed by Mixtral 8x22B and the pretrained Phi-3 medium 14B model. For qualitative evaluation, 15 reports were generated, summarizing pedestrian activity every hour, including crossing events, violations, conflicts with right-turning vehicles, and weather conditions. A questionnaire was conducted with 16 doctoral and post-doctoral researchers in the field of traffic safety using three evaluation metrics to verify the quality of the fine-tuned phi-3 medium (Analyzer) for historical analysis over several reports covering almost a whole day. The first metric assessed the clarity and accuracy of the textual reports, which were formatted as, [date, time, and location] [weather condition] [pedestrians count] [crossing violations] [conflicts] to ensure consistency among the reports. These reports summarized 15 hours of pedestrian activity from 8 am to 11 pm. The second metric evaluated the reasoning capability of the generated reports, focusing on the logical coherence and inference quality. The third metric"}, {"title": "5. Conclusions and Future Recommendations", "content": "VTPM for pedestrian activity monitoring and reporting system demonstrates effectiveness for privacy-preserve monitoring framework by converting the processed videos using computer vision techniques to textual report using LLMs. With a latency of 0.05 seconds for processing each video frame, the system ensures prompt and real-time analysis. The rapid report generation time of 0.33 seconds enhances effective monitoring and immediate response. The analysis of a 4- hour video stream revealed significant pedestrian activity and numerous crossing violations, especially at night (76%). Crosswalk B exhibited a higher rate of violations (72.2%) compared to crosswalk A (18.2%), indicating the need for targeted safety interventions. A historical analysis validated the improved performance of the fine-tuned LLM (Phi-3 medium) against other models, with Llama3 70B achieving the highest MMLU score. Qualitative evaluations by 16 doctoral transportation researchers showed the fine-tuned LLM excelled in clarity, accuracy, reasoning capability, and domain knowledge. Overall, the system's combination of real-time processing and swift report generation underscores its effectiveness for timely monitoring of pedestrian activities. This capability is essential for improving pedestrian safety and optimizing urban planning, allowing for prompt interventions based on accurate data while preserving pedestrian privacy. Moreover, by converting video footage into textual reports, the system dramatically reduces memory usage by up to 253 million percent, resolves privacy concerns, and facilitates comprehensive, interactive historical analysis for transportation departments and research organizations. For future work, it is recommended to integrate VTPM with cameras at all corners of the intersection. This would allow for comprehensive coverage of pedestrian activity across the entire intersection, enabling the capture of more events and providing a more detailed analysis of pedestrian behavior and safety."}]}