{"title": "A Scientific Machine Learning Approach for Predicting and Forecasting Battery Degradation in Electric Vehicles", "authors": ["Sharv Murgai", "Hrishikesh Bhagwat", "Raj Abhijit Dandekar", "Rajat Dandekar", "Sreedath Panat"], "abstract": "Carbon emissions are rising at an alarming rate, posing a significant threat to global efforts to mitigate climate change. Electric vehicles (EVs) have emerged as a promising solution to reduce emissions in the transportation sector, but their reliance on lithium-ion batteries introduces the critical challenge of battery degradation. Accurate prediction and forecasting of battery degradation over both short and long time spans are essential for optimizing performance, extending battery life, and ensuring effective long-term energy management. This directly influences the reliability, safety, and sustainability of EVs, supporting their widespread adoption and aligning with key United Nations Sustainable Development Goals (SDGs). In this paper, we present a novel approach to the prediction and long-term forecasting of battery degradation using a Scientific Machine Learning (SciML) framework that leverages Neural Ordinary Differential Equations (NeuralODEs) and Universal Differential Equations (UDEs). Unlike traditional machine learning models, which often function as black-box systems, SciML integrates domain knowledge with neural networks, offering more interpretable and scientifically grounded solutions for both predicting short-term battery health and forecasting degradation over extended periods. This hybrid approach captures both known and unknown degradation dynamics, improving predictive accuracy while reducing data requirements. We incorporate ground-truth data to inform our models, ensuring that both the predictions and forecasts reflect practical conditions. The model achieved a mean squared error of 9.90 with the UDE and 11.55 with the NeuralODE, in experimental data, a loss of 1.6986 with the UDE, and a mean squared error of 2.49 in the NeuralODE, demonstrating the enhanced precision of our approach. This integration of data-driven insights with SciML's strengths in interpretability and scalability allows for robust battery management. By enhancing battery longevity and minimizing waste, our approach contributes to the sustainability of energy systems and accelerates the global transition toward cleaner, more responsible energy solutions, aligning with the UN's SDG agenda.", "sections": [{"title": "1 Introduction", "content": ""}, {"title": "1.1 Background and Motivation", "content": "As of 2023, global carbon emissions have surged from 25.5 billion tonnes in 2000 to 37.55 billion tonnes [1]. Electric vehicles (EVs), which made up 18% of total vehicle sales in 2023 [2], are central to reducing emissions, representing a market worth $500.48 billion [3]. Lithium-ion batteries power these EVs but face degradation over time, leading to reduced capacity and efficiency. This decline affects EV reliability and raises sustainability concerns. Addressing battery degradation is crucial for improving EV performance, extending battery lifespan, and supporting the broader adoption of sustainable transport solutions."}, {"title": "1.2 Problem Statement", "content": "Battery degradation refers to the irreversible decline in a battery's ability to store or deliver energy, characterized by reduced charge capacity and increased internal resistance. This is primarily driven by two forms of degradation: calendar degradation, which occurs over time, and cycle degradation, caused by repeated charging and discharging. Together, they impact the battery's long-term performance. The state of health (SoH) quantifies this degradation as a percentage comparing current capacity to the original capacity when new. Monitoring SoH is crucial for extending battery life, especially in electric vehicles (EVs), allowing users to manage batteries more effectively, reduce replacements, conserve materials like lithium and cobalt, and support recycling and second-life applications.\nHowever, predicting SoH remains challenging. Current models depend on empirical constants, which vary by battery chemistry, usage, and conditions, making universal models difficult. Validating these models requires long-term testing, often taking years. Additionally, the scarcity of long-term experimental data further complicates predictions, as many datasets are incomplete or short-term. To address this, we are utilizing high-quality experimental data from Sandia National Laboratories (SNL) to validate and enhance our model, aiming for more accurate and reliable SoH forecasting across various battery types."}, {"title": "1.3 Contributions", "content": "To accurately predict the SoH of EV batteries, we utilize a SciML [7] framework that integrates physical models with deep learning techniques, offering more transparency than traditional black-box methods. In this paper, we introduce a UDE [13] and a NeuralODE [14] framework built to model and forecast battery SoH with upmost precision. The key objectives of this research are:\n\u2022 Develop a UDE and NeuralODE framework that integrates ordinary differential equations (ODEs) with neural networks to model and predict battery health over time.\n\u2022 Use synthetic ground-truth data and real-world experimental data from Sandia National Laboratories (SNL) [6] to forecast battery degradation.\n\u2022 Demonstrate the practical application of UDEs and NeuralODEs for long-term battery performance, focusing on efficiency and sustainability.\n\u2022 Show how this approach supports global sustainability goals, aligning with the United Nations Sustainable Development Goals (SDGs) such as SDG 7, SDG 11, SDG 12, and SDG 13."}, {"title": "2 Literature Review", "content": "Wang et al. [19] introduce a physics-informed neural network (PINN) to estimate the state-of-health (SoH) of lithium-ion batteries by combining empirical models with experimental data. While effective for cycle degradation, it overlooks calendar degradation and lacks Neural ODEs or UDEs, limiting its ability to generalize across battery chemistries. Hofmann et al. [20] also develop a PINN, using data from labs, simulations, and vehicles to predict SoH, but similarly focus on cycle degradation and fail to incorporate physical laws with Neural ODEs or UDES.\nYe et al. [21] propose a Physics-Informed Neural Network (PIFNN) that integrates battery properties to improve SoH accuracy, but its reliance on specific datasets reduces generalizability. The absence of Neural ODEs or UDEs weakens its ability to handle complex degradation processes, particularly with noisy data. Anonymous [4] employ a Scientific Machine Learning (SciML) framework with Universal Differential Equations (UDEs) to predict battery degradation, but lack of real-world validation remains a limitation."}, {"title": "3 System Model and Methodology", "content": ""}, {"title": "3.1 The chemistry behind battery degradation", "content": "To model lithium-ion battery degradation effectively, it's important to understand the chemical processes involved. As shown in Figure 1, lithium-ion batteries consist of copper or aluminum current collectors, a graphite anode, and a 2,2,5,5-tetramethyloxolane (TMO) cathode. The two main forms of degradation are calendar degradation, which occurs over time, and cycle degradation, caused by repeated charge-discharge cycles. Calendar degradation involves the growth of the solid electrolyte interphase (SEI) layer on the anode, consuming lithium ions and reducing capacity, even when the battery is not in use. Cycle degradation occurs during charging and discharging, as lithium ions move between the anode and cathode, damaging the SEI layer and causing mechanical stress, cracks, and structural damage. This increases internal resistance and reduces capacity. High temperatures and voltage fluctuations accelerate these processes, while external factors like graphite exfoliation, SEI decomposition, and binder degradation further contribute to battery deterioration."}, {"title": "3.2 Modeling Battery Degradation: ODES", "content": "In this research, we have used the typical lithium-ion Nickel-Manganese-Cobalt (NMC) battery that is used in EVs, particularly a Nissan Leaf to accurately predict and forecast SoH."}, {"title": "3.2.1 Calendar Degradation", "content": "Calendar degradation occurs over time, even when the battery is not in use. It depends on the state of charge (SoC) [24] of a battery, which represents the ratio of the current available charge (or energy) within a battery to its total charge capacity when fully charged, the time in days (t), the activation energy (Ea), which is the minimum amount of energy required to initiate a chemical reaction by enabling reactants to overcome the energy barrier and transition into products. Additionally, it is dependent on the internal temperature of the battery. The ODE governing calendar degradation is an Arrhenius formulation that quantifies the impact of temperature. In addition to these parameters, the equation uses a pre-exponential factor f, that is a piece-wise function of SoC as described in (1), and the values are outlined in Table 1. In this paper, we have used a base calendar degradation model from the Wang model [11].\n$f(SoC) =\\begin{cases}\n\u22121.04 \\cdot SoC\u00b2(t) + 89.72 \\cdot SoC(t) + 1224.6 & \\text{if } SoC(t) \\leq 50 \\\\\n10.35 \\cdot SoC\u00b2 (t) \u2212 1083.6 \\cdot SoC(t) + 31447 & \\text{if } 50 \\leq SoC(t) \\leq 70 \\\\\n2.64 \\cdot SoC\u00b2 (t) \u2212 409.55 \\cdot SoC(t) + 22035 & \\text{if } 70 \\leq SoC(t)\n\\end{cases}$ (1)\n$q_{cal}(t) = \\int_{0}^{t} \\frac{f(SoC)}{2\\sqrt{t}} exp(\\frac{-E_a}{RT}) dt$ (2)"}, {"title": "3.2.2 Cycle Degradation", "content": "Cycle degradation occurs over time due to charge and discharge cycles, and is dependent on discharge current (Ib), battery temperature (T\u266d), and the battery capacity (Q). In this paper, we have used the Wang model [11] to accurately model the cycle degradation of the specific NMC lithium-ion battery used in Nissan Leafs. The parameters and variables are described in Table 3. In order to calculate the discharge current of the battery, we can use (4) with the parameters as shown in Table 4 [10].\n$I_{cycl} = \\int_{0}^{T} (a\\cdot T_{b}^{2}+b\\cdot T_{b}+c)\\cdot exp(\\frac{e\\cdot I_{b}}{Q\\cdot 3600}) dt$ (3)\n$I_b = \\frac{Q \\cdot 3600}{\\frac{V_{nom}}{\\Delta E_{driving}} \\cdot \\frac{1}{Odo \\cdot \\eta}}$ (4)\nIn the absence of real-world testing conditions and to simplify the model in the early stages of our research, we made several assumptions regarding average driving time and mileage. These assumptions were based on data from multiple studies conducted in China [26], which indicate that the typical annual driving distance is approximately 20,000 kilometers. Using (3) and (4), we can calculate cycle degradation."}, {"title": "3.2.3 Cumulative Degradation", "content": "Based on (1), (2), (3) and (4), we can calculate the cumulative degradation, capacity and the SoH of the battery using (5), (6) and (7):\n$\\eta_{total} = \\frac{q_{cycl} + q_{cal}}{I_{total}}$ (5)\n$SoH = 100\\% - \\eta_{total}$ (6)\n$Q = Q_{nom} (100\\% - q_{total})$, (7)"}, {"title": "3.3 Prediction of SoH: synthetic ground-truth data", "content": "In the initial stage of the project, we lacked experimental ground-truth data, so we generated synthetic data using the ground-truth equations (2), (3), (4), and (5). Gaussian noise with an amplitude of 0.20 was added to the cumulative degradation (Figure 2(a)) to simulate real-world conditions, resulting in the data shown in Figure 2(b). This noisy dataset serves as a benchmark for predictions made by the UDE and NeuralODE models. We now explore SciML frameworks, including UDEs and NeuralODEs, to forecast battery degradation over time.\n\u2022 UDE: A UDE combines traditional mathematical models with neural networks, blending physics-based knowledge with data-driven methods. This hybrid approach allows UDEs to capture complex system dynamics, effectively modeling systems with both known physical laws and data-dependent behaviors.\nFor the UDE, we chose to replace the $\\frac{1}{\\sqrt{t}}$ term from (2), and the $(a\\cdot T_{b}^{2}+b\\cdot T_{b} + c) \\cdot exp(\\frac{e\\cdot I_{b}}{Q\\cdot 3600})$, from (3), or the cycle degradation expression with neural networks. The resultant equation is described in (8), where NN1(t) is a neural network that approximates $\\frac{1}{\\sqrt{t}}$ and NN2(Tb, Ib, Q) is a neural network that approximates the $(a \\cdot T_{b}^{2}+b \\cdot T_{b} + c) \\cdot exp(\\frac{e \\cdot I_{b}}{Q \\cdot 3600})$ term.\n$\\frac{dq_{total}}{dt} = \\frac{f(SoC)}{2} \\cdot NN_1(t) \\cdot exp(\\frac{-E_a}{RT}) + NN_2(T_b, I_b, Q)$ (8)"}, {"title": "3.4 Prediction of SoH: Using real-world experimental data", "content": ""}, {"title": "3.4.1 Dataset", "content": "The dataset from Sandia National Labs [5] is a key resource for studying lithium-ion NMC battery degradation. It includes experimental data on cycle count, capacity, voltage, current, and temperatures. NMC cells (3Ah capacity) were cycled to end of life (80% SOH) at various temperatures (15 \u00b0C, 25 \u00b0C, 35 \u00b0C), depths of discharge (0\u2013100%, 20\u201380%, 40\u201360%), and discharge rates (0.5C, 1C, 2C, 3C). After basic preprocessing to remove outliers and missing values, we generated a plot (Figure 2(c)) showing capacity degradation over time under these conditions."}, {"title": "4 Experiments and Results", "content": ""}, {"title": "4.1 Training", "content": "For experiments on both the NeuralODE and UDE, hyperparameter tuning was performed, testing various timespans, optimizers, and learning rates. Optimizers like Adam [30], Nesterov [31], Ad-aBelief [32], AdaGrad [33], Sophia [34], and RMSProp [35] were evaluated with learning rates of 0.1, 0.01, 0.001, and 0.0001, over 10,000 to 80,000 iterations, in increments of 10,000. The UDE and NeuralODE was trained on timespans from 1 to 10 years, and the MSE was recorded for each setup to determine the best configuration. To evaluate the preformances of the models, MSE was used."}, {"title": "4.1.1 Synthetic ground-truth data: UDE", "content": "In the first experiment (Table 5), without dropout or batch normalization, high losses occurred for timespans over 5 years and lacked accuracy for shorter spans. A second experiment introduced batch normalization and dropout, reducing overfitting and improving MSE across all timespans (Table 6). The UDE achieved an MSE of 9.90 over 6 years, closely matching ground-truth data (Figure 3(a)). Finally, we compared the UDE estimation with the $\\frac{1}{\\sqrt{t}}$ term (Figure 3(b)), confirming that the UDE accurately captures the time-dependent degradation of the battery."}, {"title": "4.1.2 Synthetic ground-truth data: NeuralODE", "content": "In order to evaluate the performance of the NeuralODE, we also use MSE across all the iterations. Only one experiment was conducted, which gave a MSE of 11.55 over a 7-year timespan, as demonstrated in Figure 4. The results of the experiment are shown in Table 7. Batch normalization and dropout layers were included from the start. There were lower losses over smaller timepsans."}, {"title": "4.1.3 Experimental data: UDE", "content": "Using the pre-processed dataset, we performed an 80-20 train-test split, with the training set com-prising 45,769 records. Adam provided the best performance with a loss of 1.6980, while other optimizer results are shown in Table 8. The UDE model accurately captured time-dependent and cycle degradation dynamics, as shown in Figure 5(a). This prediction improves battery health monitoring, enabling earlier decisions on repurposing, recycling, or extending battery life, reducing the need for frequent replacements. By minimizing resource extraction and waste, it supports global sustainability efforts, aligning with the UN's 9th, 11th, 12th, and 13th SDGs."}, {"title": "4.1.4 Experimental data: NeuralODE", "content": "Using the preprocessed dataset, we conducted an 80-20 train-test split to predict battery degradation over the final 20% of the data. The training set comprised 45,769 records. After testing multiple optimizers and the DOPRI solver, Adam demonstrated the best performance with training MSE loss of 2.49 as shown in Figure 5(b), while the results of other optimizers are summarized in Table 9."}, {"title": "4.2 Battery Degradation Forecasting", "content": "The UDE, trained on synthetic data over 6 years, achieved an MSE of 9.90, while the NeuralODE reached 11.55 (Figure 3(a)). Forecasting over 10 years is critical for sustainable EV battery man-agement. On experimental data, the UDE achieved an MSE of 1.6980, closely matching real-world SoH values (Figure 6(a)), while the NeuralODE had an MSE of 2.1 (Figure 7). These long-term predictions enhance battery life, support timely recycling, and reduce resource demand, aligning with the UN's 9th, 11th, 12th, and 13th sustainability goals. The UDE's forecast of 80% SoH after 10 years (Figure 6(b)) highlights its capability for sustainable battery management."}, {"title": "5 Conclusion", "content": "In this work, we explained the chemical processes behind calendar and cycle degradation, including SEI growth, particle cracking, and anode dissolution. We employed Scientific Machine Learning (SciML) to predict and forecast battery degradation using NeuralODE and UDE models, achieving MSE losses of 9.90 and 11.55 on synthetic data, and 1.6980 and 2.10 on real-world data, respectively. SciML integrates machine learning with physical models, offering more accurate and interpretable predictions by capturing complex battery dynamics. Unlike traditional black-box methods, which of-ten overlook the physical processes driving battery degradation, SciML leverages domain knowledge to improve generalization, making it an essential tool for battery health forecasting and advancing sustainable energy storage solutions."}]}