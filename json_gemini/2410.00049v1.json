{"title": "Epidemiology-Aware Neural ODE with Continuous Disease Transmission Graph", "authors": ["Guancheng Wan", "Zewen Liu", "Max S. Y. Lau", "B. Aditya Prakash", "Wei Jin"], "abstract": "Effective epidemic forecasting is critical for public health strategies and efficient medical resource allocation, especially in the face of rapidly spreading infectious diseases. However, existing deep-learning methods often overlook the dynamic nature of epidemics and fail to account for the specific mechanisms of disease transmission. In response to these challenges, we introduce an innovative end-to-end framework called Epidemiology-Aware Neural ODE with Continuous Disease Transmission Graph (EARTH) in this paper. To learn continuous and regional disease transmission patterns, we first propose EANO, which seamlessly integrates the neural ODE approach with the epidemic mechanism, considering the complex spatial spread process during epidemic evolution. Additionally, we introduce GLTG to model global infection trends and leverage these signals to guide local transmission dynamically. To accommodate both the global coherence of epidemic trends and the local nuances of epidemic transmission patterns, we build a cross-attention approach to fuse the most meaningful information for forecasting. Through the smooth synergy of both components, EARTH offers a more robust and flexible approach to understanding and predicting the spread of infectious diseases. Extensive experiments show EARTH superior performance in forecasting real-world epidemics compared to state-of-the-art methods. The code will be available at https://github.com/Emory-Melody/EpiLearn.", "sections": [{"title": "1 Introduction", "content": "The COVID-19 pandemic has resulted in millions of deaths and significant economic losses worldwide, severely disrupting social and economic systems (Martin, S\u00e1nchez, and Wilkinson 2023; Pak et al. 2020). To address these challenges, there is a growing interest in epidemiological models, which are crucial for effective public health strategies and efficient medical resource allocation (Liu et al. 2024b; Cm 2020). Traditional models, such as the SIR model and its variants (Dehning et al. 2020), rely on mathematical differential equations to simulate disease spread but often depend on oversimplified assumptions (Funk et al. 2018; Kondratyev 2013; Yang et al. 2023). To enhance performance, deep learning models like Neural Networks (Madden et al. 2024; Rodr\u00edguez et al. 2023) or Graph Neural Networks (GNNs) (Zhang et al. 2024c) have been explored. These models effectively represent interactions between entities (e.g., regions) as graphs, capturing the spatial spread of disease through message-passing mechanisms.\nNevertheless, given the dynamic nature of epidemic systems, existing work often neglects the dynamic evolution of regional interactions. For example, changes in people's behavior (e.g., lockdowns) at a specific time step of one region, will greatly reduce the spread to surrounding regions in the following period. Existing efforts generally predict future epidemic profiles by modeling regional interactions from the whole series while overlooking these dynamic changes during the evolution. Furthermore, irregular sampling observation intervals are not considered. For instance, some regions may be unable to conduct routine reporting in the early stages of an epidemic due to limited resources. Current work simplifies this scenario by learning only regular intervals which is impractical in the real world. The problem illustration is detailed in Fig. 1.\nTo tackle the aforementioned issues, neural ordinary differential equation (NODE) (Chen et al. 2018; Poli et al. 2021) stands out as a powerful approach to modeling the continuous-time system. Therefore, in this work, we take inspiration from NODE and focus on the continuous-time epidemic system, capturing the intricate dynamics more accurately. However, directly incorporating the neural ODE with the epidemic system faces nontrivial challenges. Firstly, it does not explicitly learn epidemic mechanisms and fails to provide insights to decision-makers. This motivates us to think: I) How can we generally combine the neural ODE approaches with epidemic mechanism? Some work (Arik et al. 2020; Me\u017enar, Lavra\u010d, and \u0160krlj 2021) proposes hybrid models trying to combine the epidemic mechanism and deep learning methods. However, due to the limited observations of all disease states (e.g., lacking data on susceptible individuals) in the real world, these models are not flexible and are unable to learn inherent epidemic mechanisms. In the meanwhile, some existing neural ODE approaches from other fields (Luo et al. 2023) fail in addressing this problem either. Thus, the following question naturally emerges: II) How can we learn continuous disease transmission under limited observations more flexibly? Apart from the aforementioned locally subtle spreading patterns, epidemics also exhibit a global infection trend. From a more macroscopic perspective, the infection trend can be seen as a longer-range and often multi-regional overall direction. This global signal impacts and changes the disease propagation, resulting in different spatial transmission patterns at different times. For instance, global political vaccination trends significantly alter local spatial transmission patterns. In regions with high vaccination rates, the spread of the epidemic slows down, and a \"herd immunity\" effect may even occur (Chauhan et al. 2023). However, previous work usually considers static geographic graphs or only learns the graph without accounting for the continuous evolution of global signals. This raises another intriguing question: III) How can we model the global infection trend and learn dynamic regional transmission patterns during continuous evolution?\nTo address the identified questions, we propose an innovative and end-to-end framework for continuous-time epidemic modeling: Epidemiology-AwaRe ODE with Continuous Disease Transmission GrapH (EARTH). To address question I) and facilitate epidemiology-informed transparency, we revisit the classic compartmental models (i.e., SIR). In order to surpass previous efforts (Rodr\u00edguez et al. 2023) and fully leverage the expressive ability of neural networks, we propose a neural ODE-based Network SIR (Brede 2012) to implicitly capture the continuous evolution of the regional propagation graph. To overcome the challenge II) we propose to initialize disease state features and feed them into a proposed Epidemic-Aware Neural ODE (EANO) module to learn inherent epidemic transmission pattern. Moreover, we attempt to achieve the target III). We first obtain a long-range view of epidemic progression and establish a relationship with regions that share similar development patterns. To further consider dynamic regional transmission, we develop an innovative Global-guided Local Transmission Graph (GLTG). Specifically, we fuse global trend indicative features for different regions with GNN. Then they are utilized to generate more fine-grained locally dynamic transmission graphs, which guide our EANO disease spreading during the evolution. Finally, we develop a cross-attention mechanism to accommodate both the global coherence of epidemic trends and the local nuances of disease transmission patterns. We conjecture that these two components together make EARTH a competitive method for epidemic forecasting. Our principal contributions are summarized as follows:\n\u2022 We are the first to harmonize the neural ODE with the epidemic mechanism, developing an innovative framework considering the time-continuous nature of epidemic dynamics while learning inherent disease spreading patterns.\n\u2022 We further consider global epidemic trends and learn dynamic regional transmission patterns during continuous evolution within the end-to-end model.\n\u2022 By integrating global coherence and local dynamics via a cross-attention mechanism, we achieve superior results on multiple epidemic forecasting datasets including COVID-19 and influenza-like illness."}, {"title": "2 Related Work", "content": "2.1 Epidemic Forecasting\nEpidemic forecasting plays a crucial role in predicting the spread and impact of infectious diseases, enabling timely and effective public health interventions (Emanuel et al. 2020; Fine 2015; Terris 1993). Traditional models like the SIR (Susceptible-Infectious-Recovered) model (Hethcote 2000) use differential equations to describe disease dynamics but often rely on oversimplified assumptions (Dehning et al. 2020; Caals, Saxena, and Ho 2017). Recent advances incorporate deep learning methods like Graph Neural Networks (GNNs) (Dai et al. 2022; Wan et al. 2024), which better capture the complex interactions and spatial dependencies in disease spread from data-driven perspectives (Deng et al. 2020; Yu et al. 2023). However, these deep learning methods neglect the dynamic nature of the epidemic system. The issues of regional correlation signals and irregular sampling observation intervals remain unresolved, hindering the accurate capture of real-world epidemics. Therefore, in this work, we propose a general framework by seamlessly integrating epidemic mechanisms into Neural ODE, capturing the complex evolution of continuous-time epidemics.\n2.2 Graph Neural Networks\nGraph Neural Networks (GNNs) (Hamilton, Ying, and Leskovec 2017; Veli\u010dkovi\u0107 et al. 2017; Huang et al. 2023) are widely recognized for processing non-Euclidean data structures, such as traffic networks (Wu et al. 2019). They update node representations by aggregating information from neighbors via message-passing (Zhang et al. 2024b; Zhang et al., 2024a). Many studies have used GNNs for epidemic modeling (Sha, Al Hasan, and Mohler 2021; Wang et al. 2023), focusing on the spatial relationships in disease spread (Jhun 2021; La Gatta et al. 2021), but often overlook dynamic transmission patterns. Our approach addresses this by concentrating on continuous-time epidemic modeling, using GNNs to integrate multi-region global trends and create disease transmission graphs for regional propagation."}, {"title": "2.3 Neural Ordinary Differential Equation", "content": "Neural ODEs extend discrete neural networks to continuous-time scenarios, offering superior performance and flexibility (Chen et al. 2018). They have been widely adopted in various fields such as traffic flow forecasting (Fang et al. 2021; Choi et al. 2021), continuous dynamical systems (Chen et al. 2024; Huang et al.), and recommendations (Qin et al. 2024). Recent advancements have integrated GNNs with Neural ODEs, enhancing the modeling of complex dependencies in graph-structured data (Luo et al. 2023; Wan, Huang, and Ye 2024). In contrast to prior work, we extend this concept to investigate important continuous-time epidemic modeling. Since the epidemic system is time-varying, we first attempt to associate each region with the time-corresponding latent variable $Z(t)$ by a parameterized ODE $\\dot{Z}(t) := dZ_v(t)/dt = V_t(\\Theta_t; Z_v(t))$, which depicts the region-specific dynamic trajectory for series. Thus we can derive temporal dynamics at $T$ for all regions $Z(T) \\in \\mathbb{R}^{N \\times d}$ as follows:\n$Z(T) = Z(0) + \\int_0^T V_t(\\Theta_t; t; Z(t)) dt$.\nHere $V_t$ denotes the time manipulation function parameterized by $\\Theta_t$. In our framework, we leverage multi-layer perceptrons (MLP) for the time modeling module $V_t$ by default. Furthermore, for different regions, diverse and complex processes of infectious disease transmission exist. Inspired by Neural Controlled Differential Equations (NCDE) (Kidger et al. 2020), we exploit a continuous path $Q$ for each region $v$, which reformulates Eq. (1) as:\n$Z(T) = Z(0) + \\int_0^T \\Psi_e(\\Theta_t; Z(t)) \\frac{dQ(t)}{dt} dt$.\nEq. (2) transforms the integral problem from a Riemann integral to a Riemann-Stieltjes integral. Specifically, $Q(t)$ is created from $\\{(t_i, x_i)\\}_{i=0}^n$ by an interpolation algorithm."}, {"title": "3 Preliminaries", "content": "We approach the epidemic forecasting challenge by employing a graph-based prediction model. Let $G = (V, E)$ represent the graph, where $V$ denotes a set of nodes comprising $|V| = N$ regions (e.g., cities or states). The edge set $\\epsilon \\subseteq V \\times V$ represents the geographic links between these regions. The adjacency matrix $A \\in \\mathbb{R}^{n \\times n}$ is defined such that $A_{ij} = 1$ if there is an edge $e_{ij} \\in E$ and $A_{ij} = 0$ otherwise. The normalized adjacency matrix is given by $\\hat{A} = D^{-1/2} A D^{-1/2}$, where the degree matrix $D$ is a diagonal matrix with $D_{ii} = \\Sigma_j A_{ij}$.\nProblem Formulation. Each node corresponds to a region with an associated time series input over a window $T$, such as infection counts for $T$ weeks. We represent the training data over this period as $X = [x_1, ..., x_T] \\in \\mathbb{R}^{N \\times T}$. The goal is to construct a model capable of predicting an epidemiological profile $X_{T+h}$ at a future time point $T + h$, where $h$ denotes the prediction horizon."}, {"title": "4 Methodology", "content": "4.1 Overview\nIn Epidemic-Aware Neural ODE, we initialize disease states as region-specific features and build them upon time variables, which are then fed into proposed Network SIR-inspired neural ODE functions to capture local subtle disease transmission patterns. Furthermore, in Global-guided Local Transmission Graph we leverage the GNN to obtain global trends and evolutionary graphs. Then dynamic graphs are learned during the evolution of epidemics to guide EANO propagation. Ultimately, we proposed a cross-attention mechanism to accommodate both local nuances and global coherence for final forecasting. The illustration of the overall framework is detailed in Fig. 2.\n4.2 Epidemic-Aware Neural ODE\nMotivation. Existing deep learning methods neglect the continuous evolution of epidemic systems and do not explicitly learn about epidemic development. Traditional mechanistic models attempt to understand spreading patterns through ODEs but fail to utilize available data sources and model more complex epidemics fully. Therefore, we aim to combine the advantages of both approaches to enable an Epidemic-Aware Neural ODE framework.\nSIR-inspired Neural ODE. In epidemiology, the standard SIR model (Hethcote 2000) categorizes the population into three distinct groups based on their disease states: susceptible (S) to infection, currently infectious (I), and recovered (R), with the latter group being immune to both contraction and transmission of the disease. The SIR model, formulated using ODEs (Grassly and Fraser 2008), describes the epidemic dynamics as follows:\n$\\frac{dS}{dt} = -\\beta \\frac{S_t I_t}{P}$,\n$\\frac{dI}{dt} = \\beta \\frac{S_t I_t}{P} - \\gamma I_t$,\n$\\frac{dR}{dt} = \\gamma I_t$.\nThese equations distribute the total population $P$ across the aforementioned categories. Here, susceptible individuals become infectious upon contact with infectious ones, driven by the transmission rate $\\beta$ ($S \\rightarrow I$). In the meanwhile, infectious individuals recover and gain immunity at the recovery rate $\\gamma$ ($I \\rightarrow R$). However, due to resource restrictions and observation limitations, these explicit cases may not always be available in real-world scenarios. To address this issue, we propose to utilize neural ODEs to automatically infer these ODE functions in Eq. (3) via neural networks in a data-driven manner. Specifically, we treat these disease states (S, I, and R) as latent high-dimensional variables. Each state is represented by a matrix $S(t), I(t)$, and $R(t)$ in $\\mathbb{R}^{N \\times d}$ with $d$ denoting the hidden dimension. In a continuous epidemic system, these states are intrinsically linked with the time variables. Thus, we utilize the NCDE approach in Eq. (2) and model the specific epidemic state $C$ as:\n$C(T) = C(0) + \\int_0^T \\Phi_e(\\Theta_t; C(t)) \\frac{dZ(t)}{dt} dt$,\n$= C(0) + \\int_0^T \\Phi_e(\\Theta_t; C(t)) \\Psi_e(\\Theta_t; Z(t)) \\frac{dQ(t)}{dt} dt$."}, {"title": "4.3 Global-guided Local Transmission Graph", "content": "Motivation. As previously noted, EANO solely accounts for the pre-defined neighborhood connections, neglecting the evolutionary disease interactions. This observation drives us to explore more effective approaches to represent local spatial transmission patterns during the evolution.\nGlobal Infection Trend. In addition to local transmission dynamics, epidemic systems also exhibit a global signal that represents the overall infection trend. This trend encapsulates the broader patterns of infection spread, influenced by factors such as international travel, global health policies, and widespread behavioral changes. For example, during a pandemic, international travel restrictions and lockdowns can significantly curtail cross-border disease transmission, resulting in differing regional infection rates and modifying the epidemic's overall trajectory (Demey et al. 2020; Russell et al. 2021). To address this, we propose creating a global infection indicator feature for each region, correlated with the corresponding temporal features:\n$H(T) = H(0) + \\int_0^T \\Psi_g(\\Theta_g; H(t)) \\Psi_e(\\Theta_e; Z(t)) \\frac{dQ(t)}{dt} dt$.\nSince global here refers to the multi-regional overall direction, we employ Dynamic Time Warping to assess the similarity of historical case trends across different regions, thereby extending the original geographic connections:\n$A_{uv} = \\begin{cases} 1, & \\text{if } A_{uv} = 1, \\\\ 1, & \\text{if } u \\neq v \\text{ and } u \\in Top_k(v), \\\\ 0, & \\text{otherwise}. \\end{cases}$\nIn this context, $Top_k(v)$ denotes the indices of the $k$ most similar nodes to node $v$. By doing this, we establish an epidemic-semantic spatial relationship that emphasizes regions with analogous epidemic progression patterns. To promote interactions between regions, we implement a residual GNN layer to update the global infection trend:\n$\\tilde{H} = \\sigma \\big( \\tilde{D}^{-1/2} \\tilde{A} \\tilde{D}^{-1/2} H(t) W_g \\big) + H(t)$\nHere, $\\tilde{D}$ represents the degree matrix corresponding to $\\tilde{A}$, $W_g$ is the learnable weight matrix, and $\\sigma$ denotes the activation function. The GNN layer $\\sigma_g$ facilitates the aggregation and propagation of information across a broader regional scope, resulting in the fused global trend features $\\tilde{H}(t)$.\nDynamic Regional Transmission. Having established the global infection trends, we leverage this comprehensive signal to guide local spatial transmission patterns by impacting the regional contexts in which local transmission occurs. For instance, high global vaccination rates can decrease the pool of susceptible individuals across multiple regions, thereby reducing local transmission opportunities. We employ a mapping function to learn these dynamically evolving patterns based on $\\tilde{H}(t)$:\n$M_1(t) = \\tanh (\\tilde{H}(t) W_1 + b_1)$,\n$M_2(t) = \\tanh (\\tilde{H}(t) W_2 + b_2)$,\n$A(t) = (\\tanh(M_1(t) M_2(t) - M_2(t) M_1(t)))$.\nThe concurrent local transmission relationship $A(t)$ is guided by the global trend, while Eq. (9) ensures that the learned pattern does not form a completely bidirectional graph. This highlights that inter-regional dissemination is not perfectly symmetrical, capturing the asymmetric nature of spatial interactions in epidemic spread. Additionally, we utilize a masking technique to balance the weights of static and dynamic transmission patterns:\n$M(t) = \\sigma (W_3 A(t) + b_3 J)$,\n$E(t) = M(t) \\odot A + (J - M(t)) \\odot \\tilde{A}(t)$."}, {"title": "4.4 Overall Objective", "content": "Ultimately, we derive the fused features $F(T)$, which harmonize the global consistency of epidemic trends with the particularities of local health conditions. We then concatenate these features with the time-corresponding features $Z(T)$ and employ an MLP parameterized by $\\Theta_f$ to pool the final prediction for region $v$:\n$\\Upsilon_v = f(\\Theta_f; [F_v(T) || Z_v(T)])$.\nFollowing previous methods (Deng et al. 2020; Xie et al. 2022), we use the MSE loss to compare the predicted values with the ground truth:\n$L_{mse} = \\sum_{i=1}^B \\sum_{v=1}^N |\\hat{\\Upsilon}_{i,v} - \\Upsilon_{i,v}|$,\nwhere $B$ denotes the sample size, and $i$ is the sample index. $\\hat{\\Upsilon}_{i,v}$ represents the true value for sample $i$ of region $v$."}, {"title": "5 Experiment", "content": "In this section, we comprehensively evaluate our proposed EARTH by answering the main questions:\n\u2022 Q1: Performance. Does EARTH outperforms the existing state-of-the-art epidemic forecasting methods?\n\u2022 Q2: Resilience. Is EARTH stable on different settings?\n\u2022 Q3: Effectiveness. Are proposed two key components: EANO and GLTG both effective?\n\u2022 Q4: Sensitivity. What is the performance of the proposed method with different hyper-parameters?\nThe answers of Q1-Q4 are illustrated as follows.\n5.1 Experimental Setup\nReal-world Datasets. We leverage three datasets to examine the validity of our EARTH, including COVID-19 and influenza-like illness: Australia-COVID, US-Regions, and US-States. Please see Appendix A for dataset details.\nImplemention Details. We use two metrics following (Liu, Liu, and Liu 2023): R represents RMSE (Root Mean Square Error), while P stands for Peak Time Error, which calculates the MAE (Mean Absolute Error) focusing only on significant peaks in the epidemics using a specified threshold. For more details please refer to Appendix B.\nCounterparts. We compare ours against several SOTA epidemic forecasting methods using the computational epidemiology repository EpiLearn (Liu et al. 2024a): VAR (Song et al. 2020), LSTM (Sesti et al. 2021), DCRNN (Li et al. 2018), STGCN (Yu, Yin, and Zhu 2017), ASTGCN (Guo et al. 2019), STGODE (Fang et al. 2021), STG-NCDE (Choi et al. 2021), CNNRNN-Res (Wu et al. 2018), CAMul (Kamarthi et al. 2021), EINN (Rodr\u00edguez et al. 2023), ColaGNN (Deng et al. 2020), EpiGNN (Xie et al. 2022) and EpiColaGNN (Liu, Liu, and Liu 2023).\n5.2 Performance\nThis section addresses Q1. To demonstrate the excellent performance of our proposed EARTH, we conducted comprehensive experiments on various epidemic datasets. We considered multiple baselines, including general spatio-temporal and epidemic forecasting methods, as detailed in Tab. 1. Key observations include: 1) VAR and LSTM are inadequate at capturing complex spatial dependencies, making them less effective. 2) General spatio-temporal methods like STGCN or ASTGCN can capture some regional dependencies but struggle with time development and long-term predictions. 3) ODE-based methods like STGODE can learn complex dynamic systems but do not sufficiently consider epidemic mechanisms. 4) Some epidemic-specific methods achieve excellent results but still struggle to model the evolution of epidemics. 5) Mechanistic methods like EINN do not succeed in capturing high-level spatial interaction between diseases from different regions. 6) EARTH demonstrates competitive performance across various real-world datasets due to its ability to learn complex epidemic evolution and dynamic regional propagation patterns."}, {"title": "5.3 Resilience", "content": "This section addresses the question Q2. We conducted two key experiments to evaluate this aspect: 1) We examine the robustness of the method under different irregular conditions with a range of missing rates, as detailed in Tab. 3. The outcomes show that EARTH remains robust across different datasets with diverse intervals. Our proposed method consistently outperforms other baseline methods, demonstrating its resilience to variable intervals and missing data. 2) We also test the performance of EARTH across different prediction horizons as shown in Appendix C. The results indicate that our method can make stable predictions over various horizons while learning epidemic mechanisms enables superior long-term prediction compared to other methods."}, {"title": "5.4 Effectiveness", "content": "The explanation for Q3 is presented in this section. Tab. 2 firstly discusses two key design elements in our method: EANO effectively enhances performance by leveraging the powerful capabilities of Neural ODEs while specifically considering the disease propagation mechanism. Additionally, GLTG yields promising results by learning the dynamic regional patterns during the evolution of epidemics.\nIn addition, we dive into GLTG deeper by considering it without dynamic graphs (w/o Dyna. Graph) or global trends (w/o Glo. Trend). The results show that dynamic graphs play a crucial role in modeling disease spatial interactions, while global trends help to capture long-distance information. We also examine EARTH under a fully connected regional graph, declaring this will lead to information redundancy. The variant considering adding a sparse penalty loss to the learned graph for encouraging sparsity, will not impact the final performance significantly.\n5.5 Sensitivity\nThis section provides an answer to Q4. As shown in Fig. 5, we first investigate the effect of varying the number of attention heads NT in Eq. (13). The results demonstrate overall stability with different numbers of heads, although too few heads can impair the method's ability to capture diverse information. We also test our method with different values of $k$ in Eq. (7). More connections can lead to redundancy in message passing for datasets with fewer regions (e.g., Australia-COVID). In contrast, larger datasets (e.g., US-States) can tolerate more connections. In all cases, global connections are essential for learning global infection trends."}, {"title": "6 Conclusion", "content": "In this paper, we propose a novel framework, EARTH, to improve epidemic forecasting performance. By integrating neural ODEs with traditional compartmental models, EANO captures the underlying disease propagation mechanisms. We also identify global infection trends and introduce GLTG to dynamically adjust local transmission patterns. Using a global-local cross-attention fusion approach, we extract representative features that account for both subtle disease states and broader trends. Extensive experiments on real-world epidemic datasets highlight the effectiveness of EARTH, offering valuable insights into combining mechanistic models with deep learning for future applications in epidemiology and data science."}]}