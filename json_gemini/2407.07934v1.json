{"title": "IDENTIFYING MACRO CONDITIONAL INDEPENDENCIES AND MACRO TOTAL EFFECTS IN SUMMARY CAUSAL GRAPHS WITH LATENT CONFOUNDING", "authors": ["Simon Ferreira", "Charles K. Assaad"], "abstract": "Understanding causal relationships in dynamic systems is essential for numerous scientific fields, including epidemiology, economics, and biology. While causal inference methods have been extensively studied, they often rely on fully specified causal graphs, which may not always be available or practical in complex dynamic systems. Partially specified causal graphs, such as summary causal graphs (SCGs), provide a simplified representation of causal relationships, omitting temporal information and focusing on high-level causal structures. This simplification introduces new challenges concerning the types of queries of interest: macro queries, which involve relationships between clusters represented as vertices in the graph, and micro queries, which pertain to relationships between variables that are not directly visible through the vertices of the graph. In this paper, we first clearly distinguish between macro conditional independencies and micro conditional independencies and between macro total effects and micro total effects. Then, we demonstrate the soundness and completeness of the d-separation to identify macro conditional independencies in SCGs. Furthermore, we establish that the do-calculus is sound and complete for identifying macro total effects in SCGs. Conversely, we also show through various examples that these results do not hold when considering micro conditional independencies and micro total effects.", "sections": [{"title": "1 Introduction", "content": "In observational studies, causal graphs are vital for decision-making regarding interventions and can be useful for detecting independencies between variables. Several standard tools have been developed for fully specified causal graphs, typically represented as directed acyclic graphs (DAGs) or acyclic directed mixed graphs (ADMGs). For example, d-separation [Pearl, 1988] enables the identification of conditional independencies directly from the graph structure. Similarly, the do-calculus [Pearl, 1995] allows for the derivation of total effect estimands from observational data. These results were also extended to directed mixed graphs (DMGs) [Richardson, 1997, Forr\u00e9 and Mooij, 2017, 2018, Forr\u00e9 and Mooij, 2020].\nHowever, constructing a fully specified causal graph is challenging because it requires knowledge of the causal rela- tionships among all pairs of observed variables. This knowledge is often unavailable, particularly in complex, high- dimensional settings, thus limiting the applicability of causal inference theory and tools. Therefore, recently there has been more interest in partially specified causal graphs [Perkovic, 2020, Anand et al., 2023, Ferreira and Assaad, 2024, Assaad et al., 2024], especially in partially understood domains, such as in epidemiology. An important type of partially specified graphs is the cluster-DMG which provides a coarser representation of causal relationships through vertices that represent a cluster of variables (and can contain cycles). The partial specification of cluster-DMG arises from the fact that each vertex in an cluster-DMG represents a cluster of variables. A well-known special case of cluster- DMGs is the cluster-ADMG, which imposes an acyclicity assumption on the partially specified graph [Anand et al., 2023]. Another notable special case of cluster-DMGs in dynamic systems is the summary causal graph (SCG), where each cluster represents a time series, and all temporal information is omitted from the graph [Assaad et al., 2022]."}, {"title": "2 Summary causal graphs and macro queries", "content": "We suppose that in a dynamic system, observations are generated from a discrete-time dynamic structural causal model (DTDSCM), an extension of structural causal models [Pearl, 2009] to dynamic systems. In the following we use the convention that uppercase letters represent variables and lowercase letters represent their values, moreover letters in blackboard bold represent sets.\nDefinition 1 (Discrete-time dynamic structural causal model (DTDSCM)). A discrete-time dynamic structural causal model is a tuple $\\mathcal{M} = (\\mathcal{L}, V, F, Pr(\\mathcal{L}))$, where $\\mathcal{L} = \\bigcup\\{\\mathcal{L}_i^t | i \\in [1,d], t \\in [t_0, t_{max}]\\}$ is a set of exogenous variables, which cannot be observed but affect the rest of the model. $V = \\bigcup\\{V_i^t | i \\in [1,d]\\}$ such that $\\forall i \\in [1,d], V_i = \\{V_i^t | t \\in [t_0, t_{max}]\\}$, is a set of endogenous variables, which are observed and every $V_i^t \\in V$ is functionally dependent on some subset of $\\mathcal{L} \\cup V_{\\leq t}\\{V_i^t\\}$ where $V_{\\leq t} = \\{V_j^{t'} | j \\in [1, d], t' \\leq t\\}$. $F$ is a set of functions such that for all $V_i^t \\in V, f_{V_i^t}$ is a mapping from and a subset of $V_{\\{V_i^t\\}}$ to $V_i^t$. $Pr(\\mathcal{L})$ is a joint probability distribution over $\\mathcal{L}."}, {"title": "Identifying macro conditional independencies and macro total effects in summary causal graphs with latent confounding", "content": "We suppose that the direct causal relations $F$ in a DTDSCM can be qualitatively represented by a full-time acyclic directed mixed graph (FT-ADMG), a special case of ADMGs [Richardson, 2003], where bidirected dashed arrows represent hidden confounding.\nDefinition 2 (Full-Time Acyclic Directed Mixed Graph). Consider a DTDSCM $\\mathcal{M}$. The full-time acyclic directed mixed graph (FT-ADMG) $\\mathcal{G} = (V, E)$ induced by $\\mathcal{M}$ is defined in the following way:\n$\\begin{aligned} E^1 &:= \\{X_{t-y} \\rightarrow Y_t | \\; Y_t \\in V, X_{t-y} \\in X \\subseteq V_{<t}\\{Y_t\\} \\text{ such that } Y_t := f_{Y_t} (X, \\mathcal{L}_{Y_t}) \\text{ in } \\mathcal{M}\\}, \\\\ E^2 &:= \\{X_{t-y} {\\,---\\rightarrow} Y_t | \\; \\forall X_{t-y}, Y_t \\in V \\text{ such that } I[X_{t-y} \\\\,\\; \\\\\\mathcal{L}_{Y_t}] \\neq \\emptyset\\}, \\\\ E &= E^1 \\cup E^2. \\end{aligned}$\nIn the remainder, we will use the notations of parents, children, ancestors and descendants for FT-ADMGs. Consider a FT-ADMG $\\mathcal{G} = (V, E)$ for every vertex $Y_t \\in V$ we note:\n$\\begin{aligned} &\\bullet \\; Parents(Y_t, \\mathcal{G}) = \\{X_{t'} \\in V \\; | \\; X_{t'} \\rightarrow Y_t\\}, \\\\ &\\bullet \\; Children(Y_t, \\mathcal{G}) = \\{X_{t'} \\in V \\; | \\; Y_t \\rightarrow X_{t'}\\}, \\\\ &\\bullet \\; Ancestors(Y_t, \\mathcal{G}) = \\bigcup_{i \\in \\mathbb{N}} P_i \\text{ where } P_0 = \\{Y_t\\} \\text{ and } P_{k+1} = \\bigcup_{X_{t'} \\in P_k} Parents(X_{t'}, \\mathcal{G}), \\text{ and} \\\\ &\\bullet \\; Descendants(Y_t, \\mathcal{G}) = \\bigcup_{i \\in \\mathbb{N}} C_i \\text{ where } C_0 = \\{Y_t\\} \\text{ and } C_{k+1} = \\bigcup_{X_{t'} \\in C_k} Children(X_{t'}, \\mathcal{G}). \\end{aligned}$\nIn many domains, such as epidemiology, it is generally challenging for practitioners to validate, analyze, or even provide an FT-ADMG due to the difficulty in determining the temporal lag between a cause and its effect. However, practitioners can usually provide summary causal graphs, which are compact versions of FT-ADMG. These summary causal graphs represent the causal relationships between the exposure, the disease and the different factors without specifying the temporal lags of these relationships.\nDefinition 3 (Summary Causal Graph with possible latent confounding). Consider an FT-ADMG $\\mathcal{G} = (V, E)$. The summary causal graph (SCG) $\\mathcal{G}^s = (S, E^s)$ compatible with $\\mathcal{G}$ is defined in the following way:\n$\\begin{aligned} &S := \\{V^i = (V_{t_0}^i,..., V_{t_{max}}^i) | \\forall i \\in [1,d]\\},\\\\ &E^{s_1} := \\{X \\rightarrow Y | \\forall X, Y \\in S, \\exists t' \\leq t \\in [t_0, t_{max}] \\text{ such that } X_{t'} \\rightarrow Y_t \\in E\\},\\\\ &E^{s_2} := \\{X {\\,---\\rightarrow} Y | \\forall X, Y \\in S, \\exists t', t \\in [t_0, t_{max}] \\text{ such that } X_{t'} {\\,---\\rightarrow} Y_t \\in E\\}, \\text{ and}\\\\ &E^s = E^{s_1} \\cup E^{s_2}. \\end{aligned}$\nThe transformation from a FT-ADMG to a SCG can be made explicit using the natural transformation from $V$ to $S$, $\\tau_0: V \\rightarrow S$, such that $\\forall i \\in [1,d], \\tau_0((V_{t_0}^i,..., V_{t_{max}}^i)) = (V_{t_0}^i,..., V_{t_{max}}^i)$.\nWhile SCGs, like cluster-DMGs, can contain cycles, the cycles in an SCG arise from the partial specificity of the graph. Notice that, like cluster-DMGs, SCGs may have directed cycles and in particular two directed edges oriented in opposite directions, i.e., if in the FT-ADMG we have $X_t \\rightarrow Y_t$ and $Y_{t'} \\rightarrow X_t$ then in the SCG we have $X \\rightarrow Y$ and $Y \\rightarrow X$ which we often write $X \\leftrightarrow Y$. However, unlike in cluster-DMGs, the cycles in SCGs necessarily arise from the partial specificity of the graph. Moreover, if $\\mathcal{G}^s = (S, E^s)$ and $\\mathcal{G} = (V, E)$ are compatible, we abuse the notation $\\forall V^i \\in S, V^i = \\{V_t^i | t \\in [t_0, t_{max}]\\}$ given in Definition 1 by writing $\\forall V_i = Y \\in S, V_Y = V^i$ and $V_Y \\subseteq S, V_Y = \\bigcup_{Y \\in Y} V_Y$.\nThe abstraction of SCGs entails that, even though there is exactly one SCG compatible with a given FT-ADMG, there are in general several FT-ADMGs compatible with a given SCG. For example, we give in Figure 1 an SCG with two of its compatible FT-ADMGs.\nIn the remainder, as for FT-ADMGs, we will use the notations of parents, children, ancestors and descendants for SCGs. Consider a SCG $\\mathcal{G}^s = (S, E^s)$ for every vertex $Y \\in S$ we note:\n$\\begin{aligned} &\\bullet \\; Parents(Y, \\mathcal{G}^s) = \\{X \\in S \\; | \\; X \\rightarrow Y\\}, \\\\ &\\bullet \\; Children(Y, \\mathcal{G}^s) = \\{X \\in S \\; | \\; Y \\rightarrow X\\},\\\\ &\\bullet \\; Ancestors(Y, \\mathcal{G}^s) = \\bigcup_{i \\in \\mathbb{N}} P_i \\text{ where } P_0 = \\{Y\\} \\text{ and } P_{k+1} = \\bigcup_{X \\in P_k} Parents(X, \\mathcal{G}^s), \\text{ and} \\\\ &\\bullet \\; Descendants(Y, \\mathcal{G}^s) = \\bigcup_{i \\in \\mathbb{N}} C_i \\text{ where } C_0 = \\{Y\\} \\text{ and } C_{k+1} = \\bigcup_{X \\in C_k} Children(X, \\mathcal{G}^s). \\end{aligned}$"}, {"title": "Identifying macro conditional independencies and macro total effects in summary causal graphs with latent confounding", "content": "In this paper, we focus on two distinct queries in SCGs: one that pertains to finding conditional independencies and another that infers total effects. Each of these queries can be categorized into two types: macro query and micro query. Below, we define micro conditional independency and macro conditional independency.\nDefinition 4 (Micro conditional independency). A micro independence in the FT-ADMG $\\mathcal{G} = (V, E)$ is a conditional independence between two disjoint sets of temporal variables $X, Y \\subseteq V$ conditioned on any subset of temporal variables $W \\subseteq V\\setminus (X, Y)$.\nDefinition 5 (Macro conditional independency). A macro independence in the FT-ADMG $\\mathcal{G} = (V, E)$ compatible with the SCG $\\mathcal{G}^s = (S, E^s)$ is a conditional independence between two sets of temporal variables of the form $V_X$ and $V_Y$ for $X, Y \\in S$ conditioned on a subset of temporal variables of the form $V_W$ for $W \\subseteq S\\setminus \\{X, Y\\}$.\nFor example, in Figure 1, we are interested to know if there is a macro conditional independency between $X$ and $Y$ given $W$ in the SCG which means to know if $\\{X_t | t \\in [t_0, t_{max}]\\}$ is independent of $\\{Y_t | t \\in [t_0, t_{max}]\\}$ given $\\{W_t | t \\in [t_0, t_{max}]\\}$. In contrast, a micro conditional independence in Figure 1 is to question if $X_t$ is independent of $Y_{t-1}$ given $W_{t-1}$.\nNote that there exists a fundamental tool called d-separation [Pearl, 1988] that serves for deriving conditional inde- pendence properties from causal graphs. In the following the d-separation of two subsets $X$ and $Y$ conditionally on a third one $W$ in a graph $G$ is denoted as $X \\perp_G Y \\; | \\; W$.\nNow, we define micro total effect and macro total effect.\nDefinition 6 (Micro total effect). A micro total effects in the FT-ADMG $\\mathcal{G} = (V, E)$ is a total effect from a set of temporal variables $X$ to another set of temporal variables $Y$ where $X, Y \\subseteq V$, denoted as $Pr(Y = y \\; | \\; do(X = x))$.\nDefinition 7 (Macro total effect). A macro total effect in the FT-ADMG $\\mathcal{G} = (V, E)$ compatible with the SCG $\\mathcal{G}^s = (S, E^s)$ is a total effect from $V_X$ to $V_Y$ where $X, Y \\in S$, denoted as $Pr(V_Y = v_y \\; | \\; do(V_X = v_x))$.\nSimilarly, we will also define the micro and macro interventions in the FT-ADMG respectively as $\\mathcal{I}^m = \\{do(V_i^t = v_i^t) | i \\in [1,d], t \\in [t_0, t_{max}]\\}$ and $\\mathcal{I}^M = \\{do(V^i = v^i) | i \\in [1,d]\\}$. Consider also the complete set of interventions in the SCG $\\mathcal{I} = \\{do(Y = y) | Y \\in S\\}$ which corresponds to the macro interventions from the point of view of the SCG.\nBy a slight abuse of notation, in the remainder we will denote macro total effects as $Pr(v \\; | \\; do(v))$. Notice that macro queries are a special case of micro queries.\nSection 3 and 4 show that, given only the SCG, it is possible to answer macro queries using existing methods. However, as it will be discusses in Section 5 this is not necessarily true when considering micro queries."}, {"title": "3 Identification of macro conditional independencies", "content": "In this section, we show that d-separation is sound and complete in SCGs for macro queries. Firstly, since an FT- ADMG is an ADMG, the standard definition of d-separation [Pearl, 1998] is directly applicable for FT-ADMG. This definition was introduced for ADMGs and was extended to DMGs in [Forr\u00e9 and Mooij, 2018] and to cluster-ADMGS in [Anand et al., 2023]. But it turned out that it is readily extendable to SCGs, which are a special case of cluster- DMGs.\nDefinition 8 (d-separation in SCGs). In an SCG $\\mathcal{G}^s = (S, E^s)$, a path $\\pi = (V^{P_1},..., V^{P_n})$ is said to be blocked by a set of vertices $W \\subseteq S$ if:\n$\\begin{aligned} &1. \\; \\exists 1 < i < n \\text{ such that } V^{P_{i-1}} {\\leftrightarrow} V^{P_i} \\rightarrow V^{P_{i+1}} \\text{ or } V^{P_{i-1}} \\leftarrow V^{P_i} {\\leftrightarrow} V^{P_{i+1}} \\text{ and } V^{P_i} \\in W, \\text{ or}\\\\ &2. \\; \\exists 1 < i < n \\text{ such that } V^{P_{i-1}} \\rightarrow V^{P_i} \\leftarrow V^{P_{i+1}} \\text{ and } Descendants(V^{P_i}, \\mathcal{G}^s) \\cap W = \\emptyset. \\end{aligned}$\nwhere $\\leftrightarrow$ represents $\\rightarrow$ or ${\\,---\\rightarrow}$, $\\rightarrow$ represents $\\leftarrow$ or ${\\,---\\rightarrow}$, and $*$ represents any of the three arrow type $\\rightarrow$, $\\leftarrow$ or ${\\,---\\rightarrow}$. A path which is not blocked is said to be active. A set $W \\subseteq S$ is said to d-separate two sets of variables $X, Y \\subseteq S$ if it blocks every path from a variable of $X$ to a variable of $Y$."}, {"title": "Identifying macro conditional independencies and macro total effects in summary causal graphs with latent confounding", "content": "Before providing the main results of this section, we define the notion of walks in graphs and show how it is related to the notion of paths. This notion is important in SCGs since they contain cycles and the relation between paths and walks will be useful in the proof of the soundness of d-separation.\nA walk is a sequence of consecutively adjacent vertices and contrary to paths, walks may contain repeating vertices. Furthermore, as in Ferreira and Assaad [2024] we define the notion of primary path of a walk $\\tilde{\\pi} = (V^1,..., V^n)$ as $\\pi = (U^1,..., U^m)$ where $U^1 = V^1$ and $U^{k+1} = V_{max\\{i | V^i = U^k\\}+1}$. The definition of blocked path given in Definition 8 is readily extendable to walks.\nProperty 1 (Active Walks). Let $\\mathcal{G} = (V, E)$ be a FT-ADMG, $W \\subseteq V$ and $\\tilde{\\pi} = (V^1,..., V^n)$ be a walk. If $\\tilde{\\pi}$ is $W$-active then there exist a path $\\pi$ from $V^1$ to $V^n$ which is $W$-active.\nProof. Let $\\mathcal{G} = (V, E)$ be a FT-ADMG, $W \\subseteq V$ and $\\tilde{\\pi} = (V^1,..., V^n)$ be an $W$-active walk. Suppose that its primary path $\\pi = (U^1,..., U^m)$ is $W$-blocked and take $1 < i < m$ such that $(U^{i-1}, U^i, U^{i+1})$ is $W$-blocked.\nIf $U^{i-1} {\\leftrightarrow} U^i \\rightarrow U^{i+1}$ (or symmetrically if $U^{i-1} \\leftarrow U^i {\\leftrightarrow} U^{i+1}$) and $U^i \\in W$ then there exists $1 < j < n$ such that $U^i = V^j$ and $U^{i+1} = V^{j+1}$ and thus $V^{j-1} {\\leftrightarrow} V^j \\rightarrow V^{j+1}$ is in $\\tilde{\\pi}$ and $V^j = U^i \\in W$. Therefore is $W$-blocked.\nOtherwise, $U^{i-1} \\rightarrow U^i \\leftarrow U^{i+1}$ and $Descendants(U^i, \\mathcal{G}) \\cap W = \\emptyset$. Then, there exists $1 < j < n$ such that $U^{i-1} = V^{j-1}$ and $U^i = V^j$ and thus $V^{j-1} \\rightarrow V^j \\leftarrow V^j \\leftrightarrow$ is in $\\tilde{\\pi}$. Take $j \\leq k < n$ such that $V^{j-1} \\rightarrow V^j \\rightarrow ... \\rightarrow V^k$ is in $\\tilde{\\pi}$ and notice that $V^k \\rightarrow V^{k+1}$ and $Descendants(V^k, \\mathcal{G}) \\subseteq Descendants(V^j, \\mathcal{G}) = Descendants(U^i, \\mathcal{G})$ so $Descendants(V^k, \\mathcal{G}) \\cap W = \\emptyset$. Therefore, $\\tilde{\\pi}$ is $W$-blocked which contradicts the initial assumption.\nThe following theorem shows that the d-separation as presented in Definition 8 is sound in SCGs.\nTheorem 1 (Soundness of d-Separation in SCGs). Let $\\mathcal{G}^s = (S, E^s)$ be a SCG and $X, Y, W \\subseteq S$. If $X$ and $Y$ are d-separated by $W$ in $\\mathcal{G}^s$ then, in any compatible FT-ADMG $\\mathcal{G} = (V, E)$, $V_X$ and $V_Y$ are d-separated by $V_W$.\nProof. Suppose $X$ and $Y$ are d-separated by $W$ in $\\mathcal{G}^s$ and there exists a compatible FT-ADMG $\\mathcal{G} = (V, E)$ and a path $\\pi = (V^{P_1},..., V^{P_n})$ from $V^{P_1} \\in V_X$ to $V^{P_n} \\in V_Y$ which is not blocked by $V_W$. The walk $\\tilde{\\pi}^s = (V^{P_1},..., V^{P_n})$ is in $\\mathcal{G}^s$ with $V^{P_1} \\in X$ and $V^{P_n} \\in Y$. Since $X$ and $Y$ are d-separated by $W$ and using the contraposition of Property 1, $W$ blocks $\\tilde{\\pi}^s$ and thus there exists $1 < i < n$ such that $(V^{P_{i-1}}, V^{P_i}, V^{P_{i+1}})$ is $W$-blocked.\nIf $V^{P_{i-1}} {\\leftrightarrow} V^{P_i} \\rightarrow V^{P_{i+1}}$ (or symmetrically $V^{P_{i-1}} \\leftarrow V^{P_i} {\\leftrightarrow} V^{P_{i+1}}$) and $V^{P_i} \\in W$ then $\\exists t \\in [t_0, t_{max}], \\; V^{P_i}_t \\in V_W$ and in particular $V^{P_i} \\in V_W$. Therefore, $\\pi$ is blocked by $V_W$.\nOtherwise, $V^{P_{i-1}} \\rightarrow V^{P_i} \\leftarrow V^{P_{i+1}}$ and $Descendants(V^{P_i}, \\mathcal{G}^s) \\cap W = \\emptyset$. So $V^{P_{i-1}} \\rightarrow V^{P_i} \\leftarrow V^{P_{i+1}}$ and $Desc(V^{P_i}, \\mathcal{G}) \\cap V_W \\subseteq Desc(V^{P_i}) \\cap V_W = \\{V^i \\; | \\; V^i \\in Descendants(V^{P_i}, \\mathcal{G}^s) \\cap W\\} = \\{V^i \\; | \\; V^i \\in \\emptyset\\} = \\emptyset$. Therefore, $\\pi$ is blocked by $V_W$ which contradicts the initial assumption. In conclusion, the d-separation criterion in SCGs is sound.\nThe following theorem shows that the d-separation as presented in Definition 8 is complete in SCGs.\nTheorem 2 (Completeness of d-Separation in SCGs). Let $\\mathcal{G}^s = (S, E^s)$ be a SCG and $X, Y, W \\subseteq S$. If $X$ and $Y$ are not d-separated by $W$ in $\\mathcal{G}^s$ then, there exists a compatible FT-ADMG $\\mathcal{G} = (V, E)$ such that $V_X$ and $V_Y$ are not d-separated by $V_W$\nProof. Suppose $X$ and $Y$ are not d-separated by $W$ in $\\mathcal{G}^s$. Since $X$ and $Y$ are not d-separated by $W$ in $\\mathcal{G}^s$ there exists an $W$-active path $\\pi^s = (V^{P_1},..., V^{P_n})$ with $V^{P_1} \\in X$ and $V^{P_n} \\in Y$. From the SCG $\\mathcal{G}^s = (S, E^s)$ one can build a compatible"}, {"title": "Identifying macro conditional independencies and macro total effects in summary causal graphs with latent confounding", "content": "The findings of this section establish that identifying a d-separation in SCGs guarantees a macro-level d-separation in all compatible FT-ADMGs. This is crucial because, as shown in Pearl [2009], a d-separation in an ADMG implies a conditional independence in the underlying probability distribution. By extending the applicability of d-separation to SCGs, this result allows researchers to infer macro-level conditional independencies even when dealing with par- tially specified graphs that omit specific temporal information. This is particularly valuable in constraint-based causal discovery when the interest is to uncover the structure of the SCG without uncovering an FT-ADMG.\nA bidirected dashed edge (loop) on a single vertex in an SCG does not affect the results of this section. Therefore, modelers can choose whether to include these edges in this context or not. However, these edges can be more valuable for micro conditional independencies."}, {"title": "4 Identification of macro total effects", "content": "The do-calculus initially introduced in Pearl [1995] is an important tool of causal inference that consists of three rules. It allows to express queries under interventions ie, in which there is a do(\u00b7), as queries that can be estimated from observational data ie, in which there is no do(\u00b7). Do-calculus was initially introduced for acyclic graphs so it is not easily extendable to cyclic graphs. But it turned out that it is readily extendable to SCGs (containing cycles).\nFirstly, we define the notion of mutilated graphs [Pearl, 2009]. Consider a causal graph $G = (V, E)$ and $A, B \\subseteq V$, we call a mutilated graph and we write $G_{A \\underline{B}}$ the graph obtained by removing all edges coming in $A$ and all edges coming out of $B$.\nUsing the notion of mutilated graphs and d-separation we can write the three rules of the do-calculus in SCGs."}, {"title": "Identifying macro conditional independencies and macro total effects in summary causal graphs with latent confounding", "content": "Definition 9 (do-calculus in SCGs). Let $\\mathcal{G}^s = (S, E^s)$ be a SCG and $X, Y, U, W \\subseteq S$ be disjoint subsets of vertices. The three rules of do-calculus are:\n$\\begin{aligned} Rule \\; 1&: Pr(v^y \\; | \\; do(v^x), v^u, v^w) = Pr(v^y \\; | \\; do(v^x), v^w) \\\\ & \\text{ if } \\; Y \\; {\\perp}_{\\mathcal{G}^s_{\\underline{X}}} \\; X \\; | \\; U, W \\\\ Rule \\; 2&: Pr(v^y \\; | \\; do(v^x), do(v^u), v^w) = Pr(v^y \\; | \\; do(v^x), v^u, v^w) \\\\ & \\text{ if } \\; Y \\; {\\perp}_{\\mathcal{G}^s_{\\underline{XU}}} \\; X \\; | \\; U, W \\\\ Rule \\; 3&: Pr(v^y \\; | \\; do(v^x), do(v^u), v^w) = Pr(v^y \\; | \\; do(v^x), v^w) \\\\ & \\text{ if } \\; Y \\; {\\perp}_{\\mathcal{G}^s_{\\underline{X(W)}}} \\; X \\; | \\; U, W \\end{aligned}$\nwhere $X(W)$ is the set of vertices in $S$ that are non-ancestors of any vertex in $W$ in the mutilated graph $\\mathcal{G}^s_{\\underline{X}}$.\nIn the following, we introduce a property of compatibility between mutilated graphs that will be useful for proving the soundness and the completness of do-calculus in SCGs (Definition 9).\n$\\mathbb{Property}$ 2 (Compatibility of Mutilated Graphs). Let $\\mathcal{G} = (V, E)$ be a FT-ADMG, $\\mathcal{G}^s = (S, E^s)$ its compatible SCG and $A, B \\subseteq S$. The mutilated graph $\\mathcal{G}^s_{\\underline{AB}}$ is a SCG compatible with the mutilated FT-ADMG $\\mathcal{G}_{V^A \\underline{V^B}}$.\nProof. Let $\\mathcal{G} = (V, E)$ be a FT-ADMG, $\\mathcal{G}^s = (S, E^s)$ its compatible SCG and $A, B \\subseteq S$.\nFirstly, let us show that every arrow in $\\mathcal{G}^s_{\\underline{AB}}$ corresponds to an arrow in $\\mathcal{G}_{V^A \\underline{V^B}}$. Let $X, Y \\in S$ such that $X \\rightarrow Y$ is in $E^s_{\\underline{AB}}$. Because $X \\rightarrow Y$ is in $E^s_{\\underline{AB}}$, we know that $X \\notin B$ and $Y \\notin A$ and that $X \\rightarrow Y$ is in $E^s$. Therefore, there exists $t_0 \\leq t_x \\leq t_y \\leq t_{max}$ such that $X_{t_x} \\rightarrow Y_{t_y}$ is in $E$ and $X_{t_x} \\notin V^B$ and $Y_{t_y} \\notin V^A$ so $X_{t_x} \\rightarrow Y_{t_y}$ is in $E_{V^A \\underline{V^B}}$.\nSimilarly, let $X, Y \\in S$ such that $X {\\,---\\rightarrow} Y$ is in $E^s_{\\underline{AB}}$. Because $X {\\,---\\rightarrow} Y$ is in $E^s_{\\underline{AB}}$, we know that $X, Y \\notin A$ and that $X {\\,---\\rightarrow} Y$ is in $E^s$. Therefore, there exists $t_x, t_y \\in [t_0, t_{max}]$ such that $X_{t_x} {\\,---\\rightarrow} Y_{t_y}$ is in $E$ and $X_{t_x}, Y_{t_y} \\notin V^A$ so $X_{t_x} {\\,---\\rightarrow} Y_{t_y}$ is in $E_{V^A \\underline{V^B}}$.\nSecondly, let us show that every arrow in $\\mathcal{G}_{V^A \\underline{V^B}}$ corresponds to an arrow in $\\mathcal{G}^s_{\\underline{AB}}$. Let $X_{t_x}, Y_{t_y} \\in V_{V^A \\underline{V^B}}$ such that $X_{t_x} \\rightarrow Y_{t_y}$ is in $E_{V^A \\underline{V^B}}$. Because $X_{t_x} \\rightarrow Y_{t_y}$ is in $E_{V^A \\underline{V^B}}$, we know that $X_{t_x} \\notin V^B$ and $Y_{t_y} \\notin V^A$ and that $X_{t_x} \\rightarrow Y_{t_y}$ is in $E$. Therefore, $X \\rightarrow Y$ is in $E^s$ and $X \\notin B$ and $Y \\notin A$ so $X \\rightarrow Y$ is in $E^s_{\\underline{AB}}$.\nSimilarly, let $X_{t_x}, Y_{t_y} \\in V_{V^A \\underline{V^B}}$ such that $X_{t_x} {\\,---\\rightarrow} Y_{t_y}$ is in $E_{V^A \\underline{V^B}}$. Because $X_{t_x} {\\,---\\rightarrow} Y_{t_y}$ is in $E_{V^A \\underline{V^B}}$, we know that $X_{t_x}, Y_{t_y} \\notin V^A$ and that$\\rightarrow$ is non-identifiable in all SCGs depicted in Figure 3 and in the SCG in Figure 1a by examining all possible iterations of the rules of the do-calculus.\nNote that even if the do-calculus is sound and complete for identifying macro total effects in SCGs, the ID algo- rithm [Shpitser and Pearl, 2008] which is based on the do-calculus and complete for directed acyclic graphs can- not be applied in the case of SCGs even for macro total effects. The ID algorithm rely on the notion of hedges [Shpitser and Pearl, 2008] to know if the total effect is identifiable or not. However, this notion of hedges is not sufficient for cyclic graphs. For example, the SCG in Figure 3a contains no hedge but the macro total effect is not identifiable due to the cycle between $X$ and $Y$."}, {"title": "5 What about micro queries?", "content": "In this section, we show that the results presented in this paper do not apply to micro queries.\nIn the context of conditional independencies, even if $X \\; {\\perp}_{\\mathcal{G}^s} \\; Y \\; | \\; W$ in the SCG, we cannot infer that $X_{t-1} \\; {\\perp}_G \\; Y_t \\; | \\; V_W$ where $G$ is compatible with $\\mathcal{G}^s$ and $V_W$ does not include all variables represented by $V_W$.\nIn the context of total effects, Assaad et al. [2024] demonstrated that the total effect $Pr(y_t \\; | \\; do(x_{t-1}))$ is identifiable even if there is a bidirectional arrow $X \\leftrightarrow Y$ in the SCG, provided there are no other cycles involving $X$ and $Y$ as in"}, {"title": "Identifying macro conditional independencies and macro total effects in summary causal graphs with latent confounding", "content": "However, the do-calculus rules described in this paper cannot identify micro queries. It is not complete in the sense that it does not identify every identifiable queries.\nNote that in this work, we assume access to multiple observations for each variable. Estimating the total effect would be infeasible with only a single observation per variable. This limitation does not necessarily apply to micro total effects which can be estimated from single observational under the assumption of stationarity."}, {"title": "6 Related works", "content": "The idea of representing complex low-level causal structures as partially specified high-level graphs has gained some interest in the last years. This section reviews important works, particularly the one relevant to the contributions of this paper.\nIwasaki and Simon [1994], Chalupka et al. [2016], Anand et al. [2023] have explored clustering of low-level variables. Notably, Anand et al. [2023] introduced cluster-ADMGs, which generalize acyclic directed mixed graphs by allowing flexible partitioning of variables while maintaining acyclicity. They extended d-separation and do-calculus to accom- modate macro causal effects in these graphs. Even if SCGs, discussed in our paper, are somehow related (in both graphs vertices represent clusters) to cluster-ADMGs they are inherently different since SCGs can contain cycles.\nMore generally, Richardson [1997], Forr\u00e9 and Mooij [2017, 2018], Forr\u00e9 and Mooij [2020] extended d-separation and do-calculus to causal effects in DMGs. Although not explicitly focusing on cluster-DMGs, their findings might apply to macro queries in such graphs. Indeed, SCGs can be considered as a special case of cluster-DMGs, however, the applicability of the results in Richardson [1997], Forr\u00e9 and Mooij [2017, 2018], Forr\u00e9 and Mooij [2020] to SCGs is not that clear due to SCGs' additional temporal information (the causal order within each cluster is known using temporal priority), which may affect completeness for macro queries but not necessarily soundness. Our research indicates that while this temporal knowledge does not enhance macro query identifiability, it does impact micro queries.\nIn a different view, Rubenstein* et al. [2017], Beckers and Halpern [2019] studied more general notions of abstraction, namely exact $(\\tau - w)$-transformations and $\\tau$-abstractions. If one is only focused in the macro effects then the SCG can be seen as a constructive $\\tau$-abstraction where $\\tau$ is the identity in $\\mathbb{R}^{|[t_0,t_{max}]|}$ (assuming the micro variables take values in $\\mathbb{R}$). Which means that all contributions of this paper can contribute to the development of the theory of more general notion of abstraction. However, this is no longer true if one is interested in the micro effects.\nIn the domain of dynamic systems, [Assaad et al., 2023, Ferreira and Assaad, 2024, Assaad et al., 2024] considered SCGs but for micro queries. They showed that the total effect and the direct effect is identifiable under some mild conditions if there are no hidden confounding which is different from macro causal effects as they are always identifi- able when there is no hidden confounding. Note that consistency throughout time is assumed in these papers because it allows for one multivariate time-series to be divided into multiple instances and thus enables estimation. When considering exclusively macro queries as in this paper, this is no longer true and therefore the consistency throughout time assumption has no clear value. As far as we know there exists still no sound and complete result for d-separation and the do-calculus for SCG in the more general case for micro queries.\nFurthermore, there exists also other related works that include Sch\u00f6lkopf et al. [2021], Shen et al. [2018], Parviainen and Kaski [2016] but we consider them as beyond the scope of the paper."}, {"title": "7 Conclusion", "content": "In this paper, we established the soundness and completeness of the notion of d-separation and the do-calculus for respectively identifying macro conditional independencies and macro total effects in SCGs. By doing so, we bridged the gap between SCGs and many real-world applications in epidemiology. Overall, the confirmation of soundness and completeness of macro d-separation and macro total effects in SCGs enhances the utility of causal graphs in dynamic systems, offering a powerful tool for finding conditional independencies and inferring total effects with greater con- fidence. We also showed through various examples that the results of this paper do not hold when considering micro conditional independencies and micro total effects.\nThe main limitation of our results is that they require a complete observation in time of the entire event system, which is often not feasible in practice. For example, it is challenging to ensure that data collection begins at the onset of each epidemic outbreak. Without this assumption, past instances of observed variables might act as unobserved confounders. In such cases, our results could be valuable for partially identifying [Robins, 1989, Manski, 1990, Pearl, 2009, Zhang and Bareinboim, 2021] macro total effects using SCGs by deriving bounds for the effect under a minimal set of assumptions."}]}