{"title": "IDENTIFYING MACRO CONDITIONAL INDEPENDENCIES AND MACRO TOTAL EFFECTS IN SUMMARY CAUSAL GRAPHS WITH LATENT CONFOUNDING", "authors": ["Simon Ferreira", "Charles K. Assaad"], "abstract": "Understanding causal relationships in dynamic systems is essential for numerous scientific fields, including epidemiology, economics, and biology. While causal inference methods have been extensively studied, they often rely on fully specified causal graphs, which may not always be available or practical in complex dynamic systems. Partially specified causal graphs, such as summary causal graphs (SCGs), provide a simplified representation of causal relationships, omitting temporal information and focusing on high-level causal structures. This simplification introduces new challenges concerning the types of queries of interest: macro queries, which involve relationships between clusters represented as vertices in the graph, and micro queries, which pertain to relationships between variables that are not directly visible through the vertices of the graph. In this paper, we first clearly distinguish between macro conditional independencies and micro conditional independencies and between macro total effects and micro total effects. Then, we demonstrate the soundness and completeness of the d-separation to identify macro conditional independencies in SCGs. Furthermore, we establish that the do-calculus is sound and complete for identifying macro total effects in SCGs. Conversely, we also show through various examples that these results do not hold when considering micro conditional independencies and micro total effects.", "sections": [{"title": "1 Introduction", "content": "In observational studies, causal graphs are vital for decision-making regarding interventions and can be useful for detecting independencies between variables. Several standard tools have been developed for fully specified causal graphs, typically represented as directed acyclic graphs (DAGs) or acyclic directed mixed graphs (ADMGs). For example, d-separation [Pearl, 1988] enables the identification of conditional independencies directly from the graph structure. Similarly, the do-calculus [Pearl, 1995] allows for the derivation of total effect estimands from observational data. These results were also extended to directed mixed graphs (DMGs) [Richardson, 1997, Forr\u00e9 and Mooij, 2017, 2018, Forr\u00e9 and Mooij, 2020].\nHowever, constructing a fully specified causal graph is challenging because it requires knowledge of the causal rela-tionships among all pairs of observed variables. This knowledge is often unavailable, particularly in complex, high-dimensional settings, thus limiting the applicability of causal inference theory and tools. Therefore, recently there has been more interest in partially specified causal graphs [Perkovic, 2020, Anand et al., 2023, Ferreira and Assaad, 2024, Assaad et al., 2024], especially in partially understood domains, such as in epidemiology. An important type of partially specified graphs is the cluster-DMG which provides a coarser representation of causal relationships through vertices that represent a cluster of variables (and can contain cycles). The partial specification of cluster-DMG arises from the fact that each vertex in an cluster-DMG represents a cluster of variables. A well-known special case of cluster-DMGs is the cluster-ADMG, which imposes an acyclicity assumption on the partially specified graph [Anand et al., 2023]. Another notable special case of cluster-DMGs in dynamic systems is the summary causal graph (SCG), where each cluster represents a time series, and all temporal information is omitted from the graph [Assaad et al., 2022]."}, {"title": "2 Summary causal graphs and macro queries", "content": "We suppose that in a dynamic system, observations are generated from a discrete-time dynamic structural causal model (DTDSCM), an extension of structural causal models [Pearl, 2009] to dynamic systems. In the following we use the convention that uppercase letters represent variables and lowercase letters represent their values, moreover letters in blackboard bold represent sets.\nDefinition 1 (Discrete-time dynamic structural causal model (DTDSCM)). A discrete-time dynamic structural causal model is a tuple $\\mathcal{M} = (\\mathcal{L}, \\mathcal{V}, \\mathcal{F}, Pr(\\mathcal{I}))$, where $\\mathcal{L} = \\bigcup_{i \\in [1,d], t \\in [t_0, t_{max}]} \\mathcal{L}^i_t$ is a set of exogenous variables, which cannot be observed but affect the rest of the model. $\\mathcal{V} = \\bigcup_{i \\in [1,d]} \\mathcal{V}^i$ such that $\\forall i \\in [1,d], \\mathcal{V}^i = \\{ V^i_t | t \\in [t_0, t_{max}] \\}$, is a set of endogenous variables, which are observed and every $V^i_t \\in \\mathcal{V}$ is functionally dependent on some subset of $\\mathcal{L} \\cup \\mathcal{V}_{\\leq t} \\setminus \\{V^i_t\\}$ where $\\mathcal{V}_{\\leq t} = \\{V^j_{t'} | j \\in [1, d], t' \\leq t\\}$. $\\mathcal{F}$ is a set of functions such that for all $V^i_t \\in \\mathcal{V}$, $f_{V^i_t}$ is a mapping from and a subset of $\\mathcal{V}_{< t} \\setminus \\{V^i_t\\}$ to $V^i_t$. $Pr(\\mathcal{I})$ is a joint probability distribution over $\\mathcal{L}$."}, {"title": "3 Identification of macro conditional independencies", "content": "In this section, we show that d-separation is sound and complete in SCGs for macro queries. Firstly, since an FT-ADMG is an ADMG, the standard definition of d-separation [Pearl, 1998] is directly applicable for FT-ADMG. This definition was introduced for ADMGs and was extended to DMGs in [Forr\u00e9 and Mooij, 2018] and to cluster-ADMGS in [Anand et al., 2023]. But it turned out that it is readily extendable to SCGs, which are a special case of cluster-DMGs.\nDefinition 8 (d-separation in SCGs). In an SCG $\\mathcal{G}^s = (S, E^s)$, a path $\\pi = (V^{p_1},\u2026, V^{p_n})$ is said to be blocked by a set of vertices $W \\subseteq S$ if:\n1. $\\exists 1 < i < n$ such that $V^{p_{i-1}} ** V^{p_i} \\to V^{p_{i+1}}$ or $V^{p_{i-1}} \\leftarrow V^{p_i} ** V^{p_{i+1}}$ and $V^{p_i} \\in W$, or\n2. $\\exists 1 < i < n$ such that $V^{p_{i-1}} \\to V^{p_i} * V^{p_{i+1}}$ and $Descendants(V^{p_i}, \\mathcal{G}^s) \\cap W = \\emptyset$.\nwhere ** represents $\\to$ or $\\leftrightarrow$, $\\to$ represents $\\leftarrow$ or $\\leftrightarrow$, and * represents any of the three arrow type $\\to$, $\\leftarrow$ or $\\leftrightarrow$.\nA path which is not blocked is said to be active. A set $W \\subseteq S$ is said to d-separate two sets of variables $X, Y \\subseteq S$ if it blocks every path from a variable of $\\mathcal{X}$ to a variable of $\\mathcal{Y}$."}, {"title": "4 Identification of macro total effects", "content": "The do-calculus initially introduced in Pearl [1995] is an important tool of causal inference that consists of three rules. It allows to express queries under interventions ie, in which there is a do(\u00b7), as queries that can be estimated from observational data ie, in which there is no do(\u00b7). Do-calculus was initially introduced for acyclic graphs so it is not easily extendable to cyclic graphs. But it turned out that it is readily extendable to SCGs (containing cycles).\nFirstly, we define the notion of mutilated graphs [Pearl, 2009]. Consider a causal graph $\\mathcal{G} = (\\mathcal{V}, \\mathcal{E})$ and $A, B \\subseteq \\mathcal{V}$, we call a mutilated graph and we write $\\mathcal{G}_{A \\overline{B}}$ the graph obtained by removing all edges coming in A and all edges coming out of B.\nUsing the notion of mutilated graphs and d-separation we can write the three rules of the do-calculus in SCGs."}, {"title": "5 What about micro queries?", "content": "In this section, we show that the results presented in this paper do not apply to micro queries.\nIn the context of conditional independencies, even if $\\mathcal{X} \\perp_{\\mathcal{G}^s} \\mathcal{Y} | W$ in the SCG, we cannot infer that $X_{t-1} \\perp_{\\mathcal{G}} Y_t | W$, where $\\mathcal{G}$ is compatible with $\\mathcal{G}^s$ and $W$ does not include all variables represented by $W$.\nIn the context of total effects, Assaad et al. [2024] demonstrated that the total effect $Pr(y_t | do(x_{t-1}))$ is identifiable even if there is a bidirectional arrow $X \\leftrightarrow Y$ in the SCG, provided there are no other cycles involving $X$ and $Y$ as in"}, {"title": "6 Related works", "content": "The idea of representing complex low-level causal structures as partially specified high-level graphs has gained some interest in the last years. This section reviews important works, particularly the one relevant to the contributions of this paper.\nIwasaki and Simon [1994], Chalupka et al. [2016], Anand et al. [2023] have explored clustering of low-level variables. Notably, Anand et al. [2023] introduced cluster-ADMGs, which generalize acyclic directed mixed graphs by allowing flexible partitioning of variables while maintaining acyclicity. They extended d-separation and do-calculus to accom-modate macro causal effects in these graphs. Even if SCGs, discussed in our paper, are somehow related (in both graphs vertices represent clusters) to cluster-ADMGs they are inherently different since SCGs can contain cycles.\nMore generally, Richardson [1997], Forr\u00e9 and Mooij [2017, 2018], Forr\u00e9 and Mooij [2020] extended d-separation and do-calculus to causal effects in DMGs. Although not explicitly focusing on cluster-DMGs, their findings might apply to macro queries in such graphs. Indeed, SCGs can be considered as a special case of cluster-DMGs, however, the applicability of the results in Richardson [1997], Forr\u00e9 and Mooij [2017, 2018], Forr\u00e9 and Mooij [2020] to SCGs is not that clear due to SCGs' additional temporal information (the causal order within each cluster is known using temporal priority), which may affect completeness for macro queries but not necessarily soundness. Our research indicates that while this temporal knowledge does not enhance macro query identifiability, it does impact micro queries.\nIn a different view, Rubenstein* et al. [2017], Beckers and Halpern [2019] studied more general notions of abstraction, namely exact $(\\tau - w)$-transformations and $\\tau$-abstractions. If one is only focused in the macro effects then the SCG can be seen as a constructive $\\tau$-abstraction where $\\tau$ is the identity in $R^{[t_0,t_{max}]}$ (assuming the micro variables take values in R). Which means that all contributions of this paper can contribute to the development of the theory of more general notion of abstraction. However, this is no longer true if one is interested in the micro effects.\nIn the domain of dynamic systems, [Assaad et al., 2023, Ferreira and Assaad, 2024, Assaad et al., 2024] considered SCGs but for micro queries. They showed that the total effect and the direct effect is identifiable under some mild conditions if there are no hidden confounding which is different from macro causal effects as they are always identifi-able when there is no hidden confounding. Note that consistency throughout time is assumed in these papers because it allows for one multivariate time-series to be divided into multiple instances and thus enables estimation. When considering exclusively macro queries as in this paper, this is no longer true and therefore the consistency throughout time assumption has no clear value. As far as we know there exists still no sound and complete result for d-separation and the do-calculus for SCG in the more general case for micro queries.\nFurthermore, there exists also other related works that include Sch\u00f6lkopf et al. [2021], Shen et al. [2018], Parviainen and Kaski [2016] but we consider them as beyond the scope of the paper."}, {"title": "7 Conclusion", "content": "In this paper, we established the soundness and completeness of the notion of d-separation and the do-calculus for respectively identifying macro conditional independencies and macro total effects in SCGs. By doing so, we bridged the gap between SCGs and many real-world applications in epidemiology. Overall, the confirmation of soundness and completeness of macro d-separation and macro total effects in SCGs enhances the utility of causal graphs in dynamic systems, offering a powerful tool for finding conditional independencies and inferring total effects with greater con-fidence. We also showed through various examples that the results of this paper do not hold when considering micro conditional independencies and micro total effects.\nThe main limitation of our results is that they require a complete observation in time of the entire event system, which is often not feasible in practice. For example, it is challenging to ensure that data collection begins at the onset of each epidemic outbreak. Without this assumption, past instances of observed variables might act as unobserved confounders. In such cases, our results could be valuable for partially identifying [Robins, 1989, Manski, 1990, Pearl, 2009, Zhang and Bareinboim, 2021] macro total effects using SCGs by deriving bounds for the effect under a minimal set of assumptions."}]}