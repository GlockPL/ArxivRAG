{"title": "Enhancing Supply Chain Visibility with Generative AI: An Exploratory Case Study on Relationship Prediction in Knowledge Graphs", "authors": ["Ge Zheng", "Alexandra Brintrup"], "abstract": "A key stumbling block in effective supply chain risk management for companies and policymakers is a lack of visibility on interdependent supply network relationships. Relationship prediction, also called link prediction is an emergent area of supply chain surveillance research that aims to increase the visibility of supply chains using data-driven techniques. Existing methods have been successful for predicting relationships but struggle to extract the context in which these relationships are embedded - such as the products being supplied or locations they are supplied from. Lack of context prevents practitioners from distinguishing transactional relations from established supply chain relations, hindering accurate estimations of risk. In this work, we develop a new Generative Artificial Intelligence (Gen AI) enhanced machine learning framework that leverages pre-trained language models as embedding models combined with machine learning models to predict supply chain relationships within knowledge graphs. By integrating Generative AI techniques, our approach captures the nuanced semantic relationships between entities, thereby improving supply chain visibility and facilitating more precise risk management. Using data from a real case study, we show that GenAI-enhanced link prediction surpasses all benchmarks, and demonstrate how GenAI models can be explored and effectively used in supply chain risk management.", "sections": [{"title": "1. Introduction", "content": "Global supply chains emerge as companies buy products from one another to produce and deliver their own (Bellamy and Basole, 2013). They play a critical role in almost every aspect of our daily lives. 80% of global trade flows through multi-national corporations, and one in five jobs worldwide is tied to global supply chains. Increased volatility and geopolitical tension in recent years have shown how vulnerable we are to supply chain disruptions, with major shortages impacting our food, medicines and supply of electric batteries. In tandem there is rising awareness on the exposure of global supply chains to human rights violations and unsustainable environmental practices, with US and European policy makers proposing legislative measures that demand comprehensive supply chain traceability (K\u00fcblb\u00f6ck, 2013).\nOne of the key stumbling blocks to begin addressing these concerns is a lack of knowledge on interdependent supply chain connections. Most companies have limited visibility beyond their direct connections. Increasing visibility in supply chains have been a rich area of research in the past decade, with multiple technical innovations having been proposed, such as electronic product codes, radio frequency identification, and blockchain technologies. While these have been successful to some extent,\ntheir reach is typically limited to one or two tiers at most. That is because in order for tracking technology to be adopted, companies need to be willing to share data. There is little incentive for companies to share data on whom they buy from, for various reasons. Companies typically view their own supply chains as a competitive advantage, and fear that disclosing information could result in their buyers working directly with their suppliers, reveal their pricing structure, or they may simply be not wish their manufacturing and purchasing practices to be known to the buyer.\nMore recently, researchers have proposed a new solution to this problem, which is to use data driven methods to \"estimate\" who supplies whom, rather than rely on the willingness of companies to share data. Termed as \"Digital Supply Chain Surveillance\" (Brintrup et al., 2023), these methods include network reconstruction (Mungo et al., 2023), web scraping to recognise supply relationships in text obtained from news articles and company annual reports (Wichmann et al., 2018), and machine learning methods for predicting relationships (formally, link prediction).\nMost current methods focus on a single type of relationship, such as firm-level networks that map supply or buy relationships between firms (Brintrup et al., 2018, Mungo et al., 2023). While these approaches provide valuable insights, they"}, {"title": "2. Related Works", "content": "Generative artificial intelligence and link prediction in supply chain networks are two main topics relevant to the proposed approach in this work, reviewed below.\n2.1. Generative Artificial Intelligence\nGenerative Artificial Intelligence (GenAI) refers to a class of machine learning designed to generate new content including text, images, music and even videos, by learning patterns from existing data (Ooi et al., 2023). GenAI models include Generative Adversarial Networks (GANs) (Goodfellow et al., 2014), Variational Autoencoders (VAEs) (Kingma et al., 2019), Transformer-based ChatGPTs (Open AI, 2024), LLaMA (Touvron et al., 2023), DALL-E (Open AI, 2022) and so on. These models have been applied into various fields, leading to significant achievements and efficiencies. One of the most significant capabilities of GenAI is natural language generation. For example, Transformer-based models like ChatGPTs (Open AI, 2024) have demonstrated remarkable abilities in tasks ranging from drafting emails to writing code, showcasing the versatility of GenAI in understanding and generating natural language. (Noy and Zhang, 2023) reported that ChatGPT can substantially raise productivity by decreasing the average time consuming on mid-level professional writing tasks by 40% and increasing the output quality by 18%.\nApart from natural language generation, GenAI models have been used for generating realistic images. For instance, GANs have been used to create high-resolution, photorealistic images that are indistinguishable from real photographs (Karras et al., 2019). Such capabilities have enabled applications in fields like art generation (Louie et al., 2020), virtual reality (Hashim et al., 2023), and data augmentation used for other AI model trainings (Gowda et al., 2024).\nAs with many other domains, the capabilities of GenAI have recently been explored in the field of supply chain management, albeit very few studies exist. Those which does exist, do not yet report technical performance, but rather explore potential benefits and applications. (Fosso Wamba et al., 2023) explored the benefits, challenges and trends associated with GenAI technologies like ChatGPT in Supply Chain and Operation Management (SCOM) by surveying practitioners in the United Kingdom and the United States. This study reveals an increased efficiency from GenAI adopters compared to non-adopters and highlights that the integration of GenAI can significantly enhance overall"}, {"title": "3. Combining Pretrained Language Models and Knowledge Graphs", "content": "3.1. Preliminaries: From triplets to quintuplets\nAs mentioned earlier, the first set of studies in literature solved the supply chain link prediction problem on a graph with links representing companies (Brintrup et al., 2018, Cai et al., 2021, Kazemi and Poole, 2018, Kosasih and Brintrup, 2022). This approach aimed at learning connection patterns surrounding two companies, estimating a connection between them (Figure 1). The second set of studies represent supply chain information as a knowledge graph (KG) with multiple types of links (Kosasih et al., 2022, Rossi et al., 2021).\nA KG is represented by a heterogeneous graph G and its ontology O, the former being the actual data and the latter its schema. KG can also be seen as a collection of facts represented by predicate logic statements. A KG is based on an ontology, that defines data types and attributes, with a relational taxonomy. Each item in the data is an entity (or a node in a graph), and the relationships between data are edges, or links. In previous works, KGs have been used to model edges such as who-produces-what, who-has-what-certification, in addition to buyer-supplier links (Figure 1), the structure of which then inform one another.\nBoth of the above approaches introduce triplets to describe and predict relationships. A triplet, also known as a triple or a statement, consists of three components: subject, predicate, and object, and is used to define the relationship between a subject and an object (Figure 1). Singular links are analysed at a time - where we can predict \"what a company produces\", and \"to whom it sells\", but not contextual information such as \"which"}, {"title": "4. Case Study", "content": "The case study used to evaluate the proposed approach from the automotive sector where companies produce car parts, such as engines, front axles, fuel tanks and sell them to car manufacturing companies around the world. The dataset has been used as a benchmark for link prediction problem within supply chain networks in previous works and therefore offers potential for cross-comparison (Brintrup et al., 2018, Kosasih and Brintrup, 2022, Kosasih et al., 2022). The dataset comprises 43,131 companies spanning 72 countries and producing 927 distinct products, each company associated with one or more of 5 certification types, along with the relationships among these entities (Table 3).\nWe separated the data at the country level so as to evaluate our approach over multiple heterogeneous datasets. As shown in Table 4 each partition has different numbers of companies, products, certificates and relationships.\n27 datasets have thus been generated. As a starting point, we use the same knowledge graph ontology as previous works with three types of entities: companies, products, and certificates, and four types of relationships (triplets): (company, has product), (company, has_cert, certificate), (company, supplies_to, company) and (product, purchased_by, company) (see Figure 1 c).\nFour triplets are used to generate two quintuplets for the evaluation of the proposed approach. Two quintuplets are (company, supplies, product, to, company) and (company, with, certificate, has, product). The prediction problem thus is the existence of a given quintuplet. Therefore, we consider the relationship prediction in a quintuplet as a binary classification problem.\nNext, we explain how we generate positive and negative relationships based on quintuplets to train the models, followed by experimental settings and results.\n4.1. Generating training data\nWe refer to actual relationships in a quintuplet as positive relationships and non-existing relationships as negative relationships. To train a machine learning model both positive relationships and negative relationships are needed.\nNegative quintuplets are generated by the same triplets that were used to produce positive quintuplets. Consider the following positive quintuplet, (company A, supplies, product 1, to, company B), three negative quintuplets can be generated by replacing any one of the three entities: (company A, has product, product 1), (product 1, purchased_by, company B) and (company A, supplies_to, company B), using the one that does not connect the other two.\nGiven two lists of unique entities i.e. the list of unique companies and the list of unique products, (company A, supplies, product 1, to, company B), we randomly select a company named company C, that does not connect both company A and company B, from the list of unique companies to replace company A or company B. Alternatively, we can randomly select a product named product 2, that does not connect to either company A and company B, and replace it with product 1. Therefore, we can generate three negative quintuplets: (company C, supplies, product 1, to, company B), (company A, supplies, product 1, to, company C) and (company A, supplies, product 2, to, company B). In addition, incorrect relationship direction is also considered as negative quintuplets, such as (company B, supplies, product 1, to, company A).\nBased on the above method each positive quintuplet can be used to produce several negative quintuplets. Since negative training data would far outweigh positive training data, we randomly select one negative quintuplet with the related positive quintuplet to train the model in order to have a balanced dataset.\n4.2. Experimental Settings\nExperimental settings in this work include benchmark settings and model training settings. The benchmark settings aim to evaluate whether machine learning models with the help of pretrained LMs can provide more accurate relationship predictions in supply chain networks while the model training settings aim to set the optimal parameters during the model training phase.\n4.2.1. Benchmarks\nTo evaluate the effectiveness of our proposed approach, we set machine learning models without the help of pretrained LMs as benchmarks. The proposed approach is designed to power machine learning models by pretrained LMs so we also select five pretrained LMs (cf. Section 3) to test the approach.\n4.2.2. Settings of Model Training\nAs the language models used in this work are pre-trained models, we only need to set parameters to train machine learning models, which are shown in Table 2. The parameters during the training phase include the number of epochs, $E$, batch size, $B$, and learning rate, $r$. To ensure the uniformity of experiments and follow common guidelines in machine learning training (Yang and Shami, 2020), we set $B$ as 64 and $r$ as 0.001 for all five machine learning models. For the number of epochs, $E$, we use the stop - early strategy to stop the training process if the training loss decreases but validating loss increases in 10 continuous epochs for the determination of $E$ and also prevents overfitting.\nWe consider the problem of relationship prediction in supply chain networks as a binary classification problem mentioned earlier. We thus use the Cross-Entropy Loss as the loss function for all machine learning model training. Adam (Kingma and Ba, 2014) is selected as the optimiser for all machine learning models.\nIn addition, following the common rules for splitting dataset into training, validating and testing, we use 70%, 10% and 20% of relationships present in each data partition. All experiments are run on a desktop with an Intel\u00ae Core\u2122 i9-9900K CPU and a GeForce RTX 2080 Ti GPU card with 11 GB physical memory. PyTorch is used to develop and train all models.\n4.2.3. Performance Metrics\nCommon metrics, including accuracy, precision, recall and f-score, used to evaluate the performance of a classification approach are also used to evaluate our proposed approach. Table 5 shows a confusion matrix used to calculate the four metrics. In our case, TP and TN respectively represent positive and negative relationships that are predicted correctly while FP and FN respectively describe positive and negative relationships that are predicted incorrectly. Based on Table 5, the four common metrics can be calculated as:\n\u2022 accuracy = $\\frac{TP+TN}{TP+TN+FP+FN}$ describes the ratio of correct relationship predictions to the total number of relationships.\n\u2022 precision = $\\frac{TP}{TP+FP}$ stands for the ratio of accurate predictions of positive relationships to the total number of predicted positive relationships."}, {"title": "5. Conclusions, Managerial Implications, and Future Works", "content": "Relationship prediction, also called link prediction, or supply network reconstruction, is an emergent area of \"digital supply chain surveillance\" research that aims to increase visibility of supply networks using data-driven techniques without having to rely on the willingness of supply chain actors to share information. Although many of the proposed methods have been very successful in reconstructing supply-buy relationships the context in which these relationships are embedded has thus far lacked attention. This hinders researchers and practitioners to take full advantage of these methods, as they cannot accurately differentiate between a transactional relationship and established supply relationships that characterise physical resources needed to produce a product. As such, estimations of resilience, distance to malicious actors and harmful practices based remain inaccurate.\nRecently, Generative AI (GenAI) methods such as LLMs have become popular in eliciting information patterns from natural language data. There is also much hype in their potential in SCM. However we cannot simply ask an LLM whether a supply relationship exists, due to their hallucination problem. Hence we need methods to combine the power of GenAI methods with structured, guaranteeable methods when it comes to supply network surveillance. To date, there have been no studies on the use of LLMs for supply network surveillance.\nIn this work, we developed a framework that used GenAI and machine learning for predicting complex relationships of entities in supply chain networks. We defined a new term, \"quintuplet\", to describe the complex relationships that consist of multiple connected relationships and present a complete information flow, instead of commonly used triplets in the literature describing partial information. Quintuplets provide contextual information to relationships, such as the flow of products a relationship is set for. We define the link prediction problem as a binary classification problem, aiming to predict whether a quintuplet exists or not. We then develop a machine learning-based approach enhanced by a type of GenAI models, pretrained LLMs, used as a knowledge base. This allows us to tap into the benefits of LLMs while at the same time, mitigate hallucinations."}]}