{"title": "On the Complexity of Global Necessary Reasons to Explain Classification", "authors": ["Marco Calautti", "Enrico Malizia", "Cristian Molinaro"], "abstract": "Explainable Al has garnered considerable attention in recent years, as understanding the reasons behind decisions or predictions made by AI systems is crucial for their successful adoption. Explaining classifiers' behavior is one prominent problem. Work in this area has proposed notions of both local and global explanations, where the former are concerned with explaining a classifier's behavior for a specific instance, while the latter are concerned with explaining the overall classifier's behavior regardless of any specific instance. In this paper, we focus on global explanations, and explain classification in terms of \"minimal\" necessary conditions for the classifier to assign a specific class to a generic instance. We carry out a thorough complexity analysis of the problem for natural minimality criteria and important families of classifiers considered in the literature.", "sections": [{"title": "1 Introduction", "content": "Explainable AI (XAI) has become a very active research area in the latest years. Being able to explain Al systems' behavior is crucial for their successful adoption, and this becomes even more important in critical domains, such as healthcare and finance, where decisions made by Al systems impact people's life. Among different interesting problems in XAI, explaining classifiers' decisions has attracted significant attention [Bae+10; MI22; Mar24].\nWork in this area has proposed notions to explain classifiers' behavior on a specific feature vector (instance), providing so-called local explanations, as well as notions to explain the overall classifier's behavior regardless of any particular instance, providing so-called global explanations. For both notions, a key issue is to analyze the computational complexity of the problems at hand, since this is crucial to understand how to approach the development of algorithmic solutions and their inherent limits. In the field of XAI, there has been an extensive body of work addressing complexity issues [BAK24; OPS23; Are+23; CM23; CA23; CCM23; Hua+22; Aud+22; CM22; Bar+20a; Mar+20]\nThis paper falls within this ongoing research stream. Specifically, we deal with global explanations, and focus on so-called global necessary reasons, defined as conditions that instances must satisfy in order to be classified with a class of interest.\nThis notion has been considered by Ignatiev, Narodytska, and Marques-Silva [INM19], where an interest- ing relationship with another kind of global explanation is shown. However, this is all we know about global"}, {"title": "3 Global Necessary Reasons", "content": "In this section, we consider the notion of a global necessary reason as a way to explain classifiers' behavior. Intuitively, for a classifier and a class of interest, the idea is to provide a condition that must be necessarily satisfied (by any instance) for the classifier to assign the class. Additionally, in order to identify the most infor- mative global necessary reasons, we will be interested in \u201cminimal\u201d ones, as defined later on. This section also introduces the (decision) problems whose complexity will be analyzed in the rest of the paper.\nTo express global necessary reasons, we use the logical language defined below. Let $\\mathcal{L}[n]$ denote the set of all expressions, called conditions, of the form $\\bigwedge_{i=1}^m l_i$, where $m \\geq 0$, each $l_i$ is a literal of the form $t \\diamond t'$, with $\\diamond \\in {=, \\neq}$, and $t, t'$ are terms from the set ${0, 1} \\cup {v_i | 1 \\leq i \\leq n}$, where each $v_i$ is a Boolean variable, i.e., over the values ${0, 1}$, associated to the $i$-th feature. Notice that a condition can be empty (i.e., $m = 0$); we use $\\top$ to denote such a condition."}, {"title": "4 Complexity Analysis", "content": "In this section, we study the complexity of ISNECESSARY[C] and IsMINNECESSARY[C, \u4eba], for each family of classifiers C \u2208 {BDD, MLP, PRC}, and preorder \u3126\u2208 {\u2264, \u2286}. A summary of the complexity results obtained in this paper for these two problems is reported in Table 4.1; all the missing proof details are in the appendix in the supplementary material.\nWe start by carrying out some observations regarding the problem ISMINNECESSARY[C, \u5c0f]. Given a classi- fier M, a class c, and a condition 4, an obvious procedure deciding whether $ is a\u513f-minimal global necessary reason is to first check that $ is a global necessary reason, and then verify that $ is \u4ece-minimal. The latter can naively be checked by iterating over every possible condition & and checking, whenever \u03c8 < 4, that \u03c8 is not a global necessary reason.\nThe main issue with the above procedure is that in order to verify that is \u4ece-minimal, the procedure iterates over all the possible conditions \u03c8, which are exponentially many in n. In addition, for each such condition 4, the procedure must check whether \u03c8 < 6, which in turn may require to iterate over the (possibly) exponentially many instances x such that x = 4. We are however able to provide the next characterization, enabling us to greatly simplify the process of checking whether a global necessary reason $ is \u4ece-minimal; this also enables us to pinpoint the exact complexity of ISMINNECESSARY[C, \u5c0f] by deriving tight upper bounds.\nLemma 4.1. Let M be a classifier, let c be a class, and let & be a global necessary reason. Then, for each preorder \u4eba\u2208 {\u2264, \u2286}, o is not \u4ece-minimal iff there exists a literal l such that \u00a2 |\u2260 l and l is a global necessary reason.\nVery interestingly, Theorem 4.1 implies that <- and C-minimality of conditions from L[n] are actually equivalent.\nTheorem 4.1 moreover suggests a simple procedure to check whether a condition & is a \u4ece-minimal global necessary reason (see Algorithm 1): first, we check that $ is a global necessary reason, and then we check that \u0444 is -minimal by verifying that there is no literal l for which \u00a2 |\u2260 l and such that l is a global necessary reason; by what we observed above, notice how the algorithm does not depend on the preorder < or C."}, {"title": "4.1 The Case of Perceptrons", "content": "We start considering the family of classifiers based on perceptrons. As already discussed in the previous section, we first need to understand the complexity of ISNECESSARY[PRC].\nTheorem 4.3. IsNECESSARY[PRC] is in L.\nAs the complexity class L is closed under complement, we obtain the result above by showing membership in L of the complement problem ISNOTNECESSARY[PRC]: for a perceptron S, a class c, and condition \u00f3, decide whether & is not a global necessary reason. The condition & can be shown not being a global necessary reason by finding an instance x such that S(x) = c and x = $. Intuitively, we show that the latter can be achieved by encoding within S the opposite of a literal from 4, and by then showing that for such a modified perceptron there exists an instance classified as c.\nRemember now that the generic Algorithm 1 decides ISMINNECESSARY[C, \u5c0f] also for C = PRC, and for each\u2208 {\u2264,\u2286}. Since by Theorem 4.3 and Theorem 4.2, lines 1, 3 and 4 of Algorithm 1 are feasible in logspace, and each literal l considered in each iteration can be stored in logarithmic space, the entire procedure can be carried out in logspace, when considering perceptrons. The next result follows.\nTheorem 4.4. IsMINNECESSARY[PRC, <] is in L, for each \u3126 \u2208 {\u2264,C}."}, {"title": "4.2 The case of BDDS", "content": "In this section we consider the family of classifiers based on BDDs. As already done for perceptrons, we first analyze the complexity of checking whether a given condition is a global necessary reason. We focus on the complement problem, which we call IsNOTNECESSARY[BDD], as the complexity result pertains NL, which is closed under complement.\nMore specifically, we pinpoint an interesting characterization for the conditions from L[n] that are not global necessary reasons, when focusing on BDDs. This property allows us to devise a nondeterministic proce- dure having very low space usage, i.e., logarithmic, which we report as Algorithm 2, and that decides whether a condition is not a global necessary reason for a BDD. We discuss this next."}, {"title": "4.3 The case of MLPS", "content": "In this section we consider the family of classifiers based on MLPs. As usual, we first analyze the complexity of checking whether a given condition is a global necessary reason.\nTheorem 4.8. ISNECESSARY[MLP] is co-NP-complete.\nProof. (Membership). We show that the problem is in co-NP by means of a simple polynomial-time guess and check procedure deciding the complement of IsNECESSARY [MLP]. That is, given an MLP N, a class c, and a condition 4, we can decide whether & is not a global necessary reason by guessing an instance x, which is of polynomial size in n, and by then checking that N(x) = c and x |\u2260 $. Checking N(x) = c can be carried out in polynomial time in the size of x and N, as it suffices to compute the result of each layer of N by means of matrix multiplications. Finally, checking x \u2260 & requires computing $[x] and verifying that the latter evaluates to false.\n(Hardness). We show the co-NP-hardness of the problem via a polynomial-time reduction from the UNSAT problem: given a 3CNF Boolean formula y, decide whether V is unsatisfiable. The reduction constructs an MLP Ny starting from V by exploiting a result by [Bar+20b, Lemma 13] showing that any Boolean formula can be encoded as an MLP, which can be obtained in polynomial time in the size of the formula. Together with Ny, the reduction constructs the class c = 1 and the condition $ = (1 = 0).\nNow, if & is unsatisfiable, by Barcel\u00f3, Monet, P\u00e9rez, and Subercaseaux's result, for every instance x, it holds that N(x) = 0 \u2260 c, hence [Ny, c] = \u00d8 \u2286 [6], and thus \u222e is a global necessary reason for c w.r.t. Ny. If V is satisfiable, by Barcel\u00f3, Monet, P\u00e9rez, and Subercaseaux's result, there exists an instance x with N\u2084(x) = 1 = c, and thus [Ny, c] \u2260 \u00d8, while [6] = \u00d8. Hence, & is not a global necessary reason for c w.r.t. Np.\nWe are now ready to prove that, for each \u3126\u2208 {\u2264, \u2286}, ISMINNECESSARY[MLP, \u5c0f] is DP-complete.\nTheorem 4.9. IsMINNECESSARY[MLP, \u5c0f] is DP-complete, for each \u3126 \u2208 {\u2264,\u2286}."}, {"title": "4.4 Computing Minimal Global Necessary Reasons", "content": "In this section we discuss how the complexity results we obtained for ISNECESSARY and ISMINNECESSARY allow us to study the complexity of the problem of computing a minimal global necessary reason.\nIn what follows, for a family C of classifiers, and a preorder \u3126\u2208 {\u2264, \u2286 }, we use FINDMINNECESSARY[C, \u5c0f] to denote the problem of computing, given a classifier M \u2208 C and a class c \u2208 {0,1}, a \u4ece-minimal global necessary reason f for c w.r.t. M.\nLower bounds. We observe that the complexity of the problem FINDMINNECESSARY[C, \u5c0f] is no lower than that of ISMINNECESSARY[C, \u5c0f], which is shown by reducing the latter to the former in polynomial time. That is, we show that IsMINNECESSARY[C, \u5c0f] can be solved in polynomial time by using an oracle for the prob- lem FINDMINNECESSARY[C, \u5c0f]. First, note that any two \u4ece-minimal global necessary reasons have the same models-otherwise their conjunction would also be a global necessary reason (strictly) preceding both of them w.r.t. . Consider a classifier M\u2208 C, a class c \u2208 {0, 1}, and a condition 4. To decide whether $ is a\u4eba-minimal global necessary reason for c w.r.t. M, it is enough to compute a \u4ece-minimal global necessary reason y using the oracle for FINDMINNECESSARY[C, \u5c0f], and then verify that \u25ca and 4 have the same models by checking that they entail (=) exactly the same set of literals. The latter can be done in polynomial time since there are O(n\u00b2) literals to check, and by the fact that entailment of a literal can be checked in logarithmic space, by Theorem 4.2.\nUpper Bounds. We show that the problem FINDMINNECESSARY[C, \u5c0f] can be solved in polynomial time using an oracle for IsNECESSARY[C]. Consider a classifier M \u2208 C, and a class c \u2208 {0,1}. To compute a \u4ece-minimal global necessary reason for c w.r.t. M, perform the following steps: (1) set i = 1, and let $1 = T; (2) if there is a literal l such that (i) di \u2260l and (ii) i \u2227 l is a global necessary reason, then (3) set $i+1 = $i ^l, increment i, and go back to step (2), otherwise output di. Note that (ii) can be checked by using the oracle for ISNECESSARY[C], the number of oracle calls is polynomial since there are O(n\u00b2) literals to consider, and the procedure is correct by Theorem 4.1.\nFrom the above discussions we conclude that for each preorder \u4ece\u2208 {\u2264, C}:\n\u2022 FindMinNeceSSARY[C, \u5c0f], with C \u2208 {PRC, BDD}, can be solved efficiently, i.e., in polynomial time, since ISNECESSARY[PRC] and ISNECESSARY[BDD] are in L and NL, respectively.\nFINDMINNECESSARY[MLP, \u5c0f] can be solved in polynomial time with a polynomial number of calls to a co-NP oracle, since the problem IsNECESSARY[MLP] is in co-NP. Moreover, the above upper bound can- not be significantly improved (i.e., reduced to polynomial time), unless PTIME = NP, since the problem ISMINNECESSARY[MLP, \u5c0f] is DP-hard, which implies that FINDMINNECESSARY[MLP, \u5c0f] is DP-hard as well."}, {"title": "5 Related Work", "content": "Explaining global classifiers' decisions has been considered in previous work in different forms.\nIgnatiev, Narodytska, and Marques-Silva [INM19] proposed two notions of global explanations, providing also a relationship between them. Specifically, an absolute explanation for a class c w.r.t. a classifier M is a subset-minimal set E of feature-value pairs (fi, ci), where no feature occurs twice in E, such that every instance x matching & (i.e., the instance has value ci on feature fi, for every feature fi in E) is such that M(x) = c. A counterexample for a class c w.r.t. a classifier M is a subset-minimal set E of feature-value pairs (fi, ci), where no feature occurs twice in E, such that every instance x matching E is such that M(x) \u2260 c. Thus, the \u201cnegation\u201d of E can be seen as a global necessary reason for c, whose form is a disjunction of literals though. Our explanations are expressed in terms of conjunctions, which is a widely adopted form-most of the work discussed in this section employs this form. Furthermore, our language goes beyond simple conjunctions of feature-value pairs, as already discussed in Section 3. Importantly, we deepen the study of global necessary reasons by providing a complexity analysis for concrete families of classifiers and consider different minimality criteria.\nBassan, Amir, and Katz [BAK24] introduced a notion of \"global necessary reason\u201d where both concepts of necessity and globality have fundamentally different meanings.\nIn [BAK24], necessity applies to a single feature i of an instance x, and means that i must belong to all local sufficient reasons for x.4 Equivalently, a feature i is locally necessary for x if changing the value of i in x changes the class that the classifiers assigns to x. Similarly, in [BAK24], globality applies to a single feature i, and means that i is a local necessary reason for all instances. Thus, a global necessary reason, according to the definition proposed by [BAK24], focuses only on whether changing the value of a feature changes the class, and it does not take any specific class of interest into account, while doing so.\nIn contrast, our notion of \u201cnecessity\u201d is rooted in logic: in the implication A \u2192 B, B is necessary for A to hold, because if B does not hold, A cannot hold either. Accordingly, for us, a formula & is a necessary reason for a class c w.r.t. a classifier M if, for all instances x, (M(x) = c) \u2192 (x = $), that is, if x does not satisfy 4, then M does not classify x with c. Finally, in our case, by \u201cglobality\u201d we mean the ability of an explanation (in our case, a condition) to best approximate via a logic formula the family of instances classified by the classifier with a specific class of interest. Employing logic formulas to characterize conditions that are necessary (and/or sufficient) for classifiers' decisions has been adopted by different works\u2014e.g., see the recent tutorial by Darwiche [Dar23].\nDarwiche and Hirth [DH20] proposed several notions of explanations, including necessary reasons, which differ significantly form ours, in that the former are \u201clocally\" defined w.r.t. a specific instance.\nThe works discussed in the following focus on different forms of sufficient properties for a classifier to assign a certain class, and thus differ from our approach in that we adopt necessary properties. Furthermore, the works below do not provide a complexity analysis.\nWang, Rudin, Doshi-Velez, Liu, Klampfl, and MacNeille [Wan+17] learn a rule set model, which is a set of rules, where each rule is a conjunction of conditions. Rule set models predict that an observation is in the positive class when at least one of the rules is satisfied. Given a set of records, each associated with a positive or negative class, the goal is to find a rule set model that covers mostly the positive class, but little of the negative class, while keeping the rule set model a small set of short rules.\nSetzu, Guidotti, Monreale, and Turini [Set+19] propose an approach to derive a global explanation from local ones, where both are expressed as decision rules. Specifically, the global explanation is a subset of the local explanation decision rules and is obtained by selecting only the local explanations with a score above a given threshold. The score of a rule is defined so as to measure its generality and accuracy. Setzu, Guidotti, Monreale, Turini, Pedreschi, and Giannotti [Set+21] also construct a global explanation from local ones (again, both expressed as decision rules), but the global explanation is computed by iteratively generalizing the local"}, {"title": "6 Summary and Outlook", "content": "We have considered the problem of explaining classifiers' behavior in terms of (minimal) global necessary rea- sons. We have provided a complete picture of the complexity of relevant problems for different families of classifiers and minimality criteria, which was lacking in the literature.\nThere are several natural directions for future work.\nFirst, our study might be extended along different dimensions, such as by considering other (more expres- sive) languages to express conditions, different minimality criteria, and other families of classifiers, analyzing their impact on the computational complexity.\nAlso, a natural next step is the development of algorithms to compute (minimal) global necessary reasons (along with their experimental evaluation)\u2014in this respect, our results provide valuable insights into how to tackle their development, as already discussed in the introduction.\nAnother avenue for future work is to carry out complexity analyses for other important notions proposed in the literature where a systematic study is still lacking, such as for global sufficient reasons, which are the logical dual of global necessary reasons: precisely, a global sufficient reason for a class c w.r.t. a model M is a formula $ such that, for each instance x, (x = \u00a2) \u2192 (M(x) = c)."}, {"title": "Appendices", "content": "Appendix A Detailed Proofs\nIn this section we provide the missing proofs for the claims stated in Section 4.\nLemma A.1. Let M be a classifier, let c be a class, and let & be a global necessary reason. Then, for each preorder \u5c0f\u2208 {\u2264, }, o is not \u4ece-minimal iff there exists a literal l such that \u00a2 |\u2260 l and l is a global necessary reason.\nProof. (\u21d2). We first show that if ( is not \u4ece-minimal, then there is a literal l such that \u00a2 |\u2260 l and l is a global necessary reason.\nAssume that y is a global necessary reason for c w.r.t. M such that \u03c8 < $, and consider the condition \u0393 = \u03c6 \u039b \u03c8.\nWe start by proving that: (i) \u0393 is also a global necessary reason for c w.r.t. M, and (ii) [\u0393] \u2286 [6]. Regarding (i), since both 4 and \u03c8 are global necessary reasons for c w.r.t. M, [M, c] \u2286 [6] and [M, c] \u2286 [4]. By this, we have that [M, c] \u2286 [6] \u2229 [4]. Since [\u0393] = [\u03c6 ^ \u03c8] = [4] \u2229 [y], we can conclude that \u0393 is a global necessary reason for c w.r.t. M. Regarding (ii), since \u0393 = \u03c6 \u039b \u03c8, we have that [F] \u2286 [6] and [F] \u2286 [Y]. Moreover, regardless of \u4eba actually being < or \u2286, from 4 \u4eba \u222e it follows that |[4]| < |[$]|. The latter, together with [\u0393] \u2286 [4] and [\u0393] \u2286 [6], imply that the inclusion [F] \u2286 [6] is actually strict, i.e., [\u0393] \u2286 [6].\nWe now claim that there must be a literal l in 4 such that \u00a2 |\u2260 l. Indeed, if this were not the case, i.e., if every literal l in \u03c8 were such that \u00a2 |= l, then it would mean that [F] = [\u00a2\u2227\u03c8] = [6], which cannot be the case, since we have proved that [\u0393] \u2286 [6] (see above).\nConsider now such a literal l. Since l belongs to \u03c8, and since \u0393 = \u03c6 \u039b \u03c8, we have that [\u0393] \u2286 [l]. Since we proved that I is a global necessary reason for c w.r.t. M, then l is also a global necessary reason for c w.r.t. \u039c.\nThus, l is a literal such that & Fl and l is a global necessary reason.\n(\u2190). We now show that if there is a literal l such that \u00a2 |\u2260 l and l is a global necessary reason, then o is not -minimal.\nSince & and l are both global necessary reasons for c w.r.t. M, we have that [M, c] \u2286 [6] and [M, c] \u2286 [l]. Because [ ^ l] = [6] ~ [l], it must be the case that [M, c] \u2286 [$ \u2227 l], which implies that \u00a2 \u2227 l is a global necessary reason for c w.r.t. M. Moreover, since \u00a2 |\u2260 l, there is an instance in [4] that does not belong to [l]. The latter, together with the facts that [\u00f8\u2227l] \u2286 [6] and [6\u2227l] = [6] \u2229 [l], imply that [\u00f8\u2227l] \u2286 [6].\nHence, we conclude that \u03c8 = $ ^ l is a global necessary reason for c w.r.t. M such that \u03c8 \u2286 6, by which is not-minimal. Observe that [V] F [6] implies |[4]| < |[6]|, and hence & is also not \u2264-minimal.\nTheorem 4.2. Let \u222e be a condition, and let l be a literal. Deciding whether \u00a2 = l (or \u00a2 \u2260 l) is in L.\nProof. Since L is closed under complement, it suffices to show that checking $ = l is in L; the fact that deciding l is in L will follow immediately.\nThe general strategy of the proof is to show that a condition 4, together with a literal l, can equivalently be rewritten as a propositional formula V in 2CNF of a particular shape, so that $ = l iff & is unsatisfiable.\nWe then argue that, although checking whether a 2CNF formula is unsatisfiable is NL-complete in general, for 2CNF formulas of the particular shape we build the problem becomes solvable in logspace.\nRemember that a 2CNF formula & is a Boolean formula, over a set of Boolean variables X, of the form C\u2081\u06f8\u06f0\u06f0\u06f0\u06f8 Cm, where each Ci is a clause. A clause is an expression of the form x or \u00abx, for x \u2208 X, or of the form (l1 V l2), where 11 and 12 can be either variables from X, or their negation. The disjunction (l1 V l2) can be written as the implication (\u00acl\u2081 \u2192 l2). The formula & is satisfiable iff there is a way to assign to its variables either 1 or 0 so that the formula evaluates to 1, under the standard semantics of Boolean operators."}]}