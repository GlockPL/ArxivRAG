{"title": "Active Learning for Energy-Based Antibody Optimization and Enhanced Screening", "authors": ["Kairi Furui", "Masahito Ohue"], "abstract": "Accurate prediction and optimization of protein-protein binding affinity is crucial for therapeutic antibody development. Although machine learning-based prediction methods AAG are suitable for large-scale mutant screening, they struggle to predict the effects of multiple mutations for targets without existing binders. Energy function-based methods, though more accurate, are time consuming and not ideal for large-scale screening. To address this, we propose an active learning workflow that efficiently trains a deep learning model to learn energy functions for specific targets, combining the advantages of both approaches. Our method integrates the RDE-Network deep learning model with Rosetta's energy function-based Flex ddG to efficiently explore mutants that bind to Flex ddG. In a case study targeting HER2-binding Trastuzumab mutants, our approach significantly improved the screening performance over random selection and demonstrated the ability to identify mutants with better binding properties without experimental AAG data. This workflow advances computational antibody design by combining machine learning, physics-based computations, and active learning to achieve more efficient antibody development.", "sections": [{"title": "Introduction", "content": "Optimizing the binding affinity between proteins is an important aspect of drug development, including antibody engineering [1, 2]. In recent years, deep learning-based de novo molecular design methods have been proposed [3-8]. However, approaches that utilize existing antibody information to design improved variants are also important, as de novo methods may not fully leverage the knowledge of existing antibodies [9-12]. This is particularly crucial when dealing with known antibodies that require improvements in desirable properties such as binding affinity, specificity, and developability. In recent years, many mutation-induced binding free energy change ($\\Delta\\Delta G$) prediction methods based on machine learning and deep learning have been proposed [9, 13\u201318], and their prediction accuracy has improved. However, in cases where there are insufficient data on existing antibodies, the prediction results may not be reliable. In such situations, even if the predicted $\\Delta\\Delta G$ for mutants, especially multiple mutations, is optimized, overfitting may occur, making it difficult to propose improved sequences in practice. In addition, traditional methods for calculating $\\Delta\\Delta G$ of mutants based on energy functions [19\u201321] are applicable even when sufficient $\\Delta\\Delta G$ information about known mutants is not available, and it is known that energy functions with structural sampling, such as Rosetta's energy function-based $\\Delta\\Delta G$ prediction method Flex ddG, have high prediction accuracy. However, such methods that involve structural sampling require enormous computational costs compared to machine learning-based methods, making them unsuitable for large-scale screening of mutants."}, {"title": "Materials and Methods", "content": "Figure 1 shows an overview of the active learning workflow proposed in this study.\nTrastuzumab, an antibody targeting the HER2 protein, was used as the antibody to be optimized, and the complementarity-determining regions (CDR-H) of the heavy chain were optimized. In this process, mutant data was sampled by randomly mutating the amino acid sequence of Trastuzumab's CDR-H (8 residues for CDR-H1, 8 residues for CDR-H2, and 13 residues for CDR-H3) to 19 amino acid residues excluding cysteine with a mutation probability of 0.2, generating 100,000 mutants (of which 98,567 were unique sequences).\nLuo et al.'s RDE-Network [16] was used as the Flex ddG surrogate model. RDE-Network en- ables AAG prediction performance by learning information on mutants included in the SKEMPI2 dataset [33] based on the predicted probability distribution, using a flow-based rotamer probability distribution model pretrained on crystal structures. RDE-Network is one of the state-of-the-art models"}, {"title": "Results and Discussion", "content": "Figure 2(a) shows the transition of the distribution of the top 200 Flex ddG values of the data selected in previous cycles. For comparison, the results were compared with the case where 1200 data points were randomly selected from the data pool and evaluated by Flex ddG. The figure shows that the proposed method can discover Trastuzumab mutants with significantly lower Flex ddG values compared to random selection in the final cycle. In the early stages of learning, the top predictions of RDE-Network tended to select worse mutants than Random, but by using them for learning in subsequent cycles, the enrichment was improved. Furthermore, in Figure 2(b), the number of selected mutants that bound and unbound based on Flex ddG at each active learning cycle, it can be seen that in the initial learning, many unbound data were sampled due to inaccurate model predictions, but in the latter half of learning, almost no non-binding data were selected. Figure 2(c) shows the transition of the rank of the predicted AAG of the selected mutants. In the early cycles, the selection is close to greedy selection, but in the latter half of learning, mutants with worse ranks are selected, which means that more diverse mutants were selected, i.e., more exploratory sampling was performed, due to the constraint of selecting only those that differed by 2 or more mutations from the previously selected ones. This can also be seen from the difference between greedy selection and actual selection in the embedded space in Figure 3. Thus, balancing exploitation and exploration is important for more efficient learning of active learning models.\nFurthermore, Figures 4(a) to (d) show the Spearman correlation with experimental AAG or Flex ddG's AAG and the ROC-AUC for experimental binding and Flex ddG-based binding at each active learning cycle, respectively. The Spearman correlation was calculated only for the binding mutants in the Trastuzumab mutant dataset, and for the binding ROC-AUC, 50 data points each were selected from the experimental binding data (AAGFlexddG < 0) and randomly selected non-binding data for a total of 100 data points for comparison with Flex ddG calculation. From Figures 4(a) and 4(b), it can be seen that the predictive performance of the active learning model slightly improved from the baseline and reached a level comparable to Flex ddG. However, the correlation with experimental AAG did not change even as the number of active learning cycles increased. Also, Figures 4(c) and 4(d) show a significant improvement in performance compared to the baseline model. Furthermore, in the latter half of active learning, the discriminative performance surpassed that of Flex ddG. This is an interesting result showing that the actual screening performance can be improved without using experimental information, just by adding the computational values of Flex ddG to the learning. From the above, the proposed method seems to be effective in improving the binding classification performance in particular."}, {"title": "Conclusions", "content": "In this study, we developed an active learning workflow for optimizing antibody sequences. The proposed method successfully screened Trastuzumab variants against HER2 efficiently. By utilizing active learning models as proposed in this study, we succeeded in efficiently screening by evaluating only a subset of the vast number of Trastuzumab variants against human HER2 using Flex ddG, without calculating the energy of all sequences. Furthermore, by combining the SKEMPI2 dataset and the computational energy information of variants' Flex ddG, RDE-Network was able to more accu- rately discriminate the binding of human HER2 without learning the experimental $\\Delta\\Delta G$ information. This suggests that it may be useful for exploring variants with higher binding in the early stages of antibody design, where only a few weak binders are obtained, or for optimizing variants with better pharmacological properties. In this study, RDE-Network was used as a surrogate model for active learning, but this framework is applicable to any model and can be useful for easily constructing models tailored to specific targets. However, the active learning method proposed in this study is pri- marily for optimization and requires the preparation of complex structures of known binding ligands. Furthermore, since the sequences evaluated in this study have not been experimentally validated, the effect may be limited if Flex ddG calculations do not correlate well with the experimental AAG, and it should be noted that in actual drug development phases, the developability of the selected variants should also be considered. This study investigated offline-based optimization, but combining it with genetic algorithms, as in other cases, may cover a more diverse mutant space. In the future, by combining active learning with more accurate affinity prediction methods that require even more extensive calculations, such as relative binding free energy perturbation calculations, we aim to construct models with higher binding affinity prediction accuracy for specific targets and improve screening accuracy."}]}