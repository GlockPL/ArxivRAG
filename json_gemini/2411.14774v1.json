{"title": "Resolution-Agnostic Transformer-based Climate Downscaling", "authors": ["Declan J. Curran", "Hira Saleem", "Sanaa Hobeichi", "Flora D. Salim"], "abstract": "Understanding future weather changes at regional and local scales is crucial for planning and decision-making, particularly in the context of extreme weather events, as well as for broader applications in agriculture, insurance, and infrastructure development. However, the computational cost of downscaling Global Climate Models (GCMs) to the fine resolutions needed for such applications presents a significant barrier. Drawing on advancements in weather forecasting models, this study introduces a cost-efficient downscaling method using a pretrained Earth Vision Transformer (Earth ViT) model. Initially trained on ERA5 data to downscale from 50 km to 25 km resolution, the model is then tested on the higher resolution BARRA-SY dataset at a 3 km resolution. Remarkably, it performs well without additional training, demonstrating its ability to generalize across different resolutions. This approach holds promise for generating large ensembles of regional climate simulations by downscaling GCMs with varying input resolutions without incurring additional training costs. Ultimately, this method could provide more comprehensive estimates of potential future changes in key climate variables, aiding in effective planning for extreme weather events and climate change adaptation strategies.", "sections": [{"title": "Introduction", "content": "Global Climate model simulations are usually produced at coarse resolutions due to the significant computational requirements involved in running these models World Climate Research Programme (2014). These models typically operate at resolutions ranging from tens to hundreds of kilometers, which are inadequate for capturing fine-scale atmospheric processes, such as convection, that drive extreme weather events Solman et al. (2021). Additionally, finer resolutions are needed for certain meteorological variables, like soil moisture content and precipitation, to aid in extreme weather events planning and prediction Sun et al. (2019); Rampal et al. (2024).\nRecent advances in machine learning (ML) have demonstrated the ability to model the underlying dynamics of the atmosphere. Models like Pangu, Graphcast, Gencast, and NeuralGCM have successfully captured fine-scale meteorological patterns and shown promising results in various climate-related tasks Bi et al. (2022); Lam et al. (2022); Lai et al. (2023); Dueben et al. (2023).\nGiven that GCMs are available at various resolutions, an ML model that is agnostic to input resolution could enable the downscaling of a large number of GCMs, regardless of their original resolution. Due to its affordability and significantly lower computational cost at the inference stage compared to running an RCM, such an ML model could facilitate the generation of large ensembles, providing a more comprehensive estimate of potential future changes in rainfall and other key climate variables.\nTo explore this potential, a pretrained ML-based downscaling algorithm, the Earth Vision Transformer (Earth ViT), was tested on climate/weather data at much higher resolutions than those on which it was originally trained. Additionally, we introduce an amendment to the loss function to penalise results that violate the law of conservation of mass, ensuring that the value of a coarse grid accurately reflects the cumulative property of the enclosed region within its boundary. This step is important for making the ML model more physically consistent Sun et al. (2024."}, {"title": "Earth Vision-Transformer", "content": "The architecture of the Earth ViT is very similar to the weather forecasting model, Pangu-Weather. The number of pressure levels have been reduced from 13 to 3 and the output head was modified slightly to accommodate a higher resolution necessary for multi-resolution downscaling Bi et al. (2022).\nLoss Function We implemented a custom loss function that ensures the model maintains the conservation of mass property, which is crucial in physical simulations. The loss compares the mass calculated from the low-resolution input images with the mass calculated from the super-resolved output images. Combined with the Mean Squared Error loss, it ensures that the predicted image is as close as possible to the ground truth in terms of pixel values and conserves the same total mass as the input image, enforcing physical consistency.\nMSE Loss = $\\sum_{i=1}^{N}(Y_{true,i} \u2013 Y_{pred,i})^2$\nMass Conservation Loss = $|\\sum_{i=1}^{N} Y_{pred,i} - \\sum_{i=1}^{N} Y_{input,i}|$\nwhere $\\sum_{i=1}^{N} Y_{pred, i}$ is the total mass (sum of pixel values) in the predicted super-resolved image and $\\sum_{i=1}^{N} Y_{input, i}$ is the total mass in the low-resolution input image.\nTotal Loss = MSE Loss + Mass Loss"}, {"title": "Experiments and Results", "content": "We trained Earth ViT and a ResNET on daily ERA5 Hersbach et al. (2020) climate variables for 2x downscaling tasks from 0.5\u00b0to 0.25\u00b0(Approx. 55km to 28km). The Earth-ViT was trained on daily data from 2000/2001 and the ResNET was trained on data from 2000 - 2005. Both models were tested on data from 2006. The ResNETs were only trained on surface data; results are only reported across four surface variables (10-meter u/v wind components, 2-meter temperature, total precipitation).\nThese models were then applied to a similar 2x downscaling task on BARRA-SY data Su et al. (2022) in 2006 from 3km to 1.5km. Note that the model was not finetuned or trained on any data at this fine resolution, but the climate variables remain the same. As a comparison, one version of the Earth-ViT was also trained directly on BARRA-SY.\nThe Earth ViT model was compared against ResNET and Bilinear Interpolation, which are established benchmarks in super-resolution tasks. This comparison highlights Earth ViT's effectiveness in improving downscaling performanceDawa et al. (2022). The performance results for downscaling 2-meter temperature are shown in Table 1 and 2. temperature for the testing year across both the coarse resolution and the fine resolution of the truth and prediction when downscaling ERA5 (BARRA-SY coarsened) from 50km to 25km (from 3km to 1.5km). The results demonstrate a strong overall agreement between the truth and the prediction in terms of both magnitude and spatial consistency.\nResults for downscaling precipitation, u_component_of_wind and v_component_of_wind are given in Appendix C."}, {"title": "Discussion", "content": "A resolution-agnostic model provides significant benefits for downscaling various generations of climate models, such as CMIP5, CMIP6, and the upcoming CMIP7. Using the same model for each ensemble without needing to alter resolutions or undergo additional training streamlines the process and cuts down on computational costs. By generating large ensembles of regional projections, Earth ViT could enable comprehensive climate risk assessments that are both scalable and cost-effective, benefiting sectors such as agriculture, disaster management, and infrastructure planning\nUnlike traditional Regional Climate Models (RCMs), Earth ViT offers a more accessible alternative for producing high-resolution climate projections. The introduction of a mass conservation loss function further improved the model's performance, ensuring adherence to fundamental physical laws. This integration is vital for applying the model to regional climate studies and predicting extreme weather events. Not to mention that each of the models presented here are lightweight with large carbon savings over equivalent dynamical downscaling models.\nFuture research will focus on refining Earth ViT to enhance its robustness across different regions and scenarios. The model's potential to adapt to new regions or datasets through transfer learning presents further opportunities for expanding its applicability."}, {"title": "Experiments", "content": ""}, {"title": "Hyperparameters", "content": ""}, {"title": "Hardware Requirements", "content": "All models were trained for 50 Epochs, with the ResNETS on NVIDIA V100 GPUs with 32GB RAM and Earth-ViTs on NVIDIA A100 80 GB RAM GPUs."}, {"title": "Datasets", "content": ""}, {"title": "ERA5", "content": "We used ERA5 reanalysis data Hersbach et al. (2020), selecting surface variables (10-meter U/V wind components, 2-meter temperature, total precipitation) and pressure-level variables (geopotential, specific humidity, temperature, 10-meter U/V wind components) at three pressure levels (hPa) (50, 100, and 150). These variables were regridded to 0.5 degrees for downscaling."}, {"title": "BARRA-SY", "content": "BARRA-SY is an ultra-high-resolution dataset of the Australian BARRA-R reanalysis dataset Su et al. (2022). At a 1.5 km resolution, it covers the Sydney and coastal New South Wales (NSW) region (28.0\u00b0S to 37.5\u00b0S latitude and 147.0\u00b0E to 154.0\u00b0E longitude). The variables selected were consistent with those used in ERA5. Notably, temperature is recorded at 1.5 meters in BARRA-SY, whereas it is recorded at 2 meters in ERA5. Despite this difference, our results have shown that the model's ability to generalise has not been affected."}, {"title": "Results", "content": ""}]}