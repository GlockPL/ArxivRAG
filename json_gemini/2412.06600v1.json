{"title": "Advancing Music Therapy: Integrating Eastern Five-Element Music Theory and Western\nTechniques with AI in the Novel Five-Element Harmony System", "authors": ["Yubo Zhou", "Weizhen Bian", "Kaitai Zhang", "Xiaohan Gu"], "abstract": "In traditional medical practices, music therapy has proven effective in treating various psychological and physiological ailments. Particularly in Eastern traditions, the Five Elements Music Therapy (FEMT), rooted in traditional Chinese medicine, possesses profound cultural significance and unique therapeutic philosophies. With the rapid advancement of Information Technology and Artificial Intelligence, applying these modern technologies to FEMT could enhance the personalization and cultural relevance of the therapy and potentially improve therapeutic outcomes. In this article, we developed a music therapy system for the first time by applying the theory of the five elements in music therapy to practice. This innovative approach integrates advanced Information Technology and Artificial Intelligence with Five-Element Music Therapy (FEMT) to enhance personalized music therapy practices. As traditional music therapy predominantly follows Western methodologies, the unique aspects of Eastern practices, specifically the Five-Element theory from traditional Chinese medicine, should be considered. This system aims to bridge this gap by utilizing computational technologies to provide a more personalized, culturally relevant, and therapeutically effective music therapy experience.", "sections": [{"title": "1. Introduction", "content": "Recent advancements in technology have impacted medical therapies like music therapy, traditionally used for treating psychological and physiological conditions [13]. However, the dominance of Western art music in therapy may not suit all cultural groups, particularly in the East, where Five-Element music therapy is culturally significant [24]. This therapy has shown effectiveness in treating conditions among Asian populations, complementing Western methods [11, 15, 27].\nChallenges such as limited personalization and scientific frameworks hinder its application. Considering the proven effectiveness of Five-Element music therapy, we developed the Five-Element Harmony System, which automates and digitizes the entire therapeutic process, enhancing scalability and convenience. The system integrates modern technologies like computer vision, music generation, and audio classification to further elevate therapy and bridge Eastern and Western practices [2, 8, 16]. This system takes the theory of the Five Elements of Chinese Medicine music therapy and applies it to practice. Next we will introduce the theory and the system we have developed in more detail."}, {"title": "2. Related Work", "content": ""}, {"title": "2.1. Five-element Music Therapy", "content": "Introduction to Music Therapy and FEMT: Music therapy, formalized post-World War II, uses evidence-based music interventions to address physical, emotional, cognitive, and social needs [7, 1]. Five-Element Music Therapy (FEMT), based on East Asian Traditional Medicine (EATM), integrates the Five Elements theory-Wood, Fire, Earth, Metal, and Water each linked to specific organs and emotions [11, 24]. This holistic approach aligns with traditional Chinese, Korean, and Japanese medical practices, offering a comprehensive method for diagnosis and emotional healing.\nMusical Correspondence: In FEMT, musical tones correspond to the Five Elements, each linked to specific physiological and emotional impacts. These tones help balance emotions and promote healing, embodying East Asian Traditional Medicine's holistic approach. The tones are used to address emotional disturbances and support overall health.\nClinical Applications and Efficacy of FEMT: FEMT has been effective in reducing anxiety, depression, and stress [4], aiding stroke recovery by improving speech and cognitive functions [22], and alleviating cancer-related symptoms like pain and fatigue [21].\nExtensive research supports the efficacy of FEMT. A systematic review found that FEMT significantly reduced symptoms of antenatal depression more effectively than ordinary music therapy [27]. Clinical studies show improvements in perinatal mental health and labor pain management through FEMT, highlighting its role in maternal health [19]. These findings underscore the therapeutic effectiveness of FEMT, making it a valuable non-pharmacological intervention in various clinical scenarios."}, {"title": "Comparative Analysis with Western Music Therapy:", "content": "FEMT offers unique advantages over Western Music Therapy by integrating traditional Chinese medical principles, resonating deeply with patients familiar with East Asian traditions, enhancing therapeutic outcomes [14].\nComparative studies show that FEMT significantly reduces anxiety and depression, outperforming Western Art Music Therapy (WAMT) in certain trials [14]. FEMT's alignment with Chinese medicine makes it more effective for culturally familiar patients [27]. However, adapting these methods for non-traditional patients poses a challenge [9]."}, {"title": "2.2. Challenges and Limitations", "content": "Challenges in Personalization and Accessibility: One of the main challenges of Five-Element Music Therapy (FEMT) is personalization. Selecting music in FEMT relies on practitioners' deep understanding of music and traditional Chinese medicine (TCM) theories, making it accessible only to those with specialized training [25]. Patients often struggle to choose appropriate music due to a lack of understanding of the therapeutic properties of different musical tones, potentially leading to a mismatch between the therapy and their specific needs [9].\nFor example, a patient suffering from excessive anxiety may require a specific set of tones to induce calmness; however, without proper guidance, the patient might choose music that inadvertently exacerbates their symptoms. This misalignment can reduce the overall efficacy of the therapy [9].\nRepertoire and Guidelines: Another significant limitation is the relatively small repertoire available for therapeutic use, which is compounded by the absence of comprehensive guidelines on music selection, frequency, duration, and treatment personalization. This lack of detailed guidance not only restricts therapeutic choices but also increases the risk of aesthetic fatigue, where patients may become desensitized to the music over time, thereby diminishing the therapeutic effectiveness [9]."}, {"title": "2.3. Potential of IT&AI Integration", "content": "Despite existing challenges, a comprehensive AI or IT system has yet to be developed for Five-Element Music Therapy (FEMT) to address these shortcomings comprehensively. Scholars such as [11] have emphasized the need to integrate IT and AI into FEMT, similar to Western music therapy, but practical implementations still need to be improved. To bridge this gap, our research identifies several potential AI technologies to enhance FEMT: Interactive Music Interfaces (IMIs) for dynamic engagement like MoMusic [2], real-time emotion and cognition simulation using Affectiva and CogSimulator [16, 3], personalized music generation with Jukebox [8] and MusicGen [5], and voice synthesis for emotional regulation with FlashSpeech [23].\nWe propose the Five-Element Harmony System to integrate these technologies. This innovative system is designed to enhance the accessibility and efficacy of FEMT by leveraging advanced AI solutions. It encompasses critical components that improve the therapy context's visual, auditory, and diagnostic interactions."}, {"title": "3. Proposed System", "content": ""}, {"title": "3.1. System Overview", "content": "The Five-Element Harmony System as demonstrated in Figure 1 combines advanced artificial intelligence with traditional Five-Element Music Therapy (FEMT) to create a personalized therapeutic experience. The system architecture facilitates seamless interaction between emotion recognition, LLM-driven dialogue systems, adaptive music generation, style transfer, and classification models, ensuring that each therapeutic session optimally aligns with the patient's current psychological and physiological state. This system employs real-time facial emotion recognition using convolutional neural networks to evaluate emotional states of user. Then MusicGen, an auto-regressive Transformer model, for dynamic and real-time music generation tailored to the user's emotional and therapeutic needs. This integration enhances therapy's personalization and efficacy and pioneers a novel approach in the intersection of AI, traditional medicine, and music therapy."}, {"title": "3.2. Five-Element Facial Expression Recognition", "content": "Considering the simplicity and efficiency of CNN networks, we provide a basic reference for diagnosis by capturing the current emotional state through this architecture. A Convolutional Neural Network (CNN) analyzes emotions from facial images, utilizing the haar cascade method for facial region identification before resizing images to 48 \u00d7 48 pixels and converting them to grayscale.\n1. Introduction\nRecent advancements in technology have impacted medical therapies like music therapy, traditionally used for treating psychological and physiological conditions [13]. However, the dominance of Western art music in therapy may not suit all cultural groups, particularly in the East, where Five-Element music therapy is culturally significant [24]. This therapy has shown effectiveness in treating conditions among Asian populations, complementing Western methods [11, 15, 27].\nCNN Architecture: The CNN consists of layers with increasing complexity, featuring filters of sizes 32, 64, and 128, combined with ReLU activation functions:\n$f(x) = max(0, x)$\nThe architecture integrates max-pooling to reduce feature map dimensions and dropout layers to combat overfitting. It concludes with a softmax layer to classify emotions into seven categories:\n$P = \\frac{e^{zk}}{\\sum e^{zj}}$\nMathematical Operations: Convolution operations are crucial for feature extraction:\n$S(i, j) = (K * X)(i, j) = \\sum_{m} \\sum_{n} K(m, n) \\cdot X(i-m, j -n)$"}, {"title": "3.3. Five-Element Chat", "content": "The diagnostic process for Five-Element Music Therapy (FEMT) in AI leverages ChatMed-Consult model [26], an advanced Chinese Medical Large Language Model to enable continuous therapy at home, ensuring a comprehensive understanding of the patient's emotional and physical health.\n1. Initial Facial Emotion Analysis: Using facial recognition technology, the system quickly assesses the patient's emotional state to identify imbalances such as anger, joy, contemplation, sorrow, or fear.\n2. Interactive Dialogue Inquiry: The system engages in structured dialogue to gather detailed information:\n\u2022 Basic health: \"How is your general health? Any recent physical discomfort?\"\n\u2022 Emotional state: \"Describe your recent emotions. Any impactful events?\"\n\u2022 Lifestyle habits: \"How is your sleep quality? Eating habits?\"\n\u2022 Physical activity: \"Do you engage in regular exercise?\"\n3. In-depth Analysis: Based on facial analysis and dialogue responses, the system refines the assessment: \"You mentioned feeling [emotion], does this happen often?\" and \"You mentioned [symptom], when does it worsen?\"\n4. Therapeutic Music Recommendation: The system uses the collected data to select the appropriate Five-Element music. For example, if anger and liver issues are noted, Wood element music may be chosen.\n5. Personalized Music Therapy Recommendations: A personalized music therapy plan is provided, including recommended music types, frequency, and duration of sessions.\n6. Music Generation Prompt Suggestion: Integrating facial recognition and dialogue data, the system generates text-to-music instructions based on the patient's diagnosis to create tailored therapeutic music."}, {"title": "3.4. Five-Element Music Style Transfer", "content": "Our system utilizes an advanced music style transfer method, originally developed by Koo et al. [10]. This method, designed for converting the mixing style of an input multitrack to that of a reference song, employs a pre-trained encoder with a contrastive objective to extract audio effects-related information from a reference music recording.\nApplication to Five Elements Music: In our adaptation, we specifically use Five Elements music tracks as reference tracks for style transfer. This approach leverages the unique characteristics of Wood, Fire, Earth, Metal, and Water, corresponding to different emotional and physical health aspects, to enhance therapeutic impact in music therapy.\nModel Adaptation and Technical Implementation: The encoder, \u03a6, captures essential audio effects and elemental properties:\n$\\Phi(x) = Encoded Effects with Elemental Attributes of x$\nThe mixing style converter, \u03a8, then applies these properties to the input track, aligning it with the user's elemental needs:\n$y = \\Psi(x, \\Phi(ref))$\nThis model is retrained on a dataset specifically labeled for each of the Five Elements, using a self-supervised training method from an already-processed wet multitrack dataset, which alleviates data scarcity challenges.\nPerformance and Personalization: Our implementation enhances the original system by Koo et al. by focusing on music tracks that support the Five Elements theory, allowing users to transform their favorite music into styles that promote personal health and well-being."}, {"title": "3.5. Five-Element Music Generation", "content": "Results within Five-Element Harmony Chat provide patient-specific emotional and physical diagnostics, guiding the music generation process to ensure therapeutic alignment. Moreover, the chat system also generates specific Five Element music generation prompts that directly influence the creation of the music, tailoring the output to meet the individual therapeutic needs of the patients.\nCustomization and Reference Tracks: MusicGen support extensive customization, allowing patients to modify musical elements to suit their therapy needs. We utilize Five Element music as the reference track, ensuring the generated music aligns with both the theoretical framework of Five Elements and the specific emotional or physical requirements of the patient:\n$X_{new} = MusicGen(X_{ref}, desc, 0)$   (1)\nwhere $X_{ref}$ is a reference audio track that exemplifies the desired Five Elements style, and desc is the textual description derived from the Harmony Chat.\nImplementation and Real-time Application: The Music-Gen model features a flexible API that facilitates integration into existing digital health platforms, crucial for adapting the system to various therapeutic settings. Below is the pseudocode outlining the music generation process: This approach allows for real-time adjustments during therapy sessions, continuously aligning the music with the patient's evolving emotional state, enhancing both the efficacy and personalization of treatment."}, {"title": "3.6. Five-Element Music Classification", "content": "Given the demand for integrating Five-Element Music Therapy (FEMT) with technology among both patients and therapists, and recognizing the current challenges in the scientific and uniform standards for Five-Element music classification, as well as the limitations in the existing music repertoire, we have implemented a music classification technology. This system utilizes a deep convolutional neural network (CNN) optimized for audio signal analysis, which helps in enhancing the therapy process by classifying music according to the Five Elements framework.\nSystem Architecture and Function: The CNN architecture employs convolutional and max-pooling layers to efficiently extract both low and high-level acoustic features that are essential for identifying the Five Elements in music:\n$f(x) = ReLU(W * x + b)$\nwhere x is the audio input, W represents the convolutional kernel, and b stands for the bias.\nTraining and Optimization: The training dataset consists of 759 minutes of Five Elements music and 160 minutes of non-Five Elements music, enabling the model to learn distinct musical characteristics associated with each element: Metal, Wood, Water, Fire, Earth, and categorizations outside these elements. The loss function used is categorical cross-entropy:\n$L(y, y) =  \\sum_{c=1}^{M}  y_{o,c} log(y_{o,c})$\nTraining is optimized with the Adam optimizer to improve both efficiency and classification accuracy, facilitating more precise therapeutic music recommendations."}, {"title": "4. Implementation", "content": "In the development of the Five-Element Harmony System, several advanced technological components were integrated to enhance the traditional Five-Element Music Therapy (FEMT). The facial expression recognition utilizes a Convolutional Neural Network (CNN), specifically designed and trained on the FER-2013 dataset to recognize and analyze facial emotions with an accuracy of 76.82% [17]. As described in the implementation, the CNN architecture employs layers with progressively increasing filter sizes of 32, 64, and 128 to effectively capture nuanced facial expressions. The model processes images resized to 48 \u00d7 48 pixels, converted to grayscale to standardize the input data [12]. The music generation component, MusicGen, leverages a dataset of over 20,000 hours of licensed music, including a significant contribution from Shutterstock and Pond5 collections, providing a diverse range of musical styles and genres sampled at 32 kHz for training the auto-regressive Transformer model [5].\nThe system's capability to classify and personalize music therapy sessions is further enhanced by the Music Classification module, which employs a deep convolutional neural network trained on 759 minutes of Five Elements music and 160 minutes of non-Five Elements music, achieving a classification accuracy of 96% [20]. This model effectively categorizes music according to the Five Elements, supporting the system in delivering personalized therapeutic music based on the user's diagnosed emotional and physical needs. The integration of the ChatMed-Consult model [26], fine-tuned on over 500,000 medical consultations and responses from ChatGPT, utilizes the advanced LlaMA-7b model [18] with Chinese-LlaMA-Alpaca LoRA [6] weights for enhanced dialogue interactions. These components collectively ensure that the Five-Element Harmony System adheres to traditional Eastern medicine principles and effectively incorporates modern AI technologies to provide a tailored and responsive music therapy experience."}, {"title": "5. Result", "content": "Since the Five Elements Music Therapy theory has been verified, this study did not conduct additional experimental evaluations, but rather directly applied the theory to system development practices. The Five-Element Harmony System utilizes AI to provide personalized music therapy aligned with the Five-Element theory. It features real-time emotion recognition and dynamic music generation, adapting the musical output to meet the immediate therapeutic needs of patients. This creates a therapeutic soundscape that evolves with the patient's emotional and physical state, enhancing treatment effectiveness.\nThe GitHub code is as follows: https://github.com/everydaylucky/Wu_Xing_Harmony_System.git"}, {"title": "6. Conclusion and Future Work", "content": "The Five-Element Harmony System merges traditional Chinese medicine with cutting-edge AI, significantly improving personalized music therapy. This integration caters to patients' unique cultural and health needs, ensuring relevant and effective treatments. Future efforts will focus on refining the AI's accuracy in emotion recognition and expanding the music generation process to cover a more comprehensive array of cultural and personal music preferences. Additionally, the potential for this technology to be applied in broader therapeutic and wellness contexts will be investigated, aiming to extend its benefits across different areas of holistic health care."}]}