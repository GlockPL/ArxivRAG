{"title": "CRTrack: Low-Light Semi-Supervised Multi-object Tracking Based on Consistency Regularization", "authors": ["Zijing Zhao", "Jianlong Yu", "Lin Zhang", "Shunli Zhang"], "abstract": "Multi-object tracking under low-light environments is prevalent in real life. Recent years have seen rapid development in the field of multi-object track-ing. However, due to the lack of datasets and the high cost of annotations, multi-object tracking under low-light environments remains a persistent chal-lenge. In this paper, we focus on multi-object tracking under low-light con-ditions. To address the issues of limited data and the lack of dataset, we first constructed a low-light multi-object tracking dataset (LLMOT). This dataset comprises data from MOT17 that has been enhanced for nighttime conditions as well as multiple unannotated low-light videos. Subsequently, to tackle the high annotation costs and address the issue of image quality degra-dation, we propose a semi-supervised multi-object tracking method based on consistency regularization named CRTrack. First, we calibrate a consistent adaptive sampling assignment to replace the static IoU-based strategy, en-abling the semi-supervised tracking method to resist noisy pseudo-bounding boxes. Then, we design a adaptive semi-supervised network update method, which effectively leverages unannotated data to enhance model performance.", "sections": [{"title": "1. Introduction", "content": "Multi-object tracking (MOT) is a fundamental mid-level task in computer vision. By analyzing video sequences, MOT aims to localize multiple objects and associate them across frames to produce individual trajectories [1, 2]. It is widely applied in domains such as action recognition [3, 4], video analytics [5], elderly care, and human-computer interaction [6]. Recently, practical MOT use cases have gained attention, further driving MOT development. However, most existing methods are designed for high-quality input data, overlooking common low-light conditions in real-world scenarios."}, {"title": "2. Related Work", "content": "MOT in low-light environments is crucial for numerous applications. However, the dependence on annotated data by supervised methods is imprac-tical, as low-light videos with corresponding annotations are scarce. Due to increased noise in low-light data compared to normal lighting, features be-come significantly harder to extract. As a result, tracking algorithms trained on normal-light scenes perform poorly in low-light environments, suffering from missed detections and false detections, as shown in Fig. 1.\nDue to the physical limitations of existing cameras, the video quality captured in low-light environments is inferior [7, 8]. To avoid motion blur, cameras must shorten exposure times, limiting the amount of light collected. Meanwhile, increasing the image sensor's gain to enhance the signal intro-duces noise, further degrading image quality. Additionally, the low contrast in nighttime environments restricts the dynamic range and causes detail loss. These factors make it difficult for low-light videos to achieve the same level of clarity and detail as daytime recordings.\nLow-light environments present two key challenges for multi-object track-ing (MOT). First, low brightness and high noise in such conditions blur ob-ject boundaries, hindering the collection and annotation of tracking datasets. Second, low-light MOT itself faces numerous technical difficulties. Popular MOT methods are often detection-based, where objects are first detected and then associated across frames [9, 10, 11, 12, 13, 14, 15, 16]. These meth-ods typically require high-quality annotated images as input but perform poorly on low-light images. Furthermore, they rely on supervised learning, making them unsuitable for unlabeled data. Some approaches apply pre-trained tracking algorithms directly to low-light scenarios, but they often fail to deliver satisfactory results. Other methods enhance visual quality by adding low-light restoration modules [17, 7, 8, 18, 19, 20], while incurring additional computational costs and lacking robustness in complex low-light environments.\nIn this context, semi-supervised algorithms combine small amounts of labeled data with large amounts of unlabeled data, alleviating annotation scarcity and improving model generalization in low-light environments. Compared to fully supervised methods, semi-supervised approaches exploit the latent information in unlabeled data, offering a solution for low-light MOT. Although semi-supervised methods are widely applied in many fields [21, 22, 23], their application to low-light MOT is limited. This makes introducing semi-supervised methods into tracking tasks a valuable direction for further exploration."}, {"title": "2.1. Consistency Regularization", "content": "Most object detection methods rely on large-scale and well-annotated datasets to achieve cutting-edge performance [25, 26]. However, the high cost of acquiring labeled data drives the development of semi-supervised learning (SSL) methods, which leverage unlabeled data to significantly improve model performance [27, 28, 29, 30].\nConsistency regularization is among the most widely used techniques in SSL and requires models to produce consistent predictions across augmented versions of the same input [31, 32]. Expanding on this concept, numerous studies optimize model performance through pseudo-label generation and distribution alignment.\nFor example, FixMatch [28] introduces a high-confidence pseudo-labeling strategy, retaining only pseudo-labels with sufficient confidence to improve efficiency. FlexMatch [33] dynamically adjusts thresholds for different classes to accommodate varying learning difficulties. LaplaceNet [34] leverages graph structures to optimize pseudo-label generation, while DC-SSL [35] aligns pre-dicted distributions with true distributions to improve pseudo-label accu-racy. MW-FixMatch [36] addresses class imbalance in SSL by incorporating a weight network to balance contributions from labeled and unlabeled data, which improves performance on imbalanced datasets.\nAlthough these methods enhance model performance on unlabeled data, their effectiveness in specific scenarios, such as low-light environments, re-mains underexplored. Furthermore, pseudo-label quality is constrained by issues like confirmation bias, which may lead models to overfit on incorrect pseudo-labels [37].\nTo address these challenges, this study proposes a semi-supervised learn-ing method, specifically designed for low-light pedestrian tracking, based on consistency regularization. Nighttime data augmentation strategies generate effective perturbations to enhance the model's adaptability to low-light condi-tions. By jointly leveraging labeled and unlabeled data, the proposed method enhances both the robustness and accuracy of object detection and tracking in low-light scenarios. Compared to existing methods, this work introduces a specialized data augmentation strategy tailored for low-light conditions. It also improves pseudo-label generation and utilization within the consistency regularization framework, effectively overcoming the challenges of leveraging unlabeled data in such environments."}, {"title": "2.2. Multi Object Tracking", "content": "Current multi-object tracking algorithms primarily focus on improving the algorithms, paying little attention to data-related issues and diverse ap-plication scenarios. Detection-based tracking (DBT) is one of the most widely studied approaches for pedestrian tracking, detecting objects and perform-ing data association across frames. DBT methods often combine motion and appearance features to improve tracking robustness.\nMotion-based association methods predict object trajectories over time to match detections across frames. For example, the classic SORT[9] algorithm uses Kalman filtering and IoU for target matching. Subsequent methods like BOT-SORT[38] improve robustness to camera motion, while ByteTrack[14] enhances low-confidence target association. Appearance-based association methods use visual features such as color, texture, and shape to match and track objects. However, they are less common due to their sensitivity to light-ing and pose changes. QDTrack[39] employs contrastive learning to improve object association accuracy without relying on motion priors. Combined motion-appearance methods integrate motion and appearance cues, yielding better performance in handling occlusions and complex motion patterns[40]. For example, DeepSORT[10] combines appearance features with motion cues, while FairMOT[12] unifies detection and re-identification tasks to improve both accuracy and real-time efficiency. DetTrack[13] uses spatiotemporal features to mitigate the negative effects of occlusion. GeneralTrack[41] in-troduces a \"point-wise to instance-wise relation\u201d framework, enhancing gen-eralizability across diverse MOT scenarios by improving object association robustness. Additionally, unified cue integration methods[1] enhance perfor-mance in crowded and occlusion-heavy scenarios. These approaches leverage weak cues (e.g., confidence, pseudo-depth, and height) to compensate for failures of strong cues and refine detection associations, improving overall robustness.\nDespite significant algorithmic advancements, DBT methods remain con-strained by the performance of the detector, which is inherently constrained by the quality and scale of annotated datasets. Collecting and annotating pedestrian tracking datasets is particularly challenging due to large defor-mations, frequent occlusions, and numerous small objects. For nighttime pedestrian datasets, noise and blur significantly complicate data collection and reduce data quality.\nTo mitigate the challenges posed by limited annotated data, semi-supervised learning (SSL) methods are extensively studied in recent years. These meth-"}, {"title": "3. Dataset Construction", "content": "In this paper, we present the Low-Light Multi-Object Tracking dataset (LLMOT), which focuses on pedestrian tracking and is specifically designed to address the challenges of tracking in low-light scenarios. We collected 6,264 unannotated frames through web scraping and real-world video recordings and developed a data augmentation method to adapt the MOT17[24] dataset to nighttime conditions, thereby generating a fully annotated dataset for both training and testing purposes.\nBased on the LLMOT dataset, we propose a low-light multi-object track-ing method called CRTrack, which is built upon a consistency regularization approach. Existing methods are constrained by the limited availability of labeled data and face difficulties in effectively utilizing unlabeled data, par-ticularly in low-light environments where relevant datasets are scarce. To address these limitations, we introduce a \"teacher-student\" semi-supervised learning framework that leverages consistency regularization to utilize both labeled and unlabeled data, achieving high-quality object detection and ac-curate tracking. To mitigate the issue of noisy pseudo-bounding boxes gen-erated by the teacher network, we design a consistent adaptive sampling assignment strategy. Furthermore, we propose an adaptive semi-supervised network update mechanism to further enhance the training process, making the framework more robust and effective in handling low-light scenarios.\nIn summary, our main contributions are as follows:\n\u2022 We present the first low-light multi-object tracking dataset specifically for pedestrians, which includes a large number of unannotated night-time pedestrian videos and labeled nighttime data obtained by enhanc-ing the MOT17[24] dataset.\n\u2022 We propose CRTrack, a low-light multi-object tracking method based on a \"teacher-student\u201d network framework, which is capable of lever-aging both labeled and unannotated data for semi-supervised training in low-light scenarios.\n\u2022 We conduct a comprehensive analysis of the proposed dataset and method. Experimental results demonstrate the effectiveness of our method, highlighting its superior performance and competitiveness in tracking tasks under low-light conditions.\nTo advance multi-object tracking in low-light conditions, we developed a low-light pedestrian tracking dataset, LLMOT. The dataset includes a total of 11,580 images, comprising 5,316 labeled images and 6,264 unlabeled images.\nThe labeled data is derived from the MOT17 dataset, which we enhanced to simulate nighttime conditions. The MOT17 dataset contains 14 sequences, with 7 sequences annotated for the pedestrian class. It covers various scenes"}, {"title": "4. Methodology", "content": "In this section, we introduce the overall framework of our low-light semi-supervised multi-object tracking method, CRTrack, which is built on consis-tency regularization. The proposed tracking framework consists of two main components: detection, which identifies objects in frames, and association, which links these objects across frames. First, we train a semi-supervised detector using a teacher-student network structure, which forms the back-bone of the detection process by leveraging both labeled and unlabeled data. The semi-supervised detector includes two key modules: consistent adap-tive sampling assignment and an adaptive update method. These modules are specifically designed to enhance the detector's performance in low-light conditions. Once trained, the detector is used to accurately identify objects in video frames, serving as the foundation for subsequent tracking. Subse-quently, we perform object association to link detected objects across frames, ensuring temporal consistency and robust tracking. The details of these mod-ules and methods will be elaborated in the following sections."}, {"title": "4.1. Semi-Supervised Method", "content": "In detection-based multi-object tracking frameworks, robust detection performance is crucial for ensuring accurate input data for subsequent data association. To address the challenge of limited labeled data and fully uti-lize pretrained models for improved training efficiency, we propose a semi-"}, {"title": "4.2. Consistent Adaptive Sampling Assignment", "content": "In the teacher network, only targets with detection and classification con-fidence exceeding a certain threshold are used as ground truth (GT) for the student network. However, this static label assignment violates a crucial property of semi-supervised learning: pseudo-labels may sometimes contra-dict the network's own predictions. Given an object u in frame x, denoted"}, {"title": "4.3. Adaptive Network Updating", "content": "In detection-based tracking methods, the detector is typically pretrained on a detection dataset and subsequently fine-tuned on a tracking dataset, resulting in a slow update process. In conventional detection and classifi-cation tasks, teacher networks are commonly updated using the exponential moving average (EMA) method during fine-tuning. However, in multi-object tracking, the student network is already fine-tuned. If the teacher network is updated solely using EMA, the update pace may be excessively slow, poten-tially causing the faster-updating student network to outperform the teacher network. As a result, the underperforming teacher network may provide low-quality pseudo-ground truth, reducing the student network's training effectiveness and triggering a feedback loop that degrades overall network performance. To address this issue, we propose an adaptive update method to dynamically update the teacher network."}, {"title": "4.4. Association", "content": "In multi-object tracking (MOT), incorporating appearance features for data association enhances robustness and accuracy, especially when detec-tion performance is suboptimal. Features such as color and texture help reduce ID switches, complement detection information, and improve track-ing continuity and multi-target differentiation, ensuring stable tracking in complex environments.\nIn low-light environments, object features are diminished, boundaries are blurred, and environmental noise is high, resulting in poorer detection per-formance compared to normal lighting conditions. Relying solely on motion cues for data association in such conditions can lead to frequent ID switches. To address this, we propose a method based on OC-SORT[15] that integrates both appearance and motion features for data association."}, {"title": "5. Experiments", "content": "Dataset. Our experiments utilize two datasets: LLMOT, designed for"}, {"title": "5.1. Experiment Setup", "content": "low-light object tracking, and the CrowdHuman[49] dataset, used for joint training. LLMOT comprises MOT17 data enhanced to simulate low-light conditions and additional unannotated low-light data, as shown in Fig. 7 and Fig. 8. CrowdHuman is a large-scale pedestrian detection dataset, containing 15,000 images in the training set, 5,000 images in the test set, and 4,370 images in the validation set. Incorporating CrowdHuman during training allows the model to learn diverse pedestrian features, thereby enhancing its robustness in low-light conditions.\nEvaluation Metrics. We evaluate object detection and tracking per-formance using the following metrics: detection accuracy (DetA)[50], which measures overall detection precision; multiple object tracking accuracy (MOTA)[51], which accounts for false positives, missed detections, and ID errors; higher order tracking accuracy (HOTA) [52], which provides a detailed analysis of detection and trajectory association; identity F1 score (IDF1)[53], which"}, {"title": "5.2. Main Results", "content": "Detection performance. We analyze the performance of detectors in low-light environments under three training settings: a detector trained on normal lighting data (NL), a detector trained on annotated low-light data"}, {"title": "6. Conclusion", "content": "In this work, we propose the first pedestrian tracking dataset specifi-cally designed for low-light environments. The dataset includes annotated data generated through enhancement techniques and unannotated low-light data collected from real-world scenes. This dataset serves as a critical re-source for advancing research in pedestrian tracking under low-light condi-tions, enabling more comprehensive evaluation and development of tracking algorithms in challenging environments.\nWe further investigate the task of multi-object tracking in dark scenes. To address the challenges of limited annotated data and the difficulties of man-ual annotation, we propose a semi-supervised multi-object tracking method. Based on the principle of consistency regularization, we design a teacher-student network framework to enable the model to learn robust features from both labeled and unlabeled data, thereby improving its tracking per-formance in low-light conditions. Additionally, we introduce a consistent adaptive sampling assignment (ASA) module to mitigate noise effects and enhance consistency between the teacher and student networks. Further-more, an adaptive update (ANU) module is developed, allowing the student network to update the teacher network more flexibly.\nOur work addresses the challenges posed by limited annotated data while enhancing tracking capabilities in low-light environments. By leveraging semi-supervised learning, the proposed method improves feature robustness and tracking accuracy, providing a valuable framework for reliable multi-object tracking in challenging low-light conditions."}]}