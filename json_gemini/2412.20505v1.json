{"title": "Planning, Living and Judging: A Multi-agent LLM-based Framework for Cyclical Urban Planning", "authors": ["Hang Ni", "Yuzhi Wang", "Hao Liu"], "abstract": "Urban regeneration presents significant challenges within the context of urbanization, requiring adaptive approaches to tackle evolving needs. Leveraging advancements in large language models (LLMs), we propose Cyclical Urban Planning (CUP), a new paradigm that continuously generates, evaluates, and refines urban plans in a closed-loop. Specifically, our multi-agent LLM-based framework consists of three key components: (1) Planning, where LLM agents generate and refine urban plans based on contextual data; (2) Living, where agents simulate the behaviors and interactions of residents, modeling life in the urban environment; and (3) Judging, which involves evaluating plan effectiveness and providing iterative feedback for improvement. The cyclical process enables a dynamic and responsive planning approach. Experiments on the real-world dataset demonstrate the effectiveness of our framework as a continuous and adaptive planning process.", "sections": [{"title": "Introduction", "content": "With rapid urbanization over the past few decades, many existing urban configurations have become inadequate for current needs, necessitating continuous urban regeneration to create more livable environments (Qian et al. 2023). Traditional urban planning methods include a top-down paradigm dominated by governments and urban planners, as well as a participatory paradigm that emphasizes collaborative decision-making with public citizens (Li et al. 2020). To improve effectiveness, recent research has increasingly focused on leveraging machine learning (ML) techniques (Zheng et al. 2023; Wang et al. 2023; Qian et al. 2023). More recently, the remarkable generalization abilities of large language models (LLMs) have led to the emergence of LLM-empowered multi-agent frameworks as powerful tools for urban planning (Zhou et al. 2024).\nDespite these advancements, existing urban planning methods face significant limitations in adapting to the continuous and dynamic changes characteristic of urban environments. Conventional planning approaches often rely on static, one-time interventions that lack the flexibility to accommodate evolving community needs or respond to unforeseen circumstances. To address this limitation, we propose cyclical urban planning (CUP), a novel paradigm that emphasizes long-term, iterative plan regeneration. CUP aims to establish a closed-loop planning process where urban plans are continually evaluated, refined, and adapted, thereby ensuring responsiveness to changing urban dynamics (Chigbu et al. 2016; Ramezani and Nooraie 2023).\nHowever, a fundamental challenge within CUP is how to effectively evaluate and improve urban plans throughout this iterative process (Oliveira and Pinho 2010; Wang et al. 2023). Quality of life (QOL), encompassing both quantitative and qualitative measures of residents' well-being, is a key metric used to assess the effectiveness of urban plans. However, traditional evaluation methods, such as observational studies and resident surveys, are often labor-intensive and time-consuming (Santos and Martins 2007; Wang et al. 2023), which limits their scalability and restricts the frequency of assessment. While agent-based modeling (ABM) has emerged as a computational alternative to automate parts of the evaluation process (Hosseinali, Alesheikh, and Nourian 2013; Gonz\u00e1lez-M\u00e9ndez et al. 2021), ABM approaches typically rely on rigid, predefined rules or narrowly-focused ML models. This rigidity hinders their capacity to adapt to complex and diverse urban scenarios (Gao et al. 2024).\nIn this paper, we propose an LLM-empowered multi-agent framework for CUP that integrates three iterative phases in a closed-loop: (1) Planning, where LLM agents collaboratively generate and refine urban plans involving both planners and residents; (2) Living, where the LLM-based ABM simulates residents' behaviors and interactions to monitor urban life; and (3) Judging, which automatically evaluates the QOL and generates recommendations for improving the urban plan in the next planning cycle. We validate our approach through a case study on the Huilongguan community in Beijing, demonstrating its effectiveness in enhancing urban planning outcomes."}, {"title": "Related Work", "content": "Urban Planning. Traditional urban planning approaches, including both top-down and participatory methods, have been foundational but face limitations in adaptability and scalability (Taylor 1998; Arnstein 1969; Lane 2005). Recent works have introduced machine learning (ML) to enhance urban planning by automating decision-making processes"}, {"title": "Methodology", "content": "Problem statement. Given an urban region A partitioned into smaller areas {\ud835\udc4e1,\ud835\udc4e2,..., \ud835\udc4e\ud835\udc41\ud835\udc4e} \u2208 A, where \ud835\udc41\ud835\udc4e is the total number of areas, we define an urban plan as a mapping \ud835\udc43 : A \u2192 U. Each area \ud835\udc4e\ud835\udc56 is assigned a land-use type \ud835\udc62\ud835\udc56 = \ud835\udc43(\ud835\udc4e\ud835\udc56) \u2208 U, where U represents the set of land-use types. The objective is to iteratively refine the urban plan \ud835\udc43 by continuously evaluating its impact on urban dynamics and adjusting land-use assignments accordingly.\nFramework overview. Figure 1 illustrates the overall workflow of our cyclical urban planning framework, including Planning, Living, and Judging. The process initiates with Planning module which iteratively refines the urban plan by incorporating feedback and suggestions derived from previous evaluations. This is followed by the Living phase, where the lives of the resident agents are simulated, capturing their mobility and social behaviors under the current plan. Finally, the Judging phase evaluates the plan's impact on urban quality of life (QOL) and provides recommendations for further adjustments. These phases are repeated in a closed loop, ensuring the urban plan is continuously adapted and optimized to respond to changing conditions and evolving resident needs.\nProfiling. Our framework entails three kinds of LLM agents: planner \ud835\udc43, judger \ud835\udc3d and residents \ud835\udc45\ud835\udc56, \ud835\udc56 = 1, 2, ..., \ud835\udc41\ud835\udc5f, which are assigned with specific role-playing profiles. The planner agent is responsible for integrating the discussion results, iterative suggestions for improvements, and his high-level planning expert knowledge together to draft and revise an urban plan. Also, we steer the judger agent to reflect on the quantitative and qualitative analysis results and offer feedback for plan renewal.\nResident agents are essential for our workflow in terms of collaborative decision-making in planning, living simulation, and qualitative surveys during judging, making it pressing to tailor resident profiling techniques. Specifically, we use the LLM to automatically and separately profile the residents, free from expensive manual profiling and exceeding context token limits when the number of residents scales up. For the profiling of each resident, we first sample the basic attributes (e.g., age, gender, etc.) from demographic data to align with real-world population distribution. Then, we utilize prompt chaining to gradually generate the agent's personality, occupation, hobbies, and even lifestyle and pursuits, ensuring the profile's coherence and richness. Besides, the attributes generated for previous residents are avoided when profiling the following residents, to constrain the profile repetition.\nPlanning. The planning phase intends to recurrently generate and refine an urban plan with the aid of the superior capability of LLMs. Inspired by (Zhou et al. 2024), we implement the planning process by incorporating both urban planner and public participation for effectiveness, which caters to the needs of both the planner and resident agents, which is elucidated in Figure 1(a). The workflow of planning at the"}, {"title": "i-th iteration is introduced below:", "content": "\ud835\udc43\ud835\udc58 = \ud835\udc43.plan(\ud835\udc3e, \ud835\udc43\ud835\udc58\u22121, \ud835\udc46\ud835\udc58\u22121), (1)\n\ud835\udc37\ud835\udc58 = discuss({\ud835\udc45\ud835\udc56}\ud835\udc41\ud835\udc5f\ud835\udc56=0, \ud835\udc43\ud835\udc58\u22121), (2)\n\ud835\udc43\ud835\udc58 = \ud835\udc43.plan(\ud835\udc3e, \ud835\udc43\ud835\udc58, \ud835\udc46\ud835\udc58\u22121, \ud835\udc37\ud835\udc58). (3)\nIn particular, the planner agent first modifies the previous plan \ud835\udc43\ud835\udc58\u22121 with expert knowledge \ud835\udc3e and suggestions from the last iteration \ud835\udc46\ud835\udc58\u22121. Then, the resident agents are nudged into a discussion to balance the diverging interests, motivated by their profiles and previous living experiences (if \ud835\udc58 \u2265 2). Finally, the discussion result \ud835\udc37\ud835\udc58 is summarized and leveraged by the planner to polish the plan further. Note that \ud835\udc430 is initiated with some vacant areas to be determined (i.e., except for residential areas) in the first iteration.\nLiving. The living stage embraces LLM-empowered ABM as an alternative to the traditional resource-intensive monitoring paradigm, which includes two principal components: (1) Mobility behavior simulation that emulates the residents' daily living trajectories and feelings in the region (shown in Figure 1(b.1)). (2) Social behavior simulation that imitates the propagation process of residents' experiences and opinions towards the region through social media (depicted in Figure 1(b.2)). The updating formulas of living at time \ud835\udc61 are exhibited as follows (we omit the iteration subscript \ud835\udc58 for clarity):\n\ud835\udc40\ud835\udc56(t), \ud835\udc3f\ud835\udc56(t), \ud835\udc41\ud835\udc56(t) = \ud835\udc45\ud835\udc56.live(\ud835\udc40\ud835\udc56(t \u2212 1), \ud835\udc38(t \u2212 1)), (4)\n\ud835\udc38(t) = sync(\ud835\udc38(t \u2212 1), {\ud835\udc3f\ud835\udc56(t), \ud835\udc41\ud835\udc56(t)}\ud835\udc41\ud835\udc5f\ud835\udc56=0), (5)\nwhere \ud835\udc3f\ud835\udc56 denotes the mobility behavior (i.e., geographic location of \ud835\udc45\ud835\udc56), \ud835\udc41\ud835\udc56 denotes the social behavior (i.e., posts or comments published by \ud835\udc45\ud835\udc56 in the social media). Each resident is equipped with a dynamic memory pool \ud835\udc40(t) to record the agent's living experience. The evolving environment \ud835\udc38(t) = {\ud835\udc38\ud835\udc45(t), \ud835\udc38\ud835\udc46(t)} is the combination of physical region and social media during residents' living, which are synchronously updated.\nIn specific, to serve the simulation above, we refer to (Park et al. 2023) to design the agent architecture during living simulation. For each living step, the resident first perceives the occurrences in the environment and then plans the next behavior (i.e., mobility and social behaviors) for potential execution. The agent is also prodded to reflect on his experience to yield high-level thoughts. The memory pool is curated to store the events, behaviors, and thoughts, as well as facilitate effective planning and reflecting through memory retrieval.\nJudging. The judging procedure resorts to LLM to provide reality-oriented evaluation and offer comments on plan improvements, according to both quantitative and qualitative analysis of the living simulation, as described in Figure 1(c). The workflow of judging is formulated as follows:\n\ud835\udc44\ud835\udc58,1 = automatic(\ud835\udc43\ud835\udc58, \ud835\udc38\ud835\udc58(T), {\ud835\udc45\ud835\udc56}\ud835\udc41\ud835\udc5f\ud835\udc56=0), (6)\n\ud835\udc44\ud835\udc58,2 = interview({\ud835\udc45\ud835\udc56}\ud835\udc41\ud835\udc5f\ud835\udc56=0), (7)\n\ud835\udc45\ud835\udc58 = Avg(\ud835\udc44\ud835\udc58,1, \ud835\udc44\ud835\udc58,2), (8)\n\ud835\udc46\ud835\udc58 = \ud835\udc3d.suggest(\ud835\udc44\ud835\udc58,1,\ud835\udc44\ud835\udc58,2). (9)"}, {"title": "Experiment", "content": "Experimental setup. Following (Zheng et al. 2023; Zhou et al. 2024), we test our framework on Huilongguan community which is 3.74km\u00b2 region located 33km north of Beijing's city center. In the experiments, we use GPT-4o and set the temperature as 0 for stability. We generate 30 resident agents beforehand and implement our framework for 3 iterations. For each iteration, we simulate for one day, where the time granularity of the simulation is one minute.\nTo prove our superiority, we compare the framework to a random planning method, a deep reinforcement learning (DRL)-based method (Zheng et al. 2023), and a multi-agent LLM-based method (Zhou et al. 2024). Note that the MA-LLM method instantiates our framework with only one iteration, evaluated by subsequent living and judging processes.\nThe four evaluation metrics originate from the judging procedure, including Accessibility, Ecology, and Experience.\nResults. The comparison of our framework and two baselines are reported in Table 1. We summarize our observations as follows: First, our framework generally outperforms baselines in Experience metric, and the effectiveness gradually increases with the number of cycles, which arrives at 69.03% after 3 iterations indicating the average living experience score reaches 69.03 among residents. Such results reveal that our framework can effectively balance the residents' requirements and holds the potential to enhance the residents' living experience in a continuous manner relying on iterative plan refinement. Second, from the quantitative perspective, the DRL-based method achieves the best performance in Accessibility since DRL is tailored to optimize for higher macro-accessibility. In addition, we observe the outcome decline of our framework during cycling in Accessibility and Ecology metrics, which possibly stem from the conflicts between quantitative and qualitative factors. Therefore we speculate that the boost of subjective human well-being ought to undertake the sacrifice of the valid spatial layout of land uses."}, {"title": "Case study", "content": "To assess whether our resident agents generate reliable behaviors and feedback and contribute to plan renovations, we study the participation of R19 during the cycling of our framework (Figure 2). Briefly, the elderly gardener looks forward to more open spaces close to home. He shares his wishes on social media and gets support from R16. During the subsequent interview and discussion, he insists on such desires, and finally a12 is approved to be altered into an open space."}, {"title": "Conclusion and Future Work", "content": "In this paper, we propose a LLM-based framework for CUP by iterating planning, living, and judging. The experiments in Huilongguan, Beijing showcase our framework's superiority in cyclically encouraging the residents' well-being. Further, a case study is presented to probe the believable behaviors and iterative feedback of resident agents. Future efforts will be devoted to enhancing the fidelity and scalability of planning and living and enriching the evaluation aspects of judging. Moreover, we will apply our system in larger urban regions and more planning tasks (i.e., road, infrastructure, etc.) with more resident agents, assessed by more comprehensive QOL evaluation metrics."}]}