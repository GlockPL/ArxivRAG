{"title": "Enhancing Graph Attention Neural Network\nPerformance for Marijuana Consumption\nClassification through Large-scale Augmented Granger\nCausality (IsAGC) Analysis of Functional MR Images", "authors": ["Ali Vosoughia", "Akhil Kasturia", "Axel Wismu\u00a8llera,b,c,d"], "abstract": "In the present research, the effectiveness of large-scale Augmented Granger Causality (IsAGC) as a tool\nfor gauging brain network connectivity was examined to differentiate between marijuana users and\ntypical controls by utilizing resting-state functional Magnetic Resonance Imaging (fMRI). The\nrelationship between marijuana consumption and alterations in brain network connectivity is a\nrecognized fact in scientific literature. This study probes how IsAGC can accurately discern these\nchanges. The technique used integrates dimension reduction with the augmentation of source time-\nseries in a model that predicts time-series, which helps in estimating the directed causal relationships\namong fMRI time-series. As a multivariate approach, IsAGC uncovers the connection of the inherent\ndynamic system while considering all other time-series. A dataset of 60 adults with an ADHD diagnosis\nduring childhood, drawn from the Addiction Connectome Preprocessed Initiative (ACPI), was used in\nthe study. The brain connections assessed by lsAGC were utilized as classification attributes. A Graph\nAttention Neural Network (GAT) was chosen to carry out the classification task, particularly for its", "sections": [{"title": "1 INTRODUCTION", "content": "Marijuana's longstanding status as an illegal drug, coupled with the apprehensions regarding its\nnegative influence on brain processes and cognitive abilities, has spurred the quest for precise\nbiomarkers to evaluate its ramifications. Studies involving resting-state functional MRI (rs-fMRI) have\nunveiled that consistent marijuana consumption may modify the brain's connectivity [1,2]. Techniques\nknown as Multi-Voxel Pattern Analysis (MVPA) have been utilized to derive biomarkers from rs-fMRI\ndata, which helps in distinguishing the connectivity patterns between individuals with neurological\ncomplications and healthy subjects [1,3].\nMost MVPA studies have historically leveraged cross-correlation to assemble a functional\nconnectivity profile, offering optimistic results in terms of information differentiation extracted from\nfMRI data. However, this method does not encompass directed connectivity, and thus, vital information"}, {"title": "2 DATA", "content": "The ACPI dataset's resting-state fMRI scan parameters can be found on the project's website [85]. We\nutilized preprocessed data from the MTA 1 dataset [85] of the ACPI database. The dataset initially\nincluded 126 subjects, consisting of 101 males and 25 females, with ages between 21-27 years. Of\nthese, 86 were diagnosed with ADHD (68%), and 62 of them regularly used marijuana (49%).\nPreprocessing of the raw 4D rs-fMRI data was performed using a Configurable"}, {"title": "3 METHODS", "content": null}, {"title": "3.1 Large-scale Augmented Granger Causality (IsAGC)", "content": "Large-scale Augmented Granger Causality (lsAGC) has been developed based on 1) the principle of\noriginal Granger causality, which quantifies the causal influence of time-series xs on time-series xt by\nquantifying the amount of improvement in the prediction of xt in presence of xs. 2) the idea of\ndimension reduction, which resolves the problem of the tackling a under-determined system, which is\nfrequently faced in fMRI analysis, since the number of acquired temporal samples usually is not\nsufficient for estimating the model parameters [88].\nConsider the ensemble of time-series $X \\in \\mathbb{R}^{N\\times T}$, where N is the number of time-series (Regions Of\nInterest ROIs) and T the number of temporal samples. Let $X = (X_1,X_2,...,X_N)$ be the whole\nmultidimensional system and $x_i \\in \\mathbb{R}^{1xT}$ a single time-series with $i = 1,2,...,N$, where $X_i = (X_{i(1)},x_{i(2)},...,x_{i(T)})$. In order to overcome the under-determined problem, first X will be decomposed"}, {"title": "3.2 Graph Attention Network (GAT)", "content": "Graph Attention Networks (GATs) have emerged as a vital advancement in graph-based deep learning\n[5], marking a significant departure from conventional Graph Convolutional Networks (GCNs) [89].\nWhere traditional GCNs treat all neighboring nodes equally, GATs utilize attention mechanisms to\nassign different importance levels to different nodes, enabling the capture of more complex patterns\nin data. This attribute is crucial in recognizing and modeling intricate relationships in graph-\nstructured data, an aspect that conventional models often fall short of."}, {"title": "3.2.1 Adjacency Matrix", "content": "Given a directed graph $G = (V,E)$ with N nodes, the adjacency matrix $F \\in \\mathbb{R}^{N\\times N}$ is defined such that $F_{ij} = 1$\nif there is an edge between nodes i and j, and $F_{ij} = 0$ otherwise. Our method, IsAGC, employs the measure\n$f_{x_s-x_t}$ to determine whether node i (representing xs) has a causal influence on node j (representing\nXt)."}, {"title": "3.2.2 Attention Mechanism", "content": "Graph Convolutional Networks (GCNs) inherently treat all neighbors equally, often leading to\nlimitations in expressiveness. This poses challenges in the application of GCNs to directional graphs,\nwhich are prevalent in our method, the lsAGC. In contrast, Graph Attention Networks (GATs) employ\nan attention mechanism that emphasizes the more relevant parts of the graph, facilitating a nuanced\nunderstanding of the data's underlying structure.\nThe attention mechanism in GATs is implemented by calculating attention scores between nodes\nthrough a series of learnable parameters and non-linear transformations. The attention scores\nbetween nodes i and j are computed as follows:\n$e_{ij} = LeakyReLU (a^T [Wh_i || Wh_j]),$ (5)\n$a_{ij} = softmax_j (e_{ij}) =  \\frac{exp(e_{ij})}{\\sum_{k\\in \\mathcal{N}(i)} exp(e_{ik})}.$ (6)"}, {"title": "3.2.3 Multi-Head Attention and Aggregation", "content": "The Graph Attention Networks (GATs) often utilize a multi-head attention mechanism, which applies\nmultiple sets of learnable parameters to capture diverse facets of relationships between nodes. This\nmethod enhances stability in learning and enriches the model's expressiveness by integrating\ninformation across various attention heads. In our approach, we averaged the outputs from different\nheads instead of concatenating them, as given by:\n$h_i = Aggregate(a_{ij}\\cdot Wh_j),\\forall j \\in \\mathcal{N}(i)$ (7)\nThe proposed model leverages the adjacency matrix to guide attention, focusing on pertinent\nrelationships while considering connected nodes' features."}, {"title": "3.2.4 Loss Function", "content": "In our approach, we utilize the Binary Cross-Entropy Loss with Logits (LBCE) as our chosen loss\nfunction. This loss function is applied to the outputs of a linear layer, which represents the predicted\nclass logits, and the encoded feature representations. The modified loss function is formulated as\nfollows:\n$L_{loss} = L_{BCE}(y,\\hat{y}) + L_{BCE}(y_{enc},\\hat{y})$ (8)"}, {"title": "3.3 Data Augmentation", "content": "Data augmentation is essential for enhancing the diversity of training datasets, mitigating overfitting,\nand improving generalization in deep learning models. In our study, we exploited specific parameters\nof the IsAGC method, namely the retained components of PCA and the autoregressive model number,\nto generate diverse adjacency matrices for each dataset. This augmentation strategy was integrated\ninto the training process, markedly increasing the training sample size. We employed a data\naugmentation factor of 27, expanding an initial dataset of 60 subjects to a total of 1620 samples. This\nexpansion was instrumental in constructing a robust dataset, a critical factor for the effective training\nof the Graph Attention Network (GAT) model in our research."}, {"title": "4 RESULTS", "content": "Mean connectivity matrices that were extracted using lsAGC and cross-correlation, are shown in Fig. 2\nfor both typical control and frequent marijuana user cohorts. Different patterns are visible to the\nnaked eye for both methods. In the following, we quantitatively investigate the difference between\nconnectivity patterns of the two subject cohorts using an MVPA approach."}, {"title": "5 CONCLUSIONS", "content": "To sum up, the use of large-scale Augmented Granger Causality (IsAGC) as a possible marker to\ndifferentiate marijuana users from regular controls is explored in our research by employing\nrestingstate functional Magnetic Resonance Imaging (fMRI). Changes in brain network connectivity\nconnected to marijuana consumption are built upon prior studies, reassessed by probing the ability of\nIsAGC to effectively distinguish these modifications. The description of directed causal connections\nwithin the complex fluctuations of fMRI time-series information is facilitated by lsAGC through a\nmultivariate technique focusing on dimensionality reduction, augmenting data, and time-series\npredictive modeling. Brain connections are identified using the IsAGC process and used as vital\nelements for our categorization efforts in a dataset that includes 60 adult subjects who were diagnosed\nwith childhood ADHD from the Addiction Connectome Preprocessed Initiative (ACPI) repository. A"}]}