{"title": "Predicting and Publishing Accurate Imbalance Prices Using Monte Carlo Tree Search", "authors": ["Fabio Pavirani", "Jonas Van Gompel", "Seyed Soroush Karimi Madahi", "Bert Claessens", "Chris Develder"], "abstract": "The growing reliance on renewable energy sources, particularly solar and wind, has introduced challenges due to their uncontrollable production. This complicates maintaining the electrical grid balance, prompting some transmission system operators in Western Europe to implement imbalance tariffs that penalize unsustainable power deviations. These tariffs create an implicit demand response framework to mitigate grid instability. Yet, several challenges limit active participation. In Belgium, for example, imbalance prices are only calculated at the end of each 15-minute settlement period, creating high risk due to price uncertainty. This risk is further amplified by the inherent volatility of imbalance prices, discouraging participation. Although transmission system operators provide minute-based price predictions, the system imbalance volatility makes accurate price predictions challenging to obtain and requires sophisticated techniques. Moreover, publishing price estimates can prompt participants to adjust their schedules, potentially affecting the system balance and the final price, adding further complexity. To address these challenges, we propose a Monte Carlo Tree Search method that publishes accurate imbalance prices while accounting for potential response actions. Our approach models the system dynamics using a neural network forecaster and a cluster of virtual batteries controlled by reinforcement learning agents. Compared to Belgium's current publication method, our technique improves price accuracy by 20.4% under ideal conditions and by 12.8% in more realistic scenarios. This research addresses an unexplored, yet crucial problem, positioning this paper as a pioneering work in analyzing the potential of more advanced imbalance price publishing techniques.", "sections": [{"title": "1. Introduction", "content": "In light of recent developments in climate change research, decarbonization of energy sources is a necessary step to reduce global CO2 emissions [1]. For this reason, an increasing amount of Renewable Energy Sources (RES) is being installed [1-3]. Although RES such as photovoltaic panels and wind farms have low carbon emissions, their energy supply is hard to accurately predict due to weather dependencies. This complicates the task of balancing power production and consumption, with direct consequences for the grid's operational safety. Hence, the electrical grid is being gradually redesigned to handle local and uncertain variations of electrical production [4]. For instance, some Transmission System Operators (TSOs) in Europe offer re-muneration to Balancing Service Providers (BSPs) in exchange for contracted energy transactions that help balance the grid. Moreover, a specific imbalance tariff is applied to Balance Responsible Parties (BRPs), penalizing deviations in their energy schedules that disrupt the balance of the grid. By strategically designing the imbalance fee structure, TSOs can create an implicit Demand Response (DR) framework for the BRPs, which will then react to the prices and help to reduce the grid's System Imbalance (SI) magnitude.\nIn Belgium, the imbalance prices are calculated at the end of each settlement period, spanning 15 minutes. This implies that BRPs face significant risk, as each transaction is subject to a price that remains unknown at the time of execution. This obstructs active participation from BRPs in the imbalance mechanism, as the prices might end up being less attractive than the expected ones, or even unprofitable for BRPs in case a significant swing of the SI occurs within the quarter hour. To tackle this, the Belgian TSO publishes an estimation of the imbalance price within each quarter hour on a minute basis, reducing the risks involved in the imbalance settlement participation. However, the imbalance prices are dependent on the grid's SI, making these values highly volatile. Hence, obtaining an accurate approximation of the imbalance prices is challenging. Moreover, publishing real-time prices might trigger an implicit reaction from BRPs, altering the SI and thereby impacting the price determined at the closure of the settlement period. By implicit response, we mean a voluntary, though undeclared, deviation of BRPs energy schedules aimed at taking advantage of the imbalance prices. This recursive cycle (illustrated in Fig. 1) adds complexity to the problem, highlighting a significant potential for the application of advanced planning techniques in the price publication problem.\nTo address the challenge of publishing accurate real-time imbalance prices, two main approaches can be chosen: a model-based, and a model-free one. A model-based approach uses a model of the system's dynamics to obtain each"}, {"title": "2. Related Work", "content": "Over the last decades, an increasing number of studies have focused on energy DR, which implies adapting the energy demand to make it better match the available supply, in contrast to conventional techniques that only shape the energy production. This usually happens by sending a signal that reflects the supply status (e.g., a price signal) to the demand assets [10]. The demand components are thus prompted to react to the signal, shaping their consumption. The implementation of DR programs significantly helps decarbonization of the energy transition [11], hence highlighting the relevance of the topic.\nThe majority of previous studies focused on how the demand side can react to such signals to optimize revenues. In this context, RL techniques have demonstrated considerable promise [12]. For example, [13] developed a Deep-RL solution to reduce the cost of an HVAC unit subjected to dynamic prices. RL has also been deployed in problems requiring multiple assets or structures to work parallelly. For example, the authors of [14, 15] implemented a Multi-Agent"}, {"title": "3. Problem Description", "content": "TSOs are responsible for the correct functioning of the electrical grid. For this reason, with the increasing amount of RES affecting the grid's stability, TSOs have become more dependent on ancillary services that are designed to restore and maintain the grid's frequency balance. In Western Europe, three distinct services are active, each requiring different reaction times to frequency deviations and system imbalances. In order of decreasing reaction speed, these services are respectively: Frequency Containment Reserve (FCR/R1), automatic Frequency Restoration Reserve (aFRR/R2), and manual Frequency Restoration Reserve (mFRR/R3). We are particularly interested in the secondary (aFRR) and tertiary (mFRR) reserves, as their activations directly influence the imbalance price determination in each settlement period (see Section 3.2 for details).\nParticipation in aFRR is provided through two different regulations: incremental and decremental. The activation of these two regulations depends on the sign of the system imbalance (SI). A positive SI (surplus of power) activates the decremental regulation, asking the BSPs to withdraw power from the grid (i.e., consume more or produce less); and a negative SI (lack of power) activates the incremental regulation, asking the BSPs to inject power into the grid (i.e., consume less or produce more). For each activation period (15 minutes), each regulation receives a list of bids from the BSPs. Each bid contains a price [\u20ac/MWh] and a volume [MW]. The bids get sorted by the TSO based on their economic value, i.e., the TSO identifies which bids would minimize their cost and sorts them accordingly.\nThe sorted bids for each regulation create a bid ladder that, depending on the SI of the activation period, will determine the imbalance price. mFRR uses an activation mechanism akin to that of aFRR, the main difference being that mFRR requires a less strict reaction time and activation happens only after the aFRR capacity has been fully addressed. An example of a bid ladder is given in Fig. 2. Given the bid ladders of aFRR and mFRR, and given the current SI (and, consequently, the activated balancing volume), the marginal incremental price $a^{incr}_t$ in a certain"}, {"title": "3.2. Imbalance tariff mechanism and pricing system", "content": "As previously stated in Section 1, some European TSOs designed a specific tariff addressed to BRPs that deviates their energy management from their previously declared values. This tariff, also called imbalance settlement mechanism, is not standardized in Europe, i.e., each TSO is free to decide how to design the pricing formula. However, an electricity balancing guideline (EBGL) has been published by the European Network of Transmission System Operators for Electricity (ENTSO-E). According to the EBGL: \"The general objective of imbalance settlement is to ensure that Balance Responsible Parties support the system balance in an efficient way, and to incentivize market participants in keeping and/or helping to restore the system balance [...]\\u201d [28]. The pricing formulas are then designed to promote grid stability through mechanisms aligned with open-market principles. Moreover, the settlement 'transactions' can be done in a real-time framework (as observable in Fig. 3), hence creating a desirable tool for BRPs that wish to constantly update and correct their energy positions.\nIn Belgium, the imbalance prices are determined based on the marginal balancing activated prices, and the periodicity of imbalance settlement in Belgium is 15 minutes. We use $t \\in \\mathbb{N}$ as a timestep index, each spanning 1 minute. We refer to $t_0 \\in \\mathbb{N}$ as the timestep index corresponding to the start of the quarter hour t belongs to, and $t_q \\in \\mathbb{N}$ as the timestep index corresponding to the end of the quarter hour t belongs to. In other words, given a (minute-based) timestep t, then $t_0 = t - (t \\mod 15) \\leq t$ and $t_q = t + 14 \\geq t$.\nThe price formula used in Belgium is then:\n$\\lambda_t = \\begin{cases}  a^{incr}_t + a^{imb} \\text{ } \\text{if: SI}_t > 0 \\\\ a^{decr}_t + a^{imb} \\text{ } \\text{if: SI}_t < 0  \\end{cases}$"}, {"content": "As previously stated in Section 1, some European TSOs designed a specific tariff addressed to BRPs that deviates their energy management from their previously declared values. This tariff, also called imbalance settlement mechanism, is not standardized in Europe, i.e., each TSO is free to decide how to design the pricing formula. However, an electricity balancing guideline (EBGL) has been published by the European Network of Transmission System Operators for Electricity (ENTSO-E). According to the EBGL: \"The general objective of imbalance settlement is to ensure that Balance Responsible Parties support the system balance in an efficient way, and to incentivize market participants in keeping and/or helping to restore the system balance [...]\\u201d [28]. The pricing formulas are then designed to promote grid stability through mechanisms aligned with open-market principles. Moreover, the settlement 'transactions' can be done in a real-time framework (as observable in Fig. 3), hence creating a desirable tool for BRPs that wish to constantly update and correct their energy positions.\nIn Belgium, the imbalance prices are determined based on the marginal balancing activated prices, and the periodicity of imbalance settlement in Belgium is 15 minutes. We use $t \\in \\mathbb{N}$ as a timestep index, each spanning 1 minute. We refer to $t_0 \\in \\mathbb{N}$ as the timestep index corresponding to the start of the quarter hour t belongs to, and $t_q \\in \\mathbb{N}$ as the timestep index corresponding to the end of the quarter hour t belongs to. In other words, given a (minute-based) timestep t, then $t_0 = t - (t \\mod 15) \\leq t$ and $t_q = t + 14 \\geq t$.\nThe price formula used in Belgium is then:\n$\\lambda_t = \\begin{cases} a^{incr}_t + a^{imb} \\text{ } \\text{if: SI}_t > 0 \\\\ a^{decr}_t + a^{imb} \\text{ } \\text{if: SI}_t < 0 \\end{cases}$"}, {"title": "4. Methodology", "content": "To predict the NRV for future timesteps, we use a specific neural network architecture called constant variable selection networks (C-VSN), similar to what was proposed in [8]. The forecaster was originally built to predict the SI. However, by modeling the NRV as the SI's inverse (NRV ~ -SI), we can easily adapt the model to our needs. The model consists of an ensemble of 21 neural networks, each differing from the others by using various training seeds, bootstrapping techniques, output formats, and loss weights. As explained in the original work [8], the model is trained by adding a variable weight to the training loss function, specifically aimed to increase the accuracy performance during SI spikes. This feature, together with the overall accuracy performance obtained, makes the model appropriate for the needs of our price publication problem. The main differences from the model described in [8] are:\n\u2022 The model outputs the predicted minute-based NRVs for the next 15 minutes, instead of the quarter hour averaged SI up to 45 minutes ahead of time.\n\u2022 To obtain higher independence of the model predictions from the implicit responses to published imbalance prices, we removed the input features that are mostly correlated to that (e.g., the imbalance prices input values).\nAmong the input features used [8], we used\n\u2022 Time features,\n\u2022 SI and NRV history,\n\u2022 Net cross-border nominations,\n\u2022 PV and Wind generation forecasts, and\n\u2022 Load forecasts\nUsing this forecaster allows us to simulate the future behavior of the NRV and helps predict which imbalance price will be applied at the end of the quarter hour. An example of the forecaster outputs is shown in Fig. 7. More details about integrating the NRV forecaster into our algorithm structure can be found in Section 4.3."}, {"title": "4.2. Implicit Imbalance Response", "content": "While publishing the approximations of the Imbalance price of the current quarter hour, the TSO might trigger an implicit reaction from BRPs that wish to exploit the price. This reaction will influence the SI of the grid. Hence, in cases where the implicit reaction magnitude is significant, the publication of a price might change the final price itself. Given the recent increment in the magnitude of the BRPs' flexibility assets, we can expect such phenomena to effectively occur in the price publication problem. Therefore, it's important to independently model the implicit reaction to better capture the NRV dynamics of the system."}, {"title": "4.2.1. Model structure and motivations", "content": "We model the implicit reaction as a cluster of virtual batteries leveraging the prices. Each battery is controlled by an independent policy-based RL agent (trained offline using historical data) whose objective is to maximize the profit of the battery by participating in the imbalance settlement. The motivations for this choice can be summarized as:\n\u2022 Batteries are increasingly being deployed by BRPs at grid scale.\n\u2022 Many flexible assets can be modeled as an energy buffer, which conceptually works as a battery [29, 30]."}, {"title": "4.2.2. Reinforcement Learning framework", "content": "The general structure formulation of a problem that RL tries to solve is a Markov Decision Process (MDP) [31]. An MDP is composed by the tuple (S, A, f(s, a, s'), p(s, a, s')), where S is the State Space, A is the Action Space, $f (s, a, s') : S \\times A \\times S \\rightarrow [0, 1]$ is the Transition Function, and $p: S \\times A \\times S \\rightarrow \\mathbb{R}$ is the Reward Function. Given an MDP, we can formulate an optimization problem, that is to find a sequence of actions that maximize the obtained rewards. Formally, given a policy $\\pi : S \\rightarrow A$, we can consider the definition of its Q-function [31]:\n$Q^{\\pi}(s, a) = \\mathbb{E}_{s' \\sim f(s,a,:)} [p(s, a, s') + \\gamma \\mathbb{R}^{\\pi}(s')],$ where $\\gamma \\in [0, 1]$ is the discount factor, and\n$\\mathbb{R}^{\\pi}(s_0) = \\lim_{T\\rightarrow+\\infty} \\mathbb{E}_{s_{t+1} \\sim f(s_t,\\pi(s_t),:)} [\\sum_{t=0}^{T} \\gamma^t p(s_t, \\pi(s_t), s_{t+1})].$ In other words, the Q-function $Q^{\\pi}(s, a)$ estimates the value of acting a from state s, and then following the policy $\\pi$"}, {"title": "4.3. MDP definition", "content": "To publish accurate imbalance prices using MCTS, we define the problem as an MDP. Differently from the MDP defined for the imbalance implicit response, we now define the sequential decision problem of publishing approximated imbalance prices from the TSO point of view. The MCTS techniques require the MDP to be simulable, i.e., the dynamic function of the MDP must be executable by a machine. In the case of a real-world scenario, this property is not satisfied, as it is impossible for the TSO to perfectly model and predict the NRV dynamics of the electrical grid. For this reason, we distinguish between two different MDPs:\n\u2022 The real MDP:\n$(s, a, f(s,a, s'), p(s, a, s')) \\in S \\times A \\times [0, 1] \\times \\mathbb{R},$ that describes the actual dynamics of the system, and\n\u2022 The simulated MDP:\n$(s, a, \\hat{f}(s,a), p(s, a, s')) \\in S \\times A \\times S \\times \\mathbb{R},$ that is composed of simulable models and imitates the actual dynamics of the system.\nThe only difference between the two formulations lies in the transition function, where f(s, a, s') describes the (stochastic) dynamics of the real system and hence is not mathematically formulable; and $\\hat{f}(s, a)$ is a (deterministic) mathematical approximation of the latter and is then executable by a machine. By solving the optimization problem of the simulated MDP we are then able to obtain an approximated solution of the original problem, with a transfer performance gap depending on the accuracy of the simulated model compared to the actual dynamics of the system.\nThe state of the MDP s, describes the current condition of the grid and contains temporal information, the averaged NRV of the current quarter hour, and the bid ladder for the current quarter hour.\nThe action describes the price published by the TSO at the respective timestep (i.e., at each minute). Formally: $a_t = \\lambda_t \\in A \\subset \\mathbb{R}$. In our solution, we used an MCTS algorithm"}, {"title": "5. Experiment Setup", "content": "To train our system dynamics model, we used historical data of the Belgian grid. The SI forecaster described in Section 4.1 is trained using data from 2020 to 2022. The implicit response model (i.e., comprising the batteries' controllers) is trained and validated using data from 2022. To simulate the implicit response of BRPs, we used a cluster of four batteries, each with a different capacity ratio. Moreover, to prove the method efficacy with varying magnitudes of response, we considered different battery sizes: a small one with a total capacity (sum of every battery capacity) of 60 MW-150 MWh, a medium one with a total capacity of 125 MW-310MWh, and a big one with a total capacity of 250 MW-620MWh. Please note that, although the battery sizes were chosen based on plausible capacities, their exact specifications are not particularly relevant to our experiments. Our research aims to demonstrate that our method produces valuable results, even when confronted with varying response magnitudes. Hence, we limited our experiments to select three significantly different magnitudes of response. We specifically chose power capacities to encompass various multiples of the average absolute NRV observed in historical data. A more detailed study on the matter, although beyond the scope of this paper, should be conducted in the future. Moreover, to extend the experiments towards more significant (and currently unrealistic) response magnitudes, we also considered different cases with a single-battery response of 500 MW \\u2013 1,000 MWh, up to 2,000 MW \\u2013 4,000 MWh (Section 6.2).\nThe experiments are evaluated for 10 days that we sampled from the period January 2023 to June 2023. More specifically, to select the days used for evaluation, we used the k-means clustering algorithm to partition the full dataset into 10 groups based on the average imbalance price, the average NRV, the standard deviation of the NRV, and the standard deviation of the (historically) published prices. Every evaluation day is then sampled from different clusters, ensuring sufficient diversity in the evaluation set. The NRV and price distributions of the sampled days can be observed in Fig. 9. The sampled days are considered using the Coordinated Universal Time (UTC) timezone.\nTo keep the running time of our experiments acceptable, we limited the tree search to a maximum of 200 simulations. After different trials, we identify such a hyperparameter to be a compromise between computational cost (with a running time of about 10s for MCTS to determine the eventual action, i.e., price publication, for each timestep) and algorithmic performance. However, in realistic situations, the TSO could further increase the number of simulations"}, {"title": "5.2. Experiments Formulation", "content": "To perform our analyses, we ran four different groups of experiments, each with different objectives:\nE1: To demonstrate the potential of our approach as a proof-of-concept, we assess its performance under ideal conditions, i.e., considering perfect knowledge of both the NRV fluctuations and the implicit imbalance response model. In these experiments, we only optimize the price accuracy (using Eq. (5)) and we benchmark the results over the current publication method while considering different reasonable battery sizes (Section 6.1).\nE2: Next, we study the price publication performance in case of higher response magnitudes, by considering more extreme cases up to a 2GW/4GWh battery response capacity (Section 6.2).\nE3: Subsequently, we study the ability of our technique to optimize multiple objectives (i.e., increasing the price accuracy, decreasing the SI magnitude, and decreasing the balancing costs) (Section 6.3). To this end, we extend the experiments performed in E1 with different reward functions (Eqs. (6) and (8)), using a medium-sized battery as response model.\nE4: Finally, we analyze the performance of our technique in more realistic settings, thus gauging its practical applicability for TSOs in the real world. Instead of assuming perfect knowledge of the NRV fluctuations, we implemented a forecaster as described in Section 4.1. Moreover, we added artificial noise to the implicit response model; evaluating the technique using different magnitudes of model inaccuracies (Section 6.4)."}, {"title": "6. Results", "content": "We first show the results for the experiments described in E1, using ideal conditions (perfect NRV forecast and response knowledge). Specifically, we consider four different experiments, each using different magnitude sizes of the response battery. We then compared the price publication accuracy of our technique with the one obtained using the considered baseline. The results are shown in Table 1.\nWe observe a substantial improvement in the published price accuracy of the MCTS-based method, up to +20.4%. This result is not surprising, as perfect knowledge of the model enables the tree search to accurately identify the best actions in relation to the market responses and the expected NRV fluctuations. In contrast, the baseline obtains the published prices by only looking at the current NRV, thus only using incomplete information. In addition to prediction quality, we also tracked the averaged NRV and Balancing costs (as described in Section 4.3). We observe that the MCTS-based technique does not negatively affect these values, which remain almost invariant compared to the ones obtained using the Baseline. A more detailed analysis of MCTS's ability to reduce the NRV and the balancing costs is provided in Section 6.3, while Appendix D reports on additional metrics of interest. We now show a more in-depth analysis of the prediction technique. Figure 10 shows different quantiles for the absolute error of the published prices in every minute of the quarter hour, to analyze how prediction accuracy varies within a quarter hour. These results assume a medium response magnitude.\nFigure 10 shows that the MCTS error quantiles are, overall, lower than the Baseline ones for all minutes of the quarter hour. This is in line with the results shown in Table 1. The first few minutes of each quarter hour exhibit the most noticeable improvements, which aligns with how the NRV is used for predictions. The NRV in the imbalance formula is based on minute-level measurements averaged over the current quarter hour. This means that early NRV values have a significant impact on the cumulative average, as they are averaged over fewer data points. In contrast, as the quarter hour progresses, additional NRV measurements have less effect on the cumulative average. Since the baseline method relies solely on this cumulative average, its predictions are less accurate at the start of the quarter hour, when the average is still highly sensitive to new measurements. The MCTS-based method, however, improves accuracy by considering both the current average NRV and future NRV projections, which tend to be more stable and reliable if the predictions are accurate. As a result, this technique performs notably better than the baseline, especially in the early minutes of the quarter hour when the available information still lacks robustness and reliability."}, {"title": "6.2. Publication Performance When Dealing With High Response Magnitudes", "content": "To analyze the plausible consequences of a significantly higher response capacity in the grid, we extended the experiments of Section 6.1 by increasing the power capacity of the responses up to 2 GW. Figure 13 shows the resulting publication accuracy and average absolute NRV for both the baseline and the MCTS-based techniques. Once again, the reward function considered is Eq. (5). We note that the NRV magnitude measured in the grid increases when it surpasses a certain threshold (around 250 MW). This is somehow expected, as a high response power would provide an excessive injection (or an excessive withdrawal) to the grid. For example, assuming a positive NRV at a certain moment, the resulting imbalance price would then be high. Following Eq. (1), a relatively high price would be published, causing the BRPs to sell energy to the grid as a reaction. However, in case of an excessive response, the NRV would change sign and still contribute to grid instability. A similar reasoning can be applied to the price accuracy, as such excessive reactions would cause the NRV sign to be unstable. As a consequence, the baseline technique would have high oscillations in their publications, with a consequential increment in the publication errors. On the other hand, the proposed MCTS-based technique would be able to predict such behaviors and thus try to avoid these instabilities with more strategic publications. This is observable from the graph in Fig. 13, where publication errors are significantly lower when using the MCTS-based technique, compared to the baseline. MCTS also attains a slightly lower average NRV, although not significantly. That might be due to the fact that the NRV is not being directly optimized, since it is not represented in the reward function. Hence, the next section investigates the effects of using different reward functions."}, {"title": "6.3. Reward Functions for Multi-objective Optimization", "content": "We now analyze more advanced reward functions (namely Eqs. (6) and (8)), which aim to jointly optimize multiple objectives.\nWe first focus on adding NRV reduction to the price prediction objective, i.e., using Eq. (6). Figure 14 plots the published prices MAE and the absolute average NRV when varying the b\u2081 parameter (higher values of \u1e9e\u2081 increase the relevance of the NRV reduction factor in the reward function). From the graph we observe that, as expected, the technique is able to reduce the NRV magnitude when higher values of \u1e9e\u2081 are used, sacrificing accuracy in the price publications. While this is what we expected the algorithm to achieve and therefore enables TSOs to design their objectives more broadly, the NRV reduction obtained is not necessarily cost-effective. Indeed, the relative NRV reduction (~2.8% for \u03b2\u2081 = 2) is rather low compared to the relative loss of accuracy in price prediction (~ 14.0% for \u03b2\u2081 = 2). This was also to be expected, as the ability of the flexible BRP assets to reduce the NRV magnitude is, when averaged daily, relatively limited. This limitation is mostly due to the cycle constraint enforced on the responsive batteries, which limits the times per day they can participate in NRV reduction. To quantify these limits (or, in other words, to assess the average NRV reduction the considered response model can achieve at most), we consider the case where no response is involved (i.e., the published prices do not affect the NRV in any way). The averaged NRV obtained in this case corresponds to the midpoint of the interval that defines the range of NRV reduction (or increase) achievable by the given battery capacities.\nOur analysis of aiming for joint minimization of balancing costs and price prediction errors, i.e., using Eq. (8), leads to similar conclusions.\nAs for the NRV+price case, the relative reduction of the newly added metric, in this case balancing cost, is relatively low compared to the rise in price prediction error."}, {"title": "6.4. Results in More Realistic Conditions", "content": "Finally, we show the results of our proposed technique when dealing with more realistic conditions. First, we analyze the effect of imperfect NRV forecasting, by using the NRV forecaster of Section 4.1. Figure 16 shows the results of this analysis for a medium size of the response batteries. Note that we still assume perfect knowledge of the response model. We observe that, when we no longer assume perfect knowledge of the system dynamics, the MCTS-based technique still attains significant improvements in the published price accuracy, reducing the price MAE of 12.8% compared to the baseline. We further note that the minute-based quantiles of the prediction mostly decrease linearly as the quarter hour gets close to its end. However, different from the results obtained with perfect knowledge, we do not observe a significant reduction in price MAE in the earlier minutes of the quarter. This might be related to the higher uncertainties of the NRV forecasts: even though the tree can look forward in the quarter hour, its assumed future is inaccurate, as the forecasted NRV differs from the actual one.\nBesides NRV forecasts, also the (implicit) BRP responses will be uncertain in practice. Thus, next we analyze the effect of errors in predicting such responses in the simulations used in the MCTS approach. Specifically, we multiply the actual response (from the assumed battery systems) by an inaccuracy factor Yresp \u2208 R. Hence, Yresp = 1 corresponds to the scenario with perfect knowledge of the implicit response, Yresp > 1 implies overestimating the expected response, and Yresp < 1 represents underestimation of the response. Note that if Yresp < 0, the sign of the implicit response gets wrongly predicted, implying that the expected response behavior is significantly different from the real one. Using a medium-sized battery response and including the NRV forecaster (Section 4.1) in our simulations, we varied the value of Yresp. The reward function considered in these experiments is once again described by Eq. (5). Figure 17 presents the resulting analysis. The price accuracy seems to remain decently invariant when Yresp > 0, meaning that the technique can obtain good results even when predicted responses are over-estimated (yresp > 1) or under-estimated (0 \u2264 Yresp < 1). On the other hand, when the implicit response sign is wrongly predicted (e.g., when an implicit response is expected to inject energy into the grid, but a withdrawal occurs instead), the price MAE increases substantially. We can then conclude that to obtain accurate price publications, it is not crucial to have accurate predictions of the absolute value of the implicit responses, but rather focus on predicting the correct sign. A similar conclusion can be drawn in terms of assessing the NRV magnitude, where we again observe a substantial increment when Yresp < 0. To conclude, after testing our technique with more realistic conditions, the MCTS algorithm still achieves remarkable results."}, {"title": "7. Final Discussion", "content": "In this research work, we presented a pioneering analysis of an MCTS-based real-time imbalance price publication tool from a TSO perspective. The technique uses state-of-the-art machine-learning forecasters to predict the future states of the grid, considering also the published prices and the consequential implicit responses of BRPs to increase the price accuracy. We benchmarked the technique with the publication method currently used in practice by the Belgian TSO, obtaining a 20.4% reduction of the MAE on predicted imbalance prices when considering ideal conditions (perfect knowledge of the grid dynamics). Moreover, we evaluated the technique in a more realistic setup (using the NRV forecaster and adding inaccuracies in the response model), still achieving remarkable reduction of prediction errors, achieving -12.8% lower MAE. Last, we also analyzed the technique's ability to add secondary objectives beyond only price prediction accuracy. Specifically, we added an NRV reduction term and a balancing cost reduction term. Our analysis indicates that TSOs can leverage the published prices to reduce the aforementioned values. However, as expected, this reduces the price prediction errors. Our results suggest that TSOs should carefully assess the overall cost-effectiveness, since this loss of accuracy could outweigh the (relatively limited) gains in terms of NRV or balancing cost reduction.\nTo the best of our knowledge, this is the first time a real-time publication technique for imbalance prices is proposed in the literature. Yet, we acknowledge that the presented work is to be seen as a promising proof-of-concept rather than a fully elaborated practical solution. Still, in light of the growing integration of renewable energy sources into electricity grids and the resulting significance of demand response frameworks, the topic of our work is highly relevant to the ongoing electrification of modern societies."}, {"title": "7.2. Strengths and Limitations", "content": "When using MCTS-based techniques like the one presented in this work, a series of advantages and drawbacks have to be taken into consideration. First, tree search techniques are model-based, meaning that meaningful insight can be infused into the publication method. Moreover, such techniques only require the model to be simulable. This allows non-linear forecasters such as neural networks (NNs) also in complex architectures such as the ones considered in this work to be included in the model. This is especially important when the system dynamics are particularly difficult to model with simpler tools, such as the case of the system imbalance (SI) dynamics of an electrical grid. However, the obvious drawback of this characteristic is that a decently accurate model is required for the deployment of the technique. This increases the complexity of the task, as extra effort is required to create an accurate model.\nAnother benefit of the technique is shown by the results obtained, as remarkable price accuracy has been achieved despite the technique being in its simpler form (i.e., better results can be expected when the tree-search technique is expanded to more complex mechanics). Despite the results obtained, a lack of explainability is a relevant limitation. Indeed, even though a certain grade of interpretability can be achieved through the tree structure, in case a series of price publications are particularly inaccurate (for example due to inaccuracies of the NRV forecaster), justifying these situations could be difficult. Regarding computational costs, we note that the computational complexity is limited: all results presented were obtained using a modern laptop, on which a single forecast (to be generated every minute in practice) could be generated in ~10 seconds. When scaling the technique in real applications, a more advanced computational setup can increase the number of simulations involved in the tree search. Moreover, the technique inherently supports parallelization, which could significantly speed up the tree search process. We can expect, by applying such refinements, to obtain even better results."}, {"title": "7.3. Future Directions", "content": "We conclude by suggesting different research directions that can be undertaken following our work. As previously mentioned, several improvements are required to refine the proposed technique and make it mature for real-world applications. We now present those we consider most relevant.\nTo start, more advanced MCTS algorithms should be applied and analyzed. Especially the addition of NNs in the tree-search process has been shown to be remarkably effective [5, 6", "39": "could be used as a starting"}]}