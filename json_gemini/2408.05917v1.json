{"title": "Inverse design of Non-parameterized Ventilated Acoustic Resonator via Variational Autoencoder with Acoustic Response-encoded Latent Space", "authors": ["Min Woo Cho", "Seok Hyeon Hwang", "Jun Young Jang", "Jin Yeong Song", "Sunkwang Hwang", "Kyoung Je Cha", "Dong Yong Park", "Kyungjun Song", "Sang Min Park"], "abstract": "Ventilated acoustic resonator(VAR), a type of acoustic metamaterial, emerge as an alternative for sound attenuation in environments that require ventilation, owing to its excellent low-frequency attenuation performance and flexible shape adaptability. However, due to the non-linear acoustic responses of VARs, the VAR designs are generally obtained within a limited parametrized design space, and the design relies on the iteration of the numerical simulation which consumes a considerable amount of computational time and resources. This paper proposes an acoustic response-encoded variational autoencoder (AR-VAE), a novel variational autoencoder-based generative design model for the efficient and accurate inverse design of VAR even with non-parametrized designs. The AR-VAE matches the high-dimensional acoustic response with the VAR cross-section image in the dimension-reduced latent space, which enables the AR-VAE to generate various non-parametrized VAR cross-section images with the target acoustic response. AR-VAE generates non-parameterized VARs from target acoustic responses, which show a 25-fold reduction in mean squared error compared to conventional deep learning-based parameter searching methods while exhibiting lower average mean squared error and peak frequency variance. By combining the inverse-designed VARs by AR-VAE, multi-cavity VAR was devised for broadband and multitarget peak frequency attenuation. The proposed design method presents a new approach for structural inverse-design with a high-dimensional non-linear physical response.", "sections": [{"title": "1. Introduction", "content": "Achieving effective sound insulation in environments that require ventilation has been a longstanding challenge in the field of acoustics. To attain a high level of soundproofing, it is generally essential to physically block any gaps and openings that could allow sound waves to pass through and transmit acoustic energy. However, when ventilation is required, traditional soundproofing methods can lead to the deterioration of the ventilation system. This trade-off between sound insulation and ventilation has been observed in various sound-blocking apparatuses, such as vehicle mufflers [1-3], acoustic vents [4-6], and acoustic windows [7-10]. To address this challenge, acoustic metamaterials (AMs) have been proposed as a solution. AMs consist of sub-wavelength elements arranged in a repeating pattern. Such structures are designed to have extraordinary acoustic properties, such as zero/extreme/negative density [11-13] or negative bulk modulus [14-16], which enable them to control sound waves in ways that were previously considered impossible. Moreover, by utilizing these properties, they can be employed in open spaces to facilitate airflow, allowing the simultaneous control of mass transportation and acoustic energy. Among these designs, the ventilated acoustic resonator (VAR) has gained considerable attention owing to its simple design and adaptability to various shapes [17-22]. A VAR consists of two parts: a waveguide and a Helmholtz resonator. Because the waveguide allows fluid to flow and the Helmholtz resonator blocks noise, both mass transportation and acoustic energy can be controlled. In addition, the geometric parameters of each part can be easily adjusted for ventilation and soundproofing performance, offering a high degree of flexibility in configuring the system to meet specific engineering needs.\nConsidering the wide applications of VAR for sound attenuation, it is necessary to develop an inverse-design technology for VAR structures that reflect the acoustic characteristics of the target application. Inverse design, which searches for the optimal design with characteristics"}, {"title": "", "content": "that meet the target performance, has been widely studied in the fields of photonics [23], aerodynamics [24], and acoustics [25], in which the relationships between the structure and dynamics are complex. In general, a VAR with a simple geometric shape that could be grasped by human intuition has been inverse-designed by analytical methods such as the transfer matrix method [26, 27]. However, as the geometrical complexity increases to achieve superior acoustic performance, the inverse design of VAR structures with the target acoustic response by human intuition or analytical methods would become increasingly challenging. Thus, inverse-design methods based on the iteration of numerical simulations such as genetic algorithms [28, 29], space-filling [30], direct binary search [31], and topology optimization [32] are widely used. However, these methods consume a significant amount of computational resources and time. Moreover, the optimal VAR structure that matches the target acoustic response could be omitted when the degree of freedom in the design space is high.\nDeep learning, a field of machine learning that utilizes an artificial neural network that mimics the human nervous system, has garnered growing interest as a means of addressing intricate problems that are challenging to resolve through conventional methods, such as computer vision [33, 34], natural language processing [35], active control [36-38], and speech recognition [39]. In the field of structural design such as electromagnetic metamaterials [40-42], mechanical metamaterials [43, 44], composites [45], and microwave absorbers [46], numerous studies have been conducted on the inverse design of non-intuitive structures utilizing the characteristics of deep learning models. Furthermore, the design of acoustic structures, such as phononic crystals [47], low-frequency acoustic absorbers [48], acoustic sinks [25], acoustic scatterers [49], and acoustic metasurfaces [50-52] has also been subject to the deep learning model. However, previous studies majorly relied on deep learning-based parameter searching methods, which limited the degree of freedom of design space and corresponding acoustic response. Thus, it is required to develop a deep learning model for the"}, {"title": "", "content": "inverse design of VAR with a higher degree of freedom in the design space while reflecting the target acoustic response.\nIn this study, we propose an acoustic response-encoded variational autoencoder (AR-VAE) for the accurate and inverse design of non-parameterized VAR, which is based on a deep generative model. A deep generative model, which belongs to the category of deep learning models, is designed to generate data with a similar distribution to the training dataset. Representative deep generative models include a generative adversarial network (GAN) [53] which utilizes the competing relationship between a discriminator network and generator network, and a variational autoencoder (VAE) [54] which uses a probabilistic approach. Unlike GAN, which more focuses on generating similar images to the training dataset, VAE learns the distribution of the training dataset explicitly. Furthermore, the dimension-reduced latent space of VAE could encode the geometrical features and acoustic response of the VAR, which is required for the accurate and precise inverse design. Therefore, in this study, we adopted VAE as a base model which is more suitable for understanding the distribution and features of VAR's geometric shape. We modified the VAE into the AR-VAE to encode a high-dimensional target acoustic response and generate non-parametrized VAR cross-section images with an acoustic response similar to the target acoustic response with high accuracy. To compare the inverse-design performance of AR-VAE with the inverse-design performance of the deep learning-based parameter searching method[25, 47, 48, 55-57] we trained an acoustic response-parameter matching neural network (APNN), a deep learning model that can search the geometric parameters of the VAR corresponds to the input acoustic response as a control group. We could confirm that the inverse-designed VAR by AR-VAE exhibits a 25-fold reduction in mean squared error with a target acoustic response compared to the inverse-designed VAR by APNN. As another validation, we parametrized the non-parametrized inverse-designed VAR and found that the non-parametrized inverse-designed VAR exhibits a lower average mean"}, {"title": "", "content": "squared error with the target acoustic response and peak frequency variance compared to the parametrized inverse-designed VAR. Given that VAR is often required to attenuate hybrid noise with multi-peak frequency for practical application, we designed a multi-cavity VAR capable of broadband sound attenuation with multi-target peak frequency by combining the non-parametrized inverse-designed VARs."}, {"title": "2. Structural Design and Simulation of VAR", "content": null}, {"title": "2.1 Acoustic Structure", "content": "Figure 1 shows the structures of the proposed axisymmetric VAR that attenuates the sound passing through it. The peak frequency of sound attenuation can be tuned by manipulating the geometric shape of the VAR's cavity. Figure la shows the schematic of a parameterized VAR which is defined by geometric parameters. The training dataset for the inverse design model proposed in this study consists of these parameterized VAR. As a result of our proposed inverse design model, a non-parameterized VAR is created as shown in Figure 1b. Non-parameterized VAR has a similar shape to parameterized VAR but has a non-typical structure that can not be defined with geometric parameters. Figures 1c and d show the acoustic domain of the unit VAR and the cross-section image with the unit VAR's geometric parameters, respectively. The geometric parameters of the VAR were bound to keep the typical T-shape cross-section image represented in Figure 1. The length of the air-fluid channel was fixed at l\u0109 = 20 mm. The range of other design parameters is listed in Table 1. R, lb, Rn, la, Rc represents the radius of the air-fluid channel, neck width of cavity's cross-section, height of cavity neck's cross-section, the width of the cavity, the total radius of VAR's acoustic domain respectively. Broadband sound attenuation with multi-peak frequency can be achieved by serially combining multiple unit VARs with different peak frequencies as shown in Figure le."}, {"title": "2.2 Numerical Simulation for Acoustic Response", "content": "We conducted finite element simulation using the frequency domain study in COMSOL Multiphysics 6.0 to obtain the acoustic response of the proposed VAR. The acoustic pressure field p of the proposed VAR follows the Helmholtz equation below [58].\n$\\nabla^{2} p-\\frac{1}{c^{2}} \\frac{\\partial^{2} p}{\\partial t^{2}}=0$ (1)\nwhere $\\nabla^{2}=\\frac{\\partial^{2}}{\\partial r^{2}}+\\frac{1}{r} \\frac{\\partial}{\\partial r}+\\frac{1}{r^{2}} \\frac{\\partial^{2}}{\\partial \\theta^{2}}+\\frac{\\partial^{2}}{\\partial z^{2}}$ is Laplacian operator in cylindrical coordinates, c(=343 m/s) is the speed of sound in air, and $\\frac{\\partial^{2}}{\\partial t^{2}}$ is the second derivative with respect to time t. This equation is computed with 2D-axisymmetric as shown in Figure 2. The boundary of the VAR is assumed to be a sound-hard wall in consideration of the large impedance mismatch between"}, {"title": "", "content": "the structure and air. Non-reflecting boundary conditions are applied to both ends of the waveguide. The plane wave, denoted as $p_{1}=P_{i} e^{j(\\omega t-k z)}$ with the pressure amplitude Pi (=1 Pa), a wavenumber k, and an angular frequency w is applied to the inlet domain for the input wave. For simplicity, the loss of the VAR model is not considered. The attenuation performance of the VAR was evaluated based on the acoustic power of the inlet and outlet by numerically solving the governing equation. The sound transmission loss (STL) was used as an index to evaluate the soundproofing performance of the VAR expressed as\n$S T L=10 \\log \\frac{W_{i n}}{W_{o u t}}[d B]$ (2)\nwhere $W_{i n}=(\\frac{\\mid P_{i} e_{i n l e t} \\mid^{2}}{2 \\rho c})$ and $W_{o u t}=(\\frac{\\mid P_{o} e_{o u l t e t} \\mid^{2}}{2 \\rho c})$ represent the acoustic powers at the inlet and outlet, respectively, obtained using the governing equations, and p is the density of air. 50 STL data points of each VAR were obtained by conducting simulations at 1-1961Hz and 40 Hz intervals. (see Supporting Information 1 for more detailed information about analytical solutions and validation of numerical simulation)"}, {"title": "3. Deep Generative Model for VAR Inverse-design", "content": "Many acoustic structures exhibit the same acoustic response; hence, the forward prediction of the acoustic response of the VAR should be considered a many-to-one mapping problem. However, the inverse-design problem is considered a one-to-many mapping problem because various geometric shapes could be designed for a given acoustic response. [59] To solve the one(acoustic response)-to-many(VAR structure) mapping problem of designing a VAR structure with the target acoustic response, we propose an inverse-design framework using a deep generative model as shown in Figure 3."}, {"title": "3.1 Data Acquisition", "content": "We generated the dataset of the VAR cross-section images and the corresponding acoustic response data to train the AR-VAE. Since the proposed VAR has an axisymmetric shape, the"}, {"title": "", "content": "cross-section image of the VAR structure was used as the input data for the deep generative model. The dataset of VAR cross-section images was randomly sampled within the design parameter range listed in Table 1. The cross-section images were expressed as 128 \u00d7 64 grayscale binary images, where 1 represents the acoustic domain inside the VAR and 0 represents the hard wall of the VAR. The corresponding acoustic response data, obtained by the numerical simulation, were converted into a 50 \u00d7 1 vector and used for training. A total of 53,350 data were generated with different design parameters and split into a training dataset (70% of the total data, 37,345) and a test dataset (30% of the total data, 16,005)."}, {"title": "3.2 Acoustic Response Encoded VAE (AR-VAE)", "content": "The VAE is a deep generative model that consists of a bottleneck-shaped neural network with an encoder and a decoder. The VAE forms a latent space z, a dimension-reduced space, which encodes the probability distribution of the input data x to generate data similar to the input data x. When the VAE is sufficiently trained, the decoder can generate data similar to the input data x by inputting a variable sampled from the latent space z. To implement the data-generating feature of the VAE, training proceeds through the loss function below [54].\n$\\mathcal{L}(\\varPhi, \\theta ; x)=-\\mathbb{E}_{q_{\\varPhi}(z \\mid x)}[\\log {p_{\\theta}(x \\mid z)}]+D_{K L}\\left(q_{\\varPhi}(z \\mid x) \\| p_{\\theta}(z)\\right)$ (3)\nwhere \u00d8 and 0 represents the parameters of the encoder and decoder respectively. The loss function consists of a reconstruction term (the first term of the equation) and a regularization term (the second term of the equation). The reconstruction term indicates how well the input data x was reconstructed using the latent space z sampled by the encoder(approximate posterior) q\u00f8(z|x). The regularization term indicates the degree of similarity between the prior distribution pe (z) and approximate posterior q\u00f8(z|x). The regularization term prevents the VAE from simply performing a reconstruction task on the input data, by regularizing \u00d8 so that"}, {"title": "", "content": "the approximate posterior q\u00f8(z|x) can be close to the prior distribution pe (z). (see Supporting Information 2 for more detailed information on the VAE loss function)\nGiven that conventional VAEs do not contain acoustic response information, they can only generate VAR cross-section images of various shapes without any consideration of the acoustic response. To overcome the absence of acoustic response information, we introduced the novel VAE-based inverse-design model, AR-VAE. We added the acoustic response encoding model, which encodes the acoustic response to deterministic dimension-reduced latent space. Rather than simply matching the VAR cross-section image and acoustic response, it is more effective to extract and match important features between the VAR cross-section image and acoustic response through dimension reduction. [60, 61] In addition, to solve the one-to-many mapping problem mentioned above, it is necessary to match the probabilistic latent space that can generate various results with the acoustic response. Therefore, we trained AR-VAE to be able to match VAR's geometric information-encoded probabilistic latent space and VAR's acoustic response-encoded deterministic latent space. Consequently, the decoder was able to generate various VAR cross-section images with target acoustic response and also solved the one-to-many mapping problem.\nFigure 4 shows the overall architecture of the AR-VAE, consisting of three deep neural network-based submodels- the feature extraction model, the response encoding model, and the generation model (see Supporting Information 3 for the detailed AR-VAE network architecture)."}, {"title": "", "content": "Feature extraction model: The feature extraction model extracted the geometric features of the VAR cross-section image and encoded the features into a dimension-reduced latent space. A residual network, called ResNet, was introduced in the deep neural network of AR-VAE to prevent gradient vanishing or exploding problems during extracting features with relatively complex cross-sectional shapes [62]. The feature extraction network had a total of 24 output nodes, 16 of which were used to construct the probabilistic latent space zp, which encodes the geometric feature information of the VAR cross-section image. The remaining 8 nodes were used to construct the deterministic latent space za, which was used to match the information between the geometric features and acoustic response.\nResponse encoding model: The response encoding model encodes the acoustic response data of the VAR into the dimension-reduced latent space zr. The 50 \u00d7 1 acoustic response data obtained through the numerical simulation were used as the input. By extracting the features of the corresponding acoustic responses using a 1D convolution layer, an 8-dimensional deterministic latent space z was constructed."}, {"title": "", "content": "Generation model: The generation model uses both variables of the latent space zp and zy as inputs and aims to reconstruct a VAR cross-section image based on an input of a VAR cross-section image and a corresponding acoustic response. Reconstruction from a low-dimensional latent space to a high-dimensional image was performed based on the interpolation process of a transposed convolution layer.\nThe loss function of the conventional VAE was intended to reconstruct the VAR cross-section image without considering the acoustic response, and thus, the conventional VAE would be difficult to match the acoustic response and geometric feature of VAR. To resolve this issue, we devised a latent loss that is defined as the mean squared error (MSE) between the latent space za constructed using the feature extraction model and the latent space zr constructed using the response encoding model and added the latent loss to the loss function of AR-VAE. Finally, the loss function of AR-VAE can be presented as follows.\n$\\mathcal{L}(\\varPhi, \\theta, \\tau ; x, y)=-\\mathbb{E}_{q_{\\varPhi}(z \\mid x)}[\\log {p_{\\theta}(x \\mid z_{p}, z_{r})}]+D_{K L}\\left(q_{\\varPhi}(z \\mid x) \\| p_{\\theta}(z)\\right)+\\left\\|f_{\\tau}(y)-z_{d}\\right\\|^{2}$ (4)\nwhere z is the concatenation of zp and zd; zr is a deterministic latent space variable encoded by the response encoding model f\u2081; x and y denote the VAR cross-section image data and acoustic response data, respectively. The response encoding model parameter \u03c4, feature extraction model parameter\u00d8, and generation model parameter \u03b8 were jointly learned by the backpropagation algorithm. By minimizing the above loss function, the AR-VAE could generate the VAR cross-section images reflecting the given acoustic response."}, {"title": "3.3 Training Process", "content": "The training process of AR-VAE proceeded by using an Intel\u00ae Core\u2122 i5-8500 CPU @ 3.00 GHz and NVIDIA GeForce RTX3060 GPU. We set the batch size to 32, used Adam optimizer with a learning rate of 1e-5, and proceeded with training up to 12000 epochs. The training"}, {"title": "", "content": "results are shown as the learning curves in Figure 5. The total loss is the sum of the reconstruction loss, the regularization loss, and the latent loss."}, {"title": "4. Results and Discussion", "content": null}, {"title": "4.1 Validation of AR-VAE", "content": "A validation process was conducted to assess the ability of the trained generation model to inverse-design a VAR cross-section image with an acoustic response similar to the input target acoustic response."}, {"title": "4.1.1 Inverse-designed VAR by AR-VAE", "content": "The generation model of the AR-VAE created VAR cross-section images by inputting variables of 8 \u00d7 1 probabilistic latent space zp and 8 \u00d7 1 deterministic latent space zr. To confirm the creation of various VAR cross-section images, we input variables of probabilistic latent space zp randomly sampled from a uniform distribution between -1 and 1 to the generation model with the target acoustic response. By inputting 100 randomly sampled zp for each given target acoustic response, 100 VAR candidates with acoustic responses similar to the target acoustic response were generated. Because the images generated by the AR-VAE are blurry, the generated image was converted to a binary image by thresholding. The acoustic response of the generated VAR candidates was evaluated based on the numerical simulation. Among 100 generated VAR candidates, the VAR with the smallest mean squared error (MSE) between the corresponding and target acoustic response was selected as an inverse-design result. We found that 100 sampling of VAR candidates could achieve a sufficiently smaller mean squared error between the corresponding and target acoustic response compared to that of training datasets. Figure 6 shows the schematic of the VAR inverse-design process using the AR-VAE. We confirmed that the corresponding acoustic response of generated VAR candidates was positioned close to the target acoustic response. (see Supporting Information 4 for more detailed information on the non-parameterized VAR inverse-design process by AR-VAE)"}, {"title": "4.1.2 Validation of AR-VAE's inverse design performance", "content": "To verify the performance of AR-VAE, the target acoustic responses with peak frequencies of 601, 801, 1001, 1201, 1401, and 1601 Hz were selected from the test dataset. We inverse-designed VAR cross-section images corresponding to the selected target acoustic response by applying the inverse design method described above. We trained an acoustic response-parameter matching neural network (APNN ), which consisted of a simple deep neural network for inverse designing VAR by deterministically matching the VAR's geometric parameters and"}, {"title": "", "content": "acoustic response as a control group. Because most of the previous research on AMs inverse design was based on deep learning-based parameter searching like APNN, it is considered appropriate to use APNN as a control group for AR-VAE performance validation. (see Supporting Information 5 for more detailed information on the APNN) [25, 55-57, 63] We also compared inverse-designed VAR by AR-VAE with the best VAR candidate in the training dataset, which has the smallest MSE with the target acoustic response in the training dataset to confirm that AR-VAE has better inverse design performance than the training dataset. The acoustic response of the inverse-designed VAR by AR-VAE, the inverse-designed VAR by APNN, and the best VAR candidate in the training dataset were compared, as shown in Figure 7. Figure 8 exhibited sound transmission loss error (STL error), an acoustic response difference with target acoustic response for each frequency, of the inverse-designed VAR by the AR-VAE, the inverse-designed VAR by the APNN, and the best VAR candidates in the training dataset. For all six target acoustic responses, the inverse-designed VAR by the AR-VAE exhibited the lowest STL error over the entire frequency range, particularly at the peak frequency. To compare the results quantitatively, the mean squared STL error is shown in Table 2. and it can be found that AR-VAE has the smallest mean squared STL error for all target acoustic responses. The inverse-designed VARs by the AR-VAE exhibit a 25-fold reduction in mean squared STL error compared to the APNN on average and a 2.5-fold reduction in mean squared STL error compared to the acoustic response of the best VAR candidate in the training dataset on average. Since AR-VAE performs inverse design based on binary cross-section images rather than the geometric parameters of VAR, various cross-section images with non-typical shapes are created as shown in Figure 6. To verify that inverse design using these non-parameterized VAR cross-section images can achieve a more accurate inverse design than using geometric parameters of VAR, we compared non-parameterized inverse-designed VAR with parameterized inverse-designed VAR which parameterizes non-parameterized inverse-"}, {"title": "", "content": "designed VAR by detecting parameters from its cross-section images. (see Supporting Information 6 for more detailed information and results of the parameterized VAR cross-section image) The acoustic response of 100 non-parameterized inverse-designed VAR and 100 parameterized inverse-designed VAR for each target acoustic response were obtained by the numerical simulation. It can be confirmed that non-parameterized inverse-designed VAR has a lower average mean squared STL error for all six target acoustic responses. To confirm the reliability of peak frequency coincidence with the target acoustic response, the peak frequency variance of 100 acoustic responses of non-parameterized inverse-designed VAR and parameterized inverse-designed VAR were compared. It was confirmed that the non-parameterized inverse-designed VAR has a lower peak frequency variance, which confirms that the non-parameterized inverse-designed VAR can produce more reliable inverse-design results. (see Supporting Information 7 for average mean squared STL error and peak frequency variance comparison results between non-parameterized inverse-designed VAR and parameterized inverse-designed VAR)"}, {"title": "4.2 Multi-cavity VAR", "content": "Due to the hybrid noise in environments where both noise reduction and ventilation are required, broadband sound attenuation with multi-peak frequency is often required. To realize the broadband sound attenuation performance with multi-peak frequency, a serial array of resonators should be implemented. The interaction between each single resonator composing"}, {"title": "", "content": "a serial resonator array can be analyzed by the transfer matrix method. According to this principle, broadband sound attenuation is realized while preserving the peak frequency of each single resonator. [64-68] A multi-cavity VAR was created by integrating multiple non-parameterized inverse-designed unit VARs. The structure and acoustic response of the multi-cavity VAR are presented in Figure 9. The numerical simulation revealed that the peak frequencies of the individual unit VARs were maintained in the multi-cavity VAR. Furthermore, a broadband attenuation performance within the range of 601 Hz \u2013 1961 Hz was confirmed."}, {"title": "5. Conclusion", "content": "This study proposes a novel deep generative model-based method for the inverse design of non-parameterized VARs. We proposed a VAE-based inverse-design model called the AR-VAE for accurate matching between VAR's geometric shapes and acoustic response by realizing the non-parameterized design of VAR. By combining the inverse-designed non-parameterized VARs, a multi-cavity VAR structure capable of broadband and multi-peak frequency attenuation was realized. Therefore, the method proposed in this study enables the"}, {"title": "", "content": "accurate inverse design of a VAR structure that attenuates multi-target peak frequencies. Furthermore, the generative characteristics of the AR-VAE can be exploited to design structures suitable for other physical constraints and non-parametric designs. Thus, the AR-VAE can potentially be applied to the inverse design of structures that exhibit high-dimensional nonlinear physical responses, beyond acoustic response."}, {"title": "Competing Interests", "content": "The authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper."}]}