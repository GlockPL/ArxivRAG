{"title": "Autonomous Self-Trained Channel State Prediction Method for mmWave Vehicular Communications", "authors": ["Abidemi Orimogunje", "Vukan Ninkovic", "Evariste Twahirwa", "Gaspard Gashema", "Dejan Vukobratovic"], "abstract": "Establishing and maintaining 5G mmWave vehicular connectivity poses a significant challenge due to high user mobility that necessitates frequent triggering of beam switching procedures. Departing from reactive beam switching based on the user device channel state feedback, proactive beam switching prepares in advance for upcoming beam switching decisions by exploiting accurate channel state information (CSI) prediction. In this paper, we develop a framework for autonomous self-trained CSI prediction for mmWave vehicular users where a base station (gNB) collects and labels a dataset that it uses for training recurrent neural network (RNN)-based CSI prediction model. The proposed framework exploits the CSI feedback from vehicular users combined with overhearing the C-V2X cooperative awareness messages (CAMs) they broadcast. We implement and evaluate the proposed framework using deepMIMO dataset generation environment and demonstrate its capability to provide accurate CSI prediction for 5G mmWave vehicular users. CSI prediction model is trained and its capability to provide accurate CSI predictions from various input features are investigated.", "sections": [{"title": "I. INTRODUCTION", "content": "5G millimeter wave (mmWave) technology relies on beam-forming to ensure seamless and reliable connectivity between the base stations (gNB) and the user's equipment (UE) [1], [2]. To ensure beam alignment between gNB and UE, beam man-agement procedures exploit channel state information (CSI) between gNB and UE to perform beam selection [3], [4]. However, maintaining accurate mmWave beam alignment is a complex task even for the case of stationary devices, and it becomes significant challenge for dynamically changing con-ditions experienced in 5G mmWave vehicular scenarios. This calls for proactive beam management based on CSI prediction rather than traditional reactive beam management based on experienced CSI [5]. Accurate CSI prediction as an input to the mmWave beam management may not only improve the beam alignment accuracy, but also minimize the overhead in signalling used in the beam management procedures [6]. The impact of channel prediction to beam management accuracy has been part of recent studies for increasing the robustness and resilience of beam management procedures [7], [8].\nPredicting wireless channel conditions for vehicular users is a challenging task due to highly dynamic channel behaviour [9]. Channel prediction has been addressed in a number of recent studies from different perspectives, e.g., by exploiting secondary data (e.g., aided by visual data or CSI acquired from different bands) or use of incomplete CSI data, usually paired with deep learning (DL) methods [5], [7], [9]\u2013[12]. Early works on 5G mmWave beamforming consider usage of historical CSI information to predict gNB beams for high-mobility vehicular users [1]. In [11], a DL-based approach was used to predict path loss in a vehicular communication environment using datasets created by a hybrid combination of network simulator 3 (NS3) and Simulator of Urban Mobility (SUMO). The prediction of mmWave channel in vehicle-to-vehicle (V2V) scenario using autoregressive techniques is carried out in [9], exploiting the CSI dataset collected from vehicles moving towards each other. The proposed mobility-based channel prediction module uses the mobility parameters of the vehicles to perform channel prediction. In [12], the authors applied recurrent neural networks (RNN) to predict CSI in a time-varying channel, reducing the amount of pilot symbols required for efficient channel estimation.\nIn this paper, we focus on developing a CSI prediction mod-ule for 5G mmWave vehicular users as a support for mmWave beam management module at gNB. The proposed framework aims for a fully autonomous module that continuously collects and labels acquired data, generates and maintains a training data set, and triggers the model training to generate or update the CSI prediction module. The collected data set consists of: i) CSI data set collected from 5G mmWave vehicular UEs, e.g., by exploiting demodulation reference symbols (DM-RS) in the cell area, and ii) location, speed and acceleration data set collected by overhearing V2V cooperative awareness messages (CAM) [13]. Our assumption is that the gNB is equipped with Rel. 14 C-V2X receiver overhearing the shared 5.9 GHz V2V channel and decoding all CAM messages exchanged among vehicles in the surrounding of gNB. Time synchronised data from both sources (CSI and CAM-based) are locally stored at gNB for training the prediction model, making the pro-posed framework operating essentially in autonomous and self-training mode by simultaneously logging time-synchronised input data and their corresponding labels. In this paper, we use a slight modification of DeepMIMO software [14] to recreate the above environment and generate realistic data collected at gNB. From acquired data, we train an RNN architecture with long short-term memory (LSTM) layers as a CSI prediction module. Extensive numerical evaluation demonstrates that the"}, {"title": "II. SYSTEM MODEL", "content": "In this section, we set the 5G mmWave vehicular commu-nications system model under consideration.\n5G mmWave Base Station Model: We consider a 5G NR mmWave gNB deployed in an urban environment cov-ering an area of a single busy road/street. gNB operates in mmWave band, i.e., frequency range 2 (FR2) at the carrier frequency $f_c$. Its antenna panel is a 2D uniform linear array consisting of $M = M_x \\times M_y$ antennas at a distance of $d = \\lambda/2$ from each other in both dimensions, where $\\lambda$ is the wavelength corresponding to $f_c$. gNB serves vehicular UEs (described later) using 5G mmWave beamforming in the downlink channel of bandwidth B containing K OFDM subcarriers, where beam management decisions are made by a downlink Beam Management Module (DL-BMM). We assume DL-BMM exploits periodic CSI prediction inputs it receives from CSI Prediction Module (CSI-PM) for every attached vehicular UE, where periodicity of CSI prediction delivery can be configured for each UE. The focus of our work is CSI-PM that generates per-UE CSI predictions. This module collects data from two radio interfaces: 1) From 5G NR FR2 interface, the CSI feedback obtained using channel reference symbols (e.g., CSI feedback obtained through DM-RS symbols) is delivered to CSI-PM module along with the exact acquisition timing (e.g., frame and subframe index), and 2) From additionally integrated LTE C-V2X receiver, gNB overhears cooperative awareness messages (CAMs) assumed to be broadcasted within the 5.9 GHz band periodically with period $\\Delta\\tau$ (typically, $\\Delta\\tau = 100$ ms) by all vehicular UEs in the cell from which it extracts exact timing, location, speed and acceleration of each UE. The two data streams are collected, aligned in time and stored in a dataset that is used for training the CSI prediction model: a core component of CSI-PM. Note that the process is essentially autonomous, i.e., the data collection and labeling process can be performed automatically where vehicular UE features such as location, speed, acceleration are associated with the corresponding CSI label taking into account their time alignment. Finally, we note that both CSI-PM and BMM modules can be implemented as eXtended Applications (xApps) within O-RAN Near-Real-Time Radio Interface Controller (RIC) [15].\nChannel and CSI Model: We consider a ray-tracing based channel model developed for a given environment (3D model of environment and location of gNB and UEs) using deep-MIMO simulator [14]. If the user is equipped with N antennas, the channel matrix $H_{bu} \\in C^{M\\times N}$ is constructed between a gNB b and a user u at subcarrier k. Taking into account L strongest ray-tracing paths, and for simplicity, assuming that the number of receive antennas N = 1, the vector of channel coefficients $h_u^{(b,u)} \\in C^{M\\times 1}$ between a gNB b and a user u at subcarrier k is given as:\n$h^{(b,u)}_k = \\sum_{l=1}^{L} \\rho_l(\\theta_l + \\pi\\tau_l B) a(\\gamma^{(b,u)}_{az}, \\gamma^{(b,u)}_{el})$        (1)\nwhere: $\\rho_l$ and $\\tau_l$ is the path gain and propagation delay (l is the channel path index), B is the bandwidth, $\\theta_l$ is the phase of the signal path, $a(\\gamma^{(b,u)}_{az}, \\gamma^{(b,u)}_{el})$ is the array vector of the gNB, expressed in Kronecker product form as:\n$a(\\gamma^{(b,u)}_{az}, \\gamma^{(b,u)}_{el}) = a_x((\\gamma^{(b,u)}_{az}, \\gamma^{(b,u)}_{el}) \\otimes a_y((\\gamma^{(b,u)}_{az}, \\gamma^{(b,u)}_{el}) \\otimes a_z(y^{(b,u)}_{az}, \\gamma^{(b,u)}_{el}),$   (2)\nwhere $a_x(), a_y()$ and $a_z()$ represent the BS array response vector in x, y and z direction, respectively (see [14] for more details). Although in practice, a quantised version of CSI is fed back, for simplicity, we assume that gNB receives and collects full CSI information in the form of a matrix $H^{b,u} \\in C^{M \\times K}$ that collects channel gains across all K subcarriers.\nVehicular Users Model: We consider a fleet of vehicular users moving along the road in both directions. Each vehicle is equipped with 5G NR mmWave (FR2) and LTE C-V2X 5.9 GHz radios for V2I and V2V communications, respectively. gNB maintains connectivity with vehicular UEs through beam management process implemented in the BMM module. Ve-hicular UEs broadcast CAM messages with periodicity $\\Delta\\tau$."}, {"title": "III. CSI PREDICTION MODULE FOR 5G NR MMWAVE VEHICULAR USERS", "content": "In this section, we further elaborate a framework for data collection, training and inference for CSI prediction imple-mented as a stand alone CSI-PM module. The CSI-PM module performs several main functions, as detailed below.\nData collection and labelling: For each vehicular UE connected to the gNB, the CSI-PM module collects time-stamped CSI information received from 5G NR mmWave radio and time-stamped content of CAM messages containing UE location, speed and acceleration. Time aligned data (of periodicity $\\Delta\\tau$) aggregated across all UEs is stored in a training data set where CAM data represents features and CSI data represents labels. The dataset generation process (including labelling) is fully automated.\nCSI-PM model architecture and training: The core of the CSI-PM module is the prediction model. We train the prediction model on the collected dataset. The proposed model architecture adheres to conventional methodologies for train-ing multivariate time series models, employing recurrent neu-ral networks (RNNs) as our baseline model. Specifically, we utilize an RNN architecture with two long short-term memory (LSTM) layers (each with 10 hidden states), regardless of the number of input features. This decision was motivated by our pursuit of a comprehensive understanding of the model's ro-bustness and expressive capabilities. Additionally, maintaining a consistent architecture across varied input features offers the advantage of simplifying feature management and model interpretation. While we recognize the potential trade-offs in model performance due to this uniform approach, practical considerations, such as resource constraints and the desire for a unified framework, influenced our decision-making. By adhering to this approach, we aim to explore the generaliz-ability and adaptability of our model across diverse datasets and application scenarios.\nIn our RNN architecture, we incorporate a fully-connected (FC) layer as the output layer alongside the two LSTM layers. The FC layer comprises 2M neurons, with each neuron dedicated to processing specific features, encompassing M real and M imaginary CSI values (equal to the number of predicted channel coefficients). By embedding this FC layer at the output stage of the RNN, our aim is to refine the model's predictive prowess by adeptly capturing nuanced data patterns. This augmentation empowers the algorithm to generate precise predictions grounded in a comprehensive analysis of the input features. Consequently, the synergy between the LSTM layers and the FC output layer strengthens the model's resilience and ensures accurate predictions, thereby enhancing its efficacy in handling multivariate time series data. The model is optimized through mean squared error (MSE) loss function (between estimated and true CSI values), on a batch-by-batch basis, using the Stochastic Gradient Descent (SGD) algorithm with the ADAM optimizer [18].\nCSI-PM model inference: Once the model is trained, it is deployed in the CSI-PM module for inference process. Based on inputs obtained from each UE after each received CAM message, the CSI-PM module generates CSI predictions and sends them to the BMM module to support beam management decisions. We note that a retraining process based on the newly received and stored data can be trigerred periodically to update the CSI-PM model."}, {"title": "IV. PERFORMANCE EVALUATION", "content": "The scenario considered in this paper (Figure 1) is im-plemented in DeepMIMO by performing minor adaptations to the simulator by including simulation of mobile vehicular UEs according to a simple FSMC mobility model. For the simulation model, we consider the main street called User grid 1 (UG1) as part of the first scenario (Scenario 1) in the DeepMIMO simulator. The street is about 600 m long and 40 m wide. More precisely, it is represented as a grid of possible discretised user positions with precisely 2751 rows and 181 columns and a distance of 0.2 m between neighboring grid points in both dimensions. A single gNB deployed in the street at one of the central street locations (BS3 in DeepMIMO Scenario 1) is activated. gNB parameters and their values adopted in the simulation are presented in Table 1."}, {"title": "V. CONCLUSION", "content": "Accurate CSI prediction could significantly improve the performance of beam management procedures in 5G NR mmWave networks. In this work, we explore a framework for autonomous and self-trained CSI prediction implemented as a stand-alone CSI-PM module. The module collects and labels data by overhearing vehicular C-V2X CAM messages, extracts features about each vehicular UE, and label them with the corresponding CSI feedback. The obtained dataset is used to train fully connected LSTM network on the data produced by suitable adaptation of the DeepMIMO simulator. The CSI-PM model is trained and its capability to provide accurate CSI predictions from various input features is investigated. Further work will target further development and integration of CSI-PM and BMM modules in DeepMIMO and their subsequent development as xApps in an open-source O-RAN environment."}]}