{"title": "GENERATING MULTI-SCALE NMC PARTICLES WITH RADIAL GRAIN ARCHITECTURES USING SPATIAL STOCHASTICS AND GANS", "authors": ["LUKAS FUCHS", "ORKUN FURAT", "DONAL P. FINEGAN", "JEFFERY ALLEN", "FRANCOIS L.E. USSEGLIO-VIRETTA", "BERTAN OZDOGRU", "PETER J. WEDDLE", "KANDLER SMITH", "VOLKER SCHMIDT"], "abstract": "Understanding structure-property relationships of Li-ion battery cathodes is crucial for optimizing rate- performance and cycle-life resilience. However, correlating the morphology of cathode particles, such as in NMC811, and their inner grain architecture with electrode performance is challenging, particularly, due to the significant length- scale difference between grain and particle sizes. Experimentally, it is currently not feasible to image such a high number of particles with full granular detail to achieve representivity. A second challenge is that sufficiently high- resolution 3D imaging techniques remain expensive and are sparsely available at research institutions. To address these challenges, a stereological generative adversarial network (GAN)-based model fitting approach is presented that can generate representative 3D information from 2D data, enabling characterization of materials in 3D using cost- effective 2D data. Once calibrated, this multi-scale model is able to rapidly generate virtual cathode particles that are statistically similar to experimental data, and thus is suitable for virtual characterization and materials testing through numerical simulations. A large dataset of simulated particles with inner grain architecture has been made publicly available.", "sections": [{"title": "1. INTRODUCTION", "content": "Improving Li-ion battery energy-density, power-density, and cycle-life is intricately linked to addressing the climate crisis by enabling transportation electrification and increasing storage capabilities for renewable energy sources. The tremendous progress in Li-ion battery performance, achieved over the past 30 years, has largely stemmed from fine tuning electrode microstructures and electrolyte compositions, without much change in the active material elemental composition [1]. Yet, opportunities still exist for controlling cathode sub-particle microstructure to enhance perfor- mance [2,3]. For example, frabricating radially oriented and elongated grains within $LiNi_xMnyCo_zO_2$ (NMCxyz) cathode particles has been shown to significantly increase rate capability as compared to cathode particles that have no preferential grain orientation or internal architecture [2, 4-6]. It is also expected that by designing cathode grain microstructures, chemo-mechanically induced fracture, which perpetuates loss-of-active-material and eventually leads to battery capacity fade, can be reduced [3]. The present paper seeks to improve the understanding of structure- property relationships between particle-level and grain-level microstructures and observed battery performance. This is achieved by developing a tool that can generate representative microstructures from experimental data. These realistic microstructures are essential in experiment data interpretation and are required for physics-based models that seek to explore particle- and grain-level physics that ultimately determine battery performance and longevity.\nThere is a need in the community for a tool that can generate representative microstructures for mesoscale battery models to assist in mapping realistic microstructural information to cell-level performance. Physics-based models have been used to help accelerate Li-ion battery electrode development. For example, physics-based models can be used to optimize designs for fast-charge performance [7-10]. Effective optimization using battery models requires relatively fast computation times. To achieve fast computation times, physics-based models typically abstract detailed electrode-level, particle-level, and grain microstructures to \"effective\" parameters that approximate these intricacies [11]. Examples of these effective parameters include: secondary-particle diameter, specific surface area, solid-phase diffusion coefficients, and electrolyte tortuosity. While these fast electrochemical models have shown great promise, there is a disconnect between the optimized effective parameters and the underlying complex microstructures that can achieve these performance metrics.\nMoreover, geometric complexities not typically included in physics-based models, such as grain orientation, grain size, and secondar particle surface area, can strongly influence cell aging [2, 12]. For example, secondary particle cracking has a complex relationship with capacity fade-cracks reduce solid-phase diffusion lengths and increase specific surface area [13], but can isolate active material and introduce unprotected surfaces for side reactions [14-16]). Additionally, grain orientation, size, and shape greatly influence the apparent solid-phase diffusion coefficient [17]. To bridge the gap between optimized effective parameters, identified in physics-based models and real microstruc- tures, researchers have developed \"mesoscale\" models that focus on particle- and grain-level microstructures and associated electro-chemo-mechanic physics [15,18-22]. However, generating statistically representative, realistic par- ticle and grain microstructures as inputs for these mesoscale models is challenging [23, 24]. Consequently researchers often approximate geometries with idealized shape, size, and orientations [15, 19-22, 25-29].\nIn the present paper, a \"multi-scale\" particle model is developed to generate representative secondary NMC811 particles comprised of representative grains (primary-particles). The multi-scale approach can be subdivided into two distinct models that can generate virtual morphologies that statistically resemble secondary-particles and grain architectures. A similar two-part, multi-length-scale approach was used previously [30]. As in this study, the outer secondary-particle shell is generated using a random field on the unit sphere [31], and the inner grain architecture is generated using a random tessellation. Roughly speaking, common (distance-based) tessellations can be considered as parametric partitions of Euclidean space, such as the Voronoi or Laguerre diagram [32]. Unlike the previous study [30], the proposed grain architecture model is not based on Laguerre tessellations [33], but on a more general class. Furthermore, in contrast to previous approaches, a neural network is implemented to generate the parameters of the tessellations. Importantly, this allows for a novel (gradient descent-based) fitting procedure of the tessellation model, enabling the generation of 3D grain architectures solely by using 2D planar section information.\nSeveral neural-network-based approaches for 2D-3D (re-)construction approaches have been explored previously [34- 36]. In contrast to the present model, most of these black-box methods are based on upsampling [37] or transposed convolution [38] techniques to generate discrete 3D voxel representations from 2D pixel images (i.e., slices or pro- jections). These generated 3D voxel representations do not have any underlying constraints and thus are able to generate any morphology at the expense of interpretability and computational efficiency.\nIn contrast to other 2D-to-3D generation methods, the present method does not solely rely on neural networks and the generation of a 3D voxel-based representation. Instead, a neural network and a Poisson point process [39,40] is used to generate (continuous) tessellation parameters [41, 42]. More precisely, the parameters of the random tessellation model, i.e., the parameters of the neural network and the point process, are fit by a generative adversarial network (GAN)-based [43] approach, allowing for the simulation of realistic 3D grain architectures. These virtual grain architectures are then sliced into several 2D images and passed to the so-called discriminator to be compared with measured grain architectures. The output of the discriminator is then used to update the parameters of the grain architecture model to generate more realistic 3D grain architectures. After training, the generated 3D structures are"}, {"title": "2. MATERIALS; ACQUISITION, PREPROCESSING AND ANALYSIS OF IMAGE DATA", "content": "2.1. Overview of experimental approach. To supply sufficient high-quality image data on particle and grain architectures, a multi-modal approach was deployed. Electron backscatter diffraction (EBSD) was used, as previously described in [48], to facilitate grain and grain boundary segmentation, as well as populate the segmented grains with local crystallographic orientation information. Note, there is a distinction between crystallographic and morphological grain orientation; crystallographic orientation refers to the orientation of the c-axis of the NMC811 crystal, whereas morphological grain orientation refers to the direction of the major axes of the best fitting elongated spheroid shapes of the grains with respect to the particle center. Conducting EBSD on a small number of particles provides a view of hundreds of grain planar sections. However, extending EBSD to 3D via focused ion beam (FIB)-EBSD and acquiring morphological data on hundreds of full particles is not yet practical experimentally. Instead, the (secondary-) particle morphological information, or outer shell, was captured in detail for many particles by X-ray nano-computed tomography (nano-CT) at the cost of a lack of inner grain architecture information. The outer shell and sub-particle grain architectures are independent and therefore must each be quantified with a sufficient number of samples to be representative. The combination of 2D EBSD and 3D nano-CT facilitated detailed information on the sub-particle grain features and full particle outer shell morphological detail, respectively, with sufficient volume to achieve representivity in both.\n2.1.1. Materials. A pristine sample of NMC811 electrode was used for this work. The electrode consisted of 96 wt% Targray NMC811, 2 wt% Timcal C-45, and 2 wt% Solvay 5130 PVDF binder. The Al foil was 20 \u00b5m thick, and the coating thickness was 58 \u00b5m with a porosity of 33% and areal capacity of 3.07 mAh cm-2. These cathodes have been extensively studied in fast-charge applications for electric vehicles [2, 12, 49, 50]. The preferential radial orientation of these particles is argued to significantly increase these cathodes rate performance and cycle-life resiliency [12].\n2.1.2. X-ray nano-computed tomography (nano-CT). For X-ray nano-CT imaging, cylindrical pillars of ca. 90 \u00b5m diameter were prepared using a micro-machining laser ablation approach described previously in [51]. The pillars were then imaged in a Zeiss Xradia Ultra 810 X-ray nano-CT system in Large Field of View (LFOV) absorption mode with binning 2, giving a voxel size of 128 nm. The field of view was 64 \u03bcm \u00d7 64 \u00b5m. 1601 images were acquired for the reconstruction of each tomogram.\n2.1.3. SEM and EBSD imaging. The NMC811 cathode sample was argon-milled with a JEOL CP ion beam planar section polisher (JEOL, USA). This provided a wide (ca. 2 mm) smooth planar section of the NMC811 electrode. Scanning electron microscopy (SEM) and EBSD images were taken on several planar sectioned particles using an FEI Nova NanoSEM 630 equipped with an EBSD detector (EDAX, USA). EBSD data was collected using step sizes of 50 nm rastered across the surface of particle planar sections. EBSD data was processed with OIM Analysis v.8 (EDAX, USA). Diffraction patterns were fit to a trigonal crystal system (space group R-3 m) with a = b = 2.875 \u00c5 and c = 14.248 \u00c5 to obtain the orientation of the crystal at each, where a, b, c denote the side lengths of the rhombohedral unit cell associated with the crystal's atomic lattice. The software produced text files containing a spatially resolved confidence index, image quality (IQ), and Bunge-Euler angle data. These data were then converted into images, where individual grains are labeled separately.\n2.2. Preprocessing of nano-CT data. The NMC811 particles' outer shells are modeled by a random field on the sphere. Fitting the random field model requires preprocessing the nano-CT data.\n2.2.1. Segmentation and labeling. Initially, the 3D grayscale CT image, see Figure 1a, undergoes segmentation and labeling. This process includes convolving the grayscale image with a discrete 3D Gaussian kernel with standard deviation $\u03c3 = 1.8$, followed by Otsu thresholding [52] and labeling of the resulting binary 3D image using the watershed algorithm [53]. Subsequently, disconnected components of the watershed-labeled image are separated, and small (volume V < 10 voxels) or non-spherical (sphericity $\\Psi < 0.5$, see Eq. (20) for a formal definition) components are merged with their corresponding neighboring components if they exist; otherwise, they are neglected to remove artifacts. Finally, components intersecting the boundary of the sampling window are removed to minimize edge effects. This procedure yields N = 1590 labeled particles in voxel representation, as shown in Figures 1b and 1c."}, {"title": "2.2.2. Spherical harmonics representation", "content": "These voxel-based particles are assumed to be star-shaped such that their so-called star point coincides with their centers of masses. Thereby, a star-shaped domain is one where every line segment from the star point to a boundary point lies entirely inside the domain. Therefore, a particle with center of mass $c \\in \\mathbb{R}^3$ can be represented by a radius function $P : \\mathbb{S}^2 \\rightarrow \\mathbb{R}_+ = [0,\\infty)$ on the unit sphere $\\mathbb{S}^2 = \\{x \\in \\mathbb{R}^3 : |x| = 1\\}$ given by\n(1)\n$P(u) = \\max\\{r \\in \\mathbb{R}_+ : \\text{voxel } \\xi(ru + c) \\text{ belongs to the particle}\\},\\qquad \\text{for each } u \\in \\mathbb{S}^2,$\nwhere $\u03be(x) \u2208 \\mathbb{Z}^3$ denotes the grid point that is closest to some point $x \u2208 \\mathbb{R}^3$. For a visual validation of the star-shape assumption, see Figure 1d.\nTo stochastically model the star-shaped particles, the particles radius is modeled as a function by means of random fields on $\\mathbb{S}^2$. Realizations of these models can be considered to be radius functions that describe the outer shell of particles. Therefore, we use so-called (real-valued) spherical harmonic functions $Y_{\\ell m} : \\mathbb{S}^2 \\rightarrow \\mathbb{R}$ for $\\ell \\in \\mathbb{N}_0 = \\{0,1,...\\}$ and $m \\in \\mathbb{Z} = \\{\\dots, -1, 0, 1, \\dots \\}$ with $|m| \\leq \\ell$, which are given by\n(2)\n$Y_{\\ell m}(u) = \\begin{cases}\n\\sqrt{\\frac{2\\ell+1}{4\\pi} \\frac{(\\ell-|m|)!}{(\\ell+|m|)!}} P_{\\ell}^{|m|}(\\cos(\\theta(u))) \\sin(|m|\\varphi(u)), & \\text{if } m < 0, \\\\\n\\sqrt{\\frac{2\\ell+1}{4\\pi}} P_{\\ell}^0(\\cos(\\theta(u))), & \\text{if } m = 0, \\text{ for each } u \\in \\mathbb{S}^2, \\\\\n\\sqrt{2} \\sqrt{\\frac{2\\ell+1}{4\\pi} \\frac{(\\ell-|m|)!}{(\\ell+|m|)!}} P_{\\ell}^{m}(\\cos(\\theta(u))) \\cos(m\\varphi(u)), & \\text{if } m > 0,\n\\end{cases}$\nwhere $P_l^m: [0,1] \u2192 [0,1]$ are the Legendre polynomials and $\u03b8(u) \u2208 [0,\u03c0), \u03c6(u) \u2208 [0,2\u03c0)$ are the polar and the azimuthal angles of $u \u2208 \\mathbb{S}^2$, respectively. These functions form an orthonormal basis of the Hilbert space $L^2(\\mathbb{S}^2)$ of square-integrable functions\u00b9 on the unit sphere $\\mathbb{S}^2$ [54]. Thus, loosely speaking, the surface of each star-shaped particle can be expressed as a linear combination of spherical harmonic functions. As the order of these spherical harmonic functions increases (i.e., the value of $l$), they contribute to capturing more detailed and rougher surface features. Since the considered CT data has a finite resolution, it is not meaningful to consider significantly high orders. Therefore, in the following only spherical harmonic basis functions with $l < L = 9$ are considered. This results in a spherical-harmonics representation $\\hat{P} : \\mathbb{S}^2 \\rightarrow \\mathbb{R}_+$ of the radius function $P$, given by\n(3)\n$\\hat{P}(u) = \\sum_{\\ell=0}^{L} \\sum_{m=-\\ell}^{\\ell} a_{\\ell m} Y_{\\ell m}(u), \\qquad \\text{for each } u \\in \\mathbb{S}^2,$\nwhere $a_{\\ell m}$ are the $(L + 1)^2 = 100$ coefficients of this basis representation. The computation of these coefficients for a given star-shaped particle's radius function $P$, and therefore its approximation in terms of the spherical harmonics basis up to order $L$, is done by least squares regression. More precisely, the least squares fit between $P(Ru)$ and $\\hat{P}(u)$ is computed regarding 642 equidistant evaluation points $u \u2208 \\mathbb{S}^2$ on the unit sphere, resulting in 642 equations with the 100 variables $a_{\\ell m}$. Here, $R\u2208 \\mathbb{R}^{3\u00d73}$ denotes a rotation matrix, uniformly chosen at random, which helps to mitigate any anisotropy in the data arising from the voxel-based representation of the CT data or the segmentation procedure. For a visual inspection of the quality of this fit, see Figure 1e."}, {"title": "2.3. Morphology of 2D grain architectures", "content": "As mentioned in Section 2.1.3, the text data produced by the EBSD measurement was first converted into image data of labeled grains, as shown in Figure 2. These 2D image data resulting from EBSD measurement are from now on referred to as 2D EBSD (planar section) data. The grain architectures observable in these data show a non-uniform morphological orientation, i.e., the grains morphologies exhibit a preferred orientation towards the center of the particle planar section, which is identified as the origin $o = (0,0) \u2208 \\mathbb{R}^2$ of the coordinate system. Note that morphological orientation described here is distinct from crystallographic orientation. The proposed model should be able to reflect this behavior, thus, the orientation of individual 2D grains has to be captured quantitatively. For this purpose, the principal components $v_1, v_2 \u2208 \\mathbb{R}^2$ of the pixel positions associated with a grain, along with their corresponding eigenvalues $e_1 > e_2 > 0$ are utilized. The first principal component $v_1$ is a direction that maximizes the (empirical) variance of the pixel positions [55]. In other words, it describes the primary orientation of the grain. The orientation $\u03b1 \u2208 [0, \u03c0] $ of a grain is thus given by the smallest angle between the grain's center c (in the planar section) and $v_1$, i.e.,\n(4)\n$\u03b1 = \\arccos \\frac{v_1^T c}{ |v_1||c| }$\nsee Figure 2. For grains with $\u03b1 \u2248 0$ the principal component $v_1$ points towards the origin, whereas an orientation $\u03b1 = \u03c0/2$ corresponds to principal components that are orthogonal to the direction pointing to the origin. Figure 2 shows the grain orientation distribution per 2D EBSD image. Furthermore, exemplary planar sections are presented in Figure 2. Notably, for some planar sections, the corresponding EBSD data (outlined with gray boxes in Figure 2) exhibits no preferred grain orientation. It is conjectured that these images correspond to planar sections located farther away from the particle center as compared to those highlighted with a black box, i.e., the assumption that the particle center is located at the origin of the planar section observed in the EBSD image is not valid. However, the stereological model fitting approach for the inner grain architecture model, introduced in Section 3.3, relies on image data of planar sections passing through the particle center, since in such images, grains in each radial distance from the particle center can be observed, a property not present in planar sections at other locations. Consequently, EBSD planar sections represented by gray curves in Figure 2 are excluded from the subsequent model fitting procedure."}, {"title": "3. STOCHASTIC MULTI-SCALE MODEL", "content": "In this section, the stochastic models for both the outer shell and the inner grain architecture, along with their corresponding fitting procedures, are presented. The choice of a two-scale modeling approach is driven by the pre- sumed minimal correlation between the outer shell of NMC811 particles and their inner grain architecture. Initially, the outer shell structure is modeled on a coarser length scale (by means of nano-CT data), before proceeding to the modeling of the inner 3D grain architecture, which is observable on a finer length scale (by means of 2D EBSD data).\n3.1. Stochastic outer shell model. After the preprocessing of nano-CT data explained in Section 2.2, the next step towards stochastic outer shell modeling is to describe the distribution of the coefficients $a_{\\ell m}$ appearing in Eq. (3) by appropriately chosen random variables $Z_{\\ell m}$. Due to the assumed isotropy of the underlying image data, the random variables $Z_{\\ell m}$ and $Z_{\\ell m'}$ are supposed to be identically distributed for any $m,m'$. For $(\\ell,m) \u2260 (\\ell', m')$ with $l, l' \u2260 0$, the random variables $Z_{\\ell m}$ and $Z_{\\ell' m'}$ can be assumed to be independent, see [56]. Furthermore, to justify the assumption of independence of $Z_{00}$ and $Z_{\\ell m}$ for $l,m \u2260 0$, the empirical distance correlation coefficient (edcc) [57] of the observations of $a_{00}$ and $a_{\\ell m}$ is investigated. Note that the distance correlation coefficient of two random variables is zero if and only if the random variables are independent. Thus, the small values of the edcc, shown in Figure 3, justify the assumption of independence. Moreover, the coefficients $a_{00}$ which predominantly"}, {"title": "3.2. Stochastic grain architecture model", "content": "This section introduces the model used to describe the inner grain ar- chitecture of NMC811 particles. The model is based on a so-called generalized balanced power diagram (GBPD) [58], which is a generalization of the well-known Voronoi [32] and Laguerre [33] tessellations. GBPDs are a powerful tool to describe Euclidean space filling structures, such as grains, in a low parametric way [41]. This low-parametric rep- resentation allows for data compression, fast computation, and a simpler and more interpretable grain architecture modeling as compared to voxel-based approaches.\nIn general, for any integer $d\u2208 \\mathbb{N} = \\{1,2,...\\}$, a GBPD is a decomposition of the d-dimensional Euclidean space $\\mathbb{R}^d$ into non-overlapping subsets (or grains) $G_1, ..., G_v \\subset \\mathbb{R}^d$, where for each $i \u2208 \\{1, ..., v\\}$ it holds that\n(8)\n$G_i = \\{x \u2208 \\mathbb{R}^d : |x - s_i|_{M_i} - r_i \\leq |x \u2212 s_j|_{M_j} \u2013 r_j \\text{ for all } j\u2208 \\{1, ..., v\\} \\backslash \\{i\\}\\},$\ngiven $v \u2208 \\mathbb{N}$ distinct seed points $s_1,..., s_v \\subset \\mathbb{R}^d$ and markers $(M_1,r_1), ..., (M_v, r_v)$. Here, $M_i \u2208 \\mathbb{R}^{d\u00d7d}$ is a positive definite matrix, $r_i \u2208 \\mathbb{R}$ is an offset parameter and $|x \u2212 s_i|_{M_i} = (x \u2212 s_i)^T M_i(x \u2212 s_i)$ is the metric induced by $M_i$. Later on, for $d\u2208 \\{2,3\\}$, each set $G_i$ will represent a single grain and consequently will be referred to as such. Figures 7 and 9 show examples of such tessellations for the cases d = 2 and d = 3, respectively.\nThe tessellations used within the proposed grain architecture model are further restricted to GBPDs whose matrices $M_i$ can be written as $M_i = Q_i D_i Q_i^T$. Here, $Q_i$ is a basis change matrix to a given basis whose first basis vector is $s_i/|s_i|$ and $D_i$ is a diagonal matrix. This restriction reduces the marker dimensionality from 6+1 to 3+1 and allows deriving a non-stationary but radial symmetric model, the realizations of which resemble the grain architectures observed in the image data considered in Section 2.3. To derive such a radial symmetric model, the seed points $s_1,..., s_v$, as well as the markers $(D_1, r_1), ..., (D_v, r_v)$ of the tessellations are modeled stochastically. Thereby, the modeling of the seed points is done by a Poisson point process [39,40], i.e., a random point pattern, whereas the modeling of the markers is accomplished by a fully connected neural network as explained in Section 3.3 below. The neural network based approach allows for a stereological model fitting procedure. This is crucial since only 2D EBSD data are available to investigate the grain architecture of NMC811 particles.\nThe following section describes this stereological procedure in more detail."}, {"title": "3.3. Stereological tessellation model calibration", "content": "The neural network used for marker generation is calibrated by means of a generative adversarial network (GAN) framework [43]. Note that GANs represent a game-theory inspired zero-sum game framework, where two key neural networks comprise the GAN framework: The generator G and the discriminator D. These neural networks compete with each other to achieve a so-called Nash equilibrium [59], i.e., the generator continually refines its ability to produce data resembling measured samples, while the discriminator iteratively enhances its capability to distinguish between measured and simulated data. Typically, this is realized by an image generating neural network G: N \u2192 I, i.e., a neural network that maps some noise space N to some set of images I, and a discriminator D: I \u2192 R that is trained to distinguish between measured and simulated images, see [34,43] for details. In the present paper, the discriminator tries to assign measured data a label of 1 and simulated ones a label of 0. Using the least squares loss [60], this results in the following min-max problem:\n(9)\n$\\max_{G} \\min_{D} \\mathbb{E} [(D(X) \u2013 1)^2] + \\mathbb{E} [(D(G(Z)))^2],$\nwhere X \u2208 I is a random vector following the distribution of measured data, and Z\u2208 N is some random vector which serves as input for the generator network G (where Z is sometimes chosen as white noise [60]). The terms $\\max_G$ and $\\min_D$ in Eq. (9) refer to the maximum and minimum taken over all possible parameter values of the neural networks G and D, respectively, given that their architectures are fixed. However, in the GAN approach proposed in the present paper, the output of the generator, i.e., a 3D tessellation-based grain architecture, can not directly be compared to measured data, i.e., pixel-based 2D image data, and, therefore, the loss function given by Eq. (9) has to be adapted [34]. Thus, we introduce two (random) functions, $T_{2D}$ and $T_{3D}$, which compute (random) discretized 2D cutouts of 2D images drawn from X, and 2D cutouts of simulated 3D tessellations drawn from G(Z), respectively. This leads to the optimization problem\n(10)\n$\\max_{G} \\min_{D} \\mathbb{E} [(D(T_{2D}(X)) \u2013 1)^2] + \\mathbb{E} [(D(T_{3D}(G(Z))))^2].$\nIn the following, the precise definitions of G, $T_{2D}$, $T_{3D}$, and D will be explained in more detail. To ensure an efficient GAN training, we assume the superimposed mapping $D(T_{3D} (G))$ to be differentiable almost everywhere with respect to the parameters of G. Since G and D are defined by neural networks and thus almost everywhere differentiable,"}, {"title": "3.3.1. Tessellation generation", "content": "For a given sample $(s_1, \\eta_1, \\gamma_1), ..., (s_v, \\eta_v, \\gamma_v) \u2208 W = [-128, 128]^3 \u00d7 [0,1]^2 \u00d7 [0, \u03c0]$ of seed points $s_1,...,s_v$ and noise $(\\eta_1,\\gamma_1),..., (\\eta_v, \\gamma_v)$, the generator G computes markers $(M_1, r_1), ..., (M_v, r_v)$ and a differentiable softmax representation $T: \\mathbb{R}^3 \u2192 [0,1]^\u03bd$ of a tessellation, see [41,61]. This means that the values of T are given by\n(11)\n$T(x) = \\begin{pmatrix}\n\\frac{\\exp(-|x - s_1|_{M_1} + r_1)}{\\sum_{i=1}^\u03bd \\exp(-|x \u2212 s_i|_{M_i} + r_i)}\\\\\n\\vdots\\\\\n\\frac{\\exp(-|x - s_\u03bd|_{M_\u03bd} + r_\u03bd)}{\\sum_{i=1}^\u03bd \\exp(-|x \u2212 s_i|_{M_i} + r_i)}\n\\end{pmatrix}, \\qquad \\text{for each } x \\in \\mathbb{R}^3.$\nThe vector-valued mapping T = ($T_1$ ...,$T_\u03bd$) directly implies a tessellation $G_1,...,G_\u03bd$, as defined in Eq. (8), by considering the index i of the component $T_i(x)$ with maximal value, i.e., $G_i = \\{x \u2208 \\mathbb{R}^3: T_i(x) = \\max_j T_j(x)\\}$. Furthermore, note that the differentiable softmax representation T given in Eq. (11) for 3D tessellations can be analogously defined for planar 2D tessellations.\nThe generation of the sequence $(s_1, \\eta_1, \\gamma_1), ..., (s_\u03bd, \\eta_\u03bd, \\gamma_\u03bd)$, i.e., the seed points $s_1,..., s_\u03bd$ and corresponding noise $(\\eta_1, \\gamma_1), ..., (\\eta_\u03bd, \\gamma_\u03bd)$ necessary for random marker creation, is done by drawing samples from a homogeneous Poisson point process with some intensity $\u03bc > 0$, being restricted to the set $W = [-128, 128]^3 \u00d7 [0, 1]^2 \u00d7 [0, \u03c0]$ [39,40]. However, the corresponding markers $(M_1,r_1), ..., (M_v, r_v)$ are generated by a fully connected (FC) neural network, which is denoted as $G_{net}$. Since the grain shape and the size is only influenced by nearby grains, we assume that the marker of a seed point only depends on its neighboring seed points. More precisely, for the generation of the marker $(M_i, r_i)$ only information is considered derived from the \u03ba = 12 nearest seed points $s_{i_1},..., s_{i_\u03ba}$, $i_j \u2208 \\{1,...,\u03bd\\} \\backslash \\{i\\}$ with respect to the Euclidean distance. Furthermore, to ensure a statistically radial symmetric output of the generator network $G_{net}$, its input is modified to get rid of anisotropic information, i.e., the direction of $s_i$. This is done by rotating the coordinate system in such a way that $s_i$ is always aligned in the direction of the unit vector $e_1 = (1,0,0)$. That is, for a given seed point $s_i$ we determine a rotation matrix $Q_i$ given by\n(12)\n$Q_i = R_{e_1,\u03b3_i} R_{\\frac{s_i}{|s_i|}+e_1, \u03c0},$\nwhere $R_{s,\u03b3}$ denotes the rotation matrix that describes a rotation around $s \u2208 \\mathbb{R}^3$ by an angle of $\u03b3 \u2208 [0, \u03c0]$, $\\frac{s_i}{|s_i|}$ is the normalized version of $s_i$, and $\u03b3_i$ is some angle determined by the Poisson point process. Finally, the vectors $v_{i_1},..., v_{i_\u03ba}$, which are used as input of $G_{net}$ for marker generation, are given by rotating the displacements $s_{i_j} \u2212 s_i$ by $Q_i$, i.e., $v_{i_j} = Q_i(s_{i_j} \u2212 s_i)$ for $j = 1,..., \u03ba$. Note that $Q_i$ is a basis change as described in Section 3.2.\nTo further allow the generator network $G_{net}$ to find a non-deterministic grain architecture for given seed points, and therefore being a suitable stochastic model, seed point specific noise $\u03b7_{i_j} \u2208 [0, 1]^2$ is added. Thus, the input of $G_{net}$ is given by $(v_{i_1}, \u03b7_{i_1},... v_{i_\u03ba}, \u03b7_{i_\u03ba})$. Figure 5a shows the fully connected architecture of $G_{net}$. It uses ReLu activation functions $f(t) = \\max\\{0,t\\}, t \u2208 \\mathbb{R}$ in the hidden layers for neuron activations and utilizes scaled sigmoid functions $\u03d5(t)_{a,b} = a + (b \u2212 a)/(1 + e^{\u2212t}), t \u2208 \\mathbb{R}$ as activation functions in the output layers to ensure that the generated markers are in a reasonable range. This limits the elongation of the resulting grains, which makes them less likely to be disconnected (something that can occur for GBPDs), this helps to prevent unintended artifacts, and improves the generator-discriminator training. In particular, the values of $a, b \u2208 \\mathbb{R}$ of the channels within the output layer are chosen such that the value of $r_i$ and the diagonal entries of $D_i$ are restricted to [1,10] and [0,50], respectively. A more detailed pseudocode representation of this procedure is shown in Algorithm 1."}, {"title": "3.3.2. Data transformation", "content": "To address the issue of unassigned pixels, a differentiable representation T (see Eq. (11)) of the restricted GBPD with d = 2 is fitted to the EBSD data using the method described in [41"}]}