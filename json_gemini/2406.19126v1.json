{"title": "Super-resolution imaging using super-oscillatory diffractive neural networks", "authors": ["Hang Chen", "Sheng Gao", "Zejia Zhao", "Zhengyang Duan", "Haiou Zhang", "Gordon Wetzstein", "Xing Lin"], "abstract": "Optical super-oscillation enables far-field super-resolution imaging beyond diffraction limits. However, the existing super-oscillatory lens for the spatial super-resolution imaging system still confronts critical limitations in performance due to the lack of a more advanced design method and the limited design degree of freedom. Here, we propose an optical super-oscillatory diffractive neural network, i.e., SODNN, that can achieve super-resolved spatial resolution for imaging beyond the diffraction limit with superior performance over existing methods. SODNN is constructed by utilizing diffractive layers to implement optical interconnections and imaging samples or biological sensors to implement nonlinearity, which modulates the incident optical field to create optical super-oscillation effects in 3D space and generate the super-resolved focal spots. By optimizing diffractive layers with 3D optical field constraints under an incident wavelength size of \u5165, we achieved a super-oscillatory spot with a full width at half maximum of 0.407 in the far field distance over 400\u5165 without side-lobes over the field of view, having a long depth of field over 10\u5165. Furthermore, the SODNN implements a multi-wavelength and multi-focus spot array that effectively avoids chromatic aberrations. Our research work will inspire the development of intelligent optical instruments to facilitate the applications of imaging, sensing, perception, etc.", "sections": [{"title": "1 Introduction", "content": "The Abbe-Rayleigh diffraction limit of traditional optical equipment has always been an obstacle to the study of micro-/nano-scale objects [1, 2]. Near-field microscopic imaging techniques, such as contact photography [3] and scanning near-field imaging (SNOM) [4, 5], capture evanescent fields by placing a probe or light-sensitive material extremely close to the object to achieve nanoscale resolution, which is not possible for imaging inside biological samples or encapsulated micro-/nano-structures. Far-field microscopic imaging technology is not restricted by the above bottlenecks. Some typical far-field microscopic imaging techniques, such as single-molecule localization (SML) microscopy [6, 7] or stimulated emission depletion (STED) [8, 9], have demonstrated the possibility of nanoscale imaging without capturing evanescent fields. However, SML microscopy and STED typically require intense beams to excite, deplete, or bleach fluorophores in a sample that produces photobleaching and phototoxicity in living samples.\nOptical super-oscillations are rapid sub-wavelength spatial variations of light intensity and phase that occur in complex electromagnetic fields formed by the precise interference of coherent waves, which provide an advanced method for far-field super-resolution imaging beyond the diffraction limit [10, 11]. To generate optical super-oscillation, the complicated lens design methods [12-14] or Fresnel zone plate (FZP) optimization design methods, including optimizing algorithms [15-18] or optimization-free algorithms [19, 20], have been proposed. However, the existing super-oscillatory focusing-based imaging devices still have limited performance as follows: (1) strong side-lobes resulting in a small field of view (FoV) [12, 15, 20], (2) short working distances [13, 15, 16, 19], (3) limited depth-of-focus (DoF) [15, 17, 18, 21], and (4) chromatic aberration caused by wavelength-dependent phase retardation [13, 14, 19, 22], which dramatically limit their applications.\nThe performance limitations of the existing super-oscillatory imaging methods are mainly due to the optimization with 2D optical field constraints with limited modulation element numbers or only ring-structured phase modulation, which substantially limits the degree of freedom in design space for optimizing the performance. For example, the conventional super-oscillatory lens design methods, such as the pinhole array mask [11] or FZPs [17], require the following steps. The prolate ellipsoid function or Strehl ratio is first used as the optimization function of the model. Then, the phase distribution of the super-oscillatory lens is optimized with the constraints of full width at half maximum (FWHM) of the super-oscillatory spot $I(x_i,y_i)$ at the 2D position of $(x_i, y_i)$, and the side-lobes intensity $I_{\\sum_j(x_j,y_j)}$ at a combination of the 2D positions $(x_j,y_j)$ in the local FoV expressed by the distance $r$ between the super-oscillatory spot and side-lobes, as shown in Fig. 1(b). The above optimization method can only achieve the design of a pinhole array mask with a limited element number or a simple FZP with the ring-structured phase modulation of 0 or 1, while the optimization process requires a very complex formula decomposition process."}, {"title": "2 Methods", "content": "Here, we propose constructing the super-oscillatory diffraction neural networks, i.e., SODNN, that generate optical super-oscillation in 3D and achieve super-resolution imaging beyond diffraction limits. SODNN is constructed by utilizing diffractive layers to implement optical interconnections and imaging samples or biological sensors to implement nonlinearity, as shown in Fig. 1(a). SODNN modulates the incident optical field to create optical super-oscillation effects in 3D space and generates the super-resolved focusing spots or optical super-oscillatory needle, as shown in Fig. 1(c). The diffraction limit of existing photonic neural network systems is due to training neural networks without exploring the super-oscillatory effects. By constructing the large-scale SODNN that optimizes the optical coefficients of a stack of diffractive layers to modulate the optical field in 3D space, we can generate super-oscillation at any local regions without side-lobes across the FoV and with long working distance, long DoF, and achromatic spots for high-performance super-resolution imaging.\nThe forward model of SODNN is based on the angular spectrum representation. The complex-valued coherent input optical field $U_{\\lambda_k}$ at the wavelength $\\lambda_k$ ($k = 1, 2, ..., N$) are transformed by SODNN before the detection. We consider the diffractive modulation layers of SODNN in this work with the complex transform function of $M_{\\lambda_k} (\\Delta H, z_i)$ that modulates the incident optical field to the output optical field at the plane with a distance of $z_i$. Here, $\\Delta H$ represents the relative height map of the diffractive elements in SODNN to generate optical path difference and modulate the phase $\\phi_{\\lambda_k}$ of incident optical field, which can be formulated as $\\Delta H = \\lambda_k \\Phi_{\\lambda_k}/2\\pi \\Delta \\eta_{\\lambda_k}$ with $\\Delta \\eta_{\\lambda_k}$ being the wavelength-depended material refractive index. Then, the output optical fields at the wavelength $\\lambda_k$ at the output plane with a distance of $z_i$ can be formulated as $U_{\\lambda_k}(z_i) = M_{\\lambda_k}(\\Delta H, z_i)U_{\\lambda_k}$, and the detector measures the intensity distribution of output optical fields that can be formulated as a nonlinear function such as the square of the complex optical field: $I_k (z_i) = |U_{\\lambda_k} (z_i)|^2 = |M_{\\lambda_k} (\\Delta H, z_i) U_{\\lambda_k}|^2$. As the relative height map of each diffractive modulation layer is the same under different wavelength channels, the above model can effectively eliminate chromatic aberration caused by wavelength-dependent phase retardation [23]. For the multi-wavelength SODNN, the total intensity distribution of different wavelengths at the output plane can be formulated as the superposition of detected intensity distribution at each wavelength: $I(z_i) = \\sum_{\\lambda_k} I_{\\lambda_k} (z_i)$.\nThe SODNN is optimized with the 3D optical field constrain, which optimizes the shape of the super-oscillatory focusing spot within a certain distance range $z_i \\in [f-\\Delta f, f+ \\Delta f]$ before and after the focal plane with a focal length of $f$. The ideal super-oscillatory focusing spot $I(x_i,y_i,z_i)$ at a position in the 3D space with coordinates $(x_i, y_i, z_i)$ at the output plane with a distance of $z_i$ would have a maximized energy focused spot $I(x_i,y_i,z_i)$ and minimized light intensity side-lobes $I_{\\sum_j(x_j,Y_j,z_i)}$ at a combination of position coordinates $\\sum_j (x_j, Y_j, z_i)$. Taking the ideal output light intensity as the optimization direction with the entire 3D optical field constraints, the SODNN performs the function of a neuromorphic photonic processor that utilizes weighted optical diffractive interconnections of massively diffractive neurons to achieve the desired optical super-oscillatory function. Besides, we further design the constraint to maximize the energy transmission efficiency of super-oscillatory regions by minimizing the optical energy outside the super-oscillatory regions. Therefore, the"}, {"title": "3 Results", "content": "We first validate the effectiveness of the 3D optical field constrain optimization of SODNN in achieving super-oscillatory spots without side-lobes to realize large FoV at the designed long focal length $f$, as shown in Fig. 2(a) and Fig. 2(b). Each optical diffractive element size was set to $\\lambda/2 \\times \\lambda/2$ where X is the wavelength of input coherent light and $\\lambda$=632.8 nm. We designed a 1-layer SODNN by setting the modulation element number to 2500 \u00d7 2500, corresponding to the network layer size of 0.79 mm \u00d7 0.79 mm. The selection of the above parameters is determined according to the performance analysis of SODNN, as discussed in Section 4.2. The proposed system forms a super-oscillatory focused spot with almost no side-lobes at a long focal length $f = 250 \\mu m(\\sim 400\\lambda)$, with a FWHM of 258 nm ($\\sim$ 0.407$\\lambda$, see the middle of Fig. 2(a) and the lower left of Fig. 2(b)). Recent achievements of the super-oscillatory lenses compared with SODNN are shown in Section 4.1, which demonstrates the extraordinary performance of SODNN.\nIt can be found that optimizing the SODNN only at a designed focal length $f$ (that is $\\Delta f = 0$ in Eq. (1)), SODNN can maintain the morphology of the super-oscillatory focus spot and avoid the appearance of side-lobes at the designed position, once it exceeds this distance, the side-lobes will appear immediately accompanied by smaller FWHM and weaker super-oscillatory focusing spot intensity. For example, at four different focal lengths $f \u2013 2\\Delta f$, $f \u2013 \\Delta f$, $f+ \\Delta f$, and $f+ 2\\Delta f$ where $\\Delta f = 0.25 \\mu m$, we found that the side-lobes appeared and the FWHM was reduced to 206 nm($\\sim$ 0.325$\\lambda$), 246 nm($\\sim$ 0.388$\\lambda$), 246 nm($\\sim$ 0.388$\\lambda$), and 206 nm($\\sim$ 0.325$\\lambda$), respectively, as shown in Fig. 2(a) and Fig. 2(b). For the out-of-focal planes, the intensity of the side lobes increases exponentially with respect to the central spot as the central spot size decreases, demonstrating the high quality of optical sectioning of the SODNN for imaging.\nIn order to maintain the profiles of super-oscillatory light spots within a long DoF range, that is, to form a super-oscillatory light needle, we optimize the shape of the super-oscillatory focusing spot within a certain distance range $[f \u2013 6\\Delta f, f+ 60f]$ before and after the focal length $f$ as shown in Fig. 2(c), Fig. 2(d) and Fig. 2(e). Each optical diffractive element size was set to $\\lambda/2 \\times \\lambda/2$ where $\\lambda = 632.8 nm. We evaluate the performance of 1-layer SODNN by setting the modulation element number to 1500 \u00d7 1500, corresponding to the network layer size of 0.47 mm \u00d7"}, {"title": "3.1 Numerical Evaluations", "content": "0.47 mm. We set the range of the 3D optical field constrain optimization space $z_i \\in [f\u2212 6\\Delta f, f+ 6\\Delta f]$ where $f = 100 \\mu m$ and $\\Delta f = 0.5 \\mu m$. We found that an optical super-oscillatory needle was formed within a long DoF of 6 \\mu m ($\\sim$ 10$\\lambda$, see Fig. 2(d)). The optical super-oscillatory needle was further tested by selecting 7 positions in the range $[f- 6\\Delta f, f + 6\\Delta f]$ with 2$\\Delta f$ as the sampling interval (see the slices of the optical super-oscillatory needle in Fig. 2(e) and the FWHM in Fig. 2(c)). It can be found the optical super-oscillatory needle has uniform light intensity and consistent FWHM (250 nm \u00b1 3 nm) in the designed DoF."}, {"title": "4 Discussion", "content": "Table 1 shows several typical achievements of super-oscillatory design compared with SODNN. SODNN can achieve a long working distance with hundreds of micrometers,"}, {"title": "4.1 Comparisons with State-of-the-art Methods", "content": "while the other works can only achieve a short working distance with only tens of micrometers. In terms of working distance, SODNN has improved by an order of magnitude. SODNN can also achieve a DoF greater than 6 \u00b5m, and the ratio of FWHM to Rayleigh diffraction limit is less than 60%, which demonstrates the extraordinary performance of SODNN."}, {"title": "4.2 Performance Analysis of SODNN", "content": "We evaluate and compare the network performance under different modulation element numbers, i.e., K \u00d7 K, K = 100, 200, 300, 500, 1000, and 2500 (Fig. 5(a)) when the number of layers is fixed at 1, and diffractive element size is 1/2 \u00d7 1/2. We also evaluate the network performance under different layer numbers when the modulation element numbers are fixed at 200 \u00d7 200 (Fig. 5(b)) and 300 \u00d7 300 (Fig. 5(c)), and the diffractive element size is 1/2 \u00d7 \u03bb/2. We also analyze the effects of changes in neuron size, i.e., the diffractive element size was set to 1/2 \u00d7 1/2, \u03bb \u00d7 \u03bb, 2\u03bb \u00d7 20 and 4 \u00d7 4X when the number of layers is fixed at 1 and modulation element number is 300 \u00d7 300 (see Fig. 5(d)). We found that as the number of layers increases and the number of neurons in each layer increases, the FWHM of the super-oscillatory spot without side lobes will gradually become smaller and stabilize at ~ 0.407\u03bb (Fig. 5(a) and Fig. 5(c)). It seems that the modulation element numbers have a greater impact than the layer numbers on the FWHM by comparing Fig. 5(b) and Fig. 5(c). When the modulation element numbers are small, no matter how the layer numbers increased, the FWHM of the super-oscillatory spot without"}, {"title": "4.3 Reconfigurable SODNN for Super-oscillatory Spot Scanning", "content": "SODNN can modulate the incident optical field to create optical super-oscillatory effects in any 3D space and generate the super-resolved focusing spots. By training a series of SODNNs and loading them into a reconfigurable device such as a spatial light modulator (SLM), we can achieve dynamic scanning of super-oscillatory spots. We designed a series of SODNNs by setting the modulation element number to 2500 \u00d7 2500 with the element size 1/2 \u00d7 1/2 and \u03bb = 632.8 nm, corresponding to the network layer size of 0.79 mm \u00d7 0.79 mm with the focal length f = 250 \u03bcm. The FWHM remains at 258 nm (~ 0.407\u03bb) and does not change with the position change of the super-oscillatory spots. Fig. 6 shows that SODNN can focus the super-oscillatory spots at even the four most edge locations of the detection plane, which proves that SODNN can realize scanning at any position on the detection plane."}, {"title": "4.4 Integrating SODNN with Optical Fiber", "content": "A more compact solution is to integrate SODNN with optical fiber to form an endoscope, as shown in Fig. 7(a), and collect the reflection signal of the super-oscillatory focusing spot from the measured target to complete the imaging process.\nUsing Lumerical FDTD to arrange a hypothetical observation plane at the input end of SODNN to capture the topography of the reflected light field, we found the metal structure produces strong reflection (see Fig. 7(c)) with the normalized light intensity 1 and the glass forms a weak reflection with the normalized light intensity ~ 0 (see Fig. 7(d)). Using the binary change of light intensity, we can also reconstruct the 500-line pair pattern of the measured resolution testing chart (see Fig. 7(b))."}, {"title": "5 Conclusion", "content": "In conclusion, we proposed the SODNNs that demonstrate unparalleled advantages over other techniques for the realization of super-oscillatory spots and imaging beyond the diffraction limit. SODNN makes it possible to flexibly design large FoV without side-lobes, long working distances, long DoF, and achromatic optical super-oscillatory functions. SODNNs can work at any wavelength, from microwaves to ultraviolet waves [27], which makes it possible to obtain super-oscillatory spots with smaller FWHM and further improve the resolution of SODNN imaging. We believe that this is a new cross-innovation in the fields of photonic neural networks, super-resolution microscopy, and metasurfaces, which will attract the attention of more scientists engaged in the development of intelligent optical instruments."}, {"title": "Disclosures", "content": "The authors declare no competing interests."}, {"title": "Code, Data, and Materials Availability", "content": "All relevant code is available from the corresponding author upon reasonable request."}]}