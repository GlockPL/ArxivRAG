{"title": "Ex3: Automatic Novel Writing by Extracting, Excelsior and Expanding", "authors": ["Lei Huang", "Jiaming Guo", "Guanhua He", "Xishan Zhang", "Rui Zhang", "Shaohui Peng", "Shaoli Liu", "Tianshi Chen"], "abstract": "Generating long-term texts such as novels using artificial intelligence has always been a challenge. A common approach is to use large language models (LLMs) to construct a hierarchical framework that first plans and then writes. Despite the fact that the generated novels reach a sufficient length, they exhibit poor logical coherence and appeal in their plots and deficiencies in character and event depiction, ultimately compromising the overall narrative quality. In this paper, we propose a method named Extracting Excelsior and Expanding. Ex3 initially extract structure information from raw novel data. By combining this structure information with the novel data, an instruction-following dataset is meticulously crafted. This dataset is then utilized to fine-tune the LLM, aiming for excelsior generation performance. In the final stage, a tree-like expansion method is deployed to facilitate the generation of arbitrarily long novels. Evaluation against previous methods showcases Ex3's ability to produce higher-quality long-form novels.", "sections": [{"title": "1 Introduction", "content": "The realm of automatic long-form novel generation through artificial intelligence holds significant appeal both in academic and practical domains, yet has posed persistent challenges for a long time. This demands not only solid language expression ability (Stede, 1996; Yang et al., 2022) but also strong logical thinking and organizational skills to conceive an appealing and coherent storyline.\nIn recent times, large language models (LLMS) possess excellent language expression ability and basic common sense reasoning skills, thus leveraging LLMs for narrative generation is promising. However, generating long novels is still challenging, because of the inherent fixed-size context design in the Transformer architecture. Some works (Yang et al., 2022, 2023; Zhou et al., 2023) propose the hierarchical generation approach, where general-purpose LLMs are used to directly generate outlines, and followed by subsequent prompts to generate novels in accordance with the previously devised outlines. Despite being able to produce novels that are sufficiently long, these methods have issues with the logical coherence and appeal of the storyline and the deficiencies in character and event depiction, resulting in novels that appear highly unnatural. The reason is that the general-purpose LLM has insufficient planning and linguistic capabilities in the field of novel writing, which cannot be solved simply by prompt engineering. We believe that designing AI writing systems should not only consider how people write but also how people learn to write.\nHow do human writers learn to construct reasonable storylines and improve their linguistic capacity? Reading is one of the best ways to become a better writer. The more you read and summarize, the better you will write. Inspired by this, we propose to learn organization skills and linguistic capacity from human writing. We first organize outlines from existing novels and then conduct the reverse process, that is, creating an outline and developing the outline into a novel. It's like a regular rewriting exercise that writers do.\nIn particular, we propose the Extract Excelsior and Expand framework (Ex3) to automatically construct storyline by learning from raw novels, and generate new novels that imitate the linguistic style of a specific genre. Ex3 first Extracts structural information from the raw novel data using self-instructing method. In order to obtain different levels of structure information, we divide the text into sections according to content similarity. Additionally, we utilize entity extraction techniques to develop rich profiles of the characters, further enhancing the narrative's depth and coherence. In"}, {"title": "3 Extract, Excelsior, and Expand", "content": "This section introduces the proposed Extracting Excelsior and Expanding (Ex3) framework. As"}, {"title": "3.1 Extracting", "content": "Based on the raw text of the novel, we can reverse-engineer the hierarchical structure information, so as to reconstruct the logical layout and narrative design of the novel's storylines. We use a Grouping and Summarizing approach to extract hierarchical structure information from bottom to top. In this approach, Grouping refers to aggregating consecutive texts with high relevance into a group, as we believe these texts are more likely to come from the same outline. Summarizing refers to extracting a higher-level outline of each text group. In this section, we'll introduce the text grouping method based on semantic similarity, as well as the processes of chapter summarizing and constructing structure information for the entire novel text. Moreover, to ensure the logical coherence of key contextual information, we propose the entity information extraction method.\nGroup the text by Similarity. The window length of a large language model is limited, and it cannot process an entire novel as input at once. Therefore, we need to split the novel text into smaller parts. However, using a fixed-length window for splitting would significantly disrupt the integrity of the text information and semantic logic. To address this issue, we propose a text grouping method based on semantic similarity.\nIn the process of writing a novel, the stories or scenes unfold in an orderly manner, similar to the progression of shots in a movie. We have noticed that there is a higher semantic relevance between consecutive paragraphs belonging to the same \"shot\". When there is a transition in the story or scene, the semantic similarity between paragraphs decreases to a lower value. Based on this characteristic, we use text semantic similarity to measure the correlation between paragraphs and group the text according to the story or scene, without compromising the coherence of the semantic information.\nThe process is shown in Figure 2. Firstly, we calculate the semantic similarity between all adjacent paragraphs in the text. Then, a paragraph window is created based on a length range. Within each window, we select the two paragraphs with the lowest similarity as the partition points. Next, we apply the same operation to the remaining text until the entire article is divided into multiple groups of paragraphs. This method takes paragraphs as the smallest unit and groups the stories or scenes in the text while maintaining semantic integrity. The length range controls the granularity of information in each group, making the partitioning process more flexible.\nSpecifically, We embed the paragraphs with a pre-trained CoSENT model (Xu, 2023) and then"}, {"title": "3.2 Excelsior", "content": "During the Extracting process, we form tree-like structure information from the novel text in a reverse manner. To endow the large language model with the linguistic style of a novel and enable it to learn text expansions at different hierarchical levels, we develop five distinct categories of prompts, as shown in Figure 6, to construct corpora for supervised fine-tuning. These instruction formats of the corpora contain all the instruction formats required by the LLM in the Expanding stage. The writing assistant will maintain contextual consistency through the previous outline, current outline and historical knowledge about relevant entities during the Expanding process.\nWe collect approximately 800 web novels from the internet, covering genres such as fantasy, sus-"}, {"title": "3.3 Expanding", "content": "To enable large-scale models to fully leverage the structure information for expansive writing and track important entity information during text generation, we employ a depth-first writing mode (Figure 7. In this mode, the theme and hierarchical depth of the novel are manually specified, where the theme determines the writing style, and the depth indirectly controls the final length of the generated text. Afterward, the writing assistant output the novel title and introduction. However, users also have the option to provide their own titles and introductions if necessary. The subsequent writing process will be fully automated until a complete novel is written. During the writing process, the fine-tuned writing assistant is responsible for text expansion, while another general-purpose large language model handles entity extraction and updates the entity information database along with the text generation.\nDuring the expansion of intermediate-level outlines, in accordance with the depth-first generation process, the expansion of the subsequent outline node can only commence after the subtree beneath the current outline node has been completely written. This meticulous approach guarantees the logical coherence of entity information within the generated outlines.\nWhen it comes to the expansion of chapters, each chapter contains several paragraph group outlines. The writing assistant sequentially generate the main text of the chapter based on these paragraph group outlines. We utilize the outline of the current paragraph group to extract entity names for knowledge collection. After generating the main text, we use the collected knowledge and the generated text to update the entity information database.\nIn this depth-first tree-like generation process, the leaf nodes represent the main text of the new novel. By sequentially integrating the text, we can obtain a complete and entirely new novel that is fully generated by the writing assistant."}, {"title": "4 Evaluation", "content": "Experiment Setup. Our approach has the capability to generate a long-form novel by giving a short premise. To evaluate the effectiveness of Ex3, we compare the novels generated by Ex3 and other baselines by inputting the same premise, similar to the setup in the Yang et al. (2023).\nMethod Instantiation We select 20 high-quality premises as input, which are chosen from real novel data and will not appear in the training dataset. The length of these premises ranges from 60 to 120 words, covering various genres including science fiction, fantasy, mystery, and romance. The length of the generated novels by Ex3 can be very long, which was not observed in the previous baseline experiments. To compare as fairly as possible with previous work, we reference the novel length in the RECURRENTGPT baseline (Zhou et al., 2023) and design two sets of novels with different lengths for experimentation. We generate a set of long-length novels (~10k words) and a set of medium-length novels (~4k words) respectively, where each word means a Chinese character."}, {"title": "5 Ablation Study", "content": "Ablated Modules. In order to better understand the effect of different components in Ex3 on the quality of the generated novels, we set up ablation experiments for different components. The ablation experiment for the setup is shown below:\n1. NO-TRAIN: A version that skips the extracting and excelsior stages and uses the original BaiChuan2-13B-Chat model to generate novels.\n2. NO-ENTITY: A version that does not use the entity extraction module to generate novels.\nResults. As shown in Table 3, Ex3 exhibits significant advantages over NO-TRAIN across all metrics, indicating the critical contribution of the fine-tuned LLM to the generation of long novels that are well-liked by human readers. In comparison to NO-ENTITY, although Ex3 performs relatively equally or slightly inferior in terms of Diction and Interesting metrics, it still maintains significant advantages in other metrics, suggesting a positive impact of the entity extraction module on enhancing the coherence of roles plots in generated novels. we also examine the output of the intermediate steps in our method and provide the results in Appendix G."}, {"title": "6 Conclusion", "content": "In this paper, we present Ex3, an automatic novel writing framework. Ex3 first automatically extracts structure information by learning from raw novel data and then creates an instruction-following dataset with this structure information and the novel data. Subsequently, this dataset is employed to fine-tune the LLM for excelsior generation performance. With the tuned LLM, Ex3 employs a tree-like expansion method to generate arbitrarily long novels. The experiment results demonstrate that Ex3 is able to produce higher-quality long-form novels than previous methods."}, {"title": "Limitations", "content": "Our proposed framework, Ex3, effectively learns novel structures and language styles from raw novel data, enabling the generation of sufficiently long novels across various genres. In our experiments, we compared Ex3 with other mainstream long-novel generation frameworks and found it to outperform them on multiple metrics. However, Ex3 also has some limitations.\nWhile Ex3 controls the length of the generated text by adjusting the number of hierarchy levels, we were unable to comprehensively evaluate its performance on longer novels due to time and resource constraints. Additionally, our training and generation primarily focused on Chinese novels, and further testing is needed to assess the performance of Ex3 on novels in other languages. In terms of the mechanism process, the initial outline generated may have some shortcomings, and introducing an auditing and revision mechanism could enhance the coherence and brilliance of the novels. It is worth mentioning that in the Expanding process, the expansion of the outline is fully transparent and modifiable for the user, allowing for interactive generation. However, we did not explicitly mention this in the main text.\nTo address these limitations, our future work will focus on optimizing the mechanism, expanding to multiple languages, and exploring interactive generation modes to further enhance our research."}, {"title": "Ethics Statement", "content": "Large language models can produce false and harmful content. In this article, we use audited human novel data to fine-tune the LLM, reducing the potential for harmful content. In addition, abuse of the automatic novel generation system can also have a bad effect on the field of novel writing, so the application of the system may require censorship and restraint."}, {"title": "A Details on Extract Stage", "content": "In the Extract stage, we use similarity to measure the relationship between texts, with the similarity calculation performed using the text2vec-base-chinese-paraphrase model (Xu, 2023). Additionally, we construct hierarchical structure information by summarising, and employ entity extraction methods to track the development of important characters in real time. For these two tasks, we have chosen the BaiChuan2-13B-Chat (Baichuan, 2023), which has shown outstanding performance in Chinese. We have designed appropriate prompts to automate these two processes.\nIn the Excelsior stage, we have designed several distinct prompts to differentiate information across different levels.\nMain Text: \"Please provide a brief summary for the following paragraph group plot:part of the main text\";\nChapters: \"Please provide a brief summary for the following chapter plot, trying to cover the overall plot:the text obtained by integrating the summaries of each text group in the chapter\";\nLevels: \"Please summarize the main plot of the following content in one paragraph, trying to cover the overall plot:the text obtained by aggregating the outline group of the previous level\";\nNovel: \"Please provide a summary of the main story plot for the following content, trying to cover the overall plot:the text to be integrated into a novel summary obtained by Recursively Summarizing method\"."}, {"title": "B Details on Excelsior Stage", "content": "For fine-tuning the LLM, we use an open-source pytorch framework (hiyouga, 2023). As for devices, we use four nodes, each with eight NVIDIA A100 80G. We fine-tune the model with the batch size of 256, the learning rate of 5e-5, the weight decay of le-4 for 2 epoch."}, {"title": "C Details on Expand Stage", "content": "We have designed different prompts for different levels to differentiate them, as illustrated in Excelsior. In this section, we take the generation process of a novel by setting the level depth to 1 to provide detailed prompts and outputs for each process.\nNovel Title:Wudang Sword Immortal Song Qingshu\nNovel Introduction: The story begins with Song Qingshu's time travel to the Blue Star. He becomes a disciple at Wudang Mountain and excels in martial arts, becoming a formidable warrior. As he resolves conflicts among the martial arts communities, Song Qingshu gradually finds himself entangled in a web of grudges and disputes. Faced with the temptation of demonic influences, he chooses to relinquish the Forbidden Evil Sword Manual and joins forces with the sect leader Zhang Sanfeng to confront the Shaolin monks. Meanwhile, the encounter between Huashan disciple Linghu Chong and Hengshan disciple Yi Lin further complicates the martial world relations."}, {"title": "C.1 First Outline Expansion", "content": "Prompt You are now a writer of martial arts, fantasy, and mystery novels, currently working on a book titled \"Sword Immortal Song Qingshu of Wudang.\" Based on the novel introduction provided, please create an outline for the story while ensuring the coherence of the plot. Novel Introduction: The story begins with Song Qingshu's time travel to the Blue Star. He becomes a disciple at Wudang Mountain and excels in martial arts, becoming a formidable warrior. As he resolves conflicts among the martial arts communities, Song Qingshu gradually finds himself entangled in a web of grudges and disputes. Faced with the temptation of demonic influences, he chooses to relinquish the Forbidden Evil Sword Manual and joins forces with the sect leader Zhang Sanfeng to confront the Shaolin monks. Meanwhile, the encounter between Huashan disciple Linghu Chong and Hengshan disciple Yi Lin further complicates the martial world relations.\nOutput Part 1: This part tells the story of Song Qingshu's journey to the Blue Star, his apprenticeship and training at Wudang Mountain, and his involvement in the martial arts conflicts. Throughout this process, Song Qingshu grows and becomes a martial arts master, resolving conflicts within the martial world. However, he also gets entangled in various grudges, including conflicts with his master, a love affair with a woman in red, and battles with martial artists. When faced with the temptation of demonic music, Song Qingshu chooses to give up the Forbidden Evil Sword manual and joins his master Zhang Sanfeng in opposing the Shaolin monks, thus upholding martial peace.\nPart 2: This part tells the story of Huashan disciple Linghu Chong's encounter with Hengshan disciple Yi Lin and their adventures in the martial"}, {"title": "C.2 Chapter Arrangement of Part 1 (Opening Part)", "content": "Prompt You are currently a martial arts, fantasy, and mystery novelist working on a book titled \"Song Qingshu, the Sword Immortal of Wudang.\" Building upon the previous storylines, historical information about characters or locations is as follows: None. Summary: This part tells the story of Song Qingshu's journey to the Blue Star, his apprenticeship and training at Wudang Mountain, and his involvement in the conflicts of the martial world. Throughout this process, Song Qingshu continuously grows and becomes a formidable martial artist, resolving conflicts through his interactions with martial artists. However, he also becomes entangled in various grudges, including conflicts with his master, a love affair with a woman in red, and battles with martial artists. When faced with the temptation of demonic music, Song Qingshu chooses to abandon the Forbidden Evil Sword manual and joins his sect leader Zhang Sanfeng in opposing the Shaolin monks, thus upholding martial peace.\nOutput Chapter 1: Song Qingshu travels to a planet called the Blue Star and undergoes a series of adventures before becoming an apprentice at Wudang Mountain. At Wudang Mountain, he gains attention due to a dragon turtle egg and learns Taoist spells and martial arts from his master. During this time, he also encounters a mysterious woman, and they fall in love. Song Qingshu cultivates at Wudang Mountain, mastering the essence of Taoism, and becomes a renowned martial artist.\nChapter 2: As a young man, Song Qingshu joins the Three Emperor Cannon Fist Sect in search of the mysterious woman, and through enduring hardships, he becomes an exceptional martial artist. Along the way, he befriends He Tianhua and together they overcome challenges and resolve grudges. Song Qingshu becomes a respected hero in the martial world.\nChapter 3: Song Qingshu becomes entangled in a series of complex martial conflicts,"}, {"title": "C.3 Chapter Arrangement of Part 3 (Ending Part)", "content": "Prompt As a martial arts, fantasy, and mystery novelist, you are currently writing a novel titled \"Song Qingshu, the Sword Immortal of Wudang.\" Building upon the previous storylines and historical information of relevant characters and locations, here's an expanded plot based on the provided summary. Previous Storylines: The encounters between Huashan Sect disciple Linghu Chong, Hengshan Sect female disciple Yi Lin, and their adventures in the martial world are depicted. The conflicts between Wudang disciple Song Qingshu and Dongfang Bubai are recurring themes. Throughout these events, the shifting power dynamics in the martial arts world, intricate character relationships, and entanglements of Jianghu grievances are showcased. Song Qingshu emerges victorious in his duel against Dongfang Bubai, unraveling the story of Lin Yuantu while also revealing Duan Yu's true identity. In this world full of Jianghu feuds, various heroes make their appearances, embodying the true essence of martial arts and the demeanor of"}, {"title": "C.4 Plot Arrangement of Chapter 1 (Opening Chapter)", "content": "Prompt As a martial arts, fantasy, and mystery novel writer, you are writing the opening plot of a novel called \"Wudang Sword Immortal Song Qingshu\". Please expand the opening plot according to the outline of the opening chapter. Opening chapter outline: Song Qingshu traveled to a planet called Blue Star and after experiencing a series of adventures, he apprenticed at Wudang Mountain. In Wudang Mountain, he attracted attention to a dragon turtle egg and learned Taoist spells and martial arts from his master. At the same time, he also met a mysterious woman, and the two fell in love. Song Qingshu practiced at Wudang Mountain, mastered the essence of Taoism, and became a generation of martial arts masters.\nOutput Plot 1: A young man named Song Qingshu traveled to a planet called Blue Star, where he experienced many adventures and challenges. By chance, he obtained a mysterious dragon turtle egg, which brought about a revolutionary change in his life. He was adopted as a disciple by a Taoist from Wudang Mountain and began his path of cultivation. Song Qingshu practiced at Wudang Mountain and gradually mastered the essence of Taoism. During this process, he experienced many wars and adventures, demonstrating his bravery and wisdom."}, {"title": "C.5 Plot Arrangement of Chapter 9 (Ending Chapter)", "content": "Prompt As a writer of martial arts, fantasy, and mystery novels, you need to wrap up the story of \"Sword Immortal Song Qingshu of Wudang.\" The provided outline includes the synopsis of previous chapters, historical information about relevant characters or locations, and an outline for the concluding chapter. Now, let's expand on the plot for the final chapter. Previous Chapter Outline: Wudang disciple Song Qingshu encounters obstacles from various major sects and goes through numerous adventures and challenges. He clashes with Xiao Yunling, who disguises herself as a man, and during his search for her true identity, he discovers her secret. Meanwhile, he also enhances his cultivation through interactions with a mysterious woman. Throughout this journey, he coincidentally reunites with his childhood sweetheart, Mu Wanqing, during a mission to punish evildoers. Together, they face numerous battles and challenges. Song Qingshu successfully improves his cultivation and showcases his formidable strength in battles against enemies. Historical Information about Characters or Locations: Song Qingshu | A highly skilled martial artist; rescued his hometown girl, Liu Susu, from bandits. Developed feelings for Liu Susu but faced numerous obstacles, leading to their separation. Has a friendly relationship with the villagers at the foot of Huangzi Mountain. Childhood friends with Mu Wanqing and reunites with her during a chance encounter in a fight. Mu Wanqing | Song Qingshu's childhood sweetheart; admires Song Qingshu.Duan Yu | Prince of Dali Kingdom; initially meets Song Qingshu and they exchange insights. Later, Duan Yu saves Song Qingshu from a dire situation involving the Ghost King of Dragon Gate. Linghu Chong | Disciple of Huashan sect; meets Yi Lin and may have a connection with Dongfang Bubai. Yi Lin | Female disciple of Huashan sect; meets Linghu Chong and expresses her purpose of finding companions. Concluding Chapter Outline: Wudang disciple Song Qingshu became embroiled in a conflict involving major martial sects, including Lingjiu Temple and the Demon Cult. Simultaneously, his romantic relationship with childhood sweetheart Mu Wanqing gradually deepens. In the midst of this turmoil, Song Qingshu demonstrates his leadership abilities and sense of justice, striving to protect peace in the martial world. However, he also faces a challenge from the Shaolin Temple, particularly regarding the question of justice and evil raised by the eminent monk Yuan Kong. Song Qingshu must provide a satisfactory answer within seven days, or face punishment. He displays his wisdom, courage, and determination, earning the respect of those around him. In terms of his romantic relationship, he and Mu Wanqing face various hardships but ultimately decide to spend their lives together.\nOutput Plot 42 This section tells the story of Wudang disciple Song Qingshu and his childhood sweetheart, Mu Wanqing, as well as the events involving his fellow disciples. Due to a misunderstanding, Song Qingshu is falsely accused of murder and escapes with Zhang Long. Along the way, they encounter figures like the Golden Snake King, who reveals the truth and informs them that Mu Wanqing is being pursued. As they search for Mu Wanqing, their feelings for each other deepen. Meanwhile, the forces of good and evil engage in a fierce battle for the \"Star Finger Technique,\" and Song Qingshu strives to protect the peace of the martial world.\nPlot 43 A group of martial artists finds themselves in a dilemma amidst the conflict between the Demon Cult and Lingjiu Temple. At this moment, Wudang disciple Song Qingshu proposes leading his fellow disciples to maintain order. With an increasing number of martial artists joining them, the situation gradually comes under control. How-"}, {"title": "C.6 The Main Writing of the Plot 1 (Opening Plot)", "content": "Prompt You are writing the opening paragraph for your martial arts, immortal chivalry, and suspense novel \"Wudang Sword Immortal Song Qingshu\". Please expand the opening content from a third-person perspective based on the plot outline of the opening paragraph. Plot Outline: A young man named Song Qingshu traveled to a planet called Blue Star, where he experienced many adventures and challenges. By chance, he obtained a mysterious dragon turtle egg, which brought about a revolutionary change in his life. He was adopted as a disciple by a Taoist from Wudang Mountain and began his path of cultivation. Song Qingshu practiced at Wudang Mountain and gradually mastered the essence of Taoism. During this process, he experienced many wars and adventures, demonstrating his bravery and wisdom.\nOutput Perhaps, this is fate!\nBlue Star is a mysterious and beautiful planet. It is 120 light-years away from Earth. Here, the four seasons are distinct, the scenery is beautiful, the resources are abundant, and there are completely different biological species from the Earth.\nOn the Blue Star, there is a large lake called Bailang Lake. Surrounded by mountains and lush trees, the lake is surrounded by tens of thousands of acres of fertile land at the foot of the mountains. The water in the lake is clear and sandy white, like a huge mirror at the same time. There are many waterfowl in the lake, leisurely wandering on the water surface.\nOn one side of the lake, there is a small island called Longgui Island. The island is shaded by green trees, with blooming flowers. In the center of the island, there is an ancient well, which is said to be the oldest ancient tree on the island. This ancient well is said to have gone through millions of years. There is a stone tablet next to the well with three lines of characters engraved on it, but it is already blurry and unrecognizable.\nAt noon on this day, the sun was hanging high in the sky. After a sudden loud bang, an object fell straight down from the sky, passing through the dense forest and crashing into the grass by the ancient well with a loud bang.\nA large pit was dug up in the grass, and something lay at the bottom of the pit.\nIn this time and space, another person fell, in his thirties, tall and majestic, with thick eyebrows and big eyes, beards on his cheeks, and wearing a blue Taoist robe. The person fell to the bottom of the pit, looked up at the sky and murmured to himself, \"Finally back, ten years! Ten years!\" Then he hugged his head and rolled painfully on the ground."}, {"title": "C.7 The Main Writing of the Plot 2 (Middle-Part Plot)", "content": "Prompt You are currently writing the main body of the martial arts, immortal, and suspense novel \"Wudang Sword Immortal Song Qingshu\". Please contact the previous summary and historical information about the characters or locations, and expand the paragraph content from a third-person perspective based on this abstract. Previous summary: A young man named Song Qingshu traveled to a planet called Blue Star, where he experienced many adventures and challenges. By chance, he obtained a mysterious dragon turtle egg, which brought about a revolutionary change in his life. He was adopted as a disciple by a Taoist from Wudang Mountain and began his path of cultivation."}]}