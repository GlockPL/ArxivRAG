{"title": "MDD-5k: A New Diagnostic Conversation Dataset for Mental Disorders Synthesized via Neuro-Symbolic LLM Agents", "authors": ["Congchi Yin", "Feng Li", "Shu Zhang", "Zike Wang", "Jun Shao", "Piji Li", "Jianhua Chen", "Xun Jiang"], "abstract": "The clinical diagnosis of most mental disorders primarily relies on the conversations between psychiatrist and patient. The creation of such diagnostic conversation datasets is promising to boost the AI mental healthcare community. However, directly collecting the conversations in real diagnosis scenarios is near impossible due to stringent privacy and ethical considerations. To address this issue, we seek to synthesize diagnostic conversation by exploiting anonymous patient cases that are easier to access. Specifically, we design a neuro-symbolic multi-agent framework for synthesizing the diagnostic conversation of mental disorders with large language models. It takes patient case as input and is capable of generating multiple diverse conversations with one single patient case. The framework basically involves the interaction between a doctor agent and a patient agent, and achieves text generation under symbolic control via a dynamic diagnosis tree from a tool agent. By applying the proposed framework, we develop the largest Chinese mental disorders diagnosis dataset MDD-5k, which is built upon 1000 cleaned real patient cases by cooperating with a pioneering psychiatric hospital, and contains 5000 high-quality long conversations with diagnosis results as labels. To the best of our knowledge, it's also the first labelled Chinese mental disorders diagnosis dataset. Human evaluation demonstrates the proposed MDD-5k dataset successfully simulates human-like diagnostic process of mental disorders. The dataset and code will become publicly accessible in https://github.com/lemonsis/MDD-5k.", "sections": [{"title": "Introduction", "content": "Mental health issues have garnered increasing attention in recent years. According to the statistics of World Health Organization (WHO), one in every eight people in the world lived with a mental disorder in 2019, and people living with anxiety and depressive disorders kept rising significantly because of the COVID-19 pandemic (Organization et al. 2022). With the recent progress of large language models (LLMs) (Ouyang et al. 2022; OpenAI 2024), which emerges capabilities of relevant context incorporation and human-like text generation, many researchers turn to building con-"}, {"title": "Related Work", "content": "Corpora of physician-patient conversations focused on mental health are crucial for AI mental healthcare research, especially in the large language model era. We divide current mental health datasets into three categories based on the degree of required professional knowledge. Emotional support datasets feature empathetic dialogue and comfort. ESconv dataset (Liu et al. 2021) consists of 1300 conversations covering 10 topics. SoulChatCorpus (Chen et al. 2023b) contains over 2 million single-turn and multi-turn conversations generated by ChatGPT. Psychological counseling datasets typically contain more domain knowledge than common emotional support dataset. The Emotional First Aid Raw dataset (Wang 2024) is built by crawling from psychological counseling websites and communities. PsyQA (Sun et al. 2021) is a single-turn Chinese dataset annotated by human. SmileChat dataset (Qiu et al. 2024) expands PsyQA to multi-turn through ChatGPT. CPsyCounD (Zhang et al. 2024) contains 3134 counseling conversations generated by the same number of psychological counseling reports. Diagnosis datasets aim to simulate diagnostic conversation of professional psychiatrists. D\u2074 (Yao et al. 2022) is a Chinese depression diagnosis dataset built by human annotators and supervised by psychiatrists. There are also some medical dialogue datasets, like MedDialog (He et al. 2020), MTS-Dialog (Ben Abacha et al. 2023), ChatDoctor (Li et al. 2023), which encompass a broader range of medical fields.\nWe mainly focus on the tuning-free prompting frameworks for mental disorders conversation simulation. Chen et al."}, {"title": "Methodology", "content": "The synthesis process of mental disorders diagnostic conversations is presented. The neuro-symbolic multi-agent framework features one-to-many patientcase-to-dialogue generation, indicating multiple generated conversations are based on the same patient case. As shown in Figure 2, the framework basically involves the interactions among a doctor agent, a patient agent, and a tool agent. All the agents are played by large language models (LLMs). The doctor agent controlled by a dynamic diagnosis tree leads the diagnostic topic shift of the whole conversation. The patient agent responds to the doctor agent based on the preprocessed patient case and fictitious patient experience generated by the tool agent. The tool agent is also responsible for the several symbolic operations of dynamic diagnosis tree."}, {"title": "Patient Cases Preprocessing", "content": "The quality of patient cases is vital to the diagnostic conversation synthesis. We cooperate with a pioneering psychiatric hospital and obtain over 1000 real cases of patients with mental disorders. All these patient cases have undergone data masking to prevent the leakage of sensitive personal information. The data masking process follows the standards below: (i) Private information of patients (e.g. name, date of birth, date of examination, etc.) is removed from the patient case. (ii) Patient age is rounded to the nearest ten. For example, the age of a 24-year-old patient is 20 on the pre-processed patient case. (iii) All the concrete locations are replaced with vague ones. The above preprocessing steps strictly follow the Chinese information security technology guide for health data security (GB/T 39725-2020). A complete cleaned patient case is illustrated in Appendix.\nAfter filtering repetitive or incomplete patient cases, the final version for diagnostic conversation simulation and dataset generation contains 1000 patient cases with age, gender, diagnosis and corresponding International Classification of Diseases (ICD-10) (Organization 2004) code, chief complaint, history of present illness, important past medical history, family history, personal history, mental examination, and treatment. As shown in Figure 2, the patient case is structurized as key-value pairs."}, {"title": "Fictitious Patient Experience Generation", "content": "We perform one-to-many patientcase-to-dialogue generation, which indicates one patient case will be applied to generate multiple diagnostic conversations. One key factor contributes to the diversity of generated conversations is the patient experience. It specifically refers to the past experiences that directly or indirectly lead to the mental illness problem of patients in this paper. The diagnosis of mental disorders differs from other illnesses in that it mainly depends on the conversations between psychiatrists and patients instead of physiological indices. Psychiatrists provide diagnosis result and treatment based on the acquired symptoms of patients during communicating. As a result, if the correspondence between symptoms and diagnosis can be assured, the correctness and quality of the synthesized diagnostic conversation is guaranteed and is not affected by detailed patient experience. In this sense, it's feasible to generate multiple patient experiences with one patient case for synthesizing multiple diagnostic conversations.\nLarge language model (LLM) is applied to generate fictitious patient experience. To avoid the counterfactual conflicts between fictitious patient experience and true patient case, gender, age, work and diagnosis (Dx) information from one patient case is extracted and serves as patient persona in the prompt for generating patient experience.\nPersona = Prompt(Gender, Age, Work, Dx) \\tag{1}\nIn Equation (1), the function Prompt indicates concatenating keywords into proper prompt. Next, we build knowledge graphs containing time, people, and concrete event that might cause mental disorders according to different patient age and gender. The example in Figure 2 shows the predefined knowledge graph for 20-year-old female. The triplet (Time, People, Event) is randomly selected from the graph for fictitious experience generation.\nFicExp = Prompt(Time, People, Event) \\tag{2}\nThe final patient experience (FicExp) is generated through LLM by combining patient persona.\nFicExp = LLM(Prompt(Persona, FicExp)) \\tag{3}"}, {"title": "Neuro-Symbolic Dynamic Diagnosis Tree", "content": "To imitate conversations in real scenarios where the psychiatrist leads the entire diagnostic process, we design a neuro-symbolic dynamic diagnosis tree to achieve diagnostic topic shift and controllable doctor response generation. The dynamic diagnosis tree consists of a symptom inquiry tree and an experience inquiry tree. As shown in the example of Figure 2, the symptom inquiry tree is fixed and built according to the Structured Clinical Interview for DSM-5 (SCID-5) (First 2014) and guidance from professional psychiatrists. It aims to cover inquiries about all the relevant symptoms to arrive at the final diagnosis of a patient. Considering the gender and age differences, the symptom inquiry tree is specially designed for male and female, teenagers (people under 20), adults (people aged between 30 and 50) and elders (people over 60). The example in Figure 2 shows the symptom inquiry tree for female teenager."}, {"title": "Experiment Setup", "content": "The MDD-5k dataset is generated through the neuro-symbolic multi-agent framework with 1000 real patient cases. 5 different fictitious patient experiences are generated by OpenAI gpt-40 (OpenAI 2024) based on 1 patient case, which leads to a total of 5000 experiences corresponding to the 5000 conversations in the dataset. We also create 5 doctors with different diagnosis habits, and 1 doctor will be randomly picked for generating each conversation in the dataset. Since the patient cases are still under the ethical review of psychiatric hospital, we randomly select 20 available patient cases and generate 100 conversations by gpt-40 for evaluation. The other 4900 conversations are currently generated by Qwen2-72B-Instruct (Yang et al. 2024a) deployed on NVIDIA A100-80G GPUs locally. We will apply gpt-40 for generating the rest 4900 conversations when the ethical review finishes."}, {"title": "Compared Datasets", "content": "As the evaluators' native language is Chinese, only Chinese datasets are considered to ensure the quality of human evaluation. Three datasets are selected as compared baselines.\n*   D\u2074 (Yao et al. 2022) is a Chinese dialogue dataset for depression diagnosis, which is conducted by collecting conversations between professional psychiatrists.\n*   CPsyCounD (Zhang et al. 2024) is a synthetic consultation dataset covering nine representative topics (e.g. marriage, education) and seven classic schools of psychological counseling (e.g. cognitive behavioral therapy).\n*   Direct Role-playing: To test the effectiveness of our designed multi-agent diagnostic conversation simulation framework, we directly apply role-playing LLMs (gpt-40) and generate 100 conversations with the same patient cases and prompts as MDD-5k for evaluation.\nWe haven't found any available open-source mental disorders diagnosis datasets besides D\u2074, so the consultation dataset CPsyCounD is chosen as baseline, which can also demonstrate the differences between psychological counseling and diagnostic conversation."}, {"title": "Evaluation Metrics", "content": "Human evaluation is conducted to fairly assess the quality of different datasets. Specifically, we design seven major metrics encompassing five different perspectives: professionalism, communication, fluency, similarity and safety. Professionalism measures if the psychiatrist can effectively collect all the required patient symptoms for diagnosis. Communication measures the psychiatrist's communication skills and the patient's response, including (i) Can the psychiatrist proactively ask patient for gathering key information and establish effective communication with the patients so that they are willing to share more information (e.g. daily life, past experiences) related to the mental illness problems? (ii) Can the patient engage in the diagnostic process and tell related information? Fluency contains two aspects of criterion: (i) Are the generated conversations fluent in terms of both sentence and topic flow? (ii) Is there any repetitive content or topic in the conversation? Similarity measures how similar is the synthesized conversation to real scenarios. The evaluators are guided to score from 1 to 10. A higher score indicates better performance. Safety measures the leakage of private information (e.g. address). 0 means safe generation while 1 indicates privacy leakage."}, {"title": "Results and Evaluation", "content": "The Human evaluation results are presented in Table 2.\nMDD-5k exhibits superior performance across six major metrics. The evaluation scores on professionalism and similarity are significantly higher than other datasets, suggesting that our synthesized diagnostic conversations can mirror real scenarios of diagnosis to some extent. The communication quality of both doctor and patient is also impressive. Despite these strengths, MDD-5k does include some repetitive content, occasionally leading to less fluent conversations. The D\u2074 dataset ranks second. It achieves relatively high score on communication and fluency evaluation. The biggest problem of D\u2074 is that its conversations are too brief and only include symptom inquiries and short responses.\nAn ablation study is conducted. The performance of the direct role-playing method is significantly worse compared to the neuro-symbolic multi-agent framework, particularly in terms of fluency and communication skills. This finding confirms that directly applying large language models for diagnostic conversation generation will lead to poor outcomes.\nThe evaluation also shows the distinct differences between diagnostic conversation and psychological counseling. The evaluation scores of CPsyCounD are notably low, especially for the professionalism and similarity metric. Psychological counseling prioritizes comfort and healing with different therapies, while diagnostic conversation focuses on acquiring symptoms to arrive at a final diagnosis result."}, {"title": "Conclusion and Future Work", "content": "We design a neuro-symbolic multi-agent framework for synthesizing diagnostic conversation of mental disorders, and apply it for building the first and largest open-source Chinese mental disorders diagnosis dataset with diagnosis results as labels. The framework features controllable one-to-many patientcase-to-dialogue generation. Conversation between a doctor agent and a patient agent is guided by a dynamic diagnosis tree. We also apply several techniques to improve the diversity of generated conversations. Human evaluation shows the quality of the proposed MDD-5k dataset exceeds existing relevant datasets on seven indicators. The MDD-5k dataset is believed to contribute to a wide range of downstream tasks like mental disorders classification, mental disorders diagnosis assistant training, etc.\nThe primary limitations of this work lie in three points: (i) The discrepancy between synthesized conversations and actual medical diagnostics remains a significant challenge. Large language models often struggle to interpret the full meaning of patient responses when they encapsulate diverse information aspects, consequently leading to redundant symptom inquiries. We are exploring various prompt strategies to mitigate this issue. (ii) We mainly design dynamic diagnosis tree for depression (F32), anxiety (F41),"}, {"title": "Ethics Statement", "content": "The collection of patient cases was conducted at the Shanghai Mental Health Center. All patients were informed that their information would be collected and used exclusively for research purposes. As detailed in the Patient Cases Pre-processing section, all data masking procedures strictly follow the Chinese information security technology guidelines for health data security (GB/T 39725-2020). Currently, the patient cases and the synthesized diagnostic conversation dataset, MDD-5k, are undergoing an ethics review at the Shanghai Mental Health Center. We plan to release the MDD-5k dataset for research purposes only after the ethics review finishes. To prevent any potential privacy data leakage, all experiments are conducted on servers located within the Shanghai Mental Health Center."}]}