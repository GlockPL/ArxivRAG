{"title": "Homeomorphism Prior for False Positive and Negative Problem in Medical Image Dense Contrastive Representation Learning", "authors": ["Yuting He", "Boyu Wang", "Rongjun Ge", "Yang Chen", "Guanyu Yang*", "Shuo Li"], "abstract": "Dense contrastive representation learning (DCRL) has greatly improved the learning efficiency for image dense prediction tasks, showing its great potential to reduce the large costs of medical image collection and dense annotation. However, the properties of medical images make unreliable correspondence discovery, bringing an open problem of large-scale false positive and negative (FP&N) pairs in DCRL. In this paper, we propose GEoMetric visual dense similarity (GEMINI) learning which embeds the homeomorphism prior to DCRL and enables a reliable correspondence discovery for effective dense contrast. We proposes a deformable homeomorphism learning (DHL) which models the homeomorphism of medical images and learns to estimate a deformable mapping to predict the pixels' correspondence under the condition of topological preservation. It effectively reduces the searching space of pairing and drives an implicit and soft learning of negative pairs via gradient. We also proposes a geometric semantic similarity (GSS) which extracts semantic information in features to measure the alignment degree for the correspondence learning. It will promote the learning efficiency and performance of deformation, constructing positive pairs reliably. We implement two practical variants on two typical representation learning tasks in our experiments. Our promising results on seven datasets which outperform the existing methods show our great superiority. We will release our code at a companion website.", "sections": [{"title": "1 INTRODUCTION", "content": "DENSE contrastive representation learning (DCRL) [1]\u2013\n[7] is crucial for medical image dense prediction\n(MIDP) tasks, e.g., segmentation [8]\u2013[10]. With the increas-\ning demand for deep learning in medical image applications\n[11], the extremely high cost of medical image collection\nand dense annotation are becoming a large bottleneck [12].\nThe DCRL discovers the corresponding pixel\u00b9-wise features\n[13]-[16] to drive the learning of consistent or distinct repre-\nsentation for them (Fig.1 A)) which will effectively capture\nthe dense posterior distribution of the underlying explana-\ntory factors for the input. Therefore, it will make models\neasier to extract useful information [6] when learning MIDP\ntasks, thus pushing the label and data efficiency to soaring\nheights in the learning process and coping with the large\nchallenge in the data collection and dense annotation [17].\nAlthough some DCRL works [1]\u2013[5] on natural images\nhave been reported, medical images' properties will cause\nextremely unreliable correspondence discovery (Fig.1 B)),\nleading to an open problem of large-scale false positive and\nnegative (FP&N) feature pairs [18], [19] in DCRL:\n1) Large-scale false positive (FP) pairs caused by the semantic\ndependence: (Fig.1 B) a)) Some existing works [1], [3] measure\nthe similarity between the pixel-wise features to discover the\npositive pairs. However, due to the low- and noisy-contrast\nacquisitions [20] of medical images, numerous semantic\nregions in these images are insignificant (e.g., the soft tissues\nin CT images). These insignificant regions have large depen-\ndence with each other making it a challenge to distinguish\nthem. Therefore, if directly measuring the similarity for all\nfeatures, the features will be mispaired easily resulting in\nlarge-scale FP pairs. Although some other works [2], [4], [5]\nutilize the correspondence from the manual transformation\nof the same images weakening the FP problem, the diversity\nof positive pairs is limited (only paired from the same\nimages) and they are still limited by large-scale FN problem.\n2) Large-scale false negative (FN) pairs caused by semantic\ncontinuity and semantic overlap: a. Different from the image-\nwise contrastive learning [21]\u2013[24] whose unit is \"instance\",\nthe DCRL utilizes the \u201cpixel\u201d as the unit which continuously\narranges on images and constructs semantics via numerous\npixels due to the continuity of image signal [21] (Fig.1 B)\nb)). This makes the semantics continuously distributed on\nimages, so it is unreliable to absolutely divide the pixel-\nwise features as different semantics on images as negative\npairs. b. Some natural DCRL methods [1], [3], [4] utilize\nthe features from different images as negative pairs, like\nmomentum contrast mechanism [1], [3], [25] which utilizes a\nmemory bank to save previous features as negative samples\n(Fig.1 B) c)). However, due to the consistency of human\nbody, medical images have similar global content which\nshares numerous same anatomies. This makes numerous\noverlapped semantics between images, so that it will con-\nstruct numerous negative pairs with the same semantics\nresulting in FN pairs.\nDuring correspondence discovery, these properties will\nenlarge the risk of the FP&N feature pairs [18], [19] resulting\nin large-scale FP&N problem. It will train the network's rep-\nresentation to deviate from reality, making the pre-trained\nnetwork even worse than the randomly initialized network.\nTherefore, we seek to answer the following question: How\nto cope with the FP&N problem for reliable pixel-wise correspon-dence in the medical image DCRL?\nMotivation: Inspired by topologie [26] (Fig.2), homeo-\nmorphism [27] between medical images [28]\u2013[30], e.g., CT,\nMR, X-ray, provides a prior knowledge for reliable pixel-\nwise correspondence. An often-repeated mathematical joke\nis that \"topologists cannot tell the difference between a\ncoffee cup and a donut\" [31] (Fig.2 A)), because the coffee\nand donut are homeomorphic (have the same topology) and\nthey are able to transform to each other via a topology-\npreserved mapping (homeomorphism, a bijective and con-\ntinuous transformation). The consistency of human genes\ndetermines that the human bodies have similar anatomies\n[32], for example, human hearts have four chambers with a\nfixed spatial relationship, and the human brain has a fixed\nfunctional regions distribution [29]. This makes the medical\nimages scanned from the same body ranges have stable\nsimilar anatomies [32] with consistent context topology [33],\nshowing the homeomorphic topology (Fig.2 B)). Therefore,\nbased on the topologie principle and the intrinsic homeo-\nmorphic topology of medical images, it will be easy to align\nthe semantic regions via a deformation (a homeomorphism\nmapping function, we name it deformable mapping in this\npaper). This makes an effective prior knowledge that en-\nables a reliable pixel-wise correspondence discovery inter\nimages in DCRL under the condition of medical images'\ninherent topology (Fig.2 C)), reducing the searching space of\nconstructing the correspondence. Therefore, we hypothesize\nthat \u201cEmbedding this homeomorphism prior knowledge to the\nmedical images DCRL will prompt the pixel-wise correspondence\ndiscovery to improve the dense representation.\nHowever, it is challenging to directly utilize this home-"}, {"title": "2 RELATED WORK", "content": "1) Correspondence Problem: Broadly speaking, the corre-\nspondence problem is one of the basic problems in cogni-\ntive science [38], [39], machine learning [40], and computer\nvision [41]. It studies the notion of correspondence between\ntwo autonomous agents in human cognition [38], thus\nfurther exploring the social learning, imitation, copying,\nor mimicry in human activation. These human cognition\nstudies for correspondence have been influential in machine\nlearning in the past several decades [40], [42]. Numerous\nmachine learning tasks, such as the protein 3D structure\nprediction from amino acid sequence [43], the machine\ntranslation [44], the position alignment between images [41],\netc., are able to be modeled as correspondence problems.\nIn this paper, we limit our scope to visual contrastive\nrepresentation learning and review the below topics that are\nrelevant to the applications considered in the sequel.\n2) Dense Contrastive Representation Learning: DCRL\nis a typical correspondence problem that learns consistent or\ndistinct representation for pixel-wise features of positive or\nnegative pairs via constructing pixel-wise correspondence\n[13]\u2013[15]. It will effectively capture the posterior distribution\nof the underlying explanatory factors and make models\neasier to extract useful information [6] when learning MIDP\ntasks. Therefore, the label and data efficiency will be ef-\nfectively improved to cope with the large challenge of the\nextremely high cost of medical image collection and pixel-\nwise annotation. It has three kinds to construct positive and\nnegative pairs. a. The pixel similarity-based methods [1],\n[3], [5], [45], [46] measure the Mahalanobis [47] or Euclidean\n[48] distance between pixel-wise features for the correspon-\ndence. However, the low-contrast medical images limit the\ndiscrimination of features making the measurement unre-\nliable and constructing FP&N pairs. b. The location-based\nmethods take the shared part of two cropped patches from\none image [2] or the same position between two medical\nimages [49] as the positive pairs and the features from\ndifferent images or different positions as the negative pairs,\navoiding the limitation of mismeasurement. However, due\nto the consistency of image content, the same semantic\npixel regions are widely existing in different images mak-\ning a serious false negative problem, and interfering with\nthe representation learning process. c. The attention-based\nmethod [4] utilizes the attention maps to extract positive\npairs and their negative pairs are still directly paired from\ndifferent images. It relies on a large dataset to train an\nattention prediction model, once the dataset is not large\nenough, the inaccurate attention will bring numerous mis-\ncorrespondence. The unreliable negative pairs also bring\nlarge limitations.\n3) False Positive and Negative Pairs Problem: FP&N\nProblem [18], [19] is one of the key open problems in\ncontrastive representation learning [22], [24], [25], [50], [51]\nand the existing works focus on FP&N problem in image-\nwise. FP&N problem is caused by the mis-correspondence\nof feature pairs which makes the networks learn distinct\nrepresentations for the same-semantic pairs and consistent\nrepresentations for the different-semantic pairs. The net-\nwork will learn the inaccurate posterior distribution which\nis contrary to the underlying explanatory factors, extremely\nlimiting the learning of practical tasks. Some methods [5],\n[24] remove the construction of negative pairs, and only\nlearn the positive pairs constructed by different views of one\nimage to avoid the FP&N problem. However, it will bring\nthe risk of dimensional collapse [52] which makes the net-\nwork unable to represent the information in images. Some\nother methods [18], [19], [53] construct FP&N-robust losses\nor FP&N-discovery mechanisms to reduce the interference\nof inaccurate feature pairs, and have achieved promising\nresults. However, these methods are sensitive to their addi-\ntional hyper-parameters, and these hyper-parameters have\nto be carefully adjusted for their effectiveness. There is no\nsuccess reported to cope with the FP&N problem in the\nmedical image DCRL whose special properties (continuous\nimage signal, low contrast, varied appearance, consistent\nimage content) bring more challenges in correspondence.\n4) Homeomorphism in Medical Images Analysis:\nHomeomorphism is a powerful prior for medical image\nlearning. As introduced in Sec.1, this property comes from\nthe consistency of human anatomy [32], and numerous\nmedical image categories, e.g., CT, MR, X-ray, etc., inherit\nit. Therefore, using homeomorphism as prior knowledge,\nsome medical image works have been studied. One of the\nclassic applications is the registration [34]\u2013[37], [41]. Accord-\ning to this prior, it aligns the anatomical structures in medi-\ncal images to the same spatial coordinate system, so that the\nimages' consistent anatomies will be aligned in image space.\nBased on the registration, some works [29], [54]\u2013[57] further\nstudy the atlas-based segmentation methods. They align the\nlabeled images to unlabeled images, thus indirectly map-\nping the labels to unlabeled images for segmentation results.\nThese methods have very small label requirements and large\nrobustness due to homeomorphism. With the development\nof deep learning [58], [59], the homeomorphism prior is\nfurther promoting the medical image learning, e.g., few-shot\nsegmentation [8], [60]\u2013[63]. They have effectively improved\nthe learning efficiency and robustness in these tasks, owing\nto the large contribution from the homeomorphism prior.\nHowever, due to the limitations illustrated in Sec.1, it is still\nchallenging to embed this great prior into the DCRL tasks\nand there are no preliminary studies reported."}, {"title": "3 METHODOLOGY", "content": "The proposed GEMINI paradigm (Fig.3) constructs soft\nlearning of negative pairs (DHL, Sec.3.2) and reliable learn-\ning of positive pairs (GSS, Sec.3.3) based on the homeomor-\nphism prior knowledge for the large-scale FP&N problem\nin DCRL for powerful representation.\n3.1 Preliminary of Homeomorphism and Formulation\nIn topologie [26], the \"two objects are homeomorphic\"\nmeans they have topological equivalence. There is a bijective\nand continuous function (like Fig.2 A)) between them for\na topological-preserved transformation (homeomorphism),\nand each point of one object corresponds to a point of the\nother object. Let's define two objects in topological space, X\nand Y, where the X and Y are the point sets of the objects\n(e.g., the semantic regions in images). There is a mapping\nfunction $F : X \\rightarrow Y$ that transforms the X to the Y. If the F\nis a bijection, is continuous, and its inverse function $F^{-1}$ is also\ncontinuous, this mapping function F is a homeomorphism,\nthe two objects are homeomorphic $X \\simeq Y$. Based on\nthe above theory, the bijection and continuity are two key\nelements in constructing a homeomorphic mapping for our\nreliable correspondence discovery.\nFormulation: Due to the consistency of human anatomy\nand the intrinsic topology property of images [64], numer-\nous categories of medical images scanned from the same\nhuman body region are approximately homeomorphic in\ntopologie. Let's denote two same category medical images\nxA and xB sampled from the dataset S are homeomorphic\nxA \\simeq xB. The individual variations of human body, such\nas height, figure, and scanning posture, make the semantic\nregions' position in image space different between medical\nimages. Therefore, this enables us to construct a homeo-\nmorphism mapping function $\\psi_{R^{n}}$ that transforms the pixel\npositions in the image space $R^{n}$ with n dimensions for the\nalignment of images. It is formulated as:\n$\\psi_{R^{n}}(x_{A}) = x_{B}$\ns.t. \\forall I \\in x_{A}, \\forall \\psi_{R^{n}}(I) \\in x_{B}\n\\forall J \\in x_{B}, \\forall \\psi_{R^{n}}(J) \\in x_{A},\n(1)\nwhere the I and J are subsets of A and B. The\n$\\forall I \\in x_{A}, \\forall \\psi_{R^{n}}(I) \\in x_{B}$ means that the mapping $\\psi_{R^{n}}$\nis topological-preserved (continuous), and the $\\forall J \\in$\nxB, $\\psi^{-1}_{R^{n}}(J) \\in$ xA further means that the $\\psi_{R^{n}}$ is bijective\nand there is a continuous inverse mapping $\\psi^{-1}_{R^{n}}$.\nSimple Discussion: The hypothesis of the homeomor-\nphism prior in medical images is based on an ideal situation,\ni.e., the images have the exactly same content (one-by-one\ncorrespondence of the semantic regions). However, due to\nthe potential difference in the scanning fields and the human\nbody, medical images do not always have the same content.\nFor example, the cardiac CT images in a large scanning\nwindow will have whole lungs, but if they are in a small\nscanning window, the images will only have a small part of\nthe lungs. This makes only the shared parts homeomorphic\nand the whole images are not. Fortunately, in our method,\nwe construct this homeomorphism mapping function by\ndeformation and use 0 value to fill the hole caused by defor-\nmation. This means that we append a point set of all zeros\non the original image point set so that the points between\nthe medical images that do not meet homeomorphism will\ncorrespond to these zero points, thus finally making the\nwhole point set meet the homeomorphism. It is formulated\nas ${x_{A}, 0} \\simeq {x_{B}, \\phi}$, where the $\\phi$ is the zero set has no\ngradient in training. Therefore, it enables us only need to\nfocus on the homeomorphic part between medical images.\n3.2 Deformable Homeomorphism Learning (DHL)\nAs shown in Fig.3 a), the DHL leans a deformable mapping\nthat transforms the space of one medical image to the other\nimage, thus driving the soft learning of feature pairs. It\nhas two shared-weight networks which learn representation\n(backbone) N\\theta and a network that learns deformation (de-\nformer) D\\epsilon. Two medical images sampled from the dataset\n${x_{A}, x_{B}} \\sim S$ are putted into the backbone networks to\nextract their features $f_{A} = N_{\\theta}(x_{A}), f_{B} = N_{\\theta}(x_{B})$. These\nfeatures are put into the deformer networks D\\epsilon in order\n([$f_{A}, f_{B}$]) and reverse order ([$f_{B}, f_{A}$]) to estimate their\ndeformable mapping functions, i.e., DVF $\\psi_{A \\rightarrow B}$ from xA to\nxB, and DVF $\\psi_{B \\rightarrow A}$ from xB to xA. It is formulated as\n$\\psi_{A B} = D_{\\epsilon}(f_{A}, f_{B}), \\psi_{B A} = D_{\\epsilon}(f_{B}, f_{A}).$\n(2)\nAccording to the homeomorphism prior (Equ.1) which\nconstructs a continuous and bijective correspondence in\nDVF, we train the network to learn these properties: 1) For\ncorrespondence, we propose a geometric semantic similarity\nLGSs for efficient measurement of the correspondence de-\ngree and drive the deformer to predict reliable DVF together\nwith the original geometric visual similarity LGvs in GVSL\n[33] (Sec.3.3). 2) For continuity, we utilize a smooth loss Lsmo\nto constrain the DVF $\\psi_{R^{n}}$ to perform a topological-preserved\n(smooth) transformation, i.e., the deformable mapping, so\nthe semantics of the regions inner medical images will be\npreserved, improving the reliability of correspondence:\n$L_{smo}(\\psi_{R^{n}}) = \\sum \\|\\nabla \\psi_{p}\\|^{2},$\np\\in R^{n}\n(3)\nwhere the p is the position of the pixels in image space\n$R^{n}$, the $\\nabla \\psi_{p}$ is the gradient of position p. Therefore, it\nwill avoid over-transformation which breaks the topological\nstructures of semantic regions, and keep the homeomorphic"}, {"title": "4 RELATED WORK", "content": "property of the mapping. Therefore, the loss LDM to learn\na deformable mapping (DM) is\n$L_{DM}(\\theta, \\epsilon, {x_{A}, x_{B}}) = \\lambda_{smo}L_{smo}(\\psi_{A B})$\nContinuity\n$+ \\lambda_{G v s}L_{G v s}(x_{A}, x_{B}, \\psi_{A B}) + L_{G S S}(f_{A}, f_{B}, \\psi_{A B}),$\nCorrespondence\n(4)\nwhere the $\\lambda_{smo}$ is the weights for the smooth loss and\n$\\lambda_{Gvs}$ is the weight of the geometric visual similarity. 3)\nFor bijection, we simultaneously learn forward deformable\nmapping and inverse deformable mapping, thus training\nthe deformers to learn the symmetry between two medical\nimages and constructing a bidirectional optimization objec-\ntive in our DHL LDHL:\n$L_{D H L} = L_{D M}(\\theta, \\epsilon, {x_{A}, x_{B}}) + L_{D M}(\\theta, \\epsilon, {x_{B}, x_{A}}))\nBijectivity: xAxB, xBxA$\n(5)\nTherefore, during the learning of bijective deformable map-\nping, the deformers will try to learn a reliable correspon-\ndence between images in the DVFs ($\\psi_{A B}, \\psi_{B A}$). The gradi-\nent of the loss LDHL will optimize the backbones N\\theta for\nsoft learning of feature pairs implicitly, bringing a reliable\noptimization for representation (analyzed in Sec.3.4).\nSimple discussion of the property: Our DHL serves\nas the framework of GEMINI, enabling homeomorphism\nmapping between images. By leveraging the key elements\nof continuity and bijection, it trains the backbone to extract\ndistinct features for non-corresponding pairs and consis-\ntent features for corresponding pairs through deformable\nlearning gradients. This soft feature learning mitigates false\nnegatives caused by direct negative pair distinctions. How-\never, the backbone's weak initial representation, stemming\nfrom the 'two-player game' learning process (Sec.3.4), is\naddressed by embedding foundational tasks in GEMINI\nvariants to warm up learning (analyzed in Sec.6.1.8).\n3.3 Geometric Semantic Similarities (GSS)\nOur GSS measures the correspondence (alignment) degree\nvia the represented dense features to promote the learning\nefficiency of deformation to improve the alignment, thus\nconstructing and learning the positive pairs reliably. As\nshown in Fig.3 a), the original GVS [33] utilizes the DVF\n$\\psi_{A B}$ to transform the image xA to align the image xB, and\ncalculate the distance of pixel intensity between the aligned\nimage $x_{AB}$ and the image xB for their similarity. Due to the\nlimitation of the appearance, the distance will be interfered\nwhich makes an unreliable measurement. Our GSS measure\nthe similarity between the represented features (Fig.3 b))\nfurther considering the important semantic information. It\nutilizes the DVF $\\psi_{A B}$ to align the dense features fA to the\ndense features fB, and calculate the distance of the features\nbetween the aligned features $f_{AB}$ and the feature fB for\ntheir similarity. In our GEMINI, the original GVS still takes\npart in the measurement due to its training-invariability\nwhich will not be interrupted by the learning process for\na basic optimization objective. Different from the similarity\nmeasured throughout the whole space [3], our GSS or GVS\nmeasures the similarities only between the corresponding\npositions of the features or images in the image grid. There-\nfore, this will make the measurement under the condition of\nsemantic regions' inherent topology which significantly re-\nduces the searching space of the correspondence discovery,\nso we call the GSS and GVS \u201cgeometric\u201d.\nAs discussed in Sec.3.1, during the calculation of the\ngeometric similarities, we only focus on the homeomorphic\nregions. Therefore, we utilize an adaptive mask mechanism\nto remove the zero point set and measure the alignment\ndegree of the potentially shared regions between two im-\nages. Specifically, it generates a mask $\\epsilon$ with the same size as\nthe image xA and the value of 1, and then transforms it to\nthe space of xB via the DVF $\\psi_{AB}$ for $\\epsilon_{AB}$. The void region\ncaused by the transformation in the mask is filled with \u201c0\u201d\nwhich is the appended zero point set. Therefore, the regions\nwith a value of \u201c1\u201d are the shared regions between images,\nand those with a value of \u201c0\u201d are the non-corresponding\nregions. Only the value \u201c1\u201d regions highlighted in the mask\nwill be calculated for similarity. We utilize the normalized\ncross-correlation [41] for the GVS and the cosine similarity\nfor our GSS with the mask $\\epsilon$ into the measurement process:\n$L_{GVS}=\\frac{(\\sum_{p\\in {\\epsilon_{A B}=1}}(x_{A B}^{p}-\\overline{x_{A B}})(x_{B}^{p}-\\overline{x_{B}}))^{2}}{(\\sum_{p\\in {\\epsilon_{A B}=1}}(x_{A B}^{p}-\\overline{x_{A B}})^{2})(\\sum_{p\\in {\\epsilon_{A B}=1}}(x_{B}^{p}-\\overline{x_{B}})^{2})},$\n(6)\n$L_{GSS} = \\sum_{p\\in {\\epsilon_{A B}=1}} \\frac{f_{A B} \\cdot f_{B}}{\\|\\mid f_{A B}\\|\\mid \\|\\mid f_{p}\\|\\mid},$\n(7)\nwhere the $\\epsilon_{A B} = \\psi_{A B}(\\epsilon)$, the $x_{A B} = \\psi_{A B}(x_{A})$, and the\n$\\overline{x_{A B}}=\\epsilon_{A B}(x_{A})$.\nOur GSS will both drive the learning of homeomor-\nphism mapping as a loss in the DHL and train the reliable\nlearning of positive pairs for their representation due to the\nhomeomorphism-based correspondence. As shown in Fig.4,\nthe gradient from the GSS will be divided into two parts,\nincluding the gradient for positive pairs (red path) and the\ngradient for the soft learning of feature (both positive and\nnegative) pairs (blue path). The rad path directly learns the\nconsistency of features in corresponding positions predicted\nby the deformer D\\epsilon. Due to the homeomorphism prior, the\ncorrespondence discovery is under the condition of topo-\nlogical preservation which will be reliable for the contrastive\nlearning of positive pairs. The blue path utilizes the gradient\nform the deformer D\\epsilon to optimize the backbone network N\\theta"}, {"title": "7 RELATED WORK", "content": "indirectly, i.e., the learning in our DHL, bringing implicit\nand soft learning of feature pairs (analyzed in Sec.3.4).\nThe whole optimization of our GEMINI can be modeled\nas two parts, including the optimization of parameters $\\theta$ for\nrepresentation and the optimization of the parameters $\\epsilon$ for\ndeformable mapping:\n$\\epsilon^{*}=\\underset{\\xi}{\\operatorname{arg\\ min}}L_{D H L}(\\theta^{*}, \\epsilon, S)$\ns.t. $\\theta^{*}=O P T(\\theta, \\frac{\\partial L_{D H L}(\\theta, \\epsilon, S)}{\\partial \\theta})$\n+ $\\lambda_{pos} \\underset{\\theta}{\\operatorname{arg\\ min}}L_{pos}(\\theta, S)$,\nGradient for soft negative pairs\nObjective for positive pairs\n(8)\nwhere the Lpos represents the red path in Fig.4 for positive\npairs, $\\lambda_{pos}$ is the weight of Lpos, and the OPT() is the\noptimization strategy to minimize the LDHL for negative\npairs (yellow path). If it is SGD [65] with one step, it will be\n$\\theta^{*} = \\theta - \\eta \\frac{\\partial L_{D H L}(\\theta,\\epsilon,S)}{\\partial \\theta}$, where the \u03b7 is learning rate. The\ntwo optimization parts correspond to the two forward paths\n(Fig.4) in the inference process, so the whole optimization\nprocess is compatible with the existing gradient descent\nmethods. We utilize the Adam [66] for optimization.\nSimple discussion of the property: Our GSS, a specific\nloss in GEMINI, facilitates correspondence learning-key to\nhomeomorphism mapping-by leveraging the deformer to\nalign features based on the inherent topology of medical\nimages. This enables reliable positive pair learning, ad-\ndressing the large-scale false-positive problem. As part of\nDHL, GSS also supports soft feature learning via gradients.\nTo overcome limitations in discovering positive pairs in\nnon-homeomorphic regions, our adaptive mask mechanism\nhighlights shared regions.\n3.4 Intuitions on Behavior: Learning Reliable Positive\nand Implicit Negative Pairs for Dense Representation\nThe two optimization objectives in Equ.8 for $\\theta$ train the\nbackbones to learn reliable positive feature pairs and im-\nplicit negative feature pairs, bringing an effective dense\nrepresentation learning to the continuous image signal.\nFor positive pairs, it effectively reduces the searching\nspace of pairing, bringing reliable learning for positive pairs.\nOur homeomorphism prior makes the correspondence dis-\ncovery under the condition of the consistent topology of\nimages formulated as $c_{i}=D_{\\epsilon}(f_{A}^{i}, f_{B}^{i}) i \\epsilon P R^{n}$. In the\ntraining of GEMINI, the $\\psi_{A B}$ have to meet the minimization\nof $L_{smo}, L_{G s s}, and L_{G vs}$ which make the $\\psi_{A B}$ have\ntopology-preservation ability and good alignment degree.\nTherefore, as shown in Fig.5 a), it makes our positive feature\npairing consider the topology, i.e., pairing features on a\ntopology manifold, efficiently reducing the searching space\nand improving the reliability. The objective for positive\npairs arg mine Lpos($\\theta$,S) learns their consistency on this\nmanifold. The feature $f^{A}_{\\phi}$ ($\\phi = 7$ in Fig.5) from the dense\nfeatures $f_{A}$ and the feature $f_{\\beta}$ from the dense features $f_{B}$\nwill be consistent, i.e., $f^{A}_{\\phi} = f_{\\beta}$.\nFor negative pairs, it constructs implicit learning via the\ngradient $O P T_{\\theta}(\\theta, \\frac{\\partial L_{D H L}(\\theta,\\epsilon,S)}{\\partial \\theta})$ from the DHL, avoiding the\ndirect division of negative pairs and learning a soft contrast.\nSpecifically, the deformer network D\\epsilon learns to discover the\ncorrespondence of the consistent features {$f_{A}, f_{B}$}, thus\n driving the backbone represent distinct features for the fea-\ntures with inconsistent semantics. Fig.5 b) shows an example\nof this process. The features $f^{A} = {f_{\\alpha}, f_{1}^{A},..., f_{r \\times r}^{A}}$\nis the image $x_{A}$'s features in the receptive field of the De-\nformer network D\\epsilon, where the r is the width of the receptive\nfield (it is 26 in our experiments). Due to the learning of\npositive pairs, the f\\beta is constrained to $f_{\\alpha}$ where the q is the\ncorresponding position. Therefore, as demonstrated in Fig.5\na), in order to discover the corresponding position, it will\ntrain the features in non-corresponding position to distinct\nto the feature f\\beta via a gradient.\n$\\psi_{D_{\\epsilon}}(f_{B}, f_{A})=\\psi_{B A}$\ns.t. $f_{p} = f_{q}^{A}, \\psi_{B A} : x \\rightarrow q$\n(9)\nThroughout the whole training process, the learning of rep-\nresentation in the backbone network N\\theta and the deformable\nmapping in the deformer network D\\epsilon is a two-player game\n[67]. The De learns to estimate the correspondence of se-\nmantic regions from the represented dense features $f_{A}, f_{B}$\nand measure their pixel displacement. The N\\theta learns to\nprovide features of semantic regions to the D\\epsilon for their cor-\nrespondence. To achieve more accurate correspondence, the\ndeformer network D\\epsilon has to drive the backbone network N\\theta\nto output more distinct features in turn for different seman-\ntic regions via the gradient in backpropagation. Therefore,\nunder this interaction, the N\\theta will provide more represen-\ntative features for the D\\epsilon to improve the correspondence\nestimation, and the D\\epsilon will have a more powerful ability to\nlearn the correspondence of pixel-wise features. This process\nneeds a promising representation in backbone, but it is\nalways unavailable at the beginning of training. Therefore,\nwe train the GEMINI with a fundamental learning task, e.g.,\nrestoration [68], [69] in our implementation."}, {"title": "8 RELATED WORK", "content": "With our homeomorphism prior, our GEMINI has powerful\nrepresentation learning ability with little (FS-Semi) or no\n(SS-MIP) supervision. In our experiment (Sec.4) of FS-Semi,\nthe unlabeled images and the very few labeled images are\nlearned together, so that the networks in the DCRL methods\nhave a supervised optimization target which makes a basic\ndistinction for the features of different segmentation regions.\nTherefore, this will improve the reliability of the correspon-\ndence discovery in the DCRL methods, and achieves more\nthan 70% DSC on all tasks in FS-Semi. But the reliability\nin the existing DCRL methods is still weak without our\nhomeomorphism prior, and they all only have lower per-\nformance than our GEMINI-Semi. In our experiment (Sec.5)\nof SS-MIP, the unlabeled images and the labeled images\nare trained separately in the pretext tasks and downstream\ntasks, so the networks in the DCRL methods have no\nsupervision during their learning unlabeled images. Their\ncorrespondence discovery is extremely limited owing to the\nproperties of medical images, constructing a lot of FP&N\npairs, and learning very poor representation. Therefore,\nin the downstream tasks, some of them even have worse\nperformance than the \"Scratch\". Based on our homeomor-\nphism prior, our GEMINI-MIP has much more reliability\nto discover the correspondence even without supervision,\nachieving reliable positive pairs and implicit negative pairs\nfor pre-training and powerful performance for transferring."}]}