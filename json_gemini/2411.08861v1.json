{"title": "Interaction Testing in Variation Analysis", "authors": ["Drago Ple\u010dko"], "abstract": "Relationships of cause and effect are of prime importance for explaining scientific phenomena. Often, rather than just understanding the effects of causes, researchers also wish to understand how a cause X affects an outcome Y mechanistically i.e., what are the causal pathways that are activated between X and Y. For analyzing such questions, a range of methods has been developed over decades under the rubric of causal mediation analysis. Traditional mediation analysis focuses on decomposing the average treatment effect (ATE) into direct and indirect effects, and therefore focuses on the ATE as the central quantity. This corresponds to providing explanations for associations in the interventional regime, such as when the treatment X is randomized. Commonly, however, it is of interest to explain associations in the natural, observational regime, and not just in the interventional regime. In this paper, we introduce variation analysis, an extension of mediation analysis that focuses on the total variation (TV) measure between X and Y, written as E[Y | X = X1] - E[Y | X = xo]. The TV measure encompasses both causal and confounded effects, as opposed to the ATE which only encompasses causal (direct and mediated) variations. In this way, the TV measure is suitable for providing explanations in the natural regime and answering questions such as \"why is X associated with Y in a particular way?\". Our focus is on decomposing the TV measure, in a way that explicitly includes direct, indirect, and confounded variations. Furthermore, we also decompose the TV measure to include interaction terms between these different pathways. Subsequently, the concept of interaction testing is introduced, which involves hypothesis tests to determine if interaction terms are significantly different from zero. If interactions are not significant, a more parsimonious decomposition of the TV measure can be used. The paper further provides a structural basis for these interaction tests (through the language of structural causal models) and demonstrates their applicability through synthetic and real-world data analyses. The extension of the framework for log-risk and log-odds scales for binary outcomes is also discussed, offering a comprehensive approach to understanding the interplay of direct, indirect, and confounded effects in causal inference.", "sections": [{"title": "1. Introduction", "content": "Understanding relationships of cause and effect are one of the fundamental tasks found throughout the sciences. The process of establishing mechanistic links between causes and their consequences is at the core of our ability to explain why events occur as they do. In this context, mediation analysis, a widely used tool, helps unravel the pathways through which causal effects are transmitted. By identifying intermediary variables, mediation analysis offers deeper insights into the underlying mechanisms driving the observed cause-effect relationships. This approach is crucial in fields ranging from epidemiology to social sciences, where understanding the nuances of causal relationships can inform interventions and policy decisions.\nInterestingly, most of the literature on mediation analysis focuses on understanding the variations contained in the average treatment effect (ATE), also known as the total effect (TE), given by\nE[Y | do(X = x1)] \u2013 E[Y | do(X = xo)],\n(1)"}, {"title": "2. Preliminaries", "content": "We use the language of structural causal models (SCMs) as our basic semantical framework (Pearl, 2000). A structural causal model (SCM) is defined as:\nDefinition 1 (Structural Causal Model (SCM) (Pearl, 2000)) A structural causal model M is a 4-tuple (V,U, F, P(U)), where\n1. U is a set of exogenous variables, also called background variables, that are determined by factors outside the model;\n2. V = {V1, ..., Vn} is a set of endogenous (observed) variables, that are determined by variables in the model (i.e. by the variables in U \\cup V);\n3. F = {fv\u2081, ..., fv\u2099} is the set of structural functions determining V, vi \u2190 fv; (pa(vi), ui), where pa(Vi) \u2286 V \\ Vi and U\u00bf \u2286 U are the functional arguments of fv;;\n4. P(U) is a distribution over the exogenous variables U.\nThe assignment mechanisms F determine how each of the observed variables Vi attains its value, based on other observed variables and the latent variables U. Together with the probability distribution P(U) over the exogenous variables U, it specifies the entire behavior of the underlying phenomenon. In many places, expectations are written as simple summations, whereas for continuous variables, such notation should be replaced with integrals, assuming that the corresponding probability measure admits a density w.r.t. the Lebesgue measure. For notational simplicity, we often use shorthand notation, with expressions such as P(Y = y) replaced with P(y), whenever the simplification is clear from the context.\nCrucially, the SCM induces the observational distribution of the underlying phenomenon, defined through:\nDefinition 2 (Observational Distribution (Bareinboim et al., 2022)) An SCM M that is a 4-tuple (V,U,F,P(U)) induces a joint probability distribution P(V) such that for each Y \u2286 V,\nPM(y) = \u22111 (Y(u) = y)P(u),\n(11)\nwhere Y(u) is the solution for Y after evaluating F with U = u.\nA further important notion building on the concept of the SCM is that of a submodel, which is defined next:\nDefinition 3 (Submodel (Pearl, 2000)) Let M be a structural causal model, X a set of variables in V, and x a particular value of X. A submodel Mx (of M) is a 4-tuple:\nMx = (V,U, Fx, P(U))\n(12)\nwhere\nFx = {fi : Vi & X} \u222a {X \u2190 x},\n(13)\nand all other components are preserved from M.\nBuilding on submodels, we introduce next the notion of a potential outcome:\nDefinition 4 (Potential Outcome / Response (Rubin, 1974; Pearl, 2000)) Let X and Y be two sets of variables in V and u \u2208 U be a unit. The potential outcome/response Y(u) is defined as the solution for Y of the set of equations Fx evaluated with U = u. That is, Yx(u) denotes the solution of Y in the submodel Mx of M.\nIn words, Yx (u) is the value variable Y would take if (possibly contrary to observed facts) X is set to x, for a specific unit u. We further define how counterfactual distributions over various possible potential outcomes are computed:\nDefinition 5 (Counterfactual Distributions (Bareinboim et al., 2022)) Consider an SCM M = (V, U, F, P(u)), and let Y1, ..., Yk CV, and X1, ..., Xk C V be subsets of the observables, and let x1,...,xk be specific values of Xis. Denote by (Yi)x; the potential response of variables Yi when setting Xi = xi. The SCM M induces a family of joint distributions over counterfactual events (Y1)x1,..., (\u03a5\u03ba)\u03b1\u03ba:\nPM((Y1)x1,..., (Yk)xk) = \u22111(Yi)x; (u) = yi) P(u).\n(14)\nu\ni=1"}, {"title": "3. Interaction Analysis", "content": "In this section, we introduce the key concepts of interaction analysis. Throughout, we assume that the data we are analyzing is compatible with the causal diagram. The diagram consists of a treatment variable X (assumed to be binary for most of the exposition), a set of confounders Z, a set of mediators W, and the outcome variable Y. Here, Z and W can be thought of as multi-dimensional, while X, Y are singletons. We begin by explaining the overview figure and how the section is organized, and then delve into the technical details.\nThe notion of structural interactions (part a of Fig. 2a, Def. 8) is introduced first \u2013 a definition of the ground truth for how interactions of causal pathways can be conceptualized through the lens of structural causal models. This notion would serve as a basis for one to ascertain whether pathways interact, if the knowledge of the true underlying SCM M was available. We then move onto defining higher-order contrasts (part b, Def. 9), which extend the notion of a contrast considered in the\n3.1 Structural Interactions\nTo begin, we provide a structural account of pathway interactions. The structural interaction criteria we introduce can be evaluated based on the full knowledge of the structural causal model, and represent the \"ground truth\" that determines if pathways interact:\nDefinition 8 (Structural Interaction Criteria) Consider the causal diagram, and let fy(X, Z,Uy) be the structural mechanism of the Y variable. We say that there is no structural interaction of total and spurious effects, written Str-TE-SE = 0, if either of the following hold:\n(i) we can write the mechanism fy(X,Z,Uy) as\nfy(X, Z, Uy) = f(1) (X, Uy) + f(2) (Z, Uy).\n(21)\n(ii) Z is not an input to the mechanism fx of X.\nFurther, consider Fig. 2b and let fy(X, Z,W,Uy) be the structural mechanism of the Y variable. We say that there is no structural interaction of direct and indirect effects in the causal diagram in Fig. 2b, written Str-DE-IE = 0, if either of the following hold:\n(iii) we can write the mechanism fy(X, Z,W,Uy) as\nfy(X, Z,W,U\u2084) = f(1) (X, Z, Uy) + f(2) (Z, W, Uy).\n(22)\n(iv) X is not an input to the mechanism fw of W."}, {"title": "3.2 Higher-Order Contrasts & x-specific Measures", "content": "We next introduce the distinction between first order, second order, and third order contrasts, and then instantiate some well-known first and second-order contrasts:\nDefinition 9 (First, Second, and Third Order Contrasts) Let Co, C1, C, C' be counterfactual clauses, and E0, E1 be observed events. We categorize the following types of contrasts:\n(1) A first order causal contrast C\u00b9(C0, C1, E, E), of the form\n- \u03a3[Yc\u2081 (u) \u2013 Yco (u)] \u00d7 P(u | E).\n(36)\nu\n(2) A first order spurious contrast C\u00b9 (C, C, E0, E1), of the form\n\u03a3Yc(u) \u00d7 [P(u | E\u2081) \u2013 P(u | Eo)].\n(37)\nu\n(3) A second order causal-causal contrast C\u00b2(Co, C1, C, C', E, E), of the form\n\u03a3[(YC1,C' (u) \u2013 Yco,c' (u)) \u2013 (YC\u2081,c(u) \u2013 Yco,c(u))] \u00d7 P(u | E).\n(38)\nu\n(4) A second order causal-spurious contrast C\u00b2(Co, C1, E0, E1), of the form\n\u2211 [Yc\u2081 (u) \u2013 Yco (u)] \u00d7 [P(u | E\u2081) \u2013 P(u | Eo)].\n(39)\nu\n(5) A third order causal-causal-spurious contrast C\u00b3 (C0, C1, C, C', E0, E1), of the form\n\u03a3[(YC1,C(u) \u2013 Yco,c(u)) \u2013 (Yc\u2081,c' (u) \u2013 Yco,c' (u))] \u00d7 [P(u | E\u2081) \u2013 P(u | Eo)].\n(40)\nu\nExample 3 The average treatment effect (ATE) is a first order causal contrast since it can be written as:\nATE20,21 (Y) = \u2211 [Yz1 (u) - Yxo (u)] \u00d7 P(u) = C\u00b9({xo}, {x1}, 0, 0).\n(41)\nu\nThe measure of causal-spurious effect interaction introduced in Eq. 10 of Ex. 1, can be written as\nE[Y#1 - Yxo | X1] - E[Yx1 \u2013 \u03a5\u03c0\u03bf | 20] = \u2211 [Yx\u2081 (u) \u2013 \u03a5\u03c0\u03bf (u)] \u00d7 [P(u | x\u2081) \u2013 P(u | xo)]\n(42)\nu\n= C\u00b2({xo}, {x1},{x},{x1}),\n(43)"}, {"title": "3.3 Admissibility of x-specific Measures", "content": "So far, we introduced the notions of structural interaction (Def. 8) and the x-specific measures of interaction (Def. 10). The key question we ask next is whether the x-specific measures of interaction are useful for capturing structural interactions. As shown in the following key result, the answer is affirmative:\nProposition 2 (Structural Admissibility of Interaction Tests)\nStr-TE-SE = 0 X-TE-SEx0,21(y) = 0,\n(59)\nStr-DE-IE = 0 X-DE-IEx0,x1(y | x) = 0.\n(60)\nIn words, the proposition shows that whenever there is no total-spurious interaction at the structural level, the corresponding interaction effect x-TE-SE equals 0. The same also holds for the direct-indirect interaction and the corresponding x-DE-IE interaction effect. The key of the proposition is in the contrapositive of the mentioned statements. That is, whenever we find that\nX-TE-SEx0,x1 (y) \u2260 0,\n(61)\nit implies that an interaction at the structural level must exist. The usefulness of this observation comes from the fact that the effect x-TE-SEx0,21 (y) can be estimated non-parametrically from data, and testing the hypothesis Ho: x-TE-SEx0,x1 (y) = 0 provides a valid test for testing if Str-TE-SE = 0 (and analogously for the DE-IE interaction). Therefore, the admissibility result in Prop. 2 allows us to move from evaluating the existence of structural interactions based on the knowledge of the structural causal model (almost never available to us), to a practical approach which can be carried out based on data and suitable causal assumptions (such as those encoded in the diagram in Fig. 2b)."}, {"title": "3.4 Decomposing the TV Measure", "content": "Armed with the structural understanding of different (interaction) effects, we can now decompose the TV measure:\nTheorem 1 (TV Decomposition with Interactions) The total variation (TV) measure can be decomposed as:\nTVx0,x1(y) = x-TEx0,x1(y | xo) + x-SEx0,x1(y) + x-TE-SEx0,x1(y).\n(62)\nFurthermore, the TV measure can also be decomposed as:\nTVx0,x1(y) = x-DEx0,x1(y | X0) + x-IEx0,x1(y | xo) + x-DE-IEx0,x1 (Y | XO)\n+x-SEx0,x1(y) + x-TE-SEx0,x1 (Y).\n(63)"}, {"title": "3.5 Interaction Testing", "content": "We next move to the aspect of variation analysis called interaction testing. Previously, measure for quantifying interactions were developed, and these have been shown as admissible with respect to the structural notions of interaction. Next, a formal procedure to test if an interaction is significant (and, implicitly, to test whether an interaction exists on the structural level) is introduced. We begin with the definition of an interaction test:\nDefinition 11 (Interaction Test) Let C be a contrast admissible with respect to a structural in-teraction criterion. We say that a hypothesis test of the form\nHo: C(D) = 0\n(69)\nis called an interaction test.\nExample 4 (Total-Spurious Interaction Test) Consider the x-specific total-spurious interaction effect x-TE-SEx0,x1(y). The hypothesis test\nHo: x-TE-SEx0,x1 (y) = 0\n(70)\nis an interaction test for the structural criterion Str-TE-SE.\nThe reasoning behind interaction testing is rather simple. Generally, interactions make the interpretation of causal effect decompositions more difficult. In statistics, there is often a preference for parsimony, whenever such parsimony is justifiable. Therefore, we propose an approach in which an interaction effect C is tested against 0, based on some available data D. If there is no evidence of the effect being different from 0, we may use a more parsimonious version of the TV decomposition. Based on the above, we propose an approach for interaction testing presented in Alg. 1. First, the hypothesis x-TE-SEx0,x1(y) = 0 is tested, and if this hypothesis is not rejected, one can use a more parsimonious representation of the TV decomposition, in which the effect x-TE-SEx0,x1 (y) = 0 is removed (see Eq. 67). Second, the hypothesis x-DE-IEx0,21 (y | xo) = 0 is tested. If the hypothesis is not rejected, one can again use a more parsimonious TV decomposition, in which the effect x-DE-IEx0,x1 (y | xo) is removed (see Eq. 68). More parsimonious decompositions, naturally, lead to more easily interpretable decompositions for practitioners."}, {"title": "4. More Granular Interactions", "content": "So far, we described an approach for testing the interaction of total and spurious effects (TE-SE), and direct and indirect effects (DE-IE). The summary of the approach is shown in Tab. 1. Two types of interactions tests were considered, and the implications of these tests for the TV decomposition are provided.\nOften, however, the objective may be an even more granular analysis: to distinguish between direct and spurious, indirect and spurious, or even direct-indirect-spurious interactions. The following example illustrates why considering such more granular interactions is more involved than considering the TE-SE and DE-IE interactions:\nExample 5 (DE-SE Interaction) Consider the following structural causal model M:\nZ\u2190 Ez\n(71)\nX - Bern(\n(1+ez)\n(72)\nW\u2190 \u03b5w + Z\n(73)\nY + W + XW2,\n(74)\nwhere ez,\u025bw ~ N(0,1). The model is compatible with the causal diagram in Fig. 2b. When computing the quantity\nx-DE-SEx0,x1(y) := E[Yx1,W20 - Yxo | X1] - E[Yx1,W20 - Yxo | XO],\n(75)\nwe find that it equals 1. The quantity in Eq. 75 attempts to measure how much the direct effect of a xo \u2192 x1 transition, written Yx1,W20 - Yxo, changes for units with X(u) = x1 vs. X(u) = xo. Therefore, the quantity measures the interaction of direct and spurious paths, and in M, it is different from 0. However, when looking at the fy mechanism, we see that there is no term corresponding to the X, Z interaction.\nThe reader will note the issue at hand: in the diagram in Fig. 2b, the spurious effect of X on Y may be transmitted along two different paths: firstly, it may be transmitted along the X \u2190 Z \u2192 Y path, but may also be transmitted along the X \u2190 Z \u2192 W \u2192 Y path. It is the latter path that is active in the SCM M in the above example. Previously, when testing the TE-SE interaction in the diagram in Fig. 1b, there was a single causal path X \u2192 Y, and a single spurious path X \u2190 Z \u2192 Y. Similarly, for the direct and indirect paths in Fig. 1a (or Fig. 2b), there was a single direct X \u2192 Y path and a single indirect X \u2192 W \u2192 Y path. This one-to-one correspondence between an effect"}, {"title": "Definition 12 (Granular Structural Interaction Criteria)", "content": "Definition 12 (Granular Structural Interaction Criteria) Consider the causal diagram in Fig. 2b, and let fy(X, Z,W,Uy) be the structural mechanism of the Y variable. We say that there is no structural interaction of direct and spurious effects, written Str-DE-SE = 0, if either of the following hold:\n(i) Z is not an argument of fx,\n(ii) Z is not an argument of fw and we can write the mechanism fy(X, Z,W,Uy) as\nfy(X, Z,W,Uy) = f(1) (X,W,U\u2084) + f(2) (Z,W,Uy),\n(76)\n(iii) we can write the mechanism fy(X, Z,W,Uy) as\nfy(X, Z,W,Uy) = f(1) (X, U\u2084) + f(2) (Z, W, Uy).\n(77)\nFurther, we say that there is no structural interaction of indirect and spurious effects, written Str-IE-SE = 0, if either of the following hold:\n(i) Z is not an argument of fx,\n(ii) X is not an argument of fw,\n(iii) we can write the mechanism fw as\nfw(X, Z,Uw) = f(1) (X,Uw) + f(2) (Z,Uw),\n(78)\nand the mechanism fy as\nfy(X, Z,W,Uy) = f(\u00b9) (X, Z, U\u2084) + Wf(2) (X,U\u2084),\n(79)\n(iv) W is not an argument of fy.\nWe say that there is no structural interaction of direct, indirect, and spurious effects, written Str-DE-IE-SE = 0, if either of the following hold:"}, {"title": "Definition 13 (Granular Effect Interactions)", "content": "Definition 13 (Granular Effect Interactions) Consider the following effect interactions:\nx-DE-SEx0,x1(y) = [E(Yx1,W20 | X1) - E(Yxo | x1)] - [E(Yx1,W20 | 10) - E(Yxo | xo)]\n(83)\nx-IE-SEx0,x1(y) = [E(Yxo, Wa\u2081 | X1) - E(Yxo | X1)] - [E(Yx0,W#1 | Xo) \u2013 E(Yxo | Xo)]\n(84)\nx-DE-IE-SEx0,x1(y) = [E(Yx1 | X1) - E(Yx0,W#1 | X1)] - [E(Yx1,Wzo | X1) - E(Yxo | X1)]\n(85)\n- [[E(Y21 | \u03a7\u03bf) \u2013 \u0395(Yx0,W#1 | Xo)] \u2013 [E(Y21,W20 | Xo) \u2013 E(\u03a5\u03c0\u03bf | \u03a7\u03bf)]] (86)\nAgain, to obtain a better insight into the quantities, we look at their structural basis expansion. For instance, the quantity x-DE-SE can be expanded as:\nx-DE-SEx0,21 (y) = \u03a3[Y21,Wao (u) \u2013 Yxo (u)] \u00d7 [P(u | x1) - P(u | xo)].\n(87)\nu\nThe unit-level direct effect, Yx1,W20 (u) \u2013 Yxo (u), is integrated against a posterior difference P(u | X1) - P(u | xo) that induces a difference along the spurious path. In this way, we see that the quantity is a second-order causal-spurious contrast (recall Def. 9), measuring the interaction of the direct and spurious effects. For indirect-spurious interactions, we have the quantity\nX-IE-SEx0,21 (y) = \u2211 [Yxo, Wa\u2081 (4) - Yxo (u)] \u00d7 [P(u | x\u2081) - P(u | xo)].\n(88)\nu\nThe interpretation is again very similar, where the unit-level indirect effect Yx0, W21 (u) - Yxo (u) is integrated against the posterior difference P(u | x\u2081) - P(u | xo). The quantity, therefore, captures the indirect-spurious interaction. Finally, for quantifying the three-way interaction, we can use the quantity\nx-DE-IE-SEx0,21 (y) = [(x1,W#1 - Yxo, Wa\u2081) (4) - (x1,W20 - Yx0,W20)(u)]\n(89)\nu\n\u00d7 [P(u | x\u2081) - P(u | xo)].\n(90)"}, {"title": "Theorem 2 (Total TV Decomposition)", "content": "Theorem 2 (Total TV Decomposition) The TV measure admits the following decomposition:\nTVx0,x1(y) = x-DEx0,x1(y | xo) + x-IEx0,x1 (y | xo) + x-SEx0,x1(Y)\n(91)\n+x-DE-IEx0,x1 (y | xo) + x-DE-SEx0,x1(y) + x-IE-SEx0,x1 (y)\n(92)\n+x-DE-IE-SEx0,x1 (y).\n(93)\nThe above theorem is a crown result of the paper. The TV measure can be decomposed into first order direct, indirect, and spurious effects (Line 91), the direct-indirect, direct-spurious, indirect-spurious interaction effects (Line 92), and the three-way interaction of direct, indirect, and spurious effects (Line 93). Once again, one may use an interaction testing procedure as in Alg. 1 to obtain a more parsimonious TV representation in case some of the second or third order effects are not significantly different from 0. Once again, this type of interaction testing is justified through the following admissibility result (analogous to Prop. 2):\nProposition 3 (Structural Admissibility of Granular Interaction Tests)\nStr-DE-SE = 0 X-DE-SEx0,x1 (y) = 0,\n(94)\nStr-IE-SE=0 x-IE-SEx0,x1(y) = 0,\n(95)\nStr-DE-IE-SE = 0 X-DE-IE-SEx0,x\u0131 (y) = 0.\n(96)\nPractical Implications. There are a number of practical implications resulting from the TV decomposition in Eqs. 91-93. Firstly, when the hypothesis\nHDE-IE : X-DE-IEx0,x1 (y | xo) = 0\n(97)\nis rejected, the practitioner can conclude that the mediator value W = w modifies the direct effect, namely that the controlled direct effect\nCDEx0,x1 (Yw) = \u0395[Yx1, - \u03a5\u03c0\u03bf,\u03c9]\n(98)\nvaries according to levels of W = w. Investigating such an effect along different W = w levels may therefore be informative. Similarly, the existence of DE-SE or IE-SE interactions implies that there is heterogeneity in the controlled direct effect\nCDEx0,x1 (Yw,z) = E[Yx1,2,w - Yxo,z,w],\n(99)\nmeaning that the practitioner may wish to focus on the heterogeneity of the CDEx0,x1 (Yw,z) accord-ing to levels of Z = z, W = w to learn more about the phenomenon under study. An alternative view of the DE-SE interaction is that the DE may vary according to Z = z, namely that\nz-DEx0,x1 (y | z) = E[Y11,W20 - Yxo | Z]\n(100)\nmay vary with Z = z (and similarly for Z = z). We discuss some tools for investigating this in the next section."}, {"title": "4.1 Population Granularity", "content": "In this section, we discuss population granularity, and the testing of interactions along different subpopulations of the data. We begin with a motivating example:\nExample 6 (DE-IE Interaction Testing) Consider the SCM M given by:\nZ \u2190 Bernoulli(0.5)\n(101)\nX \u2190 Bernoulli(0.5)\n(102)\nW-1-X\n(103)\nY \u2190 (2Z \u2013 1)XW.\n(104)\nIf we test for the interaction of direct and indirect effects, using the measure\nx-DE-IEx0,x1 (y|x) = [E(Yx1,W20 | x) - E(Yxo,W20 | x)] - [E(Yx1,Wa\u2081 | x) - E(Yx0,W#1 | x)] (105)\nwe find that for both x \u2208 {x0,x1}, we have\nX-DE-IEx0,x1 (y | x) = 0.\n(106)\nTherefore, based on the measure x-DE-IEx0,x1(y|x) we cannot detect an interaction of direct and indirect effects, even though X influences W and there is a term with an interaction XW in fy. However, when we consider the difference [Yx1,W20 - Yx0, W20] (u) - [Yx1,W#1 -Yx0,W#1] (u) averaged across units u with Z(u) = 0 and Z(u) = 1, respectively, we find that\n[E(Yx1,W20 | 21) - E(Yx0,W20 | 21)] - [E(Yx1,W#1 | 21) - E(Yx0,W#1 | \u22481)] = 1\n(107)\n[E(Yx1,W20 | 20) - E(Yx0,Wzo | Z0)] - [E(Yx1,W#1 | 20) - E(Yx0,Wz1 | 20)] = \u22121\n(108)\nTherefore, an interaction that was not visible in the x-DE-IEx0,x1(y | x) = 0 effect, becomes visible once the conditioning on X = x is replaced by the conditioning on Z = z.\nThe above example illustrates an important concept of power, previously discussed in (Ple\u010dko and Bareinboim, 2024). In particular, x-DE-IEx0,x1 (y | x) measures the direct-indirect effect interaction across all units compatible with X(u) = x. It can be thus be expanded as:\nX-DE-IEx0,x1 (yx) = E([Yx1,W#0 (u) \u2013 Y20,Wzo (u)] - [Yx1,Wa\u2081 (4) - Yx0,Wa\u2081 (u)] | X = x), (109)\n= \u03a3\u0395 ([Y11,Wao (u) \u2013 Y20,Wao (u)] - [Y21,W21 (4) - Yx0,Wa\u2081 (u)] | X = x, Z = z)\n(110)\nz\n\u00d7 P(Z = z | X = x).\nIn the causal diagram, we have that Yx,w, X | Z = z for any choice of x, x', known as conditional ignorability, which is a consequence of the fact that there are no back-door paths between X, Y. In the SCM M in Eqs. 101-104 of Ex. 6, we also have XIIZ, and hence we can write:\nx-DE-IEx0,21 (y | x) = \u03a3\u0395 ([Y11,Wao (U) \u2013 Yxo, Wao (u)] - [Y21,Wa\u2081 (4) - Y20, W21 (u)] | Z = z) (111)\nz\n\u00d7 P(Z = z | X = x)\n= \u2211z-DE-IEx0,x1 (y | z)P(Z = z),\n(112)\nwhere z-DE-IEx0,x1 (y | z) = E([Y21,W20 (u) \u2013 Y20,Wzo (u)] \u2013 [Y21,W21 (U) \u2013 Y20,W#1 (u)] | Z = z).\nTherefore, x-DE-IEx0,x1 (y | x) is a mixture of the z-specific direct indirect interaction effects, which"}, {"title": "5. Experiments", "content": "In this section, we perform an empirical evaluation of the proposed methods. The first part of the experiments focuses on synthetic data with a known ground truth, while the second part inves-tigates interactions in real-world datasets. For performing interaction testing, we use the known identification expressions for the required potential outcomes (Pearl, 2000; Ple\u010dko and Bareinboim, 2024), which are valid for the causal diagram. We then estimate the associated measures from observational data, by deriving the efficient influence functions and performing one-step bias correction to derive the estimators. All of the code used for the experiments can be found in the associated Github repository.\n5.1 Synthetic Experiments\nWe begin by analyzing synthetic data with a known ground truth. We consider five SCMs, labeled M1 to M5, with details given in Appendix D. In Tab. 2, we provide a summary of which interactions are active in the SCMs M\u2081 to M5. Then, over 100 repetitions and over a range of sample sizes we generate a random dataset D(i,n) of n samples from each SCM. In each instance, we estimate the measures associated with TE-SE, DE-IE, DE-SE, IE-SE, and DE-IE-SE interactions using data D(i,n). Based on asymptotic normality, we also derive the p-values for each interaction test. Whenever there is no interaction, meaning that C = 0 (on the population level) and the null-hypothesis Ho for an interaction test , we expect the distribution"}, {"title": "5.2 Real-World Data", "content": "The goal of the second part of the evaluation is to understand how often we detect different types of interactions. The experimental part is intended to answer the question of \"how often do causal path-ways interact in real-world datasets?\". For answering this question, we use a selection of 10 datasets including data in criminal justice, economics, marketing, banking, medical treatments, epidemiology, and public health. For each dataset, we first construct the graphical model shown in Fig. 2b. This is done by selecting the X, Z, W, and Y variable sets. Again, we consider the five types of interaction as before, namely the interactions of spurious and total effects, and direct and indirect effects, appearing"}]}