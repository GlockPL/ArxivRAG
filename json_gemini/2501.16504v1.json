{"title": "Digital Twin Enabled Site Specific Channel Precoding: Over the Air CIR Inference", "authors": ["Majumder Haider", "Imtiaz Ahmed", "Zoheb Hassan", "Timothy J. O'Shea", "Lingjia Liu", "Danda B. Rawat"], "abstract": "This paper investigates the significance of designing a reliable, intelligent, and true physical environment-aware precoding scheme by leveraging an accurately designed channel twin model to obtain realistic channel state information (CSI) for cellular communication systems. Specifically, we propose a fine-tuned multi-step channel twin design process that can render CSI very close to the CSI of the actual environment. After generating a precise CSI, we execute precoding using the obtained CSI at the transmitter end. We demonstrate a two-step parameters' tuning approach to design channel twin by ray tracing (RT) emulation, then further fine-tuning of CSI by employing an artificial intelligence (AI) based algorithm can significantly reduce the gap between actual CSI and the fine-tuned digital twin (DT) rendered CSI. The simulation results show the effectiveness of the proposed novel approach in designing a true physical environment-aware channel twin model.", "sections": [{"title": "I. INTRODUCTION", "content": "The sixth-generation (6G) of wireless cellular technologies is envisioned to deliver ultra-high spectral efficiency and extremely low latency as well as support huge connectivity for the Internet of Everything (IoE) applications facilitating high-fidelity immersive wireless experiences [1], [2]. 6G seeks to bring revolutionary technologies to ensure full integration of the digital, physical, and human realms for seamless interaction among them. Ultra-massive multiple-input multiple-output (MIMO) will be the key transmission technology for dense environments in 6G. It will employ highly directional narrow beams that can dynamically adapt to changing environments. Efficient precoding at the transmitter end is essential to implement advanced beamforming that can track users in real-time, notably enhancing overall system efficiency. Since precoding is a function of channel state information (CSI), to facilitate precoding, precise knowledge of CSI with low overhead or without overhead at the transmitter end is highly significant.\nHowever, having perfect knowledge of CSI at the transmitter end with low overhead is very challenging. Conventionally, channel estimation in predefined pilot carrying time slots at the receiver end and feeding it back to the transmitter to obtain CSI increases computational overhead. On the other hand, nowadays deep learning (DL) aided CSI acquisition technique is receiving significant attention as an alternative approach providing"}, {"title": "II. SYSTEM MODEL", "content": "Signal Model: Fig. 1 shows a multi-input single-output orthogonal frequency division multiplexing (MISO-OFDM) downlink communication system. We consider the time-varying frequency-selective multipath fading channel along with the deployment of linear precoding to maximize the received signal power by exploiting transmit diversity. The base station (BS) is equipped with $N_T$ antennas to create transmit diversity and a single antenna at the user equipment (UE) for the signal reception. The system operates over a transmission bandwidth divided into $N_S$ orthogonal subcarriers. Let us assume that the transmitted information bits are represented by $s$, the corresponding baseband modulated symbols (e.g., binary phase shift keying (BPSK), quadrature phase shift keying (QPSK), M-ary quadrature amplitude modulation (M-QAM), etc.) for the $k \\in \\{1,2,..., N_S\\}$ OFDM subcarrier are denoted as $S_k$. $B_k$ represents the precoding factor, which is a function of the underlying channel between BS and UE, depending on the type of precoding scheme. The precoded transmitted signal for antenna $t \\in \\{1,2,\\ldots, N_T\\}$ can be expressed as $X_t = S_kB_t$. Let us denote $H_k$ as the underlying frequency domain channel response for subcarrier $k$ and the communication link between antenna $t \\in \\{1,2,..., N_T\\}$ of BS and UE. After performing the inverse fast Fourier transform (IFFT), the time domain representation of $X_t$ and the channel impulse response (CIR) can be denoted as $x_t[m]$ and $h_t[m]$, respectively, for the OFDM symbol $m = \\{1,2,\\ldots \\}$. Note that $n_1 \\in \\{1,2,\\ldots,N\\}$ and $n_2 \\in \\{1,2,\\ldots,n_t\\}$ present the indices for time domain signal and CIR, respectively. Note that $n_t$ denotes the length of (frequency-selective) CIR for the communication link between antenna $t \\in \\{1,2,\\ldots, N_T\\}$ of the BS and the UE. Adding the cyclic prefix (CP) of $\\tau$ samples to each OFDM symbol $m$ yields $x_t[m], n \\in \\{1,2,\\ldots, N_t + \\tau\\}$. The received signal vector for OFDM symbol $m$ from $N_T$ transmit antennas can be expressed as\n\\begin{equation}\ny[m] = \\sum_{t=1}^{N_T} x_t[m] * h_t[m] + w[m],\n\\end{equation}\nwhere $(*)$ represents convolution operation, $w[m]$ denotes the additive white Gaussian Noise (AWGN) vector, where each element possesses zero mean and variance $\\sigma^2$. Here, $x_t[m]$ and $h_t[m]$ present the transmit signal vector of size $1 \\times (N_t + \\tau)$ and CIR of size $1 \\times n_t$, respectively for OFDM symbol $m \\in \\{1,2,...\\}$. UE removes the CP and executes the fast Fourier transform (FFT) operation to obtain the signals in the frequency domain. Without loss of generalization, we consider perfect channel knowledge for data detection. In practice, different blind estimation techniques can be applied at the UE for estimating the CIR and can thereby eliminate the requirements of pilot transmission, albeit at the expense of higher computational complexity. The transmit signal can be detected at the receiver by applying linear and non-linear equalization schemes. The equalized signal is expressed as $\\hat{S}_k$, which is then demodulated to obtain the estimated bits $\\hat{s}$.\nPrecoding Schemes: We consider two linear precoding schemes: maximum ratio transmission (MRT) and minimum mean square error (MMSE). For MRT precoding, the precoding vector for antenna $t$, $B_t$ is computed as $B_t = (\\hat{H}_t)^* [10]$, where $(^*)$ represents the conjugate operation and $\\hat{H}_t$ is the estimated channel frequency response. It is worth mentioning that the objective of this paper is to obtain $\\hat{H}_t$ from the proposed true environment-aware channel twin model. For MMSE precoding, $B_t = (\\hat{H}_t)^*((\\hat{H}_t)(\\hat{H}_t)^*+ \\frac{1}{P_t})^{-1}$ [10], where $P_t$ is the transmit power for antenna $t \\in \\{1,2,\\ldots, N_T\\}$. Here, $(\\cdot)^T$ denotes the transpose operation."}, {"title": "III. ENVIRONMENT AWARE CHANNEL TWIN MODEL", "content": "In this section, we describe our proposed multi-step channel twin design process including the real-world CIR data collection. The architecture and the functionality of the proposed AI-driven channel twin model are presented."}, {"title": "A. Real Radio Environment", "content": ""}, {"title": "B. Ray Tracing Aided 3D Modeling", "content": "In this subsection, we emphasize RT-aided three-dimensional (3D) modeling to create an initial version of a channel twin model, which is then tuned with an optimized material selection process to create a digital replica of the real-world wireless environment. In particular, we demonstrate this two-step tuning approach of the RT 3D model to render high-fidelity (HF) CIR.\n1) RT Propagation Physics Optimization: We portrayed a virtual 3D environment of the location of our interest shown in Fig. 3(b). First, we import the specific location (the place where real data was captured) of Ballston, Arlington, Virginia using OpenStreetMap into Blender. We then add the ground plane and scale the imported 3D map in Blender. In the 3D model, all buildings and roads are defined with the appropriate radio materials. The model is then imported into the SIONNA-RT [11] so that the RT tool can identify the objects of the 3D model for wireless signal multipath propagation. After importing the 3D virtual model of the real environment into SIONNA, we incorporate a transmitter (BS) and a receiver (UE) into the model by defining their location, antenna parameters, and operating frequency. A key feature of RT is the handling simulation of multipath propagation, where a signal from the transmitter reaches the receiver through multiple paths such as line of sight (LoS) path, reflected, diffracted, and scattered paths due to the propagation physics. In the RT emulation, we consider the impact of all three (reflection, diffraction, scattering) major propagation physics to incorporate the characteristics of the real environment. Moreover, the number of rays traced has a crucial impact on generating realistic CIR. Since an increasing number of rays can capture multipath signal propagation effects and the signal interaction with the surface and objects more precisely, it can thus render higher accuracy in creating a channel twin model and provide high-fidelity predictions of signal strength and coverage, optimizing the parameters pertinent to propagation physics. We have illustrated the comparative analysis of varying numbers of ray impact in generating CIR in Section IV. However, the interaction of a large number of rays in complex environments is computationally resource intensive. It requires significant computational power and time to execute the simulation while incorporating a large number of rays into the 3D RT model.\n2) EM Material Optimization: In RT emulation, the use of electromagnetic (EM) materials plays a crucial role in how electromagnetic waves interact with different surfaces and objects such as buildings, roads, and terrains. The interaction of rays with EM materials depends on their EM properties, such as refractive index, permittivity, conductivity, absorption, and scattering properties. To make 3D RT emulation more realistic, complex calculations are required to properly handle the interaction of rays with EM materials, especially when multiple effects occur simultaneously (e.g., reflection, diffraction, and scattering). Moreover, different types of EM material effects influence how rays reflect, diffract, and scatter when interacting with an EM material [12]. By combining these effects, RT algorithms can produce highly realistic digital replicas that mimic real-world physical radio signal interactions. Anticipating that fact, we implement the following 3 different frequently used EM material choices (MC) described in Table II as trial and error basis to determine the most suitable EM material"}, {"title": "C. Architecture AND Functionality of AI-Driven Algorithm", "content": "The proposed AI-driven algorithm incorporates the modified U-Net architecture, which consists of two main parts: a compression path called the encoder and an expansion path called the decoder. The deep denoising U-Net model with encoder and decoder architecture was proposed with very high precision for the image segmentation task [14]. The primary objective of our AI-driven algorithm is to analyze the correlation between the synthetic CIR dataset from the RT emulation after applying the aforementioned two-step tuning approach and the actual CIR captured through the driving test. To facilitate the objective, refer to Fig. 3, the encoder neural network (NN) consists of an input layer and $L_e-1$ hidden blocks. The input features of the encoder NN are $R\\{h_{rt}\\}$ and $I\\{h_{rt}\\}$, where $R$ and $I$ denote the real and"}, {"title": "IV. SIMULATION RESULTS", "content": "Parameter Specifications: In this section, we present the numerical performance evaluation for the proposed multi-step optimization process to provide optimized CIR close to the real CIR sequentially. The performance metric is the bit error rate (BER). The effective signal-to-noise ratio (SNR) is computed as $SNR = 1/\\sigma^2$. We assume that a precise computation of channel inversion is conducted. Throughout the simulations, we consider the QPSK modulation scheme and zero-forcing equalizer for data detection.\nFor the CIR prediction task, noisy and real CIR dataset scaling, dataset separation into training, testing, and the DNN modeling are executed using the MATLAB DL toolbox via Monte Carlo simulations. We assume $N_T = 4$, $N_S = 128$, $\\tau = 16$, $\\xi = 0.0008$, $L_e = L_d = 5$, and $L = 5$ unless otherwise stated. We consider total $R = 112,000$ realizations of data samples that are separated into training and testing purposes as 70% and 30%, respectively for both the proposed and baseline schemes, and $F = 2$. In the DNN-aided prediction task, we consider the same environment for training and testing while conducting simulations for experiments. It is worth noting here that after importing the RT emulation-generated CIR into MATLAB, we first scale the dataset as well as the real CIR dataset. We consider the sampling frequency $F_s = 30.72$ MHz. Unless otherwise stated, Fig. 4 considers the MRT and the MMSE precoding scheme, Fig. 5, and Fig. 6 consider only the MMSE precoding scheme at the BS.\nAI-driven Baseline Scheme: A fully connected multi-layer perceptron (MLP) model is considered as a baseline AI-driven scheme to demonstrate the effectiveness of our proposed scheme. The fully connected DNN model consists of a sequential input layer, $L_L - 2$ hidden layers, and a final output regression layer.\nGenie-Aided Scheme: In this scheme, we consider that the exact CIR is available at the transmitter for calculating $B_t$. Note that this scheme is not practically realizable. However, it results in a lower bound of BER that assists in presenting the relative performances of the proposed scheme.\nPerformance Evaluation of RT Propagation Physics Optimization: In Fig. 4, we show the impact of different numbers of rays in generating CIR on the end-to-end BER, computed while utilizing the captured actual CIR (genie-aided scheme) and the CIR generated by the RT emulation. As expected, increasing the number of rays decreases the gap between the BERs computed using actual CIR and the CIR generated by RT emulation. A large number of rays in RT assists in capturing multipath propagation scenarios effectively. It is observed that the decreasing rate of BER is much higher in the higher range of SNR values when switching from RT-low-fidelity (LF) CIR (number of rays considered $10^3$) to RT-moderate-fidelity (MF) CIR (number of rays considered $10^4$) compared to RT-MF CIR to RT-HF CIR (number of rays considered $10^5$). Fig. 4 also illustrates the performance gap between the MRT and the MMSE linear precoding technique.\nPerformance Evaluation of EM Material Optimization: Fig. 5 illustrates the significance of choosing proper EM material to get reasonable BER performance. Although the BER performance gap among three different EM MC is not significant, the appropriate EM material selection can play an important role in reducing the BER gap calculated using actual CIR (genie-aided precoding) and the HF CIR generated by RT emulation. Refer to Table II, EM MC1 gives lower BER compared to others in the considered 3D scene."}, {"title": "Performance Evaluation of the Proposed DNN Model Prediction", "content": "In Fig. 6, we show the significant improvement of the BER performance after using the predicted CIR from the comprehensive channel twin, where the RT scenario is enhanced by data-driven approach. The proposed supervised DNN model is trained with the two-step fine-tuned RT-HF CIR as input features and the actual CIR as the output label. A properly trained DNN model assists in predicting CIR that is much closer to the actual CIR. Hence, the proposed scheme shows a notably reduced gap in BER performance compared to the genie-aided scheme. Moreover, Fig. 6 depicts that the proposed DNN model prediction significantly outperforms the baseline MLP DNN model.\nTo articulate the efficiency of the proposed AI-driven channel twin model, we compute the normalized mean squared error (NMSE) for two cases. Case 1 calculates the NMSE between the actual CIR and the predicted CIR from the fine-tuned RT-HF model, whereas Case 2 computes the NMSE between the actual CIR and the predicted CIR from the proposed data-driven approach. Table III demonstrates that the NMSE for Case 2 is significantly lower than that for Case 1, highlighting the efficacy of the proposed AI-driven comprehensive channel twin model in accurately computing the Channel Impulse Response (CIR)."}, {"title": "V. CONCLUSIONS", "content": "This work proposes a novel approach to design a true physical environment-aware channel twin model that can replicate the channel very close to the real channel. Specifically, we proposed a multi-step fine-tuning approach to rectify CIR generated by RT emulation in order to create the twin of the real channel. First, we propose a two-step tuning approach in RT emulation to generate HF CIR. Then, final tuning with the aid of the proposed AI-driven algorithm can render CIR close to the actual CIR. Simulation results reveal that the proposed precoding scheme can exhibit BER performance close to that of the optimal genie-aided scheme."}]}