{"title": "Principal Curvatures Estimation with Applications to Single Cell Data", "authors": ["Yanlei Zhang", "Lydia Mezrag", "Xingzhi Sun", "Charles Xu", "Kincaid Macdonald", "Dhananjay Bhaskar", "Smita Krishnaswamy", "Guy Wolf", "Bastian Rieck"], "abstract": "The rapidly growing field of single-cell transcriptomic sequencing (scRNAseq) presents challenges for data analysis due to its massive datasets. A common method in manifold learning consists in hypothesizing that datasets lie on a lower dimensional manifold. This allows to study the geometry of point clouds by extracting meaningful descriptors like curvature. In this work, we will present Adaptive Local PCA (AdaL-PCA), a data-driven method for accurately estimating various notions of intrinsic curvature on data manifolds, in particular principal curvatures for surfaces. The model relies on local PCA to estimate the tangent spaces. The evaluation of AdaL-PCA on sampled surfaces shows state-of-the-art results. Combined with a PHATE embedding, the model applied to single-cell RNA sequencing data allows us to identify key variations in the cellular differentiation.", "sections": [{"title": "I. INTRODUCTION", "content": "The estimation of principal curvatures and principal directions is crucial in uncovering directional changes within data manifolds. Indeed, the mean and Gaussian curvatures of surfaces have been studied for several decades in computer graphics and some related areas (e.g., [1]-[5]). Recent methods have proposed to estimate curvature over data manifolds derived from point-cloud data via manifold learning techniques (e.g., [6]-[8]). However, achieving precision is challenging given the variations in data density and the necessity for high-quality samplings. To address this, various methods have been developed. Volume-based approaches like diffusion curvature by [9] and [10] heavily depend on accurate distance estimations. Laplace-Beltrami operator-based approaches, as explored in [11] and [9] encounter limitations in accurately estimating curvature from small sample sizes. Second Fundamental Form-based approaches, as proposed in [11], demonstrate relatively high-quality curvature estimation for scalar curvature. However, they rely on fixed parameters for neighborhood selection. We introduce adaptability into the estimation process, addressing the challenges associated with variable data density and the absence of intrinsic curvature information by dynamically adjusting parameters based on the local properties of the manifold. This ensures robustness across diverse manifolds. Our main contributions are:\n\u2022 We estimate the point-wise Gaussian curvature of point clouds and their underlying principal curvatures, i.e. How much the data curves and in which directions it curves the most.\n\u2022 We dynamically adjust neighborhood scales for local PCA and curvature estimation based on the explained variance ratio. This ensures accurate predictions without requiring hand-tuning of the parameters.\n\u2022 We demonstrate the fidelity of our method relative to ground truth (Gaussian and mean) curvatures on canonical 2-manifolds.\n\u2022 We illustrate its application to single-cell data analysis, where principal curvatures suggest the directions of cell differentiation."}, {"title": "II. METHODS", "content": "For differential geometry preliminaries, we refer the reader to [12], as an extensive introduction to this topic would be beyond the scope of this work and its succint presentation."}, {"title": "A. Local PCA", "content": "Our method starts with Local PCA as described in [13].\nGiven a point cloud x1,...,xm, we select a neighborhood Nxi,EPCA := {xj : 0 < ||xj - Xi || < fpca} around each\npoint xi for a hyperparameter \u20acPCA > 0 that has to be determined. Each data matrix containing the neighbors of a\npoint x; is shifted to be centered around xi to get a matrix\nXi = [Xi\u2081 - Xi, ..., Xin, - Xi] where Ni := |N24,PCA|. Then,\nthe columns of Xi are rescaled to Bi = XiDi by applying"}, {"title": "B. Adaptive Local PCA and parameter selection", "content": "AdaL-PCA uses the explained variance ratio for the first two singular values given by\n$\\displaystyle p(r) := \\frac{\\sum_{i=1}^{2} \\sigma_{i}(r)^{2}}{\\sum_{i=1}^{3} \\sigma_{i}(r)^{2}}$\n(1)\nto select a suitable parameter EPCA. This ratio describes the fraction of data variance captured by the tangent plane approximated by the span of the first two singular vectors. We set a threshold y for the ratio p(r) and compute the largest\nr-neighborhood that explains a fraction y of the data variance.\nThat is,\n$\\displaystyle \\epsilon_{PCA} := \\max \\{r | p(r) > \\gamma \\}.$\n(2)\nWe use a similar method to select a radius T\u2082 for estimating the curvature around each data point xi. In this case, we need a neighborhood large enough to capture the \"bending\" of the surface. This is done by computing the lowest value reached by the graph of the explained variance ratio p(r),\n$\\displaystyle \\tau := \\arg \\min_{r} \\{p(r)\\}$.\n(3)\nAs illustrated in Fig.1 at a point p on a torus, this approach is motivated by the fact that as the T-neighborhood increases past a certain threshold, the variance in data can no longer be explained by the selected tangent plane. We refer the reader to Algorithm 1 for a summary of AdaL-PCA's key steps and emphasize that both pc and 7 are adjusted at each data point to capture the local geometry."}, {"title": "C. Curvature Estimation", "content": "The directional curvatures \u03ba\u2081(T) at a point xi in a direction T are approximated (see for instance [14]) by\n$\\displaystyle \\kappa_{i}(T) \\approx \\frac{2N \\cdot T}{||T||^{2}} + O(t).$\n(4)\nHere T is replaced by the entries of X\u2081 in the proper Ti neighborhood and N is the orthonormal vector to the frame obtained by local PCA. The principal curvatures K\u2081 and K2 correspond, respectively, to the highest and lowest values of the directional curvatures. In practice, we select a percentage (20%) of the highest (respectively, lowest) curvatures and average them (using a Gaussian kernel) to approximate K1 (respectively, \u043a\u2082). By selecting the directional vectors T corresponding to the highest curvatures \u043a\u0442, this averaging yields principal directions, while we obtain Gaussian curvature by the product K152. The time complexity of our current implementation is O(n,m(m\u00b2 + log n\u30f6)), where n\u2081 is an upper bound on the cardinality of the T-neighborhoods (in general n < m). This can be improved significantly in practice with fast PCA algorithms for scalability [15], [16]."}, {"title": "III. RESULTS AND DISCUSSION", "content": "Our main contribution is the estimation of the principal curvatures and principal directions. We mainly focus on the application of the principal curvatures and principal directions to biological data and identify key properties and changes in the geometry of these datasets.\nWe validate the accuracy of our principal curvature es- timation by computing Gaussian curvature on toy datasets. Moreover, we apply our estimation of principal curvature and Gaussian curvature for single-cell RNA sequencing data (scRNA-seq).2 Gaussian curvature gives the \u201cintensity\u201d for the differentiation of cell states, and principal directions give the directions for the split of the cell lineages."}, {"title": "A. Estimation on Sampled Surfaces", "content": "We compare AdaL-PCA's estimates of Gaussian curvature against two contemporary methods, Hickok & Blumberg [10] and Diffusion Curvature [9]. We also quantify AdaL-PCA's recovery of ground-truth mean curvature as a validation of the fidelity of its principal curvatures.\nTo assess the ability of various models to recover the Gaussian and mean curvatures, we generate datasets from three canonical 2-dimensional manifolds: the torus, ellipsoid, and the hyperbolic paraboloid (saddle). Tables I and II were generated from 5000 points sampled uniformly from these surfaces. To study the robustness of each method to noise, we corrupt each point:\n$\\displaystyle x_{i}' = x_{i} + \\epsilon_{i}$\nwhere each \u20ac1,... \u20ac\u039d ~ \u039d(0, \u03c3) and \u03c3 between 0.0 and 0.5.\nNote that both Hickok & Blumberg's method and Diffusion Curvature require manually specified parameters, which must be tuned for each dataset. By contrast, AdaL-PCA's heuristics adapt the method to each dataset. This results in an improved performance observed in Fig. I and Fig. II. Diffusion Curvature is an unsigned measure of local curvature for point clouds sampled from a manifold. Although it differs from Gaussian curvature, numerical experiments detailed in [9] suggest a correlation. Therefore, we report only the Pearson correlation for diffusion curvature."}, {"title": "B. Curvature estimation for single-cell data", "content": "We apply our model to single-cell data for cell state dif- ferentiation direction discovery. We use RNA sequencing data for human embryonic stem cells available at [17], collected over 27 days during which cells start as embryonic stem cells and then progressively differentiate into different cellular lineages. Low-dimensional manifold visualization of this data using PHATE (Fig. 4, A) shows that embryonic cells (days 0-3, displayed in red) branch into two lineages: endoderm (upper split) and ectoderm (lower split) around day 6. Further differentiation occurs during days 12-27. This is reflected in Fig. 4B with relatively constant zero curvature values at days 0-3 and a transition into a region of high variations in curvature. We observe starting from day 3 a transition into very low negative values of curvature and then a rapid progression into higher values close to zero as we approach day 27. This is consistent with the fact that the region 0-3 days corresponds to the stem state and the region 12-27 to the differentiated state. In addition to the signed curvature that provides a better appreciation of the cellular differentiation into several lineages (cell types), the principal directions in Fig. 4C, D obtained from projecting the three-dimensional principal directions using the PHATE embedding allow us to track the state towards which the cells differentiate, adding directional information.\nWe estimated the curvature of a publicly available single- cell induced pluripotent stem cell (iPSC) reprogramming. In this dataset, mass cytometry is used to quantitatively mea- sure 33 protein biomarkers in 2005 mouse fibroblast cells induced to undergo reprogramming into stem cell state. Low- dimensional PHATE visualization of this data shows fibrob- lasts progressing to a point of divergence where two lineages emerge, one that successfully undergoes reprogramming and another that undergoes apoptosis (cell death). Our model cor- rectly identifies the initial branching point as having negative values of Gaussian curvature indicating saddle-like divergent paths out of the branching point (Fig. 5). Moreover, the principal directions on the diverging branch correctly identify the directions in which the cell lineages diverge."}, {"title": "IV. CONCLUSION", "content": "We introduced Adaptive Local PCA (AdaL-PCA), a novel method for estimating intrinsic curvature on data manifolds, with a focus on principal curvatures and directions. By dynam- ically adjusting neighborhood scales based on the explained variance ratio, AdaL-PCA provides robust and accurate cur- vature estimates without requiring manual parameter tuning. This adaptability effectively handles variations in data density and the lack of prior curvature information, making it ideal for complex, diverse datasets. We validated AdaL-PCA on synthetic surfaces, demonstrating its ability to recover Gaus- sian and mean curvatures even in noisy settings. Additionally, we applied it to human embryonic single-cell RNA sequenc- ing data, revealing key directions of cellular differentiation and providing biologically meaningful insights. These results highlight AdaL-PCA's potential in both geometric data anal- ysis and practical applications like single-cell studies. Future work may extend the method to higher dimensions for scalar curvature estimation and improve efficiency by integrating neural network-based local distribution estimation or exploring alternative local PCA frameworks."}]}