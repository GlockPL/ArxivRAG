{"title": "Communicating with Speakers and Listeners of Different Pragmatic Levels", "authors": ["Kata Nasz\u00e1di", "Frans A. Oliehoek", "Christof Monz"], "abstract": "This paper explores the impact of variable pragmatic competence on communicative success through simulating language learning and conversing between speakers and listeners with different levels of reasoning abilities. Through studying this interaction, we hypothesize that matching levels of reasoning between communication partners would create a more beneficial environment for communicative success and language learning. Our research findings indicate that learning from more explicit, literal language is advantageous, irrespective of the learner's level of pragmatic competence. Furthermore, we find that integrating pragmatic reasoning during language learning, not just during evaluation, significantly enhances overall communication performance. This paper provides key insights into the importance of aligning reasoning levels and incorporating pragmatic reasoning in optimizing communicative interactions.", "sections": [{"title": "1 Introduction", "content": "In everyday conversations there is a trade-off between clarity and conciseness. Efficient messages might appear under-specified or ambiguous under a literal interpretation but can be successfully resolved using pragmatic reasoning about the speaker's intentions and the context of the communication (Grice, 1975; Horn, 1984; Fox and Katzir, 2011; Davies et al., 2022). If the speaker trusts the listener to make the right inferences, they can choose to be more concise. Being able to infer the intended meaning of an utterance beyond its literal content allows us to communicate efficiently.\nThe process of how people attain pragmatic interpretations using a model of the speaker's intentions has long been studied. There is also plenty of evidence from psycho-linguistic studies that individuals have different levels of pragmatic competence (Franke and Degen, 2016; Mayn et al., 2023). More importantly, people have been shown to keep track of the communicative partner's pragmatic competence and adjust their interpretations and messaging accordingly. This has been demonstrated both with human (Horton and Gerrig, 2002; Mayn et al., 2024) and artificial partners (Loy and Demberg, 2023; Branigan et al., 2011).\nThe pragmatic reasoning modeled in this work involves counterfactual reasoning about alternative sentences that the speaker could have uttered. The interaction in Figure 1 depicts an instance of such pragmatic reasoning about alternatives within our simple environment. According to pragmatic theory (Grice, 1975) the same process accounts for the interpretation \"They are in the office for the rest of the week\", when we hear the sentence \"We are not in the office on Mondays\".\nIn this work, we investigate the impact of varying pragmatic competence on communicative success. We pair literal and pragmatic listeners with speakers of different levels of pragmatic competence. We study the interaction between such speakers and listeners not only during inference, where both"}, {"title": "2 Background", "content": "We situate our listener in an image-based version of Lewis's signaling game (Lewis, 1969). Image-referential games are commonly used to study the benefit of speakers and listeners reasoning about each other in context (Lee et al., 2018; White et al., 2020; Andreas and Klein, 2016).\nAt each turn a collection of N images is provided as context $C = (o_1, ..., o_N)$, with the speaker having knowledge of a specific target image $o_t$, where $1 \\leq t \\leq N$. The listener's objective is to correctly identify the target image index t given the speaker's message w. The messages may contain multiple words by combining words from a fixed vocabulary."}, {"title": "2.1 Literal meanings and the Rational Speech Act model", "content": "Frank and Goodman (2012) provide a concise model for how speakers and listeners reason about each-other when sharing referential content. As a starting point, the model assumes an underlying literal interpretation. This is a function $D(w, o)$ of an utterance w and an observation o, in our case an image. In the original formulation the base interpretation function is a 0-1 valued indicator of the set of messages that are true of the image o. In line with other work, we replace this binary function with a real-valued similarity between the observed image-embedding and text-embedding.\n$\\qquad D(o_i, w) = CNN_o(o)^T RNN_o(w)$                                              (1)\nEach image $o_i$ is individually embedded with a CNN following the ResNet architecture (He et al.,"}, {"title": "2.2 Reasoning while learning", "content": "In the previous subsection 2.1 we saw how to perform recursive reasoning on top of given literal representations $D(o,w)$. These literal interpretations are most commonly initialized by functions learned outside of the context of a referential game and the reasoning is added only during inference (Fried et al., 2018; Lazaridou et al., 2020; Andreas and Klein, 2016; Liu et al., 2023).\nHowever, the optimal literal representations are likely influenced by the reasoning itself. Following the work of Monroe and Potts (2015) and McDowell and Goodman (2019), we would like to integrate the knowledge that the received messages are the result of pragmatic reasoning already during learning. Therefore, we apply recursive reasoning during model training.\nPragmatic listeners seek to update the weights of the literal interpretation $D(o, w)$ but they need to do so by considering the repeated application of Equations 3 and 4. Similarly to McDowell and Goodman (2019), we derive the gradients of the reasoning process with respect to the lexicon weights. By repeated application of the chain rule through the hierarchical reasoning, pragmatic listeners backpropagate through the hierarchical reasoning and update the weights of the image- and utterance-embedding models."}, {"title": "3 Data", "content": "To investigate the impact of the pragmatic competence of speakers and listeners on communicative success, it is necessary to establish a controlled setting that allows for manipulation of the reasoning abilities of participants. We create a new environment based on the ShapeWorld dataset (Kuhnle and Copestake, 2017). Instead of the rule based method of Kuhnle and Copestake (2017), we use an exact implementation of the rational speaker defined in Equation 3. This way we can create speakers with different depth of recursive reasoning. Our speakers are not learned, they are knowledgeable users of the language: they have access to the underlying true lexicon which indicates the mapping between color and shape words and image properties.\nEach game consists of a target image and a variable number of N \u2013 1 distractor images. Images are described by one out of six different colors and a shape that can take five different values. The location, size and rotation of the objects is randomized on a 64x64 grid which creates a large variation of candidate pictures.\nWe parameterize the process that generates the image tuples for each game by four probability distributions: the priors over the shapes $P(S)$ and colors $P(C)$, the probability that controls the correlations between colors $P(C|C)$ and the conditional defining the co-occurrence of shapes $P(S|S)$. We sample these distributions from different Dirichlet-distributions. We create two sets of concentration parameters: in the first version of the game, all sampled distributions are close to uniform (Corr = 0), while in the second version introduces correlations in the shape and color conditionals (Corr = 1). This way the sampled image tuples share more features, creating higher likelihood for pragmatic messaging that differentiates S1 and S3.\nFor training, we sample only one instance of each distribution. At test time, we sample different $P(S), P(C), P(S|S)$ and $P(C|C)$ instances 10 times. From each of these constellations we sample 3200 games.\nThe random seed is fixed across all experiments and is reset for the learning and evaluation of each learner. This ensures that each listener sees the exact same examples in all environments."}, {"title": "4 Experiments", "content": "The fact that we have full control over the speaker's messaging strategy and the data generating process allows us to alter the level of the speakers that the listeners learn from and create image tuples that highlight the contrast between higher level pragmatic and lower level literal messaging strategies.\nWe train train $L_0$ literal listeners and $L_2$ pragmatic listeners. We create two different levels of speakers to pair them with our learning listeners: $S_1$ has an internal model of a competent $L_0$, while $S_3$ anticipates $L_2$-behavior.\nImplementation for training and evaluating all models can be found at https://github.com/naszka/rsa_backward/."}, {"title": "4.1 Results", "content": "In this section, we present the insights gained from simulating language learning and communication between listeners and speakers with pragmatic or literal preferences. First we look at altering speaker and listener levels only during evaluation using an already trained lexicon. Then we turn to the learning dynamics between our four pairs: $L_0$ - $S_1$, $L_0-S_3$, $L_2 - S_1$ and $L_2 - S_3$."}, {"title": "5 Conclusions", "content": "Humans exploit pragmatic reasoning in order to reduce the effort of speaking. For artificial agents to understand humans, it is critical to correctly resolve ambiguities. By recursively modeling the conversational partner, pragmatic listeners can arrive at the interpretations intended by pragmatic speakers.\nIn this work, we introduced speaker-listener pairs with matching or misaligned levels of pragmatic competence. We examined the benefits of integrating pragmatics not only during evaluation but already during language learning. Our results show that learning from more explicit, literal language is always beneficial, regardless of the pragmatic capacity of the learner. At the same time, we conclude that language learners need to apply reasoning about the context and the speaker when learning from data that was generated pragmatically."}, {"title": "6 Limitations", "content": "While the conversational phenomena we model in this paper have been widely attested to in linguistic theory and psycho-linguistic research, our experiments are limited to an artificial sandbox scenario with a small vocabulary and simple observations. The reasoning about all possible utterances used in this paper is intractable with larger vocabularies.\nReal world conversations contain a wide range pragmatic inferences, not all of which can be accounted for by the recursive reasoning presented in this paper."}, {"title": "A Model training and implementation", "content": "All 261838 model-parameters are trained from scratch. The weights are updated with the AdamW optimizer (Loshchilov and Hutter, 2017) which we initialize with a learning rate of 1e - 5.\nFor each training step, we use a batch of 32 games and the listeners are trained for 25920 training steps. Each instance of a listener training took 1.5 GPU hours on a single NVIDIA RTX A6000 GPU."}, {"title": "B Concentration parameters of the image generators", "content": "We sample $P(S)$, $P(C')$, $P(C|C)$ and $P(S|S)$ from Dirichlet distributions. In the case of no correlation between the images (Corr = 0), we set all concentration parameters to 1. For the correlated case (Corr = 1), we introduce correlation between the same shapes and a randomly chosen shape from all five shapes. We achieve this by setting the concentration parameter \u03b1 to 5 at the index that corresponds to the i'th shape and a randomly generated other index. $P(S|S = shape_i) \\sim Dir(a_1, ..., a_5)$, where all a's are 1 except for $a_i = 5$ and $a_j = 5$ for a randomly generated j. We apply the same process for generating all the $P(C|C')$ distributions."}, {"title": "C Benefits of pragmatic reasoning during learning", "content": ""}, {"title": "C.1 Pragmatic listeners learn faster", "content": "Figure 3 shows that when we keep all parameters of the learning environment constant, and only vary the listener's depth, we observe that listeners with higher levels, learn to perform the task with good accuracy faster. The gap in performance is especially large in the initial learning stages. This result is in line with McDowell and Goodman (2019),"}]}