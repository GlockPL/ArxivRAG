{"title": "Heterogeneous Graph Collaborative Filtering", "authors": ["Lianghao Xia", "Meiyan Xie", "Yong Xu", "Chao Huang"], "abstract": "For modern recommender systems, the use of low-dimensional latent representations to embed users and items based on their observed interactions has become commonplace. However, many existing recommendation models are primarily designed for coarse-grained and homogeneous interactions, which limits their effectiveness in two critical dimensions. Firstly, these models fail to leverage the relational dependencies that exist across different types of user behaviors, such as page views, collects, comments, and purchases. Secondly, they struggle to capture the fine-grained latent factors that drive user interaction patterns. To address these limitations, we present a heterogeneous graph collaborative filtering model MixRec that excels at disentangling users' multi-behavior interaction patterns and uncovering the latent intent factors behind each behavior. Our model achieves this by incorporating intent disentanglement and multi-behavior modeling, facilitated by a parameterized heterogeneous hypergraph architecture. Furthermore, we introduce a novel contrastive learning paradigm that adaptively explores the advantages of self-supervised data augmentation, thereby enhancing the model's resilience against data sparsity and expressiveness with relation heterogeneity. To validate the efficacy of MixRec, we conducted extensive experiments on three public datasets. The results clearly demonstrate its superior performance, significantly outperforming various state-of-the-art baselines. Our model is open-sourced and available at: https://github.com/HKUDS/MixRec.", "sections": [{"title": "1 INTRODUCTION", "content": "Modern recommender systems aim to understand users' interests by analyzing their interactions with items, such as clicks, reviews, and purchases. Collaborative filtering (CF) frameworks play a crucial role in generating item recommendations in these systems [5]. The core of most existing CF approaches lies in their ability to map users and items into a shared latent space, effectively capturing users' preferences through various learning techniques [9, 35, 43]. Notable examples of these techniques include multilayer perceptron [14], auto-encoder [24], and graph neural networks (GNNs) [7, 27, 29].\nIn practical Collaborative Filtering scenarios, user interaction data can be characterized by two crucial dimensions: Behavior Heterogeneity and Intent Diversity. Firstly, the interactions between users and items inherently exhibit heterogeneity due to the presence of multiple behavior types [3, 41]. For instance, in E-commerce platforms, users engage in various item-level behaviors such as clicks, reviews, collections, and purchases. Similarly, in video streaming sites, behaviors like watching, liking, and sharing can vary among users. These diverse behaviors reflect the varied preferences of users at a granular level. Secondly, the formation of user-item interactions is influenced by various latent intent factors [18, 28]. For example, users may have specific intentions, such as shopping for family parties or making purchases when products are on sale. However, the entanglement among these diverse user intents presents challenges when modeling heterogeneous user-item interaction patterns, an area that remains largely unexplored in current multi-behavior recommender systems (e.g., MBGCN [15], KHGT [38], SMRec [11]).\nTo enhance the expressiveness of collaborative filtering models and disentangle the hidden factors influencing user-item interactions, considerable research has focused on learning disentangled representations from interaction data. Notable studies include MacridVAE [22], which uses a variational auto-encoder framework; the graph neural network-based DGCF [28]; and the geometry-based GDCF [50]. While these methods have proven effective, they often overlook the benefits of incorporating behavior heterogeneity to capture diverse user-item relationships. Despite the potential advantages of addressing intent disentanglement alongside multi-behavior modeling, the area of heterogeneous disentangled collaborative filtering remains largely unexplored.\nHowever, this task presents non-trivial challenges: (i) The design of intent disentanglement must be approached with meticulous care to ensure that the resulting factorized representations effectively capture the expressive information pertinent to different types of user-item interactions. (ii) The limited availability of target behavior data (e.g., purchases, likes) poses a significant obstacle for most supervised multi-behavior recommender systems (e.g., MBGCN [15] and KHGT [38]), which struggle to facilitate customized knowledge transfer between auxiliary and target behaviors due to the scarcity of labeled instances. Inspired by the remarkable success of Self-Supervised Learning (SSL), data augmentation emerges as a pivotal enabler for achieving accurate user representation learning under conditions of label scarcity. In order to harness the benefits of SSL for heterogeneous collaborative filtering with intent disentanglement, it is crucial to carefully adapt the SSL tasks, ensuring their adaptability and effectiveness in empowering disentangled contrastive learning to handle the diverse user-item interactions.\nConsidering the challenges outlined above, we propose a novel heterogeneous graph collaborative filtering model, referred to as MixRec, which addresses behavior heterogeneity and disentangled intent factors through adaptive multi-behavior data augmentation. In MixRec, we begin by encoding users' relation-aware latent intents using a parameterized heterogeneous hypergraph, generating factorized representations that are specifically relevant to a particular type of user-item interaction. Each type of hyperedge is carefully tailored to aggregate diverse intent embeddings while considering the disentangled global collaborative relationships. To enhance the generalization capacity for encoding personalized multi-behavior dependencies from sparse interaction data, we introduce a relation-wise contrastive learning paradigm. This paradigm effectively models behavior heterogeneity at both the node and graph levels, incorporating adaptive self-supervision. Within our MixRec, we integrate multi-behavior discrimination objectives into the adaptive contrastive learning process. This integration ensures that the factorized representations with intent disentanglement accurately reflect the heterogeneous context.\nIn summary, our work makes the following key contributions:\n\u2022 Problem. We explore recommender systems from the new perspective of learning factorized representations pertinent to diver user-item interactions. By elucidating the intent disentanglement with interaction heterogeneity encoding, this work allows recommenders to capture fine-grained diverse preference of users.\n\u2022 Methodology. We propose a novel heterogeneous graph collaborative filtering paradigm, MixRec, that uncovers latent intent factors in heterogeneous user-item interactions. MixRec comprises two key components: (i) a learnable intent disentanglement module based on a parameterized heterogenous hypergraph neural network to encode diverse latent factors, and (ii) a relation-wise contrastive learning model with hierarchical structures for adaptive data augmentation at node- and graph-levels, facilitating the extraction of both local and global disentangled factors.\n\u2022 Theoretical Analysis. We include a theoretical discussion that validates the efficacy of our model, particularly highlighting the strengths of adaptive self-supervised data augmentation. We also provide a comprehensive rationale analysis for our heterogeneous hypergraph contrastive learning paradigm.\n\u2022 Experiments. Our MixRec method is evaluated on multiple public datasets to show the obvious performance improvement compared with a variety of baselines. We conduct further analysis to validate the model robustness, efficiency and interpretability."}, {"title": "2 PRELIMINARIES", "content": "In our heterogeneous collaborative filtering scenario, the relationships between users (ui, where i ranges from 1 to I) and items (vj, where j ranges from 1 to J) are manifested through diverse interactions, such as clicks, reviews, and purchases. Specifically, we partition K types of heterogeneous user-item interactions into the target behavior (e.g., purchase in e-commerce or like in a video streaming platform) and other auxiliary behaviors, such as click, collect and watch, review. To represent heterogeneous interactions, we define a three-way tensor X \u2208 RI\u00d7J\u00d7K. Each element xi,j,k = 1 indicates that user ui has interacted with item vj with the k-th behavior type, while xi,j,k = 0 represents unobserved interactions.\nIn practical scenarios, users exhibit diverse intentions when interacting with items in recommender systems, influenced by factors including explicit preferences, implicit interests, temporal dynamics, social influences, and contextual information. Therefore, disentangled representation learning for heterogeneous collaborative filtering becomes essential to capture and model these varied user intentions effectively and comprehensively. This approach enables a better understanding of distinct user preferences in multi-behavior patterns, ultimately improving recommendation accuracy.\nTask Formulation. With the foregoing definitions, the heterogeneous disentangled collaborative filtering can be formally stated as follows: Input. The set of observed user-item heterogeneous interactions, denoted as X. Output. The learning function f(\u00b7), which makes predictions for unobserved user-item interactions of the target interaction type (such as purchase or like). The function simultaneously explores the heterogeneous user-item interactions and captures the underlying disentangled user intentions within the context of relation heterogeneity."}, {"title": "3 METHODOLOGY", "content": "3.1 Multiplex Graph Relation Learning\nIn our heterogeneous collaborative filtering, we utilize the heterogeneous interaction data X to create a multiplex interaction graph G that captures diverse relationships between users and items. Inspired by successful GNN-based representation learning methods [9, 25, 46], we employ a relation-aware message passing approach.\n$Z_{i,k}^{(u/v)} = \\sum_{j \\in N_{i,k}} m_{i,j} e_j,$\n$Z_i^{(u/v)} = \\sum_{k=1}^{K} Z_{i,k}^{(u/v)}$\n(1)\nThe set of neighboring nodes for user ui and item vj under the k-th behavior type are denoted as Ni,k and Nj,k, respectively. To address overfitting, we apply dropout operators, represented by mi, j and mj,i, with binary values during the information aggregation process [34]. Theo symbol denotes the broadcasting multiplication operation. The general node embeddings for u\u00a1 and vj, represented by e\u00a1 and ej respectively, are initialized through random sampling. The type-specific behavior embeddings for ui and vj with behavior type k are denoted as $z_{j,k}^{(u)}$ and $z_{j,k}^{(v)}$, respectively. The aggregated multi-typed behavior representations, $\\bar{a}_i^{(u)}$ and $\\bar{a}_i^{(v)}$ are generated using the sum-pooling operator. To enhance model efficiency [5, 13], MixRec employs a compact design for graph message passing."}, {"title": "3.2 Relation-aware Intent Disentanglement", "content": "To gain insights into the diverse intentions that underlie heterogeneous user preferences in recommendation systems, we propose incorporating the disentanglement of latent factors alongside behavior heterogeneity across different types of user-item interactions. Drawing inspiration from the effectiveness of hypergraph structures in modeling high-order connectivity [8, 44], we construct a heterogeneous disentangled hypergraph that integrates the diversity of user intents with multi-behavior user-item interactions.\nIn our approach, for each type of user-item interaction, we generate multi-channel hyperedges of size E, which represent the number of latent intents for user interaction preference. These hyperedges connect different user/item nodes through parameterized node-hyperedge dependency modeling, enabling the capture of relation-aware global collaborative relationships. In essence, we generate learnable hypergraph adjacency matrices, denoted as $H_k^{(u)} \\in R^{I \\times E}$ and $H_k^{(v)} \\in R^{J \\times E}$, which connect nodes and hyperedges under the k-th type of user-item interactions. This construction allows us to effectively model and explore the intricate relationships between users, items, and latent intents in a context-aware manner.\n$H_k^{(u)} = \\Sigma_k^{(u)}. W_k^{(u)}, H_k^{(v)} = \\Sigma_k^{(v)}. W_k^{(v)T}$\n(2)\nThe behavior-aware user embeddings, denoted as $E_k^{(u)} \\in R^{I \\times d}$, and item embeddings, denoted as $E_k^{(v)} \\in R^{J \\times d}$, are composed using the aggregated representations $\\bar{a}_i^{(u)}$ and $\\bar{a}_i^{(v)}$. These embeddings capture the specific behaviors associated with the k-th interaction type. The parameters $W_k^{(u)}$ and $W_k^{(v)} \\in R^{E \\times d}$ represent the embedding matrices for the hyperedges related to the k-th interaction type. Each embedding vector in these matrices encodes the latent features corresponding to a specific user intent."}, {"title": "3.3 Parameterized Multi-Relational Hypergraph", "content": "3.3.1 Hypergraph Structure Learning. With learnable hypergraph structures facilitating latent intent disentanglement, MixRec employs hypergraph-guided message passing to enhance user and item embeddings. This approach effectively captures user- and item-wise global collaborative relationships at fine-grained intent levels. The relation-aware hypergraph embedding propagation between leaf nodes and intent hyperedges is defined as follows:\n$\\mathcal{H}_k^{(u/v)} = \\delta(\\bar{H}_k^{(u/v)}\\Gamma_k^{(u/v)}) = \\delta(\\bar{H}_k^{(u/v)} S(\\bar{H}_k^{(u/v)T}Z_k^{(u/v)}))$\n(3)\nThe matrices $\\bar{H}_k^{(u)} \\in R^{I \\times d}$, $\\bar{H}_k^{(v)} \\in R^{J \\times d}$ represent the smoothed node embeddings under the k-th behavior type for users and items, respectively. The non-linear activation function LeakyReLU is denoted by \u03b4(.). The embeddings of the E hyperedges under the k-th behavior type for users and items are denoted as $\\Gamma_k^{(u)} \\in R^{E \\times d}$ and $\\Gamma_k^{(v)} \\in R^{E \\times d}$, respectively. Here, $\\Gamma_k = \\delta(\\bar{H}Z_k)$. In our disentangled hypergraph module, MixRec takes $Z_k^{(u)} \\in R^{I \\times d}$ and $Z_k^{(v)} \\in R^{J \\times d}$ (encoded from Equation 1) as input node embeddings. Through behavior-aware hypergraph message passing with intent disentanglement, MixRec captures the diverse intents behind multiplex user-item interactions, resulting in improved user representations. The overall user/item embeddings \u0124 are generated by sum-pooling the heterogeneous embeddings Hk."}, {"title": "3.4 Hypergraph Embedding Propagation", "content": "By combining local graph convolutions and global hypergraph message passing, MixRec applies the two modules alternately to recursively enhance user/item embeddings, injecting high-order information. Starting with the initialized node embeddings E(u) and E(2), denoted as 0-order embeddings $A^{(u,0)}$ and $A^{(v,0)}$, the l-th order node embeddings can be calculated iteratively as follows:\n$A^{(u,l)} = \\sum_{j \\in N^{(u,l)}} e_j + \\mathcal{H}_k^{(u,l)} +A^{(u,l-1)}$\n$\\bar{a}^{(u,l)} = f(A^{(v,l-1)}); \\hat{H}^{(u,l)} = g(\\bar{a}^{(u,l)})$\n(4)\nThe function f(\u00b7) represents relation-aware graph convolutions applied to the multiplex interaction graph G. The function g(\u00b7) corresponds to the parameterized heterogeneous hypergraph neural network, which facilitates relation-aware intent disentanglement. To mitigate the problem of gradient vanishing, we incorporate a residual connection [12]. The final embeddings are obtained through a multi-order aggregation process, as outlined below:\n$\\Psi^{(u)} = \\sum_{l=0}^{L} \\hat{H}^{(u,l)}, \\Psi^{(v)} = \\sum_{l=0}^{L} \\hat{H}^{(v)}$\n(5)"}, {"title": "3.5 Multi-Relational Alignment with Adaptive Contrastive Augmentation", "content": "Data sparsity is a common issue in heterogeneous collaborative filtering, where most users have limited supervision labels for behaviors like purchasing or liking. To enhance the model's capacity to capture diverse collaborative relationships, we developed a hierarchical contrastive learning paradigm utilizing hypergraph structures. This approach derives self-supervised signals from the original multi-behavior interaction data, incorporating both node-level and graph-level contrastive augmentation while preserving the dependencies among different behavior types. Our multi-relational hierarchical contrastive learning paradigm offers a comprehensive solution to the challenges of data sparsity and effectively encodes heterogeneous collaborative relations for recommendation.\n3.5.1 Node-Level Adaptive Augmentation. The diverse interactive patterns exhibited by users on online platforms result in varying dependencies among different types of behavior. For example, while some users may frequently favorite or like videos on TikTok, they may find it challenging to receive likes on the videos they have watched from others. To effectively capture these personalized multi-behavior patterns, our MixRec integrates a meta network encoder with self-supervised learning, enabling adaptive data augmentation. By leveraging multi-behavior self-discrimination, we model cross-type behavior relationships while preserving the personalized semantics associated with each behavior. To accomplish this, our meta network encoder is specifically designed to dynamically transform auxiliary behavior embeddings of different types, ensuring flexibility and adaptability in the encoding process.\n$\\bar{H}_{i,k}^{(u,l)} = \\sum_{k' \\in (K - i)} \\delta(Norm(H_{i,k}^{(u,l)})w_{i,k}^{(u,l)} +b_{i,k}^{(u,l)})$\n(6)\nThe behavior-aware user embeddings, denoted as $\\bar{H}_{i,k}^{(u,l)} \\in R^{I \\times d}$, are adaptively transformed from the meta network for the l-th graph propagation layer. The activation function and the l2 normalization"}, {"title": "3.5.2 Graph-Level Adaptive Augmentation", "content": "MixRec. To accomplish this, we first employ sum-pooling to aggregate the disentangled intent-aware information from all type-specific hyperedge embeddings. This aggregation process yields the behavior-specific hyperedge representation $\\Gamma_{k'}$ at the global graph-level. Subsequently, we consider the target-auxiliary behavior pairs as positive contrasting instances. Inspired by the negative sample generation strategy in graph infomax [16, 26], we construct graph-level negative pairs by randomly shuffling the learned hypergraph adjacent matrix, resulting in corrupted user embeddings $\\overline{\\Gamma}_{k'}$. Formally, the graph-level multi-relational contrastive regularization is introduced through the following loss formulation:\n$L_g = - \\sum_k log \\frac{exp(s(\\Gamma_{k'}, \\Gamma_k))}{exp(s(\\overline{\\Gamma}_{k'}, \\Gamma_k)) + exp(s(\\Gamma_{k'}, \\overline{\\Gamma}_k))}$\n(8)\nBy employing the devised multi-relation contrastive learning, our MixRec approach utilizes adaptive contrastive self-supervised learning to enhance the modeling of multi-behavior dependencies derived from sparse and diverse interactions. This approach brings forth several advantages, including improved model robustness and enhanced recommendation performance."}, {"title": "3.6 Model Optimization", "content": "Utilizing the prediction score $X_{i,j,k} = \\Psi_i^{(u)}. \\Psi_j^{(v)T}$, we apply the pair-wise marginal loss function to the objective optimization. In particular, we randomly select S positive and negative sample pairs for each user from their interacted and non-interacted items under the target behavior type. The overall optimized objective, which includes the recommendation loss, as well as the node-level and graph-level contrastive learning objectives, is defined as follows:\n$L = \\sum_{i=1}^{N} \\sum_{s=1}^{S} max(0, 1 - \\sigma (X_{i,ps,k'} - X_{i,ns,k'}))+\\lambda_1 \u00b7 ||\\Theta|| + \\lambda_2 \u00b7 L_n + \\lambda_3 \u00b7 L_g$\n(9)\nThe weights \u03bb1, A2, A3 are utilized to individually regulate the influences of weight-decay regularization, node-level contrastive regularization, and graph-level contrastive regularization.\nModel Complexity Analysis. We conducted a time complexity analysis of MixRec considering its three key modules: i) The complexity of multiplex graph relation learning is O(|X|\u00d7d\u00d7L), where"}, {"title": "3.7 In-Depth Discussion of MixRec", "content": "3.7.1 Adaptive Self-Supervision of MixRec. We show that our heterogeneous hypergraph message passing mechanism not only generates additional supervision signals, but also provides learnable weights that facilitate adaptive CF training. Specifically, prediction scores Xi,j,k' given by a vanilla GNN can be decomposed as:\n$XG_{i,j,k'} = a_i. <E_i, E_j>. a_{j'}$ (10)\nwhere ai, aj' represent coefficients related to node degrees in the heterogeneous interaction graph. Compared to vanilla GNNs shown above, our MixRec generates more supervision signals with learnable strengths coefficients, improving the parameter learning. Specifically, the prediction scores of MixRec can be decomposed:\n$\\hat{H}i \\hat{H}j = \\sum_{e=1}^{E} \\sum_{i'=1}^{I} \\sum_{j'=1}^{J} \\beta_i \\beta_{j'}<\\delta(H_{i'e} H_{j'e}), H_ie H_{je}>$ (11)\nAssuming 8(\u00b7) as the identity function, the high-order embeddings Hi and Hj can be associated with coefficients \u1e9ei' and \u1e9ej'. In contrast to ai' and aj used in vanilla GNNs, the weights \u1e9ei and \u1e9ej' have two distinct characteristics: i) they are non-zero for all nodes in the graph, extending beyond the L-hop neighborhood, and ii) they are adaptively learnable, enabling the MixRecto optimize across heterogeneous graph structures.\n3.7.2 Rationale of Graph Multi-Relational CL. The graph-level contrastive learning objective of MixRec is able to adaptively and efficiently maximize the cross-relation similarity between nodes. This adaptive maximization is based on the strengths of nodes' connections to global hyperedges, which reflect the global connectivity of the nodes. Specifically, using dot-product as the similarity measurement s(), we have the following simplified loss:\n$L_g = \\sum_{k=1}^{K} -\\overline{k} \\overline{ik} + log (exp(\\overline{ik}\\overline{i}k) + exp(\\overline{i}\u00b4k\\overline{i}k))$ (12)\nwhere $k'$ and $\u00b4T\u012a\u0141$ denote the positive and negative terms of contrastive learning, which can be further decomposed into:\n$-=\\sum \\sum \\hat{H} \\hat{H}_{i,2} \\hat{i}_{,k\u00b4} \\hat{i}_{,k} e_1,e_2 =\\hat \\sum \\sum \\hat{H} \\hat{H}_{i,2} \\hat{i\u00b4}_{,k} e_1,e_2$"}, {"title": "5 RELATED WORK", "content": "Multi-Behavior Recommender Systems. Recent advancements have leveraged diverse user interactions to enhance predictions in multi-behavior recommender systems [2, 42, 47], utilizing techniques such as GNNs to capture high-order behavior-aware connectivity. Notable models include MBGCN [15], a graph convolutional method, KHGT [38], utilizing graph attention, and GNMR [37], which uses memory-based attention mechanisms for encoding behavior semantics. SMRec [11] proposes star-type contrastive regularization for self-supervised signal generation. Despite these developments, none have explored the benefits of learning latent intent factors from heterogeneous user-item interactions. This study aims to fill this gap by introducing a parameterized heterogeneous hypergraph to learn disentangled multi-behavior representations.\nDisentangled Representation for Recommendation. Recommendation systems enhanced with disentangled representation learning aim to uncover latent factors in complex interaction data [1, 4, 30]. Techniques like GCN in DGCF [21] facilitate intent-aware disentangled message passing, while MacridVAE [22] employs a variational auto-encoder to disentangle user representations. GDCF [50] uses non-Euclidean frameworks to disentangle user-item interactions, inspired by hybrid geometries representation learning. DcRec [33] introduces disentangled contrastive learning in social recommendations. Despite these innovations, current methods do not fully address the heterogeneity of user behaviors, a significant challenge for disentangled collaborative filtering.\nContrastive Augmentation for Recommendation. Contrastive Learning (CL) has become a key method in recommendation [31], improving both graph-based collaborative filtering and sequential recommendation. For instance, models like SGL [34] and RecDCL [48] refine user and item representations through self-discrimination tasks. In sequential recommendations, CL4SRec [23] and DuoRec [40] enhance sequence representations using techniques like masking, cropping, and reordering. CL is also applied in various areas, including micro-video recommendation [32], social-aware recommendation [20], and group recommendation [19]."}, {"title": "6 CONCLUSION", "content": "This paper introduces MixRec, addressing heterogeneous disentangled collaborative filtering by learning factorized representations that separate latent intents in user interactions. We enhance the embeddings' expressiveness and robustness with a hierarchical contrastive learning method, using adaptive augmentation through parameterized heterogeneous hypergraphs. Our experiments on public datasets show MixRec's superior performance. Future work will explore pre-training with heterogeneous hypergraphs to further improve representations for diverse recommender systems."}, {"title": "ETHICAL CONSIDERATIONS", "content": "In this section, we explore the ethical implications of the MixRec model, which aims to disentangle heterogeneous interaction patterns between users and items to enhance recommendation accuracy. We will examine and discuss potential ethical challenges that may arise during the implementation and operation of the MixRec.\nPrivacy and Data Security. The MixRec framework, like other collaborative filtering systems, relies heavily on extensive user data to personalize content recommendations, raising significant privacy concerns for all stakeholders involved. To protect user information from unauthorized access and potential breaches, it is essential to implement comprehensive data security measures, including robust encryption practices, secure data storage solutions, and regular security audits. Additionally, transparency regarding the usage and handling of user data is crucial, ensuring that users are fully informed and have consented to the utilization of their information.\nTechniques such as data anonymization and differential privacy should be employed to minimize the risk of re-identifying individuals from collected data, thereby safeguarding the confidentiality and security of user activities within the system.\nBias and Fairness. Inherent biases in the data used to train collaborative filtering algorithms, such as those in the MixRec framework, can perpetuate and amplify these biases, potentially leading to unfair outcomes for specific user groups. Addressing these biases is crucial and necessitates the implementation of fairness-enhancing techniques, including the development of models sensitive to demographic parity and equality of opportunity. Regular audits of recommendation outputs are essential to identify, monitor, and rectify any emerging biases. Additionally, adjusting algorithms to promote the visibility of underrepresented or niche content helps mitigate the dominance of popular items in recommendations. These measures ensure a balanced representation of diverse content, fostering a more inclusive and equitable platform for all users."}]}