{"title": "STAMPsy: Towards SpatioTemporal-Aware Mixed-Type Dialogues for Psychological Counseling", "authors": ["Jieyi Wang", "Yue Huang", "Zeming Liu", "Dexuan Xu", "Chuan Wang", "Xiaoming Shi", "Ruiyuan Guan", "Hongxing Wang", "Weihua Yue", "Yu Huang"], "abstract": "Online psychological counseling dialogue systems are trending, offering a convenient and accessible alternative to traditional in-person therapy. However, existing psychological counseling dialogue systems mainly focus on basic empathetic dialogue or QA with minimal professional knowledge and without goal guidance. In many real-world counseling scenarios, clients often seek multi-type help, such as diagnosis, consultation, therapy, console, and common questions, but existing dialogue systems struggle to combine different dialogue types naturally. In this paper, we identify this challenge as how to construct mixed-type dialogue systems for psychological counseling that enable clients to clarify their goals before proceeding with counseling. To mitigate the challenge, we collect a mixed-type counseling dialogues corpus termed STAMPsy\u00b9, covering five dialogue types, task-oriented dialogue for diagnosis, knowledge-grounded dialogue, conversational recommendation, empathetic dialogue, and question answering, over 5,000 conversations. Moreover, spatiotemporal-aware knowledge enables systems to have world awareness and has been proven to affect one's mental health. Therefore, we link dialogues in STAMPsy to spatiotemporal state and propose a spatiotemporal-aware mixed-type psychological counseling dataset. Additionally, we build baselines on STAMPsy and develop an iterative self-feedback psychological dialogue generation framework, named Self-STAMPsy. Results indicate that clarifying dialogue goals in advance and utilizing spatiotemporal states are effective.", "sections": [{"title": "Introduction", "content": "One in eight people worldwide is living with mental health conditions, yet the growing demand for mental health care is facing significant challenges due to insufficient resources of existing consultants(World Health Organization 2023). The uneven distribution of face-to-face counseling resources and the high cost of therapy have exacerbated the situation of mental disorders(Ierardi, Bottini, and Riva Crugnola 2022). Thanks to the development of generative AI tools, such as Large Language Models(LLMs), online counseling is gradually becoming a good alternative to traditional face-to-face counseling (Olawade et al. 2024; Song et al. 2023).\nRecent studies have leveraged LLM to aid clients in obtaining better online psychological counseling(Ke et al. 2024; Wang et al. 2023), falling into two categories: \u2460task-oriented dialogues or recent LLM-based simulations in psychology theory assume that clients have explicit goals (comfort-seeking, therapy querying, etc.)(Wang et al. 2024c; Chen et al. 2023); \u2461non-task dialogue-modeling approaches with pre-trained models for single-turn QA or multi-turn empathic dialogue(Liu et al. 2021a; Zheng et al. 2023). Almost none of these studies naturally mix different types of dialogue(called mixed-type dialogues). However, in real-world application scenarios, there are multiple dialogue types in psychological counseling. For example, as shown in Fig.1, the psychological counseling bots could proactively make QA or conversational recommendations after task-oriented dialogue for diagnosis to improve user experience. However, to the best of our knowledge, no previous research has been done on this challenge. To mitigate this challenge, we present a novel task, mixed-type dialogues for psychological counseling, as shown in Fig.1.\nBesides, beyond verbal conversations and body language, time and environment are two important nonverbal cues that affect counseling(Sherry, Paula, and Cynthia 2009) and mental health(Woo and Postolache 2008; Levitan et al. 2019). Therefore, we delve into the spatiotemporal states for this task, leading the model to generate more world-aware answers. For recommending therapy, therapists generally give different advice for late-night insomnia and early morning awakening, relaxation exercises before bed, and avoiding long naps.\nTo facilitate the study of this task, we collate the first SpatioTemporal-Aware Mixed-type dialogues dataset for Psychological counseling(STAMPsy), stamped with spatiotemporal state and psychological helping skills, including five dialogue types: task-oriented dialogues for diagnosis, knowledge-grounded dialogue, conversational recommendation, empathetic dialogue, and QA, containing 5,006 dialogues and 61,832 utterances, with at least three dialogue types in each dialogue of STAMPsy. It should be noted that data processing is guided by psychological professionals. Specifically, we propose organizing the data according to the professional psychological theory of \"Case Conceptualization\", including modules to gain the client's profile and personal information, spatiotemporal state, and goal, checked by professionals. As shown in Figure 1, to help clarify the client's goal, the therapist proactively gives recommendations like scale testing and therapies, interspersed with emotional solace. Furthermore, the counselor's reply changes with time and environment. Although both suffer from insomnia, client #1 hopes to fall asleep, while client #2 hopes to stay alert during the day. Therefore, the counselor offers different suggestions, relaxation ways, and coffee respectively, which vividly demonstrates the effectiveness of spatiotemporal state on mixed-type dialogue.\nTo promote research on mixed-type dialogues for psychological counseling, we conduct bench-marking experiments on STAMPsy for the three sub-tasks: Helping Skills Selection, SpatialTemporal State Processing(STSP), and Adaptive Retrieval Augmented Generation. Moreover, inspired by (Asai et al. 2023), we propose a novel Iterative Self-Feedback framework termed Self-STAMPsy to self-reflect on the consultation process and optimize model, imitating the supervision report and fine-tuning pre-trained dialogue models for comparison with different instruction texts as input and adaptive retrieval-augmented generation from knowledge graph. Experimental results also demonstrate that utilizing the above four modules improves the answers. Our contributions are summarized as follows:\n\u2022 To the best of our knowledge, we are the first to identify the new challenge that there are multiple dialogue types in psychological counseling for online clients.\n\u2022 To mitigate this challenge, we propose the first Chinese mixed-type dialogue dataset stamped with the spatiotemporal state and goals for psychological counseling (STAMPsy), where the spatiotemporal state of counseling is stamped to better connect the psychological dialog system with reality and explore clients' potential emotional responses to their surroundings.\n\u2022 We build baselines on STAMPsy and propose a novel iterative self-feedback framework Self-STAMPsy simulating the supervision process. Extensive experiments demonstrate that helping skill, spatiotemporal state and self-feedback retrieval can improve performance."}, {"title": "Related Work", "content": "Recently, large language models(LLMs) with professional expertise and much better inferential capability have the potential to converse like a real person(Wang et al. 2024a; Tao et al. 2024), leveraging their capabilities for tasks like reasoning and interaction. Especially in psychology, LLMs are proven capable of replacing human participants in experiments(APA 2024), like emulating human social dynamics(Park et al. 2023; Wang et al. 2024b). Therefore, we make LLMs serve as therapists and clients to generate data similar to counseling dialogues. However, previous research has mainly focused on simply establishing an identity for LLMs, with limited relative information and without considering complex scenarios in real-world counseling(Cho et al. 2023). We include the spatiotemporal state during counseling and the goal sequence of the client-counselor dialogue, which influences the client's emotional state, and is crucial for assisting LLMs in better solving clients' problems."}, {"title": "Dataset Collection", "content": "This paper aims to construct a spatiotemporal-aware mixed-type dialogue dataset for online psychological counseling. To more authentically reflect the patterns of real-world psychological counseling, we devise multiple modules to mimic practical counseling case report patterns. The construction flowchart is presented in Figure 2.\nData Source Given privacy concerns, it is difficult to obtain real-world consultation records. Therefore, we first collected a 2.6GB knowledge base with a large number of psychologically oriented books, scales, past counselor exam papers, and other materials. Then, we analyzed public cases and in-depth descriptions from popular counseling books(KAMA 2015; Sherry, Paula, and Cynthia 2009; Hill 2009). To better fit the online context, we also selected conversations from PsyQA(Sun et al. 2021), a Chinese dataset of psychological health support with the Helping Skills Theory. To ensure the controllability of the content generated by the agent system, the topics are in the ideal topic list for the laboratory activity(see Appendix B). After collection, we filter private information, divide long cases into several meetings manually, and ultimately collect 4,000 single texts as the origin input.\nPsychological counseling tends to be a long, multi-turn dialogue, and response quality hinges on communication coherence and personal information consistency. Inspired by (Park et al. 2023), we use short-term memory to update the context. For long-term memory, continuous interactions, personal information, psychological knowledge, and spatiotemporal stamps help maintain persona consistency. We utilize LLMs serving as structured psychological assistants to capture information from original case text and collate them into triples in the form of [Domain|Slot|Value]. \u201cDomain\" includes \u201cPersonal Information\u201d, \u201cSpatial-Temporal Information\" and \"Psychological Knowledge\".\nWe collate \"Personal Information\" with nine slots step by step, including \u2460Personal Profile and Background, \u2461Problem Presentation, \u2462Comorbidity, \u2463Stressors, \u2464Treatments Received with their efficacy, adherence, and satisfaction, \u2465Strengths, \u2466Summary Risk and Protective Factors, \u2467Outcomes and possible Barriers. More details are shown in Appendix A.\nSpatialTemporal Information The increasingly popular online text psychological support enables counseling to take place anytime, anywhere(Liu and Gao 2021). However, previous online counseling dialogue systems cannot comprehend complex scenarios with limited information. Therefore, we focus on the spatiotemporal state to better connect the reality. Moreover, spatial effects, environment, and time are three important nonverbal behaviors in communication because people have emotional responses to their surroundings(Sherry, Paula, and Cynthia 2009). Accordingly, for each round of conversation, we extract and label non-private spatiotemporal state $ST_i$ such as time, location, or weather based on regular expressions, and conclude their influence on mental health to spatiotemporal stamps. More details are shown in Appendix C."}, {"title": "Dataset Annotation", "content": "Dataset annotation involves labeling dialogue goals and exploring knowledge graphs, done by 8 psychology experts. The goals are split into counselor's helping skill(Hill 2009) and client's behaviors(Hill et al. 1992)(right of Fig. 2 in parentheses), with detailed guidance(see Appendix E) and knowledge triples provided to assist annotation. To ensure annotators understand the process, a trial annotation precedes the formal one.\nDuring trial annotation, we extensively analyze the generated conversations above and find that the goals sequence patterns in the dialogue are similar to Counselor Helping Skills commonly used in psychology(Bickmore, Schulman, and Sidner 2011; Hill 2009; Lent, Hill, and Hoffman 2003). Thus, we assume that each counseling can be realized through an organized helping skill sequence, which may reveal the common the layout of high-quality mixed-type conversation in psychological counseling, simplifying the process of data annotation.\nInspired by MultiWOZ(Budzianowski et al. 2018), for each dialogue session, we provide a targeted dialogue helping skill sequence assigned by at least three of eight helping skills(Hill 1986), which are \"Immediacy\u201d(Imme.), \u201cInterpretations\" (Inptn.), \u201cSelf-disclosures\u201d, \u201cOpen questions\u201d, \"Feeling Reflection\u201d(Feel.), \u201cRestatements\"(Rest.), \"Information giving\"(Info.), \"Direct guidance\"(Guid.) and \u201cOthers\u201d. Direct guidance can be categorized as recommendations of places, relaxing ways, lifestyles, therapies, and music. Specifically, thanks to spatial stamps, the \"Direct guidance: Recommended Place\" label aims to guide users to a private place while counseling outdoors or in a crowded environment. These helping skills can also be mapped to the five types of conversation(see Tab. 2). The whole dialogue sequences with the first five distinct helping skills are shown in Figure 3. Based on the analysis above, we annotate each dialogue with Client Behaviors and Counsellor Helping Skills according to Hill Counselor Verbal Response Category System (a detailed system description can be found in Appendix D).\nWe incorporate knowledge graphs, archiving extensive knowledge in the form of triples, into psychological counseling to provide more accurate interactive questions and answers (Yang, Zhang, and Erfani 2020). After experts recheck the correctness and completeness of triples, annotators relate entities about disorder, symptom, therapy, etc., and relationships including disorder-symptom relation, disorder-therapy relation, etc, to construct a psychological knowledge graph K. For each dialogue, we add a subset including persona and spatiotemporal stamps."}, {"title": "Data Quality Audit and Analysis", "content": "All annotated samples are thoroughly reviewed to identify low-quality dialogues and remove contentious illusions or hazardous information. Substandard samples are re-annotated. Following (Liu et al. 2020), we employ two senior psychologists for data quality evaluation on 1,000 randomly sampled dialogues. Specifically, they assign \u201c1\u201d for dialogues following annotation guidance, and \"O\" for the rest. The final average evaluation score of our dataset is \"0.91\", with a Kappa value(Tinsley and Weiss 1975) of \"0.84\", indicating that the dialogues are of high quality. Finally, we propose a Chinese SpatioTemporal-Aware Mixed-type multi-turn dialogues dataset for Psychological counseling. As shown in the bottom right corner of Fig.2, each meeting consists of multiple rounds of dialogues with at least three distinct Helping Skills."}, {"title": "Overview", "content": "Recently, the methodologies for different types of dialogues have gradually shifted to generative and end-to-end modeling. Following these trends, we propose a pre-trained mixed-type dialogue model Self-STAMPsy based on Qwen2(Bai et al. 2023). During training, a dialogue with a sequence of utterances between a client and a counselor is given. Then the dialogue is processed into a set of samples {(ci,ti)}, where ti is ith target counselor response, ci is the concatenation of all former utterances before ti, and D is the train set. Dialogue generation is formulated as an end-to-end dialogue generation(E2EDG) task, which aims to generate ti conditioned on ci as a query into LLMs.\nAccordingly, Self-STAMPsy has four modules, helping skills selection, spatiotemporal state extraction, adaptive retrieval augmented generation, and iterative self-feedback."}, {"title": "Helping Skills Selection", "content": "The Helping Skills Selection sub-task takes dialogue context and current dialogue goal sequence as input, then outputs predicted counselor helping skill. Formally, this task is regarded as a multi-class classification problem. Specifically, this module is divided into two baseline models, the dialogue goal prediction with or without context. The input of the prediction module is a dialogue context ci. With context ci, it outputs the counselor helping skill hi and predicts recommended goal gi. For the baseline model without contextual information, The classification process is formulated,\n$p_i = f(c_i)$,\nwhere f is the classification function BERT(Kenton and Toutanova 2019) and $p_i \\in |\\mathbb{R}^G||$ is the predicted probability value, G is the predefined category set. The dialogue activity gi is selected as the predicted dialogue activity if the value of the dimension is the highest probability value in pr. For the model with context, we input multiple consecutive sentences C1, C2, C3, ... to BERT in the form of [CLS]C1 [SEP][CLS]c2[SEP][CLS]c3... and compute the mean loss of [CLS] located at the beginning of each sentence. After Helping Skills Selection, to promote the effectiveness, we convert dialogue goal gi into natural language with predefined templates, represented as \u011di. If the predicted goal is \"Recommend Therapy\", the converted instruction will be \"The therapist will then design a therapy\"."}, {"title": "SpatioTemporal Stamp Processing", "content": "SpatioTemporal State Processing(STSP) contains two steps, spatiotemporal state extraction and stamp generation. The state ST can be obtained from the Memory Module. Subsequently, we utilize the position embeddings of ci and STi as inputs and derive emotional state STi by employing the mechanism previously analyzed for the goal. During training, we minimize the negative log-likelihood(NLL) loss:\n$L_{NLL_{ST}} = -Elogp(ST_i | ST_i, c_i)$\n$=-\\sum_{i=1}^{n} \\Sigma logp (ST_i | ST_i, c_i, ST_{i<i})$,\nwhere $ST_{i < i}$ denotes previously generated emotional state in query Q. Then based on the impact of time and place on one's emotions, we convert S into emotional state STi."}, {"title": "Adaptive Retrieval Augmented Generation", "content": "RAG methods enhance the input of LLMs with pertinent retrieved passages, thereby minimizing factual inaccuracies in knowledge-intensive tasks(Guu et al. 2020; Lewis et al. 2020). Graph-RAG(Edge et al. 2024) has claimed the use of graphs in connection with LLMs and RAG is powerful. Therefore, we combine knowledge graph K with LangChain, a RAG tool, and get augmented response ti."}, {"title": "Iterative Self-feedback", "content": "To ensure interaction quality and dialogue consistency, we add the Iterative Self-feedback mechanism. We design a multipart prompt with two main modules: Case Recordings for quality assurance. In counseling, the counselor is required to reflect on their client between every two sessions, trying to get the causes of their problems, the underlying themes behind the problems, and the interventions that apply to helping the client. Refering to Hill(Hill 2009), we designed the model to self-reflect each turn, including six parts: explicit content, implicit content, barriers to defense and change, distortions, countertransference, and personal assessment. \u2461Process Control utilizes historical interactions to determine the optimal timing to end dialogues. If the conversation isn't over (i < n), the output ti will be used for iterative model optimization."}, {"title": "Experiments", "content": "Following PsyCoun(Hu et al. 2024), we carefully select five fine-tuned robust LLMs, GPT4, and two Chinese psychological models as baselines to explore and evaluate the performance of various models. To optimize network performance, we perform LORA(Hu et al. 2022) and use LLaMa-Factory2 based on STAMPsy and under the same parameters."}, {"title": "Conclusion", "content": "In this paper, we first identify the challenge of how to develop mixed-type dialogue systems for psychological counseling for clients to articulate their goals ahead of the counseling process. Then, we take a step forward by collecting STAMPsy, a mixed-type dialogue dataset for psychological health support with 8 counselor helping skills annotated, which contains 5k mixed-type conversations and 62K utterances. Furthermore, we propose Self-STAMPsy, a spatiotemporal-aware mixed-type dialogue generation model with adaptive RAG and a novel iterative self-feedback mechanism. Finally, experimental results demonstrate the effectiveness of Self-STAMPsy, showcasing the potential of LLMs as supplemental tools that can boost the accessibility and efficiency of online counseling services."}, {"title": "Limitations", "content": "It's worth noting that the intent of the paper is not to advocate for the replacement of professional psychological counselors with automatic language models. Instead, our aim is to highlight the potential of Large Language Models (LLMs) as supplemental tools that can enhance the accessibility and efficiency of mental health care. We recognize the irreplaceable value of trained professionals in providing nuanced and empathetic care, which AI is not capable of replicating. In circumstances where there is a shortage of mental health professionals or in cases where individuals may not have the means to access traditional face-to-face counseling, LLMs can serve as an initial step or complementary option. They can provide immediate, low-threshold support, guide users to appropriate resources, or even help individuals clarify their goals before they reach out to a professional, as all replies with Self-STAMPsy are entitled with helping skills hi and goals prompt gi. Moreover, our research emphasizes that these tools should be carefully developed, tested, and integrated within the framework of professional psychological services, under the guidance and supervision of certified mental health professionals. LLMs could potentially handle more routine, information-based interactions, thus freeing up professionals to focus on cases that require deeper human insights and empathy.\nIn summary, our paper advocates for a balanced and cautious approach to integrating AI into mental health services, enhancing rather than replacing the crucial role of human professionals in this field."}]}