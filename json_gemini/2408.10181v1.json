{"title": "Imbalance-Aware Culvert-Sewer Defect Segmentation Using an Enhanced Feature Pyramid Network", "authors": ["Rasha Alshawi", "Md Meftahul Ferdaus", "Mahdi Abdelguerfi", "Kendall Niles", "Ken Pathak", "Steve Sloan"], "abstract": "Imbalanced datasets are a significant challenge in real-world scenarios. They lead to models that underperform on underrepresented classes, which is a critical issue in infrastructure inspection. This paper introduces the Enhanced Feature Pyramid Network (E-FPN), a deep learning model for the semantic segmentation of culverts and sewer pipes within imbalanced datasets. The E-FPN incorporates architectural innovations like sparsely connected blocks and depth-wise separable convolutions to improve feature extraction and handle object variations. To address dataset imbalance, the model employs strategies like class decomposition and data augmentation. Experimental results on the culvert-sewer defects dataset and a benchmark aerial semantic segmentation drone dataset show that the E-FPN outperforms state-of-the-art methods, achieving an average Intersection over Union (IoU) improvement of 13.8% and 27.2%, respectively. Additionally, class decomposition and data augmentation together boost the model's performance by approximately 6.9% IoU. The proposed E-FPN presents a promising solution for enhancing object segmentation in challenging, multi-class real-world datasets, with potential applications extending beyond culvert-sewer defect detection.", "sections": [{"title": "I. INTRODUCTION", "content": "COMPUTER vision has transformed industries by allowing machines to analyze visual data. A key aspect of this technology is semantic segmentation, which classifies individual image pixels into predefined categories [1], [2]. This capability is vital for infrastructure maintenance, particularly in identifying structural elements like culverts and sewer pipes. Culverts and sewer pipes are essential water management structures [3], [4] that need regular inspection for damage like cracks, holes, and encrustation. Traditional inspection methods, like video pipe inspection, rely on manual review of footage, which is time-consuming and susceptible to human error [5]. Automated semantic segmentation techniques can enhance inspection accuracy and efficiency. Advanced computer vision algorithms enable timely deficiency detection and repair, improving infrastructure integrity and longevity. Segmenting culverts and sewer pipes is challenging due to their varying shapes, sizes, and environmental conditions. Despite advancements in semantic segmentation, accurately identifying these structures is difficult [6]. The small size and subtle appearance of many defects complicate the task, requiring models to capture fine details while understanding the overall pipe structure [7], [8]. Factors such as diverse appearances, occlusions from vegetation or debris, and inconsistent lighting conditions can significantly impact the performance of current segmentation models [9]-[13]. Moreover, the scarcity of publicly available datasets for culvert and sewer pipe inspection complicates the development and testing of effective models. This limits the ability to train models that can generalize well to the wide variety of conditions encountered in real-world conditions.\nOur study involved collecting a specialized dataset for culvert and sewer pipe inspection in response to this gap. The dataset revealed a significant imbalance in defect types, with common defects like cracks or joint misalignments being overrepresented, while rarer but critical defects, such as holes or collapses, are underrepresented. This imbalance can lead to models that perform well on frequent issues but struggle with less common, yet critical, structural problems [14].\nAddressing these challenges is crucial for developing reliable automated systems for infrastructure inspection and maintenance. Effective segmentation enables precise detection of deficiencies, ensuring timely repairs.\nDeep learning models like U-Net [15], Feature Pyramid Network (FPN) [16], and Vision Transformers (ViT) [17], [18] have been used for semantic segmentation tasks. These models have shown promising results in general segmentation tasks but struggle with challenges posed by culverts and sewer pipes. For example, U-Net and FPN may lack robustness to handle appearance variability, while ViTs, although powerful, can be computationally expensive and require extensive training data.\nRecent advances in deep learning show promise in overcoming these challenges, particularly in improving FPNs [19]\u2013[23]. FPNs use a hierarchical pyramid of feature maps to capture information at multiple scales, improving the detection of large pipe features and small defects in culvert and sewer systems. This multi-scale approach is crucial for infrastructure inspection, where various feature scales must be accurately identified. However, while FPNs address the multi-scale issue, they do not inherently resolve the class imbalance in real-world inspection data.\nComprehensive solutions for managing object variations and addressing data imbalance in defect detection are needed. This involves adapting existing architectures for underground infrastructure inspections, developing new loss functions for class imbalance, and implementing advanced data augmentation techniques to represent underrepresented defect classes. These innovations are crucial for creating robust, reliable automated inspection systems for culverts and sewers, leading to more efficient maintenance and improved infrastructure health assessment [24]-[26].\nIn this paper, we introduce an enhanced FPN (E-FPN), a novel architecture for semantic segmentation in imbalanced culvert and sewer datasets. The E-FPN builds on the traditional FPN by incorporating enhancements to better handle object variations and improve feature extraction, addressing both the multi-scale challenges and the issue of class imbalance in underground infrastructure inspection. Our work makes two key contributions:\n\u2022 A customized E-FPN architecture for semantic segmentation of culverts and sewer pipes in imbalanced datasets:\n1) We introduce a sparsely connected block for efficient information flow.\n2) We use depth-wise separable convolutions to reduce parameters without sacrificing representational power.\nThese architectural innovations reduce computational complexity while maintaining, and often improving, segmentation performance.\n\u2022 Exploring and validating techniques to mitigate data imbalance and enhance model performance:\n1) We implemented class decomposition by partitioning the dataset into smaller, more homogeneous groups based on defect characteristics and sample distribution. This strategy allowed the model to focus on learning features specific to each type of defect more effectively. After training individual models on these smaller groups, we combined their predictions using ensemble learning techniques, enabling the final model to leverage the strengths of each sub-model. This approach enhanced the overall prediction accuracy, particularly for under-represented classes.\n2) We use data augmentation to expand and balance the dataset, increasing diversity and ensuring fair representation of defect classes during training.\nOur analysis demonstrates the effectiveness of our methods for detecting defects in culverts and sewer systems. We tested our model on a diverse real-world dataset with nine classes of pipe images, varying in material, size, and orientation. To assess its versatility, we evaluated the model on a benchmark aerial semantic segmentation drone dataset, presenting unique challenges due to varying altitudes, perspectives, and environmental conditions. The E-FPN model demonstrated exceptional performance and adaptability across both datasets, showcasing its potential for addressing real-world semantic segmentation challenges beyond underground infrastructure inspection.\nThe paper is structured as follows: Section II reviews the evolution of semantic segmentation techniques, focusing on the development of FPN and its applications. Section III details our methodology, including the design and implementation of our proposed E-FPN architecture. Section IV presents the Culvert-Sewer Defects dataset and the benchmark Aerial Semantic Segmentation Drone dataset used to evaluate the model's performance. Section V discusses techniques for balancing the dataset. Section VI outlines the implementation steps and metrics. Section VII provides an analysis of our experimental results and comparative evaluations against state-of-the-art methods. Finally, Section VIII concludes the paper with a summary of our contributions and potential future research directions in infrastructure maintenance and safety."}, {"title": "II. RELATED WORK", "content": "Semantic segmentation has significantly advanced with the development of deep learning techniques. This section provides a comprehensive review of these advancements, with a particular focus on FPNs and their applications in infrastructure inspection, especially for culverts and sewer pipes.\nA. Evolution of Semantic Segmentation Techniques\nSemantic segmentation has progressed from early methods based on hand-crafted features and conventional classifiers [27], [28] to more advanced deep learning approaches. The advent of Convolutional Neural Networks (CNNs) marked a transformative shift, enabling more effective pixel-wise classification. A key milestone in this evolution was the introduction of Fully Convolutional Networks (FCNs) [29], [30], which facilitated dense predictions over arbitrary-sized inputs and laid the groundwork for subsequent semantic segmentation architectures [31]. Among these advancements, encoder-decoder networks like U-Net [32], bottom-up top-down networks such as FPNs [22], and ViTs that leverage self-attention mechanisms for capturing long-range dependencies [33] have become prominent in addressing various segmentation challenges.\nIn the following, we will highlight each of these network types in detail:\n1) Encoder-Decoder Architectures and U-Net Variants: Encoder-decoder architectures, particularly U-Net [32], have significantly advanced the field of semantic segmentation. U-Net's innovative use of skip connections enhances segmentation accuracy by effectively combining low-level and high-level features, which has proven especially beneficial in medical imaging.\nRecent variants of U-Net have further refined its performance. For instance, Su et al. [34] integrated Convolutional Block Attention Modules (CBAM) into U-Net. This modification incorporates Channel Attention Modules (CAM) and Spatial Attention Modules (SAM), which collectively enhance the network's ability to focus on informative features and salient spatial regions, improving both global semantic understanding and local detail capture.\nFurther advancements include the Attention Sparse Convolutional U-Net (ASCU-Net) proposed by Tong et al. [35]."}, {"title": "B. Research gap and motivation", "content": "EDNs are effective at semantic segmentation but struggle with varying object scales. FPNs excel in handling multi-scale objects but may not address class imbalance as effectively as EDNs. FPNs also present high model complexity. ViTs offer promising performance but come with their own set of drawbacks. They generally require substantial computational resources and extensive training data, which can be challenging with smaller datasets. Additionally, ViTs may struggle with fine-grained details and local features due to their lack of inherent inductive biases, which can hinder performance in tasks that require high spatial resolution.\nOur culvert-sewer defect dataset presents unique challenges due to its inherent characteristics, diversity, and class imbalance. Class imbalance adversely affects the performance of EDNs and FPNs. An EDN that excels in precise localization may struggle with diverse object scales, while an FPN might be biased towards overrepresented classes, despite its ability to handle scale variations. Similarly, while ViTs show promise, their high computational demands and potential difficulties with fine details make them less suitable for our specific needs.\nThe challenges in this domain, including small structural defects, varying pipe materials and sizes, and highly imbalanced defect classes, necessitate specialized approaches. Existing solutions have made progress in semantic segmentation and addressing data imbalance, but there is a gap in tailored solutions for culvert and sewer inspection.\nGiven these limitations, directly applying existing EDN, FPN, or ViT architectures is not ideal for our dataset. We need to explore alternative approaches that improve object segmentation and manage class imbalance without adding computational overhead. Our work introduces an E-FPN designed specifically for culvert and sewer defect segmentation. The E-FPN incorporates enhanced blocks with reduced complexity for efficient multi-scale feature extraction and integrates architectural improvements inspired by recent advancements in attention mechanisms. This approach addresses the multi-scale nature of defects and the challenge of class imbalance, aiming to develop a more robust and accurate segmentation model tailored to underground infrastructure inspection."}, {"title": "III. PROPOSED METHOD: E-FPN", "content": "This section introduces the E-FPN, our proposed architecture for semantic segmentation in culvert and sewer pipe inspection. We describe the E-FPN's structure and key innovations, followed by a detailed ablation study. This study quantifies the impact of each architectural modification, supporting our design choices with empirical evidence. E-FPN builds on the foundational principles of traditional FPNs, incorporating innovative enhancements designed to address the specific difficulties encountered in this domain. The E-FPN is structured around two core components:\n1) Bottom-up pathway: The bottom-up pathway forms the foundation of our E-FPN architecture, as illustrated in the blue dotted block in Figure 1. This pathway is responsible for extracting multi-scale features from the input image through a series of convolutional operations and downsampling stages.\nTo enhance the effectiveness of this pathway for detecting defects in culverts and sewer systems, we implemented several key design modifications. Specifically, we replaced the standard bottom-up pathway layers with a custom Inception-like block, highlighted in the green dotted block in Figure 1. This custom block incorporates both 3 \u00d7 3 and 5 \u00d7 5 filters, along with a parallel max-pooling layer. The choice of these filter sizes was motivated by the characteristics of culvert and sewer imagery. The 3 \u00d7 3 filters capture fine-grained details and textures crucial for identifying defects like hairline cracks or early-stage corrosion. These filters help detect small-scale anomalies indicating structural issues. The larger 5\u00d75 filters help capture larger-scale defects, such as joint misalignments and significant deformations, by providing a wider receptive field. This allows the network to understand the overall structure and condition of the pipe.\nAdditionally, we incorporated two extra spatial detection layers compared to traditional Inception blocks. These layers enhance the model's capacity to learn and localize complex features specific to culvert and sewer defects, providing a more robust multi-scale feature representation. This is particularly valuable for detecting defects of varying sizes and appearances, depending on the camera's distance and angle.\nThe additional layers improve gradient flow during back-propagation, leading to better learning of fine-grained features essential for identifying structural anomalies. This adaptation helps our custom Inception-like block effectively address the challenges of culvert and sewer defect detection, enabling more accurate analysis across different scales and defect types.\nThroughout the pathway, we used depth-wise separable convolutions to reduce the parameter count without compromising performance. The pathway begins with 64 filters and doubles after each max-pooling operation, balancing network capacity with efficiency to capture increasingly complex features while maintaining a manageable parameter count.\n2) Top-down pathway: The top-down pathway, shown in the orange dotted block in Figure 1, enhances the bottom-up process by upsampling and merging features to create higher-resolution images. This maintains spatial details and allows for accurate defect localization. The pathway is designed using principles from deep learning, computer vision, and signal processing, specifically for inspecting culverts and sewer pipes.\nKey aspects of the top-down pathway include:\n\u2022 Feature fusion: The pathway starts with a $1\\times1$ convolution on the final bottom-up layer to reduce channel depth to 128. Each previous layer is upsampled by a factor of two and merged with the corresponding bottom-up feature map. This fusion low-level and high-level features, crucial for accurate semantic segmentation. The $1 \\times 1$ convolution reduces dimensionality while retaining essential information, and the upsampling recovers spatial details lost during downsampling.\n\u2022 Aliasing mitigation: To preserve fine details and sharp transitions, a 3 \u00d7 3 depth-wise separable convolution is applied to all merged layers. This approach mitigates aliasing effects during upsampling and ensures high fidelity in the final segmentation output. The 3 \u00d7 3 depth-wise separable convolution acts as a learnable anti-aliasing filter, which efficiently removes high-frequency artifacts.\n\u2022 Consistent output configuration: A common classifier is shared across all output feature maps, maintaining a 128-dimensional output channel configuration. This uniform representation aids in the final segmentation task and ensures consistent defect recognition regardless of scale. This approach promotes scale-invariant feature learning, which is critical for accurate defect detection across varying camera distances.\n\u2022 Efficient upsampling: Depth-wise separable convolutions in the upsampling process ensure computational efficiency while generating high-resolution feature maps. This design principle, demonstrated by Chollet [38] in the Xception architecture, enables detailed segmentation without significant computational overhead.\nThe design of the top-down pathway integrates feature fusion across abstraction levels, improving the network's ability to capture global context and fine-grained details. This is useful for culvert and sewer inspections as it facilitates accurate semantic segmentation. E-FPN offers a robust and efficient solution for semantic segmentation"}, {"title": "A. Progressive Enhancement of FPN Architectures: A Path to E-FPN", "content": "This subsection provides a detailed examination of the modifications made to the original FPN to enhance various aspects of feature extraction and representation. We conducted extensive experiments on the model, leading to the evolution of our proposed E-FPN.\n\u2022 Original FPN with ResNet Backbone: The baseline model uses the original FPN architecture with a ResNet backbone. This model serves as the foundation for evaluating subsequent modifications, establishing a reference point for performance comparisons.\n\u2022 FPN with Atrous Convolutions: We attempted to enhance the FPN architecture with atrous (dilated) convolutions to expand the receptive field while maintaining spatial resolution. Atrous convolutions insert gaps between kernel elements [39], enabling the model to capture broader context and preserve fine details without increasing computational complexity. Atrous convolutions have improved semantic segmentation in models like DeepLab [39] by enhancing multi-scale contextual understanding. However, our experiments did not show significant performance gains from integrating atrous convolutions with FPN. This unexpected result may stem from compatibility issues between atrous convolutions and FPN, or from dataset-specific factors that didn't fully utilize the technique's advantages.\n\u2022 FPN with Attention Gates: Attention gates (AGs) were incorporated into the FPN to enhance feature prioritization. Introduced by Oktay et al. [40], AGs dynamically emphasize significant regions while suppressing less relevant ones. This mechanism improves the model's ability to differentiate between important and trivial features, leading to better segmentation performance. AGs work by learning weights that adaptively highlight relevant features in feature maps, guiding the network to focus on informative areas and ignore noise. In our experiments, integrating AGs into the network's paths significantly improved accuracy in identifying and segmenting critical features. The enhanced ability to highlight key regions and suppress less useful information resulted in more precise segmentation, particularly in complex and cluttered scenes. This approach proved effective in improving the FPN's performance for segmenting culvert and sewer pipe defects.\n\u2022 FPN with Self-Attention Mechanisms: We explored integrating self-attention mechanisms into the FPN architecture, inspired by Transformer models' success [41]. Self-attention allows the network to prioritize relevant input parts, capturing long-range dependencies and global context. Despite its potential to enhance feature relationships and contextual understanding, our experiments showed no significant performance improvement. This limited impact may be due to increased computational demands or dataset characteristics that don't fully leverage self-attention advantages. While promising in other contexts, self-attention proved less effective for our specific segmentation task.\n\u2022 FPN with Squeeze-and-Excitation Blocks: The enhanced Squeeze-and-Excitation (SE) block is an attention mechanism that improves channel-wise feature responses through adaptive recalibration. It compresses feature maps into a channel descriptor, summarizing global information for each channel. This descriptor then recalibrates feature responses, emphasizing important features and suppressing less relevant ones. By capturing channel interdependencies, SE blocks enhance the network's focus on crucial features, improving overall performance [42]. We incorporated an enhanced version of SE blocks [43] into our feature extraction paths. This version includes a learnable recalibration rate, further refining the dynamic recalibration process. The integration aimed to improve information flow between bottom-up and top-down pathways. These SE blocks dynamically recalibrate channel-wise feature responses based on learned attention maps, significantly enhancing feature representation and segmentation accuracy. This improvement demonstrates the effectiveness of enhanced SE blocks in refining feature extraction and producing more precise segmentation results.\n\u2022 FPN with Inception and Residual Blocks: Integrating Inception blocks and residual connections into models architectures significantly enhances multi-scale feature extraction and supports the training of deeper networks [44], [45]. The Inception blocks capture features at multiple scales concurrently, while residual connections alleviate gradient issues, leading to substantial improvements in performance and robustness. In this experiment, we replaced FPN botton-up and top-down pathways blocks with Inception block with residual connections. The new model shows 10% improvement over the original FPN. In this experiment, we replaced the bottom-up and top-down pathway blocks in FPN with Inception blocks featuring residual connections. The new model demonstrated a 15% improvement over the original FPN.\n\u2022 FPN with Factorized Inception Block: To reduce the complexity of the previous experiment, we used a factorized Inception block, which optimizes by decomposing large convolutions into smaller, more manageable operations [46]. This modification achieves a balanced tradeoff between computational load and model performance, leading to notable improvements over the original FPN.\n\u2022 FPN with 5\u00d75 Factorized Convolution: The addition of a 5\u00d75 factorized convolution was aimed at enhancing the model's feature extraction capabilities by expanding the receptive field. This adjustment successfully improved the model's ability to capture and process features, leading to better overall performance. Both factorized versions of the Inception block improved network performance over the original FPN. However, using the unfactorized Inception block yielded higher performance compared to the factorized versions.\n\u2022 FPN with Additional 1 \u00d7 1 Layer: Introducing an additional 1x1 layer to the convolutional block was designed to further refine feature representation while maintaining computational efficiency. This enhancement contributed to improved feature extraction and model effectiveness, offering a more precise and nuanced analysis of the input data [47]. However, our experiments show that adding the additional layer to the block results in a performance drop of at least 10%.\n\u2022 E-FPN (Proposed Model): From these experiments, we observed that incorporating multi-scale block, like Inception block, significantly improves the performance of FPN but also increases computational overhead. Based on this observation, we developed our proposed E-FPN model, which integrates an advanced multi-scale block with reduced complexity, as detailed in the section above. This study reveals that while several modifications to the FPN architecture contributed to performance improvements, the E-FPN model, with its combination of advanced features and optimizations, offers the most substantial gains in accuracy and robustness for semantic segmentation tasks. All these results are detailed in Section VII-\u0421."}, {"title": "IV. DATASETS", "content": "This section is divided into two subsections. Section IV-A describes the creation of the Culvert-Sewer Defects dataset, while Section IV-B discusses the benchmark Aerial Semantic Segmentation Drone Dataset used to assess model's accuracy.\nA. Culvert-Sewer Defects Dataset\nIn this subsection, we detail the acquisition and preprocessing of source videos, which include various defect instances. We also outline the pixel-wise annotation strategy employed to create precise ground truth masks for semantic segmentation, culminating in our dataset of 6,300 images. The process is outlined as follows:\n1) Data Collection and Class Importance Weights: We collected 580 annotated videos of underground infrastructure inspections from two sources: the U.S. Army Corps of Engineers (USACE) and an industry partner. These videos cover culverts and sewer pipes and include a diverse range of real-world conditions, introducing variations in materials, shapes, dimensions, and imaging environments. This variety offers a comprehensive representation of typical inspection scenarios.\nSkilled technicians reported the majority of the videos, identifying deficiencies in culverts or sewer pipes by type and location. This precise reporting facilitated the identification and annotation process for our task. A professional civil engineer assigned importance weights to each deficiency class, reflecting their economic and safety impacts based on U.S. industry standards. These weights were normalized to establish priorities during the learning process, as shown in Table I. These class importance weights (CIW) are used to measure the severity of each deficiency using the Frequency Weighted\n2) Pixel-Wise Annotation for Semantic Segmentation Task: We compiled our dataset by partitioning each video into frames captured at intervals of 4 to 10 seconds at key classification points within the culvert and sewer inspection footage. During the manual annotation process, we referred to inspection reports to identify the location and type of each deficiency, assigning pixel-wise annotations in specific colors according to the US NASSCO's Pipeline Assessment Certification Program (PACP) guidelines [48]. Frames without any deficiencies were discarded.\nEach annotation is timestamped to the exact second of the video and linked to a specific deficiency class. Additionally, the pipe location for each annotation was recorded. The final dataset includes approximately 6,300 annotated frames, covering the nine deficiencies listed in Table I and illustrated in Figure 2.\nAs shown in the figure, our dataset exhibits a significant class imbalance, with certain deficiencies, such as cracks, being more prevalent than others, such as roots. This imbalance poses challenges for modeling and is a key aspect of the dataset's characteristics.\nB. Aerial Semantic Segmentation Drone Dataset\nThe Aerial Semantic Segmentation Drone Dataset is designed to enhance the safety of autonomous drone flight"}, {"title": "V. IMBALANCE HANDLING TECHNIQUES", "content": "The Culvert-Sewer Defects dataset exhibits significant class imbalance, with some defect types having a substantially larger number of samples compared to others ranging from 2,340 samples for some classes to as few as 104 samples for others, as shown in Figure 2. This imbalance poses a challenge for model training and may lead to biased predictions, especially favoring the overrepresented classes. In semantic segmentation tasks, such imbalance can result in poor generalization and accuracy, particularly for minority classes [50]. We explore two techniques to mitigate the effect of such imbalance on the model's performance: class decomposition and data augmentation.\nA. Class Decomposition and Ensemble Learning\nClass decomposition is used to address the imbalance issue by breaking down the multi-class segmentation problem into smaller tasks. This involves splitting the dataset into groups based on each class' characteristics and sample distribution [51]. We organize the data into groups consisting of three classes each, based on the deficiency type features and available samples. For instance, if two classes share similar characteristics, like crack and fracture, we assign them to separate groups to prevent confusion during model training. This simplifies the task for the models and improves their pattern-learning ability.\nWe train our E-FPN model separately on smaller balanced datasets. After training, we combine the predictions using ensemble learning techniques.\nEnsemble learning is a powerful approach where multiple models are combined to enhance overall performance. This method involves training several models, each of which may focus on different subsets of the data or specialize in particular classes. The strength of ensemble learning lies in its ability to aggregate the diverse insights and predictions from these individual models, leading to improved accuracy and robustness [52].\nIn our approach, ensemble learning plays a crucial role in leveraging the collective knowledge from multiple models. By aggregating their predictions, we can significantly enhance our model's robustness and generalization ability. This technique helps mitigate individual model weaknesses and provides a more reliable and stable performance, ultimately leading to more accurate and dependable results. We evaluate the enhanced model using the entire test dataset. Our experiments show a significant improvement in model performance, validating the effectiveness of our approach in addressing dataset imbalance and enhancing predictive accuracy. Detailed results with these performance metrics are presented in Section VII.\nB. Data Augmentation and Sampling Techniques\nData augmentation is a pivotal technique in deep learning for improving model performance, particularly when dealing with imbalanced datasets. By introducing variations and diversifications into the training data, data augmentation helps models generalize better and become more robust to real-world scenarios [53]. The key augmentation methods used and their impact on model training are outlined below:\n\u2022 Horizontal Flip: This technique involves flipping images horizontally, effectively doubling the dataset size while maintaining the original class distribution. It helps the model generalize better by providing mirrored versions of images.\n\u2022 Gaussian Blur: Applying Gaussian blur introduces a smooth, blurred effect to images. This reduces overfitting to specific details and encourages the model to focus on more generalized features, enhancing its robustness.\n\u2022 Color Jittering: Color jittering involves randomly adjusting the brightness, contrast, saturation, and hue of images. This adds significant diversity to the dataset and helps the model learn features that are invariant to color variations, improving its adaptability.\n\u2022 Shearing: Shearing applies a shear transformation to images, distorting them along one axis. This introduces variability in object orientations, helping the model recognize objects from different perspectives.\n\u2022 Rotation: Rotating images by specified angles exposes the model to various object orientations, aiding in generalization to unseen views and enhancing overall robustness.\n\u2022 Random Noise: Adding random variations to pixel values simulates real-world image noise. This technique improves the model's robustness by exposing it to noisy data, helping it perform better in diverse conditions.\n\u2022 Random Crop: Randomly cropping portions of images forces the model to focus on different regions of interest, enhancing its ability to localize objects and improve detection accuracy.\nThese techniques are applied to each class in the training set to ensure a balanced representation. Additionally, for classes with more than 2000 samples, such as the joint problems class, under-sampling is used by randomly removing excess samples to achieve a more balanced class distribution. This combined approach of data augmentation and strategic sampling is crucial for improving model performance and generalization ability."}, {"title": "VI. EXPERIMENTAL SETUP", "content": "In this section, we describe the methodologies and parameters used for developing, training, and evaluating our semantic segmentation model. We cover the optimization strategies, loss functions, evaluation metrics, and other key aspects of the implementation.\na) Optimization and Loss Functions: For training our semantic segmentation models, we employ the Adam optimizer with an initial learning rate of 0.001. Adam is chosen for its efficiency in handling sparse gradients and dynamically adjusting learning rates. The loss function used is Categorical Cross-Entropy, which is effective for multi-class pixel classification tasks by minimizing the difference between predicted probabilities and ground-truth labels.\nb) Evaluation Metrics: We evaluate model performance using the following metrics: 1. Intersection over Union (IoU): Measures segmentation accuracy by comparing predicted and ground-truth masks. 2. Frequency-Weighted IoU (FWIoU): Accounts for class frequencies using CIW as explained in IV-A1. 3. F1 Score: Balances precision and recall, useful for imbalanced datasets. 4. Balanced Accuracy: Averages recall across classes, effective for imbalanced datasets. 5. Matthews Correlation Coefficient (MCC): Assesses classification quality in skewed datasets.\nc) Training Procedures: Models are trained for 100 epochs on the Culvert-Sewer Defects dataset and the Aerial Semantic Segmentation Drone Dataset. The datasets are split into training (70%), validation (15%), and test (15%) subsets to evaluate generalization performance. Baseline models are also established and evaluated under the same conditions for comparison.\nd) Hardware and Software: Training is conducted on NVIDIA T4 GPUs using Keras with TensorFlow, providing the computational power and tools necessary for efficient model training and evaluation."}, {"title": "VII. RESULTS", "content": "We evaluated the effectiveness of E-FPN against state-of-the-art semantic segmentation architectures. Additionally, we tested E-FPN on the Aerial Semantic Segmentation Drone dataset to demonstrate its robustness and adaptability to diverse imagery types. This section is organized into three subsections: Subsection VII-A provides a comprehensive comparison with state-of-the-art models, including quantitative metrics and visualizations. It highlights E-FPN's effectiveness in addressing multi-scale feature representation across both the Culvert-Sewer Defects and Aerial Semantic Segmentation Drone datasets. Subsection VII-B discusses the impact of data imbalance mitigation techniques on model performance, detailing the effects of class decomposition and data augmentation. Subsection VII-C presents a detailed ablation study, analyzing the contribution of individual components and architectural modifications to E-FPN's performance.\nA. Comparison with Baseline Architectures\nTo evaluate the efficiency of our proposed E-FPN, we compared it with several state-of-the-art semantic segmentation architectures, including the original FPN, U-Net, CBAM-enhanced U-Net, ASCU-Net, and Swin Transformer.\nThe original FPN model used in our comparison was built on a ResNet backbone, pretrained on the ImageNet dataset to leverage learned features, and then fine-tuned on our specific dataset. This fine-tuning process tailored the model to the characteristics and requirements of our dataset.\nThe Swin Transformer used in this experiment is integrated with the UPerNet framework for semantic segmentation. Specifically, the \"upernet-Swin-small\" model, which is hosted on Hugging Face, combines the Swin Transformer with UPerNet's components, including a Feature Pyramid Network (FPN) and a Pyramid Pooling Module (PPM). This integration enhances the model's ability to capture multi-scale features and context for improved segmentation performance. The Swin Transformer was pretrained on the ImageNet dataset, providing it with general feature representations before being fine-tuned for the semantic segmentation task.\nWe evaluated Swin Transformer models under two conditions: with and without pretraining. In the non-pretrained condition, the models were trained from scratch on our dataset. This allowed us to evaluate the impact of pretraining on the performance of both Swin models and the original FPN.\nIn addition to our primary evaluations, we tested our proposed model on the Aerial Semantic Segmentation Drone dataset. For this comparison, we focused on three base models: the original U-Net, the original FPN, and our proposed model. This allowed us to benchmark our model against established baseline architectures. As shown in Table III, our proposed model consistently outperforms both the original U-Net and FPN across various metrics. Our model achieves an average IoU improvement of 27.3% over these baseline models, demonstrating its effectiveness and strong performance on different datasets."}, {"title": "B. Impact of Data Imbalance Mitigation Techniques on Model Performance", "content": "In this subsection, we discuss the results of applying two data imbalance mitigation techniques: class decomposition and data augmentation. These techniques were employed to enhance the model's performance on imbalanced datasets, with a specific focus on improvements observed for individual classes. We begin by presenting the overall performance of the proposed E-FPN model under different data balancing techniques, as summarized in Table V. This table compares the model's performance across various metrics, including IoU with background, IoU without background, FWIoU, F1 score, and balanced accuracy. These results provide a broad overview of how each technique impacts the model's general performance.\nFollowing the overall comparison, we explore the class-wise IoU scores to examine the specific impact on individual classes, as shown in Table VI. This table highlights the effectiveness of each technique in improving IoU scores for different defect classes, with a detailed analysis of the benefits of using class decomposition, data augmentation, and their combination.\nThe results show that applying both class decomposition and data augmentation leads to the most significant improvements, particularly in challenging classes. For instance, class decomposition alone resulted in a 5.24% improvement in average IoU, while data augmentation yielded a 3.66% increase. When combined, these techniques produced a 6.97% enhancement, demonstrating their complementary effects.\nTo further illustrate these findings, Figure 7 presents the validation graphs of these techniques, showing comparative metrics for cross-entropy loss, F1-score, and IoU. These visualizations reinforce the quantitative results by highlighting the consistent performance gains achieved through data balancing strategies.\nE-FPN's enhanced performance, coupled with class decomposition and data augmentation, shows great promise for advancing infrastructure inspection techniques. The model's 6.97% IoU enhancement using both techniques demonstrates their synergistic effect and the importance of addressing data imbalance in real-world applications, crucial in infrastructure maintenance to prevent catastrophic failures. The model's generalization across diverse scenarios suggests its potential applicability in various infrastructure inspection contexts, shown by its performance on the Aerial Semantic Segmentation Drone dataset. However, the computational overhead introduced by class decomposition and varying effectiveness of data augmentation across defect types present challenges for deployment in resource-constrained environments, highlighting the need for efficient, adaptive techniques to optimize performance while minimizing computational costs."}, {"title": "C. Ablation Study: Impact of Architectural Components on E-FPN Performance", "content": "We conducted comparative analyses to evaluate the evolution of our E-FPN. we focused on comparing different architectures within the FPN family. We compared various modifications of FPN, including the proposed E-FPN, against the baseline FPN model with a ResNet backbone. These variations encompassed FPN with atrous convolutions to enlarge receptive fields, FPN with AGs for enhanced feature selection, FPN incorporating Inception and residual blocks, self-attention mechanisms to capture long-range dependencies, enhanced SE blocks for channel-wise attention, and versions with factorized convolutions for computational efficiency. Each variant was designed to address specific aspects of feature extraction and representation. This analysis provides insights into how architectural choices impact performance in culvert and sewer defect segmentation.\nWhile some techniques, such as atrous convolutions and self-attention mechanisms, caused a drop in model performance, others led to significant improvements. Enhancements like the enhanced SE blocks and Additive AGs resulted in noticeable performance gains compared to the original FPN. Additionally, replacing the model's layers with Inception blocks that include residual connections yielded similar improvements.\nHowever, factorized versions of the Inception block did not provide the expected benefits. Adding extra layers to these blocks also led to a performance drop. This outcome is consistent with the effect of self-attention mechanisms, highlighting that increasing model complexity can sometimes negatively impact performance, particularly on our specific Culvert-Sewer Defects dataset.\nConsequently, we developed the E-FPN model, which incorporates a multi-scale depth-wise separable block. This block combines the advantages of varying filter sizes, similar to the Inception block, while achieving a reduction in computational complexity by at least 7 times fewer FLOPs. The proposed E-FPN model demonstrates a 10.35% improvement over the original FPN and approximately 3.1% improvement over the FPN models with Inception and attention mechanisms."}, {"title": "VIII. CONCLUSIONS", "content": "E-FPN is an innovative semantic segmentation architecture that enhances the traditional FPN framework. It incorporates sparsely connected blocks"}]}