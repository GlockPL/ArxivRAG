{"title": "Imbalance-Aware Culvert-Sewer Defect Segmentation Using an Enhanced Feature Pyramid Network", "authors": ["Rasha Alshawi", "Md Meftahul Ferdaus", "Mahdi Abdelguerfi", "Kendall Niles", "Ken Pathak", "Steve Sloan"], "abstract": "Imbalanced datasets are a significant challenge in real-world scenarios. They lead to models that underperform on underrepresented classes, which is a critical issue in infrastructure inspection. This paper introduces the Enhanced Feature Pyramid Network (E-FPN), a deep learning model for the semantic segmentation of culverts and sewer pipes within imbalanced datasets. The E-FPN incorporates architectural innovations like sparsely connected blocks and depth-wise separable convolutions to improve feature extraction and handle object variations. To address dataset imbalance, the model employs strategies like class decomposition and data augmentation. Experimental results on the culvert-sewer defects dataset and a benchmark aerial semantic segmentation drone dataset show that the E-FPN outperforms state-of-the-art methods, achieving an average Intersection over Union (IoU) improvement of 13.8% and 27.2%, respectively. Additionally, class decomposition and data augmentation together boost the model's performance by approximately 6.9% IoU. The proposed E-FPN presents a promising solution for enhancing object segmentation in challenging, multi-class real-world datasets, with potential applications extending beyond culvert-sewer defect detection.", "sections": [{"title": "I. INTRODUCTION", "content": "COMPUTER vision has transformed industries by allowing machines to analyze visual data. A key aspect of this technology is semantic segmentation, which classifies individual image pixels into predefined categories [1], [2]. This capability is vital for infrastructure maintenance, particularly in identifying structural elements like culverts and sewer pipes. Culverts and sewer pipes are essential water management structures [3], [4] that need regular inspection for damage like cracks, holes, and encrustation. Traditional inspection methods, like video pipe inspection, rely on manual review of footage, which is time-consuming and susceptible to human error [5]. Automated semantic segmentation techniques can enhance inspection accuracy and efficiency. Advanced computer vision algorithms enable timely deficiency detection and repair, improving infrastructure integrity and longevity. Segmenting culverts and sewer pipes is challenging due to their varying shapes, sizes, and environmental conditions. Despite advancements in semantic segmentation, accurately identifying these structures is difficult [6]. The small size and subtle appearance of many defects complicate the task, requiring models to capture fine details while understanding the overall pipe structure [7], [8]. Factors such as diverse appearances, occlusions from vegetation or debris, and inconsistent lighting conditions can significantly impact the performance of current segmentation models [9]-[13]. Moreover, the scarcity of publicly available datasets for culvert and sewer pipe inspection complicates the development and testing of effective models. This limits the ability to train models that can generalize well to the wide variety of conditions encountered in real-world conditions. Our study involved collecting a specialized dataset for culvert and sewer pipe inspection in response to this gap. The dataset revealed a significant imbalance in defect types, with common defects like cracks or joint misalignments being overrepresented, while rarer but critical defects, such as holes or collapses, are underrepresented. This imbalance can lead to models that perform well on frequent issues but struggle with less common, yet critical, structural problems [14]. Addressing these challenges is crucial for developing reliable automated systems for infrastructure inspection and maintenance. Effective segmentation enables precise detection of deficiencies, ensuring timely repairs. Deep learning models like U-Net [15], Feature Pyramid Network (FPN) [16], and Vision Transformers (ViT) [17], [18] have been used for semantic segmentation tasks. These models have shown promising results in general segmentation tasks but struggle with challenges posed by culverts and sewer pipes. For example, U-Net and FPN may lack robustness to handle appearance variability, while ViTs, although powerful, can be computationally expensive and require extensive training data. Recent advances in deep learning show promise in overcoming these challenges, particularly in improving FPNs [19]\u2013[23]. FPNs use a hierarchical pyramid of feature maps to capture information at multiple scales, improving the detection of large pipe features and small defects in culvert and sewer systems. This multi-scale approach is crucial for infrastructure inspection, where various feature scales must be accurately identified. However, while FPNs address the multi-scale issue, they do not inherently resolve the class imbalance in real-world inspection data. Comprehensive solutions for managing object variations and"}, {"title": "II. RELATED WORK", "content": "Semantic segmentation has significantly advanced with the development of deep learning techniques. This section provides a comprehensive review of these advancements, with a particular focus on FPNs and their applications in infrastructure inspection, especially for culverts and sewer pipes.\nA. Evolution of Semantic Segmentation Techniques\nSemantic segmentation has progressed from early methods based on hand-crafted features and conventional classifiers [27], [28] to more advanced deep learning approaches. The advent of Convolutional Neural Networks (CNNs) marked a transformative shift, enabling more effective pixel-wise classification. A key milestone in this evolution was the introduction of Fully Convolutional Networks (FCNs) [29], [30], which facilitated dense predictions over arbitrary-sized inputs and laid the groundwork for subsequent semantic segmentation architectures [31]. Among these advancements, encoder-decoder networks like U-Net [32], bottom-up top-down networks such as FPNs [22], and ViTs that leverage self-attention mechanisms for capturing long-range dependencies [33] have become prominent in addressing various segmentation challenges.\nIn the following, we will highlight each of these network types in detail:\n1) Encoder-Decoder Architectures and U-Net Variants: Encoder-decoder architectures, particularly U-Net [32], have significantly advanced the field of semantic segmentation. U-Net's innovative use of skip connections enhances segmentation accuracy by effectively combining low-level and high-level features, which has proven especially beneficial in medical imaging.\nRecent variants of U-Net have further refined its performance. For instance, Su et al. [34] integrated Convolutional Block Attention Modules (CBAM) into U-Net. This modification incorporates Channel Attention Modules (CAM) and Spatial Attention Modules (SAM), which collectively enhance the network's ability to focus on informative features and salient spatial regions, improving both global semantic understanding and local detail capture.\nFurther advancements include the Attention Sparse Convolutional U-Net (ASCU-Net) proposed by Tong et al. [35]."}, {"title": "III. PROPOSED METHOD: E-FPN", "content": "This section introduces the E-FPN, our proposed architecture for semantic segmentation in culvert and sewer pipe inspection. We describe the E-FPN's structure and key innovations, followed by a detailed ablation study. This study quantifies the impact of each architectural modification, supporting our design choices with empirical evidence. E-FPN builds on the foundational principles of traditional FPNs, incorporating innovative enhancements designed to address the specific difficulties encountered in this domain. The E-FPN is structured around two core components:\n1) Bottom-up pathway: The bottom-up pathway forms the foundation of our E-FPN architecture, as illustrated in the blue dotted block in Figure 1. This pathway is"}, {"title": "IV. DATASETS", "content": "This section is divided into two subsections. Section IV-A describes the creation of the Culvert-Sewer Defects dataset, while Section IV-B discusses the benchmark Aerial Semantic Segmentation Drone Dataset used to assess model's accuracy.\nA. Culvert-Sewer Defects Dataset\nIn this subsection, we detail the acquisition and preprocessing of source videos, which include various defect instances. We also outline the pixel-wise annotation strategy employed to create precise ground truth masks for semantic segmentation, culminating in our dataset of 6,300 images. The process is outlined as follows:\n1) Data Collection and Class Importance Weights: We collected 580 annotated videos of underground infrastructure inspections from two sources: the U.S. Army Corps of Engineers (USACE) and an industry partner. These videos cover culverts and sewer pipes and include a diverse range of real-world conditions, introducing variations in materials, shapes, dimensions, and imaging environments. This variety offers a comprehensive representation of typical inspection scenarios.\nSkilled technicians reported the majority of the videos, identifying deficiencies in culverts or sewer pipes by type and location. This precise reporting facilitated the identification and annotation process for our task. A professional civil engineer assigned importance weights to each deficiency class, reflecting their economic and safety impacts based on U.S. industry standards. These weights were normalized to establish priorities during the learning process, as shown in Table I. These class importance weights (CIW) are used to measure the severity of each deficiency using the Frequency Weighted\n2) Pixel-Wise Annotation for Semantic Segmentation Task:\nWe compiled our dataset by partitioning each video into frames captured at intervals of 4 to 10 seconds at key classification points within the culvert and sewer inspection footage. During the manual annotation process, we referred to inspection reports to identify the location and type of each deficiency, assigning pixel-wise annotations in specific colors according to the US NASSCO's Pipeline Assessment Certification Program (PACP) guidelines [48]. Frames without any deficiencies were discarded.\nEach annotation is timestamped to the exact second of the video and linked to a specific deficiency class. Additionally, the pipe location for each annotation was recorded. The final dataset includes approximately 6,300 annotated frames, covering the nine deficiencies listed in Table I and illustrated in Figure 2.\nAs shown in the figure, our dataset exhibits a significant class imbalance, with certain deficiencies, such as cracks, being more prevalent than others, such as roots. This imbalance poses challenges for modeling and is a key aspect of the dataset's characteristics.\nB. Aerial Semantic Segmentation Drone Dataset\nThe Aerial Semantic Segmentation Drone Dataset is designed to enhance the safety of autonomous drone flight"}, {"title": "V. IMBALANCE HANDLING TECHNIQUES", "content": "The Culvert-Sewer Defects dataset exhibits significant class imbalance, with some defect types having a substantially larger number of samples compared to others ranging from 2,340 samples for some classes to as few as 104 samples for others, as shown in Figure 2. This imbalance poses a challenge for model training and may lead to biased predictions, especially favoring the overrepresented classes. In semantic segmentation tasks, such imbalance can result in poor generalization and accuracy, particularly for minority classes [50]. We explore two techniques to mitigate the effect of such imbalance on the model's performance: class decomposition and data augmentation.\nA. Class Decomposition and Ensemble Learning\nClass decomposition is used to address the imbalance issue by breaking down the multi-class segmentation problem into smaller tasks. This involves splitting the dataset into groups based on each class' characteristics and sample distribution [51]. We organize the data into groups consisting of three classes each, based on the deficiency type features and available samples. For instance, if two classes share similar characteristics, like crack and fracture, we assign them to separate groups to prevent confusion during model training. This simplifies the task for the models and improves their pattern-learning ability.\nWe train our E-FPN model separately on smaller balanced datasets. After training, we combine the predictions using ensemble learning techniques.\nEnsemble learning is a powerful approach where multiple models are combined to enhance overall performance. This method involves training several models, each of which may focus on different subsets of the data or specialize in particular classes. The strength of ensemble learning lies in its ability to aggregate the diverse insights and predictions from these individual models, leading to improved accuracy and robustness [52].\nIn our approach, ensemble learning plays a crucial role in leveraging the collective knowledge from multiple models. By aggregating their predictions, we can significantly enhance our model's robustness and generalization ability. This technique helps mitigate individual model weaknesses and provides a more reliable and stable performance, ultimately leading to more accurate and dependable results. We evaluate the enhanced model using the entire test dataset. Our experiments show a significant improvement in model performance, validating the effectiveness of our approach in addressing dataset imbalance and enhancing predictive accuracy. Detailed results with these performance metrics are presented in Section VII.\nB. Data Augmentation and Sampling Techniques\nData augmentation is a pivotal technique in deep learning for improving model performance, particularly when dealing with imbalanced datasets. By introducing variations and diversifications into the training data, data augmentation helps models generalize better and become more robust to real-world scenarios [53]. The key augmentation methods used and their impact on model training are outlined below:\nThese techniques are applied to each class in the training set to ensure a balanced representation. Additionally, for classes with more than 2000 samples, such as the joint problems class, under-sampling is used by randomly removing excess samples to achieve a more balanced class distribution. This combined approach of data augmentation and strategic sampling is crucial for improving model performance and generalization ability."}, {"title": "VI. EXPERIMENTAL SETUP", "content": "In this section, we describe the methodologies and parameters used for developing, training, and evaluating our semantic segmentation model. We cover the optimization strategies, loss functions, evaluation metrics, and other key aspects of the implementation.\na) Optimization and Loss Functions: For training our semantic segmentation models, we employ the Adam optimizer with an initial learning rate of 0.001. Adam is chosen for its efficiency in handling sparse gradients and dynamically adjusting learning rates. The loss function used is Categorical Cross-Entropy, which is effective for multi-class pixel classification tasks by minimizing the difference between predicted probabilities and ground-truth labels.\nb) Evaluation Metrics: We evaluate model performance using the following metrics: 1. Intersection over Union (IoU): Measures segmentation accuracy by comparing predicted and"}, {"title": "VII. RESULTS", "content": "We evaluated the effectiveness of E-FPN against state-of-the-art semantic segmentation architectures. Additionally, we tested E-FPN on the Aerial Semantic Segmentation Drone dataset to demonstrate its robustness and adaptability to diverse imagery types. This section is organized into three subsections: Subsection VII-A provides a comprehensive comparison with state-of-the-art models, including quantitative metrics and visualizations. It highlights E-FPN's effectiveness in addressing multi-scale feature representation across both the Culvert-Sewer Defects and Aerial Semantic Segmentation Drone datasets. Subsection VII-B discusses the impact of data imbalance mitigation techniques on model performance, detailing the effects of class decomposition and data augmentation. Subsection VII-C presents a detailed ablation study, analyzing the contribution of individual components and architectural modifications to E-FPN's performance.\nA. Comparison with Baseline Architectures\nTo evaluate the efficiency of our proposed E-FPN, we compared it with several state-of-the-art semantic segmentation architectures, including the original FPN, U-Net, CBAM-enhanced U-Net, ASCU-Net, and Swin Transformer, as shown in Table II.\nThe original FPN model used in our comparison was built on a ResNet backbone, pretrained on the ImageNet dataset to leverage learned features, and then fine-tuned on our specific dataset. This fine-tuning process tailored the model to the characteristics and requirements of our dataset.\nThe Swin Transformer used in this experiment is integrated with the UPerNet framework for semantic segmentation. Specifically, the \"upernet-Swin-small\" model, which is hosted on Hugging Face, combines the Swin Transformer with UPerNet's components, including a Feature Pyramid Network (FPN) and a Pyramid Pooling Module (PPM). This integration enhances the model's ability to capture multi-scale features and context for improved segmentation performance. The"}, {"title": "VIII. CONCLUSIONS", "content": "E-FPN is an innovative semantic segmentation architecture that enhances the traditional FPN framework. It incorporates sparsely connected blocks and depth-wise separable convolutions to address data imbalance issues. The dual-pathway design and efficient convolution operations improve performance on imbalanced datasets while enhancing computational efficiency. E-FPN outperformed both traditional and state-of-the-art segmentation models when tested on our Culvert-Sewer Defect dataset and a benchmark aerial drone dataset. It achieved average IoU improvements of 13.8% and 27.2% respectively, surpassing FPN, U-Net, CBAM U-Net, ASCU-Net, and Swin Transformer.\nE-FPN demonstrated superior performance on imbalanced datasets with improved generalization. Class decomposition and data augmentation increased IoU by 5.24% and 3.66% respectively, with a combined improvement of 6.9%. E-FPN also achieved a 96.04% reduction in model parameters compared to other evaluated models, showcasing its efficiency and versatility for real-world applications without compromising performance.\nFuture research will focus on enhancing E-FPN's capabilities and applicability in real-world scenarios. Priorities include integrating temporal information from video streams for real-time detection, exploring unsupervised pre-training on large-scale unlabeled data to enhance feature extraction and generalization, and investigating active learning strategies and physics-informed neural networks for rare defect detection and domain knowledge incorporation. Efforts will be directed towards developing computationally efficient, adaptive techniques for resource-constrained environments, and expanding the model's applicability to diverse infrastructure inspection contexts. These advancements aim to establish E-FPN as a robust solution for automated infrastructure inspection, addressing challenges in data scarcity, computational efficiency, and critical defect detection."}]}