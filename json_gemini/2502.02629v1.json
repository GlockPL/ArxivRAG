{"title": "Graph Structure Learning for Tumor Microenvironment with Cell Type Annotation from non-spatial scRNA-seq data", "authors": ["Yu-An Huang", "Yue-Chao Li", "Hai-Ru You", "Jie Pan", "Xiyue Cao", "Xinyuan Li", "Zhi-An Huang", "Zhu-Hong You"], "abstract": "The exploration of cellular heterogeneity within the tumor microenvironment (TME) via single- cell RNA sequencing (scRNA-seq) is essential for understanding cancer progression and response to therapy. Current scRNA-seq approaches, however, lack spatial context and rely on incomplete datasets of ligand-receptor interactions (LRIs), limiting accurate cell type annotation and cell-cell communication (CCC) inference. This study addresses these challenges using a novel graph neural network (GNN) model that enhances cell type prediction and cell interaction analysis. Our study utilized a dataset consisting of 49,020 cells from 19 patients across three cancer types: Leukemia, Breast Invasive Carcinoma, and Colorectal Cancer. The proposed scGSL model demonstrated robust performance, achieving an average accuracy of 84.83%, precision of 86.23%, recall of 81.51%, and an F1 score of 80.92% across all datasets.", "sections": [{"title": "1. Introduction", "content": "Single-cell RNA-sequencing (scRNA-seq) technology has revolutionized our understanding of the cellular heterogeneity within the TME, a complex ecosystem integral to cancer progression and therapeutic response. The TME consists of a diverse array of cellular components including immune cells, endothelial cells, and stromal cells, alongside molecular components such as signaling molecules and extracellular matrix proteins. These elements do not exist in isolation. Instead, they engage in extensive cross talk that significantly influences tumor behavior and patient outcomes. Through scRNA-seq, the intricate cellular interactions and functional heterogeneity that traditional bulk sequencing methods often obscure are now illuminated, providing insights into the unique transcriptional profiles of individual cells. This intricate detail enables the identification of specific subpopulations of immune cells that may be uniquely associated with either tumorigenesis or tumor suppression. It also delineates the role of stromal cells like fibroblasts in supporting tumor growth through the secretion of matrix metalloproteinases (MMPs) and other enzymes that facilitate tumor invasion and metastasis. By offering a clearer view of the cellular landscape within the TME, scRNA-seq facilitates a deeper understanding of how these diverse cell types contribute to cancer dynamics and resistance, potentially leading to more effective therapeutic strategies.\nHowever, a significant challenge of scRNA-seq is its inability to retain spatial context of the cells, necessitating subsequent computational analysis for cell type annotation and the inference of intercellular communication. These analyses are crucial for constructing a comprehensive map of the cellular interactions within the TME, which can reveal potential targets for therapeutic intervention. By understanding how different cell types within the TME communicate and contribute to cancer progression, scRNA-seq enhances the understanding of cancer biology and opens up new avenues for targeted therapy.\nWhile scRNA-seq captures gene expression at the individual cell level, the methods for analyzing CCC predominantly focus on interactions between cell types rather than individual cells. These methods rely fundamentally on the introduction of LRIs to score signaling communication between different cell types. LRIs involve a ligand, typically a protein or small molecule secreted by one cell, binding to a specific receptor on another cell. This binding initiates a cascade of signals within the receiving cell, thereby facilitating communication between cells. LRIs are crucial for explaining how cells influence each other in biological contexts, forming the basis of intercellular communication.\nAs summarized by Peng et al. [1], existing computational approaches for inferring CCC are categorized into three main types: (i) network-based scoring methods, including CCCExplorer [2] and NicheNet [3]; (ii) machine learning prediction techniques, such as PyMINEr [4], SoptSC [5], and SingleCellSignalR [6]; and (iii) spatial information-based inference tools like CellTalker [7], SpaOTsc [8], and histoCAT [9]. The computational pipeline for these methods typically begins with cell type annotation or cell clustering, followed by the organization of original LRI data. Gene expression values of ligands and receptors are used to compute interaction scores for each pair mediating between two cell types, and these scores are aggregated to assess the overall state of communication between them [10]. Each method has its strengths and weaknesses when compared: network-based scoring and machine learning approaches heavily rely on the curation of LRIs and their downstream pathways, whereas spatial information-based inference is limited to spatial datasets and cannot be applied to non- spatial transcriptomics data. CCC inference is increasingly viewed as a data-driven analysis task that varies with different techniques and relies on diverse scoring approaches to determine cell type specificity, yet the absence of a \"gold standard\" dataset makes it challenging to evaluate and standardize these methods.\nHowever, existing CCC inference methods universally confront several significant issues. The acquisition of LRIs relies heavily on biological experiments, leading to an incomplete dataset where some interactions are missing, such as ligands like IL17D that lack known receptors and receptors like RELT, NGFR, and TROY from the TNF receptor family that lack known ligands. This incompleteness can introduce biases, particularly affecting rare cell types. Moreover, LRIs are not tumor-specific, implying that in TME scenarios, all known LRIs are considered equally critical across all cell types, potentially leading to an overemphasis on certain interactions. Most CCC inference techniques focus on proteinaceous ligands and receptors, neglecting other important signaling cofactors such as stimulatory and inhibitory membrane-bound co-receptors, along with soluble agonists and antagonists. Beyond the shortcomings related to LRIs, another challenge lies in the dependency of CCC inference methods on cell-type identification, heavily relying on tools like Seurat [11], SingleR [12], Cellassign [13], and scCATCH [14]. However, these methods have an accuracy rate of about 80% and still require significant improvement.\nRecent advances in cell-type identification have seen methods that construct cell-cell graphs and utilize GNNs to tackle the task of node label prediction for cell type annotation. For example, scGCN [15] constructs its graph by calculating similarities between cell expression profiles and applying sparsification. scGNN incorporates interaction probability scores derived from the CellChat [16] method and LRIs to assign weights to the edges of its graph. scPML [17] calculates edge weights using AUCell [18] scoring of gene signaling pathways from databases like KEGG [19]. Despite the differing methodologies in constructing graphs, these approaches have confirmed that establishing links between cells is beneficial for predicting cell types.\nIn conclusion, computational methods for CCC inference are heavily reliant on the predictive performance of cell type annotation. Concurrently, methods for cell type annotation are increasingly incorporating considerations of inter-cell interactions within CCC. Yet, the graphs constructed by graph-based cell type annotation methods, while serving as inputs for GNNs, have rarely been explored for their interpretability. Inspired by this observation, there is a reciprocal benefit to be realized between cell-cell interaction and cell type annotation. To leverage this potential, we propose a new computational model based on GNNs. Utilizing unlabeled scRNA-seq data from tumor tissues, our model addresses two pivotal computational"}, {"title": "2. Methodology", "content": "tasks essential for analyzing the TME: firstly, the annotation of cell types, and secondly, the construction of a graph that measures potential interactions among cells within the TME.\nUnlike existing GNN-based computational methods for single-cell type prediction, which construct the cell-cell graph through filtering. Our hypothesis posits that enhancing the graph representation of individual cells could significantly improve both the predictive accuracy and interpretability of cell type identification. By developing a more sophisticated neural network model that can learn these complex interactions, we aim to not only boost the predictive performance but also gain insights into the cellular mechanisms at play. Consequently, this allows for the exploration of the TME at a more detailed, single-cell level of interaction, rather than the broader cell type interactions typically analyzed in traditional studies with non-spatial scRNA-seq data."}, {"title": "2.1 scRNA-seq dataset", "content": "In this study, we utilized a comprehensive scRNA-seq dataset to predict cell types across various diseases. The dataset encompasses a total of 49,024 cells derived from 19 individuals, averaging approximately 2,580 cells per individual. This rich dataset includes cells from patients suffering from three distinct diseases: Leukemia, Breast Invasive Carcinoma, and Colorectal Cancer, which are further subdivided into specific datasets as described below and summarized in Fig. 1, a bar graph illustrating the distribution of cell counts and cell type proportions among the patients. Specifically, this dataset collection encompasses leukemia samples from GSE142213 (including AYL050 and OX1164) [20], GSE132509 (including PBMMC_1, PBMMC_2, PBMMC_3) [21], and GSE154109 (including P6 and P7); breast"}, {"title": "2.2 Overview of scGSL model", "content": "In this work, we present scGSL, a new GNN-based model geared for analyzing non-spatial transcriptomic scRNA-seq data within cancer research contexts. scGSL utilizes labeled cell type data from scRNA-seq of a particular cancer to annotate other datasets of the same cancer type and compute the cell-cell interaction graph. Notably, scGSL integrates two advanced computational strategies: GSL and graph domain adaptation [25]. GSL is employed to autonomously derive a representative cell-cell graph based on the intrinsic labels available from the data, thereby enhancing the graph's capacity to accurately reflect biological interactions. Meanwhile, graph domain adaptation functions within the non-Euclidean space of graphs to adapt domains, thereby enabling classifiers trained on a reference dataset to more effectively"}, {"title": "2.3 Graph structure learning for cell-cell graph", "content": "Upon acquisition of scRNA-seq data, in this work, rigorous quality control was implemented by removing cells with gene expressions below 200 and genes expressed in fewer than three cells, ensuring reliability in subsequent analyses. Common genes were then identified between source and target datasets, and the top 3000 highly variable genes (HVGs) were selected to highlight biological variability. To address batch effects, normalization procedures were applied to align features across datasets. The KNN algorithm, setting neighbors at 0.2% of total cell count, was used to construct graphical representations for both datasets.\nIn constructing cell-cell interaction graphs from non-spatial transcriptomic scRNA-seq data, challenges such as drop-out events, amplification bias, and insufficient sequencing depth inherently distort the representation of genuine cellular interactions. These issues introduce noise and perturbations that significantly complicate the interpretation of calculated correlations in gene expression profiles, as well as scores derived from signaling pathways or LRIs. We propose that these adverse effects can be mitigated by incorporating cell type information and by preserving two intrinsic characteristics typically observed in real-world graph data: feature smoothness in gene expression profiles and the low-rank and sparsity properties of the cell-cell interaction graph.\nGiven a cell-cell interaction graph G = (V,E), the set V consist of N nodes, each representing a cell {v\u2081, v\u2082,...,v\u2099} with E forming the edges that define cellular interactions captured in the adjacency matrix A\u2208 \u211d\u1d3a\u02e3\u1d3a. Each node v\u1d62 has an associated gene expression profile represented as feature vector x\u1d62 in the feature matrix X\u2208 \u211d\u1d3a\u02e3\u1d48. Nodes are labeled with their cell type Y={y\u2081, y\u2082,..., y\u2099}, serving as training data for the node classification task. We developed a two-layer Graph Convolutional Network (GCN), which effectively maps the node embeddings based on cell type information Y. This model generates a new graph G' with an adjusted adjacency matrix S designed to achieve three key objectives: (i) it encapsulates cell type information; (ii) it preserves essential graph properties such as low rank and sparsity; and (iii) it maintains feature smoothness across neighboring nodes. Specifically, the GCN is structured by the function f\u2080(X, A) = softmax(\u00c2\u03c3(AXW\u2081)W\u2082),where \u00c2 = D\u207b\u00b9/\u00b2(A +\n1)D\u207b\u00b9/\u00b2 and is the diagonal matrix of A+I with_D\u1d62\u1d62 = 1 + \u2211\u2c7c A\u1d62\u2c7c. \u03c3 represents a ReLU activation function. To achieve objective (i), one object function of the GCN can be formulated as:\nmin L_cls (\u03b8, A, X, Y) = \u2211_v\u1d62\u2208V cross-entropy(f_\u03b8 (X, A)\u1d62, y\u1d62)  (1)\nTo enable the GCN to effectively learn the symmetric adjacency matrix S (initialized as A) of the newly formulated undirected graph G' and to achieve objective (ii), which entails maintaining essential graph properties of low rank and sparsity, an appropriately designed loss function was incorporated into the model's training:\narg min L_graph = ||A - S||\u00b2_F + R(S), s.t., S = S\u1d40\nSE[0,1]\u1d3a\u02e3\u1d3a  (2)\nR(S) represents the constraints applied to S to ensure the preservation of properties of low rank and sparsity. According to [26], it is established that the minimization of the l\u2081 norm and the nuclear norm of a matrix promotes sparsity and low rank characteristics, respectively.\nConsequently, Equation (2) can be reformulated as follow:\narg min L_graph = ||A \u2013 S||\u00b2_F + w_s||S||\u2081 + W_l||S||*, s.t., S = S\u1d40,\nSE[0,1]\u1d3a\u02e3\u1d3a (3)\nwhere w_s and w_l are predetermined parameters that modulate the influence of sparsity and low"}, {"title": "2.4 Cell type annotation with graph domain adaptation", "content": "rank properties, respectively. In this work, the values of a and \u03b2 were respectively set at 5e-4 and 1.5. The third loss function for objective aims to maintain node feature smoothness in the learned graph, which is represented by the following term L_node\nL_node = tr(X\u1d40LX),  (4)\nwhere L is the normalized graph Laplacian matrix of S. The final objective function is as follow:\narg min L = w_cL_cls + L_graph + W_nL_node,  (5)\nS,\u03b8\nw_c and w_n were set as 0.1 and 1. To solve this loss, we employ an alternating optimization schema (details provided in Supplementary File 1) to jointly update @ and S.\nAs an increasing number of GNN algorithms are developed for cell type prediction using scRNA-seq data, the diversity in the construction of these graphs\u2014whether cell-cell, gene-gene, or cell-gene graphs\u2014and their formulation methods continue to expand. Despite their potential, these methods often face generalization challenges, especially when scRNA-seq data used for inference comes from patients with different health conditions, or when the data is collected using varied methodologies across different studies. This variability can lead to unique interconnection patterns in the data. In the context of GNNs used for single-cell prediction in cell-cell graphs, transfer issues in node classification (i.e., cell type annotation) become apparent, particularly when annotating cell types within the TME of one patient based on a model trained with scRNA-seq data from another. This highlights the inherent biological and contextual differences between individuals. In this work, we introduce for the first time the concept of graph domain adaptation (GDA) to address the challenges associated with applying a learned cell-cell graph for cell type annotation across different individuals.\nSpecifically, we train a model to predict cell types from reference scRNA-seq data G_s =\n(V_s, E_s, X_s) which comprises a feature encoder, \u03c6: \u03c7 \u2192 H and a classifier, g: H \u2192 Y. In this work, implemented as a two-layer GCN, similar to the GSL model, and g a two-layer Multi-Layer Perceptron. Given the query data G_r = (V_\u0442, \u0415_\u0442, \u0425_\u0442), the objective is to use GDA on this model to minimize the target error \u03b5_\u03c4(g\u00b0\u03c6).\nIn GDA for graphs with the adjacency matrix A and node labels Y, shifts in graph structure, indicated by P_s(A, Y) \u2260 P_\u0442(A, Y), typically manifest as either conditional structure shift (CSS), label shift (LS), or a combination of both. With decomposition as P(A,Y) =\nP(A|Y)P(Y), CSS and LS are defined as P_s(A|Y) \u2260 P_\u2081(A|Y) and P_s(Y) \u2260 P_\u2081(Y), respectively. To address these, the GDA framework of Pairwise Alignment (PA) is employed. Specifically, PA constructs the matrix of density ratio between the target and source graphs \u03b3\u2208 \u211d|Y|X|Y| to reweight edges for GNN encoding, which can be formulated as follow:\n[\u03b3]\u1d62,\u2c7c = Pr(Y_v=j|Yu=i,veNu) / Ps(Y_v=j|Yu=i,veNu), Vi, je Y.  (6)\n[y]\u1d62,\u2c7c denotes the density ratio from class-i nodes to class-j nodes between two graphs. To optimize y, PA further decompose it into another two weights, w\u2208 \u211d|Y|\u00d7|Y|_and_a\u2208 \u211d|Y|\u00d71,\nwhich are defined as:\n[w]\u1d62,\u2c7c = P_T(Yu=i,Yv=j|euv\u2208ET) / Ps(Yu=i,Yv=j|euv\u2208Es),  (7)\n[a]\u1d62 = PT(Yu=i|euvET) / Ps(Yu=i|euv\u2208Es), Vi, je Y. (8)\nGiven w, a can be derived via:\n[a]\u1d62 = \u2211_jey([w]i,jPs(Yu=i,Yv=j|euv\u2208Es)) / Ps(Yui euv\u2208\u03b5\u03c2) (9)\nGiven w and a, y can then be estimated via:"}, {"title": "3 Results", "content": "rank properties, respectively. In this work, the values of a and \u03b2 were respectively set at 5e-4 and 1.5. The third loss function for objective aims to maintain node feature smoothness in the learned graph, which is represented by the following term Lnode\nL_node = tr(XTLX),  (4)\nwhere L is the normalized graph Laplacian matrix of S. The final objective function is as follow:\narg min L = wcLcls + Lgraph + WnLnode,  (5)\nS,\u03b8\nw_c and w_n were set as 0.1 and 1. To solve this loss, we employ an alternating optimization schema (details provided in Supplementary File 1) to jointly update @ and S.\nAs an increasing number of GNN algorithms are developed for cell type prediction using scRNA-seq data, the diversity in the construction of these graphs\u2014whether cell-cell, gene-gene, or cell-gene graphs\u2014and their formulation methods continue to expand. Despite their potential, these methods often face generalization challenges, especially when scRNA-seq data used for inference comes from patients with different health conditions, or when the data is collected using varied methodologies across different studies. This variability can lead to unique interconnection patterns in the data. In the context of GNNs used for single-cell prediction in cell-cell graphs, transfer issues in node classification (i.e., cell type annotation) become apparent, particularly when annotating cell types within the TME of one patient based on a model trained with scRNA-seq data from another. This highlights the inherent biological and contextual differences between individuals. In this work, we introduce for the first time the concept of graph domain adaptation (GDA) to address the challenges associated with applying a learned cell-cell graph for cell type annotation across different individuals.\nSpecifically, we train a model to predict cell types from reference scRNA-seq data G_s =\n(V_s, E_s, X_s) which comprises a feature encoder, \u03c6: \u03c7 \u2192 H and a classifier, g: H \u2192 Y. In this work, implemented as a two-layer GCN, similar to the GSL model, and g a two-layer Multi-Layer Perceptron. Given the query data G_r = (V_\u0442, \u0415_\u0442, \u0425_\u0442), the objective is to use GDA on this model to minimize the target error \u03b5_\u03c4(g\u00b0\u03c6).\nIn GDA for graphs with the adjacency matrix A and node labels Y, shifts in graph structure, indicated by P_s(A, Y) \u2260 P_\u0442(A, Y), typically manifest as either conditional structure shift (CSS), label shift (LS), or a combination of both. With decomposition as P(A,Y) =\nP(A|Y)P(Y), CSS and LS are defined as P_s(A|Y) \u2260 P_\u2081(A|Y) and P_s(Y) \u2260 P_\u2081(Y), respectively. To address these, the GDA framework of Pairwise Alignment (PA) is employed. Specifically, PA constructs the matrix of density ratio between the target and source graphs \u03b3\u2208 \u211d|Y|X|Y| to reweight edges for GNN encoding, which can be formulated as follow:\n[\u03b3]\u1d62,\u2c7c = Pr(Y_v=j|Yu=i,veNu) / Ps(Y_v=j|Yu=i,veNu), Vi, je Y.  (6)\n[y]\u1d62,\u2c7c denotes the density ratio from class-i nodes to class-j nodes between two graphs. To optimize y, PA further decompose it into another two weights, w\u2208 \u211d|Y|\u00d7|Y|_and_a\u2208 \u211d|Y|\u00d71,\nwhich are defined as:\n[w]\u1d62,\u2c7c = P_T(Yu=i,Yv=j|euv\u2208ET) / Ps(Yu=i,Yv=j|euv\u2208Es),  (7)\n[a]\u1d62 = PT(Yu=i|euvET) / Ps(Yu=i|euv\u2208Es), Vi, je Y. (8)\nGiven w, a can be derived via:\n[a]\u1d62 = \u2211_jey([w]i,jPs(Yu=i,Yv=j|euv\u2208Es)) / Ps(Yui euv\u2208\u03b5\u03c2) (9)\nGiven w and a, y can then be estimated via:"}, {"title": "3.1 Predictive Performance of the scGSL Model Across Three Disease Types at the Patient Level", "content": "To assess the accuracy of the scGSL model in cell type identification, we employed it to predict paired cell types across different patient samples for three distinct diseases. In each dataset, every pair of patient samples acted as both \"training set\" and \"test set\" in a comprehensive combinatorial setup. Each experiment was evaluated based on four key metrics: Accuracy (ACC), Precision (PRE), Recall (REC), and F1 Score (F1). Fig. 3 presents the overall experimental results in the form of violin plots, where each subplot displays outcomes based on the aggregate dataset and the three disease-specific datasets. Each point within the plots represents an experimental pair of patient samples, providing a detailed visual representation of the model's performance across various conditions.\nOverall, the model achieved an average accuracy of 84.83%, with precision at 86.23%, recall at 81.51%, and an F1 score of 80.92% across all datasets, indicating robust predictive capabilities. In assessing the scGSL model across three distinctive datasets, each showed varied but generally effective performance metrics. The Leukemia dataset showed a robust average accuracy of 86.85% and precision at 78.46%, though it had slightly lower recall and F1 scores at 75.23% and 73.39%, respectively. The Breast Invasive Carcinoma dataset maintained a balanced performance with an average accuracy of 83.56% and a notably high precision of 89.42%. In the Colorectal Cancer dataset, the model excelled with an average accuracy of 86.52%, complemented by consistent precision and recall rates of 86.44% and 86.07%. These findings across the datasets underline the scGSL model's robust predictive capabilities and highlight its potential applicability in diverse clinical scenarios."}, {"title": "3.2 Comparison of scGSL Model Performance with Other Models", "content": "In the field of single-cell RNA sequencing, several computational methods have been developed for cell type identification, each utilizing different strategies. These include marker- based methods like MarkerCount [27] and CHETAH [28], which rely on known genetic markers; supervised machine learning approaches such as singleCellNet [29], scLearn [30], and scPred [31], which use labeled datasets to train predictive models; reference-based mapping techniques like scmapCell [32], SingleR, and sciBet [33], which match query cells to a reference database; and comprehensive frameworks like Seurat and scClassify [34]. \u03a4\u03bf thoroughly evaluate the efficacy of our scGSL model, we have conducted comparative experiments using these ten established methods across all available datasets. The results of these comparisons are meticulously presented in Table 1 for the Leukemia dataset, Table 2 for the Breast Invasive Carcinoma dataset, and Table 3 for the Colorectal Cancer dataset. Additionally, a partial comparison of the embeddings learned by these methods is visually displayed in Fig. 4.\nIn the comparative evaluation across three datasets, our scGSL model consistently demonstrated superior performance. On the Leukemia dataset, it achieved the highest average accuracy (ACC) of 86.85%, outperforming the second-best SingleR model by 3.07%. In the Breast Invasive Carcinoma dataset, scGSL led with an average ACC of 82.14%, surpassing SingleR by 3.20%. Similarly, on the Colorectal Cancer dataset, it recorded the highest average ACC of 86.52%, exceeding the second-best scLearn by 2.93%. These results highlight scGSL's robust ability to accurately classify cell types, outshining other methods in various cancer contexts."}, {"title": "3.3 Ablation Study for scGSL with Different Settings", "content": "In constructing the cell-cell graph for the scGSL model, HVGs are first selected, followed by the application of the KNN algorithm to establish an initial graph structure. Given that scGSL is a model based on GNN, this section systematically examines the impact of both the selection of the KNN algorithm and the HVG filtering criteria on the predictive performance of scGSL.\nFor the former, Fig. 5a displays violin scatter plots comparing the scGSL model's performance across different datasets under various KNN settings. The standard setting of K=0.2% total cell count and embedding size of 128 (K=0.2%, ES=128) consistently delivered superior results, achieving the highest average accuracy and F1-score. Other tested settings included K=0.1% &\nES=128, K=0.5% & ES=128, K=0.2% & ES=64, and K=0.2% & ES=256. None of these configurations could match the ACC and F1 results of the standard setting. This emphasizes the effectiveness and robustness of the K=0.2% and ES=128 configuration in the scGSL model for optimal cell type classification performance.\nTo compare different gene selection strategies, we collated gene sets from six gene signaling pathway databases, including KEGG and Reactome, as well as the cell state marker gene database (CancerSEA database) and the LRI database [19, 35-39]. We used the genes found within each of these individual databases as criteria for gene selection, which were then used to construct node features in our graph-based model. Fig. 5b showcases a heatmap of the scGSL model's performance, combining these varied selection approaches on the E-MTAB-8107 dataset, which includes data from 10 pairs of patients across five distinct patients. In our comparative analysis of gene selection strategies across several databases, our method (HVG3000) demonstrated superior performance with an ACC of 81.47%, PRE of 88.39%, REC of 82.49%, and F1 of 82.58%. Fig. 5c illustrates a comparison of cell type prediction accuracies in the GSE132509 dataset, using the scGSL model both with and without the GSL component.\nThe results demonstrate that the inclusion of GSL significantly enhances predictive accuracy. Specifically, the average accuracy with GSL was 90.89%, compared to 87.55% when GSL was not utilized. This improvement underscores the effectiveness of GSL in enhancing the precision of cell type predictions in complex biological datasets."}, {"title": "3.4 Evaluating the Interpretability of Cell-Cell Graphs Generat-ed from scGSL in TME", "content": "In this section, we explore the interpretability of disease-specific cell-cell graphs derived from scGSL by reviewing existing literature. Specifically, we focus on gene pairs involved in cell- cell interactions within the microenvironments of three diseases: Leukemia, Breast Invasive Carcinoma, and Colorectal Cancer. These gene pairs have been confirmed in prior studies as significant for their roles in intercellular communication within these diseases. Utilizing these validated gene pairs, we assess the statistical significance of these interactions in the constructed cell-cell graphs (visualized in Fig. 6). In the Leukemia dataset, the \"SPRY1-LAT\" and \"BSG-ATP2B4\" gene pairs within CD8T cells are investigated, confirmed by studies referenced in PMID19915061 [40] and PMID26729804 [41]; in the Breast Invasive Carcinoma dataset, the \"ATP2A3-SP1\" and \"ZAP70-TLN1\" gene pairs within CD8T cells are investigated, as established in the literature with PMIDs 22851172 [42] and 20488542 [43]; in the Colorectal Cancer dataset, the \"BIRC5-CASP6\" and \"PSMC3-SIRT7\" gene pairs within malignant cells are investigated, documented in PMIDs 23856250 [44] and 28435470 [45].\nSpecifically, we focused on the above particular gene pairs within a certain cell type, such as the CD8T cell subgraph in the Leukemia Dataset. We categorized the cells into two groups: one containing cells connected by an edge and the other consisting of cells without an edge, which served as the background group. We then conducted the Mann-Whitney U test to compare the expression levels of the two genes in the gene pair between these groups. If the p- value from this test is less than 0.05, it indicates that the differences in gene expression are statistically significant. Such a significant result would support the claim that the gene pair's expression differences, as learned by the scGSL from the cell-cell graph, are biologically meaningful.\nIt is noted that the generation of the cell-cell graphs was generated in an unsupervised manner, meaning that the gene pairs validated were not involved in the model training process. As a result, Tables 4, 5, and 6 present findings from three different cancer datasets: Leukemia, Breast Invasive Carcinoma, and Colorectal Cancer. In the Leukemia dataset, the gene pair \"SPRY1- LAT\" achieved significant p-values (less than 0.05) in 7 out of 12 experiments, while \"BSG- ATP2B4\" showed significance in 10 out of 12 experiments. In the dataset for Breast Invasive Carcinoma, every experiment involving the gene pair \"ATP2A3-SP1\" resulted in significant p- values, and \"ZAP70-TLN1\" was significant in 6 out of 8 experiments. In the Colorectal Cancer dataset, \"BIRC5-CASP6\" was significant in 7 out of 8 experiments, and \"PSMC3-SIRT7\" in 6 out of 8. These results underscore the robustness and biological relevance of the unsupervised cell-cell graph approach, as it successfully identified biologically meaningful gene interactions across various types of cancer without prior knowledge of these interactions during the model's training phase."}, {"title": "4 Conclusions", "content": "The scGSL model represents a significant advancement in the analysis of non-spatial transcriptomic scRNA-seq data within the context of cancer research. By leveraging GNN and graph domain adaptation, our model not only enhances the accuracy of cell type annotation but also provides a deeper understanding of the intricate cellular interactions within the TME. The ability of the scGSL model to autonomously generate and refine cell-cell interaction graphs based on intrinsic labels ensures a more biologically accurate representation of intercellular communication. This is crucial for identifying potential therapeutic targets and understanding the complex network of interactions that drive tumor progression and resistance to therapies.\nDespite its robust performance, the scGSL model faces certain challenges and limitations. One significant challenge is the inherent complexity of TMEs, which can vary widely between different types of cancers and even between patients with the same type of cancer. This variability can affect the generalizability of the model across different datasets and cancer types. Additionally, the reliance on labeled data from specific cancer types for training may limit the model's applicability to cancers with less available data. Furthermore, the model's performance is contingent on the quality and completeness of the underlying scRNA-seq data, which can be affected by technical variations and sampling errors."}, {"title": "5 Funding", "content": "This research was funded by the National Science Fund for Distinguished Young Scholars of China under grant number: 62325308; the Science and Technology Innovation 2030-New Generation Artificial Intelligence Major Project under grant number No. 2018AAA0100103; the National Natural Science Foundation of China under grant number 62002297, grant number 61722212, grant number 62072378, grant number 62273284, grant number 62472353, grant number 62302495, and grant number 62172338; the Neural Science Foundation of Shaanxi Province under grant number: 2022JQ-700; the Fundamental Research Funds for the Central Universities under grant number: D5000230199; the Guangdong Basic and Applied Basic Research Foundation under grant number 2024A1515011984; and the Fundamental Research Funds for the Central Universities under grant number G2023KY05102."}, {"title": "Supplementary File 1", "content": "Updating \u03b8. \u03a4o update 0", "to": "nmin L(S", "1": "is advisable. This\napproach alternates between a gradient descent step and a proximal step", "below": "nS(k) = proxyr (S(k-1) \u2013 NV5L(S", "as\nfollow": "nprox (Z) = arg min ||S \u2013 Z|| + R(S)\n2\nSpecifically", "expressed\nas": "nproxa||\u00b7||1 (Z) = sgn(Z)\u2299(|Z| \u2212 a)+,\nprox||-|| (Z) = Udiag((\u03c3\u00a1 \u2212 \u03b2)+)\u00bfVT\nwhere_Z = Udiag(61,..., \u03c3\u03b7) VT"}]}