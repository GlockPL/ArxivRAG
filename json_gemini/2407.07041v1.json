{"title": "Hiding Local Manipulations on SAR Images: A Counter-Forensic Attack", "authors": ["Sara Mandelli", "Edoardo Daniele Cannas", "Paolo Bestagini", "Stefano Tebaldini", "Stefano Tubaro"], "abstract": "The vast accessibility of Synthetic Aperture Radar (SAR) images through online portals has propelled the research across various fields. This widespread use and easy availability have unfortunately made SAR data susceptible to malicious alterations, such as local editing applied to the images for inserting or covering the presence of sensitive targets. Vulnerability is further emphasized by the fact that most SAR products, despite their original complex nature, are often released as amplitude-only information, allowing even inexperienced attackers to edit and easily alter the pixel content. To contrast malicious manipulations, in the last years the forensic community has begun to dig into the SAR manipulation issue, proposing detectors that effectively localize the tampering traces in amplitude images. Nonetheless, in this paper we demonstrate that an expert practitioner can exploit the complex nature of SAR data to obscure any signs of manipulation within a locally altered amplitude image. We refer to this approach as a counter-forensic attack. To achieve the concealment of manipulation traces, the attacker can simulate a re-acquisition of the manipulated scene by the SAR system that initially generated the pristine image. In doing so, the attacker can obscure any evidence of manipulation, making it appear as if the image was legitimately produced by the system. We assess the effectiveness of the proposed counter-forensic approach across diverse scenarios, examining various manipulation operations. The obtained results indicate that our devised attack successfully eliminates traces of manipulation, deceiving even the most advanced forensic detectors.", "sections": [{"title": "I. INTRODUCTION", "content": "Synthetic Aperture Radar (SAR) images are remote sensing data that use radar waves to create two-dimensional or three-dimensional representations of objects or landscapes. Over the last years, many online portals have given access to SAR images in easy-to-download and manageable data products."}, {"title": "II. BACKGROUND", "content": "In this section, we present some background concepts useful to understand the tackled objective and the proposed methodology. We start reporting details on SAR imaging; then, we show the most common SAR image manipulations; finally, we describe the existing state-of-the-art forensic detectors that deal with such manipulations."}, {"title": "A. SAR Imaging", "content": "A SAR system involves an imaging radar installed on a mobile platform, such as a satellite or an aircraft, moving in a specific direction. As it moves, the system transmits a series of high-power electromagnetic waves through its antenna. These waves engage with the objects they encounter on the Earth's surface and undergo backscattering, altering their amplitude and phase based on the permittivity and physical characteris-tics of the objects, like geometry and roughness. Subsequently, the antenna captures these modified echoes, which can be processed to generate the complex SAR image [13].\nThis final image can undergo additional processing. Accord-ing to the specific acquisition mode and type of additional processing applied, various distinct SAR products can be generated [15]. For instance, SAR images can be acquired with Strip, Spot and Scan acquisition modes [16], which results in images with different spatial resolution and spec-tral features. Then, SAR images can be processed to obtain Single Look Complex (SLC), Multi Look Complex (MLC) or Ground Range Detected (GRD) products. Among them, SLC processing considers a single acquisition step per scene, retaining full resolution in azimuth and range directions. SLC images have the highest fidelity of all SAR image products, as they are free from interpolation or projection artifacts. For this reason, SLC products are usually employed for SAR quality assessment, calibration and interferometric applications [17].\nIn the next lines, we first describe the general end-to-end SAR system model, which refers to the entire pipeline of data acquisition and formation. Then, we provide some details on speckle noise, which characterizes all SAR imaging systems."}, {"title": "1) End-to-end SAR system model", "content": "The end-to-end SAR system model regards the modeling of the entire process which starts from the reflection from a scattering object until its conversion into an image. The process starts from the source complex scene reflectivity, which collects all the information regarding the object's characteristics (like permittivity, con-ductivity and surface structure) and the antenna system (e.g., the wavelength of transmitted waves, the polarization, the inci-dence angle and the imaging geometry) [13]. Focusing on SAR 2D imagery, we can model a generic scene reflectivity image as $I_{Re^{j\\Phi}} \\in \\mathbb{C}^{X \\times Y}$, where $I_R \\in \\mathbb{R}^{X \\times Y}$ is the amplitude component and $\\Phi_R \\in \\mathbb{R}^{X \\times Y}$ is the phase term. X and Y correspond to range (i.e., the direction perpendicular to platform flight along which the electromagnetic beam travels) and azimuth (the actual trajectory of the platform), respectively.\nThe scene reflectivity is acquired by the SAR system in the form of backscattered echoes, which are usually denoted as raw data. The process that regresses raw data back to an estimate of the complex reflectivity scene is named focusing, or image formation. In the SAR imaging community, it is common to model the entire acquisition and processing chain as a cascade of linear filters [13], [18], [19]. The final image spectrum can be related to the initial scene reflectivity spectrum as\n$F(I_e^{j\\Phi}) = F(I_Re^{j\\Phi_R}) \\odot H(f_x, f_y),$   (1)\nwhere the operator F(\u00b7) describes the 2D Fourier Trans-form (FT) and describes the element-wise product, while $H(f_x, f_y)$ is the 2D transfer function of the end-to-end SAR system model, expressed as a function of the spatial frequen-cies $f_x$ and $f_y$. The final 2D image $I_e^{j\\Phi} \\in \\mathbb{C}^{X \\times Y}$ is the result of the SAR acquisition and focusing operations. An example of the amplitude of a 2D SLC SAR image selected from the TerraSAR-X ESA archive [20] is reported in Fig. 2 (left).\nIn particular, for spaceborne strip-map data $H(f_x, f_y)$ can be described as a linear azimuth and range invariant operator, which is usually approximated as a non-negative real central-symmetric 2D filter with a low pass behaviour [13], [19]. Formally,\n$\\begin{array}{l}H\\left(f_{x}, f_{y}\\right) \\geq 0 ;\\\\H\\left(-f_{x}, f_{y}\\right)=H\\left(f_{x}, f_{y}\\right) ;\\\\H\\left(f_{x}, f_{y}\\right) \\approx 0, \\forall f_{x}>f_{c x}, \\forall\\left|f_{y}\\right|>f_{c y},\\end{array}$   (2)\nbeing $f_{cx}$, $f_{cy}$ specific cutoff frequencies along azimuth and range dimensions, respectively. These frequencies may be known in advance if the SAR system model is known, but they can be easily inferred by observing the spectrum of"}, {"title": "2) Speckle pattern", "content": "In the SAR imaging community, it is well-known that the majority of surfaces exhibit significant roughness at the scale of an optical wavelength [14]. When exposed to coherent radiation, the wave reflected from such surfaces comprises contributions from numerous independent scattering areas with various different relative delays. The inference of these contributions gives rise to a typical granular pattern known as speckle [14]. This pattern typically presents a continuum of irradiance values, which range from dark spots (due to destructive interference) to bright spots (due to constructive interference).\nThe statistical modeling of the speckle pattern is done by considering the sum of the various complex microscopic contributions. Each component carries an amplitude and a phase that are statistically independent of each other and of the amplitude and phase of the other components [14]. Given a large number of contributions, it can be proved that the speckle pattern components (the real and the imaginary part) are inde-pendent and identically distributed as a Gaussian probability density function with zero mean. This results in a complex speckle pattern $S e^{i\\Phi_S}$ with an amplitude $S(x,y)$ character-ized by a Rayleigh probability density function and a phase term $\\Phi_S(x, y)$ uniformly distributed [21]. More specifically, $S(x,y) \\sim R(\\sigma_s)$, being $\\sigma_s$ the scale parameter of a Rayleigh probability distribution, whether $\\Phi_s(x, y) \\sim U[0, 2\\pi]$.\nIf we restrict the field to SLC SAR images (i.e., when a single image of the scene reflectivity is acquired and pro-cessed by the SAR system), the scene reflectivity $I_Re^{j\\Phi_R}$ (i.e., the source data that enters the SAR imaging system) follows a multiplicative speckle model with a fully developed speckle [22]. In practice, $I_Re^{j\\Phi_R}$ results from the element-wise product of a hypothetically noise-free image $I_0e^{j\\Phi_0}$ (which can be seen as a non-observable signal in our model), and the speckle pattern. Thus, $I_Re^{j\\Phi_R} = I_0e^{j\\Phi_0} \\odot S e^{j\\Phi_S}$.\nAs a consequence, the scene reflectivity image is composed by the contributions of manifold complex components, each due to a different scattering point on the target surface, showing a speckle pattern superimposed to the image of interest [14]. This pattern is maintained throughout the process of SAR data acquisition and focusing, thus it is reflected in the final reconstructed image $I_e^{j\\Phi}$. In Fig. 2 (right) we show a close-up of the previoulsy shown 2D SAR amplitude image, which is actually an SLC image thus it reasonaly contains a high amount of speckle noise. It is noticeable the effect of the speckle pattern as a granular noise superimposed to the scene of interest."}, {"title": "B. SAR amplitude image manipulations", "content": "In this paper we deal with the detection of local manipu-lations on SLC SAR amplitude images. These images may be manipulated for a variety of reasons, which span from legitimate privacy concerns up to malicious intents guided"}, {"title": "C. SAR forensic detectors", "content": "The forensic community has developed manifold image splicing detectors during the years, specifically focused on classic 8-bit imagery like photographs or video frames [25], [26]. All the deployed detectors leverage the same assumption, that is, the acquisition device and processing operations leave peculiar traces on images, and these can be exploited to expose local forgeries [27], [26].\nThe acquisition pipeline of SAR amplitude images is com-pletely different than digital photographs or video sequences. Nonetheless, it has been shown that different SAR products reasonably contain different traces relative to the processing executed for generating them [10]. In this vein, the authors of [10] recently proposed a forensic detector for localizing splicing areas on SAR amplitude images. This detector high-lights local inconsistencies between the donor and target pixel areas, and proves superior than state-of-the-art detectors on these specific images.\nThe detector training phase involves a siamese training of a denoising network architecture known as Denoising Convolutional Neural Network (DnCNN) [28]. The training process can be summarized by these three steps:\n1) Consider a number of SAR amplitude images coming from different products.\n2) Apply the DnCNN to patches extracted from different images to obtain a series of noise patterns.\n3) Train the DnCNN to extract similar noise patterns for patches coming from the same product, and different patterns from patches coming from different products.\nEventually, the trained DnCNN is able to extract a noise-like fingerprint with the same size of the input image. This fingerprint contains traces related to the processing pipeline of the acquired product, highlighting potential splicing attacks as traces' inconsistencies. Indeed, when analyzing pristine images, the fingerprint is self-consistent, whereas in case of spliced images it clearly highlights the edited regions.\nMore formally, let us consider a generic manipulated am-plitude image as input to the detector. For simplicity, we omit the subscript T from the manipulated images notation, taking for granted that all amplitude images indicated as I have been manipulated in a specific target region of pixels, identified by the tampering mask M. At first stage, the detector estimates a real-valued fingerprint map P, exposing local inconsisten-cies between pixels. Given P, the authors propose different methods to process P for estimating a binary mask M that identifies the forgery region. For an extensive description of the method, we refer the interested reader to [10]."}, {"title": "III. PROBLEM FORMULATION", "content": "In this paper we tackle a counter-forensic task, aiming at hindering the capability of existing forensic detectors in spotting local forgeries applied to SAR amplitude images. We assume to have available an amplitude image I, which has been locally manipulated for inserting or hiding details, as shown in Section II-B. Moreover, we suppose to know which is the satellite that has been used to acquire the original data and which are the acquisition mode (e.g., strip, spot, scan) and processing applied (e.g., SLC, MLC, or GRD). Notice that this situation resembles a realistic scenario, as the potential attacker typically has knowledge of the SAR system used to acquire the data under manipulation.\nOur goal is deleting the manipulation artifacts from I such that forensic detectors cannot spot the manipulation traces anymore. In doing so, we do not want to deviate from neither the semantic content nor the visual quality of \u012a. Moreover, we want to transfer to the attacked image the same properties of the pristine data acquired by the original SAR system, like the speckle-noise content and the traces left by the acquisition and processing operations. In other words, the final produced amplitude image must completely match the semantic char-acteristics of I (i.e., it actually presents a forgered area), but it has to be transparent to visual inspection (i.e., the visual quality is mantained), to SAR properties inspection, and to the forensic detector, that must estimate it being pristine in its entire area. We define the attacked amplitude image as I.\nWe consider as reference detector that proposed in [10], previously described in Section II-C, because it is specially tailored to SAR imagery and represents the state-of-the-art solution for spotting local image manipulations in the SAR field. Since this detector leverages the fingerprint extraction step as necessary operation for localizing the tampering area, our goal turns into concealing the forensic traces from I such that its fingerprint resembles that of of pristine image."}, {"title": "IV. PROPOSED METHODOLOGY", "content": "To hide local manipulations from a SAR amplitude image \u012a, we propose to recreate the effect of a SAR acquisition of the scene targets depicted in I. To do so, we exploit the original SAR system information which is available at attacker side. The output of the SAR acquisition is the amplitude image I, which still resembles I from the semantic content viewpoint (both in tampered with and original areas) but presents SAR-related properties that are equivalent to those of pristine data acquired with that satellite.\nA sketch of the proposed methodology is shown in Fig. 6. Our method is composed of three main steps:\n1) Image despeckling. We remove the speckle noise from the manipulated amplitude image I to recreate the noise-free scene reflectivity image as it was before acquisition.\n2) SAR acquisition simulation. By leveraging information on the original SAR system, we simulate the acquisition of the targets depicted in the manipulated scene.\n3) Histogram matching. We match the pixel histogram of the resulting image with that of the manipulated amplitude image I, in order to keep the dynamic range similar to the initial one. This step can be seen as a refinement phase of the previous point.\nThe effect of the proposed methodology is twofold. On the one hand, by acquiring the scene targets depicted in I with the same acquisition system of the pristine data, we force the resulting amplitude image I to maintain similar SAR characteristics to the pristine data, like the amount of speckle noise and its spatial and frequency pattern. The final histogram matching completes the process by adjusting the pixel dynamics. On the other hand, the SAR acquisition"}, {"title": "A. Image Despeckling", "content": "Since the goal is reproducing the effect of a SAR acquisition of the scene targets depicted in the manipulated image, the first natural step of an attacker would be to remove the speckle noise introduced by the previous acquisition. This operation would enable to simulate the acquisition of noise-free targets, which is exactly what happens if we consider the SAR acquisition model presented before.\nTo do so, we leverage well-known state-of-the-art SAR despeckling algorithms, namely the Fast Adaptive Non-local SAR Despeckling (FANS) [29] and the Non-Local framework for (In)(Pol)SAR denoising (NL-SAR) [30]. Both techniques reported excellent performances on SAR data and can work with the image amplitude information alone. These charac-teristics make them perfectly suited for our case study with respect to modern data-driven solutions [31] that would require a specific training and work with complex images exclusively. Following a similar notation to Section II-A2, the despeckled amplitude image is defined as $I_0$.\nNotice that the main disadvantage of image despeckling is the potential loss of high frequency details in the final despeckled image. As a matter of fact, the despeckling algo-rithm risks to remove also point scatterers that were originally depicted in the reflectivity scene. We show in our experiments that this despeckling step can be avoided, as the effects of the previous SAR acquisition are completely superseded by the new acquisition step that follows. To keep at most the frequency content of the scene depicted in the manipulated image I, we prove that it is a better choice to omit this step, directly going to the simulation of the SAR acquisition."}, {"title": "B. SAR Acquisition Simulation", "content": "This step is the main core of the proposed counter-forensic attack. It consists of recreating the acquisition of the scene tar-gets depicted in the manipulated image by means of the same SAR system (or an estimate of it) that was used to acquire the original data. Referring to SAR background concepts reported in Section II-A, we split this step into two separate stages, namely speckle injection and SAR system simulation."}, {"title": "1) Speckle Injection", "content": "The injection of speckle noise is required to simulate the acquisition of a complex SAR image in which the targets, defined by the noise-free manipulated amplitude image $I_0$, are affected by speckle noise. To do so, we generate a complex speckle noise $S e^{i\\Phi_S}$ with the same size of $I_0$ and with the characteristics reported in Section II-A. In general, $S(x, y) \\sim R(\\sigma_s)$, being of the scale parameter of a Rayleigh distribution, whether $\\Phi_s(x, y) \\sim U[0, 2\\pi]$.\nThe output image of this stage is obtained by element-wise multiplication between the input image $I_0$ and the speckle noise. This is defined as $\\bar{I}_{se^{i\\Phi}} = I_0 \\odot S e^{i\\Phi_S}$, being the element-wise product. Notice that the final image $\\bar{I}_{se^{i\\Phi}}$ is complex, i.e., it carries both amplitude and phase information."}, {"title": "2) SAR System Simulation", "content": "To recreate a SAR acquisition, the speckle-affected image $\\bar{I}_{se^{i\\Phi}}$ must be filtered through the same acquisition and processing system used to acquire the original data. This maps into the exploitation of the SAR system frequency response H described in Section II-A1.\nIn this context, we consider four different realistic scenarios that the attacker can encounter: (i) H is fully known; (ii) the attacker disposes of the original complex image under attack; (iii) the attacker disposes of N complex images captured by the same satellite, different from the original image under attack; (iv) the attacker only disposes of the original ampli-tude image under attack. The last three scenarios require an estimation process for extracting information on the original system frequency response. As suggested in [19], we assume the SAR system frequency response can be approximated by a real central-symmetric nonnegative function. For simplicity, we describe the proposed estimation process for case (ii), detailing the differences with respect to cases (iii) and (iv) at the end of the derivations.\nTo estimate H, we consider four consecutive steps (see Fig. 7):\n1) We first compute the 2D FT of the original image $I_e^{j\\Phi}$ and take its magnitude value, defined as $F_1 = |F(I_e^{j\\Phi})|$.\n2) We apply a smoothing to $F_1$ through a Gaussian kernel K. Formally, we can define the resulting magnitude spectrum as\n$F_{K}(f_{x}, f_{y})=F_{1}(f_{x}, f_{y}) * K(f_{x}, f_{y}),$   (5)\nbeing * the 2D linear convolution and $(f_x, f_y)$ the tuple of spatial frequencies. We do so for reducing the local variability of the acquired data. This helps untying the filter estimation process from the actual data content which is noisy and dependent on the depicted scene.\n3) Given $F_K$, we estimate three different versions of the frequency response of the SAR acquisition system: (i) we fit a 2D Gaussian bell; (ii) we fit a 2D Raised Cosine, as suggested in [19]; (iii) we directly estimate it by slightly modifying $F_K$.\n2D Curve Fitting. Gaussian and Raised Cosine fitting are done through the same sequence of operations. In particular, we need two further steps:"}, {"title": "\u2022", "content": "As done in [19], we normalize $F_K$ by the square root of its energy, obtaining\n$F_{K_{n}}=\\frac{F_{K}}{\\sqrt{\\sum_{f_{x}} \\sum_{f_{y}} F_{K}^{2}\\left(f_{x}, f_{y}\\right)}}$   (6)\n\u2022 Through least squares fitting, we exploit $F_{K_n}$ to fit a 2D Gaussian bell $G(f_x, f_y)$ or a 2D raised cosine $R(f_x, f_y)$. Both functions present separable components along the two frequency dimensions. $G(f_z)$ is defined as\n$G\\left(f_{z}\\right)=g_{z} \\cdot e^{-\\frac{\\left(f_{z}-\\mu_{z}\\right)^{2}}{2 \\sigma_{z}^{2}}},$   (7)\nwhere $z \\in \\{x,y\\}$ and being $g_z$, $\\mu_z$ and $\\sigma_z$ the gain, the mean value and the variance along z dimension, respectively. R($f_z$) is defined as\n$R\\left(f_{z}\\right)=\\left(A_{z}-B_{z} \\cos \\left(\\pi\\left(f_{z}-f_{c z}\\right) / f_{c z}\\right)\\right), f_{z} \\leq f_{c z},$   (8)\nwhere $f_c$ is the cutoff frequency (R($f_z$) = 0 for $f_z>f_{cz}$) and $A_z > 0$ and $B_z > 0$ are model parameters [19].\nWe define the 2D frequency responses achieved by the least squares fitting as $H_G$ and $H_R$, consider-ing Gaussian and Raised Cosine, respectively. These frequency responses always correspond to real-valued central-symmetric nonnegative functions.\nDirect estimation. In the last case, we directly employ $F_K$ to estimate the frequency response of the SAR acquisition filter. Notice that, being $F_k$ the frequency response of a complex signal, it does not necessarily cor-respond to a central-symmetric function. To circumvent this issue, we compute its 2D Inverse Fourier Transform (IFT) and consider only the real part contribution. For-mally, we define the 2D real signal\n$h_{D}=\\operatorname{Re}\\left(I \\mathcal{F}\\left(F_{K}\\right)\\right),$   (9)\nwhere $I \\mathcal{F}(\\cdot)$ represents the 2D Inverse Fourier transform operator. The finally estimated 2D frequency response is defined as $H_D = |F(h_D)|$. In this case, $H_D$ satisfies the symmetry and positivity contraints.\n4) In the last phase, the SAR acquisition filter is estimated by normalizing the obtained frequency response, i.e., either $H_G$, $H_R$ or $H_D$, by its maximum value, such that all versions have maximum gain equal to 1. We denote the estimated system frequency response as H. In the Gaussian case, H = $H_G$ / $H_{Gmax}$; in the Raised Cosine case, H = $H_R$ / $H_{Rmax}$; in the direct estimation case, H = $H_D$ / $H_{Dmax}$\nIf the original complex image is not available at attacker side but N complex images captured by the same satellite can be found, H can be estimated as the arithmetic mean of the single frequency responses estimated by each complex image.\nIn the case in which only the original amplitude image is known by the attacker, the estimation process is strongly affected by the loss of high frequency details in the spectrum. We show in Section VI-A that the amplitude image is not sufficiently informative for estimating the SAR system, thus returning poor results in the simulation of the re-acquisition."}, {"title": "C. Histogram Matching", "content": "In the last phase of the proposed attack, it may happen that the resulting amplitude image IH presents a few differences with respect to the image I in terms of dynamic range and pixels' distribution. As a matter of fact, there may be little differences between the injected and the actual speckle noise distributions. Also, the estimation of the system frequency re-sponse may contain small errors. All these situations contribute to little mismatch between the distribution of attacked and non-attacked amplitude images, thus resulting in clear artifacts that may induce forensic investigators to expose the attacked ones.\nTo counteract this effect, we match the pixels' histogram of IH with that of the manipulated amplitude image I. In doing so, the dynamics and the pixel distribution are adapted to the initial ones, hindering the traces of the global operation done to hide the forgery.\nWe define the final amplitude image as I. This image still presents the forgered area, though, as we show in our experiments, the splicing area is invisible to the existing forensic detectors developed for image splicing localization."}, {"title": "V. EXPERIMENTAL SETUP", "content": "In this section, we describe the setup of our experimental campaign. First, we present the employed SAR image dataset; second, we provide details on the forgery creation process; third, we give information on the counter-forensic attack parameters; finally, we describe the forensic detector setup."}, {"title": "A. Pristine Dataset", "content": "We downloaded the data from ESA EO-CAT [32], which provides various SAR products acquired in different modes and missions. In particular, we selected the SAR Staring SpotLight (ST) Single Look Slant Range Complex (SSC) products from the TerraSAR-X ESA archive [20]; these prod-ucts present a resolution of 0.25m and a 16-bit dynamic range. We purposely selected these products for three main reasons:\n\u2022 They are acquired with the highest possible spatial res-olution, enabling us to produce forgeries in the area of few meters.\n\u2022 They are single look, meaning that the resulting SAR images are not the average of multiple satellite looks and thus present a reasonable amount of speckle noise.\n\u2022 They are complex products, carrying both amplitude and phase information.\nOverall, there are 24 different ST-SSC products available. The temporal coverage ranges from 2016 to 2021 and the scene content varies between city center, seaside, cropland and mountain. In particular, these products show images of four specific geographical areas, located in Rome and Dublin cities, in Gaza and in north-Italy mountains.\nThe size of ST-SSC products is not fixed and can be larger than 10K \u00d7 18K pixels. Given the huge size of these acquisitions, we divided each of them into 1024 \u00d7 1024 pixels-wide images with an overlap of 512 \u00d7 512 pixels. This operation enables to operate at a local level with fine granularity, facilitating easy processing of the input by our networks. From each product, we extracted 400-500 complex"}, {"title": "B. Manipulated Dataset", "content": "To create realistic forgeries, we always considered the case in which the donor amplitude image ID and the target ampli-tude image Ir come from the same product. This operation allows to produce realistic splicings where the difference in the dynamic range and semantic details is reasonably small, since both donor and target images belong to the original product. To run multiple experiments, we created automatic forgeries by randomly selecting donor and target regions of 128 \u00d7 128 pixels, as done in [10].\nAs done in [10], we simulated an attacker perspective by processing the donor amplitude images with post-processing operations which can make the tampering more plausible. In particular, recalling Section II-B, we applied four possible edit-ings E() to the donor image: a Gaussian blur, an upscaling, a downscaling and a rotation. Each of the last three similarity transformations is proposed in two different versions: (i) a \"Near\" version, in which the similarity parameters limit the transformations to almost imperceptible changes in the edited images, like a few degree rotation; (ii) a \u201cFar\u201d version, in which the editing process becomes more noticeable.\nIn any case, all the considered editing operations do not introduce important content variations or degradations in the image visual quality. We consider this last constraint being paramount for performing realistic investigations. Indeed, we could think to include strong image perturbations like heavy noise addition or blurring. Such editing operations would carry so many artifacts that the manipulation traces could be exposed by any SAR expert looking at the image. In this scenario, there would be no reason to perform counter-forensic attacks on the manipulated images, as the image content would be so altered that any state-of-the-art detector could spot the forgery."}, {"title": "C. Counter-forensic attack parameters", "content": "1) Image despeckling: The two despeckling algorithms considered, i.e., FANS and NL-SAR, are both unsupervised and required no fine-tuning. We set the number of looks to 1, considering our TerraSAR-X SLC samples. For the NL-SAR, we had to process each sample as non-overlapping patches of 128 \u00d7 128 pixels for computational reasons. The final despeckled image is obtained by reassembling all the patches together. FANS instead worked seamlessly on the full resolution images.\n2) SAR System Frequency Response: The 2D Gaussian kernel K used for smoothing the pristine image spectrum has $\\sigma$ = 100 pixels and size 601 \u00d7 601 pixels. To fit the 2D Gaussian bell and the 2D Raised Cosine, we employed a nonlinear iterative least squares solver, whose parameters are defined in [33]."}, {"title": "D. Detector setup", "content": "To evaluate the strength of our counter-forensic attack, we employed two different versions of the forensic detectors proposed in [10], namely the SAR Adapted Extractor (SAE) and the Augmented SAR Adapted Extractor (ASAE), which are slightly different one with the other according to the specific training pipeline employed. Specifically, the SAE detector is trained as described in Section II-C, while the ASAE detector considers data augmentation in training phase, applying upscaling to the input images to enlarge the set of available SAR products (see [10] for more details).\nIn our experiments, we used the detectors in the best possible conditions, i.e., we trained and tested them over a homogenous dataset, in which the same product was available both in training and testing stages. In doing so we guaranteed that, in absence of counter-forensic attacks, the detectors performed at the best of their possibilities. Indeed, we wanted to avoid the risk of introducing errors due to different data distributions in train and test stages. This methodology ensured that the unique factor which might cause a degradation in the performance is the proposed counter-forensic attack.\nTo train and test the forensic detectors in the best possi-ble conditions, we always showed in training phase all the possible semantic scenarios: for each of the four considered geographical areas (Rome, Dublin, Gaza and Italy mountains), we randomly selected 70% of data for training (further split in 60-40% for training and validation sets, respectively) and left the remaining 30% for testing. Notice that the training images were 100% pristine, i.e., the detectors have not been trained to spot local image forgeries. Contrarily, as done in [10], the images of the test set did always present local"}, {"title": "VI. RESULTS", "content": "At first, we aim at evaluating the ability of our proposed counter-forensic attack in producing high-quality attacked amplitude images. As previously stated, we must produce attacked images which report similar characteristics than orig-inal pristine ones, such that an expert in the SAR field would not be able to easily spot that some global post processing operations have been applied.\nTo do so, we put aside for a moment the locally manipulated amplitude images, focusing only on pristine samples. For each pristine amplitude image I, we generate an attacked version of it, namely I, by following the methodology proposed in Section IV. Therefore, in this particular experiment, the input to the counter-forensic attack are the pristine amplitude images I and not their manipulated versions \u012a. If the attacked versions of pristine samples show indistinguishable from the pristine ones, our attack can be employed to realistically modify SAR data samples that resemble original untouched ones."}, {"title": "Image quality metrics", "content": "As done in [12], we compare pris-tine and attacked samples by exploiting several similarity met-rics\u00b2. We evaluate the visual quality of the attacked samples by computing metrics typical of the image full-reference quality assessment field, i.e., the Structural Similarity Index Measure (SSIM) [34], and the Multi-Scale Structural Similarity Index Measure (MS-SSIM) [35]. The higher the similarity measure between attacked and pristine samples, ideally approaching 1, the better the quality of the attack, in terms of producing pixel content that visually resembles original data.\nWe also consider SAR compatibility metrics to evaluate our ability in reproducing speckle pattern in the attacked images. In particular, we rely on the Equivalent Number of Looks (ENL) [36], usually employed in the SAR despeckling field, to understand if the considered attacked samples are compatible with the original SAR data. The ENL is a statistical measure to quantify the level of speckle noise in SAR images. In particular, we compute the absolute relative difference of"}, {"title": "Despeckling influence", "content": "We start evaluating the achieved similarity metrics according to presence or not of the despeck-ling step in our attack. To do so, we restrict our investigations to one of the four situations presented in Section IV-B2, i.e., the different levels of attacker knowledge on the SAR system frequency response H. In particular, we omit the case in which H is fully known, as we have no access to all the information describing the original SAR system used to capture the considered dataset. We consider the best case scenario, which reasonably consists in having available the original complex image $I_{e^{j\\Phi}}$ under attack.\nWe consider three different estimation strategies of the SAR system frequency response, namely the Gaussian fitting, the Raised Cosine fitting and the direct estimation, leading to HG, HR and HD respectively. As regards the speckle noise injection parameters, we show results"}]}