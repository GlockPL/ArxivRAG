{"title": "Hiding Local Manipulations on SAR Images: A Counter-Forensic Attack", "authors": ["Sara Mandelli", "Edoardo Daniele Cannas", "Paolo Bestagini", "Stefano Tebaldini", "Stefano Tubaro"], "abstract": "The vast accessibility of Synthetic Aperture Radar (SAR) images through online portals has propelled the research across various fields. This widespread use and easy availability have unfortunately made SAR data susceptible to malicious alterations, such as local editing applied to the images for inserting or covering the presence of sensitive targets. Vulnerability is further emphasized by the fact that most SAR products, despite their original complex nature, are often released as amplitude-only information, allowing even inexperienced attackers to edit and easily alter the pixel content. To contrast malicious manipulations, in the last years the forensic community has begun to dig into the SAR manipulation issue, proposing detectors that effectively localize the tampering traces in amplitude images. Nonetheless, in this paper we demonstrate that an expert practitioner can exploit the complex nature of SAR data to obscure any signs of manipulation within a locally altered amplitude image. We refer to this approach as a counter-forensic attack. To achieve the concealment of manipulation traces, the attacker can simulate a re-acquisition of the manipulated scene by the SAR system that initially generated the pristine image. In doing so, the attacker can obscure any evidence of manipulation, making it appear as if the image was legitimately produced by the system. We assess the effectiveness of the proposed counter-forensic approach across diverse scenarios, examining various manipulation operations. The obtained results indicate that our devised attack successfully eliminates traces of manipulation, deceiving even the most advanced forensic detectors.", "sections": [{"title": "I. INTRODUCTION", "content": "Synthetic Aperture Radar (SAR) images are remote sensing data that use radar waves to create two-dimensional or three-dimensional representations of objects or landscapes. Over the last years, many online portals have given access to SAR images in easy-to-download and manageable data products. For this reason, SAR images are becoming objects of investigation by the multimedia forensic community [11], [10], [12]. Given the particular processing pipeline of SAR images, researchers have developed techniques tailored explicitly to them [11], proposing solutions for the localization of tampered-with pixel regions [10]. In particular, the authors of [10] have proposed a SAR forensic detector that uncovers traces of manipulations applied locally on SAR amplitude images. Given a SAR amplitude image, the detector processes it to estimate a fingerprint map that highlights local inconsistencies. If the map is homogeneous, the image is likely pristine; if the map shows a region with completely different characteristics than the rest, the image has been likely manipulated within that area."}, {"title": "II. BACKGROUND", "content": "In this section, we present some background concepts useful to understand the tackled objective and the proposed methodology. We start reporting details on SAR imaging; then, we show the most common SAR image manipulations; finally, we describe the existing state-of-the-art forensic detectors that deal with such manipulations."}, {"title": "A. SAR Imaging", "content": "A SAR system involves an imaging radar installed on a mobile platform, such as a satellite or an aircraft, moving in a specific direction. As it moves, the system transmits a series of high-power electromagnetic waves through its antenna. These waves engage with the objects they encounter on the Earth's surface and undergo backscattering, altering their amplitude and phase based on the permittivity and physical characteristics of the objects, like geometry and roughness. Subsequently, the antenna captures these modified echoes, which can be processed to generate the complex SAR image [13]. This final image can undergo additional processing. According to the specific acquisition mode and type of additional processing applied, various distinct SAR products can be generated [15]. For instance, SAR images can be acquired with Strip, Spot and Scan acquisition modes [16], which results in images with different spatial resolution and spectral features. Then, SAR images can be processed to obtain Single Look Complex (SLC), Multi Look Complex (MLC) or Ground Range Detected (GRD) products. Among them, SLC processing considers a single acquisition step per scene, retaining full resolution in azimuth and range directions. SLC images have the highest fidelity of all SAR image products, as they are free from interpolation or projection artifacts. For this reason, SLC products are usually employed for SAR quality assessment, calibration and interferometric applications [17]. In the next lines, we first describe the general end-to-end SAR system model, which refers to the entire pipeline of data acquisition and formation. Then, we provide some details on speckle noise, which characterizes all SAR imaging systems."}, {"title": "1) End-to-end SAR system model", "content": "The end-to-end SAR system model regards the modeling of the entire process which starts from the reflection from a scattering object until its conversion into an image. The process starts from the source complex scene reflectivity, which collects all the information regarding the object's characteristics (like permittivity, conductivity and surface structure) and the antenna system (e.g., the wavelength of transmitted waves, the polarization, the incidence angle and the imaging geometry) [13]. Focusing on SAR 2D imagery, we can model a generic scene reflectivity image as $I_R e^{j\\Phi_R}\\in\\mathbb{R}^{X\\times Y}$, where $I_R \\in \\mathbb{R}^{X\\times Y}$ is the amplitude component and $\\Phi_R \\in \\mathbb{R}^{X\\times Y}$ is the phase term. X and Y correspond to range (i.e., the direction perpendicular to platform flight along which the electromagnetic beam travels) and azimuth (the actual trajectory of the platform), respectively. The scene reflectivity is acquired by the SAR system in the form of backscattered echoes, which are usually denoted as raw data. The process that regresses raw data back to an estimate of the complex reflectivity scene is named focusing, or image formation. In the SAR imaging community, it is common to model the entire acquisition and processing chain as a cascade of linear filters [13], [18], [19]. The final image spectrum can be related to the initial scene reflectivity spectrum as\n$F(I_e^{j\\Phi}) = F(I_R e^{j\\Phi_R}) \\odot H(f_x, f_y),$ (1)\nwhere the operator $F(\\cdot)$ describes the 2D Fourier Transform (FT) and describes the element-wise product, while $H(f_x, f_y)$ is the 2D transfer function of the end-to-end SAR system model, expressed as a function of the spatial frequencies $f_x$ and $f_y$. The final 2D image $I_e^{j\\Phi}\\in \\mathbb{C}^{X\\times Y}$ is the result of the SAR acquisition and focusing operations. In particular, for spaceborne strip-map data $H(f_x, f_y)$ can be described as a linear azimuth and range invariant operator, which is usually approximated as a non-negative real central-symmetric 2D filter with a low pass behaviour [13], [19]. Formally,\n$\\begin{aligned} H(f_x, f_y) &\\geq 0;\\newline H(-f_x, f_y) &= H(f_x, f_y);\\newline H(f_x, f_y) &\\approx 0, \\forall f_x > f_{cx},\\forall |f_y| > f_{cy}, \\end{aligned}$ (2)\nbeing $f_{cx}$, $f_{cy}$ specific cutoff frequencies along azimuth and range dimensions, respectively. These frequencies may be known in advance if the SAR system model is known, but they can be easily inferred by observing the spectrum of the final image $I_e^{j\\Phi}$ [19]."}, {"title": "2) Speckle pattern", "content": "In the SAR imaging community, it is well-known that the majority of surfaces exhibit significant roughness at the scale of an optical wavelength [14]. When exposed to coherent radiation, the wave reflected from such surfaces comprises contributions from numerous independent scattering areas with various different relative delays. The inference of these contributions gives rise to a typical granular pattern known as speckle [14]. This pattern typically presents a continuum of irradiance values, which range from dark spots (due to destructive interference) to bright spots (due to constructive interference). The statistical modeling of the speckle pattern is done by considering the sum of the various complex microscopic contributions. Each component carries an amplitude and a phase that are statistically independent of each other and of the amplitude and phase of the other components [14]. Given a large number of contributions, it can be proved that the speckle pattern components (the real and the imaginary part) are independent and identically distributed as a Gaussian probability density function with zero mean. This results in a complex speckle pattern $S e^{j\\Phi_s}$ with an amplitude $S(x,y)$ characterized by a Rayleigh probability density function and a phase term $\\Phi_s(x, y)$ uniformly distributed [21]. More specifically, $S(x,y) \\sim R(\\sigma_s)$, being $\\sigma_s$ the scale parameter of a Rayleigh probability distribution, whether $\\Phi_s(x, y) \\sim U[0, 2\\pi]$. If we restrict the field to SLC SAR images (i.e., when a single image of the scene reflectivity is acquired and processed by the SAR system), the scene reflectivity $I_R e^{j\\Phi_R}$ (i.e., the source data that enters the SAR imaging system) follows a multiplicative speckle model with a fully developed speckle [22]. In practice, $I_R e^{j\\Phi_R}$ results from the element-wise product of a hypothetically noise-free image $I_0e^{j\\Phi_0}$ (which can be seen as a non-observable signal in our model), and the speckle pattern. Thus, $I_R e^{j\\Phi_R} = I_0 e^{j\\Phi_0} \\odot S e^{j\\Phi_s}$. As a consequence, the scene reflectivity image is composed by the contributions of manifold complex components, each due to a different scattering point on the target surface, showing a speckle pattern superimposed to the image of interest [14]. This pattern is maintained throughout the process of SAR data acquisition and focusing, thus it is reflected in the final reconstructed image $I_e^{j\\Phi}$."}, {"title": "B. SAR amplitude image manipulations", "content": "In this paper we deal with the detection of local manipulations on SLC SAR amplitude images. These images may be manipulated for a variety of reasons, which span from legitimate privacy concerns up to malicious intents guided by political reasons or military purposes in war scenarios. As other kinds of digital imagery, these data can be easily manipulated through editing software suites like Photoshop or GIMP, as well as through synthetic generation tools [23], [24]. Inspired by [10], we can formally describe the forgery creation process of a SAR amplitude image as follows. We define a generic pristine amplitude SAR image as I, with size $X \\times Y$. Let $I_D$ and $I_T$ be two pristine SAR amplitude images; $I_D$ is the donor image, whereas $I_T$ is the target one. We define $\\overline{I_T}$ as the tampered with version of $I_T$, which has been locally manipulated by splicing a specific pixel area of $I_D$ into $I_T$. As done in [10], we acknowledge the possibility that, before the splicing, the pixels of the donor image might have undergone additional editing procedures like resizing, rotation or noise addition to enhance the credibility and visual appeal of the attack. For example, rotation and resizing could be necessary to align the content of the source and target images and prevent the splicing from being easily detectable upon visual inspection. Therefore, we define the generic edited version of the donor image as $E(I_D)$, with $E(.)$ being a suitable editing function. We define the donor pixel region of $E(I_D)$ as $D$ and the target pixel region of $I_T$ as $T$. T is the region of $I_T$ under splicing attack. D and Tare congruent, i.e., the two pixels' regions have the same shape, size and orientation. They can differ in their location inside the respective images $E(I_D)$ and $I_T$. We formally define the resulting spliced image $I_T$ as:\n$\\overline{I_T}(x, y) = \\begin{cases} D(x', y') & \\text{if } (x, y) \\in T\\newline I_T(x, y), & \\text{if } (x, y) \\notin T\\end{cases}$ (3)\nbeing $(x', y')$ the point coordinates of the donor region corresponding to the target coordinates $(x, y)$. The splicing operation can be described by a tampering mask M, with the same size of $I_T$, where each pixel takes a binary value 0 or 1 depending on the pixel of $I_T$ being pristine or manipulated, respectively. Formally, the tampering mask M has pixel values equal to\n$M(x, y) = \\begin{cases} 1, & \\text{if } (x, y) \\in T \\newline 0, & \\text{if } (x, y) \\notin T\\end{cases}$ (4)"}, {"title": "C. SAR forensic detectors", "content": "The forensic community has developed manifold image splicing detectors during the years, specifically focused on classic 8-bit imagery like photographs or video frames [25], [26]. All the deployed detectors leverage the same assumption, that is, the acquisition device and processing operations leave peculiar traces on images, and these can be exploited to expose local forgeries [27], [26]. The acquisition pipeline of SAR amplitude images is completely different than digital photographs or video sequences. Nonetheless, it has been shown that different SAR products reasonably contain different traces relative to the processing executed for generating them [10]. In this vein, the authors of [10] recently proposed a forensic detector for localizing splicing areas on SAR amplitude images. This detector highlights local inconsistencies between the donor and target pixel areas, and proves superior than state-of-the-art detectors on these specific images. The detector training phase involves a siamese training of a denoising network architecture known as Denoising Convolutional Neural Network (DnCNN) [28]. The training process can be summarized by these three steps: Eventually, the trained DnCNN is able to extract a noise-like fingerprint with the same size of the input image. This fingerprint contains traces related to the processing pipeline of the acquired product, highlighting potential splicing attacks as traces' inconsistencies. Indeed, when analyzing pristine images, the fingerprint is self-consistent, whereas in case of spliced images it clearly highlights the edited regions. More formally, let us consider a generic manipulated amplitude image as input to the detector. For simplicity, we omit the subscript T from the manipulated images notation, taking for granted that all amplitude images indicated as I have been manipulated in a specific target region of pixels, identified by the tampering mask M. At first stage, the detector estimates a real-valued fingerprint map P, exposing local inconsistencies between pixels. Given P, the authors propose different methods to process P for estimating a binary mask M that identifies the forgery region."}, {"title": "III. PROBLEM FORMULATION", "content": "In this paper we tackle a counter-forensic task, aiming at hindering the capability of existing forensic detectors in spotting local forgeries applied to SAR amplitude images. We assume to have available an amplitude image I, which has been locally manipulated for inserting or hiding details, as shown in Section II-B. Moreover, we suppose to know which is the satellite that has been used to acquire the original data and which are the acquisition mode (e.g., strip, spot, scan) and processing applied (e.g., SLC, MLC, or GRD). Notice that this situation resembles a realistic scenario, as the potential attacker typically has knowledge of the SAR system used to acquire the data under manipulation. Our goal is deleting the manipulation artifacts from I such that forensic detectors cannot spot the manipulation traces anymore. In doing so, we do not want to deviate from neither the semantic content nor the visual quality of I. Moreover, we want to transfer to the attacked image the same properties of the pristine data acquired by the original SAR system, like the speckle-noise content and the traces left by the acquisition and processing operations. In other words, the final produced amplitude image must completely match the semantic characteristics of I (i.e., it actually presents a forgered area), but it has to be transparent to visual inspection (i.e., the visual quality is mantained), to SAR properties inspection, and to the forensic detector, that must estimate it being pristine in its entire area. We define the attacked amplitude image as I. We consider as reference detector that proposed in [10], previously described in Section II-C, because it is specially tailored to SAR imagery and represents the state-of-the-art solution for spotting local image manipulations in the SAR field. Since this detector leverages the fingerprint extraction step as necessary operation for localizing the tampering area, our goal turns into concealing the forensic traces from I such that its fingerprint resembles that of of pristine image."}, {"title": "IV. PROPOSED METHODOLOGY", "content": "To hide local manipulations from a SAR amplitude image I, we propose to recreate the effect of a SAR acquisition of the scene targets depicted in I. To do so, we exploit the original SAR system information which is available at attacker side. The output of the SAR acquisition is the amplitude image I, which still resembles I from the semantic content viewpoint (both in tampered with and original areas) but presents SAR-related properties that are equivalent to those of pristine data acquired with that satellite. Our method is composed of three main steps: On the one hand, by acquiring the scene targets depicted in I with the same acquisition system of the pristine data, we force the resulting amplitude image I to maintain similar SAR characteristics to the pristine data, like the amount of speckle noise and its spatial and frequency pattern. The final histogram matching completes the process by adjusting the pixel dynamics. On the other hand, the SAR acquisition"}, {"title": "A. Image Despeckling", "content": "Since the goal is reproducing the effect of a SAR acquisition of the scene targets depicted in the manipulated image, the first natural step of an attacker would be to remove the speckle noise introduced by the previous acquisition. This operation would enable to simulate the acquisition of noise-free targets, which is exactly what happens if we consider the SAR acquisition model presented before. To do so, we leverage well-known state-of-the-art SAR despeckling algorithms, namely the Fast Adaptive Non-local SAR Despeckling (FANS) [29] and the Non-Local framework for (In)(Pol)SAR denoising (NL-SAR) [30]. Both techniques reported excellent performances on SAR data and can work with the image amplitude information alone. These characteristics make them perfectly suited for our case study with respect to modern data-driven solutions [31] that would require a specific training and work with complex images exclusively. Following a similar notation to Section II-A2, the despeckled amplitude image is defined as $I_0$. Notice that the main disadvantage of image despeckling is the potential loss of high frequency details in the final despeckled image. As a matter of fact, the despeckling algorithm risks to remove also point scatterers that were originally depicted in the reflectivity scene. We show in our experiments that this despeckling step can be avoided, as the effects of the previous SAR acquisition are completely superseded by the new acquisition step that follows. To keep at most the frequency content of the scene depicted in the manipulated image I, we prove that it is a better choice to omit this step, directly going to the simulation of the SAR acquisition."}, {"title": "B. SAR Acquisition Simulation", "content": "This step is the main core of the proposed counter-forensic attack. It consists of recreating the acquisition of the scene targets depicted in the manipulated image by means of the same SAR system (or an estimate of it) that was used to acquire the original data. Referring to SAR background concepts reported in Section II-A, we split this step into two separate stages, namely speckle injection and SAR system simulation."}, {"title": "1) Speckle Injection", "content": "The injection of speckle noise is required to simulate the acquisition of a complex SAR image in which the targets, defined by the noise-free manipulated amplitude image $I_0$, are affected by speckle noise. To do so, we generate a complex speckle noise $S e^{j\\Phi_s}$ with the same size of $I_0$ and with the characteristics reported in Section II-A. In general, $S(x, y) \\sim R(\\sigma_s)$, being of the scale parameter of a Rayleigh distribution, whether $\\Phi_s(x, y) \\sim U[0, 2\\pi]$. The output image of this stage is obtained by element-wise multiplication between the input image $I_0$ and the speckle noise. This is defined as $\\overline{I}_{se}^{j\\Phi_s} = I_0 \\odot S e^{j\\Phi_s}$, being the element-wise product. Notice that the final image $\\overline{I}_{se}^{j\\Phi_s}$ is complex, i.e., it carries both amplitude and phase information."}, {"title": "2) SAR System Simulation", "content": "To recreate a SAR acquisition, the speckle-affected image $\\overline{I}_{se}^{j\\Phi_s}$ must be filtered through the same acquisition and processing system used to acquire the original data. This maps into the exploitation of the SAR system frequency response H described in Section II-A1. In this context, we consider four different realistic scenarios that the attacker can encounter: (i) H is fully known; (ii) the attacker disposes of the original complex image under attack; (iii) the attacker disposes of N complex images captured by the same satellite, different from the original image under attack; (iv) the attacker only disposes of the original amplitude image under attack. The last three scenarios require an estimation process for extracting information on the original system frequency response. As suggested in [19], we assume the SAR system frequency response can be approximated by a real central-symmetric nonnegative function. For simplicity, we describe the proposed estimation process for case (ii), detailing the differences with respect to cases (iii) and (iv) at the end of the derivations. To estimate H, we consider four consecutive steps:"}, {"title": "C. Histogram Matching", "content": "In the last phase of the proposed attack, it may happen that the resulting amplitude image IH presents a few differences with respect to the image I in terms of dynamic range and pixels' distribution. As a matter of fact, there may be little differences between the injected and the actual speckle noise distributions. Also, the estimation of the system frequency response may contain small errors. All these situations contribute to little mismatch between the distribution of attacked and non-attacked amplitude images, thus resulting in clear artifacts that may induce forensic investigators to expose the attacked ones. To counteract this effect, we match the pixels' histogram of IH with that of the manipulated amplitude image I. In doing so, the dynamics and the pixel distribution are adapted to the initial ones, hindering the traces of the global operation done to hide the forgery. We define the final amplitude image as I. This image still presents the forgered area, though, as we show in our experiments, the splicing area is invisible to the existing forensic detectors developed for image splicing localization."}, {"title": "V. EXPERIMENTAL SETUP", "content": "In this section, we describe the setup of our experimental campaign. First, we present the employed SAR image dataset; second, we provide details on the forgery creation process; third, we give information on the counter-forensic attack parameters; finally, we describe the forensic detector setup."}, {"title": "A. Pristine Dataset", "content": "We downloaded the data from ESA EO-CAT [32], which provides various SAR products acquired in different modes and missions. In particular, we selected the SAR Staring SpotLight (ST) Single Look Slant Range Complex (SSC) products from the TerraSAR-X ESA archive [20]; these products present a resolution of 0.25m and a 16-bit dynamic range. We purposely selected these products for three main reasons:"}, {"title": "B. Manipulated Dataset", "content": "To create realistic forgeries, we always considered the case in which the donor amplitude image $I_D$ and the target amplitude image $I_T$ come from the same product. This operation allows to produce realistic splicings where the difference in the dynamic range and semantic details is reasonably small, since both donor and target images belong to the original product. To run multiple experiments, we created automatic forgeries by randomly selecting donor and target regions of 128 \u00d7 128 pixels, as done in [10]. As done in [10], we simulated an attacker perspective by processing the donor amplitude images with post-processing operations which can make the tampering more plausible. In particular, recalling Section II-B, we applied four possible editings E() to the donor image: a Gaussian blur, an upscaling, a downscaling and a rotation. Each of the last three similarity transformations is proposed in two different versions: (i) a \"Near\" version, in which the similarity parameters limit the transformations to almost imperceptible changes in the edited images, like a few degree rotation; (ii) a \u201cFar\u201d version, in which the editing process becomes more noticeable. In any case, all the considered editing operations do not introduce important content variations or degradations in the image visual quality. We consider this last constraint being paramount for performing realistic investigations. Indeed, we could think to include strong image perturbations like heavy noise addition or blurring. Such editing operations would carry so many artifacts that the manipulation traces could be exposed by any SAR expert looking at the image. In this scenario, there would be no reason to perform counter-forensic attacks on the manipulated images, as the image content would be so altered that any state-of-the-art detector could spot the forgery."}, {"title": "C. Counter-forensic attack parameters", "content": "1) Image despeckling: The two despeckling algorithms considered, i.e., FANS and NL-SAR, are both unsupervised and required no fine-tuning. We set the number of looks to 1, considering our TerraSAR-X SLC samples. For the NL-SAR, we had to process each sample as non-overlapping patches of 128 \u00d7 128 pixels for computational reasons. The final despeckled image is obtained by reassembling all the patches together. FANS instead worked seamlessly on the full resolution images.\n2) SAR System Frequency Response: The 2D Gaussian kernel K used for smoothing the pristine image spectrum has $\\sigma = 100$ pixels and size 601 \u00d7 601 pixels. To fit the 2D Gaussian bell and the 2D Raised Cosine, we employed a nonlinear iterative least squares solver, whose parameters are defined in [33]."}, {"title": "D. Detector setup", "content": "To evaluate the strength of our counter-forensic attack, we employed two different versions of the forensic detectors proposed in [10], namely the SAR Adapted Extractor (SAE) and the Augmented SAR Adapted Extractor (ASAE), which are slightly different one with the other according to the specific training pipeline employed. Specifically, the SAE detector is trained as described in Section II-C, while the ASAE detector considers data augmentation in training phase, applying upscaling to the input images to enlarge the set of available SAR products (see [10] for more details). In our experiments, we used the detectors in the best possible conditions, i.e., we trained and tested them over a homogenous dataset, in which the same product was available both in training and testing stages. In doing so we guaranteed that, in absence of counter-forensic attacks, the detectors performed at the best of their possibilities. Indeed, we wanted to avoid the risk of introducing errors due to different data distributions in train and test stages. This methodology ensured that the unique factor which might cause a degradation in the performance is the proposed counter-forensic attack. To train and test the forensic detectors in the best possible conditions, we always showed in training phase all the possible semantic scenarios: for each of the four considered geographical areas (Rome, Dublin, Gaza and Italy mountains), we randomly selected 70% of data for training (further split in 60-40% for training and validation sets, respectively) and left the remaining 30% for testing. Notice that the training images were 100% pristine, i.e., the detectors have not been trained to spot local image forgeries. Contrarily, as done in [10], the images of the test set did always present local manipulations."}, {"title": "VI. RESULTS", "content": "At first, we aim at evaluating the ability of our proposed counter-forensic attack in producing high-quality attacked amplitude images. As previously stated, we must produce attacked images which report similar characteristics than original pristine ones, such that an expert in the SAR field would not be able to easily spot that some global post processing operations have been applied. To do so, we put aside for a moment the locally manipulated amplitude images, focusing only on pristine samples. For each pristine amplitude image I, we generate an attacked version of it, namely I, by following the methodology proposed in Section IV. Therefore, in this particular experiment, the input to the counter-forensic attack are the pristine amplitude images I and not their manipulated versions I. If the attacked versions of pristine samples show indistinguishable from the pristine ones, our attack can be employed to realistically modify SAR data samples that resemble original untouched ones."}, {"title": "Image quality metrics", "content": "As done in [12], we compare pristine and attacked samples by exploiting several similarity metrics\u00b2. We evaluate the visual quality of the attacked samples by computing metrics typical of the image full-reference quality assessment field, i.e., the Structural Similarity Index Measure (SSIM) [34], and the Multi-Scale Structural Similarity Index Measure (MS-SSIM) [35]. The higher the similarity measure between attacked and pristine samples, ideally approaching 1, the better the quality of the attack, in terms of producing pixel content that visually resembles original data. We also consider SAR compatibility metrics to evaluate our ability in reproducing speckle pattern in the attacked images. In particular, we rely on the Equivalent Number of Looks (ENL) [36], usually employed in the SAR despeckling field, to understand if the considered attacked samples are compatible with the original SAR data. The ENL is a statistical measure to quantify the level of speckle noise in SAR images. In particular, we compute the absolute relative difference of the ENL of attacked images with respect to their original pristine version. We define this metrics as $|\\Delta\\text{-ENL}|$. Our goal is achieving low values of $|\\Delta\\text{-ENL}|$, meaning for a realistic reproduction of speckle noise in the attacked samples."}, {"title": "Despeckling influence", "content": "We start evaluating the achieved similarity metrics according to presence or not of the despeckling step in our attack. To do so, we restrict our investigations to one of the four situations presented in Section IV-B2, i.e., the different levels of attacker knowledge on the SAR system frequency response H. In particular, we omit the case in which H is fully known, as we have no access to all the information describing the original SAR system used to capture the considered dataset. We consider the best case scenario, which reasonably consists in having available the original complex image $I_e^{j\\Phi}$ under attack. We consider three different estimation strategies of the SAR system frequency response, namely the Gaussian fitting, the Raised Cosine fitting and the direct estimation, leading to $H_G$, $H_R$ and $H_D$ respectively. As regards the speckle noise injection parameters, we show results for phase-only injected speckle, as this scenario achieves far better results than cases with speckle amplitude contributions\u00b3."}, {"title": "Effects of the SAR system knowledge level", "content": "We now evaluate how the quality of attacked images changes according to the attacker knowledge on the original SAR system frequency response (see Section IV-B2). As done before, we omit the best knowledge case (i.e., when H is fully known), but we consider four different scenarios in any case: (i) the original complex image $I_e^{j\\Phi}$ under attack is available; (ii) another complex image $I_{\\hat{e}}^{j\\Phi_{\\hat{e}}} \\neq I_e^{j\\Phi}$ captured by the same satellite is available (randomly selected from one different ST-SSC product); (iii) N complex images $\\{I_{\\hat{e}}^{j\\Phi_{\\hat{e}}}\\}_{1}^{N} \\neq I_e^{j\\Phi}$ captured by the same satellite are available; in our case, we consider N = 23, as we dispose of 24 ST-SSC products, thus we pick one different image per product; (iv) only the original amplitude image I under attack is available. The achieved results are depicted in Table III\u00b3. The three different estimation strategies (i.e., HG, HR and HD) confirm to achieve very similar results among themselves. If only the original amplitude image is available, the iterative least square solver did not converge in case of HG and HR. This is due to the strongly different frequency content of the amplitude images with respect to the Gaussian and Raised Cosine functions\u00b3."}, {"title": "Selected attack configuration", "content": "In light of the previous considerations, we omit the despeckling step and we simulate the re-acquisition by using the direct system estimation strategy with phase-only speckle injection in all the following experiments. This option allows to avoid the least squares fitting in the system frequency estimation step and to keep at bay the ENL-related artifacts on the attacked images. Moreover, to simplify the scenario, we consider having available the original complex image at attacker side, exploiting it to estimate the SAR system frequency response. As shown before, this option does not lead to limitations in the presented results."}, {"title": "B. Counter-forensic Attack Evaluation", "content": "We now evaluate the performance of the forensic detectors in presence of our proposed counter-forensic attack."}, {"title": "Tampering localization metrics", "content": "For each analyzed image, we evaluate the tampering localization performances by comparing the detector output fingeprint P and the groundtruth tampering mask M. In particular, we rely on the Area Under the Curve (AUC) of the Receiver Operating Characteristic (ROC) curve of the related binary classification problem. In absence of counter-forensic attacks, we expect the AUC of the ROC to approach 1, meaninig for high detector accuracy in spotting local manipulations. Our goal is to reduce the AUC, ideally achieving 0.5, which means the detector is not anymore able to distinguish between pristine and manipulated pixels. Indeed, we want the fingerprints of attacked manipulated images to resemble those of pristine data, i.e., to be overall homogeneous in the entire pixel area\u2074."}, {"title": "Detector results in absence of attack", "content": "To give an upper bound on the achievable detection performances, we first provide the results on the manipulated images not undergone to any counter-forensic attacks. The AUCs associated with all editing operations almost always achieve high scores, especially for the ASAE detector, which is known to be more accurate than the SAE [10]. Downscaling operations reveal challenging to expose, especially when the downscaling factor is small (i.e., \u201cDownscale Far", "Downscale Near\"), the AUC increases but still remains below the other editings. This behaviour might seem somehow unexpected, since one could think \u201cDownscale Far": "o reasonably contain more manipulation artifacts than \u201cDownscale Near"}, {"title": "Detector results in case of attack", "content": "Table V depicts the average detection results in case of testing manipulated amplitude images undergone the proposed counter-forensic attack. It is worth noticing an important performance degradation in all scenarios. The highest achieved AUC is 0.728,in contrast with the 0.996 achieved in absence of the attack. We can observe another interesting fact: the most sensitive detector to the attack is the ASAE, which is actually the best performing detector in standard situations. This implies that, if the forensic analyst is not aware of potential global attacks done to hide the manipulation area, it is quite probable that the selected detector will be the ASAE and that localization results in case of attack will be worse than those achieved by the SAE. Nonetheless, even in case of SAE detector, we report a strong performance degradation with respect to normal conditions. Apart from the \"Downscale Far\u201d editing which was already challenging to detect before the attack, all the editing operations undergo AUC degradation of more than 23% and 30% for SAE and ASAE detectors, respectively."}, {"title": "C. Realistic Attacks", "content": "In this section, we test the proposed methodology on particular cases which resemble challenging real-world attacks. Indeed, the previous analysis allows a large number of precisely controlled experiments, though squared forgery areas which have been automatically generated might be little realistic. We consider an additional dataset including SAR data known as Moving and Stationary Target Acquisition and Recognition (MSTAR), which contains public X-band complex SAR images of military tank targets at 1 foot resolution (~30cm) [37]. We create local manipulations by inserting target vehicles in SAR amplitude images selected from our TerraSAR-X testing dataset. Given that the average size of a military tank is at maximum 10\u00d74 meters in length and witdh, we consider donor pixel areas around 35 \u00d7 16 pixels. This size is not fixed as it depends on the specific target vehicle to insert. To create the attack, we follow the pipeline described in Section IV, including phase-only speckle noise injection and estimating the frequency response of the system directly from the available original complex image."}, {"title": "D. Why not simpler counter-forensic attacks?", "content": "In this section, we perform further experiments to validate the need of the proposed speckle injection step composing our counter-forensic pipeline. Specifically, we compare the proposed global processing operation based on speckle injection with more standard counter-forensic attacks that are usually employed to hinder forensic traces from digital images. We investigate if speckle injection is actually the best processing operation to conceal the manipulation traces. Therefore, instead of injecting a phase-only speckle noise into the manipulated amplitude images (see Section IV-B1), we pass the images to multiple different global operations alternative to speckle. After the global editing, we apply the same pipeline shown in Fig. 6: we pass each processed manipulated image through the estimated SAR end-to-end system, then we match the histogram with that of the input manipulated image. We consider nine editing operations, listed in Table VI. In particular, the \u201cUpDownScale\u201d and \u201cDownUpScale\" operations consist in the application of consecutive upscaling and downscaling (or viceversa) with one resizing factor and its opposite, such to match the initial image size at the end of the processing.\""}, {"title": "Quality of the attacked images", "content": "Regarding the visual quality from natural image processing perspective (i.e., looking at SSIM and MS-SSIM), all the attacked images present extremely high quality, with results always above 0.99. This is not valid for what concerns SAR compatibility: the |\u2206-ENL| assumes values similar to those achieved by speckle noise (see Table III) only in case of additive noises, while blurring or scaling operations strongly corrupt the speckle pattern of the attacked images (|\u2206-ENL| is above 5% with respect to 0.45% of speckle injection)3. In the next lines, we investigate the counter-forensic strength of additive noise global processing operations. We do not include blurring or scaling operations since they do not resemble realistic attacks."}, {"title": "Counter-forensic attack evaluation", "content": "We report the achieved detection results on the attacked images in Table VII. For simplicity, we only consider the ASAE detector, as it demonstrated the most sensitive to counter-forensic attacks (see Table V). All the alternative global operations report extremely high AUC values, meaning for absence of counter-forensic effect. The proposed speckle injection process demonstrates the best option to hide manipulation artifacts."}, {"title": "E. Results' Discussion", "content": "We believe the strength of the proposed approach lies in the exploitation of the complex nature of SAR images for hindering the manipulation traces. Indeed, the speckle injection step contributes in widening the frequency spectrum of the manipulated image and conceals the subtle editing traces searched by forensic detectors. Though it is true that noise addition operations like those tested in Section VI-D are enlarging the spectrum as well, the speckle injection step is adding a complex phase term which is paramount to recreate the effect of a SAR acquisition. All the other global operations do not consider processing complex images, as they act only on the magnitude component. The further filtering operation through the estimated end-to-end SAR system provides the correct frequency shaping to reproduce the same SAR characteristics of original pristine images. This step is also quite important for hiding local editing artifacts that would be noticeable at human inspection even after the speckle injection stage. To reproduce exactly the same pattern of the original SAR images, we have to apply the correct shaping filter corresponding to the SAR system used for pristine acquisitions\u00b3."}, {"title": "VII. CONCLUSIONS", "content": "In this paper, we prove that an experienced SAR practitioner can effectively conceal local manipulation traces within SAR amplitude images. By exploiting the complex nature of SAR data, our devised counter-forensic attack involves simulating a re-acquisition of the manipulated amplitude image by the same SAR system that was used to acquire its original, unaltered, complex version. Through our experimental campaign, we show how the attacker can obscure all signs of manipulation, thereby presenting the image as if it were legitimately acquired by the system. We believe our proposed methodology holds significant advantages for the SAR forensic community for three primary reasons: first, it allows to simulate worrying scenarios in which a malicious user aims at erasing the traces of local manipulations; second, it answers the needs for privacy preservation by hiding sensitive targets; finally, it assesses the robustness of existing forensic detectors in case of adversarial attacks. We evaluate the efficacy of the suggested counter-forensic method across a range of scenarios, analyzing different manipulation techniques. We experiment on data undergone to automatic and hand-made local manipulations, considering also the alarming scenario of military vehicles insertion. The results obtained demonstrate that our developed attack effectively eradicates any evidence of manipulation, even fooling sophisticated forensic detection systems. Moreover, the visual quality and the SAR properties of the attacked images are maintained, to the extent that even an expert SAR scientist would unlikely notice the difference with the original data."}]}