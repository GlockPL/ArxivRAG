{"title": "CAND: Cross-Domain Ambiguity Inference for Early Detecting Nuanced Illness Deterioration", "authors": ["Lo Pang-Yun Ting", "Zhen Tan", "Hong-Pei Chen", "Cheng-Te Li", "Po-Lin Chen", "Kun-Ta Chuang", "Huan Liu"], "abstract": "Early detection of patient deterioration is essential for timely treatment, with vital signs like heart rates being key health indicators. Existing methods tend to solely analyze vital sign waveforms, ignoring transition relationships of waveforms within each vital sign and the correlation strengths among various vital signs. Such studies often overlook nuanced illness deterioration, which is the early sign of worsening health but is difficult to detect. In this paper, we introduce CAND, a novel method that organizes the transition relationships and the correlations within and among vital signs as domain-specific and cross-domain knowledge. CAND jointly models these knowledge in a unified representation space, considerably enhancing the early detection of nuanced illness deterioration. In addition, CAND integrates a Bayesian inference method that utilizes augmented knowledge from domain-specific and cross-domain knowledge to address the ambiguities in correlation strengths. With this architecture, the correlation strengths can be effectively inferred to guide joint modeling and enhance representations of vital signs. This allows a more holistic and accurate interpretation of patient health. Our experiments on a real-world ICU dataset demonstrate that CAND significantly outperforms existing methods in both effectiveness and earliness in detecting nuanced illness deterioration. Moreover, we conduct a case study for the interpretable detection process to showcase the practicality of CAND.", "sections": [{"title": "1 INTRODUCTION", "content": "Background. In intensive care units (ICUs), real-time monitoring and early detection of illness deterioration are crucial because undetected deterioration can delay treatments and increase mortality [62]. This highlights the need for automated systems to detect patient deterioration in an early stage. Previous research [45, 49, 51, 69] stress the role of vital signs, such as heart rate, as critical indicators of inflammation and essential for monitoring hospitalized patients [4]. These vital signs are simple and cost-effective to obtain from patients [32], and they can be collected in real-time by non-invasive ways to reduce the risk of nosocomial infections [53]. Studies [30, 65] have found that illness deterioration is a continuous process with distinct stages. Illness severity scores [54] effectively represent the severity across various diseases. Increases in these scores represent the nuanced illness deterioration, indicating the gradual decline of patients' health conditions. The nuanced illness deterioration is usually not significant enough to cause alarms in monitoring systems. However, by detecting these subtle changes early, physicians are able to provide flexible medical interventions before the patient's condition becomes worse.\nExisting methods of vital sign analysis for patient deterioration detection can fall into two categories: discovering critical information in each vital sign and understanding correlations among multiple vital signs. (i) For the first category, shapelet-based models are widely applied to analyze vital sign time series to find out"}, {"title": "2 RELATED WORK", "content": "Early Detection of Patient Deterioration. Previous studies focus on two main categories: detecting severe events (like death, ICU admissions, or cardiopulmonary arrest) and early diagnosis of specific diseases. For severe events, most of the research utilizes Electronic Health Records (EHR). Li et al. [36] propose a multi-task model for early detecting death and ICU admissions. El-Rashidy et al. [14] design stacking ensemble classifiers for mortality prediction. Alshwaheen et al. [2] design a deep genetic algorithm for similar purposes. Hartvigsen et al. [25] propose the EARLIEST method to analyze time series data in EHR. Shamout et al. [52] develop a neural network to predict deterioration from various data. Zhao et al. [73] and Hyland et al. [29] extract shapelets from vital signs to predict ICU admissions and circulatory failure. For specific diseases, Ghalwash et al. extract shapelets from ECG and blood gene expression for early diagnosis of specific diseases [17], and they also introduce a shapelet-based early classification method to measure temporal uncertainty [18]. Huang et al. [28] develop a snippet policy network for early cardiovascular disease classification. However, these studies require higher costs to access data since they analyze various types of patients' data rather than just vital signs. Other methods [17, 18, 28, 73] analyze only ECG signals or vital signs but only focus on detecting specific diseases or severe events. Paganelli et al. [43] design a self-adaptive algorithm to build an early warning system for illness severity deterioration, but this work is limited to utilizing five specific vital signs. Therefore, there is a lack of a general method to early detect nuanced deterioration in various patients' conditions using low-cost vital sign data.\nKnowledge Graph Alignment. Fusing embeddings from different knowledge graphs (KGs) or structures through entity (node) alignments is crucial, with research emphasizing semantic matching and GNN-based models. Semantic models like MTransE [6], IPTransE [74], and BootEA [58] use TransE for relational learning, while others like JAPE [57], AttrE [60], and MultiKE [72] enhance entity semantics with diverse methods. GNN-based models, such as GCN-Align [64] and MuGNN [5], focus on parameter sharing and"}, {"title": "3 PRELIMINARY", "content": "In this section, we outline the key symbols and definitions. Generally, a knowledge graph (KG) is represented as \\(G = \\{(h, r, t)|h, t \\in E, r \\in R\\}\\), where \\(E\\) is the entity set, \\(R\\) is the relation set, and each triplet \\((h, r, t)\\) indicates that the head entity \\(h\\) is related to the tail entity \\(t\\) through the relationship \\(r\\). A scoring function \\(f(h, r, t)\\) is typically defined to assess the plausibility of a triplet being a fact, based on the representation vectors of \\(h\\), \\(t\\), and \\(r\\). Given its ability to represent diverse relationships with triplet structures, a KG is ideal for modeling the complex knowledge in patients' vital sign time series. This leads us to develop two specific KG-based knowledge structures in our CAND.\nDefinition 1. (Vital Sign): Let \\(X\\) represent a specific type of vital sign, such as heart rate. The historical dataset for vital sign \\(X\\) is denoted as \\(D_X = \\{T^X_i\\}_{i=1}^N\\), consisting of \\(N\\) time series data measured from different patients. Each time series \\(T^X_i\\) \\(\\in R^m\\) is a sequence of real-number readings measured from a patient's vital sign \\(X\\) over \\(m\\) timestamps.\nDefinition 2. (Concept): A concept is defined as a shapelet [69], representing a key health indicator identified as a subsequence within a patient's vital signs time series. For vital sign \\(X\\), we employ an existing method [20] for shapelet discovery to identify a set of concepts, denoted as \\(C_X = \\{c_1, c_2, ..., c_{|C_X|}\\}\\).\nDefinition 3. (Domain-Specific Knowledge Structure): Given a dataset \\(D_X\\), the domain-specific knowledge structure is defined as \\(G(X) = \\{(c_i, \\tau, c_j)|c_i, c_j \\in C_X, \\tau \\in T_X\\}\\), which captures all transition relationships within each time series belonging to \\(D_X\\). Here, \\(C_X\\) is a set of concepts, and \\(T_X\\) denotes a set of relations. Each relation \\(\\tau \\in T_X\\) specifies a time interval range between consecutive concepts occurring in time series belonging to \\(D_X\\). Consequently, each triplet \\((c_i, \\tau, c_j) \\in G(X)\\) signifies that concept \\(c_i\\) transitions to concept \\(c_j\\) over the actual time interval \\(\\tau\\)."}, {"title": "4 THE CAND FRAMEWORK", "content": "The architecture of CAND is illustrated in Figure 3. CAND comprises three main components to augment knowledge based on current knowledge structures (Sec.4.1) and infer strengths of correlations (Sec.4.2), which are then leveraged to guide joint modeling of domain KSs and the cross KS (Sec. 4.3)."}, {"title": "4.1 Multi-View Context Augmentation", "content": "In graph-based representation models, the contexts (or neighborhoods) of nodes are often crucial sources of information [23, 59, 63]. In our cross KS, stronger correlations between cross-domain concepts indicate closely related contexts with significant mutual influence. To identify key contexts, we employ a multi-view context augmentation inspired by [24, 66]. The designed augmentation captures specific contexts of the cross KS from different views, serving as indicators of strengths for correlations.\nFor each triplet \\((c, a, c')\\) in cross KS \\(G_{cross}\\), we explore contexts of cross-domain concepts \\((c, c')\\) (Sec. 4.1.1) and contexts of correlation \\(a\\) (Sec. 4.1.2). These contexts are formulated into contextual triplets to improve the modeling of the cross KS.\n4.1.1 Concept-View Contextual Triplet. From the concept view, we aim to explore the contexts of cross-domain concepts \\((c, c')\\). Instead of simply considering n-hop neighbors, we employ a guided exploration, inspired by node2vec [21], to focus on contexts most likely to be influenced by \\(c\\) and \\(c'\\) within their respective domain KSs. Assuming \\(c\\) belongs to \\(G_{cross}\\) and domain KS \\(G(X_1)\\), we demonstrate guided exploration for \\(c\\) in \\(G(X_1)\\). Considering an exploration starting at \\(c\\), proceeding through \\(w\\) to \\(x\\), the unnormalized probability of moving to the next concept \\(y\\) is defined as follows:\n\\[\\gamma_{x \\to y} = \\begin{cases}\n\\varphi \\cdot W_{x,y}, & \\text{if } d_{w,y} \\le 1 \\text{ or } y \\in G_{cross} \\\\\n\\frac{1}{\\varphi} \\cdot W_{x,y} , & \\text{if } d_{w,y} = 2 \\text{ and } x \\in G_{cross}, y \\notin G_{cross} \\\\\n0 & \\text{otherwise}\n\\end{cases}\\]\nwhere \\(W_{x, y}\\) is the probability of concept \\(y\\) occurred after \\(x\\) in the historical dataset \\(D_{X_1}\\). \\(d_{w,y}\\) denotes the shortest distance between \\(w\\) and \\(y\\) on \\(G(X_1)\\). Here, \\(\\varphi > 1\\) biases the exploration towards a depth-first search, prioritizing concepts that are away from \\(w\\) and do not belong to \\(G_{cross}\\) while avoiding revisits. The supplementary descriptions of the design of Eq. 1 are in Appendix C.2.\nFormally, the guided exploration distribution for \\(c\\) is defined as \\(D(\\gamma_{x}, c) = \\gamma_{x \\to y}/Z\\) with \\(Z\\) as a normalizing constant as in [21]. The guided exploration distribution for \\(c'\\) is defined in a similar manner. Let \\(\\psi^c_i\\) and \\(\\psi^{c'}_i\\) denote the sequences of explored concepts during the \\(i\\)-th exploration of \\(c\\) and \\(c'\\), respectively. Note that \\(|\\psi^c_i| = |\\psi^{c'}_i| = L\\), where \\(L\\) is a fixed exploration length. After \\(N\\) explorations, the concept-view contextual triplet is formulated as follows:\n\\[(c_{cont}, a, c'_{cont}) = (\\{\\psi^c_i\\}_{i=1}^N, a, \\{\\psi^{c'}_i\\}_{i=1}^N)\\]\nSubsequently, a metapath-aware aggregation is employed to construct the representation vectors of \\(c_{cont}\\) and \\(c'_{cont}\\), respectively. Here, a metapath refers to a sequence of relation types within a knowledge structure, defining a composite relationship among the relations involved in explorations. For \\(c_{cont}\\), we categorize all exploration sequences \\(\\{\\psi^c_i\\}\\) of \\(c\\) into different metapaths according to the types and order of relations encountered in \\(G(X_1)\\). Taking \\(\\phi\\) as a metapath, we aggregate the representation vectors of concepts within each exploration \\(\\psi_i\\) belonging to \\(\\phi\\) to develop the overall representation of \\(\\phi\\), which is formulated as follows:\n\\[h_{\\phi} = \\frac{1}{|\\Phi|} \\sum_{\\psi_i \\in \\Phi} \\sum_{e_j \\in \\psi_i} a_j e_j; a_j = \\frac{\\exp(p_{c \\to e_j}^{\\phi})}{\\sum_{e_k \\in \\psi_i} \\exp(p_{c \\to e_k}^{\\phi})}\\]\nwhere \\(e_j\\) represents a concept within the exploration \\(\\psi_i\\), with its initial representation vector \\(e_i \\in R^d\\) at current epoch \\(t\\), where \\(d\\) is the dimensionality. The weight \\(a_j\\) is determined by the \\(p_{c \\to e_j}^{\\phi}\\), which represents the probability of exploring from \\(c\\) to \\(e_j\\) via the guided exploration distribution \\(D(\\gamma_{x}, c)\\).\nLet \\(S_{meta}\\) be the set of all metapaths, the final representation vector for \\(c_{cont}\\) is then obtained as follows:\n\\[c_{cont} = \\sum_{\\phi \\in S_{meta}} h_{\\phi}\\]\nSimilarly, the representation vector for \\(c'_{cont}\\) is derived in the same manner. Following this, we can acquire the representation vectors for the concept-view contextual triplet \\((c_{cont}, a, c'_{cont})\\). The representation vector of \\(a\\) is derived from its current vector.\n4.1.2 Correlation-View Contextual Triplet. From the correlation view, we focus on exploring the contexts of correlation \\(a\\) within cross KS \\(G_{cross}\\), specifically for triplet \\((c, a, c')\\). These contexts, embodying the path information between \\((c, c')\\), are crucial for deepening our understanding of correlation \\(a\\), as they bridge the same pair of cross-domain concepts \\((c, c')\\). Assuming a raw path from \\(c\\) to \\(c'\\) in cross KG \\(G_{cross}\\) is a sequence of concepts and correlations: \\(c(e_0) \\xrightarrow{a_1} e_1 \\xrightarrow{a_2} e_2... \\xrightarrow{a_{n-1}} e_{n-1} \\xrightarrow{a_n} c'(e_n)\\). The corresponding correlation path \\(\\pi = \\{a_1, a_2, ..., a_n\\}\\) consists of all correlations in the raw path. Denote \\(\\Pi_{<L'}\\) as the set of all correlation paths from \\(c\\) to \\(c'\\) in \\(G_{cross}\\), with each correlation path \\(\\pi \\in \\Pi_{<L'}\\) no longer than \\(L'\\). The correlation-view contextual triplet is then formulated as follows:\n\\[(c, a_{cont}, c') = (c, \\Pi_{\\leq L'}, c')\\]"}, {"title": "4.2 Bayes-Based Inference for Correlation Strengths", "content": "In typical knowledge graphs (KGs), triplet plausibility indicates factual likelihood, which can be regarded as an indicator of correlation strengths. Drawing inspiration from previous works [10, 42, 47] that incorporate the Bayesian Personalized Ranking (BPR) process [46] into knowledge graphs (or knowledge bases), we utilize BPR to merge different plausibilities as implicit feedback to infer the strengths of correlations. We define the set of all cross-domain concepts in \\(G_{cross}\\) as \\(U \\subset C_{cross} \\times C_{cross}\\), and then formulate the BPR input based on the following definitions.\nDefinition 5. (Ambiguity Type): We consider each triplet \\((c, a, c') \\in G_{cross}\\), along with its contextual triplets, as embodying different ambiguity types: the origin view, the concept view, and the correlation view with correlation \\(a\\) in \\((c, c')\\). Therefore, the set of ambiguity types is defined as \\(\\Omega = \\bigcup_{a \\in Across} \\{a_{origin}, a_{concept}, a_{correlation}\\} \\), where each ambiguity type is denoted as \\(\\omega \\in \\Omega\\).\nDefinition 6. (Partial Rank): For each pair of cross-domain concepts \\((c, c') \\in U\\), if its plausibility with ambiguity type \\(\\omega_i \\in \\Omega\\) is higher than with \\(\\omega_j \\in \\Omega\\) surpasses a predefined threshold, we denote a partial rank as \\(\\omega_i \\succ_{(c,c')} \\omega_j\\). The set with all partial ranks for \\((c, c')\\) is depicted as \\(R(c,c') = \\{(\\omega_i, \\omega_j)| \\omega_i \\succ_{(c,c')} \\omega_j\\}\\).\nOur objective is to rank all ambiguity types for each cross-domain concept pair, learning latent factors to estimate correlation strengths. To achieve this, we aim to maximize the posterior probability \\(P(\\Theta|\\succ_{c,c'}) \\propto P(\\succ_{c,c'}|\\Theta)P(\\Theta)\\), where \\(\\succ_{c,c'}\\) is total ranking for \\((c, c')\\), and \\(\\Theta\\) denotes the parameter vectors of matrix factorization (MF). We use BPR to minimize the negative log-likelihood, derived as follows:\n\\[L_{infer} = -\\ln P(\\succ_{c,c'}|\\Theta)P(\\Theta)\\]\n\\[= - \\sum_{(c,c') \\in U} \\sum_{(\\omega_i, \\omega_j) \\in R(c,c')} - \\ln(\\sigma(\\nu_{c,c',\\omega_i} - \\nu_{c,c',\\omega_j})) + \\lambda_{\\Theta} ||\\Theta||^2,\\]\nwhere \\(\\sigma(\\cdot)\\) is the sigmoid function. \\(\\nu_{c,c',\\omega_i}\\) is expressed as \\(\\nu_{c,c',\\omega_i} := (v^{\\Theta}_{(c,c')})^T (v^{\\Theta}_{w_i})\\) based on MF, where \\(v^{\\Theta}_{(c,c')} \\in R^d\\) and \\(v^{\\Theta}_{w_i} \\in R^d\\) are latent factors of cross-domain concepts \\((c, c')\\) and ambiguity type \\(\\omega_i\\), respectively. \\(\\lambda_{\\Theta}\\) are regularization parameters.\nFinally, we derive latent factors \\(v^{\\Theta}_{(c,c')}\\) and \\(v^{\\Theta}_{w_i}\\) for each \\((c, c') \\in U\\) and \\(\\omega \\in \\Omega\\). The correlation strength of ambiguity type \\(\\omega\\) with \\((c, c')\\) is formulated as follows:\n\\[E_{c,c',\\omega} = \\frac{\\exp(v^\\Theta_{(c,c')}.v^{\\Theta}_{w_i})}{\\sum_{\\omega_j \\in \\Omega} \\exp(v^\\Theta_{(c,c')}.v^{\\Theta}_{w_j})}\\]"}, {"title": "4.3 Ambiguity-Aware Representation Learning", "content": "In this subsection, we model the cross KS with inferred correlation strengths (Eq. 9), which then refining representations and influencing domain KS training.\nCross-Domain Modeling. Typically, knowledge graph embedding (KGE) aims to score positive triplets higher than negative ones. Let \\(v\\) be a triplet on cross KS \\(G_{cross}\\) or a contextual triplet, we adopt the sigmoid loss as suggested by [56], commonly used in recent high-performing KGE models. The loss for \\(v\\) is defined as follows:\n\\[L(v) = -\\log \\sigma(f(v) - d(v)) - (-\\log \\sigma(d(v_i) - f(v))),\\]\nwhere \\(\\sigma(\\cdot)\\) is the sigmoid function, and \\(v_i\\) represents the \\(i^{th}\\) negative triplet. The function \\(d(\\cdot) = f(\\cdot)\\), a negation of the scoring function \\(f(\\cdot)\\), serves as the distance function for a triplet. Each negative sample with equal importance \\(1/n\\).\nTo reveal the impact of correlation strengths in the triplet loss, we introduce \\(\\gamma\\), as a dynamic margin for each triplet \\(v\\). This margin adjusts the minimum distance between negative and positive triplets. Assuming triplet \\(v\\) corresponds to ambiguity type \\(\\omega \\in \\Omega\\) (Def. 6) embodied in cross-domain concepts \\((c, c') \\in U\\), its correlation strength \\(E_{c,c',\\omega}\\) (Eq. 9) influences the dynamic margin \\(\\gamma_v\\). A lower \\(E_{c,c',\\omega}\\) diminishes \\(\\gamma_v\\), reducing the impact of the correlation on the representation vectors of \\(c\\) and \\(c'\\) from their domain KSs. The formulation of \\(\\gamma_v\\) is as follows:\n\\[\\gamma_v = \\gamma \\cdot \\exp((E_{c,c',\\omega} - 1) \\cdot \\xi),\\]\nwhere \\(\\gamma\\) is a fixed default margin, and \\(\\xi\\) is a scale factor.\nFinally, the objective function for modeling the cross KS is derived by aggregating losses across all triplets in \\(G_{cross}\\) and their contextual triplets. Defining \\(V\\) as the set of triplets in \\(G_{cross}\\) and \\(V_{cont}(v)\\) as the contextual triplet set for each \\(v \\in V\\), we formulate the cross-domain loss as follows:\n\\[L_{cross} = \\frac{1}{|V|} \\sum_{v \\in V} \\{L(v) + \\frac{\\lambda_c}{|V_{cont}(v)|} \\sum_{v' \\in V_{cont}(v)} L(v')\\} + L_{infer},\\]"}, {"title": "5 EXPERIMENTS", "content": "5.1 Dataset and Experimental Setup\n5.1.1 Dataset and Preprocessing. We collect a real-world dataset from National Cheng Kung University Hospital (NCKUH). The dataset includes minute-by-minute vital signs from ICU patients, collected using wearable devices. It also features Apache II scores [34], a measure of illness severity, recorded at specific timestamps. Details of the dataset are in Appendix B. We select 99 ICU patients from the dataset with the most vital signs records. Based on [19], we classify Apache II scores into eight levels: scores 0-4, 5-9, 10-14, 15-19, 20-24, 25-29, 30-34 and above 35, corresponding to different potential mortality rates. In our experiments, an increase in the Apache II level signifies nuanced deterioration, while a decrease"}, {"title": "6 CONCLUSION", "content": "We develop CAND, a framework that utilizes domain-specific and cross-domain knowledge of vital signs for early detecting nuanced illness deterioration. CAND employs multi-view context augmentation and Bayes-based inference to model correlations with ambiguous strengths, guiding joint modeling of multiple knowledge structures. Applied to the real ICU dataset, CAND effectively balances detection earliness and effectiveness, showing potential for human-level interpretability. Additionally, CAND leverages low-cost vital sign data, offering potential for remote healthcare development."}, {"title": "A NOTATIONS", "content": "In this section, we outline critical notations and their corresponding descriptions used throughout this paper to enhance clarity."}]}