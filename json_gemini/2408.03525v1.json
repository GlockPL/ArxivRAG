{"title": "Hierarchical learning control for autonomous robots inspired by central nervous system", "authors": ["Pei Zhang", "Zhaobo Hua", "Jinliang Ding"], "abstract": "Mammals can generate autonomous behaviors in various complex environments through the coordination and interaction of activities at different levels of their central nervous system. In this paper, we propose a novel hierarchical learning control framework by mimicking the hierarchical structure of the central nervous system along with their coordination and interaction behaviors. The framework combines the active and passive control systems to improve both the flexibility and reliability of the control system as well as to achieve more diverse autonomous behaviors of robots. Specifically, the framework has a backbone of independent neural network controllers at different levels and takes a three-level dual descending pathway structure, inspired from the functionality of the cerebral cortex, cerebellum, and spinal cord. We comprehensively validated the proposed approach through the simulation as well as the experiment of a hexapod robot in various complex environments, including obstacle crossing and rapid recovery after partial damage. This study reveals the principle that governs the autonomous behavior in the central nervous system and demonstrates the effectiveness of the hierarchical control approach with the salient features of the hierarchical learning control architecture and combination of active and passive control systems.", "sections": [{"title": "1 Results", "content": "We first present the analysis results of the mammalian cen-tral nervous system and provide an overview of our proposedframework based on the analysis results. Subsequently, ina bottom-up order, we evaluate the motion generation resultsof the CPG module within the framework, the skill learn-ing and regulation results of the mid-level controller, andthe multi-task learning and decision-making results of thehigh-level controller to demonstrate the effectiveness of dif-ferent core components of the framework and the excellentautonomous decision-making and motion control capabilitiesof the proposed control method. Finally, through the rapidmotion recovery effect of the robot under limb amputationconditions, as well as the rapid adaptation results of the robin various unknown environments, we demonstrate that theproposed control framework has less dependence on sensorinformation and strong adaptive ability."}, {"title": "1.1 Central nervous system inspired hierarchical learning control framework", "content": "Combined with related research, we analyze the mammaliancentral nervous system. As shown in Fig. 1a, the central ner-vous system of mammals (taking humans as an example)is a three-level control system from the cerebral cortex tothe spinal cord[1, 2]. The highest level includes most corticalregions, such as the prefrontal cortex, premotor area (P\u039c\u0391),supplementary motor area (SMA), posterior parietal cortex,and basal ganglia. They are responsible for processing vari-ous information and generating high-level decisions. First, theascending nerves of the spinal cord will project proprioceptionof the body to the primary somatosensory cortex (S1), and thevisual nerves will project visual information of the retina tothe visual cortex. Areas 5 and 7 of the posterior parietal cortexprocess proprioception from S1 and visual information fromthe visual cortex, respectively, and generate abstract percep-tual information. Subsequently, the prefrontal cortex decideswhat action to take according to the perceptual information,and then the basal ganglia enhances these motor intentionsthrough the internal direct pathway while inhibiting inappro-priate motor programs through the indirect pathway [24, 25].This information mainly converges to the SMA of the cortexthrough the thalamus. Then, the SMA and PMA jointly carryout motor planning and control distal and postural muscles.The control information travels down the spinal cord throughtwo main pathways[2, 26, 27]. On the one hand, through theventromedial pathway, the high-level information is processedby the mid-level CNS composed of the cerebellum and pri-mary motor cortex (M1) and transmitted to the brain stemand spinal cord at the lowest level to control the coordi-nated movement of limbs. In the above process, proprioceptionand decision-making information are projected from the pon-tine nucleus to the lateral cerebellum and then back to M1through the thalamic ventral lateral nucleus (VLC) to gener-ate finer motor signals and transmit them to the brainstem.Then, the postural muscles are controlled by spinal tracts suchas the reticulospinal tract of the ventromedial column of thespinal cord. On the other hand, signals from SMA and PMAdirectly control the distal muscles through the corticospinaltract of the lateral column of the spinal cord. These affer-ent feedbacks will regulate CPGs neural circuits in the spinalcord, generating complex rhythmic signals to control the for-mation of autonomous movement of muscles. CPGs in thespinal cord have two levels of organization, in which the half-center rhythm generator layer (RG layer) is responsible forgenerating motor rhythms. The pattern formation layer (PFlayer) is responsible for determining the exact form of muscleactivation signals, mobilizing motoneurons to control musclesthrough spinal nerves[28].\nAccording to the above hierarchical structure and func-tional division of the central nervous system, we design thehierarchical learning control framework of Fig. 1b. The frame-work contains three levels of controllers from high to low.The high-level controller, which simulates the cortex andbasal ganglia operation principle, is responsible for process-ing the proprioception and visual information provided bythe sensors and making active and rapid decisions. Its internal convolutional neural network and somatosensory neuralnetwork process the depth image and proprioception, respec-tively, to analyze the environmental features, and speculatethe next movement direction. The subsequent neural networkprocesses such perceptual signals and provides high-level deci-sions. These decision vectors are divided into skill vectors andmorphological parameters. The length of skill vectors deter-mines the frequency of movement and simulates the regulationof basal ganglia on voluntary movement. They descend tothe bottom CPG module through two control loops. The skillvectors are sent to the mid-level controller through the ventro-medial loop. Inside the mid-level controller, the internal neuralnetwork combines the skills and proprioception to calculatethe differential control signals. These signals are then sent tothe CPG module, which generates various coordinated motionpatterns. The morphological parameters are directly transmit-ted to the CPG module through the lateral loop, thus directlychanging the shape of the limb (such as width and height).The CPG module comprises an oscillator and a desired posesolver, which simulate the functions of the RG and PF layers.The oscillator generates varying amplitude and phase signals,and the desired pose solver maps the amplitude and phaseinformation into Cartesian space. The desired angle signals ofthe motors are calculated by inverse kinematics to control theposition of the motors."}, {"title": "1.2 Results of the CPG module's motion generation", "content": "The purple box in Fig. 1b shows the structure of the proposedCPG module. We use the amplitude-phase oscillator to sim-ulate the RG layer and the desired pose solver to simulatethe PF layer, and the high-level and mid-level controllers canregulate them directly and indirectly.\nThe oscillator consists of six elements acting on the robot'ssix legs respectively. We refer to the stable gait mode ofinsects[31] (Fig. 2a,b) and design the independent tripod gaitphase \u03b1, which is only affected by the maximum oscillationfrequency $w_m$, as the fixed component of the mixed phase \u03c6.The adjustable phase \u03b8 provides the other component of \u03c6.This mixed phase enhances the autonomy of the CPG moduleand retains flexibility. Even if the higher control informationis missing, the independent phase component can ensure theCPG module produces a stable forward or backward gait (Fig.2c). In this mode, the oscillator can generate a regular ampli-tude signal r, tripod gait phase \u03b1, and adjustable phase \u03b8(Fig. 2e). Amplitude r and adjustable phase \u03b8 can be adjustedby \u03bc, \u03c9 generated by the mid-level controller based on sen-sory feedback, thus making the CPG module generate morecomplex gait (the range of \u03bcw in the figure is mapped to[-1,1]). Compared with the single-phase mode in refs [20\u201322], the introduction of the independent phase enables theoscillator to generate a stable phase signal when the higher"}, {"title": "1.3 Results of the mid-level controller's skill learning and control", "content": "The mid-level controller is a reinforcement learning policycomposed of neural networks, responsible for the robot activeskill regulation and gait control. It receives proprioceptionand skill vectors from the high-level controller. Then, it gen-erates various differential parameters \u03bc,\u03c9 for the oscillator,thus adjusting the CPG module to generate gait signals ofdifferent modes. External feedback $||z||$ is proportional to themaximum internal frequency $w_m$, which can adjust the robot'sspeed. Combining the unsupervised reinforcement learningalgorithm[32] and CPG module, we propose a skill pre-trainingmethod to learn the mid-level policy in simulation to finddiversified motor skills (Fig. 3a). The CPG module can uselow-dimensional parametric action space to generate high-dimensional joint control signals so that unsupervised learningcan discover useful skills in robot systems with high degrees offreedom. (The learning process is reserved for the descriptionof the Methods).\nFig. 3b shows the movement trajectories of the robotwithin 30 seconds of the XOY plane under the influence ofdifferent skills. To test the control effect of the mid-level"}, {"title": "1.4 Results of the high-level controller's multi-task learning and decision", "content": "The high-level controller is also a reinforcement learning policycomposed of neural networks, which is responsible for process-ing the robot's proprioception and environmental information,respectively, and then giving the appropriate high-level deci-sion $a_h = [dmp, z]$ to actively command the lower levels toproduce the appropriate movement pattern to deal with obsta-cles. $d_{mp}$ directly changes the morphological parameters ofthe CPG module through the lateral loop. At the same time, zcontrols the mid-level controller to change the internal rhythmof the oscillator through the ventromedial loop. It is worthnoting that $||z||$ determines the maximum gait frequency $w_m$of the robot, and this information is also transmitted directlyfrom the lateral loop to the CPG module, which reflects the"}, {"title": "1.5 Results of rapid recovery of movement in case of limb damage", "content": "Animals exhibit rapid motor recovery after injury through var-ious compensatory behaviors[33]. In the context of the bionichierarchical structure, our novel method has the reliability ofpassive control systems, enables the robot to swiftly relearnits high-level controller in the event of limb damage, therebycoordinating different levels to restore its motion ability. Thesemi-autonomous CPG module further diminishes the control system's reliance on sensor information, enhancing itsrobustness and resilience.\nTo simulate the effect of limb damage, we randomly dis-able the control and feedback signals of a leg of the hexapodrobot. Fig. 5a demonstrates the robot's adaptability in cross-ing a gap (difficulty 0.6) when the robot's front, middle, andhind legs are broken, respectively. Regardless of which leg fails,the controller effectively guides the robot to adapt and uti-lize the remaining healthy legs to cross the gap and maintaina stable posture during crawling. Fig. 5b further illustratesthe gait changes of the robot in this task. After the failureof the middle leg, the other five legs of the robot adjust theirgait and redistribute their workload to complete the obstaclecrossing. Overall, the robot's gait frequency decreases, and the"}, {"title": "1.6 Results of unknown environment adaption", "content": "After entering the unknown environment, animals can recom-bine the learned knowledge and solve new tasks instead oflearning from scratch. The high-level active control system ofthe proposed method also has this advantage. As shown inFig. 6a, the hierarchical controller trained in the simulationenvironment is directly deployed to the robot system withoutmodification, and its adaptability is tested in various unknowntorrains (see Supplementary Video S5 for relevant videos). Therobot can move independently on the outdoor dirt ground andcross the stone path to the opposite side through the highlevel controller's autonomous inference and decision-makingability. It can climb the stone bridge steeper than the learnedslope task. It can adjust its shape to drill into an irregu-larly shaped cave and quickly climb the curb. Moreover, itcan navigate autonomously in multi-objective combined ter-rain without being affected by limb fracture (SupplementarySection 10 introduces the composition of the combined terrainand further analyzes the motion effect of the robot).\nFig. 6b shows the change of morphological parametersadjusted by the high-level controller over time while climb-ing the curb. After seeing the stone curb, the robot decidedto reduce the height and increase the width to ensure stabil-ity during climbing. At the same time, increase gc so that thelegs can be lifted higher to climb the stone platform. Afterclimbing the stone platform, the maximum frequency $w_m$decreases, maintaining low sports activity to save energy con-sumption. Fig. 6c shows the change of skill vector z generatedby the high-level controller with the number of decision stepsin this process. Under the effect of the hierarchical structureof the proposed method, the high-level controller will samplereusable skills from the skill space according to the environ-mental information at different times and combine them intocontinuous signals to guide the lower-level controllers to gen-erate appropriate gait and trajectory to deal with the newenvironment."}, {"title": "2 Discussion", "content": "We propose a general hierarchical learning control frameworkbased on the structure and function of the central nervous sys-tem, which theoretically integrates active and passive controlsystems, and demonstrates in practice how to use hierarchi-cal semi-active control systems to enhance the autonomousmovement ability of robots. This framework provide new ideasand methods for the design and application of future robotcontrol systems. This framework refers to the structure andmechanisms of the mammalian central nervous system, includ-ing three interdependent hierarchical controllers, which canlearn various motor skills and enable robots to use sensory"}, {"title": "3 Methods", "content": "This section describes in detail the composition and learning meth-ods of each part of the proposed hierarchical learning controlframework and the application process for the hexapod robot (seeSupplementary Section 1 for details of robot platform and physi-cal simulation). The CPG module includes the oscillator and thedesired pose solver. We introduce the differential equations of theoscillator and the internal stable phase embedding method, thenshow the desired pose solver's signal adjustment process and therobot motor's control method. Then, we give a detailed descriptionof the pre-training method of the mid-level controller. Using thelearned middle controller, we show how to get a high-level controllerwith autonomous decision-making ability through the two-stagelearning process."}, {"title": "3.1 Half-center rhythm generator layer", "content": "To generate the basic motion rhythm signal, we use the Hopfoscillation differential equations[20, 49] to implement the RG layerof CPGs. The following first-order differential equations give thedynamic system:\n$r_i = v_i \\\\v = (\\frac{\\alpha^2}{4} (f(\\mu_i) - r_i)) \\\\ \\dot{\\theta_i} = f(w_i) \\\\ a_i = w_m + \\sum_j \\mu_{ij} sin(a_j - a_i - \\Psi_{ij})$\n(1)\nwhere $r_i$ is the amplitude of the oscillator, $v_i$ is the differential ofamplitude, $\\theta_i$ is the adjustable phase, $a_i$ is the tripod gait phase,$\\alpha$ is a positive constant representing the convergence factor, $\\mu_i$ and$w_i$ are amplitude and phase adjustment factors, $w_m$ is the maxi-mum oscillation frequency. The oscillator finally produces a mixedphase $\\phi_i = (a_i + \\theta_i)$ (i = 1,2,..., 6 is the serial number of eachleg). The coupling weight and bias between oscillation elements are$\\mu_{ij}$ and $\\Psi_{ij}$. They form an additive coupling term to generate anindependent tripod gait for the robot, where $\\mu_{ij} = 1$, and the biasmatrix is shown in the following formula\n$\\Psi_{6*6} = 2\\pi$$\\begin{bmatrix}0 & 0.5 & 0 & 0.5 & 0 & 0.5 \\\\-0.5 & 0 & -0.5 & 0 & -0.5 & 0\\\\0 & 0.5 & 0 & 0.5 & 0 & 0.5 \\\\-0.5 & 0 & -0.5 & 0 & -0.5 & 0\\\\0 & 0.5 & 0 & 0.5 & 0 & 0.5 \\\\-0.5 & 0 & -0.5 & 0 & -0.5 & 0\\end{bmatrix}$\n(2)\nDue to the effect of the coupling term, the left front leg (LF),the left hind leg (LH) and the right middle leg (RM) of the robotare a group. Their a is the same, while the other three legs areanother group, and their a lags $ \\pi $ rads. This setting makes the sixlegs form a tripod gait. On this basis, the mid-level controller can"}, {"title": "3.2 Pattern formation layer", "content": "To reshape the rhythm signal, we use the desired pose solver torealize the PF layer function of CPGs. After the oscillator generates$r_i$, $\\phi_i$, we calculate the desired pose of the end of each leg andthen obtain the position under Cartesian Coordinates of the endof the leg, then convert it into the desired motor angles throughthe inverse kinematics, to generate the control signal of the motors.The end position of each leg is calculated as follows:\n$P_{xi} = -l(r_i - 1) cos(\\phi_i)\\\\P_{yi} = Lw_y\\\\P_{zi} = \\begin{cases}-h + g_c sin(\\phi_i), & \\text{if } sin(\\phi_i) > 0\\\\-h + g_p sin(\\phi_i), & \\text{otherwise}\\end{cases}$\n(4)\nwhere i is the mixed phase, and $\\{P_{xi}, P_{yi}, P_{zi}\\}$ is the position ofthe end of leg in the leg's local Cartesian Coordinates. l is the steplength, L = $l_1 + l_2$, $l_1, l_2, l_3$ are the lengths of the three linksof the robot coxa, femur and tibia, $w_y$ is the width adjustmentvariable, h is the height of the robot, $g_c$ is the maximum groundclearance in the swing process, and $g_p$ is the maximum ground pen-etration in the support process. These parameters constitute theCPG morphological parameter set $m_p = \\{l, h, g_p, g_c, w_y\\}$ (Fig1.bshows the relationship between the above parameters and the gait).The high-level controller can directly adjust the shape of the robotby providing the deviation value $dm_p = \\{\\delta l, \\delta h, \\delta g_p, \\delta g_c, \\delta w_y\\} \\in[-1, 1]$. The adjustment process is as follows:\n$l \\leftarrow l + g(\\delta l)\\\\h \\leftarrow h + g(\\delta h)\\\\g_p \\leftarrow g_p + g(\\delta g_p)\\\\g_c \\leftarrow g_c + g(\\delta g_c)\\\\w_y \\leftarrow w_y + g(\\delta w_y)$\n(5)\nwhere $g(x) = 0.02(x_{max} - x_{min}) dx$ maps the deviation to therange of specified parameters, which is given in Table.1. Whenl < 0, the foot trajectory rotates clockwise, and the robot movesbackward. On the contrary, when l > 0, the robot moves forward."}, {"title": "3.3 Skill learning of the mid-level controller", "content": "The mid-level reinforcement learning control policy can combinewith the CPG module to form many coordinated motor skills. Toachieve this, we use the parameterized neural network as the mid-level policy, and output a = [\u03bc,\u03c9", "32": "and the CPG module, we propose a new pre-trainingmethod, which can enable the mid-level policy to explore motor"}]}