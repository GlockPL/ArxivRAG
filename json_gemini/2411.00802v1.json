{"title": "An Improved Chicken Swarm Optimization Algorithm for Handwritten Document Image Enhancement", "authors": ["Mugisha Stanley", "Janet Lynn Tar Gutu", "P. Nagabhushan"], "abstract": "Chicken swarm optimization is a new meta-heuristic algorithm which mimics the foraging hierarchical behavior of chicken. In this paper, we describe the preprocessing of hand-written document by contrast enhancement while preserving detail with an improved chicken swarm optimization algorithm. The results of the algorithm are compared with other existing meta-heuristic algorithms like Cuckoo Search(CS), Firefly Algorithm(FA) and Artificial Bee Colony(ABC). The proposed algorithm considerably outperforms all the above by giving good results", "sections": [{"title": "I. INTRODUCTION", "content": "Hand written text preprocessing is a major step towards recognition of hand written text for any Optical Character Recognition (OCR)System. The quality of hand written document is degraded with time as the document ages and is affected by noise from the device such as a camera or scanner used to capture the document. Therefore recognition of the text may not be accurate by any good recognition system. The aim of preproccessing is to reduce the noise and improve accuracy of the recognition System and contrast enhancement is one of the steps of preprocessing.\n\nA metaheuristic is a high level procedure designed to find an optimally good solution to an optimization problem with insufficient information or limited computation resources [1]. Many meta-heuristic algortihms which include Cuckoo Search(CS) [2], Ant Colony Optimization (ACO) [3], Firefly Algorithm (FF) [4], Genetic Algorithms (GA) [5] and many others have been proposed for Image enhancement. In this paper, we propose an algorithm for image enhancement of hand written text document images using an improved chicken swarm optimization algorithm.\n\nChicken Swarm Optimization (CSO) is a stochastic optimization algorithm proposed by mimicking the hierarchical foraging behavior of chicken in a swarm[6].\n\nOur contributions are as follows:\n\n1) We propose the application of the Improved Chicken Swarm Optimization in enhancement of text document Images using bi-criteria contrast enhancement which gives the user choice to adjust the contrast level while preserving detail.\n\nThe rest of this paper is organised as follows:\nsection 2 describes image contrast enhancement, section 3 discusses the details of the chicken swarm optimization algorithm, the proposed algorithm is presented in section 4,experimentation and discussion of results are presented in section 5, finally the conclusion in section 6."}, {"title": "II. IMAGE ENHANCEMENT", "content": "Image enhancement is described as the process of improving the visual appearance of images and make it suitable for a specific task through reduction of noise. In the spatial domain, the pixel values are controlled to attain preferred enhancement [7]. This is defined as a mapping function\n\n$g(m, n) = T[f(m, n)]$\n\nwhere g is the enhanced Image, f is the input image and T is a function applied on f.\n\nIn the frequency domain, Enhancement is achieved through the following procedures:[7]\n\n1) Compute F(u, v), the Discrete Fourier Transform of the image to be enhanced,\n2) multiply it by a filter function \u0397(u, v) and\n3) Compute the inverse Discrete Fourier Transform to produce the enhanced image\n\nIn this paper, image enhancement in the Spatial domain was considered."}, {"title": "A. Contrast enhancement using Histogram Based techniques", "content": "Given a gray scale digital Image of size Z = M * N pixels, the number of possible gray levels is L = 256. The histogram of the image h[n] can be expressed as given in [14]\n\n$h[n] = {hi \u2208 [0, Z]|i = 0, ..., L \u2013 1}$"}, {"title": "1) HISTOGRAM MODIFICATION", "content": "However, HE suffers from large backward differences values of T[n].This can be overcome by modifying the input histogram without compromising its contrast enhancement potential. The modified histogram can then be accumulated to map input pixel intensity values to output pixels intensity values [9]. The modified histogram can be seen as a solution of a bi-criteria optimization problem where the goal is to find a modified histogram h which is closer to a uniformly distributed histogram u but also minimize the residual difference h \u2013 hi where hi is the input histogram. The modified histogram would then be used to obtain the mapping function from eq.(4). This optimization problem can be modelled a weigthed sum of 2 objectives as shown in equation (5) below\n\n$min||h - h_i|| + ||h \u2013 u||$\n\nwhere u \u2208 R^{256*1} and \u2208 [0, \u221e) is a problem parameter . if X = 0 the Histogram obtained corresponds to the traditional HE and as A tends to\u221e, it converges to the original image. Thus through varying A different levels of contrast can be achieved."}, {"title": "2) Adjustable Histogram Equalization", "content": "Through use of the sum of the Euclidean norm, we can obtain the analytical solution to equation(5) as follows:\n\n$h = argmin_h||h \u2013 h_i||^2 + \\lambda||h \u2013 u||^2$\n\nThis gives a quadratic optimization problem\n\n$h = argmin_h[(h \u2013 h_i)^T (h \u2013 h_i) + (h - u)^T (h - u)]$"}, {"title": "3) Histogram Smoothing", "content": "The Adjustable histogram equalization procedure, as illustrated in the last section, attempts to match the original histogram to a uniform distribution and spikes occur mostly in homogeneous regions in the image. The spikes can be removed by adding a smoothness constraint to the objective and the backward difference can be used to measure the smoothness. The resultant smoothed histogram removes the gaps between intensities by matching the original histogram to a smooth distribution instead of a uniform distribution.[10] The difference matrix D \u2208 R^{256*256} is bi-diagonal with the additional term for smoothness, the optimal trade-off is obtained by\n\n$min||h \u2013 h_i||^2 + \\lambda||h \u2013 u||^2 + \\gamma||Dh||^2$\n\nwhose solution is a three-criterion problem\n\n$h = ((1 + \\lambda)I + \\gamma D^T D)^{-1}(h_i + \\lambda u)$"}, {"title": "III. THE CHICKEN SWARM OPTIMIZATION ALGORITHM", "content": "The the chicken swarm optimization algorithm(CSO) is a metaheuristic algorithm which mimicks the hierarchical foraging behavior of chicken [6]."}, {"title": "A. Background", "content": "Chickens are domestic birds which live together in flocks. Their flocking habit is hierarchical in order, with each flock consisting of a dominant rooster, a number of hens and a number of chicks at the lowest level. Their exists more dominant hens which are close to the rooster and some submissive ones that stand near the chicks.A group is temporarily is disturbed when a new member enters and may disorganise the order. Stronger individuals have dominance over food access though a rooster may call members of a group it leads to eat first when food is found. This behaviour also exists in hens when they raise their chicks. This hierarchy plays an important role when it comes to foraging. There is competition for food between different chickens. But the chicks search for food around their mother. Each chick cooperates with each other[6]."}, {"title": "B. General Behaviour of Chicken", "content": "1) A chicken swarm consists of many groups and each group is led by a rooster, and comprises of a number of hens and chicks.\n2) Division of chicken swarm into groups and selection of the role played by each individual in a group depends on the fitness values. Chickens with best fitness values are chosen as roosters and they lead a group, and the"}, {"title": "C. Movement of the Chicken", "content": "Roosters are the dominant individuals in a group with the best fitness values, and therefore easily find food in a wider space. The position of the rooster is updated as follows:\n\n$x_{i,j}^{t+1} = x_{i,j}^t + Randn(0, \\sigma^2) * x_{i,j}^t$\n\nwhere $x_{i,j}^{t+1}, x_{i,j}^t,x_{i,j}$ are the position of $j^{th}$ dimension of of the chicken i at a time t+1 and t respectively. Randn(0, \u03c3\u00b2) is a Gaussian distribution with mean 0 and standard deviation \u03c32 defined as shown in eq.(12) below\n\n$\\sigma^2 =\n\\begin{cases}\nexp(\\frac{f_i - f_k}{|f_i| + e}), & \\text{if } f_i \\leq f_k \\\\\n1, & \\text{otherwise}\n\\end{cases}$\n\nwhere k is the index of the rooster k \u2208 [1, N] and k \u2260 1 ,randomly selected from a group of roosters, e, is a number which is small enough to avoid division by 0, f is the fitness value of the corresponding x.\n\nThe position of Hens is updated as follows:\n\n$x_{i,j}^{t+1} = x_{i,j}^t +S1*Rand(x_{r1,j}^t-x_{i,j}^t)+S2*Rand*(x_{r2,j}^t-x_{i,j}^t)$\n\n$S1 = exp(\\frac{f_i - f_{r1}}{|f_i| + e})$\n\n$S2 = exp((f_i - f_{i}))$"}, {"title": "D. Improving Chicken Swarm Optimization", "content": "Results from experiments conducted reveal that the original CSO can easily fall into local optimum and converges prematurely for high dimensional problems[6]. To end this, an improved chicken swarm optimization was proposed by making the following observations and changes. According to eq (17), Chicks can only learn from their mothers but not the roosters. Thus, The chicks will easily fall into local optimum along with their mothers. To avoid this, the Chicks have to learn from both their mothers and the roosters in a group. Therefore the position information of the chicks is updated according to the positions of their own mother and rooster in the group using eq. (17) which is a modification for eq.(16) [8].\n\n$x_{i,j}^{t+1}= s*x_{i,j}^t + FL * (x_{m,j}^t-x_{i,j}^t) + F * (x_{r,j}^t - x_{i,j}^t)$\n\nwhere s is the self-learning coefficient for the chicks, mis the position of the ith chick's mother, r is the position of the rooster. F is a learning factor, indicating that the chicks would also follow the rooster in search for food. [8]."}, {"title": "E. The Improved Chicken Swarm Optimization Algorithm", "content": "the improved algorithm is as follows\n1) Initialize a population of N chickens and define the related parameters such as the RH,HN,CN, MN,update frequency of the chicken swarm G,maximum number of generations, etc.\n2) initialize the lower bound lu and upper bound up using the gray levels of the image,\n3) Generate a population x = (x1, x2, ...XN) of N chickens with random solutions.\n4) Evaluate the fitness(xi) and find the best solution Xbest of the chicken swarm.\n5) for t=1:itermax\n6) if(t%G == 0) Sort the chickens' fitness values and categorise the chicken swarm into several subpopulations (Roosters, Hens and Chicks) and determine the relationship between the chicks and their mother hens in a group.\n7) end if\n8) For every chicken in the swarm,update their positions depending on their category, for roosters use eq(11) and evaluate their fitness, for hens eq(13) and evaluate their fitness, for chicks use eq(17), and and evaluate their fitness.\n9) Update the personal best position and the global optimal position Xbest.\n10) end for\n11) output the optimum value Xbest"}, {"title": "IV. THE PROPOSED ALGORITHM", "content": ""}, {"title": "A. Fitness Function", "content": "Image Contrast Enhancement is posed as an image histogram optimization problem where the goal to find a histogram that minimizes a cost function given in equation (9) whose solution is a three-criterion problem given by eq(10) as described by Arici in [9]."}, {"title": "B. Enhancement Algorithm", "content": "1) Input image a gray scale image and extract the image matrix,\n2) Obtain the histogram, h[n], for the image matrix.\n3) Set the parameters, \u5165 amount of contrast, and the amount of detail to be retained \u03b3,\n4) Get a Difference matrix, D, with backward-difference of histogram, Required for histogram smoothing.\n5) Apply the Improved Chicken Swarm Optimization algorithm to Obtain the optimised histogram, with parameters Maxmimal generations (iterations)Itermax, Population size N, Dimension D, G, The population size of roosters RN, The population size of hens HN,The population size of Chicks CN, The Population size of mother hens MN, input histogram h[n], \u03bb, \u03b3 and the difference matrix, D.\n6) Obtain the normalised histogram, p[n] from the optimised histogram using the expression below.\np[n] = h[n]/Number Of Pixels;\n7) The Approximate Cumulative Distribution Function (CDF), c[n], is obtained from p[n].\n8) Map back the image to spatial domain using a mapping function of the modified equation(4)\n\n$T[n] = (\\lambda + 1)255 * \\Sigma_{j=0}^{n-1} (p[j] +0.5)$\n\n9) Then the required performance metrics are calculated."}, {"title": "C. Parameter tuning and Analysis", "content": "During the experimentation the following were considered:\n1) It is beneficial to keep more Hens roosters thus for any given population RN < HN, All hens lay eggs, but they do not all hatch simultaneously, so in a swarm HN > MN, Naturally, each mother hen can raise more than one chick, but it was assumed that the population of adult chickens would be greater than that of the chicks. Therefore CN < MN [6].\n2) The number of times the hierarchical statuses of the chicken updates(G) greatly affects the convergence rate of the ICSO algorithm. If its large, the ICSO algorithm would take a longer time to converge to a global best solution and if it was too small, the quality of the image was not good. For this experimentation, G=10 was considered to yield good results in a comparatively less time.\n3) The self-learning coefficient for the chicks s exponentially decreases from 0.9 to 0.4 with increase in the number of iterations. s updated as shown in eq.(18)\n\n$S = S_{min} * (S_{max}/S_{min})^{(1/(1+10*t/Itermax))}$\n\nwhere smin is the final value of the iterations, Smax is the initial value of the iterations, t is the current value of the iterations, Itermax is the maximum number of iterations [8]\n4) The Value of A, the amount of contrast is usually varied on the scale 0-20 and the amount of detail in the image to be retained y is adjusted on a scale 1000 \u2013 109.\nFor Image 1 in fig. 1, X = 5 and y = 50,000 was used. However for image 2 in fig. 2, best results were obtained when x = 4 and y = 10,000,\n5) A comparative analysis was done with other algorithms where all of the common parameters of these algorithms like the population size, dimensions, and maximum number of generations are set to be the same for a fair comparison. The Maximum number of iterations was set to 1000. The Other Parameters of the different algorithms were set as shown in Table I."}, {"title": "V. EXPERIMENTATION AND RESULTS", "content": ""}, {"title": "A. Quality measures", "content": "The evaluation criteria considered here is the entropy (H)of the images, mean, variance and the (Peak Signal to Noise Ratio)PSNR. The expressions are given below.\n1) The mean squared error (MSE) represents the average of the squares of the \"errors\" between the original image and our enhanced image.The MSE of 2 images X(i, j) and Y(i, j)is given by\n\n$MSE = \\frac{\\sum_{i=1}^{N}\\sum_{j=1}^{M}(X(i, j) \u2013 Y (i, j))^2}{MN}$\n\nPeak signal to noise ratio is given in eq.(20) by the following expression: [11]\n\n$PSNR = 20log_{10}(\\frac{255}{\\sqrt{MSE}})$\n\n2) According to Shannon's definition of the entropy,[12] The Entropy of the was calculated using the formula below\n\n$H(X) = \\sum_{i=1}^{n} P(x_i)I(x_i) = -\\sum_{i=1}^{n}P(x_i)log_b P(x_i)$\n\nwhere b is the base of the logarithm. In this experimentation b=2."}, {"title": "B. Results and Discussion", "content": "The algorithm was implemented in matlab and simulations conducted on a computer with a Core i3, 2.7 GHz CPU,2 GB of RAM installed with Octave software. The proposed Algorithm is tested on gray scale images.\n\nThe results are shown in table II for entropy, Mean, Variance and PSNR values for output images using different algorithms; Cuckoo Search(CS), FireFly(FF), Artificial Bee Colony (ABC) and Improved Chicken Swarm Optimization(ICSO). Table II shows the visual appearance for each output image. Image in fig 1 is for a hand written document text on poor quality paper,obtained using a flat bed scanner while Image 2 in fig.2 is another noisy image with some writings in the background For the results in table II, Each algorithm was executed independently 10 times respectively for each image and the average values were calculated.\n\nIt is clear from the visual results in table III that the images enhanced using the proposed ICSO show a good enhancement in terms of global quality. From the obtained numerical results from Table II, it is also obvious that the use of the ICSO algorithm out performs other techniques.\n\nFor future work, It is recommended to compare the performance of the ICSO with other new metaheuristic algorithms."}, {"title": "VI. CONCLUSION", "content": "In this paper, we proposed enhancement of handwritten document images using an improved Chicken swarm optimization algorithm. There are many algorithms for image enhancement but the key challenge is maintaining uniform luminance in an image while preservation of details. The two contradict each other so they need to be balanced. hence we had to devise a strategy to increase contrast while preserving detail. We optimised the input histogram with the improved Chicken swarm algorithm while increasing the contrast and preserving details to improve recognition accuracy."}]}