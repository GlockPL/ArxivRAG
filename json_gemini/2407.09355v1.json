{"title": "FastImpute: A Baseline for Open-source, Reference-Free\nGenotype Imputation Methods - A Case Study in PRS313", "authors": ["Aaron Ge", "Jeya Balasubramanian", "Xueyao Wu", "Peter Kraft", "Jonas S. Almeida"], "abstract": "Genotype imputation enhances genetic data by predicting missing SNPs using reference\nhaplotype information. Traditional methods leverage linkage disequilibrium (LD) to infer\nuntyped SNP genotypes, relying on the similarity of LD structures between genotyped target sets\nand fully sequenced reference panels. Recently, reference-free deep learning-based methods have\nemerged, offering a promising alternative by predicting missing genotypes without external\ndatabases, thereby enhancing privacy and accessibility. However, these methods often produce\nmodels with tens of millions of parameters, leading to challenges such as the need for substantial\ncomputational resources to train and inefficiency for client-sided deployment.\nOur study addresses these limitations by introducing a baseline for a novel genotype\nimputation pipeline that supports client-sided imputation models generalizable across any\ngenotyping chip and genomic region. This approach enhances patient privacy by performing\nimputation directly on edge devices. As a case study, we focus on PRS313, a polygenic risk\nscore comprising 313 SNPs used for breast cancer risk prediction. Utilizing consumer genetic\npanels such as 23andMe, our model democratizes access to personalized genetic insights by\nallowing 23andMe users to obtain their PRS313 score.\nWe demonstrate that simple linear regression can significantly improve the accuracy of\nPRS313 scores when calculated using SNPs imputed from consumer gene panels, such as\n23andMe. Our linear regression model achieved an R\u00b2 of 0.86, compared to 0.33 without", "sections": [{"title": "1. Introduction", "content": "Genotype imputation is essential in genomic research, as it enhances genetic data by\npredicting missing SNPs using reference haplotype information (Browning & Browning, 2007;\nHowie et al., 2009). Traditional methods leverage linkage disequilibrium (LD)\u2014the tendency of\nnearby SNPs to be inherited together due to chromosome recombination. These methods infer\nuntyped SNP genotypes by assuming similar LD structures between genotyped target sets and\nfully sequenced reference panels (Howie et al., 2009). However, to use traditional genotype\nimputation methods such as MiniMac4 (Das et al., 2016) or Beagle 5.4 (Browning et al., 2021),\nusers must either rely on external services like the Michigan Imputation Server (Das et al., 2016),\nwhich can compromise data privacy, or download the entire reference genome onto a local\nmachine, which may be time consuming and inefficient. Recently, reference-free deep\nlearning-based methods (Mowlaei et al., 2023; Naito et al., 2021; Tanaka et al., 2022; Kojima et\nal., 2020) for genotype imputation have emerged as a promising alternative. They utilize\nmachine learning to predict missing genotypes without external databases, enhancing privacy\nand accessibility by eliminating the need for data transfer to external servers.\nDespite their promise, previous reference-free methods face significant challenges. They\nare not universally applicable across all genomic regions and often target the MHC region due to\nits difficulty to sequence given its high degree of polymorphism and structural variation (Naito et\nal., 2024). However, conducting genotype imputation in different regions requires retraining the\nentire model for that specific region. Given that neural network models often have tens of\nmillions of parameters, substantial computational resources are required, making frequent"}, {"title": "2. Methods", "content": "The FastImpute pipeline is designed to train zero-footprint, reference-free genotype imputation models.\nThe pipeline consists of four steps. Step 1: Gather Whole Genome Sequencing (WGS) data (e.g., from the\n1000 Genomes Project). Step 2: Subset the panel SNPs from WGS data to include only those present in\nplatforms like 23andMe and AncestryDNA, and a region of interest like PRS313. This subset serves as\nthe raw input and target (output) for the model. Step 3: Using LDlink, identify a subset of SNPs in the\nraw input that are in linkage disequilibrium (LD) with the target SNPs (PRS313). These SNPs in LD with\nthe target SNPs serve as the input for model training. Step 4: Train the model to predict the target SNPs\nusing the input SNPs."}, {"title": "2.1 Determining the 23andMe SNPs on the V5 SNP", "content": "Since 23andMe does not publicly provide the positions of its V5 SNPs, we\nreverse-engineered the V5 chip using existing user data. Due to quality control measures, SNPs\nsampled from the same V5 chip can vary slightly, necessitating a method to ensure consistency\nacross different datasets. Consequently, while 70 out of the total 77 PRS313 SNPs present in the\n23andMe chip are found in most of the user data, there are 7 PRS313 SNPs that appear only\nsporadically (Figure 2)."}, {"title": "2.2 Preparing the training Dataset", "content": "To build our genotype imputation model, we started by downloading the 1000 Genomes\nProject Data GrCh37 (Step 1, Figure 1) from the official repository (Auton et al., 2015). Next,\nusing BCFtools (Li et al., 2011), we subsetted the target region of our genome imputation model,\nthe PRS313 SNPs as reported by Mavaddat et al. (2019), and the SNPs we determined to be in\nthe 23andMe panel from the 1000 Genomes Project data (Step 2, Figure 1). To reduce the\nlikelihood of overfitting and improve model efficiency, we obtained linkage disequilibrium (LD)\ndata for each PRS313 SNP (Step 3, Figure 1) using LD Proxy (Machiela et al., 2015). We\nfocused on the subset of 23andMe SNPs that have an R^2 value greater than 0.01 with the\nPRS313 SNPs. For PRS313 SNPs that are multiallelic or not found in LD Proxy, we included all\nSNPs within a 500K base pair window in the 23andMe panel, resulting in 17,551 out of over\n660,000 unique positions in the 23andMe V5 gene panel being used for training and evaluating\nthe model."}, {"title": "2.3 Model Training", "content": "This section explains step four of the FastImpute pipeline (Figure 1), in which we\ndeveloped and evaluated two models: a logistic regression model to predict PRS313 SNPs from\nphased 23andMe genotype data and a linear regression model to predict PRS313 SNPs from\nunphased 23andMe genotype data. Both models underwent a consistent pipeline for\nhyperparameter tuning, training, and evaluation, ensuring comparability across different data\ntypes."}, {"title": "2.3.1 Data Loading and Preprocessing", "content": "Since the model is designed to capture linkage disequilibrium (LD) patterns,\ninter-chromosomal information is unnecessary for predicting SNP dosages. Therefore, we split\nthe 23andMe panel data by chromosome, allowing us to construct separate models for each\nchromosome. Although the 23andMe panel already contains some of the PRS313 SNPs, each\nuser's data varies slightly due to quality control measures, resulting in different numbers of\nPRS313 SNPs genotyped for each user. To address this, the output of our model is all PRS313\nSNPs, including those already present in the user's 23andMe panel. This ensures that the model\ncan output a predicted genotype for all 23andMe users, regardless of which PRS313 SNPs they\nare missing. Additionally, the inputs of our model are the SNPs of the 23andMe gene panel in\nLD with PRS313 SNPs."}, {"title": "2.3.2 Model Architecture and Training", "content": "The models trained in this pipeline are a linear regression model and a logistic regression\nmodel, both implemented using PyTorch (Paszke et al., 2019). The linear regression model\nconsists of a single linear layer with L1 regularization (Tibshirani, 1996), which helps prevent\noverfitting by penalizing larger coefficients, acting as an implicit filter for SNPs with low linkage\ndisequilibrium (LD) to PRS313 SNPs. The logistic regression model includes an additional\nsigmoid layer appended to the linear layer.\nWe trained the models using a randomly shuffled 80/20 data split, where 80% (2003\nsamples) of the data is used for training and validation, and the remaining 20% (501 samples) is\nreserved for testing. We employed the Optuna library (Akiba et al., 2019) for hyperparameter\ntuning, utilizing 10-fold cross-validation to optimize the model's parameters across 50 trials for\neach chromosome."}, {"title": "2.3.3 Evaluation Metrics", "content": "To evaluate the imputation performance for each of our 22 genotype imputation models\n(one for each chromosome), we computed several metrics: R2, Imputation Quality Score (IQS)\n(Lin et al., 2010), accuracy, and AUC. R\u00b2 was calculated using the Scikit-learn library\n(Pedregosa et al., 2018) to indicate the proportion of variance in the true genotypes explained by\nthe imputed dosages. AUC (Area Under the ROC Curve) was computed using PyTorch (Paszke\net al., 2019) to assess the discriminative ability of the imputed dosages.\nSince imputing allele dosages is a multi-class classification problem (with allele dosages\nof 0, 1, or 2), we calculated the one-vs-all AUC for each class for the linear regression model\ntrained with unphased data. We then computed the mean AUC of the three classes. In cases\nwhere there were no positive classes for a genotype, resulting in an undefined AUC value, these\nundefined values were excluded when calculating the mean AUC.\nEach metric was computed on the test set of each chromosome, and the median values\nacross all 22 chromosomal models are reported in Figure N. Additionally, the R\u00b2 of each\nindividual SNP within PRS313 was computed for both the linear regression and logistic\nregression models. The distributions of these R\u00b2 values are plotted in Figure N and compared\nwith the R\u00b2 values of Beagle (Browning et al., 2021)."}, {"title": "2.4 Benchmarking Beagle", "content": "To benchmark the performance of Beagle 5.4 (Browning et al., 2021), we left out the\nsame 501 samples that we used to evaluate our previously trained models from the 1000 Genome\nProject to serve as the test set. We then ran Beagle 5.4 on the full 23andMe panel data, excluding\nthe overlapping PRS313 SNPs that are already present in the panel, using the remaining 2003\nsamples from the 1000 Genomes Project as the reference genome. The imputation results were\nsubsequently evaluated for R^2, IQS, Accuracy, and AUC ROC."}, {"title": "2.4 Deployment", "content": "This website displays results of the polygenic risk score (PRS) calculations for various breast cancer\nphenotypes based on user 23andMe genotype data. Users can upload their 23andMe data file and specify\nthe number of simulation trials to process their PRS313 scores. The results section displays the processing\nstatus and the calculated PRS scores for five breast cancer phenotypes: Overall Breast Cancer,\nER-positive, ER-negative, hybrid ER-positive, and hybrid ER-negative. Each phenotype panel includes\nstatistical summaries of the PRS scores, such as mean, median, standard deviation, minimum, and\nmaximum values, along with a histogram showing the distribution of PRS scores across the simulation\ntrials. For more information, please see section 2.4.\nWe deployed our linear regression (unphased) model on GitHub at\nhttps://aaronge-2020.github.io/DeepImpute/, allowing users to privately and securely calculate\ntheir PRS313 scores on any devices, including their smartphones. The reason we deployed this\nmodel over the logistic regression model despite its better performance is because 23andMe data\ndoes not contain phasing information. To calculate the polygenic risk score (PRS) from a user's\n23andMe genotype data, we conducted the following steps:\nFirst, the user's 23andMe data was converted from genotypes to allele dosages by\nreferencing the 1000 Genomes Project for the reference and alternate alleles at each position.\nDue to quality control measures by 23andMe, different users have data with slightly different\npositions, leading to varying missing data across users. To address this, we simulated missing\nSNP values based on minor allele frequency (MAF) data taken from the 1000 Genome project\n(1000 Genome Consortium, 2015). This approach allowed us to calculate PRS313 risk scores\nacross multiple simulations, generating a distribution of potential risk scores based on the\nmissing data from each user's 23andMe panel. Users could specify the number of simulations,\nbalancing the trade-off between accuracy and computational time. Typically, running 1,000\nsimulations only takes approximately 7-10 seconds based on the speed of the user's machine, due\nto the model's small size and portability.\nFor each simulation, two random draws were conducted for each allele, with the\nprobability of the allele being present based on the MAF, to determine the dosage for each allele.\nThese dosages were then summed to simulate unphased data. The simulated data from each\nsimulation was passed into the imputation model to impute the PRS313 SNPs.\nSince the user's 23andMe data may already contain certain PRS313 positions, the allele\ndosages at already genotyped locations were used in place of the imputed dosages. The PRS313\nSNPs dosages from each simulation were then used to calculate PRS scores. Beta values for each"}, {"title": "3. Results", "content": "The performance of different genotype imputation methods was evaluated using R\u00b2, IQS,\nAUC, and accuracy to determine their effectiveness in genotype imputation and predicting\npolygenic risk scores (PRS). Our analysis, presented in Figures 4 through 7, has shown that\nalthough Beagle (Browning et al., 2021) consistently performed the strongest across various\nmetrics and PRS phenotypes, the baseline linear models do not fall significantly behind. This is\nsurprising, given the simplicity of the models and the linear regression model's lack of use of a\nphased reference genome."}, {"title": "3.1 Evaluation of Genotype Imputation Models", "content": "As shown in Figure 4, which compares the median metrics (R2, Imputation Quality Score\n(IQS), Accuracy, and AUC) of each model across 22 chromosomes, Beagle (Browning et al.,\n2021) consistently achieves the highest median values. When assessed using IQS, accuracy, and\nAUC, Logistic Regression (phased) and Linear Regression (unphased) performs very\ncomparably to Beagle. While the Logistic Regression (phased) achieved a median IQS of 0.888\n+/- 0.041 and the Linear Regression (unphased) had an IQS of 0.824 +/- 0.047, Beagle has a\nmedian IQS of 0.918 +/- 0.032. However, when assessed using R\u00b2, beagle performs significantly\nstronger than the linear methods, with an R\u00b2 of 0.879 +/- 0.304, compared to 0.730 +/- 0.112 of\nlogistic regression and 0.681 +/- 0.099 of linear regression. The high standard deviation in the R2\nof Beagle is due to the presence of two problematic SNPs, which achieved extremely negative R\u00b2\nvalues (chr7:55192256 and chr4:84370124). The significance of phasing information in\ngenotype imputation is also highlighted in Figure 4, which illustrates the stronger performance of\nthe logistic regression model using phased data compared to the linear regression model using\nunphased data.\nThe distribution of R\u00b2 scores across chromosomes, shown in Figure 5, further illustrates\nthe performance differences between imputation methods. Beagle exhibits a high proportion of\nSNPs with R\u00b2 > 0.9 (68.39%), significantly outpacing Linear Regression (unphased), which only\nachieves this threshold for 21.71% of SNPs. Similarly, Logistic Regression (phased) reaches this\nlevel for 32.90% of SNPs, highlighting its stronger performance over the unphased model. These\nfindings underscore that there is indeed a significant advantage to using phased data and\nreference-base methods like Beagle. However, they also highlight the decent efficacy of the\nbaseline models, especially given their simplicity and reference-free nature."}, {"title": "3.2 Evaluation of PRS Scores Accuracy with Imputed Genotypes", "content": "The R\u00b2 values were calculated by comparing the PRS scores calculated using imputed genotypes versus\nthe PRS score calculated using the real genotypes obtained from the WGS data. Due to quality control\nmeasures, although there are 77 SNPs present within the 23andMe genotyping panel, user data may have"}, {"title": "4. Discussion", "content": "This study introduces lightweight, client-sided genotype imputation models that enhance\nboth the accuracy and accessibility of polygenic risk score calculations. Our approach addresses\nkey challenges in existing imputation methods, balancing performance, computational efficiency,\nand privacy. The ability to run these models on edge devices in real-time represents a significant\nadvancement in point-of-care genetic testing and personalized medicine.\nTraditional reference-based methods, while accurate, are computationally intensive and\nlimited by reference panel accessibility. The size of the GRCh37 1000 Genome Project files\n(14.8 GB) can be prohibitive for many researchers, necessitating reliance on services like the\nMichigan Impute Server (Das et al., 2016). These services lack real-time genotype imputation\ncapabilities and can cause delays in research and clinical decision-making due to server\ndowntimes and long queue times. Additionally, these methods may underperform when target\nsets differ from discovery panels (Levi et al., 2024), as shown by the variability in Beagle's R\u00b2 in\nour results, particularly at a few specific PRS313 SNPs (chr7:55192256 and chr4:84370124).\nThis variability could lead to inconsistent genetic risk assessments in underrepresented patient\npopulations. Reference-free approaches have been developed to address these issues (Duong et\nal., 2023; Mowlaei et al., 2023; Naito et al., 2021; Tanaka et al., 2022; Kojima et al., 2020).\nHowever, they are often too large for browser-based imputation and require computationally\nexpensive retraining for imputing on different regions, limiting their practical clinical\napplication.\nOur method offers an efficient, accurate, and privacy-preserving alternative that, to our\nknowledge, is the first serverless genotype imputation model. Using a baseline linear regression\nmodel, our solution is simple yet effective, with significantly less expensive retraining compared\nto deep neural networks. This adaptability suits various genomic regions and pipelines while\nenabling data processing on edge devices like smartphones.\nAs demonstrated by our PRS313 case study for breast cancer risk assessment, the clinical\nimplications are significant: using our pipeline, healthcare providers could, in theory, perform\nreal-time genetic risk assessments during patient consultations, seamlessly integrating genetic\ninformation into clinical decision-making. By preserving user privacy and enhancing\naccessibility, our approach could democratize access to gene imputation, enabling its integration\ninto routine clinical practice even in resource-limited settings. This could lead to earlier disease\ndetection, more personalized treatment plans, and improved patient outcomes across a wide\nrange of genetic conditions. According to Mavaddat et al. (2019), women in the top 1% of the\nPRS313 distribution have a predicted risk approximately four times larger than those in the\nmiddle quintile, aligning with the UK NICE definition of high risk for breast cancer. Our logistic\nregression model using phased data performs comparably to Beagle in identifying high-risk"}, {"title": "5. Conclusion", "content": "Our study demonstrates the viability of lightweight, client-sided genotype imputation\nmodels, highlighting their potential for preserving user privacy and enhancing accessibility.\nThese results have practical implications, particularly for breast cancer risk prediction. Our\nbaseline models identified high-risk individuals using 23andMe data with comparable\nperformance to Beagle, underscoring their potential utility in clinical settings."}]}