{"title": "FastImpute: A Baseline for Open-source, Reference-Free Genotype Imputation Methods - A Case Study in PRS313", "authors": ["Aaron Ge", "Jeya Balasubramanian", "Xueyao Wu", "Peter Kraft", "Jonas S. Almeida"], "abstract": "Genotype imputation enhances genetic data by predicting missing SNPs using reference haplotype information. Traditional methods leverage linkage disequilibrium (LD) to infer untyped SNP genotypes, relying on the similarity of LD structures between genotyped target sets and fully sequenced reference panels. Recently, reference-free deep learning-based methods have emerged, offering a promising alternative by predicting missing genotypes without external databases, thereby enhancing privacy and accessibility. However, these methods often produce models with tens of millions of parameters, leading to challenges such as the need for substantial computational resources to train and inefficiency for client-sided deployment.\nOur study addresses these limitations by introducing a baseline for a novel genotype imputation pipeline that supports client-sided imputation models generalizable across any genotyping chip and genomic region. This approach enhances patient privacy by performing imputation directly on edge devices. As a case study, we focus on PRS313, a polygenic risk score comprising 313 SNPs used for breast cancer risk prediction. Utilizing consumer genetic panels such as 23andMe, our model democratizes access to personalized genetic insights by allowing 23andMe users to obtain their PRS313 score.\nWe demonstrate that simple linear regression can significantly improve the accuracy of PRS313 scores when calculated using SNPs imputed from consumer gene panels, such as 23andMe. Our linear regression model achieved an R\u00b2 of 0.86, compared to 0.33 without", "sections": [{"title": "1. Introduction", "content": "Genotype imputation is essential in genomic research, as it enhances genetic data by predicting missing SNPs using reference haplotype information (Browning & Browning, 2007; Howie et al., 2009). Traditional methods leverage linkage disequilibrium (LD)\u2014the tendency of nearby SNPs to be inherited together due to chromosome recombination. These methods infer untyped SNP genotypes by assuming similar LD structures between genotyped target sets and fully sequenced reference panels (Howie et al., 2009). However, to use traditional genotype imputation methods such as MiniMac4 (Das et al., 2016) or Beagle 5.4 (Browning et al., 2021), users must either rely on external services like the Michigan Imputation Server (Das et al., 2016), which can compromise data privacy, or download the entire reference genome onto a local machine, which may be time consuming and inefficient. Recently, reference-free deep learning-based methods (Mowlaei et al., 2023; Naito et al., 2021; Tanaka et al., 2022; Kojima et al., 2020) for genotype imputation have emerged as a promising alternative. They utilize machine learning to predict missing genotypes without external databases, enhancing privacy and accessibility by eliminating the need for data transfer to external servers.\nDespite their promise, previous reference-free methods face significant challenges. They are not universally applicable across all genomic regions and often target the MHC region due to its difficulty to sequence given its high degree of polymorphism and structural variation (Naito et al., 2024). However, conducting genotype imputation in different regions requires retraining the entire model for that specific region. Given that neural network models often have tens of millions of parameters, substantial computational resources are required, making frequent"}, {"title": "2. Methods", "content": "The FastImpute pipeline is designed to train zero-footprint, reference-free genotype imputation models.\nThe pipeline consists of four steps. Step 1: Gather Whole Genome Sequencing (WGS) data (e.g., from the 1000 Genomes Project). Step 2: Subset the panel SNPs from WGS data to include only those present in platforms like 23andMe and AncestryDNA, and a region of interest like PRS313. This subset serves as the raw input and target (output) for the model. Step 3: Using LDlink, identify a subset of SNPs in the raw input that are in linkage disequilibrium (LD) with the target SNPs (PRS313). These SNPs in LD with the target SNPs serve as the input for model training. Step 4: Train the model to predict the target SNPs using the input SNPs."}, {"title": "2.1 Determining the 23andMe SNPs on the V5 SNP", "content": "Since 23andMe does not publicly provide the positions of its V5 SNPs, we\nreverse-engineered the V5 chip using existing user data. Due to quality control measures, SNPs\nsampled from the same V5 chip can vary slightly, necessitating a method to ensure consistency\nacross different datasets. Consequently, while 70 out of the total 77 PRS313 SNPs present in the\n23andMe chip are found in most of the user data, there are 7 PRS313 SNPs that appear only\nsporadically (Figure 2)."}, {"title": "2.2 Preparing the training Dataset", "content": "To build our genotype imputation model, we started by downloading the 1000 Genomes\nProject Data GrCh37 (Step 1, Figure 1) from the official repository (Auton et al., 2015). Next,\nusing BCFtools (Li et al., 2011), we subsetted the target region of our genome imputation model,\nthe PRS313 SNPs as reported by Mavaddat et al. (2019), and the SNPs we determined to be in\nthe 23andMe panel from the 1000 Genomes Project data (Step 2, Figure 1). To reduce the\nlikelihood of overfitting and improve model efficiency, we obtained linkage disequilibrium (LD)\ndata for each PRS313 SNP (Step 3, Figure 1) using LD Proxy (Machiela et al., 2015). We\nfocused on the subset of 23andMe SNPs that have an R^2 value greater than 0.01 with the\nPRS313 SNPs. For PRS313 SNPs that are multiallelic or not found in LD Proxy, we included all\nSNPs within a 500K base pair window in the 23andMe panel, resulting in 17,551 out of over\n660,000 unique positions in the 23andMe V5 gene panel being used for training and evaluating\nthe model."}, {"title": "2.3 Model Training", "content": "This section explains step four of the FastImpute pipeline (Figure 1), in which we\ndeveloped and evaluated two models: a logistic regression model to predict PRS313 SNPs from\nphased 23andMe genotype data and a linear regression model to predict PRS313 SNPs from\nunphased 23andMe genotype data. Both models underwent a consistent pipeline for\nhyperparameter tuning, training, and evaluation, ensuring comparability across different data\ntypes."}, {"title": "2.3.1 Data Loading and Preprocessing", "content": "Since the model is designed to capture linkage disequilibrium (LD) patterns,\ninter-chromosomal information is unnecessary for predicting SNP dosages. Therefore, we split\nthe 23andMe panel data by chromosome, allowing us to construct separate models for each\nchromosome. Although the 23andMe panel already contains some of the PRS313 SNPs, each\nuser's data varies slightly due to quality control measures, resulting in different numbers of\nPRS313 SNPs genotyped for each user. To address this, the output of our model is all PRS313\nSNPs, including those already present in the user's 23andMe panel. This ensures that the model\ncan output a predicted genotype for all 23andMe users, regardless of which PRS313 SNPs they\nare missing. Additionally, the inputs of our model are the SNPs of the 23andMe gene panel in\nLD with PRS313 SNPs."}, {"title": "2.3.2 Model Architecture and Training", "content": "The models trained in this pipeline are a linear regression model and a logistic regression\nmodel, both implemented using PyTorch (Paszke et al., 2019). The linear regression model\nconsists of a single linear layer with L1 regularization (Tibshirani, 1996), which helps prevent\noverfitting by penalizing larger coefficients, acting as an implicit filter for SNPs with low linkage\ndisequilibrium (LD) to PRS313 SNPs. The logistic regression model includes an additional\nsigmoid layer appended to the linear layer.\nWe trained the models using a randomly shuffled 80/20 data split, where 80% (2003\nsamples) of the data is used for training and validation, and the remaining 20% (501 samples) is\nreserved for testing. We employed the Optuna library (Akiba et al., 2019) for hyperparameter\ntuning, utilizing 10-fold cross-validation to optimize the model's parameters across 50 trials for\neach chromosome."}, {"title": "2.3.3 Evaluation Metrics", "content": "To evaluate the imputation performance for each of our 22 genotype imputation models\n(one for each chromosome), we computed several metrics: R2, Imputation Quality Score (IQS)\n(Lin et al., 2010), accuracy, and AUC. R\u00b2 was calculated using the Scikit-learn library\n(Pedregosa et al., 2018) to indicate the proportion of variance in the true genotypes explained by\nthe imputed dosages. AUC (Area Under the ROC Curve) was computed using PyTorch (Paszke\net al., 2019) to assess the discriminative ability of the imputed dosages.\nSince imputing allele dosages is a multi-class classification problem (with allele dosages\nof 0, 1, or 2), we calculated the one-vs-all AUC for each class for the linear regression model\ntrained with unphased data. We then computed the mean AUC of the three classes. In cases\nwhere there were no positive classes for a genotype, resulting in an undefined AUC value, these\nundefined values were excluded when calculating the mean AUC.\nEach metric was computed on the test set of each chromosome, and the median values\nacross all 22 chromosomal models are reported in Figure N. Additionally, the R\u00b2 of each\nindividual SNP within PRS313 was computed for both the linear regression and logistic\nregression models. The distributions of these R\u00b2 values are plotted in Figure N and compared\nwith the R\u00b2 values of Beagle (Browning et al., 2021)."}, {"title": "2.4 Benchmarking Beagle", "content": "To benchmark the performance of Beagle 5.4 (Browning et al., 2021), we left out the\nsame 501 samples that we used to evaluate our previously trained models from the 1000 Genome\nProject to serve as the test set. We then ran Beagle 5.4 on the full 23andMe panel data, excluding\nthe overlapping PRS313 SNPs that are already present in the panel, using the remaining 2003\nsamples from the 1000 Genomes Project as the reference genome. The imputation results were\nsubsequently evaluated for R^2, IQS, Accuracy, and AUC ROC."}, {"title": "2.4 Deployment", "content": "This website displays results of the polygenic risk score (PRS) calculations for various breast cancer\nphenotypes based on user 23andMe genotype data. Users can upload their 23andMe data file and specify\nthe number of simulation trials to process their PRS313 scores. The results section displays the processing\nstatus and the calculated PRS scores for five breast cancer phenotypes: Overall Breast Cancer,"}, {"title": "3. Results", "content": "The performance of different genotype imputation methods was evaluated using R\u00b2, IQS,\nAUC, and accuracy to determine their effectiveness in genotype imputation and predicting\npolygenic risk scores (PRS). Our analysis, presented in Figures 4 through 7, has shown that\nalthough Beagle (Browning et al., 2021) consistently performed the strongest across various\nmetrics and PRS phenotypes, the baseline linear models do not fall significantly behind. This is\nsurprising, given the simplicity of the models and the linear regression model's lack of use of a\nphased reference genome."}, {"title": "3.1 Evaluation of Genotype Imputation Models", "content": null}, {"title": "3.2 Evaluation of PRS Scores Accuracy with Imputed Genotypes", "content": null}, {"title": "4. Discussion", "content": "This study introduces lightweight, client-sided genotype imputation models that enhance\nboth the accuracy and accessibility of polygenic risk score calculations. Our approach addresses\nkey challenges in existing imputation methods, balancing performance, computational efficiency,\nand privacy. The ability to run these models on edge devices in real-time represents a significant\nadvancement in point-of-care genetic testing and personalized medicine."}, {"title": "5. Conclusion", "content": "Our study demonstrates the viability of lightweight, client-sided genotype imputation\nmodels, highlighting their potential for preserving user privacy and enhancing accessibility.\nThese results have practical implications, particularly for breast cancer risk prediction. Our\nbaseline models identified high-risk individuals using 23andMe data with comparable\nperformance to Beagle, underscoring their potential utility in clinical settings."}]}