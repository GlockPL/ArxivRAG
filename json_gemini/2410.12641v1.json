{"title": "CASCADE LEARNING IN MULTI-TASK ENCODER-DECODER NETWORKS FOR CONCURRENT BONE SEGMENTATION AND GLENOHUMERAL JOINT ASSESSMENT IN SHOULDER CT SCANS", "authors": ["Luca Marsilio", "Matteo Rossi", "Alfonso Manzotti", "Davide Marzorati", "Andrea Moglia", "Luca Mainardi", "Pietro Cerveri"], "abstract": "Osteoarthritis is a degenerative condition that affects bones and cartilage, often resulting in the formation of osteophytes, loss of bone density, and narrowing of joint spaces. Treatment options to restore normal joint function vary depending on the severity of the condition. This work introduces an innovative deep-learning framework processing shoulder CT scans. It features the semantic segmentation of the proximal humerus and scapula, the 3D reconstruction of bone surfaces, the identification of the glenohumeral (GH) joint region, and the staging of three common osteoarthritic-related conditions: osteophyte formation (OS), GH space reduction (JS), and humeroscapular alignment (HSA). The pipeline comprises two cascaded CNN architectures: 3D CEL-UNet for segmentation and 3D Arthro-Net for threefold classification. A retrospective dataset of 571 CT scans featuring patients with various degrees of GH osteoarthritic-related pathologies was used to train, validate, and test the pipeline. Root mean squared error and Hausdorff distance median values for 3D reconstruction were 0.22 mm and 1.48 mm for the humerus and 0.24 mm and 1.48 mm for the scapula, outperforming state-of-the-art architectures and making it potentially suitable for a PSI-based shoulder arthroplasty preoperative plan context. The classification accuracy for OS, JS, and HSA consistently reached around 90% across all three categories. The computational time for the entire inference pipeline was less than 15 s, showcasing the framework's efficiency and compatibility with orthopedic radiology practice. The outcomes represent a promising advancement toward the medical translation of artificial intelligence tools. This progress aims to streamline the preoperative planning pipeline delivering high-quality bone surfaces and supporting surgeons in selecting the most suitable surgical approach according to the unique patient joint conditions.", "sections": [{"title": "Introduction", "content": "Osteoarthritis (OA) is a degenerative condition affecting bones and cartilage, usually ending up in changes of the bony surfaces such as the formation of osteophytes, bone density loss, and the narrowing of joint spaces Kellgren and Lawrence [1957], Ogawa et al. [2006], Thomas et al. [2016], Khazzam et al. [2020]. In the shoulder, the glenohumeral (GH) joint is formed by the glenoid (or humeral socket) and the humeral head, physiologically concentric to the glenoid. When primary OA develops, cartilage deterioration leads to a sensible reduction of the GH space, ultimately causing direct contact between the humeral head and its socket. This condition can progress up to complete impingement inducing inflammation, pain, and the reduction of the joint's range of motion. As OA severity increases, osteophytes might arise in the antero-inferior portion of the humeral head and extend downward Ogawa et al. [2006]. The constant bone rubbing can also lead the glenoid to flatten, along with further osteophyte progression to its boundaries Lo et al. [2021]. On a long-term basis, the overall process disrupts the GH joint functionality Lo et al. [2021]. Different treatment options can be pursued based on the severity of the condition and the osteophyte location. They span from rehabilitation and drug therapy to joint resurfacing and total arthroplasty, offering a spectrum of interventions tailored to individual needs Junker et al. [2016], Ward and Dines [2018], Leung et al. [2020]. Moreover, a pathological humeroscapular alignment (HSA) further contributes to joint instability and osteoarthritis development Sassoon et al. [2013], Sabesan et al. [2014]. This condition, also called humeral eccentricity, involves the humeral head shift to the glenoid surface in the superoinferior and anteroposterior planes. Typically, it requires the surgical repositioning of the humeral head within its socket, following rehabilitation Kohles et al. [2007]. If the eccentricity is associated with osteoarthritis, shoulder arthroplasty may be considered an effective therapeutic option Buck et al. [2008], Kim et al. [2016]. In this situation, the assessment of the HSA before surgery improves the efficacy of the clinical procedure, and the rehabilitation plan after the operation can be tailored accordingly Petscavage-Thomas [2014], Kleim et al. [2022]. Therefore, GH osteophyte severity, intra-articular space staging, and HSA are among the ultimate predictive factors for shoulder joint treatment. The ensemble of these conditions is crucial to identifying the most suitable surgical implant. Anatomical and reverse are the two main prosthetic devices used in shoulder replacement surgeries to restore joint function. An anatomical shoulder implant is designed to mimic the natural shoulder anatomy, while the reverse is specialized for individuals with severe osteoarthritis combined with irreparable rotator cuff damage. Since a strong humeral head eccentricity is strongly correlated to rotator cuff damage Saupe et al. [2006], Goutallier et al. [2011], an eccentric HSA with a high degree of osteophyte size and GH joint space narrowing suggest a reverse approach, while concentric HSA and a physiological GH distance an anatomical prosthesis Goetti et al. [2021]. Furthermore, an accurate alignment in primary arthroplasty intervention is related to a reduced need for revision procedures, enhancing the outcomes of such techniques Watters et al. [2011]. Personalized Surgical Instruments (PSIs) recently revealed decreased surgical time and a more repeatable neutral postoperative alignment, reducing also intra-operative complications Seon et al. [2016], Noble Jr et al. [2012], Mattei et al. [2016]. PSIs for shoulder arthroplasty intervention are patient-specific cutting jigs reproducing the patient's proximal humerus and scapula edges. Their production and deployment require access to digital three-dimensional (3D) volumes of the humerus and scapula, obtained through medical image processing Cerveri et al. [2017], Lombardi Jr and Berend [2008]. These surfaces are needed to properly manufacture the disposable jigs, choose the prosthesis size, estimate the optimal cutting planes, and reduce the risk of poor fitting and associated loosening of the implants Mandolini et al. [2022]. Diagnostics and pre-operative computed tomography (CT) or magnetic resonance imaging (MRI) of the upper thorax are mandatory to identify osseous morphology, stage articular surface degeneration, characterize pathological deformations, and assess bone misalignment. Nevertheless, the presence of GH osteoarthritic-related pathological conditions results in highly irregular bone profiles, making the delineation of surface boundaries challenging even for expert radiologists Goud et al. [2008]. In addition, automated image processing and analysis still represent a critical issue in the orthopedic pipeline Khazzam et al. [2020], Maffulli et al. [2020], Ladd et al. [2021]. Deep learning-based tools, such as convolutional neural networks (CNNs), were explored in this field Isensee et al. [2021], Wang and Han [2021a], Yeoh et al. [2021]. Encoder-decoder (E-D) architectures, such as the UNet and nnUNet, were effective in the identification of osseous regions and soft tissues in two-dimensional (2D) X-ray and volumetric (3D) scans Norman et al. [2018], Ambellan et al. [2019], Marzorati et al. [2020], Wang and Han [2021a], Rossi et al. [2022], Florkow et al. [2022], Schnider et al. [2022], Isensee et al. [2021]. CNNs were also studied to stage osteoarthritis Thomas et al. [2020], Taghizadeh et al. [2021], Wang et al. [2022] and optimal treatment prediction, offering a valuable tool to assist clinicians in preoperative planning.Leung et al. [2020], Potty et al. [2023]. In this work, we propose an innovative deep learning framework designed for processing shoulder CT scans, aiming to streamline a PSI-based shoulder preoperative planning pipeline by delivering high-quality bone surfaces and support surgeons in selecting the most suitable surgical approach according to the unique patient joint conditions. It includes the semantic segmentation of the proximal humerus and scapula with the CEL-UNet model Rossi et al. [2022], the 3D reconstruction of bone surfaces, the identification of the GH joint region, and the staging of three common osteoarthritic-related conditions: osteophyte formation (OS), glenohumeral joint space reduction (JS), and humeroscapular alignment (HSA)."}, {"title": "Literature background", "content": "The success of PSI-based surgery relies on achieving sub-millimetric alignment between the patient's bone surface and the jig footprint Ogura et al. [2019], Anderl et al. [2016]. Consequently, the accuracy of bone segmentation methods is critical to ensuring precise instrumentation alignment with the patient's anatomy. Traditional automated segmentation techniques, such as statistical shape models (SSMs) and region-growing algorithms, have been investigated for this purpose. A hierarchical acetabolum and femoral head SSM was proposed for the automatic segmentation of diseased hip Yokota et al. [2013]. In Lamecker et al. [2004] and Seim et al. [2008], 3D SSMs were deployed for pelvic bones segmentation from CT data, while in Poltaretskyi et al. [2017] the pre-morbid proximal humeral anatomy was predicted in patients with severe degenerative osteoarthritis or a fracture of the proximal humerus. Region-growing algorithms have also been utilized for surgical planning applications Mendoza et al. [2012], Sivewright and Elliott [1994], Sekiguchi et al. [1994]. However, both SSMs and region-growing algorithms face significant challenges when dealing with complex anatomical structures and the variability often present in damaged joints. CNNs, such as the UNet Ronneberger et al. [2015] and the nn-UNet Isensee et al. [2021], demonstrated the ability to overcome these limitations by effectively capturing intricate patterns and accommodating anatomical variability. They were successful in knee bone CT scans Marzorati et al. [2020], Zhang et al. [2022], Rossi et al. [2022], vertebral bodies in CT images Klein et al. [2019], Suri et al. [2021], Schmidt et al. [2022], and automatically produced tibia and femur volumes compliant for a PSI-based total knee arthroplasty intervention Marsilio et al. [2023]. 3D UNet architectures also systematically outperformed their 2D counterparts in processing volumetric scans. Klein et al. [2019], Marzorati et al. [2020], Schnider et al. [2022]. CNNs were proposed to stage cartilage osteonecrosis in the knee from X-ray images according to the Kellgren-Lawrence scoring, reporting results similar to intra-expert repeatability Thomas et al. [2020], Yeoh et al. [2021]. In Uysal et al. [2021], different pre-trained models, including ResNet and DenseNet, were compared to assess fracture/non-fracture conditions in X-ray images. A multi-task deep learning model was proposed for grading radiographic (weight-bearing anterior-posterior pelvic) hip osteoarthritis in 4368 patients von Schacky et al. [2020], disregarding other clinical conditions. In the shoulder, rotator cuff muscle degeneration was assessed using a CNN that analyzed CT scans from 95 patients, achieving accuracy comparable to that of expert raters Taghizadeh et al. [2021]. A regression CNN was used to estimate the critical shoulder angle Minelli et al. [2022] from anteroposterior shoulder X-ray images, with outcomes compatible with the clinical setting. A similar pipeline was also proposed to assess the most common causes of shoulder pain, such as proximal humeral fractures, joint dislocation, periarticular calcification, osteoarthritis, osteosynthesis, and joint endoprosthesis, on 2700 X-ray images Grauhan et al. [2022]. However, enhancing the shoulder evaluation for a patient-specific surgical plan requires a more comprehensive joint analysis, including osteophyte staging and humeroscapular alignment, often underestimated in the current literature."}, {"title": "Contributions", "content": "Considering the preceding context, this study proposes a novel cascaded deep learning pipeline (Fig. 1), combining the semantic segmentation of proximal humerus and scapula, the 3D reconstruction of the two bones, and a multi-task multi-class classifier, predicting osteophyte staging, GH osteoarthritis severity, and HSA, concurrently. The paper's contributions can be summarized as:\n\n\u2022 the CEL-UNet segmentation quality assessment against state-of-the-art nnUNet architectures over a 571 CT scan dataset featuring several degrees of bone morphological deformations;\n\n\u2022 the automatic extraction of the GH joint region in the CT volume to speed up the identification of the region where relevant joint pathological conditions are detected;\n\n\u2022 the design of a novel CNN architecture (Arthro-Net) tailored for staging three GH osteoarthritic-related pathological conditions, concurrently;\n\n\u2022 the deployment of an automated deep learning-based pipeline coupling two cascaded CNN architectures to simultaneously perform CT segmentation, 3D bone reconstruction, and GH pathology classification."}, {"title": "Materials and Methods", "content": "A dataset of 607 axial CT scans, acquired in DICOM standard format in the context of PSI-based preoperative planning for total or reverse shoulder arthroplasty intervention, was provided by MEDACTA International SA (Castel San Pietro, Switzerland). Patients, aged 74\u00b111 years, were diagnosed with various clinical conditions like osteoarthritis, inflam-matory arthritis, osteonecrosis involving the glenoid, and post-traumatic degenerative GH joint disease. Preliminary image analysis confirmed varying degrees of osteophytes, cartilage defects, misalignment of the humeral head, and GH impingement. All patients underwent shoulder arthroplasty between 2021 and 2022 (about 20% anatomical implants and the remaining inverse implants). CT scans were acquired with different imaging equipment, mostly at 512\u00d7512 pixels and 330 slices on average, with variable pixel size, ranging from 0.30 to 0.98 mm, and axial slicing, ranging from 0.30 to 2.5 mm. In addition to CT images, the dataset included 3D surface models of the proximal humerus and Out of the initial 607 cases, 36 were excluded due to the presence of inner metal parts such as screws, implants, and plaques, which fell outside the scope of this study. The remaining 571 cases (297 males and 274 females, comprising 271 left shoulders and 300 right shoulders) were considered for the present investigation. Since CT scans originated from different scanning equipment, voxel intensities were normalized to improve the network's learning performance. Values, acquired in the Hounsfield Unit (HU) scale, were first clipped between -1024 and 2500 units, representing air to dense cortical bone Schneider et al. [1996], then shifted to positive ranges, and normalized between 0 and 1 for consistency. From this dataset, 85% of the cases, totaling 481, were randomly selected for training and validation sets, including 410 and 71 volumes, respectively. The remaining 90 images defined the test set to evaluate the network performances. To address the two tasks, the dataset was duplicated into two sets: one for segmentation (DSeg), and one for classification (DClass) (Fig. 3). CT scans in the DSeg set were cropped in the axial, coronal, and sagittal view, to remove all the slices where the proximal humerus and scapula were unavailable. A patch-based method was then applied to increase training and validation instances, while preserving the original voxel resolution. Each cropped CT was patched into a different number of 160\u00d7160\u00d7160 sub-volumes, depending on their initial dimension and degree of overlapping (around 25% of the size). For the DClass set, CT scans were cropped to a single 160\u00d7160\u00d7160 sub-volume, ensuring that both the humeral head and the glenoid surface were included and centered on the GH joint area. This focused extraction was essential to minimize classification biases from surrounding tissues and organs and to reduce computational overhead. The GH-centered bounding box was extracted through an automated algorithm that builds upon the technique described in Cerveri et al. [2017], originally focused on the proximal femoral head, that employs morphological analysis of the proximal humerus to delineate the desired region. The number of CT scans in the DClass set was finally doubled by flipping the originated sub-volumes in the sagittal plane. This technique effectively mirrored"}, {"title": "GH pathological conditions staging and data labeling", "content": "The severity of humeral head osteophytes (OS) was staged into three classes based on the Samilson-Prieto grading system Elsharkawi et al. [2013], Habermeyer et al. [2017], featuring increasing osteophyte size. Grade 0 denoted small-size (so <3 mm), grade 1 medium-size (3 < s\uff61 < 7 mm), and grade 2 large-size (s\u3002 > 7 mm) osteophytes. Preliminary labeling of OS was automatically performed by computing the maximum distance (in millimeters) between the morphologic and osteophyte-cleared humerus reference surfaces for each case in the dataset and assigning the corresponding classification label. A radiological expert with more than 20 years of orthopedic clinical practice (A.M.) revised the final labeling of the OS. The GH joint space was tagged manually according to the Kellgren-Lawrence grading system Kellgren and Lawrence [1957] under the supervision of the same radiological expert. Three classes were identified for each case depending on the residual GH joint space (JS), featuring physiological joint space (grade 0), slightly narrowed joint space (grade 1), and non-detectable joint space (grade 2). HSA was assessed by analyzing the displacement of the humeral head relative to the glenoid surface defining either eccentric-pathological or concentric-physiological humeral head alignments Kleim et al. [2022]."}, {"title": "Segmentation network: CEL-UNet", "content": "The CEL-UNet model was prior Rossi et al. [2022], Marsilio et al. [2023] designed and developed by our group to boost the segmentation quality on knee CT scans and enable preoperative planning in PSI-based total knee arthroplasty. The identification of severe pathological anatomy deformations and narrow joint space was enhanced by combining traditional semantic mask segmentation with boundary identification (Fig. 5). In detail, the decoder was split into two parallel branches, one devoted to region segmentation (RA, region-aware branch) and the other addressing edge detection (CA, contour-aware branch). Vertical unidirectional skip connections were added between each CA branch processing block and its corresponding one in the RA branch, to integrate region and boundary-related features at increasing resolution. A specialized processing module was also implemented after each CA branch layer, using the pyramidal edge extraction (PEE) approach inspired by [Wang et al., 2022]. A custom loss function dynamically weighting RA and CA branch losses throughout the training process was deployed to better combine each contribution. It exploited the importance of the region boundary, by incorporating the distance-weighted map (DWM) factor into the formula. DWM was computed as the negative exponential function of the Euclidean distance transform (EDT) as:\n\n$DWM = (1+exp(-\\frac{EDT}{\\sigma}))$"}, {"title": "Classification network: Arthro-Net", "content": "The Arthro-Net (Fig.6) is a novel CNN architecture designed for multi-task, multi-class staging of GH osteoarthritic-related conditions. The network processes GH-centered patches and classifies the severity of each pathology according to predefined categories: three classes for osteophyte size (OS), three classes for joint space narrowing (JS), and two classes for the humeroscapular alignment (HSA). The Arthro-Net encoder is a sequence of convolutional/downsampling blocks to extract features at decreasing resolution up to the bottleneck. Each processing block embeds two sequences of convolutional with linear activation, batch normalization, and ReLU activation layers. The filter size and stride length are 3\u00d73\u00d73 and 1\u00d71\u00d71, respectively. This configuration is consistent with the CEL-UNet feature extractor, which captures relevant osseous characteristics from CT images Rossi et al. [2022]. However, the number of feature maps in the Arthro-Net doubles every two processing blocks (Fig. 6), to avoid unnecessary over-parametrization. Downsampling is performed through max-pooling layers with filter size and stride length of 2\u00d72\u00d72. According to state-of-the-art classification architecture Traore et al. [2018], a flatten layer was placed after the bottleneck to reshape the data into a one-dimensional tensor while preserving the total number of elements. Three separate fully connected branches, characterized by two consecutive dense layers with input sizes of 256 and 32, and a ReLU activation function, were added to specialize the network for each classification task. Each branch was preceded by a dropout layer to prevent overfitting and reduce sparsity, due to the large number of unique connections at this stage. The dropout rate was set to 0.6. Lastly, the three outputs consisted of one softmax layer each, with three, three, and two neurons, respectively. Categorical cross-entropy was chosen as the loss function. To balance the uneven training label frequency for each task, shown in Table 1, each loss function was weighted with a parameter Kc to balance the representation of every class, following Eq.4:\n\n$K_c = \\frac{1}{\\sum_1^C \\frac{1}{N_c}}$"}, {"title": "Network training and prediction pipeline", "content": "The CEL-UNet and Arthro-Net were trained separately for the two tasks using Tensorflow framework (v.2.14). The learning rate for the Adam optimizer was fixed to 1e-04. Nevertheless, segmentation and classification were sequentially performed in the prediction step, combining the two networks with a cascade approach (Fig.1). The CEL-UNet region identification output was processed by two custom algorithms. The first one is a marching cube-based method that generates the 3D humerus and scapula surfaces from the corresponding segmentation maps Cerveri et al. [2017]. The second creates a bounding box around the GH portion of the CT given the shoulder joint side (left or right) and the bone coordinates obtained in the previous step. The extracted sub-volume serves as the input for the Arthro-Net to classify osteoarthritic-related conditions. Training and testing procedures were performed on a 32-core CPU and NVIDIA A100-PCIE GPU with 40 GB RAM. Due to memory constraints, the batch size in the training was set to eight. Early stopping was used to prevent overfitting, stopping the training after 50 epochs with no improvement in validation loss. The total number of training epochs was 183."}, {"title": "Segmentation and classification quality assessment", "content": "The humerus and scapula segmentation performance on the test set was evaluated by comparing the CEL-UNet results (Dice and Jaccard indices) with those obtained by the state-of-the-art nnUNetIsensee et al. [2021]. The nnUNet was trained with two different loss functions, namely distance cross entropy (DCE) and focal (FOC) losses. Precision and recall were further computed to detect over- and under-segmentation errors. To evaluate 3D surface reconstruction accuracy, root mean squared error (RMSE) and Hausdorff distance were measured, capturing both average and maximum distances between predicted and reference volumes. For classification tasks, accuracy, precision, recall, F1-score, and confusion matrices were utilized to determine the optimal Arthro-Net architecture. Time evaluations were conducted across the automated pipeline steps, encompassing CT segmentation, 3D reconstruction, GH identification, and pathological condition staging. The statistical analysis of segmentation and 3D reconstruction outcomes was conducted using the Friedman test, followed by Wilcoxon Signed-Rank tests with Bonferroni correction for post-hoc analysis. This choice was driven by the features of the results: three paired sets with non-Gaussian distributions. Asterisk symbol (*) in Table 2 defines a statistically significant difference between the outcome distributions against the two other networks. Fig. 7 reports the unique differences between the CEL-UNet and the other models, a single asterisk (*) refers to a p-value < 0.05, while three (***) to a p-value < 0.001."}, {"title": "Results", "content": "Focusing on the humerus (Table 2 and Fig. 7), Dice and Jaccard distributions achieved with the CEL-UNet were statistically higher than the other two networks. CEL-UNet also outscored DCE-nnUNet on precision and FOC-nnUNet on recall, respectively. Considering the scapula, statistically significant differences demonstrated the superiority of the CEL-UNet over state-of-the-art architectures in terms of Dice, Jaccard, and precision indices. The highest recall value was found with the DCE-nnUNet instead. A qualitative comparison of humerus and scapula segmentation across the three networks (Fig. 8) highlighted the CEL-UNet's ability to capture osteophyte contours (A, B) and narrowed scapular anatomy (C) accurately. In this example, DCE- and FOC-nnUNet did not recognize the bone spur (A, B), and FOC-nnUNet exhibited under-segmentation issues (black arrow). The CEL-UNet achieved global RMSEs of less than 1 mm for both 3D reconstructed surfaces (Fig. 9). Median and IQR values were 0.22 (0.15-0.38) mm, 0.37 (0.22-0.77) mm, and 0.55 (0.29-0.78) mm for the humerus, and 0.16 (0.12-0.27) mm, 0.19 (0.13-0.36) mm, and 0.24 (0.15-0.54) mm for the scapula with CEL-UNet, DCE-nnUNet, and FOC-nnUNet, respectively. CEL-UNet statistically outscored the other networks. Statistical evidence was confirmed with Hausdorff distance errors, reporting median and IQR of 1.48 (0.97-2.26) mm, 2.56 (1.47-4.51) mm, and 4.68 (2.50-6.73) mm for the humerus, and 1.48 (1.13-2.56) mm, 2.22 (1.31-3.48) mm, and 2.63 (1.84-3.60) mm for the scapula. The qualitative examination of the 3D humerus and scapula reconstructed surfaces for a test set case example (Fig. 10) revealed the CEL-UNet proficiency in the reconstruction of irregular humeral head osteophytes (circled black area A), missed by DCE- and FOC-nnUNet. All three networks faced difficulties in accurately reconstructing the scapula, particularly around the superior angle. This region's highly variable and often sub-millimeter thickness poses a challenge for segmentation at standard voxel resolutions. Despite this, the CEL-UNet delivered superior reconstruction quality, especially in the subscapular fossa. The ablation study on Arthro-Net's key hyperparameters (number of processing blocks and feature maps), revealed two optimal design configurations (Table 3). The first one, named A(7, 48), featuring seven processing blocks and 48 initial feature maps (crf. Fig. 6), showed globally the best accuracy, precision, recall, and F1-score scores, ranging from 0.88 to 0.95 across the three classification tasks. Only the F1-score for HSA (0.88) was less than the corresponding score (0.90) in the design with 32 feature maps. The second one, B(8, 32), showed scores ranging from 0.83 to 0.94, greater than the other two competing configurations, while comparable with the previous design A. The further analysis, performed on the normalized confusion matrices computed for A and B designs (Fig. 11), was resolutive in choosing the optimal Arthro-Net configuration. The osteophyte size staging was better achieved with design A, correctly predicting each small-size bone spur and outscoring design B for the other sizes. Likewise, a perfect GH physiological joint space classification was obtained with design A, and non-detectable joint space was better identified as well. Design B instead prevails in the identification of narrow joint space and the detection of eccentric humeroscapular alignment. Concentric condition staging was better achieved with design A. According to such results, the final Arthro-Net was configured according to design A. As expected the OS recall was more accurate when detecting small (<3 mm) and large (>7 mm) osteophytes than osteophytes of intermediate size (3-7 mm) (Fig. 11). Likewise, the recall results of both physiological (100%) and non-detectable (93%) JS conditions were more reliable than the recall value of narrowed (80%) joint space. The classification of humeral head eccentricity was a little poorer (88%) than concentricity (95%)."}, {"title": "Deployment of the overall pipeline and inference speed", "content": "To validate the potential of translating the developed pipeline in clinical practice, the computational time of each operation was measured across the whole test set (Table 4). This included CT segmentation using the CEL-UNet, 3D reconstruction, glenohumeral region identification, and diagnostic classification using the Arthro-Net. Among these, segmentation, encompassing CT loading, preprocessing, and postprocessing, emerged as the most time-consuming step, with a median time of 9.2 s. Proximal humerus reconstruction time outpaced that of scapula reconstruction, taking 1.0 s (range: 0.65-1.7) versus 3.6 s (range: 2.9-4.6), owing to the smaller size of the analyzed bone segment. The humeral head patching algorithm time to identify the glenohumeral region was neglectable, while the classification took about 1 s. The cumulative median time for all processes amounted to 14.8 s, confirming a high-speed throughput underscoring the efficiency of the proposed cascaded multi-task approach making it potentially suitable for clinical diagnostic practice."}, {"title": "Discussion", "content": "In recent years, the use of deep learning algorithms for biomedical image processing has gained considerable attention in several key areas, including semantic segmentation for 3D anatomy reconstruction, morphological lesion analysis, and disease classification for clinical staging to aid diagnostics. However, much of the current literature is highly specialized, frequently focusing on just one of these domains at the time. In this work, a comprehensive automated framework for shoulder CT scan processing was developed and tested on a 571 retrospective dataset. It integrates the proximal humerus and scapula segmentation and 3D reconstruction, with the classification of three GH joint pathological conditions at various severity degrees. The outcomes showcased median root mean squared errors less than 0.5 mm for both bones, even in case of severe osteoarthritis, extensive morphological deformation, and inter-surface impingement (cfr. Fig. 7). The CEL-UNet segmentation results outscored state-of-the-art nnUNet models (crf. Fig. 9) Isensee et al. [2021], revealing an advantage on severe pathological joints (Fig. 8, 10). A novel CNN (Arthro-Net) was further proposed to achieve an automated staging of the GH osteophyte size, joint space, and the relative position between the humeral head and the glenoid surface, following the CEL-UNet-based segmentation. The ablation study allowed us to identify the optimal balance between network depth and feature map size. Configurations with fewer feature maps and depth often lack the complexity needed to accurately capture detailed anatomical features, leading to poorer performance. Conversely, deeper networks with more feature maps may suffer from overfitting. The optimal results from the ablation study delivered a configuration that strikes a balance between model complexity and accuracy, mitigating both under and overfitting. The classification accuracy was around 90% for all three class sets. A deterministic automated algorithm for the GH-centered patch extraction was implemented following shoulder segmentation, diverging from the conventional approach of integrating an additional deep learning model such as Mask-R-CNN, YOLO, or analogous object detection networks Anantharaman et al. [2018], Liu et al. [2023]. This approach streamlined the computational workflow and minimized potential errors introduced by inter-model dependencies."}, {"title": "Literature overview and limitations", "content": "Despite the recent advancements in automated image processing, several limitations persist in the existing literature, impacting the robustness, scalability, and clinical translation of the proposed methods. Many studies rely on relatively small datasets Schnider et al. [2022], Wong et al. [2023], Kim et al. [2024], raising concerns about the generalizability of their approaches, not adequately representing the variability found in real-world clinical scenarios. Other works Liu et al. [2020], Noguchi et al. [2020] analyze CT images from patients who are not engaged in preoperative planning contexts, resulting in datasets with less severe joint damage. This can lead to reduced scalability when applied to cases with significant pathological conditions. Additionally, a reported mean 3D reconstruction error exceeding 1 mm, as in Wong et al. [2023], Huang et al. [2022], renders a method less suitable for PSI-based preoperative planning frameworks, where high reconstruction accuracy is crucial Ogura et al. [2019], Anderl et al. [2016]. In Huang et al. [2022], the GH joint was reconstructed by deploying a SSM yielding to a mean surface RMSE of the humerus and scapula around 2 mm. A UNet-based glenoid segmentation model was trained and tested with a 237 CT scan dataset featuring patients with unilateral shoulder dislocations achieving an average intersection-over-union score of 0.96 Zhao et al. [2023a]. Nearly 100 MRIs were processed by AlexNet and UNet-based segmentation models to extract humerus, humeral head, and articular bone segmentation, reaching a positive predictive value of dice coefficient between 0.94 and 0.97 Wang and Han [2021b]. The GH joint deep learning-based analysis has been reported to address different acquisition modalities, pathological conditions, and shoulder morphological parameters. In Sezer and Basri Sezer [2020], the authors reported a CNN to automatically extract discriminative features from proton density MRI sequences, achieving about 98% success rate in classifying normal, edematous, and Hill-Sachs lesion humeral heads. However, the geometric relation between the humeral head and the glenoid surface was not investigated. A set of bone morphological parameters, including the glenoid inclination and the shoulder critical angle, were automatically assessed on about 1250 anteroposterior shoulder radiographs using a UNet model Shariatnia et al. [2022]. Nonetheless, the staging of potential osteoarthritic conditions of the GH was not computed. Finally, ensemble deep learning models were proposed to process X-ray images and assess fracture/non-fracture conditions in the shoulder area, featuring an accuracy of nearly 84% Uysal et al. [2021]."}, {"title": "Translational contributions and work limitations", "content": "From a translation point of view, we highlight two main potential contributions of this work. Firstly, the achieved median root mean squared errors below 0.5 mm renders the segmentation tool potentially suitable to be integrated into a PSI-based planning pipeline, delivering radiologists high-quality bone surfaces within a computation time-frame that aligns with clinical requirements Mars"}]}