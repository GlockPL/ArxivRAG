{"title": "High-Dimensional Fault Tolerance Testing of Highly Automated Vehicles Based on Low-Rank Models", "authors": ["Yuewen Mei", "Tong Nie", "Jian Sun", "Ye Tian"], "abstract": "Ensuring fault tolerance of Highly Automated Vehicles (HAVs) is crucial for their safety due to the presence of potentially severe faults. Hence, Fault Injection (FI) testing is conducted by practitioners to evaluate the safety level of HAVs. To fully cover test cases, various driving scenarios and fault settings should be considered. However, due to numerous combinations of test scenarios and fault settings, the testing space can be complex and high-dimensional. In addition, evaluating performance in all newly added scenarios is resource-consuming. The rarity of critical faults that can cause security problems further strengthens the challenge. To address these challenges, we propose to accelerate FI testing under the low-rank Smoothness Regularized Matrix Factorization (SRMF) framework. We first organize the sparse evaluated data into a structured matrix based on its safety values. Then the untested values are estimated by the correlation captured by the matrix structure. To address high dimensionality, a low-rank constraint is imposed on the testing space. To exploit the relationships between existing scenarios and new scenarios and capture the local regularity of critical faults, three types of smoothness regularization are further designed as a complement. We conduct experiments on car following and cut in scenarios. The results indicate that SRMF has the lowest prediction error in various scenarios and is capable of predicting rare critical faults compared to other machine learning models. In addition, SRMF can achieve 1171 acceleration rate, 99.3% precision and 91.1% F1 score in identifying critical faults. To the best of our knowledge, this is the first work to introduce low-rank models to FI testing of HAVs.", "sections": [{"title": "I. INTRODUCTION", "content": "Highly Automated Vehicles (HAVs) can greatly improve the safety, mobility, and efficiency of transportation [1]. However, ensuring the safety performance and resilience of HAVs has been a long-standing concern due to fatal accidents caused by HAVs. HAVs can be vulnerable and dangerous when exposed to faults caused by malicious attackers [2] or system malfunctions [3]. Malicious attackers are interested in creating a potential accident by tampering with the data in HAVs without authorization. For example, corrupting the hardware or software to force the HAVs to deviate from the lane [4]. Meanwhile, system malfunctions are frequently posed in complex HAVs. These minor faults can lead to severe consequences, such as collisions with obstacles. Hence, Fault Injection (FI) testing becomes a necessary verification and validation methods for HAVs [5]."}, {"title": "II. RELATED WORKS", "content": "Safety testing is crucial for HAVs before large-scale deployment. There are three verification and validation methods for HAV safety testing: scenario-based testing, formal verification, and FI testing [5]. However, testing scenarios and faults consist of a high-dimensional space and randomly selecting scenarios or faults for testing is inefficient [12]. Accordingly, to accelerate the HAVs safety testing process, surrogate models have been widely used.\nSurrogate models can approximate the testing results, thus saving tremendous testing resources, such as searching for critical faults [7], [13], finding faulty behavior from the parameter space [14], identifying high-risk scenarios [8], and discovering safety performance boundaries [15], [16]. Based on the summary of the machine learning methods commonly used as surrogate models, [17] compares the strengths and weaknesses of various surrogate models. However, the comparison clearly shows that Decision Trees, Random Forrest, Gradient Boosted Trees (such as Extreme Gradient Boosting), and Neural Networks are prone to overfitting. This leads to the surrogate models performing poorly in new scenarios that have not been tested before.\nLow-rank models are widely adopted to reconstruct high-dimensional data with low-dimensional structures. This kind of model assumes the algebraic structures of the observations and can reconstruct the unobserved data in a self-supervised way, without the need to collect a large amount of labeled training data. For example, visual data can be organized into a three-dimensional tensor, and missing pixels can be recovered with a low-rank solution. [9]. In the field of spatiotemporal traffic data, low-rank models garnered great interest in missing data imputation problems. Representative methods include tensor factorization [18], nuclear norm minimization [19], and matrix factorization [20]. In addition, they can be integrated with advanced machine learning frameworks to tackle more challenging tasks, such as deep learning architectures [21]\u2013[23] and surrogate modeling [24]."}, {"title": "III. PROBLEM FORMULATION", "content": "This paper considers three types of scenarios: functional scenario, logical scenario, concrete scenario in the scenario-based testing [25]. The functional scenario describes the participants and their behaviors within the scenario. The logical scenario parameterizes the scenario, by giving the definition, distribution, and range of the parameters. Then, in the concrete scenario, these parameters are precisely defined.\nWe denote k types of functional scenarios as $P_1, P_2, ..., P_k$ and each functional scenario $P_i$ has a parameter space containing $n_i$ parameters, which correspond to $n_i$ types of concrete scenarios denoted as $p_{i,n}$. Then we have:\n$\\begin{aligned} &|P_i| = n_i, \\forall i = 1, 2, ..., k\\\\ &P_i = \\{ P_{i,1}, P_{i,2},..., P_{i,n_i} \\} \\end{aligned}$"}, {"title": "IV. METHODOLOGY", "content": "The K scenarios can be divided into partially tested scenarios (existing scenarios) and completely new scenarios. In the concrete scenarios of functional scenario $P_i$, suppose that the proportion of faults that have been tested to the entire fault space is $r_i$. Meanwhile, only part of the concrete scenarios in $P_i$ are tested, and others are not tested at all. The existing concrete scenarios are distributed at equal intervals. For example, with an interval of 3, the proportion of tested faults in different concrete scenarios is:\n$(r_{i,1}, r_{i,2}, r_{i,3}, r_{i,4}, r_{i,5}, ...) = (r_i, 0, 0, r_i, 0, ...)$\nTo capture the relationship between existing scenarios and new scenarios from the two fault dimensions, the IJ faults injected into the K scenarios are folded as illustrated in Fig. 2. The scenarios are arranged by one fault parameter: fault injection time. For example, in the first part of the folded matrix, the fault injection time is the same while there are K types of scenarios with I types of fault value. Therefore, the safety indicators of different scenarios and faults can be formed as a matrix $X \\in \\mathbb{R}^{I \\times (JK)}$. The rows correspond to the I types of fault value, and the columns correspond to K scenarios with J types of injection time."}, {"title": "B. Smoothness regularized matrix factorization", "content": "In standard Low-Rank Matrix Factorization (MF) method, X is calculated by factorizing it into two low-rank factor matrices: $W \\in \\mathbb{R}^{R \\times I}$ for rows and $H \\in \\mathbb{R}^{R \\times M}$ for columns, where $M = JK$, $R \\leq min(I, M)$. Then, we can estimate the complete matrix $X$ from the low-rank matrix $W^T H$ with a reconstruction loss on the observed points:\n$\\min\\limits_{W,H} \\frac{1}{2} ||P_{\\Omega}(X - WH^T)||^2_F + \\frac{\\rho}{2} (||W||^2_F + ||H||^2_F)$\nwhere $\\rho$ is the weight parameters for regularization terms.\nThe rationale for low-rank models is to reconstruct the dominating features of the space. Both the scenario parameters and the fault parameters change successively. The safety indicators obtained by simulation testing with adjacent parameters are similar to each other. Then, the correlation in the high-dimensional testing space is significant. Therefore, low-rank assumptions can encourage the estimation of dominating patterns of fauthuse, thereby predicting the safety values of untested faults.\nThe MF model can capture the global pattern of the whole fault matrix. However, the local correlation within fault values (between adjacent rows) and fault injection time, scenarios (between adjacent columns) are neglected. To describe the local correlation, we add smoothness regularization and auto-regression in MF.\nThe fault injection time ranges from the beginning to the end of the scenario at a fixed time step, and the scenario parameters is similar in adjacent scenarios. The safety indicators are smoothly varied from one parameter to another. Therefore, in the columns representing scenarios and fault injection times, two smoothness regularization are designed to preserve the continuity between adjacent scenarios and adjacent fault injection time separately. We first formulate two difference operators as follows:\n$\\Psi_{r1} = [0_{(M-1)\\times 1}I_{M-1}] \u2013 [I_{M-1}0_{(M-1)\\times 1}]$\n$\\Psi_{r2} = [0_{(M-K)\\times K}I_{M-K}] \u2013 [I_{M-K}0_{(M-K)\\times K}]$\nwhere $\\Psi_{r1}$ represents the index of two adjacent scenarios with the same fault injection time. $\\Psi_{r2}$ signifies the index of two adjacent fault injection times of a single scenario.\nAccordingly, the difference of safety values in H can be formed as:\n$H\\Psi_{r1} = \\begin{bmatrix} h_2 - h_1 & | & ... & | & h_M - h_{M-1} \\end{bmatrix}$"}, {"title": "V. CASE STUDY", "content": "To verify the effectiveness of SRMF, two functional sce-narios are tested: cut in (denoted as $P_1$) and car following(denoted as $P_2$) in our experiment, as shown in Fig. 3. In thecar following scenario, the blue vehicle 1 behind controlledby HAV follows the leading vehicle 2. While in the cutin scenario, vehicle 2 controlled by HAV in the left lanepreparing to change lanes in front of vehicle 1.\nThe HAVs are controlled with the Intelligent Driver Model(IDM) and the IDM parameter is the same as that calibratedand defined in [8]."}, {"title": "E. Parameter tuning and analysis", "content": "To analyze the influence of key hyper parameters on the performance of SRMF, we compare the model performance under different parameter settings, as shown in Fig. 7. The hyper parameters include the rank of the matrix, the coefficients of smoothness regularization $\\lambda_1$, $\\lambda_2$, $\\lambda_3$. The MAE reaches its minimum when the rank is equal to 10 and tends to increase when the rank becomes greater than 10. For $\\lambda$, SRMF has the smallest MAE when $\\lambda_1$, $\\lambda_2$ is set to 1 and when $\\lambda_3$ equals 10. The MAE increases as the values of $\\lambda_1$, $\\lambda_2$, $\\lambda_3$ decrease (equal to 0.1), demonstrating that smoothness regularization is useful for improving model performance."}, {"title": "VI. CONCLUSIONS", "content": "Fault tolerance testing of HAVs is important and should be accelerated for the rapid development of HAVs due to the high-dimensional problem caused by numerous scenarios and faults. Surrogate models commonly employed to accelerate testing are prone to overfit in existing scenarios and might not detect rare critical faults. To overcome these problems, a new accelerated FI testing method based on SRMF is proposed. SRMF solves the high-dimensional problem by imposing the low-rank constraint and uses correlation between faults and scenarios to tackle the newly added scenario and the rare critical fault problem. It turns out that SRMF can perform well in new scenarios and is capable of identifying rare critical faults. The precision of SRMF is higher than 99% and the acceleration rate can reach 1171 times.\nThere are also several directions to explore in future research. First, the details of SRMF can be improved to tackle larger dimensions with more types of scenarios and faults. Second, SRMF, which acts as a surrogate model, can be combined with other existing method in HAVs safety acceleration testing to find more rare critical faults."}]}