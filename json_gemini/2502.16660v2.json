{"title": "BIOMAZE: BENCHMARKING AND ENHANCING LARGE\nLANGUAGE MODELS FOR BIOLOGICAL PATHWAY\nREASONING", "authors": ["Haiteng Zhao", "Chang Ma", "Fangzhi Xu", "Lingpeng Kong", "Zhi-Hong Deng"], "abstract": "The applications of large language models (LLMs) in various biological do-\nmains have been explored recently, but their reasoning ability in complex bio-\nlogical systems, such as pathways, remains underexplored, which is crucial for\npredicting biological phenomena, formulating hypotheses, and designing exper-\niments. This work explores the potential of LLMs in pathway reasoning. We\nintroduce BioMaze, a dataset with 5.1K complex pathway problems derived\nfrom real research, covering various biological contexts including natural dy-\nnamic changes, disturbances, additional intervention conditions, and multi-scale\nresearch targets. Our evaluation of methods such as CoT and graph-augmented\nreasoning, shows that LLMs struggle with pathway reasoning, especially in per-\nturbed systems. To address this, we propose PATHSEEKER, an LLM agent that\nenhances reasoning through interactive subgraph-based navigation, enabling a\nmore effective approach to handling the complexities of biological systems in\na scientifically aligned manner. The dataset and code are available at https:\n//github.com/zhao-ht/BioMaze.", "sections": [{"title": "1 INTRODUCTION", "content": "Large Language Models (LLMs) have recently demonstrated remarkable performance across scien-\ntific domains, including mathematics (Yu et al., 2023), chemistry (Liu et al., 2023b; Zhu et al., 2022),\nbiology (Hayes et al., 2024; Madani et al., 2020; Ma et al., 2023), and materials science (Zheng\net al., 2023; Park et al., 2024). In biology, LLMs have shown promise in addressing complex tasks\nsuch as protein design (Valentini et al., 2023; Hosseini et al., 2024), drug discovery (M. Bran et al.,\n2024; Liu et al., 2023c), clinical trial analysis (Singhal et al., 2023; Jin et al., 2023), and experiment\ndesign (AI4Science & Quantum, 2023; Roohani et al., 2024).\nWhile LLMs have been explored in various biological applications, their emerging capability for\nmulti-step reasoning\u2014extensively studied in fields like mathematics and programming (Wei et al.,\n2022; Wang et al., 2022; Kojima et al., 2022)\u2014remains underexplored in the context of complex,\nreal-world biological problems. In particular, little research has focused on how LLMs can under-\nstand and reason through the intricate, multi-step processes inherent to complex biological systems.\nBiological reasoning is challenging due to the intricate, long causal chains naturally and widely\npresent in biological systems. These systems are composed of complex networks called pathways,\nwhich involves genes, enzymes, substrates, and signaling molecules. Intervention in a single compo-\nnent\u2014such as mutations or infections\u2014can trigger multi-step cascades affecting other components\nwithin the organism. Pathway reasoning is essential for explaining phenomena, forming hypotheses,\ndesigning experiments, and interpreting results. For example, blocking muscarinic M3 receptors in\ntaste cells reduces calcium mobilization in Type II cells, weakens CALMH1-mediated ATP release,\nand diminishes taste responses in sensory fibers (Figure 1). Such insights aid in toxicity analysis,\nexperimental design, and treatments for taste disorders.\nIn this work, we evaluate the understanding and reasoning abilities of LLMs for biology tasks\nthrough the lens of biological pathways. We explore their potential applications in key pathway\nresearch areas, including functional understanding, dynamic changes, regulation, and intervention.\nTo support these investigations, we introduce a pathway benchmark, BioMaze, which comprises\n5.1K high-quality, complex biological pathway problems derived directly from real research liter-"}, {"title": "2 RELATED WORK", "content": "Biological Scientific Question Answering Previous studies have explored the potential of language\nmodels in the biological scientific domain (Lu et al., 2022; Vilares & G\u00f3mez-Rodr\u00edguez, 2019; Jin\net al., 2021; Pal et al., 2022), such as biological scientific reading comprehension (Welbl et al.,\n2018; Jin et al., 2019) and question-answering (Krithara et al., 2023). A few studies have examined\nlanguage models' ability to complete biological pathways (Li et al., 2023b; Park et al., 2023; Azam\net al., 2024). Different from previous tasks, this work introduces biological pathway reasoning in\nrealistic research scenarios. See Appendix A.12 for a more detailed comparison.\nGraph-augmented Language Model Several studies have explored augmenting LLMs with graph\ndata. In particular, some works enhance LLMs by encoding graph data as text (Ye et al., 2023;\nWang et al., 2024; Fatemi et al., 2023), or tuning LLMs specifically for graph-based tasks (Liu et al.,\n2023a; Tang et al., 2024; He et al., 2024; Zhao et al., 2023; He & Hooi, 2024). Augmented LLMs\nhave been applied to knowledge-based QA (Sun et al., 2023; He et al., 2024; Li et al., 2023a; Jin\net al., 2024; Cheng et al., 2024; Edge et al., 2024) and graph tasks like property prediction (Wang\net al., 2024; He et al., 2023). Some studies leverage graph structures for complex reasoning tasks"}, {"title": "3 BENCHMARK: BIOMAZE", "content": "3.1 DATASET CREATION\nBioMaze is created by generating question-answer pairs from biological pathway research papers,\nwhich are then checked and filtered through a combination of automated methods and expert human\nreview. The dataset creation process involves prompting large language models, with GPT-4 and\nLLaMA3.1-405B (Dubey et al., 2024) being selected for data generation in this study.\nTo gather relevant biological pathway questions in realistic scientific research contexts, particularly\nthose involving interventions, the data for BioMaze is sourced from over 6,000 biological pathway\nresearch papers. These studies include carefully designed experimental interventions supported by\npathway mechanisms to observe biological system responses. After extracting detailed experimental\nobservations and their contexts, we convert each one into either a True/False or open-ended question,\ndepending on its content. Each question is paired with corresponding labeled answers.\nWe then apply multiple data filters and human expert reviews to ensure the accuracy and quality\nof the questions. The accuracy of each question is validated by comparing it with the content of\nthe original paper. Question quality is ensured through several filters that remove questions that\nare poorly defined, ask for specific measurement values, query more than one fact, are trivial (with\nanswers revealed in the question's context), or are unrelated to biological pathways.\nFinally, all questions are reviewed by human experts based on quality dimensions and their judgment\nto ensure overall question quality. The passing rate for expert review is approximately 40%. After\napplying all filters, BioMaze contains 5.1k high-quality questions. More details are provided in\nAppendix A.2.\nThe questions of BioMaze cover a wide range of biological domains, as illustrated in Figure 2 (left)."}, {"title": "3.2 REASONING TYPE CATEGORIES", "content": "To study various research scenarios in biological pathways, such as natural dynamic changes, dis-\nturbances and interventions, and additional intervention conditions, as well as a multi-scale under-\nstanding of single factors, action processes, and macroscopic functions, we classify BioMaze tasks\nfrom three dimensions, namely inquiry type, extra condition, and investigation target, as shown in"}, {"title": "3.3 PATHWAY GRAPH AUGMENTATED REASONING", "content": "Text-only reasoning methods, such as Chain-of-Thought (CoT), generate reasoning based on the\ninherent knowledge of LLMs. However, biological pathways present unique challenges due to\ntheir graph-structured nature. Consequently, using graph-augmented LLM reasoning is a natural\napproach for BioMaze. Providing explicit pathway graphs can serve as structural blueprints, en-\nhancing reasoning from both knowledge and planning perspectives. We formalize this problem as\nfollows:\n$a = G(E, o)$,\nwhere G represents the language model, & denotes the task instruction (including the question), \u03bf\nrefers to the observation from the augment pathway graph database, and a is the model output which\ncould be the reasoning and answer.\nPathway Graph Database To augment LLMs with reasoning in biological pathways, we created a\npathway graph database based on KEGG (Kanehisa & Goto, 2000), a collection of pathway maps on\nmetabolism and various cellular and organismal functions widely-used resource among biologists.\nWe compiled all available pathway networks and maps from KEGG and integrated all of them into\na single pathway graph database. The statistics for the pathways are in Appendix A.4. Each entry"}, {"title": "4 METHOD: PATHWAY REASONING AGENT PATHSEEKER", "content": "As we evaluated several graph-augmented reasoning methods, we found that current graph-\naugmentation methods' performance is limited by their ineffective utilization of the pathway graph\ndatabase for reasoning. Inspired by how scientists browse pathway networks during reasoning, we\npropose PATHSEEKER, a reasoning agent method that can interactively conduct reasoning and take\nactions to perceive and navigate pathways using a web-like engine, along with flexible reasoning in\neach step, as shown in Figure 3.\nAt each step, t, the language agent G can conduct reasoning by natural language thought, and\ntakes an action step $a_t$, based on problem E (problem instructions) and previous observation-action\ntrajectory $h_t = [o_1, A_1, ..., o_{t\u22121}, a_{t-1}, o_t]$,\n$a_t = G(E,h_t)$\nGlobal and Local Subgraph Navigation In addition to the global subgraph retriever\nSearch_Subgraph, PATHSEEKER has access to an additional neighbor subgraph retriever,\nNeighbor_Subgraph(line_id, query, N), which retrieves an optimal connected subgraph of tar-\nget size from the multi-hop neighbors of a previously observed pathway step line_id.\n$Neighbor_Subgraph (line_id, query, N) =$\n$argmax_{SCPid, S is connected, |S|=N} \\sum_{iEVSUES} score(i, query)$"}, {"title": "5 EXPERIMENT", "content": "5.1 BASELINE AND METRIC\nWe evaluate the reasoning performance of LLMs on BioMaze in both the unaugmented step-by-step\nreasoning and the pathway graph-augmented methods. We adopt reasoning method without graph\naugmentation Chain-of-Thought (CoT) (Wei et al., 2022; Kojima et al., 2022), and methods with\npathway graph augmentation: Chain-of-Knowledge (CoK) (Li et al., 2023a), Think-of-Graph (ToG)\n(Sun et al., 2023), and G-Retriever (He et al., 2024). Details of baselines are in Appendix A.7.\nFor True/False tasks, we compute accuracy averaged across the True and False labels to account for\nlabel imbalance in the dataset. For open-ended tasks, the LLM is used to evaluate the accuracy of\ngenerated answers by comparing them to the ground truth and determining whether they are correct\nor incorrect. In this study, we use the LLaMA3.1-405B model as the evaluator, with five in-context\nexamples. The performance of the evaluator is further analyzed in Appendix A.9.\n5.2 MAIN RESULT\nWe evaluate PATHSEEKER and baseline methods on BioMaze, presenting results in Tables 2 and 3.\nThe comparison covers task dimensions including signal source, additional conditions, and target.\nThe results lead to the following conclusions:\nLLMs struggle with biological pathway reasoning. Pathway reasoning tasks in BioMaze are\ntough for LLMs, with True/False accuracy slightly above random. Both CoT and graph-augmented\nreasoning reveal the gap between LLM capabilities and the complexity of biological systems.\nPerturbation query in BioMaze presents significant challenges. LLMs perform worse with per-\nturbed inquiry settings than normal ones, especially in True/False and open-ended formats. This\nsuggests that reasoning about biological pathways is harder in intervention scenarios, where the"}, {"title": "5.3 ANALYSIS", "content": "Backbone Ability for Pathway Reasoning We compare the performance of different backbones in\nFigure 4. As the model size and capacity increase, overall performance improves, indicating a strong\ncorrelation between an LLM's general reasoning ability and its performance in pathway reasoning.\nHowever, a consistent gap remains between the normal/perturbed and natural/intervened settings\nacross different backbones. This underscores the inherent limitations of LLMs in reasoning about\ncausal relationships within biological pathways.\nReasoning Difficulty with Steps To explore the relationship between task difficulty and reasoning\nsteps in BioMaze, we prompted LLaMA3.1-405B to explain its reasoning process based on the\ncorrect answer and pathway to get the step numbers.\nFigure 5 shows that Chain-of-Thought (CoT) performance declines as reasoning steps increase,\nsuggesting that more steps lead to higher reasoning difficulty. This supports our hypothesis that the\ncomplexity of the pathways is one factor of challenges in biological pathway reasoning.\nNotably, PATHSEEKER's performance remains more consistent across different reasoning step\ncounts. This suggests that augmenting LLMs with biological pathway information can mitigate the\nchallenges of pathway reasoning, particularly when dealing with intricate intermediate processes."}, {"title": "5.4 METHOD ANALYSIS AND ABLATION STUDY", "content": "API Usage and Step Distribution We analyze PATHSEEKER's agent behavior by reviewing task\nsteps and API usage. Tables 4 and 5 show that most tasks are completed in six or fewer steps,\nthough some require over ten due to missing pathway data. On average, the agent performs 1.5\nglobal searches and over three local navigations per task, indicating frequent subgraph exploration.\nAblation Study To evaluate PATHSEEKER's components, we perform ablation studies, with results\nfor LLaMA3-8B in Table 6. The most important component is FinalReaser; without it, the agent's\nanswers degrade due to long task history. The local search API is also crucial for efficient graph nav-\nigation, and the graph encoding method improves performance, highlighting the value of encoding\ngraph data for sequential models."}, {"title": "6 CONCLUSION", "content": "In this study, we introduce BioMaze, a benchmark designed to evaluate LLMs' ability to under-\nstand and reason about biological pathways. Extensive evaluations using BioMaze, incorporating\nadvanced methods like CoT and graph-augmented approaches, show that LLMs struggle with un-\nderstanding pathway mechanisms. We also propose PATHSEEKER, a novel LLM agent that uses\ninteractive subgraph exploration to enhance reasoning in biological pathways."}, {"title": "A APPENDIX", "content": "A.1 DATASET CASE ILLUSTRATION\nDimension 1: Inquiry Type\nCategory 1: Normal Source\nQuestion: In the context of YopT-induced cleavage of Rho GTPases, is carboxyl methylation a\nnecessary post-translational modification for the cysteine protease activity of YopT to occur?\nAnswer: No\nQuestion: In U2OS-hGR osteosarcoma cells, does the glucocorticoid receptor (GR)-dependent\nmRNA expression of ladinin 1 require the presence of both Mediator subunits MED1 and MED14\nfor transcriptional regulation in response to dexamethasone treatment?\nAnswer: Yes\nQuestion: In pancreatic acinar cells, How does the sensitivity to nicotinic acid adenine dinucleotide\nphosphate (NAADP) compare to the sensitivity to cyclic adenosine 5'-diphosphate-ribose (cADPR)\nand inositol trisphosphate (InsP3) in terms of triggering Ca2+ release?\nAnswer: Pancreatic acinar cells are significantly more sensitive to NAADP than to either cyclic\nadenosine 5'-diphosphate-ribose (cADPR) or inositol trisphosphate (InsP3).\nQuestion: In the context of Mycobacterium tuberculosis signal transduction, what is the effect of\nTrcS-phosphate and calcium ions (Ca2+) on the transphosphorylation of the response regulator pro-\ntein TrcR?\nAnswer: TrcS-phosphate and Ca2+ are required for the transphosphorylation of TrcR.\nCategory 2: Perturbed Source\nQuestion: In the context of human papillomavirus type 16 (HPV16) E7 gene product's role in cel-\nlular transformation, can a transcriptionally inactive c-Jun deletion mutant that retains E7 binding\ncapability interfere with the E7-induced transformation of rat embryo fibroblasts when co-expressed\nwith an activated ras oncogene?\nAnswer: Yes\nQuestion: In HTLV-1-infected T-cell lines, does the application of short interfering RNA (siRNA)\ntargeting JunD result in an increase in matrix metalloproteinase-7 (MMP-7) mRNA expression?\nAnswer: No\nQuestion: In the context of opioid withdrawal, how does blocking A1-adenosine receptors with\n8-cyclopentyl-1, 3-dipropylxantine affect the response to mu-opioid receptor activation on the am-\nplitude of GABAB-mediated IPSPs in slices taken from morphine-treated guinea pigs?\nAnswer: Blocking A1-adenosine receptors with 8-cyclopentyl-1, 3-dipropylxantine allows mu-\nopioid receptor activation to inhibit the IPSP at all concentrations and increases the maximal in-\nhibition in withdrawn slices.\nQuestion: In 3T3-L1 adipocytes, What is the effect of platelet-derived growth factor treatment on\nthe tyrosine phosphorylation of APS?\nAnswer: Platelet-derived growth factor treatment results in no APS phosphorylation.\nDimension 2: Extra Condition\nCategory 1: Natural Condition\nQuestion: In the context of Kaposi's sarcoma-associated herpesvirus (KSHV) infection, can viral\ninterleukin-6 (vIL-6) induce the up-regulation of DNA methyltransferase 1 (DNMT1) in endothelial\ncells independently of signal transducer and activator of transcription 3 (STAT3) activation?\nAnswer: No"}, {"title": null, "content": "Question: In BJAB cells, does the expression of the K5 protein, encoded by the Kaposi's sarcoma-associated herpesvirus (KSHV), lead to a reduction in the surface expression of intercellular adhe-sion molecule 1 (ICAM-1)?\nAnswer: Yes\nQuestion: In human hepatoma HuH-7 cells, What is the effect of transient expression of the HepatitisC virus (HCV) core protein on the trans-activation ability of the cellular putative RNA helicase CAP-Rf?\nAnswer: Transient expression of HCV core protein in human hepatoma HuH-7 cells potentiates thetrans-activation effect of CAP-Rf on gene expression.\nQuestion: In Caenorhabditis elegans, What is the effect of being heterozygous for the cet-1 gene onbody length compared to wild-type and null mutant individuals?\nAnswer: Heterozygotes for cet-1 display body lengths ranging between null mutant and wild type.\nCategory 2: Intervened Condition\nQuestion: In the Edar signalling pathway, can NF-kappaB activation still be induced by Edar-associated death domain (Edaradd) in the presence of dominant negative forms of TNF-receptor-associated factor 6 (TRAF6)?\nAnswer: No\nQuestion: In mice treated with the angiotensin-converting enzyme inhibitor ramipril, do those lack-ing the specific PACAP receptor (PAC1-/-) exhibit lower plasma renin concentrations compared totheir wild-type littermates?\nAnswer: Yes\nQuestion: In human lung cancer cell lines with methylated retinoic acid receptor-beta (RARbeta)P2 promoter, What is the effect of demethylation by 5-aza-2'-deoxycytidine on the expression ofRARbeta2 and RARbeta4 isoforms?\nAnswer: Demethylation by exposure to 5-aza-2'-deoxycytidine restores the expression of RARbeta2and RARbeta4 in methylated tumor lines.\nQuestion: In the context of hematopoietic progenitor cell proliferation, What is the effect of Flt3ligand (FL) on progenitor cells from mice deficient in the signal transducer and activator of tran-scription 5a (Stat5a)?\nAnswer: Flt3 ligand (FL) does not act on progenitors from marrows of Stat5a(-/-) mice.\nDimension 3: Investigation Target\nCategory 1: Single Component as Target\nQuestion: In MELN cells, which are derived from MCF-7 breast cancer cells and stably expresstestrogen receptor alpha (ERalpha), does exposure to mono-n-butyl ester phthalic acid result in anincrease in vascular endothelial growth factor (VEGF) secretion?\nAnswer: No\nQuestion: In the context of non-alcoholic fatty liver disease (NAFLD) induced by a choline-deficient, ethionine-supplemented (CDE) diet in C57BL/6J mice, is the protein level of peroxisome-proliferator-activated receptor-gamma coactivator 1alpha (PGC1alpha) decreased in comparison tocontrol livers?\nAnswer: Yes\nQuestion: In the context of Mycobacterium tuberculosis signal transduction, what is the effect ofTrcS-phosphate and calcium ions (Ca2+) on the transphosphorylation of the response regulator pro-tein TrcR?\nAnswer: TrcS-phosphate and Ca2+ are required for the transphosphorylation of TrcR."}, {"title": null, "content": "Question: In the context of myeloma cells, What is the effect of elevated heparanase expression onthe expression levels of urokinase-type plasminogen activator (uPA) and the uPA receptor?\nAnswer: Elevation in heparanase expression in myeloma cells increases urokinase-type plasminogenactivator (uPA) and uPA receptor expression levels.\nCategory 2: Components Interaction as Target\nQuestion: In the context of growth hormone-releasing hormone (GHRH) stimulation of growth hor-mone (GH) gene expression in anterior pituitary somatotrophs, does the CBP-Pit-1 pathway, whichinvolves the interaction between CREB binding protein (CBP) and the pituitary-specific transcrip-tion factor Pit-1, require the presence of cAMP-response element binding protein (CREB) to mediateits effects on the human GH promoter?\nAnswer: No\nQuestion: In the context of mitophagy, does the ubiquitin-binding protein RABGEF1 play a role inrecruiting the downstream Rab GTPases, RAB5 and RAB7A, to damaged mitochondria that havebeen ubiquitinated by Parkin?\nAnswer: Yes\nQuestion: In human lung cancer cells treated with the nitrosamine 4-(methylnitrosamino)-1-(3-pyridyl)-1-butanone (NNK), What is the role of Bcl2 phosphorylation at Ser(70) in the interactionbetween Bcl2 and c-Myc oncogenic proteins?\nAnswer: Phosphorylation of Bcl2 at Ser(70) promotes a direct interaction between Bcl2 and c-Myc,enhancing the half-life of the c-Myc protein.\nQuestion: In cells infected with Epstein-Barr virus (EBV), How does the BGLF4 protein kinaseaffect the recruitment of active interferon regulatory factor 3 (IRF3) to the IRF3-responsive elementcontaining the interferon-beta (IFN-beta) promoter region?\nAnswer: BGLF4 reduces the amount of active IRF3 recruited to the IRF3-responsive element con-taining the IFN-beta promoter region.\nCategory 3: Function as Target\nQuestion: In human hepatoma cells (Huh-7) and normal human hepatocytes (Hc) infected with anadenovirus expressing a mutated form of IkappaBalpha (Ad5IkappaB), does pretreatment with N,N-dimethylsphingosine (DMS), an inhibitor of sphingosine kinase (SphK), lead to an increase in thenumber of apoptotic cells induced by tumor necrosis factor-alpha (TNF-alpha) stimulation?\nAnswer: Yes\nQuestion: In Escherichia coli, do mutants lacking acyl-acyl carrier protein (acyl-ACP) synthetaseactivity (aas mutants) retain the ability to incorporate exogenous fatty acids into the major outermembrane lipoprotein through an acyl-CoA-independent pathway?\nAnswer: No\nQuestion: In the context of myocytes expressing adiponectin receptor 1 (AdipoR1), What is theeffect of adiponectin on extracellular calcium (Ca2+) influx?\nAnswer: Adiponectin induces extracellular Ca(2+) influx by adiponectin receptor 1 (AdipoR1) inmyocytes.\nQuestion: In the context of lung inflammation resolution, What is the role of cholesterol 25-hydroxylase (Ch25h) in alveolar macrophages (AM) during the resolution phase of inflammation?\nAnswer: Ch25h is induced in macrophages upon their encounter with apoptotic cells and is requiredfor LXR-dependent prevention of AM lipid overload, induction of Mertk, efferocytic resolution ofairway neutrophilia, and induction of TGF-beta."}, {"title": "A.2 DATA CREATION AND FILTER PIPELINE", "content": "The overall dataset creation pipeline is shown in Figure 7."}, {"title": "A.3 QUESTION KEY WORDS DISTRIBUTION", "content": "We present the distribution of question keywords in Figure 8. While these keywords do not directlycorrespond to the three main categories we primarily use, they offer an additional perspective on thedataset. Below are explanations of the keywords:\nGeneral Influence Inquiry: Can x influence y or not?\nActivation Inquiry: Can x activate y?\nInhibition Inquiry: Can x inhibit y?\nDependency Inquiry: Is y dependent on x?\nInduction Question: Can x induce y?\nRelief Inquiry: Can x relieve y?\nMechanism Question: Does x influence y via a specific mechanism?"}, {"title": null, "content": "Exclusive Mechanism Question: Is a specific mechanism the only mechanism for process z?\nSignificance Inquiry: Will x cause a significant/insignificant phenomenon y?\nBaseline Comparison Question: Is x different from the baseline?\nExperimental Observation Question: Will a specific detailed phenomenon be observed in the exper-iment?\nPhysiological Observation Question: Will a specific phenomenon be observed in the body?"}, {"title": "A.4 PATHWAY GRAPH DATABASE STATISTICS", "content": "Table 7: Data statistic of our pathway network database.\nEntries Edges Involved biological process\n8939 15131 2265"}, {"title": "A.5 IMPLEMENTATION OF SUBGRAPH RETRIEVER", "content": "Since the connectivity of the pathway graph is crucial for enhancing reasoning in biological sys-tems, we developed the retrieval API designed to find the optimal connected subgraph S* =Search_Subgraph(query, N), where S* is the retrieved subgraph, query represents the querycontent, such as keywords, and N is the target size. The goal is to match a given target size asclosely as possible while maximizing the matching score. This is formulated as a optimizationproblem:\n$S* = Search_Subgraph(query, N) = $\n$argmax_{SCP,|S|=N,\\ EVSUES, S is connected} \\sum score(i, query)$\nHere, the overall pathway network is denoted by P, with Vs and Es representing the node and edgesets of subgraph S.\nThe optimization problem is hard to solve directly for huge graph databse. Inspire by He et al.(2024) that convert optimal subgraph problem into a Prize-Collecting Steiner Tree (PCST) problem,we solve the problem as a bi-level optimization as follows:\n$S(Ce) = argmax_{SCP,\\sum_{iEVSUES} score(i, query) \u2013 |Es| \u00d7 Ce}$"}, {"title": null, "content": "$C_e = argmin||S(C_e)| \u2013 N|$\nThen\n$Search_Subgraph(query, N) = S(C^*_e)$\nThe inner optimization problem, a Prize-Collecting Steiner Tree (PCST) problem, seeks to identifya connected subgraph that maximizes the total score of its nodes and edges while minimizing theedge costs, as utilized in (He et al., 2024). The outer optimization problem minimizes the differencebetween the optimal subgraph size and the target size. In practice, we apply a fast-solving methodfor the inner problem proposed by (Hegde et al., 2015) and employ a binary root search algorithmfor the outer problem.\nGraph-to-Text Encoder For retrieved results which is a list of triples (e.g., the output ofSearch_Triple or Search_Subgraph), the result S is encoded into text o using the following process:\no = TripleToText(DFSOrder(S))\nFunction DFSOrder arranges the triples in depth-first search (DFS) order. Unlike other methods,such as relevance scoring, DFS order more closely aligns with the reasoning process through thesubgraph, reflecting the natural progression of biological functions. The ordered subgraph S isconverted into text format for the LLM by encoding each triple as a string in the following format:Head Tail Relation and Biological Process."}, {"title": "A.6 PATHSEEKER CASE", "content": "Please explore pathways to find relevant information regarding\nthe following question: Worldwide, one of the most prevalent\nforms of chronic disease is alcoholic fatty liver, which may\nprogress to more severe forms of liver injury. Chronic ethanol\nexposure is thought to cause enhanced hepatic lipogenesis and\nimpaired fatty acid oxidation. Adiponectin is an adipose-derived\nhormone that has been associated with the development of\nalcoholic liver steatosis in rodent models. Does adiponectin have\na protective role against alcoholic liver steatosis?\nAction: Thought: To find information regarding the role of\nadiponectin in protecting against alcoholic liver steatosis, I\ncan use the search_biopathway_subgraph_global tool to explore\nrelevant biological pathways. I should convert all the question\ncontent into keywords to enhance retrieval quality. Action:\nsearch_biopathway_subgraph_global(['Adiponectin,\nadipose-derived hormone, associated with the development of\nalcoholic liver steatosis in rodent models, protective role\nagainst alcoholic liver steatosis, chronic ethanol exposure,\nenhanced hepatic lipogenesis, impaired fatty acid oxidation,\nliver injury'])\nEnd Action\nState: 0) C00469: Ethanol; Ethyl alcohol; Methylcarbinol |\n406999: microRNA 217 MIR217 MIRN217 mir-217 | PCrel indirect\neffect activation | hsa04936: Alcoholic liver disease\n1) 406999: microRNA 217 MIR217 MIRN217 mir-217 | 23411: sirtuin 1\nSIRT1 SIR2 SIR2L1 SIR2alpha | PPrel inhibition indirect effect |\nhsa04936: Alcoholic liver disease\n2) 406999: microRNA 217 MIR217 MIRN217 mir-217 | 29896 6434:\nTRA2A AWMS1 HSU53209 | PPrel inhibition indirect effect |\nhsa04936: Alcoholic liver disease\n3) 29896 6434: TRA2A AWMS1 HSU53209 | 23175 64900 9663: LPIN1\nPAP1 PPrel activation | hsa04936: Alcoholic liver disease\n4) 23175 64900 9663: LPIN1 PAP1 | 6720: sterol regulatory element\nbinding transcription factor 1 SREBF1 HMD IFAP2 SREBP1 bHLHd1 |\nPPrel inhibition | hsa04936: Alcoholic liver disease"}, {"title": null, "content": "5) 6720: sterol regulatory element binding transcription factor 1SREBF1 HMD IFAP2 SREBP1 bHLHd1 | 6319 79966: SCD FADS5 MSTP008SCD1 SCDOS HSCD1 | GErel expression | hsa04152: AMPK signalingpathway hsa04936: Alcoholic liver disease\n6) 6720: sterol regulatory element binding transcription factor 1SREBF1 HMD IFAP2 SREBP1 bHLHd1 | 23175 64900 9663: LPIN1 PAP1 |GErel expression | hsa04936: Alcoholic liver disease\n7) C00469: Ethanol; Ethyl alcohol; Methylcarbinol | 51094 79602:ADIPOR1 ACDCR1 CGI-45 CGI45 PAQR1 TESBP1A | PCrel inhibitionindirect effect | hsa04936: Alcoholic liver disease\n8) C00469: Ethanol; Ethyl alcohol; Methylcarbinol | 51422 536325562 5563 5564 5565 5571: PRKAG2 AAKG AAKG2 CMH6 H91620p WPWS |PCrel inhibition indirect effect | hsa04936: Alcoholic liverdisease\n9) C00469: Ethanol; Ethyl alcohol; Methylcarbinol | 50507: NADPHoxidase 4 NOX4 KOX KOX-1 RENOX | PCrel activation | hsa04936:Alcoholic liver disease\n10) 50507: NADPH oxidase 4 NOX4 KOX KOX-1 RENOX | C22381:Reactive oxygen species; ROS | PCrel activation | hsa04936:Alcoholic liver disease\n11) C22381: Reactive oxygen species; ROS | 51422 53632 5562 55635564 5565 5571: PRKAG2 AAKG AAKG2 CMH6 H91620p WPWS | PCrelinhibition indirect effect | hsa04936: Alcoholic liver disease\n12) C22381: Reactive oxygen species; ROS | 10000 207 208: \u0391\u039a\u03a43MPPH MPPH2 PKB-GAMMA PKBG PRKBG RAC-PK-gamma RAC-gamma STK-2 |PCrel inhibition | hsa04936: Alcoholic liver disease\n13) 10000 207 208: AKT3 MPPH MPPH2 PKB-"}]}