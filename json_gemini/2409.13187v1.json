{"title": "Cooperative Resilience in Artificial Intelligence Multiagent Systems", "authors": ["Manuela Chacon-Chamorro", "C\u00e9sar Gonz\u00e1lez", "Luis Felipe Giraldo", "Juan Sebasti\u00e1n Pinz\u00f3n", "Daniel G\u00f3mez-Barrera", "Nicanor Quijano", "Vicente Vargas-Panesso", "Rub\u00e9n Manrrique", "Manuel R\u00edos", "Yesid Fonseca", "M\u00f3nica Perdomo-P\u00e9rez"], "abstract": "Resilience refers to the ability of systems to withstand, adapt to, and recover from disruptive events. While studies on resilience have attracted significant attention across various research domains, the precise definition of this concept within the field of cooperative artificial intelligence remains unclear. This paper addresses this gap by proposing a clear definition of 'cooperative resilience' and outlining a methodology for its quantitative measurement. The methodology is validated in an environment with RL-based and LLM-augmented autonomous agents, subjected to environmental changes and the introduction of agents with unsustainable behaviors. These events are parameterized to create various scenarios for measuring cooperative resilience. The results highlight the crucial role of resilience metrics in analyzing how the collective system prepares for, resists, recovers from, sustains well-being, and transforms in the face of disruptions. These findings provide foundational insights into the definition, measurement, and preliminary analysis of cooperative resilience, offering significant implications for the broader field of AI. Moreover, the methodology and metrics developed here can be adapted to a wide range of AI applications, enhancing the reliability and effectiveness of AI in dynamic and unpredictable environments.", "sections": [{"title": "1 Introduction", "content": "Understanding how systems withstand and adapt to adversity has become a focal point for researchers. This capability is referred to as resilience. The concept of resilience has been extensively explored across various domains, ranging from game theory [1-4], artificial intelligent (AI) systems [5-9], engineering [10-12], psychology [13-18], economy [19-21], social science [22, 23], network science [24-26], dynamical systems theory [27, 28], and ecology [29-31]. Particular interest lies in understanding how systems that involve collective action, whether from humans, machines, or both, exhibit resilience as an emergent property from their interactions. These systems are encompassed within the domain of cooperative AI.\nCooperative AI systems operate in complex, dynamic environments [32]. Interactions with various actors, whether human or machine, add further complexity and uncertainty. This makes them more susceptible to disruptions and failures, as they must continually adapt to changes while maintaining efficient responses [6,11, 25]. Consequently, understanding and transferring the concept of resilience from other domains to cooperative AI systems is crucial. Doing so can inspire the development robust AI architectures and methodologies [33]. Emphasizing resilience ensures that these systems remain adaptable and persistent in the face of disruptions.\nWhile the concept of resilience has been studied extensively across various domains, its definition in the context of cooperative AI problems remains unclear. This situation represents a need not only to contribute"}, {"title": "2 Defining Cooperative Resilience", "content": "Several key factors from definitions of resilience across various disciplines contribute to defining cooperative resilience. The essence of defining resilience lies in identifying the resilient entity (who?), the actions that define resilience (what is it?), and recognizing the disruptive event (to what?). These key questions, along with their corresponding keywords, are illustrated in Fig. 1. This figure summarizes a review of resilience concepts across various fields and demonstrates the broad scope of the concept across multiple disciplines\u00b9.\nIn the figure, fields are represented as blue nodes, while the guiding questions are shown as nodes in orange (who?), green (to what?), and purple (what is it?). The edges illustrate the relationships between the fields and these questions, as well as the interdisciplinary connections of the concept.\nFor instance, in ecology, resilience is related to verbs such as absorb, transform, and respond [30]. It encompasses elements such as resistance and latitude, representing the extent to which a system can be"}, {"title": "Definition 1", "content": "Cooperative resilience is the ability of a system, involving the collective action of individuals \u2014whether humans, machines, or both\u2014 to anticipate, prepare for, resist, recover from, and transform in the face of disruptive events that threaten their joint welfare."}, {"title": "3 Measuring Cooperative Resilience", "content": "Once the definition of Cooperative Resilience has been proposed, it is essential to establish a consistent measurement approach. This section proposes a methodology that comprehensively captures all aspects of the concept. It is important to note that resilience, as outlined in Definition 1, depends on the random nature of disruptive events. This randomness is characterized by the probability of occurrence $(p_s)$ and the probabilistic magnitude of impact $(v_s)$. These parameters are related to risk and vulnerability and could be associated with various sources depending on the system. Therefore, the measure is determined by the realization of the random disruptive event, and this realization, based on specific values of $p_s$ and $v_s$, is referred to as a scenario.\nThe proposed methodology consists of four stages summarized in Fig. 2. In the first stage, we begin by assessing a group of autonomous agents engaged in collective actions. Variables related to collective well-being are identified and measured, for instance resource availability, resource distribution, resource sustainability, or in general variables related to the welfare of the agents. These variables, specific to the problem at hand, will serve as the basis for calculating resilience. We measure these variables under normal conditions (reference curve) and during disruptions (performance curve). The reference behavior is not necessarily an ideal behavior. Rather, the goal in this stage is to compare the system's behavior with and without disruptions.\nIn the second stage, we recognize that systems often face successive adverse events over time. We assume that disruptions occur sequentially. To capture resilience at a specific moment, the system's response to all previous disruptions is analyzed within defined time windows, considering the timing of event occurrence, failure, and recovery. Resilience is then calculated within each window by comparing the performance and reference curves. This process allows for detailed assessment of how the system behaves before, during, and after each disruption.\nThis summary value is denoted as $J_{ji}$ (variable j and disruptive event 1) and is calculated by the metric described in [34]. The metric involves identifying the failure profile, which relates to the speed and magnitude of the system's degraded behavior after the disruptive event. Additionally, it also takes into account the recovery profile, considering the speed and stabilization of the system following the disruptive event.\nThe equation relating to the calculation of the summary metric denoted as $J_{ji}$ is as follows in Equation (1):\n$J_{jl} = \\frac{t_i + F_{jl}\\Delta t_f + G_{jl}\\Delta t_r}{t_i + \\Delta t_f + \\Delta t_r}, $\nwhere $F_{il}$ corresponds to the failure profile, and $G_{ji}$ represents the recovery profile. $\\Delta t_f$ and $\\Delta t_r$ denote the failure and recovery event duration, computed as $\\Delta t_f = t_f - t_i$ and $\\Delta t_r = t_r - t_f$. The terms $t_i$, $t_f$, $t_r$ respectively represent the time of the incident occurrence, the time of failure when the performance deteriorates to the lowest point, and the recovery time, where it is assumed the system should reach a stable state. Total recovery is not necessarily expected, but the time $t_r$ is set as a reference to consider the recovery progress.\nThe method for calculating the failure and recovery profiles is as follows:\n$F_{jl} = \\frac{\\int_{t_i}^{t_f} P_{il}(t)dt}{\\int_{t_i}^{t_f} R_{il}(t)dt}$ and $G_{jl} = \\frac{\\int_{t_f}^{t_r} P_{il}(t)dt}{\\int_{t_f}^{t_r} R_{il}(t)dt}$\nThese profiles are positive measures. Values close to 1 indicate that observed and expected behaviors are nearly identical, suggesting minimal deviation from the reference interval. Values below 1 indicate performance below expectations, while values above 1 demonstrate behavior exceeding expectations for the performance curves. For this analysis to be meaningful, it is crucial that the well-being variables have a positive interpretation, meaning higher values correspond to better well-being.\nAt the conclusion of this stage, for each variable the summary metrics for all L disruptive events are computed, resulting in a set of $J_{ji}$ index by variable and disruptive event."}, {"title": "3.1 Stage I: Performance and reference Curves", "content": "The objective of this stage is to define and measure variables related to collective well-being. Initially, we assume that there are N interacting agents, depicted as circles in Fig. 2. This stage entails defining K"}, {"title": "3.2 Stage II: Computed summary metrics", "content": "The purpose of this stage is to derive metrics that summarize resilient behavior for each adversity across time intervals and for each measured variable. The performance and reference curves are defined for the entire observation period [to, tf]. Within this period, smaller time windows are used to isolate and analyze each disruptive event, as illustrated in the orange plane of Fig. 2. Resilience metrics are calculated by comparing the performance curve with the reference curve for each time window. This process allows for detailed assessment of how the system behaves before, during, and after each disruption.\nThis summary value is denoted as Jji (variable j and disruptive event 1) and is calculated by the metric described in [34]. The metric involves identifying the failure profile, which relates to the speed and magnitude of the system's degraded behavior after the disruptive event. Additionally, it also takes into account the recovery profile, considering the speed and stabilization of the system following the disruptive event.\nThe equation relating to the calculation of the summary metric denoted as Jji is as follows in Equation (1):\n$J_{jl} = \\frac{t_i + F_{jl}\\Delta t_f + G_{jl}\\Delta t_r}{t_i + \\Delta t_f + \\Delta t_r},$\nwhere $F_{il}$ corresponds to the failure profile, and $G_{ji}$ represents the recovery profile. $\\Delta t_f$ and $\\Delta t_r$ denote the failure and recovery event duration, computed as $\\Delta t_f = t_f - t_i$ and $\\Delta t_r = t_r - t_f$. The terms $t_i$, $t_f$, $t_r$ respectively represent the time of the incident occurrence, the time of failure when the performance deteriorates to the lowest point, and the recovery time, where it is assumed the system should reach a stable state. Total recovery is not necessarily expected, but the time tr is set as a reference to consider the recovery progress.\nThe method for calculating the failure and recovery profiles is as follows:\n$F_{jl} = \\frac{\\int_{t_i}^{t_f} P_{il}(t)dt}{\\int_{t_i}^{t_f} R_{il}(t)dt}$ and $G_{jl} = \\frac{\\int_{t_f}^{t_r} P_{il}(t)dt}{\\int_{t_f}^{t_r} R_{il}(t)dt}$\nThese profiles are positive measures. Values close to 1 indicate that observed and expected behaviors are nearly identical, suggesting minimal deviation from the reference interval. Values below 1 indicate performance below expectations, while values above 1 demonstrate behavior exceeding expectations for the performance curves. For this analysis to be meaningful, it is crucial that the well-being variables have a positive interpretation, meaning higher values correspond to better well-being.\nAt the conclusion of this stage, for each variable the summary metrics for all L disruptive events are computed, resulting in a set of Jji index by variable and disruptive event."}, {"title": "3.3 Stage III: Time-window assembly", "content": "The proposed definition of resilience emphasizes transformation, suggesting that more resilient systems improve their behavior in response to disruptive events. Systems that adapt and learn from disruptions become better prepared for future occurrences, enhancing their ability to anticipate and respond to new events. Conversely, systems that fail to recover from disruptions may become more sensitive to future events, leading to decreased resilience. During this stage, efforts focus on penalizing behaviors where the system fails to transform between disruptive events, reducing resilience over time. Conversely, rewarding occurs when the system demonstrates improved resilience across events. Averaging across consecutive time-windows is proposed, penalizing decreases and incrementally rewarding increases. Therefore, the proposed metric rewards systems that not only recover and adapt but also show measurable improvements in well-being indicators, enhancing their ability to anticipate and manage future disruptions.\nFor each variable and across all disruptive events, a single metric J; (with j \u2208 1 \u2264 j \u2264 K is computed. In the initial iteration of the calculation, it is performed as follows:\n$\\frac{(J_{kt} + J_{k(l+1)})}{2} (1 + (J_{k(l+1)} \u2013 J_{kt}))$.\nThe resulting metrics undergo an iterative process, consolidating into a single value. Negative variations indicate decreasing factors of the summary metric across successive disruptive events. If a negative variation results in a negative value, we apply saturation, forcing the value to zero. Conversely, positive variations, which indicate an increase in resilience through disruptive events, are saturated at 1 if they exceed this value.\nThis stage is represented in the green plane of Fig. 2. At the conclusion of this stage, we obtain a measure Jk, which represents the resilience assembly for agents and disruptive events in a specific scenario."}, {"title": "3.4 Stage IV: Variables assembly", "content": "So far, we have the set {J1,\u2026\u2026,JK} of summary metrics, one for each variable. However, coupling is necessary to generate a single metric across all K variables. Typically, coupling summary metrics involves averaging or using a weighted average. However, since each indicator represents a component associated with well-being, it is expected that the coupling should penalize low values in the set, indicating poor performance in some variables. Therefore, the harmonic mean is proposed as the coupling metric. This stage is represented in the blue plane of Fig. 2, where at the end of this stage, a single measure J is obtained, representing the measure of resilience assembly among agents, disruptive events, and variable for well-being."}, {"title": "4 Case Studies", "content": "The objective of this section is to measure cooperative resilience in AI multiagent systems, and investigate how cooperative resilience manifests when these systems are subjected to disruptive events. To achieve this, used Melting Pot 2.0 [40], a research tool designed to study multi-agent AI systems. The specific scenario chosen is referred to as 'Commons Harvest Open,' where multiple agents inhabit a confined space containing trees laden with apples. The objective for each agent is to consume as many apples as possible. Consumed apples regenerate with a probability per step that depends on the number of remaining apples on the tree. If all the apples on a tree are consumed, the tree vanishes. In this scenario a social dilemma might arise, when all apples are depleted from a tree, no further apples with grow and this goes in detriment of the entire population.\nCurrently, the primary metrics used to evaluate system performance in such scenarios focus on the number of resources consumed by the agents. However, this is insufficient to fully understand the dynamics at play, especially in a context where external disruptive conditions can significantly impact collective welfare. The social dilemma emulated in this scenario requires a deeper evaluation that considers not just resource consumption, but also how agents anticipate, prepare, resist, recover and transform from these disruptions. This underscores the need for a cooperative resilience metric that can assess how the system face of adversity.\nTo systematically assess resilience, we introduce two distinct disruptive events. As per the definition, events should pose a risk to the joint-welfare of the agents. The first disruptive event involves the sudden removal of apples from the environment, simulating resource depletion and testing the agents' ability to"}, {"title": "4.1 Reinforcement Learning-based agents", "content": "The PPO algorithm [47], a gradient-based optimization method aimed at maximizing the expected return of policies, is employed to train the agents using RL. The training is conducted using independent RL for each agent. This resulting in each agent possessing its own policy parameterized by its own neural network.\nThe architecture of the network for each agent consisting of a feedforward neural network with two hidden layers, each with 64 neurons and ReLU activation function. This neural network is connected to another network that features a single hidden layer with 1280 neurons, also utilizing the ReLU activation function.\nThe total training process span 1.280.000 steps, with mean duration episode 1500 steps. The training process took a total of 769 episodes. For training, the reward function of the problem is defined as 1 if an apple was eaten and 0 otherwise at each step. The agents are capable of executing the following actions: moving up, down, right, or left, rotating right or left, or shoot a laser beam that relocated agents within its range to a distant position from the apples."}, {"title": "4.2 Large Language Model-augmented agents", "content": "To work with an LLM in the decision-making process of each agent, we develop an adapter that converts the spatial observations received by each agent into textual observations that are comprehensible for a language model, specifically GPT-4. This process is divided into two parts: first, a converter is developed to transform the visual information into ASCII format, representing what each agent perceives about the environment at any given moment in real-time. Subsequently, this information is transformed into detailed textual descriptions of what is observed by each agent within their field of vision.\nTo integrate the adapter for working with an LLM in the decision-making process of each agent, the architecture \"Generative Agents\" proposal in [48] is used. The architecture consists of a memory module, a perception module, a planning module, a reflection module, and an action module. Fig. 3 shows a diagram of the modules comprising it. It is important to note that each module of the architecture is structured around a prompt directed at the language model, utilizing engineering practices of prompting that follow specific guidelines, similar to those applied in projects such as MetaGPT and AutoGPT. The prompts incorporate relevant details of each agent, adapting to current observations and pertinent memories.\nFurthermore, the \"Chain of Thought\" methodology [49], except for the action module, is employed to structure the responses, enhancing the model's capability to reason and generate coherent outputs. Regard-ing the module responsible for action execution and decision-making within the simulated environment, an"}, {"title": "4.3 Evaluation of cooperative resilience", "content": "In the previously described environment, the phases of the methodology are followed to establish a value of cooperative resilience with both RL and LLM decision-making systems. The evaluation is conducted for a set of experiments proposed in the two disruptive events. Below are the detailed parameters of the experiments conducted."}, {"title": "4.3.1 First type of disruptive events: apple disappearance", "content": "To cover various scenarios related to the probability of occurrence of a disruptive event and its probabilistic magnitude, the probability of the disruptive event occurring is fixed at certain points in the simulation, with ps = 1 at specific moments and ps = 0 at others. For the impact level, the event iterates through each apple and removes this with a probability corresponding to \u03c5s, ensuring that at least one apple remains on each tree. Three probabilistic values for \u03c5s are considered, leading to nine scenarios described in the Table 2, the cells in the table with darker hues indicating higher disruption."}, {"title": "4.3.2 Second type of disruptive events: unsustainable bots", "content": "In the second disruptive event, unsustainable bots are introduced into the simulation. These bots are introduced at a standardized point: the 10th round in LLM or the 100th time-step in RL. The impact of this disruption is evaluated based on the duration of the bots' interaction with the environment. Three levels of disruption are considered: E1: Bots interact for 25 time-steps in RL and 5 rounds in LLM. E2: Bots interact for 50 time-steps in RL and 10 rounds in LLM. E3: Bots interact for 75 time-steps in RL and 15 rounds in LLM.\nThese duration intervals are chosen to ensure a proportionate comparison of the disruption impact across both approaches. In the case of LLM-agumented agents, one round consists of all the steps in which agents execute their plan in turns. The bots were configured to move only half the time within a round, meaning they do not move every step but alternate instead. The evaluation of cooperative resilience employs the same variables as the previous disruptive event."}, {"title": "4.4 Discusion of the Results", "content": "The results from both types of disruptive events highlight the complex dynamics that influence the system's resilience. These findings underscore the need for a broader understanding of how varying magnitudes and frequencies of disruptive events affect the final value of cooperative resilience. While additional experiments could enhance the accuracy of the cooperative resilience metric, the current methodology effectively captures resilience by focusing on the process of confronting disruptions, an aspect often overlooked by traditional metrics in AI multiagent systems. This approach is particularly valuable for studying AI systems prone to failures, as it addresses the impact of disruptions and highlights the agents' adaptive responses. Despite these complexities, the methodology can be appropriately applied to these experiments, establishing a cooperative resilience value that aligns with the definition outlined in this document."}, {"title": "5 Conclusion and Future Work", "content": "In this article, we have introduced the concept of cooperative resilience in cooperative AI, a notion proposed after analyzing the definition of resilience across various domains and aligning it with the concepts and scope of cooperative AI. This contribution not only try to unify the terminology within cooperative AI, but also aligns with interdisciplinary research efforts to understand emergent resilience in complex systems. Following the establishment of this definition, we have proposed a methodology designed to quantify cooperative resilience consistently with the defined concept. This methodology aims to estimate resilience in cooperative AI systems with the aim of enhance or comparing this value in future studies.\nThe proposed methodology is applied to and validated in experiments using Melting Pot 2.0, specifically the 'Common Harvest Open' scenario, employing both RL and LLM approaches for the control of agents. Two sets of experiments were conducted, one involving a disruptive event related to vanished apples at some point, and the other involving a disruptive event associated with the inclusion of bots. Under varying conditions of disruptive events, the value of cooperative resilience is determined in 9 experiments in the first case and in 3 experiments in the other disruptive event. The interplay of factors contributing to system resilience is underscored by the results, revealing instances where unexpected recovery patterns are demonstrated by the systems. Notably, the observation that resilience can sometimes increase with the number of disruptive events or vary with the magnitude of disruption, challenges conventional ideas and suggests a complex adaptive capacity inherent in these systems. These results, while preliminary, provide a foundation for deeper investigation into the dynamics of cooperative resilience and highlight the need for a broader range of experiments to understand the behavior of resilience.\nMoreover, this research opens avenues for interdisciplinary collaboration, drawing parallels with resilience studies in ecology, psychology, network science, and other domains. Such collaborations can enrich our understanding of resilience as a multi-faceted concept and foster the development of more resilient cooperative AI systems.\nFuture research should aim to expand the experimental framework to encompass a broader range of scenarios and disruptive events. Applying the developed methodology to experiments involving human performance could also enable comparisons between machine-only decision-making and human-machine interactions, providing valuable insights into cooperative resilience. Furthermore, a deeper exploration of the factors contributing to the emergence of resilience would be beneficial. Inverse problem approaches, such as inverse games and inverse reinforcement learning, can help uncover the underlying motivations driving resilient behaviors, facilitating their replication and enhancing resilience properties in AI systems."}]}