{"title": "Decentralized Federated Anomaly Detection in Smart Grids: A P2P Gossip Approach", "authors": ["Muhammad Akbar Husnoo", "Adnan Anwar", "Md Enamul Haque", "A. N. Mahmood"], "abstract": "The increasing security and privacy concerns in the Smart Grid sector have led to a significant demand for robust intrusion detection systems within critical smart grid infrastructure. To address the challenges posed by privacy preservation and decentralized power system zones with distinct data ownership, Federated Learning (FL) has emerged as a promising privacy-preserving solution which facilitates collaborative training of attack detection models without necessitating the sharing of raw data. However, FL presents several implementation limitations in the power system domain due to its heavy reliance on a centralized aggregator and the risks of privacy leakage during model update transmission. To overcome these technical bottlenecks, this paper introduces a novel decentralized federated anomaly detection scheme based on two main gossip protocols namely Random Walk and Epidemic. Our findings indicate that the Random Walk protocol exhibits superior performance compared to the Epidemic protocol, highlighting its efficacy in decentralized federated learning environments. Experimental validation of the proposed framework utilizing publicly available industrial control systems datasets demonstrates superior attack detection accuracy while safeguarding data confidentiality and mitigating the impact of communication latency and stragglers. Furthermore, our approach yields a notable 35% improvement in training time compared to conventional FL, underscoring the efficacy and robustness of our decentralized learning method.", "sections": [{"title": "I. INTRODUCTION", "content": "The widespread adoption of Internet of Things (IoT) technology and advanced communication protocols within the Smart Grid (SG) paradigm has led to a significant surge in data volumes generated from edge devices. This vital power-related data play a crucial role in various key operations of the grid including demand management, grid monitoring and control, fault detection and isolation, etc. Consequently, the management of the overall grid infrastructure can be carried out more dynamically and efficiently. However, the increasing heterogeneity, diversity, and complexity within the power grid ecosystem present significant challenges to its integrity. Ensuring data integrity is now a priority for modern power systems due to the ubiquity of modern cyber-physical power grid components and advancements in information technology, which enable data processing and decision-making at the edge, as opposed to traditional cloud storage-based control centers.\nOn another hand, whilst the digitisation of the modern-day power systems has mitigated the response issues to the ever-growing demand for energy, smart grids are still prone to several technical bottlenecks. Driven by the massive amounts of sensitive data generated, a wide range of the cyber-physical components of the SG have become potentially susceptible to zero-day cyber vulnerabilities by malicious actors, including but not limited to False Data Injection Attacks (FDIA), Time Synchronization Attacks, etc. Hence, it is preemptive to leverage state-of-the-art technological advances to develop effective countermeasures which defend SGs against such types of intrusions. Consequently, the use of Machine Learning and Deep Learning (DL) has emerged as driving technologies behind several breakthroughs in grid sabotage detection due to their ability to identify relevant complex patterns from diverse data sources.\nDespite their impressive contributions, such centralized anomaly detection schemes suffer from several drawbacks which include limited storage capabilities, communication network overhead and, foremost, privacy issues. Experts often disregard the fact that grid information contains sensitive data which carries potential privacy risks during transfer to centralized repositories for analytical tasks. Thus, to tackle such impediments, training deep learning models in a distributed fashion, essentially Federated Learning (FL) garnered momentum as a potential privacy-preserving alternative which enables edge-based on-device training without the need of sharing raw data thus mitigating the associated privacy risks. For instance, one of our previous works [1] in similar line proposed a computationally-efficient privacy-preserving federated scheme to differentiate between anomalous events and system disturbances. Other studies [2]-[4] have similarly leveraged FL techniques for misbehaviour detection within SG ecosystems. Such literature have explored the effectiveness of FL at detecting irregularities and deviations from normal operating conditions, thus, reinforcing the security and resilience of power grids.\nHowever, traditional FL-based intrusion detection schemes, whilst being focussed on its client-server-centric design principles as shown in Fig. 1A, exhibits certain drawbacks that impede its practical implementation within real-world power system scenarios. One such limitation is the blind reliance of client nodes on a centralized aggregator to coordinate the learning process and aggregate local model updates. This may"}, {"title": "A. Conventional FL-based Anomaly Detection & its Limitations", "content": "Since its inception, FL has established itself as an emerging discipline that has achieved promising results in various SG-related applications whereby privacy is paramount. Taik and Cherkaoui [6] introduced FL to the SG domain by training a LSTM model on a real-world Texas load consumption data to highlight the effectiveness of FL and its privacy-preserving guarantees in a demand load forecasting scenario. Another work in [7] proposed a horizontal federated load forecasting solution for Retail Energy Providers and achieved sufficient forecasting performance using the Solar Home Electricity Data from Ausgrid. Following its success, multiple studies including [8]-[10] continued in similar directions.\nGiven its prominence and optimal results within demand forecasting, FL swiftly gained momentum in other facets of power systems, in particular, anomaly detection. For instance, researchers in [3] developed a federated temporal convolutional network for identifying power theft. Through comprehensive data-driven experiments using a real-energy consumption dataset, they asserted that their federated framework can attain high detection accuracy with reduced computational overhead. Similarly, Ashraf et al. [11] attained comparable performance for energy theft detection by validating federated conventional machine learning algorithms on real-world datasets. The works in [1], [12] proposed computationally-efficient differentially-private federated schemes to differentiate between anomalous events and system irregularities. Furthermore, authors in [13]\u2013[15] developed FL-based frameworks for the detection of False Data Injection attacks in power systems with sufficient performance. More recently, to mitigate the effects of straggler client nodes and communication inefficiency in relation to conventional FL, the works in [16]\u2013[18] proposed semi-asynchronous FL-based anomaly detection frameworks to discriminate between cyberattack events and natural power system disturbances which yielded improved attack detection performance and improved robustness versus stragglers.\nWhilst conventional FL has proved its effectiveness in the area of anomaly detection for power systems, it comes with inherent limitations that necessitate further investigations. One such major drawback is its heavy reliance on a centralized aggregator which introduces potential privacy and security hazards during the transmission of sensitive model updates to and from client nodes. Furthermore, the communication overhead associated with the bi-directional transmission of model gradients from numerous edge devices to the central aggregator can be computationally expensive, thus leading to scalability issues, particularly in scenarios with a large number of client nodes or when operating in resource-constrained environments. Hence, it is imperative to devise a solution to address these technical bottlenecks."}, {"title": "B. Decentralized Federated Anomaly Detection", "content": "In the context of power system scenarios, the novelty of Decentralized Federated Learning (DFL) emerges as a vital solution to overcome the aforementioned technical challenges associated with conventional FL-based anomaly detection. DFL is a recently surfaced machine learning paradigm which combines the principles of FL with a decentralized architecture. In conventional FL, a central aggregator orchestrates the model training process by aggregating model updates from multiple client nodes. In contrast, model training is distributed across multiple client nodes during DFL. Each node independently trains a local model using its own data and periodically exchanges model updates or gradients with other client nodes within the network. In the context of power systems, Giuseppi et al. [19] devised a decentralized version of FederatedAveraging (DecFedAvg) algorithm for non-intrusive load monitoring in smart energy communities and validated the effectiveness of their innovative approach using REFIT dataset which yielded low Mean Absolute Error (MAE) values. Another work by Gao et al. [20] presented a DFL-based residential building load forecasting framework with a gradient selection mechanism and achieved a 97% accuracy on Pecan Street Dataset. Remarkably, only a limited number of studies have explored the use of DFL within the smart grid domain with a notable absence of studies specifically addressing the issue of anomaly detection. This evident gap in existing literature highlights the need for additional investigation, prompting our motivation. Therefore, this manuscript aims to address this gap by proposing a novel approach to anomaly detection in power systems by decentralizing the FL process using a gossip-based approach to eliminate the dependency on a centralized aggregator."}, {"title": "III. PROPOSED METHOD", "content": "Throughout this section, we will initially present the system model considered for this scenario followed by a discussion of our proposed DFL-based anomaly detection framework."}, {"title": "A. Power System Model & Assumptions", "content": "Throughout this manuscript, we consider a geographically sparse and decentralized electrical grid system that is segmented into N number of power grid regions where $N \\in \\mathbb{R}^{+}$. As depicted in Fig 2, we briefly introduce the primary actors of power system model as in the following: 1) SCADA Sub-systems: The SCADA sub-systems are the edge-based client nodes equipped with sophisticated data acquisition technological capabilities which play a very crucial role in gathering and overseeing the electrical data sensed by each IoT-based device (including relays, Remote Terminal Units (RTUs), etc.) within a power grid region. Furthermore, the SCADA sub-systems will function as the DFL nodes whereby they will each be training a model locally using their own data repository and update the one-bit quantized model updates to selected peers within the network. Lastly, the SCADA sub-systems are responsible for the aggregation of the received updates from their peers with their own local model parameters. For this given scenario, we assume that the SCADA sub-systems are honest-but-curious, i.e, they strictly adhere to the protocols of DFL without exhibiting malicious behaviours to ensure data integrity and privacy, model quality, fairness, etc. 2) Grid Regions: The power grid regions are equipped with a variety of decentralized monitoring sensoring devices including relays, synchrophasors, RTUs, etc. and are responsible for the continuous sensing of grid-related data such as current phase angle, voltage magnitude, etc. The Intelligent Electronic Devices (IEDs) are presumably connected to the SCADA sub-systems via high speed data transmission networks built upon DNP3/IEC 61850 protocols. Furthermore, we assume that the grid regions are interconnected for operational purposes using wireless mesh networking protocols including Zigbee, etc."}, {"title": "B. Proposed Anomaly Detection Mechanism", "content": "As previously mentioned in Section II above, previous works in similar field have employed a number of anomaly detection techniques including statistical approaches, traditional ML algorithms, DL neural networks, etc. However, in this manuscript, we formulate the problem of cyber attack detection using a Transformer-Autoencoder (TAE) model as illustrated in Fig. 3. TAEs are powerful hybrid neural networks that combines the elements of both transformer and autoencoder models, leveraging the strengths of sequence modelling and representation learning, with the objective of achieving identity mapping between inputs and outputs, whilst capturing complex patterns and dependencies from the data [21]. Autoencoders learn representations in data by passing an input data vector $V_i$ through an encoder $f_a$ which maps each input $v_i$ to a latent space representation $r^{(i)}$ which is essentially a low-dimensional and compressed knowledge representation of the original input such that $r^{(i)} = f_a(v_i) = \\alpha(Wv_i + b)$ where $\\alpha$ is an element-wise activation function, $W$ is the weight matrix and $b$ is the bias vector of the encoder. On the other hand, the decoder $g_a$ is responsible for the reconstruction of the original input $v_i$, with minimal reconstruction error, from $r^{(i)}$ through $v_j = g_a(v_i) = \\alpha(W'v_i + b')$ where $v_j$ is the reconstructed input (output of decoder). During the federated training process, the model parameters $W$, $W'$, $b$ and $b'$ are iteratively improved to optimize the reconstruction error $l(v_i, v_j)$ such that $\\alpha, \\alpha' = \\text{argmin}_{\\alpha,\\alpha'} l(v_i, v_j)$.\nOur proposed TAE model architecture consists of two symmetrical components, namely, the encoder and the decoder, each comprising of a mixture of Feed Forward Neural Network (FFNN) layers and transformer layers, which utilize self-attention mechanisms to capture dependencies between input tokens and model long-range interactions. These transformer layers enable effective sequence modeling and feature extraction which is crucial for identifying complex patterns indicative of anomalies in the data. Each layer within the TAE facilitates communication between its preceding and succeeding layers, serving as a hidden layer to the previous nodes and a visible one to the subsequent nodes. During learning, the parameters of the model, including weight and bias, are adjusted to minimize the reconstruction error, which serves as an indication of the existence of anomalies. Leaky Rectified Linear Unit (ReLU) is used as the activation function for its robustness against noisy and sparse data while Mean Squared Error (MSE) is chosen as the reconstruction error metric for the measurement of anomaly degree. An anomaly threshold $\\tau$ is established by initially sorting the anomaly degrees in increasing order and selecting the optimal value of $\\tau$ at the point of inflection in the error distribution. Furthermore, soft-max layers are incorporated at the end of the TAE layers stack to enable the prediction of attack labels based on learned representation. The training batch size and the learning rate are both configured to 100 and 10-3 respectively. This model serves as the cornerstone for power systems anomaly detection in this manuscript."}, {"title": "C. Gradient Quantization", "content": "During federated training, the canonical objective of the TAE model is minimize the objective function $\\text{argmin}_{\\alpha,\\alpha'} l(v_i, v_j)$. Typically, the search for the optimal parameter values of this objective function within a FL/DFL set-up can be accomplished by employing several optimization algorithms including Stochastic Gradient Descent (SGD), Adam, etc. However, due to the requirement of bi-directional communication amongst grid regions, the size and frequency of the local gradient updates increases which hinders the scalability of our proposed approach to increasing number of grid regions. Additionally, the sharing of raw model updates poses significant privacy risks to such a critical system, this non-conformant to confidentiality guarantees of FL [5].\nTherefore, to overcome such technical bottlenecks, we propose to employ a gradient quantization scheme, specifically DP-SIGNSGD [1], which approximates the TAE model gradients into low-precision values to reduce communication bandwidth. After aggregation with previous model updates, each decentralized grid region k executes a zero-mean normalization of its computed gradient $g_k$ such that $\\tilde{g}_k = \\frac{g_k - \\mu_k}{\\sigma_k}$ for uniform distribution, followed by a compression of the normalized gradients by each grid region k through a one-bit differentially-private quantizer which eventually captures the sign of $\\tilde{g}_k$, such that $\\hat{g}_k = dpsign(\\tilde{g}_k)$. The quantized gradient $\\hat{g}_k$ from one grid region is then sent to a randomly selected neighbour node. The latest model gradient is achieved by updating the new weight parameters such that $W_{t+1} = W_t - \\eta_t \\hat{g}_k$ where $\\eta_t \\in (0, 1)$ represents the learning rate. This gradient quantization technique, as detailed in Algorithm 1, significantly decreases the byte size of the gradient updates exchanged during the gossip-based model training."}, {"title": "D. Gossip-based DFL Framework", "content": "As presented in Fig. 2, throughout our manuscript, we focus a geographically decentralized region-wise power grid system which is interconnected with wireless technologies. The primary objective of the decentralized federated anomaly detection scenario is to collaboratively train the global TAE model across the participating grid clients without the need to transmit local model updates to a centralized server for aggregation. Let $D_k = \\{ a_i, b_i \\}_{i=1}^{N_k}$ denote the training dataset for a specific grid region $k \\in [K]$ where $N_k = |D_k|$ represents the number of data points for each $D_k$. It is crucial to note that the data distributions are Non-IID, mirroring real-world intrusion detection scenarios. Hence, the objective function $f_k$ for a shared global TAE model parameter $W \\in \\mathbb{R}^M$ can be expressed as $f_k(W) = \\frac{1}{N_k} \\sum_{i=1}^{N_k} l( \\{a_i, b_i \\}; W)$. Here, $l(.): \\mathbb{R}^M \\times \\mathbb{R} \\rightarrow \\mathbb{R}$ represents the loss function to be optimized for data point $(a_i, b_i)$. In addition, the global objective function F across all k can be expressed as $F(W) = \\sum_{k=1}^{K} f_k(W)$ which is the sum of the local loss functions for each k, where N is the total data points for training.\nIn order to enable the federated discrimination of cyber attack events from non-anomalous natural power system disturbances, we propose to implement two types of gossip protocols:\n1) Random Gossip: This proposed gossip approach randomly selects client nodes within a network for communication. During each communication round, each k computes its local gradient $f_k(Z_t)$ using its training dataset $D_k$ and aggregates this gradient with that received from a randomly chosen peer node. This aggregated gradient is then normalized and quantized before being transmitted to another randomly selected peer node. This process repeats iteratively, facilitating decentralized communication and collaboration among nodes.\n2) Epidemic Gossip: Epidemic approach, on the other hand, operates on the principle of spreading information to all client nodes within a network. Each k communicates with a fixed subset of its neighboring k, known as its Epidemic Radius. Similar to random gossip, nodes compute, aggregate, normalize, and quantize gradients before transmitting them to neighboring nodes. However, unlike random gossip, Epidemic gossip ensures that each node eventually receives the information from all other nodes in the network and is implemented for contrastive empirical purposes.\nBy leveraging random gossip, nodes can efficiently exchange information without requiring explicit knowledge of the network topology. This enhances scalability and adaptability to changes in network conditions. On the other hand, Epidemic gossip ensures that all nodes eventually receive the information, thereby promoting information dissemination and consensus among nodes. As discussed in Section IV, we will compare and contrast the two implemented protocols to identify the superior one.\nDuring a particular communication round $t^{th}$, our proposed decentralized federated anomaly detection, as presented in Algorithm 1 constitutes of five specific implementation steps as discussed in the following: 1) Each grid region $k \\in [K]$ computes its local gradient $g_k = f_k(W_t)$ using its training dataset $D_k$ and the current global model parameter $W_t$. 2) Each k then performs a majority-vote based aggregation and summation of the computed gradient $g_k$ along with the previous gradient $g_k^{t-1}$ received from the previous peer such that $\\sum_{i=k-1}^{N_k} g^{agg}$. 3) The aggregated gradient $g^{agg}$ is then normalized through zero-mean normalization such that $g^{norm} = g^{agg} - \\mu_k$ to ensure consistency, stability and improved convergence. 4) The normalized gradient norm is then quantized using the differentially private quantizer $dpsign(.) to obtain the quantized gradient $\\hat{g}$. 5) Lastly, the quantized gradient $\\hat{g}$ is then updated to a peer node within the network. In case of Random Walk gossip, each k transmits to another randomly selected peer node and during Epidemic gossip, each k communicates with a fixed subset of its neighboring k."}, {"title": "IV. EMPIRICAL EVALUATION & DISCUSSIONS", "content": "In this section, we initially discuss the dataset used for the experimental set-up followed by comprehensive discussion of the empirical results, which validate the anomaly detection performance and robustness of our proposed solution as presented in Section III."}, {"title": "A. Dataset Description & Preparation", "content": "We conduct an empirical evaluation of our proposed federated decentralized anomaly detection framework for power systems using the openly available Mississippi State University and Oak Ridge National Laboratory Power System Attack (MSU-ORNL PSA) datasets, which are derived from industrial control systems. These datasets consist of 15 distinct data files, each representing various power system event scenarios. The binary dataset scenarios encompass both natural events, such as power system disturbances, and deliberate attack events, including cyberattacks. Natural events are categorized based on fault severity across distributed grids, ranging from 10-19%, 20-79%, to 80-90%. Conversely, attack events include: 1) remote tripping command injection, involving sending commands to IEDs to manipulate circuit breakers operations, 2) changes in IED settings to disrupt normal operations, and 3) false data injection attacks, intelligently altering power system values across parameters like reference power, voltage and current to mislead system operators. In the case of the three-class dataset, no events indicates normal operations load changes. The datasets consist of 128 features, encompassing measurements e.g. frequency, voltage phase angle and current magnitude, amongst others.\nWe begin by selecting a basis of 100 necessary features for training our TAE-based anomaly detection neural network, a selection made following Principal Component Analysis (PCA) to cull out redundant features and decrease training complexity. To address the issue of missing values within the dataset, we employ K-Nearest Neighbor (KNN) imputation to prevent information loss as opposed to downsampling. Furthermore, we normalize the input features to fall within the range of (0,1). Finally, we partition the dataset into training and testing sets using a split ratio of 80% for training and 20% for testing, respectively."}, {"title": "B. Anomaly Detection Performance", "content": "Table I vs. Table III & Table II vs. Table IV demonstrate the performance metrics of the two gossip-based decentralized federated learning approaches applied to anomaly detection in power systems, with Tables I & II representing the results obtained using the random walk gossip-based method Tables III & IV corresponding to the epidemic gossip-based approach. It is clear from comparing results of the tables that the our proposed random walk gossip-based approach outperforms the epidemic gossip-based method consistently in terms of all performance criteria. The random walk gossip-based approach in DFL encourages efficient communication and information exchange among grid regions by allowing each client node to randomly select its peer. This randomness encourages a diverse exchange of model updates, thus enhancing convergence and accuracy of model updates. Furthermore, a balanced distribution of updates is achieved, thus mitigating information bottlenecks and ensuring all grid regions contribute effectively to the learning process. Similarly, based on Fig. 4 & Fig. 5 whereby the confusion matrices depict the performance of the Random Walk gossip-based (above) and Epidemic gossip-based (below) approaches, it is evident based on analysis of the true positive and true negative values that the proposed Random Walk gossip-based DFL approach exhibits superior performance. The higher true positive and true negative rates in the Random Walk gossip-based DFL matrix suggest that it more accurately identifies and correctly classifies both positive and negative instances, making it a preferable choice for our particular anomaly detection scheme. Furthermore, in Fig. 6, we contrast the anomaly detection performance of our proposed Random Walk gossip based protocol against that of epidemic and conventional FL. Similarly, Random Walk outperforms Epidemic protocols in terms of misbehaviour detection. The conventional FL approach demonstrates the lowest performance due to its inherent limitations in facilitating efficient communication and information exchange among the distributed nodes."}, {"title": "C. Computational Overhead Analysis", "content": "Following the successful validations of the anomaly detection performance of our proposed approach, we further assess the the computational overhead achieved through elimination of the centralized aggregator and gradient quantization as presented in Section III. Specifically, we contrast the time taken to train the neural networks in three distinct scenarios namely Random Walk gossip-based DFL, Epidemic gossip-based DFL and conventional FL. To ensure fairness during comparison, we utilize similar models with similar hyperparameters in all three setups. Fig. 7 illustrated a comparison of the computational efficiency among the two aforementioned types of gossip DFL protocols and a conventional FL scenario. The results reveal a consistent decrease in training time across all models when our proposed DFL-gradient quantization approach is employed against a conventional FL scheme. Notably, the Random Walk and Epidemic Gossip based FL approach demonstrate higher training time compared to the traditional FL framework which is mainly due to increased complexity and distributed aggregation. Furthermore, it is evident that Random Walk-based DFL demonstrates around 30% reduction in training time as compared to Epidemic-based DFL, indicating that Random Walk is less computationally demanding and much better suited for resource-constrained environments such as in the case of power systems."}, {"title": "D. Summary of findings", "content": "In this section, we investigated the detection performance of our novel decentralized anomaly detection solution within power systems, focusing on the comparison between decentralized federated learning (DFL) and conventional federated learning (FL) methodologies. Through extensive experimentation and analysis, we found that our proposed Random Walk gossip algorithm consistently outperformed its epidemic gossip-based DFL and conventional FL counterparts. Specifically, the novel solution exhibited superior detection accuracy and more efficient communication and information exchange among participating grid regions. The decentralized nature of DFL enables more dynamic and adaptive learning processes, leveraging the collective intelligence of distributed grid regions while mitigating the limitations associated with centralized coordination mechanisms in conventional FL setups. Additionally, we investigated the computational overhead and found that the our proposed DFL method incurred negligibly higher time costs compared to conventional FL approaches which is due to the complexity of the aggregation process and could be further improved through efficient gradient quantization. However, random walk protocol requires 35% less training time further emphasizing its computational efficiency and scalability for anomaly detection for Smart Grids."}, {"title": "V. CONCLUSION", "content": "In this paper, we investigated the effectiveness of a Decentralized Federated Learning scheme for anomaly detection in the domain of power systems. To the best of our knowledge, we are the first to introduce a gossip-based solution to decentralized federated anomaly detection in the SG ecosystem. First, we proposed a Random Walk gossip-based anomaly detection that enables the transition from a conventional Federated Learning paradigm to a decentralized one while eliminating the need for a centralized aggregator. Secondly, we proposed a hybrid anomaly detection neural network namely a Transformer Autoencoder (TAE) model. Extensive experimental validations using a publicly available datasets show that the TAE achieves superior accuracy as opposed to other state-of-the-art benchmark neural networks. Lastly, we introduce a sign-based gradient quantization scheme to optimize communication efficiency within the DFL framework, resulting in a significant reduction in training time. Overall, the findings concluded that there is a compelling potential for developing anomaly detection solutions using DFL and that Random Walk has shone in terms of both detection performance and computational overhead.\nIn future works, our main objective would be to improve the resilience of intrusion detection models by exploring more complex hybrid techniques within the DFL paradigm. Additionally, we will be investigating on the different cyberattacks e.g. Byzantine attacks that may disrupt the operations of the DFL framework."}]}