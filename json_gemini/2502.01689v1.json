{"title": "scGSDR: Harnessing Gene Semantics for Single-Cell Pharmacological Profiling", "authors": ["Yu-An Huang", "Xiyue Cao", "Zhu-Hong You", "Yue-Chao Li", "Xuequn Shang", "Zhi-An Huang"], "abstract": "The rise of single-cell sequencing technologies has revolutionized the exploration of drug resistance, revealing the crucial role of cellular heterogeneity in advancing precision medicine. By building computational models from existing single-cell drug response data, we can rapidly annotate cellular responses to drugs in subsequent trials. To this end, we developed scGSDR, a model that integrates two computational pipelines grounded in the knowledge of cellular states and gene signaling pathways, both essential for understanding biological gene semantics. scGSDR enhances predictive performance by incorporating gene semantics and employs an interpretability module to identify key pathways contributing to drug resistance phenotypes. Our extensive validation, which included 16 experiments covering 11 drugs, demonstrates scGSDR's superior predictive accuracy, when trained with either bulk-seq or scRNA-seq data, achieving high AUROC, AUPR, and F1 Scores. The model's application has extended from single-drug predictions to scenarios involving drug combinations. Leveraging pathways of known drug target genes, we found that scGSDR's cell-pathway attention scores are biologically interpretable, which helped us identify other potential drug-related genes.", "sections": [{"title": "1. Background", "content": "Predicting drug responses based on individual transcriptomic profiles serves as a cornerstone for precision medicine, enabling tailored therapeutic strategies that optimize efficacy and minimize the risk of treatment failure for each patient. Extensive research consistently demonstrates that treatment failure is intricately linked to cellular heterogeneity, which fosters the emergence of rare subpopulations of malignant cells. These cells exhibit distinct epigenetic and transcriptional states, rendering them resistant to a diverse array of anticancer drugs and thus preventing the total eradication of the tumor population. A thorough understanding of such a complex genetic and molecular landscape within a tumor is crucial for devising more effective, personalized therapy strategies that specifically target the unique characteristics of all cancerous subpopulations.\nSingle-cell sequencing technologies have emerged as pivotal methodologies in delineating tumor heterogeneity. These technologies facilitate a granular analysis of the diverse cellular environments within tumors, enabling a deeper understanding of the molecular underpinnings of various cancer subtypes. Recent efforts have expanded to incorporate the use of single- cell sequencing to elucidate the mechanisms underlying drug responses in cancer treatment.\nAlthough these studies are still in their preliminary stages and the dataset is relatively limited, they represent a critical advancement in understanding how individual cells within a tumor may respond to therapeutic interventions. Given the crucial significance of these findings, there has been a notable increase in the deployment of sophisticated computational models utilizing deep learning and machine learning to precisely annotate cellular drug response.\nCurrent computational models used to predict cellular drug responses primarily employ databases such as the Cancer Cell Line Encyclopedia (CCLE) and the Genomics of Drug Sensitivity in Cancer (GDSC). These repositories provide large-scale expression profiles of cancer cell lines using bulk RNA sequencing (RNA-seq), which yields an averaged estimation of gene expression across various subtypes within tumor cell populations. However, the effective application of these models faces challenges due to the fundamental differences between bulk RNA-seq and single-cell RNA-seq (scRNA-seq) techniques. Bulk RNA-seq aggregates the gene expression data of thousands of cells, potentially masking the unique responses of individual cells crucial for precise drug response prediction. Therefore, the success of these computational models hinges on the effective transfer of knowledge from bulk RNA- seq data, used as the reference, to scRNA-seq data, used as the query. Two prime examples include SCAD, which adopts an adversarial learning approach by training a domain discriminator, and scDEAL, which utilizes a loss function based on Maximum Mean Discrepancy (MMD) that is minimized to retain similarity between bulk and single-cell data.\nWith the increasing availability of single-cell sequencing data in drug response testing, it has become feasible to train a model using single-cell data to predict the response of single cells from other experiments to the same drug based on their gene expression profiles. However, training models with scRNA-seq data faces challenges such as dropout events that cause sparse gene expression and the limited number of genes related to drug mechanisms. This suggests that relying solely on domain adaptation for the knowledge transfer between datasets may not be sufficient for robust predictive modeling. Existing computational methods map all genes to the same learned feature space based on expression levels, thereby overlooking the distinct biological semantics attached to each gene. The biological semantics of genes, which reflect their functions and roles within the cell, are crucial for understanding their contribution to drug response mechanisms. Such semantics can be revealed through gene signaling pathways, which illustrate how genes execute specific biological functions via signal transduction. Such semantics, which can be revealed through gene signaling pathways that illustrate how genes execute specific biological functions via signal transduction, are also reflected in the macroscopic manifestations of cellular states, encompassing the cell's phenotype and behavior.\nIn this work, we introduce the scGSDR model (Single-cell Gene Semantics for Drug Response prediction), which employs a dual computational pipeline to integrate the prior knowledge of cellular states and gene signaling pathways, enhancing the prediction of drug responses at the single-cell level. The model was tested across three scenarios: using bulk-seq data as a reference, scRNA-seq data for single-drug predictions, and scRNA-seq for combination drug experiments. These applications demonstrate scGSDR's ability to handle both traditional and novel predictive challenges from various scenarios. We further show how the scGSDR model utilizes an attention mechanism interpretability module to discern the contribution of each pathway in each cell during the model inference process. It enables the identification of the most relevant gene pathways potentially leading to drug-resistant and drug- sensitive phenotypes within the dataset. Leveraging these pathways, we showcase a novel method for predicting drug action mechanisms and identifying genes associated with specific drugs. Specifically, we identified genes associated with the drug PLX4720, including BCL2, CCND1, the AKT family, and PIK3CA, as well as genes linked to the drug Paclitaxel, such as ICAM1, VCAM1, NFKB1, NFKBIA, and RAC1."}, {"title": "2. Results", "content": ""}, {"title": "2.1 Overview of scGSDR", "content": "We present the scGSDR (acronym for single-cell Gene Semantic Drug Response prediction) model depicted in Fig. 1 The proposed model considers two biological semantic perspectives of genes in scRNA-seq data through two computational pipelines, focusing on cellular states and cellular signaling pathways. In the first pipeline, tailored to assess cellular states, we utilize marker genes from 14 different cellular states as criteria for gene filtering. This process constructs cellular features, which are then mapped into an embedding space using a transformer module for cell representation. The second pipeline automatically learns attention matrices that define the association between each cell and various pathways, and constructs cell-cell graphs. These learned graphs, along with the gene expression profiles within the pathways, are input into a multi-graph fusion module, which maps them to another embedding space. Through both computational pipelines, each cell in the scRNA-seq single-cell matrix acquires two distinct embeddings, which are then integrated through feature fusion to produce the final fused embedding for annotating cellular drug responses.\nThe application of scGSDR model is designed to function in scenarios where scRNA-seq or cell line bulk-seq drug response data for a particular drug are used as a reference. Our model utilizes supervised learning to annotate drug responses in any scRNA-seq dataset for that drug. Considering that the reference data used during training inherently exhibit batch effects with the query data employed during testing, we incorporate a loss function augmented with domain adaptation (DA) learning to train our model, aiming to mitigate their discrepancies. Additionally, to address the potential issue of data imbalance between drug-resistant and drug- sensitive cells, the scGSDR model is optionally equipped with a loss function designed to correct distribution anomalies."}, {"title": "2.2 Evaluation of scGSDR on Bulk RNA-seq Reference Datasets", "content": "Since existing computational models for predicting drug responses in single-cell data primarily utilize cell line bulk-seq data, we sought to objectively compare their performance with that of our proposed scGSDR model. Therefore, we adopted the reference-query dataset pairs used in the SCAD model and employed the same five-fold cross-validation framework to evaluate the predictive performance of our model in training scenarios that utilize cell line bulk-seq data. In each fold, four-fifths of the query dataset along with their \u2018dataset labels' are used to train the DA classifier equipped in the scGSDR, with the remaining fifth reserved for testing. Importantly, as depicted in Fig. 3d, the term 'dataset labels' refers to identifiers that specify whether cells are derived from the reference or the query datasets, not to be confused with cell type labels. These dataset labels are utilized exclusively for training the DA classifier within the framework of five-fold cross-validation. Consequently, the cell type labels present in the query dataset do not contribute to the model training process.\nIn this section, we tested nine drugs (i.e., Afatinib, AR-42, Cetuximab, Etoposide, Gefitinib, NVP-TAE684, PLX4720, Sorafenib, and Vorinostat) across ten experiments. Notably, PLX4720 was evaluated in two separate experiments on the A375 and 451Lu cell lines. For each drug, the corresponding bulk-seq data set, sourced from the GDSC database, served as the reference for training the model, while the scRNA-seq data sets were used as query data to assess model performance. The enumeration of drug-resistant and drug-sensitive cells within these datasets is presented in Fig. 2a. It is noted that the collected bulk-seq datasets consistently show a significant data imbalance issue, with the average number of drug-resistant cells (634.3) substantially exceeds that of drug-sensitive cells (82.4). To address this issue, we introduced several loss functions tailored for anomaly detection tasks to replace cross-entropy, shifting the focus from a standard binary classification of drug-sensitive versus resistant cells to identifying the sparse drug-sensitive cells among a majority of drug-resistant ones. These specialized loss functions improve accuracy by applying stronger penalties for misclassifying the less prevalent category, thus effectively prioritizing the minority class amid data imbalances.\nFig. 2b illustrates the predictive performance of the five tested loss functions (Inverse, Deviation, Hinge, Minus, Overlap) on the Afatinib drug dataset across four performance metrics: Area Under the ROC Curve (AUROC), Area Under the Precision-Recall Curve (AUPR), Accuracy (ACC), and F1 Score (F1-macro). We observed significant improvements over the cross-entropy loss with average increases of 0.1002, 0.1019, 0.1450, and 0.1605 in AUROC, AUPR, ACC, and F1-macro, respectively. Notably, the scGSDR equipped with the Overlap loss function (scGSDR-overlap) demonstrated the best predictive performance, achieving average values of 0.9219 in AUROC, 0.9352 in AUPR, 0.8583 in ACC, and 0.8567 in F1-macro.\nWe compared our models against two other methods specifically designed for cellular drug response annotation, SCAD and scDEAL, using the same validation framework. In Fig. 2c, the violin plot is constructed from ten points representing the results of ten experiments, and the red line on the plot depicts the mean values. The results illustrate the superior performance of our models, particularly the scGSDR-overlap model, across all metrics. Specifically, scGSDR- overlap significantly outperforms not only our baseline model using cross-entropy (scGSDR- ce) but also SCAD and scDEAL. In AUROC, the mean score for scGSDR-overlap is 0.8758, markedly higher than scGSDR-ce's 0.7676, and substantially outpaces SCAD's 0.6085 and scDEAL's 0.4647. Similarly, in AUPR, scGSDR-overlap achieves a mean score of 0.8861 compared to scGSDR-ce's 0.8001, 0.6753 for SCAD, and 0.5363 for scDEAL. Accuracy and F1-macro metrics exhibit similar patterns, with scGSDR-overlap reaching 0.8381 and 0.8263 in mean scores, respectively, demonstrating its effectiveness in predicting more accurately and maintaining a balance between precision and recall compared to other methods. The median values further confirm the robustness of scGSDR-overlap, showcasing its consistency in delivering higher performance."}, {"title": "2.3 Evaluation of scGSDR on scRNA-seq Reference Datasets", "content": "As scRNA-seq technique gains prominence in drug research, it becomes feasible to use scRNA- seq data instead of cell line bulk-seq data for training models to predict drug responses at the single-cell level. As an extension of experiments based on bulk-seq data model training, we here further tested the performance of the scGSDR model when using scRNA-seq data as the reference data. We collected seven scRNA-seq datasets from three different drug treatment regimens to organize four experimental groups. The first and second experiments were based on the single-drug PLX4720. In Experiment 2-1, both reference and query datasets came from the 451Lu cell line, aiming to test the scGSDR model's performance in cross-platform scenarios and its ability to use small datasets for training to predict larger datasets. Experiment 2-2 used 451Lu as the reference and A375 as the query to evaluate the scGSDR model's predictive ability across different cell lines. Experiment 2-3 involved data collected from patients treated with a combination of Paclitaxel and Atezolizumab, assessing the scGSDR model's efficacy in multi-drug treatment scenarios. Experiment 2-4 utilized data from patients treated with Paclitaxel alone to test the scGSDR model's performance across tissue types in single-drug treatment experiments.\nThe results in Fig. 3b show scGSDR's predictive performance across four experiments using four metrics. It is demonstrated that scGSDR achieved an average accuracy of 0.825 with a standard deviation of 0.0735 across all experiments. The model reached its highest accuracy of 0.944 in the first experiment and the lowest at 0.743 in the second, while the third and fourth experiments registered accuracies of 0.801 and 0.812, respectively. These results highlight the model's robust predictive capabilities, particularly in the cross-platform experiment, and its consistent performance across varied scenarios. In Fig. 3c, we further present the distribution of representations for each cell derived from the scGSDR, scDEAL, and SCAD models in the first experiment. It is shown that our scGSDR model is capable of effectively distinguishing between drug-resistant and drug-sensitive cells within the representation space, compared to raw data, and also outperforms the scDEAL and SCAD models. To mitigate batch effects between the reference and query datasets, we incorporated DA into the training of scGSDR, as depicted in Fig. 3d. A portion of the testing dataset (without cell type labels) was used to train the DA classifier. We evaluated the impact of using different proportions of the testing data on the average accuracy of scGSDR across four experiments. The results (Fig. 3e) indicate that introducing 30% of the testing samples was sufficient for scGSDR to eliminate the heterogeneity between datasets while maintaining stability upon the introduction of additional testing samples. The results (Fig. 3f) indicate that without using DA, the average accuracy of scGSDR trained with cross entropy and Overlap respectively decreased from 0.825 to 0.785 and from 0.806 to 0.770 across four experiments. To assess the utility of drug action pathways, we compared the predictive performance of scGSDR with and without the incorporation of PharmGKB pathways across ten experiments. The results (Fig. 3g) show that the removal of drug action pathways led to a decline in performance across both databases. Specifically, the average accuracy decreased from 0.835 to 0.755 in the Reactome experiments, and from 0.825 to 0.772 in the KEGG experiments. This indicates that the prior information provided by drug action pathways is beneficial for distinguishing cell responses to drugs. Fig. 3h presents a comparison of scGSDR's performance in constructing cell-cell graphs using both pathways and solely gene expression information across four experiments. The results demonstrate that removing the prior knowledge from gene pathways causes a decrease in the average accuracy of scGSDR from 0.825 to 0.745. This underscores the utility of the inherent gene relationships within pathways in enhancing the construction of cell-cell graphs. We further compare with 12 existing methods including machine learning-based cell type annotation tools such as SciBet, scPred, and singlecellNet; statistical methods like CHETAH; reference dataset-based tools such as SingleR; deep generative models including scVI and scANVI; and marker gene-based tools like MarkerCount, each offering distinct approaches for achieve cell type classification in scRNA-Seq data analysis."}, {"title": "2.4 Application of scGSDR on Combination Drug Therapy", "content": "We further evaluated the predictive performance of the scGSDR model in the context of combination drug therapy experiments. Specifically, we investigated whether it is feasible to use datasets from individual drug treatments as references to train the scGSDR model. By leveraging this model, we aimed to develop a representation space that effectively distinguishes between drug-resistant and drug-sensitive cells in scenarios where the two drugs are used in combination. We here designed two experiments to further assess the scGSDR model : Experiment 3-1 involved the combination therapy of JQ1 and Paclitaxel, while Experiment 3- 2 focused on the combination of JQ1 and Palbociclib. Fig. 4b shows the training framework for our combination drug prediction model. We augmented two monotherapy reference datasets with dataset labels and trained the scGSDR using a shared dataset classifier. This strategy aims to enable the scGSDR model to effectively predict the cellular drug response types common to both datasets, while also distinguishing and preserving the unique characteristics of each drug dataset. We utilized data from combined drug treatments as a test set to evaluate whether the scGSDR model can distinguish between drug-resistant and drug-sensitive cells within this dataset. To assess the performance, we employed clustering evaluation metrics based on the embedding space generated by the scGSDR's response classifier. We applied two unsupervised clustering algorithms, K-means and Birch, for cell clustering. The results (Fig. 4c) show that using K-means with scGSDR cellular embeddings significantly outperformed raw data across three metrics: Adjusted Rand Index (ARI), Normalized Mutual Information (NMI), and Average Silhouette Width (ASW). In Experiment 3-1, the improvements were 0.884, 0.708, and 0.161, respectively, while in Experiment 3-2, they were 0.651, 0.593, and 0.307, respectively. Similarly, with Birch, the enhancements in Experiment 3-1 were 0.654, 0.585, and 0.233, and in Experiment 3-2, they were 0.540, 0.514, and 0.311, respectively. Fig. 4d illustrates that scGSDR effectively distinguishes between drug-resistant and drug-sensitive cells, demonstrating improved intra-class cohesion and inter-class dispersion compared to raw data across two experiments. Our experiments demonstrate that scGSDR can effectively use data from individual drug treatments to accurately annotate cellular drug responses in scenarios involving combined drug use, without requiring experimental data from the combined administration of both drugs."}, {"title": "2.5 Analysis of Cell-pathway Attention in scGSDR with Biological Interpretability", "content": "In the pathway pipeline of scGSDR, each cell automatically learns the importance of all pathways through an attention mechanism, and these importance levels serve as weights that influence the drug response predictions of scGSDR. We evaluated the biological interpretability of these cell-pathway attention scores. Specifically, we first focused on the known target genes of drugs used in combination therapy experiments, observing whether the pathways containing these target genes received significantly different attention scores between drug-resistant and drug-sensitive cell groups. We examined gene pathways associated with the target gene BRD4 of drug JQ1 (hsa03036, hsa01001, and hsa03021) as well as the pathways associated with target genes CDK4 and CDK6 of drug Palbociclib (hsa1001). We collected attention scores from drug-resistant and drug-sensitive cell groups for these pathways and calculated the p-values between groups. The results (Fig. 4e) illustrate the distribution of these pathways across the two cell groups, with green indicating a p-value <0.05 and red otherwise. Except for hsa03021 in Experiment 3-2, all other results demonstrated significantly different attention scores between drug-resistant and drug-sensitive cells learned via scGSDR, suggesting that the attention mechanism offers substantial biological interpretability. We further tested the central cell collections in the clustering space for two types of drug response cells, specifically analyzing their expression levels of target drug genes (BRD4 for JQ1 and CDK4 for Palbociclib). As depicted in Fig. 4g, starting from the two cluster centers, we segmented the cells into five groups ranging from 20 to 100 cells at intervals of 20. The results (Fig. 4f) show that, except for the smallest group (20 cells), there were statistically significant differences in expression levels between the drug-resistant and drug-sensitive cell collections across all other groups. The larger the number of cells, the more statistically significant the differences, affirming the biological interpretability of the scGSDR model's learned cellular representation space and the clusters' representativeness for the two types of drug responses."}, {"title": "2.6 Application of scGSDR on Discovering Potential Gene Targets with Intersecting Pathways", "content": "Our analyses so far have expanded from known drug target genes to gene pathways that they involve. We now aim to determine if pathways with significant statistical differences can reveal potentially other unknown drug-related genes. Our hypothesis posits that genes potentially related to drugs can be enriched across multiple gene pathways. Given the biological interpretability of the cell-pathway attention scores calculated by scGSDR in previous analyses, we seek to identify pathways with significant statistical differences in attention scores between two predicted cell clusters (drug-resistant and drug-sensitive). By examining these pathways, we aim to identify common genes within them, which could help infer potential genes associated with drug response outcomes.\nBased on Experiment 2-1, we used this method to further infer other genes associated with the drug PLX4720. Specifically, we first collected the cell-pathway attention scores, which were pre-calculated using the scGSDR model with the query dataset (GSE108394) serving as the testing set. We then computed the p-values for each pathway using a t-test between the drug-resistant and drug-sensitive cell groups. Fig. 6a illustrates the distribution of attention scores on the top 20 pathways with the lowest p-values, based on the 100 genes with the largest variance in gene expression. It is shown that within the same pathway, the scores are similar within both cell groups, yet there are notable differences between the two groups. Based on the pathways with the lowest p-values for attention scores between cell groups, we identified the most frequently occurring genes within these pathways. These genes are considered potential candidates most relevant to the cellular response to the drug. We further identified the genes that appear most frequently within these pathways. These genes are considered the most relevant potential candidates related to the cellular response to the drug. Fig. 6b displays the occurrence of each gene in the pathways: the top panel is based on statistics from the top 20 pathways with the lowest p-values, while the bottom panel is based on the top 10. In the enrichment results of the top-20 pathways, we found that the top-1 gene, CCND1, was enriched in eight pathways. The distribution of attention scores for these eight pathways across all cells is depicted in Fig. 6c. Furthermore, based on the enrichment results from the top-10 pathways, the gene BCL2, which is enriched in three pathways (hsa04340, hsa04215, hsa04210), emerges as the most potentially relevant gene associated with the drug PLX4720, as visualized in Fig. 6d.\nWe further validated the gene lists enriched by intersecting pathways in experiments 2-1 and 2-4 through a review of existing literature. In the gene list generated from the top-10 pathways, BCL2 (rank 1) was inferred to be associated with PLX4720, while ICAM1 and VCAM1 (both rank 1, enriched by pathways hsa04064, hsa04090, hsa04091) were most likely associated with Paclitaxel. For BCL2, (34) found that the regulation of its family proteins may be associated with resistance to PLX4720 treatment in melanoma, particularly in the context of AKT pathway activation. It is worth noting that the AKT family gene is also present in the top- 20 pathways in our experiment (upper panel in Fig. 6b). For ICAM1 and VCAM1, (35) discovered that low-dose Paclitaxel induces the expression of these inflammatory adhesion molecules in primary tumor samples."}, {"title": "3. Discussion", "content": "Predicting the response phenotype of individual cells to specific drugs based on differential gene expression profiles is essential, as it provides insights into the molecular mechanisms of drugs at the single-cell level, and is a critical step in applying scRNA-seq technology to pharmacological research and analysis. Existing computational methods for single-cell drug response prediction predominantly focus on utilizing bulk-seq cell line data as a reference for training models. In our work, we propose the scGSDR model, which extends to experimental scenarios involving single and combination drug treatments using scRNA-seq data as the reference. However, computational scenarios leveraging scRNA-seq as a reference pose new challenges, as the drop-out events inherent to scRNA-seq data induce sparsity in gene expression. This sparsity makes it increasingly difficult to discern the limited number of genes relevant to drug mechanisms, which are crucial for cell representation, from among a multitude of other genes. To address this issue, we propose the incorporation of prior knowledge of gene biological semantics to enhance the model's ability to learn cellular characterization.\nConsidering that genes function collaboratively in groups through signaling pathways to perform certain biological functions, influencing the cellular state and ultimately determining the cell's response phenotype to a specific drug, we have designed two computational pathways within the scGSDR model that consider the biological semantic prior knowledge of genes in two aspects: marker gene sets from different cellular states, and (ii) gene regulatory relationships within gene signaling pathways.\nBy incorporating prior knowledge of gene pathways, the scGSDR model implements a two-tiered coarse representation of genes. Initially, genes are clustered into a pathway-level representation based on the pathways they are involved in, using AUCell scoring. Subsequently, multiple pathways are aggregated according to biological function categories (as shown in Fig. 2d) and further represented at the biological function level through a cell-cell graph structure learner (as depicted in Fig. 1b). The introduction of such gene semantic information, as evidenced by the experimental results (Table 1), demonstrates that scGSDR can achieve both high predictive accuracy and good stability in experiments using scRNA-seq as a reference.\nAdditionally, we validated across multiple datasets that the scGSDR model's computational pipeline for cellular state and gene pathway has complementary effects on predictive performance, confirming the synergistic value of these two types of prior knowledge. By analyzing the attention scores obtained from the pathways of known drug target genes, we observed significant statistical differences in these scores across cell clusters responding to two types of drugs, demonstrating that the attention generated by scGSDR possesses biological interpretability.\nThe incorporation of gene semantics not only enhances the predictive performance of the scGSDR model but also, through an attention mechanism interpretability module, enables it to identify which gene pathways contribute most significantly to its predictions. This facilitates the identification of key gene pathways that may determine cellular drug response phenotypes. Compared to single genes, gene pathways are coarser-grained and have known biological functions, making the cell-pathway attention scores generated by scGSDR inherently more interpretable and robust when elucidating the mechanisms behind drug responses. We leveraged the interpretability at the pathway level to identify potential genes associated with drug responses, utilizing single-drug scRNA-seq data from experiments 2-1 and 2-4. Several genes (BCL2, CCND1, AKT family, PIK3CA for PLX4720; ICAM1, VCAM1, NFKB1, NFKBIA, RAC1 for Paclitaxel) were identified and confirmed through literature review, validating the biological interpretability of the scGSDR model's attention mechanism. It should be noted that this method for discovering potential genes does not require any prior information about drug target genes for inference. Furthermore, it allows for the analysis of the reasoning behind these inferences (i.e., which gene pathways are relevant to the inferred genes), thereby providing valuable application in the study of potential drug mechanisms.\nThe current version of scGSDR still has some limitations, which we hope to address and improve in future work. The training of the scGSDR model relies on reference datasets and gene semantic data, meaning that selecting different datasets as references could lead to variations in performance and interpretability for the same query dataset. However, the availability of scRNA-seq experimental data for the same drug remains scarce, with only one set available for PLX4720 and one for Paclitaxel . The uncertainty introduced by the choice of reference data still needs to be tested in the future.\nMoreover, since scGSDR utilizes gene pathways to group genes performing similar functions, genes involved in multiple pathways may disproportionately influence the final predictive outcomes, leading to potential oversight of critical genes that are involved in fewer pathways. Additionally, scGSDR still faces issues with data scarcity. If more than one set of data becomes available for reference in the future, scGSDR could potentially be iteratively trained across multiple reference datasets to achieve more robust and accurate performance."}, {"title": "4. Conclusions", "content": "scGSDR leverages gene semantic knowledge to enhance the accuracy of single-cell drug response predictions and provides interpretable insights into drug molecular mechanisms at the gene pathway level, significantly advancing the analysis of scRNA-seq data in drug resistance studies. Comprehensive experiments across various settings have confirmed that scGSDR delivers high performance on different types of training data, including both bulk-seq and scRNA-seq data, and is applicable to predictions for either single-drug or multi-drug combination trials. scGSDR not only achieves accurate and robust predictive performance across various experimental datasets but also provides the rationale for its predictions through an interpretability module, thereby identifying trustworthy gene pathways that have a significant impact on cellular drug response profiling. Based on these pathways, we examined the top-ranking list and successfully confirmed through literature review the identification of some potential drug-related genes, such as the BCL2 gene for PLX4720 and the ICAM1 gene for Paclitaxel, demonstrating scGSDR's potential application in identifying key genes involved in drug mechanisms. We anticipate that scGSDR will serve as a valuable tool, providing accurate cellular drug response profiling and facilitating the discovery of potential gene pathways in the analysis of single-cell drug response experiments."}, {"title": "5. Methods", "content": "Datasets used in the experiments on bulk RNA-seq reference datasets: In our study", "datasets": "As part of our study on predicting drug responses in scRNA-seq datasets using scRNA-seq datasets, 4 experiments were designed, denoted as Experiment 2-1 to Experiment 2-4. Experiment 2-1 is a cross-platform experiment involving the drug PLX4720, where the reference dataset is from GSE108383 and the query dataset is from GSE108394, using data generated on NextSeq and HiSeq platforms, respectively. The reference dataset consists of 163 cells (83 resistant cells and 80 sensitive cells), and the query dataset consists of 6548 cells (3262 resistant cells and 3286 sensitive cells). Experiment 2-2 is a cross-cell line prediction experiment involving the drug PLX4720, using data from GSE108383, where the reference dataset is from the 451Lu cell line and the query dataset is from the A375 cell line. The reference dataset consists of 163 cells (83 resistant cells and 80 sensitive cells), and the query dataset consists of 101 cells (43 resistant cells and 58 sensitive cells). Experiment 2-3 and 2-4 are cross-tissue prediction experiments"}]}