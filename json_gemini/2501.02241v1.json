{"title": "Interpretable Load Forecasting via Representation Learning of Geo-distributed Meteorological Factors", "authors": ["Yangze Zhou", "Guoxin Lin", "Gonghao Zhang", "Yi Wang"], "abstract": "Meteorological factors (MF) are crucial in day-ahead load forecasting as they significantly influence the elec-tricity consumption behaviors of consumers. Numerous stud-ies have incorporated MF into the load forecasting model to achieve higher accuracy. Selecting MF from one representative location or the averaged MF as the inputs of the forecasting model is a common practice. However, the difference in MF collected in various locations within a region may be significant, which poses a challenge in selecting the appropriate MF from numerous locations. A representation learning framework is proposed to extract geo-distributed MF while considering their spatial relationships. In addition, this paper employs the Shapley value in the graph-based model to reveal connections between MF collected in different locations and loads. To reduce the computational complexity of calculating the Shapley value, an acceleration method is adopted based on Monte Carlo sampling and weighted linear regression. Experiments on two real-world datasets demonstrate that the proposed method improves the day-ahead forecasting accuracy, especially in extreme scenarios such as the \"accumulation temperature effect\" in summer and \"sudden temperature change\" in winter. We also find a significant correlation between the importance of MF in different locations and the corresponding area's GDP and mainstay industry.", "sections": [{"title": "I. INTRODUCTION", "content": "Accurate day-ahead load forecasting plays an essential role in the operation of power systems [1]. Improving the accuracy of day-ahead load forecasting is an efficient approach to decreasing operational costs by reducing reserve require-ments and avoiding temporary generation adjustment [2], [3]. Meteorological factors (MF) are crucial in day-ahead load forecasting as they significantly influence the electricity con-sumption behaviors of consumers. For example, the increase in temperature leads to 6.14% and 11.3% electricity demand in summer and spring in New South Wales, respectively [4]. Additionally, the relationship between electricity demand and air temperature exhibits a non-linear pattern, as demonstrated by studies conducted in London and Athens [5]. These findings highlight the importance of considering MF when forecasting electricity load.\nThere are two primary methods for incorporating MF into the load forecasting model: used for similar daily sample selection and used as input features [6]. Similar daily sample selection refers to forecasting the load for a target date with the load data from historical dates deemed similar to the target date [7]. An essential aspect of this approach is developing an appropriate index for selecting similar days, and MF are typically incorporated into the index design. [8] proposed an index for selecting similar days that involves temperature similarity and date proximity. [9] investigated the exponential relationship between temperature and load demand and utilized a weighted mean hourly load from three previous similar days for forecasting. [10] developed an index that considered factors such as temperature, humidity, wind speed, weather conditions, and haze to reflect human comfort. The second approach involves the MF as input for the forecasting model, allowing the model to learn the relationship between these factors and load in model training [11]. It has been widely adopted to different models, such as artificial neural networks [12], [13], tree-based models [14], and support vector machines [15]. However, weather stations are commonly built at various geographical locations within a city to monitor and record MF. Due to the urban heat island effect [16] and atmo-spheric activity [17], the recorded data from different locations tends to show strong spatial heterogeneity and variability [18]. Specifically, air temperature in urban areas can be higher than that in their surrounding rural areas by up to 5\u00b0C [19]. Hence, a problem arises: MF collected from which locations should be selected for day-ahead load forecasting?\nSuch a problem is mainly discussed in research related to Global Energy Forecasting Competition 2012 (GEFCom2012) [20] and Global Energy Forecasting Competition 2014 (GEF-Com2014) [21]. These competitions provided data collected by various weather stations but no identification of their geo-graphical locations. [22] and [23] employed simple techniques to tackle this issue, directly averaging the MF of all stations. [24] selected stations based on the cubic regression's in-sample fits, and the best two stations were aggregated by averaging. [25] utilized the generalized cross-validation criterion to select stations and created a virtual station by averaging the lowest validation loss across multiple stations. [26] proposed a rank-based method with three main procedures, including ranking stations based on Hongtao's vanilla benchmark [20], creating virtual stations by averaging the top weather stations, and selecting the best virtual stations based on the performance of the validation dataset. [27] presented a genetic algorithm-based selection approach based on [26]. The optimum weather station combination was generated by crossover and mutation during the creation of the next generation. However, current studies suffer from two main drawbacks:\n1) These studies neglect spatial relationships between weather stations due to the lack of geographical infor-mation. It may lead to the inappropriate merging of MF selected by stations that are far apart. In addition, different load zones may consist of various customer types, in-cluding residential, commercial, and industrial customers [26]. These different types of users are influenced differ-ently by weather fluctuation. For instance, temperature changes have a minimal impact on the industrial load, while there is a strong impact on the residential load [28]. Incorporating geographical information can help to"}, {"title": "II. PROBLEM STATEMENT", "content": "Assume there are n MF collection locations within the studied region, denoted as V. For each locations $v_i \\in V$, it contains m MF features $X_i = \\{X_{i,1}, X_{i,2},\\dots, X_{i,m}\\}$ and their set are represented as $X = \\{X_i | v_i \\in V\\}$. The geometrical relationship of V is represented by the adjacency matrix $A \\in R^{n \\times n}$. The element $A_{ij}$ denotes the geometric relationship between locations i and j. $A_{ij} = 1$ means that they are adjacent; $A_{ij} = 0$ means they are not adjacent.\nTraditionally, MF of location $v_i$ are selected or extracted before model training. The pre-selected or pre-extracted MF (denoted as $X'$), together with other features (such as calendar variables and history loads, denoted as $X_o$), are fed as inputs to the forecasting model f. Then, the model is trained as:\n$\\arg \\min_{f} \\sum_{t \\in T_{train}} L(f(X'_t, X_{o,t}), y_t)$  (1)"}, {"title": "III. PROPOSED FRAMEWORK", "content": "Fig. 1 presents the proposed load forecasting framework using geo-distributed MF. It consists of two procedures, i.e., GCN-based load forecasting and accelerated Shapley value-based model interpretation, which correspond to the two tasks defined above."}, {"title": "A. GCN-based Load Forecasting", "content": "GCN is one of the most popular variants of graph neural networks (GNN), which is specifically designed to operate on graph-structured data [29]. It has been successfully applied in extracting hidden information from diverse types of graph data, including traffic networks [30] and social networks [31]. For applications in energy systems, GCN has demonstrated its capability in integrating network topology information and temporal dynamics into voltage disturbance detection models [32]. It has been utilized to describe the relationships among different blocks within complex buildings, leading to improved energy consumption forecasting [33].\nHere, we focus on how to extract the representation of geo-distributed MF to improve load forecasting accuracy with GCN. The proposed GCN-based load forecasting can be di-vided into representation generation model g, load forecasting model f, and integrated model training.\nThe representation generation model gg consists of an input layer, convolutional layers, pooling layers, and an output layer. The input is graph G(X, A) composed of geo-distributed MF and the output is the extracted representation $R_G$. The function of the convolutional layer can be divided into three steps: propagation, aggregation, and updating. In the propagation step, the model computes messages between every node pair $(v_i,v_j)$. In the aggregation step, for each $v_i \\in V$ in the graph, the messages from its neighboring nodes are aggregated into $m_i^{(l-1)}$, where $(l)$ is the l-th convolutional layer. In the updating step, the updated representation $H_i^{(l)}$ of each node $v_i$ is computed using the aggregated messages $m_i^{(l-1)}$ and the previous layer representation $H_i^{(l-1)}$. The working"}, {"title": "B. Accelerated Shapley Value-Based Model Interpretation", "content": "Given the presence of numerous MF collection locations within a region, it is necessary to interpret the forecasting model to determine MF from which locations are more im-portant. It can underly the connections between geo-distributed MF and loads, guiding practical weather station deployment. The goal of model interpretation is to find the most impor-tant subgraph $G_s(X_s, A_s)$ for the forecasts y, which can be formulated as (5).\n$G_s = \\arg \\max_{G_s | N_{max}} Score(f_{g}, G(X, A), G_s(X_s, A_s))$  (5)\nwhere Score() is a scoring function to evaluate the importance of a subgraph, $f_g$ is the integrated model of f and g, $G_s(X_s, A_s)$ is a subgraph of G(X, A), $N_{max}$ is the upper bound of the size of the subgraph, which is defined as the number of nodes in this work."}, {"title": "IV. CASE STUDIES", "content": "A. Experimental Setups\n1) Data source: This study evaluates the proposed frame-work using data collected from two cities in China (City A and City B). The hourly electricity load data from City A is collected from 2018 to 2023, with the data from 2018 to 2022 selected as the training dataset and the data collected in 2023 used as the testing dataset. The hourly electricity load from City B is collected from 2014 to 2018, with the data from 2014 to 2017 selected as the training dataset and the data collected in 2018 used as the testing dataset.\nThe MF utilized in this work are downloaded from the fifth-generation European Centre for Medium-Range Weather Forecasts (ERA5) for the global climate and weather. ERA5 provides global climate and weather data, which are gridded to a regular latitude-longitude grid of 0.25 degrees. This dataset is obtained through data assimilation, which combines model data with observations from around the world to create a global dataset using the laws of physics. There are 18 grid points in City A and 20 grid points in City B. The MF considered in this study includes the 2-meter (m) temperature and relative humidity. Furthermore, historical load features (last seven days) and calendar features (month, weekday, hour) are also chosen as load forecasting inputs as well.\n2) Metric: Mean absolute error (MAE) and Mean absolute percentage error (MAPE) are chosen to evaluate forecast accuracy in this work. They are defined by (11a) and (11b).\n$MAE = \\frac{1}{|T|}\\sum_{t \\in T}|Y_t - \\hat{Y_t}|$  (11a)\n$MAPE = \\frac{1}{|T|}\\sum_{t \\in T}\\frac{|Y_t - \\hat{Y_t}|}{Y_t}$  (11b)\nwhere $Y_t$ and $\\hat{Y_t}$ is the t-th actual load and predicted load, respectively; T is the dataset index set, |T| is the size of T.\nIn the real world, system operators tend to focus more on load forecasting accuracy at 11:00 AM and 8:00 PM. This is because the load at these times is generally higher or the forecasting errors are often larger than other periods. Hence, system operators consider these time points to be more critical for day-ahead scheduling. Therefore, the forecasting error (MAE and MAPE) at 11:00 AM and 8:00 PM will be calculated, which are denoted as $MAE_{Noon}$, $MAE_{Night}$, $MAPE_{Noon}$ and $MAPE_{Night}$. Additionally, this work proposes comprehensive metrics $MAPE_{com}$ and $MAE_{com}$ to combine the forecasting accuracy at different periods. This approach aims to provide a more comprehensive evaluation of the model's performance.\n$MAE_{com} = 0.6MAE + 0.2MAE_{Noon} + 0.2MAE_{Night}$  (12a)\n$MAPE_{com} = 0.6MAPE + 0.2MAPE_{Noon} + 0.2MAPE_{Night}$  (12b)\n3) Benchmark: There are several kinds of benchmarks and all forecasting models of these benchmarks are artificial neural networks. The first kind of benchmark is selecting MF from one location as the model input. It is denoted as $L_x$, where x is the index of location. As for other benchmarks, \"None MF\" means the forecasting model does not accept the MF as input features. \"All locations\" means that the MF from all locations is fed directly into the forecasting model. \u201cAverage\u201d means the geo-distributed is aggregated by taking the average and then provided to the forecasting model. \u201cHT\u201d means the Hongtao weather station selection mentioned in [26]."}]}