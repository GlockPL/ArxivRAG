{"title": "Reverse Map Projections as Equivariant Quantum Embeddings", "authors": ["Max Arnott", "Dimitri Papaioannou", "Kieran McDowall"], "abstract": "We introduce the novel class (\u0395\u03b1)\u03b1\u20ac[\u2212\u221e,1) of reverse map projection embeddings, each one defining a unique new method of encoding classical data into quantum states. Inspired by well-known map projections from the unit sphere onto its tangent planes, used in practice in cartography, these embeddings address the common drawback of the amplitude embedding method, wherein scalar multiples of data points are identified and information about the norm of data is lost.\nWe show how reverse map projections can be utilised as equivariant embeddings for quantum machine learning. Using these methods, we can leverage symmetries in classical datasets to significantly strengthen performance on quantum machine learning tasks.\nFinally, we select four values of a with which to perform a simple classification task, taking Ea as the embedding and experimenting with both equivariant and non-equivariant setups. We compare their results alongside those of standard amplitude embedding.", "sections": [{"title": "Introduction", "content": "In today's noisy, intermediate scale quantum (NISQ) era of quantum computing, quantum algorithms face challenges from hardware limitations, including qubit quantity, connectivity, and noise [1]. To reduce the negative effects of these challenges for the purpose of quantum machine learning (QML), they must be considered at every step of the QML process: data embedding, computation, and measurement. Particularly, clever choices of 'classical-to-quantum' embedding schemes and efficient quantum circuits are essential to maximise the utility of current quantum resources.\nThe mapping of a classical dataset D to a set of quantum states is the necessary first step for said data to be processed by a quantum computer. Precisely, we are required to construct some map E from D to the unit sphere of a Hilbert space H, which is the state space of the given quantum computer. Popular embedding schemes in quantum information science include basis encoding, amplitude embedding, and angle embedding. Basis encoding works by taking a datapoint b expressed in binary, and assigning it the quantum state |b), which belongs to the standard orthonormal basis of the quantum computer. Amplitude embedding maps a classical vector x = (xi)201 to the quantum state\n$\\frac{1}{\\|x\\|_2}\\sum_{i=0}^{2^n-1}x_i\\|i\\rangle$.\nAngle embedding uses rotation gates to encode classical data into a quantum state, by mapping a real vector (xi)=0 to the state\n$\\bigotimes_{i=0}^{n}R_x(x_i)\\|0\\rangle$\n[2, 3, 4].\nA projection on a Hilbert space H is always surjective when restricted to its complemented range. As such, embeddings can often be thought of as partial inverses to projections. Predefined projections on Hilbert spaces, and their domain restrictions to the unit sphere, can therefore serve naturally as inspiration for those looking to define new quantum encoding schemes.\nCartographers have defined a plethora of projections to send the three dimensional surface of"}, {"title": "Preliminaries", "content": "Here, we explain in detail the mathematical terminology, conventions, and notation used throughout. We remark that the notation (\u00b7,.) has been chosen to denote inner products in this paper as opposed to the Dirac notation \u3008\u4e8c\u3009more commonly seen in quantum-related material. Due to the pure mathematical nature of large portions of our research, we decided to align our notation to the pure mathematical convention.\n2.1 Basics\nWe write N for the set of natural numbers, R for the set of real numbers, and C for the set of complex numbers. Henceforth, the notation K may denote either field R or C.\nLet V be a vector space over K, with norm ||\u00b7|| - The closed unit ball of V is the set\n$B_V = \\{v \\in V : \\|v\\| \\leq 1\\} $.\nThe unit sphere $S_V$ of V is the set of exterior points of $B_V$, that is,\n$S_V = \\{v \\in V : \\|v\\| = 1\\} $.\nA Hilbert space His an inner product space which is complete with respect to the norm derived from its inner product. Completeness in this context is the property that every Cauchy sequence in H is convergent, with limit in H. For"}, {"title": "Basics", "content": "We write N for the set of natural numbers, R for the set of real numbers, and C for the set of complex numbers. Henceforth, the notation K may denote either field R or C.\nLet V be a vector space over K, with norm ||\u00b7|| - The closed unit ball of V is the set\n$B_V = \\{v \\in V : \\|v\\| \\leq 1\\} $.\nThe unit sphere $S_V$ of V is the set of exterior points of $B_V$, that is,\n$S_V = \\{v \\in V : \\|v\\| = 1\\} $.\nA Hilbert space His an inner product space which is complete with respect to the norm derived from its inner product. Completeness in this context is the property that every Cauchy sequence in H is convergent, with limit in H. For"}, {"title": "Operators", "content": "A bounded operator from a Hilbert space H to a Hilbert space G is a continuous, linear function H \u2192 G. We write B(H;G) for the vector space of all bounded operators from H to G, and we abbreviate B(H; H) to B(H).\nLet T\u2208 B(H;G) for some Hilbert spaces H and G. We write T* \u2208 B(G;H) to denote the ad- joint (or dual) of T, that is, the unique operator for which\n$\\langle Tx,y\\rangle = \\langle x,T^*y\\rangle$,\nfor every x \u2208 H and every y\u2208G.\nAn operator U \u2208 B(H) on a Hilbert space H is unitary if\n$UU^* = U^*U = I_H$,\nwhere In is the identity operator on H with action x\u2192x for every x \u2208 H. Unitary operators U on Hare isometries, meaning that for every x \u2208 H, we have ||Ux|| = ||x||.\nA projection on a Hilbert space H is an operator P\u2208 B(H) for which\n$P^2 = P^* = P $.\nThe range P(H) of P is then a complemented subspace of H, and thus, when convenient, we may identify a projection P with its corestriction to P(H), so that P\u2208 B(H; P(H)). We shall always make clear the domain and codomain of all projections, so this will not cause confusion."}, {"title": "Group Representations", "content": "Let G be a nonempty set, equipped with a binary operation We say that G is a group under if it satisfies the following three conditions.\n\u2022 Associativity:\n\u2200f,g,h\u2208G, (f. g) . h = f. (g\u00b7h) .\n\u2022 Identity Element:\n\u2203e\u2208 G such that \u2200g\u2208G, e.g=g.e=g.\n\u2022 Inverse Elements:\n\u2200g \u2208 G, \u2203g^{-1} \u2208 G such that\ng \u2022 g^{-1} = g^{-1} . g = e.\nLet G be a group, and let H be a Hilbert space. A representation of Gon H is a function p : G \u2192 B(H) for which p(g) is invertible (i.e., bijective) and\np(g)p(h) = p(g\u00b7h)\nfor every g,h \u2208 G. If we further have that p(g) is a unitary operator for every g\u2208 G, we say that pis a unitary representation. For a unitary representation p of G, we also have that\np(g)^* = p(g^{-1})\nfor every g\u2208 G. If p(g) = I\u04a3 for every g \u2208G, then p is called the trivial representation of G on H.\nLet p1 and p2 be representations of a group G on two Hilbert spaces H\u2081 and H2 respectively. The direct sum p1 p2 of p\u2081 and p2 is the representation of Gon H1 H2 with action\n$\\langle \\rho_1 \\oplus \\rho_2 \\rangle(g)(x_1 \\oplus x_2) = \\rho_1(g)x_1 \\oplus \\rho_2(g)x_2$\nfor every g\u2208 G, x1 \u2208 H1, and x2 \u2208 H2.\nSee [12] for more information on representation theory in the context of QML."}, {"title": "Higher Dimensional Map Projections", "content": "A map projection, loosely defined, is any projection on R3 which is used primarily to map some subset of a sphere to a subset of a plane. Map projections are named for their use in cartography for creating maps of the earth [5]. For myriad topological reasons, distortions of certain geometric properties of a sphere are inevitable under a map projection. A wide array of different map projections have been defined, specifically designed in order to best preserve certain features of the sphere, for different mapping needs. Oftentimes this comes with the trade-off of increasing the distortion of other aspects.\nMap projections Pp can be defined by taking some centre of projection p, and acting on each point x of the sphere by mapping x to the unique point Ppx on a given tangent plane of the sphere for which Ppx is colinear with both x and p. In this paper, we highlight four particular map projections. Below, we give a brief overview of each one. In each case, the maps are R3 \u2192 R3, the given sphere is SR3, and the tangent plane in ques- tion is the set {(x0,x1,x2) \u2208 R\u00b3 : x2 = 1}.\n\u2022 Gnomonic: This projection sets the cen- tre of projection as the origin. Under a gnomonic projection, great circles are mapped to straight lines, a feature useful in e.g., aviation. A drawback of the gnomonic projection is that it causes high distortion to shape and area, especially towards the edge of the map.\n\u2022 Stereographic: The centre of projection for the stereographic projection is the point (0,0,-1), which is antipodal to the point of contact between the sphere and the tan- gent plane. Locally, angles and shapes are well-preserved under this projection. This preservation of angles is a helpful feature in navigation.\n\u2022 Twilight: The twilight projection places the centre of projection outside of the sphere, at the point (0,0,-1 - 12). This projection provides somewhat of a compromise between the stereographic and orthographic views in terms of its preservation of geometric fea- tures.\n\u2022 Orthographic: Finally, the orthographic projection sets the point of projection at (0,0,-) (mathematically speaking, the operator P-\u221e is the limit in operator norm of the sequence of operators (Pn) as n \u2192 -\u221e). This map projection is azimuthal, which means that directions from the cen- tre point to any other point on the map are"}, {"title": "", "content": "preserved. There is however, high distortion to shape and area.\nFor a detailed exploration of map projections, see [6].\nIn this paper, we generalise the term 'map projection' to higher dimensions, enabling the defi- nition to include projections of hyperspheres of arbitrary finite dimension to their tangent hyper- planes. We shall now introduce the notation re- quired to handle such projections. For a subset W of a vector space V, and some element p\u2208 V, we write W -p to denote the subset {w-p : w \u2208 W} of V.\nDefinition 3.1. Let H be a Hilbert space over a field K. Fix some constants a \u2208 Hand b \u2208 K, and consider the hyperplane\n$W = \\{x \\in H : \\langle a, x \\rangle = b\\}$\nof H.\nThe projection from 0 to W is defined as the operator $P^W_0: H \\rightarrow H $ with action\n$x \\mapsto x - \\frac{\\langle a, x \\rangle -b}{\\|a\\|^2} a$\nfor all x \u2208 H.\nFix a point p\u2208 H. The projection from p to W is then defined as the function $P^W_p : H \\rightarrow H$ with action\nx \u2192 $P^W_0(x+p)+p$\nfor every x \u2208 \u041d.\nRemark 3.2. Definition 3.1 does not typically define a projection in the operator-theoretic sense since its span is an affine subspace of H rather than a true subspace whenever W does not con- tain the origin. This can prevent the function $P^W_p$ from being linear.\nFrom here on, we will consider only map projections from a point of projection along the $X_n$ axis of Rn+1 onto the tangent hyperplane W defined by equation xn = 1. It will be helpful for us to identify the hyperplane W with Rn, which will be done by ignoring the final coordinate of each point in W, which is always equal to 1. This process is incorporated into Definition 3.3 below, which provides us with a class\n$\\left\\{P_a : a \\in [-\\infty,1)\\right\\}$\nof map projections, containing the four map pro- jections discussed earlier."}, {"title": "", "content": "Definition 3.3. Let a \u2208 (-\u221e,1) and let n\u2208N. Let\nW = {(xi)=0 \u2208 Rn+1 : xn = 1},\nand set p = (0,0,...,0,a) \u2208 Rn+1. Then define Pa \u2208 B(Rn+1; R"}, {"title": "", "content": "Lemma 3.4. Let x = (x0,x1,...,xn) \u2208 SRn+1 for some n \u2208 N, let a \u2208 (\u2212\u221e,1) and let Pa \u2208 B(Rn+1; Rn) be as in Definition 3.3. Then\n$Pax = \\frac{1}{(x_n - \\alpha)} (x_0,x_1,..., x_{n-1}) $.\nProof. Set Pax = (xi)=0, and set i \u2208 {0, ..., n \u2212\n1}. Recall that Pax can be defined as the unique point in Rn+1 with nth coordinate equal to 1, colinear with both x and (0,...,0,a), with its nth coordinate then removed. When viewing Pax through this lens, as pictured in Figure 1, we see that\n$\\frac{x_i}{1-\\alpha} = \\frac{x_i}{x_n-\\alpha}$.\nThe result follows."}, {"title": "", "content": "Proposition 3.5. Let n \u2208 N. Take a \u2208 [\u2212\u221e, 1), and let Pa \u2208 B(Rn+1; Rn) be as in Definition 3.3. Define the sets Sa and Ra as follows.\n(i) If a \u2208 [\u22121,1), set\n$S_a = \\{(x_i)_{i=0}^{n} \\in S^{n+1}: x_n > a\\}$,\nand let Ra = Rn.\n(ii) If a \u2208 (-\u221e, -1), set\n$S_a = \\{(x_i)_{i=0}^{n} \\in S^{n+1}: x_n \\geq \\frac{a}{1\\}\\}$,\nand let\n$R_a = \\frac{\\sqrt{a^2-1}}{|\\alpha +1|} B^{R^n}$.\n(iii) If a = -\u221e, set\n$S_a = \\{(x_i)_{i=0}^{n} \\in S^{n+1}: x_n \\geq 0\\}$,\nand let Ra = $B^{R^n}$.\nThen $P_a |S_a : S_a \\rightarrow R_a$ is a bijection.\nProof. We begin by showing that $P_a |R_a$ is injective. Notice that there can be at most two points on the surface of the hypersphere Srn+1 colinear with both the point of projection (0,0,..., 0, \u03b1) and the tangent hyperplane defined by xn = 1. The set Sa is defined specifically to only contain one such point. This tells us that if x, y \u2208 SRn+1"}, {"title": "", "content": "with Pax = Pay, then only one of x and y can belong to Sa. This proves that $P_a |R_a$ is injective as required.\nNow, we check that $P_a |R_a$ is surjective. Let y = (yi) Ra. For a \u2208 (-\u221e,1), we notice that a line connecting (0,...,0, a) and (Yo, \u2026\u2026\u2026, Yn\u22121, 1) intersects Sa exactly once, proving the claim. Finally, for a = -\u221e, taking x = (Y0,..., Yn\u22121,xn) where\n$x_n = \\sqrt{1 - \\sum_{i=0}^{n-1}y_i^2 }$,\nwe see that x \u2208 Sa with Pa(x) = y.\nAs alluded to in the above proof, the subsets Sa of Srn+1 are specifically defined in order to make Palsa injective. The intuition behind their defi- nitions is that a line which intersects the point of projection (a,0,...,0) and the hypersphere SRn+1, can intersect Srn+1 at most twice. In cases where there are two such intersection points, the set Sa is chosen to include only one of these two points - the one closest to the plane of projection defined by In = 1."}, {"title": "Definition of Ea for a \u2208 [\u22120,1)", "content": "Fix n\u2208 N. Our goal for this section will be to define for every a \u2208 [\u2212\u221e,1), a map Ea: Rn \u2192 Rn+1, with range contained in the closed unit sphere Srn+1 of Rn+1. The map Ea will in part be defined to be an inverse of the bijection $P_a |R_a$ as calculated in Proposition 3.5.\nSince the range $P_a$ of $P_a |R_a$ is bounded whenever a < -1, and we require Ea to be defined on the entirety of R\", we define the action of Ea to map points outside of Ra to points on the boundary of Sa. This of course makes the map Ea not injective, however this will not be a problem when utilising Ea as a quantum embedding since in practice, any distinct data points which Ea identifies can always be considered extreme outliers.\nThat Ea is defined on the entirety of Rn will be of key importance in Section 5, where we wish to consider the interactions between Ea and group representations on Rn and Rn+1.\nDefinition 4.1. Let n \u2208 N and a \u2208 [\u2212\u221e,1). Let Pa be as in Definition 3.3, and let Ra and Sa be as in Proposition 3.5. Define Ea : Rn \u2192 Rn+1 to have action\n$ E_a(x) = \\begin{cases}\n(P_a |S_a)^{-1}(x) & \\text{if x }\\in R_a, \\\\\n (P_a |S_a)^{-1}(\\beta x) & \\text{if x }\\in R^n \\backslash R_a\n\\end{cases} $\nHere, \u03b2 = ||x||-1 if a = \u2212\u221e, and\n$\\beta = \\frac{\\frac{\\alpha}{\\alpha+1}}{\\|x\\|}$  for every a \u2208 (-\u221e, \u22121).\nProposition 3.5 proves that for every a \u2208 [-\u221e,1), Ea is well-defined. Akin to Lemma 3.4, for the benefit of future calculations and to reduce the abstractness of our methods, we give our next result, which concretely expresses the final coor- dinate of the image of an arbitrary point under Ea. To this end, for each n \u2208 N, 0 \u2264 i \u2264 n, x \u2208 Rn and a \u2208 [\u2212\u221e, 1), write Ea(x); to denote the ith coordinate of Ea(x).\""}, {"title": "", "content": "Lemma 4.2. Fix n \u2208 N, and let x = (xi)=d e\nRn. Let a \u2208 (-\u221e,1), and let Ea \u2208 B(Rn; Rn+1) be as in Definition 4.1, with Ra and Sa as in Proposition 3.5."}, {"title": "", "content": "If x \u2208 Ra, let s = ||x||, and if x \u2260 Ra, let\n$\\xi = \\sqrt{\\frac{a-1}{a+1}}$. Then\n$\\Ea(x)n = \\frac{-B + \\sqrt{B^2 - 4AC}}{2A}$\nwhere\nA = s\u00b2 + (1 \u2212 a)\u00b2, \u0392 = \u22122as,\nC = s\u00b2a\u00b2 \u2013 (1 \u2212 a)\u00b2 .\nMoreover, if a = \u2212\u221e and x \u2208 Ra, then\nEa(x)n = $\\sqrt{1 - \\|x\\|^2}$,\nand if x & Ra, we have that\nEa(x)n = 1.\nIn particular, Ea(x)n is a function of only ||x|| and a.\nProof. Suppose first that a \u2208 (-\u221e,1) and x \u2208\nRa. Embed x in the natural way into the hy- perplane of Rn+1 defined by equation xn = 1, to obtain the vector x' = (X0,...,Xn-1,1). Then Ea(x) is the point in Sa colinear with both x' and (0,..., 0, \u03b1).\nFrom Lemma 3.4, we see that\n$E_a(x)i = \\frac{E_a(x)_n - a}{1-\\alpha} x_i$\nfor every i \u2208 {0,...,n - 1}. Now using the fact that Ea(x) has norm 1, we deduce that\n$\\sum_{i=0}^{n-1}E_a(x)_i^2 = 1 - \\sum_{i=0}^{n}E_a(x)_i^2$\n$=1- \\sum_{i=0}^{n-1} \\frac{(E_a(x)_n - a)^2}{(1 - \\alpha)^2} x_i^2 $\n$=1- \\frac{(E_a(x)_n - a)^2}{(1 - \\alpha)^2} ||x||^2$.\nThe result follows from using the quadratic for- mula to find Ea(x)n from the above equation, se- lecting the unique solution which belongs to the set Sa.\nSimilarly, for a = -\u221e and x \u2208 Ra, we get that\n$E_a(x) = \\sqrt{1 - \\|x\\|^2}$\nbecause the norm of Ea(x) must be equal to 1. From this, the conclusion follows easily.\nThe cases for x & Ra follow from applying the same methods to a version of x scaled by \u1e9e to belong to the boundary of Ra. Thus Ea(x)n is a function of only ||x|| and a as claimed."}, {"title": "Group Equivariance", "content": "The authors would like to stress that the representation theoretic fundamentals at the beginning of this section are not new, and can be found in e.g., [8, 13]. However, we believe that it is important for a complete understanding to give each result formally alongside a mathematically rigorous proof.\nFurther examples of equivariant embeddings in QML can be found in [8, 9, 10].\nDefinition 5.1. Let G be a group, and let V and W be vector spaces. Let \u03c8 : G \u2192 B(V) and \u00a2 : G \u2192 B(W) be representations of G on V and W respectively.\nA function f: V \u2192 W is said to be equivariant with respect to G (with representations & and $) if for all g\u2208 G, we have that\n$f(\\psi(g)v) = \\phi(g)f(v)$,         \u2200\u03c5\u2208 V.\nAn important feature of equivariant functions is that the property of equivariance is preserved under composition. The following proposition states this clearly. For brevity, during this sec- tion we may omit the precise description of which group representations some functions are equiv- ariant under. This is often clear from context and should not cause confusion."}, {"title": "", "content": "Proposition 5.2. Let G be a group, and let V,W, and X be vector spaces. Let : G \u2192 B(V), \u00a2 : G \u2192 B(W), and \u03be : G \u2192 B(X) be representations of G on V, W, and X respectively. Let f: V \u2192 Wandh:W \u2192 X be equivariant with respect to G. The composition hof: V \u2192 X is equivariant with respect to G.\nIt follows that any composition of finitely many functions that are equivariant with respect to G, is an equivariant function with respect to G.\nProof. Since f and h are equivariant with respect to G, we have for all v \u2208 V, w \u2208 W, and g \u2208 G, f(\u03c8(g)v) = $(g)f(v), and h($(g)w) = \u03be(g)h(w)\nSo, we have\n(hof)(\u03c8(g)v) = h($(g)f(v))\n= \u03be(g)h(f(v)) =\u03be(g)(h\u25e6 f)(v) .\nThis proves that hof is equivariant with respect to G as required.\nThe second claim pertaining to composing ar- bitrarily many equivariant functions follows from a simple induction argument."}, {"title": "", "content": "Now, consider the fact that gates in a quantum circuit are simply manifestations of unitary oper- ators on Hilbert spaces, and expectations of mea- surements of quantum systems are themselves simply functions from the set of possible quan- tum states to the real line. If a chosen embed- ding mapping classical data to a quantum state is equivariant with respect to a given group, and so is every gate and measurement enacted on that state in a quantum circuit, the entire quantum circuit will then be equivariant with respect to said group. In such a circuit, inputs related by some symmetry group will always yield outputs related by the same symmetry (modulo the ef- fects of noise). The upshot of this for QML is that information about symmetry in the data no longer needs to be learned by an equivariant vari- ational quantum circuit - this information about the data is incorporated to the structure of the model even before training. In certain cases, this can lead to dramatic increases in training accu- racy and training speed.\nProposition 5.4 provides us with a simple method of determining whether a gate is equivari- ant. For its proof, we require the following basic group theoretic lemma."}, {"title": "", "content": "Lemma 5.3. Let G be a group, and let h \u2208 G.\nThe function $L_h : G \\rightarrow G$ defined by $L_\u0127(g) = hg$ for every g\u2208 G, is a bijection.\nProof. Taking 91,92 \u2208 Gif Lh(91) = Lh(92), then\ng1 = h\u00ae\u00b9hg1 = h^{-1}L_h(91)\n= h^{-1}L_h(92) = h^{-1}hg_2 = g_2\nso Lh is injective. Further, for all g\u2208 G, we have that g = Ln(h-\u00b9g), so L\u0127 is surjective.\nWe hereon restrict our scope to finite groups. A version of the following proposition for Lie groups exists and can be found in e.g., [8], however this is outside the scope of this paper.\nProposition 5.4. Let G be a finite group, let V be a Hilbert space, and let $ : G \\rightarrow B(V)$ be a unitary representation of Gon V. The function T\u00a2 : B(V) \u2192 B(V) defined by\n$ T_{\\phi}(U) = \\frac{1}{|G|} \\sum_{g \\in G} \\phi(g)U\\phi(g)^*,         \\forall U \\in B(V) $\nis a projection of B(V) onto the space of opera- tors equivariant with respect to G.\nProof. Let U \u2208 B(V), v \u2208 V, and h\u2208 G. Then\n$ T_{\\phi}(U)\\phi(h)v = \\frac{1}{|G|} \\sum_{g \\in G} \\phi(g)U\\phi(g)^*\\phi(h)v$\n$= \\frac{\\phi(h)}{|G|} \\sum_{g \\in G} \\phi(g)U\\phi(g)^*\\phi(h)v$\n$= \\frac{\\phi(h)}{|G|} \\sum_{g \\in G} \\phi(g)^*\\phi(g^{-1}h)U v$\n$= \\frac{\\phi(h)}{|G|} \\sum_{x \\in G} \\phi(x)^*\\phi(x)U v $\n$= \u03c6(h)T(U)\u03c5,\nwhere the penultimate equality holds because Lemma 5.3 allows us to replace the terms of the summation as shown. Thus To(U) is equivariant with respect to G. Next, we show that To is idempotent. Indeed,\n$T_{\\phi}(T_{\\phi}(U)) = \\frac{1}{|G|} \\sum_{g \\in G} \\phi(g) (\\frac{1}{|G|} \\sum_{h \\in G} \\phi(h)U\\phi(h)^*) \\phi(g)^*$\nExpanding and rearranging, we get\n$ T_{\\phi}(T_{\\phi}(U)) = \\frac{1}{|G|^2} \\sum_{g \\in G, h \\in G} \\phi(gh)U\\phi(gh)^* $. Again, two further applications of Lemma 5.3 al- low us to rewrite the the sum above, from which we obtain\n$T_{\\phi}(T_{\\phi}(U)) = \\frac{1}{|G|} \\sum_{x \\in G} \\phi(x)U\\phi(x)^* = T(U)$.\nFurther simple direct calculations show that To is linear, which completes the proof."}, {"title": "", "content": "Given a representation & of a finite group on a Hilbert space H, the idempotence of To allows us to easily identify the unitary operators on H that are equivariant. These are exactly those unitaries U \u2208 B(H) satisfying T\u2084(U) = U.\nNow armed with the knowledge of how to find equivariant gates for a given group repre- sentation, and how equivariant circuits can be constructed through compositions of equivariant gates, measurements, and embeddings, we con- clude this section with the final ingredient re- quired for us to utilise our embeddings Ea for equivariant QML - the proof that they are indeed equivariant embeddings.\nTheorem 5.5. Let G be a group, let n \u2208 N and let p be any unitary representation of G on Rn. Let 1 : G \u2192 B(R) be the trivial representation of Gon R.\nThe direct sum p\u2295\u0131 is a unitary representation of G_on Rn+1, and for any a\u2208 [\u2212\u221e,1), \u0395a is equivariant with respect to G with representations pand\u03c1\u03b9.\nProof. The fact that p\u2295\u03b9 is a unitary represen- tation of G on Rn+1 follows simply from the fact that i and pare unitary representations of Gon R and Rn respectively.\nUsing Lemma 4.2, we may take a function\nf : [0,\u221e) \u00d7 [-\u221e,1) \u2192 R\nfor which\nEa(x)n = f(||x||, \u03b1)\nfor every x \u2208 Rn and every a \u2208 [\u2212\u221e,1).\nTo prove the claim about equivariance, fix a \u2208 [-\u221e,1), set g\u2208 G and let x \u2208 Rn. Because pis a unitary representation, we have that\n$\\rho(g)x\\| = \\|x\\| $."}, {"title": "", "content": "Therefore,\n$ (\\rho \\oplus \\iota)(9) E_{\\alpha}(x)$\n$= \\rho(9)(\\Ea(x)i=\\iota(9)E_{\\alpha}(x)n$\n$= \\rho(9)(\\Ea(x))=f(\\|x\\|, a)\n$= \\rho(g)(\\Ea(x)) \\oplus f(\\|\\rho(g)(x)\\|a) $\n$= \\rho(9)(\\Ea(x)) E_{\\alpha}(\\rho(g)(x))n$.  (5)\nConsider the definition of the set Ra as in Proposition 3.5. No matter the value of a, Ra is either a hypersphere centred at the origin, or it is the entire space Rn. Since p(g) is unitary, it is an isometry, and it follows that x \u2208 Ra if and only if p(g)x \u2208 Ra. Thus, because p(g) is linear, we can hereon restrict ourselves to the case for x \u2208 Ra (else, replace x with \u1e9ex before proceed- ing, where \u1e9e is as in Definition 4.1).\nLemma 3.4 then tells us that\n$\\rho(g)(\\Ea(x)) = \\rho(g)(\\frac{(f(\\|x\\|,a)-a)}{(1-\\alpha)} p(g)(x))$ $\n$=  \\frac{(f(\\|\\rho(g)(x)\\|,a)-a)}{(1-\\alpha)} p(g)(x)$\n$= E_a(\\rho(g)(x))$   (6)\nCombining Equations (5) and (6) now gives\n$\\rho \\oplus \\iota)(9) E_{\\alpha}(x) =  E_a(\\rho(g)(x)) +  E_a(\\rho(g)(x))n = E_a(\\rho(g)(x))$\ncompleting the proof.\nTo intuit the above theorem, think of unitary operators on Hilbert spaces as generalised rota- tions about the origin and reflections about some hyperplane through the origin. Then observe that to rotate or reflect a vector in Rn and then embed it to the unit hypersphere of Rn+1 using Ea, is to perform the same action as to embed that vector"}]}