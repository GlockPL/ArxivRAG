{"title": "Reverse Map Projections as Equivariant Quantum Embeddings", "authors": ["Max Arnott", "Dimitri Papaioannou", "Kieran McDowall"], "abstract": "We introduce the novel class (\u0395\u03b1)\u03b1\u20ac[\u2212\u221e,1) of reverse map projection embeddings, each one defining a unique new method of encoding classical data into quantum states. Inspired by well-known map projections from the unit sphere onto its tangent planes, used in practice in cartography, these embeddings address the common drawback of the amplitude embedding method, wherein scalar multiples of data points are identified and information about the norm of data is lost.\nWe show how reverse map projections can be utilised as equivariant embeddings for quantum machine learning. Using these methods, we can leverage symmetries in classical datasets to significantly strengthen performance on quantum machine learning tasks.\nFinally, we select four values of a with which to perform a simple classification task, taking Ea as the embedding and experimenting with both equivariant and non-equivariant setups. We compare their results alongside those of standard amplitude embedding.", "sections": [{"title": "Introduction", "content": "In today's noisy, intermediate scale quantum (NISQ) era of quantum computing, quantum algorithms face challenges from hardware limitations, including qubit quantity, connectivity, and noise [1]. To reduce the negative effects of these challenges for the purpose of quantum machine learning (QML), they must be considered at every step of the QML process: data embedding, computation, and measurement. Particularly, clever choices of 'classical-to-quantum' embedding schemes and efficient quantum circuits are essential to maximise the utility of current quantum resources.\nThe mapping of a classical dataset D to a set of quantum states is the necessary first step for said data to be processed by a quantum computer. Precisely, we are required to construct some map E from D to the unit sphere of a Hilbert space H, which is the state space of the given quantum computer. Popular embedding schemes in quantum information science include basis encoding, amplitude embedding, and angle embedding. Basis encoding works by taking a datapoint b expressed in binary, and assigning it the quantum state |b\u27e9, which belongs to the standard orthonormal basis of the quantum computer. Amplitude embedding maps a classical vector x = (xi)i=0 to the quantum state\n$\\frac{1}{||x||_2} \\sum_{i=0}^{2^n-1} x_i |i\\rangle$.\nAngle embedding uses rotation gates to encode classical data into a quantum state, by mapping a real vector (xi)i=0 to the state\n$\\bigotimes_{i=0}^{n} R_x(x_i) |0\\rangle$\n[2, 3, 4].\nA projection on a Hilbert space H is always surjective when restricted to its complemented range. As such, embeddings can often be thought of as partial inverses to projections. Predefined projections on Hilbert spaces, and their domain restrictions to the unit sphere, can therefore serve naturally as inspiration for those looking to define new quantum embedding schemes.\nCartographers have defined a plethora of projections to send the three dimensional surface of"}, {"title": "Preliminaries", "content": "Here, we explain in detail the mathematical terminology, conventions, and notation used throughout. We remark that the notation (\u22c5,\u22c5) has been chosen to denote inner products in this paper as opposed to the Dirac notation \u27e8\u22c5|\u22c5\u27e9 more commonly seen in quantum-related material. Due to the pure mathematical nature of large portions of our research, we decided to align our notation to the pure mathematical convention.\nWe write N for the set of natural numbers, R for the set of real numbers, and C for the set of complex numbers. Henceforth, the notation K may denote either field R or C.\nLet V be a vector space over K, with norm \u2225\u22c5\u2225. The closed unit ball of V is the set\n$B_V = \\{v \\in V : ||v|| \\le 1 \\}.$\nThe unit sphere SV of V is the set of exterior points of BV, that is,\n$S_V = \\{v \\in V : ||v|| = 1 \\}.$\nA Hilbert space H is an inner product space which is complete with respect to the norm derived from its inner product. Completeness in this context is the property that every Cauchy sequence in H is convergent, with limit in H. For"}, {"title": "Basics", "content": "for every n \u2208 N, the space Kn is a Hilbert space with respect to the inner product\n$\\langle (x_i), (y_i) \\rangle = \\sum_{i=0}^{n-1} x_i \\overline{y_i}$\nfor every (xi), (yi) \u2208 Kn, which yields the norm\n$\\sqrt{\\langle x, x \\rangle} = (\\sum_{i=0}^{n-1} |x_i|^2)^{\\frac{1}{2}}$\nFrom here on, we drop the subscript 2 when using the above norm. Throughout this paper, when n\u2208 N is given, we use the convention that vectors in n + 1 dimensional spaces are indexed by the set {0,1,..., n} whereas vectors in n dimensional spaces are indexed by {0, 1, . . ., n \u22121}."}, {"title": "Operators", "content": "A bounded operator from a Hilbert space H to a Hilbert space G is a continuous, linear function H \u2192 G. We write B(H;G) for the vector space of all bounded operators from H to G, and we abbreviate B(H; H) to B(H).\nLet T\u2208 B(H;G) for some Hilbert spaces H and G. We write T* \u2208 B(G;H) to denote the adjoint (or dual) of T, that is, the unique operator for which\n$\\langle Tx, y \\rangle = \\langle x, T^* y \\rangle,$\nfor every x \u2208 H and every y\u2208G.\nAn operator U \u2208 B(H) on a Hilbert space H is unitary if\n$UU^* = U^*U = I_H,$\nwhere IH is the identity operator on H with action x \u21a6 x for every x \u2208 H. Unitary operators U on H are isometries, meaning that for every x \u2208 H, we have \u2225Ux\u2225 = \u2225x\u2225.\nA projection on a Hilbert space H is an operator P\u2208 B(H) for which\n$P^2 = P^* = P$.\nThe range P(H) of P is then a complemented subspace of H, and thus, when convenient, we may identify a projection P with its corestriction to P(H), so that P\u2208 B(H; P(H)). We shall always make clear the domain and codomain of all projections, so this will not cause confusion."}, {"title": "Group Representations", "content": "Let G be a nonempty set, equipped with a binary operation \u22c5 . We say that G is a group under \u22c5 if it satisfies the following three conditions.\n$\\forall f,g,h \\in G, (f\\cdot g) \\cdot h = f \\cdot (g\\cdot h).$\n$\\exists e \\in G \\text{ such that } \\forall g \\in G, e\\cdot g = g\\cdot e = g.$\n$\\forall g \\in G, \\exists g^{-1} \\in G \\text{ such that } g \\cdot g^{-1} = g^{-1} \\cdot g = e.$\nLet G be a group, and let H be a Hilbert space. A representation of G on H is a function \u03c1 : G \u2192 B(H) for which \u03c1(g) is invertible (i.e., bijective) and\n$\\rho(g)\\rho(h) = \\rho(g\\cdot h)$\nfor every g,h \u2208 G. If we further have that \u03c1(g) is a unitary operator for every g\u2208 G, we say that \u03c1 is a unitary representation. For a unitary representation \u03c1 of G, we also have that\n$\\rho(g)^* = \\rho(g^{-1})$\nfor every g\u2208 G. If \u03c1(g) = IH for every g \u2208G, then \u03c1 is called the trivial representation of G on H.\nLet \u03c11 and \u03c12 be representations of a group G on two Hilbert spaces H1 and H2 respectively. The direct sum \u03c11 \u2295 \u03c12 of \u03c11 and \u03c12 is the representation of G on H1 \u2295 H2 with action\n$((\\rho_1 \\oplus \\rho_2)(g))(x_1 \\oplus x_2) = \\rho_1(g)x_1 \\oplus \\rho_2(g)x_2$\nfor every g\u2208 G, x1 \u2208 H1, and x2 \u2208 H2.\nSee [12] for more information on representation theory in the context of QML."}, {"title": "Higher Dimensional Map Projections", "content": "A map projection, loosely defined, is any projection on R3 which is used primarily to map some subset of a sphere to a subset of a plane. Map projections are named for their use in cartography for creating maps of the earth [5]. For myriad topological reasons, distortions of certain geometric"}, {"title": "Definition 3.1.", "content": "Let H be a Hilbert space over a field K. Fix some constants a \u2208 Hand b \u2208 K, and consider the hyperplane\n$W = \\{x \\in H : (a, x) = b \\}$\nof H.\nThe projection from 0 to W is defined as the operator $P_W: H \\to H$ with action\n$x \\mapsto x - \\frac{(a, x) - b}{||a||^2}a$\nfor all x \u2208 H.\nFix a point p\u2208 H. The projection from p to W is then defined as the function $P_W^p: H \\to H$ with action\n$x \\mapsto P_W(x-p) + p$\nfor every x \u2208 H."}, {"title": "Remark 3.2.", "content": "Definition 3.1 does not typically define a projection in the operator-theoretic sense since its span is an affine subspace of H rather than a true subspace whenever W does not contain the origin. This can prevent the function $P_W^p$ from being linear.\nFrom here on, we will consider only map projections from a point of projection along the Xn axis of Rn+1 onto the tangent hyperplane W defined by equation xn = 1. It will be helpful for us to identify the hyperplane W with Rn, which will be done by ignoring the final coordinate of each point in W, which is always equal to 1. This process is incorporated into Definition 3.3 below, which provides us with a class\n$\\big\\{P_a : a \\in [-\\infty, 1)\\big\\}$\nof map projections, containing the four map projections discussed earlier."}, {"title": "Definition 3.3.", "content": "Let a \u2208 (\u2212\u221e, 1) and let n\u2208N. Let\n$W = \\{(x_i)_{i=0}^n \\in R^{n+1} : x_n = 1\\},$\nand set p = (0,0,...,0,a) \u2208 Rn+1. Then define Pa \u2208 B(Rn+1; Rn) to have action\n$P_a x = (P_W^p x)_{i=0}^{n-1}$\nfor every x \u2208 Rn+1, where PW is in the notation of Definition 3.1.\nFurther, define P\u2212\u221e \u2208 B(Rn+1; Rn) to have action\n$P_{-\\infty} (x_i)_{i=0}^n = (x_i)_{i=0}^{n-1}$\nfor every (xi)i=0 \u2208 Rn+1."}, {"title": "Lemma 3.4.", "content": "Let x = (x0,x1,...,xn) \u2208 SRn+1 for some n \u2208 N, let a \u2208 (\u2212\u221e, 1) and let Pa \u2208 B(Rn+1; Rn) be as in Definition 3.3. Then\n$P_a x = \\frac{1}{x_n - a} (x_0, x_1, ..., x_{n-1}).$\nProof. Set Pax = (x\u2032i)ni=0, and set i \u2208 {0, . . ., n \u2212 1}. Recall that Pax can be defined as the unique point in Rn+1 with nth coordinate equal to 1, colinear with both x and (0,...,0,a), with its nth coordinate then removed. When viewing Pax through this lens, as pictured in Figure 1, we see that\n$\\frac{x_i'}{1-a} = \\frac{x_i}{x_n-a}.$"}, {"title": "Proposition 3.5.", "content": "Let n \u2208 N. Take a \u2208 [\u2212\u221e, 1), and let Pa \u2208 B(Rn+1; Rn) be as in Definition 3.3. Define the sets Sa and Ra as follows.\n(i) If a \u2208 [\u22121,1), set\n$S_a = \\{(x_i)_{i=0}^n \\in S_{R^{n+1}} : x_n > a\\},$\nand let Ra = Rn.\n(ii) If a \u2208 (\u2212\u221e, \u22121), set\n$S_a = \\{(x_i)_{i=0}^n \\in S_{R^{n+1}} : x_n \\ge \\frac{a}{\\sqrt{a^2+1}}\\},$\nand let\n$R_a = \\frac{\\sqrt{a^2-1}}{a+1} B_{R^n}.$\n(iii) If a = \u2212\u221e, set\n$S_a = \\{(x_i)_{i=0}^n \\in S_{R^{n+1}} : x_n \\ge 0\\},$\nand let Ra = BRn.\nThen $P_{a\\vert R_a} : S_{a\\vert S_a} \\to R_a$ is a bijection.\nProof. We begin by showing that $P_{a\\vert R_a}$ is injective. Notice that there can be at most two points on the surface of the hypersphere SRn+1 colinear with both the point of projection (0,0,..., 0, \u03b1) and the tangent hyperplane defined by xn = 1. The set Sa is defined specifically to only contain one such point. This tells us that if x, y \u2208 SRn+1"}, {"title": "4 Definition of Ea for a \u2208 [\u22120,1)", "content": "Fix n\u2208 N. Our goal for this section will be to define for every a \u2208 [\u2212\u221e,1), a map Ea: Rn \u2192 Rn+1, with range contained in the closed unit sphere SRn+1 of Rn+1. The map Ea will in part be defined to be an inverse of the bijection $P_{a\\vert R_a}$ as calculated in Proposition 3.5.\nSince the range $P_{a\\vert R_a}$ of Pala is bounded whenever a < -1, and we require Ea to be defined on the entirety of R\", we define the action of Ea to map points outside of Ra to points on the boundary of Sa. This of course makes the map Ea not injective, however this will not be a problem when utilising Ea as a quantum embedding since in practice, any distinct data points which Ea identifies can always be considered extreme outliers.\nThat Ea is defined on the entirety of Rn will be of key importance in Section 5, where we wish to consider the interactions between Ea and group representations on Rn and Rn+1.\nLet n \u2208 N and a \u2208 [\u2212\u221e,1). Let Pa be as in Definition 3.3, and let Ra and Sa be as in Proposition 3.5. Define Ea : Rn \u2192 Rn+1 to have action\n$\\begin{cases}\n(P_{a\\vert R_a})^{-1}(x) & \\text{if } x \\in R_a, \\\\\n(P_{a\\vert R_a})^{-1}(\\beta x) & \\text{if } x \\in R^n \\backslash R_a\n\\end{cases}$\nHere, \u03b2 = \u2225x\u2225\u22121 if a = \u2212\u221e, and\n$\\beta = \\frac{\\sqrt{a^2+1}}{\\sqrt{a^2-1}} ||x||^{-1}$\nfor every a \u2208 (\u2212\u221e, \u22121).\nProposition 3.5 proves that for every a \u2208 [-\u221e,1), Ea is well-defined. Akin to Lemma 3.4, for the benefit of future calculations and to reduce the abstractness of our methods, we give our next result, which concretely expresses the final coordinate of the image of an arbitrary point under Ea. To this end, for each n \u2208 N, 0 \u2264 i \u2264 n, x \u2208 Rn and a \u2208 [\u2212\u221e, 1), write Ea(x); to denote the ith coordinate of Ea(x).\""}, {"title": "Lemma 4.2.", "content": "Fix n \u2208 N, and let x = (xi)i=0 \u2208 Rn. Let a \u2208 (\u2212\u221e,1), and let Ea \u2208 B(Rn; Rn+1) be as in Definition 4.1, with Ra and Sa as in Proposition 3.5."}, {"title": "functions Ea for a \u2208 [-0,1)", "content": "If x \u2208 Ra, let s = \u2225x\u2225, and if x \u2209 Ra, let\n$s = \\sqrt{\\frac{\\alpha-1}{\\alpha+1}}$. Then\n$E_a(x)_n = \\frac{-B + \\sqrt{B^2 - 4AC}}{2A}$\nwhere\n$A = s^2 + (1 - a)^2, B = -2as,$\n$C = s^2a^2 - (1 - a)^2$.\nMoreover, if a = \u2212\u221e and x \u2208 Ra, then\n$E_a(x)_n = \\sqrt{1 - ||x||^2},$\nand if x \u2209 Ra, we have that\n$E_a(x)_n = 1$.\nIn particular, Ea(x)n is a function of only \u2225x\u2225 and a.\nProof. Suppose first that a \u2208 (\u2212\u221e,1) and x \u2208 Ra. Embed x in the natural way into the hyperplane of Rn+1 defined by equation xn = 1, to obtain the vector x' = (X0,...,Xn\u22121,1). Then Ea(x) is the point in Sa colinear with both x' and (0,..., 0, \u03b1).\nFrom Lemma 3.4, we see that\n$\\frac{E_a(x)_i}{x_i} = \\frac{E_a(x)_n - a}{1 - a}$\nfor every i \u2208 {0,...,n - 1}. Now using the fact that Ea(x) has norm 1, we deduce that\n$\\sum_{i=0}^{n-1} E_a(x)_i^2 = 1 - \\sum_{i=0}^{n-1} E_a(x)_i^2$\n$E_a(x)_i = 1 - \\sum_{i=0}^{n-1} \\frac{(E_a(x)_n - a)^2}{(1 - a)^2} x_i^2$\n$E_a(x)_i = 1 - \\frac{(E_a(x)_n - a)^2}{(1 - a)^2} ||x||^2.$\nThe result follows from using the quadratic formula to find Ea(x)n from the above equation, selecting the unique solution which belongs to the set Sa.\nSimilarly, for a = -\u221e and x \u2208 Ra, we get that\n$E_a(x)_i = 1 - ||x||^2$\nbecause the norm of Ea(x) must be equal to 1. From this, the conclusion follows easily.\nThe cases for x \u2209 Ra follow from applying the same methods to a version of x scaled by \u03b2 to belong to the boundary of Ra. Thus Ea(x)n is a function of only \u2225x\u2225 and a as claimed.\nWe finish this section with a brief explanation of how the functions Ea for a \u2208 [-0,1) can be used as classical-to-quantum data embeddings. The state space of a quantum computer of n qubits is the complex Hilbert space H of dimension 2n. The set of possible quantum states on said quantum computer is given by SH. Clearly, R2n is a subspace of H, and SR2n is a subset of SH. We henceforth consider Ea as a function with range H by identifying Ea with the composition of Ea and the canonical embedding R2n to C2n. Expressed in standard Dirac notation, for each n\u2208 N, and each a \u2208 [\u2212\u221e,1), we map the vector x\u2208 R2n\u22121 to the quantum state |Ea(x)\u27e9 defined as\n$|E_a(x)\u27e9 := \\sum_{i=0}^{2^n-1} E_a(x)_i |i\u27e9.$"}, {"title": "Group Equivariance", "content": "The authors would like to stress that the representation theoretic fundamentals at the beginning of this section are not new, and can be found in e.g., [8, 13]. However, we believe that it is important for a complete understanding to give each result formally alongside a mathematically rigorous proof.\nFurther examples of equivariant embeddings in QML can be found in [8, 9, 10].\nLet G be a group, and let V and W be vector spaces. Let \u03c8 : G \u2192 B(V) and \u03d5 : G \u2192 B(W) be representations of G on V and W respectively.\nA function f: V \u2192 W is said to be equivariant with respect to G (with representations \u03c8 and \u03d5) if for all g\u2208 G, we have that\n$f(\\psi(g)v) = \\phi(g)f(v), \\quad \\forall v \\in V.$"}, {"title": "5.1.", "content": "An important feature of equivariant functions is that the property of equivariance is preserved under composition. The following proposition states this clearly. For brevity, during this section we may omit the precise description of which group representations some functions are equivariant under. This is often clear from context and should not cause confusion.\nLet G be a group, and let V,W, and X be vector spaces. Let \u03c8 : G \u2192 B(V), \u03d5 : G \u2192 B(W), and \u03be : G \u2192 B(X) be representations of G on V, W, and X respectively."}, {"title": "Proposition 5.2.", "content": "Let f: V \u2192 Wandh:W \u2192 X be equivariant with respect to G. The composition hof: V \u2192 X is equivariant with respect to G.\nIt follows that any composition of finitely many functions that are equivariant with respect to G, is an equivariant function with respect to G.\nSince f and h are equivariant with respect to G, we have for all v \u2208 V, w \u2208 W, and g \u2208 G, f(\u03c8(g)v) = \u03d5(g)f(v), and h(\u03d5(g)w) = \u03be(g)h(w) So, we have\n$(h\\circ f)(\\psi(g)v) = h(\\phi(g)f(v))$\n$\\quad = \\xi(g)h(f(v)) = \\xi(g)(h\\circ f)(v) .$\nThis proves that hof is equivariant with respect to G as required.\nThe second claim pertaining to composing arbitrarily many equivariant functions follows from a simple induction argument.\nNow, consider the fact that gates in a quantum circuit are simply manifestations of unitary operators on Hilbert spaces, and expectations of measurements of quantum systems are themselves simply functions from the set of possible quantum states to the real line. If a chosen embedding mapping classical data to a quantum state is equivariant with respect to a given group, and so is every gate and measurement enacted on that state in a quantum circuit, the entire quantum circuit will then be equivariant with respect to said group. In such a circuit, inputs related by some symmetry group will always yield outputs related by the same symmetry (modulo the effects of noise). The upshot of this for QML is that information about symmetry in the data no longer needs to be learned by an equivariant variational quantum circuit - this information about the data is incorporated to the structure of the model even before training. In certain cases, this can lead to dramatic increases in training accuracy and training speed.\nProposition 5.4 provides us with a simple method of determining whether a gate is equivariant. For its proof, we require the following basic group theoretic lemma."}, {"title": "Lemma 5.3.", "content": "Let G be a group, and let h \u2208 G. The function Lh : G \u2192 G defined by Lh(g) = hg for every g\u2208 G, is a bijection.\nTaking g1,g2 \u2208 G if Lh(g1) = Lh(g2), then\n$g_1 = h^{-1}hg_1 = h^{-1}L_h(g_1)$\n$\\quad = h^{-1}L_h(g_2) = h^{-1}hg_2 = g_2$\nso Lh is injective. Further, for all g\u2208 G, we have that g = Lh(h\u22121g), so Lh is surjective."}, {"title": "Proposition 5.4.", "content": "Let G be a finite group, let V be a Hilbert space, and let \u03d5 : G \u2192 B(V) be a unitary representation of G on V. The function T\u03d5 : B(V) \u2192 B(V) defined by\n$T_{\\phi}(U) = \\frac{1}{|G|} \\sum_{g \\in G} \\phi(g)U\\phi(g)^*, \\quad \\forall U \\in B(V)$\nis a projection of B(V) onto the space of operators equivariant with respect to G.\nLet U \u2208 B(V), v \u2208 V, and h\u2208 G. Then\n$T_{\\phi}(U)\\phi(h)v = \\frac{1}{|G|} \\sum_{g \\in G} \\phi(g)U\\phi(g)^*\\phi(h)v$\n$\\qquad = \\frac{\\phi(h)}{|G|} \\sum_{g \\in G} \\phi(h)^*\\phi(g)U\\phi(g)^*\\phi(h)v$\n$\\qquad = \\frac{\\phi(h)}{|G|} \\sum_{g \\in G} \\phi(h^{-1}g)U\\phi(g^{-1}h)v$\n$\\qquad = \\frac{\\phi(h)}{|G|} \\sum_{x \\in G} \\phi(x)U\\phi(x)^*v$\n$\\qquad = \\phi(h)T_{\\phi}(U)v,$\nwhere the penultimate equality holds because Lemma 5.3 allows us to replace the terms of the summation as shown. Thus T\u03d5(U) is equivariant with respect to G. Next, we show that T\u03d5 is idempotent. Indeed,\n$T_{\\phi}(T_{\\phi}(U)) = \\frac{1}{|G|} \\sum_{g \\in G} \\phi(g) ( \\frac{1}{|G|} \\sum_{h \\in G} \\phi(h)U\\phi(h)^* ) \\phi(g)^*$\nExpanding and rearranging, we get\n$T_{\\phi}(T_{\\phi}(U)) = \\frac{1}{|G|^2} \\sum_{g \\in G} \\sum_{h \\in G} \\phi(gh)U\\phi(gh)^* .$"}, {"title": "Theorem 5.5.", "content": "Let G be a group, let n \u2208 N and let \u03c1 be any unitary representation of G on Rn. Let \u03b9 : G \u2192 B(R) be the trivial representation of G on R.\nThe direct sum \u03c1\u2295\u03b9 is a unitary representation of G on Rn+1, and for any a\u2208 [\u2212\u221e,1), Ea is equivariant with respect to G with representations \u03c1 and\u03c1\u2295\u03b9.\nProof. The fact that \u03c1\u2295\u03b9 is a unitary representation of G on Rn+1 follows simply from the fact that \u03b9 and \u03c1 are unitary representations of G on R and Rn respectively.\nUsing Lemma 4.2, we may take a function\n$f : [0,\\infty) \\times [-\\infty, 1) \\to R$\nfor which\n$E_a(x)_n = f(||x||, a)$\nfor every x \u2208 Rn and every a \u2208 [\u2212\u221e,1).\nTo prove the claim about equivariance, fix a \u2208 [\u2212\u221e,1), set g\u2208 G and let x \u2208 Rn. Because \u03c1 is a unitary representation, we have that\n$||\\rho(g)x|| = ||x|| .$"}, {"title": "5", "content": "Therefore,\n$((\\rho \\oplus \\iota)(g)) E_a(x)$\n$= \\rho(g) ((E_a(x)_i)_{i=0}^{n-1}) \\oplus \\iota(g) E_a(x)_n$\n$= \\rho(g) ((E_a(x)_i)_{i=0}^{n-1}) \\oplus f(||x||, a)$\n$= (\\rho(g)((E_a(x)_i)_{i=0}^{n-1})) \\oplus f(||\\rho(g)(x)||, a)$\n$= (\\rho(g)((E_a(x)_i)_{i=0}^{n-1})) E_a(\\rho(g)(x))_n .$\nConsider the definition of the set Ra as in Proposition 3.5. No matter the value of a, Ra is either a hypersphere centred at the origin, or it is the entire space Rn. Since \u03c1(g) is unitary, it is an isometry, and it follows that x \u2208 Ra if and only if \u03c1(g)x \u2208 Ra. Thus, because \u03c1(g) is linear, we can hereon restrict ourselves to the case for x \u2208 Ra (else, replace x with \u03b2x before proceeding, where \u03b2 is as in Definition 4.1).\nLemma 3.4 then tells us that\n$\\rho(g)((E_a(x)_i)_{i=0}^{n-1}) = \\rho(g) ((\\frac{f(||x||, a) - a}{1-a}) (x_i)_{i=0}^{n-1})$\n$ = ((\\frac{f(||\\rho(g)(x)||, a) - a}{1-a})) \\rho(g) (x_i)_{i=0}^{n-1}) = E_a(\\rho(g)(x)).$\nCombining Equations (5) and (6) now gives\n$((\\rho \\oplus \\iota)(g)) E_a(x)$\n$= E_a(\\rho(g)(x)) (\\frac{f(||\\rho(g)(x)||, a) - a}{1-a}) + E_a(\\rho(g)(x))_n$\n$= E_a(\\rho(g)(x)),$\ncompleting the proof."}, {"title": "Experiments", "content": "For a = 0, \u03b1 = \u22121, \u03b1 = \u22121\n2, and a = \u2212\u221e, we term the maps Ea from Definition 4.1 to be the reverse gnomonic, reverse stereographic, reverse twilight, and reverse orthographic embeddings respectively. The goal of this section is to display a series of comparisons between these embeddings.\nWe first do this by investigating their like-for-like performance on a basic machine learning classification task using a typical quantum neural network (QNN). The data for the classification task is chosen with labels that are invariant to a Z2 symmetry. Leveraging this symmetry, we also investigate the capacity of the four chosen embeddings as equivariant embeddings by performing the same classification task with a second QNN, of equal size, which is equivariant with respect to the symmetry group. A comparison of each embedding with an equivariant and non-equivariant setup can then also be made. We also include standard amplitude embedding in our comparisons.\nThe classification task with which to test our embeddings is to distinguish images of boots from images of sandals, with the footwear randomly directed to point either left or right. The reason behind this random flipping is that the equivariant QNN may have an advantage over the non-equivariant QNN when we specifically construct it to respect the symmetry of horizontally flipping the data. A sample of the data used is shown in Figure 3.\nBecause sandals are open footwear and boots are not, we can expect the greyscale images of boots to be more predominantly white in colour when compared to the images of sandals. As such, the data vector for a sandal will typically have a smaller euclidean norm than that of a boot. This norm value features prominently when using a reverse map embedding, but is lost information under standard amplitude encoding."}, {"title": "Setup", "content": "Take a \u2208 [\u2212\u221e, -1). The radius of Ra as in Proposition 3.5 is $\\frac{\\sqrt{a^2-1}}{a+1}$ if a \u2260 -\u221e, and is 1 for \u03b1 = \u2212\u221e. A key ingredient of Definition 4.1 is that data not contained in Ra is first scaled by some constant \u03b2 before the partial inverse of Pa is applied to it. It is desirable for this to exclusively happen in the case of extreme outliers, so for experiments, before applying Ea to the image data, we scale all the data down by dividing by some scalar M. The maximal euclidean norm of the data in our experiment is around 2500. Thus we set M = 800 before applying the reverse twilight embedding, and M = 2500 before applying the reverse orthographic embedding. For the cases of"}, {"title": "Non-Equivariant Model", "content": "The non-equivariant QNN model architecture consists of our selected embedding followed by one repetition of the hardware-efficient ansatz on 8 qubits, shown in Figure 5, followed by Pauli-Z measurements on all qubits."}, {"title": "Equivariant Model", "content": "Consider the coordinates (x,y) of a pixel in a given image in our dataset, so that 0 < x, y < 16. Express x and y in binary, so that they each have four digits. When we apply Ea, viewing through the lens of Equation (2), the value of pixel (x, y) corresponds to the amplitude of the orthonormal basis vector |x\u27e9 \u2297 |y\u27e9. The symmetrically related (under horizontal flipping) coordinate is (x, y'), where x' has the bit-flipped binary expression to x. To map |x\u27e9 \u2297 |y\u27e9 to |x'\u27e9 \u2297 |y\u27e9, or vice versa, we thus apply the tensor product X0 X1 X2 X3 of Pauli-X gates to the first four qubits.\nDenote the horizontal flip operation on the data space by H, and the identity operation by I. Then {I, H} is a group isomorphic to Z2. It is easy to see that the function from {I, H} to the state space of an 8 qubit quantum computer which sends I to the identity map and H to Xo X1 X2 X3, is a unitary representation. Theorem 5.5 shows that for every a\u2208 [\u2212\u221e,1), Ea is equivariant with respect to . An application of Proposition 5.4 is used to find a set of equivariant gates, and from this, the equivariant QNN architecture is set as shown in Figure 6.\nOn the first four qubits, Rxx(\u00b7), Ryy(\u00b7), and Rzz(\u00b7) gates replace the CNOT gates from the non-equivariant QNN, and Rx gates replace all Ry and Rz"}]}