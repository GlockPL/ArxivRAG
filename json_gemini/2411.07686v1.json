{"title": "Data-Driven Graph Switching for Cyber-Resilient Control in Microgrids", "authors": ["Suman Rath", "Subham Sahoo"], "abstract": "Distributed microgrids are conventionally dependent on communication networks to achieve secondary control objectives. This dependence makes them vulnerable to stealth data integrity attacks (DIAs) where adversaries may perform manipulations via infected transmitters and repeaters to jeopardize stability. This paper presents a physics-guided, supervised Artificial Neural Network (ANN)-based framework that identifies communication-level cyberattacks in microgrids by analyzing whether incoming measurements will cause abnormal behavior of the secondary control layer. If abnormalities are detected, an iteration through possible spanning tree graph topologies that can be used to fulfill secondary control objectives is done. Then, a communication network topology that would not create secondary control abnormalities is identified and enforced for maximum stability. By altering the communication graph topology, the framework eliminates the secondary control layer's dependence on inputs from compromised cyber devices helping it achieve resilience without instability. Several case studies are provided showcasing the framework's robustness against False Data Injections and repeater-level Man-in-the-Middle attacks. To understand practical feasibility, robustness is also verified against larger microgrid sizes and in the presence of varying noise levels. Our findings indicate that performance can be affected when attempting scalability in the presence of noise. However, the framework operates robustly in low-noise settings.", "sections": [{"title": "I. INTRODUCTION", "content": "Microgrids are cyber-physical systems with a hierarchical control framework that involves primary and secondary layers for voltage/frequency control and power-sharing regulations [1]. The microgrid secondary control layer is responsible for set-point tracking and relies on communication devices for nominal operations [2]. This makes the system vulnerable to stealth attacks compromising communication devices and manipulating data flow patterns [3]. Under the attacks' influence, this layer computes erroneous control signals that propagate further to jeopardize nominal operation [4]. A necessary requirement for convergence of secondary control inputs is to ensure a spanning tree in the cyber (communication graph) topology [5]. If this spanning tree relies on compromised network devices, then it would feed untrustworthy inputs to the secondary controller, forcing it to compute erroneous control signals [6]. Hence, it is essential to ensure that the communication graph topology on which the microgrid secondary control layer is dependent is free from manipulations in the cyber layer [7], [8]."}, {"title": "II. CONTROL STRUCTURE AND ATTACK FORMULATION", "content": "As shown in Fig. 1, this paper considers a conventional two-layered hierarchical control structure consisting of primary and secondary layers. A detailed description of their operational principles and functionalities is provided below:\n1) Primary Control: The primary layer's core objective is to achieve synchronization in voltage and frequency values for the regulation of active and reactive power sharing across Distributed Generators (DGs) in the microgrid. Droop-based primary power control action can be formulated as follows:\n$\\omega^*_l = \\omega_{nom} - D_{P_l} P_l$\n$v^*_l = V_{nom} - D_{Q_l} Q_l$\nwhere, $\\omega^*_l$ is the frequency at $l^{th}$ DG, $v^*_l$ is voltage, and $\\omega_{nom}$ and $V_{nom}$ are frequency and voltage set-points. $D_{P_l}$ and $D_{Q_l}$ signify the droop gains corresponding to active and reactive power controllers. The droop gains adhere to the following conditions in a N-DG microgrid:\n$D_{P_1} \\cdot P_1 = D_{P_2} \\cdot P_2 = ... = D_{P_N} \\cdot P_N = \\Delta \\omega_{max}$\n$D_{Q_1} \\cdot Q_1 = D_{Q_2} \\cdot Q_2 = ... = D_{Q_N} \\cdot Q_N = \\Delta v_{max}$\nwhere $\\Delta \\omega_{max}$ and $\\Delta v_{max}$ are the largest allowable values of frequency and voltage deviation respectively. As the primary controller has a droop-based operational framework, it results in voltage and frequency values dropping as real and reactive power values increase. To restore these values to normalcy, the secondary layer adopts a cooperative synchronization-based mechanism. This is described below.\n2) Secondary Control: The core objective of the secondary control layer is to remove the drop in parameter values created as a consequence of the primary controller's actions. To achieve this, it utilizes a set of localized distributed controllers each of which computes two feedback signals $\\delta \\omega_l$ and $\\delta v_l$ (for its corresponding DG) via cooperative synchronization. In this mechanism, one of the DGs is assigned the role of leader with access to reference setpoints equal to nominal values of frequency and voltage. As shown in Fig. 1, each controller is capable of communicating with its neighbors via a well-connected cyber network. The overall goals for the secondary layer can be formulated as:\n$\\lim_{t\\to\\infty} ||\\omega_l - \\omega_n|| = 0 \\forall l$\n$\\lim_{t\\to\\infty} ||D_{P_l} P_l - D_{P_m} P_m|| = 0 \\forall l, m$\n$\\lim_{t\\to\\infty} ||D_{Q_l} Q_l - D_{Q_m} Q_m|| = 0 \\forall l, m$\nTo achieve these goals, the $l^{th}$ secondary controller directly feeds $\\delta \\omega_l$ and $\\delta v_l$ to the primary power controller dynamics. Hence, the nominal control framework in distributed micro-grids achieves set-point tracking and global synchrony via the following power control dynamics at the local DG level:\n$\\omega^*_l = \\omega_{nom} - D_{P_l} P_l + \\delta \\omega_l$\n$V^*_l = V_{nom} - D_{Q_l} Q_l + \\delta v_l$\n$\\delta \\omega_l$ and $\\delta v_l$ are determined as per the following single integrator dynamics:\n$\\delta \\dot{\\omega}_l = K_1(\\sum_{m\\in N(l)} a_{lm}(\\omega_m - \\omega_l) + g_l(\\omega_n - \\omega_l)+\\sum_{m\\in N(l)} a_{lm} (D_{P_m} P_l - D_{P_l} P_l))$\n$\\delta \\dot{v}_l = K_2 (\\sum_{m\\in N(l)} a_{lm}(D_{Q_m} Q_m - D_{Q_l} Q_l))$\nwhere, $a_{lm}$ is an element of the adjacency matrix representing the communication spanning tree $s_r[i] \\in S_T$. $S_T$ is the set of spanning trees, each consisting of a unique set of network devices (e.g., transmitters, receivers, repeaters, etc). A noteworthy point is that each spanning tree in $S_T$ can achieve nominal secondary control objectives in the microgrid environment without affecting nominal stability.\nFurther, spanning trees for a microgrid (or for any graphical network for that matter) are non-unique in nature [13]. Each possible spanning tree in this context consists of a different set of communication devices (e.g., transmitters, repeaters, etc.). This means that every pair of non-unique spanning trees will have one or more non-overlapping communication elements.\n3) DIAs in the Communication Layer: DIAs in the microgrid environment are typically executed via the cyber layer. This paper considers two DIAs, each initiated from a unique vulnerable cyber device. The first DIA involves manipulations at the transmitter level. Access to one or more transmitters in the microgrid network means that the attacker can directly falsify information at the primary source and simultaneously mislead all the controllers that make decisions based on signals from the untrustworthy transmitter(s). The second DIA is achieved via repeater-level manipulations. In this case, the attacker can only falsify information to two different nodes simultaneously. The first one is the receiver of the recipient DG and the second one is the receiver of the transmitting DG. This is because a single repeater often handles bidirectional communication for any given pair of communicating DGs in the microgrid network.\nEach of the considered DIAs can affect the stability of the microgrid as it has a direct impact on the decisions of the secondary control layer and consequentially a cascading impact on the primary control layer. Hence, it is important that there be a dedicated framework to identify the presence of such DIAs and neutralize/alleviate their impact on microgrid system dynamics and nominal control operations."}, {"title": "III. ANN-BASED COMMUNICATION GRAPH SWITCHING", "content": "The microgrid system consists of inter-dependent physical and cyber layers. The physical layer consists of generators, load units, tie-lines, sensors, etc. The cyber layer consists of network devices that help in the exchange of information like transmitters, receivers, repeaters, etc. A crucial requirement for stability in distributed microgrids is the formation of a spanning tree at the communication network level. In the event of cyber-attacks, following a spanning tree communication network topology that is dependent on compromised network devices can lead to attack propagation and instability. We consider two attack vectors:\n1) FDI attacks which are executed via one or more compromised transmitters. In the network graph topology, transmitters are an integral part of the nodes. Hence, a compromised transmitter will mean that all outgoing in-formation from the node(s) is untrustworthy. Mitigation of this vector will require that no outgoing signal from a compromised node is utilized for the achievement of control objectives.\n2) MITM attacks via compromised signal repeaters. In the microgrid communication network graph, repeaters are part of the communication link (edge) and can be exploited to achieve bidirectional manipulation of infor-mation. Mitigation of MITM attacks will require that the corresponding link is not actively involved in feeding measurement signals to the secondary controllers.\nUsing compromised transmitters and/or repeaters in a commu-nication network topology makes it untrustworthy and inca-pable of achieving secondary control objectives. To determine the trustworthiness of the communication graph topology, we utilize a physics-guided ANN framework (visual depiction in Fig. 2) that is trained in a supervised manner to estimate the possibility of abnormal secondary control behavior that may be generated if it is continually used in the system. As shown in Fig. 3, in case the current topology is found to be untrustworthy and cyberattack-infected, the mitigation frame-work iterates through possible spanning tree communication graph topologies and identifies the one that preserves normalcy in the system. Prior analysis in [14] has shown that there will always be at least one trustworthy spanning tree topology even if (N-1) DGs in an N-DG microgrid are cyber-attack-infected. This means that unless 100% of the microgrid network is cyberattack-infected, at least one spanning tree can always achieve resilience even under the influence of active cyber manipulations. A detailed depiction of the ANN-assisted attack detection and topology switching framework is provided in the following text."}, {"title": "A. Physics-Guided Deep Learning for Cyber-Attack Indication", "content": "$\\delta \\dot{\\omega}_l$ and $\\delta \\dot{v}_l$ are essentially error computations between inter-DG sensor measurements. We use these terms to create a physics-guided principle for our ANN-based regression model that can estimate abnormal secondary control behavior indicating cyberattacks. Consider a fused sum of all secondary control signals ($T_{pr}$) in the microgrid model. Mathematically, we express this as:\n$T_{pr} = {\\sum_{l=1}^{N} \\delta \\dot{\\omega}_l + \\sum_{l=1}^{N} \\delta \\dot{v}_l}$\nFrom equations 10 and 11, we can write $T_{pr}$ as:\n$T_{pr} = \\sum_{l=1}^{N}(K_1(\\sum_{m\\in N(l)} a_{lm}(\\omega_m - \\omega_l) + g_l(\\omega_n - \\omega_l)+\\sum_{m\\in N(l)} a_{lm} (D_{P_m} P_l - D_{P_l} P_l)) + K_2(\\sum_{m\\in N(l)} a_{lm}(D_{Q_m} Q_m - D_{Q_l} Q_l)))$\nIn the steady state, the secondary control layer strives to achieve the objectives in equations 5, 6, and 7. This means that the following conditions would be satisfied:\n$\\omega_n \\approx \\omega_1 \\approx... \\approx \\omega_N$\n$D_{P_1} P_1 \\approx D_{P_2} \\cdot P_2 \\approx ... \\approx D_{P_N}\\cdot P_N$\n$D_{Q_1} Q_1 \\approx D_{Q_2} \\cdot Q_2 \\approx ... \\approx D_{Q_N} Q_N$\nUsing equations 14, 15, and 16, we can estimate a steady state value for $T_{pr}$ as:\n$T_{pr} \\approx 0$\nTo replace the approximate equality in the above equation with an exact equality, we introduce an infinitesimal term $\\sigma$.\n$T_{pr} = \\sigma$\nHowever, in the presence of FDI and MITM vectors, equation 18 becomes invalid. This is because the communicated signals {$\\omega$, P, Q} are modified by the attacker to incorporate a bad exogenous data signal $X_A$. Hence, in the presence of an attack vector,\n$T_{pr} = \\sum_{l=1}^{N}(\\sum_{m\\in N(l)} a_{lm}(\\omega_m - \\omega_l) + g_l(\\omega_n - \\omega_l)+$"}, {"title": "B. Optimal Spanning Tree Switching for Attack Mitigation", "content": "As shown in Fig. 3, on the receipt of the trigger, a Hold is initiated that keeps the state of the system immune from the estimated controller abnormality due to cyberattacks. The Hold is retained until the ANN is made to estimate $T_{pr}$ values for all the spanning trees in $S_T$. Finally, the first spanning tree graph topology with $T_{pr} = \\sigma$ is chosen as the active communication topology and nominal operations are resumed again. This preserves system stability in the presence of the cyberattack and removes the impact of the attack from the microgrid dynamics before it has a chance to affect the system. As depicted in Fig. 4 (a), this framework can also identify and isolate repeater-level DIAs. A noteworthy point is that the framework can achieve resiliency even if N - 1 transmitters in the microgrid network are cyberattack-infected. This is also depicted in Fig. 4 (b)."}, {"title": "C. Rationale Behind the Proposed Method", "content": "The rationale behind the proposed abnormality estimation method is derived from [10] which highlights that stealthy DIA attacks lead to the disruption of consensus among microgrid DGs diverging one or more secondary control outputs from their nominal value which is approximately 0. The method presented in [10] involves attack detection only after local sec-ondary controllers have processed them indicating cyberattack progression from the communication layer to the secondary control plane. This can lead to a higher risk of increased time delay and/or instability as the attack has already achieved a certain degree of penetration within the control plane. However, the regression mechanism in our paper attempts to estimate possible secondary controller-level abnormality that can be indicative of DIAs even before the attack progresses from the communication/network layer to the control plane thereby attempting to lower the risk of instability and achieve mitigation with minimal time delays. Furthermore, our method estimates a fused sum of all individual secondary control outputs within the microgrid environment meaning that any DIA irrespective of its target and mode of propagation is identified via a unified framework represented by the ANN outputting an estimation for $T_{pr}$. Then, a hold is introduced, and the active network graph topology is switched from the current topology to another pre-defined spanning tree topology whose estimation for $T_{pr}$ conforms to equation 18. As per [13], there can be several such topologies for any given (microgrid)"}, {"title": "IV. PERFORMANCE VALIDATION AND RESULTS", "content": "We use a MATLAB-based N-DG autonomous AC mi-crogrid model for performance validation of our proposed abnormality estimation and cyberattack mitigation framework. This system follows the control architecture in Section II. Key parameters for this test system are provided in Table I. The default communication graph topology for this N-DG model is shown in Fig. 3. The microgrid abnormality estimation framework consists of a L-layered neural network (including\n$\\sum_{m\\in N(l)} a_{lm} (D_{P_m} P_l - D_{P_l} P_l))+\nK_2(\\sum_{m\\in N(l)} a_{lm}(D_{Q_m} Q_m - D_{Q_l} Q_l))) + X_A$\nOn further simplification, we can say that during any DIA (irrespective of whether it is FDI or MITM),\n$T_{pr} = \\sigma + X_A$\nConsidering the inherent nature of microgrid physics, we use ANN as an estimator for $T_{pr}$. This helps it to serve as an indicator of cyberattacks in the microgrid network. Thus exploiting this physics-guided property, we use a L-layered deep ANN that is trained in a supervised manner to estimate a single output feature $T_{pr}$ based on all the P, Q,$\\omega$ to be received by each DG as per the current spanning tree $s_r[i]$. Note that these features are collected from each DG in the network. If the value of $T_{pr}$ is found to be higher than $\\sigma$, a trigger is raised indicating the presence of a cyberattack in the microgrid environment."}, {"title": "B. Impact of cyberattacks", "content": "Without proposed fortification strategy: FDI attacks are initiated from the transmitters associated with DGs 1, 2, and 3. Fig. 8 shows the impact of this attack vector in the absence of the proposed defense framework. The vector creates a deviation of frequency from its steady state and disrupts nominal power-sharing arrangements.\nProposed ANN-based defense: We consider two sub-cases of attacks for performance evaluation: (i) transmitter-level FDIs and (ii) repeater-level MITMs (both initiated at t = ta). During the above FDI attack strategy, in the presence of proposed defense, the physics-guided ANN analyzes the measurements flowing as per the current cyber (communi-cation) graph and estimates that it can lead to abnormal secondary control behavior. Then a flag is raised indicating attack detection and a hold is placed on the system states. Then the ANN iterates through the set of pre-defined spanning trees estimating $T_{pr}$ values for them. Finally, it identifies and enforces the topology with $T_{pr}$ conforming to equation 18. The new topology does not rely on measurements from DGs 1, 2, and 3. This means that it will not require transmitters 1, 2, and 3 to achieve nominal functionality. As depicted in Fig. 9, local frequencies attain normalcy even in the presence of the attack vector. Power-sharing arrangements return to normal and frequency returns to 50 Hz after a minor disruption. The second sub-case involves injecting repeater-level MITM manipulations in the links connecting DGs 2 to 3 and 3 to 4. The framework can also achieve normalcy during this attack (Fig. 10). Local frequencies and power-sharing arrangements remain unaffected even in the presence of the attack vector."}, {"title": "C. Scalability analysis", "content": "Microgrid sizes in the real world are not identical. Hence, the scalability of the proposed ANN model must be evaluated for higher microgrid sizes to evaluate its practical feasibility. To perform this evaluation, we develop a 10-DG AC micro-grid with system parameters as listed in Table III. First, to understand how ANN performance is affected by the increased microgrid size, we retrieve data from the microgrid model and"}, {"title": "V. CONCLUSION", "content": "This paper presented a physics-guided deep ANN model to estimate the possibility of abnormal secondary control operations due to communication-level cyberattacks. If an attack is identified, a flag is raised (introducing a hold of the last measured stable states) and the ANN checks the set of pre-defined spanning trees to find one that can achieve resilience. Then this topology is enforced mitigating the attack which finally leads to the achievement of nominal operations within the microgrid. Our results showed that the proposed method is resilient to both transmitter-level FDIs and repeater-level MITM attacks. Further, the performance of the proposed framework also showed robustness irrespective of varying mi-crogrid sizes. However, performance degradation was observed"}]}