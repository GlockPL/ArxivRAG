{"title": "EcoFollower: An Environment-Friendly Car Following Model Considering Fuel Consumption", "authors": ["Hui Zhong", "Xianda Chen", "PakHin Tiu", "Hongliang Lu", "Meixin Zhu"], "abstract": "Abstract-To alleviate energy shortages and environmental impacts caused by transportation, this study introduces EcoFollower, a novel eco-car-following model developed using reinforcement learning (RL) to optimize fuel consumption in car-following scenarios. Employing the NGSIM datasets, the performance of EcoFollower was assessed in comparison with the well-established Intelligent Driver Model (IDM). The findings demonstrate that EcoFollower excels in simulating realistic driving behaviors, maintaining smooth vehicle operations, and closely matching the ground truth metrics of time-to-collision (TTC), headway, and comfort. Notably, the model achieved a significant reduction in fuel consumption, lowering it by 10.42% compared to actual driving scenarios. These results underscore the capability of RL-based models like EcoFollower to enhance autonomous vehicle algorithms, promoting safer and more energy-efficient driving strategies.", "sections": [{"title": "I. INTRODUCTION", "content": "The escalating concerns over global energy shortages and environmental issues have driven increased focus on emission control in autonomous vehicles [1]. The transportation sector is a major contributor, accounting for a staggering 59% of total oil consumption and 22% of carbon dioxide emissions in 2011 [2]. Furthermore, transportation was responsible for nearly 30% of all greenhouse gas (GHG) emissions in 2015, highlighting its role in global warming and its detrimental effects [3].\nCar-following behaviour is a fundamental aspect of autonomous driving systems, particularly within Adaptive Cruise Control (ACC) frameworks [4], [5]. It allows autonomous vehicles to maintain a safe distance from preceding vehicles by adjusting their speed [6]. Traditionally, car-following models have been built using two main approaches: rule-based and supervised learning [7]. Rule-based models include classics like the Gazis-Herman-Rothery (GHR) model and the Intelligent Driver Model (IDM) [8]. Supervised learning models, on the other hand, rely on data from human drivers to learn the relationship between car-following states and vehicle acceleration [9]\u2013[11]. However, both approaches aim to replicate human driving behaviour. Studies have shown that novice drivers tend to be less smooth or more aggressive with the accelerator pedal compared to experienced drivers, leading to higher fuel consumption [12]. This suggests that simply mimicking human behaviour might not be the most optimal solution for autonomous driving. Additionally, research on fuel economy testing of autonomous vehicles has indicated that algorithms not designed with efficiency in mind can lead to a 3% decrease in fuel economy [13]. These findings emphasize the importance of considering environmental impact and implementing sustainable traffic management strategies.\nTo tackle these challenges, this paper introduces a ground-breaking human-like eco-car-following model based on reinforcement learning (RL), named EcoFollower. This model distinguishes itself by incorporating passenger comfort alongside safety, efficiency, and fuel consumption optimization. We evaluate the effectiveness of the proposed model using real-world data, focusing on its ability to improve fuel efficiency while maintaining passenger comfort demonstrably. This analysis of real-world data allows us to demonstrate the Ecofollower's capacity to enhance energy efficiency in autonomous driving systems significantly."}, {"title": "II. RELATED WORK", "content": "The growing interest in autonomous driving stems partly from its potential to reduce energy consumption. Studies have explored this potential using two main approaches: macro-level simulations and individual vehicle behaviour optimization.\nChen et al. [14] employed network activity data to simulate national fuel consumption impacts in the U.S., offering insights into the broader implications of autonomous driving. Similarly, Yao et al. [15] compared fuel consumption and emissions between connected automated vehicles and human-driven vehicles, highlighting the potential environmental benefits. However, these valuable insights are limited to a macro level, and there is a need to investigate individual vehicle behaviors within the context of autonomous driving.\nWu et al. [16] proposed an optimization system for improving fuel economy by fine-tuning rule-based car-following models. However, research on supervised learning approaches, which are becoming increasingly prevalent, remains relatively scarce. Zhou et al. [17] introduced a driving strategy for connected and automated vehicles at signalized intersections using a reinforcement learning (RL) approach, demonstrating its effectiveness in macro-level traffic management. While these studies address aspects of safety, efficiency, and comfort,"}, {"title": "III. DATA PREPARATION", "content": "Building upon our previous work on car-following datasets in [19], we selected the Next Generation Simulation (NGSIM) dataset [20] for this study due to its well-established reputation and alignment with the criteria identified in our earlier research. The data encompasses a 500-meter section with six freeway lanes, including a dedicated high-occupancy vehicle (HOV) lane. It provides a total of 45 minutes of data divided into three 15-minute intervals (4:00 PM - 4:15 PM, 5:00 PM - 5:15 PM, and 5:15 PM - 5:30 PM). These specific periods capture the transition from uncongested to congested traffic and peak rush hour conditions. The dataset records each vehicle's location at a high sampling rate of 10 Hz, ensuring precise data. We employed the reconstructed NGSIM I-80 data [21] to guarantee data quality. A total of 1,341 car-following events that are over 15 seconds were extracted from the dataset for this study.\nFig.1 illustrates the statistic analysis of the NGSIM dataset, revealing insights into following vehicle behavior. The data suggests generally smooth traffic flow, with average speeds for leading and following vehicles at 8.14 m/s and 8.07 m/s, respectively. Additionally, the average distance headway is 12.12 m, with a maximum of 60 m. This suggests that following vehicles typically maintain close proximity without experiencing excessive braking. However, Figure 1 also highlights the presence of random following events characterized by significant variations in speed and headway. While these events are brief, lasting only around 30 seconds, they involve rapid acceleration and deceleration. This suggests potential discomfort for passengers in following vehicles due to unexpected changes in speed."}, {"title": "IV. METHODOLOGY", "content": ""}, {"title": "A. Intelligent Driver Model (IDM)", "content": "IDM serves as our baseline model for car-following behavior. IDM is a well-established model that mimics human driving by considering both the desired speed of the following vehicle and its desired following distance. Mathematically, IDM is expressed as follows:\n$$a_n(t) = a_{max} \\left[ 1 - \\left( \\frac{v_n(t)}{v_n^0} \\right)^\\delta - \\left( \\frac{s_n(t)}{s_n(t)} \\right)^2 \\right]$$\nwhere $a_n(t)$ is the output acceleration for the following vehicle n, $a_{max}$ is the maximum acceleration, $v_n(t)$ and $v_n^0(t)$ are the actual and desired velocity, respectively, and $s_n(t)$ and $\\bar{s_n}(t)$ are the actual and desired spacing, respectively. Specifically, the desired spacing can be calculated by:\n$$s_n(t) = s_{jam} s_n^{(m)} + max \\left(0, v_n(t)T_n + \\frac{v_n(t) \\Delta v_n(t)}{2\\sqrt{a_{max} a_{comf}}} \\right)$$\nwhere $s_{jam}^{(m)}$ is the minimum standstill spacing, $T_n$ is the desired time headway, $\\Delta v_n(t)$ is the relative speed between the leading vehicle and the following vehicle n, and $a_{comf}$ is the comfortable acceleration. The specific model parameters used in this study were calibrated based on the work of Zhu et al. [18]."}, {"title": "B. DDPG Algorithm", "content": "This section explores the Deep Deterministic Policy Gradient (DDPG) algorithm, employed to train an intelligent agent that simulates the following vehicle's behavior. The goal is to develop an optimal policy that achieves a balance between fuel consumption, safety, travel effectiveness, and passenger comfort in car-following scenarios.\nWhile our primary focus is on evaluating the potential of DDPG for fuel-efficient car following, it's well established that energy consumption is directly related to vehicle speed and acceleration. However, simply minimizing fuel consumption might lead the agent to prioritize staying stationary, compromising travel efficiency. Therefore, we design a reward function that considers a combination of factors: fuel consumption, time to collision (TTC), time headway, and jerk. This approach balances fuel efficiency with safety and travel progress. The specific parameters used in the reward function will be detailed in the following section."}, {"title": "1) Fuel Consumption:", "content": "The VT-Micro model, established by Ahn et al. in 2002 [22], serves as the foundation for estimating fuel consumption in the following vehicle. This well-regarded model is known for its high accuracy and has been validated with real-world data. Its strength lies in considering both speed and acceleration through an exponential Measure of Effectiveness (MOE) [23]. The MOE is expressed mathematically as:\n$$MOE(a_n(t), v_n(t)) = exp \\ P(a_n(t), v_n(t))$$\nwhere is $P(a_n(t), v_n(t))$ a polynomial function representing the influence of speed and acceleration on fuel consumption, represented as:\n$$P(a_n(t), v_n(t)) = \\sum_{i=0}^3 \\sum_{j=0}^3 K_{ij} v_n^i(t) a_n^j(t)$$\nwhere $K_{ij}$ are the regression coefficients that have been calibrated using field data, and they quantify the influence of speed and acceleration on fuel consumption, $CO_2$ emissions, and $NO_x$ emissions."}, {"title": "2) Comfort:", "content": "We leverage jerk, the rate of change of acceleration, as the primary metric for quantifying passenger comfort. Jerk represents the jolting sensation passengers experience during abrupt changes in speed. Minimizing jerk translates to smoother vehicle motion and reduces discomfort. Jerk can be calculated using the following equation:\n$$J_n(t) = \\frac{d}{dt} a_n(t)$$\nwhere $J_n(t)$ and $a_n(t)$ are the jerk and acceleration of the following vehicle n at time t."}, {"title": "3) Safety and Efficiency:", "content": "According to previous studies [18], [24], [25], safety and efficiency can be denoted by the TTC and time headway. Safety is the most essential and important element in traffic conditions and TTC means the time left before a collision takes place during a car-following event. Thus, it can be represented using eq.6.\n$$TTC(t) = \\frac{S_{n-1,n}(t)}{\\Delta V_{n-1,n}(t)}$$\nwhere t denotes time step; n-1 and n stands for the preceding and following vehicle, respectively. Therefore, $S_{n-1,n}(t)$ represents the spaces between two vehicles at moment t, m; $\\Delta V_{n-1,n}(t)$ means the relative speed at moment t, which equals to the speed of leading vehicles minus the speed of following vehicles. This definition reflects that the trend of TTC is converse with crash risk [26]. Usually, the thresholds of TTC range from 1.5 s to 5s. In this study, its thresholds were referred to the results of Zhu et al. [18], which can be constructed as follows:\n$$f_{TTC}= \\begin{cases} log(TTC), & 0 \\le TTC < 4 \\\\ 0, & otherwise \\end{cases}$$"}, {"title": "4) States and Actions:", "content": "In the car-following scenario, the action of the agent was defined as the longitudinal acceleration of followers, and the state contains speed $V_{FV}(t)$, relative gap $S(t)$ and relative speed $\\Delta V_{LV, FV}$ of the following vehicles. Thus, at each time step t, the simulated follower's trajectory satisfied the Newtonian motion equations given lead vehicle data, which can be divided into these three steps:\n\u2022 A. Calculate action (acceleration)\n\u2022 B. Update state (speed, relative speed and spacing):\n$$\\Delta V(t + 1) = V_{LV}(t + 1) - V_{FV}(t+1)$$\n$$S(t+1) = S(t) + \\frac{\\Delta V(t) + \\Delta V(t + 1)}{2} * \\Delta T$$\nReturn to Step A until the event ends\n5) Reward Function: According to the above-mentioned features for reward function, it can be defined as the following equation, which considers safety and fuel consumption and is subject to traffic efficiency.\n$$r(s, a) = w_1 f_{TTC} + w_2 f_{headway} + w_3 f_{fuel} + w_4 f_{jerk}$$\nwhere r(s, a) denotes the reward function and $w_1, w_2, w_3$ stand for weights of safety, efficiency, and fuel consumption, respectively, during car following. In this paper, they are set to 1 given for equal importance [18]."}, {"title": "V. EXPERIMENT", "content": ""}, {"title": "A. EcoFollower model", "content": "The NGSIM datasets are divided into training and testing subsets, utilizing 70% of the data for training and 30% for testing purposes. During the training phase, the RL agent iteratively simulates car-following events using the training dataset, which undergoes random shuffling. After the completion of each event, a new car-following event is randomly drawn from the training dataset, and the agent's state is reset based on the empirical data from the selected event. This iterative training cycle is conducted across 3000 episodes, with each episode corresponding to a unique car-following scenario.\nFig.3 depicts the training outcomes after 3000 episodes, clearly demonstrating that the DDPG model achieves convergence by approximately the 500th episode when employing a collision avoidance strategy. The rolling mean episode reward, calculated as the average reward obtained across all time steps within an event at a sampling interval of 0.1 seconds for the NGSIM data, stabilizes around 0.6, accompanied by 28 accumulative collisions. These findings suggest that the EcoFollower car-following model is sufficiently adaptable to develop an optimal strategy that effectively balances safety, efficiency, comfort, and fuel consumption.\nFig.4 presents the test results for safety, comfort, efficiency, and fuel consumption using the EcoFollower car-following model. When compared to Figure 2, the distributions of the four calculated indicators in the test results mirror the trends observed in the original training datasets. For instance, the analysis of the original test datasets indicated that the TTC values ranged from -20 seconds to 20 seconds. The predictive outcomes of TTC from the trained EcoFollower model exhibit a symmetrical range. Likewise, the distribution of jerk maintains a consistent pattern between the observed and simulated values, spanning the range of [-0.4, 0.4]. These observations underscore the substantial simulation capabilities of the DDPG model in replicating human driver behaviours, as noted in the work of Zhu et al. [28]. Moreover, a comparison of fuel consumption between real and simulated car-following events reveals an approximate 10.42% energy savings using the EcoFollower model, with a mean fuel consumption rate of 0.86ml/s across 403 car-following events. This demonstrates the model's efficacy not only in mimicking driving behaviours but also in enhancing fuel efficiency in practical scenarios."}, {"title": "B. Comparison between EcoFollower and IDM model", "content": "To evaluate the efficacy of RL in reducing fuel consumption within autonomous driving contexts, this study conducted comparative experiments using the trained car-following model and the IDM on the same test datasets, assessing performance in terms of safety, comfort, efficiency, and fuel consumption. Notable differences were observed in the simulated driving behaviours between the IDM and the RL-based models. The EcoFollower model demonstrated a high capacity for emulation, as evidenced by the similarity in the distribution of the four key indicators, whereas the driving behaviours modelled by the IDM exhibited considerable variability from real conditions.\nFurthermore, the safety of simulated car-following behaviours by the IDM model showed significant enhancements, characterized by larger TTC values and increased headway. Conversely, comfort levels decreased slightly in comparison to real-world conditions, with a broader jerk range of [-0.6, 0.8]. Additionally, the fuel consumption exhibited an upward trend due to frequent acceleration and deceleration. Prior studies have indicated that more frequent \"stop-and-go\" behaviours typically result in increased fuel consumption and emissions. This highlights the complex trade-offs between achieving safety and efficiency in autonomous driving technologies and underscores the importance of optimizing driving algorithms to balance these factors effectively.\nTable 1 provides a comprehensive evaluation of safety, comfort, efficiency, and fuel consumption, comparing the simulated results with the ground truth. The findings indicate that the simulated car-following models generally adopt a conservative strategy to enhance safety, as evidenced by higher TTC values. However, among these models, the IDM demonstrates the poorest comfort levels but achieves the highest efficiency. This outcome is attributed to the frequent acceleration and deceleration behaviours exhibited by the simulated following vehicle, which, in turn, lead to relatively higher fuel consumption compared to the EcoFollower model.\nTo examine the variations among different models, four indicators were analyzed during a randomly selected car-following event, as presented in Figure 6. The actual data for TTC, headway, and fuel consumption exhibit significant fluctuations. To some extent, both the EcoFollower and IDM models mitigate these oscillatory fluctuations that occur during car-following. It is also noteworthy that, due to improper initial"}, {"title": "VI. CONCLUSIONS", "content": "This study developed and assessed the EcoFollower model, an innovative car-following model based on reinforcement learning designed to optimize fuel consumption. This model was contrasted with the traditional IDM to evaluate comparative efficacy across key performance metrics, including safety, comfort, efficiency, and fuel consumption in both simulated and real-world settings. The results demonstrate that both the EcoFollower and IDM models are effective in mitigating the oscillatory fluctuations typical in car-following data. However, they exhibit distinct behavioral patterns that significantly affect their overall performance. The EcoFollower model not only excelled in reducing fuel consumption but also excelled in its ability to simulate realistic driving behaviors, maintain smooth vehicle operations, and closely mirror ground truth metrics such as TTC, headway, and jerk. Conversely, the IDM model, while demonstrating high efficiency with lower time headway, exhibited abrupt changes in speed and time headway in the first part of car-following events. These sudden alterations"}]}