{"title": "AI-Powered Intracranial Hemorrhage Detection: A Co-Scale Convolutional Attention Model with Uncertainty-Based Fuzzy Integral Operator and Feature Screening", "authors": ["Mehdi Hosseini Chagahi", "Md. Jalil Piran", "Niloufar Delfan", "Behzad Moshiri", "Jaber Hatam Parikhan"], "abstract": "Intracranial hemorrhage (ICH) refers to the leakage or accumulation of blood within the skull, which occurs due to the rupture of blood vessels in or around the brain. If this condition is not diagnosed in a timely manner and appropriately treated, it can lead to serious complications such as decreased consciousness, permanent neurological disabilities, or even death. The primary aim of this study is to detect the occurrence or non-occurrence of ICH, followed by determining the type of subdural hemorrhage (SDH). These tasks are framed as two separate binary classification problems. By adding two layers to the co-scale convolutional attention (CCA) classifier architecture, we introduce a novel approach for ICH detection. In the first layer, after extracting features from different slices of computed tomography (CT) scan images, we combine these features and select the 50 components that capture the highest variance in the data, considering them as informative features. We then assess the discriminative power of these features using the bootstrap forest algorithm, discarding those that lack sufficient discriminative ability between different classes. This algorithm explicitly determines the contribution of each feature to the final prediction, assisting us in developing an explainable AI model. The features feed into a boosting neural network as a latent feature space. In the second layer, we introduce a novel uncertainty-based fuzzy integral operator to fuse information from different CT scan slices. This operator, by accounting for the dependencies between consecutive slices, significantly improves detection accuracy.", "sections": [{"title": "I. INTRODUCTION", "content": "ICH, recognized as one of the most critical and life- threatening medical conditions, can severely impact patient health and require prompt and accurate diagnosis in order to ensure appropriate treatment [1], [2]. These types of hem- orrhages are typically caused by traumatic injuries, such as head trauma, or specific medical conditions like aneurysm rupture, high blood pressure, or blood disorders [3], [4]. This emergency situation can rapidly increase intracranial pressure and cause damage to brain tissues [5], [6].\nIn the past, diagnosing such hemorrhages primarily relied on conventional imaging techniques, such as CT scans and magnetic resonance imaging (MRI). These images were re- viewed by radiologists and neurologists to determine the type and severity of the hemorrhage [7], [8]. However, due to the reliance on the expertise and experience of physicians, these methods have always faced challenges related to accuracy and speed [9], [10].\nIn the past decade, with significant advancements in arti- ficial intelligence and machine learning (ML), research has shifted towards the development of automated models for the detection and classification of intracranial hemorrhages [11]\u2013[14]. Deep learning (DL) models, such as convolutional neural networks (CNNs), pre-trained networks, and attention- based architectures, have garnered considerable attention from researchers due to their high capability in analyzing medical images [15]\u2013[20]. These models can automatically analyze CT scan images and accurately detect ICH.\nThe study [21] presented a novel method for Multiple Instance Learning (MIL) for medical image analysis, partic- ularly for detecting ICH in CT scans. The approach built on Gaussian Process-based MIL (VGPMIL) but introduced a new formulation using P\u00f3lya-Gamma random variables to handle the logistic function more efficiently. The reformulation, called PG-VGPMIL, was mathematically equivalent to the original VGPMIL model but provided better computational tractability.\nPerez et al. [22], presented a novel end-to-end model combining CNN, attention mechanisms, and gaussian pro- cesses for MIL to detect ICH from CT scans. The method overcame challenges in the manual annotation of large datasets by using scan-level labels instead of slice-level labels. The CNN was employed to extract features from each CT slice, which were then processed by an attention mechanism that assigned weights to highlight important slices. These weighted feature vectors were passed into a sparse gaussian process for probabilistic classification.\nThe work [23] evaluated a novel DL algorithm based on the Dense-UNet architecture for detecting ICH in non-contrast CT (NCCT) head scans after traumatic brain injury. The algorithm processed CT scans by segmenting the brain using"}, {"title": "II. FUZZY-BASED ICH DETECTION FRAMEWORK", "content": "Fig. 1 illustrates the overall architecture of the proposed system for detecting ICH and SDH. Initially, the raw images undergo essential preprocessing. Following this, feature ex- traction is performed, and subsequently, feature fusion and selection techniques apply to ensure that only the most dis- criminative features are kept for input to the boosting neural network. The architecture estimates the probability of each slice belonging to specific classes. Finally, slices from the same CT scan are aggregated using a fuzzy integral operator based on uncertainty, resulting in the determination of the final label for the CT scan. In the following, we delve into the details of each component of the proposed system."}, {"title": "A. Data acquisition and labeling", "content": "In this study, we utilize two datasets: NICH137 and SDH45. The NICH137 dataset focuses on assessing the presence or absence of ICH, while the SDH45 dataset is dedicated to identifying the type of Subdural Hemorrhage. Please see Table I for a comprehensive overview of the two datasets. Both datasets were collected between 2018 and 2024 from two medical centers in Tehran: Rasul Akram Hospital and Firouz- abadi Hospital. They were meticulously labeled by two board- certified neurosurgeons. Labeling was initially performed by"}, {"title": "B. Image preprocessing", "content": "The data preprocessing for preparing brain CT scan images for use in DL models is conducted in several stages. First, the head CT scan images are separated from all available images, which include various sections such as body, lungs, bones. Subsequently, these images are converted from DICOM format to the more commonly used JPEG format. At this stage, noisy slices or those lacking brain tissue are removed from the dataset to improve the quality of the input data for the models. To enhance the focus of DL models on the primary brain tissue and information-rich areas, background removal tech- niques are initially applied to identify and eliminate non- homogeneous color regions in the images. Afterward, a binary mask is employed to dynamically crop the images. The result- ing cropped images contain only the main brain tissue. Fig. 4 illustrates various slices of a CT scan image, where slices marked by red diagonal lines are removed from the dataset, and the remaining slices are cropped to a red rectangular bounding box. This process is repeated for all slices of the CT scan images."}, {"title": "C. Feature Fusion and Feature Importance", "content": "Based on a comprehensive review of prior studies, DL models with the highest frequency and best performance in Q1-ranked publications are selected as the most suitable candi- dates for feature extraction from CT scan images. In our study dataset, the CCA and VGG19 models demonstrate the best performance in feature extraction, while the cross-attention and EfficientNetB6 models show the worst performance in this regard. To refine the extracted features, we apply principal component analysis (PCA) and select the top 50 components from each model that account for the greatest data variance, considering these as informative features. This transformation enables a shift from basic features to more sophisticated ones, effectively reducing feature dimensionality and substantially lowering computational costs. To evaluate the discriminative power of these components, the Bootstrap Forest algorithm is employed. This algorithm leverages permutation techniques to determine the importance of each component in the final prediction by iteratively permuting the values of each com- ponent while keeping others constant. The greater the effect of a component's permutation on model accuracy, the more critical that component is deemed to be. In fact, we define"}, {"title": "D. Boosting Neural Networks", "content": "After identifying the informative and discriminative features through PCA and permutation techniques, these features are fed into a boosting neural network. This architecture comprises"}, {"title": "E. uncertainty-based fuzzy integral operator", "content": "Since hemorrhage may not be visible in a single slice but could be apparent across consecutive slices, and single-slice diagnosis is highly susceptible to environmental variations such as changes in patient angle and position, analyzing multi- ple slices allows the AI system to examine a broader range of patterns, enhancing diagnostic accuracy. Therefore, to integrate multiple slices of a CT scan, we utilize an uncertainty-based fuzzy integral operator, which is capable of accounting for"}, {"title": "III. FINDINGS AND ANALYSIS", "content": "Since multiple CT scan images were typically recorded for each patient, to maximize the use of available scans and pre- vent data leakage, we included all scans from the same patient within the training data. The test data was designed to ensure subject independence. At the slice level, 80% of the data was designated for training, and 20% for testing. Considering that the training data included patients with multiple scans, this slice-level split corresponds to training the model on 50% of the patients and testing it on the remaining 50% at the patient level."}, {"title": "A. ICH Detection", "content": "The goal is to evaluate an intelligent model using CT scan images that can automatically detect the presence or absence of ICH. This is formulated as a binary classification problem, where the classes are defined as \"Normal\" and \"ICH\". Tables III and IV evaluate different models for slice- level ICH detection. Table III highlights regression metrics, where the CCA model achieved the best performance with the highest Generalized R-square (0.849) and lowest RASE (0.231) and MAD (0.118). In contrast, models like Cross Attention showed lower predictive capabilities."}, {"title": "B. SDH Detection", "content": "The aim here is to accurately identify the specific type of SDH. This binary classification includes \"ASDH\" and \"CSDH\" classes.\nTable V focuses on regression-based metrics. The CCA model demonstrates the best performance with the highest Generalized R-square (0.85) and the lowest MAD (0.087). It significantly outperforms models like EfficientNetB6, which has the lowest Generalized R-square (0.629) and highest error metrics.\nTable VI highlights classification metrics. The CCA model again leads with the highest Accuracy (0.913). The Incep- ResNet and Pyramid ViT models also perform well, while"}, {"title": "IV. FUTURE RESEARCH DIRECTIONS", "content": "In the future, we aim to explore:\n\u2022 An uncertainty-based fuzzy integral operator was utilized to fuse different slices of CT scan images at the decision level. Future studies can employ this operator at the data or feature level, allowing features extracted from various deep networks to be combined using this operator."}, {"title": "V. CONCLUSION", "content": "ICH requires prompt and accurate diagnosis to ensure timely implementation of appropriate treatments. In this study, after feature extraction from CT scan images, the most informative and most discriminative features were identified to feed into a hybrid neural network, enabling the classification of each slice into specific classes. Subsequently, we introduced a novel version of a fuzzy integral operator, enhanced with uncertainty-based weighting, to aggregate slices from CT scan images. The proposed approach, implemented on two separate datasets, demonstrated significant improvement in hemorrhage detection at the scan-level through the intelligent combination of multiple slices."}]}