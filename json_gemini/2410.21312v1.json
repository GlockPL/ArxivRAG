{"title": "PatentAgent: Intelligent Agent for Automated Pharmaceutical Patent Analysis", "authors": ["Xin Wang", "Yifan Zhang", "Xiaojing Zhang", "Longhui Yu", "Xinna Lin", "Jindong Jiang", "Bin Ma", "Kaicheng Yu"], "abstract": "Pharmaceutical patents play a vital role in biochemical industries, especially in drug discovery, providing researchers with unique early access to data, experimental results, and research insights. With the advancement of machine learning, patent analysis has evolved from manual labor to tasks assisted by automatic tools. However, there still lacks an unified agent that assists every aspect of patent analysis, from patent reading to core chemical identification. Leveraging the capabilities of Large Language Models (LLMs) to understand requests and follow instructions, we introduce the first intelligent agent in this domain, PatentAgent, poised to advance and potentially revolutionize the landscape of pharmaceutical research. PatentAgent comprises three key end-to-end modules - PA-QA, PA-Img2Mol, and PA-CoreId - that respectively perform (1) patent question-answering, (2) image-to-molecular-structure conversion, and (3) core chemical structure identification, addressing the essential needs of scientists and practitioners in pharmaceutical patent analysis. Each module of PatentAgent demonstrates significant effectiveness with the updated algorithm and the synergistic design of PatentAgent framework. PA-Img2Mol outperform existing methods across CLEF, JPO, UOB, and USPTO patent benchmarks with an accuracy gain between 2.46% and 8.37% while PA-CoreId realizes accuracy improvement ranging from 7.15% to 7.62% on PatentNetML benchmark. Our code and dataset will be publicly available.", "sections": [{"title": "1 Introduction", "content": "Patents provide a unique wealth of information for the early stages of chemical research and development, especially in freedom-to-operate analysis (Mucke 2023), prior-art search (Setchi et al. 2021), and landscape analysis (Ohms 2021). They play a critical role in lead and target discovery (Zdrazil et al. 2024; Senger 2017), offering earlier access to innovative insights and biochemical data than publishable journals (Southan et al. 2013). Given the competitive nature of the drug development business (Bregonje 2005), patents are a vital source of information. Aiming for the wealth of information provided by patents, scientists continuously work to extract relevant contents in patents and analyze them. However, scientists struggle with extracting and organizing information due to the lack of an unified agent. Specifically, existing approaches have the following shortcomings:\nManual approaches require excessive human effort to extract information. Traditional methods before the existence of computational technologies, such as manual review and keyword search (Hu et al. 2018; Andres and Treanor 2010), are often viewed as the golden standards in patent analysis. However, these methods require scientists to spend considerable time and effort extracting information. These methods rely heavily on human expertise to interpret complex chemical information, making them expensive and time-consuming.\nCurrent computational tools are highly specialized and lack a holistic solution. For instance, methods like text mining (Gadiya et al. 2023; Liu et al. 2011; Yun and Geum 2020) and chemical structure exploration (Morin et al. 2024; Zdrazil et al. 2024) operate independently, with little integration or standardized criteria for data formats, algorithms, or evaluation metrics. This lack of common standards makes it difficult to coordinate efforts across multiple modules, a necessity in comprehensive patent analysis. As a result, researchers, particularly those without a background in computer science, such as medical researchers, struggle to effectively utilize these tools. The need for coding skills and the lack of seamless integration create significant barriers, limiting the accessibility and efficiency of these computational methods.\nExisting tools still struggle to identify the core compound successfully. Identifying the core compound structure among hundreds or even thousands of chemicals (Habibi et al. 2016) in a pharmaceutical patent is one of the major tasks for scientists and practitioners (Akhondi et al. 2019). Given the complexity of the task, however, current tools struggle at an accuracy level of random guesses (Tyrchan et al. 2012; Falaguera and Mestres 2021; Zhu et al. 2024), including the most recent one.\nThose shortcomings make it challenging for AI to assist scientists in analyzing pharmaceutical patents. A unified agent with the capability to precisely interpret and execute scientific requests is essential. To bridge this gap, we aim to create an integrated system that can fully leverage the potential of computational methods to streamline patent analysis (Morin et al. 2024). Fortunately, Large Language"}, {"title": "2 Method", "content": "This section presents our PatentAgent framework (Fig 2). Our LLM orchestrator is introduced in Section 2.1, and the three succeeding subsections discuss three major modules used in PatentAgent. Section 2.2 explains the question answering chatbot PA-QA that to process natural language queries and generate accurate responses based on the knowledge base of the patent file. Section 2.3 describes the module PA-Img2Mol and its updated algorithm in converting images of chemical structures to molecular expression with Simplified Molecular Input Line Entry System (SMILES) (Weininger 1988). Section 2.4 introduces module PA-Coreld that identifies the common chemical scaffold across a series of diverse chemical compounds.\n2.1 LLM Orchestrator\nThe LLM orchestrator serves as the central component that connects and coordinates the three major modules: PA-QA, PA-Img2Mol, and PA-CoreId. Upon receiving a user query, the LLM orchestrator interprets the input and determines whether the query involves retrieving textual information, converting images to molecular structures, or identifying core chemical structures through contextual understanding. It then processes the queries to the requested format and routes the processed queries to corresponding module, aggregates the results and returns a comprehensive response to the user."}, {"title": "2.2 PA-QA", "content": "PA-QA is designed to interpret and respond to natural language queries about patents, extracting precise information from the text of patent documents. After collecting user's request from LLM Orchestrator, PA-QA focuses on specific sections of the patent that are most likely to contain relevant answers. When retrieving relevant sections, PA-QA utilizes a doc-layout model comprised of object detection and Optical Character Recognition (OCR) to extract specific regions in the patents, such as the abstract, claims, and detailed description.\nAfter getting specific section, PA-QA employs a transformer-based retrieval model that performs semantic search across the parsed sections of the patent document. Once the relevant information are retrieved, PA-QA synthesizes into a coherent answer. If necessary, the LLM orchestra would rephrase the text to ensure the response is directly aligned with the user's query."}, {"title": "2.3 PA-Img2Mol", "content": "The task of PA-Img2Mol is to convert images to molecular sequences, which is a task of Optical Chemical Structure Recognition (OCSR). Here specifically we wish to generate Simplified Molecular Input Line Entry System (SMILES) (Weininger 1988).\nFirstly, We use MolDetect (Ozymandias314 2023)\u00b9 to extract specially images of chemical compounds from patents. After retrieving all the chemical images, we followe Algorithm 1 to convert chemical images to SMILES.\nConsidering the different architectures and training data of each OCSR model, it is natural that each model has its own strengths and weaknesses in learning and identifying the relevant features. Therefore, we select three OCSR models, namely DECIMER 2.0 (Rajan, Zielesny, and Steinbeck 2021), MolScribe (Qian et al. 2023b), and SwinOCSR (Xu et al. 2022) for the best performance and use GPT-40 (Achiam et al. 2023) as the VLM evaluator.\nIn this module, for each chemical image, we use the three models: DECIMER, MolScribe, and SwinOCSR, to generate SMILES. After standardizing the generated SMILES, we use RDKit (RDKit 2015) to convert SMILES back to chemical images. Then we use GPT-40 (Achiam et al. 2023) the VLM to calculate the similarity between the regenerated image and the original image, so that the similarity considers possible re-orientation and scaling. By comparing the results, we are able to find the best SMILES with the highest similarity."}, {"title": "2.4 PA-Coreld", "content": "PA-Coreld is designed to identify the core chemical structure when given a list of chemicals, most possibly retrieved from the same patent file. The mechanism for identifying"}, {"title": "3 Experiments", "content": "We design experiments to evaluate PatentAgent to answer the following research questions:\nRQ1: How effectively does PA-Img2Mol convert patent images to molecular structures compared to existing methods?\nRQ2: How accurately does PA-CoreId identify core chemical structures within pharmaceutical patents, comparing to other state-of-the-art methods?\nRQ3: How does PatentAgent perform in a real-world application, such as analyzing a complex pharmaceutical patent, and what insights can it provide to researchers?\n3.1 RQ1: PA-Img2Mol converts patent images to molecular structure more effectively than existing methods\nTo answer RQ1, we compared PatentAgent with other openly available tools for Optical Chemical Structure Recognition (OCSR):\n1. OSRA: Filippov and Nicklaus (2009) propose the first open-source tool to identify chemical structure from images using traditional computational techniques.\n2. Imago: Smolov, Zentsev, and Rybalkin (2011) suggest a novel algorithm for processing images of chemicals by separating out the graphical and symbolic layers.\n3. MolVec: National Center for Advancing Translational Sciences (NCATS (2017)) publishes a public repository vectorizing chemical images into chemical objects.\n4. Img2Mol: Clevert et al. (2021) train and publicize a deep convolutional neural network that consists of an encoder that converts images into latent space and a decoder that translates latnent space information into SMILES.\n5. SwinOCSR: Xu et al. (2022) propose a Swin transformer based approach to train an end-to-end model.\n6. MolScribe: Qian et al. (2023b) present a generational model that predicts atom, bond, and layer to construct molecular structure.\n7. DECIMER: Rajan, Zielesny, and Steinbeck (2021) brings an image transformer that trains on PubChem (Kim et al. 2023) dataset and a dataset generated with Markush structure.\nExperiments comparing PatentAgent and the above models run on these datasets with real chemical structure images without distortion 3:\n1. CLEF: 992 images and chemical molecule file pairs published by the Conference and Labs of the Evaluation Forum (CLEF) in 2012.\n2. JPO: 450 images and chemical molecule file pairs published by Japanese Patent Office (JPO).\n3. UOB: 5470 image and chemical molecule file pairs published by the University of Birmingham (UOB), United Kingdom.\n4. USPTO: 5719 image and chemical molecule file pairs published by the US PaTent Office (USPTO).\n5. ACS: 331 image and chemical molecule file pairs published by American Chemistry Society (ACS) and manually annotated by MolScribe (Qian et al. 2023b)."}, {"title": "3.2 RQ2: PA-CoreId identifies core chemical structure more accurately comparing to other SOTA methods", "content": "To answer RQ2, we compared our model with PatentNetML (Zhu et al. 2024) and other traditional Cheminformatics Methods, including Cluster Seed Analysis(CSA) (Hattori, Wakabayashi, and Tamaki 2008), Molecular Idol(MI) (Lee et al. 2019), and Frequency of Group Analysis(FOG) (Tyrchan et al. 2012) on PatentNetML dataset (Zhu et al. 2024).\nWe present the results from the experiments in with all the accuracy measures, including Top 1, Top 5, Top 10, Top 1%, Top 5%, and Top 10%. We got the highest percentage in all these accuracy measures with the updated feature selection algorithm."}, {"title": "3.3 RQ3: PatentAgent improves the efficiency when dealing with complex patent - a case study", "content": "We select the patent with ID US-8063224 (LaChance et al. 2011) for this case study. This patent covers azacycloalkane derivatives acting as selective inhibitors intended for the treatment and prevention of diseases related to abnormal lipid metabolism, such as cardiovascular disease, obesity, diabetes, and metabolic syndrome.\nTo demonstrate PatentAgent's ability under real-world circumstances, we want to test if PatentAgent successfully complete the requests of the users and achieves high accuracy when identifying core chemical structure.\nWhen asked to identify the core chemical compound from this patent, after scanning the file, extracting chemical compound images, converting these images to SMILES, and identifying the top ten candidates with the highest probabilities, the core chemical compound ranks sixth. This lower ranking compared to using PA-CoreId alone is due to discrepancies in retrieving all chemical images, as many chemicals in the patent are not listed as images. Nevertheless, PatentAgent effectively reduces the effort needed to identify the core chemical compound from fifty compounds, saving time for researchers in testing and linking tools."}, {"title": "4 Discussion", "content": "Our experiments show that PatentAgent is a robust tool capable of addressing key aspects of patent analysis within a single, integrated framework. The effective operation across core modules-patent question answering, image-to-molecular-structure conversion, and chemical identification-demonstrates its functionality and ability to streamline traditionally fragmented workflows.\nIntegration of Multiple Aspects. One of the most significant finding is PatentAgent's ability to unify diverse tasks into a unified system, effectively bridging gaps that usually require multiple tools. This integration ensures consistency and enhances efficiency in patent analysis, suggesting that PatentAgent could serve as an all-in-one solution.\nAccuracy Boosts. Our experiments, particularly those conducted on the JPO dataset, indicate that PatentAgent improves accuracy in identifying and analyzing chemical structures within patents, leading to more reliable insights for subsequent research.\nEfficiency in Real-Life Applications. PatentAgent simplifies tasks traditionally handled by separate modules into one streamlined step, significantly reducing time and effort. This makes patent analysis more accessible and manageable, broadening its use among researchers.\nThese findings collectively reinforce the initial claim that PatentAgent has the potential to transform the drug discovery routine by accelerating the process from patent analysis to actionable insights, contributing to faster and more effective drug development."}, {"title": "5 Related Works", "content": "This section provides an overview of existing approaches in patent analysis in time and method development order, along with gaps that our approach aims to address.\n5.1 Text Mining and Natural Language Processing\nWith advancements in computational linguistics, NLP techniques have been applied to patent analysis. SCRIPDB provides a database that automatically retrieves relevant patent information, including syntheses, chemicals, and reactions (Heifets and Jurisica 2012). Chemical NER methods like tmChem (Leaman, Wei, and Lu 2015) and ChemSpot (Rockt\u00e4schel, Weidlich, and Leser 2012) efficiently identify chemical names in patent text. Feng and Fuhai (2012) combines text mining with informetric methods for morphological analysis of patent technology. Chikkamath et al. (2020) introduces novelty detection and evaluates various language models. Kronemeyer, Draeger, and Moehrle (2021) presents a process model identifying frugal patents.\nRecent works leverage AI and language models for patent innovation and validation. Inspired by TRIZ (Ilevbare, Probert, and Phaal 2013), Trapp and Warschat (2024) identifies contradictions in patents using LLMs to drive technological progress. PARIS and LE-PARIS generate effective responses to Office Actions (OAs) (Chu et al. 2024a), while PRO combines legal knowledge graphs with LLMs through retrieval-augmented generation (RAG) for more faithful OA responses (Chu et al. 2024b).\n5.2 Chemical Structure Analysis\nChemical structures are the vital treasure of information in biochemical patents, especially in drug discoveries. There are plenty of works related to chemical structures in patents, and the first one is mining chemicals in patents.\nSureChEMBLcss (Falaguera and Mestres 2021) contains authentic information on core chemicals in patents in the SureChEMBL datasets. PatentNetML (Zhu et al. 2024) predicts key compound using machine learning networks, a model MOMP (Turutov and Radinsky 2024) is proposed to optimize molecules with patentability constraint. CASTER (Huang et al. 2020) predicts drug-drug interactions (DDIs) given chemical structures of drugs.\n5.3 Integrated AI Systems\nThe increasing complexity and volume of patent data, with the development of large language models (LLMs), have led to increasing efforts in integrating AI into a whole system consisting of multiple analytical modules. MolTailor (Guo et al. 2024) combines molecular representation model as a knowledge base with language model as an agent to achieve molecule-text multi-task regression (MT-MTR). DECIMER.ai (Rajan et al. 2023) is an open platform for automatic chemical structure segmentation, classification, and translation in scientific publications, which can also be generalized into patents."}, {"title": "6 Conclusion", "content": "In conclusion, in this paper we propose PatentAgent as a novel approach in utilizing Large Language Models (LLMs) to link vital tools in pharmaceutical patent analysis so that researchers and practitioners can interactively and efficiently analyze patents from both text and chemical compounds. Moreover, PA-Img2Mol and PA-CoreId with updated algorithm achieve better performances than current tools. The case study also presents as a qualitative validation of the real-life application of PatentAgent even under unusual and complex circumstances.\nWhile our results are encouraging, they represent just the beginning of what PatentAgent could achieve. With further development and refinement, PatentAgent has the potential to not only streamline patent analysis but also fundamentally change the drug discovery routine by making the process faster, more accurate, and more accessible to researchers worldwide. As the field of automatic patent analysis develops, we wish to see more evaluation datasets and benchmarks for assessing intelligent automatic patent analysis agent like PatentAgent."}], "Algorithm 1": "Algorithm 1: The OCSR Algorithm with Model Ensemble and VLM as Evaluator\nGiven three Image-to-SMILES models M1, M2, and M3 and an input image I, this algorithm outputs the final SMILES: SMILESfinal\nfor each model M do\nSMILESM = M(I) // Image to SMILES\nSMILESstd = g(SMILESM) // Standardizes\nI' = RDKit(SMILES) // Convert back to image\nsimilarityM = VLM(I, I')\nend\nSMILESfinal = SMILESM*, when similarityM* =\nmax{similarityM1, similarityM2, similarityM3 }"}