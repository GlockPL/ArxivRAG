{"title": "Adaptive Variational Inference in Probabilistic Graphical Models: Beyond Bethe, Tree-Reweighted, and Convex Free Energies", "authors": ["Harald Leisenberger", "Franz Pernkopf"], "abstract": "Variational inference in probabilistic graphical models aims to approximate fundamental quantities such as marginal distributions and the partition function. Popular approaches are the Bethe approximation, tree-reweighted, and other types of convex free energies. These approximations are efficient but can fail if the model is complex and highly interactive. In this work, we analyze two classes of approximations that include the above methods as special cases: first, if the model parameters are changed; and second, if the entropy approximation is changed. We discuss benefits and drawbacks of either approach, and deduce from this analysis how a free energy approximation should ideally be constructed. Based on our observations, we propose approximations that automatically adapt to a given model and demonstrate their effectiveness for a range of difficult problems.", "sections": [{"title": "1 INTRODUCTION", "content": "The computation of the partition function and marginals is fundamental for probabilistic inference in graphical models (Koller and Friedman, 2009). As these problems are NP-hard (Valiant, 1979; Cooper, 1990; Dagum and Luby, 1993), one must - except for special cases - rely on approximation methods.\nVariational free energies provide a deterministic framework for approximate inference (Yedidia et al., 2005). One states an auxiliary optimization problem and uses its solutions to estimate the quantities of interest. However, the approximation accuracy depends on the auxiliary objective whose specific choice is known to be challenging (Wainwright et al., 2008).\nIn this work, we analyze pairwise free energy approximations that allow for an efficient optimization. Starting from the Bethe approximation (Mooij and Kappen, 2005; Weller"}, {"title": "2 BACKGROUND", "content": "In this section we introduce the relevant background of this work. This includes probabilistic graphical models (Sec. 2.1), the variational Gibbs free energy (Sec. 2.2), and Bethe and related approximations (Sec. 2.3). We also summarize additional related work (Sec. 2.4)."}, {"title": "2.1 PROBABILISTIC GRAPHICAL MODELS", "content": "Let $X = {X_1, ..., X_v}$ be a set of binary random variables taking values in $X = {+1,-1}$. Let their joint distribution $p(x)$ be modeled by an undirected graph $G = (X,E)$, whose nodes are a one-to-one representation of the variables $X$ and whose edges $(i, j) \\in E$ represent"}, {"title": "2.2 VARIATIONAL GIBBS FREE ENERGY AND BETHE APPROXIMATION", "content": "One large class of approximation methods relies on variational inference (Jordan et al., 1999). The idea is to convert the inference problems (P1), (P2) into an optimization problem which, however, will be intractable too. Hence, to reduce the computational complexity,"}, {"title": "2.3 RELATED FREE ENERGY APPROXIMATIONS", "content": "As the Bethe approximation can fail in certain models, various attempts were made to construct alternative types of free energy approximations. In this work we consider the so-called pairwise approximations, which are generalizations of the Bethe free energy that preserve two of its favorable properties: first, they include statistics that are defined over at most two variables\u00b2; second, they are defined on the local polytope L and thus bounded by a relatively small number of linear constraints\u00b3. This enables an efficient optimization of the objective function by methods of constrained numerical optimization and using its minima to estimate the partition function and marginals. Among all pairwise approximations we focus on two specific classes: those which make a different entropy approximation than FB but leave the average energy Epi,pij [E(x)] unchanged (Sec. 2.3.1); and those which keep the Bethe entropy (8) but modify the energy E(x) in (2) or, in other words, the model parameters Jij, di (Sec. 2.3.2)."}, {"title": "2.3.1 GENERALIZING THE BETHE ENTROPY", "content": "While the Gibbs free energy (6) is convex on its domain, this is not guaranteed for the Bethe free energy; in fact, FB is convex on L if and only if the graph contains at most one loop (Heskes, 2004; Watanabe and Fukumizu, 2009). This is because the Bethe entropy SB is generally not concave which has sometimes been considered the reason why the Bethe approximation fails in loopy graphs (Wainwright et al., 2005; Heskes, 2006). Hence, alterna-"}, {"title": "2.3.2 CHANGING THE STATE ENERGY", "content": "The approximations Fc introduced in Sec. 2.3.1 share the favorable property that the average energy is computed as in the Gibbs free energy (6) (but extended to L, which may still alter the location of the minimum). Recently, an alternative class of approximations were proposed that leave the entropy approximation as in the Bethe free energy but modify the state energy (2) by scaling the model parameters. This may seem unintuitive as now both aspects of the approximation \u2013 the average energy and the entropy \u2013 are incorrect. However, some experimental results show improvements over the Bethe approximation (Knoll et al., 2023)."}, {"title": "Self-Guided Belief Propagation", "content": "Self-Guided Belief Propagation (SBP) exploits the well known relationship between the Bethe approximation and the popular loopy belief propagation (LBP) algorithm5. It starts with a completely uncorrelated model (i.e., where all Jij are set zo zero) and successively increases the correlations Jij until LBP, which is sequentially applied during this procedure, either fails to converge for some intermediate state of the model or converges to a fixed point of the original model. In our context, this means that we successively increase a pairwise scale factor $\u03c2 = \u03b6$ ( (that is the same for all edges) starting from $\u03b6 = 0$ and setting the local scale factors 0\u00bf to one (i.e., leaving the local potentials 0\u017c unmodified), until LBP either fails to find the minimum of Fr for some \u03b6\u2208 (0,1) or finds the minimum of FB for $\u03b6 = 1$. It uses the minimum of F\u03c2 (or FB) associated to the final state of convergence of LBP to estimate the marginals and partition function. The detailed algorithm is described in (Knoll et al., 2023).\nAnother approximation of the class F; successively deletes edges from the model; this corre-sponds to setting pairwise scale factors \u010cij associated to deleted edges to zero (Leisenberger et al., 2022). However, SBP proves to be the more flexible algorithm."}, {"title": "2.4 OTHER RELATED WORK", "content": "Higher-Order Variational Inference. Increasing the complexity of variational infer-ence can help to achieve a higher accuracy. The exact solution can be computed by the junction-tree algorithm whose complexity increases exponentially with the size of the largest clique in the graph (Lauritzen and Spiegelhalter, 1988). Methods that make higher order entropy approximations were constructed by Yedidia et al. (2005). Other methods whose efficiency is located 'between' pairwise approximations and exact inference include join graph propagation (Dechter et al., 2002), loop corrections (Mooij et al., 2007), oriented trees (Globerson and Jaakkola, 2007a), and variable clamping (Weller and Jebara, 2014b).\nMessage Passing Algorithms. Having its origins in statistical mechanics (Bethe, 1935; Peierls, 1936), the Bethe approximation has gained popularity in the computer science and statistics community when Yedidia et al. (2001) have proven its connection to loopy belief propagation. Inspired by their discovery, other researchers designed alternative free energies that are related to similar message passing algorithms (Yedidia et al., 2005; Hazan and Shashua, 2008; Meltzer et al., 2009). These are often efficient but can fail to converge to a fixed point. Also, the convergence behavior of LBP has been subject of research (Tatikonda, 2003; Ihler et al., 2005; Mooij and Kappen, 2007; Leisenberger et al., 2021).\nMinimizing Free Energy Approximations. In practice, it can be difficult to minimize a certain type of free energy approximation, in particular if it is non-convex and has mul-tiple local minima. Various methods were proposed: gradient-based algorithms combined with projection steps (Welling and Teh, 2001; Shin, 2012); a double-loop algorithm that applies a concave-convex decomposition (Yuille, 2002); combinatorial optimization (Weller"}, {"title": "3 ADAPTIVE FREE ENERGY APPROXIMATIONS", "content": "In this section we analyze the two classes of pairwise free energy approximations Fc and Fr introduced in Sec. 2.3.1 and Sec. 2.3.2 in a broader context. Our goal is to identify regimes of the counting numbers c and scale factors that are related to accurate approximations Fc and Fr. For that purpose, we vary these parameters systematically in appropriate in-tervals and, for each realization of c and , evaluate the approximation accuracy induced by Fc and Fr; that is, we compare the minima of Fe and Fr to the exact marginals and partition function which were computed with the junction tree algorithm (Lauritzen and Spiegelhalter, 1988). For minimizing free energy approximations of class Fc or F\u0163, we use techniques of constrained numerical optimization (Nocedal and Wright, 2006). In particu-lar, we apply a projected Quasi-Newton algorithm which iteratively performs second-order parameter updates, by using an approximation to the inverse Hessian. To ensure that the iterates stay within the local polytope L, a projection step is required. The algorithm stops when it reaches a stationary point (usually a minimum) of the free energy approximation. All details including pseudocode are contained in the Appendix (Alg. 1, named F-MIN).\nFor error evaluation, we measure three kinds of errors: the l\u00b9-errors between exact and approximate singleton and pairwise marginals, and the absolute error between the exact and approximate log-partition function. In addition to the error evaluation and analysis, another aspect is of practical importance: do algorithms like Bethe, TRW, LS-Convex, and SBP capture favorable regimes of c and well, or do there exist optimal settings of c or that are not related to any of the 'existing' free energy approximations? We address this question by comparing the governing parameters c and associated to the baseline algorithms to optimal settings of c and \u03da (i.e., with minimum errors).\nIn this section we consider a complete graph on 10 nodes that allows for tractable exact inference. Further evaluations on different graphs exhibit a similar behavior and are shown in the Appendix. We analyze both attractive and mixed models (Sec. 2.1). For either type, we consider two different scenarios regarding the pairwise potentials Jij: weak correlations with all Jij being uniformly sampled from (0,0.5) resp. (-0.5, 0.5), and strong correlations with all Jij being uniformly sampled from (0,2) resp. (-2,2). We consider three differ-ent scenarios regarding the local potentials 0; that are uniformly sampled from (-0.2, 0.2), (-0.6, 0.6), or (-1,1). For each configuration of the potentials, the results (i.e., the errors and the estimated values of c and shown as vertical lines in Fig. 2, Fig. 3) are averaged over 100 individual models."}, {"title": "3.1 ANALYSIS OF CLASS FC-APPROXIMATIONS", "content": "To simplify our considerations, we focus on a specific subclass of Fe where the pairwise entropies in (13) share the same counting number, i.e., Cij = c for all edges. In Meshi et al. (2009) it has been argued that free energies of class Fc should be variable-valid, i.e., that the entropy approximation is exact on a tree. This can be achieved by setting the local counting numbers\n$c_i = 1- \\sum_{j\\in N(i)} C_{ij}$       (19)\nfor all nodes. Then the local counting numbers are implicitly parameterized via c too. For error evaluation, we vary c in the interval (0,3). Note that c = 1 corresponds to the Bethe free energy F\u0432.\nThe first row in Fig. 2 shows the results for attractive models. The estimates for singleton and pairwise marginals are improved if c decreases. Especially the least-squares (LS) convex energy (Sec. 2.3.1) finds a good regime for the counting numbers, as is shown by the orange vertical line, and outperforms the Bethe approximation (represented by the black vertical line); however, this advantage shrinks if Jij increases. The estimates of the log-partition function are less sensitive to changes in the counting numbers, unless they become too small. In this regard, the LS-convex free energy appears not to be a decent choice and is inferior to Bethe. However, there appears to be an optimal regime of c that is located between FB and the LS-convex energy. Note that the counting numbers of TRW are often similar to those of LS-convex, and not explicitly shown in this analyses.\nThe second row in Fig. 2 shows the results for mixed models. If Jij is small, FB finds almost optimal estimates for all quantities; however, its accuracy degrades if pairwise potentials become stronger in which case a minimum error is achieved if c grows beyond one. Beyond a certain threshold (which also depends on the strength of the local potentials 0\u00bf) the marginal error increases again, while the error in the log-partition function keeps relatively stable at a low level. The red, green, and blue line (adapted to \u03b8i) represent the counting numbers cas estimated by our algorithm ADAPT-c that will be introduced in Sec. 3.3. As ADAPT-C also takes the local potentials into account, three different vertical lines are shown. While, for small Jij, the estimated c is almost identical to the pairwise Bethe counting number (i.e., c = 1), estimates of c made by ADAPT-c usually increase if Jij increases. This has a beneficial effect on the partition function (for all settings of 0\u2081) and the pairwise marginals (for stronger 0\u2081) when estimated by ADAPT-c."}, {"title": "3.2 ANALYSIS OF CLASS F-APPROXIMATIONS", "content": "Again we facilitate our analysis by only modifying the pairwise potentials Jij, while setting the local scale factors \u0160i in (18) to one for all nodes (i.e., we leave the local potentials \u03b8i unchanged). We further assume that all edges share the same pairwise scale factor, i.e., \u0160ij = 6. This enables us to directly compare our results to self-guided belief propagation (SBP, Sec. 2.3.2) which makes the same assumptions. For error evaluation, we vary in the interval (0,1.5).\nThe first row in Fig. 3 shows the results for attractive models. We observe that the singleton and pairwise marginal error develops similarly as for class Fe; in particular, Bethe fails to approximate the marginals if Jij is large, while improvements can be made if ( is decreased to a certain level. Same as the Bethe approximation, SBP mostly uses a scale factor of ( = 1 in attractive models. Our algorithm ADAPT-\u03da (introduced in Sec. 3.3) aims to reduce and affect a 'smoothening' of FB until it gets a relatively convex shape. This approach has a positive effect on estimating singleton marginals, while an optimal for estimating pairwise marginals tends to be underestimated. Moreover, Fr-approximations (except for FB) do generally entail unstable estimates of the partition function and should be used with care for that purpose. As ADAPT- takes the local potentials into account, three lines represent the associated estimates of \u03da (red, green, and blue).\nThe second row in Fig. 3 shows the results for general models. Usually, FB outperforms other F; - approximations if Jij is small (in which case it is equivalent to SBP). If Jij increases, the scale factor ( should be decreased to a certain optimal level that depends on the local potentials 0. For all quantities of interest, SBP makes clear improvements over FB in mixed models (drawn by the red, green, and blue line adapted to \u03b8\u00bf). However, there is some more room for further improvement over SBP regarding the choice of an optimal ( (particularly for strong pairwise potentials Jij)."}, {"title": "3.3 ADAPTIVE FC - AND F APPROXIMATIONS", "content": "This subsection includes a conceptional description of our two algorithms ADAPT-c and ADAPT-C that we propose and evaluate in this work. Detailed pseudocodes are contained in the Appendix (Algorithms 3 and 4)."}, {"title": "3.4 ATTRACTIVE MODELS: ADAPT-C", "content": "For attractive models, we propose an adaptive algorithm of class Fr, named ADAPT-\u03b6. In these models, the Bethe approximation regularly fails to approximate the quantities of in-terest; in particular, the estimated marginals are often highly inaccurate if the pairwise potentials are strong. This behavior has been explained by the non-convexity of the Bethe entropy (and thus the Bethe free energy) and is shared by other free energy approximations that are not provably convex (Wainwright et al., 2008; Weller et al., 2014; Leisenberger"}, {"title": "3.4.1 \u039c\u0399\u03a7ED MODELS: ADAPT-C", "content": "For mixed models, we propose an adaptive algorithm of class Fc, named ADAPT-c, whose design is motivated by the analyses from Sec. 3.1. In Fig. 2 (second row) we have ob-served that especially the partition function but also the marginals estimated by Fc become more accurate if c increases beyond one; in particular, there appears to be a certain regime of c in which all errors roughly attain a minimum (with the marginal errors increasing again beyond that point). Note that most existing algorithms of class Fc such as TRW or LS-convex use counting numbers that are smaller than one to make the free energy ap-proximation convex; however, convexity is sometimes not considered a favorable property in mixed models (Weller et al., 2014).\nThe idea of ADAPT-c is to estimate the threshold of c beyond which only small changes in the partition function error occur. The associated free energy approximation Fe will then also be used to estimate the marginals. Let Ac be an incremental change in c and let Ctol be some value that defines to what extent changes in the estimated log-partition function (i.e., - min Fc) are tolerable if c is increased by Ac. Then we are formally interested in the solution of the following optimization problem:\n$c^* = \\underset{[1,\\infty)}{min} c, s.t. \\underset{ \\underset{}{}}{min F_{c+\\Delta c}} - \\underset{ \\underset{}{}}{min F_{c}} < C_{tol}$            (21)\nNote that the solution of (21) depends on the choice of Ac and Ctol. Also, there is no theroretical guarantee on the existence of c* for any choice of these two parameters; however, we expect that the existence of a real-valued solution becomes more likely if Ctol increases (while Ac is kept at a constant level). Thus, ADAPT-c successively increases c in small steps (starting from one, i.e., from the Bethe approximation), and minimizes the associated free energy approximation Fc until there are no significant changes in the estimated log-partition function anymore. For each realization of c, algorithm F-MIN is applied to find a minimum of Fc. Fortunately, F-MIN usually converges quickly for most mixed models. Although this procedure is not guaranteed to converge to the solution c* of (21), we show in our experiments (Sec. 4) that the results produced by ADAPT-c are fairly promising."}, {"title": "4 EXPERIMENTS", "content": "In this section we evaluate and compare the algorithms that were discussed in this work. This includes the Bethe approximation (FB), the tree-reweighted (TRW) free energies, the least-squares-convex (LS-convex) free energies, self-guided belief propagation (SBP), and the two adaptive algorithms ADAPT-\u03da (for attractive models) and ADAPT-c (for mixed models) introduced and explained in Sec. 3. Our experimental setup is similar as in Sec. 3; however, we now vary the size \u00ce of the intervals (0, \u00ce) (for attractive models) resp. (-\u00ce, \u00ce) (for mixed models) for sampling Jij between 0 and 3 in steps of 0.1 (instead of varying the counting numbers c or scale factors (). We compare the performance of the algorithms by using the l\u00b9-errors w.r.t. the singleton and pairwise marginals, and the absolute error w.r.t. the log-partition function. We consider the same scenarios regarding the strength of the local potentials: 0\u00bf ~ U(\u22120.2,0.2), ~ U(-0.6,0.6), and ~ U(\u22121,1). The experiments are performed on a complete graph on 10 vertices. Further experiments on grid graphs and Erdos-Renyi random graphs are presented in the Appendix. For each configuration of the potentials and each algorithm the results are averaged over 100 models."}, {"title": "4.1 ATTRACTIVE MODELS", "content": "The results for attractive models are shown in Fig. 4. We observe that all algorithms per-form well if the correlations between model variables are weak (i.e., if the parameters Jij are small). If Jij increases beyond a certain threshold (that differs for each method), most algorithms experience a significant degradation of their approximation accuracy. This effect is sometimes referred to as a phase transition in the model, and may be explained by the loss of certain properties such as convexity or uniqueness of a minimum (Mooij and Kappen, 2007; Zdeborov\u00e1 and Krzakala, 2016; Leisenberger et al., 2024). In Wainwright et al. (2008) it is argued that convex approximations are more robust to such spontaneous changes in the model dynamics. For the marginals this agrees with our observations, but for the partition function this is less obvious.\nFor estimating singleton marginals, ADAPT-\u03da proves to be the most stable alternative that only suffers a slight loss of accuracy during the increase of Jij. This is especially distinct for weak local potentials \u03b8i, while for stronger local potentials also SBP improves its per-formance considerably. For estimating pairwise marginals, ADAPT-C is less robust and slightly outperformed by SBP. For strong local and pairwise potentials, both methods are superior to the convex approximations. For estimating the partition function, SBP clearly shows the most accurate and stable performance while ADAPT-C is not competitive (thus the corresponding results are omitted at this point)."}, {"title": "4.2 MIXED MODELS", "content": "The results for mixed models are shown in Fig. 5. Similar as for attractive models, the performance of most algorithms deteriorates if Jij increases. However, this degradation happens rather slowly and steadily than spontanously; in particular, an acceptable approx-imation accuracy for the marginals is achieved for even higher values of Jij. Two possible explanations for this behavior are the following: either properties such as convexity or uniqueness of a minimum are less relevant in mixed models (Weller et al., 2014); or these properties are relevant but preserved in models with stronger correlations (Leisenberger et al., 2024).\nFor estimating singleton marginals SBP is the most stable alternative, while ADAPT-C is inferior for weak local potentials \u03b8i. If \u03b8i increases, ADAPT-c achieves a similar performance as SBP. For pairwise potentials the situation is similiar with ADAPT-c even having a slight advantage over SBP if local potentials are strong. For estimating the partition function, ADAPT-c is by far the most powerful alternative. While any other method fails to approx-imate Z by several orders of magnitude, ADAPT-c proves to be accurate and stable. These observations are in agreement with the discussion of Fc-approximations in Sec. 3.1. This indicates that ADAPT-c performs well in approximating the solution of problem (21)."}, {"title": "5 CONCLUSION", "content": "In this work we have considered pairwise free energy approximations of two particular classes Fc and Fr, which both generalize the Bethe free energy. We have analyzed them in a broader context, by systematically varying their governing parameters (the counting numbers Cij for Fc and the scale factors (\u0160ij for Fr) and evaluating the impact on their approximation accuracy. We have drawn practical conclusions, and proposed two adaptive free energy approximations \u2013 one for attractive and one for mixed models - that automatically adapt to a model. Our experiments show that our algorithms slightly improve on estimating singleton marginals in attractive models and pairwise marginals in mixed models, and drastically improve on estimating the partition function in mixed models."}, {"title": "Appendix A. Results from related work", "content": "For implementing our algorithms, we require a few results from related work. First, we use from Welling and Teh (2001) that we can reparameterize the local polytope L to get a simpler description of pairwise free energy approximations (Sec. 2 in the main paper).\nLet Xi, Xj be any pair of connected variables and let pi, pj, pij be a set of associated pseudo-marginal vectors from the local polytope L (i.e., with all entries satisfying the constraints in the definition of L). Let us denote the individual pseudo-marginal probabilities for Xi and Xj being in state +1 by qi := Pi(Xi = +1) and qj := pj(Xj = +1) and let us further denote the joint pseudo-marginal probability for Xi, Xj being both in state +1 by \u0160ij := Pij(Xi = +1, X\u2081 = +1). Then, as pi, pj, Pij must satisfy the constraints of L, all five remaining entries of these vectors can already be expressed in terms of qi, qj, \u0160ij according to the following table:\nAdditionally, we have constraints on the independent parameters qi, qj, \u0160ij of the form\n$0 < q_i < 1,$\n$0 < q_j < 1,$\n$max(0, q_i + q_j - 1) < \\xi_{ij} < min(q_i, q_j).$\nThis step reparameterizes the local polytope by exploiting probabilistic dependencies be-tween variables and removing a considerable number of redundant parameters. If we collect all node-specific variables q\u012f in a vector q and all edge-specific parameters \u0160ij in a vector \u00a7, we can compactly rewrite the local polytope L as the set\n$L = \\{(q; \\xi) \\in \\mathbb{R}^{|X|+|E|} : 0 < q_i < 1, i \\in X;\\newline max(0, q_i + q_j - 1) < \\xi_{ij} < min(q_i, q_j), (i, j) \\in E\\}.$\n15. More precisely, pi =\nand pij ="}, {"title": "Appendix B. Details on Algorithms", "content": "This section includes the pseudocodes of the algorithms that we have proposed and applied in our work:\n\u2022 Algorithm 1 F-MIN was used in Sec. 3 and 4 of the main paper to minimize an arbitrary pairwise free energy approximation of class Fc or Fr (or a combination of both) to obtain estimates to the exact marginals and partition function.\n\u2022 Algorithm 2 is used as a subroutine in F-MIN for an adaptive choice of the step size in the projected Quasi-Newton iterations.\n\u2022 Algorithm 3 is ADAPT-c which was proposed in the main paper for approximate infer-ence in mixed models.\n\u2022 Algorithm 4 is ADAPT-, which was proposed in the main paper for approximate infer-ence in attractive models.\nAlgorithm 1 describes our proposed method F-MIN for minimizing a free energy approxi-mation Fes of class Fc or F\u00e7 (or a combination of both) on B that we have applied in our experiments in Sec. 3 and 4 in the main paper. First, one initializes the singleton pseudo-marginals q(0). Until convergence, F-MIN iterates through the following steps: Update of the search direction according a quasi-Newton scheme, i.e., with the inverse Hessian being replaced by an approximation; projecting the largest possible step back into B; optimiz-ing the step size via an adaptive Wolfe line search (WOLFE-LS, described in Algorithm 2); updating the parameter vector according to\n$q^{(t+1)} = q^{(t)} - \\rho^{(t)}. (B^{(t)})^T \\nabla F_{c,\\zeta}(q^{(t)}),$\n(29)\nand updating the current approximation to the inverse Hessian (we use the BFGS update rules for approximating the inverse Hessian, Nocedal and Wright (2006)). For checking convergence, we compute the gradient norm with respect to the current parameter vector q(t). After F-MIN has converged, it returns a stationary point q* (usually a minimum) of \u03be\u03b5\u03c2.\nThe Wolfe conditions used in the adaptive line search stategy are as follows:\n$F_{c,\\zeta} (q^{tail} + \\rho^W . (q^{head} - q^{tail})) < F_{c,\\zeta}(q^{tail}) + \\tau_1 . \\rho^W . d^T \\nabla F_{c,\\zeta}(q^{tail})$                  (W1)\n$d^T \\nabla F_{c,\\zeta} (q^{tail} + \\rho^W . (q^{head} - q^{tail})) \\geq \\tau_2 . d^T \\nabla F_{c,\\zeta}(q^{tail})$                  (W2)\nThe parameter vectors qtail and qhead specify the search interval. Condition (W1) ensures that there is a sufficient decrease of the energy function after each iteration. This can be achieved by sufficiently reducing the step size pW to prevent Fapprox from increasing again (which may happen if the step is too large). Conversely, condition (W2) ensures that we do not stop moving along the search direction d, as long as the energy function descends sufficiently steeply. Hence, the step size must not be chosen too small. Both conditions together guarantee that the step size is neither chosen too great nor too small. The parameters T\u2081 and T2 control how 'strict' the individual conditions are. Following"}, {"title": "Appendix C. Additional analysis of Fc - and F; - approximations", "content": "This section includes additional experiments. In Sec. C.1, we perform an analogous analysis of class Fe approximations as in Sec. 3.1 of the main paper; in Sec. C.2, we perform an analogous analysis of class Fr approximations as in Sec. 3.2 of the main paper. We show some more evaluations on the complete graph on 10 nodes, and additionally on a grid graph on 5 x 5 vertices, and Erdos-Renyi random graphs (Erdos and Renyi, 1959) on 25 nodes and an edge probability of 0.2 (i.e., the probability that a pair of nodes is connected by an edge). The experimental setup is the same as explained in Sec. 3 of the main paper; in particular, the results are averaged over 100 individual models for each specific configuration of the potentials."}, {"title": "Appendix D. Additional experiments", "content": "In this section we present additional experiments in which we compare the inference al-gorithms introduced in the main paper to each other. As in Sec. C of this Appendix, we present additional experiments on the complete graph on 10 vertices, on a grid graph on 5 \u00d7 5 vertices, and Erdos-Renyi random graphs (Erdos and Renyi, 1959) on 25 nodes and"}]}