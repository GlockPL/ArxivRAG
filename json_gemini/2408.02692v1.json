{"title": "Attention is all you need for an improved CNN-based flash flood susceptibility modeling. The case of the ungauged Rheraya watershed, Morocco", "authors": ["Akram Elghouatab", "Ahmed Algouti", "Abdellah Algouti", "Soukaina Baid"], "abstract": "Effective flood hazard management requires evaluating and predicting flash flood susceptibility. Convolutional neural networks (CNNs) are commonly used for this task but face issues like gradient explosion and overfitting. This study explores the use of an attention mechanism, specifically the convolutional block attention module (CBAM), to enhance CNN models for flash flood susceptibility in the ungauged Rheraya watershed, a flood prone region. We used ResNet18, DenseNet121, and Xception as backbone architectures, integrating CBAM at different locations. Our dataset included 16 conditioning factors and 522 flash flood inventory points. Performance was evaluated using accuracy, precision, recall, F1-score, and the area under the curve (AUC) of the receiver operating characteristic (ROC). Results showed that CBAM significantly improved model performance, with DenseNet121 incorporating CBAM in each convolutional block achieving the best results (accuracy = 0.95, AUC = 0.98). Distance to river and drainage density were identified as key factors. These findings demonstrate the effectiveness of the attention mechanism in improving flash flood susceptibility modeling and offer valuable insights for disaster management.", "sections": [{"title": "1. Introduction", "content": "Flash floods are considered one of the most devastating, costly, challenging, and widespread natural hazards globally (Jeyaseelan 2003, Tingsanchali 2012; Kuenzer et al. 2013; Dahri & Abida 2017; Nogueira et al. 2018; Mohanty et al. 2020). These events emerge from rapid and excessive rainfall occurring within a concise timeframe, typically around 6 hours, and often in mountainous environments (Li et al. 2019), resulting in erosion, landslides, substantial damage to infrastructure and properties, and even significant loss of life (Cao et al. 2016). In fact, they are responsible for almost 84% of global deaths related to natural disaster (Jamali et al. 2020). In recent years, scientific communities worldwide have expressed huge concern about flash floods, as they expect that global warming, population growth, deforestation, and land use planning will increase the frequency and severity of these events, which will result in significant economic and social impacts (Bouwer et al. 2010, De Leijster et al. 2021, Mackay 2008, Woodruff et al. 2013, Hirabayashi et al. 2013, Guha-Sapir et al. 2016, Mekonnen & Hoekstra 2016). Therefore, there is an urgent need for effective spatial prediction of flash flood occurrences on different spatial scales to mitigate their damaging impacts.\nAchieving absolute prevention of flood damage seems like a challenging and complex task. Flood management efforts therefore increasingly prioritize proactive measures like evaluating susceptibility and vulnerability in flood-prone regions (Hoque et al. 2019). The comprehensive understanding and identification of these susceptible areas through advanced and appropriate mapping techniques can offer effective mitigation strate-\ngies, including emergency evacuation plans (Guerriero et al. 2020; Klipalo et al. 2022; Musolino et al. 2020; Tehrany et al. 2013; Cloke & Pappenberger 2009). Flash flood susceptibility mapping (FFSM) is considered a crucial tool in preventing and managing flash flood events, as it provides significant information about the spatial likelihood of future flash floods taking into consideration topographical features, hydrological aspects, and climatic conditions (Jacinto et al. 2015; Vojtek & Vojtekov\u00e1 2019). This provides targeted guidance to facilitate the implementation of flash flood control and disaster reduction measures that can subsequently reduce potential losses (Choubin et al. 2019; Hong et al. 2018; Saha et al. 2021). Modeling susceptibility to flash floods is thus a prominent global research focus nowadays.\nMultiple methods have been developed by researchers to assess and measure flood susceptibility (Sahana et al. 2020; Costache et al. 2020a; Islam et al. 2021 Islam et al. 2021; Pradhan et al. 2023). Former approaches primarily relied on expert knowledge, physical-based models such as HEC-RAS, SWAT, WetSpa (Khalil et al. 2017; Ongdas et al. 2020), and traditional statistical models, encompassing techniques like frequency ratio analysis, discriminant analysis, and generalized linear models (GLMs) (Choubin et al. 2019; Zeng et al. 2021. However, these approaches are time-consuming and require extensive measurement datasets (Costache et al. 2022). Recently, the rapid evolution and advancements of technology in both hardware and software have opened the door to the use of more sophisticated and advanced data-driven models in environmental studies. Particularly, several machine learning (ML) algorithms have gained widespread application, such as artificial neural networks (ANN), support vector machines (SVM), random forests (RF), decision trees (DT), naive bayes (NB), and K-Nearest Neighbors (KNN) (Kabir et al. 2020; Pham et al. 2021; Bui et al. 2020b Wang et al. 2020a; Eini et al. 2020; Lin et al. 2022; Khoirunisa et al. 2021; Priscillia et al. 2021; Khosravi et al. 2018). These models have showcased superior performance and improved assessment quality compared to traditional methods (Elghouat et al. 2024; Khosravi et al. 2018; Hayashi 2019; Gudiyangada Nachappa & Meena 2020; Zhongping et al. 2020). They analyze topography, hydrological traits, land use, and historical flood occurrences to identify key variables influencing flash floods. Moreover, the availability of remote sensing data has facilitated the application of ML techniques. These data sources provide vital information for mapping flood susceptibility by capturing details about past flood events in addition to different linked factors (Zhao et al. 2020). This will help improve our understanding and prediction of floods, contributing to better flood management and mitigation strategies.\nDeep learning methods, a subset of ML algorithms, have been increasingly explored for supervised and unsupervised classification, segmentation, and regression tasks. They prove particularly efficient and beneficial when dealing with large datasets (Wang et al. 2020a; Wang et al. 2020b). Among DL models, deep neural networks (DNNs) and convolutional neural networks (CNNs) take precedence in applications due to their capacity and efficiency to automatically identify crucial features in datasets (Alzubaidi et al. 2021). For flood susceptibility, Bentivoglio et al. (2022) highlighted that CNNs are the most utilized deep learning models across a majority of research papers. They showed superior predictive performance over conventional ML algorithms. For instance, Zhao et al. (2020) conducted an urban flood susceptibility study utilizing RF,\nSVM, and CNN methods, with CNN demonstrating the highest performance. Wang et al. (2020a) compared SVM and CNN models for mapping flood susceptibility using different data-input methods, revealing CNN's superior accuracy in the 2D-based input approach. Similarly, Liu et al. (2021) assessed the performance of three hybrid models, including SVM, classification and regression trees (CART), and a CNN, with the latter outperforming the other models. These models consistently exhibit strong performance in flood susceptibility studies. Various CNN architectures, such as LeNet-5, AlexNet, VGGNet, ResNet, InceptionNet, and more, have been developed, each with distinct strengths and weaknesses. However, although these CNN architectures are robust and efficient, they still suffer from drawbacks (Joshi et al. 2019). Deeper CNNs commonly face challenges such as gradient explosion or vanishing (Joshi et al. 2019), whereas wider CNNs may induce overfitting phenomena (Joshi et al. 2019). Therefore, the key is to ensure that CNNs concentrate on learning and emphasizing important information instead of learning non-useful background information.\nIn this context, attention modules have emerged as a significant enhancement for CNN architectures in multiple tasks, including image classification (Vaswani et al. 2017). Along with attention modules, CBAM (i.e., convolutional block attention module) integrates both channel and spatial attention mechanisms within any CNN, allowing the network to focus not only on critical spatial features but also on important channels within the data (Woo et al. 2018). It is a lightweight module that adds very few extra parameters to a CNN and doesn't burden the computations much. Multiple studies have showcased the ability of this module to direct network focus towards learning only the important things, resulting in enhanced performance of their DL models (Zheng et al. 2022; Ravi & Alazab 2023; Mao et al. 2023; Alirezazadeh et al. 2023). However, the literature shows no studies with a focus on flash flood susceptibility modeling. Adding the attention mechanism could therefore make CNNs better at distinguishing and recognizing patterns in data related to flash floods, leading to more accurate results.\nThis study aims to assess the effectiveness of attention-based CNNs in predicting flash flood susceptibility. The specific objectives were: (1) to compare the performance of CBAM-based CNNs with baseline models such as ResNet18, DenseNet121, and Xception in predicting flash flood susceptibility and use the most accurate model to create a susceptibility map; and (2) to assess the impact of the CBAM attention module's location within the CNN architecture on flash flood susceptibility predictions. In this study, we selected the ungauged Rheraya watershed, a region with a history of flash flood events, and considered 16 well-chosen conditioning factors that influence flash flooding. The innovations of this study include: (1) it is the first application of attention-based CNNs in flash flood susceptibility; (2) it is the first evaluation of the CB\u0410\u041c attention module's location within the CNN architecture on flash flood susceptibility model performance; and (3) the generation of the first deep learning-based flash flood susceptibility map for the Rheraya watershed, a flood-prone area. The findings of this study will assist authorities and policymakers in mitigating the risks of flash flooding in the area and in devising effective measures to prevent potential losses."}, {"title": "2. Materials and Methods", "content": null}, {"title": "2.1. Study area", "content": "The Rheraya watershed lies in the southern region of Marrakech city, within the Western High Atlas area. Its outlet is defined by the Tahanaout hydrometric station at coordinates 31.3\u00b0N, 7.9\u00b0E (Figure 1). Key population centers in this region include Asni, Imlil, and Moulay Brahim. Regarded as a significant catchment area in the High Atlas range, the Rheraya covers approximately 224 km2, with elevations spanning from 1084 to 4167 meters and steep slopes reaching up to 80\u00b0. The region experiences an average annual rainfall of 363 mm, with temperatures ranging typically between 18 and 38 degrees Celsius. Hillslopes within this area are characterized by degraded rangelands with sparse vegetation and rocky terrain, while the valley hosts a narrow stretch of cultivated land on both sides of the river (Boudhar et al. 2007).\nThe study area is an ungauged basin with a documented history of destructive flash flood events causing substantial damage to agricultural land, infrastructure, and buildings. Notably, the region experienced a devastating flash flood in 1995 due to intense, short-term rainfall, resulting in over 150 fatalities, including 60 tourists (DIGBY 2000). Additionally, a severe flash flood in 2019 caused significant property damage (Figure 2). The high vulnerability and loss of life in this area are linked to the population's occupation of these exposed regions, primarily for tourism purposes (El Fels et al. 2018). The severity of the consequences of these events and the high frequency of this phenomenon in this region made it suitable for the implementation and development of an attention-based CNN model for flash flood susceptibility in order to evaluate its efficiency and predictive performance."}, {"title": "2.2. Flash flood inventory", "content": "Identifying and creating a precise historical inventory of flash floods is an essential step in assessing and investigating the relationship between flash floods and their causal factors, enabling the development of accurate flash flood susceptibility maps (Choubin et al. 2019). Current approaches rely on historical archives, field surveys, and remote sensing satellite data. In this study, we generated an inventory of historical flash flood events based on records from the Hydraulic Basin Agency of Tensift (ABHT), followed by a field survey in which local residents contributed to the development of this inventory. Validating the obtained data is a mandatory step to ensure its trustworthiness and accuracy. Therefore, pre-flood and post-flood remote-sensing images were analyzed to ascertain the existence and validation of the documented flash flood records. We calculated the Sentinel-1 dual-polarization water index (SDWI) and the normalized difference water index (NDWI) using Landsat data to identify the flooded areas (DeVries et al. 2020; Mehmood et al. 2021). The validation step was conducted using the Google Earth Engine platform (GEE).\nA total of 261 flash flood locations from 1994 to 2022 were identified. Additionally, we generated 261 points designated as 'non-flash flood' from areas where there was no evidence of flash flood occurrences using the geo-processing tool 'create random points', within the data management tool in ArcGIS software (ESRI 2011)."}, {"title": "2.3. Flash conditioning factors", "content": "The process of identifying flash flood causative factors lacks a universal framework, as it depends on the complex interactions between local environmental dynamics and historical flash flood events (Gui et al. 2023). Also, these phenomena have characteristics that differ from region to region. Therefore, selecting the most sensitive flash flood conditioning factors is critical for developing an accurate flash flood-susceptibility map. In this study, 16 conditioning factors were thoughtfully selected based on a comprehensive literature review of previous studies, data availability, and the characteristics of flash flood development in the Rheraya watershed (Figure 3,4,5). We made sure to consider different aspects of the study area, including topographical, hydrological, meteorological, environmental, and anthropogenic features (Table 1). All factors were transformed into raster format, then aligned and resampled to 12.5 meters to ensure spatial consistency. Subsequently, data standardization was implemented to ensure a consistent scale and distribution of data values. Finally, the entire dataset was divided into training, validation, and testing sets."}, {"title": "2.3.1. Topographical factors", "content": "The topographical factors, including elevation, slope, aspect, curvature, distance to river, convergence index (CI), topographical positioning index (TPI), and ruggedness index (RI), were computed via processing in ArcGIS 10.2. The derived data were obtained using a 12.5 m-resolution PALSAR Phased Array type L-band Digital Elevation Model (DEM) obtained from the Alaska Satellite Facility (ASF). Elevation is a key factor in flash flood modeling, given the inverse relationship between elevation and flash floods (Fern\u00e1ndez & Lutz 2010; (Bui et al. 2020b; (Dodangeh et al. 2020). With decreasing elevation, the terrain tends to flatten, leading to increased river water flow and vice versa (Cao et al. 2016). Slope is a critical factor that affects flash floods occurrence, since it affects the speed of the water flow (Stevaux et al. 2020). Regions with gentler slopes are more likely to accumulate water, potentially facilitating higher infiltration rates and reduced surface runoff speeds. These areas could be more prone to flash floods. Aspect refers to the direction of the predominant slope on the surface of the terrain. It indirectly affects flash flooding as it influences floodwater flow directions, which helps to maintain soil moisture (Chu et al. 2020). Curvature delineates areas where runoff diverges or converges, impacting water flow dynamics (Ginesta Torcivia & R\u00edos L\u00f3pez 2020). Runoff speed can vary based on the slope. Convex slopes often promote faster overland flow, potentially affecting infiltration and soil saturation (Cao et al. 2016), whereas concave slopes might slow down overland flow and potentially aid infiltration (Young & Mutchler 1969). Distance to river significantly influences flash flood vulnerability within a watershed as it affects the extent of flooding (Tehrany et al. 2015). Areas close to the hydrographic network often face a higher susceptibility to flooding compared to those situated farther away (Butler et al. 2006; Chapi et al. 2017). The topographic position index (TPI) measures the elevation difference between a specific point and its surrounding area. It helps identify topographic features like valleys, hills, or bottoms (Zwoli\u0144ski & Stefa\u0144ska 2015; Newman et al. 2018). Generally, areas with higher elevations and steeper slope, indicated by TPI, tend to be less susceptible to flash flooding compared to lower-lying regions (Alam et al. 2021). The ruggedness index measures terrain roughness based on elevation variations. In flash floods, rugged terrain might affect water flow patterns, potentially influencing flash flood behavior due to altered landscape topography (Alam et al. 2021)."}, {"title": "2.3.2. Hydrological and meteorological factors", "content": "Hydrological and meteorological factors directly influence the occurrence and severity of flash floods. Various factors were taken into consideration in this study, such as stream power index (SPI), topographical wetness index (TWI), drainage density, convergence index, flow accumulation, and rainfall. SPI quantifies a river's erosive potential by assessing its ability to transport sediment and erode its bed during flood events, influencing the river's overall fluvial system (Knighton 1999; Pamu\u010dar et al. 2017). TWI identifies variations in spatial wetness and highlights areas susceptible to water accumulation (Chapi et al. 2017; Beven & Kirkby 1979; Moore et al. 1991). It helps predict potential flash flood-prone zones by considering the ratios of basin area to slope angles (Wilson & Gallant 2000; Nhu et al. 2020). Drainage density measures the total length of streams within a watershed area (Elmore et al. 2013; Nguyen et al. 2020). Higher drainage densities suggest increased surface runoff potential, which can contribute to flooding under certain conditions (Chapi et al. 2017). The convergence index measures the degree of river network convergence within a region, highlighting valleys and inter-alluvial surfaces (Costache & Zaharia 2017). Flow accumulation quantifies the cumulative flow contribution from neighboring cells towards each specific cell within a terrain. It is a crucial factor in identifying water accumulation patterns and potential flash flood-prone areas in a landscape (Abdel Hamid et al. 2020). Rainfall is one of the most critical factors that causes flash floods (Pourghasemi et al. 2020). These sudden floods arise when rainfall exceeds the ground's capacity to absorb water, causing rapid and unexpected flooding. In this study, we used data from 1994 to 2022 collected from two specific meteorological stations, i.e., Tahanaout and Armed, obtained from the hydraulic basin agency of Tensift (ABHT). The IDW (i.e., inverse distance weighted) interpolation method was then used to compute the precipitation variable using ArcGIS 10.2 software."}, {"title": "2.3.3. Environmental and anthropogenic factors", "content": "Environmental and anthropogenic factors included the NDVI (normalized difference vegetation index), landcover, and distance to roads. The NDVI is an index that reflects the changes in vegetation and surface water cover over time (Ahmed & Akter 2017). It expresses the density of vegetation in a region and has a strong influence on flash flooding (Kumar & Acharya 2016). Areas with lower vegetation cover often exhibit increased vulnerability to flooding (Ngo et al. 2018). In this study, the NDVI was calculated using Sentinel-2 Level-2A data spanning six years, from January 1, 2017, to December 31, 2022, which included a total of 538 Sentinel-2 images. These images were filtered to include only the ones with a cloud cover of 20% or less. Through Google Earth Engine (GEE), we generated a raster representing the mean NDVI across all these years. Land cover has a significant influence on surface runoff, infiltration, evaporation, and sediment transport (Benito et al. 2010; Karlsson et al. 2017; Khosravi et al. 2018). It directly affects flash flood occurrence and frequency, which aids in identifying highly susceptible areas. Urban areas characterized by impermeable surfaces, for instance, are more likely to be flooded compared to areas covered by farmlands, forests, and green vegetation (Rahmati et al. 2016). We used the European Space Agency (ESA) WorldCover product, which provides a global land cover map for 2021 at 10 m resolution based on Sentinel-1 and Sentinel-2 data (Zanaga et al. 2022). The landcover categories included 7 classes, including tree cover, shrubland, grassland, cropland, built-up, bare or sparse vegetation, and permanent water bodies. Distance from roads can significantly impact flooding and the susceptibility of an area to flood risks. Roads often act as barriers, altering natural drainage patterns and increasing surface runoff, elevating flash flood vulnerability. Therefore, distance to roads could be an important variable of flash flood susceptibility (Nachappa et al. 2020). We extracted road data from Open Street Map (OSM), and then we calculated the distance from each pixel to the road feature using the Euclidean distance in ArcGIS 10.2."}, {"title": "2.4. Methodology", "content": "In the present research, a CBAM-based CNN model was developed to assess flash flood susceptibility in the Rheraya watershed. Given their advantages, three representative deep CNNs, namely, ResNet 18 (He et al. 2016), Xception (Chollet 2017), and DenseNet121 (Huang et al. 2017), were used as the backbone architectures (detailed in Section 2.4.2). To investigate the impact of the CBAM block on flash flood susceptibility outcomes, we integrated the CBAM at various points within these CNN architectures. Specifically, we tested three insertion points: plugging CBAM into each block of the backbone architecture (Figure 7c), at the head of the backbone architecture (Figure 7a), and at the tail of the backbone architecture (Figure 7b).\nThe workflow of the study is presented as a flowchart in Figure 6, consisting of five main steps: (1) compilation of the GIS and remote sensing database, including flash flood inventory data and 16 well-\nselected flash flood conditioning variables; (2) identification and removal of redundant flash flood influencing variables through factor optimization (i.e., Pearson's correlation and multi-collinearity analysis), followed by the splitting of the database into training, validation, and testing datasets; (3) developed and trained multiple CBAM-based CNNs, including the attention block at different locations within the architectures, and then evaluated and compared their performance using various statistical metrics. (4) generated a flash flood susceptibility map based on the most robust model; and (5) conducted sensitivity analysis on various flash floods with respect to the influencing variables.\nAll models were trained using Keras 2.15.0, with TensorFlow 2.15 serving as the backend. Model weights and biases were initialized from scratch, and the network was trained with a batch size of 4. The initial learning rate was set to 0.001, decreasing by a factor of 10 whenever the validation set's accuracy showed no improvement for 10 consecutive epochs. Models with the lowest validation loss were chosen. Binary cross-entropy served as the loss function for the CNNs. All the analysis and model implementations were performed in Python 3.11.2."}, {"title": "2.4.1. Factor optimization", "content": "Identifying and filtering redundant flash flood-influencing factors with limited classification ability enhances the accuracy of the process as it overcomes training challenges related to high data dimensionality (Pham et al. 2021). In the context of classification or regression problems, it is crucial that independent variables exhibit minimal correlation. This increases the prediction power of the models by selecting the most significant factors and removing the irrelevant ones. Therefore, it is crucial to ensure the dependency between the flash flood conditioning variables through correlation and multicollinearity tests. In this study, we initially computed the Pearson correlation coefficient to examine correlations, followed by computing the variance inflation factor (VIF) to assess multicollinearity. These commonly used metrics have demonstrated high efficiency and accuracy in selecting relevant variables in flood susceptibility analysis (Yang et al. 2022; Tsangaratos et al. 2023). The Pearson correlation coefficient quantifies the linear correlation between two datasets, serving as a tool to evaluate how changes in one variable align with changes in another. It has values ranging from 1 to 1, where a strong correlation is indicated by values equal to or greater than 0.7, a significant correlation falls between 0.5 and 0.7, a weak correlation is between 0.3 and 0.5, and no correlation is indicated when values are lower than 0.3 (Sedgwick 2012). VIF measures multicollinearity among the independent variables, where values higher than 5 to 10 suggest a problem with multicollinearity (Kim 2019)."}, {"title": "2.4.2. Models", "content": null}, {"title": "(a) ResNet18", "content": "ResNet (Deep residual network) is one of the models developed by He et al. (2016) that addresses challenges encountered in the training of deep neural networks. Training deep learning models is often time-consuming and constrained by the number of layers. To overcome these issues, ResNet incorporates skip connections or shortcuts. Notably, the ResNet model exhibits superior performance compared to alternative architectures, as its effectiveness does not diminish with increasing depth. This results in more efficient computational calculations and improved network training capabilities. The ResNet architecture employs skip connections across two to three layers, incorporating Rectified Linear Unit (ReLU) and batch normalization.He et al. (2016) demonstrated that ResNet excels in image classification, outperforming other models and highlighting its proficiency in extracting image features. The implementation of residual learning across multiple layers is a key aspect of ResNet's success. The residual block in ResNet is defined as:\n$y = F(x, W + x)$\nwhere x is the input layer, y is the output layer, and F represents the residual map. ResNet's residual block is effective when input and output data dimensions are identical. Additionally, each ResNet block comprises either two layers (for ResNet-18 and ResNet-34 networks) or three layers (for ResNet-50 and ResNet-101 networks). The initial two layers of the ResNet architecture resemble GoogleNet, employing a 7 \u00d7 7 convolution and 3 \u00d7 3 max-pooling with a stride of 227. In this study, we chose ResNet-18, which contains 17 convolution layers and 1 fully connected layer."}, {"title": "(b) DenseNet121", "content": "Dense convolutional networks (DenseNets), introduced by Huang et al. (2017), represent a highly effective architecture alternative to ResNets, showcasing superior performance across various classification tasks, including those in remote sensing applications (Zhang et al. 2019; Tong et al. 2020; Chen & Tsou 2021). In contrast to ResNets, DenseNets feature dense blocks where each layer connects to every preceding layer, incorporating an additional (channel-wise) concatenated input of the previously learned feature maps. This design fosters extensive feature reuse throughout the network, resulting in well-performing and more compact models with fewer trainable parameters compared to an equivalent-sized ResNet. However, this advantage comes with the trade-off of increased memory requirements during training. Equation 2 defines the operation of Densenet:\n$H(x) = T_k(H_{k\u22121}(H_{k\u22122}(... H_1(T_0(x))...)))$\",\n      \""}, {"title": "(c) Xception", "content": "Xception, proposed by Chollet (2017), is a convolutional neural network architecture that aims to enhance traditional convolutional layers by leveraging depthwise separable convolution layers. The term Xception, short for \"Extreme Inception,\" reflects its inspiration from the Inception architecture. The Xception architecture has 36 convolutional layers, forming the feature extraction base of the network. Unlike standard convolutions, Xception utilizes depthwise separable convolutions, consisting of two steps: depthwise convolutions, where a separate 3x3 convolution is applied for each channel, capturing spatial dependencies; and pointwise convolutions, employing a 1x1 convolution across all channels to mix information. This design optimizes parameter usage, reducing computational costs while preserving expressive power. The architecture is modular, featuring repeated depthwise separable convolution blocks with skip connections to facilitate information flow across different depths. These skip connections aid in training very deep networks and support gradient flow during backpropagation, making Xception efficient and powerful for various deep learning tasks."}, {"title": "(d) Convolutional block attention module (CBAM)", "content": "Convolutional block attention module (CBAM) is an attention module for convolutional neural networks (Woo et al. 2018). It can be integrated into any CNN to enhance its representational capacity by guiding the model to focus on relevant features and ignore non-useful background information. The architectural overview of CBAM is depicted in Figure 8a. CBAM combines channel and spatial information through convolution operations, emphasizing key features in the convolution layers. This is achieved with two sequential sub-modules: the channel attention module and the spatial attention module, as shown in Figure 8b. Below, we describe the details of each sub-module:\nChannel attention module: in the convolution process, each channel of intermediate features is treated as a feature detector. The channel attention module exploits inter-channel relationships to determine the importance of each channel. Initially, the spatial dimension of intermediate features undergoes average-pooling and max-pooling to generate two distinct context features. Subsequently, these fea-tures are transformed by a shared multi-layer perceptron (MLP) and combined through element-wise summation. The resulting fused feature is activated by a sigmoid function, representing the channel importance of the original feature map. Mathematically, the channel attention module's calculation process is defined as:\n$M_c(F) = f_{sigmoid} (MLP(AvgPool(F)) + MLP(MaxPool(F)))$\nSpatial attention module: in contrast to the channel attention module, the spatial attention module focuses on determining \"where\" in the input space significant information lies, complementing the channel attention. It aims to generate refined features by exploiting inter-spatial relations in the original features. This involves applying average-pooling and max-pooling along the channel axis, concatenating the outputs, and converting the concatenated descriptor into a spatial attention map through a 7 \u00d7 7 convolution and a sigmoid operation. The spatial attention module's computation can be expressed as:\n$M_s(F) = f_{sigmoid} (Conv([AvgPool(F); MaxPool(F)]))$\nFinally, CBAM combines attention maps derived from the channel and spatial attention modules to generate refined feature maps. The combination of the two sub-modules is described by:\n$F' = M_c(F) \u2297 F$\n$F'' = M_s(F') \u2297 F'$\nwhere F represents an intermediate feature map of the CNN, \u2297 denotes element-wise multiplication, and $F''$ is the resulting refined feature map."}, {"title": "2.4.3. Model validation", "content": "To evaluate our model, four common metrics were used: accuracy (A), precision (P), recall (R), and F1-score (F). These metrics rely on values obtained from the confusion matrix, where true-positive (TP) and true-negative (TN) signify correctly predicted positive and negative samples, while false-positive (FP) and false-negative (FN) represent misclassified positive and negative samples. The calculations for these metrics are as follows:\n$A = \\frac{TP+TN}{TP+FP+TN+FN}$\n$P = \\frac{TP}{TP + FP}$\n$R= \\frac{TP}{TP + FN}$\n$F = \\frac{2PR}{P+R}$\nAdditionally, the evaluation incorporated the use of the receiver operating characteristic (ROC) curve and the area under the curve (AUC). The ROC curve plots \"1-specificity\" on the X-axis against \"sensitivity\" on the Y-axis. Specifically, false positive rate (FPR) is represented by \"1-specificity\", and true positive rate (TPR) is represented by \"sensitivity\". These measures are computed as follows:\n$FPR= \\frac{TN}{TN + FP}$\n$TPR= \\frac{TP}{TP + FN}$\nThe AUC value ranges from 0.5 to 1. A higher AUC means better classification performance."}, {"title": "2.4.4. Sensitivity analysis", "content": "Sensitivity analysis offers a comprehensive approach to assess the impact of variables or parameters on the variability and uncertainty within numerical model outputs (Xing et al. 2021). Widely adopted for statistical assessments of model characteristics, the Jackknife test holds particular significance, especially in the context of AUC-based statistical coefficients, and is recognized for its effectiveness in addressing a diverse array of practical challenges (Bandos et al. 2017). Hence, in our study, the Jackknife test was used to evaluate the sensitivity of a specific factor to flash flooding.\nIn this test, we compared predictions based on all dependent variables with predictions deliberately excluding one dependent variable. Our focus was on observing the resultant reduction in AUC concerning the original value (Park 2015). The percentage of relative decrease (PRD) emerged as a crucial metric in this analysis. The importance of the excluded factor is considered more pronounced if the PRD experiences a more substantial reduction. The PRD is determined by the formula:\n$PRD = \\frac{100 \u00d7 AUC_0 - AUC_i}{AUC_0}$"}, {"title": "3. Results", "content": null}, {"title": "3.1. Factor optimization", "content": "The correlation between flash flood predictors was calculated using the Pearson coefficient, as shown in Figure 9. The results indicate that most variables have a low correlation, suggesting they are independent. However, a slightly moderate correlation appears between landcover and elevation, slope and rainfall, NDVI and landcover, as well as distance to stream and drainage density. This correlation is not significant. The multi-collinearity analysis was conducted using the VIF to enhance the prediction power and performance of the model. The results are summarized in Table 2. The VIF values range from 1.0086 to 4.7282, with rainfall exhibiting the highest value and aspect the lowest. These findings imply that there are no multi-collinearity problems among the flash flood variables. Therefore, all 16 variables were included in the present study."}, {"title": "3.2. Model validation", "content": "The performance of the twelve models was assessed using various standard quantitative metrics (Table 3). The results show that adding the CBAM attention module significantly improved performance, demonstrating its effectiveness in flash flood susceptibility modeling. In addition, the"}]}