{"title": "AlphaSharpe: LLM-Driven Discovery of Robust Risk-Adjusted Metrics", "authors": ["Kamer Ali Yuksel", "Hassan Sawaf"], "abstract": "Financial metrics like the Sharpe ratio are pivotal in evaluating investment performance by balancing risk and return. However, traditional metrics often struggle with robustness and generalization, particularly in dynamic and volatile market conditions. This paper introduces AlphaSharpe, a novel framework leveraging large language models (LLMs) to iteratively evolve and optimize financial metrics to discover enhanced risk-return metrics that outperform traditional approaches in robustness and correlation with future performance metrics by employing iterative crossover, mutation, and evaluation. Key contributions of this work include: (1) a novel use of LLMs to generate and refine financial metrics with implicit domain-specific knowledge, (2) a scoring mechanism to ensure that evolved metrics generalize effectively to unseen data, and (3) an empirical demonstration of 3x predictive power for future risk-returns, and 2x portfolio performance. Experimental results in a real-world dataset highlight the superiority of discovered metrics, making them highly relevant to portfolio managers and financial decision-makers. This framework not only addresses the limitations of existing metrics but also showcases the potential of LLMs in advancing financial analytics, paving the way for informed and robust investment strategies.", "sections": [{"title": "1 Introduction", "content": "In finance, performance metrics such as the Sharpe ratio are pivotal in evaluating the trade-off between risk and return. The Sharpe ratio (the ratio of excess returns to the standard deviation of returns) has become a cornerstone of modern portfolio management due to its simplicity and widespread applicability. Yet, despite their popularity, the Sharpe ratio and similar metrics have several inherent limitations. There is a pressing need for financial performance metrics that are robust to market anomalies and capable of generalizing effectively to future scenarios. Such metrics should strongly correlate with future performance, providing actionable insights for portfolio managers and investors. Designing these advanced metrics, however, is a complex task that requires blending financial domain expertise with cutting-edge computational techniques. Large Language Models (LLMs) present a unique opportunity to address these challenges. LLMs, trained on vast data corpora, exhibit an unparalleled ability to generate creative and contextually relevant solutions across domains. Their ability to analyze existing financial literature, synthesize insights, and propose novel approaches makes them ideal candidates for evolving financial metrics. Enhancing financial metric robustness has significant implications for portfolio management. Robust metrics enable more reliable decision-making by mitigating the impact of data noise and outliers. Furthermore, metrics that generalize to future scenarios help portfolio managers align their strategies with long-term performance goals. Integrating LLMs and iterative optimization represents a transformative step toward achieving these objectives. This paper introduces AlphaSharpe, a novel framework for evolving robust financial metrics using LLMs. AlphaSharpe leverages the generative capabilities of LLMs to propose innovative financial metrics and employs iterative optimization techniques to refine and validate these metrics. The framework addresses traditional metrics' limitations by focusing on robustness, generalization, and predictive performance. The key contributions:\n\n1.  A comprehensive system that utilizes LLMs for iterative refinement of investment performance metrics through crossover, mutation, and scoring to discover novel interpretable metrics with proven out-of-sample robustness.\n\n2.  The innovative use of LLMs to generate diverse metric variants instilling financial literature and mathematical principles, enabling creativity in financial metric design."}, {"title": "2 Background", "content": "Financial metrics are critical for evaluating investment performance (Markowitz, 1952). Metrics like the Sharpe Ratio by Sharpe (1966), have long been used to assess risk-adjusted returns but face notable limitations. While widely adopted, they are sensitive to outliers, rely on normality assumptions, and lack robustness in non-stationary environments.\n\n\u2022 Sensitivity to Outliers: Metrics like the Sharpe ratio can be skewed by extreme values in return distributions (Bailey and L\u00f3pez de Prado, 2014).\n\n\u2022 Stationarity Assumptions: These metrics assume a static risk-return relationship, which may not hold in dynamic markets (Bailey and L\u00f3pez de Prado, 2012).\n\n\u2022 Backward-Looking Nature: They evaluate past performance without adequately correlating with future outcomes.\n\n\u2022 Limited Generalization: Metrics often fail to adapt to diverse asset classes or market conditions, leading to suboptimal decisions.\n\nAn improvement over the traditional Sharpe ratio, the Probabilistic Sharpe Ratio (PSR), incorporates statistical inference to account for uncertainty in performance evaluation (Bailey and L\u00f3pez de Prado, 2014). By considering the distribution of Sharpe ratio estimates, the PSR reduces noise and offers a probabilistic interpretation of performance consistency. Human-discovered innovations in financial investment performance metrics like the PSR are revolutionary but still suboptimal in robustness and predictive generalization.\n\nMachine learning (ML) has transformed financial analysis by introducing adaptive and predictive capabilities that traditional approaches lack. It has been widely applied in portfolio optimization, risk management, and metric design. ML models, like Deep Neural Networks (DNNs), and reinforcement learning enable learning dynamic asset allocation strategies. These models optimize for risk-adjusted returns under varying market conditions, outperforming static portfolio strategies. DNNs can be used to train nonlinear metrics that capture complex relationships in return data, offering enhanced predictive accuracy over traditional methods. For example, DNNs trained on historical data optimize for metrics that maximize future performance consistency. Yet, these approaches would be heavily prone to overfitting and lack interpretability.\n\nRecent advancements in reinforcement learning, particularly through AlphaTensor and AlphaCode, provide a blueprint for iterative optimization and creative problem-solving. AlphaTensor, introduced by Fawzi et al. (2022), uses multi-agent reinforcement learning to optimize algorithms iteratively, discovering efficient methods for matrix multiplication. Its iterative optimization framework inspired the proposed approach for evolving financial metrics. Similarly, AlphaSharpe employs LLMs to propose, score, and refine financial metrics through an iterative workflow, ensuring continuous improvement. AlphaCode, demonstrated by Li et al. (2022), highlights the potential of large-scale models in generating high-quality code for competitive programming tasks. Its ability to learn from examples and refine outputs through iterative feedback strongly parallels the generation of financial metrics optimized for out-of-sample robustness.\n\nRecent works such as Romera-Paredes et al. (2024), also demonstrated how LLMs can contribute to mathematical discovery by automating the search for novel programs and equations, and Lu et al. (2024), who proposed a framework for fully automated, open-ended scientific discovery using LLMs. These works further highlighted the growing potential of AI to drive innovation in scientific and technical domains, reinforcing the potential of LLM-driven iterative workflows like AlphaSharpe to redefine financial metric design."}, {"title": "3 Methodology", "content": "LLMs, such as OpenAI's GPT, Meta's LLama, have demonstrated exceptional capabilities in generating codes for creative and robust algorithms across several domains. In this work, LLMs are used to revolutionize financial metric discovery by:\n\n\u2022 Few-Shot Generation: Leveraging few-shot examples to generate creative variations of existing and discovered metrics, combining domain expertise with data-driven insights.\n\n\u2022 Iterative Optimization: Utilizing evolutionary strategies and feedback loops to iteratively refine generated metrics for better robustness and predictive power.\n\n\u2022 Cross-Domain Inspiration: Drawing on extensive training data across domains, LLMs can introduce concepts from other disciplines to innovate financial metrics.\n\n\u2022 Mutational Refinement: Inspired by evolutionary algorithms, LLMs can suggest mutations to existing metrics, optimizing robustness and generalization.\n\n\u2022 Automated Code Generation: Similar to AlphaCode, LLMs can generate high-quality implementations for new financial metrics.\n\n\u2022 Critical Thinking and Synthesis: By analyzing the academic literature, LLMs can integrate theoretical insights into metric design, ensuring both novelty and rigor.\n\nThe AlphaSharpe is a novel method designed to iteratively optimize financial performance metrics, such as the Sharpe ratio, for out-of-sample robustness by leveraging large language models (LLMs) for creativity and critical thinking. The framework employs an evolutionary approach that blends the implicit domain expertise of LLMs and evolutionary strategies to design metrics that exhibit superior robustness and generalization capabilities. LLMs, such as GPT-based models, generate novel metrics by drawing inspiration from academic literature and best practices in financial analysis. Few-shot learning and prompt engineering guide LLMs in producing relevant and innovative metrics."}, {"title": "3.1 Architecture", "content": "The workflow comprises an iterative four-step process that refines financial metrics through crossover, mutation, scoring, and ranking (selection). Each iteration is designed to improve the metrics' robustness and predictive capabilities incrementally. The framework operates in a looped pipeline, where each iteration refines existing metrics or generates new ones through crossover and mutation:\n\n\u2022 Crossover: Combining elements from a diverse set of top-performing metrics to create hybrids that inherit strengths from all of them.\n\n\u2022 Mutation: LLM generates meaningful variations of crossovered metric by making small but deliberate modifications to enhance predictive capability (out-of-sample robustness).\n\nMutated metrics are evaluated using scoring functions based on:\n\n\u2022 Robustness: Sensitivity to outliers and extreme market conditions.\n\n\u2022 Generalization: Correlation between the metric scores on historical data and future performance (e.g., future Sharpe ratios).\n\n\u2022 Predictive Power: Statistical relevance in identifying high-performing assets.\n\nMetric quality is evaluated using statistical criteria such as robustness, correlation with future Sharpe ratios, and normalized discounted cumulative gain (NDCG). These functions ensure that the designed metrics generalize effectively to unseen scenarios. Metrics are ranked based on quality and diversity; only top candidates are retained for crossover in further iterations. Cross-over combines these top-ranked metrics from the scoring phase to create hybrids blending their computational elements. This process leverages the strengths of individual metrics while mitigating their weaknesses. Metrics that rank poorly are discarded, ensuring only a diverse set of high-quality candidates proceed to further stages (Cully and Demiris, 2017)."}, {"title": "3.2 LLM Usage", "content": "LLMs are integral to the AlphaSharpe, serving as the creative engine for metric generation and refinement. These models enable the system to draw from vast repositories of financial knowledge and provide innovative solutions that traditional methods might overlook. They are trained to understand the structure and purpose of financial metrics based on context from research papers, textbooks,"}, {"title": "3.3 Scoring Functions", "content": "AlphaSharpe employs robust scoring mechanisms to evaluate and evolve financial metrics. These functions measure how well a proposed metric generalizes to the future (out-of-sample) performance. To evaluate and rank top-performing metrics, AlphaSharpe employs the following workflow: (1) Apply the proposed metric to a historical asset log-return dataset to compute scores. (2) Evaluate the alignment of scores with future Sharpe ratios via:\n\n\u2022 Spearman's Rho: Measures the monotonic relationship between rankings produced by the metrics on historical data and the realized future Sharpe ratios (Spearman, 1904).\n\n\u2022 Kendall's Tau: Assesses the strength of ordinal associations between metric scores and future Sharpe ratios, offering a robust ranking correlation metric (Kendall, 1938).\n\n\u2022 Normalized Discounted Cumulative Gain (NDCG): Evaluates the quality of asset rankings, placing greater importance on correctly ranking top-performing assets, critical in financial contexts such as portfolio selection (J\u00e4rvelin and Kek\u00e4l\u00e4inen, 2002).\n\nThese metrics evaluate how consistently the rankings of assets based on the metric align with their rankings based on future performance. They reduce sensitivity to outliers and non-linearities by relying on the ranks of data instead of raw values."}, {"title": "4 Experiments", "content": "Time-series cross-validation was employed to validate and rank metrics as they evolve. The dataset, comprising 15 years of historical data from 3,246 US stocks and ETFs, was split into overlapping folds after separating 20% of the data for the out-of-sample test (3 years). Metrics evolved based on their correlation with future Sharpe ratios within the cross-validation sets, ensuring robust evaluation across different periods. The evolved metrics were finally blind-tested during recent periods of extreme market stress, including the 2020 COVID-19 market crash, highlighting their robustness and stability under high-volatility conditions (Lipton and Lopez de Prado, 2020). Evolved to correlate better with future Sharpe ratios by iteratively refining their formulation through LLM-driven mutation and scoring. The resulting metric adapts to varying market conditions and improves predictive accuracy for future Sharpe ratios, as resulted in experiments. The implementation of the discovered metrics, AlphaSharpe Ratio ($ a_s $), and the code for reproducing the experiments are open-sourced.\n\nThe $ a_{s1} $ to $ a_{s4} $ metrics are advanced alternatives to the traditional Sharpe ratio, addressing its limitations in handling small sample sizes, extreme values, and non-normal return distributions. These metrics provide a robust and realistic assessment of risk-adjusted performance, ensuring greater reliability for evaluating modern financial strategies.\n\n$ a_{s1} = \\frac{exp (E[log R - r_f])}{\\sqrt{(\\sigma_{log R} + \\epsilon) \\cdot (\\sigma_{log R} + \\epsilon)} + V} $\n\n$ a_{s1} $ uses the expected log excess return to emphasize compounding effects, while incorporating stability constants ($ \\epsilon $) to reduce sensitivity to extreme values and ensure robustness in small datasets.\n\n$ a_{s2} = \\frac{exp (E[log R - r_f])}{\\sqrt{\\sigma_{log R} + \\epsilon} + DR + V} $\n\nDownside Risk Adjustment: The $ a_{s2} $ metric builds on its parent $ a_{s1} $ by integrating downside risk. This addition accounts for negative returns, penalizing them more heavily and better reflecting real-world risk asymmetries.\n\n$ DR = \\frac{\\sigma_{R-} + \\sqrt{N} + \\epsilon}{N_{R-} + \\epsilon}  \\cdot \\sigma_{log R} $"}, {"title": "Forecasted Volatility Adjustment", "content": "$ a_{s2} $ also introduces forecasted volatility (V) as an additional component for forward-looking risk assessment:\n\n$ V = \\frac{1}{\\frac{3}{4}n} \\sum_{t=n/4}^{n} (R_t - E[R])^2 $\n\nHigher-Order Moment Adjustment: The $ a_{s3} $ metric further evolves from the $ a_{s2} $ metric by incorporating higher-order moments of return distributions (HAD), such as skewness and kurtosis, along with a dynamic adjustment for drawdown risks. This enables $ a_{s3} $ to more comprehensively evaluate risk-adjusted performance.\n\n$ a_{s3} = a_{s2} \\cdot (1 + \\frac{K}{12} - 1) \\cdot \\frac{1 + \\xi}{1 + MDD} $\n\nRegime Factor Adjustment: $ a_{s4} $ extends the evaluation by incorporating a regime-dependent factor to dynamically adjust for market conditions:\n\n$ a_{s4} = a_{s3} \\cdot (1 + 0.1 \\cdot (P[E[R - r_f] > 0)) $\n\nThese metrics, $ a_{s1} $ through $ a_{s4} $, are particularly suitable for evaluating strategies with log-transformed returns, especially in volatile markets or scenarios with skewed and fat-tailed return distributions. By addressing key limitations of the traditional Sharpe ratio, these advanced metrics offer nuanced, reliable perspectives for assessing risk-adjusted performance. The experimental results demonstrate the significant advantages of AlphaSharpe metrics over traditional financial metrics in ranking correlation and portfolio construction."}, {"title": "4.1 Ranking Correlations", "content": "AlphaSharpe achieved significantly higher ranking correlations than traditional metrics. Table 1 shows the Spearman correlation, Kendall correlation, and NDCG@25% scores for discovered metrics where the empirical results showcase AlphaSharpe's significant enhancement in ranking correlations.\n\n\u2022 Exceptional Ranking Quality: AlphaSharpe achieved over 3x higher Spearman and Kendall correlations than traditional metrics, providing unparalleled asset ranking accuracy.\n\n\u2022 Spearman's Rho: $ a_{s4} $ achieves a correlation of 0.409, which is over 3x higher than the Sharpe Ratio and PSR, demonstrating its robustness in ranking assets effectively."}, {"title": "4.2 Portfolio Construction", "content": "To assess the practical utility of AlphaSharpe, portfolios were constructed by selecting the top-performing assets ranked by each metric. Portfolios were created for the top 10%, 15%, 20%, and 25% of assets. Uniform weights were assigned to all selected assets in the portfolio, ensuring equal exposure to each asset (DeMiguel et al., 2009). The test performance of portfolios was then evaluated using the Sharpe Ratio. Table 2 summarizes the percentage improvements of $ a_{s2} $ over the Sharpe Ratio and PSR regarding the resulting Sharpe Ratio on the test period. AlphaSharpe achieved a +89.11% improvement over the Sharpe Ratio and a +95.73% improvement over PSR, consistently delivering significant improvements across thresholds."}, {"title": "5 Implications", "content": "AlphaSharpe metrics redefine the evaluation of financial strategies by addressing the limitations of traditional measures like the Sharpe Ratio. Their ability to handle small datasets, integrate distributional nuances (such as skewness and kurtosis), and adapt to changing market regimes makes them invaluable for modern portfolio management and risk assessment. The metrics' empirical outperformance demonstrates their reliability in ranking assets and constructing portfolios with superior risk-adjusted returns. As financial markets grow increasingly complex, tools like AlphaSharpe offer a forward-looking, data-driven approach to optimizing investment strategies, ensuring resilience and adaptability in an ever-changing landscape.\n\n\u2022 Enhanced Portfolio Construction: The advanced adjustments within AlphaSharpe metrics enable more precise selection and allocation of portfolio assets, particularly in scenarios involving volatile markets or non-normal return distributions. This ensures robust performance across diverse investment strategies.\n\n\u2022 Improved Risk Management: AlphaSharpe metrics provide a more realistic assessment of risk-adjusted performance by incorporating downside risks, higher-order moments, and dynamic adjustments for market regimes. Investors can better prepare for extreme market events and mitigate potential losses.\n\n\u2022 Dynamic Adaptability: The regime-dependent factors in $ a_{s4} $ allow for dynamic portfolio adjustments, making it ideal for strategies that respond proactively to shifting market conditions and economic cycles.\n\n\u2022 Broader Applicability: AlphaSharpe metrics' ability to outperform traditional measures across ranking, risk assessment, and portfolio optimization makes them a versatile tool for financial analysts, portfolio managers, and quantitative researchers."}, {"title": "6 Discussion", "content": "The LLM-driven evolution blended elements from traditional metrics to address the Sharpe Ratio's limitations. These metrics enhance robustness, generalization, and predictive power by incorporating innovations such as log-transformed returns, downside risk adjustments, higher-order moments, and regime-sensitive factors, making them relevant in financial analysis. $ a_{s1} $ addresses the Sharpe Ratio's sensitivity to outliers and normality assumptions by using log returns and stability constants. Its focus on compounding effects also aligns with the Kelly Criterion (Kelly, 1956) principles. $ a_{s2} $ further extends this foundation by introducing downside risk adjustments, drawing inspiration from the Sortino Ratio (Sortino and Price, 1994) and tail-risk metrics like Value-at-Risk (VaR) and Conditional VAR (Artzner et al., 1999).\n\n$ a_{s3} $ incorporates skewness, kurtosis, and maximum drawdown (MDD) to account for higher-order moments and extreme losses, inspired by metrics such as the Skewness-Adjusted Sharpe Ratio (Zakamulin and Giner, 2015), Calmar Ratio, and Sterling Ratio (Young, 1991). These additions enable $ a_{s3} $ to handle non-normal return distributions and periods of high volatility, similar to the Omega Ratio's focus on capturing the full return distribution (Keating and Shadwick, 2002). Finally, $ a_{s4} $ incorporates regime-dependent adjustments, dynamically adapting to market conditions such as positive or negative excess returns. This aligns with regime-switching models like Markov frameworks (Hamilton, 1989) and extends the adaptability of risk-return metrics with state-dependent factors."}, {"title": "7 Portfolio Optimization", "content": "Traditional portfolio allocation techniques like the Risk Parity Portfolio and Equal Risk Contribu-tion Portfolio often struggle with stability, extreme"}, {"title": "AlphaSharpe Portfolio", "content": "The newly discovered AlphaSharpe Portfolio optimization method follows a structured approach, where it allocates a long-only portfolio by adjusting weights for stability, volatility, and diversification while preserving an optimal risk-return profile.\n\n1.  Compute the mean excess return vector and the covariance matrix, and the inverse covariance-adjusted risk-return vector. R is the excess log return matrix, $ \\mu $ is the mean excess return vector, and $ \\lambda $ is a constant.\n\n$ \\mu = \\frac{1}{T} \\sum_{t=1}^{T} R_t, \\Sigma = Cov(R) + \\lambda I $\n\n$ r = max(0, \\Sigma^{-1}\\mu) $\n\n2.  Introduce a stability factor by incorporating the standard deviation of the inverse covariance-adjusted risk-return vector, apply volatility normalization and softmax normalization to derive initial asset allocations.\n\n$ r' = \\frac{1}{1 + std(r)} \\cdot r $\n\n$ w' = \\frac{r'}{\\sqrt{diag(\\Sigma)} + \\epsilon} $\n\n3.  Introduce entropy regularization to ensure diversification penalizing dominant assets:\n\n$ H = \\sum w_i log(w_i + e) $\n\n$ w' = \\frac{exp(r')}{\\sum_j exp(r')} e^{-H} $\n\n4.  Compute final portfolio weights, ensuring risk-balanced allocation while preventing excessive concentration:\n\n$ w^* = \\frac{max(0, w')}{\\sum_i max(0, w')} $"}, {"title": "8 Conclusion", "content": "This paper introduced AlphaSharpe, a novel framework that leverages LLMs to iteratively evolve robust financial metrics. AlphaSharpe addresses key limitations of traditional risk-adjusted metrics, including limited robustness, poor generalization, and insufficient predictive accuracy; by integrating LLMs for metric design, refinement, and optimization. The evolution of financial metrics demonstrated the power of combining LLM-driven creativity with a structured optimization framework.\n\nLLMs played a pivotal role by generating innovative, interpretable metrics inspired by financial literature and mathematical principles. Their ability to process few-shot examples and extrapolate ideas enabled the discovery of solutions that balance novelty with practical relevance, complementing human expertise and accelerating innovation.\n\nAlphaSharpe metrics significantly improve ranking accuracy and portfolio performance, with adjustments that address volatility, skewness, and market regime shifts. For financial institutions, adopting these metrics enhances decision-making, fosters trust, and delivers competitive advantages by enabling more precise asset selection and allocation, even in dynamic or volatile markets. In conclusion, AlphaSharpe represents a transformative advancement in financial analytics, showcasing the potential of LLMs to redefine risk-return evaluation. By addressing the limitations of traditional metrics and introducing adaptive, robust alternatives, AlphaSharpe paves the way for more informed and resilient investment strategies. Future work can focus on enhancing interpretability and scaling its application across broader use cases."}]}