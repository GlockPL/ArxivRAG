{"title": "DeepFM-Crispr: Prediction of CRISPR On-Target Effects via Deep Learning", "authors": ["Condy Bao", "Fuxiao Liu"], "abstract": "Since the advent of CRISPR-Cas9, a groundbreaking gene-editing technology that enables precise genomic modifications via a short RNA guide sequence, there has been a marked increase in the accessibility and application of this technology across various fields. The success of CRISPR-Cas9 has spurred further investment and led to the discovery of additional CRISPR systems, including CRISPR-Cas13. Distinct from Cas9, which targets DNA, Cas13 targets RNA, offering unique advantages for gene modulation. We focus on Cas13d, a variant known for its collateral activity where it non-specifically cleaves adjacent RNA molecules upon activation, a feature critical to its function. We introduce DeepFM-Crispr, a novel deep learning model developed to predict the on-target efficiency and evaluate the off-target effects of Cas13d. This model harnesses a large language model to generate comprehensive representations rich in evolutionary and structural data, thereby enhancing predictions of RNA secondary structures and overall sgRNA efficacy. A transformer-based architecture processes these inputs to produce a predictive efficacy score. Comparative experiments show that DeepFM-Crispr not only surpasses traditional models but also outperforms recent state-of-the-art deep learning methods in terms of prediction accuracy and reliability.", "sections": [{"title": "1 Introduction", "content": "The discovery and development of Clustered Regularly Interspaced Short Palin-dromic Repeats (CRISPR) and their associated Cas proteins have revolutionized biotechnology and biomedical sciences. Initially identified within the adaptive immune systems of bacteria and archaea, these CRISPR-Cas systems have been ingeniously adapted for genome editing. They exploit their inherent ability to make precise and efficient genetic alterations Doudna and Charpentier (2013); Jinek et al. (2012). The CRISPR locus is characterized by repetitive base sequences interspersed with spacers derived from past viral and plasmid invaders. This locus is transcribed into a long precursor CRISPR RNA (pre-crRNA), which is then processed into mature guide RNAs (crRNAs). These crRNAs direct the Cas proteins to cleave complementary sequences in invading genetic elements, thereby providing adaptive immunity. Among the various CRISPR-Cas systems, CRISPR-Cas9 of Type II has attracted significant attention due to its simplicity"}, {"title": "2 Method", "content": "Our methodology integrates multiple deep learning architectures and data represen-tation techniques to predict the on-target efficiency of sgRNAs based on their sequences and secondary structures. This approach harnesses the power of large language models, convolutional networks, and transformer encoders to process and analyze the complex biological data. The details of DeepFM-Crispr shown in Fig. 1."}, {"title": "2.1 Data Representation", "content": "sgRNA sequences were encoded using a one-hot encoding scheme, where each nucleotide (A, C, G, U) is represented by a binary vector. The vectors for adenine (A), cyto- sine (C), guanine (G), and uracil (U) are respectively [1,0,0,0], [0,1,0,0], [0,0,1,0], and [0,0,0,1]. This methodological choice ensures a uniform input structure for all sequences, facilitating the computational handling of genetic data across diverse sgRNA samples. By transforming the nucleotide sequences into binary vectors, the model can effectively learn from the positional and compositional nuances of the sgRNA without the biases and variances inherent in raw textual data.\nThe one-hot encoded vectors serve as the primary input for the subsequent layers of the machine learning architecture. They are fed into a series of deep learning models that are designed to extract and learn complex patterns and relationships. This initial representation forms the basis for all further transformations and feature extractions performed by the RNA large language model and other components of our predictive framework. The standardized format ensures that each sgRNA is represented in a consis-tent manner, allowing the deep learning algorithms to focus on learning the underlying biological mechanisms rather than adjusting to variations in data format."}, {"title": "2.2 RNA Large Language Model", "content": "RNA-FM Chen et al. (2022) is designed as an end-to-end deep learning model that efficiently extracts latent features from RNA sequences and leverages an attention mechanism to capture contextual information. It features 12 layers of transformer-based bidirectional encoder blocks equipped with positional embeddings. This structure allows RNA-FM to accurately discern the positional context of ncRNA sequences. The encoder within RNA-FM utilizes self-attention and feedforward connections to generate complex representations that integrate context from every sequence position. Furthermore, the model is adept at constructing pairwise interactions between nucleotides, enhancing its ability to depict direct nucleotide-nucleotide interactions and providing a nuanced representation of the input data. These capabilities make RNA-FM particularly effective in correlating internal representations with RNA secondary structures. As a result, the model produces high-dimensional embeddings for each sgRNA Abudayyeh et al. (2017), encapsulating both local and global contextual relationships within the sequences. These embeddings are subsequently utilized as inputs for further predictive modeling to deter-mine sgRNA efficacy scores, and also serve as inputs for a secondary structure prediction model, enhancing our understanding and prediction of RNA structural configurations."}, {"title": "2.3 Secondary Structure Prediction", "content": "The secondary structure of each sgRNA was predicted using a ResNet model Krishna et al. (2017) that processes inputs derived from the RNA-FM representations. This model outputs a probability matrix where each nucleotide position is labeled as either paired (1) or unpaired (0). These binary sequences are then further processed using a deep convolutional network based on the ResNet architecture, which is particularly adept at capturing spatial hierarchies in structured data He et al. (2016). This approach allows for effective integration of contextual and spatial information, enhancing the accuracy of the secondary structure predictions for the sgRNAS."}, {"title": "2.4 Feature Integration and Processing", "content": "The embeddings from the RNA-FM and the outputs from the secondary structure prediction ResNet are integrated and further processed to refine the feature representation.\nDenseNet architecture. Seq-DenseNet Wei et al. (2021) and SS-DenseNet Zhao et al. (2021), was employed to process integrated features. This architecture benefits from dense connectivity patterns that improve the flow of information and gradients throughout the network, aiding in the robust learning of features from both sequence and structural data Wei et al. (2021).\nPositional Encoding Transformer Encoder. The output embedding of RNA-FM are passed through a positional encoding transformer encoder. This module incorporates positional encodings to the input features to maintain the sequence order, which is crucial for capturing dependencies that are positionally distant in the sgRNA sequence. The transformer encoder refines these features by focusing on the most relevant parts of the sgRNA for efficacy prediction Huang et al. (2017)."}, {"title": "2.5 Efficacy Prediction", "content": "The final prediction of sgRNA efficacy is performed using a multi-layer perceptron (MLP) Riedmiller and Lernen (2014). The MLP comprises an input layer that receives the processed features, several hidden layers with non-linear activation functions to capture complex relationships in the data, and an output layer that produces a continuous efficacy score for each sgRNA."}, {"title": "3 Dataset", "content": "To explore the efficiency and specificity of the Cas13d system, we performed a comprehensive two-vector CRISPR/Cas13d proliferation screen on the A375 melanoma cell line, guided by protocols from a well-established benchmark study Cheng et al. (2023). The screening library consisted of 10,830 sgRNAs targeting a total of 426 genes, including 192 protein-coding genes and 234 long non-coding RNAs (lncRNAs). This selection included 94 essential genes and 14 non-essential genes, previously identified in A375 cells via RNA interference and CRISPR-based screenings. Our library design aimed to robustly model the efficiencies of Cas13d sgRNAs, allocating approximately 30 guides per gene. This strategy was intended to overcome potential biases observed in previous tiling screens that were limited to only 2-3 genes, thereby enhancing the representativity of the sgRNA library.\nFollowing the screening, sgRNA abundance was quantitatively assessed through high-throughput sequencing. Data analysis was conducted using the MAGECK algorithm to evaluate sgRNA performance and gene essentiality. Quality control checks were stringent, with an average of 5.6 million reads per sample, ensuring reliable data capture. Each guide was represented by over 300 reads, with fewer than four guides missing per gene-indicative of comprehensive coverage. The Gini coefficient was maintained below 0.06, confirming a uniform and non-biased distribution of guide representation across the dataset. Most notably, 20 of the essential genes demonstrated significant depletion, with a false discovery rate (FDR) of less than 10%, underscoring the screening's effectiveness in identifying gene functionalities crucial for cell proliferation in melanoma."}, {"title": "4 Experiments", "content": ""}, {"title": "4.1 Implementation", "content": "Batch Size: The model was trained with a batch size of 128 sgRNAs to balance computational efficiency with memory constraints.\nLearning Rate: We employed a learning rate of 1e-4, utilizing a learning rate scheduler to decrease the rate by 10% every two epochs to stabilize training as it progressed.\nEpochs: The model was trained for up to 50 epochs, with early stopping implemented if the validation loss did not improve for 5 consecutive epochs. This approach prevented overfitting and ensured that the model generalized well to new, unseen data.\nOptimizer: The Adam optimizer Zhang (2018) was used for its adaptive learning rate capabilities, which helped in converging faster and more effectively than traditional stochastic gradient descent. L2 regularization Cortes et al. (2012) was applied to all trainable parameters to prevent overfitting by penalizing large weights. A dropout rate of 0.1 was used in each transformer layer to randomly omit a subset of features during training, further helping the model to generalize better. To handle the varying lengths of sgRNA sequences, attention masks were used within the transformer layers to ignore padding tokens during the self-attention calculations.\nBaseline Methods: In the evaluation of guide RNA (gRNA) efficacy prediction, the DeepFM-Crispr model was compared against several established machine learning methods, including Random Forest (RF) Rigatti (2017), XGBoost (XGB) Chen and Guestrin (2016), Support Vector Machine (SVM) Suthaharan and Suthaharan (2016), AdaBoost (ADA) Ying et al. (2013), and a recent deep learning method, DeepCas13 Wessels et al. (2020)."}, {"title": "4.2 Evaluation", "content": "Conventional machine learning algorithms were applied using 185 curated features consistent with previous studies. Each model was trained and validated on three publicly available Cas13d tiling screening datasets, encompassing a total of 5,726 sgRNAs, employing five-fold cross-validation to ensure robustness. The evaluation of our models focused on two primary metrics: (1) the prediction accuracy of sgRNA efficacy across the entire dataset, and (2) the ability to classify sgRNAs into efficient or non-efficient categories based on their performance."}, {"title": "4.3 Result Discussion", "content": "Prediction Accuracy. The first metric of evaluation was the coefficient of determi-nation (R2) and the Pearson correlation coefficient (PCC) between the predicted efficacy scores and the actual log fold changes (LFCs). DeepFM-Crispr demonstrated superior performance in this regard, achieving a higher R2 value and a more pronounced negative Pearson correlation. These results, illustrated in Fig. 2, indicate that DeepFM-Crispr pro-vides more accurate predictions of sgRNA efficacy, aligning closely with experimental outcomes."}, {"title": "Classification of sgRNA Efficiency", "content": "For the classification task, sgRNAs were cat-egorized based on their LFC values; those with LFC smaller than -0.5 were classified as positive (efficient), and all others as negative (non-efficient). The effectiveness of each model in this binary classification was measured by the area under the Receiver Operating Characteristic (ROC) curve (AUC) and the area under the precision-recall curve (AUPR). DeepFM-Crispr not only matched the top AUC performance of Deep-Cas13 at an average of 0.88 across five-fold cross-validation (as shown in Fig. 2) but also significantly outperformed other methods, which exhibited AUC scores ranging from 0.78 to 0.85. Furthermore, DeepFM-Crispr excelled in the precision-recall metric, achieving an average AUPR score of 0.69. This score was notably higher than those achieved by DeepCas13 and other traditional approaches, which varied between 0.45 and 0.58 (depicted in Fig. 2). This indicates a stronger capability of DeepFM-Crispr to differentiate between strong and weak knockdown effects. The high AUPR score is particularly significant in the context of the dataset's imbalance, where positive samples are less frequent, underscoring the model's robustness in distinguishing positives from negatives."}, {"title": "Implications for Gene Editing Applications", "content": "These findings underscore the en-hanced predictive accuracy of DeepFM-Crispr in assessing sgRNA efficacy, affirming its utility in gene editing applications where precise guide RNA selection is crucial. The ability of DeepFM-Crispr to accurately predict and classify sgRNA efficiency supports its potential as a valuable tool in optimizing CRISPR-based gene editing. This is par-ticularly in therapeutic contexts where the precision of genetic modification can dictate treatment efficacy."}, {"title": "5 Related Work", "content": "The CRISPR-Cas systems Doudna and Charpentier (2013); Jinek et al. (2012) have revolutionized the field of genetic engineering, offering unprecedented precision in gene editing Jinek et al. (2012); Doudna and Charpentier (2014); Khalil (2020). Since its inception, the CRISPR-Cas9 system has been extensively studied and applied across various biological contexts due to its ability to make targeted DNA modifications. However, the discovery of CRISPR-Cas13 Abudayyeh et al. (2017), which targets RNA, has opened new avenues for gene modulation without altering the DNA itself. Among the variants, Cas13d is particularly notable for its collateral activity, where it cleaves nearby non-target RNA sequences upon activation, offering potential for diagnostic as well as therapeutic applications Barrangou et al. (2007).\nRecent advancements have leveraged computational models to enhance the pre-dictability and efficiency of CRISPR systems. For instance, models like CRISPRpred-seq Muhammad Rafid et al. (2020) and DeepCas Wessels et al. (2020) have utilized tradi-tional machine learning and deep learning techniques Li et al. (2024); Fei et al. (2024); Wang et al. (2024) to predict sgRNA efficacy, primarily focusing on CRISPR-Cas9. These models often rely on sequence-based features and have shown significant promise in reducing off-target effects and enhancing on-target efficiency. However, the unique mechanisms and RNA targeting properties of Cas13d Gupta et al. (2022) present distinct challenges and opportunities that these models are not tailored to address."}, {"title": "6 Conclusion", "content": "The DeepFM-Crispr model has proven to be exceptionally versatile and robust, demonstrating not only its efficacy with the Cas13d system but also its potential ap-plicability to other CRISPR-Cas systems. Leveraging advanced large language model techniques, DeepFM-Crispr adeptly captures complex genetic interactions and sequence nuances essential for precise genome editing. The model's strength lies in its ability to integrate sophisticated deep learning techniques with large-scale genomic data, enabling it to surpass traditional models in both predictive accuracy and operational efficiency. This adaptability positions DeepFM-Crispr as a valuable asset across a broad spectrum of CRISPR technologies, potentially revolutionizing gene editing methodologies across diverse applications."}, {"title": "7 Future Work", "content": "Looking forward, our research will extend the application of DeepFM-Crispr to other widely used CRISPR systems Barrangou and Doudna (2016); Wu et al. (2024), such as Cas9 and Cas12. These systems play crucial roles in both basic research and clinical settings. By tailoring DeepFM-Crispr to these platforms, we aim to enhance the specificity and efficiency of sgRNA design, thereby minimizing off-target effects and optimizing therapeutic outcomes. Future developments will also focus on refining the model's architecture to incorporate a more comprehensive range of genomic features and environmental factors, which are expected to further enhance its predictive capabilities.\nAs CRISPR technology continues to evolve, the integration of sophisticated compu-tational models like DeepFM-Crispr is poised to drive significant advancements in the field of genetic engineering. This synergy between cutting-edge biotechnology and com-putational innovation opens new avenues for medical research and treatment strategies, holding promise for transformative impacts on healthcare and disease management."}]}