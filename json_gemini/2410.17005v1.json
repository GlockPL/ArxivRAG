{"title": "Hybrid Generative AI for De Novo Design of\nCo-Crystals with Enhanced Tabletability", "authors": ["Nina Gubina", "Andrei Dmitrenko", "Gleb Solovey", "Lyubov Yamshchikova", "Oleg Petrov", "Ivan Lebedev", "Nikita Serov", "Grigorii Kirgizov", "Nikolay Nikitin", "Vladimir Vinogradov"], "abstract": "Co-crystallization is an accessible way to control physicochemical characteristics\nof organic crystals, which finds many biomedical applications. In this work, we\npresent Generative Method for Co-crystal Design (GEMCODE) 1, a novel pipeline\nfor automated co-crystal screening based on the hybridization of deep genera-\ntive models and evolutionary optimization for broader exploration of the target\nchemical space. GEMCODE enables fast de novo co-crystal design with target\ntabletability profiles, which is crucial for the development of pharmaceuticals. With\na series of experimental studies highlighting validation and discovery cases, we\nshow that GEMCODE is effective even under realistic computational constraints.\nFurthermore, we explore the potential of language models in generating co-crystals.\nFinally, we present numerous previously unknown co-crystals predicted by GEM-\nCODE and discuss its potential in accelerating drug development.", "sections": [{"title": "Introduction", "content": "The use of multi-component molecular crystals, specifically co-crystals, have become increasingly\npopular in various industries including energy [1], electronics [2, 3], optoelectronics [4, 5], food [6],\nand especially in pharmaceuticals [7\u20139]. Pharmaceutical co-crystals are defined as solids that are\ncrystalline singlephase materials composed of a drug molecule and an additional pharmaceutically\nacceptable molecule (coformer) [10]. Co-crystals have a different crystal structure from the original\ncomponents, leading to unique physicochemical properties. They are appealing because the resulting\nsolid can exhibit better physicochemical properties compared to either of the pure molecules [11].\nThe formation of co-crystals has been shown to enhance characteristics such as bioavailability\n[12, 13], solubility [14\u201316], stability [17\u201319], pharmacokinetics [20, 21], and mechanical properties\n[14, 22, 23]. Plasticity is a mechanical property that is particularly important for the pharmaceutical\nindustry. It is known that highly plastic materials tend to produce stronger tablets compared to those\nexhibiting elastic behavior [24]. In other words, it possesses improved tabletability, defined as the\ncapacity of a powdered material to be transformed into a tablet of specified strength under the effect\nof compaction pressure [25]. Therefore, it is essential to control for tabletability as it allows direct\npressing with minimal addition of excipients to form a stable compact tablet.\nDespite all the robustness and versatility of co-crystals, determining the combination of a coformer\nand parent component with the desired property modification is an extremely non-trivial task, usually"}, {"title": "Related Work", "content": "Traditionally, the process of discovering new molecules or selecting chemical structures for a\nparticular task relies on existing experimental evidence and subjective research experience, both\nlimiting the number and variety of possible compounds to consider. Generative models allow efficient\nexploration of the molecular space, which has already caused a rapid growth of molecular generative\ndesign. Recurrent neural networks [37\u201340], variational autoencoders [41-44], generative adversarial\nnetworks [45\u201348], evolutionary algorithms [49\u201353] and hybrid models using reinforcement learning\ntechniques [54\u201357] have been successfully applied for various problems in chemistry. In this work,\nwe trained, evaluated and compared multiple generation approaches, such as LSTM-based GAN,\ntransformer-based VAE and conditional VAE. The latter was inspired by a study using a conditional\nVAE model with an attention mechanism to generate molecules [58]. However, our approach differs\nsignificantly in that we generated a condition vector based on the predictions of the pretrained\ngradient-boosting model. In addition, our approach includes a fine-tuning phase on a state-of-the-art\ndataset of coformers."}, {"title": "Co-crystal property prediction", "content": "Research in co-crystal property prediction is targeted at determining various parameters, such as the\nlattice energy, density, melting temperature, crystal density, enthalpy and entropy of melting, as well\nas ideal mole fraction solubility of co-crystals [62\u201365]. However, a limited number of samples is\ntypically used in the training phase. For example, Gamidi and Rasmuson trained an artificial neural\nnetwork on the data of 30 co-crystal systems for 8 different drugs [35]. Such models are likely to\nhave very limited generalization power beyond the training data. The most recent model predicting\nthe co-crystal density [36] used a large training set of 4144 molecular pairs covering a much wider\nchemical space of possible co-crystals. In this work, we predict several mechanical properties of\nco-crystals for the first time. We use an even larger amount of data for that (6029 samples), which\nmakes our approach more versatile and better generalizable for different pharmaceutical applications."}, {"title": "Applications of language models in chemistry", "content": "Large language models have recently been challenged with multiple chemistry tasks, such as property\nprediction, yield prediction, text-based molecular design, and others [66]. The results suggest\nthat language models are less competitive in generative tasks requiring a deeper understanding of\nmolecular SMILES strings, but show competitive performance in classification and ranking tasks.\nAnother study on the applicability of language models without prior specialization in the chemistry\ndomain found that LLMs can effectively interpret chemical structures given various representations\n[67]. In addition, the use of language models as agents was explored in ChemCrow [68], which\nmakes chemistry more accessible to researchers with less domain expertise. Following up on these\npioneering works, we explore the applicability of language models to the creation of coformer\nmolecules with desired properties, which has not yet been addressed in the past."}, {"title": "Data", "content": "In order to train a generative model capable of suggesting reasonable\nchemical structures, a dataset of molecules from the ChEMBL database (available with CC BY-SA\n3.0 license) was collected. From the large variety of molecular structures available in the database,\n~1.75M samples were selected using criteria based on the distributions of relevant parameters in the\nknown coformers (Appendix C.1). Using these criteria ensures that the generative models are trained\non molecules capable of forming co-crystals."}, {"title": "Dataset of coformers", "content": "Chemical structures in the ChEMBL database are still substantially different\nfrom the structures composing co-crystals. Coformers most often have more basic chemical structures\nand a smaller variety of functional groups. Therefore, we used an open dataset of 6819 two-component\nco-crystals [33] (available with MIT license), which contains 4227 unique chemical structures of the\ncoformers, for fine-tuning."}, {"title": "Dataset of co-crystals mechanical properties", "content": "For the mechanical properties of co-crystals, we\nused the Cambridge Structural Database (CSD) [69] and a recently proposed protocol for geometric\nanalysis of co-crystalline materials available with a CSD Python API [24]. For each of the 6819\navailable co-crystals, we used the API to query additional experimental data from the CSD and\ncalculate the following binary parameters of plasticity: presence of non-overlapping Miller planes\n(Unobstructed planes), presence of orthogonal planes (Orthogonal planes), and presence of hydrogen\nbonds between the planes (H-bond bridging). Since some of the co-crystals were missing in CSD,\nthis process yielded a total of 6029 records. This data was then used for training ML models to\npredict each of the three plasticity parameters."}, {"title": "Data curation", "content": "Cutting-edge generative models use string [70\u201372], 2D [73\u201375] and 3D [76\u201378] molecular graphs\nas molecular representations. The most common way is the SMILES (Simplified molecular-input\nline-entry system) notation, as the other approaches have not yet shaped the field to such an extent\n[79]. Therefore, we used the SMILES representations to describe the composition and structure of\nchemical molecules with short strings. Additionally, molecular fingerprints allowed us to represent\nmolecules in a vectorized form and compare different structures by calculating a similarity measure\n(Appendix C.3).\nWe used RDKit to generate 43 molecular descriptors for each coformer with its SMILES representa-\ntion. Since co-crystals consist of two coformer components, each one was described by 86 numerical\nfeatures in total. Before training ML models for the prediction of mechanical properties, we applied\na set of preprocessing steps. We engineered new features by aggregating the molecular features of\nthe coformers of the same co-crystal with summation and averaging. To reduce redundancy in the\nfeature space, we investigated the feature importances using embedded methods and the degree of\nlinear association with target variables through correlation coefficients. After feature engineering and\nfiltering, the datasets for the prediction of non-overlapping planes, orthogonal planes, and hydrogen\nbonding contained 29, 24, and 30 features, respectively."}, {"title": "GEMCODE: Generative Evolution-based Method for Co-crystal Design", "content": "We present GEMCODE, a novel pipeline for generative co-crystal design with improved tabletability\nproperties. It based on the idea of hybridization of deep generative models and combinatorial\noptimisation. GEMCODE consists of four key components, as depicted on Figure 1.\nFirst, a trained and fine-tuned generative model generates SMILES representations of coformer-like\nchemical structures. The generated molecules are then fed into the trained ML models along with the\ntherapeutic compounds, where the mechanical properties of co-crystals are predicted. In addition, an\nevolutionary algorithm is used in combination with the ML models to further improve the tabletability\nof the generated coformers. Finally, co-crystals with the desired properties are selected for the\nnext step, where a pretrained graph neural network scores and ranks molecular pairs of drugs and\ncoformers according to the probability of co-crystallization. Thus, the pipeline outputs a list of\npotential coformers with the desired mechanical properties of the co-crystal, ranked according to"}, {"title": "Prediction of mechanical properties of co-crystals", "content": "Since the number of training examples available for prediction of mechanical properties was only\n6029, we resorted to the classical machine learning algorithms. We formulated a binary classification\nproblem for each of the mechanical properties and implemented a number of ML models as a first\nscreen, including logistic regression, k-nearest neighbors classifier, support vector machines, decision\ntrees, multilayer perceptron, as well as ensemble models, such as random forest and gradient boosting.\nWe then selected the best models and optimized their hyperparameters to achieve top performance.\nThose pretrained models were then integrated into the coformer generation and the evolutionary\noptimization frameworks. To validate this solution, we used an AutoML tool to design the modeling\npipeline in an automated way (details are provided in Appendix G.5."}, {"title": "Generation of coformers", "content": "The performance of a particular deep neural network is largely determined by its architecture, as\nwell as the strategy to learn the hidden representations [80]. In order to find the most effective\nsolution for the coformer generation task, we implemented and systematically compared three\ndifferent architectures. Our evaluation included a GAN model with recurrent neural networks for\nboth, generator and discriminator, and two transformer-based models implementing a VAE. For more\ninformation regarding the model architectures, refer to Appendix D.4 and D.5.\nGAN-based methods consider molecule generation a minimax game, which consists of training\na discriminator to distinguish between the real data and the samples produced by a generator\n(Appendix D.1). In this work, we employed an open-source GAN implementation\u00b2 using LSTM\nto address molecule generation as a sequence-to-sequence (S2S) problem, inspired by the work of\nd\u2019Autume [81]. As an alternative, we opted for a transformer architecture [82] as a basis for a VAE,\nsince it normally outperforms recurrent neural network architectures in S2S tasks [83].\nOur objective was to produce co-crystals meeting specific tabletability requirements that translate\nto a set of target mechanical properties. We utilized a conditional variational autoencoder (CVAE)\napproach [84] to achieve this. By design, CVAE makes it possible to consider physicochemical\ncharacteristics of molecules and generate co-crystals with the desired properties (Appendix D.3 offers\na more detailed description of the VAE and CVAE models). We used the aforementioned mechanical\nproperties (unobstructed planes, orthogonal planes, and H-bonds bridging) as conditions for CVAE.\nIn the following, we refer to this model as transformer-based CVAE (T-CVAE).\nFinally, we included a transformer-based VAE (T-VAE) for comparison, which does not consider any\nspecific properties of molecules, for completeness of the analysis."}, {"title": "Evolutionary optimization of coformers", "content": "To increase the quality of coformer generation, we applied a graph-based evolutionary algorithm to\nstructures produced by the generative models. The software implementation is obtained from the\nself-developed GOLEM library [85]. The fitness function was designed to reinforce the mechanical\ncharacteristics of molecules based on predictions of the classification models described above:\n$f(x) = (1 - p_u(x), 1 \u2013 p_o(x), p_h(x))$,\nwhere x is an evaluated molecule of coformer, $p_u(x)$ is the probability of the positive class for\nunobstructed planes, $p_o(x)$ is the same probability for orthogonal planes, and $p_h(x)$ \u2013 for H-bond\nbridging. Therefore, minimization of the fitness function f leads to generation of coformer molecules\nhaving an improved tabletability profile."}, {"title": "Experimental studies", "content": "The preprocessed dataset was randomly split into train and test sets in\nproportion 4:1. The train set was used to optimize hyperparameters of the models with a grid search\nusing the 10-fold cross-validation (CV). The random grid size was 500 and concerned the following\nparameters: learning rate, number of estimators, subsample, maximum depth of the individual\nestimators. The test set was used only once, to evaluate and report the performance of the optimized\nmodels. We calculated accuracy and F1 score during the CV to select the best hyperparameter set.\nThe use of the two metrics was important given the imbalanced nature of the \u201cOrthogonal planes\" and\n\"Unobstructed planes\" target variables (Appendix C.2, Figure 3c). To account for the disproportion,\nwe also adjusted the threshold for the probability of the positive class by calculating precision and\nrecall metrics. Finally, we employed SHapley Additive exPlanations (SHAP) to interpret model\npredictions, which is based on sensitivity analysis investigating the effect of systematic changes in\nfeature values on the model output [92].\nOverall, the GB model showed the best accuracy and F1 score compared to the other\nmodels across all tasks (Figure 2). Despite the high accuracy for the orthogonal planes parameter, we\nobtained a moderate F1 score suggesting that the final model is more likely to predict the absence\nof the orthogonal planes. This is attributed to the disproportion in the training examples discussed\nearlier. Although we demonstrated a significant improvement in metrics by introducing the probability\nthreshold (Appendix G.2) evaluating the model trained on the processed data, it was not enough to\nentirely resolve this issue.\nWe optimized the hyperparameters of the Gradient Boosting (GB) model, which resulted in the\nperformance metrics outlined in Table 10 (Appendix G.4). Furthermore, we conducted a thorough"}, {"title": "Estimation of probability of co-crystal formation", "content": "Determining the possibility of co-crystallization by molecular pairing is an important step in the\nco-crystal design. For this reason, many works attempted to solve this problem with AI [86, 34, 87].\nMost works that are closely related to our problem do not provide code to reproduce or reuse their\nresults [88-91]. To account for the probability of co-crystallization, we applied an existing GNN-\nbased deep learning framework, called CCGNet [33] (available with MIT license). Unlike many of\nthe previous works, CCGNet achieves state-of-the-art performance predicting co-crystal formation\nwhile being 100% open-source and easily reproducible. With an average balanced accuracy of 98.6%,\nCCGNet efficiently scores and ranks coformer candidates according to the probability of co-crystal\nformation. Since CCGNet was originally trained on the same database of coformers, we did not\nperform any fine-tuning and simply integrated the model from the open GitHub repository into the\npipeline."}, {"title": "Generation of coformers", "content": "Analyzing experimental results of coformer generation, we observed that T-VAE produced\nthe highest percent of valid and novel molecules with by far the lowest percent of duplicated structures\nHowever, among the generated coformers, only 1.68% had the target tabletability profile,\nas assessed by the pretrained classification models. In contrast, when generating 10,000 candidates,\nT-CVAE produced 5.63% of new coformers with the required mechanical properties on average.\nWhile the diversity of target coformers 3 was slightly higher for GAN, it was able to produce the\nintermediate 2.23% of such coformers. Therefore, we conclude that T-CVAE was the most effective\napproach to target coformer generation. However, the transformer architecture was also the most\ndemanding for both, the training and the generation phases (see Appendix D.6 for more details).\nUltimately, we recommend to use an ensemble of generative models whenever sufficient computa-\ntional resources are available. Our findings presented in Appendix D.7 suggest that the three models\nproduce complementary results. Collectively, GAN, T-VAE and T-CVAE generate up to 2.47 times\nmore unique target coformers than individually."}, {"title": "Evolutionary optimization of coformers", "content": "To evaluate results of the evolutionary search, we compared the probabilities of co-\nformers to possess the desired mechanical properties before (\u201cGenerated\u201d) and after (\u201cOptimized\")\nevolutionary optimization (Table 2). For that, we used the pretrained ML models to retrieve the\nprobabilities, calculated statistics and applied the non-parametric one-sided Mann-Whitney test (see\nAppendix E.4, F.1 for more details). In most cases, we observed a significant increase in the median\nprobability of the target class. Notably, evolutionary optimization equalized the performance of\ndifferent generative models in their ability to produce coformers with the target tabletability profile.\nMoreover, this process consistently yielded new coformer structures, not present in the training set or\nin the initial population."}, {"title": "Validation case studies", "content": "In order to test the effectiveness of GEMCODE, we generated coformers for the drugs with poor\nability to form a tablet by powder pressing. Among the therapeutic molecules selected for the pipeline\nvalidation were Nicorandil, Rivaroxaban and Paracetamol. For each of the listed drugs, experimentally\nvalidated molecules were found among the GEMCODE-generated coformers improving tabletability\nof the co-crystals (Table 3). More details can be found in Appendix B.1."}, {"title": "Novel coformer molecules predicted by GEMCODE", "content": "To showcase the ability of GEMCODE to predict novel coformers with target tabletability profiles,\nwe generated coformers for one of the therapeutic molecules, i.e., Nicorandil. GEMCODE enabled\ndiscovery of 23 unique coformer with improved mechanical properties and with the presence of func-\ntional groups as in experimentally validated tabletable co-crystals (see Table 4 in the Appendix B.2).\nThis result demonstrates the potential of GEMCODE as an indispensable tool for accelerated drug\ndevelopment. Broader impact is further discussed in Appendix A."}, {"title": "Limitations", "content": "The evidence presented above looks very promising for the practical applications of our pipeline.\nHowever, a comprehensive experimental validation involving organic synthesis of coformers and\nco-crystal formation followed by a tablet compression experiment is required to confirm its utility.\nBased on our empirical results, we anticipate the following limitations of the proposed pipeline:\n\u2022 The coformers molecular space may be too narrow for some applications due to the small\nsample size of the coformer dataset. Nevertheless, if computational power is available, it is\npossible to use an ensemble of generative models, which partially solves the problem by\nincreasing the number of unique molecules generated.\n\u2022 Currently, the GB model is biased towards predicting the absence of orthogonal planes,\nleading to more false negatives in the predicted coformers. We recommend exploring an\nalternative set of coformers based on the other two mechanical properties only.\n\u2022 Low-scale screening may still result in some coformers failing to form co-crystals, particu-\nlarly those optimized through evolution. Screening more coformers increases the chances of\nfinding co-crystal pairs for a specific therapeutic agent.\n\u2022 While polymorphism's impact on predicting co-crystal mechanical properties is not exam-\nined here, its significance is undeniable and often understated. Despite limited reported\npolymorphs, their potential impact on prediction model accuracy in the co-crystal field\nnecessitates further exploration, considering the current scarcity of polymorphism data.\nMost limitations of the proposed pipeline can be solved with more data available for training, which\nremains a major challenge for successful AI applications in co-crystallization. We are working\ntowards collecting more data and improving its quality. Also, to date GEMCODE has been adapted\nmainly for pharmaceutical applications. In the future, we plan to extend GEMCODE by adding\nmore predicted physicochemical properties and other crystal forms to be able to expand beyond the\npharmaceutical field."}, {"title": "Conclusion", "content": "In this work, we presented GEMCODE, a novel generative pipeline for de novo co-crystal design. To\nmake it as effective as possible, we implemented the hybrid generative approach combininig positive\nsides of both deep learning models and combinatorial optimisation. We systematically evaluated and\ndiscussed the individual components of the pipeline achieving state-of-the-art performance in the\ncorresponding tasks. Furthermore, we performed experiments to validate the pipeline by generating\ncoformers for three different drugs and discovering previously unknown coformers for Nicorandil.\nIn addition, we explored the applicability of language models in the coformer generation task and\nidentified prospective research directions. Despite limitations associated with data availability,\nGEMCODE enables fast generation of unique and valid chemical structures of coformers with high\nprobabilities of co-crystallization and target tabletability profiles. This research enhances co-crystal\ndesign for pharmaceuticals and contributes to the accelerated drug development. Thanks to data and\ncode availability, our versatile hybrid approach might find other impactful applications in chemistry."}]}