{"title": "NudgeRank: Digital Algorithmic Nudging for Personalized Health", "authors": ["Jodi Chiam", "Aloysius Lim", "Ankur Teredesai"], "abstract": "In this paper we describe NudgeRank\u2122\u2122, an innovative digital algorithmic nudging system designed to foster positive health behaviors on a population-wide scale. Utilizing a novel combination of Graph Neural Networks augmented with an extensible Knowledge Graph, this Recommender System is operational in production, delivering personalized and context-aware nudges to over 1.1 million care recipients daily. This enterprise deployment marks one of the largest AI-driven health behavior change initiatives, accommodating diverse health conditions and wearable devices. Rigorous evaluation reveals statistically significant improvements in health outcomes, including a 6.17% increase in daily steps and 7.61% more exercise minutes. Moreover, user engagement and program enrollment surged, with a 13.1% open rate compared to baseline systems' 4%. Demonstrating scalability and reliability, NudgeRank\u2122\u2122 operates efficiently on commodity compute resources while maintaining automation and observability standards essential for production systems.", "sections": [{"title": "1 INTRODUCTION", "content": "Recommender Systems (RecSys) are pivotal and have been deployed in production across various industries, including e-commerce [15], streaming services [7], music [2], and social media [30]. They enable users to discover relevant items amidst overwhelming choices, enhancing engagement and satisfaction. This, in turn, drives growth for platforms and their user base.\nIn healthcare, RecSys play a crucial role, aiding both clinicians and patients. For example, they support clinical decision-making with drug recommendations considering patient history of allergies and drug interactions [4, 8], facilitate finding suitable healthcare providers [32], and enable access to relevant health information [24].\nDespite these advancements, leveraging RecSys for digital algorithmic nudging to promote healthy lifestyles across a large population remains underexplored. With the ubiquity of health devices and wearables, the data collected-ranging from physical activity (steps, active exercise minutes) to vital signs (heart rate, oxygen saturation, blood glucose)-offers a comprehensive view of an individual's health behavior and states. Such data is used, with consent, to motivate health tracking and behavior modification through nudges, a concept rooted in behavioral economics about choices presented to guide individuals towards desired behaviors [25]. Several wearable device manufacturers use rule based systems to generate nudges that aim to guide the consumer to focus on certain activities. In general health and wellness settings, such nudges can encourage users to exercise more, get enough sleep, quit smoking and reduce alcohol intake, and even help develop healthy eating habits. Similarly in clinical healthcare settings nudges can help increase patient engagement for improving outcomes such as medication adherence, increasing screening rates for early detection of cancers, and encouraging clinical-trial patients to stay on protocol. In general, some level of nudging is recognized as useful for most people, whether they are healthy, or if they have a noncommunicable disease (NCD) like diabetes or cardiovascular disease, where behavior modifications are critical for preventing disease progression and complications. At a population level, more individuals adopting healthy behaviors can reduce the incidence and burden of NCDs, which are responsible for 74% of deaths globally [19, 22].\nAchieving such sustained behavior change at a large population scale presents two notable challenges from socioeconomic and technical perspectives.\nFirst, changing human behavior is hard. People are creatures of habit. To be effective, nudges need to be personalized to the recipient and contextual to their circumstances. Nudges also have to be perceived to be coming from a human expert, and must be relevant and useful. In contrast to traditional outreach methods like billboards and mass emails, a RecSys can provide a much more private and intimate user experience by sending nudges on a regular basis and saying the appropriate thing at the right time, which can ultimately contribute to sustained behavior change.\nSecond, implementing a RecSys for personalized health nudging at population scale requires the system to address numerous technical challenges. It has to be highly compliant to care protocols, while being scalable and performant to generate recommendations for millions of users in real-time, or hourly, or daily. It needs to be easily configurable to meet specific business and compliance requirements of each local region and a variety of health goals. Such a system also needs to be reliable to operate in a production setting without any major downtimes and failures given the clinical importance of the interactions. It must be fully automated to gather performance and health metrics continuously; and capable of addressing issues like new user and new health goal cold start in a health setting where traditional methods may not apply directly.\nIn this paper we describe one such system we developed termed NudgeRank\u2122\u2122: a RecSys for digital algorithmic nudging for health. It is currently deployed in collaboration with the Health Promotion Board of Singapore (HPB) to support health and wellness goals of the nation. NudgeRank\u2122\u2122 has been running in production since July 2022, and scales to send digital personalized nudges to over 1.1 million active users of HPB's Healthy 365 mobile app. Users sync their fitness trackers to the app and monitor progress in various health and wellness programs including physical activity like steps and moderate to vigorous physical activity (MVPA), and nudges are delivered via push notifications. We evaluated the effectiveness of algorithmic nudging in engaging users as well as efficacy of enabling changes in health behaviors, model performance, and overall system performance.\nThe main contributions of this work are:\n\u2022 We describe a novel Graph Neural Network (GNN) based digital algorithmic nudging recommendation system for personalized health, with deployment details and results that can be applied to a wide range of health use cases and behaviors.\n\u2022 We complemented the GNN with an extensible Knowledge Graph framework to capture rich information about care recipients' states and behaviors coming from lifestyle and health data sources like wearables and health records, to contextualize and personalize the nudges for individuals.\n\u2022 We deployed the system to encourage awareness of improving physical activity levels in a large population (> 1 million users) in Singapore, and demonstrated its efficacy at health metrics such as improving step count and MVPA across the population.\n\u2022 We demonstrated that the deployed system meets stringent compliance criteria for nudges, and is able to handle the scalability and reliability requirements of the overall system to operate in production at population scale."}, {"title": "2 RELATED WORK", "content": "The landscape of health behavior nudging encompasses a spectrum of strategies, from basic environmental cues to sophisticated digital interventions. For decades, policy makers have encouraged approaches that have utilized methods such as strategic placement of milk and vegetables to promote nutritional needs of consumers [16], used socially targeted messages on shopping trolleys to increase vegetable purchases [12], and the alteration of trash bag colors to improve waste disposal practices [1] for example. Despite their merits, these methods lack personalization and context-awareness necessary for broader applicability.\nAdvancements in consumer technology and Just-In-Time Adaptive Interventions (JITAIs) signify a shift towards leveraging mobile and sensor technologies for real-time data collection about users' changing internal and contextual states, enabling timely and relevant nudges [17]. These interventions span such a variety of health domains, including physical activity [6], alcohol cessation [10], smoking cessation [23], and weight loss [20] that it is impossible to cite all the relevant studies here and we point the reader to but few of the ones we found interesting. For example, Consolvo et al., used a personalized display to visualize the user's progress towards daily physical activity goals, but did not send any messages[6]. Gustafson et al., addressed this and applied decision rules to send text messages: to send an alert if the user's GPS location is in the proximity of a high-risk area for alcohol consumption [10]. Riley et al., send messages as users progress through different stages of their care plans [23], and Patrick et al. incorporate a library of 1,500 decision rules to decide which message to send and when, based on user's state [20]. While these interventions are context-sensitive, their reliance on a universal set of decision rules limits their personalization capacity.\nApplication of Machine Learning (ML) has increasingly enabled personalization of health interventions to adjust to individual preferences. Notably, the HeartSteps app employs Reinforcement Learning to tailor the timing of nudges [14], while other studies utilize hierarchical clustering and binary classification to refine daily goal recommendations [13] and employ LSTM models for exercise recommendations based on predicted heart rate profiles [18]. These approaches were designed to offer study-specific personalization for a single goal and don't report results across simultaenous multiple health outcomes, an important criteria necessary to address polychronic and multiple comorbidities that exist in any population which our deployed system addresses in an extensible way.\nWe demonstrate that an AI driven extensible RecSys can offer a versatile foundation for developing personalized nudge systems applicable across various health scenarios. We were motivated by other preliminary successes in targeted studies, such as smoking cessation efforts achieving significantly higher abstinence rates with personalized messaging [3, 11].\nBased on the demonstrated commercial success of RecSys in significant operational contexts across various industries, we posited that a newly devised RecSys tailored for healthcare could sufficiently meet the requirements to establish a population-scale nudging mechanism. Our inquiry is predicated on the notion that RecSys, particularly those enhanced with knowledge graphs, possess the capability to adeptly expand personalized health nudging initiatives. Knowledge graphs offer the flexibility to assimilate a wide array of health-related information, encompassing data from fitness tracker activities to various smart sensors and clinical records, without necessitating extensive feature engineering efforts. This approach not only enriches the contextual basis for personalization but also leverages semantic relationships for more nuanced recommendations. Examples of knowledge-enhanced RecSys include RippleNet [27] and KGCN [28], which utilize knowledge graphs for item recommendations, KGAT [29], KNI [21], which integrate user-item interactions for a comprehensive understanding of user preferences, and IntentGC [31] which captures knowledge about users.\nTo the best of our knowledge, this paper introduces the first GNN and Knowledge Graph augmented deployment of a RecSys for nudging for health that is capable of dynamically generating personalized nudges for millions of users. Our system design described in the next section demonstrates the practical application and effectiveness of this approach for real-world enterprise health setting."}, {"title": "3 SYSTEM DESIGN", "content": "NudgeRank\u2122\u2122 by design is agnostic to specific health scenarios. While we present the system design and evaluation of nudging for population health promotion, it is also being used in other use cases where it is important to sustain desired health behaviors, like chronic disease management and pre- or post-surgical care."}, {"title": "3.1 NudgeRank System", "content": "The NudgeRank\u2122\u2122 system is depicted in Figure 1, highlighting its primary components."}, {"title": "3.1.1 Data Collection: Nudge Library and Participant Data", "content": "The system commences by aggregating essential data. The Nudge Library enables care program manager to author nudge templates that can be personalized for end users. Participant data, encompassing demographics, health behaviors, and more, are sourced via API from mobile apps or other databases, including electronic health records. This dataset is enriched by user-item interactions, capturing engagement with the nudges, including opening or rating them (e.g. thumbs up or down)."}, {"title": "3.1.2 Knowledge Graph Neural Network Recommender System", "content": "Data preparation for the RecSys involves the Personal Candidate Nudge Generator generating a tailored list of candidate nudges for each user based on predefined targeting rules. For example, some nudges may only be targeted at users over 60 years old who have walked less than 5,000 steps in the previous week.\nThe NudgeRank\u2122\u2122 Knowledge Graph Constructor forms a heterogeneous knowledge graph, capturing the complex interplay between users, nudges, and their attributes. This graph dynamically updates in response to new user data, ensuring recommendations reflect the current contextual state of each user. Users and nudges are represented as nodes in the graph, and directed edges capture the history of user's past interactions with the nudges. In the example in Figure 2, user u\u2081 opened nudge n\u2081 and rated it \"useful\". Users' attributes and behaviors are represented by binary markers, which are classified into topics. For example, user u\u2081 has the markers \"age: 30s\", \"BMI: normal\" and \"steps: 2.5k\". While the figure only illustrates a few markers, the actual graph contains over 130 markers, and can be easily extended with more data sources and adapted to more use cases, e.g. HbA1C or blood glucose markers for diabetes. The graph also captures knowledge about the nudges. For example, nudge n\u2082 targets segment s\u2081 \"Inactive Young Adults\", and was written to encourage them to walk more steps.\nWe extend prior efforts ([21, 27-29, 31]) in two important ways for algorithmic digital nudging in health:\nFirst, besides capturing knowledge about items, the knowledge graph also captures knowledge about users, such as their demographics, health behaviors and segments. Furthermore, it captures shared knowledge between users and items, in addition to their interaction histories. For example, in Figure 2, users u\u2081 and u\u2082 are in segment s\u2081 since they are both in their 20's and 30's, and have not been active in either steps or MVPA. Nudge n\u2082 targets segment s1 and has a \"steps\" goal, and would therefore be a candidate nudge to encourage u\u2081 and u\u2082 to walk more steps. By capturing all the knowledge about users and nudges and the relationships between them, the knowledge graph provides a rich representation of the world for the RecSys to finely tailor nudges according to each user's preferences and contextual states.\nSecond, the graph is dynamic and updated frequently as new information about users are collected, to ensure that recommendations are always made in the context of the users' current states and behaviors. For example, if a user had the marker \"steps: 2.5k\" one week ago, but the marker changed to \"steps: 10k\" this week because the user walked more, the user's graph connections are updated to reflect this new information, and new nudges are generated with the updated graph.\nBoth the list of candidate nudges per user and the knowledge graph are fed to the RecSys, which ranks the candidate nudges for each user, based on higher-order relationships between users and items captured in the knowledge graph.\nLet U be the set of users, I be the set of items (nudges), &' be the set of other entities, and R be the set of relation types. Then, the dynamic NudgeRank\u2122\u2122 Knowledge Graph at time t is defined by Gt = {(a, r, b)|a, b \u2208 &, r \u2208 R}, where & = UUIUE' and a triplet (a, r, b) represents a relationship r from head node a to tail node b that exists at time t. For example, the triplet (u1, in_segment, s\u2081) is an edge in the graph indicating that user u\u2081 is in segment s\u2081. Each node in & is represented by a d-dimensional embedding vector e \u2208 Rd, and each relation in R is represented by a k-dimensional embedding vector r\u2208 Rk.\nFor initial training, all node and relation embeddings are initialized using Xavier initialization [9]. When the model is subsequently fine-tuned on new data, the node and relation embeddings of graph Gt+1 are first initialized using the previously learned embeddings from graph Gt, except for any new nodes or relations where Xavier initialization was applied.\nThe NudgeRank\u2122 model (Figure 3) uses attentive graph convolution layers to aggregate node embeddings from neighboring nodes, so that the GNN can learn which neighbors are most important for passing information to personalize the nudges. The number of layers L and the dimensions of each layer are hyperparameters that can be tuned. The embeddings for head node a in layer l are updated by the attention-weighted linear combination of its first order neighbors Na in layer l - 1, aggregated with its own embeddings via a differentiable function f, e.g. addition or concatenation.\nea(l)=f(ea(l\u22121),\u2211b\u2208Na\u03b1abel\u22121)),\nwhere\n\u03b1ab=e(l\u22121)\u2211b\u2208Naeaabel\u22121),\nWe adopted Knowledge-Aware Attention [29], where the relation-specific attention weights \u03b1ab are defined in Equation 2, with matrix W, projecting the node embeddings ea and eb to the space of relation r. Thus, the attention weight for the relation (a, r, b) is proportional to the similarity between a + 7 and b in the space of relation r.\n\u03b1ab=softmax((Web)Ttanh(Wrea+er))\nThe NudgeRank\u2122 framework is extensible to allow other attention mechanisms to be used, for example, the Graph Attention Layer [26] (Equation 3), which includes self-attention and supports multiple attention heads. We left alternate attention mechanisms for future exploration.\n\u03b1ab=softmax(LeakyReLU(a[Wea||Web]))\nAfter node embeddings have propagated through the convolutional layers, the predicted rating for user u and item i is computed as the dot product of the embedding vectors:\n\u03b3ui=evei"}, {"title": "3.1.3 Constraints Filter", "content": "After the RecSys has ranked the candidate nudges for each user, the Constraints Filter applies customizable criteria to refine the nudge selection, aiming to optimize engagement while mitigating fatigue. For example, a nudge budget (maximum number of nudges per day) is applied to minimize nudge fatigue; nudges that were sent recently (e.g. last 7 days) are removed to increase the diversity of nudges in consecutive days; nudges that a user had rated \"not useful\" are removed to reduce annoyance. All of these nudges are fully configurable according to the business needs of the health program."}, {"title": "3.1.4 Content Personalizer", "content": "The Content Personalizer processes the final list of selected nudges for each user, and renders any personalized fields in the nudge template. For example, the following nudge template \"Great job walking {{avg_daily_steps}} daily steps last week! You are getting pretty close to your goal of 10,000 steps per day!\" is rendered with the user's actual data (e.g. \"8,356 daily steps\") to personalize the nudge for that user."}, {"title": "3.1.5 NudgeAPI", "content": "Finally, the nudges are exposed via NudgeAPI to external delivery channels such as mobile apps or email delivery systems. Feedback data in the form of nudge engagement (sent, opened, ratings) are collected, along with health behavior and vitals from fitness trackers and other smart devices. As new data is ingested, they create a continuous feedback loop with updated contextual information for the next set of personalized nudges to be generated."}, {"title": "3.2 Design Considerations", "content": "Deploying a RecSys at scale requires careful design to solve operational issues that can occur in a production system. This section describes the critical design considerations for NudgeRank\u2122\u2122."}, {"title": "3.2.1 Personalization and Contextualization", "content": "The main job of a RecSys for health nudges is to deliver personalized nudges that are relevant and contextual to the user's health state, goals and behaviors, so that the user remains engaged with the health program and adheres to the desired positive health behaviors. NudgeRank\u2122\u2122 achieves a high level of personalization by considering what to say, who to send a nudge to, and when to send it.\nWhat: the Nudge Library allows a wide variety of nudges to be written, using different nudge techniques, choice of words, or tonalities. Since different users may find different nudges to be interesting, NudgeRank\u2122\u2122 can learn the preferences of individual users and recommend other similar nudges. For example, some users may have a competitive personality and respond better to nudges that challenge them with social comparisons to peer groups, while others respond better to gentle reminders. Furthermore, nudges can be written as templates that allow the content to be personalized by injecting the user's own contextual data into the message, as described in Section 3.1.4.\nWho: The program manager can write nudges for different audiences by specifying the target segments for each nudge. For example, different nudges can be written for young adults who are sedentary vs. active. Segments can be defined by static user attributes like demographics, and dynamic attributes like health behaviors. A user's segment memberships are dynamic and automatically updated, as their health states and behaviors change daily. As a result, the list of candidate nudges that the user may receive is also contextual and up-to-date. For example, suppose the user belongs to the \"Inactive Young Adult\" segment on day 1, and gets a nudge reminding the user to exercise. On day 2, the user goes to the gym and moves to another segment called \"Active Young Adult\"; the user receives a different nudge saying, \"Good job, keep it up!\" Segments can be defined as broadly or precisely as required; for example, nudges can be written for all \"Young Adults\", or only \"Prediabetic Overweight Moderately Active Young Males\". As users perform different health behaviors or their health states change, dynamic segments ensure that the right nudges are selected for them.\nWhen: Underpinning the ability to send the right nudge at the right time is the dynamic knowledge graph that provides the latest state of the world for the RecSys model to generate nudges with. As new data is collected about users and how they have interacted with nudges, the knowledge graph's nodes and edges are updated with the latest data. In this way, recommendations are timely and relevant to each user's current context and behaviors."}, {"title": "3.2.2 Cold Start", "content": "In NudgeRank\u2122\u2122, the cold start problem can happen when (a) new nudges are added to the Nudge Library, or (b) new users enroll for the health program and they are added to the graph. We solve cold start in two main ways.\nFirst, new users and nudges are added to the knowledge graph, with any information that is known about them. Users have demographic or other data that is collected about them during enrollment. Nudges minimally have a target health goal, target segments, and other attributes. Using these basic information, graph connections can already be established for new users and nudges. Node embeddings representing new users and nudges are initialized using the Xavier initializer [9], which effectively randomizes the new users and nudges without any learned preferences. By adding new users to the graph, the RecSys is able to recommend nudges that are relevant to the users, even in the absence of any behavior data or nudge interactions; for example, nudges that were opened by other users in the same demographic groups. As new users record their health behaviors and interact with nudges, the recommendations become more and more personalized to their individual contexts and preferences. Likewise, new nudges with no interaction history can already be recommended to users in the relevant target segments, and based on other graph connections.\nSecond, we introduced a mechanism to ensure diversity of nudges. A configurable parameter Pdiversity \u2208 [0.0, 1.0] controls the proportion of nudges that are randomly sampled without replacement from each user's list of candidate nudges. For every nudge that is output by the Constraints Filter (Section 3.1.3), there is a probability of Pdiversity that the nudge is replaced by a uniformly sampled nudge from the user's candidate nudge list. In doing so, some of the nudges actually sent to the user may have been below the top k ranked nudges. This allows a greater diversity of nudges to be sent, including new nudges which are typically not ranked high. Increasing diversity also allows for more user-nudge interaction data to be collected, allowing the RecSys to learn user preferences more broadly."}, {"title": "3.2.3 Business Rules and Constraints", "content": "To ensure and maintain a positive user experience, critical business rules can be configured in the system, according to the specific needs of the health program. These are enforced by the Constraints Filter (Section 3.1.3).\nA Negative Rating Filter removes all nudges that the user has given a negative rating for (e.g. thumbs down) in the last dneg_filter \u2265 0 days. This prevents such nudges from being recommended again, to maintain a positive user experience. The nudge can be sent again after dneg_filter days, in case the user's preferences or context have changed.\nBecause nudges are delivered via push notifications, a Nudge Budget Filter allows the number of daily nudges to be limited to a configurable parameter kdaily, to reduce nudge fatigue and annoyance to users. If a user has krecommended recommended nudges after all other constraints have been applied, then the actual number of nudges sent is kfinal = min(kdaily, krecommended)."}, {"title": "3.2.4 Performance and Resilience", "content": "Generating nudges for a large population in production requires the NudgeRank\u2122\u2122 system to be engineered with performance and resilience in mind. NudgeRank\u2122\u2122 runs on Kubernetes, with critical pipelines running in parallel and distributed across the cluster. This allows the system to scale horizontally on commodity infrastructure, including virtual machines and storage from any cloud provider. Specifically, the batch scoring pipelines run in parallel by processing and generating different subsets of the population. As many instances of the pipeline as needed can be instantiated to handle the load of a large and growing population of users. Based on the number of Kubernetes nodes available and the desired overall execution time, the parameter b > 0 determines how many parallel batches are processed. The n users are divided into b equal batches, then the NudgeRank\u2122\u2122 pipeline is run for each batch of users. The generated nudges for all users are then concatenated at the final step before publishing the nudges in NudgeAPI. This is illustrated in Algorithm 1.\nA distributed system architecture running in the cloud introduces sources of potential failures in the system. For example, intermittent network issues when reading or writing data, or issues in the Kubernetes cluster may cause various parts of the pipeline to fail. To improve the resilience of the system, an automated retry mechanism was built into the parallel algorithm, to automatically recover from failures and increase the fault-tolerance of the system. If any failures occur within a batch resulting in an exception being raised, the processing for that batch is repeated. Because batches contain non-overlapping subsets of users, there is no conflict with other batches being processed. To minimize the time to recover from failures, only failed batches need to be re-executed, and the results of other successful batches are retained for the final output."}, {"title": "3.2.5 Operations and Automation", "content": "To streamline production operations, the key pipelines in the system are fully automated. DevOps Engineers and Data Scientists can monitor the system and be alerted of any issues, in order to investigate and fix them quickly. The Model Trainer automatically fine-tunes the model daily as the graph gets updated with new data about user states and nudge interactions, to ensure that model learns about user preferences in a timely manner. This was especially critical in the cold start period when the system was first launched and users interacted with nudges for the first time. Batch scoring as described in the preceding section is also automated on a schedule, as data is ingested from the source systems. Finally, all pipelines capture system telemetry including graph attributes (e.g. number of nodes and edges, number of users, number of nudges), pipeline performance (e.g. execution time) and model performance during training and fine-tuning (e.g. recommendation metrics)."}, {"title": "3.2.6 Security and Privacy", "content": "Privacy and security of information is paramount when dealing with health data, especially in cases where the data comes from medical records. To ensure that the system complies with global data protection standards for health data, NudgeRank\u2122\u2122 is designed to work without any Personal Identifiable Information (PII) such as names or addresses. All user IDs in the system are pseudonymous masked IDs, and the system does not require any PII to perform its functions.\nFurthermore, the system is designed to be deployed in \"air gapped\" environments with private networks and no public Internet access (including private networks in the cloud), to ensure that there is no risk of data egress. Data belonging to a healthcare provider or health program never leaves their environment; rather, NudgeRank\u2122\u2122 is deployed in their environment with automated CI/CD for deployments, and remote monitoring of aggregated and anonymous system telemetry for daily operations."}, {"title": "4 RESULTS", "content": "We evaluated NudgeRank\u2122\u2122 in a large-scale deployment in Singapore, in collaboration with HPB. The system was launched in production in July 2022 as part of several beta tests involving selected users. In July 2023, the system was launched for all users, and has since been generating personalized nudges for over 1.1 million users daily. All users had previously given consent for their fitness data to be collected via the Healthy 365 mobile app, and for their data to be used to send personalized messages, nudges or notifications, and for evaluation of results.\nThe system was deployed in HPB's Azure cloud environment, with all data required for model updates and generating recommendations remaining in the secure cloud environment. A 10-node Kubernetes cluster was used, with each node having 16 vCPUs and 128 GB RAM. Data was stored in Azure Data Lake Gen2, a cloud storage service supporting blobs in a hierarchical namespace.\nWith input from business requirements, the system was configured with the following parameters (described above): b = 8, kdaily = 1, Pdiversity = 0.3, and dneg_filter = 7."}, {"title": "4.1 Model Performance", "content": "In the first limited beta phase, nudges were sent to about 100,000 randomly selected users for a period of 4 months, and the interaction data were collected to tune the hyperparameters of the model. The following hyperparameters were evaluated using a grid search: the dimension size of entity and relation embeddings, and the number of graph convolution layers and their respective embedding sizes of the hidden layers. For each combination of hyperparameters, the model was trained on the knowledge graph with 25% of user-nudge interactions randomly hidden, and tested on the knowledge graph including those 25% unseen interactions.\nWe theorized that behavior change via nudging starts with simply interacting with the nudges by opening or rating them. The more nudges are opened, the more likely it is that users have read them, and therefore make a choice about their behaviors. Therefore, offline evaluation focused on the model's ability to recommend top 3 daily nudges that users were most likely to interact with. Precision@3 was chosen as the primary evaluation metric, since it represents the proportion of the 3 recommended nudges that lead to user interaction.\n shows the list of parameters tested, with the parameter combination that produced the best offline evaluation score of Precision@3 = 0.0652. This parameter combination was set up in the system for subsequent nudge recommendations. compares this with the best-performing parameter combinations for 1-, 2- and 3-layer models. The 2-layer model achieved the highest Precision@3; notably, this is 0.0201 (45%) higher than the 1-layer model that serves as a baseline for comparison.\nAfter nudges were rolled out at full scale, we added more metrics (MeanAverage Precision, NDCG@3 and Recall@3), and continued to monitor the offline metrics during daily incremental model updates. was captured from the system's monitoring dashboards, showing that model metrics experienced daily fluctuations within fairly tight ranges. The standard deviations of the metrics ranged from 0.00684 for Precision@3 to 0.00996 for Recall@3 over the 4 month period from August 2023 to November 2023, indicating that model performance was fairly stable over time."}, {"title": "4.2 Impact of Nudging on Physical Activity", "content": "Arguably the most important outcome to evaluate is whether NudgeRank\u2122\u2122 is effective at improving health behaviors via nudging. We evaluated this over a 12-week period, where daily personalized nudges were sent to n = 84,764 randomly selected users of the Healthy 365 mobile app, to encourage them to do more physical activity including steps and MVPA. A matched control group of n = 84, 903 users with the same demographics (age and sex) and baseline behaviors (mean steps and MVPA before nudging) were also selected to compare the effect of nudging. Users in the control group did not get any personalized nudges.\nOver the 12-week period, users who received daily personalized nudges performed 6.17% more average daily steps and 7.61% more average weekly minutes of MVPA than users who did not receive any nudges. These results were statistically significant at a = 0.05 on one-tailed independent samples t-tests comparing both groups (Table 3). When the behaviors of the nudge and no nudge groups were measured on a weekly basis for each of the 12 weeks, they remained significantly different for all 12 weeks for steps, and 10 out of 12 weeks for MVPA, suggesting that behavior differences were sustained and persistent.\nParticipants who opened more nudges were also found to have been more physically active. For example, participants who opened 0, 1, 2 and \u2265 3 nudges during the 12 weeks walked a mean of 2,491, 3,213, 3,588 and 4,445 daily steps, respectively. This suggests a positive relationship between nudge engagement and behavior.\nFurthermore, nudges were generally well received. A total of 1.12 million nudges sent during this period, comprising 660,000 nudges to encourage steps and 460,000 nudges for MVPA. 13.1% of all nudges were opened, out of which, 6 times more nudges were rated useful (11.7%) than not useful (1.9%) by users.\nreports more representative results from this study on the impact of nudges on physical activity; for full coverage, see [5]."}, {"title": "4.3 System Scalability and Performance", "content": "On a daily basis, the production system generates nudges for over 1 million users. The typical size of the knowledge graph (which has small daily fluctuations) is reported in. In order to ensure that nudges are generated in time to be sent each day, a performance test was conducted to evaluate how total execution time increases with the number of candidate nudges that need to be ranked. Synthetic data was created to generate a larger number of candidate user-nudge pairs than was available in the production system, ranging from 300 thousand to 19 billion candidate pairs. For each set of candidate nudges, the system was executed with 8 parallel batches, with each batch process running on a Kubernetes node with 16 vCPUs and 128GB RAM. The total end-to-end execution time of Parallel NudgeRank\u2122 (Algorithm 1) was recorded."}, {"title": "5 DISCUSSION", "content": "We presented the design and implementation results of a production-scale RecSys for digital algorithmic nudging, and demonstrated the ability of the NudgeRank\u2122 system to not only improve health behaviors, but also to do it at scale for a large population, and with a high level of performance and reliability. Although the system was first evaluated on physical activity (steps and MVPA), it is designed to be easily deployed for any other use cases where it is important to influence users' health behaviors, for example, diabetes management, nutrition, sleep, smoking cessation, pre- / post-operative care, and many others.\nThe system was launched to users in a progressive rollout, starting with fewer users and gradually increasing to the full user base over a period of 12 months. This allowed the system to be monitored and improved in iterations to address operational issues. For example, Parallel NudgeRank\u2122\u2122 (Algorithm 1) was developed in response to the increased load, as nudges were enabled for more users. The monitoring dashboards that recorded model performance and nudge engagement provided useful real-time insights into the system's daily operations for observability and troubleshooting.\nA number of future improvements are under development. Reinforcement Learning can be used to provide goal-directed recommendations, where nudges are based not only on user preferences, but also consider the \"next best action\" that a user should take towards stated health goals. The Knowledge Graph can be updated with more node and edge types, providing richer context for personalized recommendations. Large Language Models can be used to enrich the graph with semantic information, for example about nudge content, as well as add external knowledge about relevant health topics.\nThis work is just the first step in improving population-level health behaviors through personalization. As the future iterations of the system bring new capabilities and the system is deployed and evaluated on other health use cases and"}]}