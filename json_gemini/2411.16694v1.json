{"title": "REACTION-CONDITIONED DE NOVO ENZYME DESIGN WITH GENZYME", "authors": ["Chenqing Hua", "Jiarui Lu", "Yong Liu", "Odin Zhang", "Jian Tang", "Rex Ying", "Wengong Jin", "Guy Wolf", "Doina Precup", "Shuangjia Zheng"], "abstract": "The introduction of models like RFDiffusionAA, AlphaFold3, AlphaProteo, and Chail has revolutionized protein structure modeling and interaction prediction, primarily from a binding perspective, focusing on creating ideal lock-and-key models. However, these methods can fall short for enzyme-substrate interactions, where perfect binding models are rare, and induced fit states are more common. To address this, we shift to a functional perspective for enzyme design, where the enzyme function is defined by the reaction it catalyzes. Here, we introduce GENZYME, a de novo enzyme design model that takes a catalytic reaction as input and generates the catalytic pocket, full enzyme structure, and enzyme-substrate binding complex. GENZYME is an end-to-end, three-staged model that integrates (1) a catalytic pocket generation and sequence co-design module, (2) a pocket inpainting and enzyme inverse folding module, and (3) a binding and screening module to optimize and predict enzyme-substrate complexes. The entire design process is driven by the catalytic reaction being targeted. This reaction-first approach allows for more accurate and biologically relevant enzyme design, potentially surpassing structure-based and binding-focused models in creating enzymes capable of catalyzing specific reactions. We provide GENZYME code at https://github.com/WillHua127/GENzyme.", "sections": [{"title": "1 INTRODUCTION", "content": "Proteins are fundamental to life, playing an important role in numerous biological processes through their involvement in essential interactions (Whitford, 2013; Nam et al., 2024). Among these, enzymes stand out as a specialized class of proteins that function as catalysts, driving and regulating nearly all chemical reactions and metabolic pathways in living organisms, from simple bacteria to complex mammals (Kraut, 1988; Murakami et al., 1996; Copeland, 2023). The catalytic efficiency of enzymes is central to biological functions, facilitating the rapid production of complex organic molecules necessary for biosynthesis (Liu & Wang, 2007; Ferrer et al., 2008; Reetz et al., 2024) and enabling the creation of novel biological pathways in synthetic biology (Keasling, 2010; Hodgman & Jewett, 2012; Girvan & Munro, 2016). Studying enzyme functions across diverse species provides insight into the evolutionary mechanisms that shape metabolic networks, allowing organisms to adapt to their environments (Jensen, 1976; Glasner et al., 2006; Campbell et al., 2016; Pinto et al., 2022). Enzymes are integral to cellular functions, from energy production to the regulation of genetic information (Babcock & Wikstr\u00f6m, 1992; Heinrich & Schuster, 2012; Nielsen & Keasling, 2016). Understanding enzyme catalysis, mechanisms, and how enzymes interact with their substrates is not only fundamental to enhance our knowledge of core biological processes but also important for advancing biotechnology and developing new therapeutic approaches to disease management (Nam et al., 2024; Bell et al., 2024; Listov et al., 2024).\nWhile traditional approaches in enzyme research have focused on predicting enzyme functions, annotating enzyme-reaction relationships (Gligorijevi\u0107 et al., 2021; Yu et al., 2023b), or retrieving enzyme-reaction pairs (Mikhael et al., 2024; Hua et al., 2024c; Yang et al., 2024b), these methods are limited in their ability to design new enzymes capable of catalyzing specific biological reactions (Kroll et al., 2023). Recent progress in designing enzymes for particular enzyme commission (EC) classes (Munsamy et al., 2022; Yang et al., 2024a) has shown success, with models generating enzyme sequences that closely resemble reference sequences and achieve desired EC classifications. Additionally, Hossack et al. (2023) introduced a method for designing novel enzymes by assembling active site and scaffold libraries, followed by refinement algorithms.\nHowever, these advancements are not without limitations. Designing enzymes based solely on EC classifications can constrain model ability to generalize to novel, unseen reactions. In response, recent models have sought to move away from the EC system, instead aiming to directly comprehend the relationships between enzyme structures and their substrate molecules (Mikhael et al., 2024; Yang et al., 2024b; Hua et al., 2024c). Another significant challenge is that existing enzyme sequence design models are not yet equipped to comprehend the enzyme-substrate catalytic mechanism. Even when new enzyme sequences fold correctly into 3D structures, the catalytic pocket and the intricate binding interactions between enzymes and substrates are frequently underexplored or unclear.\nIn this work, we introduce GENZYME, a framework designed to address these challenges by generating enzymes capable of catalyzing previously unseen reactions Moreover, GENZYME aims to address the key question of how enzymes and substrates interact by generating enzyme-substrate binding structures. By leveraging generative models for enzyme scaffolds, active sites, and protein language models trained for enzyme motif scaffolding, GENZYME takes a catalytic reaction as input and generates the catalytic pocket, full enzyme structure, and enzyme-substrate complex. GENZYME seeks to advance de novo enzyme design for specific catalytic reactions, enhance our understanding of enzyme active sites, and reveal how enzymes interact with substrates during catalysis\u2014ultimately contributing to the understanding of metabolic pathways and potentially aiding therapeutic interventions and disease management."}, {"title": "2 RELATED WORK-NOBEL-WINNING PROTEIN DESIGN MODELS", "content": "The field of AI-driven protein design was largely propelled by the success of AlphaFold (Senior et al., 2020), which achieved remarkable accuracy in protein structure prediction. AlphaFold2 (Jumper et al., 2021) further revolutionized the field, reaching experimental-level folding accuracy and solving the 50-year-old protein folding problem. This breakthrough provided millions of valid protein structure templates for nearly all catalogued proteins, a feat unattainable for decades. Similarly, RoseTTAFold (Baek et al., 2021) achieved high folding accuracy, comparable to AlphaFold2. These accomplishments were recognized with the Nobel Prize in Chemistry in 2024. OpenFold (Ahdritz et al., 2024), an open-source project inspired by AlphaFold2, aimed to make protein folding more accessible and transparent. ESMFold (Lin et al., 2022) applied ESM-series protein language models trained on millions of sequences, leveraging evolutionary information to predict protein structures at scale. ColabFold (Mirdita et al., 2022) streamlined the folding process by integrating AlphaFold2 and RoseTTAFold with MSAs, making protein structure prediction faster and easier via a web server.\nThese advancements in protein folding laid the foundation for structure-based protein design models. RFDiffusion (Watson et al., 2023) showcased the ability to generate novel protein structures\u2014ranging from monomers to oligomers and binders using a generative diffusion approach (Song et al., 2020). Other models, such as Genie (Lin & AlQuraishi, 2023), Chroma (Ingraham et al., 2023), FoldingDiff (Wu et al., 2024), FrameDiff (Yim et al., 2023b), FoldFlow (Bose et al., 2023), and EvoDiff (Alamdari et al., 2023), applied various diffusion and flow-matching (Lipman et al., 2022) strategies to design new proteins from random noise, demonstrating good novelty, diversity, and designability.\nBeyond monomer designs, recent models have shifted toward designing proteins and their potential binders, including other proteins, molecules, antibodies, RNAs, and others. AlphaFold-Multimer (Evans et al., 2021) extended the folding models to predict protein complexes, learning how proteins interact with each other. RoseTTAFoldNA (Baek et al., 2024) was developed to predict 3D structures of protein-DNA and protein-RNA complexes, as well as RNA tertiary structures, capturing the interactions between proteins and nucleic acids. RFDiffusionAA (Krishna et al., 2024) enhanced RFDiffusion by incorporating all-atom representations, allowing it to generate detailed protein structures and ligand interactions. AlphaFold3 (Abramson et al., 2024) advanced AlphaFold2 by predicting not only individual protein structures but also their interactions with DNA, RNA, and small molecules. Chail (Chai Discovery, 2024), inspired by AlphaFold3, offers an open-source web server for predicting protein interactions with other biological molecules, showing competitive results. AlphaProteo (Zambaldi et al., 2024) and BindCraft (Pacesa et al., 2024) focus on generating high-strength protein binders that can tightly bind to target molecules, such as viral or cancer proteins.\nWhile structure-based protein design models are highly effective for creating stable and functional proteins, their primary focus is on static protein-ligand or protein-protein interactions. Enzymes, as catalysts that regulate nearly all chemical reactions and metabolic pathways in the human body, present a unique challenge for these models. Enzyme-substrate interactions are often driven by dynamic energy changes, and the induced-fit model is typically sufficient for catalysis. During a catalytic reaction, the enzyme transforms substrates into products through a chemical process, and afterward, it is free to bind another substrate molecule. The dynamic change and chemical transformation are completely different to static mechanism in protein-ligand interactions.\nAs a result, structure-based design models, which focus on static ligand-binding interactions, may fail to capture the dynamic transformations and complexities of enzyme-substrate interactions. In contrast, GENZYME proposes a function-based approach to enzyme design, where enzyme function is defined by the chemical reaction it catalyzes, potentially addressing the limitations of current structure-based models and allowing for the design of enzymes for specific catalytic functions.\nGiven any catalytic reaction $m_r$, GENZYME aims to generate/predict the enzyme $E$, which is capable of potentially catalyzing $m_r$, and the corresponding enzyme-substrate complex $C$, as:\n$POCKET E_P, ENZYME E, COMPLEX C \\leftarrow GENZYME(REACTION m_r)$.\nFig. 3 illustrates the process by which GENZYME generates an enzyme and its corresponding docked enzyme-substrate complex. Starting with the input SMILES representations of the reaction, GENZYME generates the full enzyme structure and sequence from SE(3) noise, progressing through parts 1 to 4, where the catalytic pocket is first designed and then inpainted into a complete enzyme representation. Concurrently, the binding model computes multiple substrate conformations, optimizing both the geometry and binding poses based on the catalytic pocket of the full enzyme. An optimal enzyme-substrate model is predicted and output, as illustrated in part 5 of Fig. 3."}, {"title": "3 GENZYME RESULT", "content": "We evaluate GENZYME from both structural and functional perspectives, starting with an assessment of the quality of the generated catalytic pockets, followed by an evaluation of the inpainted full enzyme structures. GENZYME is compared against several baselines for enzyme design, including EnzymeFlow (pocket-level) (Hua et al., 2024b), ZymCTRL+ESMFold (enzyme-level) (Munsamy et al., 2022; Lin et al., 2022), and RFDiffusionAA (pocket- and enzyme-level) (Krishna et al., 2024). Additionally, we employ Chail (Chai Discovery, 2024) to assess the quality of enzyme-substrate complexes. For catalytic pockets and enzymes generated by RFDiffusionAA, we apply LigandMPNN (Dauparas et al., 2023) to inverse fold and predict sequences post-hoc.\nFor each model, we generate 8 catalytic pockets and full enzyme structures per reaction (or substrate for RFDiffusionAA, EC-class for ZymCTRL) to comprehensively evaluate their performance. For GENZYME, we randomly generate and select 8 enzymes with $pTM > 0.60$ or $pLDDT > 0.60$ and use their corresponding catalytic pockets for evaluation. Both structural validity and catalytic functionality are assessed for the generated pockets and enzymes. We provide the code of GENZYME and inference scripts at https://github.com/WillHua127/GENzyme.\nFor model validation, we select five enzyme-reaction pairs from each EC class (1-6) in the EnzymeFill dataset (Hua et al., 2024b), capturing diverse enzyme functions, catalytic mechanisms, and reaction types. Using MMseqs2 (Steinegger & S\u00f6ding, 2017), we cluster at a 10% homology threshold and select the central member of each cluster as the initial dataset. After removing duplicates of repeated reactions and UniProt, we uniformly sample 5 enzyme-reaction pairs per EC class for evaluation, yielding a total of 30 unique catalytic pockets and 30 unique reactions. The full set of evaluation enzyme-reaction pairs is presented in Tab. 1.\nFollowing Hua et al. (2024b), we begin by evaluating the structural validity of the generated catalytic pockets and full enzymes. While enzyme function determines whether the designed pocket or enzyme can catalyze a specific reaction, structure provides important information regarding substrate binding. Proper substrate binding to the active region of the enzyme is essential for catalysis and chemical reaction, even if a perfect binding pose is not always needed.\nTo assess structural validity, we use the metrics: Root Mean Square Deviation (RMSD): Measures the structural distance between ground-truth and generated catalytic pockets and enzymes, indicating the alignment accuracy of the generated structures with the actual structures. TM-score: Assesses topological similarity between generated and ground-truth structures, particularly focusing on local deviations (Zhang & Skolnick, 2005). Embedding Distance (Emb-Dist): Calculates the embedding distance between generated and ground-truth pockets and enzymes. We co-encode both protein sequences and structures using ESM3 (Hayes et al., 2024), and employ tSNE to reduce hidden dimensionality to compute embedding distances.\nWe compare the structural validity of GENZYME- and baseline-generated catalytic pockets in Tab. 2, and the inpainted and generated enzymes in Tab. 3, focusing on structural consistency at both local (catalytic regions) and global (entire enzyme) levels.\nIn Tab. 2, which evaluates local consistency, GENZYME-generated catalytic pockets demonstrate closer alignment to ground-truth pockets, reflected in lower distance errors and higher structural alignment scores, as well as lower embedding distances. This suggests that GENZYME can design catalytic pockets that maintain or meet specific catalytic requirements for the target reaction. In Tab. 3, assessing global consistency, we observe that GENZYME-inpainted enzymes differ more from ground-truth structures than the catalytic regions alone, while the embedding distances do not diverge dramatically. This divergence indicates that, while GENZYME preserves critical catalytic properties locally, it also introduces structural modifications across the entire enzyme, potentially enhancing overall stability and functional diversity beyond wild-type enzymes.\nThese findings are further validated by the t-SNE visualizations in Fig. 5 and Fig. 6 in Sec. 3.2, where we analyze embeddings for generated catalytic pockets and full enzymes, supporting the observed balance between local catalytic alignment and broader structural innovation."}, {"title": "3.2 INSIGHTS FROM ENZYME SEQUENCE-STRUCTURE EMBEDDINGS", "content": "Additionally, we evaluate the generated catalytic pockets and full enzymes by analyzing their sequence-structure embeddings in comparison to ground-truth ones. We use ESM3 (Hayes et al., 2024) to co-encode both protein sequences and structures, though alternative methods like FoldSeek are also viable for this purpose. Fig. 5 illustrates the tSNE visualization of catalytic pocket embeddings, and Fig. 6 presents the embeddings of full enzyme structures.\nBy analyzing Fig. 5, we observe that the GENZYME-generated catalytic pockets cluster closely with the ground-truth pockets, indicating high catalytic potential, as these active regions and catalytic sites are where reactions occur. This alignment suggests that GENZYME effectively maintains key catalytic features. In contrast, Fig. 6 shows that the inpainted enzymes cluster separately from the ground-truth enzymes, which could imply enhanced overall enzyme stability and functionality in the de novo designs. Together, Fig. 5 and Fig. 6 suggest that GENZYME preserves essential catalytic properties while potentially improving overall enzyme stability and functional diversity."}, {"title": "3.3 ENZYME FUNCTION EVALUATION", "content": "A key question in enzyme design is how to quantitatively assess whether the generated catalytic pockets and enzymes can effectively catalyze a chemical reaction. To address this, we evaluate enzyme functions by analyzing the optimal pH, enzyme kinetics, and mutation effects of the generated pockets and full enzymes-three metrics that can provide insight into their catalytic potential.\nFirst, we evaluate the optimal pH ($pH_{opt}$), which refers to the specific pH level at which an enzyme achieves its highest catalytic activity. Although most enzymes perform optimally within a pH range of 6.0 to 8.0, some enzymes are specialized to function in highly acidic ($pH_{opt} < 5.0$) or highly alkaline ($pH_{opt} > 9.0$) conditions (Bisswanger, 2014). The pH affects enzyme activity by altering the enzyme shape and the charges at both the active site and substrate. For therapeutic applications, it is important that the enzyme functions well at physiological pH levels, or within the specific pH range of the tissue or fluid where it will act Therefore, we first evaluate the $pH_{opt}$ of the designed enzymes to assess their functional suitability. To predict the optimal pH $pH_{opt}$, we use EpHod (Gado et al., 2023).\nIn addition to optimal pH, enzyme kinetics is a critical parameter for evaluating enzyme function. Specifically, we assess the turnover number ($k_{cat}$), which describes the rate at which enzyme-catalyzed reactions occur. This metric provides insights into the enzyme's catalytic mechanism, metabolic role, and responsiveness to potential inhibitors or activators The $k_{cat}$ value, or turnover number, indicates the number of substrate molecules converted to product per second at each active site, thus reflecting the enzyme's catalytic speed and efficiency. To predict and evaluate these kinetic parameters for the generated enzymes, we employ UniKP , a tool that offers comprehensive insights into enzyme function and catalytic efficiency through kinetic profiling.\nWe also assess enzyme function by measuring the rate of change of Gibbs free energy ($AAG$) under mutation, which quantifies the impact of mutation effects on enzyme stability relative to the wild-type enzymes A negative $AAG$ ($AAG < 0$) indicates that the mutation increases stability, potentially enhancing enzyme fitness. A positive $AAG$ ($\\Delta\\Delta G > 0$) suggests decreased stability via mutation, which can reduce enzyme fitness. A zero AAG ($AAG \\approx 0$) implies that the mutation has little to no effect on stability. The enzyme fitness landscape, which maps the mutation effects on function and stability, can be better understood by analyzing AAG, as it helps predict whether a mutation will enhance or degrade the enzyme catalytic performance To predict mutation effect AAG, we use Mutate-Everything (Ouyang-Zhang et al., 2024)."}, {"title": "4 GENZYME METHOD", "content": "We introduce GENZYME approach in App. B, \u0421."}, {"title": "5 GENZYME DISCUSSION", "content": "GENZYME envisions a comprehensive approach to generating enzymes for specific catalytic reactions, aiming to contribute to therapeutic solutions, decompose harmful substances, and enhance our understanding of metabolic pathways. While it represents an important step forward, GENZYME is not yet a complete solution and does not reach the level of models like RFDiffusionAA , AlphaFold , or AlphaProteo . However, we hope that GENZYME can serve as a foundation for future advancements, inspiring further research and progress in de novo enzyme design, eventually leading to successful computational enzyme discovery and influencing therapeutics."}, {"title": "5.1 MODEL GENERALIZABILITY", "content": "We are currently testing GENZYME on the latest 2024 enzyme and reaction datasets collected from Rhea (Bansal et al., 2022), MetaCyc (Caspi et al., 2020), and Brenda (Schomburg et al., 2002). This will help us evaluate GENZYME's performance and adaptability on newly collected, unseen data."}, {"title": "5.2 LIMITATIONS OF STRUCTURE-BASED MODELS FOR CATALYTIC REACTION MODELING", "content": "This section explores instances where structure-based protein and complex design models, including recent powerful methods like Chai-1 and AlphaFold3 , occasionally fall short in accurately modeling catalytic reactions. A notable limitation in these complex generation models, particularly for our de novo enzyme design approach, is the requirement for an input protein sequence to generate the enzyme-substrate complex. However, for this analysis, we assume the enzyme sequence is known and focus solely on reaction modeling.\nIn our experiments using Chai-1 to model catalytic reactions, we observed a generally high success rate, where catalytic regions (active sites or catalytic pockets) remained stable and mostly unchanged throughout the catalytic process. Nonetheless, there are cases where Chai-1 does not maintain catalytic consistency, leading to significant alterations in catalytic regions.\nFig. 8 presents an example of such a failure, where Chai-1 does not preserve the original catalytic sites. The catalytic regions before the reaction (in blue) shift considerably after the reaction (in purple) for the resulting products. This illustrates that even advanced models like Chai-1 occasionally struggle with modeling catalytic reactions effectively. This finding highlights the need for a shift towards function-driven enzyme design, emphasizing catalytic activity as a primary objective\u2014whether defined by specific reactions, as in our approach, or by enzyme classification systems like ZymCTRL's EC-number-controlled generative strategy"}, {"title": "5.3 WHAT DOES GENZYME AIM TO ADDRESS?", "content": "Advancing De Novo Enzyme Design for Unseen Reactions. GENZYME seeks to address the challenge of designing enzymes for novel, unseen catalytic reactions. This could deepen our un-derstanding of metabolic pathways and offer therapeutic benefits, including disease intervention. By combining de novo catalytic pocket design, pocket inpainting, and protein evolutionary tech-niques, GENZYME attempts to generate new catalytic pockets both through computational design and biological mutation perspectives. This dual approach could make the algorithm more robust and generalizable to reactions that have not yet been experimentally observed.\nShifting to Function-based Protein Design. Unlike structure-based models such as RFDiffusionAA , AlphaFold3 , or Chail (Chai Discovery, 2024), which prioritize generating proteins based on structures, GENZYME aligns with a function-driven strategy. The input in GENZYME is defined by the enzyme function\u2014the catalytic reaction it is meant to perform-rather than merely its structure. This approach emphasizes not only binding performance, i.e., optimizing the enzyme-substrate binding affinities, but also ensures that the enzyme structure can facilitate the dynamic kinetic changes needed for catalysis. Although GENZYME encodes the protein function in a simplified way (via tokenized catalytic reactions), it introduces a novel direction for function-based protein design, where the function defines the structure.\nAddressing Data Scarcity in Enzyme Design. A long-standing issue in enzyme design has been the lack of enzyme-reaction data with detailed structures or binding poses of enzyme-substrate complexes. Without this structural information, understanding how enzymes interact with substrates in the active site, and subsequently achieve catalysis, can been difficult. GENZYME attempts to address this challenge by generating synthetic enzyme-substrate complexes, which could provide insights into the mechanisms of catalysis and how enzymes facilitate specific reactions, helping bridge the gap in our understanding of enzyme-substrate interactions.\nFine-tuned EnzymeESM for Representation Learning. Beyond its focus on de novo enzyme design for therapeutic applications, GENZYME also contributes to enzyme representation learning. Current deep learning methods often employ models like ESM2  or ProtT5 to embed enzymes for downstream tasks such as enzyme function prediction. Although these protein language models are pre-trained on millions of sequences, fine-tuning them for enzyme-specific tasks is necessary, similar to how large language models like LLaMa are fine-tuned for specific downstream applications In this context, we fine-tune ESM3 on the EnzymeFill dataset, learning both enzyme sequences and structures. EnzymeESM is fine-tuned over 300,000 enzyme-reaction pairs, enabling tasks including enzyme catalytic pocket scaffolding, enzyme inverse folding, and enzyme embedding."}, {"title": "5.4 WHAT IS STILL MISSING IN GENZYME?", "content": "Virtual Screening in Computational Enzyme Discovery. A key gap in GENZYME, and in the broader field of computational enzyme discovery, is the lack of robust virtual screening models. Recent works have attempted to address this using contrastive learning methods to model enzyme-reaction relationships both from sequence and structural perspectives. However, current screening models remain insufficiently robust. Traditional approaches, such as using tools like Vina to compute binding affinities between enzymes and substrate conformations, focus heavily on structural evaluations, which may not capture the full complexity of enzyme catalysis. An ideal virtual screening model, in our view, should take an enzyme-reaction pair as input and output a confidence score ranging from 0 to 1, indicating how likely the enzyme is to catalyze the reaction. This concept has been hinted at in earlier work Hua et al. (2024b). However, creating such a model presents significant challenges, particularly in generating meaningful negative enzyme-reaction pairs. For instance, CLIPZyme treats all non-positive enzyme-reaction pairs as negative examples, while ReactZyme creates negative pairs by mutating amino acids in positive data. These methods are inspired by CLIP models in computer vision, where a mismatched image-text pair can clearly be labeled as negative However, in enzyme-reaction prediction, an enzyme-reaction pair that does not exist in positive data could simply be an unobserved reaction, not necessarily a negative one. This limits the generalizability of current enzyme-reaction CLIP models, particularly for virtual screening of unseen enzyme-reaction pairs. We believe that improving virtual screening models in computational enzyme discovery is more important than generative models alone, as robust screening will enable the identification of truly functional enzyme-reaction pairs, enhancing the accuracy of enzyme design efforts.\nIntegration of AI-assisted Protein Evolution. Another missing aspect in GENZYME is the broader use of directed protein evolution, such as amino acid mutations, which are important for practical enzyme design Although GENZYME models enzyme-reaction co-evolution to account for dynamic changes in catalytic reactions, this is still insufficient from a practical, wet-lab perspective. In real-world ex-perimental designs, researchers often start with enzyme mutations, rather than generating full enzyme structures from scratch. A more practical approach would be to focus on motif scaffolding\u2014replacing active regions of existing enzymes with newly generated catalytic pockets, while preserving the rest of the enzyme backbone structure . This method would align more closely with wet-lab needs, where scaffold-based modifications are often preferred due to higher success rates in enzyme design experiments. By designing enzymes from a scaffolding perspective, GENZYME could increase the likelihood of successful wet-lab implementation, ultimately bridging the gap between computational predictions and experimental outcomes."}, {"title": "5.5 BROADER IMPACT AND FUTURE WORK", "content": "The de novo enzyme design approach, while groundbreaking, naturally encounters limitations, particularly in verifying enzyme functionality. Although we are making strides toward addressing this through an enzyme evolution framework, our efforts remain in progress. Future work will focus on incorporating principles of enzyme engineering and site-specific mutations to enhance the functional reliability and catalytic efficiency of the de novo enzymes generated. These improvements aim to build a more robust and validated pathway for enzyme design, bridging the gap between computational predictions and real-world enzymatic applications.\nA key challenge in enzyme design lies in accurately modeling substrate-product transitions, which are central to understanding catalytic mechanisms. Current approaches primarily focus on static binding models, yet dynamic interactions during catalysis remain underexplored. Future work will involve developing methods to model these substrate-product transitions more effectively, enabling designs that capture the full catalytic process. This could significantly improve the precision of de novo enzyme designs, bridging the gap between computational models and practical, functional enzymes capable of specific catalysis."}, {"title": "A EXTENDED RELATED WORK", "content": "Protein evolution learns how proteins change over time through processes such as mutation, selection, and genetic drift which influence protein functions. Studies on protein evolution focus on understanding the molecular mechanisms driving changes in protein sequences and structures. Zuckerkandl & Pauling (1965) introduce the concept of the molecular clock, which postulates that proteins evolve at a relatively constant rate over time, providing a framework for estimating divergence times between species. DePristo et al. (2005) show that evolutionary rates are influenced by functional constraints, with regions critical to protein function (e.g., active sites, binding interfaces) evolving more slowly due to purifying selection. This understanding leads to the development of methods for detecting functionally important residues based on evolutionary conservation. Understanding protein evolution has practical applications in protein engineering. By studying how natural proteins evolve to acquire new functions, researchers design synthetic proteins with desired properties Additionally, deep learning models increasingly integrate evolutionary principles to predict protein function and stability, design novel enzymes, and guide protein engineering (Yang et al., 2019; AlQuraishi, 2019; Jumper et al., 2021).\nGraph representation learning emerges as a potent strategy for learning about proteins and molecules, focusing on structured, non-Euclidean data . In this context, proteins and molecules can be effectively modeled as 2D graphs or 3D point clouds, where nodes correspond to individual atoms or residues, and edges represent interactions between them . Indeed, representing proteins and molecules as graphs or point clouds offers a valuable approach for gaining insights into and learning the fundamental geometric and chemical mechanisms governing protein-ligand interactions. This representation allows for a more comprehensive exploration of the intricate relationships and structural features within protein-ligand structures\nProtein function prediction aims to determine the biological role of a protein based on its sequence, structure, or other features. It is a crucial task in bioinformatics, often leveraging databases such as Gene Ontology (GO), Enzyme Commission (EC) numbers, and KEGG Orthology (KO) annotations Traditional methods like BLAST, PSI-BLAST, and eggNOG infer function by comparing sequence alignments and similarities . Recently, deep learning has introduced more advanced approaches for protein function prediction There are two major types of function prediction models, one uses only protein sequence as their input, while the other also uses experimentally-determined or predicted protein structure as input. Typically, these methods predict EC or GO annotations to approximate protein functions, rather than describing the exact catalyzed reaction, which is a limitation of these approaches.\nRecent advancements in generative models have advanced the field of protein design and binding pocket design, enabling the creation of proteins or binding pockets with desired properties and func-tions For example, RFDiffusion employs denoising diffusion in conjunction with RoseTTAFold for de novo protein structure design, achieving wet-lab-level generated structures that can be extended to binding pocket design. RFDiffusionAA  extends RFDiffusion for joint modeling of protein and ligand structures, generating ligand-binding proteins and further leveraging MPNNs for sequence design. Additionally, FAIR and PocketGen use a two-stage coarse-to-fine refinement approach to co-design pocket structures and sequences. Recent models leveraging flow matching frameworks have shown promising results in these tasks. For instance, FoldFlow introduces a series of flow models for protein backbone design, improving training stability and efficiency. FrameFlow further enhances sampling efficiency and demonstrates success in motif-scaffolding tasks using flow matching, while MultiFlow advances to structure and se-quence co-design. These flow models, initially applied to protein backbones, have been further generalized to binding pockets. For example, PocketFlow combines flow matching with physical priors to explicitly learn protein-ligand interactions in binding pocket design, achieving stronger results compared to RFDiffusionAA. And EnzymeFlow introduces a flow-based generative model, leveraging enzyme-reaction co-evolution and structure-based pre-training for enzyme catalytic pocket generation.\nThe first major contribution of GENZYME is its ability to perform de novo enzyme design, generating catalytic pocket structures and full enzyme structures capable of catalyzing previously unseen reactions. The second contribution is GENZYME generation of synthetic enzyme-substrate binding complex data, which aids in a deeper understanding of enzyme-substrate interactions and metabolic processes. The third contribution is the fine-tuned protein language models for enzyme representation learning, optimizing them for enzyme-specific tasks such as catalytic pocket inpainting, enzyme inverse folding, and enzyme representation learning."}, {"title": "B PRELIMINARIES", "content": "Following Jumper et al. (2021); Yim et al. (2023a), we refer to the enzyme structure as the backbone atomic coordinates of each residue. An enzyme with number of residues $N_E$ can be parameterized into SE(3) residue frames $\\{(x_i, r_i, a_i)\\}_{i=1}^{N_E}$, where $x_i \\in \\mathbb{R}^3$ represents the position (translation) of the $C\\alpha$ atom of the $i$-th residue, $r_i \\in SO(3)$ is a rotation matrix defining the local frame relative to a global reference frame, and $a_i \\in \\{1, ..., 20\\}$ denotes the amino acid type. We refer to the residue block as $E_i = (x_i, r_i, a_i)$, and the entire enzyme is described by a set of residues $E = \\{E_i\\}_{i=1}^{N_E}$\nA chemical reaction, $m_r: m_1 \\rightarrow m_2$, describes a process in which a substrate molecule $m_1$ is transformed into a product molecule $m_2$, catalyzed by the enzyme $E$. The reaction, substrate, and product can be represented by canonical SMILES. The catalytic pocket $E^P = \\{E_i\\}_{i=1}^{N_P}$, consisting of $N_P$ residues, is the active site within the enzyme $E$ where the substrate $m_1$ binds, forming an enzyme-substrate complex $C = [E, m_1]$, facilitating the reaction. Additionally, the enzyme scaffold $E^S = \\{E_i\\}_{i=1}^{N_S}$, consisting of $N_S$ residues, complements the catalytic pocket, such that $E = E^P \\cup E^S$ where $N_E = N_P + N_S$.\nFlow matching describes a process where a flow transforms a simple distribution $p_0$ into the target data distribution $p_1$. The goal in flow matching is to train a neural network $v_{\\theta}(\\epsilon_t, t)$ that approximates the vector field $u_t(\\epsilon)$, which measures the transformation of the distribution $p_t(\\epsilon_t)$ as it evolves toward $p_1(\\epsilon_t)$ over time $t \\in [0, 1)$. The process is optimized using a regression loss defined as $L_{FM} = E_{t \\sim U[0,1], \\epsilon_t \\sim p_t(\\epsilon_t)}||v_{\\theta}(\\epsilon_t, t) - u_t(\\epsilon)||^2$. However, directly computing $u_t(\\epsilon)$ is often intractable in practice. Instead, a conditional vector field $u_t(\\epsilon|\\epsilon_1)$ is defined, and the conditional flow matching objective is computed as $L_{CFM} = E_{t \\sim U[0,1], \\epsilon_t \\sim p_t(\\epsilon_t)}||v_{\\theta}(\\epsilon_t, t) - u_t(\\epsilon|\\epsilon_1)||^2$. Notably, $V_{OLFM} = L_{CFM}$.\nDuring inference or sampling, an ODEsolver, e.g., Euler method, is typically used to solve the ODE governing the flow, expressed as $\\epsilon_1 = ODEsolver(\\epsilon_0, v_{\\theta}, 0, 1)$, where $\\epsilon_0$ is the initial data and $\\epsilon_1$ is the generated data. In actual training, rather than directly predicting the vector fields, it is more common to use the neural network to predict the final state at $t = 1$, then interpolates to calculate the vector fields. This approach has been shown to be more efficient and effective for network optimization"}, {"title": "B.2.1 CONTINUOUS VARIABLE TRAJECTORY", "content": "Given the predictions for translation $x_1$ and rotation $r_1$ at $t = 1$", "follows": "n$v_{\\theta}(x_t, t) = \\frac{x_1 -"}]}