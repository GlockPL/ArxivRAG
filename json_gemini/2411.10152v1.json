{"title": "Causal Time-Series Synchronization for Multi-Dimensional Forecasting", "authors": ["Michael Mayr", "Georgios C. Chasparis", "Josef K\u00fcng"], "abstract": "The process industry's high expectations for Digital Twins require modeling approaches that can generalize across tasks and diverse domains with potentially different data dimensions and distributional shifts i.e., Foundational Models. Despite success in natural language processing and computer vision, transfer learning with (self-) supervised signals for pre-training general-purpose models is largely unexplored in the context of Digital Twins in the process industry due to challenges posed by multi-dimensional time-series data, lagged cause-effect dependencies, complex causal structures, and varying number of (exogenous) variables. We propose a novel channel-dependent pre-training strategy that leverages synchronized cause-effect pairs to overcome these challenges by breaking down the multi-dimensional time-series data into pairs of cause-effect variables. Our approach focuses on: (i) identifying highly lagged causal relationships using data-driven methods, (ii) synchronizing cause-effect pairs to generate training samples for channel-dependent pre-training, and (iii) evaluating the effectiveness of this approach in channel-dependent forecasting. Our experimental results demonstrate significant improvements in forecasting accuracy and generalization capability compared to traditional training methods.", "sections": [{"title": "1. Introduction", "content": "The number of sensors and the corresponding data produced in the process industry continuously increases, enabling a rich source of sensor data [13], which presents an unprecedented opportunity to harness complex sensor data for enhancing operational efficiency and decision-making. Manufacturers in the European Union, in particular, face the dual challenge of accelerating decision-making processes while conforming with ambitious energy-efficiency standards to reduce greenhouse gas emissions from production plants [7]. These challenges underscore the need for intelligently man-aged and controlled manufacturing lines, highlighting Digital Twins as the key enabler to increase competitiveness, sustainability, and efficiency [12]. A Digital Twin (DT) in the process industry represents a virtual model of a production system, integrating sensor data, simulations, and real-time data processing to predict and optimize the production process [22]. Recently, the evolution of DTs embraces cognitive capabilities, i.e. cognitive DTs (see [1], [17]), showcasing their progression towards autonomy and intelligence. A cognitive DT should be capable of learning from and"}, {"title": "1.1. Contributions", "content": "In this paper, we tackle the challenges of applying CD pre-training on multi-dimensional time-series datasets with complex causal structures or isolated causal clusters in addition to slow inertia and time misalignment, characteristics commonly encountered in the process industry. These characteristics may make it difficult for a CD pre-training strategy to efficiently converge across multi-dimensional datasets, as the models may constantly fit potential non-causally related vari-ables and time-mismatched cause-and-effect behaviours. A related time-alignment problem is also encountered in a recently proposed control-flow DT for the process industry [18]; however, it is"}, {"title": "2. Background and Related Work", "content": ""}, {"title": "2.1. Predictive Modelling in Digital Twins for Process Industry", "content": "Time-series forecasting, i.e. extrapolation of time-series into the future, a commonly encoun-tered regression problem for Digital Twins in process industry [17], is a critical area of research in"}, {"title": "2.2. Data-Driven Granger Causality and Causal Graph Structures", "content": "Granger causality, initially developed for economics [10], is increasingly used in various fields to identify cause-effect relationships (e.g. [2]). In the following paper, we utilize a similar approach as Ammann et al. [2] to identify cause-effect relationships between pairs of stochastic process variables and employ a simple linear VAR model, i.e. auto-regressive, assuming stationarity and linearly model-able cause-effect relationships. For a detailed analysis of the utilized method, we kindly refer to the authors [2]. We estimate the full VAR model on the training data and test for a significant increase in variance for specific time lags for pairs of variables using F-tests to denote causality. As a more straightforward use-case, and also for demonstration purposes, we assume globally stationary causal relationships. However, in a real-world scenario, dynamic causal rela tionships are expected. Zhao et al. [30] propose a simple method to directly incorporate dynamic cross-correlation measures, i.e., lead-lags, into the learning procedure.\nCausal and correlation-related information may be encoded in graph structures, where nodes denote (lagged) variables and edges denote the type of relation, i.e. correlation value, Granger Causality p-value. Encoding such data in graph structures enables complex query capabilities using graph related query languages (e.g. SPARQLfor RDF graph data formats, Cypher for Neo4J, or AQL for ArangoDB). Embedding such information in graph-like format may not be needed for simple use-cases like retrieving sub-graphs, identifying causally related pairs, i.e. cause-effect pairs, for syn chronization (described in Sec. 3.1 and Sec. 3.2), however, will be helpful in case of more complex information embedding in the graph. In this research, we utilize RDF triplets to store this informa tion in a Knowledge Graph (KG) format, i.e. the embedded data is queryable by using SPARQL standard, however as the graph grows, one may also utilize optimized databases for storing KGs or graph-related structures like Neo4J or ArangoDB, which all provide tailored graph-query languages"}, {"title": "2.3. Channel Dependence vs. Channel Indpendence", "content": "Time-series data in the process industry comprises different causally related variables, and accu-rate modelling requires capturing the relationships between these. CI methods just model cross-time dependence (e.g. [20], [3], [14]), only indirectly modelling cross-variable dependence through shared weights, whereas CD methods (e.g. [29], [11], [6], [26]) model cross-time and cross-variable depen-dence. Both CI and CD methods are commonly window-based, i.e., the forecast is conditioned on N time-points of historic context values. Increasing the context requires retraining the model, and increasing the context length is also computationally costly. This poses a problem in the process industry, as there may be causes and effects between different variables of the multi-dimensional dataset that are highly lagged, e.g. over several hours or even days, e.g. a kiln with high inertia to control inputs, which the specific context size may overlook, i.e. missing out on crucial data-driven supervisory signals for the model to generalize. Additionally, CD modelling approaches using the whole dataset, i.e. mixing all variables, may learn from causally unrelated variables or unsynchro-nized cause-effect behaviours.\nIn the following, we propose a CD pre-training methodology for multi-dimensional datasets with highly lagged causal data that can be used to pre-train various deep-learning models. Our proposed methodology aims to break down the problem of CD multi-dimensional time-series modelling by splitting the multi-dimensional data into causally related cause-effect pairs that are time synchro-nized. We hypothesize that by applying such pre-training methodology for CD methods, we move towards better generalization in case of modelling different multi-dimensional datasets as we break down the very complex problem into smaller, potentially easier solvable sub-problems for the model by only modelling time-synchronized cause-effect pairs. In comparison to the work done by Zhao et al.[30], where they account for dynamic lags using synchronization at each time step, we specifically investigate the capability of performance improvements of CD methods for causal dependencies that may lie outside of the specific context window used. We expect an improvement in accuracy for regression-related tasks due to reduced input and output complexity, higher amounts of data and reduced \"noise\" of wrongly lagged variables."}, {"title": "3. Methodology - Synchronized Cause-Effect Pairs for Channel Dependent Pre-Training on Multi-Dimensional Data", "content": "This section explains the proposed causal lag synchronization (see Sec. 3.2) as well as the construction of cause-effect data samples (see Sec. 3.3) in detail. Our proposed methodology aims to break down the problem of CD multi-dimensional time-series modelling by splitting the multi-dimensional data into causally related cause-effect pairs that are time synchronized. To do this, we exhaustively search for all possible cause-effect pairs (also transient connectivity), time synchronize the cause variable with the effect variable by applying a right shift operator with the specific lag to the cause variable (getting highly lagged causes into the context window), create data samples where the context holds all historical values for the respective synchronized cause and additionally the non-synchronized cause (in order to not miss any data due to the shift) and effect variable, the target, i.e. the variable that has to be predicted over a horizon, is, in this case, the future effect."}, {"title": "3.1. Threshold-based Causal Graph Generation", "content": "Given a multi-dimensional time-series X, we calculate the Granger causality for each possible variable pair up to lag $L_{max}$. We store the causal measurements for each lag and each variable pair. We calculate the \"best\" lag w.r.t. to the causal measurement, i.e. p-value, and test the causal hypothesis for the selected lag based on an expert-defined or data-driven defined threshold. Depending on the dataset, this results in a sub-graph, where clusters may form or even long causal chains. We exhaustively search for cause-effect pairs and denote the corresponding lag for each pair as $d_{ij}$, which is needed for the target-oriented causal shift, explained in the Sec. 3.2. Fig. 2 (a) depicts an illustrative example of a non-synchronized cause-effect pair, where the effect follows the cause with a time delay of two time steps."}, {"title": "3.2. Target-oriented Causal Shift", "content": "Given the identified cause-effect pairs, including the global lags, we adjust the variables accord-ingly by shifting $Z^{(i)}$ w.r.t $X^{(i)}$ by the corresponding calculated lag $d_{ij}$ forward in time, such that cause synchronizes with the effect, i.e. the target (see Fig. 2 (b)). The pairs reflect the globally stationary cause-effect relationships across the multi-dimensional data and can be utilized for CD pre-training or end-to-end modelling of e.g. regression-related tasks like forecasting (see Sec. 3.3). The assumption of global static causal lags may not hold in real-world systems. Thus, further refinement by calculating the dynamic lags for each time step or each domain, e.g. different prod-ucts, different environmental factors, etc., may be a necessity. However, dynamic causal lags are considered a future research direction but are not followed up on in this paper."}, {"title": "3.3. Predictive Modelling of Cause-Effects using Channel Dependent Deep Learning Models", "content": "We construct synchronized subsets of cause-effect training samples using a specific context length and horizon (i.e. prediction horizon). Synchronization leaves data at the beginning of the time series empty (when applied on a sliding window basis, each window would miss some time steps in the beginning). However, in case of causes outside the context window, we would benefit from filling up the missing values by sampling a bigger window to account for potential lags that need to fill up the first shifted missing values. In addition, due to the shift, data is lost in the cause variable as one shifts the latest values outside the context window. This is tackled by specifying a fixed additional cause variable that denotes the non-synchronized version. In this way, no information in the window is lost. Fig. 3 denotes an illustrative example of the transformed cause-effect pair. This input-output structure can be easily used to perform CD pre-training for various state-of-the-art deep learning models."}, {"title": "4. Experiments and Results", "content": ""}, {"title": "4.1. Experiment 1 - Synchronized vs. Non-Synchronized Cause-Effect Pairs for End-to-End Fore-casting", "content": "The following experiment showcases the difference of training with synchronized vs non-synchronized cause-effect pairs with state-of-the-art deep learning models that support exogenous variables, i.e. TSMixerx, MLPMultivariate, BiTCN, and TFT on synthetically generated datasets with known causal lagged relationships. We base the training of the mentioned models on the framework of Olivares et al. [21]. The training samples are structured as depicted in Fig. 3, and the models are trained with synchronized cause-effect pairs and non-synchronized cause-effect pairs; we compare"}, {"title": "4.2. Experiment 2 - Transferability of Cause-Effect Pre-Training", "content": "In this experiment, we evaluate the transferability of learned cause-effect dependencies by pre-training models on multiple synthetic source datasets and assessing their performance on a target dataset with unseen causal structures. Specifically, we investigate whether pre-training on a large and diverse set of causal relationships can improve forecasting accuracy on new datasets compared to models trained solely on limited target domain data. We compare two dataset configurations: models trained with non-synchronized cause-effect pairs and synchronized cause-effect pairs. We generated 100 synthetic source datasets, each consisting of a varying number of variables and 5000 time steps. As in Experiment 1, the variables are injected with random linear cause-effect structures using Tigramite. We compare source pre-trained and target fine-tuned models with models only trained on the target data. We average across the models and report the averaged MAPE of this experiment in Tab. 2. We can observe that pre-training on many different causal structures improves accuracy over solely supervised training on the limited target data with unseen causal structures, indicating that the models generalize from seeing independent cause-effect samples to some extent. It is important to note that this experiment does not evaluate zero-shot capabilities. However, this is planned as part of future research."}, {"title": "5. Discussion and Conclusion", "content": "This section discusses the stated research questions based on the research and experimental results conducted and highlights the assumptions for this methodology. In addition, we discuss the relevancy of (self-) supervised learning and transfer-learning for the process industry, their impact on Digital Twin modelling, and future research steps."}, {"title": "5.1. Evaluating the Research Questions (RQs)", "content": ""}, {"title": "Research Question 1: How can highly lagged, linear cause-effect relationships in multi-dimensional process data be identified in a data-driven way?", "content": "We utilize a data-driven methodology based on the Granger Causality to identify cause-effect pairs (see Ammann et al. [2]). We assume that the causal relationships can be linearly modelled using a VAR model. Non-linear Granger Causality methods exist; however, we follow a linear approach for simplicity. We highlight the necessity of non-linearity and the inclusion of expert knowledge in order to achieve high-quality causal discovery of complex systems."}, {"title": "Research Question 2: How can one synchronize cause-effect pairs w.r.t causal lag and create context-horizon training samples for CD pre-training without losing in-formation in the sample?", "content": "We propose a target-oriented shift trick (see Fig. 2), similarly to [30]. We recognize the complex causal structures, sometimes with isolated causal clusters in industrial multi-dimensional process data, making a correct synchronization across all N variables a challenging task, as one might introduce wrong shifts due to complex transitive or isolated dependen-cies. Thus, we propose a novel data preparation method to break down the complex causal graph into pairs of cause and effect variables, mit-igating unnecessary noise and complexity that might be introduced by CD methods training with out-of-sync or obsolete values in the samples. The proposed input-output format for the regression task is depicted in Fig. 3. As we lose information on the right (and left, but this is filled up) side of the window for the cause variable due to shifting the latest values out of the window, we also include the non-synchronized cause variable in the input sample to prevent any loss of data. The proposed method is generally formulated and breaks down the problem of multi-dimensional time-series forecasting in complex causal structures into its core compo-nents, i.e. cause-effect pairs. The input-output format is constructed in such a way that essentially, we combine CD on the level of individual cause-effect pairs, assuming CI-like learning behaviour of the whole causal structure."}, {"title": "Research Question 3: Do CD pre-training methods (e.g., TSMixerx, TFT, MLPMultivariate) benefit from synchronized cause-effect pairs for regression-related tasks like forecasting?", "content": "We evaluate the performance of various state-of-the-art forecasting mod-els trained on non-synchronized (NS) and synchronized (S) synthetic data with known cause-effect relationships. We denote the percentage differ-ence in MAPE to highlight the performance improvements. Each model is fitted using cross-validation and subsequently evaluated to retrieve the MAPE. We denote substantial percentage improvements across all models trained on the synchronized data compared to training on non-synchronized data. Details of all the experimental results are depicted in Tab. 1 and Tab. 2. It is essential to highlight that the tests in this paper are conducted on synthetically generated datasets. We aim to thoroughly benchmark the proposed methodology (i.e., causal synchronization and training on cause-effect pairs) on real-world datasets. We will prioritize"}, {"title": "5.2. Conclusion", "content": "This paper proposes a novel pre-training strategy to address several critical challenges en-countered when pre-training on diverse industrial datasets, particularly those arising from multi-dimensional time-series data, lagged cause-effect dependencies, complex causal structures, and vary-ing numbers of variables. Firstly, we utilize a data-driven methodology leveraging Granger Causality within a VAR model framework (see Ammann et al. [2]) to identify cause-effect pairs, utilizing a linear approach while recognizing the potential for future research in non-linear methods. Secondly, we introduce a synchronization technique called the target-oriented shift trick, similar to Zhao et al. [30], however, we align individual cause-effect pairs w.r.t. causal lag, thereby creating context-horizon training samples (see Fig. 3) for a novel pre-training strategy. This method tackles the complexity of industrial multidimensional process data by breaking the complex causal structure into manageable cause-effect pairs, minimizing the noise of misaligned time-series data, and ensur-ing more robust training in datasets with varying amounts of variables and causal structures. By utilizing the proposed pre-training strategy, we can train CD models on various cause-effect pairs across different multi-dimensional datasets, focusing on directly learning cause-effect behaviours on the variable pair level (CD) and indirectly learning from other cause-effects through shared weights (CI) (see Nie et al. [20]) which is a novel contribution in this area of research. Our method specif-ically captures cause-effect behaviours, an essential part of simulation and control in industrial"}]}