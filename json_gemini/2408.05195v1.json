{"title": "HistoKernel: Whole Slide Image Level Maximum Mean Discrepancy Kernels for Pan-Cancer Predictive Modelling", "authors": ["Piotr Keller", "Muhammad Dawood", "Brinder Singh Chohan", "Fayyaz ul Amir Afsar Minhas"], "abstract": "Machine learning in computational pathology (CPath) often aggregates patch- level predictions from multi-gigapixel Whole Slide Images (WSIs) to generate WSI-level prediction scores for crucial tasks such as survival prediction and drug effect prediction. However, current methods do not explicitly characterize distributional differences between patch sets within WSIs. We introduce HistoKernel, a novel Maximum Mean Discrepancy (MMD) kernel that measures distributional similarity between WSIs for enhanced prediction performance on downstream prediction tasks. Our comprehensive analysis demonstrates HistoKernel's effectiveness across var- ious machine learning tasks, including retrieval (n = 9,362), drug sensitivity regression (n = 551), point mutation classification (n = 3,419), and survival anal- ysis (n = 2,291), outperforming existing deep learning methods. Additionally, His- toKernel seamlessly integrates multi-modal data and offers a novel perturbation- based method for patch-level explainability. This work pioneers the use of kernel-based methods for WSI-level predictive modeling, opening new avenues for research. Code is available at https://github.com/pkeller00/HistoKernel.", "sections": [{"title": "1 Introduction", "content": "Advances in Computational Pathology (CPath) have demonstrated that machine learning can effectively utilize Whole Slide Images (WSIs) to address various clinically relevant problems [1, 2]. Due to their large size and high memory demands, WSIs are divided into smaller patches for model training using weakly supervised approaches to perform patch-level predictions. These are then aggregated into a single slide-level prediction. The development of patch-level foundation models has further increased the need for efficient aggregation techniques [3]. Three main branches of aggregation techniques have emerged [4]. Heuristic meth- ods generate predictions for each patch independently and aggregate them using fixed statistics, such as majority voting [5, 6]. These methods assume equal contribu- tion from all patches, which fails to capture complex relationships and dependencies, and can lead to sensitivity to outliers and the overshadowing of significant patches if they are in the minority. Clinically driven aggregations use domain-specific rules, like calculating overall WSI tumor cell percentage based on patch-level counts [4]. While interpretable, they require established clinical rules, limiting their appli- cability. Data-driven methods, including attention mechanisms and graph neural networks (GNNs) [7], can weigh patches based on relevance and context, but their learned parameters are task-specific, making them less generalizable without extensive retraining, and are computationally intensive. Crucially, existing aggregation approaches cannot explicitly quantify the differ- ences or similarities in the multi-variable distributions of patches in two WSIs, limiting their effectiveness. This gap is addressed by our novel WSI-level Maximum Mean Dis- crepancy (MMD) kernels. These kernels act as statistical tests to determine if two WSIs, modeled as sets of patches, are drawn from different distributions by comparing infinite statistical moments [8]. This capability allows us to define pairwise simi- larity between WSIs, facilitating numerous downstream tasks such as visualization, clustering, regression, classification, and survival analysis [9, 10]."}, {"title": "2 Results", "content": "At its core, the proposed approach allows calculation of the degree of similarity between two WSIs in the form of a kernel function (henceforth called HistoKernel) based on patche feature embeddings. These patch-level feature embeddings can be obtained from any pre-trained embedding or foundation model (See Methods: 4.3 and Fig 1 part (a)). Intuitively, if the kernel score between two WSIs is high then, with high probability, patches in these WSIs come from the same underlying distribution. Conversely, if the kernel score between two WSIs is small then that implies there is a substantial difference between the statistical distributions of patches comprising the two WSIs. This provides a principled way for identifying relationships between WSIS"}, {"title": "2.1 Visualization and Clustering", "content": "Fig 1 (b) shows HistoKernel for the entire TCGA dataset comprising more than 74 million pairs of WSIs. The degree of similarity between any two WSIs is expressed as a single number leading to the interpretation of the kernel matrix as an affinity matrix that can be used for hierarchical clustering or two-dimensional visualization through UMAP (see Fig 1 (b) and (c)). These visualizations clearly show WSIs of the same cancer type are clustered closer to each other in comparison to those from other types. Thus, HistoKernel is able to capture meaningful similarities between WSIs based on cancer type despite the fact that no cancer type labels or any other type of target labels are used in kernel computation. The kernel matrix visualization provides useful insights into similarities and differences in WSIs of different cancer types which typical patch-based approaches cannot do. For example, the UMAP plot shows some cancer types are very distinguishable such as brain and prostate whilst others are more closely clustered such as liver and endocrine tumours. It also allows for identification of cancer sub-populations such as the two predominant sub-clusters in endocrine tumours. Investigating the reasons for these patterns can help broaden our understanding of cancer. Dataset visualization can also be used for identifying potential noise or outliers, allowing interactive quality control in a CPath pipeline."}, {"title": "2.2 Whole Slide Image Retrieval", "content": "We utalise HistoKernel for WSI retrieval. Here, we are interested in retrieving the top k most similar WSIs for a given query image, Xq. Effective retrieval can be used to aid in clinical diagnosis for new patients based on diagnosis of similar patients. It may also help train new histopathologists by showing them similar images with the same diagnosis to help identify common histology patterns such as gland shape often used for prostate cancer grading [12]. To perform WSI retrieval we directly query HistoKernel matrix to find the most similar images (see Methods: 4.8). We compared performance of the proposed approach with current State of the art (SOTA), RetCCL, under the same validation protocol [13]. Table 1 shows the majority vote at the top five search results (mMV@5) achieved by HistoKernel and SOTA [13] for each cancer sub-type. The mMV@5 measures the percentage of samples in test set for which the majority cancer sub-type in the top - k retrieved samples is the same as the query image. We see HistoKernel consistently out- performed RetCCL, 12% higher mMV@5 macro-average across all sub-types. Further, HistoKernel's results are statistically significantly higher than comparative method (Wilcoxon paired signed rank test found p < 0.01). Thus, overall we can be confident HistoKernel has significantly outperformed the SOTA for WSI retrieval."}, {"title": "2.3 Regressing Cancer Drug Sensitivities", "content": "Next, we demonstrate HistoKernel's capability for regression tasks by predicting can- cer drug sensitivity from WSIs. We want to predict if a patient will respond to a drug using only a WSI. The target drug sensitivity values are inferred as real num- bers by aligning patients gene expression profile with cell line expression profile for which drug sensitivity values of drugs exist [14]. This is an important task as drug sensitivities can be used to optimise a patient's treatment, many studies supporting this approach [15]. Predicting drug sensitivities just from images is particularly inter- esting as histopathological assessment is considered routine and may be more readily available than genetic molecular tests which have high costs. We can utilise the pre-computed HistoKernel to train a Support Vector Regressor (SVR) to perform predictions. We compare performance of HistoKernel with the exist- ing SOTA approach in this domain by Dawood et al.'s SlideGraph under the same evaluation protocol [16] with spearman rank correlation between true and predicted sensitivities for each drug as a performance metric. Fig 2 part (a) shows the comparison between Spearman correlation coefficient (SCC) of predicted sensitivity for HistoKernel (y-axis) and the comparative method (x- axis) [16] for each compound. HistoKernel outperformed comparative method in terms of SCC for 94% of compounds clearly showing its superiority. HistoKernel's results are statistically significantly higher than comparative method (Wilcoxon paired signed rank test found p < 0.01) indicating a genuine increase in performance that was not a result of chance. Finally, in Supplementary Figure 1 we see HistoKernel produced 1.5 times as many statistically significant predictors (p-value < 1e-3) compared to com- parative method indicating greater reliability of HistoKernel. Fig 2 part (b) shows the distribution of HistoKernel's top 10 models which can have numerous advantages for patients treatment success. For example, Vincristine (SCC=0.65\u00b10.05) and Paclitaxel (SCC=0.69 \u00b1 0.06) are not effective for all patients [17]. Consequently, HistoKer- nel provides a potential mechanism for early identification of patients for alternative therapies leading to improved treatment efficacy and minimising side effects [18]."}, {"title": "2.4 Classification of Point Mutations", "content": "To illustrate the efficacy of HistoKernel for slide-level classification problems, we per- form point mutation classification. Point mutations are genetic mutations that involve a change in a single nucleotide base within the DNA or RNA sequence [19]. Numerous studies reported associations between various genetic mutations and tumour progres- sion and therapeutic response, highlighting the tasks importance [20]. WSI-based point mutation predictors can act as alternatives to genetic test leading to reduced turnaround times and costs [21]. HistoKernel was used as a precomputed kernel to train a Support Vector Machine (SVM) to perform gene point mutation classification. We compared performance of the proposed approach with the current SOTA under the same validation protocol [22]. Comparison results in Fig 3 part (a) show the number of genetic point mutations for a given cancer type that were predicted with high, moderate or weak confidence"}, {"title": "2.5 Survival Analysis", "content": "Thirdly, we use HistoKernel for survival analysis. Here we use WSIs to predict the expected time until a clinically important event occurs, for example, disease progres- sion or death, given other patients survival data. Accurate survival predictions can be used by pathologists to make data-driven decisions about best treatment course, improving overall patient care. Using WSI-based deep learning we can reduce human"}, {"title": "2.6 Multi-Modal Integration with Kernels", "content": "Finally, we show the ease of integrating multiple data modalities with HistoKernel. As a proof of concept, we demonstrate results for multi-modal survival analysis in BRCA. Here we want to combine information from different data sources such as histological image data and transcriptomics in order to capture complementary information about patient survival. We build on Multiple Kernel learning to combine the pre-computed HistoKernel with a kernel based on patient transcriptomic profiles or topics (see methods: 4.11) [30]. We can then utilise this combined kernel as a precomputed kernel for a KSSVM (as explained in Results: 2.5). Specifically, we use additive and multiplicative combinations of kernels from the two modalities. Figure 5 (a) shows the results of survival prediction in terms of C-index for BRCA for two multi-modal kernels. We see that both multi-modal kernels perform better than their single-modal counterparts. A clear increase in C-index as well as a smaller standard deviation clearly shows a multi-modal approach better captures patters asso- ciated with survival whilst being more robust. Part (c) and (d) support this idea as Kaplan-Meier curves produced for both multi-modal kernels show a clear sepa- ration between high and low risk patients. Further analysis of the best performing KTOPIC + KWSI kernel shows that unsupervised hierarchical clustering of the kernel (b) finds clear clusters forming with respect to BRCA subtypes. For example, basal- like breast cancer forms a clear cluster and is known to be associated with worse prognosis [31]. These results show the ease with which imaging and transcriptomic data can be integrated."}, {"title": "2.7 Time Complexity", "content": "For kernel computation we computed similarity between 12,186 WSIs, resulting in 74,243,205 WSI pairs. Calculating a single pairwise computation varies depending on number of patches but on average took 4 miliseconds. Thus, for all pairs the distance matrix computation requires 3.4 days on single GPU. This can be accelerated with parallelisation and by preloading WSI feature vectors into the GPUs."}, {"title": "3 Discussion", "content": "We presented a novel MMD-based kernel approach that quantifies similarity between WSIs. By computing MMD between WSIs represented as sets of patch-level features we generate a single kernel for entire dataset where the similarity between any two given WSIs is expressed by a single number. This kernel is only computed once for the entire dataset, after which it can be used for a variety of downstream tasks. Avoiding long retraining times per task makes HistoKernel very fast and flexible. Nevertheless, HistoKernel captures meaningful information as it is comparable to SOTA approaches for numerous fundamental tasks. To strengthen this claim, our perturbation-based patch-level explainer found logical patterns in HistoKernel's predictions, highlighting the potential for clinical applications. Firstly, we visualised HistoKernel. Fig 1 part (a) shows that numerous cancers like brain form clear clusters, supporting the idea that HistoKernel is finding patterns in data. This clustering is not perfect potentially due to tumour heterogeneity. Fig 1 part (b) further support idea of cancers clustering. Interestingly, both clustering methods coincide with the cancer types that are most distinguishable. It may be beneficial to study underlying reasons for this. It seems HistoKernel is capturing meaningful patterns in the data. It is unlikely HistoKernel is picking up stain variations or pos- sible artefacts as these have been accounted for during feature extraction and tissue segmentation. However, other confounding variables may exist. We investigated WSI retrieval where HistoKernel significantly outperformed SOTA for majority of sites\u00b9, 12% higher macro-average. A strong retrieval method is useful for diagnosis of new patients, based on similarity with patients with existing diagno- sis. Further, retrieval can be used to discover new patterns, for example identifying genetic patterns in patients who have high image-based similarity. Overall, HistoKer- nel has outperformed SOTA for retrieval without any processing of the kernel. This strengthens the argument that HistoKernel has found meaningful patterns. Next, we looked at the regression task of predicting drug sensitivities. HistoKernel significantly outperformed SOTA, achieving higher SCC for 94% of compounds. For Vincristine and Paclitaxel HistoKernel achieved highest SCC. Knowledge of patient"}, {"title": "4 Methods", "content": "4.1 Dataset For all the experiments we used WSIs of Formalin-Fixed paraffin-Embedded (FFPE) Hematoxylin and Eosin (H&E) stained tissue section from The Cancer Genome Atlas (TCGA) [32]. After excluding WSIs having missing baseline resolution information in total we end up with 12,186 WSIs belonging to 9,374 patients. We used data of 32 caner sub-types spanning across 25 anatomic sites. To obtain the target labels of patients point mutation status we downloaded muta- tion data of patients in 6-cancer types (endometrial, breast, lung adenocarcinoma, lung squamous cell carcinoma and glioblastoma) from cBioportal [33]. Inline with previous work we curated cancer-related genes with at least 25 mutations of known significance with a matching WSI [22]. However, unlike previous work we relabelled TCGA brain samples to obtain a new glioblastoma sub-population based on modern classification standards [34] (2021 fifth edition WHO). This edition incorporated molecular features into the diagnostic decision tree for brain tumours thus causing a major change in the classification of samples. These reclassified labels for the TCGA were obtained from Zakharova et al. [35]. Due to this relabelling and after excluding WSIs with missing baseline resolution from analysis we obtained 76 analysable genes in six cancer types. For cancer drug sensitivity prediction to be consistent with comparative method, we used data of 1,098 patients with breast invasive carcinoma from TCGA (TCGA- BRCA). For these patients we acquired their estimated sensitivity to 427 experimental and FDA-approved compounds from a previously published work that has used genomic and drug response data of Cancer Cell Lines (CCL) data [36] to infer these numbers. Based on these labels the comparative method restricted the analysis to patients with gene expression-based imputed sensitivity scores for all compounds to get a total of 551 patients for analysis. The labels were also normalised using z-score normalisation to account for the different ranges of the drug scores. For survival analysis, we restricted our analysis to kidney renal clear cell carci- noma (n=504), uterine corpus endometrial carcinoma (n=504), astrocytoma (n=219), glioblastoma (n=266), bladder urothelial carcinoma (n=372) and lung adenocarci- noma (n=426). To obtain labels for astrocytoma and glioblastoma we relabelled the"}, {"title": "4.2 Pre-processing of WSIs", "content": "For each WSI we first identify its viable tissue regions by using a U-Net-based tissue segmentation model from the TIAToolbox [11]. This ensures any artefacts such as pen markings or tissue folds as well as background regions are removed. This generates a mask for each image with a score of one for tissue area and zero otherwise. Since WSIs at full resolution can be very large (150,000 \u00d7 150, 000 pixels) and cannot fit into GPU memory, we apply the previously generated masks and then tile each WSI into patches of size 1024 \u00d7 1024 at a spatial resolution of 0.50 micrometers-per-pixel (MPP). Patches capturing less than 40% of informative tissue area (mean pixel intensity above 200) are discarded, and the rest of the patches are used, both tumour and non-tumour patches. For each patch pj in a WSI J, we obtain its d = 2048-dimensional feature representation x \u2208 Rd by passing it through a convolutional neural network (CNN) encoder. Any feature extractor can be used to encode patch-level features however we used the RetCCL model [13]."}, {"title": "4.3 Maximum Mean Discrepancy Kernels", "content": "We are interested in defining a (dis)similarity metric between two arbitrary WSIs X1 and XJ. To do this we will instead try to solve the analogous problem of defin- ing a distance metric which can then easily be converted to a similarity metric via a transformation (See Equation 5). We first require that this distance metric is valid, it should satisfy the non-negativity, identity, symmetry, and triangle inequality pro- prieties [39]. On top of this, since we are working with WSIs we need the distance metric to be independent of the orientation or shape of tissue, work with arbitrary feature representations, and it should be able to compare WSIs with different num- bers of patches. To capture these additional properties we model each WSI as a set of patches since by definition sets are unordered and can have different sizes thus any metrics defined will implicitly be forced to include these assumptions. More specifi- cally, X\u2081 = {x}, x},...,x1} where X\u2081 is a WSI such that N\u2081 is the number of patches in the image and xm represents the mth patches feature embedding in image X1."}, {"title": "4.4 Computation of Maximum Mean Discrepancy Kernels", "content": "In line with our previous work, we used the GPU-based GeomLoss library to efficiently compute MMD between WSIs [43]. In this paper, we use a Gaussian kernel thus to reduce computation the standard deviation for the kernel is set to \u03c3 = 10. By paral- lelising the matrix computation the MMD-dissimilarity matrix for the entire TCGA (12, 186 \u00d7 12, 186 dimensional matrix) took around 2 days to compute with paralleli- sation. It is important to note this computation was only done once and then the relevant subsections of this kernel were utilised for each task mentioned in Section 2."}, {"title": "4.5 Explainability of Maximum Mean Discrepancy Kernels", "content": "Since MMD generates a slide-level kernel any models trained with the precomputed kernel are intrinsically unable to generate patch-level predictions since patch-level information has already been condensed during the computation of moments. Thus, it was previously impossible to see which patches were most important for HistoKernel. Explainability is vital in CPath to ensure pathologists can make informed decisions about any models they use as well as to ensure the safety, approval, and acceptance of such models in a clinical setting [44]. To overcome this limitation, we developed a model-agnostic patch sensitivity metric that tells us how sensitive our predictor is with respect to a certain patch. This method takes inspiration from the field of perturbation-based instance explainability which perturb inputs of a given sample to observe the effects of these perturbations on the model's output [45, 46]. Traditionally, perturbations are applied to the features of a particular instance and any change in"}, {"title": "4.6 Kernel Visualisation", "content": "To perform kernel visualisation we first carried out Uniform Manifold Approximation and Projection for Dimension Reduction (UMAP). This works by constructing a high- dimensional graph representation of the data and then optimising a low-dimensional graph to be as structurally similar as possible [48]. Since the current implementation of UMAP accepts a precomputed square distance matrix we can simply pass in the HistoKernel matrix as input. The two main hyper-parameters of the model are the minimum distance between embedded points, dmin = 0.0, and the size of the local neighbourhood, Slocal = 100 (see the documentation for more details [48]). Secondly, we generated a heatmap of the distance matrix. This is done by first converting the distance matrix to a similarity kernel, KMMD, with y set to the median of the flattened distance matrix. This standardises all the values between zero and one. Then to get"}, {"title": "4.7 Drug Sensitivity Prediction", "content": "In order to predict drug sensitivity we made use of support Vector Regression (SVR) with our precomputed kernel. SVRs work similarly to traditional SVMs however the two major differences are that they predict scalar values instead of a binary label and use epsilon-insensitive loss for the loss function. This loss function introduces a new hyper-parameter that is not present in traditional SVMs, e, which sets errors that are within e distance of the true value to zero. For this experiment, we trained an SVR for each chemical compound separately resulting in 427 models. In line with the comparison study, for evaluation we made use of 5-fold cross- validation where we reserve 10% of the training data as a validation set for hyper-parameter optimisation. The metric used for evaluation was Spearman's rank correlation coefficient (SCC) between the ground truth and predicted values. The p-value associated with each SCC was also computed. A Wilcoxon paired signed rank test was also calculated between HistoKernel and the comparative method results [49]. This test is used to establish if two groups of samples are statistically significantly different from one another. A one-sided test was carried out to see if the distribution d=RMMD- RB, where RMMD and RB are the results of HistoKernel and compara- tive method respectively, is stochastically greater than a distribution symmetric about zero. This test was chosen as the Shapiro-Wilk test for normality revealed that both the comparative method and HistoKernel results do not follow a normal distribution (p < 0.01) [50]."}, {"title": "4.8 Whole Slide Image Retrieval", "content": "In this task for a query WSI, XQ, given that we know the site of origin of XQ we aim to retrieve the top k most \"similar\" WSIs. In the comparative method paper, similarity is defined as images from the same cancer sub-type. For example, if XQ originates from the brain and is of sub-type brain lower grade glioma (LGG) a database of WSIs originating from the brain is searched and the algorithm is considered successful if it returns images of the same sub-type (in this case LGG). To remain fair we will utilise the same definition. To perform Whole Slide Image Retrieval we directly query the precomputed kernel. Thus to retrieve the top-k most similar WSIs for an arbitrary query image XQ using MMD kernels we first generate a similarity kernel of the entire dataset KMMD = e-YDMMD. Here y is set to the median of the flattened distance matrix. Then we select the qth row of the matrix, KMMD. Since Kq* captures the similarity between X\u0119 and every other image in the dataset we just need to sort the row in descending order of similarity to find out which images are most similar to the query. We will also need to exclude the entry from the this sorted row which corresponds to similarity between XQ with itself since the similarity kernel includes the entire dataset and an image will"}, {"title": "4.9 Point Mutation Prediction", "content": "To predict point mutations we made use of kernelized binary SVMs. Inline with the comparative method we trained a separate model (SVM) for each of the 76 genes. For performance evaluation, we used 4-fold cross-validation with 40% of the train- ing data used as a validation set for hyperparameter tuning (both kernel y, see Section 4.3, and SVM regularisation parameter) [51]. The model's performance was measured by using Area Under the Receiver Operating Characteristic curve (AUC- ROC). In Figure 3 part (a) predcitons are binned based on AUC-ROC into weak (AUC-ROC < 0.6), moderate (AUC-ROC 0.6 to 0.7) and strong (AUC-ROC 0.7 to 1.0) predictors. In Fig 3 part (b) we filtered out genes where both comparative method and HistoKernel achieved an AUC-ROC less than 0.6, leaving 34 genes. This is because comparing genes for which both predictors are weak is meaningless."}, {"title": "4.10 Survival Analysis", "content": "In order to perform survival analysis we utilised kernelized survival SVMs (KSSVM) with our precomputed kernel. These predict a risk score f(X1) for a given patient, I, after training a model over a training dataset in the form of {(X1,T1,81)|\u0399 = 1... Ntrain}. Each patient is modelled as a tuple comprised of a patient's WSI X1, their disease-specific survival time T\u2081 and a binary event indicator variable \u03b4\u2081 \u2208 {0,1} which shows if the patient has passed away from the recorded cancer or not within a censoring time Tcensor = 10 years. The implementation of KSSVM accepts a pre- computed kernel and has a single hyperparameter a that controls the loss penalty term in its objective function [26]. We chose, a = 0.0625 and y, for the kernel, is set to the median of the flattened distance matrix. This is done to reduce the number of tunable hyper-parameters as the effect of y is also modulated by the blur parameter of the patch level kernel [52]."}, {"title": "4.11 Multi-Modal Kernels", "content": "To perform multi modal learning we first have to define our kernels. The first kernel is our precomputed HistoKernel that captures morphological information, KWSI. The second is a transcriptomic kernel that is computed from gene expression topics defined by Dawood et al [38]. In this work, each BRCA patient has been characterised by 200 binary variables or topics. The status of each topic variable represents specific gene expression patterns of co-dependent genes. Thus for each patient, P1, we can express their genetic information as a 200 binary feature vector, tP1: \\(tP1 = \begin{bmatrix} t^{1}_{P1} \\ \\vdots \\ t^{200}_{PI} \\end{bmatrix}\\) where t\u00b9\u2208 {0,1} is the binary status of topic j of patient I. To define a topic kernel we can compute the radial basis function between topic representations of two patients as: \\(KTOPIC = e^{-\\frac{||tPI-tPJ ||2}{2\\sigma^{2}}}\\) where o is the bandwidth of the RBF kernel function. In this work, for simplicity, we set \u03c3 = 10. We can then utilise the rich theory of Multi Kernel Learning (MKL) in order to combine our set of kernels K = {KTOPIC, KWSI}. The simplest type of method to combine kernels is Unweighted Multiple Kernel Methods (UMKL) where we perform a specific arithmetic operation to combine kernels without assigning kernel weights [30]. The first operation we use is addition where we define a new kernel KWSI + KTOPI\u0106."}, {"title": "5 Conclusion", "content": "This work explores Maximum Mean Discrepancy-based kernels for various CPath tasks. We have demonstrated the power of HistoKernel for WSI retrieval, cancer drug sensitivity prediction, point mutation classification, survival analysis and multi-modal learning. For these, HistoKernel has outperformed various comparative methods show- ing its wide versatility and ability to capture meaningful information from WSIs and summarise the data in a very compact manner. Our second major contribution was developing a patch sensitivity metric that provides explainability of slide-level predic- tions removing a major obstacle that was blocking the use of HistoKernel in a clinical setting. We hope this work paves the way for further exploration of HistoKernel in CPath. Future work will involve testing HistoKernel on datasets other than TCGA, testing for confounding factors and seeing how the model performs in a clinical setting."}, {"title": "Declarations", "content": "5.1 Funding Fayyaz Minhas acknowledges funding from EPSRC EP/W02909X/1. Fayyaz Min- has and Muhammad Dawood report research funding from GlaxoSmithKline outside the submitted work. Piotr Keller acknowledges funding from EPSRC Doctoral Train- ing Partnership (DTP) at the University of Warwick. Brinder Singh Chohan has no associated funding. 5.2 Conflict of interest/Competing interests Not applicable."}, {"title": "5.3 Ethics approval and consent to participate", "content": "Not applicable. 5.4 Consent for publication Consent for publication is given by all authors. 5.5 Data availability All WSIs and survival data used in this study are part of the TCGA and are publicly available at https://www.cancer.gov/ccg/research/genome-sequencing/tcga. Point mutation data from all genes is publicly available at https://www.cbioportal.org/31. 5.6 Materials availability Not applicable. 5.7 Code availability All code is available in GitHub at: https://github.com/pkeller00/HistoKernel. 5.8 Author contribution The concept for the study and experimented was developed by P.K. and F.M. The experiments and statistical were implemented by P.K. Assistance with run- ning comparative models and providing cleaned data was done my M.D. The study was supervised by F.M. B.R analysed patches and WSIs from KIRC, identifying morphological patterns in high and low risk regions."}]}