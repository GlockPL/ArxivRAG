{"title": "A Bayesian Approach to Harnessing the Power of LLMs in Authorship Attribution", "authors": ["Zhengmian Hu", "Tong Zheng", "Heng Huang"], "abstract": "Authorship attribution aims to identify the origin or author of a document. Traditional approaches have heavily relied on manual features and fail to capture long-range correlations, limiting their effectiveness. Recent advancements leverage text embeddings from pre-trained language models, which require significant fine-tuning on labeled data, posing challenges in data dependency and limited interpretability. Large Language Models (LLMs), with their deep reasoning capabilities and ability to maintain long-range textual associations, offer a promising alternative. This study explores the potential of pre-trained LLMs in one-shot authorship attribution, specifically utilizing Bayesian approaches and probability outputs of LLMs. Our methodology calculates the probability that a text entails previous writings of an author, reflecting a more nuanced understanding of authorship. By utilizing only pre-trained models such as Llama-3-70B, our results on the IMDb and blog datasets show an impressive 85% accuracy in one-shot authorship classification across ten authors. Our findings set new baselines for one-shot authorship analysis using LLMs and expand the application scope of these models in forensic linguistics. This work also includes extensive ablation studies to validate our approach.", "sections": [{"title": "1 Introduction", "content": "Authorship attribution, the process of identifying the origin or author of a document, has been a longstanding challenge in forensic linguistics. It has numerous applications, including detecting plagiarism (Alzahrani et al., 2011) and attribution of historical text (Silva et al., 2023). As the digital age progresses, the need for reliable methods to determine authorship has become increasingly important, especially in the context of combating misinformation spread through social media and conducting forensic analysis. The ability to attribute authorship can also lead to challenges around privacy and anonymity (Juola et al., 2008).\nThe field traces its roots back to the early 19th century (Mechti and Almansour, 2021), with early studies focusing on stylistic features and human expert analysis (Mosteller and Wallace, 1963). Traditional methods often relied on stylometry, which quantifies writing styles (Holmes, 1994), and rule-based computational linguistic methods (Stamatatos, 2009) to deduce authorship. Later, statistical algorithms incorporating extensive text preprocessing and feature engineering (Bozkurt et al., 2007; Seroussi et al., 2014) were introduced to improve accuracy. However, these methods often struggled with capturing long-range dependencies in text and require careful setup of specific thresholds for various indicators, which can be challenging to select effectively. They also involve designing complex, high-quality features, which can be costly and time-consuming.\nThe advent of deep learning has transformed the landscape of authorship attribution by turning the problem into a multi-class classification challenge, allowing for the capture of more features and addressing more complex scenarios effectively (Ruder et al., 2016; Ge et al., 2016; Shrestha et al., 2017; Zhang et al., 2018). However, these neural network (NN) models often lack interpretability and struggle with generalization in cases of limited samples.\nDespite advancements, the field still faces significant challenges. Obtaining large, balanced datasets that represent multiple authors fairly is difficult, and as the number of authors increases, the accuracy of machine learning models tends to decrease.\nOn the other hand, language models, central to modern NLP applications, define the probability of distributions of words or sequences of words and have traditionally been used to predict and generate plausible language. Yet, for a long time, these models, including high-bias models like bag-of-words and n-gram models, struggled to fit the true probability distributions of natural language. Deep learning's rapid development has enabled orders of magnitude scaling up of computing and data, facilitating the use of more complex models such as Random Forests (Breiman, 2001), character-level CNNs (Zafar et al., 2020), Recurrent Neural Networks (Bagnall, 2015), and Transformer (Vaswani et al., 2017).\nThe recent rapid evolution of Large Language Models (LLMs) has dramatically improved the ability to fit natural language distributions. Trained on massive corpora exceeding 1 trillion tokens, these models have become highly capable of handling a wide range of linguistic tasks, including understanding, generation, and meaningful dialogue (Liang et al., 2022; Bubeck et al., 2023; Zhang et al., 2023a, 2024). They can also explain complex concepts and capture subtle nuances of language. They have been extensively applied in various applications such as chatbots, writing assistants, information retrieval, and translation services. More impressively, LLMs have expanded their utility to novel tasks without additional training, simply through the use of prompts and in-context learning (Brown et al., 2020). This unique ability motivates researchers to adapt LLMs to an even broader range of tasks and topics including reasoning (Wei et al., 2022), theory of mind (Kosinski, 2023) and medical scenario (Singhal et al., 2023).\nInterestingly, language models have also been explored for authorship attribution (Agun and Yilmazel, 2017; Le and Mikolov, 2014; McCallum, 1999). Recently, research has utilized LLMs for question answering (QA) tasks within the application of authorship verification and authorship attribution (Huang et al., 2024), though these have primarily been tested in small-scale settings. Other approaches have attempted to leverage model embeddings and fine-tuning for authorship attribution, such as using GAN-BERT (Silva et al., 2023) and BERTAA (Fabien et al., 2020). However, these techniques often face challenges with scalability and need retraining when updating candidate authors. Moreover, they require relatively large dataset and multiple epochs of fine-tuning to converge. Given the challenges with current approaches, a natural question arises: How can we harness LLMs for more effective authorship attribution?\nTwo aspects of evidence provide insights to answer the above questions. First, recent studies on LLMs have shown that these models possess hallucination problems (Ji et al., 2023). More interestingly, the outputs of LLMs given prompts may disagree with their internal thinking (Liu et al., 2023). Therefore, it is advisable not to rely solely on direct sampling result from LLMs. Second, the training objective of LLMs is to maximize the likelihood of the next token given all previous tokens. This indicates that probability may be a potential indicator for attributing texts to authors.\nLanguage models are essentially probabilistic models, but we find the probabilistic nature of LLMs and their potential for authorship identification remains underexploited. Our study seeks to bridge this gap. Specifically, we explore the capability of LLMs to perform one-shot authorship attribution among multiple candidates.\nWe propose a novel approach based on a Bayesian framework that utilizes the probability outputs from LLMs. By deriving text-level log probabilities from token-level log probabilities, we establish a reliable measure of likelihood that a query text was written by a specific author given example texts from each candidate author. We also design suitable prompts to enhance the accuracy of these log probabilities. By calculating the posterior probability of authorship, we can infer the most likely author of a document. Due to the pivotal role of log probability in our algorithm, we coined our approach the \"Logprob method.\"\nOur new method has three main advantages:\n\u2022 No Need for Fine-Tuning: Our approach aligns the classification task with the pretraining objective, both focusing on computing entailment probability. This avoids any objective mismatch introduced by fine-tuning. Moreover, our method leverages the inherent capabilities of pre-trained LLMs and avoids knowledge forgetting that often occurs during fine-tuning.\n\u2022 Speed and Efficiency: This approach requires only a single forward pass through the model for each author, making it significantly faster and more cost-effective compared to normal question-answering method of language models which involves sampling a sequence of tokens as answer, with one forward pass for each token generated.\n\u2022 No Need for Manual Feature Engineering: The pre-training on diverse data enables LLMs to au-"}, {"title": "2 Method", "content": "Our approach to authorship attribution is based on a Bayesian framework. Given a document whose authorship is unknown, our objective is to identify the most probable author from a set using the capabilities of Large Language Models (LLMs).\nWe consider a scenario where we have a set of authors A = {a1,...,an} and a set of all possible texts E. Given an authorship attribution problem, where each author a\u017c has written a set of texts ti,1, ti,2,..., ti,m\u2081 \u2208 E, we denote the collection of known texts of an author ai as t(ai) = (ti,1, ti,2,..., ti,mi). For an unknown text u \u2208 E, we aim to determine the most likely author from the set A.\nTo estimate the author of text u, we use a Bayesian framework where the probability that u was written by author a\u017c is given by:\n$P(a_i|u) = \\frac{P(u|a_i)P(a_i)}{P(u)}$\nHere, P(ai) is the prior probability of each author, assumed to be equal unless stated otherwise, making the problem focus primarily on estimating P(ulaz).\nAssuming that each author a\u017c has a unique writing style represented by a probability distribution P(.ai), texts written by a\u017c are samples from this distribution. To estimate P(ulai), we consider the independence assumption: texts by the same author are independently and identically distributed (i.i.d.). Thus, the unknown text u is also presumed to be drawn from P(\u00b7|a\u017c) for some author a\u017c and is independent of other texts from that author.\nNotice that although texts are independent under the i.i.d. assumption when conditioned on a particular author, there exists a correlation between the unknown text u and the set of known texts t(a) in the absence of knowledge about the author. This correlation can be exploited to deduce the most likely author of u using the known texts.\nSpecifically, we have\n$P(u|t(a_i)) = \\sum_{a_j \\in A} P(u, a_j | t(a_i))$\n$= \\sum_{a_j \\in A} P(u|a_j,t(a_i))P(a_j|t(a_i))$\n$= \\sum_{a_j \\in A} P(u|a_j)P(a_j|t(a_i)),$\nwhere the last equality uses the i.i.d. assumption, meaning that when conditioned on a specific author aj, u is independent of other texts.\nWe then introduce the \"sufficient training set\" assumption, where:\n$P(a_j|t(a_i)) = \\begin{cases}\n1 & a_i = a_j\n\\\\\n0 & a_i \\neq a_j.\n\\end{cases}$\nThis implies that the training set is sufficiently comprehensive to unambiguously differentiate authors, leading to:\n$P(u|t(a_i)) = P(u|a_j),$\nwhere aj is the assumed true author of text u.\nWe use Large Language Models (LLMs) to estimate P(ult(ai)), which represents the probability that a new text u was written by the author of a given set of texts t(ai).\nThe probability nature of language models means that they typically calculate the probability of a token or a sequence of tokens given prior context. For a vocabulary set \u2211, the input to a language model might be a sequence of tokens X1,..., Xm \u2208\u03a3, and the model's output would be the probability distribution PLLM(\u00b7|x1,...,xm), typically stored in logarithmic scale for numerical stability.\nWhen using an autoregressive language model, we can measure not only the probability of the next token but also the probability of a subsequent sequence of tokens. For instance, if we have a prompt consisting of tokens X1,..., Xm \u0395 \u03a3, and we want to measure the probability of a sequence Y1,..., Y\u03c2 \u0395\u03a3, we calculate:\n$P_{LLM}(y_1,..., y_s|x_1,..., x_m) = \\prod_{i=1}^{S} P_{LLM}(y_i | x_1,..., x_m, y_1, ..., y_{i-1}).$\nTo estimate P(u|t(ai)) for authorship attribution, we define:\n$P(u|t(a_i)) = P_{LLM}(u | prompt\\_construction(t(a_i))).$\nThe prompt construction can vary, providing flexibility in how we use the model to estimate probabilities. Our method involves constructing a prompt steering the LLM uses to predict the likelihood that the unknown text was written by the same author.\nIn summary, our approach is straightforward and simple. By leveraging the capabilities of Large Language Models, we calculate the likelihood that an unknown text originates from a known author based on existing samples of their writing. This"}, {"title": "3 Experimental Setups", "content": "Models We selected two widely-used LLM families: 1) LLaMA family, which includes LLaMA-2 (Touvron et al., 2023), LLaMA-3, CodeL-LaMA (Roziere et al., 2023), available in various parameter sizes and configurations, with some models specifically fine-tuned for dialogue use cases; 2) the GPT family (Brown et al., 2020), featuring GPT-3.5-Turbo and GPT-4-Turbo (Achiam et al., 2023), where we specifically used versions gpt-4-turbo-2024-04-09 and gpt-3.5-turbo-0125. The LLaMA family models were deployed using the VLLM framework (Kwon et al., 2023) if used for Logprob method and are deployed on Azure if used for question-answering. Apart from Table 1, all ablation studies of Logprob method uses LLaMA-3-70B model.\nBaselines We chose two types of baselines for comparison. 1) embedding-based methods such as BertAA (Fabien et al., 2020) and GAN-BERT (Silva et al., 2023), which require training or fine-tuning, 2) LLM-based methods such as those described in (Huang et al., 2024), which utilize LLMs for authorship attribution tasks through a question-answering (QA) approach."}, {"title": "3.2 Evaluations", "content": "We evaluated our method on two widely used author attribution datasets: 1) IMDB62 dataset, a truncated version of IMDB dataset (Seroussi et al., 2014) and 2) Blog Dataset (Schler et al., 2006). IMDB62 dataset comprises 62k movie reviews from 62 authors, with each author contributing 1000 samples. Additionally, it also provides some extra information such as the rating score. The Blog dataset, contains 681k blog comments, each with an assigned authorID. Besides the raw text and authorID, each entry includes extra information such as gender and age. Both datasets are accessible via HuggingFace.\nBenchmark Construction Unlike fixed author sets used in many previous studies, we constructed a random author set for each test to minimize variance. By default, unless specified otherwise, each experiment in our experiments involved a 10-author one-shot setting, and we conducted 100 tests for each experiment to reduce variance. Each test involved the following steps: 1) Ten candidate authors were randomly selected. 2) For each author, one (or n for n-shot) article was randomly selected as the training set. 3) One author was randomly selected from the ten candidates as the test author. 4) One article not in the training set was randomly selected from the test author's articles as the test set (with size of 1). 5) We run the authorship attribution algorithm to classify the test article into 10 categories.\nOur evaluation pipeline can avoid potential biases from fixed author sets and better measure the efficacy of LLMs in authorship attribution tasks. We also share our pipeline for fair evaluations of future related works.\nNotably, aforementioned pipeline is suitable for non-training based methods like ours and QA approaches. However, for training-based methods such as embedding approaches, each train-test split is followed by a retraining, demanding significant computational resources. Therefore, in this work, we directly cited scores from the original papers."}, {"title": "3.1 Models & Baselines", "content": "Evaluation Metrics We adopt three metrics: top-1, top-2 and top-5 accuracies. Specifically, top k accuracy is computed as follows:\n$Top k Accuracy = \\frac{Num_{k \\_ correct}}{Num_{all}},$\nwhere $Num_{k \\_ correct}$ represents the number of tests where the actual author is among the top k predictions, and $Num_{all}$ represents the total number of tests."}, {"title": "4 Experiments", "content": "Firstly, we evaluate different methods for author attribution in Section 4.1, noting that our Log-prob method significantly outperformed QA-based methods in accuracy and stability across datasets. Then, we study the impact of increasing candidate numbers on performance in Section 4.2, where our method maintained high accuracy despite a larger pool of candidates. Next, in Section 4.3, we analyze prompt sensitivity, concluding that while prompt use is crucial, variations in prompt design did not significantly affect the performance. Further, in Section 4.4, we explore bias in author attribution and in Section 4.5, we measure performance variations across different subgroups. Finally, in"}, {"title": "4.1 Author Attribution Performance", "content": "Table 1 shows the main results for different methods on the IMDB62 and Blog datasets concerning authorship attribution capabilities. We make the following observations:\n\u2022 LLMs with QA-based methods cannot perform author attribution tasks effectively. For example, GPT-4-Turbo can only achieve a top-1 accuracy of 34% on the IMDB62 dataset and 62% on the Blog dataset. Notably, there are two interesting phenomena: 1) GPT-4-Turbo and GPT-3.5-Turbo exhibit inconsistent higher accuracy across different datasets, highlighting inherent instability in the prompt-based approach. 2) Older LLMs with smaller context window lengths are unable to perform author attribution due to the prompt exceeding the context window. These phenomena indicate that QA methods are not a good option for enabling LLMs to conduct author attribution tasks effectively.\n\u2022 Our Logprob method helps LLMs perform author attribution tasks more effectively. With LLaMA-3-70B, we achieved top-1 accuracy of 85%, and both top-2 and top-5 accuracies were even higher. This suggests that LLMs equipped with our method can effectively narrow down large candidate sets. Additionally, two another things worth noting are that 1) LLMs with the Logprob method exhibit more stable performance across both tasks, something QA methods struggle with, and 2) LLMs with Logprob can conduct authorship attribution tasks with lower requirements for context window length. For instance, LLaMA-2-70B-Chat with the Log-prob method can handle authorship attribution, whereas the same model with a QA approach fails when the collective text of 10 authors exceeds the context window length. These findings highlight the superiority of our Logprob method.\n\u2022 Training-free method can achieve comparable or even superior performance to training-based methods. The Blog dataset showed higher top-1 accuracy with LLaMA + Logprob compared to GAN-BERT and BertAA. While the IMDB62 dataset exhibited lower performance relative to embedding-based methods, it is important to note that Logprob achieves this as a"}, {"title": "4.2 Performance vs. Number of Candidates", "content": "One of the challenges in authorship attribution is the difficulty in correctly identifying the author as the number of candidates increases, which generally leads to decreased accuracy. Figure 3 shows the author attribution performance across different candidate counts on the IMDB62 dataset. We made the following observations:\n\u2022 First, performance indeed decreases as the number of candidates increases.\n\u2022 Second, across all settings, all metrics maintain relatively high scores. For example, in the setting with 50 candidates, our method achieved 76% top-1 accuracy, 84% top-2 accuracy, and 87% top-5 accuracy.\n\u2022 Third, top-2 and top-5 accuracies are more stable compared to top-1 accuracy. The model may not always place the correct author at the top, but it often includes the correct author within the top few predictions. This attribute is also crucial as it allows the narrowing down of a large pool of candidates to a smaller subset of likely candidates."}, {"title": "4.3 Analysis of Prompt Sensitivity", "content": "Our method relies on suitable prompt as in Figure 2. Here, we discuss the sensitivity of our accuracy to different prompt constructions in Table 2. We made the following observations:\n\u2022 Using prompts is essential for enhancing the accuracy of our method (#1 vs. #2). This phenomenon is aligned with previous studies"}, {"title": "4.4 Bias Analysis", "content": "An algorithm trained on an entire dataset may exhibit different accuracy levels across different subgroups during testing (Chouldechova and G\u2019Sell, 2017; Pastor et al., 2021). This section discusses such bias issues and measures how the algorithm's accuracy varies for different subgroups."}, {"title": "4.5 Subgroup Analysis", "content": "When considering authorship attribution restricted to specific subgroups, the task can either become simpler or more difficult. Certain subgroups may express personal styles more distinctly, making authorship attribution easier, while others may be more homogeneous, making it more challenging. Here, we consider three subgroup factors: gender, age, and rating, to analyze the performance under each group."}, {"title": "Subgroup by Gender", "content": "As shown in Table 4, we evaluated the performance of authorship attribution within different gender subgroups in the Blog dataset. We observed that authorship attribution performed better within the female subgroup, consistent with findings in Section 4.4, suggesting female-authored blogs possess more distinctive personal styles."}, {"title": "Subgroup by Rating", "content": "Table 5 (a) shows the performance of authorship attribution across different rating ranges in the IMDb review dataset. Overall, we can see that rating does influence performance, with review in the [5 \u2013 6] rating range easier to attribute. Despite such difference, our method consistently obtains good performance across all subgroups."}, {"title": "Subgroup of Age", "content": "Table 5 (b) shows the performance of authorship attribution across different age ranges of bloggers in the Blog dataset. We observed that age significantly influences performance. The youngest age group [13 \u2013 17] exhibited the highest top-1 accuracy at 90%, while accuracy decreased with increasing author age. This suggests that younger authors tend to have more distinct opinions and identifiable writing styles. Despite performance differences, our method maintained relatively overall high performance, with the lowest accuracy still surpassing that of GPT-4-Turbo with QA method."}, {"title": "4.6 Efficiency Analysis", "content": "Table 6 shows the efficiency comparison of different methods on the imdb dataset. Our Logprob method operates with notably lower runtime compared to QA methods. This is primarily due to the Logprob method requiring only a single forward pass through the LLM for each author to estimate the log probabilities. In contrast, QA methods generally need multiple iterations of token generations to form a response, which increases computation time substantially. In the mean time, our method achieves an accuracy of up to 85%, surpassing QA method based on GPT-4-Turbo in both efficiency and accuracy.\nIn summary, our method proves to be effective and efficient in performing authorship attribution across various datasets and setups."}, {"title": "5 Conclusion", "content": "In this paper, we study the problem of authorship attribution. We demonstrate the effectiveness of utilizing pre-trained Large Language Models (LLMs) for one-shot author attribution. Our Bayesian approach leverages the probabilistic nature of language models like Llama-3 to infer authorship. Our method does not require fine-tuning, therefore reduces computational overhead and data requirements. Our experiments validate that our method is more effective and efficient compared to existing techniques."}, {"title": "6 Limitations", "content": "The main limitations arise due to the dependence on LLMs.\nOur method relies heavily on the capabilities of LLMs, and the performance of our approach is highly affected by the size and training objectives of the LLMs. As shown in Table 1, models that are only pre-trained rather than fine-tuned for dialogue or code task performs better.\nWhile larger models generally perform better, they also entail higher costs, posing scalability and accessibility challenges for broader applications.\nAnother limitation is due to training data of LLMs. If the training data lacks diversity or fails to include certain writing styles, the model may not fully capture the intricacies of an author's style, potentially leading to misclassifications. This limitation underscores the importance of using diverse and comprehensive training datasets.\nFurthermore, any biases present in the training data can also be absorbed by the model. These biases will influence the performance of our authorship attribution method.\nOn the broader societal level, the potential for misuse of this technology is a significant concern. The challenge of regulating and overseeing the use of such powerful tools is still not fully addressed.\nLastly, while our approach avoids the need for extensive retraining or fine-tuning, which is an advantage in many cases, this also means that our method might not adapt well to scenarios where lots of training data and computation is available, which justifies more complex and computationally intensive methods."}, {"title": "A Ethical Considerations", "content": "Our method using LLMs for authorship attribution brings several ethical considerations that must be addressed to ensure responsible and fair use of the technology.\nPrivacy and Anonymity The capacity of LLMs to attribute authorship with high accuracy can lead to ethical challenges regarding privacy and anonymity. Individuals who wish to remain anonymous or protect their identity could be compromised if authorship attribution tools are misused. Therefore, it is crucial to establish strict guidelines and ethical standards on the use of such technologies to prevent breaches of privacy.\nPotential for Abuse Despite multiple beneficial applications, the misuse potential of authorship attribution tools is significant. Risks include the use of this technology to suppress free speech or to endanger personal safety by identifying individuals in contexts where anonymity is crucial for safety. Addressing these risks requires robust governance to prevent misuse and to ensure that the technology is used ethically and responsibly.\nBias Issue The performance of authorship attribution methods can vary across different demographics, leading to potential biases. It is important to continually assess and correct these biases to ensure fairness in the application of this technology.\nMisclassification Issue Given the high stakes involved, especially in forensic contexts, the accuracy of authorship attribution is important. Misclassifications can have serious consequences, including wrongful accusations or legal implications. It is essential for authorship attribution methods to be reliable and for their limitations to be transparently communicated to users."}, {"title": "B Broader Impact", "content": "Our study of authorship attribution using LLMs contributes to advancements in various domains:\nForensic Linguistics Our research contributes to the field of forensic linguistics by providing tools that can solve crimes involving anonymous or disputed texts. This can be particularly useful for law enforcement and legal professionals who need to gather evidence and make more informed decisions.\nIntellectual Property Protection Our method can serve as a powerful tool in identifying the authors of texts, which can help protect intellectual property rights and resolve disputes in copyright.\nHistorical Text Attribution In literary and historical studies, determining the authorship of texts can provide insights into their origins and contexts, enhancing our understanding and interpretation.\nEnhanced Content Management Media and content companies can use this technology to manage content more effectively by accurately attributing authorship to various contributors.\nEducational Applications In educational settings, our method can help prevent plagiarism and promote academic integrity. It can also serve as a teaching tool to help students understand and appreciate stylistic differences between authors.\nWhile our method holds promise across multiple applications, it is crucial to deploy it with caution. Ensuring that the technology is used responsibly and ethically will be key to maximizing its benefits while minimizing potential harm."}]}