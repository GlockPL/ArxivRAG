{"title": "REBIND: ENHANCING GROUND-STATE MOLECULAR CONFORMATION PREDICTION VIA FORCE-BASED GRAPH REWIRING", "authors": ["Taewon Kim", "Hyunjin Seo", "Sungsoo Ahn", "Eunho Yang"], "abstract": "Predicting the ground-state 3D molecular conformations from 2D molecular graphs is critical in computational chemistry due to its profound impact on molecular properties. Deep learning (DL) approaches have recently emerged as promising alternatives to computationally-heavy classical methods such as density functional theory (DFT). However, we discover that existing DL methods inadequately model inter-atomic forces, particularly for non-bonded atomic pairs, due to their naive usage of bonds and pairwise distances. Consequently, significant prediction errors occur for atoms with low degree (i.e., low coordination numbers) whose conformations are primarily influenced by non-bonded interactions. To address this, we propose REBIND, a novel framework that rewires molecular graphs by adding edges based on the Lennard-Jones potential to capture non-bonded interactions for low-degree atoms. Experimental results demonstrate that REBIND significantly outperforms state-of-the-art methods across various molecular sizes, achieving up to a 20% reduction in prediction error.", "sections": [{"title": "1 INTRODUCTION", "content": "The ground-state conformation of a molecule represents the lowest energy state on the potential energy surface, where the inter-atomic forces are balanced at equilibrium. This 3D conformation of the molecule plays a crucial role in determining the molecule's physical, chemical, and biological properties. As a result, it is utilized in various applications such as molecular property prediction (Satorras et al., 2021; Sch\u00fctt et al., 2021; Liu et al., 2022; Th\u00f6lke & De Fabritiis, 2022; Zhou et al., 2023a; Zaidi et al., 2023; Ni et al., 2024), drug discovery (Luo et al., 2021; Ganea et al., 2021; Jing et al., 2022; Xu et al., 2022; Zhou et al., 2023b; Tang et al., 2024), and protein-ligand interactions (Pei et al., 2024; Wang et al., 2024).\nRecently, deep learning approaches (Hu* et al., 2020; Xu et al., 2021c; Brody et al., 2022; Rampasek et al., 2022; Xu et al., 2024) have emerged as promising alternatives to reduce the computational costs of ab initio calculations such as density functional theory (DFT; Kohn & Sham, 1965; Parr et al., 1979). These approaches focus on predicting 3D molecular conformations by leveraging graph neural networks (GNNs) with 2D molecular graphs as input. Central to most of these models is the assumption that a 2D molecular graph, where atoms are represented as nodes and covalent bonds as edges, can effectively capture atomic interactions. Building on this assumption, they employ iterative message-passing updates to predict molecular conformations, which are parallel to the iterative force-based updates used for conformer optimization. Specifically, GNN-based methods rely on covalent bonds (Hu* et al., 2020; Brody et al., 2022; Rampasek et al., 2022) and pairwise distances (Xu et al., 2024) during the message-passing phase to represent inter-atomic forces, encouraging bonded and proximate atomic pairs to be close in the representational space."}, {"title": "2 PRELIMINARIES", "content": "Problem definition. We focus on predicting the 3D ground-state molecular conformation from its corresponding 2D molecular graph G = (V, E), where V denotes the set of N = |V| atoms (nodes) and & represents the set of M = E bonds (undirected edges) between atomic pairs. Nodes are characterized by a feature matrix X = [X1,X2, ..., XN]T \u2208 RN\u00d7d, where each feature encodes atomic properties such as atom types and chirality. Edges are described by a binary adjacency matrix A \u2208 RN\u00d7N, where A[i, j] = 1 if a bond exists between atoms i and j, and A[i, j] = 0 otherwise. Additionally, an edge feature matrix E = [e1, e2, ..., eM]T\u2208 RM\u00d7f may be utilized to represent bond-specific attributes, including bond types. The ground-state molecular conformation is represented as C = [C1, C2, ..., CN] \u2208 RN\u00d73, where each Ci\u2208 R\u00b3 corresponds to the 3D coordinate of atom i. The atomic pairwise distance is denoted as D \u2208 RN\u00d7N, where Dij = ||Ci - Cj ||2"}, {"title": "3 LIMITATION OF INTER-ATOMIC FORCE MODELING IN PRIOR STUDIES", "content": "In this section, we highlight the shortfalls of current approaches in using covalent bonds (Hu* et al., 2020; Brody et al., 2022; Rampasek et al., 2022) or pairwise distances (Xu et al., 2024) to model inter-atomic forces, followed by experimental results supporting our claim.\nLimitations of prior works for non-bonded interactions. In ground-state molecular conformation prediction, accurately modeling inter-atomic forces is essential, as the net force on each atom defined by the gradient of molecular energy E, approaches zero at equilibrium (Shi et al., 2021a). This equilibrium condition primarily determines the spatial arrangement of atoms. Meanwhile, a classic model of the energy E divides the term into bonded and non-bonded interactions (Leach,"}, {"title": "4 REBIND: ENHANCING GROUND-STATE MOLECULAR CONFORMATION VIA FORCE-BASED GRAPH REWIRING", "content": "Given the limitation of previous studies, we introduce REBIND, a novel graph rewiring framework that selectively adds edges in a force-aware manner, prioritizing atoms with low-degree. In Sec-"}, {"title": "4.1 OVERVIEW", "content": "The overall architecture of REBIND is illustrated in Figure 2. Our framework receives a 2D molecular graph as input, characterized by its bonded adjacency matrix Abond and node feature or embeddings augmented with Laplacian positional encoding L. The framework outputs a predicted molecular conformation, denoted as C. We employ a standard encoder-decoder architecture with multi-head self-attention, following the approaches presented in (Vaswani, 2017; Cai & Lam, 2020; Xu et al., 2024). In this setup, the encoder processes the input graph to generate hidden representations Henc. A task-specific prediction head then produces an initial conformation prediction \u0109enc from Henc. From this intermediate prediction, we derive 1) an inter-atomic distance matrix Denc and 2) force-aware adjacency matrices Aforce = {Aattr, Arep}, where Aattr and Arep denote adjacency matrices identifying attractive and repulsive atomic pairs. The hidden representation Henc, along with Abond and Aforce, are subsequently fed into the decoder to generate the refined, residual molecular representation."}, {"title": "4.2 FORCE-AWARE GRAPH REWIRING", "content": "Here, we outline the construction of force-aware adjacency matrix Aforce, which connects non-bonded atomic pairs exerting significant forces to one another, mitigating the shortfalls of prior works identified in Section 3.\nForce modeling with Lennard-Jones potential. To capture the interactions between non-bonded atomic pairs, we leverage the Lennard-Jones (LJ) potential (Jones, 1924), a well-established model for non-bonded interactions such as van der Waals forces. The LJ potential is defined as:\nV(r) = 4\u20ac [(\u03c3/r)^12 - (\u03c3/r)^6]\nwhere r is the distance between two atoms, & is the depth of the potential well (representing the strength of the interaction), and o is the finite distance at which the inter-atomic potential is zero. The first term (\u03c3/r)^12 accounts for the repulsion when atoms are too close, while the second term (\u03c3/r)^6 accounts for the attraction at moderate distances. By using the derivative of this potential, we compute the inter-atomic forces acting upon non-bonded atom pairs, which is critical for modeling the equilibrium conformation of the molecule. This force model provides a more realistic representation of how spatial positions are influenced, especially for low-degree atoms, where non-covalent interactions dominate.\nThe values of and \u025b are assigned based on the specific pair of atom types being modeled (e.g., carbon, hydrogen, etc.). In line with conventional force-field modeling approaches used in com-"}, {"title": "4.3 INTEGRATION WITH MULTI-HEAD SELF-ATTENTION", "content": "Leveraging the augmented edges, REBIND enhance the multi-head self-attention by incorporating both bond-based and force-based adjacency matrices. Specifically, the augmented force-based adjacency matrices Aforce = {Aattr, Arep} and original bond-based adjacency matrix Abond are incorporated as residual components in the attention scores for each head h. This integration is formalized as follows:\nSh = Sh + Sh (BP \u00d7 Abond) + Sh (Attr x Aattr) + Sh (Rep x Arep),\nwhere Sh = QhK = (ZW)(ZWK) represents the global self-attention score. Here, Z = Henc + L \u2208 RN\u00d7d is the input to the decoder, combining the encoder's hidden representations Henc"}, {"title": "4.4 OBJECTIVE FUNCTION", "content": "To ensure that the predicted molecular conformation remains invariant to rotation and translation, we adopt a loss function based on the difference between the predicted and ground-truth pairwise Euclidean atomic distances, denoted as D and D, respectively, which is also utilized in prior works (Xu et al., 2021c; 2024). Additionally, to achieve precise force modeling within the decoder, we apply the same loss objective to the initial conformation predictions Denc and D from the encoder. The overall loss objective L is formulated as follows:\nL = 1/NN ||Denc - D|| + 1/N2\u03a3 - Dencij || + - Dencij || + D - Dij ||\nComparison with existing graph transformers. Several existing works integrate inter-atomic relationships as residuals within multi-head self-attention mechanisms. For instance, the Geometric Transformer (Choukroun & Wolf, 2021) utilizes the pairwise Euclidean distances D, computed from ground-truth atomic coordinates, to perform molecular property prediction. Similarly, MAT (Maziarka et al., 2020) incorporates both the pairwise distances D and the bond adjacency matrix Abond for the same task. In contrast, GTMGC (Xu et al., 2024) employs predicted inter-atomic distances Drow-sub to forecast ground-state molecular conformations.\nWhile our work also leverages pairwise atomic relationships as residuals in the computation of attention scores, REBIND distinguishes itself by enabling fine-grained force modeling. This is achieved through the joint utilization of both bonded interactions and non-bonded interactions characterized by the largest forces. Consequently, our framework attains more precise ground-state molecular geometries, which is substantiated in the subsequent section."}, {"title": "5 EXPERIMENTS", "content": "Datasets. We evaluated REBIND on well-established benchmark datasets, including QM9 (Ramakrishnan et al., 2014), Molecule3D (Xu et al., 2021c), and GEOM-DRUGS (Axelrod & Gomez-Bombarelli, 2022). QM9 consists of small organic molecules and is widely utilized for quantum"}, {"title": "5.2 MAIN RESULTS", "content": "We present the performance results with of REBIND in Table 1, where the percentage reduction is calculated as the ratio of the performance improvement over the best baseline, expressed as a percentage. As demonstrated, our method achieves consistent superiority over baseline methods across all datasets and evaluation splits. On the QM9 dataset, REBIND achieves notable improvements across all evaluation metrics, with gains of up to 24% in both C-RMSD and E-RMSD. Additionally, our method exhibits robust generalization capabilities on the larger Molecule3D dataset. Notably, REBIND further excels in the scaffold split, where training and test sets contain structurally diverse molecules, achieving up to a 10% reduction in E-RMSD. This highlights REBIND's ability to generalize effectively to novel molecular scaffolds. Furthermore, it is worth emphasizing that higher performance gains are observed in E-RMSD compared to C-RMSD. This suggests that REBIND generates molecular conformations that are not only geometrically accurate but also more realistic in terms of energetic stability, resulting in more physically plausible molecular structures."}, {"title": "5.3 SCALABILITY TO LARGE MOLECULES", "content": "We further validate REBIND on the GEOM-DRUGS dataset with large molecules by including Torsional Diffusion (Jing et al., 2022)as an additional baseline, which adopts the same dataset as its benchmark. Since Torsional Diffusion was originally designed to generate multiple conformers, we adapt it to produce a single conformation per molecule for evaluation.\nAs shown in Table 2, REBIND signifi-cantly outperforms the baselines, achiev-ing improvements of up to 4% in C-RMSD"}, {"title": "5.4 ABLATIVE STUDY", "content": "Ablation on components. We conduct an ablation study on the components of REBIND on the QM9 dataset, with the re-sults presented in Table 3. Using a fully-connected transformer with Laplacian po-"}, {"title": "5.5 QUALITATIVE ANALYSIS", "content": "We present a qualitative comparison of REBIND against baseline architectures based on atom-wise RMSD on the QM9 dataset, shown as blue bars in Figure 1. As illustrated, REBIND achieves significant error reductions for both groups. Specifically, when compared against GTMGC, REBIND further reduces the atom-wise RMSD for lower-degree groups by 0.11, compared to a reduction of 0.05 for high-degree groups, thereby verifying the efficacy of our degree-compensating augmenta-tion. Moreover, our method greatly reduces the gap between the atom-wise errors of low-degree and high-degree groups, achieving 15.16% and 20.91% percentage reduction in the gap for atom-wise RMSD and MAE, respectively, compared to GTMGC. These results substantiates that REBIND comprehensively captures non-bonded interactions through force-aware edge augmentation."}, {"title": "6 RELATED WORKS", "content": "There has been a growing interest in generating molecular conformations from 2D molecular graphs. Traditional cheminformatics methods, such as DG and ETKDG from RDKit (Landrum et al., 2013), are widely used for their efficiency, relying on chemical heuristics for fast generation. However, their performance is limited due to insufficient handling of non-bonded interactions and minimal energy optimization. To address this limitation, deep learning models have emerged as powerful alternatives, producing multiple conformations for molecules using generative models (Mansimov et al., 2019; Xu et al., 2021b;a; Luo et al., 2021; Shi et al., 2021b; Xu et al., 2022; Jing et al., 2022). Recently, the focus has shifted to predicting ground-state molecular conformations, which is critical for practical applications requiring stability and feasibility. A benchmark and training pipeline were introduced in Xu et al. (2021c) for this task, followed by the graph transformer (Xu et al., 2024), achieving state-of-the-art results."}, {"title": "7 CONCLUSION", "content": "Given the limitations of previous studies in modeling inter-atomic forces, we introduced REBIND, an innovative framework that incorporates force-aware edge augmentation to accurately capture inter-atomic interactions. We anticipate that REBIND can be extended to other critical applications such as drug discovery or property prediction, particularly in scenarios where ground-truth coordinates"}]}