{"title": "LoRaWAN Based Dynamic Noise Mapping with Machine Learning for Urban Noise Enforcement", "authors": ["H. Emre Erdem", "Henry Leung"], "abstract": "Abstract-Static noise maps depicting long-term noise levels over wide areas are valuable urban planning assets for municipalities in decreasing noise exposure of residents. However, non-traffic noise sources with transient behavior, which people complain frequently, are usually ignored by static maps. We propose here a dynamic noise mapping approach using the data collected via low-power wide-area network (LPWAN, specifically LoRaWAN) based internet of things (IoT) infrastructure, which is one of the most common communication backbones for smart cities. Noise mapping based on LPWAN is challenging due to the low data rates of these protocols. The proposed dynamic noise mapping approach diminishes the negative implications of data rate limitations using machine learning (ML) for event and location prediction of non-traffic sources based on the scarce data. The strength of these models lies in their consideration of the spatial variance in acoustic behavior caused by the buildings in urban settings. The effectiveness of the proposed method and the accuracy of the resulting dynamic maps are evaluated in field tests. The results show that the proposed system can decrease the map error caused by non-traffic sources up to 51% and can stay effective under significant packet losses.\nIndex Terms-Acoustic localization, IoT, LoRaWAN, noise mapping, noise monitoring, wireless sensor networks.", "sections": [{"title": "I. INTRODUCTION", "content": "OISE exposure is long proven to be a primary health problem due to its negative impacts on main body functions such as sleep, hearing, and mental capacity [1]. Thus, diminishing noise exposure plays a key role in improved quality of life. For this purpose, municipalities around the globe utilize noise management practices to constrain the exposure within healthy limits [2]. These practices include passive measures such as consideration of static traffic noise maps for new development plans as well as active noise enforcement measures such as elimination of noise limit violations.\nStatic (or strategic) noise maps used by passive measures depict noise levels of desired areas over extended periods (e.g. a year) [3]. These levels are calculated based on the methodological frameworks such as CNOSSOS-EU, CRTN, and sonROAD18 created by various government authorities [4]-[6]. Since static noise maps present noise levels over extended periods, their outputs represent only perpetual noise sources such as road traffic and industrial facilities and not the intermittent sources with random emergence at arbitrary locations such as construction, loud music or car alarm. However, these temporary non-traffic sources constitute a significant portion of civil noise complaints, rendering a more capable alternative to static noise maps essential for effective noise enforcement [7]. Moreover, relying on noise complaints to mitigate noise violations is a slow process. For these reasons, internet of things (IoT) based dynamic noise maps incorporating higher frequency noise level changes are sought for elevated noise enforcement capabilities.\nDynamic noise maps can be considered as collections of noise maps created at consecutive time steps with short intervals. At each time step, either a completely new map or a partial update to the previous map can be created based on the environmental parameters collected from a sensor network. No matter what method is used for map generation, existing dynamic mapping research focus on decreasing temporal error of traffic noise and omit the spatiotemporal error caused by non-traffic sources. As a result, the noise from non-traffic sources is either filtered out or incorrectly attributed to roads, damaging effectiveness of these maps for noise enforcement.\nTo have a dynamic noise map with a short time step for a low-cost city-wide noise monitoring system, low-power wide-area networks (LPWANs) can be used. Although LPWANS provide lower deployment and maintenance costs by eliminating tethered infrastructure via battery-powered wireless nodes, they limit communication data rates significantly. For example, LoRaWAN, the most frequently used LPWAN protocol, enables extremely long single-link communication ranges using its LoRa modulation technique in return for extremely low data rates [8]. Combined with hundreds of nodes having to share the same channel using ALOHA-like medium access, the rate and size of messages each node can transmit is significantly constrained to prevent collisions. Using only limited data available, estimation of non-traffic source locations on the dynamic map also becomes challenging.\nTo fill the gap for dynamic maps with non-traffic sources using LPWANs, this study proposes a dynamic mapping system with machine learning (ML) based acoustic localization to overcome the data rate limitation. The localization model uses only periodically transmitted 2-byte sound pressure level (SPL) readings and combines them with its prior knowledge of the acoustic behavior of the environment to predict the non-traffic source location. The final dynamic map is created as a joint visualization of traffic and non-traffic sources. The main contributions of this article can be listed as follows:\n\u2022\tA scalable LoRaWAN based dynamic noise mapping approach with non-traffic sources is proposed.\n\u2022\tAn ML based acoustic localization approach using simple SPL indicators to overcome the data rate limitations of LoRaWAN is provided."}, {"title": "II. RELATED WORK", "content": "Existing noise mapping literature can be grouped into simulation and measurement based approaches [9]. While simulation based approaches use computational methods to estimate noise levels, measurement based approaches use IoT technologies to collect measurements from acoustic sensors to generate a seamless noise level distribution over a wide region. Static noise maps are the most prominent examples of simulation based maps and their update interval of several years provide sufficient flexibility to execute time consuming acoustic simulations unsuitable for dynamic maps with frequent updates. Using the computational approach, the need to collect scattered SPL measurements are eliminated. Studies adopting this approach usually focus on improving the accuracy and computational efficiency of simulations [10]\u2013[12].\nOn the other hand, dynamic maps are enabled with measurement based approaches using the spatiotemporal information provided from distributed acoustic sensors.\nA unique IoT-based approach for noise data collection is crowdsensing where microphones and network capabilities of smartphones are used to measure and transmit SPL measurements for map generation [13], [14]. Although crowdsensing approaches eliminate the usage of a dedicated sensor network, calibration of microphones from different manufacturers and varying availability of up-to-date data may pose significant challenges. For example, [15] reports almost half of the users removing their application after using it only once. Moreover, privacy becomes a significant concern when users' accurate location information is attached to noise measurements [16].\nOn the other hand, dedicated acoustic sensor networks with cloud connectivity are used as a more robust IoT backbone for noise measurements, eliminating the shortcomings of crowdsensing in return for increased costs. However, existing noise mapping studies focus mostly on demonstrating their mapping techniques using pre-recorded measurements without considering the networking aspect [17]\u2013[19]. For example, [20] demonstrates the integration of SPL readings into static maps using measurements logged at eight locations without any loss of information. Similarly, Aumond et al. use SPL values recorded using a mobile measurement device that attaches position information to its logs [21]. Analyzing network conformity is another important aspect for effective evaluation of IoT-based mapping systems to demonstrate their feasibility in real world. While many noise monitoring studies prefer spatially sparse SPL values, they do not generate a map with fine-grained representation of noise levels.\nSeveral noise monitoring studies adopt commercial off-the-shelf IoT-compatible platforms such as Raspberry Pi and BeagleBone as their edge platform [22]\u2013[24]. Although these single-board computers provide elevated capabilities with low cost, their power consumption figures prevent long-term battery-powered operation as reported in [23] with a daily energy consumption of 43 Wh. Hence, [25] uses power over ethernet technology to jointly meet network and power requirements of the nodes. However, tethered infrastructures are usually not preferred due to their higher long-term costs.\nFor truly untethered IoT-based noise mapping/monitoring applications, low-power microcontroller based architectures with wireless communications are preferred. For this goal, various communication technologies such as WiFi, Zigbee, and LoRaWAN can be considered [26]\u2013[28]. While WiFi provides the highest data rates, its power consumption is also the highest, preventing long-term battery-powered operation. Zigbee on the other hand provides mediocre performance in both data rate and range, while LoRaWAN or another low-power wide-area network (LPWAN) protocol combines the longest range and low power consumption in return for low data rates [29]. For example, [30] reports triple the lifetime for their node with LoRaWAN compared to a similar node using WiFi. Thus, LoRaWAN usually becomes the first choice for non-data-hungry applications. Moreover, [31] shows that large datasets can be sent with LPWANs if divided into smaller pieces and sent over longer periods. In a different LoRaWAN based study, LoRa modulation is combined with their unique MAC protocol to enable multi-hop communication unlike the star topology of LoRaWAN when sending small-sized SPL and class label [32]. Similarly, [33] uses LoRaWAN to collect SPL measurements to redirect road traffic to decrease noise at noise-sensitive locations such as hospitals.\nNo matter which technology is used to transmit noise data, the assumptions on the collected data have a strong impact on the accuracy of generated maps. Hence, [19] uses a classifier to detect non-traffic noise events and discards audio signals containing these events in SPL calculation to leave traffic noise only for their intended map. Although they create event labels in situ, the manual process to remove non-traffic sources prior to SPL calculation prevents it from being realized as a real-time application. Conversely, other existing dynamic noise mapping approaches mostly assume contribution from non-traffic sources to noise levels to be negligible, limiting the variety of noise violation types against which dynamic noise maps can be used.\nFor a more effective noise enforcement, non-traffic noise sources should also be depicted on the map. Such a task is not trivial since the locations of non-traffic sources are arbitrary. To overcome this challenge, acoustic localization algorithms can be used to estimate the position of non-traffic sources [34]. These algorithms estimate source locations using indicators such as steered response power (SRP), direction of arrival (DoA), energy level, or time difference of arrival (TDoA). Due to data rate and energy budget limitations, these algorithms may not be realistic for microcontroller and LPWAN-based IoT systems.\nAmong the existing acoustic localization methods, energy based methods offer the lowest computational complexity at the edge nodes while requiring small amount of information transmission (i.e. energy level only). Least squares and"}, {"title": "III. SYSTEM OVERVIEW", "content": "In providing a low-cost LPWAN based dynamic noise mapping system, limited data rate of LPWANs poses a big challenge and the system must be designed to overcome this barrier. Our proposed system uses ML models to predict the specifications of the non-traffic noise sources on the dynamic map using sparsely transmitted small-sized SPL information from the end nodes. Since the acoustic behavior of outdoor environments may vary drastically due to the different sizes and shapes of physical objects such as buildings, which makes accurate location prediction difficult. Therefore, our proposed dynamic noise mapping system divides the application region into 250 m \u00d7 250 m areas and uses area-specific ML models to predict non-traffic noise events as well as their locations and SPLs. This way, ML models can learn the acoustic behavior of the specific environment during training, and non-traffic noise sources can be more accurately localized given small amount of SPL data, increasing LPWAN compatibility. Such bottom-up approach enables elevated scalability for cities at different sizes.\nIn the proposed approach, each area is monitored by nine sensor nodes and the data transmitted by the nodes are collected by multiple gateways. Each gateway covers a circular area with a radius of the gateway's communication distance $dgw$. The frequently used terms of region, cell, and area are visualized in Figure 1.\nFor LoRaWAN, although battery-powered nodes eliminate power infrastructure requirement, they may significantly increase maintenance costs if frequent battery replacements are needed. To keep power consumption low, the sensor nodes in our proposed system calculate only fast time weighted (LAF) and 15-minute long-term equivalent (LAeq,15min) A-weighted SPL values. These measurements constitute only 2 bytes in total and are transmitted with only 5 to 15-minute intervals (\u0394t). As a result, the transmission of these data consumes only between 0.36 to 0.84 bps of physical bitrate for each node when used with \u0394t = 15 minutes and DR0 or \u0394t = 5 minutes and DR3, respectively.\nTo extract useful information from the scarce sensor data, our system uses two ML models. While the first model predicts non-traffic noise events ($p$), the other predicts the properties (location and SPL, i.e. $\\hat{x}$, $\\hat{y}$, and $\\hat{I}$) if the first model returns positive. This way, computation requirements of the server are decreased by running the secondary model only when a non-traffic noise event exists. The predicted non-traffic source is integrated into the map after being simulated as a point source enabling the distinctive output of our system. An overview of our proposed approach is shown in Figure 2.\nWhen used against noise violations, the time until the dynamic map includes the new noise sources is an important metric. In addition to transmission interval, the lack of time synchronization among sensor nodes may contribute to this delay if packet arrivals from all the nodes are waited. Moreover, packet losses may cause SPL information temporarily unavailable. To overcome these issues, dynamic map update tasks are executed with a 1-minute interval using the latest measurements available to stay functional despite possibly lower output accuracy. This approach not only increases system robustness but also eliminates the need for acknowledgements, helping decrease network congestion by reducing the use of valuable downlink windows of LoRaWAN."}, {"title": "A. Sensor Node", "content": "To process acoustic signals and provide extended battery lifetime, we need to develop our own LoRaWAN acoustic sensor. These sensor nodes contain dual microcontrollers, stereo microphones, battery and LoRa transceiver as shown in Figure 3. All the tasks listed in Figure 4 are performed on the primary microcontroller while the more powerful secondary microcontroller and microphone are reserved for more complicated edge artificial intelligence (AI) functions for our future studies.\nThe MEMS microphones located under windscreens at the tip of the extended arms have an overload limit of 120 dB and provide digital audio signal using I2S protocol. Thanks to this protocol, nodes can easily switch between mono and stereo audio. Also, calibration is not mandatory thanks to the \u00b1 1 dB of sensitivity tolerance [47]. The nodes first sample audio signal $s_t$ at time t with a sampling rate of 31.25 kHz using direct memory access (DMA) for lower power consumption. $s_t$ contains 1024 samples which takes 4096 bytes in the memory as floating-point values. However, the default frequency response of the microphone does not fully lie within the specified tolerances of ANSI specifications for the targeted Type 2 sound level meters and requires an equalizer [48]. Hence, an equalizing filter with frequency-based gain is applied to move the response at non-conforming frequencies into the specified limits. In addition, an A-weighting filter is consecutively applied to better mimic the human perception of audio levels as required by most noise enforcement bylaws. These two filters are implemented in second-order recursive structure with minimal memory footprint. Following the filtering, LAF and Laeq are calculated using:\n$m_t^{lf} = 20 \\log_{10} (S_{RMS,t}/10^{(C_S/20)}) + C_{ST} + C_C$ (1)\n$m_t^{leq} = 10 \\log_{10} (\\frac{1}{N_h} \\sum_{i=t-N_h+1}^{t} 10^{(m_i^{lf}/10)})$ (2)\nwhere $C_S$, $C_{Sr}$, and $C_C$ represent microphone sensitivity, reference sensitivity, and calibration constants, respectively. In (2), T represents the preferred time duration for the long-term equivalence and $N_h$ represents the length of $m_t^{lf}$ storing historical LAF values measured within this duration. The calculated SPL measurements are within \u00b11 dB tolerance as tested in $LAeq, 1h$. Our system implementation adopts 15-minute $LAeq$ duration as a good trade-off between response latency and accuracy [20]. After the calculation of SPL indicators audio data is deleted, the indicators are transmitted as 1-byte integers if transmission interval is reached. Otherwise, the node goes to sleep for 15 seconds as a good tradeoff"}, {"title": "B. Machine Learning Models", "content": "1) Binary classifier model for non-traffic event detection: For event detection $\\hat{p}$, a binary classification model using a single long short-term memory (LSTM) layer with 100 units is used to utilize LSTMs' high capability in learning temporal changes. The only input feature is the change in the latest discrete $L_{Aeq}$ measurement at each node (i.e. $\\Delta m_t^{leq}$). These 9 differences are fed into the network as if they are part of a single feature over discrete time steps instead of individual features to eliminate the need to store historical values and simplify the model. The model is trained using an additional dropout layer with 0.5 rate and le-4 learning rate.\nTo save computational resources, the secondary model is executed only when this model predicts a non-traffic noise event. Hence, the correct representation of non-traffic source is only possible with high true positive rate of this model.\n2) Regression model for source property prediction: To predict properties (easting ($\\hat{x}$), northing ($\\hat{y}$), and level ($\\hat{I}$)) of the non-traffic source, a regression model using a dual-branch FNN is used. Different from the first ML model, the second ML model uses both LAF and LAeq foreground measurements fused via Kalman filter (KF) to combine the low latency of LAF and low variance of Laeq measurements. Here, the term foreground represents the values where background values are subtracted from the measured values (e.g. $m_t^{lf,fg} = m_t^{lf} - m_t^{lf,bg}$), with background levels representing the minimum levels observed at each sensor location.\nSince we are using cross-validation with leave-one-out method to evaluate the performance of the proposed system, a secondary set of features is needed to inform the model on the leave-one-out status. This way, the ambiguity on whether the measurement being 0 due to the long distance to the source or leave-one-out is eliminated. This extra set of features is called mask and is basically an indicator for the presence of the measurement. Mask value of zero means the respective measurement is reserved for cross-validation:\n$k_n = \\begin{cases} 0, & \\text{if node n is used for leave-one-out} \\\\ 1, & \\text{otherwise}. \\end{cases}$ (3)\nUsing two different groups of features, we adopt the dual-branch structure so that the network can learn distinct representations for each group before concatenating them. For this goal, each feature is connected to a layer of 320 neurons before concatenation. The resulting layer is connected to a hidden layer with 100 neurons before the final output layer. Between consecutive layers, a dropout rate of 0.2 is used to prevent overfitting. The model is trained using a learning rate of le-3."}, {"title": "C. Noise Map Generation", "content": "Our system utilizes individual noise maps for traffic and non-traffic sources before combining them for dynamic map iterations. Both traffic and non-traffic maps are generated using NoiseModelling simulation software [51]. While a traffic map uses multiple point sources representing the vehicles on roads, a non-traffic map uses single point source at the predicted location. Resulting vector maps are converted to 50 px \u00d7 50 px raster images using the nearest neighbor grid in QGIS software before they are combined [52]. Since our system divides an entire region into multiple areas, map generation is scripted to adapt different areas based on the coordinates given as parameters.\nTo embed area-specific acoustic behavior into ML models, each model is trained using noise maps generated for their target area. Since collecting high amount of real-world noise violation data is only theoretically possible due to strict legislation around such practice, simulated synthetic data is used in our training. Although this approach requires additional computation, it is a one-time preliminary process, and it decreases edge computing complexity enabling localization using only the SPL measurements.\nSince the LSTM model predicts non-traffic noise events, it is trained using a scenario where 500 non-traffic noise sources randomly emerge and disappear within the target area at different times. The output maps without reaching a mean value of 35 dB are discarded since they do not possess useful information for training. After the resulting map is combined with the base traffic map, $\\Delta m_t^{leq}$ values at node locations are extracted with a 1-minute interval.\nThe second ML model is trained using single-shot noise levels discarding the time domain. Random sources in 10,000 trials are used to simulate SPL at sensor nodes. The resulting maps are further augmented by adding Gaussian noise ($\\mathcal{Z} \\sim \\mathcal{N}(0, 1)$).\nFinally, the directivity of the simulated sources is randomized to prevent possible bias. The contribution of each frequency bin is randomized while dB magnitude of the directivity (v) for each frequency bin at a specific direction (\u03b8) is calculated using:\n$\\upsilon (\\theta, i_f) = 40 \\frac{|\\cos (\\theta) - 1|}{2i_f + 1}$ (4)\nwhere $i_f \\in \\{1, 2, ..., 7\\}$ represents frequency bin index for frequencies of {8000,4000,2000,1000,500,250,125} Hz, respectively. Generated random directivities are fed into NoiseModelling software to be used in simulations. Training, validation, and testing splits use 80%, 20%, and 20% of all the simulated map data, respectively."}, {"title": "D. LoRaWAN Communication", "content": "To evaluate system performance, the efficiency of the communication protocol represented as packet success rate (PSR) must be known. This study considers two factors affecting"}, {"title": "IV. EXPERIMENTAL RESULTS", "content": "The performance of our proposed system in reducing the error caused by non-traffic source is evaluated in field tests using a speaker shown in Figure 5 positioned at 6 random locations within the selected application area. In each test, the same music tracks were played for 15 minutes with the same order with the sound level of around 100 dBA. The reason for such duration is to focus on the entire transitional period of the selected SPL indicator (i.e. $L_{Aeq,15m}$). Each test was followed by a 15-minute break so that the $L_{Aeq}$ measurements can settle back to background levels and allow the equipment to be moved to the next location."}, {"title": "V. CONCLUSION", "content": "In this paper, we propose a LoRaWAN based dynamic map for urban noise monitoring. We develop a novel Lo-RaWAN acoustic sensor with edge AI capability. Realization of dynamic noise mapping with non-traffic sources is shown to be possible for LoRaWAN when ML models are utilized to extract useful information from sparsely transmitted data. Using experimental data, the proposed system is found to stay operational under high packet collisions when sparse gateway deployment and frequent transmissions are preferred. The impact of channel model on this LoRaWAN IoT noise monitoring system is also analyzed.\nOur future work is planned to provide improvements to the localization and map error reduction performance using edge ML models while preserving the compatibility with LPWANS."}]}