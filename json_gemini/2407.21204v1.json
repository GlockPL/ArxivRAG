{"title": "LoRaWAN Based Dynamic Noise Mapping with Machine Learning for Urban Noise Enforcement", "authors": ["H. Emre Erdem", "Henry Leung"], "abstract": "Abstract-Static noise maps depicting long-term noise levels\nover wide areas are valuable urban planning assets for mu-\nnicipalities in decreasing noise exposure of residents. However,\nnon-traffic noise sources with transient behavior, which people\ncomplain frequently, are usually ignored by static maps. We\npropose here a dynamic noise mapping approach using the data\ncollected via low-power wide-area network (LPWAN, specifically\nLoRaWAN) based internet of things (IoT) infrastructure, which\nis one of the most common communication backbones for smart\ncities. Noise mapping based on LPWAN is challenging due to\nthe low data rates of these protocols. The proposed dynamic\nnoise mapping approach diminishes the negative implications of\ndata rate limitations using machine learning (ML) for event and\nlocation prediction of non-traffic sources based on the scarce\ndata. The strength of these models lies in their consideration of\nthe spatial variance in acoustic behavior caused by the buildings\nin urban settings. The effectiveness of the proposed method and\nthe accuracy of the resulting dynamic maps are evaluated in field\ntests. The results show that the proposed system can decrease the\nmap error caused by non-traffic sources up to 51% and can stay\neffective under significant packet losses.", "sections": [{"title": "I. INTRODUCTION", "content": "OISE exposure is long proven to be a primary health\nproblem due to its negative impacts on main body\nfunctions such as sleep, hearing, and mental capacity [1].\nThus, diminishing noise exposure plays a key role in improved\nquality of life. For this purpose, municipalities around the\nglobe utilize noise management practices to constrain the\nexposure within healthy limits [2]. These practices include pas-\nsive measures such as consideration of static traffic noise maps\nfor new development plans as well as active noise enforcement\nmeasures such as elimination of noise limit violations.\nStatic (or strategic) noise maps used by passive measures\ndepict noise levels of desired areas over extended periods\n(e.g. a year) [3]. These levels are calculated based on the\nmethodological frameworks such as CNOSSOS-EU, CRTN,\nand sonROAD18 created by various government authorities\n[4]\u2013[6]. Since static noise maps present noise levels over\nextended periods, their outputs represent only perpetual noise\nsources such as road traffic and industrial facilities and not\nthe intermittent sources with random emergence at arbitrary\nlocations such as construction, loud music or car alarm.\nHowever, these temporary non-traffic sources constitute a\nsignificant portion of civil noise complaints, rendering a more\ncapable alternative to static noise maps essential for effective\nnoise enforcement [7]. Moreover, relying on noise complaints\nto mitigate noise violations is a slow process. For these\nreasons, internet of things (IoT) based dynamic noise maps\nincorporating higher frequency noise level changes are sought\nfor elevated noise enforcement capabilities.\nDynamic noise maps can be considered as collections\nof noise maps created at consecutive time steps with short\nintervals. At each time step, either a completely new map or\na partial update to the previous map can be created based on\nthe environmental parameters collected from a sensor network.\nNo matter what method is used for map generation, existing\ndynamic mapping research focus on decreasing temporal error\nof traffic noise and omit the spatiotemporal error caused by\nnon-traffic sources. As a result, the noise from non-traffic\nsources is either filtered out or incorrectly attributed to roads,\ndamaging effectiveness of these maps for noise enforcement.\nTo have a dynamic noise map with a short time step for a\nlow-cost city-wide noise monitoring system, low-power wide-\narea networks (LPWANs) can be used. Although LPWANS\nprovide lower deployment and maintenance costs by eliminat-\ning tethered infrastructure via battery-powered wireless nodes,\nthey limit communication data rates significantly. For example,\nLoRaWAN, the most frequently used LPWAN protocol, en-\nables extremely long single-link communication ranges using\nits LoRa modulation technique in return for extremely low data\nrates [8]. Combined with hundreds of nodes having to share\nthe same channel using ALOHA-like medium access, the rate\nand size of messages each node can transmit is significantly\nconstrained to prevent collisions. Using only limited data\navailable, estimation of non-traffic source locations on the\ndynamic map also becomes challenging.\nTo fill the gap for dynamic maps with non-traffic sources\nusing LPWANs, this study proposes a dynamic mapping sys-\ntem with machine learning (ML) based acoustic localization\nto overcome the data rate limitation. The localization model\nuses only periodically transmitted 2-byte sound pressure level\n(SPL) readings and combines them with its prior knowledge\nof the acoustic behavior of the environment to predict the non-\ntraffic source location. The final dynamic map is created as a\njoint visualization of traffic and non-traffic sources. The main\ncontributions of this article can be listed as follows:\n\u2022 A scalable LoRaWAN based dynamic noise mapping\napproach with non-traffic sources is proposed.\n\u2022 An ML based acoustic localization approach using simple\nSPL indicators to overcome the data rate limitations of\nLoRaWAN is provided."}, {"title": "II. RELATED WORK", "content": "Existing noise mapping literature can be grouped into\nsimulation and measurement based approaches [9]. While\nsimulation based approaches use computational methods to\nestimate noise levels, measurement based approaches use IoT\ntechnologies to collect measurements from acoustic sensors\nto generate a seamless noise level distribution over a wide\nregion. Static noise maps are the most prominent examples\nof simulation based maps and their update interval of several\nyears provide sufficient flexibility to execute time consuming\nacoustic simulations unsuitable for dynamic maps with fre-\nquent updates. Using the computational approach, the need\nto collect scattered SPL measurements are eliminated. Studies\nadopting this approach usually focus on improving the accu-\nracy and computational efficiency of simulations [10]\u2013[12].\nOn the other hand, dynamic maps are enabled with measure-\nment based approaches using the spatiotemporal information\nprovided from distributed acoustic sensors.\nA unique IoT-based approach for noise data collection is\ncrowdsensing where microphones and network capabilities of\nsmartphones are used to measure and transmit SPL measure-\nments for map generation [13], [14]. Although crowdsensing\napproaches eliminate the usage of a dedicated sensor network,\ncalibration of microphones from different manufacturers and\nvarying availability of up-to-date data may pose significant\nchallenges. For example, [15] reports almost half of the users\nremoving their application after using it only once. Moreover,\nprivacy becomes a significant concern when users' accurate\nlocation information is attached to noise measurements [16].\nOn the other hand, dedicated acoustic sensor networks with\ncloud connectivity are used as a more robust IoT backbone\nfor noise measurements, eliminating the shortcomings of\ncrowdsensing in return for increased costs. However, existing\nnoise mapping studies focus mostly on demonstrating their\nmapping techniques using pre-recorded measurements without\nconsidering the networking aspect [17]\u2013[19]. For example,\n[20] demonstrates the integration of SPL readings into static\nmaps using measurements logged at eight locations without\nany loss of information. Similarly, Aumond et al. use SPL\nvalues recorded using a mobile measurement device that at-\ntaches position information to its logs [21]. Analyzing network\nconformity is another important aspect for effective evaluation\nof IoT-based mapping systems to demonstrate their feasibility\nin real world. While many noise monitoring studies prefer\nspatially sparse SPL values, they do not generate a map with\nfine-grained representation of noise levels.\nSeveral noise monitoring studies adopt commercial off-\nthe-shelf IoT-compatible platforms such as Raspberry Pi and\nBeagleBone as their edge platform [22]\u2013[24]. Although these\nsingle-board computers provide elevated capabilities with\nlow cost, their power consumption figures prevent long-term\nbattery-powered operation as reported in [23] with a daily\nenergy consumption of 43 Wh. Hence, [25] uses power\nover ethernet technology to jointly meet network and power\nrequirements of the nodes. However, tethered infrastructures\nare usually not preferred due to their higher long-term costs.\nFor truly untethered IoT-based noise mapping/monitoring\napplications, low-power microcontroller based architectures\nwith wireless communications are preferred. For this goal,\nvarious communication technologies such as WiFi, Zigbee,\nand LoRaWAN can be considered [26]\u2013[28]. While WiFi\nprovides the highest data rates, its power consumption is also\nthe highest, preventing long-term battery-powered operation.\nZigbee on the other hand provides mediocre performance in\nboth data rate and range, while LoRaWAN or another low-\npower wide-area network (LPWAN) protocol combines the\nlongest range and low power consumption in return for low\ndata rates [29]. For example, [30] reports triple the lifetime\nfor their node with LoRaWAN compared to a similar node\nusing WiFi. Thus, LoRaWAN usually becomes the first choice\nfor non-data-hungry applications. Moreover, [31] shows that\nlarge datasets can be sent with LPWANs if divided into smaller\npieces and sent over longer periods. In a different LoRaWAN\nbased study, LoRa modulation is combined with their unique\nMAC protocol to enable multi-hop communication unlike the\nstar topology of LoRaWAN when sending small-sized SPL\nand class label [32]. Similarly, [33] uses LoRaWAN to collect\nSPL measurements to redirect road traffic to decrease noise at\nnoise-sensitive locations such as hospitals.\nNo matter which technology is used to transmit noise data,\nthe assumptions on the collected data have a strong impact on\nthe accuracy of generated maps. Hence, [19] uses a classifier\nto detect non-traffic noise events and discards audio signals\ncontaining these events in SPL calculation to leave traffic\nnoise only for their intended map. Although they create event\nlabels in situ, the manual process to remove non-traffic sources\nprior to SPL calculation prevents it from being realized as a\nreal-time application. Conversely, other existing dynamic noise\nmapping approaches mostly assume contribution from non-\ntraffic sources to noise levels to be negligible, limiting the\nvariety of noise violation types against which dynamic noise\nmaps can be used.\nFor a more effective noise enforcement, non-traffic noise\nsources should also be depicted on the map. Such a task is not\ntrivial since the locations of non-traffic sources are arbitrary.\nTo overcome this challenge, acoustic localization algorithms\ncan be used to estimate the position of non-traffic sources [34].\nThese algorithms estimate source locations using indicators\nsuch as steered response power (SRP), direction of arrival\n(DoA), energy level, or time difference of arrival (TDoA). Due\nto data rate and energy budget limitations, these algorithms\nmay not be realistic for microcontroller and LPWAN-based\nIoT systems.\nAmong the existing acoustic localization methods, energy\nbased methods offer the lowest computational complexity at\nthe edge nodes while requiring small amount of informa-\ntion transmission (i.e. energy level only). Least squares and"}, {"title": "III. SYSTEM OVERVIEW", "content": "In providing a low-cost LPWAN based dynamic noise\nmapping system, limited data rate of LPWANs poses a big\nchallenge and the system must be designed to overcome this\nbarrier. Our proposed system uses ML models to predict the\nspecifications of the non-traffic noise sources on the dynamic\nmap using sparsely transmitted small-sized SPL information\nfrom the end nodes. Since the acoustic behavior of outdoor\nenvironments may vary drastically due to the different sizes\nand shapes of physical objects such as buildings, which makes\naccurate location prediction difficult. Therefore, our proposed\ndynamic noise mapping system divides the application region\ninto 250 m \u00d7 250 m areas and uses area-specific ML models\nto predict non-traffic noise events as well as their locations and\nSPLs. This way, ML models can learn the acoustic behavior of\nthe specific environment during training, and non-traffic noise\nsources can be more accurately localized given small amount\nof SPL data, increasing LPWAN compatibility. Such bottom-\nup approach enables elevated scalability for cities at different\nsizes.\nIn the proposed approach, each area is monitored by nine\nsensor nodes and the data transmitted by the nodes are\ncollected by multiple gateways. Each gateway covers a circular\narea with a radius of the gateway's communication distance\ndgw. The frequently used terms of region, cell, and area are\nvisualized in Figure 1.\nFor LoRaWAN, although battery-powered nodes eliminate\npower infrastructure requirement, they may significantly in-\ncrease maintenance costs if frequent battery replacements are\nneeded. To keep power consumption low, the sensor nodes in\nour proposed system calculate only fast time weighted (LAF)\nand 15-minute long-term equivalent (LAeq,15min) A-weighted\nSPL values. These measurements constitute only 2 bytes in\ntotal and are transmitted with only 5 to 15-minute intervals\n(At). As a result, the transmission of these data consumes\nonly between 0.36 to 0.84 bps of physical bitrate for each\nnode when used with At = 15 minutes and DR0 or At = 5\nminutes and DR3, respectively.\nTo extract useful information from the scarce sensor data,\nour system uses two ML models. While the first model predicts\nnon-traffic noise events (p), the other predicts the properties\n(location and SPL, i.e. \u0129, \u0177, and \u00ce) if the first model returns\npositive. This way, computation requirements of the server are\ndecreased by running the secondary model only when a non-\ntraffic noise event exists. The predicted non-traffic source is\nintegrated into the map after being simulated as a point source\nenabling the distinctive output of our system. An overview of\nour proposed approach is shown in Figure 2.\nWhen used against noise violations, the time until the\ndynamic map includes the new noise sources is an important\nmetric. In addition to transmission interval, the lack of time\nsynchronization among sensor nodes may contribute to this\ndelay if packet arrivals from all the nodes are waited. More-\nover, packet losses may cause SPL information temporarily\nunavailable. To overcome these issues, dynamic map update\ntasks are executed with a 1-minute interval using the latest\nmeasurements available to stay functional despite possibly\nlower output accuracy. This approach not only increases sys-\ntem robustness but also eliminates the need for acknowledge-\nments, helping decrease network congestion by reducing the\nuse of valuable downlink windows of LoRaWAN.\nIt is noted that as a result, each area can have at most one\nnon-traffic noise source at a time. Considering the size of an\narea, the probability of this assumption being violated should\nbe very low and can be omitted. Alternatively, the size of the\nareas can be shrunk until this assumption is fully satisfied.\nWe make the sizes of our ML models small so that running\nthe models with a 1-minute interval for small regions can be\ncarried out by regular computers. If city-wide coverage with\nhundreds of areas and 1-minute update interval is desired, a\npowerful server can be used. It is noted that the power required\nfor the proposed system is much less than those mapping\nsystems with complete simulations."}, {"title": "A. Sensor Node", "content": "To process acoustic signals and provide extended battery\nlifetime, we need to develop our own LoRaWAN acoustic\nsensor. These sensor nodes contain dual microcontrollers,\nstereo microphones, battery and LoRa transceiver as shown\nin Figure 3. All the tasks listed in Figure 4 are performed\non the primary microcontroller while the more powerful sec-\nondary microcontroller and microphone are reserved for more\ncomplicated edge artificial intelligence (AI) functions for our\nfuture studies.\nThe MEMS microphones located under windscreens at the\ntip of the extended arms have an overload limit of 120 dB\nand provide digital audio signal using I2S protocol. Thanks\nto this protocol, nodes can easily switch between mono and\nstereo audio. Also, calibration is not mandatory thanks to the\n\u00b1 1 dB of sensitivity tolerance [47]. The nodes first sample\naudio signal st at time t with a sampling rate of 31.25\nkHz using direct memory access (DMA) for lower power\nconsumption. st contains 1024 samples which takes 4096\nbytes in the memory as floating-point values. However, the\ndefault frequency response of the microphone does not fully lie\nwithin the specified tolerances of ANSI specifications for the\ntargeted Type 2 sound level meters and requires an equalizer\n[48]. Hence, an equalizing filter with frequency-based gain is\napplied to move the response at non-conforming frequencies\ninto the specified limits. In addition, an A-weighting filter is\nconsecutively applied to better mimic the human perception of\naudio levels as required by most noise enforcement bylaws.\nThese two filters are implemented in second-order recursive\nstructure with minimal memory footprint. Following the fil-\ntering, LAF and Laeq are calculated using:\n$m_{t}^{lf} = 20 log_{10} \\left(SRMS,t \\cdot (SRMS,t/10^{(Cs/20)}) \\right) + CST + CC$ (1)\n$m_{t}^{leq} = 10 log_{10} \\left(\\frac{1}{N_{h}} \\sum_{i=t-N_{h}+1}^{t} 10^{(m_{i}^{lf}/10)}\\right)$ (2)\nwhere Cs, Csr, and Cc represent microphone sensitivity, ref-\nerence sensitivity, and calibration constants, respectively. In\n(2), T represents the preferred time duration for the long-\nterm equivalence and Nh represents the length of $m_{t}^{lf}$ storing\nhistorical LAF values measured within this duration. The\ncalculated SPL measurements are within \u00b11 dB tolerance as\ntested in LAeq, 1h. Our system implementation adopts 15-minute\nLAeq duration as a good trade-off between response latency\nand accuracy [20]. After the calculation of SPL indicators\naudio data is deleted, the indicators are transmitted as 1-\nbyte integers if transmission interval is reached. Otherwise,\nthe node goes to sleep for 15 seconds as a good tradeoff"}, {"title": "B. Machine Learning Models", "content": "1) Binary classifier model for non-traffic event detection:\nFor event detection \u00f4, a binary classification model using a\nsingle long short-term memory (LSTM) layer with 100 units\nis used to utilize LSTMs' high capability in learning temporal\nchanges. The only input feature is the change in the latest\ndiscrete Laeq measurement at each node (i.e. $\\Delta m_{t}^{leq}$). These\n9 differences are fed into the network as if they are part of\na single feature over discrete time steps instead of individual\nfeatures to eliminate the need to store historical values and\nsimplify the model. The model is trained using an additional\ndropout layer with 0.5 rate and le-4 learning rate.\nTo save computational resources, the secondary model is\nexecuted only when this model predicts a non-traffic noise\nevent. Hence, the correct representation of non-traffic source\nis only possible with high true positive rate of this model.\n2) Regression model for source property prediction: To\npredict properties (easting (\u0129), northing (\u0177), and level (\u00ce))\nof the non-traffic source, a regression model using a dual-\nbranch FNN is used. Different from the first ML model,\nthe second ML model uses both LAF and LAeq foreground\nmeasurements fused via Kalman filter (KF) to combine the\nlow latency of LAF and low variance of Laeq measurements.\nHere, the term foreground represents the values where back-\nground values are subtracted from the measured values (e.g.\n$m_{t}^{lf,fg} = m_{t}^{lf} - m_{t}^{lf,bg}$), with background levels representing\nthe minimum levels observed at each sensor location.\nSince we are using cross-validation with leave-one-out\nmethod to evaluate the performance of the proposed system, a\nsecondary set of features is needed to inform the model on the\nleave-one-out status. This way, the ambiguity on whether the\nmeasurement being 0 due to the long distance to the source\nor leave-one-out is eliminated. This extra set of features is\ncalled mask and is basically an indicator for the presence of\nthe measurement. Mask value of zero means the respective\nmeasurement is reserved for cross-validation:\n$k_{n} = \\begin{cases}\n0, & \\text{if node n is used for leave-one-out} \\\\\n1, & \\text{otherwise}.\n\\end{cases}$ (3)\nUsing two different groups of features, we adopt the dual-\nbranch structure so that the network can learn distinct rep-\nresentations for each group before concatenating them. For\nthis goal, each feature is connected to a layer of 320 neurons\nbefore concatenation. The resulting layer is connected to a\nhidden layer with 100 neurons before the final output layer.\nBetween consecutive layers, a dropout rate of 0.2 is used to"}, {"title": "C. Noise Map Generation", "content": "Our system utilizes individual noise maps for traffic and\nnon-traffic sources before combining them for dynamic map\niterations. Both traffic and non-traffic maps are generated using\nNoiseModelling simulation software [51]. While a traffic map\nuses multiple point sources representing the vehicles on roads,\na non-traffic map uses single point source at the predicted\nlocation. Resulting vector maps are converted to 50 px \u00d7 50\npx raster images using the nearest neighbor grid in QGIS\nsoftware before they are combined [52]. Since our system\ndivides an entire region into multiple areas, map generation\nis scripted to adapt different areas based on the coordinates\ngiven as parameters.\nTo embed area-specific acoustic behavior into ML models,\neach model is trained using noise maps generated for their\ntarget area. Since collecting high amount of real-world noise\nviolation data is only theoretically possible due to strict leg-\nislation around such practice, simulated synthetic data is used\nin our training. Although this approach requires additional\ncomputation, it is a one-time preliminary process, and it\ndecreases edge computing complexity enabling localization\nusing only the SPL measurements.\nSince the LSTM model predicts non-traffic noise events,\nit is trained using a scenario where 500 non-traffic noise\nsources randomly emerge and disappear within the target area\nat different times. The output maps without reaching a mean\nvalue of 35 dB are discarded since they do not possess useful\ninformation for training. After the resulting map is combined\nwith the base traffic map, $\\Delta m_{t}^{leq}$ values at node locations are\nextracted with a 1-minute interval.\nThe second ML model is trained using single-shot noise\nlevels discarding the time domain. Random sources in 10,000\ntrials are used to simulate SPL at sensor nodes. The resulting\nmaps are further augmented by adding Gaussian noise (Z ~\nN(0, 1)).\nFinally, the directivity of the simulated sources is ran-\ndomized to prevent possible bias. The contribution of each\nfrequency bin is randomized while dB magnitude of the\ndirectivity (\u03c5) for each frequency bin at a specific direction\n(\u03b8) is calculated using:\n$\\upsilon(\\theta, i_{f}) = 40 \\cdot \\left(\\frac{cos(\\theta) - 1}{2i_{f}+1}\\right)$ (4)\nwhere $i_{f} \\in \\{1,2,...,7\\}$ represents frequency bin index for fre-\nquencies of {8000,4000,2000,1000,500,250,125} Hz, respec-\ntively. Generated random directivities are fed into NoiseMod-\nelling software to be used in simulations. Training, validation,\nand testing splits use 80%, 20%, and 20% of all the simulated\nmap data, respectively."}, {"title": "D. LoRaWAN Communication", "content": "To evaluate system performance, the efficiency of the com-\nmunication protocol represented as packet success rate (PSR)\nmust be known. This study considers two factors affecting"}, {"title": "IV. EXPERIMENTAL RESULTS", "content": "The performance of our proposed system in reducing the\nerror caused by non-traffic source is evaluated in field tests\nusing a speaker shown in Figure 5 positioned at 6 random\nlocations within the selected application area. In each test, the\nsame music tracks were played for 15 minutes with the same\norder with the sound level of around 100 dBA. The reason"}, {"title": "V. CONCLUSION", "content": "In this paper, we propose a LoRaWAN based dynamic\nmap for urban noise monitoring. We develop a novel Lo-\nRaWAN acoustic sensor with edge AI capability. Realization\nof dynamic noise mapping with non-traffic sources is shown\nto be possible for LoRaWAN when ML models are utilized\nto extract useful information from sparsely transmitted data.\nUsing experimental data, the proposed system is found to\nstay operational under high packet collisions when sparse\ngateway deployment and frequent transmissions are preferred.\nThe impact of channel model on this LoRaWAN IoT noise\nmonitoring system is also analyzed.\nOur future work is planned to provide improvements to the\nlocalization and map error reduction performance using edge\nML models while preserving the compatibility with LPWANS."}]}