{"title": "Exploring Machine Learning Models for Lung Cancer Level Classification: A comparative ML Approach", "authors": ["Mohsen Asghari Ilani", "Saba Moftakhar Tehran", "Ashkan Kavei", "Hamed Alizadegan"], "abstract": "This paper explores machine learning (ML) models for classifying lung cancer levels to improve diagnostic accuracy and prognosis. Through parameter tuning and rigorous evaluation, we assess various ML algorithms. Techniques like minimum child weight and learning rate monitoring were used to reduce overfitting and optimize performance. Our findings highlight the robust performance of Deep Neural Network (DNN) models across all phases. Ensemble methods, including voting and bagging, also showed promise in enhancing predictive accuracy and robustness. However, Support Vector Machine (SVM) models with the Sigmoid kernel faced challenges, indicating a need for further refinement. Overall, our study provides insights into ML-based lung cancer classification, emphasizing the importance of parameter tuning to optimize model performance and improve diagnostic accuracy in oncological care.", "sections": [{"title": "Introduction", "content": "Lung cancer stands as the leading cause of cancer-related fatalities globally, often originating in the windpipe, main airway, or lungs due to unchecked cell growth and spread. Factors such as lung disease history, tobacco usage, exposure to pollutants, and workplace chemicals contribute to its prevalence. Primary lung cancer begins in the lungs, while secondary lung cancer spreads from other parts of the body [1]. The tumor's size and spread determine its stage, ranging from early-stage, localized tumors to advanced tumors invading surrounding tissues or distant organs. Early detection is crucial for improving survival rates, highlighting the significance of using machine learning techniques to enhance the efficiency of diagnosis[2]. In recent years, lung cancer has remained a major health concern worldwide, particularly in regions like China, where it ranks highest in cancer incidence [3-5]. Despite advancements, the 5-year survival rate for lung cancer patients remains low, emphasizing the importance of early diagnosis. Metabolomics studies offer insights into metabolic pathways regulating tumor progression, aiding in distinguishing tumor stages and types [6]. Artificial intelligence, particularly machine learning, has revolutionized cancer research by efficiently analyzing extensive datasets and improving prognostic prediction models. Various studies have explored the application of machine learning algorithms in lung cancer detection, achieving promising results [7]. Recent research has demonstrated the efficacy of machine learning algorithms in lung cancer detection and classification[8]. Studies have explored various classification models, including decision trees, support vector machines[9], neural networks[10], and ensemble methods[11], achieving high accuracy rates. Combining machine learning with metabolomics has shown promise in identifying biomarkers for early-stage lung cancer diagnosis [12]. By integrating these approaches, we strive to contribute to the advancement of early detection methods, ultimately improving patient outcomes in the fight against lung cancer [9, 13]. Ahmadi et al. developed an algorithm using U-Net and pretrained SAM architectures to segment tumor regions in breast ultrasound and mammographic images. The U-Net model excelled, particularly in complex cases, outperforming SAM in accuracy and handling tumors with irregular shapes and vague boundaries. Ahmadi et al. [18] develops a supervised machine learning architecture for classifying and segmenting diverse geographical terrains into multiple classes such as water, grassland, and forest using digital twin technology in coastal regions. Danandeh Mehr et al. [19] introduced the VMD-GP model, a new evolutionary approach for drought prediction in ungauged catchments, which utilizes variational mode decomposition with genetic programming to improve forecasting accuracy from global data sources. Rahimi et al. (2023) [20] applied machine learning (ML) feature analysis to a broad spectrum of neurocognitive symptoms specific to individuals with Parkinson's Disease (PD), with the goal of modernizing and individualizing the staging process of the disease. Farhadi Nia et al. [21] examine the impact of Large Language Models like OpenAI's ChatGPT on dental diagnostics. Their research highlights ChatGPT-4's potential to improve diagnosis, patient communication, and clinical efficiency in oral surgery, while also discussing broader implications for healthcare and academia. Ahmadi et al. [22] propose a deeply supervised adaptable neural network that classifies Alzheimer's disease severity into four levels using MRI images, demonstrating enhanced diagnostic accuracy through multitask feature extraction. Templeton et al. (2024) [23] conducted a study on the complex nature of Parkinson's Disease (PD) and the challenges in assessing and monitoring its clinical progression. Ahmadi et al. [24] Utilized a U-Net network, the study demonstrates high accuracy in crack classification and provides insights into improving U-Net model for segmentation."}, {"title": "Materials and Methods", "content": "lung cancer prediction using machine learning poses formidable challenges, primarily stemming from the diversity and imbalance inherent in datasets sourced globally. To tackle this issue, our study employed a meticulous data aggregation strategy, drawing upon diverse public datasets shared by esteemed organizations such as the World Health Organization (WHO), Kaggle, and Google datasets. By leveraging these rich and varied sources, we aimed to curate a comprehensive dataset representative of diverse geographical regions and clinical scenarios. This approach not only facilitated the development of robust machine learning models but also ensured the generalizability and applicability of our findings across different populations and healthcare settings [1, 8, 14]. Moreover, the utilization of public datasets underscores the collaborative ethos of modern scientific research, fostering knowledge sharing and innovation within the scientific community. By harnessing the collective expertise and resources available through these platforms, we were able to augment the quality and breadth of our dataset, thereby enhancing the reliability and utility of our machine learning models for lung cancer prediction. Looking ahead, continued collaboration and data sharing initiatives are essential for advancing the field of oncological diagnostics and improving patient care outcomes. By collectively addressing challenges such as dataset diversity and imbalance, we can pave the way for more accurate and personalized approaches to lung cancer detection and prognosis, ultimately leading to better health outcomes for patients worldwide."}, {"title": "Dataset", "content": "The collected datasets underwent rigorous cleaning and preprocessing to establish meaningful relationships between features and target variables. The features included in the dataset are:\n\u2022\nPatient Id: Unique identifier for each patient, not directly related to lung cancer.\n\u2022\nAge: Advanced age is a significant risk factor for lung cancer, with incidence increasing as individuals get older.\n\u2022\nGender: Lung cancer incidence is higher in males than females, primarily due to higher rates of smoking among men historically.\n\u2022\nAir Pollution: Prolonged exposure to air pollution, especially particulate matter and pollutants like nitrogen dioxide and sulfur dioxide, increases the risk of developing lung cancer.\n\u2022\nAlcohol use: Heavy alcohol consumption is linked to a higher risk of lung cancer, particularly when combined with tobacco smoking.\n\u2022\nDust Allergy: Allergies to dust may exacerbate respiratory symptoms but are not directly linked to lung cancer development.\n\u2022\nOccupational Hazards: Exposure to occupational carcinogens such as asbestos, silica, arsenic, and certain chemicals increases the risk of lung cancer.\n\u2022\nGenetic Risk: Family history of lung cancer or genetic predispositions can elevate the likelihood of developing the disease.\n\u2022\nChronic Lung Disease: Pre-existing chronic lung conditions like chronic obstructive pulmonary disease (COPD) or emphysema heighten the risk of lung cancer.\n\u2022\nBalanced Diet: A diet rich in fruits, vegetables, and antioxidants may lower the risk of lung cancer, while a poor diet may increase susceptibility.\n\u2022\nObesity: Obesity is associated with an increased risk of lung cancer, although the exact mechanism is not fully understood.\n\u2022\nSmoking: Tobacco smoking is the leading cause of lung cancer, responsible for the majority of cases worldwide.\n\u2022\nPassive Smoker: Exposure to secondhand smoke increases the risk of lung cancer, particularly in nonsmokers.\n\u2022\nChest Pain: Chest pain can be a symptom of lung cancer, especially if it persists or worsens over time.\n\u2022\nCoughing of Blood: Hemoptysis (coughing up blood) is a common symptom of advanced lung cancer.\n\u2022\nFatigue: Fatigue is a common symptom of lung cancer, often caused by the disease itself or the side effects of treatment.\n\u2022\nWeight Loss: Unexplained weight loss can be a sign of advanced lung cancer or cancer cachexia.\n\u2022\nShortness of Breath: Dyspnea (shortness of breath) is a common symptom of lung cancer, particularly as the disease progresses.\n\u2022\nWheezing: Wheezing can occur in lung cancer patients, especially if tumors obstruct the airways.\n\u2022\nSwallowing Difficulty: Difficulty swallowing (dysphagia) may occur if lung cancer spreads to nearby structures or lymph nodes.\n\u2022\nClubbing of Finger Nails: Clubbing of the fingers, where the nails curve excessively, can be a sign of advanced lung cancer.\n\u2022\nFrequent Cold: Frequent respiratory infections or colds may be a symptom of an underlying lung condition, including lung cancer.\n\u2022\nDry Cough: A persistent dry cough can be a symptom of lung cancer, especially if it lasts for several weeks.\n\u2022\nSnoring: While snoring itself is not directly linked to lung cancer, it may be a sign of obstructive sleep apnea, which has been associated with an increased risk of cancer development.\nThe target variable is lung cancer level, categorized into three stages: low, medium, and high."}, {"title": "ML Models", "content": "Six machine learning models were employed for lung cancer prediction:\n\u2022\nDeep Neural Network (DNN)\n\u2022\nVoting\n\u2022\nBagging\n\u2022\nSupport Vector Machine (SVC) with radial basis function kernel (SVC_rbf)\n\u2022\nSVC with linear kernel (SVC_linear)\n\u2022\nSVC with polynomial kernel (SVC_polynomial)\n\u2022\nSVC with sigmoid kernel (SVC_sigmoid)\nEach of these models was carefully selected to ensure comprehensive coverage and robust prediction capabilities.\nDeep Neural Networks (DNN)\nDeep Neural Networks (DNNs) represent a class of artificial neural networks distinguished by their numerous hidden layers positioned between the input and output layers. These networks excel at capturing intricate patterns and correlations within data, particularly in scenarios involving high-dimensional input data such as images, audio, and text [13]. Leveraging deep architectures, DNNs autonomously learn hierarchical representations of features, enabling them to effectively discern between various classes within the dataset [4, 5, 15, 16].\nVoting Classifier\nThe Voting Classifier operates by amalgamating predictions from multiple individual classifiers to produce a final prediction. It consolidates the decisions made by each classifier and selects the class with the most votes as the predicted outcome. This ensemble approach typically yields enhanced performance compared to individual classifiers by leveraging the diverse viewpoints provided by multiple models.\nBagging (Bootstrap Aggregating)\nBagging, short for Bootstrap Aggregating, is an ensemble learning technique that entails training multiple instances of the same base classifier on different subsets of the training data. The final prediction is usually derived by averaging the predictions generated by all individual classifiers. Bagging serves to diminish variance and mitigate overfitting by introducing randomness into the training process and fostering model diversity [17]. Support Vector Machines (SVMs) are potent supervised learning models utilized for classification tasks. The RBF kernel is a favored choice for SVM classification due to its capability to capture intricate nonlinear relationships among features. SVMs strive to ascertain the hyperplane that most effectively separates the classes in the feature space, endeavoring to maximize the margin between distinct classes while minimizing classification errors.\nSupport Vector Machine (SVM) with Linear Kernel (SVC_linear)\nThe linear kernel represents another variant of SVM that assumes the input data to be linearly separable. It functions by identifying the optimal linear boundary (hyperplane) that segregates the classes in the feature space. Despite its simplicity, linear SVMs can exhibit commendable performance across many classification tasks, particularly when the data displays linear separability or when the feature space is high-dimensional."}, {"title": "Support Vector Machine (SVM) with Polynomial Kernel (SVC_polynomial)", "content": "The polynomial kernel is employed in SVMs to handle nonlinear relationships among features by projecting the input data into a higher-dimensional space. This facilitates SVMs in capturing more intricate decision boundaries compared to linear SVMs. However, selecting an appropriate degree for the polynomial kernel is imperative to forestall overfitting."}, {"title": "Support Vector Machine (SVM) with Sigmoid Kernel (SVC_sigmoid)", "content": "The sigmoid kernel serves as an alternative option for SVM classification, particularly suitable for binary classification tasks. It operates akin to logistic regression and can delineate nonlinear decision boundaries. Nonetheless, SVMs with sigmoid kernels may exhibit sensitivity to hyperparameter settings and susceptibility to overfitting, necessitating meticulous tuning for optimal performance."}, {"title": "Results and Discussion", "content": "Overfitting is a common challenge in machine learning, occurring when a model learns to perform well on the training data but fails to generalize to unseen data. In the context of lung cancer level classification, overfitting can lead to inaccurate predictions and unreliable model performance, ultimately hindering the effectiveness of the classification system.\nThere are several reasons why overfitting occurs and why it needs to be addressed in the context of lung cancer level classification:\n\u2022\nComplexity of Data: Lung cancer classification involves intricate relationships between various features such as patient characteristics, environmental factors, and medical history. Overfitting can occur when the model captures noise or irrelevant patterns in the training data, leading to poor generalization to new data.\n\u2022\nLimited Sample Size: Medical datasets, including those used for lung cancer classification, are often limited in size due to data collection constraints. With a small dataset, there is a higher risk of overfitting as the model may memorize the training samples rather than learning meaningful patterns.\n\u2022\nImbalanced Data: Imbalanced classes, such as uneven distribution of lung cancer levels, can exacerbate the overfitting problem. Models may become biased towards the majority class, leading to poor performance in predicting minority classes.\nTo mitigate the risk of overfitting in lung cancer level classification, it is essential to apply techniques such as adjusting hyperparameters, including learning rate and minimum child weight. Monitoring these parameters allows us to control the complexity of the model and prevent it from memorizing noise in the training data. By fine-tuning hyperparameters, we aim to strike a balance between model complexity and generalization performance, ensuring that the model can effectively classify lung cancer levels in unseen data."}, {"title": "Splitting Data", "content": "In the Data Splitting section, a rigorous approach was adopted to ensure the integrity and generalizability of our machine learning models. The datasets underwent meticulous partitioning into training and test sets, a critical step aimed at mitigating overfitting and maintaining data balance. To address potential disparities in feature scales and class distribution, two key preprocessing techniques were employed. Firstly, the MinMaxScaler was utilized for data normalization, ensuring uniformity in feature magnitudes and facilitating convergence during model training. Additionally, the Synthetic Minority Over-sampling Technique (SMOTE) from imblearn.over_sampling was applied to address class imbalance, thereby promoting equitable representation of minority classes in the training data. Following data preprocessing, the train_test_split method was invoked, resulting in a stratified partitioning of 876 samples for training and 219 samples for testing, as illustrated in Figure 13. This stratification ensures that the distribution of classes remains consistent between the training and test sets, thereby enabling robust model evaluation and performance assessment.\nFurthermore, to ascertain the stability and reliability of our models, k-fold cross-validation was employed with k=5. This technique partitions the dataset into k equal-sized folds, with each fold serving alternately as the validation set while the remaining folds are used for training. By iteratively training and evaluating the model across different subsets of the data, k-fold cross-validation aids in mitigating overfitting and provides a more accurate estimation of model performance."}, {"title": "Conclusion", "content": "In conclusion, our journey through the intricate landscape of lung cancer level classification using machine learning has been both illuminating and promising. We've navigated through a myriad of models and techniques, uncovering hidden patterns and revealing novel insights along the way. At the forefront of our discoveries stands the formidable Deep Neural Network (DNN), a beacon of hope in the realm of oncological diagnostics. Its remarkable ability to decipher complex data patterns underscores the transformative potential of artificial intelligence in revolutionizing lung cancer diagnosis. But our quest didn't stop there. We delved deeper, exploring the synergistic power of ensemble methods like voting and bagging, where the collective wisdom of multiple models converges to achieve unparalleled accuracy and reliability. Yet, amidst our triumphs, we encountered challenges. The enigmatic Support Vector Machine (SVM) with the Sigmoid kernel posed a formidable adversary, reminding us of the importance of humility and adaptability in the face of complexity. Through it all, our journey has been guided by the steady hand of methodological rigor. From fine-tuning hyperparameters to meticulous model monitoring, we've remained steadfast in our pursuit of excellence, ensuring that every step taken brings us closer to our ultimate goal: improving patient outcomes and advancing the frontier of oncological care. As we bid farewell to this chapter of our research, we do so with optimism and resolve. For in the crucible of scientific inquiry lies the promise of a brighter future, where the tools forged today pave the path to tomorrow's breakthroughs. So let us embark on this journey together, armed with knowledge, curiosity, and the unwavering belief that through innovation and collaboration, we can overcome even the greatest of challenges. The road ahead may be long and arduous, but with determination as our compass, we march forward, ever closer to a world where lung cancer is not just treatable, but preventable."}]}