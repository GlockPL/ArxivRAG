{"title": "Evaluating GPT's Capability in Identifying Stages of Cognitive Impairment from Electronic Health Data", "authors": ["Yu Leng", "Yingnan He", "Colin Magdamo", "Ana-Maria Vranceanu", "Christine S. Ritchie", "Shibani S. Mukerji", "Lidia M. V. R. Moura", "John R. Dickson", "Deborah Blacker", "Sudeshna Das"], "abstract": "Identifying cognitive impairment within electronic health records (EHRs) is crucial not only for timely diagnoses but also for facilitating research. Information about cognitive impairment often exists within unstructured clinician notes in EHRs, but manual chart reviews are both time-consuming and error-prone. To address this issue, our study evaluates an automated approach using zero-shot GPT-40 to determine stage of cognitive impairment in two different tasks. First, we evaluated the ability of GPT-40 to determine the global Clinical Dementia Rating (CDR) on specialist notes from 769 patients who visited the memory clinic at Massachusetts General Hospital (MGH), and achieved a weighted kappa score of 0.83. Second, we assessed GPT-40's ability to differentiate between normal cognition, mild cognitive impairment (MCI), and dementia on all notes in a 3-year window from 860 Medicare patients. GPT-40 attained a weighted kappa score of 0.91 in comparison to specialist chart reviews and 0.96 on cases that the clinical adjudicators rated with high confidence. Our findings demonstrate GPT-40's potential as a scalable chart review tool for creating research datasets and assisting diagnosis in clinical settings in the future.", "sections": [{"title": "1. Introduction", "content": "Alzheimer's Disease and Related Dementias (ADRD, referred to hereafter as dementia) describes a group of related neurodegenerative disorders that affect over 6 million people over age 65 in the United States and represent a large and growing problem in the 21st century (Association, 2024). Timely diagnosis of dementia is crucial for interventions and treatment plans that can help manage symptoms and improve the quality of life for persons living with dementia and their families (Robinson et al., 2015). Yet, dementia remains under-recognized, under-diagnosed, and under-reported in healthcare records (Amjad et al., 2018). Automated mining of clinical notes have the potential to facilitate clinical diagnosis as well as research studies of dementia.\n\nThe Electronic Health Record (EHR)\u2014which includes detailed health history, clinical notes, and other health-system interaction information\u2014offers readily available data and great potential for identifying cognitive impairment in patients without a formal diagnosis in EHR. Despite the prevalence of cognitive impairment data within EHR, these critical insights are often buried in unstructured clinician notes and not readily accessible for clinical decision-making or research. Traditional methods for extracting this information involve labor-intensive manual reviews, which are not only time-consuming but also prone to inconsistencies and errors. To address this gap, several prior studies have applied natural language processing (NLP) and/or large-language models (LLMs) to detect cognitive impairment in clinical notes within EHR, for example Yan et al. (2024)\n\nHowever, to our knowledge none of the prior efforts have applied the latest GPT models to this problem."}, {"title": "2. Datasets and Processing", "content": "For the first study, the dataset comprised of 769 latest visit notes of 769 unique patients from the memory clinic at MGH from February 2016 to July 2019. These patients consented to be part of a registry which recorded the global CDR score and diagnoses at their visit, along with other data. Any sentence with mention of CDR was redacted from the notes using regex before evaluation by GPT-40. GPT-40 was prompted to assign a global CDR score.\n\nFor the second study, the dataset consisted of a sample of 860 Medicare fee-for-service patients from a previous study by Moura et al. (2021). Each patient's EHR data between 01/01/2016 \u2013 12/31/2018 was reviewed by an expert physician to label patients with the stage of cognitive impairment (Normal, Normal-to-MCI, MCI, MCI-to-dementia, and dementia) and to assign a confidence level of 1 (lowest) to 4 (highest). The MCI-to-dementia patients were included in the MCI category and Normal-to-MCI were excluded to get three final categories: NC, MCI, and dementia. For this dataset (Table 2), we prepared a summary of summaries with GPT-40. For each patient, we aggregated outpatient visit notes in chronological order. The context of the note (i.e., the date, department, specialty) was added to each note and summarized by GPT-40. The notes summaries were then combined chronologically into one document. For each patient, GPT-40 was prompted to generate a \"summary of summaries\" and make a final diagnosis based on this summary of summaries, classifying the patient's cognitive status as: NC, MCI, or Dementia."}, {"title": "3. Methodology", "content": "In this study, we evaluated the capability of GPT-40 to identify stage of cognitive impairment by implementing a series of prompt engineering techniques and a Retrieval-Augmented Generation (RAG) approach in the two datasets described above."}, {"title": "3.1. GPT, Prompt Engineering and Retrieval-Augmented Generation", "content": "For Study I, we tried three approaches. The first approach utilized a structured answer template to guide GPT-40's analysis of patient visit notes. The response format asks GPT-40 to provide observations and summaries across six key domains in the CDR scoring system (Hughes et al., 1982): i) Memory, ii) Orientation, iii) Judgment and Problem Solving, iv) Community Affairs, v) Home and Hobbies, and vi) Personal Care. The model was required to conclude with an explicit CDR score. This structured format helped standardize the output and ensured that each relevant domain was systematically considered before making the final decision.\n\nSecond, to further enhance GPT-40's ability to determine stages of cognitive impairment, we implemented a Retrieval-Augmented Generation (RAG) approach. We extracted information from the NACC UDS v3 CDR Dementia Staging Instrument (Besser et al., 2018; Hughes et al., 1982), chunked them into manageable pieces, and indexed them for efficient retrieval. When processing patient visit notes, the model searches for the top three chunks that are most similar to the notes. These relevant pieces of information are then used to augment GPT-40, providing the model with domain-specific guidance from human experts.\n\nThird, we asked GPT-40 to include a self-assessment of confidence and a count of explicitly mentioned domains. The model was asked to review the visit notes with a focus on identifying information within the six specific CDR domains and summarize the number of domains with explicit information. Based on the clarity and consistency of the evidence across these domains, GPT-40 was asked to assign a confidence level (low, medium, or high). This method aimed to enhance the reliability of the predictions by integrating a self-evaluation component into the model's decision-making process.\n\nFor Study II (Moura et al., 2021), based on the summary of summaries from the 3-year window, we asked GPT to provide an overall classification of the patient's cognitive status over the three-year period into one of the following syndromic diagnoses: i) NC, ii) MCI, iii) Dementia. We reasoned that a RAG ap-"}, {"title": "3.2. Evaluation", "content": "To assess the accuracy and reliability of decisions made by GPT, we used several analytical methods. We treated the staging task as an ordinal classification problem, and used quadratic weighted Cohen's kappa score as the evaluation metric. We also created confusion matrices and computed stratified performance metrics based on GPT confidence levels."}, {"title": "4. Results", "content": "For Study I, GPT-40 with structured answer template prompt, RAG-enabled GPT-40, and GPT-40 with confidence level and domain count prompt achieved weighted Cohen's kappa scores of 0.79, 0.80, and 0.83 respectively (Figures 1(a), 1(b) and 1(c)). GPT-40 consistently predicted a higher stage of cognitive impairment than the actual condition in all models. Stratification analysis showed that decisions made with high confidence had the highest weighted Cohen's kappa, whereas predictions with low or medium confidence had lower values, as expected (low: 0.40; medium: 0.56; high: 0.84). Notably, GPT-40 was \"overconfident\", with more than two-thirds of the predictions (618) rated as high confidence, and only a few (5) rated as low. The prompts for the third approach (confidence level and domain count) and a sample output are shown in Appendix A.\n\nFor Study II, the overall weighted kappa score is 0.91 (Figure 1(d)). A stratification analysis based on the clinical adjudicator's confidence levels revealed a clear trend: cases adjudicated with higher confidence by physicians demonstrated stronger alignment between GPT-40's predictions and the physician's diagnosis (Figure 1(e)). This trend indicates that cases rated with higher confidence by physicians were also those where GPT-40 performs exceptionally well. Figure 1(f) displays the confusion matrix between physician's confidence level in the adjudication and GPT-generated confidence levels. There was strong agreement between physicians and GPT-40 at the highest confidence level, indicating that GPT likely shares a similar understanding with physicians of what the highest confidence level represents. The GPT-40 prompt and sample output is shown in Appendix B."}, {"title": "5. Conclusion and Future Work", "content": "GPT-40 demonstrated good performance (weighted kappa 0.79-0.83) on assessing global CDR from the MGH memory clinic visit notes. Notably, the highest weighted Cohen's kappa score was achieved through the use of prompt engineering techniques that incorporated confidence levels and a count of the documented domains. However, even this approach had several errors (Figure 1(c)). The mismatch between the global CDR assigned by the physician and the GPT-determined CDR may stem from some physicians estimating a \"gestalt CDR\" based on their overall impression, rather than using the formal scoring algorithm. The use of RAG-enabled GPT-40 did not significantly enhance the scores in this study; it is possible that GPT-40 possesses sufficient knowledge to determine the stage of cognitive impairment without additional augmentation. In short, our findings on the memory clinic notes indicate that GPT-40 can be used by researchers to create structured datasets such as those of disease progression from memory clinic notes, applying manual review to cases rated with low or medium confidence. Such a real-world dataset can serve as a valuable resource for a wide range of dementia studies.\n\nOn the Medicare fee-for-service patients notes, GPT-40 demonstrated even stronger performance (weighted kappa 0.91), perhaps because this task was simpler than scoring a global CDR. The CDR is a detailed measure of cognitive and functional performance across six domains, while staging broadly categorizes cognitive status. Our results underscore GPT's potential for automated chart reviews, and facilitating diagnosis in clinical settings. However, it is important to acknowledge that, as previously reported, there are sociodemographic biases in access to specialists, healthcare utilization, reporting of symptoms, and documentation in clinic notes (Gianfrancesco et al., 2018; Sun et al., 2022; Perets et al., 2024) that this study does not address. Future work is essential to mitigate these biases in EHR data before they can be deployed at scale. Additionally, larger studies at multiple healthcare institutions are required to validate GPT as a tool for dementia chart reviews, and to investigate whether GPT-assisted cognitive diagnoses in clinical settings can influence patient outcomes."}, {"title": "Appendix A. GPT-40 prompt and sample answer for memory clinic notes", "content": "Review the following progress notes and provide a global CDR score (0, 0.5, 1, 2, or\n3).\nFocus on key observations for each CDR domain (Memory, Orientation, Judgment and Problem\nSolving, Community Affairs, Home and Hobbies, Personal Care) and identify whether there\nare clear clues that can help determine the cognitive impairment stage.\n\nThen, summarize how many domains have explicit information mentioned.\nProvide a confidence level (low, medium, or high) based on the clarity and consistency\nof the evidence from these six domains. Use \"high\" confidence only if the evidence is\nexplicitly mentioned in most domains and consistent across domains.\n\nKeep the response concise and follow this format:\n**CDR Score: ** [Insert barely CDR score here, e.g., 2.0.]\n**Justification: ** [A few sentences summarizing key observations.]\n**# of Domains Explicitly Mentioned: ** [Insert number of domains that are clearly\nobserved, e.g., 2]\n**Confidence Level: ** [Insert your confidence level in this decision as \"low\", \"medium\",\nor \"high\"]\n\nResponse:\n**CDR Score: ** 1.0\n\n**Justification: ** The patient was observed to have significant memory impairment, moderate\norientation issues, some impairment in judgment and problem-solving, and a decline in\nparticipation in community affairs. The individual remains independent in personal care and is\nsomewhat limited but not incapacitated with home and hobbies. These observations are consistent\nwith a Clinical Dementia Rating (CDR) of 1.0, which is indicative of mild dementia.\n\n**# of Domains Explicitly Mentioned: ** 4 (Memory, Orientation, Community Affairs, Home\nand Hobbies)\n\n**Confidence Level: ** High"}, {"title": "Appendix B. GPT-40 prompt and sample answer for Medicare patient dataset", "content": "Here are the summaries in chronological order: {summaries}\nBased on these summaries, provide an overall classification of the patient's cognitive\nstatus over the three-year period into one of the following categories:\n1. Normal\n2. MCI\n3. Dementia\nProvide a rationale for your classification.\nFollow this format and do not include patient name in response:\n**Syndromic Diagnosis: **[Insert one of 3 categories above here]\n**Summarized Reasons: **[Insert the summary of reasoning here]\n\nGPT-Response:\n**Syndromic Diagnosis: ** MCI\n\n**Summarized Reasons: ** Over a three-year observation period, a case of mild cognitive\nimpairment (MCI) was consistently documented. The subject has shown a pattern of mild\nconfusion and forgetfulness, particularly with medication management and recalling recent events.\nThese cognitive changes are more frequent and pronounced than what is normally expected with\naging, yet they do not meet the criteria for dementia. The cognitive difficulties may be associated\nwith a complex medical background. Based on the consistency and detail of the documented\nobservations throughout this period, a diagnosis of MCI is suggested with high confidence."}]}