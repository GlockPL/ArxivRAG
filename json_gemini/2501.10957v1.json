{"title": "MARIO: A MIXED ANNOTATION FRAMEWORK FOR POLYP SEGMENTATION", "authors": ["Haoyang Li", "Yiwen Hu", "Jun Wei", "Zhen Li"], "abstract": "Existing polyp segmentation models are limited by high la-beling costs and the small size of datasets. Additionally, vastpolyp datasets remain underutilized because these modelstypically rely on a single type of annotation. To address thisdilemma, we introduce MARIO, a mixed supervision modeldesigned to accommodate various annotation types, signif-icantly expanding the range of usable data. MARIO learnsfrom underutilized datasets by incorporating five forms ofsupervision: pixel-level, box-level, polygon-level, scribble-level, and point-level. Each form of supervision is associatedwith a tailored loss that effectively leverages the supervisionlabels while minimizing the noise. This allows MARIO tomove beyond the constraints of relying on a single annotationtype. Furthermore, MARIO primarily utilizes dataset withweak and cheap annotations, reducing the dependence onlarge-scale, fully annotated ones. Experimental results acrossfive benchmark datasets demonstrate that MARIO consis-tently outperforms existing methods, highlighting its efficacyin balancing trade-offs between different forms of supervisionand maximizing polyp segmentation performance.", "sections": [{"title": "1. INTRODUCTION", "content": "Colorectal cancer remains a significant global health challenge, with early detection and treatment of polyps critical forimproving patient outcomes. Recent advances in deep learn-ing have significantly improved polyp segmentation, withmodels such as U-Net and its variants [1, 2, 3] demonstratingstrong performance. Transformer-based architectures, suchas Polyp-Pvt [4], have further enhanced segmentation accu-racy. However, these methods are constrained by the highcost of annotation and the limited scale of existing datasets.\nTo address these challenges, weakly supervised methodslike WeakPolyp [5] leverage low-cost bounding box annota-tions to reduce labeling efforts but fail to exploit the diversityof available annotation types. To overcome this limitation,we propose MARIO, a mixed-supervision framework thatintegrates five annotation types-pixel-level, polygon-level,bounding box-level, scribble-level, and point-level. Thisunified architecture enhances dataset utility, reduces label-ing burdens, and provides a scalable, practical solution forclinical applications.\nDespite its advanced design, weak labels introduce noisethat can hinder model performance. MARIO addresses thischallenge with specialized loss functions tailored to the char-acteristics of each annotation type. For example, pixel-levelannotations, offering fine-grained detail, benefit from metricslike binary cross-entropy and Dice loss, while bounding boxannotations rely on mask-to-box transformations and consis-tency losses to align predictions with spatial context and ad-dress label inaccuracies. These tailored losses enhance train-ing robustness, enabling effective learning from both detailedand coarse labels. This diverse annotation strategy optimizesdata usage, addressing data scarcity while mitigating limita-tions associated with specific annotation types. By seamlesslyincorporating multiple annotation formats, MARIO expandsusable training data, improves generalization across datasets,and ensures practical adoption by accommodating varied an-notation preferences of medical professionals.\nIn conclusion, MARIO provides a scalable solution forcolorectal polyp segmentation by unifying five annotationtypes within a single framework. Tailored loss functionsmitigate noise and enhance training robustness, enablingeffective learning from diverse annotations. This flexibleapproach optimizes data usage by leveraging diverse anno-tations, enhances generalizability across datasets throughrobust training, and advances colorectal cancer screening byimproving segmentation accuracy and diagnostic precision,ensuring practical applicability in clinical workflows."}, {"title": "2. METHODOLOGY", "content": ""}, {"title": "2.1. Transformer-based Polyp Segmentation Model", "content": "MARIO is a transformer-based weakly supervised segmenta-tion model that uses PVTv2-B2 [10] as its backbone. It ini-"}, {"title": "2.2. Loss Function Definition", "content": "In MARIO, the supervision losses are carefully designed toalign with specific types of annotations, which can be cate-gorized into four groups: dense supervision, box supervision,scribble supervision, and point supervision.\nDense Supervision. Dense supervision, building onprior studies [2, 3], has proven effective in supervised learn-ing tasks by leveraging a combination of binary cross-entropy(LBCE) and Dice loss (LDice). Dice loss maximizes\nspatial overlap, effectively addressing class imbalance, whileBCE ensures pixel-level precision, particularly at boundaries.\nTogether, these losses complement each other to provide ro-bust training for accurate and detailed segmentation, makingthem particularly suitable for pixel-level and polygon-levelannotations. In dense supervision, the loss is denoted as Lpixel\nfor pixel-level data and Lpolygon for polygon-level data.\nBox Supervision. For box supervision, we utilize the\nmask-to-box (M2B) transformation to align the predicted re-sults and labels in the same space, eliminating potential biasesfrom box shapes. Specifically, M2B consists of two mainprocedures: a projection step that projects the predicted maskinto two vectors along the row and column directions, anda back-projection step that reconstructs a box-shaped maskfrom these vectors. This projection mechanism eliminates in-consistencies in shapes between predictions and labels, allow-ing supervision to focus more on the target's location ratherthan its shape, thereby avoiding misleading noise. The super-vision loss is denoted as Lbox.\nScribble Supervision. Scribble supervision is sparse,\nleaving most areas of the image unannotated and withouteffective supervision, which increases uncertainty in the pre-dictions. To address this challenge, we propose the uncer-tainty loss LUncertain, or Lscribble to mitigate the uncertaintyintroduced by scribble annotations. LUncertain specifically\ntackles the lack of ground truth for the majority of pixels, pre-venting the model from becoming overconfident and making"}, {"title": "Point Supervision.", "content": "Point annotations are the sparsest formof labeling, introducing significant noise into the model. Tomitigate this impact, we propose a consistency loss Lpoints thatconstrains the consistency of output results. Specifically, weperform a 90-degree rotation on each input image, then re-verse the rotation to compare the consistency between the twopredictions. This consistency loss is calculated by computingthe MSE loss between the model's predictions on the originalimages and those on their 90-degree rotated counterparts. Byenforcing consistency between these predictions, our methodeffectively reduces the influence of noise from sparse pointannotations, enhancing the overall robustness and accuracy ofthe segmentation model. The total loss is derived as the cumu-lative sum of individual supervision losses, each contributingto the overall optimization process:\n$L_{total} = L_{pixel} + L_{box} + L_{polygon} + L_{scribble} + L_{points}.$"}, {"title": "3. EXPERIMENT", "content": ""}, {"title": "3.1. Dataset and Implementation Detail", "content": "This study leverages eight datasets: Kvasir, CVC-ClinicDB,CVC-ColonDB, EndoScene, ETIS, SUN-SEG, LDPolypVideo,and PolypGen. A total of 1,451 pixel-level annotated imagesfrom the first five datasets were used for training, with theremainder for testing. LDPolypVideo provided 33,884 box-annotated samples, while SUN-SEG's 49,136 samples wereevenly split for polygon and scribble annotations. PolypGen"}, {"title": "3.2. Performance Comparison", "content": "We evaluated our mixed-supervised method MARIO againsteight state-of-the-art fully supervised polyp segmentationmodels across five diverse datasets. As shown in Table 1,\nMARIO achieved the highest weighted average (wAVG) per-formance, with a Dice score of 85.8% and an IoU of 78.3%,\nsurpassing the second-best model, CAFA-Net, by 1.0% inDice and 0.6% in IoU. MARIO also excelled on individ-ual datasets, achieving 82.8% Dice on ColonDB, 91.7%\non Kvasir, and 85.1% on ETIS. These results underscoreMARIO's superior segmentation accuracy and robustness,\nenabled by its mixed supervision approach, which integratesmultiple annotation types and outperforms fully supervisedmethods reliant on costly pixel-level annotations."}, {"title": "3.3. Ablation Study", "content": "The ablation study presented in Table 2 demonstrates the in-cremental benefits of incorporating multiple loss functions.Starting with LBCE alone, the model achieves a Dice scoreof 85.24% and an IoU of 77.91%. Introducing the Uncertainloss slightly enhances performance to a Dice score of 85.37%and an IoU of 78.23%. Further adding the Consistency lossresults in the highest observed metrics, with a Dice score of85.81% and an IoU of 78.39%. These findings indicate thateach additional loss component contributes to improved seg-mentation accuracy, highlighting the effectiveness of a multi-faceted loss strategy in enhancing model performance."}, {"title": "4. CONCLUSION", "content": "To address the challenge of data scarcity due to high label-ing costs, we present MARIO, a mixed-supervised modelfor polyp segmentation. MARIO unifies five annotationtypes: pixel-level, polygon-level, box-level, scribble-level,and point-level. This integration maximizes the utilizationof existing annotated data, caters to medical professionals'annotation preferences, and improves usability for clinicalapplications. We also design specific loss functions for eachannotation type. These functions adopt the mixing nature ofannotations and reduce noise, making the model more robustand practical. Experiments on five diverse datasets show thatMARIO outperforms existing methods in polyp segmenta-tion. It effectively optimizes data usage, boosts segmentationaccuracy, and meets clinical needs."}, {"title": "5. COMPLIANCE WITH ETHICAL STANDARDS", "content": "This is a retrospective analysis relying exclusively on publiclyavailable, fully anonymized datasets, and the need for ethicalapproval was waived."}]}