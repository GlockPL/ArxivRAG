{"title": "NODER: Image Sequence Regression Based on Neural Ordinary Differential Equations", "authors": ["Hao Bai", "Yi Hong"], "abstract": "Regression on medical image sequences can capture temporal image pattern changes and predict images at missing or future time points. However, existing geodesic regression methods limit their regression performance by a strong underlying assumption of linear dynamics, while diffusion-based methods have high computational costs and lack constraints to preserve image topology. In this paper, we propose an optimization-based new framework called NODER, which leverages neural ordinary differential equations to capture complex underlying dynamics and reduces its high computational cost of handling high-dimensional image volumes by introducing the latent space. We compare our NODER with two recent regression methods, and the experimental results on ADNI and ACDC datasets demonstrate that our method achieves the state-of-the-art performance in 3D image regression. Our model needs only a couple of images in a sequence for prediction, which is practical, especially for clinical situations where extremely limited image time series are available for analysis.", "sections": [{"title": "1 Introduction", "content": "In medical image analysis, image sequences like longitudinal image scans or image time series provide rich spatio-temporal information for studying the mechanisms of human aging and the patterns of disease development. Regression on temporal image sequences [15,12,9,10] is a commonly-used technique to explore the relationship between images and their associated time attribute. However, in practice, regression on medical image sequences, especially longitudinal 3D image volumes, is facing the following three challenges: (i) Missing data. Collecting regular follow-up scans of a subject is a challenging task. Often, we have missing scans at one or more time points for each subject. (ii) High-dimension low-sample size data. In this paper, we tackle 3D medical image sequences, and each volume is high-resolution three-dimensional images with millions of voxels, while each sequence has only tens of image scans for regression. (iii) Semantic richness but with subtle temporal changes. Each volume has detailed spatial information about tissue structures, which is non-trivial to generate; at the same time, the temporal changes of these tissues are often subtle, which is difficult to capture without a special design or treatment to model the temporal dynamics."}, {"title": "2 Method", "content": null}, {"title": "2.1 Background and Definitions", "content": "We consider an unparameterized 3D image as a discrete solid, where the position of its i-th voxel can be represented as: $x_i \\in \\Omega \\subseteq \\mathbb{R}^3$, where $\\Omega$ represents the 3D image domain. The positions of all voxels in the image can be represented by an ordered set: $q = \\{x_i\\}_1^N$. Here, $N = D \\times H \\times W$ represents the total number of voxels in the image, and $D, H, W$ denote the depth, height, and width of the image, respectively. We denote the domain where the voxel cloud resides as $\\Pi$, then we have $q \\in \\Pi$.\nNow we denote an image sequence as: $\\{(I_k, t_k)\\}_{k=0}^{L-1}$, where $L$ represents the length of the image sequence, $I_k$ represents the $k$-th, and $t_k$ is its associate time like age. The"}, {"title": "2.2 Formulation of Image Regression in Neural ODEs", "content": "From a system perspective, neural ODEs represent vector fields as a continuous-time model of neural networks. It has been widely used as a general framework for modeling high-dimensional spatio-temporal chaotic systems using convolutional layers, demonstrating its ability to capture highly complex behaviors in space and time. Therefore, we consider the trajectory of the entire voxel cloud as the solution of the following first-order ordinary differential equation (ODE):\n$\\frac{dq}{dt} = v_\\theta(q(t), t), \\quad \\text{s.t.} \\quad q(0) = q_0 = Id,$\nwhere $v_\\theta(\\cdot)$ is a parameterized network that describes the dynamics of voxel cloud deformation, $q_0$ represents the initial state of the voxel cloud at $t = 0$, which corresponds to an identity map. The varying velocity field over time indicates non-stationary dynamics, which is fundamentally different from SGR with stationary dynamics.\nThe trajectory of q is generated by integrating the above ODE under the initial condition $q_0$. Assuming the voxel cloud evolves from $t = 0$ to $t = t_k (k = 1, 2, ..., L-1)$, the voxel cloud obtained at $t = t_k$ is given by the following equation:\n$\\psi_k(q_0) = q(t_k) = q_0 + \\int_0^{t_k} v_\\theta(q(t), t) dt.$\nIn particular, the computation of this flow field map is performed using numerical integration methods such as the Euler method [4]. The time t can be parameterized by the"}, {"title": "3 Experiments", "content": "We conducted experiments on two medical datasets, including a 3D MRI brain image dataset ADNI (Alzheimer's Disease Neuroimaging Initiative) [14] and the cardiac dataset ACDC [3]. We compare our method with two advanced medical image regression baselines, FPSGR [9] and SADM [21]. Finally, we perform ablation experiments to demonstrate the effects of a series of smoothness constraints within the network.\nDatasets. (1) ADNI [14]. The ADNI dataset consists of 3D brain MRI images collected from 2,334 subjects. Each subject has an image sequence of 1 to 16 time points, resulting in 10,387 MRI images. All images went through preprocessing steps including denoising, bias field correction, skull stripping, and affine registration to the SRI24 atlas. All brain images are standardized to a size of 144 \u00d7 176 \u00d7 144 with a spacing of 1mm \u00d7 1mm \u00d7 1mm and applied histogram equalization. The intensity of each image volume is normalized within [0, 1]. We select 1,568 subjects that have more than two image scans as our dataset for experiments. For each subject, we randomly select 20% time points for the test and the remaining images are used for training and validation.\n(2) ACDC [3]. The ACDC (Automatic Cardiac Diagnosis Challenge) dataset consists of cardiac MRI images from 100 training subjects and 50 testing subjects. We follow SADM [21] and borrow its pre-processed and partitioned ACDC dataset. We take the"}, {"title": "4 Conclusion and Discussion", "content": "In this work, we propose the NODER method, leveraging the powerful representation capability of neural networks to simulate the underlying dynamics of brain or cardiac deformation trajectories. Through solving ordinary differential equations, we achieve fitting regression on existing medical image time series, thus enabling the generation of desired images at any time point. Our method is based on the theoretical basis of deformable registration and resamples the first image of each subject through the deformation field to generate a new image. The loss terms we use in this paper explicitly impose diffeomorphic constraints, thus maintaining accurate anatomical information to some extent. Experimental results on large-scale 3D MRI datasets demonstrate that our method outperforms existing state-of-the-art methods, FPSGR and SADM, by predicting more accurate image volumes. In future work, we consider incorporating the learning-based methods to further reduce the inference time cost and make it more practical. Also, exploring ways to improve the smoothness of the deformation fields is another direction for our future work."}]}