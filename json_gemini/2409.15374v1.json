{"title": "Explainable AI for Autism Diagnosis: Identifying Critical Brain Regions Using fMRI Data", "authors": ["Suryansh Vidya", "Kush Gupta", "Amir Aly", "Andy Wills", "Emmanuel Ifeachor", "Rohit Shankar"], "abstract": "Early diagnosis and intervention for Autism Spectrum Disorder (ASD) has been shown to significantly improve the quality of life of autistic individuals. However, diagnostics methods for ASD rely on assessments based on clinical presentation that are prone to bias and can be challenging to arrive at an early diagnosis. There is a need for objective biomarkers of ASD which can help improve diagnostic accuracy. Deep learning (DL) has achieved outstanding performance in diagnosing diseases and conditions from medical imaging data. Extensive research has been conducted on creating models that classify ASD using resting-state functional Magnetic Resonance Imaging (fMRI) data. However, existing models lack interpretability. This research aims to improve the accuracy and interpretability of ASD diagnosis by creating a DL model that can not only accurately classify ASD but also provide explainable insights into its working. The dataset used is a preprocessed version of the Autism Brain Imaging Data Exchange (ABIDE) with 884 samples. Our findings show a model that can accurately classify ASD and highlight critical brain regions differing between ASD and typical controls, with potential implications for early diagnosis and understanding of the neural basis of ASD. These findings are validated by studies in the literature that use different datasets and modalities, confirming that the model actually learned characteristics of ASD and not just the dataset. This study advances the field of explainable AI in medical imaging by providing a robust and interpretable model, thereby contributing to a future with objective and reliable ASD diagnostics.", "sections": [{"title": "I. INTRODUCTION", "content": "AUTISM Spectrum Disorder (ASD) is a complex neuro- developmental condition characterised by impairments in social communication, interaction, and restricted, repetitive behaviors [1]. Its presentation varies widely across affected individuals, impacting on quality of life. In the last 20 years, there has been a 787% surge in ASD diagnosis increasing its prevalence from approximately 1% to around 3% of the population. This surge in diagnosis is thought to be due to the delay in recognition of the clinical symptoms and the lack of personnel to diagnose. [2]-[4]. Early diagnosis, ideally be- tween the ages of two and five, can lead to a significantly better Quality of Life (QoL) for individuals with ASD [5]. Studies also show that early intervention can improve IQ scores by up to 18 points and enhance language skills [6], emphasising the critical need for early diagnosis and intervention. However, the average age of diagnosis remains around five years old, highlighting a crucial limitation in current diagnostic practices [7]. Specifically, current clinical ASD diagnostic practices lack effective early diagnosis methods. The method of diagnosing ASD in children is behavioral analysis combined with clinical history, which is not effective for early diagnosis as it is based on identifying abnormal communication and social behaviors that may not emerge until the condition is well established [8]. It is also subject to clinicians' biases and has historically led to under-diagnosing ASD particularly, in certain groups such as females [9]. To enhance our understanding of ASD and improve diagnostic accuracy, there is a need for objective, biologically-based markers of the condition. The resting-state functional Magnetic Resonance Imaging (fMRI) data of people with ASD has been analysed to show abnormalities in functional connectivity\u00b9 [10]. These differ- ences in distinctive patterns in the functional connectivity of autistic individuals can serve as biomarkers of ASD. By researching these differences, studies have identified several brain networks and areas that are associated with ASD such as disrupted connectivity in the Default Mode Network (DMN) [11]. However, the vast differences in ASD and the concept of the \"idiosyncratic brain\u201d suggests that there exists a highly personalised neural network configuration for each individual [10], [12]. The regions involved are also affected by the severity of ASD [13]. This highlights the need for a method to identify the intricate patterns of neural networks in ASD and possibly reveal a biomarker that is characteristic of all ASD individuals regardless of the severity of ASD. These abnormalities can be learned using deep learning (DL) to distinguish between ASD and Typical Control (TC). Many recent studies have emerged using functional connec- tivity for ASD classification using machine learning, with some showing a high accuracy (> 90%) [14], [15]. While these models cannot replace clinical professionals, they can offer valuable decision support. These neuroimaging-based diagnosis methods have the potential to revolutionise ASD diagnosis, but most current approaches lack in explainability. These limitations reduce trust and hinder clinical acceptance of the model in real-world scenarios [16]. To address this chal- lenge, there is a large body of research focusing on approaches that enhance the interpretability of DL models in the medical domain [17]. However, identifying which approach should be used with functional connectivity data or how they should"}, {"title": "II. RELATED WORK", "content": "A. Neurological basis of ASD and fMRI studies Research into ASD using fMRI has revealed distinct con- nectivity patterns between individuals with ASD and typical controls. Understanding these patterns is vital as they pro- vide objective, neurobiological markers that could enhance early detection and inform targeted interventions. Functional connectivity, which measures synchronised activity between different brain regions, shows atypicality in several areas frequently linked to ASD. Key regions include the frontal cortex, involved in executive functions and social cognition [20], temporal regions for language and social processing [21], the amygdala for emotion processing [22], and the cerebellum for motor function and social cognition [23]. Studies indicate that ASD individuals often exhibit local over-connectivity and long-range under-connectivity [24]\u2013[26]. Furthermore, dis- rupted connectivity in the DMN and Salience Network (SN) is associated with ASD [11], [27]. However, there is considerable variation in the important regions identified across studies, and these regions can change on a case-by-case basis depending on the severity of ASD symptoms [13]. Notably, a universal biomarker common to all cases of Autism, if it exists, has not been found. The concept of the \"idiosyncratic brain\" suggests highly personalised neural network configurations in ASD, presenting a complex challenge for traditional analysis methods. This emphasises the need for advanced techniques like DL2 to identify the intricate patterns in ASD neuroimaging data [12]. B. Deep Learning for brain imaging DL techniques, inspired by the structure of the brain, have proven highly effective in medical imaging, surpass- ing traditional machine learning methods [28]. DL models capture complex patterns and combine data from multiple modalities, improving diagnostic accuracy. In brain imaging, various DL architectures like Convolutional Neural Networks (CNNs), Recurrent Neural Networks (RNNs), Graph Neural Networks (GNNs), and Autoencoders are employed for dif- ferent analysis tasks [29]\u2013[31]. Challenges include managing high-dimensional and multimodal data, mitigating overfitting, and ensuring model interpretability. Initiatives promoting data sharing, ethical frameworks, and cloud-based resources are addressing these challenges, while explainable AI research is gaining traction to identify key brain regions driving DL model predictions. Ethical considerations are paramount, as DL models must be evaluated rigorously to prevent biases and discriminatory practices [32]. In the context of ASD diagnosis, these advanced DL techniques show great promise, offering the potential for high accuracy and early detection by leveraging complex patterns in brain imaging data that may not be apparent to the human eye or traditional analysis methods. C. Feature analysis and interpretability in ASD research Feature analysis helps translate a model's accuracy into insights about the underlying mechanisms it uses for classifi- cation. Methods include gradient-based techniques like Layer- wise Relevance Propagation (LRP) [33] and DeepLift [34], and perturbation techniques like SHapley Additive exPlanations (SHAP) [35] and Local Interpretable Model-Agnostic Expla- nations (LIME) [36]. In medical research, these interpretability methods have been successfully applied to identify biomarkers for various conditions [37]\u2013[39]. However, a comprehensive review [40] found that there is no universally \"best\" inter- pretability method; rather, their effectiveness varies depending on the specific application and data type. In the context of ASD research, there is a notable gap in the application of these interpretability methods, particularly for functional connectivity data derived from fMRI. This gap is exacerbated by several challenges unique to ASD and neuroimaging data. Firstly, the heterogeneity of ASD manifestations adds another layer of complexity, as different neural patterns may be significant for different subgroups within the ASD spectrum. Secondly, the lack of ground truth for important brain regions in ASD makes it challenging to validate the results of interpretability methods. Moreover, even when studies attempt to incorporate interpretability, they often fail to validate their results, leaving uncertainty about whether the model is truly learning characteristics of Autism or merely"}, {"title": "III. METHODOLOGY", "content": "A. Data Collection and Preprocessing 1) Dataset: This study used the Autism Brain Imaging Data Exchange (ABIDE) dataset [44], specifically the Preprocessed Connectomes Project (PCP) version. ABIDE was chosen for its large sample size, ease of access, and prevalence in com- parable studies, facilitating performance benchmarking. The dataset includes resting-state fMRI data from 539 individuals with ASD and 573 typically developing controls, aged 7-64 years. While ABIDE offers a robust sample size for model training, it has a notable gender bias (85.2% male) [45]. Notably, We employed stratified k-fold cross-validation during model training and evaluation, ensuring that each fold maintained the original dataset's distribution. We acknowledge that our results should be interpreted with caution regarding generalisability across genders. The data is anonymised in accordance with HIPAA guidelines and 1000 FCP / INDI protocols, ensuring ethical use of the neuroimaging data. 2) Preprocessing: The PCP openly shares preprocessed neuroimaging data from ABIDE. There is no set standard on how neuroimaging data should be preprocessed so PCP offers data preprocessed using four different preprocessing pipelines, namely the Connectome Computation System (CCS) [46], the Configurable Pipeline for the Analysis of Connectomes (CPAC) [47], the Data Processing Assistant for Resting-State fMRI (DPARSF) [48] and the NeuroImaging Analysis Kit (NIAK) [49]. The preprocessing steps carried out by the various pipelines are comparatively analogous [14]. The main differences are in the particular algorithms for each step, the software simulations, and the parameters applied. Details of each pipeline technique are provided on the PCP website [50]. Since there is no consensus on what precprocessing pipeline is the best we have trained a model using each of the four pipelines and compared their results. PCP applies some standard low-level fMRI preprocessing steps to all preprocessing pipelines. These include brain extrac- tion, spatial smoothing, temporal filtering, realignment (motion correction), slice timing correction and intensity normalisa- tion [47]. Further, there has been significant discussion in the literature about whether Framewise Displacement (FD) 3 filtering affects the accuracy of an autism diagnosis model. This necessitates an investigation to clarify head movement's role in model performance. Some influential studies state that an FD value > 0.2mm corrupts the fMRI data [51], [52], leading to a decrease in performance. In contrast, another study stated that FD filtering or head movement did not affect the performance of their model [53]. By conducting our study under both conditions - with and without FD filtering we aim to provide clarity on this methodological issue and its impact on model accuracy. 3) Parcellation: Brain images are overlaid on a brain atlas, which divides the brain into several Regions of Interest (ROIs). The voxels within each ROI are averaged to produce a single value, effectively reducing the dimensionality of the data. For this project, we selected the Automated Anatomical Labelling"}, {"title": "B. Feature Extraction", "content": "To reveal the patterns of coordination between brain regions, the data is converted to a functional connectivity matrix (FCM) using Pearson's correlation coefficient R(i, j) between the intensity time series from two regions of interests (ROIs). Furthermore, Fisher's Z transformation 4 was applied to the data. The Fisher's z-transformed correlation coefficients were then represented as a 116 x 116 matrix which was symmetric with respect to the diagonal due to the symmetric nature of correlation matrices R(i, j) = R(j, i). To reduce redundancy, the lower triangular matrix of the FCM was taken and flattened to form a feature vector for each of the 884 samples creating a feature vector with 6670 features. Creating a feature vector from the FCM has been thoroughly researched and used in DL models, however, when using them directly for autism diagnosis, the DL models peaked at an accuracy of 66.8% [55], [56]. This implies that these DL models suffer from the high-dimensionality and low number of samples problem. To efficiently use DL models, feature dimensionality must be reduced, or sample size must be increased. However, increasing sample size is infeasible due to reasons including high MRI costs and difficulty in participant recruitment. Support Vector Machine with Recursive Feature Elimination (SVM-RFE) was used to reduce the feature set from 6670 features to a 1000 features per sample [15]. This choice considers computational constraints, proven performance and the fact that SVM-RFE is a supervised feature selection approach, whereas unsupervised methods like Principal Com- ponent Analysis (PCA), operate without knowledge of the classification task, which can affect the accuracy."}, {"title": "C. Deep Learning Model", "content": "This study utilises a DL architecture (Figure 1) that com- prises of a Stacked Sparse Autoencoder (SSAE) combined with a softmax classifier to classify ASD using functional connectivity data. The SSAE was chosen for this study due to its ability to effectively handle high-dimensional functional connectivity data. Autoencoders are neural networks that learn to compress input data into a lower-dimensional representation and then reconstruct it, making them ideal for capturing essential fea- tures in complex datasets. The \u201csparse\u201d aspect is especially important for ASD classification, as it encourages the model to focus on the most distinctive biomarkers within the functional connectivity data while reducing noise and overfitting. The hierarchial structure of the SSAE, consisting of multiple layers of sparse autoencoders, encourages the model to learn increasingly abstract features of the data with each layer. This is important since biomarkers in functional connectivity may involve complex multi-level patterns. To address potential overfitting and improve generalisability, we incorporate a sparsity constraint using the Kullback-Leibler (KL) divergence 5 term in the loss function: \\begin{equation} L(x, \\hat{x}) = MSE + \\beta \\times KL(p||\\hat{p}) \\tag{1} \\end{equation} where MSE is the mean squared error between input x and its reconstruction \u00ee, p is the desired sparsity, \u00f4 is the average activation of a neuron, and \u03b2 controls the weight of the sparsity penalty. Our SSAE consisted of two autoencoder layers that used the ReLU activation function. The first reduces 1000 input features to 500, and the second further compresses to 100 neurons. The output was then fed into a softmax classifier that was trained using cross-entropy loss for ASD/TC classification. This is visualised in Figure 1."}, {"title": "D. Training and Evaluation", "content": "The model was trained in two stages combining the strengths of both supervised learning and unsupervised learn- ing. To ensure robust evaluation and training a stratified k-fold cross-validation approach with k value of 5 was employed. A k-fold value of 5 was chosen to balance computational cost with variance reduction in performance estimates with regard to the dataset size of 884. A higher k value led to there not being enough test cases for the model to be tested properly and a lower k value leads to there being not enough training data and the model struggles to generalise. Within each fold, the dataset was split into training, validation, and testing sets, with careful consideration given to maintaining a balance between computational efficiency and robust performance assessment. 1) Unsupervised Pre-training: The SSAE underwent un- supervised pre-training using the greedy layer-wise training approach [57]. This sequential approach allows each autoen- coder layer to learn increasingly abstract representations of the input data. SAE 1 was trained first and its compressed hidden layer representation then served as input for training SAE 2. Both layers were trained using the Adam optimiser, chosen for its adaptive learning rate and faster convergence [58]. Performance monitoring during pre-training combined Mean Squared Error (MSE) and a sparsity penalty achieved"}, {"title": "E. Feature Analysis and Interpretation", "content": "This section explores the different methods that were used to extract meaningful features used by the model for its diagnosis. Understanding the basis of its decisions is essential for trust and clinical translation. 1) Interpretability Methods: To identify potential neurobi- ological markers of ASD and enhance the model's explainabil- ity, a rigorous feature analysis was conducted. This investiga- tion involved multiple interpretability techniques, including: \u2022 Integrated Gradients [38]: Calculates feature importance by examining how changes in input values impact the predictions \u2022 LIME [36]: Approximates complex model decisions lo- cally through perturbations of the input data. \u2022 SHAP [35]: A game-theoretic approach attributing feature importance based on its contribution to the model's output. \u2022 DeepLift [34]: Decomposes the output prediction by backpropagating the contributions of neurons against a reference point."}, {"title": "IV. RESULTS AND DISCUSSION", "content": "The model achieved state-of-the-art performance on the ABIDE dataset, with a maximum accuracy of 98.2% across three different preprocessing pipelines, surpassing previous models for ASD classification. Evaluation metrics, including specificity, precision, and F1-score, were high with values of 0.98, 0.98 and 0.97 respectively. Analysis of the model's decision-making process identified a set of discrimi- native functional connectivity features. These results are pre- sented in detail, alongside a discussion of model performance, interpretability performance, feature analysis and the potential significance of the identified ROIs. A. Model performance The model demonstrated exceptional performance on the ASD classification task, particularly when samples with a FD value > of 0.2mm were filtered. The 7% decrease in accuracy along with the observation that the autoencoders could not accurately reconstruct the data when a sample has more than 0.2mm FD, suggests that the hypothesis regarding FD's impact on data quality is indeed valid. This finding aligns with previous research on the subject [52] [51]. In particular, all the incorrect predictions during testing also had a high FD, suggesting that head movement during MRI has a significant effect on the precision of the diagnosis of ASD. This finding contrasts with previously reported results on the subject [53]. Using FD Filtering, an accuracy of 98.2% using the DPARSF pipeline (averaged across 5 K-Folds) was achieved by the model. These metrics surpass all previous state-of-the-art models using the fMRI modality, reported as 93.59% accuracy in [15] Notably, CCS, DPARSF and CPAC all performed within 1% of each other while NIAK trailed behind in every metric by an average of 4% (Figure 6). This difference in performance likely stems from the different approaches used for NIAK compared to CCS, CPAC, and DPARSF. In the NIAK pipeline,"}, {"title": "V. CONCLUSION", "content": "This research significantly advanced the field of ASD clas- sification using deep learning models applied to resting-state fMRI data, addressing several key gaps in current literature. Our model achieved exceptional performance with an average accuracy of 98.2% using the DPARSF pipeline, surpassing the previous benchmark of 93.59% [15]. This addresses the critical gap of lacking an explainable model with over 95% ac- curacy in ASD classification. The model's success stems from its hybrid architecture, combining unsupervised pre-training and supervised fine-tuning, and the removal of corrupt data. This helped the model effectively capture complex functional connectivity patterns characteristic of ASD. Unlike many previous studies that focused solely on accu- racy, we provided comprehensive evaluation metrics including sensitivity, specificity, precision, and F1 scores. This thorough approach offers a more robust assessment of the model's performance and addresses the limitation of narrow evaluation practices in the field. Our study also revealed the significant effect of head movement on the precision of ASD diagnosis, contrasting with some previous findings and highlighting the importance of motion correction in fMRI studies of ASD. We pioneered the use of ROAR (Remove And Retrain) to benchmark different deep learning interpretability methods in the context of functional connectivity data. This novel application revealed that gradient-based methods, particularly Integrated Gradients, are most suitable for this type of data, filling a significant gap in understanding the reliability of various interpretability approaches in ASD research. Our feature analysis highlighted the importance of vi- sual processing regions, particularly the calcarine sulcus and cuneus, in ASD classification. These findings were consistent across different preprocessing pipelines and aligned with in- dependent genetic studies [68], providing strong validation of our model's ability to capture genuine neurobiological markers of ASD rather than dataset-specific patterns. Notably, our"}, {"title": "VI. LIMITATIONS AND FUTURE DIRECTIONS", "content": "Despite the promising results of this study, several limita- tions must be acknowledged, each of which points to important directions for future research. A primary limitation is the binary nature of our classification model. By focusing on distinguishing between ASD and TC and due to a dataset limitation, we may have inadvertently created a classifier that identifies general neurodivergence rather than ASD specifi- cally. This raises the question of whether our model can truly differentiate ASD from other neurodevelopmental disorders or atypical brain patterns. Future research should explore multi- class classification models that can distinguish ASD not only from typical controls but also from other neurodevelopmental conditions. Secondly, while our model achieved high accuracy and identified consistent biomarkers, the dataset used was limited in the amount of information given, particularly in terms of ethnic representation. This limitation potentially affects the generalisability of our findings to the broader ASD population and its potential to perpetuate healthcare disparities [75]. Future studies should prioritise the use of explicitly diverse and representative datasets to ensure that the identified biomarkers and classification methods are valid across different demo- graphic groups. An important future direction would be to develop a model that can highlight important regions for ASD classification on a per-MRI scan basis, rather than studying the model's overall behavior. This approach could provide more personalised insights into the neurobiological markers of ASD for each individual, potentially revealing how these markers vary across the spectrum and among different demographic groups. This could potentially also aid clinicians with early and accurate diagnosis of ASD. Furthermore, a multimodal approach holds significant promise. Integrating behavioural, cognitive, genetic, and struc- tural imaging data alongside functional connectivity could provide a more holistic and nuanced picture of ASD [76]. This could lead to the identification of ASD subtypes or personalised profiles, enabling tailored interventions. Finally, collaborative research models are needed to bridge the gap between AI development and clinical practice. Inter- disciplinary teams of neuroscientists, AI researchers, and clin- icians are crucial to design studies with translational impact, ensuring that research questions are clinically relevant and AI models are designed to address the complexities of real-world ASD diagnosis and care."}, {"title": "A. ROAR Benchmark", "content": "ROAR analysis identified which interpretability methods are reliable. It showed that Inte- grated Gradients, Deep fLift, DeepLiftShap, and GradientShap methods all had similar results and showed the steepest drop in accuracy when the initial features were removed, indicating"}]}