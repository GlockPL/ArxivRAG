{"title": "Roundabout Dilemma Zone Data Mining and Forecasting with Trajectory Prediction and Graph Neural Networks", "authors": ["Manthan Chelenahalli Satish", "Duo Lu", "Bharatesh Chakravarthi", "Mohammad Farhadi", "Yezhou Yang"], "abstract": "Traffic roundabouts, as complex and critical road scenarios, pose significant safety challenges for autonomous vehicles. In particular, the encounter of a vehicle with a dilemma zone (DZ) at a roundabout intersection is a pivotal concern. This paper presents an automated system that leverages tra-jectory forecasting to predict DZ events, specifically at traffic roundabouts. Our system aims to enhance safety standards in both autonomous and manual transportation. The core of our approach is a modular, graph-structured recurrent model that forecasts the trajectories of diverse agents, taking into account agent dynamics and integrating heterogeneous data, such as semantic maps. This model, based on graph neural networks, aids in predicting DZ events and enhances traffic management decision-making. We evaluated our system using a real-world dataset of traffic roundabout intersections. Our experimental results demonstrate that our dilemma forecasting system achieves a high precision with a low false positive rate of 0.1. This research represents an advancement in roundabout DZ data mining and forecasting, contributing to the assurance of intersection safety in the era of autonomous vehicles.", "sections": [{"title": "I. INTRODUCTION", "content": "Drivers often face dilemmas at traffic intersections, where they must decide whether to stop or proceed through the in-tersection [1][2]. Yellow-light dilemma zone (DZ) is the area on a roadway where a driver may encounter such a dilemma. This dilemma can lead to dangerous situations, such as red-light running (RLR) or rear-ended crashes, particularly at high-volume or high-speed intersections [1]. Various studies have investigated the factors affecting drivers' decision-making processes, such as gap size, speed, and visibility [1][3][4].\nTransportation engineers have proposed various solutions, such as advanced warning signs or pavement markings and intelligent transportation systems (ITS) using pressure, radar, or camera-based technologies to detect and monitor yellow-light DZs [5][6][7][8]. However, these solutions are not applicable to roundabouts that do not have traffic lights. Instead, roundabouts use yield-controlled entries and con-tinuous circular flows to improve traffic flow efficiency, reduce delays, and enhance safety. As a result, roundabouts can also create DZs where drivers may struggle to judge the safe gap size or time to enter the roundabout since vehicles inside the roundabouts create conflicts similar to \"moving yellow lights\", as shown in Fig. 1. In recent years, roundabout DZs have gained attention due to their unique characteristics and challenges [9], such as difficulties in obtaining accurate training data for driver behavior prediction [4][10], constantly changing factors affecting driver decision-making [1][11], and tracking errors from roadside units [12].\nTo tackle the challenges associated with roundabout DZ, we propose a practical data mining approach to detect abnor-mal driving behaviors and filter out roundabout DZ events given the road geometry and vehicle trajectories. Our method compares the predicted trajectory with the actual trajectory, as shown in Fig. 2. Specifically, our trajectory prediction model incorporates multiple pieces of information to make its prediction, such as the driver's speed and acceleration, the position of other vehicles, and a semantic map of the environment. If there is a discrepancy between the predicted trajectory and the actual trajectory, it means that the driver has had to brake hard, accelerate rapidly, or make a sudden turn, which is indicative of the vehicle being in a DZ [11]. Further, using a graph representation of the vehicles, we extend the trajectory predictor to forecast DZ events on the fly from the perspective of an autonomous vehicle, which can help the vehicle to make a decision.\nWe also utilize accurate vehicle tracking through drone data [13], which provides a unique bird's eye view (BEV) perspective [14] that is not easily obtainable by other means. However, it is important to note that the use of drone data is not universal, and there are limitations to collecting data for extended periods. However, in the context of autonomous vehicles, the BEV representation can also be generated using data from the vehicles themselves [15]. Modern autonomous vehicles are typically equipped with advanced sensors, such as LiDAR, radar, and cameras, which can be used to create a"}, {"title": "II. RELATED WORKS", "content": "A. Roundabout Dilemma Zone\nThe roundabout DZ [2][11][16] is a brief period when a vehicle must decide whether to yield or pass when ap-proaching a roundabout, based on the presence of other vehicles inside the roundabout. This can be a tricky decision for drivers, as it requires good judgment of the speed and distance of other vehicles. Improper judgments can result in traffic violations and sometimes even rear-ended crashes [7]. Decision-making can be challenging, particularly with large traffic volumes or when traffic is moving at high speeds.\nFig. 3 shows a vehicle in a dilemma zone. The mathe-matical model [1][2] of a vehicle of length L approaches a roundabout yield scenario [17]. If the driver's reaction time is given by $d_{react}$ and the vehicle is traveling at an initial velocity vo and accelerating at $a_{acc}$ m/s, then the maximum distance at which the vehicle can pass safely is given by:\n$S_{pass} = W+L+\\frac{1}{2}a_{acc}d_{react}^2$ (1)\nWhere W is the width of the road in the intersection.\nSimilarly, if the vehicle has a safe braking deceleration of $a_{dec}$, the minimum distance before at which the vehicle needs to stop is given by,\n$S_{stop} = V_0d_{react} + \\frac{V_o^2}{2a_{dec}}$ (2)\nA vehicle is said to be in a dilemma if it lies between the distances Sstop - Spass at a given yield signal. The case when $S_{stop} > S_{pass}$ is a DZ, whereas the case when $S_{stop} < S_{pass}$ is called an option zone.\nThe behavior of vehicles in yellow-light DZs at intersec-tions has been widely studied [10][11][18] and several factors were brought to light on the cause and effect. The three major factors to be considered are (a) approaching velocity, (b) acceleration after the event starts, and (c) the type of the vehicle incurring the yield. In the study conducted by li e. al. [11] for yellow light DZs at signalized intersections, 26% of their drivers chose to stop, whereas 74% of their drivers were observed to run through the intersection. After the yellow signal started, the majority of vehicles elected to avoid the intersection, stopping only when there was a strong likelihood that they would commit a Red Light Running (RLR) violation. In other simulated studies [18], it was noticed that drivers stopping when in a DZ decelerate rapidly, which could contribute to rear-ended clashes.\nWhile some studies have examined dilemmas at round-abouts, such as the one conducted by Najmi et al. [16], they do not fully extend the concept of normal DZs to roundabout DZs due to the significant presence of deceleration and priority given to circular traffic flow. The study also found that the dilemma zone in roundabouts was shorter in length and closer to the stop line. We extend the studies presented in existing works[10][11][18] to roundabouts by understanding the behavior of vehicles and the effect of the yield sign on them. We particularly solve this issue by generalizing a roundabout as an intersection with virtual signals and by predicting the trajectories of the vehicles present in the scene. This system can help drivers make informed decisions when approaching a roundabout, reducing the risk of accidents and improving traffic flow."}, {"title": "B. Trajectory Prediction", "content": "Social connections and spatial environment [19][20] can affect how people and vehicles will move in the future. In the case of the DZ, the behavior of vehicles is characterized by vehicle dynamics. Works that consider dynamics [21][22] use a graph-based approach to model the agent environment. This involves adding features of the agent as the features of a node in a graph. Salzmann et al. [21] proposed Trajectron++, an approach that involves heterogeneous data such as semantic maps of the agent environment to predict its trajectory by us-ing a convolutional neural network (CNN). Acceleration and lane information highly characterize DZ conditions. These features can be leveraged to detect abnormalities in normal driving behavior. However, features such as acceleration and lane information that affect a vehicle's behavior in DZ can be added to refine its predictions."}, {"title": "III. ROUNDABOUT DILEMMA ZONE DATA MINING", "content": "A. Dilemma Zone Determination\nTo unearth DZ data concealed within datasets of vehicle trajectories, we employ the equations Eq. 1 and 2 designed to estimate the boundaries of the dilemma zone on the road surface. By plugging in the speed limits of the intersection, the safe acceleration, and the deceleration rate into this equation, we can calculate an approximate region where DZ events are likely to occur.\nOne pivotal aspect of our data mining strategy involves when to apply the calculation with the two equations. Compared to yellow-light DZ at signalized intersections, we developed a procedure to determine when a vehicle inside the roundabout generates a \u201cvirtual yellow light\" for vehicles approaching the roundabout, which is shown in Algorithm 1. It is based on driving safety metrics [23][24] such as time to collision (TTC) and time to stop (TTS). There are two key observations as follows.\nWe use this DZ determination method to filter out ground-truth DZ events to train our abnormal driving event detector detailed in the next subsection."}, {"title": "B. Abnormal Driving Event Detection", "content": "Predicting the trajectory of a vehicle on the road would serve as the ground for detecting dilemma events. Salzmann et. al [21] proposed a forecasting model that was capa-ble of incorporating agent dynamics with semantic maps (heterogeneous data) in a multi-agent scenario. We propose Superpowered Trajectron++ (ST++), which is a modified version of Trajectron++ [21] trained with the features that have a significant impact [2][11] on the dilemma zone to predict a vehicle's trajectory under non-dilemma conditions. Under a dilemma zone, the behavior of the driver changes drastically, which is abnormal. To leverage this knowledge, a trajectory prediction model that produces a target probability p(y|x) where x = st-Hit s-H(t) \u2208 R(H+1)\u00d7N(t)\u00d7D are the current and previous D-dimensional states of the modeled agents is trained under non-dilemma conditions. The model outputs the probability distribution of the output trajectory $p(y | x) = \\sum_{z\\in Z} P_{\\Theta}(y | x,z)p_{\\phi}(z | x)$ where z \u2208 Z is a discrete Categorical latent variable that encodes high-level latent behavior, & and @ are deep neural network weights that parameterize their respective distributions. The most likely trajectory ypred can be calculated from the above distribution:\n$Z_{mode} = arg \\max p_{\\phi} (z | x)$,\n$y_{pred} = arg \\max p_y (y | X, Z_{mode})$. (3)\nAs a driver behaves abnormally under a DZ, we can compute the deviation of the driver's trajectory and the model's predicted trajectory:\n$\\Delta Path = \\sum_{i=1}^n || y_{pred} - Y_{true}||_2$. (4)\nHowever, a dilemma cannot the calculated just by thresh-olding $\\Delta Path$. The driver would have made an abrupt lane"}, {"title": "IV. DILEMMA FORECASTING AND DECISION MAKING", "content": "Our forecasting method leverages the state graph that was originally employed in the ST++ trajectory prediction algo-rithm. This state graph serves as a foundational framework for modeling vehicle movements and interactions within a roundabout. Within this, we implement a graph neural network node classifier designed to assess the likelihood of a node (or a vehicle) ending up in a dilemma situation in the future ($P_{Dilemma}$). We also calculate the probability of a node causing a dilemma $P_{causal}$. Calculating the probability of a node causing a dilemma is important because it helps identify vehicles that are likely to create a dilemma zone. By understanding which vehicles have a higher probability of causing a dilemma, we can take proactive measures to prevent such situations from occurring. This classification process hinges on the analysis of various parameters and historical data, allowing us to make informed predictions about impending DZ scenarios.\nTo train our dilemma event forecasting model, we harness the wealth of data generated by ST++. The training process involves feeding the trajectories with the information of them falling into a DZ into our forecasting model and fine-tuning the model's parameters. This iterative process refines the model's ability to identify potential DZ events based on real-world trajectories and empirical data."}, {"title": "V. EXPERIMENTAL EVALUATION", "content": "A. Experiment Setup\nDataset. We evaluated our methods using the publicly available CAROM Air dataset\u00b9 curated by Lu et al. [13]. This dataset is a collection of videos of vehicle trajectories in the United States recorded by a drone. There are diverse sites covered in the dataset, such as roundabouts, intersec-tions, local road segments, and highways. The dataset has a variety of features, including the local position coordinates of vehicles, their velocity and acceleration, and semantic maps of the intersections. Each site has approximately 60 minutes of footage, and there are approximately 4-5 vehicles in each frame. We use the vehicle trajectory data of ten roundabout sites in the dataset.\nTo calculate dilemma zones on the road surface, we use the speed limits suggested by the U.S. Department of Trans-portation [25]. The speed is constrained between 15-25 Mph for any oncoming vehicle, irrespective of the roundabout and regardless of the posted speed limits on approaches.\nWe calculate the dilemma zone by using equations 1 and 2. We plug in the speed limit of the intersection as the velocity of the vehicle and the safe deceleration or braking rate [17] as $a_{dec}$.\nBaselines. To compare the modified trajectory prediction model, we use the original Trajectron++ as the baseline, which is trained without DZ features on the same dataset.\nMetrics. For dilemma zone event detection, Two sets of metrics are used as follows.\nB. Implementation Details\nWe implement the system with Python and PyTorch [26]. Using the dataset, we demonstrate the trajectory prediction model and detection of dilemma zones on Roundabout-A5 as the number of dilemma events is large. 80% of the video is randomly sampled and used for training, whereas test and validation sets are comprised of 10% each. Before training, the dilemma zones are calculated from the training"}, {"title": "VI. CONCLUSIONS AND FUTURE WORK", "content": "This study introduces a novel perception-based system aimed at detecting and forecasting dilemma zones at round-abouts through trajectory prediction. By analyzing trajectory deviations in dilemma zones compared to non-dilemma zones, the system can anticipate when a vehicle is in a dilemma with a low FPR of 10%. However, certain lim-itations are acknowledged, including the system's reliance on data quality, its specific applicability to roundabouts, and potential computational challenges in real-time performance. Despite these constraints, this work lays a foundation for future advancements in traffic safety and management. We aim to extend the framework beyond roundabouts to various scenarios like unsignalized T-bone intersections and ramp-merging, enhancing real-time forecasting capabilities for intelligent transportation systems. Additionally, implement forecasting and maneuver techniques in real-world controlled scenarios to proactively address potential hazards and op-timize vehicle responses and overall safety. Our team is currently working with the Institute of Automated Mobility of Arizona\u00b2 and the City of Phoenix to seek real-world exper-iments of the presented system in the Phoenix metropolitan area. We hope this paper can collectively enhance our understanding of DZ dynamics and pave the way for more robust and proactive solutions in autonomous vehicle safety."}]}