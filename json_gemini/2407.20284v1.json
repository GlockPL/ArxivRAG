{"title": "MLtoGAI: Semantic Web based with Machine Learning for Enhanced Disease Prediction\nand Personalized Recommendations using Generative AI", "authors": ["Shyam Dongre", "Ritesh Chandra", "Sonali Agarwal"], "abstract": "In modern healthcare, addressing the complexities of accurate disease prediction and\npersonalized recommendations is both crucial and challenging. This research introduces\nMLtoGAI, which integrates Semantic Web technology with Machine Learning (ML) to enhance\ndisease prediction and offer user-friendly explanations through ChatGPT. The system comprises\nthree key components: a reusable disease ontology that incorporates detailed knowledge about\nvarious diseases, a diagnostic classification model that uses patient symptoms to detect specific\ndiseases accurately, and the integration of Semantic Web Rule Language (SWRL) with ontology\nand ChatGPT to generate clear, personalized health advice. This approach significantly improves\nprediction accuracy and ensures results that are easy to understand, addressing the complexity of\ndiseases and diverse symptoms. The MLtoGAI system demonstrates substantial advancements in\naccuracy and user satisfaction, contributing to developing more intelligent and accessible\nhealthcare solutions. This innovative approach combines the strengths of ML algorithms with the\nability to provide transparent, human-understandable explanations through ChatGPT, achieving\nsignificant improvements in prediction accuracy and user comprehension. By leveraging\nsemantic technology and explainable AI, the system enhances the accuracy of disease prediction\nand ensures that the recommendations are relevant and easily understood by individual patients.\nOur research highlights the potential of integrating advanced technologies to overcome existing\nchallenges in medical diagnostics, paving the way for future developments in intelligent\nhealthcare systems. Additionally, the system is validated using 200 synthetic patient data records,\nensuring robust performance and reliability.", "sections": [{"title": "1. Introduction", "content": "Infectious diseases [1] pose significant challenges to global health, particularly in developing\ncountries, where they disproportionately impact populations. Countries such as India, Brazil, and\nseveral in sub-Saharan Africa [2] face high burdens of diseases like malaria, tuberculosis, and\ndengue fever. These diseases strain healthcare systems, impact economic productivity, and\ncontribute to high mortality rates. In India [3], for example, the prevalence of communicable\ndiseases remains a critical public health issue, with millions affected annually. The Indian\nhealthcare system is often overwhelmed by the volume of patients requiring diagnosis, treatment,\nand management for these conditions, highlighting the urgent need for effective and scalable\nsolutions.\nTo address these challenges, we utilize comprehensive documentation and datasets from\nreputable sources such as the World Health Organization (WHO) [4] and the Indian healthcare\nsystem. These sources provide detailed information on various diseases, including their\nsymptoms, transmission methods, and treatment protocols. This data is crucial for developing\nrobust models that accurately predict disease occurrence and recommend personalized treatment\nplans. By leveraging this extensive documentation, our approach ensures that the disease models\nare grounded in the latest medical knowledge and address the specific health challenges faced by\npopulations in India and similar regions.\nIn recent years, integrating advanced technologies like SWRL and ML has become\nincreasingly important in healthcare. These technologies enable the development of sophisticated\nmodels that can analyze vast amounts of medical data, identify patterns, and provide actionable\ninsights. Combining semantic technologies with ML enhances the accuracy and explainability of\ndisease prediction models. This integration is crucial in the current healthcare landscape, where\nthe demand for precise, personalized, and understandable health recommendations is growing.\nBy improving disease prediction and treatment personalization, these technologies can\nsignificantly enhance patient outcomes and streamline healthcare delivery in\nresource-constrained settings.\nGiven the challenges discussed, we introduce a novel approach called MLtoGAI [5], which\nleverages SWRL for disease classification using explainable AI and ontology. The primary\ncontributions of this paper in response to the study's objectives are:\n1. The development of a comprehensive disease Ontology. Ontologies provide structured\nrepresentations of disease-specific knowledge, capturing and modeling essential\nconcepts, relationships, and attributes relevant to various diseases.\n2. We are implementing the MLtoGAI approach for disease classification based on patient\nsymptoms to detect multiple conditions. By incorporating SWRL reasoning, this\napproach improves the accuracy of disease classification by providing clear explanations\nfor the classification rules.\n3. Utilizing explainable AI(ChatGPT) in our experiments refers to the AI system's ability to\noffer human-understandable explanations for its classifications using different models.\nBy leveraging the power of explainable AI, our goal is to enhance the interpretability and\nreliability of the classification results by providing explanations at the user level.\nThis paper is organized as follows: Section II reviews the related work. Section III\ndescribes the proposed MLtoGAI approach, including dataset description, model architecture,\nknowledge graph development, SWRL rules development, and ChatGPT-based suggestions."}, {"title": "2. Related Work", "content": "This literature review examines the research on methods for classifying diseases. In recent\nyears, increasing interest has been in utilizing AI and semantic technologies to improve disease\nclassification and decision-making in healthcare [6]. Various studies have investigated the\napplication of machine learning, deep learning, ontology-based approaches, rule-based reasoning\n[7], and the integration of explainable AI techniques [8] for disease classification. This section\noffers an overview of related work in the field, emphasizing their contributions and limitations.\nA recent survey [9] identified 966 models developed for analyzing dengue epidemics; of these\nmodels, 545 used regression methods, 220 employed temporal series analysis, 76 utilized neural\nnetworks, and 50 used decision trees to predict dengue outbreaks in tropical countries. The\ndetails of these methodologies and their applications in disease classification are summarized in\nTable 2.\nRule-based reasoning has been extensively used to improve disease classification\naccuracy by incorporating domain-specific knowledge and logical inferences. For example,\nZolhavarieh [10] proposed a rule-based method using the SWRL to classify tuberculosis cases\nbased on clinical symptoms and diagnostic indicators. Their results showed improved accuracy\ncompared to traditional ML algorithms, demonstrating the effectiveness of rule-based reasoning\nin disease classification. Similarly, Sandh et al. [11] introduced a framework that efficiently\nidentifies patients with similar dengue symptoms using a domain thesaurus and case-based\nreasoning techniques that consider relevant keywords. Chandra et al. [7] proposed a Vector-borne\nDisease (VBD) ontology to aid in diagnosing and treating vector-borne diseases. This approach\nuses Resource Description Framework (RDF) medical data to create ontologies specifically for\nthese diseases and employs SWRL rules for diagnosis and treatment. Similarly,\nDevi et al. [12] introduced a method that uses semantic rule-based modeling and\nreasoning to formalize the definition of dengue disease, focusing on operational definitions\n(semantics) to support clinical and diagnostic reasoning. Bensalah et al. [13] presented an\napproach that combines ontology and SWRL inference rules for diagnosing bone tumorsEl\nMassari et al. [14] demonstrated the effectiveness of combining ontology-based methods with\nmachine learning algorithms like Support Vector Machine (SVM), K-Nearest Neighbor(K-NN),\nand Decision Trees (DT) for diabetes prediction. Using SWRL reasoning and ontological models\ncreated in Protege, they enhanced classification accuracy and provided explainable AI for better\ninterpretability. In [15], they explored the use of decision tree algorithms and SWRL rules for\nbreast cancer detection, achieving high prediction accuracy. The study integrated ontologies with\nML techniques, using Web Ontology Language (OWL), SWRL, and a reasoner to distinguish\nbetween malignant and benign cases, emphasizing explainable AI for more precise diagnostic\ninsights."}, {"title": "3. Methodology", "content": "3.1 Architecture of the suggested model\nThe proposed model is developed into three modules: Dataset Formation [21], Ontology\nand ChatGPT-Based System, and User Input and ML Model-Based System. The complete\nworking process is shown in Figure 1."}, {"title": "3.2 Dataset description and Formation", "content": "The table below 3 compares four datasets used for disease prediction, highlighting the\nnumber of diseases and symptoms included in each. The first dataset, \"Disease Symptoms and\nPatient Profile Dataset,\" contains 100 diseases with nine symptoms each. This dataset provides a\nbasic overview of common diseases and their primary symptoms, which can be helpful in\npreliminary disease classification and patient profiling.\nThe second dataset, \"Disease prediction based on symptoms,\" also includes 100 diseases\nbut extends the number of symptoms to 100. This allows for a more detailed analysis and\nimproves the accuracy of disease prediction models. The third dataset, \"Disease and Symptoms\ndataset,\" comprises 41 diseases with a broader range of 394 symptoms, offering a comprehensive\nview of each disease's symptomatology.\nOur proposed dataset's fourth dataset significantly expands the scope, incorporating 265 diseases\nand 590 symptoms. The dataset contains information about these diseases and their possible\nsymptoms, where each row represents a disease, and each column indicates whether a particular\nsymptom is present (1) or not (0). For example, diseases like ADHD are listed with symptoms\nsuch as \"abdomen,\" \"abdominal bloating,\" and \"abdominal cramp,\" marked to show if they occur\nor not. This CSV file helps study the connections between diseases and their symptoms, making\nit useful for medical research and diagnosis. This extensive dataset enhances the model's ability\nto handle various diseases and symptoms, improving the reliability and effectiveness of\npredictions."}, {"title": "3.3 Knowledge graph development", "content": "A knowledge graph [23] organizes information into a network of connected items,\nmaking it easier to search and understand. We can create and manage these networks using\nProt\u00e9g\u00e9, a free software tool. With Prot\u00e9g\u00e9, we can define different categories of information and\nshow how they are related, creating a visual map that people and computers can use to find and\nanalyze data. This approach helps us improve search engines, make recommendations, and\ndevelop intelligent applications. Figure 3 illustrates the class hierarchy for disease names and\nsymptoms. The left side shows two main categories: \"Disease_name\" and \"symptoms.\" When we\nclick on the \"Disease_name\" category at the top, it expands to display 265 diseases, including\nexamples like 'Common Cold,' 'Chronic Kidney Disease' and 'Chlamydia.' Similarly, clicking on\nthe \"symptoms\" category at the bottom reveals 590 symptoms, with examples such as 'abdominal\nbloating,' 'abdominal cramp,' and 'abdominal pain' This hierarchical organization helps efficiently\nmanage and understand the relationships between various diseases and their associated\nsymptoms."}, {"title": "3.4 SWRL rules Development", "content": "SWRL [7] combines Rule Markup Language (RuleML) with OWL by restricting the\ndatalog kernel to classification explanations. In MLtoGAI, operational definitions (semantics)\n[25] within the knowledge base being designed include measures in the form of IF...THEN rules.\nThese rules capture the knowledge required for diagnosis, treatment, types of clinical tests,\nphysical symptoms, and classifying patients based on features. For instance, if an individual Ip\nfrom the patient class is diagnosed with a particular disease and exhibits a symptom X, it can be\ninferred that symptom X belongs to the symptom class of that disease.\nSWRL provides implication rules that enable the integration of Horn logic rules, allowing\nthe construction of complex predicates to incorporate operational definitions (semantics) [26] of\nconcepts in the knowledge base (Golbreich, 2004). The interpretation of a rule depends on its\nspecific context: Production: Condition\u2192Action, General Inference: Premise\u2192Conclusion and\nHypothesis: Cause\u2192Effect."}, {"title": "3.5 Chat GPT based suggestion", "content": "We used a ChatGPT [27] recommendation system in the medical field to improve patient\ncare by giving personalized and timely health advice. This system uses advanced technology to\nunderstand patient questions, medical history, and symptoms. ChatGPT [28] can provide tailored\nrecommendations for treatments, preventive measures, and lifestyle changes by analyzing this\ninformation, ensuring patients receive accurate and relevant information. This helps patients stay\nengaged with their health, supports early diagnosis, and assists healthcare providers by offering\nhelpful insights and suggestions [5],[29]. Additionally, the system keeps learning from\ninteractions, ensuring its recommendations stay up-to-date with the latest medical guidelines and\nresearch, ultimately leading to better patient outcomes and more efficient healthcare. In Figure 7,\ninput symptoms are provided, and ChatGPT [38] offers detailed explanations and\nrecommendations based on those symptoms, showcasing the system's capability to deliver\npersonalized health advice effectively."}, {"title": "3.6 ML Model", "content": "Once we have our dataset ready, we start by splitting it into two parts: 90% for training\nand 10% for testing. This split ensures that we can train the model on a large portion of the data\nand then test its performance on a smaller, separate set. We then apply multiple machine learning"}, {"title": "3.7 User Input and ML Models Based System", "content": "Figure 9 outlines the process of our proposed disease prediction model, which begins\nwith user input. The user provides their symptoms, which are then preprocessed to ensure they\nare in a suitable format for analysis. The system generates symptoms based on the user input,\nwhich are matched using the Jaccard coefficient to identify the best matches. Co-occurring\nsymptoms from the best matches are then selected to refine the prediction further. Next, the\nrefined symptoms undergo prediction, where two parallel processes occur: using TF-idf with\ncosine similarity and an ML model. The TF-idf with cosine similarity process leverages\nhistorical medical data to find diseases with typical symptoms. At the same time, the ML model,\nspecifically using LR, predicts the probable disease based on the final symptoms. LR was chosen\nfor its high accuracy during testing, making it the most reliable algorithm for our purposes. Both\nprocesses contribute to identifying diseases with a Jaccard coefficient greater than 0.5, ensuring\nrobust and reliable predictions."}, {"title": "4. Result and Discussion", "content": "The process begins with a dataset in CSV format that includes disease names and their\nassociated symptoms, which is used to develop an ontology. This ontology helps organize\ndiseases and their relationships with symptoms and other relevant medical information. Based on\nmedical guidelines, SWRL rules are developed to enhance the reasoning capabilities of the\nontology. These rules infer additional information and relationships within the data.\nUser input, typically including reported symptoms, is then processed. The system\ngenerates a list of symptoms from the input, selects the best-matching symptoms using the\nJaccard coefficient, and identifies co-occurring symptoms to refine the prediction. This final set\nof symptoms is used to predict potential diseases using machine learning models, which also\nconsider the user's medical history. The predictions are evaluated for accuracy and reliability\nusing synthetic data from 200 persons to validate the model.\nBased on the evaluated results, ChatGPT provides recommendations, integrating insights\nfrom the ontology and SWRL rules to give comprehensive suggestions. The final output\ncombines the results from the machine learning predictions, SWRL rules, and ChatGPT\nrecommendations, providing the user with suggestions and recommendations for potential\ndiseases and possible next steps. This integrated approach leverages the strengths of\nontology-based knowledge representation, rule-based reasoning, machine learning, and natural\nlanguage processing to offer accurate and comprehensive disease predictions and\nrecommendations."}, {"title": "4.1 SWRL rules based disease prediction using in Protege", "content": "SWRL is a powerful extension of OWL that allows for creating rules within a\nknowledge graph. These rules can be used to make logical inferences and deductions based on\nexisting RDF [34] data and the structure of the ontology. SWRL rules are written as logical\nexpressions and consist of two main parts: the antecedent and the consequent. The antecedent, or\n\"if\" part, specifies the conditions to be met for the rule to be triggered. The resultant, or \"then\"\npart, outlines what actions should be taken if the conditions in the antecedent are satisfied.\nIn simpler terms, SWRL [39] lets you set up \"if-then\" rules that can automatically\ngenerate new information from your existing data. For example, you could have a rule that says,\n\"If a person is a parent of another person, then the first person is an ancestor of the second\nperson.\" When this rule is applied to your data, it will automatically infer and add new ancestor\nrelationships based on the parent relationships you already have. The figure uses a reasoner to\ninfer new information from a patient's (patient_220) medical data. Initially, the patient's data\nincludes various symptoms such as abnormal bleeding, prolonged symptoms, unexplained\nweight loss, a lump, and changes in bowel movement (step 1). \"Pellet\" is used as the reasoner\n(step 2). After running the reasoner, a new assertion is that the patient has cancer,"}, {"title": "4.2 Ml model based disease prediction", "content": "The below graph figure 11 illustrates the accuracy of various machine learning classifiers\nused for disease prediction after performing training and testing on our dataset. The classifiers\nevaluated include MNB [25], RF, KNN [26], LR, SVM, and DT. LR and SVM performed the\nbest, with accuracies of 90.51% and 90.16%, respectively. KNN achieved 86.99%, while RF\nreached 83.30%. MNB had an accuracy of 81.20%, and DT had the lowest accuracy at 77.50%."}, {"title": "4.3 Use case based on complete model", "content": "Figure 12 illustrates the workflow for diagnosing patient_220 and providing\nrecommendations. In Step 1, the patient's details are initially input through the user interface.\nThe information includes the patient's name, age, sex, blood group, height, weight, current\nsymptoms (abnormal bleeding, unexplained weight loss, lump, change in bowel movement,\nprolonged symptoms), and medical history (none)."}, {"title": "4.4 Ontology metrics based evaluation", "content": "Based on the ontology metrics displayed in figure 13, we define Attribute Richness,\nInheritance Richness, Relationship Richness, Attribute-Class Ratio, Equivalence Ratio, Axiom\nClass Ratio, Inverse Relations Ratio, Class Connectivity, Class Fullness, and Class Importance4\n[36], [37], [40] as detailed in figure 13."}, {"title": "4.5 Comparison with existing Work", "content": "Table 9 summarizes the comparison of different approaches to disease prediction using\nmachine learning and ontology-based methods. Grampurohit et al. [32] focus on early detection\nusing Decision tree, Random forest, and Naive Bayes algorithms with a Kaggle dataset,\ndemonstrating a cost-efficient system. Dahiwade et al. [33] also use KNN and CNN with data\nfrom the UCI Repository, finding CNN to be more accurate with 84.5% accuracy. Sharma et al.\n[5] target dengue fever prediction, integrating Semantic Web Rule Language (SWRL) and\nontology with explainable AI, achieving 96% accuracy.\nOur proposed model aims to enhance disease prediction for multiple diseases using machine\nlearning and SWRL. Using data from the CDC, our model leverages ML models, OWL\ndevelopment with Protege, and SWRL to improve prediction accuracy and provide\nuser-understandable explanations. This integrated approach highlights the potential for\ncombining machine learning with semantic technologies to advance disease prediction\ncapabilities."}, {"title": "5. Conclusion and Future Work", "content": "In this paper, we developed a comprehensive model for disease prediction and\nrecommendation by integrating machine learning, ontology development, and explainable Al\ntechniques. The process began with the creation of a dataset that includes disease names and\ntheir associated symptoms, which was then used to develop an ontology. This ontology was\nenhanced with SWRL rules based on medical guidelines, allowing for robust reasoning\ncapabilities. User input, including reported symptoms, was processed to generate a list of\nsymptoms, which were refined and matched using the Jaccard coefficient and co-occurring\nsymptoms. These refined symptoms were then used to predict potential diseases through\nmachine learning models, which were validated using synthetic data from 200 persons. The final\noutput, combining predictions from machine learning models, SWRL rules, and ChatGPT\nrecommendations, provided comprehensive and accurate disease predictions and suggestions.\nThis integrated approach demonstrates the effectiveness of combining ontology-based\nknowledge representation, rule-based reasoning, machine learning, and natural language\nprocessing to improve disease classification and decision-making in healthcare. The use of\nexplainable Al techniques further enhances the transparency and trust in the decision-making\nprocess, providing human-understandable explanations for the predictions and recommendations.\nThis research work has established a strong foundation for integrating advanced\ntechnologies in disease prediction and recommendation, but several areas need further\nenhancement. Expanding the dataset with more diseases and symptoms from reliable sources can\nimprove model robustness and accuracy. Developing a user-friendly interface for symptom input\nand accessing predictions can make the system more accessible to non-experts. Incorporating\nreal-time data from electronic health records (EHRs) and other medical databases can keep the\nontology and prediction models up-to-date. Personalizing recommendations based on patient\nhistories and preferences can improve their relevance and effectiveness. Validating the model\nwith real patient data in clinical settings can ensure accuracy and reliability, paving the way for\npractical use. Integrating data from wearable health devices can enable continuous monitoring\nand early detection of health issues. Implementing a Big Data framework will help manage large\ndatasets for better visualization and analysis. Collaborating with healthcare professionals to\nrefine SWRL rules will ensure recommendations align with clinical guidelines. Addressing these\nareas will enhance the accuracy, reliability, and user-friendliness of tools for disease prediction\nand healthcare decision-making, ultimately improving patient health outcomes."}]}