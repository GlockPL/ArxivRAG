{"title": "Deep Learning-Based Longitudinal Prediction of Childhood Myopia Progression Using Fundus Image Sequences and Baseline Refraction Data", "authors": ["Mengtian Kang", "Yansong Hu", "Shuo Gao", "Yuanyuan Liu", "Hongbei Meng", "Xuemeng Li", "Shengbo Wang", "Xuhang Chen", "Hubin Zhao", "Jing Fu", "Guohua Hu", "Wei Wang", "Yanning Dai", "Arokia Nathan", "Peter Smielewski", "Ningli Wang", "Shiming Li"], "abstract": "Childhood myopia constitutes a significant global health concern. It exhibits an escalating prevalence and has the potential to evolve into severe, irreversible conditions that detrimentally impact familial well-being and create substantial economic costs. Contemporary research underscores the importance of precisely predicting myopia progression to enable timely and effective interventions, thereby averting severe visual impairment in children. Such predictions predominantly rely on subjective clinical assessments, which are inherently biased and resource-intensive, thus hindering their widespread application. In this study, we introduce a novel, high-accuracy method for quantitatively predicting the myopic trajectory and myopia risk in children using only fundus images and baseline refraction data. This approach was validated through a six-year longitudinal study of 3,408 children in Henan, utilizing 16,211 fundus images and corresponding refractive data. Our method based on deep learning demonstrated predictive accuracy with an error margin of 0.311D per year and achieved area under the curve (AUC) scores of 0.944 and 0.995 for forecasting the risks of developing myopia and high myopia, respectively. These findings confirm the utility of our model in supporting early intervention strategies and in significantly reducing healthcare costs, particularly by obviating the need for additional metadata and repeated consultations. Furthermore, our method was designed to rely only on fundus images and refractive error data, without the need for meta data or multiple inquiries from doctors, strongly reducing the associated medical costs and facilitating large-scale screening. To serve impoverished areas where people face difficulties in visiting medical institutions, our model can even provide good predictions based on only a single time measurement. Consequently, the proposed method is an important means to reduce medical inequities caused by economic disparities.", "sections": [{"title": "Introduction", "content": "High myopia is a prevalent global health concern, and is anticipated to affect over 1 billion individuals by 2050\u00b9. This condition and its associated complications, including amblyopia, strabismus, and retinal detachment, significantly increase the risk of severe ophthalmologic conditions such as cataracts and glaucoma, potentially leading to permanent vision loss and representing a primary cause of blindness worldwide. Given the irreversible progression of high myopia, early intervention for at-risk individuals is recognized as the most effective preventive strategy2,3. Empirical evidence indicates a strong correlation between the onset of myopia in childhood and the later development of high myopia and related complications during adolescence and adulthood. Consequently, proactive and timely treatment of childhood myopia is crucial to prevent escalation of the disorder into more severe conditions. However, addressing this issue effectively poses significant challenges for the following three reasons.\nFirst, while studies indicate that pharmacologic interventions can reduce myopic progression by over 70% in children aged 6 to 13 years, the lack of predictive ability regarding individual myopic trajectories impedes timely and targeted treatment. Second, traditional methods for assessing and predicting myopia trends heavily rely on subjective assessments by specialists, leading to significant variability in predictions and placing a substantial strain on regional medical resources. Third, the prevalence of childhood myopia is alarmingly high and continues to rise, with the World Health Organization reporting global rates of 40% and figures exceeding 90% in some Asian countries such as South Korea'. Contemporary research often utilizes machine learning models that incorporate multidimensional data, including lifestyle, physiological, and genetic factors, to forecast myopia risk in children17,18,19. However, these methods require extensive data and are currently inadequate for early detection among the vast population in his age group. There is thus a pressing need for scalable techniques capable of accurately predicting myopia progression at early stages to facilitate effective intervention.\nAchieving large-scale childhood myopia screening has long been considered a \"mission impossible.\" However, the rapid advancements in imaging technology and artificial intelligence have now made this goal feasible. Fundus imaging technology, which is non-invasive and cost-effective (with specialized equipment priced below $10,00027, significantly lower than OCT at over $60,00028 and MRI at over $1,000,00029), is ideal for widespread use. Fundus images offer a wealth of deep biomarker data that are crucial for understanding the pathology of myopia. The advent of deep learning has further enabled the extraction and analysis of complex data from these"}, {"title": "Results", "content": "Study Design and Data Characteristics. The Anyang Childhood Eye Study (ACES) was a school-based cohort study to determine the annual rate of the incidence of, progression of, and risk factors for myopia among Chinese children in the urban areas of Anyang city, Henan province, and central China. In brief, we recruited 3,408 grade 1 students from 11 randomly selected primary schools from February to May 2012. These students were followed annually for five years. In total, 16,211 macula-centered fundus images with a 45\u00b0 field of view were utilized to develop and internally validate our deep learning model, as depicted in Figure 1. This model was used to process n (1~5) years of fundus image sequences and corresponding optometric data to predict the future risk of myopia and high myopia, along with refractive errors for m (5~1) subsequent years. Due to incomplete longitudinal data, we partitioned the dataset into training and validation sets in a 5:1 ratio, maintaining consistent feature proportions across both. The internal validation dataset included 56.7% male subjects with baseline myopia and high myopia prevalence of 5.68% and 0.07%, respectively, which increased to 59.27% and 1.90% after five years. We further validated the model's generalizability through an external dataset from Henan, yielding comparable results over a three-year period. Additional demographic and ocular baseline characteristics, as well as five-year follow-up data, are detailed in Supplementary Table 1.\nMethod Performance and Model Explainability. As depicted in Figure 4, our methodology demonstrated robust performance in predicting future myopia progression in children using minimal data. In internal validations, the accuracy for predicting sixth-year myopia risk using 1~5 years image sequences was 78.3%, 78.6%, 79.6%, 87.3%, and 89.1%, respectively. For high myopia, the accuracy was 99.5%, 97.9%, 97%, 98.4%, and 99.2%. Details for the other years are presented in Table 2 and Figure 2. The absolute mean errors in predicting myopic equivalent spherical refractive errors over the next 1-4 years using a 2-year sequence were 0.353 D, 0.517 D, 0.773 D, and 0.912 D, respectively; additional data for other durations are also provided in Table 2 and Figure 3. Our method significantly outperformed diagnostics using traditional data, as shown in Table 3. Figure 6 illustrates the model's physiologically relevant focus areas in enhanced fundus images, highlighting key features around the macula and vascular structures near the optic disc. This focus suggests potential paths for future pathological studies on childhood myopia prediction.\nSubgroup Analysis. We evaluated potential performance biases within different characteristic groups of children, as illustrated in Figure 5. The MAE of quantitative prediction errors for males and females differed by less than 5%, and the predicted ROC curves at different sequence lengths also remained generally consistent. This result suggests that gender has little effect on the performance of our model. For children's initial myopic status, the model's errors in predicting the quantitative future development of myopia for initially myopic children were significantly greater than those for initially nonmyopic children, with a difference of nearly 50%, suggesting that the initial state of myopia has a greater impact on errors in predicting the quantitative development of future myopia. However, when employing relative error measurements, the prediction discrepancies between these groups can also align closely since initially myopic children are themselves more refractive in absolute terms.\nFurther Results of Myopia Prediction. In addition to quantitative regression predictions of myopia progression trajectory, we also provide two different methods for future myopia risk classification predictions. These methods can use the newly trained classifier in the model or directly apply the refractive index prediction results for classification. A comparison of the results under these two different methods can be found in Table 2. Specifically, when the refractive index predictions are used directly for classification, a curve of different predicted myopia versus classification accuracies was obtained by comparing the classification thresholds with the accuracy. As shown in Figure 3, the accuracy values at X=-6 and X=-0.5 on this curve correspond to the predictive ability for high myopia and average myopia risk, respectively. Notably, this curve reflects the distribution in the degree of inconsistency between the model predictions and the true distribution, which offers rich in in-depth information, and the lowest point of the curve, which reflects the most inconsistent categorization thresholds. This curve show the most difficult-to-discriminate and widespread trends in myopia development within this population, which offers insights into regional myopia progression patterns among children."}, {"title": "Discussion", "content": "In this study, we introduce a novel method to assess the risk of myopia and high myopia and quantitatively predict the developmental trajectory of refractive errors in children. Our approach leverages sequences of fundus images combined with refractive error data to make predictions, achieving remarkable average prediction AUCs of 0.944 and 0.995 for the incidence probability of myopia and high myopia, respectively, along with a mean absolute error (MAE) in SER predictions of approximately 0.3 D per year. Notably, our model requires only fundus images and baseline refractive data, obviating the need for additional patient information such as ocular biological, lifestyle, or environmental parameters. Moreover, our model can generate reliable forecasts from a single clinical encounter. For instance, utilizing one year's data from a single visit can yield AUCs of 0.910 and 0.996 for predicting the risk of myopia and high myopia three years later, with a refractive error prediction MAE of 0.257 D/year. To our knowledge, this is the first methodology that achieves high-precision predictions of myopia and quantitatively charts the progression of SER solely using fundus images and baseline refractive error data. We further elaborate on the technical and practical merits, societal impacts, and other dimensions of our method in subsequent sections.\nOur methodology represents a significant advancement in extracting in-depth information from fundus images. While artificial intelligence models based on fundus images have been extensively used to diagnose a variety of ocular diseases such as glaucoma, diabetic retinopathy, and pathological myopia, including both current status assessments and progression predictions\", myopia remains a challenge due to its higher prevalence and less distinct features compared to other conditions\u00b9. Unlike diseases such as glaucoma, which is characterized by specific optic nerve and blood vessel structures22, diabetic retinopathy, marked by microaneurysms and hemorrhages23, and pathological myopia, which present features such as a tessellated retina\u00b9\u00b9, normal myopia lacks readily discernible features, complicating the development of accurate prediction models. In response, some researchers have integrated multi-dimensional data, including lifestyle, parental myopia history, and other ocular examinations, into machine learning and decision-making frameworks to enhance myopia risk prediction. For instance, Karla Zadnik et al. successfully forecasted myopia in children aged 7 to 13 using factors such as the baseline spherical equivalent refractive error and parental myopia history, achieving predictive accuracy with an area under the curve between 0.87 and 0.9324. Similarly, Haotian Lin et al. utilized longitudinal electronic pathology data from multiple eye centers in China, employing annual myopia progression rates and other metrics to predict high myopia risk over a decade with remarkable precision in external validation datasets and achieving a minimum mean absolute error below 0.3 D, as well as an area under the curve of up to 0.97619. However, these approaches often require substantial data and time commitments, leading to significant resource consumption, which poses challenges in medically underserved regions. There have also been efforts to combine fundus images with baseline refractive data to predict high myopia risk. For example, Li Lian Foo et al. employed a hybrid model and achieved an AUC of 0.97 over five years15. Nonetheless, these methods generally predict long-term high myopia risks but struggle with providing short-term forecasts or a quantitative trajectory of myopia development.\nOur technique advances the use of fundus images through a well-designed preprocessing system (incorporating high-boosting filter, channel transformers, and contrast limited adaptive histogram equalization, as shown in Figure 6 in the Supplementary Information) to accentuate physiological characteristics. This step facilitates feature extraction when using a convolutional neural network, which is further enhanced by a temporal neural network integrating baseline refractive data. Our method successfully captured the underlying deep information related to myopia from the fundus images, as well as temporal information in fundus sequences, enabling the quantitative prediction of general myopia with indistinct symptoms. The results indicate three categories of benefits: data efficiency (requiring minimal data, typically collected in a single visit), predictive versatility (capable of both short-term and long-term forecasts for general and high myopia, while also providing quantitative trajectories of myopia progression), and prediction accuracy (achieving an AUC of 0.944 for myopia and 0.995 for high myopia risk prediction, with an average MAE at 0.311 D/year for the quantitative prediction of spherical equivalent refraction), as illustrated in Figure 4. This methodology not only enhances the feasibility of widespread myopia screening but also reduces the related healthcare burden, offering robust support for the early intervention and management of childhood myopia.\nDue to innovative technical advances, our method presents two significant advantages in practical applications. Firstly, this method can be swiftly implemented in regions with limited medical resources, as it requires data from only a single visit, which can save significant time and labor. Additionally, our method exhibits remarkable flexibility. The proposed technique not only captures depth information on myopia progression but also integrates temporal information between fundus sequences to obtain more accurate predictions. Therefore, this method can accommodate varying lengths (ranging from one to five years) of fundus images and equivalent spherical refractive error sequence data. This flexibility allows our approach to fully leverage the existing information from subject children, whether they have prior data or are new subjects, thereby optimizing the use of medical resources. Secondly, through an analysis of fundus photography, our method can identify potential factors and new biomarkers related to the general development of myopia in children. This factor is illustrated by the heat maps generated using the model, as shown in Figure 6. We employed technologies such as Grad-CAM25 and Guided-Backpropagation26 to visualize the model heat maps on both the enhanced pre-processed and original fundus images. These heat maps show certain key features considered by the model, such as blood vessel structures connected to the optic disc and peripheral features around the macula. It can be seen that the fundus features related to rapid myopia progression are mainly concentrated in the optic disc, macular area, superior temporal and inferior temporal retinal areas. These results are somewhat consistent with the areas of fundus lesions in high myopia, including maculopathy, dome-shaped macula, myopia-associated glaucoma-like neuropathy, and posterior staphyloma. These characteristics suggest underlying genetic information pertinent to myopia development in children, marking a departure from the biomarkers currently used for myopia diagnosis. Historically, clinicians have struggled to predict myopia progression using fundus images. Our research advances the analysis of myopia characterization in fundus imagery, contributes to ophthalmic pathology research, and supports the discovery of novel biomarkers.\nOur deep learning method for predicting childhood myopia significantly enhances the feasibility of large-scale risk screening in primary and rural hospitals with limited medical resources. Unlike traditional screening processes that depend heavily on extensive clinical data from specialized equipment and subjective assessments by experienced ophthalmologists, our approach requires only fundus images and historical refractive data to predict long-term high myopia risk. Thus, this method substantially lowers screening costs and increases operational efficiency. Effective screening enables early intervention for children at high risk of developing high myopia, thereby optimizing resource use in medically underserved areas by reducing unnecessary ophthalmologic consultations for low-risk cases. Additionally, our technique generates personalized, quantitative forecasts of myopia progression (refer to Results Figure 3, where green dashes indicate known data; red, our predictions; and blue, actual outcomes). This predictive capability will not only facilitate timely interventions but also help determine the most appropriate timing, type, and intensity of preventive measures tailored to individual risk profiles, particularly in children identified as high risk. Such targeted interventions are likely to improve the efficacy and reliability of managing potential high myopia, mitigating the escalating global prevalence of myopia among children. Furthermore, our deep learning method to accurately predict childhood myopia developmental trajectories opens avenues for future research, particularly in investigating the correlation between early intervention and future myopic characteristics. This factor represents a pivotal direction for advancing our understanding and management of childhood myopia.\nAdditionally, our study contributes positively to bridging the urban rural divide and narrowing socioeconomic disparities. Myopia represents a significant global impediment to workforce productivity30. In impoverished regions, children often lack timely interventions and treatments for myopia, leading to exacerbated myopia in adulthood. This myopia, profoundly impacts both livelihoods and productivity, thereby perpetuating regional disparities. Relevant data underscore the economic toll of myopia, with East Asia, South Asia, and Southeast Asia experiencing GDP losses of nearing 1.5%. East Asia alone has exceeded $140 billion in productivity losses. Conversely, regions such as Western Europe and Australia, where early myopia receives professional intervention, have experienced GDP losses under 0.1% and productivity losses under $10 billion\u00b3\u00b9. Hence, our research offers promise in addressing medical resource disparities and economic imbalances. Long-term myopia or high myopia in childhood is also significantly correlated with psychological disorders, notably contributing to pathological anxiety among teenagers, with a correlation coefficient of p < 0.0532. Moreover, the progression to high myopia and even pathological myopia markedly increases the incidence of depression and anxiety disorders by over 20%32. Additionally, childhood myopia serves as a prominent factor in school bullying, with nearly 48.9% of myopic children fearing ridicule and bullying for wearing glasses, deterring them from wearing corrective eyewear33. Given the efficacy of our method in universal screening and developmental predictions, widespread adoption of this method in childhood myopia prevention and intervention holds promise in effectively mitigating school bullying and youth depression.\nThere are also certain limitations to our study, the most important being the generalization performance of deep learning systems when deployed in clinical settings. Achieving robust generalization necessitates a diverse training dataset. Our study built a prediction model using the same cohort in central China. However, testing the model in other populations will be necessary to evaluate its generalizability, particularly for individuals of East Asian descent. Mitigating these biases would be possible by fine-tuning the model and, using the model with local datasets for retraining and adjustments in future applications. To enhance the model's efficacy, subsequent work should aim to incorporate data encompassing a broader spectrum of regions and ethnicities. Another significant limitation of the present study is the underrepresentation of high myopia in our dataset, which compromises the model's sensitivity to this condition due to its infrequency. Future research should, therefore, prioritize the collection of a more comprehensive dataset to address this imbalance. Additionally, the predominance of children with stable myopia progression in the dataset may introduce a systematic bias against those exhibiting rapid progression. However, this factor is consistent with the general characteristics of the population. Children with severe myopia progression are of significant concern to the model and physicians. In addition, errors for children with higher levels of progress are acceptable when considered from perspective of view of relative errors."}, {"title": "Methods", "content": "Study participants. This school-based cohort study (ACES) recruited 3,408 grade 1 students aged 7.1 \u00b1 0.4 years (range, 6-9 years) attending 11 randomly selected primary schools from February to May 2012. The selected students were followed annually for five years, resulting in a total of 16,211 fundus images. Each participant underwent a comprehensive dilated pupil optometry test administered by a trained medical professional, with meticulous statistical analysis and documentation conducted thereafter. Fundus images were captured by skilled operators employing a Canon CR-2 non-dilated fundus camera (Canon Inc, Tokyo, Japan). Two fundus photographs of the right eye were taken for each subject, with a 45\u00b0 field of view, centred around both the optic disc and the macula. For subsequent analysis, this study primarily utilized a fundus photograph of the right eye centred around the macula. All children provided a written informed consent form signed by their parents, and verbal consent was also obtained from each child. This study adhered to the tenets of the Declaration of Helsinki. Ethics committee approval was obtained from the Institutional Review Board of Beijing Tongren Hospital, Capital Medical University.\nDefinitions of myopia. Spherical equivalent refraction (SER, sometimes abbreviated to SE) was defined as the sum of spherical power and half of the cylinder. In this study, myopia was characterized and classified based on the SER to reflect the severity and progression of the disorder. Myopia was defined as a SER of -0.5 D or less, individuals with an SER below -6.0 diopters (D) were categorized as having high myopia, those with an SER between -6.0 D and -3.0 D were classified as having moderate myopia, individuals with an SER between -3.0 D and -0.5 D were categorized as having low myopia, those with an SE between -0.5 D and +3.0 D were classified as emmetropic or having low hyperopia, and those with an SER above +3.0 D were considered hyperopic48. The annual progression of myopia was defined as the change in cycloplegic SER between the measurements acquired in the previous year and the measurements taken during the annual follow-up period. Rapid myopia progression was defined as an increase in the myopic spherical equivalent of more than 0.75 D/year among myopic children, while those with an average annual SER progression of less than 0.50 D were labelled as having non-progressive myopia.\nImage preprocessing and enhancement technology. To ensure the quality of the training data, we developed an image preprocessing and enhancement system, as illustrated in Figure 6 of the Supplementary Information. This system was tailored for the model's requirements. Initially, considering the model's memory constraints, and the clarity and informational content of the images, we standardized the input size to 512 * 512 * 3 through cropping and scaling. Additionally, the original fundus images sometimes contained various defects, such as exposure abnormalities, colour irregularities, and incomplete optic discs, as depicted in Figure 6 of the Supplementary Information. Such defects can adversely impact subsequent training outcomes. Hence, we manually devised three criteria for image filtering: the bright area proportion, representing pixels with grey values greater than the average plus three times the standard deviation (not exceeding 255); the dark area proportion, denoting pixels with grey values lower than the average minus the standard deviation (not less than 5); and the red-blue difference, indicating the disparity between the grey sum of pixels in the red channel and the grey sum in the blue channel. The formula for computing these filtering conditions is presented in Figure 6 of the Supplementary Information. To enhance physiological features such as the optic disc and blood vessels in fundus images while mitigating brightness and contrast disparities among different images (as illustrated in Figure 6 of the Supplementary Information), we also implemented a novel feature enhancement algorithm. This algorithm combines CLAHE (Contrast Constrained Local Histogram Equalization) and High"}, {"title": "Development of the deep-learning algorithms.", "content": "We developed a multi-year myopia prediction network (MMPN) by implementing a model integration strategy. As shown in Figure 5 of the Supplementary Information, in the MMPN, model 1 belonged to the encoder component, through which features are extracted from the input image sequence using the ResNet34 structure based on the CNN architecture and retained in the final convolutional layer. These feature maps are then converted into feature vectors using global average pooling and spliced with the refractive index sequence feature values as the final output of the encoding part, which also serves as the input for the decoding component. Model 2 belongs to the decoding component, which utilizes the LSTM structure in the RNN architecture to process temporal information and perform predictions, outputting the future refractive index sequence. For myopia or high myopia risk predictions, the output must also pass through the fully connected layer classifier, which outputs the risk classification result. The model was trained using Python 1.12.0 as a whole and accelerated using an A5000-24G graphics card. The batch size was set to 8 for the training set and 2 for the validation and test sets. The training process was divided into three phases with learning rates of 1e-3, 1e-4, and le-5, for which the number of training rounds was 40, 20, and 10, respectively. The CNN skeleton in model 1 used pre-trained ResNet34 parameters from ImageNet data to initialize the network parameters. The optimization algorithm used Adam's algorithm, the weight-decay parameter was set to 0 in the first period and le-4 in the last two periods, and the other parameters were set using the defaults."}, {"title": "Evaluating the algorithms.", "content": "To evaluate the overall performance of the model, we used two types of basic metrics: 1) the accuracy, specificity, and sensitivity, alongside the ROC curves and AUC areas for predicting the risk of future myopia and high myopia in children and 2) the MAE error for quantitatively predicting refractive error progression49. The results of the evaluation are shown in Table 2."}, {"title": "Sub-group analysis.", "content": "To assess the effects of factors such as age, gender, and myopia on model performance, we conducted a subgroup analysis. We divided the data into male and female groups, as well as myopic and non-myopic groups, for model validation. The results of the subgroup analysis are shown in Figure 5."}, {"title": "Model explanation.", "content": "When diagnosing general myopia in children and predicting the degree of development, we used visual interpretation tools to understand which regions in the fundus image had the greatest impact on our deep learning model, as shown in Figure 6. We used techniques such as gradient CAM and guided backpropagation to draw weight heatmaps for the model. These maps were used to predict future high myopia risk and quantitatively predict the refractive index. These two technologies offer different methods to attribute some of the network's contributions to the regions in the image. This flexibility enables our model to provide better support for clinical decision-making among doctors, while also contributing to the development of related medical and pathological research."}, {"title": "Data availability.", "content": "Primary fundus images supporting the results of this study, labelling data, and more specific optometric results and medical record data are available upon request from the corresponding author."}, {"title": "Code availability.", "content": "Our deep learning network model was developed using the standard model library and script in Python 1.12.0. The code for fundus image preprocessing technology and deep learning network model construction and training verification was published on GitHub:\nhttps://github.com/19376357/Myopia-prediction-model/tree/main."}]}