{"title": "Deep Learning-Based Longitudinal Prediction of Childhood Myopia Progression Using Fundus Image Sequences and Baseline Refraction Data", "authors": ["Mengtian Kang", "Yansong Hu", "Shuo Gao", "Yuanyuan Liu", "Hongbei Meng", "Xuemeng Li", "Shengbo Wang", "Xuhang Chen", "Hubin Zhao", "Jing Fu", "Guohua Hu", "Wei Wang", "Yanning Dai", "Arokia Nathan", "Peter Smielewski", "Ningli Wang", "Shiming Li"], "abstract": "Childhood myopia constitutes a significant global health concern. It exhibits an escalating prevalence and has the potential to evolve into severe, irreversible conditions that detrimentally impact familial well-being and create substantial economic costs. Contemporary research underscores the importance of precisely predicting myopia progression to enable timely and effective interventions, thereby averting severe visual impairment in children. Such predictions predominantly rely on subjective clinical assessments, which are inherently biased and resource-intensive, thus hindering their widespread application. In this study, we introduce a novel, high-accuracy method for quantitatively predicting the myopic trajectory and myopia risk in children using only fundus images and baseline refraction data. This approach was validated through a six-year longitudinal study of 3,408 children in Henan, utilizing 16,211 fundus images and corresponding refractive data. Our method based on deep learning demonstrated predictive accuracy with an error margin of 0.311D per year and achieved area under the curve (AUC) scores of 0.944 and 0.995 for forecasting the risks of developing myopia and high myopia, respectively. These findings confirm the utility of our model in supporting early intervention strategies and in significantly reducing healthcare costs, particularly by obviating the need for additional metadata and repeated consultations. Furthermore, our method was designed to rely only on fundus images and refractive error data, without the need for meta data or multiple inquiries from doctors, strongly reducing the associated medical costs and facilitating large-scale screening. To serve impoverished areas where people face difficulties in visiting medical institutions, our model can even provide good predictions based on only a single time measurement. Consequently, the proposed method is an important means to reduce medical inequities caused by economic disparities.", "sections": [{"title": "Introduction", "content": "High myopia is a prevalent global health concern, and is anticipated to affect over 1 billion individuals by 2050\u00b9. This condition and its associated complications, including amblyopia, strabismus, and retinal detachment, significantly increase the risk of severe ophthalmologic conditions such as cataracts and glaucoma, potentially leading to permanent vision loss and representing a primary cause of blindness worldwide. Given the irreversible progression of high myopia, early intervention for at-risk individuals is recognized as the most effective preventive strategy2,3. Empirical evidence indicates a strong correlation between the onset of myopia in childhood and the later development of high myopia and related complications during adolescence and adulthood. Consequently, proactive and timely treatment of childhood myopia is crucial to prevent escalation of the disorder into more severe conditions. However, addressing this issue effectively poses significant challenges for the following three reasons.\nFirst, while studies indicate that pharmacologic interventions can reduce myopic progression by over 70% in children aged 6 to 13 years, the lack of predictive ability regarding individual myopic trajectories impedes timely and targeted treatment. Second, traditional methods for assessing and predicting myopia trends heavily rely on subjective assessments by specialists, leading to significant variability in predictions and placing a substantial strain on regional medical resources. Third, the prevalence of childhood myopia is alarmingly high and continues to rise, with the World Health Organization reporting global rates of 40% and figures exceeding 90% in some Asian countries such as South Korea'. Contemporary research often utilizes machine learning models that incorporate multidimensional data, including lifestyle, physiological, and genetic factors, to forecast myopia risk in children17,18,19. However, these methods require extensive data and are currently inadequate for early detection among the vast population in his age group. There is thus a pressing need for scalable techniques capable of accurately predicting myopia progression at early stages to facilitate effective intervention.\nAchieving large-scale childhood myopia screening has long been considered a \"mission impossible.\" However, the rapid advancements in imaging technology and artificial intelligence have now made this goal feasible. Fundus imaging technology, which is non-invasive and cost-effective (with specialized equipment priced below $10,00027, significantly lower than OCT at over $60,00028 and MRI at over $1,000,00029), is ideal for widespread use. Fundus images offer a wealth of deep biomarker data that are crucial for understanding the pathology of myopia. The advent of deep learning has further enabled the extraction and analysis of complex data from these"}, {"title": "Results", "content": "Study Design and Data Characteristics. The Anyang Childhood Eye Study (ACES) was a school-based cohort study to determine the annual rate of the incidence of, progression of, and risk factors for myopia among Chinese children in the urban areas of Anyang city, Henan province, and central China. In brief, we recruited 3,408 grade 1 students from 11 randomly selected primary schools from February to May 2012. These students were followed annually for five years. In total, 16,211 macula-centered fundus images with a 45\u00b0 field of view were utilized to develop and internally validate our deep learning model, as depicted in Figure 1. This model was used to process n (1~5) years of fundus image sequences and corresponding optometric data to predict the future risk of myopia and high myopia, along with refractive errors for m (5~1) subsequent years. Due to incomplete longitudinal data, we partitioned the dataset into training and validation sets in a 5:1 ratio, maintaining consistent feature proportions across both. The internal validation dataset included 56.7% male subjects with baseline myopia and high myopia prevalence of 5.68% and 0.07%, respectively, which increased to 59.27% and 1.90% after five years. We further validated the model's generalizability through an external dataset from Henan, yielding comparable results over a three-year period. Additional demographic and ocular baseline characteristics, as well as five-year follow-up data, are detailed in Supplementary Table 1.\nMethod Performance and Model Explainability. As depicted in Figure 4, our methodology demonstrated robust performance in predicting future myopia progression in children using minimal data. In internal validations, the accuracy for predicting sixth-year myopia risk using 1~5 years image sequences was 78.3%, 78.6%, 79.6%, 87.3%, and 89.1%, respectively. For high myopia, the accuracy was 99.5%, 97.9%, 97%, 98.4%, and 99.2%. Details for the other years are presented in Table 2 and Figure 2. The absolute mean errors in predicting myopic equivalent spherical refractive errors over the next 1-4 years using a 2-year sequence were 0.353 D, 0.517 D, 0.773 D, and 0.912 D, respectively; additional data for other durations are also provided in Table 2 and Figure 3. Our method significantly outperformed diagnostics using traditional data, as shown in Table 3. Figure 6 illustrates the model's physiologically relevant focus areas in enhanced fundus images, highlighting key features around the macula and vascular structures near the optic disc. This focus suggests potential paths for future pathological studies on childhood myopia prediction.\nSubgroup Analysis. We evaluated potential performance biases within different characteristic groups of children, as illustrated in Figure 5. The MAE of quantitative prediction errors for males and females differed by less than 5%, and the predicted ROC curves at different sequence lengths also remained generally consistent. This result suggests that gender has little effect on the performance of our model. For children's initial myopic status, the model's errors in predicting the quantitative future development of myopia for initially myopic children were significantly greater than those for initially nonmyopic children, with a difference of nearly 50%, suggesting that the initial state of myopia has a greater impact on errors in predicting the quantitative development of future myopia. However, when employing relative error measurements, the prediction discrepancies between these groups can also align closely since initially myopic children are themselves more refractive in absolute terms.\nFurther Results of Myopia Prediction. In addition to quantitative regression predictions of myopia progression trajectory, we also provide two different methods for future myopia risk classification predictions. These methods can use the newly trained classifier in the model or directly apply the refractive index prediction results for classification. A comparison of the results under these two different methods can be found in Table 2. Specifically, when the refractive index predictions are used directly for classification, a curve of different predicted myopia versus classification accuracies was obtained by comparing the classification thresholds with the accuracy. As shown in Figure 3, the accuracy values at X=-6 and X=-0.5 on this curve correspond to the predictive ability for high myopia and average myopia risk, respectively. Notably, this curve reflects the distribution in the degree of inconsistency between the model predictions and the true distribution, which offers rich in in-depth information, and the lowest point of the curve, which reflects the most inconsistent categorization thresholds. This curve show the most difficult-to-discriminate and widespread trends in myopia development within this population, which offers insights into regional myopia progression patterns among children."}, {"title": "Discussion", "content": "In this study, we introduce a novel method to assess the risk of myopia and high myopia and quantitatively predict the developmental trajectory of refractive errors in children. Our approach leverages sequences of fundus images combined with refractive error data to make predictions, achieving remarkable average prediction AUCs of 0.944 and 0.995 for the incidence probability of myopia and high myopia, respectively, along with a mean absolute error (MAE) in SER predictions of approximately 0.3 D per year. Notably, our model requires only fundus images and baseline refractive data, obviating the need for additional patient information such as ocular biological, lifestyle, or environmental parameters. Moreover, our model can generate reliable forecasts from a single clinical encounter. For instance, utilizing one year's data from a single visit can yield AUCs of 0.910 and 0.996 for predicting the risk of myopia and high myopia three years later, with a refractive error prediction MAE of 0.257 D/year. To our knowledge, this is the first methodology that achieves high-precision predictions of myopia and quantitatively charts the progression of SER solely using fundus images and baseline refractive error data. We further elaborate on the technical and practical merits, societal impacts, and other dimensions of our method in subsequent sections.\nOur methodology represents a significant advancement in extracting in-depth information from fundus images. While artificial intelligence models based on fundus images have been extensively used to diagnose a variety of ocular diseases such as glaucoma, diabetic retinopathy, and pathological myopia, including both current status assessments and progression predictions"}, {"title": "Methods", "content": "Study participants. This school-based cohort study (ACES) recruited 3,408 grade 1 students aged 7.1 \u00b1 0.4 years (range, 6-9 years) attending 11 randomly selected primary schools from February to May 2012. The selected students were followed annually for five years, resulting in a total of 16,211 fundus images. Each participant underwent a comprehensive dilated pupil optometry test administered by a trained medical professional, with meticulous statistical analysis and documentation conducted thereafter. Fundus images were captured by skilled operators employing a Canon CR-2 non-dilated fundus camera (Canon Inc, Tokyo, Japan). Two fundus photographs of the right eye were taken for each subject, with a 45\u00b0 field of view, centred around both the optic disc and the macula. For subsequent analysis, this study primarily utilized a fundus photograph of the right eye centred around the macula. All children provided a written informed consent form signed by their parents, and verbal consent was also obtained from each child. This study adhered to the tenets of the Declaration of Helsinki. Ethics committee approval was obtained from the Institutional Review Board of Beijing Tongren Hospital, Capital Medical University.\nDefinitions of myopia. Spherical equivalent refraction (SER, sometimes abbreviated to SE) was defined as the sum of spherical power and half of the cylinder. In this study, myopia was characterized and classified based on the SER to reflect the severity and progression of the disorder. Myopia was defined as a SER of -0.5 D or less, individuals with an SER below -6.0 diopters (D) were categorized as having high myopia, those with an SER between -6.0 D and -3.0 D were classified as having moderate myopia, individuals with an SER between -3.0 D and -0.5 D were categorized as having low myopia, those with an SE between -0.5 D and +3.0 D were classified as emmetropic or having low hyperopia, and those with an SER above +3.0 D were considered hyperopic48. The annual progression of myopia was defined as the change in cycloplegic SER between the measurements acquired in the previous year and the measurements taken during the annual follow-up period. Rapid myopia progression was defined as an increase in the myopic spherical equivalent of more than 0.75 D/year among myopic children, while those with an average annual SER progression of less than 0.50 D were labelled as having non-progressive myopia.\nImage preprocessing and enhancement technology. To ensure the quality of the training data, we developed an image preprocessing and enhancement system, as illustrated in Figure 6 of the Supplementary Information. This system was tailored for the model's requirements. Initially, considering the model's memory constraints, and the clarity and informational content of the images, we standardized the input size to 512 * 512 * 3 through cropping and scaling. Additionally, the original fundus images sometimes contained various defects, such as exposure abnormalities, colour irregularities, and incomplete optic discs, as depicted in Figure 6 of the Supplementary Information. Such defects can adversely impact subsequent training outcomes. Hence, we manually devised three criteria for image filtering: the bright area proportion, representing pixels with grey values greater than the average plus three times the standard deviation (not exceeding 255); the dark area proportion, denoting pixels with grey values lower than the average minus the standard deviation (not less than 5); and the red-blue difference, indicating the disparity between the grey sum of pixels in the red channel and the grey sum in the blue channel. The formula for computing these filtering conditions is presented in Figure 6 of the Supplementary Information. To enhance physiological features such as the optic disc and blood vessels in fundus images while mitigating brightness and contrast disparities among different images (as illustrated in Figure 6 of the Supplementary Information), we also implemented a novel feature enhancement algorithm. This algorithm combines CLAHE (Contrast Constrained Local Histogram Equalization) and High"}, {"title": "Segmentation and distribution characteristics of datasets.", "content": "To guarantee the reproducibility of our findings, we employed a consistent random seed to partition the dataset randomly into a training set and a test set, while preserving the underlying distributional properties of the data. For temporal prediction tasks across varying years, we systematically segregated sequences of differing lengths into training and validation sets in a 5:1 ratio, ensuring that key data attributes, such as the prevalence of myopia, remained constant."}, {"title": "Development of the deep-learning algorithms.", "content": "We developed a multi-year myopia prediction network (MMPN) by implementing a model integration strategy. As shown in Figure 5 of the Supplementary Information, in the MMPN, model 1 belonged to the encoder component, through which features are extracted from the input image sequence using the ResNet34 structure based on the CNN architecture and retained in the final convolutional layer. These feature maps are then converted into feature vectors using global average pooling and spliced with the refractive index sequence feature values as the final output of the encoding part, which also serves as the input for the decoding component. Model 2 belongs to the decoding component, which utilizes the LSTM structure in the RNN architecture to process temporal information and perform predictions, outputting the future refractive index sequence. For myopia or high myopia risk predictions, the output must also pass through the fully connected layer classifier, which outputs the risk classification result. The model was trained using Python 1.12.0 as a whole and accelerated using an A5000-24G graphics card. The batch size was set to 8 for the training set and 2 for the validation and test sets. The training process was divided into three phases with learning rates of 1e-3, 1e-4, and le-5, for which the number of training rounds was 40, 20, and 10, respectively. The CNN skeleton in model 1 used pre-trained ResNet34 parameters from ImageNet data to initialize the network parameters. The optimization algorithm used Adam's algorithm, the weight-decay parameter was set to 0 in the first period and le-4 in the last two periods, and the other parameters were set using the defaults."}, {"title": "Evaluating the algorithms.", "content": "To evaluate the overall performance of the model, we used two types of basic metrics: 1) the accuracy, specificity, and sensitivity, alongside the ROC curves and AUC areas for predicting the risk of future myopia and high myopia in children and 2) the MAE error for quantitatively predicting refractive error progression49. The results of the evaluation are shown in Table 2."}, {"title": "Sub-group analysis.", "content": "To assess the effects of factors such as age, gender, and myopia on model performance, we conducted a subgroup analysis. We divided the data into male and female groups, as well as myopic and non-myopic groups, for model validation. The results of the subgroup analysis are shown in Figure 5."}, {"title": "Model explanation.", "content": "When diagnosing general myopia in children and predicting the degree of development, we used visual interpretation tools to understand which regions in the fundus image had the greatest impact on our deep learning model, as shown in Figure 6. We used techniques such as gradient CAM and guided backpropagation to draw weight heatmaps for the model. These"}, {"title": "Data availability.", "content": "Primary fundus images supporting the results of this study, labelling data, and more specific optometric results and medical record data are available upon request from the corresponding author."}, {"title": "Code availability.", "content": "Our deep learning network model was developed using the standard model library and script in Python 1.12.0. The code for fundus image preprocessing technology and deep learning network model construction and training verification was published on GitHub:\nhttps://github.com/19376357/Myopia-prediction-model/tree/main."}]}