{"title": "Research on the Proximity Relationships of Psychosomatic Disease Knowledge Graph Modules Extracted by Large Language Models", "authors": ["Zihan Zhou", "Ziyi Zeng", "Wenhao Jiang", "Yihui Zhu", "Jiaxin Mao", "Yonggui Yuan", "Min Xia", "Shubin Zhao", "Mengyu Yao", "Yunqian Chen"], "abstract": "As social changes accelerate, the incidence of psychosomatic disorders has significantly increased, becoming a major challenge in global health issues. This necessitates an innovative knowledge system and analytical methods to aid in diagnosis and treatment. Here, we establish the ontology model and entity types, using the BERT model and LoRA-tuned LLM for named entity recognition, constructing the knowledge graph with 9668 triples. Next, by analyzing the network distances between disease, symptom, and drug modules, it was found that closer network distances among diseases can predict greater similarities in their clinical manifestations, treatment approaches, and psychological mechanisms, and closer distances between symptoms indicate that they are more likely to co-occur. Lastly, by comparing the proximity d and proximity z score, it was shown that symptom-disease pairs in primary diagnostic relationships have a stronger association and are of higher referential value than those in diagnostic relationships. The research results revealed the potential connections between diseases, co-occurring symptoms, and similarities in treatment strategies, providing new perspectives for the diagnosis and treatment of psychosomatic disorders and valuable information for future mental health research and practice.", "sections": [{"title": "1. Introduction", "content": "In recent years, due to rapid economic development and a faster pace of life, the number of psychosomatic disorder patients has been increasing annually. Traditional treatment for psychosomatic disorders involves professional psychological counseling, yet most patients harbor fears and a resistant attitude towards it, and both patients and their relatives lack professional knowledge related to psychological healthcare, coupled with the concealment and complexity of psychosomatic disorders themselves, making it difficult for psychosomatic disorders to be promptly detected and intervened [1,2]. This necessitates an innovative knowledge system and analytical method, serving as a specialized data foundation for a medical information intelligent decision-making system, to assist in diagnosis and treatment [3,4].\n\nThe knowledge graph (KG) with a robust semantic network can establish a network framework for complex psychosomatic disorder data. The classic KG is a graph data structure composed of knowledge points [5-7]. Each knowledge point is represented by a subject-predicate-object triplet (SPO), where the subject (S) and object (O) describe"}, {"title": "2. Materials and Methods", "content": "The field of psychosomatic disorders currently lacks standardized annotated data resources. Our data comes from 262 patient medical records in the psychiatric department of Zhongda Hospital in Nanjing, China. We performed data cleaning and preprocessing on the medical records and produced two differently formatted NER datasets. The first type of NER dataset uses the \"BIO\" (Begin: the beginning character of an entity, Inside: a middle or ending character of an entity, Outside: a character that is not part of an entity) scheme for annotation [24,25]. Each character in the text sequence is tagged with a \u201cB-\u201d, \u201cI-\u201d and \u201cO\u201d label to indicate whether the character is part of a named entity. This dataset divides entities into 7 types.\n\nThe second dataset is used for NER tasks with LLM. Initially, medical cases are divided into 16 sections based on different tasks, then dataset is constructed using each section separately. Examples of the dataset are shown in Figure 2.B. The 16 sections include Patient number, Chief complaint, Course of disease, Severity, Summary of primary symptoms, Admission status, Mental examination, Medical history, Risk factors, Inducement, Treatment plan, Primary diagnostic basis, Primary diagnosed disease, Differential diagnostic basis, Differential diagnosed disease and Summary of signs. An example of 16 sections is shown as follows:\n(1) Patient number: 0101447813.\n(2) Chief complaint: Unable to feel happy, gloomy and joyless. Unable to concentrate. Fatigued and weak, lack of energy. Having had negative thoughts. Irritable and anxious, feeling of panic and chest tightness. Trembling hands, headache. Irregular sleep patterns, day-night reversal. Poor appetite.\n(3) Course of disease: A year ago, the patient began to experience low mood due to family issues and gastrointestinal disease, feeling persistently unhappy and unable to cheer up, with difficulty concentrating, unable to stop thinking about past sad events, feeling let down by parents, often self-blaming, feeling tired and weak, lacking energy, having passive thoughts but never acting on them, accompanied by symptoms of irritability, panic, chest tightness, trembling hands, and headaches. Irregular sleep patterns, reversal of day and night, poor appetite.\n(4) Severity: Unable to live and study normally, took a leave of absence to recuperate the gastrointestinal tract at home, afterward the gastrointestinal disease gradually improved, but emotional problems worsened, preventing a normal return to study.\n(5) Summary of primary symptoms: Symptoms include palpitations, chest tightness, trembling hands, and headaches. Insight is present. Always feeling down, unable to cheer up, difficulty concentrating, unable to control thoughts of past sad events, often self-blaming, feeling tired and weak, lacking energy, having negative thoughts but never acting on them, accompanied by symptoms of irritability, palpitations, chest tightness, trembling hands, and headaches. Sleep is irregular, with a reversed sleep cycle and poor appetite. Bowel and bladder functions are normal, sleep is average, and there has been no significant recent weight change.\n(6) Admission status: Yesterday, visited the psychiatric outpatient clinic at Zhongda Hospital, where they diagnosed a \"depressive episode\" and admitted for treatment.\n(7) Mental examination: Psychiatric evaluation: Conscious and oriented, passive engagement, rapid speech, no perceptual disturbances elicited, slightly active thinking, presence of pathological circumstantiality and obsessive thoughts, unstable emotions, decreased interest, poor concentration, impaired memory, reduced volition, poor appetite, sleep rhythm disturbances, with symptoms of palpitations, chest tightness, trembling hands, and headaches. Insight is present.\n(8) Medical history: One year ago, the patient began to experience low mood due to family issues and gastrointestinal disease.\n(9) Risk factors: Family factors: there are significant conflicts within the father's family, and the grandparents argue daily.\n(10) Inducement: no obvious inducement.\n(11) Treatment plan: The treatment plan should include antidepressants and mood stabilizers, supplemented with psychotherapy.\n(12) Primary diagnostic basis: The patient speaks quickly because it is their natural manner, not because of the typical excitability associated with excessive talking.\n(13) Primary diagnosed disease: Diagnosed with a depressive episode with mixed features.\n(14) Differential diagnostic basis: The patient speaks quickly because it is their natural manner, not because of the typical excitability associated with excessive talking.\n(15) Differential diagnosed disease: bipolar disorder, mania.\n(16) Summary of signs: Sleep patterns are irregular, with day and night reversed, and appetite is poor. Emotional issues have gradually worsened. The patient is conscious and oriented, interacts passively, speaks quickly, exhibits no perceptual disturbances, has slightly active thoughts, pathologically circumstantial and obsessive thinking, unstable emotions, decreased interest, poor concentration, impaired memory, reduced volitional actions, poor appetite, disordered sleep rhythm, and symptoms including palpitations, chest tightness, trembling hands, and headaches. Insight is present.\n\nThe third dataset is used for querying text content. We first establish structured text content and then query the content of medical records. Ultimately, we hope that the"}, {"title": "2.2. Entity Recognition Technology Based on BERT", "content": "The BERT language model [11,12], which utilizes the Transformer as a feature extractor [26-29], is a deeply trained bidirectional language model based on attention mechanisms. It has achieved outstanding results in various tasks in the Natural Language Processing (NLP) field, such as question answering systems, natural language inference, and NER, among others. This study uses the RoBERTa Chinese pre-trained character vector model, which is improved based on Google's official BERT pre-trained model for Chinese, and fine-tuned according to the NER task\n\nGiven a sentence $[W_1, W_2, ..., W_N]$, where $W_i$ represents a Chinese character in the sentence, and N represents the maximum length of the sentence. This sentence needs to be prefixed with a [CLS] token and suffixed with a [SEP] token before input, followed by character embedding through querying a character vector table, representing each character as a one-dimensional vector. For the NER task, the RoBERTa model is trained to predict the \u201cBIO\u201d labels for each character in the sequence. Therefore, we fine-tune the ROBERTa model with the first dataset, adding a classification layer to determine the label type of each character. The final pipeline is depicted in Figure 1."}, {"title": "2.3. Entity Recognition Technology Based on Large Language Models", "content": "LoRA is a low-rank adaptation fine-tuning method that significantly reduces the number of trainable parameters for downstream tasks and achieves excellent results [30]. For the pre-trained weight matrix $W_o \\in \\mathbb{R}^{d \\times k}$ it can be updated via low-rank decomposition $W_o + \\Delta W = W^o + BA$ where $B \\in \\mathbb{R}^{d \\times r}, A \\in \\mathbb{R}^{r \\times k} $ and $r \\ll min(d, k)$ .\nDuring the training process, $W_o$ is frozen and does not receive gradient updates, while A and B contain trainable parameters. Figure 2.A is a schematic diagram of the LoRA principle, where matrix A is initialized with random Gaussian values, and matrix B is initialized to zero. When the input is x, for h = Wox, the modified forward propagation:\n\n$h = W_ox + \\Delta Wx = W_ox + BAx \\#(1)$\n\nWe use both the pre-trained LLaMA model and the LLaMA model fine-tuned with LORA from the KnowLM [31-36] for entity extraction. This method uses the second type of dataset we created. When performing NER tasks with this project, it requires inputs of \"Instruction\" and \"Input\u201d. \u201cInstruction\" provides detailed information about the task to be performed by the model. \"Input\" is the text information received by the LLM, forming the basis for the model to perform calculations and generate outputs. Subsequently, the LLM returns an \u201cOutput\" result, which is determined by the \u201cInstruction\u201d and \u201cInput\" provided by the user. In this research, we define \u201cInstruction\u201d as \u201cExtract possible entities and their types from the given text, with optional entity types are ['patient', 'symptom', 'drug', 'diagnosed disease', 'differential diagnosed disease', 'risk factor', 'severity'], answer in the format of (entity, entity type)\". The final pipeline is depicted in in Figure 2.B.\""}, {"title": "2.4. Entity Alignment", "content": "Through entity extraction, we obtained approximately 30,000 entities, which had a significant amount of duplication (for instance, if both case A and case B contain the entity \"schizophrenia\", then the entity \"schizophrenia\" would be extracted from both cases) and errors. Therefore, we performed data cleaning and integration on the extracted entities [37]. Then, we undertook a crucial data processing step, namely the standardization and unification of entity names [38-40]. This step was accomplished by calculating the degree of approximation between entities, including textual and semantic similarity of entities. Textual similarity of entities was determined by calculating the proportion of identical characters between two entities to decide if they represent the same expression [10]. The similarity was calculated using the Jaccard coefficient:\n\n$sim_t(A, B) = \\frac{A \\cap B}{A \\cup B} \\#(2)$\n\nWhere $sim_t(A, B)$ represents the textual similarity between entity A and entity B, $|A \\cap B|$ represents the number of identical characters is between the two entities, and $|A \\cup B|$ represents the total number of characters for both entities.\n\nSemantic similarity calculates the similarity between two entities based on their approximation in contextual semantics. The method involves calculating the cosine of the word vectors between entities. The closer the cosine value is to 1, the smaller the vector angle distance, and the greater the approximation between the two entities:\n\n$sim_s(A, B) = cos \\theta = \\frac{\\sum A_i \\times B_i}{\\sqrt{\\sum (A_i)^2 \\times \\sum (B_i)^2}} \\#(3)$\n\nHere, $sim_s(A, B)$ represents the semantic similarity between entity A and entity B, $A = [A_1, A_2,..., A_n]$ represents the word vector set of entity A, and $B = [B_1, B_2,..., B_n]$ represents the word vector set of entity B.\n\nDue to the excessive similarity in the text of some different entities, relying solely on textual similarity can easily lead to errors in entity alignment. For example, \"bipolar disorder\" and \"depression\" are two different diseases, but they have a high textual similarity in Chinese. Therefore, we calculate entity similarity by assigning weights of 0.4 and 0.6 to textual similarity and semantic similarity, respectively:\n\n$sim(A, B) = sim_t(A, B) \\times 0.4 + sim_s(A, B) \\times 0.6 \\#(4)$\n\nFor entities with high similarity, their entity names are standardized and unified. For example, the expression \"bad temper\" is used to replace similar terms like \" lose temper easily\" and \"irritable\". We merge the two entity types \"diagnosed disease\" and \"differential diagnosed disease\" into a single \"disease\" entity type. They will be differentiated by employing three distinct relationships: \"primary diagnosis\", \"diagnosis\", and \"differential diagnosis\". Ultimately, 3285 entities were obtained. Through such standardized processing, the KG can organize and link information more effectively. This improves the accuracy of queries and the search experience for users. It also enhances the quality of the graph, laying a solid foundation for subsequent analysis of the graph structure."}, {"title": "2.5. LCC and LCC z score", "content": "The z-score of the Largest Connected Component (LCC) [41] of a set of nodes is used to describe the positioning of node sets in the psychosomatic disorder knowledge network. We calculate the size of the LCC formed by the set of nodes, and then compare the calculated LCC size with the expected LCC of a randomly selected set of nodes. The"}, {"title": "", "content": "LCC z-score is the difference between the LCC size and the mean of randomization \u03bc(random LCC), divided by the SD of the randomization \u03c3(random LCC):\n\n$Z_{LCC} = \\frac{Observed LCC size \u2013 \u00b5(randomLCC)}{\u03c3(randomLCC)} \\#(5)$\n\nAn LCC z-score greater than the expected mean indicates that the observed LCC is significantly larger than expected, meaning the node set aggregates into a local module."}, {"title": "2.6. Network Distance Dab and Network Separation Sab", "content": "We measure the network relationship between two sets of nodes using network distance Dab and network separation Sab [42,43]. Network distance Dab, also denoted as <dab>, is the average network distance between all pairs of nodes in the two sets of nodes:\n\n$D_{ab} = \\frac{1}{|A| \\times |B|} \\sum_{a \\in A, b \\in B} d(a, b) \\#(6)$\n\nWhere A and |B| represents the number of nodes in two sets of nodes. Network separation compares the average shortest distance within each node set <daa> and <dbb> with the average shortest distance <dab> between node sets A and B:\n\n$S_{ab} = <d_{ab}> - \\frac{<d_{aa}> + <d_{bb}>}{2} \\#(7)$\n\nThe random expectation of Sab is zero; a negative Sab indicates that the two sets of nodes are in the same network neighborhood, while a positive Sab indicates that the two sets of nodes are topologically separated."}, {"title": "2.7. Semantic Similarity", "content": "We define semantic similarity to evaluate the biological and psychological mechanism similarities between diseases and between drugs [44,45]. we constructed an association matrix. Taking the symptom module of diagnosed diseases as an example, where each row represents a disease, each column represents a symptom, and the elements in the matrix (0 or 1) indicate whether there is an association between them. Using this association matrix, we calculate semantic similarity using the Wang method:\n\n$sim_{wang}(g_1, g_2) = \\frac{2 \\times \\sum_{t \\in T_{g1} \\cap T_{g2}} IC(t)}{IC(g_1) + IC(g_2)} \\#(8)$\n\nWhere $g1$ and $g2$ are two diseases, $T_{g1}$ and $T_{g2}$ represent the sets of symptoms or drugs corresponding to diseases $g1$ and $g2$, respectively, and $IC(g)$ denotes the number of symptoms or drugs associated with disease $g$."}, {"title": "2.8. Network Proximity Distance and z score", "content": "We define the network proximity metric (referred to in the text as \"proximity distance d\") as the average distance from all points in node set A to the nearest points in node set B among two sets of nodes [42,43]:\n\n$d(A, B) = \\frac{1}{|A|} \\sum_{\u03b1 \\in A} min_{b \\in B} dist(a, b) \\#(9)$\n\nWhere |A| represents the number of nodes in node set A, $dist(a, b)$ represents the shortest distance between nodes a and b. Then, we simulated and obtained the expected distances between randomly selected disease-symptom pairs. We denote the expected mean distance as \u03bcrand(A, B), the SD as grand(A, B), and define the proximity z score:\n\n$z(A, B) = \\frac{d(A, B) \u2013 \u00b5_{rand}(A, B)}{\u03c3_{rand}(A, B)} \\#(10)$\n\nThe proximity z score measures the difference between the proximity distance and the expectation, with z < 0 indicating closer than random, and z > 0 indicating farther than random. For the proximity distance d and the proximity z score, lower metric values"}, {"title": "", "content": "indicate closer distances between the two sets of nodes in the network. Since it's based on random simulation, the proximity z score is a stochastic measure, meaning the same repeated calculation can produce different proximity z score."}, {"title": "2.9 Knowledge Base Construction", "content": "This paper uses the LangChain framework to construct the knowledge base [46]. The workflow is shown in Figure 8. The workflow of LangChain is a highly integrated and automated process that includes six stages. (1) files need to be loaded from the local knowledge base, which is the first step in obtaining raw data. Then, the loaded file content is read and converted into a processable text format, and then the text is segmented according to certain rules (such as paragraphs, sentences, words). (2) Using NLP technology, the segmented text is converted into numerical vectors. Then, the converted text vectors are stored in a vector database. (3) Users' queries or questions also need to be converted into vectors using the same vectorization method to ensure comparison within the same vector space as the text vectors. (4) By calculating similarity measures, the Top k vectors most similar to the query vector are retrieved from the text vectors. (5) Using the retrieved text vectors, build context related to the question, and then enter them as a \"Prompt\" along with the question. (6) Finally, the question and context are submitted to LLM to generate an answer."}, {"title": "3. Results", "content": "The KG on psychosomatic disorders comprises 3285 entities and 9668 triplets. The categories and quantities of entities are as follows: patient 189, symptom 2693, risk factor 75, severity 136, disease 94, drug 98. Entities in the patient category are represented by codes, such as \u201cJ+0101389333\". There are 7 types of relationships: <patient, suffer, disease>, <drug, treat, disease>, <symptom, diagnosis, disease>, <symptom, primary diagnosis, disease>, <symptom, differential diagnosis, disease>, <risk factor, cause, disease>, <severity, diagnosis, disease>.\n\nThe KG displays the relationships between diseases and related entities, visually characterizing the features of the psychosomatic disorder domain. In the graph, dots represent different entities, the color of the dots indicates the types of entities, and the lines between dots represent the relationships between entities. Taking \"depression\" as an example from the disease category. The graph shows entities related to the disease type \"depression\" and their relationships, such as the <symptom: bad temper, diagnosis, disease: depression>, <drug: sertraline, treat, disease: depression>, <risk factor: high work pressure, cause, disease: depression>.\n\""}, {"title": "3.2. Nodes Representing Symptom Clusters for Diagnosing Diseases form Modules within the Network Structure.", "content": "We rely on our psychosomatic disorder KG to extract all symptom nodes and their diagnostically related diseases (referred to as \u201cdiseases\u201d in this section). We focused on 54 diseases, with a total of 107 types of symptom cluster nodes. We found that for 46 of these 54 diseases, the connectivity components formed by their related symptom clusters were significantly larger than random expectation (z > 1.5). This indicates that symptoms related to diseases cluster into a local module. Additionally, we analyzed the network separation metric between diseases (Sab), where disease pairs overlapping between modules have Sab < 0, and those topologically separated between modules have Sab > 0. We found the average network separation metric <Sab> between diseases and their related symptom modules to be 0.99. The value greater than 0, indicating that symptom modules related to different diseases are distantly separated from each other.\n\nWe also explored whether the network distances between symptom modules corresponding to these diseases could reveal clinical relationships between the diseases. For this purpose, we calculated the network distances (Dab) between diseases, centered around diseases, with symptom clusters forming modules. We used 5027 symptom-disease pairs to calculate the Co-symptoms count between disease pairs. We found that the Co-symptoms count between two diseases was negatively correlated with the network distance Dab of their symptom modules (Pearson's correlation = -0.39, P = 2.26\u00d710-95), indicating that a closer network distance between diseases can predict their clinical manifestations to be more similar. We also studied whether the network distance between diseases could predict their similarity in psychiatry. For this, we defined semantic similarity of symptoms [24]. We found that the overall semantic similarity of disease pairs negatively correlates with their average network distance Dab (Pearson's correlation = -0.80, P < 1\u00d710-100). In summary, we found that two diseases with closer network distances share more symptoms and have stronger similarities.\n\nFor example, the network distance Dab=1.25 between \"Mood disorders\" and \"recurrent depressive disorder\" is substantially lower than the average network distance <Dab>=2.04 for diseases, with 99 Co-symptom count, greatly surpassing the average Co-symptom count across diseases. \"Mood disorders\" and \"recurrent depressive disorder\" share many symptoms, such as \u201cirritability\u201d and \u201csleep disturbances\". Other pairs of diseases with high similarity (highlighted in red in Figure 4.D) include \"compulsive disorder\u201d and \u201cdepressive episode\u201d (Dab=1.67, Co-symptom count=85), among others. Conversely, pairs of diseases with a higher network distance exhibit less Co-symptom count and are not considered similar within the field of psychiatry, such as \u201cacute stress psychosis\u201d and \u201cTourette's symptoms\" (highlighted in green in Figure 4.D), which have a larger Dab=3.73 and a lower comorbidity count of 3.\""}, {"title": "3.3. Nodes of Disease Groups Diagnosed through Symptoms Cluster into Modules in the Network Structure", "content": "Following the previous section, we again extracted all nodes of symptoms and their diagnosed diseases (referred to as \u201cdiseases\" in this section). However, we will focus on symptoms as central nodes to observe the local modules formed by disease group nodes. We focused on 105 symptoms, among which there were 54 types of disease group nodes. We found that the connectivity components formed by their related disease groups were significantly larger than random expectation (z>1.03). See Figure 5.A, indicating that diseases related to symptoms can also form local modules, meaning there is a many-to-many correspondence between diseases and symptoms. Furthermore, we also found that the <Sab> between the symptom pairs is 0.09, a value close to 0, indicating a high degree of similarity between some symptoms of disease, with some symptom clusters able to reflect a single disease simultaneously.\n\nWe also explored whether the network distances between disease modules corresponding to these symptoms could reveal the co-occurrence relationships between symptoms. For this purpose, we calculated the Dab between symptoms, centered on the symptoms, with disease groups forming modules. We calculated the number of concurrent diseases between symptom pairs. We found a negative correlation between Co-disease count for two symptoms and their disease modules' network distance Dab (Pearson's correlation = -0.63, P < 1\u00d710-100). Subsequently, to further validate this co-occurrence relationship, we calculated the relative risk (RR) between each pair of symptoms. RR is a standard measure of the strength of association (in this study, the simultaneous occurrence of two symptoms). We then found a negative correlation between the RR of symptom pairs and their network distance Dab (Pearson's correlation = -0.29, P=2.1\u00d710-57). This indicates that a closer network distance between symptoms suggests they are more likely to occur together. For example, \"decreased interest\u201d and \u201cEmotional discomfort", "decreased interest": "nd \u201cVomit", "hypochondriacal delusions": "nd \u201cEmotional discomfort"}, {"title": "3.4. Nodes Representing Groups of Drugs for Diagnosed Diseases form Modules within the Network Structure", "content": "We rely on our psychosomatic disorder KG to extract all drug nodes and their diseases with a therapeutic relationship (referred to as \u201cdiseases\" in this section). We focused on 37 diseases, among which there were 98 types of drug group nodes. We found that for 35 of these 37 diseases, the connectivity components formed by their related drug clusters were significantly larger than random expectation (z>2.9). See Figure 6.A. This indicates that drugs related to disease treatment cluster into a local module. Furthermore, we also found that the <Sab> between diseases and drug modules treating diseases was 1.15, a value greater than 0, indicating that drug modules related to different diseases are distantly separated from each other.\n\nWe also explored whether the network distances between drug modules corresponding to these diseases could reveal the treatment principles between diseases. For this purpose, we calculated the Dab between diseases, centered on the diseases, with drug groups forming modules. We used 279 drug-disease pairs to calculate the number of drugs shared between pairs of diseases. We found a negative correlation between the Co-drug count for two diseases and their drug modules' network distance Dab (Pearson's"}, {"title": "", "content": "correlation = -0.34, P = 2.08\u00d710-18), indicating that a closer network distance between diseases can predict their treatment plans to be more similar. We also studied whether the network distances between diseases could predict their similarity in psychological mechanisms. For this, we defined the semantic similarity of drugs. We found that the overall semantic similarity of disease pairs negatively correlates with their average network distance Dab (Pearson's correlation = -0.82, P < 1\u00d710-100). In summary, we found that two diseases with closer network distances have more similar treatment plans and psychological mechanisms. The visualization of the drug modules associated with diseases is shown in Figure 6.E and Figure 6.F.\n\nFor example, the network distance Dab between \"bipolar disorder\" and \"depressive episode\" is 0.89, much lower than the average network distance of diseases <Dab>=2.14, with 19 shared drugs, far above the average number of shared drugs for diseases, which is 4. \"bipolar disorder\u201d and \u201cdepressive episode\u201d share many drugs, such as \"seroquel\" and \"olanzapine\". Other disease pairs with high similarity (highlighted in red in Figure 6.C) include \"schizophrenia\u201d and \u201cdepressive episode\u201d (Dab=1.19, co-drugs=15), among others. Conversely, disease pairs with higher network distances have fewer shared drugs and are not considered similar in psychological mechanisms, such as \u201crecurrent depressive disorder\u201d and \u201cMood disorders\" (highlighted in green in Figure 6.C), which have a larger Dab=2.04 and a smaller co-drug count of 2."}, {"title": "3.5. The Modules Formed by Symptom Cluster Nodes for Differential Diagnosis of Diseases and the Degree of Association between Diseases and Symptoms", "content": "Besides diagnosed diseases, we rely on our psychosomatic disorder KG to extract all symptoms and their disease nodes with a differential diagnosis relationship. Differential diagnosis means excluding the possibility of a disease based on certain symptoms. We focused on 53 diseases with differential diagnosis, among which there were 243 types of symptom cluster nodes. We found that for 36 of these 53 diseases with differential diagnosis, the connectivity components formed by their related symptom clusters were significantly larger than random expectation (z>1.1). See Figure 7.A. This indicates that symptoms of diseases with differential diagnosis cluster into a local module. Furthermore, we also found the <Sab> between symptom modules corresponding to diseases with differential diagnosis to be 2.26, a value greater than 0, indicating that symptom modules corresponding to different differential diagnosis diseases are far apart from each other.\n\nIn our psychosomatic disorder KG, diagnostic relationships are divided into primary diagnosis relationships and diagnosis relationships. The symptoms connected by diagnosis relationships are mostly patient-reported and colloquial, whereas those connected by primary diagnosis relationships are summarized by psychiatrists and are terms standardized in the field of psychiatric medicine. To explore the degree of association between symptoms and their diseases for both types of relationships, we observed the network structure of symptoms and diseases under primary diagnosis relationships and diagnosis relationships, respectively. To quantify the degree of association, we used two metrics [18]: (1) proximity distance d, the average shortest distance between nodes within symptom and disease modules. (2) the proximity z score,"}, {"title": "", "content": "measuring the difference between proximity distance d and random expectation. For these metrics, lower values indicate a higher degree of association between diseases and symptoms. For the proximity z score, z < 0 indicates closer than random, z > 0 indicates further than random. We plotted box plots for both types of relationships, comparing symptom-disease pairs in primary diagnosis relationships (orange bars) and diagnosis relationships (blue bars). See Figure 7.C. We found that under both metrics, the orange bars are consistently lower than the blue bars, indicating that symptom-disease pairs in primary diagnosis relationships have a stronger degree of association and are of higher reference value. Specific examples are shown in Figure 7.D."}, {"title": "3.6 Comparison of Results from Different Models", "content": "We evaluate the NER task performance on the ROBERTa, LLaMA, and LLaMA fine-tuned with LoRA. We measured the NER task quality in terms of precision (P), recall (R), and the F1 score. shows the evaluation result of different models in the NER task. It indicates that the LLaMA fine-tuned with LoRA has a clear advantage in the NER task, showing that this method can more effectively identify entities in unstructured text."}, {"title": "4. Discussion", "content": "In this study, we defined entity and relation types based on clinical terminology widely used in the field of psychiatry. Through communication and discussion, we developed a comprehensive set of standardized concepts that can precisely represent various clinical entities and their relationships. To accommodate the demands of real-some mod world psychiatric applications, we also sought opinions from domain experts and made ifications and adjustments to the entity and relation types. Ultimately, we obtained 6 types of entities and 7 types of relationships.\n\nDue to information repetition, the extracted knowledge on psychosomatic disorders inevitably contains a certain degree of redundancy. Therefore, we used entity alignment methods to remove duplicate entities and standardized and unified the entities. As a result, we constructed a high-quality psychosomatic disorder KG. After constructing the KG, we analyzed its structure, revealing the connections between diseases, symptoms, and drugs in the field of psychosomatic disorders.\n\nWe found that in 54 diseases, the symptoms corresponding to 46 diseases, diseases related to 105 symptoms, and the drugs required for 35 of 37 diseases all formed significantly clustered local modules. This phenomenon indicates that there is a close interrelation between symptoms and pharmacological treatments in the diagnosis and treatment of psychosomatic disorders, suggesting that the network structure of psychosomatic disorders might have a decisive influence on symptom and drug selection. The discovery of this correlation not only unveils the intrinsic link between the symptoms and treatment of psychosomatic disorders but also provides a theoretical basis for using bioinformatics methods to predict potential treatment strategies for mental diseases. For example, by analyzing the symptom cluster modules, we can identify which symptoms are key manifestations of a particular psychosomatic disorder and thereby infer the most effective medication combinations.\n\nThe symptom modules of diseases reflect their clinical similarity. For instance, the diseases \"Mood disorders\" and \"recurrent depressive disorder\" have close network distances Dab in their symptom modules and a high number of shared symptoms, hence a high clinical similarity between them. Conversely, \u201cacute stress disorder\" and \"Tourette syndrome\u201d have a high network distance Dab and very few shared symptoms, therefore are not considered similar by the field of psychiatry. By analyzing the clinical similarities between diseases, it aids doctors in more accurately distinguishing and identifying similar diseases during the early diagnostic stages, especially in cases of overlapping or unclear symptoms, thus improving diagnostic accuracy. Moreover, it provides a symptom-based method of disease classification that may complement traditional etiological classification methods, offering data support for new classification standards in psychiatric disorders.\n\nThe disease modules of symptoms reflect the co-occurrence relationships among symptoms. For example, the symptoms \u201challucinations\u201d and \u201canhedonia\" have close network distance Dab in their disease modules and a high number of concurrent diseases, indicating a high degree of co-occurrence between the symptoms. Conversely, \"elevated mood\" and \"lack of insight\u201d have a high network distance Dab and very few concurrent diseases, thus exhibiting a low degree of co-occurrence. Subsequently, we validated this conclusion using the relative risk (RR) of symptoms, showing that the co-occurrence of symptoms is negatively correlated with their network distance between modules. By analyzing the co-occurrence relationships of symptoms between different diseases, it helps to understand why certain symptoms frequently appear together, potentially indicating a common pathophysiological basis. Furthermore, in the management of patients with multiple psychosomatic disorders, it enables a better understanding and prediction of symptom progression, optimizing treatment plans.\n\nThe drug modules of diseases reflect the similarity in treatment approaches among diseases. For example, the diseases"}]}