{"title": "Weather-Informed Probabilistic Forecasting and Scenario Generation in Power Systems", "authors": ["Hanyu Zhang", "Reza Zandehshahvar", "Mathieu Tanneau", "Pascal Van Hentenryck"], "abstract": "The integration of renewable energy sources (RES) into power grids presents significant challenges due to their intrinsic stochasticity and uncertainty, necessitating the development of new techniques for reliable and efficient forecasting. This paper proposes a method combining probabilistic forecasting and Gaussian copula for day-ahead prediction and scenario generation of load, wind, and solar power in high-dimensional contexts. By incorporating weather covariates and restoring spatio-temporal correlations, the proposed method enhances the reliability of probabilistic forecasts in RES. Extensive numerical experiments compare the effectiveness of different time series models, with performance evaluated using comprehensive metrics on a real-world and high-dimensional dataset from Mid-continent Independent System Operator (MISO). The results highlight the importance of weather information and demonstrate the efficacy of the Gaussian copula in generating realistic scenarios, with the proposed weather-informed Temporal Fusion Transformer (WI-TFT) model showing superior performance.", "sections": [{"title": "1. Introduction", "content": "The adoption of Renewable Energy Sources (RES), especially wind and solar generation, is at the forefront of modern power systems' transition towards sustainable and carbon-free electricity generation. This transition also promises to improve the affordability and accessibility of energy systems worldwide (U.S. Department of Energy, n.d.a,n). However, integrating high levels of RES into existing power grids introduces significant challenges, particularly in forecasting. Indeed, RES, whose output depends on weather conditions, are intrinsically intermittent and stochastic. This operational uncertainty thus complicates grid stability and optimization efforts (U.S. Department of Energy, n.d.a) which, in turn, motivates the need for advanced forecasting tools.\nIn that context, academics and practitioners have increasingly moved from deterministic to probabilistic forecasting, which better captures the uncertainty in load and RES output. In addition, probabilistic forecasts provide the ability to sample multiple scenarios, which is essential for risk quantification (Stover, Karve and Mahadevan, 2023) and uncertainty-aware optimization (Knueven, Faqiry, Garcia, Chen, Treinen, Werho, Zhang, Vittal, Zhao, Thatte and Yin, 2023). Despite their popularity, probabilistic forecasts present substantial scalability challenges. Indeed, they must capture spatial (between system elements located at different"}, {"title": "1.1. Related Work", "content": ""}, {"title": "1.1.1. Time Series Forecasting", "content": "Historically, the domain of time series prediction was dominated by statistical methods, with Autoregressive Integrated Moving Average (ARIMA) (Ho and Xie, 1998) model being a prominent example. However, these methods often fall short in capturing the non-linear and non-stationary nature of the time series and might not be reliable for forecasting RES. The advent of Recurrent Neural Networks (RNNs) marked a significant shift, demonstrating superior capabilities in capturing complex temporal dependencies inherent in time series data (Sutskever, Vinyals and Le, 2014; Smyl, 2020). Notably, the sequence-to-sequence (S2S) RNN architecture (Sutskever et al., 2014), initially developed for neural machine translation, has inspired the development of innovative time series forecasting models such as multi-quantile RNN (Wen, Torkkola, Narayanaswamy and Madeka, 2017), DeepAR model (Salinas, Flunkert, Gasthaus and Januschowski, 2020), and Temporal Fusion Transformer (TFT) (Lim, Ar\u0131k, Loeff and Pfister, 2021). By leveraging cross-series and cross-temporal learning, these methods have gained promising performance"}, {"title": "1.1.2. Scenario Generation in RES", "content": "Scenario generation in power systems is the process of creating diverse and possible future states of the system, accounting for uncertainties caused by different factors such as temperature and other weather-related variable fluctuations, which affects the power consumption and generation within the RES. Various methods have been proposed for scenario generation in power systems, including sampling-based approaches (e.g., Monte Carlo sampling, latin hypercube sampling) (Carmona and Yang, 2021; Saraninezhad, Ramezani and Falaghi, 2022) and optimization-based methods (e.g., moment matching, distance matching) (Li, Zhou and Chen, 2020; Liao, Yang, Chen and Li, 2022; Lu, Wu and Wu, 2021). While these methods are foundational, they often require extensive datasets and/or are computationally demanding, particularly for generating high-dimensional scenarios. Moreover, when these methods are applied to individual dimensions (i.e., marginal distributions), they struggle to capture the critical spatio-temporal correlations present in the system.\nRecently, Generative Adversarial Networks (GANs) have been employed in power systems scenario generation, notably within wind power generation, as demonstrated in (Zhang, Ai, Xiao, Hao and Lu, 2020; Dong, Chen and Yang, 2022; Tan, Qi, Sun, Li, Yang and Li, 2020). These methods have been demonstrated to be effective in capturing the dynamic and complex patterns inherent in RES, thereby providing a robust framework for simulating realistic and diverse energy production scenarios. Dong et al. applies a data-driven GAN model to wind and solar scenario generation, however, weather information was not incorporated in the model (Dong et al., 2022). Zhang et al. utilized a point-prediction forecasting model, using GAN to learn the distribution of forecast errors and generate scenarios by adding generated residuals to the point forecasts, making the model's performance highly dependent on the accuracy of the initial forecasts (Zhang et al., 2020). Chen et al. also applied GANs to generate solar and wind scenarios, with a model that can condition on certain weather events, however does not include the weather time series such as wind speed and solar irradiation and can result in low performance (Chen, Wang, Kirschen and Zhang, 2018). Furthermore, training GANs presents significant challenges, especially when dealing with the high-dimensional forecasting problems in RES.\nThe integration of the copula method with time series forecasting presents a promising solution to the aforementioned challenges by facilitating the modeling of the joint distribution. For example, the DeepVAR model utilizes a Gaussian copula to model the time-varying mutual-dependence structure, incorporating a low-rank structure on the Gaussian copula covariance to enhance computational efficiency (Salinas, Bohlke-Schneider, Callot, Medico and Gasthaus, 2019). However, DeepVAR assumes stationarity"}, {"title": "2. Contributions", "content": "To address the existing gaps within high-dimensional forecasting in RES, this paper introduces a comprehensive probabilistic multivariate time series forecasting framework that leverages Gaussian copulas for enhanced forecasting and realistic scenario generation of load, and wind and solar power generation. The proposed model is augmented with both historical and forthcoming weather forecast covariates, aiming at improving forecasting and scenario generation performance across various temporal and spatial dimensions. The principal contributions of this paper are threefold:\n\u2022 Integration of multivariate time series forecasting with copula method for high-dimensional problem in RES to effectively capture the complex spatial and temporal dependencies. Particularly, the largest problem is a 48-hour ahead prediction for 376 solar farms, with an output dimension of 10,848.\n\u2022 Showcasing the importance of incorporating weather forecast data, which significantly enhances the accuracy and reliability of forecasting and scenario generation processes, especially for higher prediction lead times.\n\u2022 Comprehensive benchmarking and comparison of various time series prediction methodologies, including ARIMA, DeepAR, NLinear, DLinear, and TFT, combined with Gaussian copula. Different metrics are considered to evaluate the efficacy of these models in multi-dimensional forecasting and scenario generation within power systems.\nThe analysis encompasses time series forecasting methods for the prediction and scenario generation of load, and wind and solar power generation within the Midcontinent Independent System Operator (MISO) system. In contrast with previous methods, which are mainly on small and/or low-dimensional datasets, this work considers probabilistic forecasting of a large-scale system with 6 load zones, 286 wind farms and 376 solar farms. The proposed Weather-Informed (WI) TFT model is highlighted for its superior performance across multiple evaluation metrics, in both deterministic forecasting and scenario generation. The findings of this paper showcase the comparative effectiveness of different forecasting techniques within the context of energy forecasting and uncertainty quantification, thus providing critical insights for risk-aware decision making in power system operations."}, {"title": "3. Problem Formulation", "content": "This section outlines the problem formulation and introduces the notations used for the probabilistic multivariate time series forecasting of load, and wind and solar power generation, that incorporates weather data."}, {"title": "3.1. Problem Setting", "content": "Let $Z_{i,t}$ denote a random variable corresponding to the target $i \\in D = \\{1, .., D\\}$ (i.e., a load, a wind farm, or a solar farm) at time $t \\in \\mathbb{Z}$, and denote its realization as $z_{i,t} \\in \\mathbb{R}$. The vector realization of all joint observations at time $t$ is defined as:\n$\\mathbf{z}_{.,t} = (z_{1,t}, ..., z_{D,t}) \\in \\mathbb{R}^D$   (1)\nFor instance, in the context of wind farms, $z_{i,t}$ represents the output generated power of wind farm $i$ at time $t$, measured in megawatts (MW), and $\\mathbf{z}_t$ is the vector representing output of all wind farms at time $t$. Similarly, for an individual target $i$, the realization of the univariate time series for time interval $T = \\{t + 1, ..., t + T\\} \\subset \\mathbb{Z}$ is denoted by:\n$z_{i,T} = (z_{i,t+1}, ..., z_{i,t+T}) \\in \\mathbb{R}^T$   (2)\nHence, the multivariate time series realization corresponding to the targets in the system from time $t + 1$ to $t + T$ is denoted as:\n$\\mathbf{Z}_{.,T} = \\begin{pmatrix} z_{1,t+1:t+T} \\\\ \\vdots \\\\ z_{D,t+1:t+T} \\end{pmatrix} \\in \\mathbb{R}^{D \\times T}$   (3)\nThe paper also considers so-called covariates, denoted by $\\mathbf{x}$ with support in $\\mathbb{R}^{D'}$. Thereby, for $j \\in D' = \\{1, ..., D'\\}$, $x_{j,t}$ represents the observed value of the $j$-th covariate at time $t$, and the vector representation of all covariates at time $t$ is denoted by $\\mathbf{x}_{.,t} = (x_{1,t}, ..., x_{D',t})$. The corresponding covariates in the paper include time encoding, e.g., day of the week, and the weather-related quantities such as temperature, humidity, cloud coverage, wind speed, etc. Hence, the matrix realization of the covariates is denoted as below:\n$\\mathbf{X}_{.,T} = \\begin{pmatrix} x_{1,t+1:t+T} \\\\ \\vdots \\\\ x_{D',t+1:t+T} \\end{pmatrix} \\in \\mathbb{R}^{D' \\times T}$   (4)\nThe details corresponding to each target and the covariates are discussed in Section 6."}, {"title": "4. Multivariate Forecasting", "content": "Let $t\\in \\mathbb{Z}$ and consider the forecasting horizon $H = \\{t + 1,...,t + H\\}$ of length $H$, and the past observation window of length $W$ as $W = \\{t - W + 1, .., t - 1, t\\}$. A time series forecasting model predicts the target $\\mathbf{z}_H \\in \\mathbb{R}^{D \\times H}$ as $\\mathbf{\\hat{z}}_H \\in \\mathbb{R}^{D \\times H}$. Figure 1(a) shows schematic of the DL-based model for multivariate probabilistic forecasting of the wind power generation given historical data and covariates. More generally, probabilistic forecasting can be considered as modeling the joint cumulative distribution function (CDF) of the target variables conditioned on the past observations $\\mathbf{z}_W \\in \\mathbb{R}^{D \\times W}$, past covariates $\\mathbf{x}_W \\in \\mathbb{R}^{D' \\times W}$, and the future covariates $\\mathbf{x}_H \\in \\mathbb{R}^{D' \\times H}$ as\n$F_t(\\mathbf{z}_H) = P (\\mathbf{Z}_H \\leq \\mathbf{z}_H | \\mathbf{z}_W, \\mathbf{x}_W, \\mathbf{x}_H)$   (5)"}, {"title": "5. Restoring Correlations via Copula", "content": "The copula method provides a robust statistical tool for modeling the underlying dependencies and correlations in high-dimensional probabilistic forecasting. This method enables the estimation of the joint distribution by combining the marginal distributions with a copula function. In the context of RES, the copula method facilitates the generation of realistic scenarios that accurately reflect the true variability and spatial-temporal interdependencies."}, {"title": "5.1. Copula Method", "content": "A function $C: [0,1]^d \\rightarrow [0,1]$ is a copula if it is the joint CDF of a $d$-dimensional random vector $U = (U_1,...,U_d)$ with uniformly distributed marginals on the interval $[0, 1]$. Sklar's Theorem (Sklar, 1959) shows that any multivariate CDF can be expressed as the product of its marginal distributions and a copula function.\nTheorem 1 (Sklar's Theorem). Let $Z$ be a $d$-dimensional random variable with joint CDF $F_Z$ and marginal CDFs $F_{Z_1},\\ldots, F_{Z_d}$. There exists a copula $C$ such that\n$F_Z(z_1,..., z_d) = C (F_{Z_1}(z_1),..., F_{Z_d}(z_d))$   (7)\nand the random variables $U_i = F_{Z_i}(Z_i)$ are uniformly distributed on interval $[0, 1]$ (i.e., $U_i \\sim \\mathcal{V}[0, 1]$). The copula $C$ is unique, given continuous marginals $F_{Z_1},\\ldots, F_{Z_d}$.\nSklar's theorem thus enables the decomposition of any multivariate CDF into its marginal CDFs and a copula, without specific assumptions on the marginals. Hence, given the estimated marginal CDFs, it is possible, via a Copula function, to reconstruct the joint CDF and represent the underlying dependencies and correlations among different dimensions. This is particularly crucial in probabilistic forecasting in RES where spatial and temporal correlations should be restored in high dimensions."}, {"title": "5.2. Conditional Copula", "content": "Sklar's theorem can be extended to modeling conditional distributions, which is particularly important in regression"}, {"title": "5.3. Gaussian Copula", "content": "One of the most popular and effective ways of linking the joint distribution into its marginals is the Gaussian copula. Considering $\\Phi$ as the CDF of the standard normal distribution and $\\Phi_R$ as the multivariate normal CDF with mean vector of 0 and covariance matrix of R, the Gaussian copula $C_R: [0, 1]^d \\rightarrow [0, 1]$ is defined as:\n$C_R = \\Phi_R (\\Phi^{-1}(u_1), ..., \\Phi^{-1}(u_d))$   (9)\nAs a result, the multivariate joint CDF $F_{Z|X}$ can be decomposed as:\n$F_{Z|X} = \\Phi_R(\\Phi^{-1} (F_{Z_1|X}(z_1|x)), ..., \\Phi^{-1} (F_{Z_d|X}(z_d|x)))$   (10)\nThe two main pillars to estimate the joint CDF under the Gaussian copula framework are: 1) the marginal CDFs $F_{Z_i|X}$ for $i \\in \\{1, ...,d\\}$ and 2) the correlation matrix $R \\in \\mathbb{R}^{d\\times d}$, which is responsible for modeling the correlations among different dimensions."}, {"title": "5.4. Scenario Generation", "content": "The combination of the multivariate probabilistic forecasting and copula method provides the estimated joint distribution of the target variables, incorporating the correlations among different dimensions. Consequently, it is possible to generate probabilistic scenarios by sampling from the estimated joint distribution that captures the underlying correlations between different dimensions.\nThe scenario generation steps are outlined in Algorithm 1 and are depicted in Figure 1(c) for a 2D (i.e., $d = 2$) example. The algorithm takes as input the estimated correlation matrix $R$, the estimated marginals $F_{Z_i|X}$ for $i \\in \\{1, ...,d\\}$, and the number of required scenarios (i.e., the number of samples from the joint distribution) $S$, and it outputs $\\mathbf{z}^{(s)} = (z_1^{(s)},...,z_d^{(s)})$ for $s\\in \\{1,...,S\\}$. The algorithm starts by sampling $\\mathbf{v}^{(s)} = (v_1^{(s)}, ..., v_d^{(s)})$ from a multivariate normal distribution with 0 mean and estimated covariance matrix $\\hat{R}$ (i.e., $MVN (0, \\hat{R})$). The samples are then transformed using the CDF of the standard normal into $u_i^{(s)} = \\Phi(v_i^{(s)})$, which has uniform marginals (as shown in Figure 1(c)). Finally, the samples are mapped into the original space via $z_i^{(s)} = F_{Z_i|X}^{-1}(u_i^{(s)})$. The resulting vector $\\mathbf{z}^{(s)}$ corresponds to the samples generated using the copula method, which captures the interdependencies and correlations among the different dimensions."}, {"title": "5.5. Copula for Time Series Scenario Generation", "content": "This section extends the Gaussian copula method to the context of time series forecasting in RES, where the objective is to model a joint CDF for all sites and time steps, and generate scenarios that capture both spatial and temporal dependencies across the forecasting horizon. In this setting, the joint conditional CDF $F_t(\\mathbf{z}_H)$ is over $d = D \\times H$"}, {"title": "6. Experiment Setup", "content": "A comprehensive performance evaluation was conducted with large-scale data using various time series forecasting methods. Both deterministic and probabilistic forecasting methods are employed to assess their efficacy under different metrics. Additionally, the experiments incorporate weather information to evaluate its importance in predicting RES. The forecast horizon H is set to 48 hours, which aligns with the common practice for day-ahead market-clearing and reliability assessment in power systems (Werho, Zhang, Vittal, Chen, Thatte and Zhao, 2021). However, the methodology can be extended to longer or shorter time horizons depending on the specific requirements."}, {"title": "6.1. Dataset", "content": "Table 2 provides summary statistics of the MISO dataset that is used in this study which contains time series data for the years 2018 and 2019 with hourly resolution within the MISO system (Sergi, Feng, Zhang, Hodge, Ring-Jarvi, Bryce, Doubleday, Rose, Buster and Rossol, 2022). This dataset includes zone-level time series for loads and unit-level time series of wind and solar power generation. Additionally, it includes forecasts generated by NREL's System Advisor Model (SAM) for the year 2019, which is considered for comparison with the developed models in this study.\nTo explore the effect of weather data, this study incorporates an additional dataset of weather forecasts for the MISO system. The weather forecasts are gathered from the publicly available datasets produced by the European Center for Medium-Range Weather Forecasts (ECMWF), particularly from the THORPEX Interactive Grand Global Ensemble (TIGGE) dataset (European Centre for Medium-Range Weather Forecasts, 2023; Varela Santolalla and Mladek, 2024). This dataset provides essential meteorological variables including surface pressure, wind speed, cloud cover, skin temperature, solar irradiation, as outlined in Table 3. Issued twice everyday at 12:00 and 00:00 UTC, the forecasts from the TIGGE database are provided in 6-hour intervals (Varela Santolalla and Mladek, 2024). The forecast data is collected on a 1\u00ba latitude by 1\u00ba longitude grid covering the MISO territory. The 6-hour temporal resolution time series from the ECMWF are then interpolated to hourly granularity to align with the load, and wind and solar power time series used in this study."}, {"title": "6.2. Methods", "content": "In this study, different methods are employed to determine their efficacy for 48-hour forecasting horizon prediction in RES and load. The models encompass both traditional statistical methods and advanced DL-based techniques with and without incorporation of weather data, to provide a comprehensive performance comparison. The models include:\n\u2022 ARIMA: This model is implemented in a univariate framework due to the shortcoming of the autoregressive methods in handling high-dimensional input data (Ho and Xie, 1998).\n\u2022 Dlinear: This is a linear model tailored for time series forecasting. The implementation in this work considers the spatio-temporal correlations by regressing the forecasts over the previous observations and past and future covariates (Zeng, Chen, Zhang and Xu, 2022).\n\u2022 Nlinear: This model normalizes each input by subtracting the last value in the sequence and then adds it back after passing through the linear layer to address distribution shift. In this paper, the model is adapted to probabilistic setting by using quantile regression objective function (Zeng et al., 2022).\n\u2022 DeepAR: This is an RNN-based model designed to capture the temporal dependencies and provide multi-step ahead forecast by recursively applying the model, using its own predictions as inputs for subsequent steps. In this work, the model's output parameters are parametrized using a Beta distribution to account for the capacity factors in RES, which are inherently bounded between 0 and 1 (Salinas et al., 2020).\n\u2022 TFT: This is a transformer-based model designed for multi-horizon forecasting with mixed-type inputs, including static covariates, known future inputs, and past exogenous time series. Quantile loss is utilized for training the model in this work (Lim et al., 2021).\nThe models are trained using historical data of the targets from 2018 within the MISO system, with the remaining data reserved for testing. At the beginning of each month, a new model is trained using all available observations since Jan. 1st, 2018 up to midnight on the first day of that month. The first week of each month is designated for validation purposes (i.e., for fine tuning the model parameters), and the models are subsequently evaluated during the second week of each month. The DL models are trained both with and without weather data to assess the importance of weather covariates. Evaluations are conducted only for the first nine months, as the ECMWF data was not available from October 2019 onward.\nWeather features are utilized as additional covariates in the forecasting tasks for the WI-based models. These covariates include both historical weather data and weather forecasts, which are available in advance as discussed in the previous section. For each target variable, weather information from the closest region on a 1\u00ba by 1\u00b0 grid is used. For load forecasting, skin temperature and total cloud cover are incorporated as key variables. For wind power generation forecasting, the model uses wind speed, surface pressure, and both V and U wind components, which indicate horizontal airflow towards the north and east, respectively. In forecasting solar power generation, total cloud cover and surface solar radiation are key variables. When generating forecasts, the actual weather information from the past and weather forecasts for the upcoming forecasting horizon are fed into the WI-based models..\nThe ARIMA model parameters are optimized using the open-source Statsforecasts package (NIXTLA, 2024), which features an AutoARIMA function for parameter selection. Training of the DL-based models are performed in Pytorch using Adam optimizer (Kingma and Ba, 2014). Early stopping with patience of 10 steps in conjunction with a learning rate scheduler (ReduceLROnPlateau) with patience of 5 steps is used for all models. The remaining hyperparameters for each model are optimized using Optuna (Akiba, Sano, Yanase, Ohta and Koyama, 2019). The details about the training process are provided in C."}, {"title": "6.3. Evaluation Metrics", "content": "This section outlines various metrics employed to quantify the models for both deterministic and the probabilistic forecasting (i.e., scenario generation). Recall that, for a given target $i \\in D$ and each time step within the forecasting time horizon ($\\tau \\in H$), the model produces output in the form of marginal CDFs, whereas $S$ forecasts (i.e., scenarios) are generated for the scenario generation using Algorithm 1. This essentially gives the prediction one more dimension, which indiced by superscript $(s)$.\nThe evaluation of the deterministic forecasts are performed at the individual and space-sum levels. Additionally,"}, {"title": "7. Results", "content": "This section presents the experimental results for the deterministic and probabilistic forecasting of the load, and the wind and solar power generation within MISO. Initially, the deterministic forecasting results for different models discussed in Section 6.2 are presented to compare the performance with and without the inclusion of weather data. Following this, the probabilistic forecasting results are discussed, highlighting the rational for incorporating the copula technique to restore the correlations. The experimental results are reported on distinct individual and aggregate levels."}, {"title": "7.1. Deterministic Prediction", "content": "To evaluate the performance of the different models discussed in Section 6.2 for point-predictions and quantify the importance of weather covariates, deterministic forecasts are performed for each model. For each probabilistic forecasting method, and given the predicted marginal distributions of each space-time dimension, the expected values on each dimension are used as deterministic forecasts. For models that trained with quantile loss, the middle quantiles are used as deterministic forecasts, as they are optimized for L1 loss (Koenker and Hallock, 2001; Wen et al., 2017). The forecasting accuracy of each model is evaluated using NMAEind and RMSEind to measure the average forecast accuracy across all individual series. Additionally, NMAEs-sum and RMSEs-sum are used to assess the forecasts for total load, and solar and wind power generation at the aggregate space-sum level.\nTable 5 presents the forecast errors for MISO system on the test dataset. The performance of models with and without weather forecast information is compared to examine the impact of weather covariates. The models that utilize weather data are denoted with the prefix WI (i.e., weather informed) in Table 5.\nThe comparison of deterministic forecasting methods shows how the DL-based models improve over the traditional ARIMA model. These improvements are primarily attributed to the transition from ARIMA's univariate framework to a DL-based multivariate approach, which more accurately captures the complex dynamics within energy systems. The capacity of these models to effectively utilize cross-series information significantly enriches the forecasting process, offering a deeper understanding of energy patterns. The integration of weather forecast information into these models further enhances their accuracy. It is observed that WI models consistently outperform those that do not include weather data, highlighting the importance of weather covariates in predicting the variability of RES. This"}, {"title": "7.2. Scenario Generation", "content": "This section presents the results for the probabilistic forecasting of RES using the DL-based WI models discussed in the previous sections. Models that do not include weather covariates are omitted, as it was demonstrated that they consistently underperform compared to the WI models. Specifically, the performance of the generated scenarios for load, wind power, and solar power generation using different models are compared with and without integration of Gaussian copula. The evaluation metrics are computed for scenarios generated from both marginal distributions (mar.) and joint distributions represented by copula (cop.). For each model and individual target, 200 scenarios are generated (i.e., S = 200) with and without the copula restoration. The performance of the models for generating scenarios are presented in Table 6.\nThe ED quantifies the distance between the distributions of the forecasted scenarios and the actual data. Lower ED values with the copula indicate improved alignment of generated scenarios with the true distribution. The ED for joint distribution and (s-sum)-level are calculated and"}, {"title": "8. Conclusion", "content": "This paper proposed a new method based on combination of TFT and Gaussian copula for high-dimensional probabilistic forecasting in RES. Extensive experiments were conducted to compare different time series forecasting methods on a real-world forecasting problem within the MISO system. The results demonstrated superiority of the TFT model compared to other statistical and DL-based methods, and the significant impact of including weather information on the accuracy and effectiveness of the forecasts. The integration of weather data as covariates also improved the precision of the models over higher lead times. Additionally, the paper highlighted the efficacy of the Gaussian copula method in restoring spatio-temporal correlations, which is crucial for generating realistic scenarios in RES forecasting. This methodological advancement provides a robust framework for addressing the complexities associated with high-dimensional forecasting problems in RES.\nFuture work will focus on studying the effect of noise in covariates on the performance of the forecasts and scenarios. Investigating how inaccuracies in weather data influence the model's predictions is essential for further improving the robustness of the forecasting method. Additionally, uncertainty quantification will be considered using conformal prediction to provide confidence-aware predictions in high-dimensional RES forecasting problems. This will involve developing techniques to quantify and incorporate prediction uncertainty, thereby offering more reliable and actionable insights for system operators."}, {"title": "A. Evaluation Metrics", "content": "In this section, the details of evaluation metrics are provided."}, {"title": "A.1. Deterministic Forecast", "content": "In the case of point forecast, $S=1$ and only one scenario/forecast is generated. For notational simplicity, the scenario index $s$ is dropped in this subsection.\nNormalized Mean Absolute Error (NMAE) For wind and solar power, the ground truth can sometimes become zero or close to zero. To avoid dividing by zeros, NMAE is considered. The first metric considers the forecast on each space-time dimension:\n$\\text{NMAE}_{ind} = \\frac{1}{N_{\\text{test}}} \\sum_{t=1}^{N_{\\text{test}}} \\sum_{i \\in D, \\tau \\in H} \\frac{|z_{i,\\tau} - \\hat{z}_{i,\\tau}|}{\\text{max}\\{z_{i,\\text{Train}}\\}} \\times 100,$   (13)\nexpressed as a percentage. The $\\text{NMAE}_{ind}$ reflects the average performance on individual time series.\nThe normalization value $z_{\\text{max}\\{z_{i,\\tau}\\}}$ is the capacity of the generator if given. If the capacity is not given, it is the maximum value of the first year in the training dataset.\nThe second metric considers summation over space and is defined as:\n$\\text{NMAE}_{s-\\text{sum}} = \\frac{1}{N_{\\text{test}}} \\sum_{t=1}^{N_{\\text{test}}} \\frac{\\sum_{\\tau \\in H} |\\sum_{i=1}^D \\hat{z}_{i,\\tau} - \\sum_{i=1}^D z_{i,\\tau}|}{\\sum_{i=1}^D \\text{max}\\{z_{i,\\text{Train}}\\}} ,$   (14)\nRoot Mean Square Error (RMSE) The RMSE is a commonly used metric to measure the accuracy of a model by calculating the square root of the average squared differences between the predicted and actual values. It provides a measure of the average magnitude of the error. The first metric considers the forecast on each space-time dimension:\n$\\text{RMSE}_{ind} = \\sqrt{\\frac{1}{N_{\\text{test}} D T} \\sum_{t=1}^{N_{\\text{test}}} \\sum_{i \\in D, \\tau \\in H} (z_{i,\\tau} - \\hat{z}_{i,\\tau})^2},$   (15)\nexpressed in megawatts (MW). The $\\text{RMSE}_{ind}$ reflects the average performance on individual dimension.\nThe second metric considers summation over space and is defined as:\n$\\text{RMSE}_{s-\\text{sum}} = \\sqrt{\\frac{1}{N_{\\text{test}} T} \\sum_{t=1}^{N_{\\text{test}}} \\sum_{\\tau \\in H} (\\sum_{i=1}^D \\hat{z}_{i,\\tau} - \\sum_{i=1}^D z_{i,\\tau})^2},$   (16)\nalso expressed in MW. The $\\text{RMSE}_{s-\\text{sum}}$ measures the model's accuracy in predicting the summation of wind power, solar power, or load over space."}, {"title": "A.2. Probabilistic Forecast", "content": "Energy Distance The energy distance is a popular metric for evaluating the quality of probabilistic forecasts (Messner, Pinson, Browell, Bjerreg\u00e5rd and Schicker, 2020). Given two probability distributions $F$ and $G$ with support in $\\mathbb{R}^D$, the energy distance between $F$ and $G$ is defined as\n$\\text{ED}(F, G) = 2\\mathbb{E} ||X - Y || - \\mathbb{E} ||X - X'|| - \\mathbb{E} ||Y - Y'||,$   (17)\nwhere $||\\cdot||$ is the Euclidean norm, and $X \\sim F, X' \\sim F, Y \\sim G, Y' \\sim G$ are independent random variables. In particular, when $F$ and $G$ are empirical probability distributions with"}, {"title": "A.3. Marginal Distributions", "content": "When estimating marginal distributions", "methods": "quantile regression and parameterized distribution estimation.\nNon-Parametric Estimation: Quantile Regression The quantile regression approach", "follows": "n$\\min \\sum_{t} \\sum_{\\tau \\in H} \\sum_{q \\in \\mathcal{Q}} \\sum_{i \\in D} QL_{q}\\left(z_{i,\\tau},\\hat{z}_{i,\\tau}^{(q)}\\right),$   (25)\nwhere $t$ iterates over all forecast creation times.\nThe quantile loss (QL) is defined as\n$QL_{q}\\left(z_{i,\\tau},\\hat{z}_{i,\\tau}^{(q)}\\right) = q\\left(\\hat{z}_{i,\\tau}^{(q)}-z_{i,\\tau}\\right)_{+}+(1-q)\\left(z_{i,\\tau}-\\hat{z}_{"}]}