{"title": "IOT-LLM: ENHANCING REAL-WORLD IOT TASK REASONING WITH LARGE LANGUAGE MODELS", "authors": ["Tuo An", "Yunjiao Zhou", "Han Zou", "Jianfei Yang"], "abstract": "Large Language Models (LLMs) have demonstrated remarkable capabilities across textual and visual domains but often generate outputs that violate physical laws, revealing a gap in their understanding of the physical world. Inspired by human cognition-where perception is fundamental to reasoning-we explore augmenting LLMs with enhanced perception abilities using Internet of Things (IoT) sensor data and pertinent knowledge for IoT task reasoning in the physical world. In this work, we systematically study LLMs' capability to address real-world IoT tasks by augmenting their perception and knowledge base, and then propose a unified framework, IoT-LLM, to enhance such capability. In IoT-LLM, we customize three steps for LLMs: preprocessing IoT data into formats amenable to LLMs, activating their commonsense knowledge through chain-of-thought prompting and specialized role definitions, and expanding their understanding via IoT-oriented retrieval-augmented generation based on in-context learning. To evaluate the performance, we design a new benchmark with five real-world IoT tasks with different data types and reasoning difficulties and provide the benchmarking results on six open-source and close-source LLMs. Experimental results demonstrate the limitations of existing LLMs with naive textual inputs that cannot perform these tasks effectively. We show that IoT-LLM significantly enhances the performance of IoT tasks reasoning of LLM, such as GPT-4, achieving an average improvement of 65% across various tasks against previous methods. The results also showcase LLMs' ability to comprehend IoT data and the physical law behind data by providing a reasoning process. Limitations of our work are claimed to inspire future research in this new era.", "sections": [{"title": "1 INTRODUCTION", "content": "Recent advancements in large generative models have showcased their exceptional performance and versatility in handling complex tasks across textual and visual domains, as evidenced by the GPT series (Radford et al., 2018; 2019; Brown et al., 2020; Achiam et al., 2023; OpenAI, 2023) and visual generation models (Dosovitskiy et al., 2020; Liu et al., 2021; Ho et al., 2020; Peebles & Xie, 2023; Blattmann et al., 2023). However, these models could occasionally generate outputs that are physically implausible, often referred to as \u201challucinations\" (Alkaissi & McFarlane, 2023; Huang et al., 2023). Even advanced video generation models, e.g., Sora (Brooks et al., 2024), are susceptible to producing animations that contravene fundamental physical laws, such as a video clip containing a tipping water glass that appears to defy gravity. These observations suggest that generative models may not really comprehend and apply physical laws of the physical world as accurately as humans when acting as world simulators. This has renewed interest in research on the World Model that focuses on understanding and modeling the physical world in a brain-like manner (Dawid & LeCun, 2023; Garrido et al., 2024; Mendonca et al., 2023; Liu et al., 2024).\nUnlike Large Language Models (LLMs) that map descriptions of the physical world to a latent space and perform reasoning by predicting the text sequence according to the probability, research on human cognitive science illustrates a different mechanism. The human brain comprises multiple mutually-functional areas, of which the important components include the temporal and occipital lobes for perception, and the frontal cortex for reasoning (Churchland & Sejnowski, 1988; Saxe"}, {"title": "2 RELATED WORK", "content": "ML/DL methods in IoT tasks. The Internet of Things (IoT) sensors gather diverse data from the real world, such as tri-axial acceleration, electrocardiogram readings, WiFi signals, and pres-sure (Sehrawat & Gill, 2019). These data have empowered various human sensing tasks, including Human Activity Recognition (HAR) (Lara & Labrador, 2013), health monitoring like heartbeat and respiration anomaly detection (Mousavi & Afghah, 2018; Aytekin et al., 2022), and industrial appli-cations such as machine operational state monitoring (Kong et al., 2023). Currently, these IoT data are primarily processed using traditional machine learning techniques, such as Support Vector Ma-chines (SVM) and K-Nearest Neighbors (KNN) Algorithm (Alam et al., 2016; Luo et al., 2021), or deep learning methods (Li et al., 2021; Njima et al., 2019). These approaches build black-box pre-dictors for specific tasks, yet each predictor only supports one task, and the task cannot be addressed with reasoning analysis, which motivates us to explore LLM for IoT tasks.\nLLMs in IoT tasks. Existing literature on Large Language Models (LLMs) in IoT mainly regards LLM as a user interface or as coordinators in smart machines (Li et al., 2023; Cui et al., 2023; Du et al., 2023). However, in these studies, LLMs function as intermediaries and do not directly interpret IoT data to perform real-world tasks. Recent studies, such as Penetrative AI (Xu et al., 2024a) and HarGPT (Ji et al., 2024), have begun integrating IoT data into LLMs for specific tasks, leveraging their inherent knowledge bases. Despite these advancements, the exploration of LLMs processing IoT data remains nascent. Penetrative AI converts IoT data into textual and numerical formats for basic tasks like R-peak identification in ECG data, heavily relying on manually crafted expert knowledge, which limits automation and scalability. Similarly, HarGPT processes raw IMU data to recognize human activities using a chain of thought technique but is restricted to this specific data type and task, not demonstrating the broader applicability of LLMs. While these studies provide initial insights into using LLMs in the IoT domain, they do not offer a comprehensive framework"}, {"title": "3 METHODOLOGY", "content": "In this section, we define the problem for IoT task reasoning with LLM and introduce our research methodology. The formulated research problem is how to leverage LLM and in-context learning for task reasoning for IoT data, termed as IoT task reasoning, e.g., using accelerators data for activity recognition or machine sensor for anomaly detection. The prompt for LLM should include two parts: data, as a way to perceive the physical world, and the task description, such as \u201cIs it a Normal heartbeat (N) or Premature ventricular contraction beat (V)?\", serves as the query. To evaluate the performance of IoT reasoning task, we build a new benchmark including 5 real-world tasks with different IoT data types and difficulty levels, encompassing both classification and regression problems.\nAt first, we employ LLMs to execute IoT tasks in a basic setting, similar to the existing ap-proaches (Ji et al., 2024; Xu et al., 2024b), where the prompt provided to the LLMs includes only raw IoT data and the associated query. However, the performance of LLMs remains suboptimal. As shown by the baseline results in Table 2, even GPT-4 only achieves an accuracy of 43% for 3-way activity recognition and 50% for machine diagnosis based on their approach. These preliminary results akin to near-random guessing suggest a lack of comprehension of IoT data and tasks by this naive prompting way. Upon analyzing the characteristics of IoT data and real-world tasks, we"}, {"title": "3.1 IOT DATA SIMPLIFICATION AND ENRICHMENT", "content": "Unlike textual human tasks that have been learned by LLMs, IoT data for IoT task reasoning presents unique challenges that hinder LLMs' comprehension. Firstly, IoT data encompasses a diverse range of types and forms, many of which are complex time-series data (e.g., electrocardiogram read-ings) (Goldberger et al., 2000) or multi-variant data (e.g., WiFi CSI) (Yang et al., 2024). LLMs often struggle with accurately interpreting dense numerical data, especially when it involves long-sequence time-series data (Zhang et al., 2024b). Secondly, IoT data is typically composed of raw numerical values. This data often lacks essential textual annotations, such as units of measurement and metadata about the data collection process, which are critical for LLMs to interpret effectively in real-world applications. In summary, raw IoT data requires (1) appropriate simplification and (2) information enrichment. Previous studies (Xu et al., 2024b) have employed down-sampling techniques for time-series data but they only achieve coarse-grained simplification at a length level without enhancing the informational content of the IoT data. In contrast, we not only simplify IoT data at the token level but also enrich the IoT data by providing additional information to facilitate better understanding by LLMs (as illustrated in Fig. 10 in Appendix B). In this way, we transform complex raw IoT data into an LLM-friendly format for IoT task reasoning.\nIoT data simplification. To achieve effective simplification, it is crucial to understand why LLMs struggle with dense numeric data. Firstly, according to recent research (Gruver et al., 2024; Spathis & Kawsar, 2023), tokenization methods, such as Byte Pair Encoding (BPE) often fragment numbers into tokens that do not align with their digits, resulting in inconsistent tokenization of floating-point numbers and complicating arithmetic operations. Therefore, in addition to down-sampling and keeping fixed precision (e.g., two digits of precision) to efficiently manage context length, we propose to insert spaces between digits to ensure distinct tokenization of each digit and use a comma (\u201c,\u201d) to separate each time step in a time series. Secondly, the complexity of long-sequence IoT data poses significant challenges for LLMs in analysis. To assist LLMs in processing this data, we extract essential statistical features, e.g., mean, variance, and FFT mean, utilizing external tools, such as Python scripts. We find that these fundamental features are strong enough for IoT task reasoning in classic IoT tasks. By doing so, we not only simplify IoT data at both length and token levels but also transform it into a format that is more suitable for tokenization and processing by LLMs.\nIoT data enrichment. As previously noted, IoT data alone is insufficient for LLMs to effectively perform real-world tasks. To address this, we enrich the data by incorporating contextual information about the physical world. Specifically, we provide a comprehensive overview of IoT data collection and the integration of physical information. For instance, in human activity recognition (HAR) tasks where we employ inertial measurement unit (IMU) data including triaxial acceleration and angular velocity from accelerometers and gyroscopes, we meticulously outline the data collection process, incorporating the metadata such as sampling frequency (e.g., 10 Hz), device placement on the body, and units of measurement (e.g., gravitational acceleration and radians per second). This approach enables LLMs to not only align the three-axis IMU data with the corresponding three-dimensional spatial orientations of the human body but also to understand the physical significance of these numerical values, thereby enhancing the comprehension of LLMs for the task in the physical world."}, {"title": "3.2 IOT-ORIENTED KNOWLEDGE RETRIEVAL AUGMENTATION", "content": "In IoT task reasoning, the knowledge of LLMs to perform IoT tasks is significant. For example, de-tecting abnormal heartbeats from electrocardiogram (ECG) data requires interpreting ECG signals and associating them with specific heartbeat states (e.g., normal, premature ventricular contraction), necessitating specialized domain knowledge. Although previous research (Xu et al., 2024b) pro-poses to include specific expert knowledge for specific tasks, the augmentation is task-specific and added manually, which is time-consuming and not scalable. To address this, we enable LLMs with"}, {"title": "3.3 PROMPT CONFIGURATION", "content": "In addition to augmenting LLMs' knowledge by providing external documents in the context uti-lizing the in-context learning capability of LLMs, we further invoke LLMs' internal knowledge by carefully configuring the prompt. Recent studies demonstrate that LLMs possess strong role-playing capabilities (Park et al., 2023). To leverage this, we assign specific roles to LLMs for particular tasks. For instance, we have LLMs assume the role of a professional doctor when performing heart-beat anomaly detection, thereby activating their internal domain knowledge. What's more, since LLMs' reasoning capability can be improved a lot by decomposing the whole problem into several parts (Wei et al., 2022), we decompose the reasoning procedure into two steps, prompting LLMs to analyze the IoT data and task first, and then provide the final answer based on this analysis. By do-ing so, we can also evaluate the extent to which the LLM understands IoT data and its capability to perform IoT tasks through the generated analysis. In the end, we employ a prompt template (refer to Fig. 8 in Appendix B) to structure the content discussed previously. The ultimate prompt is crafted based on the template and subsequently fed into a downstream LLM. The LLM then produces the final output, encompassing both analysis and answer to the specified task."}, {"title": "4 EXPERIMENTS", "content": "4.1 A BENCHMARK ON IOT TASK REASONING\n4.1.1 IOT TASKS.\nTo comprehensively assess the capability boundaries of LLMs for IoT task reasoning, we develop a new benchmark comprising five real-world tasks with diverse IoT data types and difficulty levels: (1) Human Activity Recognition (HAR) using Inertial Measurement Unit (IMU) data, (2) Industrial anomaly detection using metrics such as temperature, cooling power, and cooling efficiency, (3) Heartbeat anomaly detection using Electrocardiogram (ECG) data, (4) Human sensing using WiFi Channel State Information (CSI), and (5) Indoor localization based on WiFi signal strength. It is important to note that we don't need to construct a knowledge base for each task especially, in-"}, {"title": "4.1.2 IOT DATASETS.", "content": "In our benchmark, we choose public IoT datasets on the five tasks to ensure fairness. Since some datasets are too challenging for LLMs with many classes, we simplify some datasets by only using a subset, which is also employed in previous works (Ji et al., 2024).\nHuman Activity Recognition. We employ the Smartphone-Based Recognition of Human Activ-ities and Postural Transitions Dataset (Reyes-Ortiz et al., 2015). This dataset comprises raw IMU data, specifically 3-axial linear acceleration, and 3-axial angular velocity, captured at a sampling rate of 50Hz by the smartphone's accelerometer and gyroscope. The data encompasses twelve distinct activities. To reduce both the sequence length and data complexity, we down-sample the data to 10Hz. Given the challenges associated with multi-class classification for LLM, instead of utilizing all twelve activity categories, we conduct a binary classification task involving the WALKING and STANDING labels, and a ternary classification task with the LYING, WALKING UPSTAIRS, and LIE TO SIT labels.\nIndustrial anomaly detection. We employ the Condition Monitoring of Hydraulic Systems Dataset (Helwig et al., 2018), which facilitates the assessment of a hydraulic test rig's condition using multi-sensor data, including temperature, cooling power, and efficiency factor series, all ex-perimentally derived from the rig. The dataset categorizes cooler conditions into three severity grades: (1) close to failure; (2) reduced efficiency; and (3) full efficiency. For simplicity, we focus on a binary classification task using only \"close to failure\"and \"full efficiency\"categories.\nHeartbeat anomaly detection. We employ the MIT-BIH Arrhythmia Database (Goldberger et al., 2000). This dataset comprises ECG recordings from 48 subjects, each sampled at 360Hz, and cat-egorizes heartbeats into several types, including Normal beat (N), Atrial premature beat (A), and Premature ventricular contraction (V), among others. To reduce the difficulty of the task, we down-sample the signals to 72Hz and focus on a binary classification task using only the Normal beat (N) and Premature ventricular contraction (V) categories.\nHuman sensing task. We utilize a dataset collected using a TP-Link TL-WDR4300 WiFi router operating at 5 GHz with a 40 MHz bandwidth (Zhuravchak et al., 2022). The dataset specifically captures the absence of human presence across three different rooms. Each room's environment is carefully monitored to record Channel State Information (CSI) that reflects the presence or absence of occupants, providing a robust basis for occupancy detection tasks.\nIndoor localization task. We utilize a dataset collected in a laboratory environment using an IoT system developed in (Huang et al., 2022). The dataset consists of RSSI signals, the basis for determining human positions within the space. By collecting RSSI fingerprints at various reference points, a signal radio map is constructed using a modified Gaussian Process Regression (GPR) method. This approach allows us to estimate the RSS distribution at any given location, providing a reliable means of localizing human presence in the environment."}, {"title": "4.1.3 LLM BASELINES.", "content": "In the conducted experiments, we utilize a combination of proprietary and open-source LLMs, in-cluding gpt-3.5-turbo, gpt-4-turbo, claude-3-5-sonnet, gemini-pro, Mistral-7B, and LLama2-7B. This diverse selection of models enables a comprehensive evaluation of the LLMs' capabilities in executing IoT tasks and provides insights into their respective strengths and limitations in real-world applications. The project code will be made available after publication."}, {"title": "4.2 RESULTS AND ANALYSIS", "content": "To evaluate the efficacy of our proposed framework in enhancing the capabilities of IoT task reason-ing for LLMs, we use HarGPT (Ji et al., 2024) as the baseline, of which the prompts only contain raw IoT data and corresponding task descriptions, without any data preprocessing, domain knowl-edge, and demonstrations. The overall performance of LLMs on IoT tasks is shown in Table 1 and"}, {"title": "4.3 ABLATION STUDY", "content": "To evaluate the impact of different components within our framework, we performed an ablation study using GPT-4 on HAR and industrial anomaly detection tasks. We tested the following con-figurations: (1) IoT data simplification and enrichment, (2) addition of retrieved domain knowledge based on (1), (3) inclusion of retrieved demonstrations based on (2), and (4) the full configura-tion, which incorporates role descriptions and chain-of-thought techniques as outlined in the Prompt Configuration stage. The results, presented in Table 3, reveal that for straightforward tasks such as classifying walking and standing activities, IoT data simplification and enrichment and domain knowledge retrieval are sufficient. However, for more complex tasks, the inclusion of additional modules significantly boosts performance. Overall, our findings indicate that each module in our framework progressively enhances the ability of LLMs to perform IoT-related tasks using IoT data."}, {"title": "5 CONCLUSION", "content": "LLMs often struggle with tasks requiring an understanding of physical laws. To address this, we pro-pose IoT-LLM, a framework that integrates IoT sensor data with LLMs to enhance their perception and reasoning abilities in the physical world. Evaluated on tasks like human activity recognition and industrial anomaly detection, IoT-LLM improves LLM performance by approximately 65%, though challenges remain in specialized domains. This approach systematically enhances LLM capabilities for real-world applications by leveraging IoT data.\nLimitations. While LLMs can manage low-dimensional time-series data, they face significant challenges with higher-dimensional data, such as audio and 3D point cloud data, due to their ex-tensive length and complexity. Integrating such data into the context of LLMs is both difficult and impractical. Instead, directly fine-tuning LLMs with data specific to these modalities may be a more effective approach. This strategy could be explored in future research to extend the capabilities of LLMs to handle more complex data types within the IoT domain."}]}