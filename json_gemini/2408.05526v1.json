{"title": "CryoBench: Diverse and challenging datasets for the heterogeneity problem in cryo-EM", "authors": ["Minkyu Jeon", "Rishwanth Raghu", "Miro Astore", "Geoffrey Woollard", "Ryan Feathers", "Alkin Kaz", "Sonya M. Hanson", "Pilar Cossio", "Ellen D. Zhong"], "abstract": "Cryo-electron microscopy (cryo-EM) is a powerful technique for determining high-resolution 3D biomolecular structures from imaging data. As this technique can capture dynamic biomolecular complexes, 3D reconstruction methods are increasingly being developed to resolve this intrinsic structural heterogeneity. However, the absence of standardized benchmarks with ground truth structures and validation metrics limits the advancement of the field. Here, we propose CryoBench, a suite of datasets, metrics, and performance benchmarks for heterogeneous reconstruction in cryo-EM. We propose five datasets representing different sources of heterogeneity and degrees of difficulty. These include conformational heterogeneity generated from simple motions and random configurations of antibody complexes and from tens of thousands of structures sampled from a molecular dynamics simulation. We also design datasets containing compositional heterogeneity from mixtures of ribosome assembly states and 100 common complexes present in cells. We then perform a comprehensive analysis of state-of-the-art heterogeneous reconstruction tools including neural and non-neural methods and their sensitivity to noise, and propose new metrics for quantitative comparison of methods. We hope that this benchmark will be a foundational resource for analyzing existing methods and new algorithmic development in both the cryo-EM and machine learning communities.", "sections": [{"title": "Introduction", "content": "Single particle cryo-electron microscopy (cryo-EM) is a widely used imaging technique for visualizing biomolecular complexes at near-atomic resolution. A major challenge in cryo-EM structure determination is the task of reconstructing 3D density maps from an experimentally-derived dataset of 2D images [1]. These images characteristically exhibit extremely low signal-to-noise ratios (SNR), with unknown poses (3D orientations and 2D translations) of individual images, and there is often heterogeneity in both conformational and compositional aspects of the target protein complex (Fig. 1a). Despite these challenges, cryo-EM holds significant promise due to its ability to capture structural heterogeneity of intrinsic biological interest, which is typically inaccessible to structure prediction tools such as AlphaFold [2, 3]. Consequently, numerous heterogeneous reconstruction methods have been proposed in recent years to address these challenges [4, 5, 6, 7, 8, 9, 10].\nSeveral state-of-the-art heterogeneous reconstruction methods leverage deep learning to capture the structural heterogeneity through a continuous latent variable, allowing structural changes to be represented as trajectories on a manifold [11, 12]. However, current research on heterogeneous"}, {"title": "Background and Related Work", "content": "Heterogeneous reconstruction. Over the past decade, advances in cryo-EM technology have led to major increases in data quality, enabling atomic resolution structure determination of static protein structures [15]. The ability to image heterogeneous systems both presents a unique opportunity for structural biology, and poses a major computational challenge for 3D reconstruction. To address this opportunity, there has recently been an explosion of methods for heterogeneous cryo-EM reconstruction [4, 6, 7, 16, 8, 9, 17, 18, 19, 10, 20, 21, 22, 23, 24, 25]. Methods take a variety of approaches, with differences in volume representation (real, Fourier; explicit voxel grids, meshes, or implicit neural representations; Gaussian kernels in coordinate spaces; other basis functions), inference approach (statistical inference approaches, end-to-end gradient-based methods, minimax optimization), use of physically informed priors, and assumed inputs to the task [11, 12]. However, these methods typically use different datasets to illustrate their algorithm's efficacy, making it difficult to judge which methods outperform the others, and for which cases.\nPast Benchmarks. While standard benchmarks in this field have yet to be established, there are some consistent datasets that have been used. For example, an experimental dataset that has been used for compositional heterogeneity is the different assembly states of the large subunit of a bacterial ribosome (EMPIAR-10076) [26], and a commonly used real dataset for conformational heterogeneity is the pre-catalytic spliceosome (EMPIAR-10180) [27]. However, it is also common to generate simulated cryo-EM datasets for which a ground truth is known [28, 6, 29, 30], but so far these are generated ad hoc for a research project, and not taken from a standard benchmark dataset for which the performance of other methods is known. There have been attempts at benchmark studies for heterogeneity where many methods are applied to a single dataset [31, 32], but this approach does not address performance across different types of heterogeneity such as conformational motions or compositional changes. Ideally, a common set of diverse benchmark datasets can be used by the community to compare different methods. Here, we focus on synthetic but challenging datasets where ground truth information is available for all latent variables, allowing for rigorous, quantitative benchmarking.\nMetrics. In addition to benchmark datasets, metrics with which to assess heterogeneity methods themselves are also lacking. Metrics for assessing homogeneous 3D reconstruction methods, where only a single volume is achieved from a cryo-EM image stack, are more mature and often incorporate the Fourier shell correlation (FSC) to judge resolution [33, 34], and a gold standard approach for computing [35] has been widely adopted by the community (though this has its own degree of controversy [36]). However, when it comes to evaluating heterogeneous reconstructions, metrics become much less straightforward, and the standard FSC-based approach is flawed as it provides a global assessment of resolution and is typically performed on independent half-sets and thus is only a self-consistency measure. Recent work has introduced new metrics either to improve priors for variational autoencoders or to disentangle latent embeddings based on ground truth [37, 38, 39]. However, analysis metrics that can compare different methods remain challenging. Here, we choose to use metrics that depend on knowing ground truth from synthetic datasets, which either use (a) the FSC-but with nuances appropriate to for heterogeneity-or (b) applying local neighborhood comparisons and clustering accuracy on latent representations [40, 41]."}, {"title": "CryoBench Design", "content": "We generate CryoBench datasets by designing an ensemble of atomic models to serve as ground truth structures, followed by simulating the cryo-EM forward process to generate synthetic images."}, {"title": "Image Formation Model", "content": "Cryo-EM density volumes are first generated from each atomic model by simulating the electron scattering potential of each atom. From the volumes, we generate cryo-EM images I\u00bf following the standard image formation model in the Fourier domain:\n\\(I_i = C_iPV + N_i\\)"}, {"title": "Conformational Heterogeneity", "content": "IgG-1D. Starting from an atomic model of the human immunoglobulin G (IgG) antibody (PDB: 1HZH), conformational heterogeneity is produced by rotating a dihedral angle connecting one of the fragment antibody (Fab) domains (Fig. 2a), simulating a simple one-dimensional continuous circular motion. This process yields 100 atomic models approximating the continuous dihedral rotation (360 degrees, 3.6-degree intervals). We simulate 1,000 images for each conformation, apply CTF and add noise at a signal-to-noise (SNR) ratio of 0.01 to produce a dataset of 100k images.\nIgG-RL. Many protein complexes, including IgG, possess relatively rigid domains connected by a disordered peptide linker (e.g. exemplifying \"beads on a string\"). To model this more realistic and complex motion and provide a challenging case of heterogeneity, we generate random conformations for the linker connecting the Fab to the rest of the IgG complex (Fig. 4b). We identified a sequence of 5 residues as the linker and generated random realizations of its structure by sampling the backbone dihedral angles according to the Ramachadran distributions of disordered peptides from Towse et al. [42], using rejection sampling to eliminate"}, {"title": "Compositional Heterogeneity", "content": "Ribosembly. We create a dataset modeling ribosome assembly as a simple example of compositional heterogeneity. In particular, these structures contain a common core that is successively grown through the addition of proteins and ribosomal RNA. We use the bacterial ribosome assembly states from Qin et al. [44] consisting of 16 different atomic models, which we color in groups according to structural similarity in Figure 6a. We generate a non-uniform number of images for each ground truth structure following the distribution in the original publication, apply the CTF, and add noise to an SNR of 0.01 to produce a dataset of 335,240 images.\nTomotwin-100. While cryo-EM is typically performed on purified samples or simple mixtures, in principle, the technique can be used to image complex mixtures e.g. from cellular lysates or in situ samples from cryo-ET. To create a challenging dataset of modeling compositional heterogeneity of this scale, we use atomic models from the curated set of cellular complexes in Rice et al. [45]. Here"}, {"title": "Evaluation Framework", "content": "As part of CryoBench, we consider methods for heterogeneous reconstruction with fixed (ground truth) poses, and the more challenging task of ab initio reconstruction where no input poses are provided. We evaluate seven fixed pose state-of-the-art methods and three ab initio variants. The fixed pose methods include 3D Classification (3D Class) in cryoSPARC [46], 3DVA [8], 3DFlex [9], CryoDRGN [7], DRGN-AI-fixed [47], Opus-DSD [18], and RECOVAR [19]. For ab initio methods, we use multiclass ab initio reconstruction in cryoSPARC (3D Class abinit) [46], CryoDRGN2 [48], and DRGN-AI [47]. An overview of these methods and training details can be found in Appendix B."}, {"title": "Analysis and Metrics", "content": "We present analyses and metrics for comprehensive comparison of existing state-of-the-art methods, addressing both qualitative and quantitative aspects. For qualitative evaluation, we visualize each method's distribution of latent embeddings, which collectively define a low-dimensional manifold capturing conformational and compositional variability in the particle images. We additionally sample representative density volumes for visual inspection.\nFor quantitative evaluation, we propose three metrics for comparison of embeddings: 1) Neighborhood Similarity, 2) Information imbalance, and 3) Adjusted Rand Index (ARI). To assess reconstructed volumes, we propose \"Per-Conformation Fourier Shell Correlation (FSC)\" as a metric that jointly evaluates image conformation estimation and reconstruction quality."}, {"title": "Embedding Comparisons", "content": "Neighborhood Similarity. To quantify the similarity between local neighborhoods in the learned embedding spaces and a ground truth heterogeneity embedding, we first use a generalization of neighborhood similarity [40]. We quantify the percentage of matching neighbors (pMN) with respect to the ground truth that are found within a neighborhood radius k,\n\\(pMN(k) = \\frac{100}{kN}\\sum_{i}\\sum_{j}S(NN_i^{gt}) ,\\)"}, {"title": "Results", "content": "We present the results of each dataset in Figure 2-7, and we report summary statistics of volume metrics and run times in Table 1.\nIgG-1D. Figure 2c illustrates UMAP visualization of the methods' latent spaces colored by dihedral conformations. The methods generally demonstrate compact clustering, and well preserved local neighborhoods relative to the ground truth quantified by a high neighborhood similarity and close to the equivalent region, (0,0), in the information imbalance plane (Fig. 2d). RECOVAR exhibits a latent space structure most consistent with the ground truth manifold, as shown by the embedding metrics in Figure 2d, while also achieving the highest reconstruction quality as shown in Table 1. In contrast, the rotating Fab domain is not well captured by 3DFlex (Fig. 2b), indicating limitations in effectively representing intricate conformal motions. Additionally, we provide Time per epoch for each method. For 3D Class abinit and RECOVAR, which do not have epochs, we report the whole training time. As expected, ab initio methods take significantly longer than fixed pose methods. With increasing noise levels, Figure 3a, we find that the volume metrics decrease as expected. Ab initio methods fail to reconstruct at the lowest SNR (Fig. 3b)."}, {"title": "Conclusion and Future Directions", "content": "CryoBench presents: 1) five synthetic datasets containing conformational and compositional heterogeneity; 2) comprehensive analyses of ten existing state-of-the-art tools across these datasets; and 3) new quantitative metrics and qualitative visualizations to compare these baselines. Our metrics assess representation learning, reconstruction quality, and the end-to-end heterogeneous reconstruction task. Overall, we find that quantification of the reconstruction performance aligns well with qualitative observations.\nIn addition to simple datasets that provide interpretable results for development and validation, we propose challenging datasets that push the frontiers of heterogeneous cryo-EM reconstruction. We anticipate that these datasets and metrics could inspire the exploration of new tasks for methods development, both in cryo-EM and within related areas of computer vision and computational imaging. These tasks may include generalization beyond training dataset distributions, high-resolution neural rendering, and the incorporation of biophysical priors into models. Our datasets are designed such that methods geared towards these challenges will also address key frontiers in cryo-EM and structural biology.\nIn future work, we aim to explore several limitations of the current benchmark. For example, we could use more complex or realistic noise statistics in image formation or simulate the joint presence of compositional and conformational heterogeneity. Through the active use of these datasets by the community, we anticipate that custom metrics designed for each type of heterogeneity will be fruitful, such as analyses of free energy landscapes and atomic-level motions in the case of MD data. Lastly, while the presented synthetic datasets provide a challenging setting for methods development, future versions of the benchmark could include non-structural sources of heterogeneity found in real cryo-EM datasets, such as junk particles and non-uniform pose distributions. We anticipate that these developments will facilitate the application of novel methods towards biological discovery on real data."}, {"title": "Data and Software Availability", "content": "CryoBench datasets and tools are available at https://cryobench.cs.princeton.edu/."}, {"title": "Data Availability", "content": "CryoBench datasets are deposited to Zenodo with the following DOIs:"}, {"title": "Software Availability", "content": "Scripts for simulating cryo-EM images and computing metrics are available at https://github.com/ml-struct-bio/CryoBench."}, {"title": "Glossary of Terms from Single-Particle Electron Cryo-Microscopy", "content": "Sample\nBiomolecular: Pertaining to molecules involved in the biological processes of living organisms, such as proteins and nucleic acids.\nProtein: Large, complex molecules made up of amino acids, essential for various biological functions like catalyzing metabolic reactions and DNA replication.\nNucleic Acid: A type of biomolecule, including (deoxy)ribonucleic acid (DNA, RNA, respectively). This term can refer to a single unit that can polymerize (form a long chain).\nComplex: In the context of biomolecular complexes, the term 'complex' refers to a stable association of two or more biomolecules that interact with each other, typically to perform a specific biological function. The interactions that hold these molecules together can be non-covalent, such as hydrogen bonds, ionic interactions, van der Waals forces, and hydrophobic effects, or covalent, such as disulfide bonds.\nSubunit: a part of a larger whole. The part (domain, polypeptide) is contextual to the whole (domain, protein complex).\nHeterogeneity\nHeterogeneity: The presence of variations in shape or the presence or absence of mass within a sample. Coming in two main sub-classes\nCompositional: Related to the total amount of mass and their proportions within a sample or structure. Often used in the context of discrete differences in total mass.\nConformational: Pertaining to the various shapes or structures that a molecule can adopt. Often used in the context of continuous movement in 3D space.\n3D Structure: The spatial form or shape of an object, which in the context of cryo-EM refers to the 3D structure of biomolecules. Often contrasted with the sequence of a biomolecule, or schematic (e.g. 2D) representations communicating atom type of bond connectivity.\nConformation: The specific three-dimensional arrangement of atoms in a molecule. Often employed in the plural to refer to the different shapes a particular biomolecule can adopt.\n(Biomolecular) Ensemble: The collection of multiple conformations of a biomolecule. Biomolecules are typically dynamic and change conformations due to thermal fluctuations and interactions to carry out function [60, 61]. This concept is related to microstates and macrostates in statistical thermodynamics. A microstate represents a specific arrangement of particles at a given moment, while a macrostate describes the overall properties of a system, encompassing many possible microstates. Similarly, a biomolecular ensemble in cryo-EM represents the collection of microstates (individual conformations) that contribute to the observed macrostate (overall structural and functional behavior) of the biomolecule.\nCollective Variable (CV): A parameter used to describe the state of a system, typically in terms of a few degrees of freedom. Further distinguished into geometric (centre of mass, angle, distance) and abstract [62]. The term CV is related to \u2018order parameter', and 'reaction coordinate', which is often used in the context of reactants and products in chemical catalysis [63]. However, as employed in the biomolecular simulation community, CVs typically relate to distinguishing metastable states [64].\nModel and Representation\nAngstrom (\u00c5): A unit of length equal to 0.1 nm, or 10-10 m. Often used in chemistry because the diameter of an atom and the distance between atoms is close to 1 \u00c5.\nVoxel: A volume element representing an intensity value on a regular grid in three- dimensional space, similar to a pixel in 2D images but for a 3D array. A typical voxel volume ranges 0.53 \u2013 23 \u00c5\u00b3."}]}