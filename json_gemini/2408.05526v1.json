{"title": "CryoBench: Diverse and challenging datasets for the heterogeneity problem in cryo-EM", "authors": ["Minkyu Jeon", "Rishwanth Raghu", "Miro Astore", "Geoffrey Woollard", "Ryan Feathers", "Alkin Kaz", "Sonya M. Hanson", "Pilar Cossio", "Ellen D. Zhong"], "abstract": "Cryo-electron microscopy (cryo-EM) is a powerful technique for determining high-resolution 3D biomolecular structures from imaging data. As this technique can capture dynamic biomolecular complexes, 3D reconstruction methods are increasingly being developed to resolve this intrinsic structural heterogeneity. However, the absence of standardized benchmarks with ground truth structures and validation metrics limits the advancement of the field. Here, we propose CryoBench, a suite of datasets, metrics, and performance benchmarks for heterogeneous reconstruction in cryo-EM. We propose five datasets representing different sources of heterogeneity and degrees of difficulty. These include conformational heterogeneity generated from simple motions and random configurations of antibody complexes and from tens of thousands of structures sampled from a molecular dynamics simulation. We also design datasets containing compositional heterogeneity from mixtures of ribosome assembly states and 100 common complexes present in cells. We then perform a comprehensive analysis of state-of-the-art heterogeneous reconstruction tools including neural and non-neural methods and their sensitivity to noise, and propose new metrics for quantitative comparison of methods. We hope that this benchmark will be a foundational resource for analyzing existing methods and new algorithmic development in both the cryo-EM and machine learning communities.", "sections": [{"title": "1 Introduction", "content": "Single particle cryo-electron microscopy (cryo-EM) is a widely used imaging technique for visualizing biomolecular complexes at near-atomic resolution. A major challenge in cryo-EM structure determination is the task of reconstructing 3D density maps from an experimentally-derived dataset of 2D images [1]. These images characteristically exhibit extremely low signal-to-noise ratios (SNR), with unknown poses (3D orientations and 2D translations) of individual images, and there is often heterogeneity in both conformational and compositional aspects of the target protein complex (Fig. 1a). Despite these challenges, cryo-EM holds significant promise due to its ability to capture structural heterogeneity of intrinsic biological interest, which is typically inaccessible to structure prediction tools such as AlphaFold [2, 3]. Consequently, numerous heterogeneous reconstruction methods have been proposed in recent years to address these challenges [4, 5, 6, 7, 8, 9, 10].\nSeveral state-of-the-art heterogeneous reconstruction methods leverage deep learning to capture the structural heterogeneity through a continuous latent variable, allowing structural changes to be represented as trajectories on a manifold [11, 12]. However, current research on heterogeneous reconstruction methods has two main limitations: 1) the absence of common benchmarks comparable to MNIST [13] or ImageNet [14] in computer vision that drove tremendous progress for the field and 2) the lack of metrics suitable for evaluation and comparison of methods.\nPrevious methods development has relied on various types of benchmarks. These include: a) real datasets known to have sensible conformal trajectories, allowing experts to perform qualitative benchmarking by visually assessing reconstructed volumes, b) datasets of synthetic blob-like volumes used to demonstrate that models' conformational latent spaces can represent simple 1D and 2D motions as parameterized motions, and c) pseudo-real motions, where real molecular structures are used, but simple motions such as rotations are applied to the subregions of the structure to generate a continuum of conformations. The lack of realistic and common benchmarks poses challenges in training models whose performance can generalize well across different datasets or in comparing existing heterogeneous reconstruction methods without relying on expert intuition. Moreover, because each method has been applied to different datasets designed to showcase different types of heterogeneity, practitioners cannot compare and determine the most promising method for their application. Finally, since these methods are mostly tested on real datasets with no ground truth, it's hard to assess whether a given method produces accurate results on a new dataset, or how much to trust its scientific conclusions.\nIn this work, we design new challenging datasets and evaluation metrics for the heterogeneous cryo-EM reconstruction task. Our datasets contain a range of types of heterogeneity and are synthetically generated in order to have ground truth poses, conformational states, and imaging parameters for quantitative evaluation. Our datasets range from having simple heterogeneity for diagnostic use to more challenging forms of heterogeneity for motivating new methods in cryo-EM (Fig. 1b). Using these datasets, we conduct extensive experiments on existing state-of-the-art methods (Fig. 1c). We introduce metrics for both qualitative and quantitative comparison of methods (Fig. 1d) and suggest new directions for methods development. CryoBench, including tools for dataset generation and model evaluation, is available at https://cryobench.cs.princeton.edu/."}, {"title": "2 Background and Related Work", "content": "Heterogeneous reconstruction. Over the past decade, advances in cryo-EM technology have led to major increases in data quality, enabling atomic resolution structure determination of static protein structures [15]. The ability to image heterogeneous systems both presents a unique opportunity for structural biology, and poses a major computational challenge for 3D reconstruction. To address this opportunity, there has recently been an explosion of methods for heterogeneous cryo-EM reconstruction [4, 6, 7, 16, 8, 9, 17, 18, 19, 10, 20, 21, 22, 23, 24, 25]. Methods take a variety of approaches, with differences in volume representation (real, Fourier; explicit voxel grids, meshes, or implicit neural representations; Gaussian kernels in coordinate spaces; other basis functions), inference approach (statistical inference approaches, end-to-end gradient-based methods, minimax optimization), use of physically informed priors, and assumed inputs to the task [11, 12]. However, these methods typically use different datasets to illustrate their algorithm's efficacy, making it difficult to judge which methods outperform the others, and for which cases.\nPast Benchmarks. While standard benchmarks in this field have yet to be established, there are some consistent datasets that have been used. For example, an experimental dataset that has been used for compositional heterogeneity is the different assembly states of the large subunit of a bacterial ribosome (EMPIAR-10076) [26], and a commonly used real dataset for conformational heterogeneity is the pre-catalytic spliceosome (EMPIAR-10180) [27]. However, it is also common to generate simulated cryo-EM datasets for which a ground truth is known [28, 6, 29, 30], but so far these are generated ad hoc for a research project, and not taken from a standard benchmark dataset for which the performance of other methods is known. There have been attempts at benchmark studies for heterogeneity where many methods are applied to a single dataset [31, 32], but this approach does not address performance across different types of heterogeneity such as conformational motions or compositional changes. Ideally, a common set of diverse benchmark datasets can be used by the community to compare different methods. Here, we focus on synthetic but challenging datasets where ground truth information is available for all latent variables, allowing for rigorous, quantitative benchmarking.\nMetrics. In addition to benchmark datasets, metrics with which to assess heterogeneity methods themselves are also lacking. Metrics for assessing homogeneous 3D reconstruction methods, where only a single volume is achieved from a cryo-EM image stack, are more mature and often incorporate the Fourier shell correlation (FSC) to judge resolution [33, 34], and a gold standard approach for computing [35] has been widely adopted by the community (though this has its own degree of controversy [36]). However, when it comes to evaluating heterogeneous reconstructions, metrics become much less straightforward, and the standard FSC-based approach is flawed as it provides a global assessment of resolution and is typically performed on independent half-sets and thus is only a self-consistency measure. Recent work has introduced new metrics either to improve priors for variational autoencoders or to disentangle latent embeddings based on ground truth [37, 38, 39]. However, analysis metrics that can compare different methods remain challenging. Here, we choose to use metrics that depend on knowing ground truth from synthetic datasets, which either use (a) the FSC\u2014but with nuances appropriate to for heterogeneity\u2014or (b) applying local neighborhood comparisons and clustering accuracy on latent representations [40, 41]."}, {"title": "3 CryoBench Design", "content": "We generate CryoBench datasets by designing an ensemble of atomic models to serve as ground truth structures, followed by simulating the cryo-EM forward process to generate synthetic images."}, {"title": "3.1 Image Formation Model", "content": "Cryo-EM density volumes are first generated from each atomic model by simulating the electron scattering potential of each atom. From the volumes, we generate cryo-EM images \\(I_i\\) following the standard image formation model in the Fourier domain:\n\\[I_i = C_iPV_i + N_i\\]"}, {"title": "3.2 Conformational Heterogeneity", "content": "IgG-1D. Starting from an atomic model of the human immunoglobulin G (IgG) antibody (PDB: 1HZH), conformational heterogeneity is produced by rotating a dihedral angle connecting one of the fragment antibody (Fab) domains (Fig. 2a), simulating a simple one-dimensional continuous circular motion. This process yields 100 atomic models approximating the continuous dihedral rotation (360 degrees, 3.6-degree intervals). We simulate 1,000 images for each conformation, apply CTF and add noise at a signal-to-noise (SNR) ratio of 0.01 to produce a dataset of 100k images.\nIgG-RL. Many protein complexes, including IgG, possess relatively rigid domains connected by a disordered peptide linker (e.g. exemplifying \"beads on a string\"). To model this more realistic and complex motion and provide a challenging case of heterogeneity, we generate random conformations for the linker connecting the Fab to the rest of the IgG complex (Fig. 4b). We identified a sequence of 5 residues as the linker and generated random realizations of its structure by sampling the backbone dihedral angles according to the Ramachadran distributions of disordered peptides from Towse et al. [42], using rejection sampling to eliminate\nstructures with steric clashes. We generate 100 such atomic models and simulate 1k projections per conformation, apply CTF and add noise at an SNR of 0.01 to produce a dataset of 100k images.\nSpike-MD. As a challenging example of detailed motions, we use a long-timescale molecular dynamics simulation as a source of ground truth models for dataset construction. Specifically, we use a simulation of the activating SARS-CoV-2 spike protein from Wiecz\u00f3r et al. [43]. Images for Spike-MD are generated at a higher resolution (\\(D = 256\\)) to assess the ability of methods to capture high-resolution motions. We generate a dataset of 100k projection images at an SNR of 0.1.\nIgG-1D-noisier and -noisiest. One of the most salient characteristics of cryo-EM images is the high degree of noise. As a test of the robustness of each method to the amount of noise, we also create versions of the IgG-1D dataset at SNR 0.005 for IgG-1D-noisier and 0.001 for IgG-1D-noisiest."}, {"title": "3.3 Compositional Heterogeneity", "content": "Ribosembly. We create a dataset modeling ribosome assembly as a simple example of compositional heterogeneity. In particular, these structures contain a common core that is successively grown through the addition of proteins and ribosomal RNA. We use the bacterial ribosome assembly states from Qin et al. [44] consisting of 16 different atomic models, which we color in groups according to structural similarity in Figure 6a. We generate a non-uniform number of images for each ground truth structure following the distribution in the original publication, apply the CTF, and add noise to an SNR of 0.01 to produce a dataset of 335,240 images.\nTomotwin-100. While cryo-EM is typically performed on purified samples or simple mixtures, in principle, the technique can be used to image complex mixtures e.g. from cellular lysates or in situ samples from cryo-ET. To create a challenging dataset of modeling compositional heterogeneity of this scale, we use atomic models from the curated set of cellular complexes in Rice et al. [45]. Here"}, {"title": "4 Evaluation Framework", "content": "As part of CryoBench, we consider methods for heterogeneous reconstruction with fixed (ground truth) poses, and the more challenging task of ab initio reconstruction where no input poses are provided. We evaluate seven fixed pose state-of-the-art methods and three ab initio variants. The fixed pose methods include 3D Classification (3D Class) in cryoSPARC [46], 3DVA [8], 3DFlex [9], CryoDRGN [7], DRGN-AI-fixed [47], Opus-DSD [18], and RECOVAR [19]. For ab initio methods, we use multiclass ab initio reconstruction in cryoSPARC (3D Class abinit) [46], CryoDRGN2 [48], and DRGN-AI [47]. An overview of these methods and training details can be found in Appendix B."}, {"title": "4.1 Analysis and Metrics", "content": "We present analyses and metrics for comprehensive comparison of existing state-of-the-art methods, addressing both qualitative and quantitative aspects. For qualitative evaluation, we visualize each method's distribution of latent embeddings, which collectively define a low-dimensional manifold capturing conformational and compositional variability in the particle images. We additionally sample representative density volumes for visual inspection.\nFor quantitative evaluation, we propose three metrics for comparison of embeddings: 1) Neighborhood Similarity, 2) Information imbalance, and 3) Adjusted Rand Index (ARI). To assess reconstructed volumes, we propose \"Per-Conformation Fourier Shell Correlation (FSC)\" as a metric that jointly evaluates image conformation estimation and reconstruction quality."}, {"title": "4.1.1 Embedding Comparisons", "content": "Neighborhood Similarity. To quantify the similarity between local neighborhoods in the learned embedding spaces and a ground truth heterogeneity embedding, we first use a generalization of neighborhood similarity [40]. We quantify the percentage of matching neighbors (pMN) with respect to the ground truth that are found within a neighborhood radius k,\n\\[pMN(k) = \\frac{100}{kN}\\sum_i S(NN_i^{k} , GT_i^k).\\]"}, {"title": "5 Results", "content": "We present the results of each dataset in Figure 2-7, and we report summary statistics of volume metrics and run times in Table 1.\nIgG-1D. Figure 2c illustrates UMAP visualization of the methods' latent spaces colored by dihedral conformations. The methods generally demonstrate compact clustering, and well preserved local neighborhoods relative to the ground truth quantified by a high neighborhood similarity and close to the equivalent region, (0,0), in the information imbalance plane (Fig. 2d). RECOVAR exhibits a latent space structure most consistent with the ground truth manifold, as shown by the embedding metrics in Figure 2d, while also achieving the highest reconstruction quality as shown in Table 1. In contrast, the rotating Fab domain is not well captured by 3DFlex (Fig. 2b), indicating limitations in effectively representing intricate conformal motions. Additionally, we provide Time per epoch for each method. For 3D Class abinit and RECOVAR, which do not have epochs, we report the whole training time. As expected, ab initio methods take significantly longer than fixed pose methods. With increasing noise levels, Figure 3a, we find that the volume metrics decrease as expected. Ab initio methods fail to reconstruct at the lowest SNR (Fig. 3b).\nIgG-RL. The overall performance of IgG-RL in Table 1 is lower than that of IgG-1D, attributed to the more challenging dataset design. In particular, Fab orientation inference is challenging, limiting the resolution of the moving Fab (Fig. 4c). Nonetheless, some methods, such as Opus-DSD or DRGN-AI-fixed, are able to conserve high neighborhood similarity and equivalent information with the ground truth for small radii (Fig. 4d). RECOVAR demonstrates superior performance in the FSC metric. Among ab initio methods, DRGN-AI generally outperforms the others. Despite the random orientations of the moving Fab, ab initio methods are able to align on the fixed region.\nSpike-MD. The high number of unique structures (46k) makes this dataset comparatively challenging with some methods modeling the continuous motion better than others by visual inspection (Fig. 5c). UMAP visualizations of the latent space reveal that methods have learned a variety of topologies, with neither of the ground truth coordinates correlating well with the different UMAP embeddings (Fig. 5d). As shown in Figure S22, the neighborhood similarity metric also shows a poor local neighborhood overlap (<35%) at small-to-intermediate radii suggesting that there is low neighborhood correlation with the ground truth, indicating that the flexibility is indeed a challenging inference task. The Per-Conformation FSC plot for Spike-MD is provided in Figure S8. Future work could explore more custom analyses and metrics for MD data, and we hope to enable future methods development connecting MD simulations with cryo-EM.\nRibosembly. Methods are largely capable of reconstructing the ground truth states (Fig. 6b,e). However, latent embeddings do not perfectly cluster each ground truth assembly state (Fig. 6c), quantified in Table 2. The neighborhood similarity ranges are intermediate, from 50-80%, for a neighborhood clustering size k corresponding to the true number of images belonging to each state (Fig. 6d). Here, the neighborhood similarity uses a rank-size embedding for ground truth heterogeneity, while information imbalance uses the voxel intensities, where similar assembly states would have a close distance. RECOVAR demonstrates better clustering, with DRGN-AI also\nperforming well amongst ab initio methods. In contrast, both 3D Class and 3D Class abinit exhibit a"}, {"title": "6 Conclusion and Future Directions", "content": "CryoBench presents: 1) five synthetic datasets containing conformational and compositional heterogeneity; 2) comprehensive analyses of ten existing state-of-the-art tools across these datasets; and 3) new quantitative metrics and qualitative visualizations to compare these baselines. Our metrics assess representation learning, reconstruction quality, and the end-to-end heterogeneous reconstruction task. Overall, we find that quantification of the reconstruction performance aligns well with qualitative observations.\nIn addition to simple datasets that provide interpretable results for development and validation, we propose challenging datasets that push the frontiers of heterogeneous cryo-EM reconstruction. We anticipate that these datasets and metrics could inspire the exploration of new tasks for methods development, both in cryo-EM and within related areas of computer vision and computational imaging. These tasks may include generalization beyond training dataset distributions, high-resolution neural rendering, and the incorporation of biophysical priors into models. Our datasets are designed such that methods geared towards these challenges will also address key frontiers in cryo-EM and structural biology.\nIn future work, we aim to explore several limitations of the current benchmark. For example, we could use more complex or realistic noise statistics in image formation or simulate the joint presence of compositional and conformational heterogeneity. Through the active use of these datasets by the community, we anticipate that custom metrics designed for each type of heterogeneity will be fruitful, such as analyses of free energy landscapes and atomic-level motions in the case of MD data. Lastly, while the presented synthetic datasets provide a challenging setting for methods development, future versions of the benchmark could include non-structural sources of heterogeneity found in real cryo-EM datasets, such as junk particles and non-uniform pose distributions. We anticipate that these developments will facilitate the application of novel methods towards biological discovery on real data."}, {"title": "7 Data and Software Availability", "content": "CryoBench datasets and tools are available at https://cryobench.cs.princeton.edu/."}, {"title": "7.1 Data Availability", "content": "CryoBench datasets are deposited to Zenodo with the following DOIs:\n\u2022 Conf-het: https://doi.org/10.5281/zenodo.11629428\n\u2022 Comp-het: https://doi.org/10.5281/zenodo.12528292\n\u2022 MD: https://doi.org/10.5281/zenodo.12528784\nWe include the downsampled images (\\(D = 128\\)) analyzed in this study (\\(D = 256\\) for Spike-MD) in .mrcs, .txt, and .star file formats, along with CTFs and pose data in Python pickle files. We also include the consensus volume (needed for some methods) and the mask used for FSC computation. Full-resolution images (\\(D = 256, 384\\)) and ground truth PDB files and volumes will be deposited to BioImage Archive [51]. We provide the datasets under the Creative Commons Attribution 4.0 International license."}, {"title": "7.2 Software Availability", "content": "Scripts for simulating cryo-EM images and computing metrics are available at https://github.com/ml-struct-bio/CryoBench."}, {"title": "A Dataset Design", "content": null}, {"title": "A.1 Generating IgG-1D", "content": "Starting from an atomic model of the human immunoglobulin G (IgG) antibody (PDB: 1HZH), conformational heterogeneity is produced by rotating a dihedral angle connecting one of the fragment antibody (Fab) domains (Fig. 2a), simulating a simple one-dimensional continuous circular motion. Specifically, we rotate the backbone \u03c6 angle of residue 230 in the heavy chain H. We sample 100 atomic models at 3.6 degree intervals to approximate a continuous 360 degree dihedral rotation. For each atomic model, the molmap command in ChimeraX [52] was used to generate the corresponding density volume at a resolution of 3 \u00c5 with a bounding box of dimension D = 256 pixels and a pixel size of 1.5 \u00c5. Poses in Eq. 1 were uniformly sampled from \\(R \\in SO(3)\\) and t was sampled uniformly from [20, 20]^2 pixels. For the CTF, the accelerating voltage was set at 300 kV, spherical aberration at 2.7 mm, and amplitude contrast at 0.1. Defocus parameters were sampled randomly without replacement from EMPIAR-11247 [53]. Noise was added at a signal-to-noise (SNR) ratio of 0.01. See Appendix A.6 for a definition of the SNR. We simulate 1,000 images for each conformation to produce a dataset of 100k images. The dataset is then downsampled to D = 128 by Fourier cropping. We use the same projection images but increase the amount of added noise to SNR 0.005 and SNR 0.001 for IgG-1D-noisier and IgG-1D-noisiest, respectively."}, {"title": "A.2 Generating IgG-RL", "content": "For IgG-RL, we identified a sequence of 5 residues (D232, K235, T236, H237, T238) from 1HZH PDB as the linker and generated 100 random realizations of its structure by sampling the backbone dihedral angles according to the Ramachadran distributions of disordered peptides from Towse et al. [42], using rejection sampling to eliminate structures with steric clashes. For each atomic model, the molmap command in ChimeraX [52] was used to generate the corresponding density volume at a resolution of 3 \u00c5 with a bounding box of dimension D = 256 pixels and a pixel size of 1.5 \u00c5. Poses in Eq. 1 were uniformly sampled from \\(R \\in SO(3)\\) and t was sampled uniformly from [20, 20]^2 pixels. For the CTF, the accelerating voltage was set at 300 kV, spherical aberration at 2.7 mm, and amplitude contrast at 0.1. Defocus parameters were sampled randomly without replacement from EMPIAR-11247 [53]. Noise was added at a signal-to-noise (SNR) ratio of 0.01. We simulate 1,000 images for each conformation to produce a dataset of 100k images. The dataset is then downsampled to D = 128 by Fourier cropping."}, {"title": "A.3 Generating Spike-MD", "content": "We sourced the individual MD structures from the enhanced sampling molecular dynamics simulations performed in [43]. Using the free-energy landscape calculated with these simulations for the wild-type Spike, we sampled molecular structures assuming a Boltzmann distribution with T = 6000 K. By using an artificially high temperature, we were able to increase the number of sampled conformations- particularly in regions with a high free energy barrier connecting the receptor binding domain (RBD) open and closed states. This process resulted in 46,789 unique conformations. For each atomic model, the molmap command in ChimeraX [52] was used to generate the corresponding density volume at a resolution of 3 \u00c5 with a bounding box of dimension D = 256 pixels and a pixel size of 1.5 \u00c5. Poses in Eq. 1 were uniformly sampled from \\(R \\in SO(3)\\) and t was sampled uniformly from [20, 20]^2 pixels. For the CTF, the accelerating voltage was set at 300 kV, spherical aberration at 2.7 mm, and amplitude contrast at 0.1. Defocus parameters were sampled randomly without replacement from Walls et al. [54]. Noise was added at a signal-to-noise (SNR) ratio of 0.1. We simulated 100,000 images in total with at least 1 image per sampled conformation, resulting in approximately two images for each unique conformation."}, {"title": "A.4 Generating Ribosembly", "content": "For Ribosembly, we used the 16 atomic models of the bacterial ribosome assembly states from Qin et al. [44]. We first centered all atomic models using the move in ChimeraX. Subsequently, the models were aligned to the last state (PDB: 8C8X) using matchmaker in ChimeraX. For each atomic model, the molmap command in ChimeraX [52] was used to generate the corresponding density volume at a resolution of 3 \u00c5 with a bounding box of dimension D = 256 pixels and a pixel size of 1.5 \u00c5. Poses in Eq. 1 were uniformly sampled from \\(R \\in SO(3)\\) and t was sampled uniformly from [20, 20]^2 pixels. For the CTF, the accelerating voltage was set at 300 kV, spherical aberration at 2.7 mm, and amplitude contrast at 0.1. Defocus parameters were sampled randomly without replacement from EMPIAR-10076 [26]. Noise was added at a signal-to-noise (SNR) ratio of 0.01. We simulate images with a non-uniform distribution following Qin et al. [44] listed below, totaling 335,240 particle images. The dataset is then downsampled to D = 128 by Fourier cropping."}, {"title": "A.5 Generating Tomotwin-100", "content": "We created Tomotwin-100 from the curated set of cellular complexes in Rice et al. [45]. Here we use 100 out of the original set of 120 after excluding the 15 smallest and 5 largest complexes by molecular weight. We centered all atomic models using the move in ChimeraX. Then, the molmap command in ChimeraX [52] was used to generate the corresponding volume map. For each atomic model, the molmap command in ChimeraX [52] was used to generate the corresponding density volume at a resolution of 3 \u00c5 with a bounding box of dimension D = 384 pixels and a pixel size of 1.5 \u00c5. Poses in Eq. 1 were uniformly sampled from \\(R \\in SO(3)\\) and t was sampled uniformly from [20, 20]^2 pixels. For the CTF, the accelerating voltage was set at 300 kV, spherical aberration at 2.7 mm, and amplitude contrast at 0.1. Defocus parameters were sampled randomly without replacement from EMPIAR-11247 [53]. Noise was added at a signal-to-noise (SNR) ratio of 0.01."}, {"title": "A.6 Signal to Noise Ratio (SNR)", "content": "We define SNR as the ratio between the variance of the signal and the variance of the noise. We calculate the variance of the signal over all CTF-applied projection images for a given dataset where we define the entire D \u00d7 D image as the signal. We apply Gaussian white noise to the desired SNR level based on the computed variance. As SNR values can be arbitrarily set based on the definition of the signal, we additionally visualize example cryo-EM images for all datasets in Figure S2."}, {"title": "B Experimental Settings", "content": null}, {"title": "B.1 Mask Generation", "content": "Certain reconstruction methods take as input a volume mask defining the region of interest. For mask generation, we first aggregated all ground truth volumes using the volume add in ChimeraX. Subsequently, we then applied the Volume Tools in CryoSPARC. Specifically, for IgG-1D, IgG-RL, and Ribosembly, the Dilation radius (pix) and Soft padding width (pix) were set at 8 and 5, respectively. For Tomotwin-100, these parameters were adjusted to a Dilation radius (pix) of 5 and a Soft padding width (pix) of 3. For Spike-MD, we take the union of all binarized volumes and use the cryoDRGN gen_mask command with a dilation of 25 \u00c5 and soft cosine edge of 15 \u00c5. Masks for each dataset are shown in Figure S3b."}, {"title": "B.2 CryoDRGN, CryoDRGN2", "content": "CryoDRGN [7] is a deep generative network-based method where the input images are encoded in the (conformational) latent space and the latent coordinates are decoded into 3D volumes in Fourier domain via an implicit neural representation [6]. In its second version cryoDRGN2 [48], better ab initio capabilities were improved with changes to the hierarchical pose search (HPS) algorithm for image pose inference. In our benchmark, we use cryoDRGN for fixed, and cryoDRGN2 for ab initio purposes.\nWe trained cryoDRGN and cryoDRGN2 using the official PyTorch implementation1, version 3.0.0b. We used the default settings with the z-dimension set to 8. For the total number of training epochs, 20 and 30 were used for cryoDRGN and cryoDRGN2, respectively. For Ribosembly, we trained cryoDRGN using 50 epochs. We used one V100 GPU for training."}, {"title": "B.3 DRGN-AI, DRGN-AI-fixed", "content": "DRGN-AI [47] is a deep generative network-based method, inspired by cryoDRGN. DRGN-AI uses both HPS and stochastic gradient descent in pose estimation, while utilizing a differential lookup table instead of an encoder network to encode the pose and conformational latent variable information. We denote the fixed pose mode of operation with \u201cDRGN-AI-fixed\u201d and ab initio with \u201cDRGN-AI.\u201d\nWe trained DRGN-AI and DRGN-AI-fixed using the official PyTorch implementation2, version 0.2.2b0. We used the default settings with the z-dimension set to 4 and the total number of training epochs set to 100. We used one A100 GPU for training."}, {"title": "B.4 Opus-DSD", "content": "Opus-DSD [18] is also a deep generative network-based method, built upon cryoDRGN. The network architecture is similar to cryoDRGN except that it uses a 3D Convolutional Neural Network (CNN) and priors for the latent conformational variable.\nWe trained Opus-DSD using the official PyTorch implementation3, commit ID 6bc7b86 in GitHub. We used the default settings with the z-dimension set to 12, valfrac of 0.25, downfrac of 0.75, and lamb of 1.0, bfactor of 4.0, and templateres of 192 as recommended on the official GitHub. For the Spike-MD dataset, we use a downfrac of 1.00 and templateres of 256. The total number of training epochs was set to 20. The volumes reconstructed by Opus-DSD are smaller than the original image dimensions. Consequently, to compute the volume comparison metric (Per-Conformation FSC), we zero-padded the volumes to match the original image dimension. Since the volumes are also misaligned, we aligned them as we did for ab initio methods to compute the FSC. We used four A100 GPUs for training."}, {"title": "B.5 RECOVAR", "content": "RECOVAR [19] is a white-box approach that utilizes principal component analysis (PCA), which is computed through regularized covariance estimation, and an adaptive spatial and fourier domain kernel regression for volume reconstruction.\nWe trained RECOVAR using the official JAX implementation4, commit ID 1977aa9 in GitHub. We used the default settings with the z-dimension set to 10 and provided the mask described in Section B.1 as an input. We used one V100 GPU for training."}, {"title": "B.6 CryoSPARC", "content": "We used cryoSPARC5 version 4.4.0 to train 3DFlex, 3DVA, 3D Classification (fixed, ab initio). Some methods in cryoSPARC require a consensus volume, in addition to the masks described in Section B.1. We created the consensus volume for each dataset by backprojecting all images of a given dataset in cryoDRGN [7", "9": "is a deep learning-based method for heterogeneous reconstruction designed to model conformational heterogeneity. 3DFlex models a single canonical 3D volume represented by a tetrahedral mesh and its deformation through training a flow field as a function of conformational latent space coordinates.\nTo train 3DFlex, the particle stack was normalized such that the mean of each image was 0 and the variance was 1. In the mesh preparation phase (Flex Mesh Prep job), we provided the consensus volume and mask as inputs. We adjusted the Min. rigidity weight to 1. For training (3D Flex Training job), we use all default settings. The latent dimension is 2.\nSpike-MD required additional modifications to produce reasonable results. A 3DFlex model was trained with consensus poses and volume from ab initio reconstruction in cryoSPARC, and the following hyperparameters. The number of latent dimensions was 3, the MLP neural network which models the deformations of the consensus volume had 256 hidden layers, and we trained the model for 32 epochs beyond the standard training time. All other parameters were left to their default values.\n3DVA. 3DVA ["}]}