{"title": "Integrating Physics and Data-Driven Approaches: An Explainable and Uncertainty-Aware Hybrid Model for Wind Turbine Power Prediction", "authors": ["Alfonso Gij\u00f3n", "Simone Eiraudo", "Antonio Manjavacasa", "Daniele Salvatore Schiera", "Miguel Molina-Solana", "Juan G\u00f3mez-Romero"], "abstract": "The rapid growth of the wind energy sector underscores the urgent need to optimize turbine operations and ensure effective maintenance through early fault detection systems. While traditional empirical and physics-based models offer approximate predictions of power generation based on wind speed, they often fail to capture the complex, non-linear relationships between other input variables and the resulting power output. Data-driven machine learning methods present a promising avenue for improving wind turbine modeling by leveraging large datasets, enhancing prediction accuracy but often at the cost of interpretability. In this study, we propose a hybrid semi-parametric model that combines the strengths of both approaches, applied to a dataset from a wind farm with four turbines. The model integrates a physics-inspired submodel, providing a reasonable approximation of power generation, with a non-parametric submodel that predicts the residuals. This non-parametric submodel is trained on a broader range of variables to account for phenomena not captured by the physics-based component. The hybrid model achieves a 37% improvement in prediction accuracy over the physics-based model. To enhance interpretability, SHAP values are used to analyze the influence of input features on the residual submodel's output. Additionally, prediction uncertainties are quantified using a conformalized quantile regression method. The combination of these techniques, alongside the physics grounding of the parametric submodel, provides a flexible, accurate, and reliable framework. Ultimately, this study opens the door for evaluating the impact of unmodeled variables on wind turbine power generation, offering a basis for potential optimization.", "sections": [{"title": "1. Introduction", "content": "The increasing adoption of renewable energy sources is crucial for addressing climate change and promoting a sustainable energy future [1]. Simultaneously, rapid advancements in sensor and storage technologies have enabled the collection of large volumes of data complemented by the emergence of flexible and powerful data-driven and machine learning techniques [2, 3]. Within this context, the development of accurate and robust wind turbine (WT) models is imperative for optimizing operations [4] and enabling automated fault diagnosis [5].\nPower prediction in WTs as a function of the weather conditions and the turbine state is crucial for wind energy management and power forecasting [6]. Beyond its role in managing generated energy and integrating it into the electricity grid [7], power prediction, when combined with data analysis and monitoring techniques, aids in detecting and diagnosing powertrain component failures [8]. By comparing predicted power with real-time data, deviations and anomalies can be identified, potentially indicating component issues, thus enabling early intervention and effective fault management. Additionally, power prediction is vital for optimal pitch angle control and overall WT performance, as it provides real-time data on the power output. This information can be leveraged to adjust blade angles, maximize power generation, protect the WT, and ensure efficient system control [9].\nThe lack of precise and efficient physics-based models for forecasting power production in utility-scale wind farms has led to the adoption of data-driven approaches [10]. While machine learning approaches are traditionally regarded as black-box models, the development of novel architectures, such as physics-informed neural networks (PINNs), has enhanced their ability to model physical phenomena while ensuring accuracy and robustness [11]."}, {"title": "2. Related work and main contributions", "content": "Existing wind power prediction methods can generally be categorized into four types: physical methods, statistical methods, machine learning methods, and hybrid prediction methods [15].\nDetailed physical models leverage meteorological and geographical data to simulate the dynamic processes of wind [15], offering high accuracy and strong physical interpretability. However, their computational efficiency is limited, as they must account for complex fluid dynamics and atmospheric effects [16], making them impractical for large-scale data applications. In contrast, approximate empirical physical models, while useful for qualitative physical insights, often fail to accurately predict power production at utility-scale wind farms due to numerous simplifying assumptions and neglected physical phenomena [17]. Several empirical formulas have been proposed to model the power coefficient; however, no consensus has been achieved regarding a model that offers sufficient flexibility and robustness [18, 19]. Statistical methods, such as the simple moving average strategy, are commonly employed to forecast wind power using extensive historical data. However, the predictive performance of these models is constrained by their limited ability to capture nonlinear relationships [20]. Compared with physical methods, statistical methods are usually simpler and more suitable for small farms [21].\nData-driven machine learning models are extensively used for wind power forecasting due to their strong nonlinear fitting capabilities and self-learning abilities [22, 23, 24, 25, 26, 27]. The direct application of machine learning methods can yield favorable results in predicting the WT power curve and significantly contribute to turbine performance analysis. However, these methods often lack robustness and physical interpretability [28]. For effective real-system optimization, the predictive model must accurately replicate observed data while adhering to the physical constraints of the system, even for atypical configurations.\nFinally, hybrid methods combine physics-based with data-driven approaches to effectively address regression problems [29], having advantages such as a broader knowledge base, transparency in the modeling process, and cost-effective model development [12]. Multi-objective ensemble models have distinguished themselves among hybrid models by combining multiple data groups with different distributions and multiple learners to achieve superior predictive performance and generalization [30, 31]. However, there is still room for improvement through outlier correction, diversification of combination weights, or the use of residual data to refine prediction results and enhance model accuracy [32, 33].\nThe non-parametric, data-driven component of hybrid regression models has a significant limitation: it lacks inherent functional explainability, and is therefore not directly interpretable. Furthermore, the underlying functional relationships may remain unclear, meaning causality between explanatory and dependent variables cannot be guaranteed. Recent advancements in explainability and uncertainty quantification techniques have significantly improved the interpretability and reliability of predictions made by data-driven models [34, 14]. The application of these techniques to the WT power sector remains in its early stages and has been identified as a key research challenge in wind energy by the European Academy of Wind Energy (EAWE) [35]. Recent studies have explored Bayesian [36, 37] and Monte Carlo [38] methods to approximate uncertainty in power curve model estimation, while others have begun employing explainability techniques to develop robust and transparent data-driven models [39, 40, 41]. To the best of our knowledge, no existing work has simultaneously incorporated both considerations\u2014practices we deem essential for achieving trustworthy and robust power curve models.\nIn this work, we propose a hybrid model comprising a physics-based submodel for predicting the power generated by a dataset of four similar turbines and a data-driven, non-parametric submodel to learn the residuals between the physics-based submodel's output and the observed data. This approach aims to capture unmodeled physical phenomena and variations in the data that the physics-based submodel alone cannot fully account for. It is particularly advantageous when certain inputs are not reliably represented in the data or when integrating domain knowledge through a physical reference input is beneficial. The main novelties and contributions of this paper can be summarized as follows:\n\u2022 A hybrid model is proposed for regression analysis of WT power generation as a function of weather conditions and internal turbine variables. This approach preserves the interpretability of the physics-based submodel while achieving high predictive accuracy.\n\u2022 The proposed physics-based model operates with minimal assumptions regarding the functional form, deriving the generated power as a function of wind kinetic energy modulated by the power coefficient. The power coefficient is constrained by the Betz limit and is modeled using a neural network. This methodology offers significant flexibility while enabling the estimation of the power coefficient profile, which serves to characterize the aerodynamic performance of the WT.\n\u2022 Prediction accuracy is improved by incorporating a non-parametric model that accounts for additional unmodeled input features to learn the residuals between the physics-based model's predictions and the observed data. An explainability analysis is conducted to evaluate the influence of input variables on the hybrid model's output. This analysis identifies the most significant features and provides insights into potential improvements for the physics-based model.\n\u2022 To evaluate the reliability of the hybrid model's predictions, a conformalized quantile regression method is employed for uncertainty quantification, enabling the calculation of coverage and mean length of the uncertainty intervals. This approach enhances confidence in the model, which, to the best of our knowledge, is the first hybrid model in the wind energy sector to integrate both explainability and uncertainty quantification analyses."}, {"title": "3. Methods", "content": "3.1. Additive semi-parametric hybrid model\nHybrid models integrate diverse sources of knowledge to create detailed representations. In this study, parametric physics-based and non-parametric data-driven submodels are combined to construct the regression function.\nOn the one hand, parametric models assume a specific distribution of the output variables in relation to the input variables, with this distribution being characterized by a finite set of parameters [42]. Selecting an appropriate function requires prior knowledge, taking into account the expected relationship between the input and output variables. In the engineering field, a suitable choice may involve the underlying physical law that governs the problem. Parametric physics-based models may offer lower accuracy compared to non-parametric models; however, they are more interpretable, allowing for the identification of characteristic coefficients and providing a deeper understanding of the relationship between the modeled variables. While still offering a reasonable approximation, the error in a parametric regression may include noise, outliers, deviations from the expected behavior, or unmodeled influences from other observable variables.\nOn the other hand, non-parametric models do not assume any specific form on the function used to calculate the dependent variables. Non-parametric models, such as neural networks, can effectively capture complex relationships among the considered variables. These models are particularly useful when the physical laws governing the system are unknown or too intricate, as they do not require domain-specific expertise to define the regression function. Additionally, they offer the flexibility to incorporate extra input variables into the regression task as needed. While they can achieve high accuracy when sufficient data are available, non-parametric models tend to be less interpretable and may encounter robustness issues when generalized to different conditions.\nIn real-world problems, typically, some aspects of the system can be described using a physical model, while other parts are more complex, and no effective parametric functions are available. The approximation provided by the physical model can be enhanced by modeling the residuals with a non-parametric model. In this paper, an additive semi-parametric model is proposed, to address the limitations of the two previously mentioned approaches:\n\\(\\hat{y} = f_{phys}(x) + f_{res}(\\tilde{x}).\\)\n(1)\nThe prediction consists of a physics-inspired part and a non-parametric part, the latter is specifically designed to predict the residuals of the physics-inspired output with respect to the global target. The physics-inspired sub-model is driven by input variables \\(x\\) that are readily interpretable, whereas the residual submodel can accommodate a broader set of input variables \\(\\tilde{x}\\). These additional variables include both those that are easily interpretable and those that are more difficult to integrate into physical equations. The training of the hybrid model is performed in two steps. First, the physics-inspired submodel is fitted using the global target \\(y\\) as the objective, providing a robust approximation of this quantity. Second, the residual submodel is trained to approximate \\(r=y - f_{phys}(x)\\), enhancing the prediction by incorporating corrections based on unknown physical factors and integrating variables contained in \\(\\tilde{x}\\) that more effectively describe the state of the system.\n3.2. Explainability and Uncertainty Quantification\nOnce the hybrid model is described, two approaches are proposed to enhance the interpretation and reliability of the predictions obtained: SHAP (SHapley Additive exPlanations) and uncertainty quantification.\nSHAP [43] is a game theory-based technique used for measuring the marginal contribution of different input features of a model to its output. Its application involves the calculation of SHAP values, which quantify the local contribution \\(\\phi_i\\) of each feature \\(i\\) to the output of the model \\(f\\), such that:\n\\(\\phi_i = \\sum_{S \\subset N-\\lbrace i \\rbrace} \\frac{\\vert S \\vert ! \\cdot (\\vert N \\vert - \\vert S \\vert - 1)!}{\\vert N \\vert !} [f(S \\cup \\lbrace i \\rbrace) - f(S)],\\)\n(2)\nwhere \\(N\\) is the total set of features, and \\(S\\) is any subset of features that does not include \\(i\\). Thus, \\(f(S \\cup \\lbrace i \\rbrace)\\) represents all the possible outputs of the model \\(f\\) when all the features are considered, while \\(f(S)\\) corresponds to the possible outputs of the model when the feature \\(i\\) is ignored.\nA relevant property of SHAP values is additivity, meaning that if a model can be decomposed into the sum of two submodels, the SHAP values can similarly be decomposed in an equivalent manner. SHAP also provides guarantees of consistency \u2014i.e., it is model-agnostic\u2014, as well as robustness in the presence of missing features. Once the SHAP values are computed, the prediction for an instance \\(j\\) can be reconstructed as the sum of the mean value of the predictive function over all instances, plus the sum of all the SHAP values:\n\\(f(x_j) = \\bar{f} + \\sum_{i\\in N} \\phi_i(x_j).\\)\n(3)\nFurthermore, we employ Conformal Prediction (CP) [44] to quantify the uncertainty of model outputs. In addition to predicted output values, CP provides confidence intervals (for regression tasks) or sets (for classification tasks) within which the true value will be contained, with at least a probability of \\(1 - \\alpha\\), where \\(\\alpha\\) determines the coverage.\nTo apply CP in regression tasks, we start with a pre-trained model and a calibration dataset. Using the predictions on the calibration set, we compute a nonconformity score, which quantifies the difference \\(\\vert \\hat{y} - y \\vert\\) between model predictions \\(\\hat{y}\\) and true values \\(y\\). Finally, we determine the \\(1 - \\alpha\\) percentile of these differences and generate an interval around the new prediction such that \\([\\hat{y} - \\epsilon, \\hat{y} + \\epsilon]\\), where \\(\\epsilon\\) is the percentile considered.\nIn our case, we use the Conformalized Quantile Regression (CQR) variant proposed in [45], which is available in the MAPIE library [46]. This approach extends standard CP by using specific models \u2014or biased versions of the base model\u2014 to determine interval bounds. For a given value of \\(\\alpha\\), we consider: (i) the base model, (ii) a model that predicts the lower bound of the intervals (with \\(\\alpha/2\\)), and (iii) a model that predicts the upper bound of the intervals (with \\(1-\\alpha/2\\)). To obtain the interval models, we use the pinball loss function, which biases the base model predictions towards upper and lower bounds."}, {"title": "4. Case study and experimental setup", "content": "4.1. Wind turbines physical background\nAlthough challenging, the modeling of the low-scale aerodynamic behavior of WTs can be accomplished using physics-based fluid dynamics methodologies. However, the predictive capacity of these models for the power generation of utility-scale wind farms is limited [17]. Alternatively, partial physical insights can be obtained through well-established equations that relate certain large-scale variables. The power extracted by a WT from the kinetic energy of the incoming wind is expressed as:\n\\(P = \\frac{1}{2} C_p \\rho A v^3,\\)\n(4)\nwhere \\(C_p\\) is the power coefficient, \\(\\rho\\) is the air density, \\(A\\) is the area swept by the blades of the WT, and \\(v\\) is the wind velocity.\nThe power generated by a WT is closely related to the power coefficient \\(C_p\\), a dimensionless parameter influenced by the turbine's intrinsic characteristics, such as its size, geometry, and aerodynamic properties, as well as operational conditions defined by variables like wind speed and pitch angle. A typical objective is to optimize \\(C_p\\) to achieve maximum efficiency in converting wind kinetic energy into electrical energy, constrained by the theoretical upper limit of 0.5926, known as the Betz limit [47]. In regions with variable wind speeds, optimal power output is achieved by precisely adjusting the pitch angle, \\(\\theta\\), which represents the angle between the lateral axis of the blades and the direction of the relative wind. However, the complexity of pitch control arises from the nonlinear dynamics inherent in these systems, as well as from external disturbances.\nThe power coefficient's functional form is not dictated by physical laws and is often approximated using empirical parametric functions. To improve flexibility, we employ more adaptable regressors, such as neural networks. The output power is then computed using Equation 4 and depicted in Figure 3, as further detailed in subsection 4.3.\n4.2. Data description and preprocessing\nReal data were collected from two periods, 2013\u20132016 and 2017-2020, for four MM82 turbines manufactured by Senvion at the \u2018La Haute Borne' wind farm [48, 49], sourced from ENGIE Renewables. The original dataset comprises 10-minute averages of over 35 features related to turbine performance and weather conditions. \nThe wind farm under study consists of four turbines with similar data distributions. Furthermore, the turbines share an identical power curve, shown in Figure 2. Consequently, a single model is proposed to represent all the data without distinguishing between individual turbines.\nBefore preprocessing, the dataset comprised approximately 1 million instances. Initially, non-physical data points, such as those with a power coefficient exceeding the theoretical Betz limit (\\(C_p > 0.5926\\)), were removed. Since the calculation of \\(C_p\\) from direct measurements is sensitive to error propagation, only physically valid values were retained. Anomalous data were then identified by comparing the measured power with an estimate obtained from the power curve using an iterative median technique. Data points deviating from the median by more than three standard deviations (3\\(\\sigma\\)) were classified as anomalies and excluded. Furthermore, a low-velocity power cutoff was applied to eliminate noisy data at low wind speeds, where the relative error has a more pronounced impact. As a result of these steps, the dataset was reduced from 1 million instances to approximately 7 \u00d7 105, representing 70% of the original data.\n4.3. Power hybrid model\nFor our purposes, the power prediction consists of two primary components: a physics-inspired part, based on Equation 4, and a non-parametric part designed to predict the residuals of the physics-inspired output relative to the target variable, as shown in Figure 3.\n\\(P = P_{phys}(x) + P_{res}(\\tilde{x})\\)\n(5)\nThe physics-inspired submodel \\(P_{phys}\\) is driven by input variables directly related to the kinetic-electrical energy conversion process, such us wind velocity, pitch angle and rotor angular velocity. Additionally, the residual submodel \\(P_{res}\\) uses a broader set of input variables extracted from the dataset, difficult to interpret and incorporate into physical equations, including outdoor temperature, nacelle temperature, rotor temperature, vane angle and wind direction:\n\\(x = (v, \\theta, \\omega),\\)\n(6)\n\\(\\tilde{x} = (v, \\theta, \\omega, T_{out}, T_n, T_r, a_v, a_w).\\)\n(7)\nIt should be noted that we decided to include the physically modeled variables (\\(v, \\theta, \\omega\\)) in the residual non-parametric model to correct potential deviations of the data from Equation 4, which is an approximation derived from physical laws. The physical submodel, in turn, incorporates an undetermined element: the power coefficient, whose functional form is not defined by physical laws. To address this, we employ a neural network for the regression of \\(C_p\\), with a sigmoid output layer to constrain the predicted power coefficient to values within the range set by the Betz limit.\nAlthough the variables (v, \\(\\theta\\), \\(\\omega\\)) are inputs to both the physics-based and residual submodels, for practical purposes of conducting the explainability analysis of the hybrid model, they are treated as distinct variables within the two submodels. This allows the physics-based and residual components to be reconstructed from the SHAP values of the hybrid model as:\n\\(P_{phys} \\approx \\bar{P}_{phys} + \\sum_{i=1}^{3} \\phi_i,\\)\n(8)\n\\(P_{res} \\approx \\bar{P}_{res} + \\sum_{i=1}^{8} \\tilde{\\phi}_i,\\)\n(9)\nwhere \\(\\phi_i\\) and \\(\\tilde{\\phi}_i\\) are the SHAP values of features \\(x\\) and \\(\\tilde{x}\\), respectively.\n4.4. Computational details\nOur experimental setup is based on artificial neural network models, trained using the Tensorflow library and hyperparameters optimized with the hyperband algorithm from the Keras Tuner library. All the calculations were carried out on a computer equipped with an 11th Gen Intel Core i7-11800H processor, 16 GB RAM memory and NVIDIA GeForce RTX 3060 graphics card.\nBefore training, a grid search was conducted to optimize hyperparameters, including the activation function, learning rate, number of hidden layers, and neurons per layer. The network was then trained using the optimal hyperparameters, and its performance was evaluated based on the epoch with the minimum loss value. Both submodels were trained using a batch size of 128, with the mean absolute error as the loss function. The dataset was randomly split into 80% for training and 20% for testing. An adaptive learning rate strategy was employed to reduce the learning rate when the loss function stabilized, with training continuing until the loss plateaued, typically after approximately 150 epochs.\nThe code used for data preprocessing, building, training, and evaluating the models is available at the following Github repository:\nhttps://github.com/alfonsogijon/WindTurbines_hybrid."}, {"title": "5. Results and discussion", "content": "5.1. Regression analysis\nBefore initiating the model fitting process, a cross-correlation analysis was conducted to evaluate the influence of input variables on the output. As anticipated, variables utilized in the physical model, such as wind speed and rotor speed, exhibited strong correlations with the output, namely the power generated by the turbine. This finding reinforces the validity of the physical model using data-driven evidence. By setting a threshold of 0.9 for the correlation coefficient, the most critical variables representing the system's state were identified, while less relevant and redundant variables were excluded. This process reduced the original dataset from 35 variables to 9, as detailed in Table 1. It was observed that including additional variables did not improve accuracy significantly, while hindering the interpretation of the models.\nUsing Equation 4, a physics-based submodel \\(P_{phys}\\) was trained to predict the power output. The trained model was then used to compute prediction errors, which were subsequently utilized to train the non-parametric residual submodel \\(P_{res}\\). The hybrid model was constructed by adding the outputs of both submodels.  presents the performance metrics of the proposed models on the test dataset, including a purely data-driven model that utilizes the same set of eight input features employed by the hybrid model. As can be observed, the hybrid model outperforms the physics-based model, achieving a 28% reduction in Mean Absolute Error (MAE) and a 37% reduction in Mean Absolute Percentage Error (MAPE). In turn, the performance of the resulting hybrid model essentially matches that of the reference data-based black-box approach. In this manner, the hybrid model effectively combines the accuracy of data-driven methods with the interpretability of physics-based approaches, as will be demonstrated in the following.\nThe physics-based model provides a reliable approximation of the data, having a MAE of 16 kW and a MAPE of 3.7%, as indicated by the metrics in . Additionally, it enables the identification and visualization of key parameters, such as the power coefficient \\(C_p\\) of the WT. This coefficient can be expressed as a function of the tip-speed ratio, \\(\\lambda = \\omega R/v\\), where R represents the rotor radius, to derive a profile that characterizes the aerodynamic behavior of the WT.  illustrates the \\(C_p\\) curve for different pitch angles, showing good agreement between the data and predictions, with the maximum \\(C_p\\) shifting to the left as the pitch angle increases.\nThe residual component of the hybrid model effectively captures the error between the target power and the prediction made by the physics-based submodel, as shown in Figure 5. The panel (a) of the figure indicates that the absolute residuals are higher in the mid to high power range, suggesting that this region is not perfectly modeled by the physics submodel. Both the physics and residual components of the hybrid model are displayed in the scatter plot of Figure 6, alongside the test data. It is evident that the physics-based submodel (in orange) closely matches the power curve of the data (in blue), while the residuals are more pronounced at intermediate wind velocities, between 7.5 and 12.5 m/s.\n5.2. Explainability and Uncertainty Quantification\nTo further enhance the interpretation and reliability of the hybrid model's predictions, we apply explainability and uncertainty quantification techniques."}, {"title": "6. Conclusions", "content": "In this study, we design and validate a hybrid semi-parametric model comprising a physics-inspired submodel, \\(P_{phys}\\) and a non-parametric submodel for predicting the residual power of the physical term, denoted as \\(P_{res}\\). The proposed model, trained on real historical data from four turbines at 'La Haute Borne' wind farm, demonstrates an improvement of a 37% in predicting generated power.\nThe physics-inspired submodel offers inherent interpretability of the power coefficient, as it is built upon a physical equation that captures the relationships among the system's most critical variables. In contrast, the non-parametric residual submodel, which accounts for the unexplained components of the system, requires an additional analysis to interpret its behavior, which is accomplished using the SHAP explainability technique. Moreover, the conformalized quantile regression method provides conformal predictions along with associated confidence intervals, consistent with the data and previous results. The integration of these components results in a flexible, accurate and reliable framework.\nOnce deployed, this hybrid model can serve as a robust regression-based anomaly detection tool, quantifying the probability of new data being classified as normal or anomalous. Furthermore, all models presented in this study are fully differentiable, making them suitable for developing optimal operation controllers. These controllers have the potential to further enhance power generation efficiency across varying wind speed conditions.\nUsing SHAP values, the model also provides insights into the relative importance of input features and their influence on the predicted power output. The analysis indicates that incorporating outdoor temperature into future, more advanced physical models could enhance prediction accuracy. Additionally, it highlights potential adjustments in the relationships between power and wind or rotor speed. Future research should focus on a more in-depth analysis of correlations and the application of causal analysis tools, which would be valuable for the development of improved physics-based causal models."}]}