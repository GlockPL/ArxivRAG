{"title": "PATCH: a deep learning method to assess heterogeneity of artistic practice in historical paintings", "authors": ["Andrew Van Horn", "Lauryn Smith", "Mahamad Mahmoud", "Michael McMaster", "Clara Pinchbeck", "Ina Martin", "Andrew Lininger", "Anthony Ingrisano", "Adam Lowe", "Carlos Bayod", "Elizabeth Bolman", "Kenneth Singer", "Michael Hinczewski"], "abstract": "The history of art has seen significant shifts in the manner in which artworks are created, driven by changes in technology and the art market. Thus, understanding creative processes is a central question in technical art history. In the Renaissance and Early Modern period, paintings were largely produced by master painters who directed workshops of apprentices and others who often contributed to the work produced. The masters varied significantly in both their artistic and managerial styles, meaning different combinations of artists and implements might be seen both between masters and within workshops or even individual canvases. Information about the way different workshops were managed and the processes by which artworks were created remains elusive, however. Machine learning methods have potential to unearth new information about artists' creative processes by extending the analysis of brushwork to a microscopic scale. Analysis of paintings created in a workshop setting, however, presents a challenge in that documentation of the artists and materials involved in individual works is sparse, meaning external examples are not available to train networks to recognize their contributions. Here we present a novel machine learning approach we call pairwise assignment training for classifying heterogeneity (PATCH) that is capable of identifying individual artistic practice regimes with no external training data, or \u201cground truth.\u201d The method achieves unsupervised results by supervised means, and outperforms both simple statistical procedures and unsupervised machine learning methods. We apply this method to two historical paintings by the Spanish Renaissance master, El Greco: The Baptism of Christ and Christ on the Cross with Landscape, and our findings regarding the former potentially challenge previous work that has assigned the painting to workshop members. Further, the results of our analyses create a measure of heterogeneity of artistic practice that can be used to characterize artworks across time and space.", "sections": [{"title": "INTRODUCTION", "content": "There are many ways to create a painting. The process can be collaborative or solitary, and there is no end to the styles, tools, materials and techniques that can be implemented. The evolution of what we call artistic practice-the technical, stylistic, material, and even physiological aspects of an artist's creative process\u2014over time and its variation between artists remains a key element of technical art history scholarship. For example, in the last two centuries, Western painters, aided (and in many ways, enabled) by concomitant changes in the tools of the trade such as the invention of the paint tube\u00b9, have often chosen more solitary practice in the studio or even outdoors. From the late Middle Ages through the Early Modern period, on the other hand, painting was typically done in a bustling workshop\u00b2. A master painter would establish a workshop and assemble a group of apprentices, journeymen and specialist painters and even collaborate with associates to help fulfill commissions and create smaller works to support the enterprise between larger contracts.\nWorkshop practice adds a second layer of complexity to artistic practice. Master painters varied considerably in their managerial styles. Some performed much of the work themselves, while others dictated the composition but left many elements to the hands of workshop members (e.g., van Dyck\u00b3). Still others involved apprentices in the conceptualization of a piece4. Often, there was a hierarchy, with young apprentices typically assigned more mundane tasks such as the mixing of paints and the construction of canvases and more senior workshop members directed to paint portions of larger works in the master's style5.\nBecause workshops varied so widely in their organization and management yet produced works with cohesive styles, deeper understanding of variation in artistic practice can shed light on workshop practice and vice versa. Research into these key aspects of Renaissance and Early Modern art production is hindered by a lack of surviving textual sources regarding the structure, size, and membership of individual workshops as well as their day-to-day operation and the variation in artistic practices. While scholars have been able to reconstruct individual artists' workshops through a variety of methods, our collective understanding of the inner workings of workshops is still fragmentary. Artistic practice varies widely, encompassing materials, methods, styles, and individual contributions. Understanding who interacted with individual paintings and how they did so-discerning the artists at work in a painting, the interplay of their individual \u201chands,\u201d and the interaction of the artist's hand and eye with paint and brush-is an important open question in art history. Answering these questions requires new methods of analysis.\nMachine learning has recently emerged as a promising complement to traditional art historical analyses in applications including preservation, conservation and the detection of forgeries x9\u201312 as well as in fighting illegal trafficking in antiquities13. Much work involving style is focused on broad classification of works14,15, such as the use of a neural network to arrange works of the Western canon in the correct chronological order16. Recently published work by some of the authors of the present study demonstrated the efficacy of ML for attribution of paintings by analyzing high-resolution topographic images of the surface texture of oil paintings by known authors (student painters) in a controlled experimental setting. The topographic images, created using optical profilometry, captured variations in the height of the paint with"}, {"title": "STUDY 1 - METHOD DEVELOPMENT", "content": "The PATCH method consists of two phases. The first phase, pairwise assignment training, identifies pairs of paintings or pairs of regions of a single painting that are the \u201csame,\u201d that is, created by the same artist under the same conditions. The second phase, community finding, creates post hoc classes based on these pairings.\nThe first phase was developed on a set of paintings by known artists. A group of nine artists each individually painted three paintings, all using the same tools, materials, and subject (a photograph of lilies). The materials used for the paintings were described previously17. While the artists were instructed to realistically depict the subject, choices of style and technique (including the use of brushes and alteration of paint viscosity) were left up to the artists. One artist was only able to produce two paintings, and one painting was removed from the sample due to the optical profilometry data being corrupted, for a total of 25 paintings. Topographical information for each painting was recorded using high resolution spectral confocal optical profilometry with a spatial resolution of 50 microns, and a height repeatability of 200 nm. The resulting data were processed to remove any large scale warping of the canvas by subtracting a mean-filtered version of the height map (with filter radius of 0.5 cm)17.\nThe network architecture chosen was VGG-16, implemented in TensorFlow and pretrained on the ImageNet dataset. Given the computational complexity of the training\u2014the combinatorics of many region-to-region comparisons, repeated over many folds, described in detail below- the relatively light-weight but accurate VGG-16 architecture was ideal for the PATCH approach. Output from VGG-16 was pooled and flattened and passed through two dense layers with dropout rates of 0.25. The learning rate was set to 0.0001 and the batch size was set to 32 patches. In order to measure the ability of the network to learn to distinguish between two paintings or regions of a painting, we ran 26 training folds. Each fold comprised the following steps: 1 cm\u00b2 patches from each painting/region were randomly selected, with replacement. Sampling with replacement creates a bootstrapping effect that drives down the success rate of same-artist pairs and drives up the success rate for different-artist pairs. In each fold, the network was trained for 25 epochs with validation set size set to 30% of patches, and the maximum validation accuracy (percentage of validation patches correctly identified) was recorded. At the end of 26 folds, the distribution of the 26 maximum validation accuracies was compared to the distribution expected if the network were assigning patches at random."}, {"title": "STUDY 2 - APPLICATION TO EL GRECO'S THE BAPTISM", "content": "Two large sections of The Baptism were scanned in situ using the Factum Foundation's Lucida scanner. The Lucida scanner is a non-contact laser triangulation scanner with 100-micron lateral resolution and is capable of acquiring scans in situ over a large area by stitching together 48 cm square tiles. The height data was processed in the same way as in study 1, including correction for possible canvas warping.\nRegions of the topographic image of The Baptism were selected by hand in order to minimize variation in subject matter (e.g., faces, robes) within each region and to constrain region size to between 180 and 540cm\u00b2. The lower bound was chosen because the method had been developed using 180-patch paintings in study 1 and the upper bound was selected to ensure adequate representation of patches when regions of significantly different size were compared. We avoided selecting areas with significant cracking or damage, including the robes of the large angels to the left and right of God, and the red swatch held by the \"green angel\u201d in the bottom half of the painting. Each fold proceeded as described in study 1, above. Where regions were of different sizes, the sample size was set equal to the number of patches in the smaller region."}, {"title": "STUDY 3 - APPLICATION TO EL GRECO'S CHRIST ON THE CROSS", "content": "As in study 2, regions of the topographic image of Christ on the Cross were selected by hand in order to minimize variation in subject matter and to constrain region size. Areas with apparent cracking or damage, such as the background and trees on the lower left and the cross beam to the immediate left of Christ's face, were not included.\nPairwise comparison of all 24 regions (276 pairwise tests) yielded a network with 123 edges, which was reduced to 108 edges after pruning. The Louvain community finding algorithm21 at resolution 1.0 generated a partition with Q=0.231 that featured two communities. Two is the smallest possible number of communities for a non-fully connected graph, as Q compares inter-"}, {"title": "ANALYSIS OF PATCH-GENERATED COMMUNITIES", "content": "Further analysis of the community structure in the PATCH generated networks can provide additional insight into the community cohesiveness beyond the modularity index. We analyzed the average community degree, defined as the count of all edges between nodes within two communities. This is shown for all possible community pairs in Figure 5A and C, and within a single community (internal degree) or between nodes within and external to a given community (external degree) in Figure 5B and D. Each degree is normalized by the theoretical maximum degree based on the number of edges in the classification. The degree between community pairs and external degree can be taken as a measure of the PATCH intra-community similarity between specific communities and between a community and all others, respectively. Likewise, the internal degree can be taken as a measure of inter-community cohesiveness.\nIn The Baptism, all of the connections between the first three communities are significantly stronger than those involving the fourth community, with the average external degree over"}, {"title": "DISCUSSION", "content": "Ours is, to our knowledge, the first study to demonstrate this learning method and apply it both to paintings from a controlled experiment and to historical paintings by a well-known artist with a workshop. Among AI/ML-based methods designed to aid in the analysis of historical paintings, PATCH is notable in that it requires no external, ground truth data. Networks trained on known examples can accomplish tasks associated with workshop practice and authorship with exceptional accuracy. For example, Ugail and colleagues recently used transfer learning to authenticate paintings by the Renaissance master Raphael (Raffello Sanzio)34. By combining edge detection with typical feature extraction in a residual neural network, they were able to recognize works by Raphael with 98% accuracy. However, known examples of artists' work may not be available, as exemplified by the workshop context. Our method shows exceptional promise as a tool for ML analysis of complex historical works where known samples of work by the artists involved do not exist. Indeed, it may have extensive application in other image analysis tasks where there is little to no ground truth information available.\nFurther, the second phase of PATCH creates what we consider a measure of the HAP within a given dataset. Communities found within a dataset represent different artists, materials or both. The degree to which those communities are interconnected provides information about the possibility of shared authorship, materials, or other practices. A fully connected network with no distinct communities has Q = 0. As the number of communities increases and the interconnection between communities decreases, modularity increases toward 1 (a completely disconnected network has undefined modularity, but would effectively represent the maximum heterogeneity). The networks from our three studies provide empirical examples of lower and higher modularity networks. Christ on the Cross and The Baptism have Q values that cluster around 0.3, considered the threshold for evidence of structure, indicating low heterogeneity. The network for the experimental student paintings has much greater heterogeneity at Q=0.875 (see Figure S3). The maximum modularity depends on the number of edges in the network 35, but also on the number of communities in the network. A network with two fully connected and completely disjoint communities has Q = 0.5, for example. As such, network modularity can function as a measure of absolute observed heterogeneity (Figure 6).\nHAP informs interpretation of our analyses of Christ on the Cross and The Baptism. For the former, our analysis identifies two communities of regions, but with Q below the threshold generally accepted to indicate structure (0.231 vs 0.3). The regions in each community do cluster in space, however, which is worth considering. One community overlaps Christ's head and torso and surrounding areas. Conservation files generously provided by the Cleveland Museum of Art indicate that the figure of Christ (areas overlapped by the community in yellow in Figure 4) contains inpainting from previous conservation, which could create a distinguishable signal, though damage to the canvas is another, more likely culprit. Further mapping of damage and past conservation efforts will improve our understanding of this work. However, the results comport with the notion of Christ on the Cross as the work of a single artist with some variation introduced by artistic practice or possibly early conservation practice.\nAt first glance, the communities identified in our analysis of El Greco's Baptism appear to roughly correspond to the proposed attributions by previous authors discussed above. The community in yellow in Figure 3 overlaps much of the top of the painting, previously attributed to El Greco, while the community in blue overlaps John the Baptist and the figure in red, assigned to Jorge Manuel. We also find a combination of communities in the face and torso of Christ, which was attributed to both artists. A single, small and particularly unique community (in orange in figure 3) overlaps the landscape at the bottom of the painting and Christ's legs.\nOverall, however, the PATCH findings suggest a different story underlying the existing art historical interpretation. The partition of The Baptism has Q = 0.341, which is only slightly above the threshold for evidence of structure. Nearly a third of all edges in the network are interconnections between three of the four communities we have identified. The yellow and green groups have 49 intercommunity edges, blue and green 30, and blue and yellow 22. If the blue, green and yellow communities indeed represented three distinct artists working with the same or similar materials, we would expect the communities to be more insular and the modularity of the network to be substantially higher, similar to what we observed in our controlled test. Yet the modularity of The Baptism is much closer to that of Christ on the Cross (Q = 0.231), which appears to feature one artist. It is worth noting that, as shown in the analysis of student paintings, the CNN is particularly proficient at recognizing different-artist pairs and is more likely to incorrectly label a same-artist pair as different than the converse. Thus, the intercommunity edges in The Baptism network that survived our initial pruning are not liable to be spurious.\nThis suggests that some unifying factor connects these three communities. One possibility is a single artist working with different brushes. In El Greco's time, brushes were made with either bristles (which are coarse) or hair (which is fine and soft). Each served distinct technical purposes and often came in material-specific shapes36. Variation could arise from using the hair/bristles of different species in the same type of brush. Key sources were hog bristles (especially white hog) and \u201cminever\u201d (gray squirrel tail fur)37, though dog and mongoose often replaced minever due to its rarity36 and also something else38. Hog's bristles likewise may have been replaced with ox39. Such changes could affect paint application. For example, hog's bristles are naturally flagged (the ends of the hairs are split), allowing them to pick up more paint40. Bristle substitution could decrease brush capacity. Further experimentation to understand the effect of materials on PATCH analysis is needed.\nThe evidence could also indicate the work of one artist with changing style or technique over time. Interestingly, Biannuci and colleagues41 present evidence that El Greco suffered a series of ischemic events, one in the 1590s and a second in 1608 (the year the contract for the altarpieces for the Hospital Tavera was initiated), \u201cresulting in progressive disabilities with fluctuating course characterized by temporary improvements and worsening before his death.\u201d The regions that were previously identified as the work of different individual painters could conceivably represent variation in the master's individual style (however this may have arisen) over the course of his final years. Investigation of changes in style and technique and their effect on PATCH analysis will be an important direction for future research, as well.\nPATCH has the capability to make a substantial contribution to research as a complement to existing art historical methods. The accuracy of the method has been demonstrated in the method validation. Our analyses of Christ on the Cross and The Baptism show the true potential of PATCH by contributing important new information to art historical scholarship on the creation of objects in El Greco's workshop in Toledo.\nIn the analysis of The Baptism, the fact that the orange group, which overlaps a region known to have been altered after the delivery of the painting, is so disconnected from the remainder of the communities speaks to the method's capability of recognizing a unique contribution or substantial departure from the technique used in the rest of the painting. That the other three communities roughly correspond to art historical attributions suggests PATCH possesses a kind of semantic fidelity 42\u2013our method recognizes areas that appear different to the trained eye of an art historian. However, the connections between those areas revealed by PATCH call this attribution into question. Traditional attribution studies rely on the inspection of painters' unconscious tendencies and individual styles. For example, in attributing the painting of John the Baptist to El Greco's son, Wethey29 cites the \u201chardness\u201d of the details. Computer vision allows us to view the surface of a painting at a different scale. Previous analyses indicate that features as small as the diameter of a single paint brush bristle (length scales of 0.2-0.4 mm) may be integral to the network's identification of an artist17. By analyzing spatial correlations at this microscopic scale, the network may be revealing aspects of the physics of paint application and of the physiology of hand movements. PATCH adds micro-scale features to the macro (brushstrokes) and meta-scale (historical and material) data, allowing for a full-scale analysis and the discovery of heretofore unseen evidence of the processes by which paintings were created.\nFuture research with PATCH will focus on teasing apart the influences of materials and artists on the heterogeneity of artistic practice. Expansion of PATCH applications to include inter- painting comparisons and other art historical applications will be important as well. However, uses of PATCH are not limited to those contexts: it provides a general-purpose approach to clustering data that can be encoded in the form of image-like arrays, as occurs in a wide variety of applications across the social and natural sciences. Underlying the effectiveness of pairwise assignment training is the power of convolutional neural networks to find extremely subtle differences among such data points, and the counter-intuitively useful information gained when the network consistently fails to succeed in this task. As such, PATCH can be deployed where supervised learning is impossible (because the ground truth is unknown) and when alternative unsupervised approaches are ineffective."}, {"title": "Appendix A - Analytical derivation of the random assignment distri-bution", "content": "In order to determine whether the network has learned to correctly sort patches of both images, we generated the distribution of correct assignments expected if the network were assigning each patch to a class at random (as though it were simply flipping a coin). The network is trained for 26 folds of 25 epochs each. In each epoch, the network is trained on 70% of the patches and tested on the remaining 30% (there are equal numbers of patches from each image). The percentage of this test set that is assigned correctly is called the \u201cvalidation accuracy.\u201d At the end of each fold, the maximum validation accuracy is recorded, the dataset is resampled, and a new fold begins. After all folds are completed, we have a distribution of 26 maximum validation accuracies that represent how well the network has learned to distinguish between the two images in each of its attempts. The derivation of this expected distribution is as follows:\nThe goal is to find the distribution $p_{\\text{max}}(m)$, the probability that you will see a maximum of $m$ heads over $k$ repetitions (\u201c$k$ epochs\u201d) of an experiment where you flip a fair coin $n$ times. We start with the distribution of finding $m$ heads in a single experiment, which is the binomial distribution for a fair coin,\n$P_n(m) = 2^{-n} \\binom{n}{m}$,\nwhere $\\binom{n}{m} = \\frac{n!}{m!(n-m)!}$ is the binomial coefficient. We also define a tail distribution, which is the cumulative probability that you would find $m$ or more coin flips in a single experiment:\n$P_{\\text{tail}}(m) = \\sum_{j=m}^{n} P_n(j) = \\binom{n}{m} \\, _2F_1(m, n+1, m + 1; -1)$.\nHere $_2F_1(a, b, c; z)$ is a hypergeometric function, defined by the series:\n$_2F_1(a, b, c; z) = \\sum_{j=0}^{\\infty} \\frac{(a)_j(b)_j}{(c)_j}\\frac{z^j}{j!}$,\nwhere $(x)_j = x(x + 1)\\dots(x + j - 1)$ for $j > 0$ and $(x)_0 = 1$. There are other equivalent ways of expressing the tail probability of a binomial distribution (using for example incomplete beta functions), but all of them are similarly complicated.\nIf we repeat the experiment $k$ times, the probability that every single experiment had fewer than $m$ heads is:\n$U_{n,k}(m) = (1 - P_{\\text{tail}}(m))^k$."}, {"title": "Appendix B - Hyperparameter Optimization", "content": "The model hyperparameters for the neural network artistic practice discriminator model are opti- mized with a commercially available Bayesian hyperparameter optimization package built around the tree parzen optimization algorithm [1]. The optimization loss is based on the model perfor- mance after initial training on a restricted subset of the training data, because using the full dataset for this initial optimization step is computationally infeasible. In particular each model was trained for: 6 folds, 10 epochs, and patch size 200 on a reduced student painting dataset consisting of 5 paintings with 4 same artist combinations and 6 different artist combinations. Training loss was calculated as the RMSE distance between the predicted artist similarity and the ground truth, av- eraged over all painting combinations. The restricted training scheme was employed to reduce the total optimization time on finite computational resources. The considered hyperparameters and ranges are shown in Table S1. The model structure consists of a variable number of dense, fully- connected layers following the VGG16 model, where the number of nodes per layer decreases linearly from a variable maximum at the first dense layer to 2 at the output layer. Maximum poste- rior estimation was performed on the generated set of all trained models (130 instances) to predict the optimal hyperparameter set. Final optimization of the model shown in the manuscript utilized a full training scheme on the full dataset, as described in the manuscript, and is performed by hand. This is necessary since the full training scheme leads to unreasonably long convergence time in the optimization algorithm. The final hyperparameters align closely with the maximum posterior estimation result, as shown in Figure S1. Note that the largest deviation between the optimized and maximum posterior hyperparameters occurs for the learning rate, which is expected since the longer number of epochs in the full training process allows the model to converge with a smaller learning rate."}, {"title": "Appendix C - Comparison to alternative methods", "content": "Pairwise comparison of large numbers of regions via ML is computationally expensive, so a simpler method would be preferable if it were equally accurate. One simple way of distinguish- ing between regions of a painting using topography would be to compare the \u201croughness\" of the surfaces. We applied a roughness-based method to the student paintings to determine its accu- racy relative to the SSP method. We used the standard deviation of height values as a measure of roughness, and calculated the standard deviation of height values for each 1x1 cm\u00b2 patch of each student painting. We then compared paintings pairwise using the pairwise Wilcoxon rank sum test implemented in R using the stats package. A significant result on the pairwise Wilcoxon test means the distributions (specifically the medians) are significantly different, which in this con- text would indicate a different-artist pair. Thus, same-artist pairs would be tests where the null hypothesis could not be rejected. Using the Bonferroni correction for multiple tests with a=0.01, any pairwise comparison with a p-value greater than 0.00003 was considered a same-artist pair. This method had an overall accuracy of 81.0%, identifying 19 of 23 same-artist pairs (82.6%) and 220 of 277 different artist pairs (79.4%), a significant reduction in accuracy relative to SSP. This translates to F-scores of 0.384 for same-artist pairs and 0.878 for different-artist pairs, an average of 0.631. We conclude that SSP substantially outperforms roughness for identification of painters. This also indicates that the network is not simply sorting patches of images based on their roughness.\nAs described in the main text, SSP achieves unsupervised ends by supervised means. How would SSP fair against fully unsupervised learning on the surface topography, using clustering of"}, {"title": "Appendix D - Additional Figures", "content": null}]}