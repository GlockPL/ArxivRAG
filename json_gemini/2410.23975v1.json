{"title": "AVERAGE CONTROLLED AND AVERAGE NATURAL MICRO DIRECT EFFECTS IN SUMMARY CAUSAL GRAPHS", "authors": ["Simon Ferreira", "Charles K. Assaad"], "abstract": "In this paper, we investigate the identifiability of average controlled direct effects and average natural direct effects in causal systems represented by summary causal graphs, which are abstractions of full causal graphs, often used in dynamic systems where cycles and omitted temporal information complicate causal inference. Unlike in the traditional linear setting, where direct effects are typically easier to identify and estimate, non-parametric direct effects, which are crucial for handling real-world complexities, particularly in epidemiological contexts where relationships between variables (e.g., genetic, environmental, and behavioral factors) are often non-linear, are much harder to define and identify. In particular, we give sufficient conditions for identifying average controlled micro direct effect and average natural micro direct effect from summary causal graphs in the presence of hidden confounding. Furthermore, we show that the conditions given for the average controlled micro direct effect become also necessary in the setting where there is no hidden confounding and where we are only interested in identifiability by adjustment.", "sections": [{"title": "1 Introduction", "content": "The identification and estimation of direct effects are critical in many applications. For instance, epidemiologists aim to measure how smoking affects lung cancer risk independently of genetic susceptibility [Zhou et al., 2021]. In addition, it has been shown that estimating direct effects can help diagnose system failures by comparing the direct impacts of different components before and after failure [Assaad et al., 2023].\nIn the framework of Structural Causal Models (SCMs) [Pearl, 2009], there has been significant progress in identifying direct effects using fully specified causal graphs. However, constructing a fully specified causal graph is a challenging task, as it requires precise knowledge of the causal relationships between all pairs of observed variables. In complex, high-dimensional settings such as in medico-administrative databases, this level of detail is often unavailable, limiting the practical application of causal inference. As a result, there has been growing interest in the use of partially specified causal graphs in recent years [Perkovic, 2020, Anand et al., 2023, Ferreira and Assaad, 2024a, Assaad et al., 2024, Wahl et al., 2024]. One notable example is the cluster-ADMG (Acyclic Directed Mixed Graph) introduced by Anand et al. [2023], which offers a coarser representation of causal relationships. In this graph, vertices represent clusters of variables and therefore it simplifies the representation of complex systems. However, one main limitation of this type of graph is its acyclicity assumption which does not necessarily hold even if the underlying fully specified graph is acyclic. A closely related graph type is the summary causal graph (SCG), which is mainly used in systems involving time and which relaxes the assumption of acyclicity and represents causal relationships where each cluster corresponds to a time series or repeated measurements of the same variable in longitudinal studies. This flexibility makes SCGs particularly useful in scenarios involving temporal data and cycles.\nIn SCGs, two types of causal effects may be of interest. The first is the macro causal effect, which captures the impact of one set of time series on another set of time series. The second is the micro causal effect, which concerns the effect of one specific time point on another. This paper focuses on micro causal effects, with particular emphasis on micro direct effects."}, {"title": "2 Related works", "content": "There is a substantial body of work in the literature focused on identifying causal effects using partially specified graphs. For instance, the studies by Maathuis and Colombo [2013], Perkovic et al. [2016], Perkovic [2020], Wang et al. [2023] provided conditions for identifying total effects through partially directed graphs that represent all graphs within the Markov equivalence class of the true causal graph, including CPDAGs, MPDAGs, and PAGs. Furthermore, Flanagan [2020] provided conditions for identifying average controlled direct effects and average natural direct effects using CPDAGs and MPDAGs assuming no hidden confounding.\nIn the context of Cluster-ADMGs (acyclic directed mixed graphs where each vertex represents a group of variables), Anand et al. [2023] extended Pearl's do-calculus [Pearl, 1995] to establish necessary and sufficient conditions for identifying total effects between clusters. Building on this, Ferreira and Assaad [2024b] applied these results to SCGs, where each cluster represents a time series and which unlike Cluster-ADMGs, can contain cycles. However, both studies focus on macro causal effects (i.e., effects between clusters), whereas the present paper is concerned with micro-level causal effects within clusters.\nFor micro causal effects, Eichler and Didelez [2007] provided sufficient conditions for identifying micro total effects in time series, applicable to SCGs under the assumption of no instantaneous relations. When instantaneous relations are allowed, Assaad et al. [2023] showed that both micro total and micro direct effects are identifiable from SCGs in a linear setting, assuming no hidden confounders and that cycles in the SCG cannot be of size greater than one. Subsequently, Ferreira and Assaad [2024a] and Assaad et al. [2024] extended these results, establishing conditions for identifying micro total effects in a non-parametric setting and micro direct effects in a linear setting, even when cycles larger than one exist in the SCG. More recently, Assaad [2024] provided sufficient conditions for identifying total effects in the presence of hidden confounding. However, identifying micro direct effects in a non-parametric setting or with hidden confounding from SCGs (or any graph with cycles) remains an open challenge. This is not surprising, as direct effects are inherently more complex than total effects in non-parametric setting."}, {"title": "3 Preliminaries", "content": "In this section, we introduce the tools, terminology, and key theoretical results that will be essential for the remainder of the paper.\nIn the remainder, uppercase letters are used to denote variables, lowercase letters represent specific values of those variables, and blackboard bold letters indicate sets of variables. For any given graph, \\(Parents(., .)\\), \\(Ancestors(.,.)\\), and \\(Descendants(...)\\) will be used to represent the parents, ancestors, and descendants of a vertex, respectively. The first argument refers to the specific vertex under consideration, while the second argument corresponds to the graph in which these relationships are being examined. For instance, \\(Parents(X,G)\\) refers to the parents of vertex X in graph G. By convention, We will treat any vertex as an ancestor and a descendant of itself. The mutilated graph \\(G_{Wz}\\) is obtained from G by removing all edges with an arrowhead pointing to W (e.g., \\(X \\rightarrow W, X \\leftarrow W)\\), as well as all edges with a tail originating from Z (e.g., \\(X \\leftarrow Z\\)). In a graph, a path is said to be activated by W if every collider W (i.e., a node with structure \\(\\rightarrow W \\leftarrow\\)) on the path, or any of its descendants, is in W, and no non-collider on the path is in W. A path that is not activated is said to be blocked. If all paths between X and Y are blocked by a set W, then X is said to be d-separated from Y by W in the graph G, denoted as \\(X \\perp_G Y | W\\). The strongly connected component of a vertex X in a graph G, denoted by \\(Scc(X, G)\\), is the maximal subset of vertices that includes X, such that every vertex in this subset has a directed path to every other vertex in the subset. By convention, \\(Scc(X, G) = \\emptyset\\) if there is no cycle in the graph that includes X and \\(Scc(X, G) = \\{X\\}\\) if the cycle that includes X is a self loop on X. We refer to Pr as the probability distribution, and \\(Pr(\\cdot | do(X = x))\\) as the interventional distribution, where the do(\\cdot) operator represents the intervention.\nIn this study, we consider an unknown discrete-time dynamic structural causal model, a specific variant of the structural causal model [Pearl, 2009], designed to account for temporal dynamics."}, {"title": "Definition 1 (Discrete-time dynamic structural causal model (DTDSCM)).", "content": "A discrete-time dynamic structural causal model is a tuple \\(M = (\\mathcal{L}, \\mathcal{V}, F, Pr(I))\\), where \\(\\mathcal{L} = \\bigcup\\{\\mathcal{L}^i_t | i \\in [1,d], t \\in [t_0, t_{max}]\\}\\) is a set of exogenous variables, which cannot be observed but affect the rest of the model. \\(\\mathcal{V} = \\bigcup\\{\\mathcal{V}^i | i \\in [1,d]\\}\\) such that \\(\\forall i \\in [1,d], \\mathcal{V}^i = \\{V^i_t | t \\in [t_0, t_{max}]\\}\\), is a set of endogenous variables, which are observed and every \\(V \\in \\mathcal{V}\\) is functionally dependent on some subset of \\(\\mathcal{L} \\cup \\bigcup_{s \\le t} \\mathcal{V}^s \\setminus \\{V\\}\\) where \\(\\mathcal{V}^{\\le t} = \\{V^j_{t'} | j \\in [1, d], t' \\le t\\}\\). F is a set of functions such that for all \\(V^i_t \\in \\mathcal{V}\\), \\(f^i_t\\) is a mapping from \\([\\mathcal{L}^i_t\\) and a subset of \\(\\mathcal{V}^{<t} \\setminus \\{V\\}\\) to \\(\\mathcal{V}^i_t\\). \\(Pr(\\mathcal{I})\\) is a joint probability distribution over \\([\\mathcal{L}\\).\nSome of the findings in this paper consider an unknown, general DTDSCM, while others focus on a specific subfamily of DTDSCM that are constrained by the following assumption."}, {"title": "Assumption 2.", "content": "$\\forall \\mathcal{L}^i, \\mathcal{L}^j \\in \\mathcal{L}$ such that $\\mathcal{L}^i \\neq \\mathcal{L}^j$, $Pr(\\mathcal{L}^i \\cap \\mathcal{L}^j) = Pr(\\mathcal{L}^i)Pr(\\mathcal{L}^j)$, i.e., no hidden confounding.\nFurthermore, we suppose that in every unknown DTDSCM, there exists a known maximal lag between causes and effects, denoted as \\(\\gamma_{max}\\). Additionally, we assume that the probability distribution Pr over the observed variables is positive. Finally, we suppose that each DTDSCM induces a full-time acyclic directed mixed graph (FT-ADMG), a specific type of ADMG [Richardson, 2003], where bidirected dashed arrows represent hidden confounding. Under Assumption 2, the FT-ADMG reduces to a full-time directed acyclic graph (FT-DAG)."}, {"title": "Definition 3 (Full-Time Acyclic Directed Mixed Graph).", "content": "Consider a DTDSCM M. The full-time acyclic directed mixed graph (FT-ADMG) G = (V, E) induced by M is defined in the following way:\n\\[\n\\begin{aligned}\nE^1 &:= \\{X_{t-\\gamma} \\rightarrow Y_t | \\forall Y_t \\in V, X_{t-\\gamma} \\in X \\subseteq V^{\\le t}\\{Y_t\\}\\\\\n&\\qquad \\text{ such that } Y_t := f_{Y_t}(X, \\epsilon_{Y_t}) \\text{ in } M\\},\\\\\nE^2 &:= \\{X_{t-\\gamma} \\leftrightarrow Y_t | \\forall Y_t, \\forall X_{t-\\gamma} \\in V\\{X_{t-\\gamma}\\}\\\\\n&\\qquad \\text{ such that } Pr(\\epsilon_{X_{t-\\gamma}} \\cap \\epsilon_{Y_t}) \\neq Pr(\\epsilon_{X_{t-\\gamma}}) \\cdot Pr(\\epsilon_{Y_t})\\},\n\\end{aligned}\n\\]\nwhere \\(E = E^1 \\cup E^2\\).\nThe findings of this study, when viewed in isolation, do not rely on any additional assumptions. However, following the identification of the direct effect, the estimation phase involves using actual data. If the data consist of time series (e.g., various time series describing a specific patient), a stationarity assumption becomes necessary to satisfy the positivity assumption. Conversely, the stationarity assumption is not required when working with spatio-temporal or cohort data.\nIn the context of DTDSCM and FT-ADMG, both macro and micro causal effect questions can be posed [Ferreira and Assaad, 2024b]. A macro causal effect refers to the influence of an entire time series (or multiple time series) on another series, whereas a micro causal effect focuses on the influence of specific time points (or multiple time points) on other time points. This work specifically focuses on micro causal effects, with a particular emphasis on micro direct effects. In a linear setting (where all functions in F are linear), the micro direct effect of \\(X_{t-\\gamma}\\) on \\(Y_t\\) is represented by the path coefficient of \\(X_{t-\\gamma}\\) in \\(f_{Y_t}\\) within the DTDSCM. However, in a non-parametric setting, defining the direct effect becomes more complex. The literature distinguishes two types of non-parametric direct effects, the first being the controlled direct effect, which is defined as follows."}, {"title": "Definition 4 (Average Controlled Micro Direct Effect [Pearl, 2001]).", "content": "Given a FT-ADMG G = (V, E), \\(Y_t, X_{t-\\gamma} \\in V\\) and \\(Z = Parents(Y_t,G)\\{X_{t-\\gamma}\\} \\). The controlled micro direct effect of changing \\(X_{t-\\gamma}\\) from x to x' on \\(Y_t\\) while keeping Z at value z is defined as\n\\[\nCDE^{x,x'}_{X, Y, z} = E(Y_t | do(X_{t-\\gamma} = x'), do(Z = z)) - E(Y_t | do(X_{t-\\gamma} = x), do(Z = z)).\n\\]"}, {"title": "Definition 5 (Average Natural Micro Direct Effect [Pearl, 2001]).", "content": "Given a FT-ADMG G = (V, E), \\(Y_t, X_{t-\\gamma} \\in V\\) and \\(Z = Parents(Y_t,G)\\{X_{t-\\gamma}\\} \\). The natural micro direct effect of changing \\(X_{t-\\gamma}\\) from x to x' on \\(Y_t\\) is defined as\n\\[\nNDE^{x,x'}_{X,Y} = E(Y_t | do(X_{t-\\gamma} = x'), do(Z = z_x)) - E(Y_t | do(X_{t-\\gamma} = x))\n\\]\nwhere \\(z_x\\) is the counterfactual value of Z under the setting \\(X_{t-\\gamma} = x\\).\nNote that in Pearl [2014], Z is not the parents of \\(Y\\) but the set of intermediate variables (i.e., mediators) between \\(X_{t-\\gamma}\\) and \\(Y_t\\). In this work we will focus on the set of parents of the effect, as in Pearl [2001], since it allows a better parallel with the controlled direct effect.\nThere has been substantial work on identifying both average controlled and average natural direct effects from obser-vational data using ADMGs, and by extension, FT-ADMGs. These direct effects are considered identifiable if they can be expressed solely in terms of conditional probabilities and expectations over observed variables. Notably, the task of identifying these effects can, in some cases, be fully reduced to identifying interventional distributions alone. For instance, in the case of the average controlled direct effect, identification relies entirely on identifying the inter-ventional distribution \\(Pr(y_t | do(X_{t-\\gamma} = x), do(Z = z))\\). Meanwhile, for the average natural direct effect, it partially depends on identifying the interventional distribution \\(Pr(y_t | do(X_{t-\\gamma} = x))\\) and additionally requires identifying a counterfactual term. However, as demonstrated by Pearl [2001] and as we will show in Section 5, even this counter-factual term can sometimes be identified by relating it back to specific interventional distributions. The do-calculus, introduced by Pearl [1995] provides a symbolic machinery that can be used to identify interventional distributions. It compromises three rules, each establishing specific graphical criteria that dictate when substitutions can be applied to an interventional distribution. The most important aspect of the do-calculus is that it is sound and complete: any inter-ventional distribution is identifiable if and only if there exists a sequence of the rules of the do-calculus that transforms the interventional distribution into an expression containing only of conditional probabilities and expectations over ob-served variables [Pearl, 1995, Shpitser and Pearl, 2006, Huang and Valtorta, 2006]. The three rules of the do-calculus are as follows:"}, {"title": "R1:", "content": "$\\Pr(Y = y | do(Z = z), X = x, W = w) = Pr(Y = y | do(Z = z), W = w)$ if \\(Y \\perp_G X | Z, W\\)"}, {"title": "R2:", "content": "$\\Pr(Y = y | do(Z = z), do(X = x), W = w) = Pr(Y = y | do(Z = z), X = x, W = w)$ if \\(Y \\perp_G XZ, W\\)"}, {"title": "R3:", "content": "$\\Pr(Y = y | do(Z = z), do(X = x), W = w) = Pr(Y = y | do(Z = z), W = w)$ if \\(Y \\perp_{G\\overline{Z(W)}} XZ, W\\)"}, {"title": "", "content": "where \\(X(W)\\) is the set of vertices in X that are non-ancestors of any vertex in W in the mutilated graph \\(G\\overline{Z}\\).\nThe interventional distribution is said to be identifiable by adjustment when it can be expressed as a sum of probabilities of the response conditioned on the treatment and a subset of observed variables W, weighted by the probability of observing those values of W, i.e., \\(\\sum_{w} Pr(Y_t | X_{t-\\gamma} = x, W = w)Pr(w)\\).\nHowever, it is challenging for practitioners in fields like epidemiology to provide or validate a full-time ADMG, as this requires detailed knowledge of temporal dynamics at every time point, which can be both complex and impractical. Moreover, causal discovery algorithms [Spirtes et al., 2000] (i.e., algorithms which infer a causal graph from obser-vational data under strong untestable assumptions) are still largely ineffective on real-world data [A\u00eft-Bachir et al., 2023]. Therefore, it is often more feasible to use summary causal graphs, which simplify the causal structure into a more manageable form. This allows practitioners to focus on the key pathways and relationships. For instance, when studying the long-term effects of smoking on lung disease, epidemiologists can outline the main causal pathways\u2014like smoking leading to lung damage\u2014without needing to detail the exact timing of each intermediate step."}, {"title": "Definition 6 (Summary Causal Graph with possible latent confounding).", "content": "Consider an FT-ADMG G = (V,E). The summary causal graph (SCG) \\(G^s = (S,E^s)\\) compatible with G is defined in the following way:\n\\[\n\\begin{aligned}\nS &:= \\{V^i = (V^i_0, \\dots, V^i_{t_{max}}) | \\forall i \\in [1, d]\\},\\\\\nE^{s1} &:= \\{X \\rightarrow Y | \\forall X, Y \\in S, \\exists t' \\le t \\in [t_0, t_{max}] \\text{ such that } X_{t'-\\gamma} \\rightarrow Y_t \\in E\\},\\\\\nE^{s2} &:= \\{X \\leftrightarrow Y | \\forall X, Y \\in S, \\exists t', t \\in [t_0, t_{max}] \\text{ such that } X_{t'-\\gamma} \\leftrightarrow Y_t \\in E\\},\n\\end{aligned}\n\\]\nwhere \\(E^s = E^{s1} \\cup E^{s2}\\).\nFigures 1-4 present many examples of SCGs with compatible FT-ADMGs. The abstraction of SCGs implies that, while a given FT-ADMG corresponds to exactly one SCG, multiple FT-ADMGs can be compatible with the same SCG. As a result, the do-calculus as introduced by Pearl [1995], is not directly applicable to SCGs to identify micro causal effects [Ferreira and Assaad, 2024b]. The objective of this paper is to establish specific graphical conditions within an SCG that guarantee the existence of a sequence of do-calculus rules that can be applied to any FT-ADMG compatible with the SCG, yielding an identical expression involving only conditional probabilities and expectations over observed variables. A key insight about SCGs that aids in identifying these conditions is that, although there may not be a strict one-to-one correspondence between the set of parents of a vertex Y in an SCG and the set of parents of \\(Y_t\\) in any particular FT-ADMG, a precise mapping is possible when considering the set of all potential parents across all FT-ADMGs compatible with the SCG. Specifically, this set includes vertices that act as parents in at least one FT-ADMG that aligns with the SCG. Formally, this set of possible parents is defined as follows."}, {"title": "Definition 7 (Possible Parents).", "content": "Given an SCG \\(G^s = (S, E^s)\\), a maximal lag \\(\\gamma_{max}\\) and a vertex \\(Y \\in S\\). The set of possible parents of the temporal vertex \\(Y_t\\) is the set of temporal vertices (i.e.vertices in compatible FT-ADMGs) which are parents of \\(Y_t\\) in at least one compatible FT-ADMG. It is written PP(\\(Y_t\\)) and is defined as\n\\[\nPP(Y_t) = \\{P_{t-\\gamma} | P \\in Parents(Y, G^s)\\{Y\\}, \\gamma \\in [0, \\gamma_{max}]\\} \\cup \\{Y_{t-\\gamma} | \\gamma \\in ]0, \\gamma_{max}]\\} * 1_{Y \\in Parents(Y, G^s)}.\n\\]\nWe close this section with the following property of possible parents, which shows that it is possible to replace the set of parents in the definitions of the average controlled micro direct effect and the average natural micro direct effect by the set of potential parents."}, {"title": "Property 8.", "content": "Given a FT-ADMG G = (V, E), \\(Y_t \\in V\\) and \\(Z \\supseteq Parents(Y_t, G)\\) such that \\(Y_t \\notin Z\\), the following equality holds:\n\\[\nPr(Y_t = y | do(Parents(Y_t, G) = p)) = Pr(Y_t = y | do(Z = z)).\n\\]\nThis equality holds specifically for Z = PP(\\(Y_t\\)) and note that there exists a compatible FT-ADMG G' in which PP(\\(Y_t\\)) = Parents(\\(Y_t\\), G').\nThis property results directly from R3 of the do-calculus. A formal proof can be found in the supplementary materials."}, {"title": "4 Identifying Controlled Micro Direct Effects in SCGS", "content": "As stated in the previous section, the average controlled micro direct effect of interest is the one where we intervene on all parents of \\(Y_t\\). In order to identify this effect, in particular using R2 of the do-calculus, one can find a set of variables of \\(Y_t\\) which d-separates \\(Y_t\\) from its parents in \\(G^{Parents(Y_t,G)}\\) for all compatible FT-ADMG G. There are two significant challenges in this process. The first challenge arises when there exists a cycle involving Y and another vertex in the SCG. For example, consider the SCG in Figure 1(a), where Assumption 2 holds. In this case, the cycle between Y and W implies the presence of a compatible FT-ADMG G, as depicted in Figure 1(b), in which \\(W_t \\in Parents(Y_t, G)\\). In this FT-ADMG we would like to ultimately remove all the do(\\cdot) operators in the interventional distribution \\(Pr(Y_t = y | do(W_t = w), do(Y_{t-1} = y'), do(X_{t-1} = x), do(W_{t-1} = w'))\\) but for the sake of illustration let us only focus on removing the do(\\cdot) on \\(W_t\\). Notice that in this FT-ADMG, we have\n\\[\nY_t \\perp_G Y_{t-1} X_{t-1} W_{t-1} W_t | Y_{t-1}, X_{t-1}, W_{t-1},\n\\]\nwhich means that by using using R2 of the do-calculus, it is possible to write the considered interventional distribution as \\(Pr(Y_t = y | W_t = w, do(Y_{t-1} = y'), do(X_{t-1} = x), do(W_{t-1} = w'))\\). However, there exists another compatible FT-ADMG G', shown in Figure 1(c) where \\(W_t \\leftarrow Y_t\\) and thus it is impossible to use R2 to remove the do(\\cdot) operator on \\(W_t\\) in the same interventional distribution since\n\\[\n\\forall W_t, Y_t \\nleftrightarrow_G Y_{t-1} X_{t-1} W_{t-1} W_t.\n\\]\nThis indicates that the relationship between \\(W_t\\) and \\(Y_t\\) is ambiguous when only the SCG is considered, preventing the removal of the do(.) operator on \\(W_t\\) in the considered interventional distribution. The second challenge occurs when hidden confounding exists between Y and another vertex. For instance, consider the SCG in Figure 2(a), in this scenario, by examining the compatible FT-ADMG G in Figure 2(b), it becomes clear that as in the previous example, it is necessary to remove the do(.) on \\(W_t\\) in the interventional distribution \\(Pr(Y_t = y | do(W_t = w), do(Y_{t-1} = y'), do(X_{t-1} = x), do(W_{t-1} = w'))\\) as \\(W_t \\in Parents(Y_t, G)\\). However, hidden confounding exists between \\(W_t\\) and \\(Y_t\\), making R2 and R3 of the do-calculus inapplicable since\n\\[\n\\forall W_t, Y_t \\nleftrightarrow_G Y_{t-1} X_{t-1} W_{t-1} W_t \n\\text{ and } Y_t \\nleftrightarrow_G Y_{t-1} X_{t-1} W_{t-1} W_t | W_t^\\perp.\n\\]\nNevertheless, as shown in the following theorem, it is possible to identify the controlled micro direct effect in any SCG where no cycle involving Y and other vertices exists and where hidden confounding between Y and its ancestors is absent."}, {"title": "Theorem 9.", "content": "Given an SCG \\(G^s = (S, E^s)\\), \\(Y \\in S\\) and \\(X_{t-\\gamma} \\in PP(Y_t)\\). The controlled direct effect of changing \\(X_{t-\\gamma}\\) from x to x' on \\(Y_t\\) is identifiable if Scc(Y,\\(G^s\\)) \\(\\subseteq \\{Y\\}\\) and there does not exist a bidirected dashed arrow between Y and one of its ancestors (i.e. \\(\\nexists Z \\in Ancestors(Y, G^s), Z \\leftrightarrow Y\\)) and we have:\n\\[\nCDE^{x,x'}_{X, Y, z} = E(Y_t | X_{t-\\gamma} = x', Z = z) - E(Y_t | X_{t-\\gamma} = x, Z = z)\n\\]\nwhere Z = PP(\\(Y_t\\))\\(\\{X_{t-\\gamma}\\}\\).\nProof. Using Property 8 one can replace \\(Z = Parents(Y_t, G)\\{X_{t-\\gamma}\\} \\) by Z = PP(\\(Y_t\\))\\(\\{X_{t-\\gamma}\\}\\) in Definition 4. Suppose that Scc(Y,\\(G^s\\)) \\(\\subseteq \\{Y\\}\\) and that there does not exist a bidirected dashed arrow between Y and one of its ancestors in G. Let us show that in every compatible FT-ADMG G, we have\n\\[\nY_t \\perp_G^{PP(Y_t)} PP(Y_t),\n\\]\nin order to use R2 of the do-calculus to write \\(Pr(Y_t = y | do(PP(Y_t) = p))\\) as \\(Pr(Y_t = y | PP(Y_t) = p)\\).\nLet G be a compatible FT-ADMG and \\(Z_{tz} \\in PP(Y_t)\\) and let us consider a path \\(\\pi\\) from \\(Z_{tz}\\) to \\(Y_t\\) in \\(G^{PP(Y_t)}\\).\n*  \\(\\pi\\) cannot end with a right arrow (i.e., \\(\\pi \\neq (Z_{tz} \\dots \\rightarrow Y_t)\\)) as no arrow going in \\(Y_t\\) exists in \\(G^{PP(Y_t)}\\).\n*  \\(\\pi\\) can end with a left arrow (i.e., \\(\\pi = (Z_{tz} \\dots \\leftarrow Y_t)\\)) but it cannot contain only left arrows (i.e., \\(\\pi \\neq (Z_{tz} \\leftarrow \\dots \\leftarrow Y_t)\\)) as if X = Y, this would imply having causal arrows going backwards in time which is forbidden or if X \\(\\neq\\) Y, this would imply \\(X \\in Descendants(Y, G^s)\\) and thus \\(X \\in Scc(Y, G^s)\\) which contradicts the assumption. Therefore, there exists a collider in \\(\\pi\\) (\\(\\pi = (Z_{tz} \\dots \\rightarrow W_{tw} \\leftarrow \\dots \\leftarrow Y_t)\\) or \\(\\pi = (Z_{tz} \\dots \\leftrightarrow W_{tw} \\leftarrow Y_t)\\)) and is blocked.\n*  If \\(\\pi\\) ends with a bidirected dashed arrow (\\(\\pi = (Z_{tz} \\dots U_{tu} \\leftrightarrow Y_t)\\)) then by assumption, \\(U_{tu}\\) is not a possible ancestor of \\(Y_t\\) so since \\(Z_{tz} \\in PP(Y_t)\\), the remaining arrows cannot all be left arrows (\\(\\pi \\neq (Z_{tz} \\leftarrow \\dots U_{tu} \\leftrightarrow Y_t)\\)). Therefore, there exists a collider in \\(\\pi\\) (i.e., \\(\\pi = (Z_{tz} \\dots \\rightarrow W_{tw} \\leftarrow \\dots \\leftarrow U_t \\leftrightarrow Y_t)\\) or \\(\\pi = (Z_{tz} \\dots \\leftrightarrow W_{tw} \\leftarrow \\dots \\leftarrow U_{tu} \\leftrightarrow Y_t)\\)) and \\(\\pi\\) is blocked.\nTherefore, all path between \\(Y_t\\) and PP(\\(Y_t\\)) are blocked in \\(G^{PP(Y_t)}\\), i.e.,\n\\[\nY_t \\perp_G^{PP(Y_t)} PP(Y_t).\n\\]"}, {"title": "Proposition 10.", "content": "Given an SCG \\(G^s = (S, E^s)\\), \\(Y \\in S\\) and \\(X_{t-\\gamma} \\in PP(Y_t)\\). Under Assumption 2, if Scc(Y, \\(G^s\\)) \\(\\not\\subseteq \\{Y\\}\\) then the controlled direct effect of changing \\(X_{t-\\gamma}\\) from x to x' on \\(Y_t\\) is not identifiable by adjustment.\nProof. Firstly using Property 8 one can replace \\(Z = Parents(Y_t, G)\\) by Z = PP(\\(Y_t\\)) in Definition 4. Let us suppose that Scc(Y, \\(G^s\\)) \\(\\not\\subseteq \\{Y\\}\\), then there exists a cycle on Y other than the self-loop in the SCG, i.e.\\(\\exists C \\in Cycle(Y, G^s)\\{\\{Y\\}\\}\\). Let us write \\(C = (V_1, \\dots, V_n)\\) with n \\(\\ge\\) 3, \\(V_1 = V_n = Y\\), \\(\\forall 1 < i < n, V^i \\neq V^{i+1}\\) and \\(V^i \\rightarrow V^{i+1}\\) or \\(V^i \\leftrightarrow V^{i+1}\\). Then, \\((V_{n-1}, \\dots, V_1)\\) is a active non-direct path containing only descendants of Y so according to Theorem 1 of Ferreira and Assaad [2024a] one cannot be certain to block every non-direct from \\(V_{n-1}\\) (which is a potential parent of \\(Y_t\\)) to \\(Y_t\\) without risking to induce a bias by adjusting on descendants of \\(Y_t\\) and thus the controlled direct effect is not identifiable by adjustment."}, {"title": "5 Identifying Natural Micro Direct Effects in SCGs", "content": "Pearl [2014"}]}