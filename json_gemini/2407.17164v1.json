{"title": "Robust Deep Hawkes Process under Label Noise of Both Event and Occurrence", "authors": ["Xiaoyu Tan", "Bin Li", "Xihe Qiu", "Jingjing Huang", "Yinghui Xu", "Wei Chu"], "abstract": "Integrating deep neural networks with the Hawkes process has significantly improved predictive capabilities in finance, health informatics, and information technology. Nevertheless, these models often face challenges in real-world settings, particularly due to substantial label noise. This issue is of significant concern in the medical field, where label noise can arise from delayed updates in electronic medical records or misdiagnoses, leading to increased prediction risks. Our research indicates that deep Hawkes process models exhibit reduced robustness when dealing with label noise, particularly when it affects both event types and timing. To address these challenges, we first investigate the influence of label noise in approximated intensity functions and present a novel framework, the Robust Deep Hawkes Process (RDHP), to overcome the impact of label noise on the intensity function of Hawkes models, considering both the events and their occurrences. We tested RDHP using multiple open-source benchmarks with synthetic noise and conducted a case study on obstructive sleep apnea-hypopnea syndrome (OSAHS) in a real-world setting with inherent label noise. The results demonstrate that RDHP can effectively perform classification and regression tasks, even in the presence of noise related to events and their timing. To the best of our knowledge, this is the first study to successfully address both event and time label noise in deep Hawkes process models, offering a promising solution for medical applications, specifically in diagnosing OSAHS.", "sections": [{"title": "1 Introduction", "content": "Temporal point processes (TPP) are designed to predict the nature and timing of forthcoming events by understanding the patterns of their occurrence [8]. These models are particularly suited for scenarios where events happen asynchronously (at unpredictable intervals), are multimodal (involving diverse event types), and are influenced by past occurrences. As a distinctive TPP approach, the Hawkes process is designed to simulate a self-exciting process over time. Essentially, as one event happens, it increases the likelihood of subsequent events, though this increased intensity fades as time passes. The model's applications span high-frequency trading [2], bioinformatics gene mapping [20], earthquake forecasting [3], traffic pattern analysis [39], and predicting patient disease trajectories and timings [23, 21].\nTo estimate the likelihood of an event's occurrence, the Hawkes process employs an intensity function influenced by past events. Traditional Hawkes models, however, often presume that prior events invariably have a positive impact on upcoming ones. This presumption can limit the model's adaptability, sometimes yielding suboptimal outcomes with limited versatility [37, 40]. To address this, several approaches incorporating deep neural structures have been proposed to enhance the dynamic modeling and demonstrate improved results in various real-world data experiments [37, 40, 14]. Yet, even with the benefits of deep neural networks, these models overlook the significant label noise present in real-world scenarios. In real-world settings, data often suffers from label noise, which can hinder the efficiency and reliability of the learning process. Such noise might arise from human labeling mistakes or intrinsic flaws in electronic logging systems [4, 19, 27]. Especially in the medical domain, label noise is primarily induced by the inherent subjectivity in diagnoses, expert errors in manual labeling, equipment variability, and the complexity of medical conditions [5], which introduce significant risk in medical diagnosis predictions using the Hawkes process.\nTo explore the impact of label noise on both event types and timing, we first conduct an ablation study focusing on the errors in learning intensity functions. We compare datasets with clean, accurate labels against those with noisy labels to understand this influence. Our analysis in Section 2.2 reveals that label noise, whether in events or timing, significantly impairs the learning of intensity functions, leading to errors in model predictions. Furthermore, when both types of label noise are present, the resultant error in learning intensity functions surpasses the sum of errors caused by each type of noise independently. This indicates a compounded effect, where the interaction between event and time noise amplifies the learning challenges more than if each noise type acted alone. The compounded impact of event and time noise not only challenges conventional label noise mitigation strategies but also emphasizes the importance of developing a more sophisticated approach to improve robustness under both label noise and influence.\nTo separately mitigate the influence of label noise from events and timing, reduce the compounded effects, and improve the robustness of the Hawkes process under the deep learning framework, we therefore propose a novel framework called Robust Deep Hawkes Process (RDHP) to improve the performance under label noise, especially in real-world medical scenarios. We conduct experiments on synthetic open-source datasets and a real medical dataset on obstructive sleep"}, {"title": "2 Methods", "content": "2.1 Preliminary\nWe consider a TPP sequence \\(X = \\{(t_1, v_1), (t_2, v_2), ..., (t_i, v_i)\\}\\), where each \\((t_i, v_i)\\) denotes the i-th event of a time series, with \\(v_i\\) representing the event type and \\(t_i\\) the arrival time. The goal is to predict the type and occurrence time of the next event based on X. In such processes, past events influence future ones, and the occurrence of events is modeled using a conditional intensity function \\(\\lambda^*(t)\\), which depends on historical events \\(H_t\\). This function is defined by the conditional density \\(f(t | H_t)\\) and the cumulative distribution function \\(F(t | H_t)\\) is as follows:\n\n\\lambda^*(t) = \\frac{f(t | H_t)}{1- F(t | H_t)} \\tag{1}\n\nConsidering a small time interval [t, t + dt], the event probability in this interval is given by:\n\n\\lambda^*(t)dt = E [N([t, t + dt]) | H_t], \\tag{2}\n\nwhere N() is the counting function for events in the interval. The conditional intensity function can be simulated through the Hawkes process:\n\n\\lambda^*(t) = \\mu + \\alpha\\sum_{t_{i-1} < t}e^{-\\beta(t-t_{i-1})}, \\tag{3}\n\nwhere \\(\\mu\\) is the base intensity, \\(\\alpha\\) is the incentive weight, and each new event increases the conditional intensity, which decays exponentially back to \\(\\mu\\) over time. This framework allows for the modeling of event sequences, considering both self-excitement and mutual excitation between different event types.\n\n\\lambda^*(t) = \\mu(t) + \\alpha \\Sigma \\varphi(t - t_{i-1}), \\tag{4}\n\nt_{i-1} < t\n\nwhere \\(\\varphi(t) = e^{-(\\gamma t)}\\) is the density function influenced by historical events, with \\(\\gamma\\) controlling the decay rate.\n2.2 The Compounded Effect of Label Noise from Both Events and Occurrence\nIn real-world scenarios, however, there is typically some noise in the Hawkes process. For example, for electronic health records (EHRs) [1], there are a number of instances where the wrong disease type or time point is recorded during the manual recording process. As shown in Figure 1, such instances can have a significant impact on the Hawkes process prediction. In this study, we conducted an experiment to examine the impact of label noise on the MIMIC dataset using the SAHP algorithm [37]. Initially, we trained a model on a clean dataset, using the values of the intensity layers as a benchmark. Subsequently, we introduced two types of noise: Gaussian noise (with a mean of 0 and a standard deviation of 0.8) to corrupt the time labels, and uniform noise for the event labels. These were used to train two separate models to assess how each type of noise affected the learning of the intensity function.\nThe final step involved combining both types of label noise to train another model. This helped us understand the combined impact of event and time label noise on the intensity layers. We compared the performance of each model by measuring the deviation of their learned intensity layers from those of the clean dataset, as illustrated in Figure 3.\nOur findings reveal that both event and time label noise independently affect the learning of intensity layers, leading to errors. More notably, the concurrent presence of both noise types leads to a compounded effect, resulting in errors that exceed the sum of their individual impacts. This complex interaction between event and time label noise hasn't been extensively explored in prior studies. Therefore, developing a robust learning framework that effectively counters the detrimental effects of both types of label noise is crucial.\n2.3 Deep Hawkes process\nWe use a linear embedding layer to encode event types of a time series, transforming one-hot embeddings into a vector \\(S_j\\) using a matrix \\(W_s\\):\n\nS_j = I_jW_s, \\tag{5}\n\nwhere \\(I_j\\) is the one-hot embedding of event type j. Event occurrence times are encoded using a sinusoidal function, following the method by [37]:"}, {"title": null, "content": "wktj = sin(wtktj + wk), \\\\\nwctj = cos(wetj + we), \\tag{6}\n\nwhere \\(w_k\\) and \\(w_e\\) represent angular frequency and phase shift, respectively. The final embedding is a combination of these two encodings:\n\nX_i = S_j + T_j. \\tag{7}\n\nTo model event intensity, the model uses self-attention mechanisms, as defined by [32]:\n\nA(Q, K, V) = softmax(\\frac{QK^T}{\\sqrt{d}}) V, \\tag{8}\n\nwhere Q and K are derived from linear transformations of \\(x_i\\), and d is the dimension of K. The historical information of events is encoded using a hidden vector:\n\nh(t_{i+1}, 0) = \\frac{\\Sigma_{j=1}^{i} f(x_{i+1}, x_i)g(x_i)}{\\Sigma_{j=1}^{i} f(x_{i+1}, x_i)}, \\tag{9}\n\nwhere f() is a Gaussian embedding and g() is a linear transformation. Using this hidden vector, we calculate the conditional intensity function parameters to model Hawkes process:\n\n\\mu_{i+1,0} = gelu(h(t_{i+1, 0})W_{\\mu}), \\\\\n\\alpha_{i+1,0} = gelu(h(t_{i+1,0})W_{\\alpha}), \\\\\n\\gamma_{i+1,0} = softplus(h(t_{i+1,0})W_{\\gamma}), \\tag{10}\n\nwhere gelu(.) and softplus() are activation functions. The intensity function \\(\\lambda_o\\) reflects the historical event's effect on the next event for \\(t \\in (t_i, t_{i+1}]\\):\n\n\\lambda_o = softplus(\\mu_{i+1,0} + (\\Alpha_{i+1,o} - \\mu_{i+1,0})e^{-\\gamma_{i+1,0}(t-t_i)}). \\tag{11}\n\nFinally, we use hybrid fully connected MLPs for regression (time prediction) and classification (event-type) based on \\(\\lambda\\). This approach aligns with [37] and has shown effectiveness in various real-world TPP scenarios. The hybrid architecture is shown in Figure 2.\n2.4 Robust Deep Hawkes Process\nThe historical event's influence on subsequent events can be analyzed using the deep Hawkes process. This analysis uncovers hidden details that can be instrumental in predicting upcoming events. However, as introduced in Section 2.2, real-world point process data often comes with inaccuracies regarding the event type and timing, which induces a significant compounded error effect during hidden intensity layer learning. Hence, in this section, we begin by addressing the label noise issue, both in event classification and time regression. We approach this through targeted adjustments in loss functions and network design. Subsequently, we develop a loss balance network, similar to the model discussed in [26], which is designed to effectively reduce compounded errors by ensuring balanced updates.\n2.4.1 Mitigate Label Noise Effects in Events Learning\nIn standard deep Hawkes processes, such as SAHP or THP, the frequently employed cross-entropy loss function is not particularly resistant to label noise [38]. For handling label noise in classification,"}, {"title": null, "content": "numerous historical approaches have been proposed for modifying loss functions in the study of label noise. In RDHP, we implement generalized cross-entropy (GCE) loss for event-type prediction [38]. GCE combines the advantages of MAE noise immunity performance and categorical cross-entropy (CCE) loss fast convergence, and the effectiveness of GCE has a theoretical guarantee from the gradient perspective. To encounter the event type error, we implement the GCE as the loss function of the event type prediction layer:\n\nL = \\frac{1 \u2013 (M(X)_u)^{\\beta}}{\\beta}, \\tag{12}\n\nwhere \\(\\beta \\in (0, 1]\\) is a predefined temperature hyperparameter and M() denotes the u-th element of the MLP prediction output, which target is one. \\(\\beta\\) controls the degree of GCE loss generalization on CCE and MAE. When \\(\\beta = 1\\), \\(L_u\\) becomes MAE loss, which is insensitive to outliers, but the gradient decreases too slowly when approaching model convergence, hence extending the model's convergence time [33]. When \\(\\beta = 0\\), L approaches CCE loss, which converges quickly but remains unstable for noise data. Training RDHP under GCE loss can exploit the trade-off and enhance noise-resistant performance.\n2.4.2 Mitigate Label Noise Effects in Occurrence Time Learning\nFor event occurrence time prediction, the noise is imposed on the occurrence time point. We design the timing label noise mitigation part by extending the method proposed by [18] in RDHP. The basic idea is to introduce a hyperparameter on each data point to overparameterize the model. Then, during the model learning process, the bias induced by the label noise can be mainly learned by these hyperparameters, and the main model can remain highly generalized. This learning process can significantly reduce the impact of noisy data [18].\nHence, in the timing prediction part of RDHP, our goal is to minimize the difference between \\(M_t(X) + p_i\\) and \\(t_i\\), where \\(M_t(A)\\) is the output of the time prediction layer. Based on the sparse overparameterization trick[18], we can formulate the parameter \\(p_i\\) by:\n\np_i = m_i \\odot t_i - n_i \\odot (1 \u2013 t_i), \\tag{13}\n\nwhere \\(m_i \\in [-1,1]\\) and \\(n_i \\in [-1,1]\\) denote two data-specific parameters, and \\(\\odot\\) is element-wise production. Please note that since the purpose of the hyperparameter term \\(p_i\\) is to learn the noise information during the training process, \\(p_i\\) is only optimized in the training process and dropped in inference. To further improve the robustness of \\(M_t\\) in handling large outliers, which might be the data points with large label noise, we implement MAE loss as a time-prediction loss function to optimize this model:\n\nC = |M_t(X) + p_i - t_i|. \\tag{14}\n\n2.4.3 Mitigate Compounded Label Noise Effect From Both Events and Occurrence\nAs discussed in Section 2.2, the impact of label noise can be compounded from both events and occurrences, substantially affecting the learning of intensity layers. This, in turn, can lead to significant errors in prediction. Besides, when the dataset is subjected to label noise originating from both events and occurrences, the impact of this noise is also heterogeneous across individual data points. Moreover,"}, {"title": null, "content": "different datasets may have different label noise distributions across events and occurrences, which should be addressed adaptively.\nHence, uniformly applying the label noise mitigation methods introduced in Section 2.4.1 on each data might not address such inconsistency. Here, we design a sample re-weighting learning process by assigning varying weights to loss and differentially addressing the varying degrees of noise contamination during the model training process.\nSimilar to [26], we first construct a small clean set \\(D_c\\) from the whole noise set \\(D_n\\) and design re-weighting net r with parameter \\(\\epsilon\\) to generate the sample-wise loss weight of \\(\\sigma_o\\) for \\(L_t\\) and \\(\\sigma^+\\) for \\(L^o\\):\n\n\\sigma_o, \\sigma^+ = r_{\\epsilon}(L^o, L_t). \\tag{15}\n\nHence, to optimize the main model M with parameter \\(\\theta\\) which are introduced in Section 2.3 and 2.4.2, we can perform a bi-level optimization approach by minimizing the following two loss on separate dataset:\n\nL_D^{\\theta,\\epsilon} = \\sigma^o L_D^o + \\sigma^+ L_D^t \\\\\nL_D^{\\epsilon,\\theta} = \\sigma_o L_D^o + \\sigma_t L_D^t \\tag{16}\n\nwhere the \\(\\epsilon\\) is optimized by the \\(L_{D_c}^{\\theta,\\epsilon}\\), on small clean dataset \\(D_c\\) and \\(\\theta\\) is optimized by the \\(L_{D_n}^{\\epsilon,\\theta}\\), iteratively.\nTo stabilize the whole training procedure of RDHP, the optimization is carried out in four sequential stages. In the first stage, we focus on updating parameters in \\(M_t\\) and \\(M_e\\). The second stage involves the optimization of the regularization parameters of m and n. In the third stage, we update the parameters of M. Finally, in the fourth stage, we update the parameters of r. Details of this multi-stage optimization process are thoroughly described in Algorithm 1."}, {"title": "3 Experimental results", "content": "In this section, the noise resistance of our proposed framework is evaluated using both synthetic and real-world clinical OSAHS datasets provided by the collaborative university hospital.\nand is influenced by the performance of PSG instruments and environmental factors during data collection. In the OSAHS dataset presented in Table 1, the longest sequence spans two hours and encompasses a total of 207 recorded events. Extrapolating to a full 8-hour night of sleep results in a total of 1656 events. If the misclassification rate of snoring events exceeds 3%, it can potentially lead to the erroneous diagnosis of mild OSAHS in patients.\n3.2 Noise setup\nTo assess the model's robustness to label noise, we introduce noise into the training set, while maintaining the integrity of the validation and test sets. The dataset is modified with synthetic noise using a noise probability p. Consider a time series X = {(t1, 1), (t2, U2), ..., (ti, vi)}, where vi represents the event type of the i-th event, taking values from 1 to K, and ti signifies the event occurrence time within the range [0, tmax]. Label noise means that for each event (ti, vi), there is a probability p that either ti or vi, or both, may be incorrect. With a noise probability of p, the timestamp ti could be modified to ti + tnoise, where tnoise is a Gaussian-distributed variable with a mean of 0 and a standard deviation of 0.8. This alteration can lead to changes in the chronological order of events, as illustrated in Figure. 1.\nWe incorporate three distinct forms of label noise into our analysis: Uniform noise, Flip noise, and Flip2 noise. The matrices illustrating how each type of noise affects the labels are depicted in Figure 4. For a more comprehensive explanation of these noise types, including their specific characteristics and how they are applied to the data, please refer to Appendix B.\n3.3 Experiment Setup and Implementation\nBefore introducing noise, in a synthetic experiment, we randomly extract 5% clean datasets from the training set, which are used for optimizing the re-weighting net. For different noise dataset scenarios, we simulated synthetic datasets with a noise rate of p, and the noise was added by introducing Gaussian distribution on timestamps and the three aforementioned types of label noise. This corresponds to the situation where experts incorrectly record time points and event types during data labeling.\nWe utilized a dataset of OSAHS patients obtained in a noisy environment and manually labeled by human experts. This dataset is used to test the robustness of RDHP under TPP with real human label noise. The dataset is divided into 60%, 20%, 10%, and 10% for train, validation, test, and clean, respectively. Here, we invite the human expert to relabel the validation and test sets carefully, which are considered clean sets. For synthetic noise datasets, we divide the dataset into 80% for training, 10% for validation, and 10% for testing.\nSince the event type is a multi-classification problem, as shown in Table 1, we choose Macro F\u2081 score to evaluate the noise robustness of RDHP. For the event occurrence time prediction, we choose"}, {"title": "3.4 Main Results", "content": "These experiments involved the application of three different noise types and were performed in five separate trials. The average number of iterations for the experiments was 200, with an average runtime of approximately 3000 seconds. The experimental results represent the mean values obtained from five independent trials with random seeds, which have been summarized and listed in Table 2. The hyperparameter settings for the RDHP model experiment can be found in Appendix C.\nRDHP achieves the most stable and best classification F\u2081 on MIMIC-II in all noise cases. It converges to the best RMSE for all the event occurrence time prediction. It also stabilizes the training on MIMIC-III and achieves superior noise robustness compared to baseline methods. In the uniform noise case, the RDHP model generally exhibits greater robustness in classification compared to THP and SAHP, with a significantly lower RMSE. In summary, the classification performance of SAHP and THP deteriorates under moderate to high noise conditions, resulting in a rapid increase in RMSE. Furthermore, noise has a catastrophic impact on SAHP and THP, particularly in high-noise scenarios, where their classification performance notably declines. This supports our previous assertion that existing deep Hawkes processes may lack robustness in the presence of label noise. However, through robust structural modifications and overparameterization regression, RDHP maintains high accuracy and low RMSE even in high-noise environments.\nTable 3 shows the performance of RDHP with baseline methods on the OSAHS dataset. This dataset is a time series of snoring events taken from OSAHS patients throughout the night, and the presence of marker noise is assumed. After the experiments, we can observe that RDHP achieves superior performance in the real case, on both classification and regression. THP overfits the noise data and demonstrates its unstable performance in the real circumstances under label noise. The classification effect of SAHP in the real environment is also greatly reduced, and the prediction error for the time of event occurrence is large. The results indicate that, so far, deep Hawkes models remain unstable under real-world label noise."}, {"title": "4 Ablation Study", "content": "In this section, we conduct an ablation study to evaluate the contributions of each component in our RDHP model, particularly focusing on its label noise resilience capability. For event type prediction, the model employs a training loss based on the Generalized Cross Entropy (GCE) and utilizes a dedicated event prediction subnet, denoted as \\(M_e\\). In contrast, time regression is handled by a separate subnet, \\(M_t\\), which applies sparse overparameterization regression. Additionally, we incorporate a re-weighting network, r, to ensure balanced training between classification and regression tasks.\nThe ablation study is structured to assess the individual impact of these components. Initially, we explored the model's performance under various noise conditions, including scenarios with only temporal noise, only label noise, and situations where both occur simultaneously. This investigation aimed to understand how different types of noise affect the model's robustness. We also examined the convergence patterns of the weights for classification and regression losses during balanced training. This was crucial to ensuring that both aspects of the model were trained effectively. Lastly, we analyzed the"}, {"title": "4.1 Impact of Noise", "content": "The experimental results provide insights into the impact of noise on the SAHP and RDHP using different noise scenarios applied to the MIMIC-II dataset. The time point noise is configured following Section 3.2, with a Gaussian distribution for time point noise and uniform noise for label noise. The results are presented in Table 4. In the study, the introduction of only occurrence noise significantly affected the RMSE, with a minor reduction in the F\u2081 score. Conversely, when only label noise was introduced, it notably impacted the accuracy of event type prediction, leading to a substantial increase in RMSE as the noise level increased. Moreover, when both time and label noise were present, the performance in terms of F1 score for classification and the RMSE for regression was the poorest. This decline in performance is attributed to the nature of the Hawkes process, a self-exciting model, where noise considerably affects the computation of intensity, as evident in Figure 3. This, in turn, adversely affects the final model's performance in both classification and regression tasks. However, our proposed RDHP demonstrates superior classification performance and maintains a low RMSE under these conditions, indicating its resilience to noise. These findings highlight the Deep Hawkes Process's vulnerability to noise and underline the necessity of implementing noise reduction strategies or robust training methods to ensure dependable performance in practical applications."}, {"title": "4.2 The Learning of loss weight \u03c3", "content": "In Figure 5, we present the dynamic adjustments of the loss weight \\(\\sigma\\) in the RDHP model, considering both time loss and event loss, with 30% uniform noise. The X-axis represents the progression of training epochs, while the Y-axis tracks the difference Ao in weight values between epochs. This visualization reveals a notable pattern in the training phase: the weights assigned to each loss function adaptively adjust over time, eventually reaching a state of equilibrium. The re-weighting network plays a crucial role in this process, effectively managing the balance and mitigating the compounded bias from the learning loss for events and timing. This equilibrium not"}, {"title": null, "content": "only enhances the model's performance but also incorporates a systematic approach to mitigating label noise in both the event and timing aspects of the training data. In Table 5, the RDHP's performance in both classification and regression tasks decreases without the re-weighting net.\n4.3 Regularization\nAs introduced above, robust regularization utilizes new hyperparameters on each data to separate the noisy information. The results demonstrate that the robustness of the classification task has been slightly enhanced, whereas the regression task has been significantly enhanced. In Table 5, we present a comparative analysis of various models. It is evident that the incorporation of robust regularization leads to a notable reduction in the RMSE. Given that each sequence in the MIMIC-II dataset represents a patient's medical history over a period of 7 years, normalized within the range [0, 5.3846], even minor inaccuracies in time prediction can result in significant deviations. This context underscores the exceptional performance of the RDHP model, which maintains an RMSE of approximately 1.0, indicating its high accuracy. Furthermore, the model demonstrates resilience against label noise, showing minimal impact on its regression capability."}, {"title": "5 Conclusion", "content": "In this study, we introduce a novel robust deep Hawkes process (RDHP) model specifically designed to handle corrupted training labels. Prior research has largely overlooked the compounded bias arising from label noise in both event types and their occurrence times. To the best of our knowledge, our RDHP model is the first to tackle this challenge. It improves the resilience of event classification and time prediction in noisy environments through a robust loss function, sparse overparameterization regularization, and loss re-weighting strategies. We demonstrate the limitations of existing Hawkes process models for handling label noise through experiments on synthetic and real OSAHS datasets. Our RDHP model consistently outperforms traditional models, achieving higher classification accuracy and a lower RMSE. Further, we conduct ablation studies to assess the impact of each component of our model. This research paves the way for enhancing robustness in broader point process models, offering a significant advancement in handling real-world data with inherent label noise. Future works will focus on further refining accuracy in noisy conditions and expanding applicability to a wider range of practical noisy scenarios."}, {"title": "A Related Work", "content": "A.1 Temporal Point Process\nThe temporal point process (TPP)[8, 6, 10] is an approach of modeling time series that employs point patterns, which can be employed to model historical events. It is assumed that events in the point model occur instantaneously and can be represented as points on a time series. These points are interconnected, and what occurred in the past may have an impact on what will occur in the future [22].\nThe conventional point process methods include the poisson process [17], the self-correcting process [13], and the Hawkes process [10]. The Hawkes process is a self-exciting model, which means that previous events have an incentive effect on future events, and this incentive effect decays with time, in accordance with the real world. Hawkes process is commonly used in earthquake prediction, finance, and disease prediction [11].\nWith the recent advances in deep learning technology in recent years, the deep Hawkes process technique has attracted considerable interest. [37] proposes the SAHP model by combining the Hawkes process with the attention mechanism to increase the connection between event points in a sequence. [40] combines the Hawkes process with Transformer to capture long-term dependencies using a self-attention mechanism while increasing computational efficiency. However, the aforementioned models' assumptions are modeled in a noise-free situation, i.e., the event type and event time point are precisely recorded. Real-world data is always contaminated with various types of labeling noise, such as human labeling errors and technical recording techniques, significantly affecting the learning process's efficiency and stability. [4, 19, 27].\nA.2 Label Noise\nWhen considering a time series with noise, there are typically two types of noise: one is caused by the time shift of the event time point (i.e., label noise of occurrence time), and the other is the event type being recorded incorrectly (i.e., label noise of the event). Both of these types of noise are prevalent in real-world scenarios and might have an impact on the robustness of the model.\nA number of methods have been developed to improve the model's robustness under label noise of event. Modifying the model's structure, adjusting sample selection, incorporating regularization, and designing loss functions are typical techniques for improving model robustness [27].\nNoise modeling [35] proposes a method employing two independent networks, both for predicting noise type and label shift probability, respectively. After the training step, both networks are trained with numerous noisy labels and a small amount of clean data, making their adaptability to more general architectures challenging.\nSample selection the Co-teaching family [9] [36] [34] as the main representative, multiple network structures are used to filter each other, and there is the problem of increasing the training parameters and decreasing the training efficiency.\nRobust regularization data augmentation [25], weight decay [16], dropout [28], and batch normalization [12], can improve model robustness, but these methods suffer from reduced generalization when the noise is high [29]. The loss function is reviewed in the following. Moreover, the mentioned methods also have a uniform problem, that is, only the label noise of the event is considered without considering the label noise of the occurrence time point.\nRecent studies have also extensively focused on the label noise of the event's occurrence time point. [30] claim that each sequence has a fixed time shift (synchronous noise), and the causal relationship between the sequences can be reconstructed by modifying the excitation kernel function and estimation method. Subsequently, [31] amend the noise assumption and correct the sequence causality by the cumulative amount of MHP, with each sequence noise belonging to different independent distributions. However, the above-mentioned models have certain limitations: they concentrate solely on the relationship between time sequences without accounting for the simultaneous presence of label noise existing in both event types and occurrence time points, which will have a negative effect on the classification accuracy of the following event.\nCategorical cross-entropy loss (CCE) is the most commonly used loss function in event classification tasks due to its fast convergence and high generalization capabilities. [7] demonstrate that in noisy tasks, MAE has superior generalization performance than CCE and is more robust under noise by creating a risk minimization model. However, if the data is more complicated and the event types are more diverse, MAE is difficult to converge, and its generalization performance will subsequently decrease. Subsequently, [38] derives the GCE loss function from the gradient properties of MAE and CCE. It has both the fast convergence property of CCE and the robustness of MAE in terms of noise performance.\nWe present a deep robust Hawkes process (RDHP) that combines a robust loss function and robust regularization in order to deal with the simultaneous presence of label noise in both event types and occurrence time points. The model encodes a sequence of event points with event type and occurrence time noise, produces point-to-point attention scores, and then models them using the Hawkes process in order to obtain historical event hidden information. GCE is presented as a loss function for event prediction. The prediction of occurrence time points, which is more probable to be a regression problem, employs the more robust MAE loss function. Meanwhile, robust regularization is implemented, and new hyperparameters are added to create a data model for learning clean data by separating noise information. The overview of our proposed model is shown in Figure 2."}, {"title": "B Noise Setting", "content": "Here we describe three types of label noise. Consider a time series X = (t1, 01), (t2, U2), ..., (ti, vi), where vi \u2208 1,2,3, ..., K denotes the event type of the i-th event, and ti \u2208 [0, tmax] represents the event occurrence time.\n\u2022 Uniform Noise: Uniform noise refers to each event type having an equal probability of p to transform into any of the other K \u2013 1 classes. Specifically, the dataset with a corruption probability of p means that vi has probability p being corrupted into other K - 1 labels in event point (ti, vi), which is a one-to-K 1 type of label noise."}, {"title": "C Hyperparameter", "content": "Here we show the hyperparameter we used in the experiments.\nD Re-weight Net Algorithm\nWe show the algorithm of Re-weight Net in Algorithm 2."}]}