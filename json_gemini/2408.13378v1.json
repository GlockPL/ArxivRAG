{"title": "DRUGAGENT: EXPLAINABLE DRUG REPURPOSING AGENT WITH LARGE LANGUAGE MODEL-BASED REASONING", "authors": ["Yoshitaka Inoue", "Tianci Song", "Tianfan Fu"], "abstract": "Drug repurposing offers a promising avenue for accelerating drug development by identifying new therapeutic potentials of existing drugs. In this paper, we propose a multi-agent framework to enhance the drug repurposing process using state-of-the-art machine learning techniques and knowledge integration. Our framework comprises several specialized agents: an AI Agent trains robust drug-target interaction (DTI) models; a Knowledge Graph Agent utilizes the drug-gene interaction database (DGIdb), DrugBank, Comparative Toxicogenomics Database (CTD), and Search Tool for Interactions of Chemicals (STITCH) to systematically extract DTIs; and a Search Agent interacts with biomedical literature to annotate and verify computational predictions. By integrating outputs from these agents, our system effectively harnesses diverse data sources, including external databases, to propose viable repurposing candidates. Preliminary results demonstrate the potential of our approach in not only predicting drug-disease interactions but also in reducing the time and cost associated with traditional drug discovery methods. This paper highlights the scalability of multi-agent systems in biomedical research and their role in driving innovation in drug repurposing. Our approach not only outperforms existing methods in predicting drug repurposing potential but also provides interpretable results, paving the way for more efficient and cost-effective drug discovery processes. Code is available https://anonymous.4open.science/r/DrugRepurposeLLM-E0B5/.", "sections": [{"title": "1 INTRODUCTION", "content": "Drug repurposing, also known as drug repositioning, is a strategy for identifying new uses outside the scope of the original medical indication of existing drugs. This approach has gained significant attention due to its potential to reduce the time, cost, and risk associated with drug development (Push-pakom et al., 2019; Chen et al., 2024b; Fu et al., 2022b). With the growing complexity of biological data and the increasing availability of diverse biomedical information sources (Chen et al., 2024a; Wu et al., 2022b), there is a pressing need for innovative computational strategies that can efficiently integrate and analyze these vast datasets (Huang et al., 2021; Lu, 2018).\nRecent advances in artificial intelligence (AI), particularly in machine learning and knowledge graphs (Gyori et al., 2017), have shown great promise in addressing these challenges (Vamathevan et al., 2019). However, the integration of heterogeneous data sources and the effective interpretation of their interrelations remain significant hurdles. To overcome these obstacles, we propose a multi-agent"}, {"title": "2 RELATED WORKS", "content": "The concept of drug repurposing has evolved significantly with the advancements in computational tools, leading to a growing body of literature that explores various methodologies. Here, we highlight key developments in the field that align with our multi-agent system approach.\nMachine Learning in Drug Repurposing. Machine learning techniques have increasingly been applied to drug repurposing, demonstrating significant potential in predicting drug-disease interac-tions (Issa et al., 2021). Similarly, our AI Agent leverages the DeepPurpose toolkit, which has been extensively validated for its efficiency in drug-target interaction (DTI) predictions (Huang et al., 2020).\nKnowledge Graphs for Integrative Analysis. Knowledge graphs have been instrumental in provid-ing a structured way of integrating diverse biological data. For instance, the DRKG, as employed by our Knowledge Graph Agent, integrates data from several sources, including DrugBank (Knox et al., 2024), Hetionet (Himmelstein et al., 2017), and STRING (Szklarczyk et al., 2023), to offer comprehensive insights into possible drug-disease links (Ioannidis et al., 2020). This structured integration facilitates the systematic exploration of potential drug repurposing candidates.\nLiterature Search for Drug Repurposing. The automation of literature review and data extraction using AI tools, particularly large language models (LLMs), has become an essential component of modern drug discovery (Chakraborty et al., 2023). This trend is especially relevant in the field of drug repurposing, where efficient processing of vast amounts of scientific literature is crucial. Recent studies have demonstrated that LLM-based search tools can significantly enhance the efficiency and complexity of queries compared to traditional search engines (Spatharioti et al., 2023). In our framework, we leverage this approach by implementing a Search Agent that utilizes search engines as a data source for the LLM, aligning with current trends in AI-assisted literature review for drug discovery and repurposing.\nMulti-Agent Systems in Biomedical Applications. While individual AI applications have shown promise, the integration of these technologies through a multi-agent system is less explored in the field of drug repurposing. However, similar multi-agent frameworks have been successfully implemented in other areas of biomedical research, such as clinical trials (Yue & Fu, 2024). These studies provide a foundation for the application of multi-agent systems in drug repurposing, suggesting that such frameworks can enhance the predictive accuracy and efficiency of computational drug discovery."}, {"title": "3 METHODS", "content": "Our DrugAgent framework is designed to mimic the collaborative and multidisciplinary nature of drug discovery teams. Each agent in the system is specialized to handle specific aspects of the drug repurposing process, allowing for a more comprehensive and nuanced analysis than traditional single-model approaches."}, {"title": "3.1 OVERVIEW OF DRUGAGENT", "content": "Our proposed system is a conversational multi-agent framework analogous to a specialized research team focused on drug repurposing. Each agent within this system plays a distinct role, mirroring the specialization seen in pharmaceutical research-some focus on machine learning models, others on search-based analysis, and another is dedicated to knowledge graph exploration.\nThe system comprises the following key agents:\n1. A Coordinator Agent that oversees the specialized agents and integrates their findings.\n2. An AI Agent specializing in predicting drug repurposing potential using machine learning models.\n3. A Search Agent focusing on analyzing existing literature and data for repurposing opportunities.\n4. A Knowledge Graph (KG) Agent dedicated to exploring connections between drugs, diseases, and biological pathways.\nTo process natural language inputs and generate responses that are coherent and contextually appro-priate, each agent utilizes large language models. The system's reasoning capabilities are enhanced by incorporating methodologies that allow for step-by-step problem-solving and decision-making.\nFollowing the reasoning process, the system is capable of taking actions such as calculating re-purposing scores, performing literature-based analyses, and querying knowledge graphs for novel drug-disease associations. By integrating this information through a weighted average approach, the system effectively simulates a highly knowledgeable drug repurposing researcher.\nWorking in concert, these agents can deliver precise, explainable assessments of drug repurposing potential in response to user inquiries about specific drugs or diseases. This framework's modular nature allows for easy expansion and refinement of the system's capabilities in the context of drug repurposing research."}, {"title": "3.2 AGENT ROLES AND RESPONSIBILITIES", "content": "The DrugAgent framework integrates a diverse array of specialized agents, each employing the Re-Act (Yao et al., 2022) and LEAST-TO-MOST (Zhou et al., 2022) reasoning methods to meticulously plan their actions. Through the use of advanced search capabilities, access to specialist models, and indexing in databases, these agents can execute a wide range of tasks effectively. Below, we delve into the specific roles and responsibilities assigned to each agent within the system."}, {"title": "3.3 AI AGENT", "content": "Our approach begins with the AI Agent, which utilizes the MPNN_CNN_BindingDB model from DeepPurpose (Huang et al., 2020) to predict potential drug repurposing opportunities. This model combines Message Passing Neural Networks (MPNN) (Gilmer et al., 2017) for processing molecular structures with Convolutional Neural Networks (CNN) for capturing binding site features. It is trained on the comprehensive BindingDB dataset, which contains a wealth of binding affinity data for DTIs.\nThe MPNN_CNN_BindingDB model operates as follows:\n1. The MPNN component processes the molecular graph of the drug, capturing its structural features.\n2. The CNN component analyzes the binding site information of the target protein.\n3. These features are then combined and processed through fully connected layers to predict binding affinity or repurposing potential.\nThe AI Agent's predictions are continually refined through an iterative training and validation process, using cross-validation techniques to ensure accuracy and robustness."}, {"title": "3.4 KNOWLEDGE GRAPH (KG) AGENT", "content": "Concurrently, the Knowledge Graph (KG) Agent employs DGIdb (Cannon et al., 2024), Drug-Bank (Knox et al., 2024), CTD (Davis et al., 2023), and STITCH (Kuhn et al., 2007). From these datasets, we make use of the DTI table and then create the vast drug-gene interaction table. From this, we calculate the number of hops to reach from the drug to the target using the below formula,\n$DTIscore (d, t) = \\begin{cases}0 & \\text{if } d \\& G \\text{ or } t \\& G, \\\\0 & \\text{if } h(d, t) = -1, \\\\1 & \\text{if } h(d, t) = 1, \\\\ln(1+h(d,t)) & \\text{otherwise,}\\end{cases}$ (1)\nwhere d is a drug, t is a target G is a knowledge graph h(d, t) is a number of hops in the shortest path between d and t in G and $ln(\u00b7)$ is a natural logarithm."}, {"title": "3.5 SEARCH AGENT: INFORMATION EXTRACTION FROM BIOMEDICAL LITERATURE", "content": "Parallel to these processes, the Search Agent leverages large language models to automate the extraction of relevant information from biomedical literature, including new findings published in"}, {"title": "3.6 CALLING EXTERNAL TOOLS", "content": "GPT supports calling external tools (e.g., function, database retrieval) to leverage external knowledge and enhance its capability. Specifically, suppose we have a couple of toolkits, GPT's API can automatically detect which tool to use, which serves as glue to connect large language models to external tools. Our system integrates a variety of external data sources and predictive AI models to support the agents' functions.\nData Sources The use of professional datasets is pivotal in ensuring the accuracy and reliability of our agents' information retrieval capabilities."}, {"title": "3.7 DRUG REPURPOSING AGENT", "content": "The predictions from the AI agent are cross-referenced and enriched with data from the Knowledge Graph Agent and validated against findings from the Search Agent. This integrated workflow allows for a dynamic updating mechanism, wherein feedback from the literature and knowledge graph continually refines the predictions. The entire process is supported by a central data hub that manages data consistency and real-time updates, ensuring that all agents have access to the latest and most accurate data available.\nThe final prediction score is calculated in this formula:\n$Smerged = \\alpha Sml + \\beta Ssearch + (1 - \\alpha - \\beta)Skg,$\nwhere $Smerged$ is the merged DTI score, $Sml$ is the machine learning DTI score, $Ssearch$ is the search-based DTI score, $Skg$ is the knowledge graph DTI score, $\\alpha$ is the weight for the machine learning score, $\\beta$ is the weight for the search score, and $(1 - \\alpha - \\beta)$ is the weight for the knowledge graph score. Note that 0 < $\\alpha$ < 1, 0 < $\\beta$ < 1, and $\\alpha$ + $\\beta$ < 1."}, {"title": "3.8 WORKFLOW", "content": "The workflow of our DrugAgent is designed to leverage the strengths of multiple specialized agents to provide comprehensive and accurate DTI scores. The process is structured in several sequential steps, as described below:\nStep 1: Query Initialization and Agent Preparation. The workflow begins with the user input, specifying the drug name, target name, and weighting parameters (alpha and beta). The system initializes four specialized agents: the AI Agent, Search Agent, Knowledge Graph (KG) Agent, and Coordinator Agent. Each agent is configured with specific roles and access to relevant functions and databases.\nStep 2: Task Allocation to Specialist Agents. The Coordinator Agent, acting as the central manager, allocates specific tasks to each specialist agent:"}, {"title": "4 EXPERIMENT", "content": "In our study, we utilized the Kd (dissociation constant) data from the BindingDB database (Liu et al., 2007) as our experimental dataset. BindingDB is a public repository of measured binding affinities, primarily focusing on interactions between proteins considered as drug targets and small, drug-like molecules.\nThe Kd dataset comprises 52,284 DTI pairs, involving 10,665 unique drug-like compounds and 1,413 distinct protein targets. Kd values represent the dissociation constant, which quantifies the propensity of a larger complex to separate (dissociate) into smaller components. A lower Kd value indicates a higher binding affinity between the drug and the target protein.\nOur regression task involved predicting these Kd values given the target protein's amino acid sequence and the drug compound's SMILES string (a line notation for encoding molecular structures and specific instances) (Weininger, 1988). To evaluate our model's performance, we employed three metrics: Mean Squared Error (MSE), R2 Score, and Correlation. These metrics collectively assess the accuracy of our predictions and the model's capacity to capture the underlying patterns in DTIs."}, {"title": "4.2 PROCEDURE", "content": "Each agent in our DrugAgent system was tasked with specific roles, as outlined in the Methods section. The AI Agent applied machine learning models to calculate the DTI score, the Search Agent analyzed literature data to derive a DTI score based on published research, and the KG Agent evaluated DTIs using graph-based techniques. The Coordinator Agent then synthesized these findings into a comprehensive DTI prediction. We conducted experiments to assess the accuracy of the merged DTI scores and the consistency of predictions across different methods."}, {"title": "4.3 IMPLEMENTATION DETAILS", "content": "In this section, we provide detailed descriptions of the implementation processes to enhance the reproducibility of our study.\nRole Assignment to Agents Each agent within our multi-agent framework is designated a specific role, which is integrated directly into the LLM's system prompt for clarity and focus. For instance, the role of the AI Agent is defined as follows:\nThis role definition is crucial as it guides the LLM to prioritize responses based on the assigned expert domain, leveraging the model's inherent capability to focus more acutely on instructed tasks than on general information.\nDefining External Tools External tools are defined in a structured format to facilitate their inte-gration and usage within the LLM environment. These definitions are crafted in Python functions, specifying the function name, parameters, and return types. Key examples include:\n1. AI Agent: Utilizes machine learning models for DTI scoring.\n2. Search Agent: Performs web-based information retrieval to gather relevant DTI data.\n3. KG Agent: Leverages a knowledge graph (KG) for graph-based DTI scoring.\nThis structured approach allows for the direct execution of function calls within the system, providing detailed responses, including the function name and arguments. These responses enable the retrieval of results in a structured manner. (See Appendix A for detailed implementations of these agents)\nEnhanced Score Integration To improve the model's prediction capabilities, we incorporate a weighted integration method within the Coordinator Agent. This method, known as score merging, aids in synthesizing the outputs from different agents into a comprehensive DTI prediction. The integration is performed using predefined weights ($\\alpha$ and $\\beta$) to balance the contributions of each prediction method:\n$merged\\_dti\\_score = \\alpha * ai\\_score + \\beta * search\\_score + (1 - \\alpha - \\beta) * kg\\_score$\nHere, ai score, search_score, and kg_score represent the DTI scores from the AI Agent, Search Agent, and KG Agent, respectively. The weights $\\alpha$ and $\\beta$ are adjustable hyperparameters that determine the relative importance of each score in the final prediction. This approach enhances the accuracy of the model's outputs and its ability to leverage diverse prediction methods for more robust drug repurposing predictions.\nThese implementation strategies collectively ensure that each component of our multi-agent system operates effectively and that the integration between different agents and external tools is seamless, fostering an environment conducive to robust, reproducible research in drug repurposing prediction."}, {"title": "4.4 CASE STUDY", "content": "We analyze three realistic case studies focusing on drug repurposing for Topotecan, targeting different proteins: TOP1, SLFN11, and SLC26A4 (Tables 1, 2, and 3). Topotecan inhibits TOP1, preventing DNA religation and causing cell death in rapidly dividing cancer cells (Schmidt et al., 2001). While SLFN11 is not the direct target of Topotecan, it has been associated with Topotecan efficacy in some studies (Raynaud et al., 2023). In contrast, SLC26A4, a gene encoding pendrin (an anion exchanger protein), is not directly related to Topotecan's mechanism of action or efficacy. These cases represent a spectrum of DTIs, from well-established to potentially novel and unlikely connections. For each case, the user initiates the process by providing the drug name (Topotecan) and the target protein. The Coordinator Agent then decomposes the complex problem into three subproblems, handled by specialized agents: the AI Agent, the Search Agent, and the Knowledge Graph Agent. Case"}, {"title": "5 DISCUSSION", "content": "Our study presents a novel multi-agent system for drug repurposing that integrates machine learning, knowledge graphs, and literature search. This approach offers more robust predictions by leveraging diverse data sources and analytical methods.\nThe system's strength lies in its collaborative approach, which combines each agent's specialized capabilities to evaluate complex DTIs comprehensively. The weighted integration method allows for flexible adjustment of different prediction methods, enhancing overall accuracy.\nHowever, limitations exist. The system still relies on human expertise for initial setup, limiting its scalability. It also lacks autonomous knowledge updating capabilities to keep pace with rapidly evolving pharmacological research. Furthermore, the current model does not adequately account for individual patient characteristics or drug combination effects.\nFuture research should focus on:\nIntegrating autonomous knowledge updating mechanisms to keep the system current with the latest pharmacological research;\nEnhancing the system's ability to predict drug efficacy and handle complex drug combinations;\nExpanding the system's applicability to a broader range of pharmaceutical tasks by incorporating existing models:\nAdapting the framework for Drug Response Prediction using models like drGAT (Inoue et al., 2024b);\nExtending to DTI prediction tasks, leveraging the system's existing knowledge graph and AI capabilities;\nDeveloping a more flexible prompting system to allow easy adaptation to various pharmaceu-tical tasks without major architectural changes, such as drug synergy prediction (Huang et al.,"}, {"title": "A APPENDIX", "content": "WEIGHT OPTIMIZATION FOR SCORE INTEGRATION\nTo determine the optimal weights for our score integration process, we employed a simple optimization method. We utilized a dataset comprising 3,347 drug-target pairs, each containing scores from our three specialized agents (AI, Knowledge Graph, and Search) along with corresponding ground truth interaction scores from the BindingDB dataset. We formulated the weight optimization as a constrained least squares problem:\n$arg min ||Ax - b||2 \\quad \\text{subject to} \\sum_i x_i = 1 \\quad x_i \\geq 0, \\quad i=1,2,3$\nwhere A is the matrix of agent scores, x is the weight vector we are optimizing, and b is the vector of ground truth scores. The optimization was performed using non-negative least squares (NNLS) followed by Sequential Least Squares Programming (SLSQP) to ensure the weights sum to 1. This approach allows us to determine the relative importance of each agent's score in predicting the true DTI strength. The resulting weights were then used in our merged DTI score calculation:\n$Smerged = x1SAI + x2SKG + x3 SSearch,$\nwhere $x1, x2, and 13$ represent the optimized weights for the AI Agent, Knowledge Graph Agent, and Search Agent, respectively. This data-driven weight optimization approach ensures that our final predictions leverage the strengths of each agent while accounting for their relative performance on a large set of known DTIs."}, {"title": "A.2 DETAILED EXTERNAL TOOL DEFINITIONS", "content": "This appendix provides a comprehensive overview of the implementation details for our three key agents: AI Agent, Search Agent, and KG Agent. Each agent plays a crucial role in our multi-agent system for drug repurposing prediction."}, {"title": "\u0391.2.1 \u0391\u0399 AGENT IMPLEMENTATION", "content": "The AI Agent utilizes machine learning models to predict DTIs. Its core function, get_ml_dti score, takes a drug name and a target name as input and returns a float value representing the predicted interaction score.\nThis implementation uses a pre-trained MPNN_CNN model from the BindingDB dataset. It first retrieves the target protein sequence and loads the drug data. If the specified drug is found, it performs virtual screening to predict the interaction score."}, {"title": "A.2.2 SEARCH AGENT IMPLEMENTATION", "content": "The Search Agent leverages web-based information to gather relevant data about DTIs. It consists of several functions that work together to perform a Google search, parse the results, and calculate a DTI score based on the search findings."}, {"title": "A.2.3 KG AGENT IMPLEMENTATION", "content": "The KG Agent utilizes a knowledge graph to derive DTI scores based on the structural relationships between drugs and targets in the graph.\nThe KG Agent loads a pre-constructed knowledge graph and calculates the DTI score based on the shortest path between the drug and target nodes in the graph. A direct connection yields the highest score, while more distant connections result in lower scores, calculated using a logarithmic scale.\nThese detailed implementations demonstrate how each agent contributes unique insights to the overall DTI prediction task. The AI Agent provides predictions based on learned patterns from large datasets, the Search Agent incorporates up-to-date information from web sources, and the KG Agent leverages structured knowledge representations. By combining these diverse approaches, our system aims to produce more robust and comprehensive drug repurposing predictions."}]}