{"title": "Field Matching: an Electrostatic Paradigm to Generate and Transfer Data", "authors": ["Alexander Kolesov", "Manukhov Stepan", "Vladimir V. Palyulin", "Alexander Korotin"], "abstract": "We propose Electrostatic Field Matching (EFM), a novel method that is suitable for both generative modeling and distribution transfer tasks. Our approach is inspired by the physics of an electrical capacitor. We place source and target distributions on the capacitor plates and assign them positive and negative charges, respectively. We then learn the electrostatic field of the capacitor using a neural network approximator. To map the distributions to each other, we start at one plate of the capacitor and move the samples along the learned electrostatic field lines until they reach the other plate. We theoretically justify that this approach provably yields the distribution transfer. In practice, we demonstrate the performance of our EFM in toy and image data experiments.", "sections": [{"title": "1. Introduction", "content": "The basic task of generative modeling is to learn a transformation between two distributions accessible by i.i.d. samples. The typical scenarios considered are noise-to-data and data-to-data. These are usually referred to as the unconditional data generation and data translation, respectively.\nPhysics is often at the heart of the principles of generative modeling. The first attempt to link generative models and physics was made in Energy-Based models. They parameterize data distributions using the Gibbs-Boltzmann distribution density and generate data through simulation of Langevin dynamics.\nDiffusion Models (DM) are a widely popular generative models' class which is inspired by nonequilibrium thermodynamics. The diffusion models consist of forward and backward stochastic processes. While the forward process corrupts the data via injection of Gaussian noise, the backward process reverses the forward process and recovers the data.\nPoisson Flow Generative Models (PFGM) use ideas from the electrostatic theory for the data generation process, recovering an electric field between a hyperplane of the data and a hemisphere of large radius.\nBoth DM and PFGM use physical principles to corrupt data, simplifying the data distribution to a tractable one. As a result, they are only used directly for noise-to-data tasks.\nMore recently, modifications of DM have appeared that can learn diffusion in a data-to-data scenario. Diffusion Bridge Matching (BM) is an SDE-based method that recovers the continuous-time Markovian process between data distributions. Flow matching (FM) is the limiting case of BM that learns ODE-based transformation between distributions.\nHowever, there is no method based on electrostatic theory that can be applied to data-to-data translation tasks.\nContributions. We propose and theoretically justify a new paradigm for generative modeling called Electrostatic Field Matching (EFM). It is based on the electrostatic theory and suitable for both noise-to-data and data-to-data generative scenarios. We provide proof-of-concept experiments on low- and high-dimensional generative modeling tasks."}, {"title": "2. Background and Related Works", "content": "To understand the physics behind the electrostatic field matching method, let us give some basic background from standard Maxwell's 3D-electrostatics and then generalize it to the case of D dimensions. Information on Maxwell's electrostatics can be found in any electricity textbook, for instance (Landau & Lifshitz, 1971, Chapter 5)."}, {"title": "2.1. Basic physics", "content": null}, {"title": "2.1.1. MAXWELL'S ELECTROSTATICS\u00b9", "content": "Let the point charge $q \\in \\mathbb{R}$ be located at the point $x' \\in \\mathbb{R}^3$. At the point $x \\in \\mathbb{R}^3$ it creates an electric field $E(x) \\in \\mathbb{R}^3$ equal to:\n$E(x) = \\frac{1}{4\\pi} \\frac{q (x - x')}{||x \u2013 x'||^3}$ (1)\nNote that the electric field\u00b2 is a potential field, i.e., it can be expressed as a gradient of a scalar function $\\varphi(x)$:\n$E(x) = -\\nabla \\varphi(x)$. (2)\nThe function is called the electric field potential. From (1), and $\\nabla = \\frac{\\partial}{\\partial x}$, we obtain that the potential of the point charge is equal:\n$\\varphi(x) = \\frac{q}{4\\pi ||x \u2013 x'||}$ (3)"}, {"title": "The superposition principle.", "content": "If point charges $q_1, q_2,..., q_n$ are located at points $X_1, X_2, ..., X_N$, they create independent fields $E_1 (x), E_2(x), ..., E_N (x)$, and potentials $\\varphi_1 (X), \\varphi_2(X), ..., \\varphi_N (x)$ at a given point $x \\in \\mathbb{R}^3$. All these charges together create the following field and potential:\n$E(x) = \\sum_{n=1}^{N} E_n(x) = \\sum_{n=1}^{N} \\frac{q_n (x-x_n)}{4 \\pi ||x - x_n||^3}$, (4)\n$\\varphi(x) = \\sum_{n=1}^{N} \\varphi_n(x) = \\sum_{n=1}^{N} \\frac{1}{4 \\pi} \\frac{q_n}{||x - x_n||}$\nIn the general case we are dealing with a continuously distributed charge $\\rho(x)$. Then the superposition principle can be written as:\n$E(x) = \\int \\frac{1}{4\\pi} \\frac{(x-x')}{||x \u2013 x'||^3} \\rho(x')dx'$, (5)\n$\\varphi(x) = \\int \\frac{1}{4\\pi} \\frac{1}{||x \u2013 x'||} \\rho(x')dx'$.\nNote that the charge distribution $\\rho(x)$ can have values greater than zero (positive charge) or less than zero (negative charge).\nAn electric field strength line is a curve x(t) $\\in\\mathbb{R}^3$, $\\tau \\in [a, b] \\subset\\mathbb{R}$ whose tangent to each point is parallel to the electric field at that point. In other words:\n$\\frac{dx(\\tau)}{d\\tau} = E(x)$, where $\\tau\\in [a, b] \\subset\\mathbb{R}$. (6)\nThe electrostatic field satisfies two theorems which define the most important properties of these lines.\nGauss's theorem (Landau & Lifshitz, 1971, \u00a731). For any closed two-dimensional surface $\\partial M$, which bounds the set $M\\subset\\mathbb{R}^3$, the electric field flux is equal to the total charge enclosed by this surface:\n$\\oint_{\\partial M} E\\cdot ds = \\int_{M} \\rho(x)dx$. (7)\nIn particular, it follows from Gauss's theorem that the electric field line must begin at a positive charge (or at infinity) and end at a negative charge (or at infinity). The lines cannot simply terminate in a space where there are no charges.\nTheorem of electric field circulation.(Landau & Lifshitz, 1971, \u00a726) For any closed loop $l$ the electric field circulation is equal to zero:\n$\\oint_{l} E\\cdot dl = 0$. (8)"}, {"title": "2.1.2. D-DIMENSIONAL ELECTROSTATICS", "content": "The generalization of electrostatic equations for higher dimensions appears in discussions related to the influence of extra dimensions on the physics. The generalization modifies Eqs. (7) and (8) by replacing $\\mathbb{R}^3$ with $\\mathbb{R}^D$ and replacing dimensionality 2 of $\\partial M$ to $D \u2013 1$ in the Gauss's theorem. The definitions in Eqs. (2), (6) and the superposition principle remain unchanged. The differences affect only the explicit expressions for the potential and the electric field.\nThe potential at the point $x \\in \\mathbb{R}^D$ of a point charge $q$, which is located at $x' \\in \\mathbb{R}^D$ equals to:\n$\\varphi(x) = \\frac{1}{(D-2)S_{D-1}} \\frac{q}{||x \u2013 x'||^{D-2}}$, (9)\nwhere $S_{D-1}$ is the surface area of an ($D \u2013 1$)-dimensional sphere with radius 1. Then the field of the point charge is:\n$E(x) = -\\nabla \\varphi(x) = \\frac{q}{S_{D-1}} \\frac{x - x'}{||X - X'||^{D}}$. (10)\nThe field of a distributed charge $\\rho(x)$ can be obtained by the principle of superposition as in Eq. (5) for 3D case:\n$E(x) = \\frac{1}{S_{D-1}} \\int \\frac{x - x'}{||x - X'||^{D}} \\rho(x')dx'$. (11)\nTogether Gauss's theorem and the circulation theorem in a D-dimensional space ensure the following principal characteristics of electric field lines:\n(i) Electric field lines cannot terminate in points where there are no charges;\n(ii) For a system having zero total charge ($\\int \\rho(x)dx = 0$), electric field lines almost surely start at positive charge and end at negative charge;\n(iii) There are no electric field lines that form closed loops.\nFor convenience of the reader, these properties are proven in Appendix A"}, {"title": "2.2. Poisson Flow Generative Model (PFGM)", "content": "The first attempt to couple electrostatic theory and generative modeling is proposed by (Xu et al., 2022; 2023). The authors work with a D-dimensional data distribution. They embed this distribution into (D + 1)-dimensional space by applying the transformation $x \\rightarrow \\tilde{x} = (x, 0)$, i.e., place the data x on a hyperplane z = 0 in (D + 1)-dimensional space. The data distribution is interpreted then as a positive electrostatic charge distribution.\nThe intuition of the method is that the charged points x in the hyperplane z = 0 generate the electric field E(\u00b7) which behaves at infinity as the field of a point charge. If a point charge is placed inside a sphere $S_\\infty$ with an infinite radius, then the flux density $P_\\infty(\\cdot)$ through the surface of the sphere is distributed uniformly. For the simplicity the authors consider the hemisphere $S^+_\\infty$ (Fig. 4b). Then:\n$P_\\infty() = U(S_\\infty^+)$. (12)\nThus, the electric field lines define the correspondence between uniformly distributed charges on the surface of the hemisphere $S_\\infty^+$ and the original data samples from $P_0(x)$ in the hyperplane z = 0.\nIf a massless point charge is placed in the electric field E(\u00b7) with field lines directed from $P_0(\\cdot)$ to $P_\\infty(\\cdot)$, then the charge moves along the lines to $P_\\infty(\\cdot)$. This movement transforms the data samples from the complex distribution to the simple distribution on the hemisphere along the field lines. The corresponding inverse transformation generates the data samples from uniformly distributed samples on the hemisphere. The inverse map is a movement along these field lines in the backward direction and is defined by the following ODE with electric field -E(\u00b7).\n$\\frac{dx(\\tau)}{dt} = -E(x)$. (13)\nTo recover the electric field E(\u00b7) in the extended (D + 1)-dimensional space, the authors propose to approximate it with a neural network $f_\\theta(\\cdot) : \\mathbb{R}^{D+1} \\rightarrow \\mathbb{R}^{D+1}$.\nFirst, they compute the ground truth electric field E(X) empirically at a set of arbitrary (D + 1)-dimensional points x inside the hemisphere $S^+_\\infty$ through samples from $P_0(\\cdot)$ according to Eq. (11). Second, the electric field is learned at x by minimizing the difference between the predicted $f_\\theta (X)$ and the ground-truth E(X). Having learned the electric field E(\u00b7) in the (D + 1)-dimensional space, they simulate the ODE (13) with initial samples from $P_\\infty(\\cdot)$ until the spatial coordinate z reaches 0. Finally, they get samples $x_T \\sim P_0(\\cdot)$, where T is the end time of the ODE simulation."}, {"title": "3. Electrostatic Field Matching (EFM)", "content": "This section introduces Electrostatic Field Matching (EFM), a novel generative modeling paradigm applicable to both noise-to-data and data-to-data generation grounded in electrostatic theory. The \u00a73.1 gives an intuitive description of the method. The \u00a73.2 gives a theoretical formulation of the method and the main theorem. In the \u00a73.3, the learning and inference algorithms are formulated."}, {"title": "3.1. Intuitive explanation of the method", "content": "Our idea is to consider distributions as electric charge densities. One could assign positive charge values to the first distribution and negative charges to the second one, i.e., the charge density follows the distributions up to a sign. We then place these distributions on two D-dimensional planes at distance L from each other (Fig. 1). This will produce an electric field with lines starting at one density and finishing at another. We prove theorem 3.1 that movement along the lines allows one to make a transition from one distribution to another almost surely."}, {"title": "3.2. Formal theoretical justification", "content": "Let $P(x^+)$ and $Q(x^-), x \\in \\mathbb{R}^D$ be two data distributions. Let us assign to the first distribution a positive charge $q^+(x^+) = P(x^+)$, and to the second distribution a negative charge $q^-(x^-) = -Q(x^-)$. Note that the charge distributions are normalized to $\\int q^+(x^+)dx^+ = 1, \\int q^-(x)dx^- = -1$ and therefore the total charge of the system is zero.\nLet us now place these distributions in (D+1)-dimensional space. The new point in this space can be written as:\n$(X_1, X_2, ..., X_D, z) = (x, z) = x \\in \\mathbb{R}^{D+1}$. (14)\nWe place $q^+ (x^+)$ in the hyperplane $z = 0$, and $q^-(x^-)$ in the hyperplane $z = L(Fig. 1)$. One can think of it as a (D+1)-dimensional capacitor. The distributions would be written as:\n$q^+(x) = q^+(x, z) = q^+(x) \\delta(z)$,\n$q^-(x) = q^-(x, z) = q^-(x) \\delta(z - L)$, (15)\nwhere $\\delta(.)$ denotes Dirac delta function.\nThe electric field produced at the point $x \\in \\mathbb{R}^{D+1}$ between plates will consist of two summands:\n$E(x) = E_+(x) + E_-(x)$, (16)\nwhere $E_+(x)$ and $E_-(x)$ are the fields defined by the $q^+(x^+)$ and $q^-(x)$, respectively. The exact expression for these fields is given by Eq. (11) with replacement of D by D + 1:\n$E_+(x) = \\int \\frac{1}{S_{D}} \\frac{x-x}{\\mid x-x^\\prime\\mid^{D+1}}q(x)dx$. (17)\nFinally, let us define the map between the distributions $T: supp(P(x^+)) \\rightarrow supp(Q(x^-))$ using electric field lines. Consider a point $x^+ = (x^+,0)$ in the support of the first distribution. Let us denote the field line $x(\\tau), (\\tau\\in [a,b])$ starting at this point. From the properties of electric field lines formulated in Section 2.1.2, it must end almost surely at the point $x^- = (x^-, L)$ in the support of the second distribution $q^-(x)$ with negative charge. Thus, $x(a) = (x^+, 0) = x^+, x(b) = (x^-, L) = x^-$. Using this, we define $T(x^+) = x^-$.\nThen, for this map we prove the following theorem:\nTheorem 3.1 (Electrostatic Field Matching). Let $x^+$ is distributed over $P(x^+)$. Then $x^- = T(x^+)$ is distributed over $Q(x^-)$ almost surely:\nIf $x^+ \\sim P(x^+) \\Rightarrow T(x^+) = x^- \\sim Q(x^-)$. (18)\nIn other words, the map T defined by electric field lines does transfer $P(x^+)$ into $Q(x^-)$ indeed, as we had intended.\nThe proof of the theorem is given in Appendix B."}, {"title": "3.3. Learning and Inference Algorithm", "content": "We consider samples $X^+ = \\{x_1^+,...,x_N^+\\}$ and $X^- = \\{x_1^-, ..., x_M^-\\}$ distributed by $P(x^+)$ and $Q(x^-)$, respectively. We then extend the space to (D + 1) by placing the first sample at z = 0 and the second sample at z = L. Thus $X^+ \\rightarrow \\tilde{X}^+ = \\{(x_1^+, 0), ..., (x_N^+,0)\\} = \\{x_1^+,...,x_N^+\\}$ and $X^- \\rightarrow \\tilde{X}^- = \\{(x_1^-, L), ..., (x_M^-, L)\\} = \\{x_1^-, ..., x_M^-\\}$\nTraining. To recover the electric field E(\u00b7) in (D + 1)-dimensional points between the hyperplanes, we approximate it with a neural network $f_\\theta(\\cdot) : \\mathbb{R}^{D+1} \\rightarrow \\mathbb{R}^{D+1}$. We sample the value t from the uniform distribution U(0, L) and take two random samples $x^+$ and $x^-$. Then, we get a new point x between the planes as follows:\n$x = tx^+ + (1 -t)x^- + \\tilde{e}$, (19)\nwhere random $\\tilde{e}$ is sampled by using the following scheme. Sampling the noise e from $N (0, \\sigma^2 I_{D+1 \\times D+1})$ and calculating the Euclidean norm $||e||_2$, we multiply this norm by a unit Gaussian vector and get $\\tilde{e}$:\n$\\tilde{e} = \\frac{e}{||e||_2}||e||_2 m,  m \\sim N(0, I_{D+1 \\times D+1})$. (20)\nInference. Having learned the vector field E(\u00b7) in the extended space with $f_\\theta(.)$, we simulate the movement between hyperplanes to transfer data from $P(x^+)$ to $Q(x^-)$. For this, we run an ODE solver for Eq. (13).\nOne needs a right stopping time for the ODE solver. In order to find it, we follow the idea of (Xu et al., 2022) and use an equivalent ODE solver with x evolving with the extended variable z:\n$d(x, z) = (\\frac{dx}{d\\tau}, \\frac{dz}{d\\tau}) = (E_x(x)E_z^{-1}(x), 1)\\frac{dz}{d\\tau}$, (22)\nwhere we denote $E(X) = (E_x(x), E_z(x))$. In the new ODE (22), we replace the time variable \\tau with the physically meaningful variable z, allowing explicit start (z = 0) and end (z = L) conditions. We start with samples from $Q(x^-)$, i.e., when z = L. Then, we arrive at the data distribution $P(x^+)$ when z reaches 0 during the ODE simulation.\nAll the ingredients for training and inference in our method are described in Algorithm 1, where we summarize the learning and inference procedures."}, {"title": "4. Experimental Illustrations", "content": "In this section, we demonstrate the proof-of-concept experiments with our proposed EFM method. We show a 2-"}, {"title": "4.1. Gaussian to Swiss Roll Experiment", "content": "An intuitive first test to validate the method is to transfer between distributions whose densities can be visualized for comparison. We consider the 2-dimensional zero-centered Gaussian distribution with the identity covariance matrix as $P(x^+)$ and the Swiss Roll distribution as $Q(x^-)$, see their visualizations in Figs. 5a and 5b, respectively.\nTo show the effect of hyperparameter L in our EFM method, we do two experiments. In the first one, the samples from $Q(x^-)$ are placed on the hyperplane L = 6 (see Fig. 5c), while in the second one, we use L = 30 (see Fig. 5d). We show the learned trajectories of samples' movement along the electrostatic field in Figs. 7a and 7b, respectively.\nWhen L is small, the electric field lines are rather straight, see Fig. 7a. The learned electric field $f_\\theta(\\cdot) \\approx E(\\cdot)$ allows one to accurately perform the distribution transfer, see Fig. 5c.\nWhen the distance L between the hyperplanes is large, the learned map $T(x^+)$ recovers the target density $Q(x^-)$ poorly (see Fig. 5d). Presumably, this is because it is more difficult to perfectly recover the electrical field $E(.)$ by a neural network between plates with a large distance L."}, {"title": "4.2. Image-to-Image Translation Experiment", "content": "Here we consider the image-to-image translation task for transforming colored digits 3 to colored digits 2. The data is based on the conventional 32 \u00d7 32 MNIST images dataset but the digits are randomly colored. We consider unpaired translation task, i.e., there is no pre-defined correspondence between digits. In other words, one colored digit 3 can be mapped to many possible digits 2 and vice versa.\nWe place colored digits 3 on the left hyperplane z = 0 and colored digits 2 on the right plate z = 10. We learn the electric field E(\u00b7) between plates and show how the translation happens, see Fig. 6. For more examples of input-translated pairs, see Fig. 9.\nFor comparison, we add the results of the translation of the the popular ODE-based Flow Matching (FM) method. The key difference between our method and FM is that FM matches to a time-conditional transformation (velocity), whereas our method matches to a space-conditional transformation (electric field). Interestingly, FM does not always accurately translate the shape and color of the initial digits 3, see Fig.9c."}, {"title": "4.3. Image Generation Experiment", "content": "We also consider the task of generating 32 \u00d7 32 colored digits 2 from the MNIST dataset. For this task, we place white noise on the left hyperplane z = 0 and colored digits 2 on the right plate z = 30. We learn the electric field E(\u00b7) between the plates and demonstrate recovering the distribution $Q(x^-)$. Also, we show the sampling trajectories for our EFM (see Fig. 8). We qualitatively see that our method recovers the target distribution $Q(x^-)$ of colored digits 2 (see Fig. 10b).\nAlso, for completeness and comparison, we show the results of generation of PFGM method which is also based on the electrostatic theory, see Fig. 10c. We run the PFGM method with hyper parameters, which are described in Appendix C."}, {"title": "5. Discussions & Limitations", "content": "Influence of dimensionality. In high dimensions, our algorithm may require working with small numbers. Specifically, the multiplier 1/||x \u2013 x'||^D in the electric field formula Eq. (11) may produce values comparable to machine precision as the dimensionality of D increases. As a result, the training of our method may become less stable.\nThe impact of inter-plate distance L on the field estimation. The larger the inter-plate distance L is, the more curved and disperse the electric field lines become, see, e.g., Fig. 7b. Also, with an increase of this distance the electric field has to be accurately learned in a larger volume between the plates. A careful selection of the hyperparameter L may be important when applying our method.\nDefining the optimal training volume. Our training approach involves sampling points $x^+$ and $x^-$ from the distributions, interpolating them with Eq. (19) and noising them with Eq. (20). This allows us to consider an intermediate point x between the plates (19) to learn the electrostatic field. There may exist smarter schemes to choose such points; it is a promising question of further work."}, {"title": "6. Impact Statement", "content": "This paper presents work whose goal is to advance the field of Machine Learning. There are many potential societal consequences of our work, none of which we feel must be specifically highlighted here."}, {"title": "A. Properties of D-dimensional electric field lines", "content": "In this Appendix the basic properties of electric field lines in D-dimensions are formulated and proved.\nDefinition A.1. The flux of electric field with a strength E through an area dS is called d$\\Phi$ = E \u00b7 dS. The flux through a finite surface is defined as an integral:\n$\\Phi = \\oint_{\\Sigma} E = \\int\\int E. ds$. (23)\nDefinition A.2. Consider a closed piecewise smooth curve $\\Gamma$ placed in an electric field. A field line passes through each point of this contour. The set of these lines is called a stream surface or a stream tube.\nLemma A.3. The electric field flux is conserved along a stream surface if there are no charges inside that surface.\nProof. Consider an arbitrary stream tube $\\partial M$ (Fig. 11,(a)). Note that the normal for closed surfaces is directed outwards. Near the right end of the tube, the normal and the electric field are co-directional, and near the left boundary, they have opposite directions. Therefore, $\\Phi_1 = -\\Phi_1$. It is required to prove that $\\Phi_1 = \\Phi_2$.\nThe full flux is a sum of fluxes through the ends of the tube and through its lateral surface:\n$\\Phi_{full} = \\Phi_1 + \\Phi_2 + \\Phi_{lat}$. (24)\nThe flux through the lateral surface, by the definition of a stream tube, must be zero: $\\Phi_{lat} = 0$. Thus, $\\Phi_{full} = \\Phi_1 + \\Phi_2 = \\Phi_2 \u2013 \\Phi_1$.\nFrom the Gauss's theorem (7):\n$\\Phi_{full} = \\oint_{\\partial M} E. dS = \\int_M \\rho(x)dx = 0$. (25)\nFrom where it follows that $\\Phi_1 = \\Phi_2$.\nCorollary A.4. An electric field line cannot terminate in empty space.\nLemma A.5. Consider a charge distribution with density $\\rho(x)$ on an D-dimensional hyperplane embedded in $\\mathbb{R}^{D+1}$. Let dS denote an element of D-dimensional surface area. For a stream tube with area dS as its base, the electric flux through this tube remains constant and is given by:"}, {"title": null, "content": "d$\\Phi = \\frac{\\rho(x)dS}{2}$ (26)\nProof. Consider a stream tube in form of a cylinder and the charged surface dividing it in two equal halves. The axis of the cylinder is perpendicular to the surface. The flux through this surface will consist of three contributions: The flux through the upper base d$\\Phi_1$ = EdS, the flux through the lower base d$\\Phi_2$ = EdS = d$\\Phi_1$ = d$\\Phi$, and the flux through the lateral surface d$\\Phi_{lat} = 0$:\nd$\\Phi_{full} = d\\Phi_1 + d\\Phi_2 + d\\Phi_{lat} = d\\Phi + d\\Phi + 0 = 2d\\Phi$. (27)\nFrom the Gauss's theorem (7):\nd$\\Phi_{full} = dq_{in} = \\rho(x)dS$. (28)\nHence, near the surface the electric field flux is d$\\Phi$ = $\\frac{1}{2}\\rho(x)dS$. Since the flux is conserved along the stream tube (lemma A.3), d$\\Phi$ = $\\frac{1}{2}\\rho(x)dS$ at any distance from the surface, not only infinitely close to the plane."}, {"title": null, "content": "Lemma A.6. Let us assume that a surface $\\Sigma$ can be seen at a solid angle $\\Omega$ from a point charge $q_0$. The electric field flux through this surface is equal to:\n$\\Phi = \\frac{q\\Omega}{S_{D-1}}$ (29)\nProof. Divide $\\Sigma$ into small surface elements dS. The total flux is the integral over the entire surface, $\\Phi = \\int_{\\Sigma} d\\Phi$. By the definition of flux (A.1), and according to Eq. (10) we have:\nd$\\Phi = E dS = E dS cos \\alpha = EdS = \\frac{q_0}{S_{D-1}} \\frac{dS}{r^{D-1}} = \\frac{q_0 d\\Omega}{S_{D-1}}$. (30)\nThen after integration over the solid angle, we obtain (29).\nLemma A.7. Let there be an electrically neutral system ($\\int \\rho(x)dx = q_+ - |q_-| = 0$) bounded in space. Then the electric field lines must begin at positive charges and end at negative charges, except perhaps for the number of lines of zero measure."}, {"title": null, "content": "Proof. Let us assume the opposite and consider the electric field lines that start at the positive charges of the system and end at infinity (if there are no such lines, consider the lines that come from infinity and end at the negative charges). Let us denote the size of the system by $l = max_{x,y \\in supp(q)} (|x \u2013 y|)$. Consider moving a distance $L \\gg l$ along these lines from the initial charge system. Let $\\xi = l/L \\ll 1$. We define the surface $\\Sigma$ such that it is intersected by the lines. Using the multipole decomposition of the electric field (Landau & Lifshitz, 1971, \u00a740-41) with a first-order accuracy, we obtain:\n$E|\\Sigma = E^{(0)} + E^{(1)} + ... = E_{point} + O(\\frac{\\xi}{LD-2})$, (31)\nwhere $E^{(i)}$ is the i-th order of multipole expansion, $E^{(0)} = E_{point}$ is the field of a point charge. At large distance from the system the contribution of the point charge becomes the major one. All other contributions can be neglected. And therefore, in the limiting case $\\xi \\rightarrow 0, L \\rightarrow \\infty$ the formula (29) can be used. Since there is no limit on the increase of L, one can achieve an approximation accuracy as high as one needs.\nThen $\\Phi = \\int_{\\Sigma} E \u00b7 dS = (q_+ \u2212 |q_\u2212|)\u03a9/S_{D\u22121}(1) = 0 by convention. Hence,\n$\\int_{\\Sigma} E dS = 0$. (32)\nTherefore, if the lines that start (end) at the charges of the system and end (start) at infinity exist, their measure is zero and they do not create any flux."}, {"title": "Lemma A.8. Electric field lines cannot form closed loops", "content": "Proof. Assume that there exists a closed loop l along which $\\oint E \u00b7 dl > 0$. At the same time, by virtue of the circulation theorem (8) $\\oint E. dl = 0$.Since the two expressions contradict to each other there can be no such thing."}, {"title": "B. Proof of the Electrostatic Field Matching theorem", "content": "Theorem B.1 (Electrostatic Field Matching). Let $x^+$ be distributed over $P(x^+)$. Then $x^\u2212 = T(x^+)$ is distributed over $Q(x^\u2212)$ almost surely:\nIf $x^+ \u223c P(x^+) \u21d2 T(x^+) = x^\u2212 \u223c Q(x^\u2212)$. (33)\nProof. Let $\\{x_i^+\\}_{i=1}^n$ be a set of points distributed over the distribution $q^+(x^+) = q^+(x^+)\u03b4(z) = P(x^+)\u03b4(z)$. We denote the electric field lines starting at these points as $\\{x_i(\\tau)\\}_{i=1}^n, \u03c4 \u2208 [a, b] \u2282 \\mathbb{R}$. From the properties of electric field lines"}, {"title": null, "content": "they must end on the support of the second distribution $q^\u2212(x^\u2212) = q^\u2212(x^\u2212)\u03b4(z \u2212 L) = Q(x^\u2212)\u03b4(z \u2013 L)$, that is:\n$\\frac{dx}{d\\tau} = E(Xi), x_i(a) = x^+, x_i(b) = x^-$, (34)\nwhere $E(x)$ is the field between plates.\nLet us denote by $\\hat{Q}_n(x^\u2212) = \\frac{n\u2019(x\u2212)}{n}\u03b4(z \u2212 L)$ the effective distribution of points $\\{x_i^\u2212\\}_{i=1}^n$ from the second data set, which were obtained by moving along electric field lines. Then we have to prove that $\\hat{Q}_n(x^\u2212)$ converges to the true distribution $Q(x^\u2212)$ with probability 1 (almost surely):\n$P(lim_{n \\rightarrow \\infty} \\hat{Q}_n = Q) = 1$, (35)\nwhere P(\u00b7) is probability of a given event."}, {"title": null, "content": "Let us select an element of D-dimensional volume $dS$ on the first distribution. Let $dn$ be the number of points $x \u2208 \\mathbb{R}^D$ that are in this volume. Consider an electric field stream tube with $dS$ as a base. Let $ds\u2019$ be the element of the volume into which $dS$ has passed, and let $dn\u2019$ be the number of points $x \u2208 \\mathbb{R}^D$ which have entered into this volume.\nAn effective distribution $\\hat{Q"}]}