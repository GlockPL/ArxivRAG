{"title": "Solar Filaments Detection using Active Contours Without Edges", "authors": ["Sanmoy Bandyopadhyay", "Vaibhav Pant"], "abstract": "In this article, an active contours without edges (ACWE)-based algorithm has been proposed for the detection of solar\nfilaments in Ha full-disk solar images. The overall algorithm consists of three main steps of image processing. These are\nimage pre-processing, image segmentation, and image post-processing. Here in the work, contours are initialized on the solar\nimage and allowed to deform based on the energy function. As soon as the contour reaches the boundary of the desired\nobject, the energy function gets reduced, and the contour stops evolving. The proposed algorithm has been applied to few\nbenchmark datasets and has been compared with the classical technique of object detection. The results analysis indicates that\nthe proposed algorithm outperforms the results obtained using the existing classical algorithm of object detection.", "sections": [{"title": "1. Introduction", "content": "Solar filaments are one of the important features on the surface of the Sun. These filaments are large regions of very dense,\ncool gas, held in place by magnetic fields and generally sit above magnetic neutral lines, outlining the demarcation of\nnegative and positive magnetic fields on the solar surface [1, 2]. Since they are cooler than their surroundings, they appear\ndark [1]. They usually appear long and thin above the chromosphere and are primarily observed in the H-alpha and Calcium\nK lines in the solar chromosphere. These solar features can be very dynamic objects, which change their appearance in only a\nfew hours and last for a few weeks or months, looping hundreds of thousands of miles into space [3, 4].\n\nIf the magnetic field is destabilized, the filaments can erupt, e.g., as flares, coronal mass ejections (CMEs), and the plasma\nstored in them is ejected into space [4, 5, 6]. Every so often these filaments blow off from the surface of the Sun can cause\nspace weather impacts on Earth in case their ways intersect [2]. These in turn raise the event of major interplanetary\ndisturbances, and geomagnetic storms. Thus for better understanding of the changes in solar activities and operational space\nweather forecasts there arises the need to analyze the location, properties, and time evolution of solar filaments, which in turn\nrequires the need for proper and automated identification of the filaments.\n\nIn literature there exists several automated methods of solar filaments detection. Gao et al. [7] used thresholding and\nregion-based techniques to detect filaments in full-disk solar images. Candidate filament pixels were identified through\nthresholding, and a region growing method was applied to merge these pixels into filament areas [7]. Shih and Kowalski [8]\nproposed a method involving local and global thresholding to distinguish dark regions from the solar disk background. They\napplied directional morphological filtering to extract elongated shapes. Qu et al. [9] employed the stabilized inverse diffusion\nequation (SIDE) followed by adaptive thresholding for segmenting filament regions in solar images. Subsequently, a support\nvector machine (SVM) classifier was used on the segmented image to distinguish filaments from Sunspots. Atouma et al.\n[10] used adaptive local thresholding for filament segmentation. The segmented filaments were then evaluated by comparing\nthe resulting image with a manually constructed synoptic map. Despite several advantages of thresholding-based methods, the\nselection of the optimal threshold value remains a challenging task [11]. Fuller and Aboudarham [12] introduced a filament\ndetection method using seed selection and region growing technique. However, the success of the method depends on the\nproper selection of seeds point in the solar images. In recent decades, advancements in artificial neural network (ANN) and\ndeep learning techniques have led to the adoption of methodologies such as fully convolutional neural network (FCN) u-net\n[13], Mask R-CNN [14], Conditional Convolutions for Instance Segmentation [15], and YOLOv5 [4] for filament\nidentification. However, the success of these supervised neural network approaches hinges on rigorous training, necessitating\nextensive datasets for effective model performance. In the recent past K-means clustering technique had been used by\nPriyadarshi et al. [16] for the identification of the filaments. However the method had been applied on Kodaikanal Solar\nObservatory (KoSO) suncharts.\n\nIn order to overcome the aforementioned issue associated with the solar filaments detection and to detect the filaments region\naccurately, in this paper an active contour without edges (ACWE) [17] based algorithm has been introduced. The overall\nproposed algorithm of filament detection consists of three major steps of computer vision, these are image pre-processing,\nimage segmentation and image post-processing. The major contribution in the paper is,\n\n\u2022\tApplication of active contour without edges (ACWE) based technique for the detection of the filament region in\nfull-disk solar image."}, {"title": "2. Proposed Method of Filaments Detection", "content": "The proposed ACWE-based algorithm has been applied to Ha full-disk solar images for the detection of solar filaments. This\ndetection process encounters two major issues. Firstly, the Ha solar images used in the experiment exhibit an inhomogeneous\nintensity distribution throughout, evident in the first row of Figure 1. Secondly, the ACWE method used in this detection\nprocess can be prone to local minima, potentially leading to false boundary detections. In order to address these issues in this\nwork of filament detection three image pre-processing methodologies have been applied. In the first step image inpainting has\nbeen carried out, which involves filling in part of an image using information from the surrounding area [18]. The general\nequation of image inpainting can be written as,\n\n$f^{n+1}(x, y) = I^{n}(x, y) + \\Delta tI_t(x, y), \\forall(x, y) \\epsilon \\Omega$ (1)\n\nwhere n denotes the inpainting time, (x, y) indicate image pixel coordinate, $\\Delta t$ is the rate of improvement and $I_t(x, y)$\ndenotes the update of image $I^{n}(x, y)$ [19]. In the equation (1), the term $\\Omega$ represents the region to be inpainted. The notion\n$I^{n+1}(x, y)$ denotes the improved version of $I^{n}(x, y)$, which is given by;\n\n$\\overleftarrow{I}^n(x, y) = \\delta I^n(x, y) \\cdot N(x, y)$, (2)\n\nwhere $I^n(x, y)$ is the information to be propagated, $N(x, y)$ denotes the propagation direction and $\\delta I^n(x, y)$ represents the\nchange in the information. This image inpainting in this work has been done to remove the white patches from the solar\nimage so that the contour doesn't get stuck around the white region in the image. In the second step, the inpainted image was\nenhanced using the logarithmic transformation, in order to map a narrow range of low pixel intensity input values to a wide\nrange of resultant values [20]. Mathematically, the output image obtained after performing log transform is given by,\n\n$I_1(x, y) = r \\log(1 + I^{n+1}(x, y));$ (3)\n\nwhere r is a scaling constant given by $255/\\log(1+I^{n+1}_{max} (x, y))$, and $I^{n+1}_{max} (x, y)$ is the maximum pixel value in the inpainted\nimage. In the last stage of pre-processing, the enhanced image has been sharpened using the formulation given by [21],\n\n$I(x, y) = 5I_1(x, y) \u2013 [I_1(x + 1,y) + I_1(x \u2212 1, y) + I_1(x, y + 1) + I_1(x, y \u2013 1)].$ (4)\n\nNow, with a view to segment out the filament regions from the pre-processed image ACWE technique has been applied. The\nACWE algorithm focuses on finding the region of interest (RoI) boundary by utilizing an active contour approach. The active\ncontour is dynamically evolved by minimizing the value of the energy function using the level set method. A contour is\ninitialized within the boundary of the image and then evolves as the numerical partial differential equations are iteratively\nsolved. Finally, it converges to the RoI boundary. The energy function in the ACWE model is given by:\n\n$F(c_1, c_2, C) = \\mu \\cdot Length(C) + \\nu \\cdot Area(inside(C)) + \\lambda_1 \\int_{inside(C)} |I(x, y) - c_1|^2 dxdy $\n\n$\\qquad + \\lambda_2 \\int_{outside(C)} |I(x, y) - c_2|^2 dxdy, $\n(5)\n\nwhere C is the initialized curve, and the constants $c_1, c_2$ are the averages of I inside and outside the curve Crespectively. The\nterms $\\mu, \\nu, \\lambda_1$ and $\\lambda_2$ are the weight parameters associated with the energy function. After segmenting the image using\nACWE, post-processing tasks were performed. Connected components in the segmented image were analyzed using\narea-based morphological operations, and components failing to meet the threshold area value were removed. This step aimed\nto eliminate redundant regions identified during the segmentation process. The major advantage of using ACWE for detecting\nthe filaments regions in solar image is that the method has the capability to detect and preserve the boundaries of the Rol,\neven in noisy images. [17]."}, {"title": "3. Results and Discussions", "content": "The experiment of filaments detection using the proposed algorithm were conducted on Ha full-disk solar images captured by\nthe Big Bear Solar Observatory (BBSO) during year 2013, dataset as used by Zhu et al. [13]\u00b9. The dataset contain the\nground-truth maps corresponds to the Ha full-disk solar images, this in turn ease the visual and quantitative analysis of the\nperformance of the proposed method. The parameter u used in equation (5) is kept at 0.003, with a view to detect small as\nwell as big filaments regions. The value assigned to the terms $\\lambda_1$ and $\\lambda_2$ are 1.000001 and 0.1 respectively. This has been\ndone with a view to give more weight to the foreground regions in the image and extract out the dark filament regions as the\nbackground. The final output obtained using the proposed method is shown in the last row of Figure 1.\n\n3.1 Visual Analysis\n\nFrom the last two rows of Figure 1 it can be visualized that the proposed method is capable of detecting most of the filaments\nregions properly compared to the classical Otsu thresholding and K-mean clustering based methods of detection. In this case\nthe classical method of detection fails because it tries to find out the filament by separating foreground and background class\nbased on the optimal intensity value which mainly gets stuck near the average value of image pixel intensities. At the same\ntime while comparing the results with the ground-truth images, it can be seen from Figure 1., that the proposed method has\neither identified a few small redundant regions as filaments or is unable to detect the filaments present near the solar\nboundary. This is due to the limitation of ACWE of getting stuck at the local minima.\n\n3.2 Quantitative Analysis"}, {"title": "4. Conclusion", "content": "In this study, an active contour algorithm without edges was implemented for detecting filament regions in Ha full-disk solar\nimages. Preprocessing techniques such as image inpainting, log transformation, and sharpening were applied to prepare the\nimages for segmentation using ACWE. The proposed algorithm has notable advantages: it accurately identifies Rol\nboundaries even in noisy images and operates effectively without requiring a large image database like deep learning\napproaches do. However, the execution time of the algorithm (near about 29.8128 sec) is higher than the compared algorithms\nof detection. Future efforts will concentrate on enhancing its computational efficiency, potentially by refining the\npreprocessing stages. Additionally, aim to analyze solar filaments in extreme ultraviolet images from observatories like\nAditya-L1 and Solar Dynamics Observatory in future."}]}