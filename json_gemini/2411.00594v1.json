{"title": "Deep learning-based auto-contouring of organs/structures-at-risk for pediatric upper abdominal radiotherapy", "authors": ["Mianyong Ding", "Matteo Maspero", "Annemieke S Littooij", "Martine van Grotel", "Raquel Davila Fajardo", "Max M van Noesel", "Marry M van den Heuvel-Eibrink", "Geert O Janssens"], "abstract": "This study aimed to develop a computed tomography (CT)-based multi-organ segmentation model for delineating organs-at-risk (OARs) in pediatric upper abdominal tumors and evaluate its robustness across multiple datasets.\nIn-house postoperative CTs from pediatric patients with renal tumors and neuroblastoma (n=189) and a public dataset (n=189) with CTs covering thoracoabdominal regions were used. Seventeen OARs were delineated: nine by clinicians (Type 1) and eight using TotalSegmentator (Type 2). Auto-segmentation models were trained using in-house (Model-PMC-UMCU) and a combined dataset of public data (Model-Combined).\nPerformance was assessed with Dice Similarity Coefficient (DSC), 95% Hausdorff Distance (HD95), and mean surface distance (MSD). Two clinicians rated clinical acceptability on a 5-point Likert scale across 15 patient contours. Model robustness was evaluated against sex, age, intravenous contrast, and tumor type.\nModel-PMC-UMCU achieved mean DSC values above 0.95 for five of nine OARs, while spleen and heart ranged between 0.90 and 0.95. The stomach-bowel and pancreas exhibited DSC values below 0.90. Model-Combined demonstrated improved robustness across both datasets. Clinical evaluation revealed good usability, with both clinicians rating six of nine Type 1 OARs above four and six of eight Type 2 OARs above three. Significant performance differences were only found across age groups in both datasets, specifically in the left lung and pancreas. The 0\u20132 age group showed the lowest performance.\nA multi-organ segmentation model was developed, showcasing enhanced robustness when trained on combined datasets. This model is suitable for various OARs and can be applied to multiple datasets in clinical settings.", "sections": [{"title": "Introduction", "content": "Neuroblastomas and Wilms tumors are two of the most common pediatric abdominal solid tumors, representing 6% and 5% of childhood cancers, respectively [1]. Approximately 25% of Wilms tumor patients [2] and 64% of neuroblastoma patients [3] require radiotherapy in their treatment.\nRadiotherapy relies on accurately delineating organs-at-risk (OARs) to minimize the dose to healthy tissues/organs. Typically, OAR delineation is performed on computed tomography (CT). The procedure is manual, time-consuming [4], and prone to inter-observer variability [5,6].\nRecently, advancements in image processing and computational capacity, mainly through deep convolutional neural networks (CNNs) and dedicated hardware, have resulted in accurate and fast OAR auto-segmentation [7\u20139], leading to time savings during delineation [9], a reduction in inter-observer variability and differences in dose inconsistencies in clinical trials [10]. Numerous studies have focused on developing auto-segmentation models capable of delineating abdominal OARs from adult CTs [7,9,11,12], demonstrating good clinical acceptability for most OARs [12].\nHowever, while significant advancements have been made in auto-segmentation on adults, advancements in children remain limited [13\u201315]. To our knowledge, a comprehensive model tailored for pediatric upper abdominal cases that meets clinical needs has yet to be developed. Furthermore, previous works have indicated that models trained exclusively on adult data tend to underperform on pediatric datasets, highlighting the need for models specifically developed using pediatric data [13,14]."}, {"title": "Materials and methods", "content": "This study investigates the performance of deep learning models on two datasets: (1) an in-house dataset from the Princess M\u00e1xima Center and UMC Utrecht (PMC-UMCU) and (2) a public dataset from Children's Wisconsin (PedSeg dataset) [16]. Both datasets contain pediatric CTs of thoracoabdominal regions, with patient demographics and imaging details summarized in Table 1 and age distribution provided in the Supplementary material (Figure S.1)."}, {"title": "PMC-UMCU dataset", "content": "The dataset includes CTs performed between March 2015 and July 2023 at the UMCU for radiotherapy planning in a national cohort of pediatric patients with a renal tumor or neuroblastoma diagnosed at the PMC. All patients provided informed consent for the Princess M\u00e1xima Center Biobank procedure (Netherlands Trial Register NL7744, IRB approval number MEC-2016-739). After excluding eleven patients with missing annotations for more than four OARs, the PMC-UMCU dataset contained 80 patients with renal tumors and 102 patients with neuroblastoma, including seven patients with repeated imaging in the context of a second course of radiotherapy. In total, 189 postoperative CTs were included.\nWe collected delineations for seventeen OARs: nine for clinician-made delineations and used for the radiotherapy planning (Type 1 OARs), while eight for delineations obtained with TotalSegmentator [7] (Type 2 OARs). Clinician-made contours were delineated by one of the two expert pediatric radiation oncologists in renal tumors or neuroblastoma [20]. Type 1 OARs include the spleen, lung (L+R), kidneys (L+R), heart, pancreas, and stomach-intestine-bowel (labeled \"stomach-bowel\"). For the heart, pancreas, and stomach-bowel, where more than 10% of cases had missing delineations (Figure S.2), TotalSegmentator was used to complement the missing delineations. For Type 2 OARs, all labels were generated by TotalSegmentator for the vertebrae, spinal cord (spinal canal), aorta abdominal, inferior vena cava, autochthonous muscles (L+R), and iliopsoas muscles (L+R) when clinical labels were unavailable.\nIntersections between closely situated anatomical structures occasionally resulted in overlapping voxels. To manage these overlays, structures were in the following order: spleen, kidneys, heart > pancreas, liver > stomach-intestine-bowel> lungs. Additionally, Type 1 OARs were prioritized over Type 2 due to their manual, clinician-based annotations, which were hypothesized of higher quality."}, {"title": "PedSeg dataset", "content": "The original dataset [16] contained 359 cases and was filtered to exclude patients with missing structures or slice counts outside the range of 80-400. From the 289 remaining cases, 189 CTs were randomly selected. Like the PMC-UMCU data, the annotations of the stomach, small intestine, and large intestine were combined into a single structure labeled \"stomach-bowel.\"\nFor Type 2 OARs, the spinal canal's original delineations remained, while delineations for other structures were generated using the TotalSegmentator.\nThe supplementary material (Figures S.3-S.6) includes examples of CTs and OAR delineations from the two datasets."}, {"title": "Model and evaluation metric", "content": "We used the automatic self-configuring framework nnUNet for model development [8], employing both 3D low-resolution (3D lowres) and 3D full-resolution (3D fullres) UNet architectures without ensembling strategies. Images were resampled to axial, sagittal, and coronal spacings: 3.12 mm, 1.59 mm, 1.59 mm (lowres) and 2.0 mm, 0.78 mm, 0.78 mm (fullres). Patch sizes were set to (axial, sagittal, coronal) 64x192x160 (fullres) and 80x160x160 voxels (lowres). Each model was trained for 1000 epochs, and the best-performing model was selected as the final model at the end of training. The default post-processing strategy of nnUNet was employed, using the validation set to decide whether to remove all but the largest connected component of each class. The hyperparameters used for all models are available on our GitHub repository (https://github.com/MMianyong/-PedAbdSeg-).\nDice similarity coefficient (DSC), mean surface distance (MSD), and 95% Hausdorff distance (HD) were used to assess the segmentation accuracy for Type 1 organs. For the stomach-bowel structure, where intestinal regions were not wholly delineated, metrics were calculated solely for slices where the structure was present in the clinical contours, which we consider the ground truth. In renal tumor patients who had undergone nephrectomy, the false positive rate (FPR) was calculated to account for absent predicted kidneys. OARs without ground truth delineations were excluded from the evaluation."}, {"title": "Study design", "content": "The study consists of four parts (Figure 1): first, we built and evaluated a model using only PMC-UMCU data, then expanded it to a combined PMC-UMCU and PedSeg dataset. The best model was selected between the single dataset and combined dataset models for clinical evaluation. Finally, the model's robustness across different conditions was assessed."}, {"title": "Single dataset model training", "content": "The PMC-UMCU dataset was chosen to identify the best auto-segmentation model architecture. The dataset was split at the patient level into representative subsets of 132 CTs for training, 21 for validation, and 36 for testing. The repeatability of the results is reported in Table S.1."}, {"title": "Combined dataset model training", "content": "The PedSeg dataset was split into 132:21:36 for training, validation, and testing, respectively. The sets were combined with the PMC-UMCU set to create a dataset with 264 CTs for training and 42 for validation. The best-performing architecture from 2.3.1 was trained on the combined dataset (Model-Combined) and PedSeg dataset (Model-PedSeg). Comparisons were made by evaluating predictions from Model-Combined, Model-PMC-UMCU, and Model-PedSeg on PMC-UMCU and PedSeg test data."}, {"title": "Clinical evaluation", "content": "The best-performing model from the evaluation from Section 2.3.2 was used for independent clinical validation. Model output from fifteen patients from the PMC-UMCU test set were randomly selected for review by two pediatric radiation oncologists (GJ, RDF). Each OAR, when present, was rated using a 5-point Likert scale, and the final mean score of each OAR was used to determine clinical usability. The inference time of the best-performing model was also reported."}, {"title": "Robustness of the model", "content": "The best-performing model was evaluated for robustness against sex (male vs. female), tumor type (renal vs. neuroblastoma), use of IV (with vs. without contrast), and age group. Patients were divided into four age groups for age-dependent analyses to ensure adequate sample sizes: 0-2, 3-4, 5-6, and \u22657. A 5-fold cross-validation on the combined 378 scans from PMC-UMCU and PedSeg, was performed to have a sufficiently large sample. Five different models were trained using a random split of 64:16:20 for training, validation, and testing. The Wilcoxon rank-sum test was applied to compare pairs of groups, except for the IV subgroup, due to its small sample size. A Bonferroni correction was applied, with corrected p-values < 0.05 indicating significant differences."}, {"title": "Results", "content": null}, {"title": "Single dataset training", "content": "We developed and evaluated models on PMC-UMCU data using two architectures, 3D fullres and 3D lowres. Across the evaluation metrics for all OARs, no significant differences in performance were observed between the two architectures, with the 3D fullres resulting in the best average performances. Thanks to the highest DSC (\u2191) and lowest HD95 or MSD (\u2193) for most OARs (Table S.1), fullres was chosen as the preferred architecture.\nThe fullres model showed strong performance, with mean DSC values above 0.95 for the kidneys, liver, and lungs, and between 0.90 and 0.95 for the spleen and heart. The pancreas (0.70\u00b10.11) and stomach-bowel (0.85\u00b10.07) had mean DSC values below 0.90. The FPR for kidney predictions was 6/14 in 3D lowres and 3/14 in the 3D fullres.\nCompared to TotalSegmentator, the 3D fullres model demonstrated higher mean DSC scores, with significant differences observed for all OARs (Figure S.8). Differences in mean DSC were around 0.01 for the liver and lungs, 0.01\u20130.1 for the spleen and pancreas, and 0.10\u20130.15 for the stomach-bowel and kidneys."}, {"title": "Combined dataset training", "content": "To compare models trained on data from combined datasets versus uncombined datasets, we found that models trained on a single dataset generally performed well on their dataset but were less robust on other datasets. For instance, Model-PMC-UMCU performed significantly worse across all OARs on PedSeg, while Model-PedSeg showed the poorest performance for the left kidney, heart, and lungs on PMC-UMCU.\nIn contrast, Model-Combined demonstrated greater robustness across both datasets (Figure 3). Its performance was comparable to models trained on datasets, with no significant differences and all differences in mean DSC within 0.04 (Table S.3). The only significant difference was observed for the left lung on PedSeg, where Model-Combined showed a 0.04 improvement in mean DSC. Additionally, in PMC-UMCU nephrectomy cases, the FPR decreased to 2/14."}, {"title": "Clinical evaluation", "content": "Model-Combined was selected for clinical evaluation due to its better robustness. The average inference time, including post-processing, was 64.5 seconds per patient, using an Intel Xeon Gold 6240 CPU at 2.60 GHz, 251 GB of RAM, and a Tesla V100 GPU with 32 GB. Nine of the fifteen patients evaluated had neuroblastoma, and six had renal tumors with only one remnant kidney. Prediction examples are shown in Figure 4, S.9, and S.10.\nFor Type 1 OARs, all organs-except the heart, pancreas, and stomach-bowel-received average scores above four from both raters, indicating suitability for clinical use (Table S.4). The heart and pancreas were rated above three, with the largest disagreement for the pancreas (3.87\u00b10.74 vs. 5\u00b00). The stomach-bowel scored (3.07\u00b10.26 vs. 2.80\u00b10.86) near the borderline of clinical usability.\nFor Type 2 OARs, both raters agreed the spinal canal scored above four, and the autochthon(L+R), iliopsoas muscles(L+R), and vertebrae scored above three. Vena cava inferior was rated below two and deemed unusable. There was disagreement on the aorta-abdominal (1.47\u00b1 0.94 vs. 3.00\u00b11.61). Despite these differences, all Type 1 OARs except for the stomach-bowel and Type 2 OARs except for the vena cava inferior and aorta-abdominal received scores above three, demonstrating clinical utility for most OARs."}, {"title": "Model robustness", "content": "The model showed no significant differences in most OARs by sex (in both PMC-UMCU and PedSeg) or tumor types (in PMC-UMCU) (Figures S13-S15). Using IV resulted in higher mean DSC for most OARs at both datasets (Figure S.16, S.17). Age-related variations were observed, with distinct patterns between the two datasets. In PMC-UMCU, significant age-dependent differences were found only in the left lung and pancreas (Figure 5), while in PedSeg, significant age-related differences were observed across all OARs except the bowel-intestine (Figure S.12). These findings suggest that the model's performance may vary with patient age, an important consideration for its clinical use. For the left lung, both datasets showed increasing mean DSC with age, with significant differences between younger and older groups.\nThe pancreas showed increasing performance with age in PedSeg, while in PMC-UMCU, it had the highest mean DSC in the 3-4 age group. In both cohorts, significant differences were observed between the 0-2 age and older groups, with the 0-2 group consistently showing lower DSCs."}, {"title": "Discussion", "content": "In this study, we developed and evaluated a deep-learning CT-based auto-segmentation model for the surrounding OARs in pediatric patients undergoing upper abdominal radiotherapy for renal tumors and neuroblastoma. The nnUNet model was trained on the Dutch national cohort of pediatric patients undergoing neuroblastoma and renal tumors radiotherapy, showing improved performance when combined with a public pediatric dataset. Clinical evaluation confirmed that most type 1 OARs were clinically acceptable, and most type 2 OARs were clinically usable.\nIt is necessary to develop pediatric-specific models: even when a model is trained in a small dataset (n=10), it outperformed TotalSegmentator in our in-house pediatric cohort (Table S.2).\nFew studies have investigated auto-segmentation for pediatric upper abdominal OARs, and none have developed or shared a single model capable of segmenting all OARs specifically for upper abdominal target volumes applicable for pediatric radiotherapy [13\u201315].\nComparing the mean DSCs reported in other pediatric studies for type 1 OARs (excluding the stomach-bowel), our model's performance aligns with studies using deep learning-based models on PedSeg and internal datasets [13\u201315]. Pancreas segmentation remains challenging across studies, with DSCs ranging from 0.73 to 0.79 [13\u201315]. Our model achieved a DSC of 0.73 on internal testing and 0.81 on PedSeg. The lower performance may be due to the pancreas's low contrast with surrounding structures, the lack of peri-pancreatic fatty tissue in young children, and large anatomical variability.\nOne of the main challenges in our research was using real-world data from clinical practice contours without modification. In our in-house dataset, we encountered missing labels or incomplete delineations for some patients. Differences in organ definitions between datasets or between the clinic and TotalSegmentator, e.g., for the stomach-bowel, posed further challenges. Despite these limitations, we successfully developed a model resulting in clinically acceptable delineations for most type 1 OARs. This suggests that even without extensive review, clinical contours can still help develop models intended for clinical use. For type 2 OARs, where annotations were unavailable, TotalSegmentator helped generate labels, resulting in 6/8 clinically usable structures. However, some OARs, such as the aorta and inferior vena cava, remained challenging. OARs that did not achieve optimal clinical evaluation may require additional manual correction. Incorporating active learning could improve the efficiency of contour corrections [22].\nPediatric datasets are rare, and our results indicate that a sample size of about 50 cases is sufficient to build the model in our in-house dataset. A further increase in sample size did not improve performance. Training on data from two heterogeneous cohorts improved the model's robustness without significantly reducing performance at either dataset compared to individually trained models. Generally, data privacy remains a barrier to sharing patient information across institutions. Federated learning, which enables model training without direct data sharing, may offer a promising solution for developing more robust segmentation models[23]. We will explore federated learning to strengthen the model's robustness in future work.\nThe model's robustness was evaluated across patient subgroups, with age-dependent variations observed. PMC-UMCU showed fewer OARs with age-related performance differences, possibly due to the distribution of patients skewing towards younger ages compared to PedSeg. Across all age groups, the 0\u20132 age group remained the most challenging, with significantly lower DSCs than older groups, likely due to less sample size, greater anatomical variability, and difficulties in imaging younger patients. Despite using a stratified validation approach, limited sample sizes may have reduced the statistical power of the tests, particularly for the patients older than seven years in the PMC-UMCU) cohort. Similarly, the small sample size of groups with or without IV in two datasets prevented statistical testing.\nOur models demonstrate good clinical usability based on PMC-UMCU data, making, on average, predictions in less than 1 minute compared to 1 to 2 hours estimated for manual delineation for a single patient. We will hold a workshop to evaluate the model and the time needed to revise its output among multiple observers. Our model is shared online and can be applied to other centers for pediatric abdominal radiotherapy, promising to facilitate radiotherapy planning."}, {"title": "Conclusion", "content": "A multi-organ segmentation model for deep learning-based auto-contouring of OARs in pediatric upper abdominal radiotherapy was developed using data from a single and combined dataset. Incorporating an additional dataset improved the model's robustness. Clinical evaluation revealed high performance for most OARs. The model is publicly available, facilitating the adoption of automatic OAR delineation in pediatric radiotherapy."}, {"title": "Declaration of Generative Al and Al-assisted technologies in the writing process", "content": "While preparing this work, the author (M. Ding) used ChatGPT-4 for grammar and spelling revision. After using this tool/service, the author(s) reviewed and edited the content as needed and take(s) full responsibility for the publication's content."}]}