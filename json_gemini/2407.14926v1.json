{"title": "TraveLLM: Could you plan my new public transit route in face of a network disruption?", "authors": ["Bowen Fang", "Zixiao Yang", "Shukai Wang", "Xuan Di"], "abstract": "Imagine there is a disruption in train 1 near Times Square metro station. You try to find an alternative subway route to the JFK airport on Google Maps, but the app fails to provide a suitable recommendation that takes into account the disruption and your preferences to avoid crowded stations. We find that in many such situations, current navigation apps may fall short and fail to give a reasonable recommendation. To fill this gap, in this paper, we develop a prototype, TraveLLM, to plan routing of public transit in face of disruption that relies on Large Language Models (LLMs). LLMs have shown remarkable capabilities in reasoning and planning across various domains. Here we hope to investigate the potential of LLMs that lies in incorporating multi-modal user-specific queries and constraints into public transit route recommendations. Various test cases are designed under different scenarios, including varying weather conditions, emergency events, and the introduction of new transportation services. We then compare the performance of state-of-the-art LLMs, including GPT-4, Claude 3 and Gemini, in generating accurate routes. Our comparative analysis demonstrates the effectiveness of LLMs, particularly GPT-4 in providing navigation plans. Our findings hold the potential for LLMs to enhance existing navigation systems and provide a more flexible and intelligent method for addressing diverse user needs in face of disruptions.", "sections": [{"title": "I. INTRODUCTION", "content": "Imagine visiting New York City on April 3, 2024 when severe flooding and high winds disrupted transportation. While planning your route, you also learn that the Columbus Circle station exit is too windy and want to avoid it. Unfortunately, apps like Google Maps lack options to navigate around disruptions with a different subway route or integrate with alternative services, for instance, shared Citi bike. This underscores the need for an intelligent, flexible system to address diverse user needs and seamlessly incorporate new transportation services.\nLLMs, such as GPT-4 [1], Claude 3 [2], and Gemini [3], have demonstrated remarkable capabilities in understanding and generating human-like text [4], [5], [6], as well as reasoning and planning across various domains, including autonomous driving [7], [8]. By leveraging the natural language understanding capabilities of LLMs, users can input specific requirements, preferences, and real-time information about the situation at hand. For instance, they might say, \"I finished my work at WTC and headed home at Cathedral Parkway. West Manhattan is flooded and 1/2/3/A/B/C/D are not in operation so I want to take alternative paths.\u201d The LLM can then process this input, interpret the context and generate a customized route that takes into account the specific needs of the users.\nIn this paper, we introduce the use of LLMs as a tool for customized route planning during disruption. Our objectives are twofold. First, we aim to investigate the potential of LLMs in incorporating multi-modal user-specific queries and constraints into path recommendation. We designed test cases under different scenarios to evaluate whether LLMs can succeed in various weather conditions, emergency events, and when adding new transportation services. Second, we compare the performance of major state-of-the-art LLMs, assessing their ability to generate accurate and personalized route recommendations.\nThe main contributions of this paper are as follows:\n1) We propose a novel LLM-based approach for cus-tomized route planning when facing disruption, ca-pable of incorporating diverse user preferences, situ-ational factors, and alternative transportation options.\n2) We design a set of test cases to evaluate the perfor-mance of our approach under various scenarios, includ-ing different weather conditions, emergency events, and the introduction of new transportation services.\n3) We conduct a comparative analysis of state-of-the-art LLMs to assess their effectiveness in generating accurate route recommendations."}, {"title": "II. METHODOLOGY", "content": "In this section, we will introduce our method TraveLLM for generating route recommendation in face of network disruptions.\n\nA. TravelLLM: Customized Route Planning Using LLM Agents in face of network disruptions\nWe have 4 parts of information as input to generate a route. The first input is the instruction, which serves to regularize the output format and set route constraints. This instruction can include requirements such as minimizing the number of stops, reducing walking distance, or prioritizing certain modes of transportation. The second is a description of the available transportation services. We focus primarily on the subway system and utilize subway maps from official website as our main source of information. Different transportation services are given by separate map images. The third is a description of user's current situation and specific demands. This includes the user's starting location, destination, and any preferences or limitations they may have. The fourth is a description of the disruptions that could potentially impact the recommended route.\nThe format of these inputs can vary between natural language and images, depending on the nature of the in-formation. For instance, we use natural language for the instructions and user's situation and demands, while the transportation services are represented through map images. By taking these inputs, we use LLMs to generate a route recommendation in the form of natural language. The LLMS consider the provided constraints, the user's specific de-mands, and the available transportation services to create a route recommendation.\nTo obtain the inputs, we begin by setting format guidance and constraints in the instructions, such as minimizing the number of stops or reducing the overall walking distance. For the transportation services, we consider subway as main service method, and use subway map from official websites. The instruction and transportation service descriptions are provided at the beginning of the session and serve as the knowledge base for the LLMs. The user's situation and demands, as well as any relevant information of disruption, are generated by the user and must include, at a minimum, the starting location and destination.\nWe illustrate our method in Figure 1. The proposed system consists of two main components: an LLM Planner and an LLM Summary. The process begins with a user query, which includes information such as the start and destination locations, events and constraints, and additional instructions. This query serves as the input to the LLM Planner, which generates a detailed plan based on the provided context.\nTo enhance the interpretability and usability of the plan-ner's output, the system incorporates an LLM Summary component. This module takes the detailed plan generated by the LLM Planner and creates a concise, standardized summary that captures the key aspects of the route, mainly the transportation methods and intermediate stations. By presenting the plan in a structured format, it is easier for downstream tasks to process the route output.\nThe reasons for introducing LLM Summary, instead of directly generating structured plan with LLM Planner, are twofold. The first is that the performance of generated plan is affected, while the second is that in such way it is harder to satisfy the given format. We will discuss in more detail in the following Ablation study section."}, {"title": "B. Prompt Engineering", "content": "The performance of LLM Planner and LLM Summary relies on prompt engineering. For LLM Planner:\n1) We define the role for LLM Planner to be an alternative path-finding agent who needs to access its knowledge base(e.g. subway map) every time before providing recommendations.\n2) We specify the goal as considering safety first and then efficiency. For instance, it considers passing through a station marked as dangerous, even staying on train, as a safety risk to be avoided.\n3) To further guide the agent's behavior and decision-making process, we append additional instructions to the user prompt. These instructions can include specific preferences, constraints, or contextual information that the agent should take into account when generating recommendations.\nWhile for LLM Summary, we define the role to be a route summary expert, with the goal of generating standardized format given a natural language text. We also give instruc-tions that no other texts should be generated, as the output is directly used by programming language. Additionally, we observed that LLM Summary agent tends to ignore some general term describing the transportation method, for instance, walk. As a result, it failed to include part of the plan and reach the destination. Therefore, we give examples of acceptable transportation service terms, which alleviate the phenomenon.\nBy prompt engineering, we can steer the LLM Planner's behavior and ensure that it generates alternative paths that prioritize user safety and efficiency. And we can also enable LLM Summary to generate required format with no addi-tional texts, which makes it easier for downstream tasks."}, {"title": "III. EXPERIMENTS", "content": "A. Implementation\nFor LLM Planner, We compare 3 LLMs: GPT-4, Claude-3 Opus, and Gemini Pro 1.0.\n1) GPT-4: GPT-4 is a large multimodal model developed by OpenAI, building on the success of its predecessors in the GPT series. GPT-4 is capable for accepting image and text inputs and responses in a speed of 100 billion tokens per second.\n2) Claude 3 Opus: Claude 3 Opus is one of the advanced models in the Claude 3 series developed by Anthropic. Opus stands out as the most powerful model in the series.\n3) Gemini Pro: Gemini Pro 1.0 is developed by Google and is publicly available. Gemini Pro 1.0 is able to perform image understanding and reasoning.\nBy comparison, we aim to identify the most effective model for generating high-quality navigation plans that meet user needs and preferences. For LLM Summary, we utilize GPT-4 to generate concise and structured summaries of the navigation plans produced by the LLM Planner. Our method rely on prompt engineering and all experiments are conducted without further training or fine-tune."}, {"title": "B. Description of Scenarios", "content": "Table I presents scenarios designed to test the capabil-ities and limitations of LLMs in providing route recom-mendations under various conditions. The scenarios cover different aspects of transportation systems, such as the type of subway line (north-south, cross-river, or cross-town), the presence of extreme weather or emergency events, and the availability of additional transportation services like buses and Citi Bikes. Each scenario is associated with a specific take-home message that highlights the key aspect being tested, for instance, the LLMs' ability to reason based on general positions, physical constraints, or the impact of events on regular routes. We also explore the LLMs' capacity to incorporate new information provided as images, understand and utilize markings, and optimize routes based on given constraints. Furthermore, the inclusion of a scenario involving the DC subway system aims to investigate whether the LLMs' performance is specific to NYC due to potentially richer text data available for the city."}, {"title": "C. Metrics", "content": "To evaluate the performance of the proposed method, we employ four metrics: connectivity, avoidance, approximate total travel time and number of transfers.\n1) Connectivity: This metric assesses whether the pro-posed route ensures available transportation between intermediate stations. A route is considered to have satisfied connectivity if all the suggested transportation methods are available at each intermediate station. In this context, \"available\" means that the station is marked as having a train stop, without considering the specific time table, as this information is not provided to the LLM agents.\n2) Disruption Avoidance: The avoidance metric evalu-ates the system's ability to generate routes that success-fully avoid any areas, stations, or disruptions the user wishes to avoid based on their preferences or external information. This could include locations marked as dangerous, stations with reported incidents, or areas affected by service disruptions. A route is considered to have failed in avoidance if it passes through or includes any of the user-specified avoidance criteria, even if the user does not disembark at that particular station or location.\n3) Approximate Total Travel Time: To estimate the total travel time for each proposed route, we use Google Maps to query the travel time for every segment based on the corresponding transportation method. For routes that fail to satisfy connectivity, i.e., when the suggested transportation method is not available between two stations, we estimate the travel time for that segment by calculating the walking time between the stations. For a fair comparison, all travel time queries are made with a fixed start time of May 1st, 2024, at 1:30 PM EST, to minimize variations in estimated travel times due to differing query times. For the purpose of comparison, the travel time for each scenario is standardized rel-ative to the total estimated walking time from origin to destination without additional constraints. This is achieved by dividing the travel time by the walking time, converting the time factor into a percentage (less than 1). In cases where models fail to yield a valid result, this value is adjusted to 1.\n4) Number of Transfers: This metric counts the number of times a user needs to switch between different trains or transportation methods (e.g., from train to bus or from bus to walking) along the proposed route. A lower number of transfers indicates a more convenient route for the user."}, {"title": "IV. RESULTS", "content": "Table II compares the performance of three models - GPT, Gemini, and Claude across four key metrics. GPT achieves the highest scores in three out of the four metrics, with a connectivity score of 0.78, an avoidance score of 0.78, and the lowest approximate time of 0.51. Gemini, on the other hand, has the lowest number of transfers at 3.00, but fails for the other three metrics. Claude falls in between GPT and Gemini. These results suggest that GPT offers the best overall performance, achieving a good balance between high connectivity and avoidance scores, low approximate time, and a reasonable number of transfers."}, {"title": "A. Ablation Study", "content": "We perform the ablation study to investigate the impor-tance of the subway map image and the LLM summary in the route planning process. As mentioned in [9], we are interested in determining whether image data is essential for effective route planning. To explore this, we conduct an ablation study where we keep all other inputs fixed but remove the map images provided to the agent. However, for the user query, we still include the image, for instance, image that marks the dangerous zones, as this information is crucial for understanding the user's location, preferences and constraints. By comparing the performance of the LLMs with and without access to the subway map image, we can assess the contribution of visual information to the route planning task. Further, we examine whether a single LLM agent, provided with both planner and summary instructions, can generate accurate recommendations in the required format. We evaluate the performance of the generated routes using the metrics defined in Section III-C. In addition to these metrics, we also count the number of violations of the route format, as demonstrated in Figure 1. This allows us to determine the ability of the LLM agent to adhere to the specified structure.\nTable III presents an ablation study comparing the perfor-mance of GPT with and without access to map images. The results demonstrate that providing GPT with map images leads to significant improvements across all metrics. This highlights the importance of incorporating visual information in the form of map images to enhance GPT's ability to provide accurate and efficient route recommendations.\nTable IV investigates the impact of using a separate LLM for summarizing the output. When a separate LLM is employed for summarization, the performance improves substantially compared to direct summarized output. The separate LLM summary approach reduces the violations of format to 0.11. On the other hand, direct summarized output results in lower quality routes, and completely violates the format. The overall benefits of using a separate LLM for summarization, particularly in terms of route quality and format adherence, make it a more effective strategy.\nThe only instance where the separate LLM summary approach leads to a violation of format is Scenario S4. In this case, the LLM Planner correctly suggests taking the 1 train from Times Square to the destination, effectively avoiding the dangerous area. However, the separate LLM summary identifies this as a contradiction to the narrative's emphasis on avoiding Times Square. As a result, it proposes an alternative route with additional reasoning, despite the LLM Planner's already safe and efficient recommendation. This highlights a potential limitation of using a separate LLM for summarization, as it may occasionally overrule valid suggestions due to a misinterpretation of the context.\nNonetheless, the benefits of the separate LLM summary approach, as demonstrated by the overall improvements in route quality and format adherence, generally outweigh this inconsistency."}, {"title": "V. DISCUSSION", "content": "The ability to process image data requires further analysis. Figure 2 illustrates the constraints for Scenario S5, where the black-boxed area on the map indicates the region the route should avoid while still identifying a valid path to the destination. The results for this scenario were unsatisfactory; although GPT-4 was the only model that successfully avoided the black-boxed area, it failed to maintain a connected route to the destination. The previous section (IV-A) has demonstrated that utilizing maps significantly enhances the quality of the outputs. Nevertheless, marking an area on the map did not yield success in Scenario S5. The potential reasons for this failure might be the insufficient resolution of the image or the possibility that all the most commonly used routes fall within the black-boxed area, preventing the agents from identifying a valid route that adheres to the constraints.\nFigure 3 presents the image input for Scenario S6, where the current location is marked by a black circle, and nearby Citi Bike stations are labeled on the map. The agents were tasked with planning a bicycle route that includes sightsee-ing in Central Park and concludes at the Port Authority Bus Terminal using public transportation while avoiding biking through Times Square. In this scenario, Claude 3 emerged as the best-performing model. It not only provided a route that satisfied all restrictions but also demonstrated an understanding of Citi Bike usage. For instance, Claude 3 Opus was the only model to mention renting and returning the bike and interpreting the availability information in the image, with raw output like \"Walk to the nearby Citi Bike station at Cathedral Parkway & Broadway (just south of your location). The map shows this station has a good number of bikes available.\" and \"exit the park and return your bike to a station near W 57th St, such as 8th Ave & W 57th St or Broadway & W 58th St.\" Conversely, other models failed to identify specific bike stations. Scenario S6, which involves potentially unfamiliar transportation services compared to other scenarios, highlights the limitations of the other models.\nWhile our experiments required the LLM Planner to gen-erate routes with specific trains, tools like Google Directions only require the transportation mode, such as transit, and internally determine the specific trains. Consequently, iden-tifying the proper intermediate stations is more crucial than specifying the exact trains, when used with such navigation tools.\nFigure 4 demonstrates the routes generated for Scenario S2, where the requirement is to avoid Times Square. From left to right, the red, pink, and blue lines represent the routes generated by GPT-4, Claude 3, and Gemini, respectively. Although all three models successfully avoid Times Square, only the route generated by GPT-4 satisfies the connectivity criterion (defined in Section III-C). Both Claude 3 and Gemini generate routes that suggest taking a train to an unreachable station. However, this issue is mitigated when using Google Directions, as it will automatically specify the correct train to reach the desired station."}, {"title": "VI. CONCLUSION", "content": "In this paper, we proposed a prototype system TraveLLM for customized route planning in face of network disruptions. We designed a set of test cases to evaluate the perfor-mance of state-of-the-art LLMs in generating accurate routes. Our comparative analysis demonstrated the effectiveness of LLMs, particularly GPT-4, in generating high-quality nav-igation plans. The ablation study showed the importance of incorporating visual information, such as subway map images, to enhance the LLMs' ability to reason about the transportation network and provide more accurate routes. Furthermore, we showed that employing a separate LLM for summarizing the output leads to improved route quality and adherence to the desired format, compared to direct summarized output. We also identified limitations and areas for future improvement. The ability of LLMs to process im-age data and incorporate potentially unfamiliar transportation services requires further improvements. Overall, our findings underscore the potential of LLMs in enhancing existing navigation systems and providing a more flexible method for addressing diverse user needs in face of disruptions. Our future work would focus on improving the agents' ability to process visual information, mitigate hallucination, and refine the interaction between the LLM agents and downstream applications."}]}