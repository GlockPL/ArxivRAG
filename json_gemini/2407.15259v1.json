{"title": "New Rules for Causal Identification with Background Knowledge", "authors": ["Tian-Zuo Wang", "Lue Tao", "Zhi-Hua Zhou"], "abstract": "Identifying causal relations is crucial for a variety of downstream tasks. In additional to observational data, background knowledge (BK), which could be attained from human expertise or experiments, is usually introduced for uncovering causal relations. This raises an open problem that in the presence of latent variables, what causal relations are identifiable from observational data and BK. In this paper, we propose two novel rules for incorporating BK, which offer a new perspective to the open problem. In addition, we show that these rules are applicable in some typical causality tasks, such as determining the set of possible causal effects with observational data. Our rule-based approach enhances the state-of-the-art method by circumventing a process of enumerating block sets that would otherwise take exponential complexity.", "sections": [{"title": "1. Introduction", "content": "In recent years, the adoption of causal thinking (Pearl, 2009) has opened up new venues for many machine learning topics, such as semi-supervised learning (Sch\u00f6lkopf et al., 2012; von K\u00fcgelgen et al., 2020), reinforcement learning (Huang et al., 2022; Ruan et al., 2023), transfer learning (Gong et al., 2016; Zhang et al., 2020; Cai et al., 2021), and so on. One essence of causal thinking lies in the causal relations among the variables, generally characterized by a causal graph. As a causal graph is usually not pre-known, uncovering the causal relations is vital for addressing downstream tasks.\nGiven observational data, the existing theoretical results have shown that only a Markov equivalence class (MEC) of causal graphs is identifiable, which contains some uncertain causal relations (Spirtes et al., 2000; Ali et al., 2005; Zhang, 2008). To further reveal these relations, additional structural knowledge is usually incorporated, which could be attained from experiments or human expertise (Meek, 1995). In the literature, we usually call this kind of knowledge by background knowledge, or BK for short.\nIn the presence of both observational data and BK, a core problem is causal identification, i.e., understanding what causal relations are identifiable from these knowledge. This problem is vital because it concerns the extent to which causal relations can be inferred from available information. On one hand, it pursues to identify as many causal relations as possible from existing knowledge, which can provide supports for fully utilizing BK in practical tasks (He & Geng, 2008; Hauser & B\u00fchlmann, 2014). On the other hand, even without BK, it is still valuable to some tasks with only observational data, such as causal effect estimation (Maathuis et al., 2009; Fang & He, 2020; Wang et al., 2023a) and equivalent causal graph enumeration (Wien\u00f6bst et al., 2023; Wang et al., 2024). In these tasks, some additional structures that can be viewed as hypothetical BK are possibly introduced, thus solving causal identification can facilitate uncovering the most informative causal graph given these additional structures.\nSignificant efforts have been made towards causal identification in scenarios without latent variables (Verma & Pearl, 1990; 1992). And Meek (1995) closed the problem by presenting four sound and complete rules to uncover causal relations. However, in real world tasks, latent confounders that influence some observable variables generally exist. In these instances, ancestral graph is usually used to characterize the causal relations among observable variables (Richardson et al., 2002). To identify causal relations with observational data in such contexts, ten sound and complete rules have been proposed (Ali et al., 2005; Zhang, 2008). And there are also several studies about causal identification with some kind of specific BK (Andrews et al., 2020; Jaber et al., 2020; Wang et al., 2023b). Nevertheless, the thorough result for causal identification with any kinds of BK in the presence of latent confounders remains elusive.\nIn this paper, we propose two novel rules for incorporating BK in the presence of latent confounders. Different from existing rules which identify causal relations based on few edges or paths, the identified causal relations by our proposed rules may rely on a subgraph. Our findings suggest that in the presence of latent variables, causal identification requires more complicated orientation rules when BK is"}, {"title": "2. Preliminary", "content": "Denote a graph by G. Let V(G) denote the set of vertices (variables) and E(G) denote the set of edges in G. We use bold letter (e.g., A) to denote a set of vertices and normal letter (e.g., A) to denote a vertex. Given a set of vertices V' \u2286 V(G), G[V'] is the subgraph of G induced by V' which consists of vertices V' and all the edges between V'. G[-V'] denotes G[V(G)\\V']. G is a complete graph if for any two vertices in G, there is an edge connecting them.\nIn this paper, we assume the absence of selection bias. Hence the case for selection bias is not involved in the following definitions. A graph is a mixed graph if it contains directed and bi-directed edges. The two ends of an edge are marks, which could be arrowhead, tail, and circle(0). The symbol represents that the mark here is unknown. The symbol * is a wildcard that represents any marks. A partial mixed graph (PMG) is a graph containing arrowheads, tails, and circles. Due to space limit, some definitions are shown in Appendix A.1, including directed path, minimal path, collider path, parent, ancestor, descendant, possible ancestor, possible descendant, circle edge, circle component.\nIn a graph G, if there is $V_i *\\rightarrow V_j; V_k$ where $V_i$ is not adjacent to $V_k$, they form an unshielded collider. Consider a path $p = (V_1, V_2,\\ldots, V_k)$, p is a possible directed path if for the edge between $V_i$ and $V_{i+1}, \\forall 1 \\leq i \\leq k - 1$, there is no arrowhead at $V_i$ and no tail at $V_{i+1}$; p is uncovered if $V_{i-1}$ is not adjacent to $V_{i+1}, \\forall 2 \\leq i \\leq k-1$. In G, denote the set of parents/ancestors/descendants/possible descendants of $V_i$ by $Pa(V_i, G)/Anc(V_i, G)/De(V_i, G)/PossDe(V_i, G)$. Given a vertex $V_i$ and a set of vertices V' in G, $V_i \\in Anc(V', G)$ if there exists a vertex $V_j \\in V'$ such that $V_i \\in Anc(V_j, G)$.\nFor a mixed graph G, if there is a directed path from $V_i$ to $V_j$ and an edge $V_j \\rightarrow V_i/V_j \\leftrightarrow V_i$, they form a directed cycle/almost directed cycle. A mixed graph G is ancestral if there are no directed cycles and no almost directed cycles. The maximal property is given in Appendix A.1. In the presence of latent variables, maximal ancestral graph (MAG) is usually used to characterize the causal relations among observable variables. Essentially, MAG is a projection graph on the observable variables of an underlying DAG that contains both observable and latent variables. We say a DAG D is represented by a MAG M if M is a projection graph of an underlying D. Note many DAGs can be represented by one MAG, which is detailed in Appendix A.1. A partial ancestral graph (PAG) represents a Markov equivalence class (MEC) of MAGs. Denote MAG and PAG by M and P, respectively. Suppose we obtain a PMG H from P by transforming some circles. We say a MAG M is consistent with H if M has the same non-circle marks at H and M belongs to the MEC represented by P. Note when we say an edge *, the * here is not a tail, for otherwise the circle can only be an arrowhead due to no selection bias. $G_x$ denotes the subgraph of G by deleting all the edges out of X.\nIn the literature, there are orientation rules R1 - R11 to identify a PAG or incorporate local background knowledge into a PAG. These rules are shown in Appendix A.2.\nCovariate adjustment is a classical method to estimate the causal effect given a causal graph, by finding an adjustment set Z such that $P(Y|do(X)) = \\sum_z P(Z)P(Y|X, Z) dZ$. More related results are shown in Appendix A.3."}, {"title": "3. Proposed Rules", "content": "In this section, we present two novel rules to incorporate BK into a partial mixed graph (PMG) H. As there have established sound and complete rules to obtain a PAG with observational data in the literature (Zhang, 2008), we do not"}, {"title": "4. Application on Set Determination", "content": "In this section, we demonstrate the applicability of the rules proposed in Sec. 3 to causality tasks that rely solely on observational data. Specifically, we focus on set determination task in the presence of latent confounders, i.e., determining the set of possible causal effects of vertex X on vertex Y with observational data. We will present a rule-based method by introducing the proposed rules into the state-of-the-art method PAGcauses (Wang et al., 2023a), which takes a substantial improvement on efficiency.\nIn set determination task, we have a PAG P identified with observational data (Spirtes et al., 2000). Suppose we are interested in the causal effect of X on Y henceforth. As many causal graphs are consistent with P and possibly associated with different causal effects, the target of set determination is to determine the set of possible causal effects, consisting of all the causal effects in the DAGs represented by the MAGs in the MEC represented by P. Following previous studies (Maathuis et al., 2009; Malinsky & Spirtes, 2016; Fang & He, 2020; Wang et al., 2023a), we only consider the possible causal effects that are estimated by covariate adjustment, and only focus on finding all the adjustment"}, {"title": "A. Detailed Preliminary", "content": "A.1. Preliminary about Graphs\nIn a graph G, consider a path $p = (V_1, V_2,\\ldots, V_k)$, p is a directed path if there is $V_i \\rightarrow V_{i+1}, \\forall 1 \\leq i \\leq k - 1$; p is a collider path if there is $V_{i-1}*\\rightarrow V_i *V_{i+1}, \\forall 2 \\leq i \\leq k - 1$; p is minimal if any two non-consecutive vertices are not adjacent. A vertex $V_i$ is a parent of $V_2$ if there is $V_1 \\rightarrow V_2$. $V_1$ is an ancestor/descendant of $V_2$ if there is a directed path from $V_1/V_2$ to $V_2/V_1$. $V_1$ is a possible ancestor/possible descendant of $V_2$ if there is a possible directed path from $V_1/V_2$ to $V_2/V_1$. Note each vertex is an ancestor/descendant/possible ancestor/possible descendant of itself. An edge in the form of 0-0 is a circle edge. The circle component of a graph G is the subgraph of G = (V, E) consisting of the vertices V and all the circle edges. We say two vertices $V_i$ and $V_j$ is a connected circle component in G if there is a circle path $V_i ooo V_j$ from $V_i$ to $V_j$ in G. For two paths $p_1 = (V_1, V_2,\\ldots, V_a)$ and $p_2 = (S_1, S_2,\\ldots, S_n)$, we use $P_1 P_2$ to denote the concatenate path $(V_1,\\ldots, V_a, S_1,..., S_n)$.\nIf there is a path $V_1 \\rightarrow V_2 \\rightarrow \\rightarrow V_a$ and an edge $V_a \\rightarrow V_1/V_a \\rightarrow V_1$, then there is a directed cycle/almost directed cycle. For a mixed graph, if there is not a directed cycle or almost directed cycle, then it is ancestral. For an ancestral graph, if for any two non-adjacent vertices, there is a set of vertices that m-seperates them, then the graph is maximal. If a mixed graph is both ancestral and maximal, it is a maximal ancestral graph (MAG), denoted by M.\nEssentially, MAG is a projection graph on the observable variables of some underlying DAGs containing both observable and latent variables. Spirtes et al. (2000); Zhang (2008) presented the algorithm to obtain a MAG with vertices O from a DAG with vertices OULUS, where O, L, S denote the observable vertices set, latent vertices set, and selection vertices set. Since we do not consider selection bias in this paper, we do not consider S in the following. Next we show inducing path in Def. 6, followed by the algorithm to obtain a MAG based on a DAG. According to the algorithm, as the number of latent vertices can be arbitrary, there can be infinite number of DAGs which could lead to one MAG by the algorithm.\nDefinition 6 (Inducing path; Spirtes et al. (2000)). Let X, Y be two vertices in an maximal ancestral graph. Denote L, S two disjoint sets of vertices that X, Y do not belong to. A path p from X to Y is an inducing path relative to (L, S) if every non-endpoint vertex on p is either in L or a collider, and every collider on p is an ancestor of either X, Y, or a member of S.\nInput: a DAG D over V = OUL;\nOutput: a MAG M over O.\n(1) for each pair of vertices A, B \u2208 O, A and B are adjacent in M if and only if there is an inducing path relative to (L, (\u00d8) from A to B in D;\n(2) for each pair of adjacent vertices A, B in M, orient the edge between A and B according to the following steps:\n(a) orient A \u2192 B in M if A \u2208 Anc(B, D) and B \u2209 Anc(A,D);\n(b) orient A + B in M if B \u2208 Anc(A, D) and A \u2209 Anc(B, D);\n(c) orient A + B in M if A \u2209 Anc(B,D) and B \u2209 Anc(A,D).\nGiven observational data, we can only identify a Markov equivalence class (MEC) of MAGs, which is represented by a partial ancestral graph (PAG) and denoted by P. In a PAG, there is an arrowhead/tail at some position if and only if there is an arrowhead/tail at this position in all the MAGs in the MEC; and there is a circle at some position if and only if there are both arrowheads and tails at this position in all the MAGs in the MEC."}, {"title": "A.2. Preliminary about Orientation Rules", "content": "Ali et al. (2005); Zhang (2008) proposed ten rules $R_1$ \u2013 $R_{10}$ to identify a PAG with observational data. Jaber et al. (2020) presented the solid result to imply that when there is additional interventional data and selection bias is not allowed for, the ten rules are also complete. Another study (Andrews et al., 2020) indicates that the ten rules are complete if we incorporate tiered background knowledge, which means that the BK can classify the variables into distinct parts, where the causal order between different parts is explicit, but the structural information within each part cannot be directly known according to the BK.\nFurther, when we have obtained a PAG and incorporate local background knowledge (local BK), i.e., the full structural knowledge regarding some specific variables, Wang et al. (2023b) proposed a rule $R'_4$ to replace $R_4$ and an additional rule"}, {"title": "A.3. Preliminary about Causal Effect Estimation", "content": "Definition 7 (Adjustment set; Pearl (2009); van der Zander et al. (2014)). Given a DAG, MAG, or PAG G, Z is an adjustment set relative to (X, Y) if for any probability density f compatible with G, the causal effect of X on Y\n$P(Y|do(X)) = \\begin{cases}\nP(Y|X), \\text{ if Z = }\n\\int P(X|Z, X)P(Z) dZ, \\text{ otherwise}\n\\end{cases}$\nMaathuis et al. (2015); Perkovic et al. (2017b) presented the necessary and sufficient graphical characterization for the causal effect identifiablility via covariate adjustment given a DAG/CPDAG/MAG/PAG. We show them in Prop. 4. See Maathuis et al. (2015) for the notation Gx. At first, we introduce an important concept D-SEP(X, Y, G) in Def. 8. D-SEP(X, Y, G) is essentially a set of vertices.\nDefinition 8 (D-SEP(X, Y, G); Spirtes et al. (2000)). Let X and Y be two distinct vertices in a mixed graph G. We say that V \u2208 D-SEP(X, Y, G) if V \u2260 X, and there is a collider path between X and V in G, such that every vertex on this path (including V) is an ancestor of X or Y in G.\nProposition 4 (Maathuis et al. (2015); Perkovic et al. (2017b)). Let G be a MAG or PAG, and X and Y be two distinct vertices in G. There exists an adjustment set relative to (X, Y) in G if and only if Y \u2209 Adj(X,Gx) and D-SEP(X, Y,Gx)\u2229 PossDe(X, G) = (\u00d8. Moreover, if an adjustment set exists, then D-SEP(X,Y,Gx) is such a set. Denote D-SEP(X, Y, Gx) by D, then\n$f(Y|do(X = x)) = \\int f(D)f(Y|D, X = x) dD$\nB. A Detailed Introduction to PAGcauses (Wang et al. 2023a)\nIn this part, we introduce the method PAGcaused to determine the set of possible causal effects given a PAG, which is proposed by Wang et al. (2023a). We first show some theoretical results of Wang et al. (2023a). Some of these results are needed in our proof.\nThe first important result is Prop. 5. It provides a graphical characterization for the adjustment set comprised of observable variables in all the DAGs represented by a given MAG. It implies that there exists a DAG where the causal effect of X"}]}