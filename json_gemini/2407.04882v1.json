{"title": "Improving ensemble extreme precipitation forecasts using generative artificial intelligence", "authors": ["Yingkai Sha", "Ryan A. Sobash", "David John Gagne II"], "abstract": "An ensemble post-processing method is developed to improve the probabilistic forecasts of extreme precipitation events across the conterminous United States (CONUS). The method combines a 3-D Vision Transformer (ViT) for bias correction with a Latent Diffusion Model (LDM), a generative Artificial Intelligence (AI) method, to post-process 6-hourly precipitation ensemble forecasts and produce an enlarged generative ensemble that contains spatiotemporally consistent precipitation trajectories. These trajectories are expected to improve the characterization of extreme precipitation events and offer skillful multi-day accumulated and 6-hourly precipitation guidance. The method is tested using the Global Ensemble Forecast System (GEFS) precipitation forecasts out to day 6 and is verified against the Climate-Calibrated Precipitation Analysis (CCPA) data. Verification results indicate that the method generated skillful ensemble members with improved Continuous Ranked Probabilistic Skill Scores (CRPSSs) and Brier Skill Scores (BSSs) over the raw operational GEFS and a multivariate statistical post-processing baseline. It showed skillful and reliable probabilities for events at extreme precipitation thresholds. Explainability studies were further conducted, which revealed the decision-making process of the method and confirmed its effectiveness on ensemble member generation. This work introduces a novel, generative-AI-based approach to address the limitation of small numerical ensembles and the need for larger ensembles to identify extreme precipitation events.", "sections": [{"title": "1. Introduction", "content": "The accurate prediction of extreme precipitation events is crucial for saving lives and property but continues to challenge our best prediction systems (e.g. Sukovich et al. 2014; Herman and Schumacher 2016). State-of-the-art global numerical weather prediction (NWP) models typically have 10-50 km horizontal grid spacing (e.g. Molteni et al. 1996; Buizza et al. 2018; Zhou et al. 2017, 2022). These horizontal resolutions require parameterization schemes to approximate small-scale processes that contribute to the generation of rainfall, such as convection and the microphysical interactions of cloud and precipitation water particles (Stensrud 2009). Despite the large improvements made over recent decades (Bauer et al. 2015), systematic error remains in these parameterization schemes, particularly for the modeling of extreme precipitation events (Wilcox and Donner 2007; Wehner et al. 2010; Sun and Liang 2020).\nPost-processing methods have been proposed for the bias correction and calibration of precipitation forecasts. These methods include both parametric methods, which assume a known predictive distribution, and non-parametric methods, which derive a predictive distribution from the training data with no prior distribution assumptions. One common parametric method is nonhomogeneous regression (Scheuerer and Hamill 2015; Baran and Nemoda 2016), which is an approach where a regression model predicts the parameters of a parametric distribution, such as a censored, shifted Gamma distribution for precipitation. Bayesian model averaging (Sloughter et al. 2007) estimates a multi-modal predictive distribution from an ensemble of deterministic predictions by learning the predicted variance and weight of each ensemble member. Nonparametric methods include the Analog Ensemble (Hamill and Whitaker 2006; Monache et al. 2013), which identifies the most similar prior NWP predictions to a new prediction and creates a distribution of observed"}, {"title": "2. Research domain and data", "content": "a. Region of interest and the definition of extreme precipitation events\nThis research focuses on precipitation events within the CONUS (Fig. Sla). Following the definition of the Intergovernmental Panel on Climate Change (IPCC), Sixth Assessment Report (AR6), gridpoint-wise 99th percentile values were used as thresholds to identify extreme precipitation events (P\u00f6rtner et al. 2022). These values were estimated separately for different time periods"}, {"title": "3. Methods", "content": "Two neural-network-based post-processing steps were combined as the main methodology of this research (Fig. S2). First, a 3-D Vision Transformer (ViT) was proposed to reduce the forecast bias of each GEFSv12 member. Second, each bias-corrected member was used as the conditional input of a diffusion model, which generates post-processed members as outputs. The two steps above were conducted within the latent space created by a Vector-Quantized Variational Autoencoder (VQ-VAE), with the VQ-VAE encoder projecting GEFS members into the latent space and the VQ-VAE decoder projecting the latent space outputs back to the real space. The term \u201cLatent Diffusion Model (LDM)\" was used to highlight the application of VQ-VAE, and hereafter, the method is named \u201cViT-LDM\".\nThe ViT-LDM post-processing was trained from 2002 to 2019 using the 6-hourly GEFS reforecasts out to 6 days (i.e., 06-144 hours lead times) and the CCPA data. The validation set was a 10% random sampling from the training set and fixed for all training steps. When applied to the operational GEFSv12 in 2021, ViT-LDM generates 2 post-processed members from each GEFSv12 member, thus producing 62 generative members from all 31 operational members. The generated 62 members were verified against the CCPA data from 1 January to 31 December 2021 with a focus on extreme precipitation events. The basics and applications of VQ-VAE, ViT, and LDM are"}, {"title": "4. Results", "content": "a. Case-based assessments\nA case-based assessment is presented to demonstrate the generative ensemble produced by ViT-LDM. In Fig. S6, an example of 48-54 hour GEFS forecasts, initialized on 0000 UTC 30 December 2020, is presented. At this time, a synoptic scale system was forecast in the Southeastern US. The system caused extreme precipitation (see the dotted area in Fig. S6d) and gradually moved towards the East Coast. Part of the ViT-LDM generative ensemble members are shown in Fig. S6e-i with the corresponding extreme precipitation events highlighted by the dotted area. Comparing the ViT-LDM outputs with the two baselines, several performance highlights are evident:\n1. Precipitation patterns generated by ViT-LDM shared roughly the same locations as the CCPA verification target. The LDM-based conditional sampling from the bias-corrected GEFS ensemble members has the ability to preserve the broad-scale structure of the forecast event. This ensures that the generative ensemble would not exhibit large spatial discrepancies and place negative impacts on the prediction of extreme precipitation events.\n2. Differences in terms of the shape and intensity of the generated precipitation patterns can be found. For example, in Fig. S6f, the generated precipitation pattern had similar shapes to the CCPA target, but its forecast extreme precipitation area was shifted to the east. In Fig. S6g and i, extreme precipitation events were forecast on the correct grid points, but the precipitation pattern was extended to the south. Such small-scale variations provided good horizons on how this extreme precipitation event would develop. The probabilistic forecasts, collectively summarized from the ViT-LDM generative ensemble, showed good BS and outperformed the two baselines.\n3. The generated members were smoother than the CCPA verification target. This indicates that, although the ViT-LDM was trained using the 1/8\u00b0, they may not have the full ability to downscale 0.25\u00b0 GEFS inputs into the 1/8\u00b0 target resolution. That said, spatial downscaling is not the purpose of ViT-LDM."}, {"title": "5. Discussion", "content": "This research utilized generative AI for the ensemble post-processing of extreme precipitation events. Two research questions were examined. The first was related to the feasibility of generative AI and its performance in forecasting extreme precipitation. The implementation of generative AI in this study was successful, and its technical approach was similar to that of Li et al. (2024) and Zhong et al. (2023), which applied diffusion models using forecasted fields as conditional inputs. An important technical choice of ViT-LDM that differs from other research is the use of latent space projection, which reduced the overall data sizes and simplified the training of 3-D ViT and LDM. In the early stage of this research, the authors experimented with 3-D ViTs configured with larger patch sizes and without using a VQ-VAE. Strong checkerboard artifacts were identified with this choice. The VQ-VAE-based latent space projection and patch size 1 were then proposed, leading to the success of this generative AI application. Elevation and climatology inputs were incorporated into the ViT-LDM pipeline as background information. This option benefits the generation of precipitation fields with better quality, and its effectiveness has been discussed in other downscaling (e.g. Sha et al. 2020a,b; Wang et al. 2021) and bias-correction(e.g. Sha et al. 2022) studies. The performance of ViT-LDM in predicting extreme precipitation events were verified to be better than the AnEn-ECC baseline, a set of widely used post-processing techniques, as well as the original GEFS ensemble. The good performance of ViT-LDM is especially evident from the verification of 40 mm per 6-hour events, which many existing post-processing methods cannot calibrate properly. We think generative AI has the potential to be applied to the ensemble generation of regional precipitation forecasts and improve the prediction of extreme precipitation events.\nThe second research question focused on the explainability of ViT-LDM. Here, the example-based explainability studies were conducted. An important finding of this study is that the VQ-VAE latent space is capable of separating GEFS forecasts and the CCPA targets, which further explains the effectiveness of 3-D ViT in relocating the forecast-oriented representations. The role of LDM was identified as expanding the spatial area of latent space representations, which improved both the general post-processing performance and the calibration of extreme precipitation events. The explainability of AI-based forecast post-processing methods are generally lacking. For many neural-network-based post-processing methods, it is unclear how they have improved the quality"}, {"title": "6. Conclusions", "content": "A novel post-processing method, ViT-LDM, was proposed by incorporating a Vector Quantised-Variational AutoEncoder (VQ-VAE), a 3-D Vision Transformer (ViT), and a Latent Diffusion Model (LDM). The method takes 6-hourly precipitation forecasts from numerical ensembles as inputs and generates post-processed trajectories that are skillful for the probabilistic estimation of extreme precipitation events. The 3-D ViT aims to reduce conditional bias from the original numerical ensemble, while the LDM produces an expanded generative ensemble that better characterizes extreme events.\nThe method was trained using the Global Ensemble Forecast System version 12 (GEFSv12) reforecasts as inputs and the Climate-Calibrated Precipitation Analysis (CCPA) as targets from 2002 to 2019 and tested with the operational GEFSv12 over the Conterminous United States (CONUS) from 1 January 2021 to 31 December 2021. Verification results showed that the method generated skillful precipitation forecast trajectories, as indicated by Continuous Ranked Probabilistic Skill Scores (CRPSSs) and Brier Skill Scores (BSSs). Its calibration performance for extreme precipitation events was superior to that of the operational GEFS and the combination of Analog Ensemble (AnEn) and Ensemble Copula Coupling (ECC). Reliability diagrams demonstrated that the probabilistic extreme precipitation forecasts of ViT-LDM were as reliable as that of the AnEn-based calibrations but with better resolution scores. For the verification of 6-day accumulated"}]}