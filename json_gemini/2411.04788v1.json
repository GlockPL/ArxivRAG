{"title": "Enhancing Investment Analysis: Optimizing Al-Agent Collaboration in Financial Research", "authors": ["Xuewen Han", "Neng Wang", "Shangkun Che", "Hongyang Yang", "Kunpeng Zhang", "Sean Xin Xu"], "abstract": "In recent years, the application of generative artificial intelligence (GenAI) in financial analysis and investment decision-making has gained significant attention. However, most existing approaches rely on single-agent systems, which fail to fully utilize the collaborative potential of multiple Al agents. In this paper, we propose a novel multi-agent collaboration system designed to enhance decision-making in financial investment research. The system incorporates agent groups with both configurable group sizes and collaboration structures to leverage the strengths of each agent group type. By utilizing a sub-optimal combination strategy, the system dynamically adapts to varying market conditions and investment scenarios, optimizing performance across different tasks. We focus on three sub-tasks: fundamentals, market sentiment, and risk analysis, by analyzing the 2023 SEC 10-K forms of 30 companies listed on the Dow Jones Index. Our findings reveal significant performance variations based on the configurations of AI agents for different tasks. The results demonstrate that our multi-agent collaboration system outperforms traditional single-agent models, offering improved accuracy, efficiency, and adaptability in complex financial environments. This study highlights the potential of multi-agent systems in transforming financial analysis and investment decision-making by integrating diverse analytical perspectives.", "sections": [{"title": "1 INTRODUCTION", "content": "In recent years, generative artificial intelligence (GenAI) has made significant strides in various domains, including financial analysis and investment decision-making. The use of Al agents to analyze financial reports and aid in investment strategies has shown promising results, enhancing both accuracy and efficiency [12, 16, 27, 28].\nExisting literature primarily focuses on single Al agents in finan-cial analysis [15, 31, 35]. While these models have demonstrated effectiveness, there is growing interest in exploring the potential benefits of multi-agent systems. Current research has explored multi-agent debates (MAD) to improve agents' performance [6] and shown improvements. However, applying MAD is not practical in larger agent groups. In this situation, agent collaboration can better leverage different agents' capabilities and improve task com-pletion. This requires properly defined agent roles and a validated well-designed collaboration model.\nThis research aims to fill this gap by investigating the effects of varying Al agent structures, with single to multiple agents, on financial analysis tasks. To address these questions, this paper fo-cuses on the scenario of AI-powered investment research in the financial industry, which uses artificial intelligence to analyze fi-nancial market data, company financial reports, news, social media, and other sources, providing in-depth market insights and invest-ment research reports. Specifically, we examine the 2023 SEC 10-K forms of 30 companies in the Dow Jones Index in terms of three primary tasks: fundamental analysis, market sentiment analysis, and risk analysis. These analyses inform final investment decisions, including whether to buy or not stocks and setting target prices for one week ahead. Primarily, we focus on two main configurations: 1) Agent Group Size, to evaluate the impact of agent group size on financial annual report analysis; 2) Agent Collaboration Structure, to identify the optimal collaboration structure for multi-agent groups for different financial tasks.\nOur study shows that for relatively simple tasks such as fun-damental and market sentiment analysis, a single agent performs better than multiple agents from both investment research and"}, {"title": "2 RELATED WORKS", "content": "Large Language Models (LLMs) are advanced AI systems designed to process and generate human language [4, 17, 37], leveraging deep learning architectures like transformers to capture complex linguistic patterns [21]. These models, exemplified by OpenAI\u2019s GPT-4 and Google\u2019s BERT [5, 9], excel in diverse tasks such as translation, summarization, and conversational interfaces due to their ability to understand context and semantics. LLMs are trained on extensive datasets, which allows them to learn grammar, facts, and reasoning, although this also necessitates substantial compu tational resources. AI agents, on the other hand, are autonomous systems that interact with their environment to achieve specific ob jectives, often using LLMs to enhance natural language processing capabilities [7, 24, 32]. Applications range from personal assistants like Siri and Alexa to autonomous vehicles and healthcare diag nostics [14, 19]. These agents significantly improve efficiency and productivity in various domains; for instance, they can automate routine tasks, allowing professionals to focus on more complex and creative work [25]. Furthermore, the financial sector is experiencing a profound transformation as AI agents are increasingly utilized in investment research [16], enabling more sophisticated analysis and decision-making processes."}, {"title": "2.1 LLM and AI Agents", "content": "Large Language Models (LLMs) are advanced AI systems designed to process and generate human language [4, 17, 37], leveraging deep learning architectures like transformers to capture complex linguistic patterns [21]. These models, exemplified by OpenAI\u2019s GPT-4 and Google\u2019s BERT [5, 9], excel in diverse tasks such as translation, summarization, and conversational interfaces due to their ability to understand context and semantics. LLMs are trained on extensive datasets, which allows them to learn grammar, facts, and reasoning, although this also necessitates substantial compu tational resources. AI agents, on the other hand, are autonomous systems that interact with their environment to achieve specific ob jectives, often using LLMs to enhance natural language processing capabilities [7, 24, 32]. Applications range from personal assistants like Siri and Alexa to autonomous vehicles and healthcare diag nostics [14, 19]. These agents significantly improve efficiency and productivity in various domains; for instance, they can automate routine tasks, allowing professionals to focus on more complex and creative work [25]. Furthermore, the financial sector is experiencing a profound transformation as AI agents are increasingly utilized in investment research [16], enabling more sophisticated analysis and decision-making processes."}, {"title": "2.2 AI Agents in Financial Investment", "content": "In the rapidly evolving field of financial investment research, Large Language Models (LLMs) and AI Agents are revolutionizing the way analysts and investors gather and interpret data [10, 13, 30, 36]. These advanced technologies utilize natural language processing and machine learning to analyze vast amounts of unstructured data, such as news articles and financial reports, providing insights that enhance decision-making. Examples like StockAgent [15], FinA gent [35], and FinMEM [31] illustrate diverse applications of these technologies. StockAgent specializes in stock market analysis by predicting price movements, while FinAgent offers comprehensive financial assessments and strategic recommendations. FinMEM em ploys memory-enhanced modeling to integrate historical market knowledge with current conditions for long-term investment strate gies. The benefits of using LLMs and AI Agents include increased efficiency, improved accuracy, and scalability across markets."}, {"title": "3 METHODOLOGY", "content": "The architecture of AI agents varies from a single agent running independently to a collaborative form where multiple agents work together. Multi-agent systems involve two or more agents with the same or different LLM back-ends. In this section, we explore our methodology for building AI agent structures from single-agent to multi-agent, including multi-agent collaboration structures with the distinct internal implementation of leadership and cooperation. The overview of the structures is shown in Figure 1."}, {"title": "3.1 Overview", "content": "The architecture of AI agents varies from a single agent running independently to a collaborative form where multiple agents work together. Multi-agent systems involve two or more agents with the same or different LLM back-ends. In this section, we explore our methodology for building AI agent structures from single-agent to multi-agent, including multi-agent collaboration structures with the distinct internal implementation of leadership and cooperation. The overview of the structures is shown in Figure 1."}, {"title": "3.2 Unified RAG & Funtion Calling", "content": "Relying on the Text2Param capabilities of the underlying LLM, it\u2019s not difficult for agents to invoke a variety of tools, such as retriev ing stock prices from YFinance and fetching posts from Reddit\u2019s r/WallStreetBets. However, for investment research, analyzing com pany financial reports is also crucial. This requires equipping agents with the ability to retrieve relevant contexts from financial reports that are usually extremely long and complex. Typically, researchers adopt RAG (Retrieval-Augmented Generation) for such scenarios. Unlike typical RAG use cases (e.g. QA), we do not manually provide query questions or adjust the retriever settings for optimal results. Instead, to fully evaluate the agent\u2019s capabilities, we have encapsulated the ability to retrieve chunks from the RAG database into a tool function as shown in Figure 1. Under this setup, agents can independently write the query and pick the number of retrievals based on task requirements. If the retrieved chunks do not meet the"}, {"title": "3.3 Single-agent", "content": "For a single-agent case study, we utilize a basic chatbot with the function-calling ability described in the previous section. System prompts define its role as an analyst and limit its behavior to write & execute codes on its own. Through such constraints, it's easier to balance the difficulty level of each task based on not only the task itself but also the information available for each agent. There is no human intervention in any agent's process of handling the task, agents can decide to terminate their analysis on their own when they finish their tasks."}, {"title": "3.4 Dual-agent Group", "content": "In a group of two agents, agents' roles are similarly defined as, and have equal rights to conclude the given tasks. However, If we directly apply the implementation of a single-agent architecture, a common issue is that one agent might complete most of the work and then summarize and respond, skipping interaction with the other agent. Extra prompts are thus added to force communication between agents. For a dual group of Agents A& B, the following responsibilities are added to Agent A's system prompt:\n(1) Ask for advice from [Agent B] before you make any conclu-sion.\n(2) Inspect analysis delivered by [Agent B] and give out advice.\n(3) Reach a consensus with [Agent B] and provide the final analysis."}, {"title": "3.5 Triple-agent Group", "content": "When the number of agents exceeds three, we can experiment with more complex and dynamic structures. These structures can be bet-ter adapted to scenarios involving larger groups or can function as unit structures within a larger organization. Centered around lead-ership and communication, we have developed three distinct agent collaboration patterns, which are referred to as vertical structure, horizontal structure and hybrid structure."}, {"title": "3.5.1 Horizontal Collaboration", "content": "In a horizontal multi-agent structure, all agents are on the same level. This architecture is easy to implement and expand and has been proven to be suitable for han-dling relatively simple tasks. In a horizontal agent structure, all agents equally participate and discuss tasks together. Their commu-nication is shared, and each agent can see all messages from other agents. The horizontal agent structure is usually suitable for tasks requiring collaboration, feedback, and team discussion.\nThe implementation of a horizontal collaboration structure can be seen as an expansion of a dual-agent group, as similar prompts are utilized to force communication and information sharing. The dialogue unfolds in the form of a group chat, and the conversation in the group chat is visible to all roles. The speaking order follows a round-robin mechanism, with all roles taking turns to speak until any agent decides to end the conversation and report back to the user."}, {"title": "3.5.2 Vertical Collaboration", "content": "In the vertical multi-agent structure, the organization structure is leader-subordinate. Leaders are re-sponsible for global planning and coordination, while subordinates handle specific data processing and analysis. Subordinates simply receive orders from the leader, finish the job assigned, and report back. They are not designed to communicate with other agents.\nAs such structure is not natively supported, we implemented it with a nested chat mechanism as shown in Algorithm 1. The leader needs to specify a subordinate's name at the end of the response and issue instructions to it. Such a format is captured by the framework, triggering a nested chat process towards the specified subordinate, starting with the leader's instruction. This nested chat content is not visible to other subordinates. After the nested chat ends, the subordinate's final response is delivered back to the leader. The leader then issues instructions continuously or integrates the subordinate's results to ultimately decide whether to end the entire conversation. To achieve this, a leader_prompt is designed as below, where group_desc introduces all subordinates and their responsibilities:"}, {"title": "3.5.3 Hybrid Collaboration", "content": "In a hybrid multi-agent structure, agents have the same leveled roles and responsibilities defined as in the vertical structure but can communicate in a shared manner as in the horizontal structure. Unlike in the horizontal structure, where all agents have the right to report the final analysis and finish the conversation, lower-level agents here are asked to turn to the leader for the final analysis. This structure indicates a balance between leadership and equal cooperation.\nInstead of using the leader_prompt to establish leadership, two extra responsibilities are added separately to the leader and subor-dinates' system prompt as follows:\n\u2022 Leader\n(1) Give out tasks and advices to [Agent A] & [Agent B].\n(2) You should be the person to provide final analysis and finish the task.\n\u2022 Subordinates"}, {"title": "4 EXPERIMENTS", "content": "This study focuses on the effectiveness of different Al agent struc-tures in the context of investment research. Specifically, it examines the 2023 SEC 10-K forms of 30 companies in the Dow Jones Index to assess the performance of Al agents in three primary tasks: fundamentals analysis, market sentiment analysis, and risks anal-ysis. These analyses inform final investment decisions, including whether to buy or sell stocks and setting target prices for one week ahead.\nEach task is executed by a team of AI agents equipped with large language models. We evaluate three agent sizes: single, dual, and triple. Additionally, we examine three collaboration structures under the triple-agent setup: horizontal, vertical, and hybrid."}, {"title": "4.1 Task Description", "content": "This study focuses on the effectiveness of different Al agent struc-tures in the context of investment research. Specifically, it examines the 2023 SEC 10-K forms of 30 companies in the Dow Jones Index to assess the performance of Al agents in three primary tasks: fundamentals analysis, market sentiment analysis, and risks anal-ysis. These analyses inform final investment decisions, including whether to buy or sell stocks and setting target prices for one week ahead.\nEach task is executed by a team of AI agents equipped with large language models. We evaluate three agent sizes: single, dual, and triple. Additionally, we examine three collaboration structures under the triple-agent setup: horizontal, vertical, and hybrid."}, {"title": "4.2 Implementation Details", "content": "The data set used for investment research includes the 2023 annual reports of the 30 Dow Jones Index companies, along with stock prices at the time of report release and one week later. As for information available through tool function calls, all the search ranges of either stock movements or social media are limited to before the release date of the report to prevent data leakage.\nExperiments are conducted on the FinRobot platform developed by the AI4Finance community [29]. The communication is achieved with Microsoft's AutoGen's GroupChat [26] for a basic horizontal group. For complex agent group structures that are not natively supported by AutoGen, like vertical & hybrid collaboration, we add leadership with our own implementation. Codes are available on our GitHub Repository\u00b9.\nThis study uses the \"GPT-4-1106-vision-preview\" model provided by OpenAI as the foundation for all Al agents. Tool functions are also transformed into JSON schema as defined by the OpenAI API. All agents are equipped with Retrieval-Augmented Generation (RAG) capabilities as a tool function for recalling context from SEC filings based on keywords or key phrases. Texts from the annual reports are parsed from PDF files, divided into chunks of 1,000 tokens and then vectorized using the \"all-MiniLM-L6-v2\" model of sentence transformers [18], which is also utilized for queries during retrieval.\nDifferent sets of additional tool functions are provided for dif-ferent tasks. For fundamental analysis, we leverage several APIs of Financial Modeling Prep (FMP) [23] for company fundamentals and the YFinance package [20] for more stock-related information. For market sentiment analysis, we provide agents with encapsulated FinnHub API [22] for company-related market news, and Python Reddit API Wrapper (PRAW) [2] to gather relevant social media posts. For risk analysis, we provide no additional tool function thus making the task harder."}, {"title": "4.3 Evaluation", "content": "To evaluate the performance of AI agents in tasks, we need to analyze and assess AI-generated content.\nFrom the functional perspective, the AI-generated content in this study is used as reports to provide intelligent investment research services, which should meet the requirements of research reports in the financial investment field, such as information accuracy, logical completeness, professional evaluation indicators, and the ability to guide investment decisions.\nFrom the perspective of Artificial Intelligence Generated Content (AIGC), which is another category widely studied in academia, mainly focusing on evaluating and analyzing content generated by Al, we need to pay attention to the readability, coherence, and other general indicators of the generated text, adopting these indicators to assess whether the AI-generated research reports regarding text quality are close to the human level.\nIn summary, from the perspective of investment research reports as well as AIGC, totally we have 7 indicators, summarized in Table 1."}, {"title": "4.3.1 Evaluation Indicators from the Perspective of Investment Re-search Reports", "content": "From a functional perspective, we focus on the quality of AI-generated content as a research report. Since we di-vided investment analysis into three sub-tasks and combined the three sub-modules to complete the final research report and invest-ment suggestions, we designed evaluation indicators for both the overall research report and the three sub-tasks:\n(1) For fundamental analysis sub-task, calculating standard in-dicators is a common practice in the financial industry [1]. Therefore, we need to assess whether the AI agent correctly leverages indicators to provide a comprehensive analysis of the company's fundamentals."}, {"title": "4.3.2 Evaluation Indicators from the Perspective of AIGC", "content": "From the perspective of AIGC, related research has proposed evalua-tion indicators such as relevance, attractiveness, coherence, and readability, where readability and coherence are suitable for the scenarios in this study [33, 34]. Readability refers to the precision and natural expression of the content. Coherence refers to whether the answer's content is organized, grammatically correct, and easy to understand. Therefore, in this study, we will evaluate the analysis reports generated in sub-tasks from these two aspects."}, {"title": "4.4 Analysis of Experimental Results", "content": "To evaluate AI-generated content, LLMs like GPT-4 are frequently utilized in research [33]. In this study, we adopt a similar approach by designing specific prompts to enable the GPT-4 model to evaluate text quality based on our defined criteria. The GPT-4 model is tasked with providing a score ranging from 1 to 5, with 1 indicating minimal task completion and 5 indicating full task completion. For example, for the \"fundamental analysis\" indicator, the prompt input to GPT-4 is: \"Please evaluate from the perspective of whether the fundamental indicators of the enterprise have been identified or discussed, eradicated and judgments or suggestions have been given. Please give a score of 1-5 based on your judgment. 1 represents a lack of fundamental analysis or nonsense, 3 represents a certain fundamental analysis capability but not sufficient, and 5 represents a relatively complete fundamental analysis.\""}, {"title": "4.4.1 Analysis of Sub-task Quality", "content": "In this study, we analyze the annual reports of listed companies through three primary tasks: company fundamentals analysis, market sentiment analysis, and risk analysis. Each task follows a unified introduction and scoring system to ensure consistency.\nCompany Fundamentals Analysis focuses on evaluating a company's financial health, operational efficiency, profitability, and cash flow status. This task involves a detailed examination of finan-cial data and business operations from the annual report.\nMarket Sentiment Analysis gathers information from diverse sources such as news, social media, and investor reports to assess sentiment changes, which are closely linked to market trends and investment opportunities. By detecting market sentiment, investors can swiftly identify market signals and anticipate potential risks and opportunities.\nRisk Analysis involves identifying investment risk factors based on financial data. Identifying risk events allows investors to adapt their strategies flexibly, mitigating potential losses."}, {"title": "4.4.2 Performance of Different Agent Group Sizes", "content": "First, we com-pared the quality of generated content from the perspective of investment research reports. As illustrated in Table 2, for funda-mental analysis, a single agent outperforms larger groups. As the size of the agent group increases, performance decreases. A similar trend is observed in the sentiment analysis task, though the per-formance gap between a single agent and larger groups is smaller. However, for risk analysis, a group of three agents performs the best, while a single agent shows the poorest performance.\nNext, we evaluated the quality from the perspective of AI gen-erated content. The readability and coherence score distributions among different group sizes are illustrated in Figure 2. For fun-damental and sentiment analysis tasks, a single agent excels in readability and coherence. However, for risk analysis, a group of three agents outperforms, while a single agent performs the worst in both readability and coherence metrics. Findings in this part are consistent with the above evaluation from the perspective of investment research reports.\nThe complexity and depth of the tasks increase from fundamental analysis to sentiment analysis and risk analysis. In fundamental analysis, standard metrics such as financial health, operational efficiency, profitability, and cash flow status are used. Single agents, equipped with the necessary tools to calculate these metrics, can complete the task efficiently and produce high-quality reports. In contrast, larger agent groups introduce noise through debates and differing opinions, reducing the readability and coherence of the final reports.\nSentiment analysis based on social media presents a relatively complex task. Multiple sentiment tendencies can coexist in the market, and the content, particularly from individual forums, may be contradictory. Agents must analyze substantial information to provide a comprehensive sentiment analysis. Additionally, market sentiment is dynamic, requiring consideration of the time dimen-sion for accurate conclusions. Despite these complexities, the task remains manageable due to restricted information sources, enabling a small number of agents to produce highly readable reports. Con-sequently, the performance of a single agent is not as distinctly superior as in fundamental analysis.\nRisk analysis is highly challenging, requiring agents to identify potential risks in annual reports, online news, and social media. Collaborative efforts and debates among agents enhance insights and accuracy, resulting in more comprehensive risk reports. Larger agent groups can leverage diverse perspectives and expertise, lead-ing to more thorough identification and analysis of risks. The collab-orative process improves the overall quality of the report, making it more readable and coherent. Therefore, larger agent groups perform better in this task, highlighting the importance of collaboration in handling complex and multifaceted analyses. Additionally, the success of larger agent groups in risk analysis emphasizes the value of diversity in thought and expertise when dealing with intricate and dynamic information. The ability to pool knowledge and cross-verify findings helps mitigate individual biases and leads to more robust and reliable conclusions. This collaborative approach is par-ticularly beneficial in scenarios where the stakes are high, and the accuracy of the analysis is crucial for informed decision-making."}, {"title": "4.4.3 Performance of Different Agent Collaboration Structures", "content": "Furthermore, we conduct the same generated content quality evalua-tion based on different agent collaboration structures. The overall trend in Table 3 indicates that for easier tasks, such as fundamen-tal and sentiment analysis, hybrid and horizontal structures per-form better. For more complex tasks, like risk analysis, the vertical structure yields superior performance. We carefully analyzed the execution and communication records of agents of all structures in various tasks, and drew the information flow between agents in these structures shown in Figure 4.\nAmong the three sub-tasks, both fundamental analysis and sen-timent analysis have clear and relatively simple task objectives and execution processes. For example, fundamental analysis mainly in-volves extracting key fundamental analysis indicators from annual reports, which are common indicators used in financial invest-ment. Sentiment analysis first crawls data from multiple media data sources, and then further summarizes the sentiment in the text. It can be summarized that these two tasks mainly involve the collec-tion, organization and summary of key information, and ensure the comprehensiveness and reliability of information. For such rela-tively basic tasks, when multiple agents can communicate, multiple agents can share their own information, and the information pro-vide by these agents can be used to correct errors and complement each other to improve the comprehensiveness and reliability. The final decision-making power of the leader is not very useful for such information-collecting-and-summarizing and non-decision-making tasks. Therefore, we can observe that the horizontal structure and the hybrid structure perform better in these two tasks because they allow communication and collaboration between agents.\nAs shown in the information flow in Figure 4, there is com-munication between agents in the horizontal structure and the hybrid structure. One agent can make supplementary analysis or"}, {"title": "4.4.4 Financial Decision Making Analysis", "content": "Lastly, we perform a financial decision analysis by integrating three key sub-tasks. This integration aims to provide a comprehensive evaluation of our system's performance. We leverage GPT-4 to predict stock prices for the upcoming week with the information provided by three sub-tasks and provide investment recommendations. On the one hand, we utilize the same structure-generated content to generate final decision. On the other hand, our sub-task analysis reveal that vertical agent structure excels in risk analysis, while single agent structure performs better in fundamental and market sentiment tasks. Consequently, we select the optimal structure for each sub-task, resulting in a \"ensemble structure.\"\nFirst, we evaluate the error between the target price predicted by GPT-4 for the upcoming week and the actual price. The error is defined as the absolute difference between the predicted and actual"}, {"title": "5 CONCLUSION", "content": "This paper investigates the impact of Al agent structures on finan-cial document analysis tasks. We designed Al agents of varying sizes: single, dual, and triple. Additionally, we implemented dif-ferent collaborative structures among multiple AI agents, namely horizontal, vertical, and hybrid configurations. Our experiments, conducted on the 10-K forms of 30 companies listed on the Dow Jones Index, reveal the heterogeneous performance of different Al agent structures across various tasks. The results highlight the importance of suitable AI agent structure selection in emphasizing financial documents. Overall, our findings provide valuable insights into the optimization of AI agent structures for financial document analysis, offering practical guidelines for enhancing performance through strategic design and collaboration.\nThis work is one step toward financial document analysis for fi-nancial tasks leveraging AI agents. Future research in this area may include: ensuring the continuous and complete flow of informa-tion in an extensively hierarchical multi-agent system; leveraging small-scale debates in group structure to enhance task performance; replacing the sub-optimal structure selection/combination strategy with a globally optimized task approach."}]}