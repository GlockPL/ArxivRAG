{"title": "Ensemble-based, large-eddy reconstruction of wind turbine inflow in a near-stationary atmospheric boundary layer through generative artificial intelligence", "authors": ["Alex Rybchuk", "Luis A. Mart\u00ednez-Tossas", "Stefano Letizia", "Nicholas Hamilton", "Andy Scholbrock", "Emina Maric", "Daniel R. Houck", "Thomas G. Herges", "Nathaniel B. de Velder", "Paula Doubrawa"], "abstract": "To validate the second-by-second dynamics of turbines in field experiments, it is necessary to accurately reconstruct the winds going into the turbine. Current time-resolved inflow reconstruction techniques estimate wind behavior in unobserved regions using relatively simple spectral-based models of the atmosphere. Here, we develop a technique for time-resolved inflow reconstruction that is rooted in a large-eddy simulation model of the atmosphere. Our \"large-eddy reconstruction\" technique blends observations and atmospheric model information through a diffusion model machine learning algorithm, allowing us to generate probabilistic ensembles of reconstructions for a single 10-min observational period. Our generated inflows can be used directly by aeroelastic codes or as inflow boundary conditions in a large-eddy simulation. We verify the second-by-second reconstruction capability of our technique in three synthetic field campaigns, finding positive Pearson correlation coefficient values (0.20 > r > 0.85) between ground-truth and reconstructed streamwise velocity, as well as smaller positive correlation coefficient values for unobserved fields (spanwise velocity, vertical velocity, and temperature). We validate our technique in three real-world case studies by driving large-eddy simulations with reconstructed inflows and comparing to independent inflow measurements. The reconstructions are visually similar to measurements, follow desired power spectra properties, and track second-by-second behavior (0.25 > r > 0.75).", "sections": [{"title": "INTRODUCTION", "content": "Even though gigawatts of utility-scale wind turbines have been deployed to date, it remains difficult to precisely assess the accuracy of the tools used to design those turbines when they operate within the atmospheric boundary layer (ABL). While many factors complicate the model validation and uncertainty quantification process for utility-scale turbines, here we are particularly interested in the challenges associated with the turbulent inflow, as inaccurate inflow reconstruction hampers\u00b9 model validation for complicated turbine dynamics that can occur for large turbines\u00b2 (e.g., unsteady aerodynamics, vortex-induced vibrations). In this study, we are specifically interested in an accurate and probabilistic reconstruction of the ABL three rotor diameters (D) upwind of the turbine over a single 10-min window. While utility-scale turbine validation studies often compare against time-averaged quantities of interest1,3,4, in this paper, we are also motivated by time-resolved turbine validation (also known as one-to-one turbine validation) in which one validates against time-varying quantities of interest to specifically examine dynamical behavior. As such, we seek to produce inflows that track observations on a second-by-second basis, as opposed to those that strictly track time-averaged quantities5.\nTo reconstruct second-by-second inflow upwind of a turbine, three components are needed: wind observations, a model of atmospheric winds, and an analysis technique to reconcile the two. Wind observations often come from a meteorological mast6, though increasingly, nacelle-mounted lidar systems7,8,9 and hub-mounted lidar systems 10 are also being used. Observations provide wind information at a small region in space; in isolation, they rarely provide all the inflow information that is needed to run aeroelastic simulations. For example, meteorological masts can provide high-frequency measurements of three velocity components (u, v, w), although only at a few fixed points across their vertical span. Conversely, turbine-mounted lidars measure incoming flow across a larger volume, although only in the form of line-of-sight velocity and typically at a coarser temporal resolution. In contrast, atmospheric models that are used for turbine inflows can simulate plausible wind behavior at heights everywhere between the ground and the rotor tip at high temporal resolution, and they typically output all three velocity components that are used by turbine aeroelastic codes. However, when they are not coupled to observations or mesoscale models, atmospheric turbine inflow models simulate idealized atmospheric flows that correspond to desired bulk characteristics (e.g., time-averaged hub-height wind speed, turbulence intensity (TI) over a 10-min window) as opposed to an observed, real-world atmosphere. To reconstruct second-by-second, real-world inflow over the full rotor disk, analysis techniques combine information from both observations and models. In the wind energy community, these blending techniques have been based off methods such as kriging 11,12 and linear interpolation within the spectral domain 13. This process of reconstructing turbine inflows by combining observations with atmospheric modeling is often referred to as \u201cconstrained turbulence generation\u201d within the wind energy community.\nTo date, one-to-one turbine validation studies 6,7,8,14,15 have used practical, but physically limited, spectral-based models of turbulence to generate observation-informed, second-by-second inflows. Turbine inflows are predominantly modeled by using one of two spectral-based models of turbulence: Kaimal-based methods16 and Mann-based methods17. Spectral-based turbulence models come with a number of benefits. For example, they are relatively computationally inexpensive, they are trusted enough to be incorporated into design standards 18, and of particular interest here\u2014they have demonstrated that they can be used to reconstruct turbine inflow with second-by-second measurements from point sensors and scanning lidars 13,19,20. While spectral-based turbulence models are powerful and have demonstrated success in the wind sector, they come with several limitations for use in one-to-one turbine model efforts. First, while these inflow models have already been used for one-to-one turbine validation efforts, the constrained turbulence models themselves have never been validated in their ability to reconstruct second-by-second inflows against atmospheric measurements. While inflow generation models have been validated for time-averaged statistics7, to our knowledge there are no published studies in which a constrained inflow is created by using atmospheric observations at one region in space (e.g., hub height) and then validated against held out data in a second-by-second basis at a different location (e.g., at the top of the rotor). Reconstructed atmospheric winds are a key input into the one-to-one turbine validation model process, and as such, it is important to characterize the accuracy and confidence associated with these reconstructions. Second, the spectral-based turbulence models use modeling assumptions that limit their physical realism, and these assumptions translate to impacts in modeled turbine loads. For example, Holtslag et al. (2016)21 discuss the limited coupling between wind shear and turbulence during non-extreme conditions in spectral-based turbulence models; this coupling has implications for fatigue predictions. In a similar vein, spectral-based turbulence models do not simulate the dynamic interactions between buoyancy and velocity fields. As such, these models do not explicitly incorporate atmospheric stability when generating turbulence. This assumption impacts the types of turbulent coherent structures that are generated 22,23, thereby impacting the modeled turbine loads 24,25. Regarding the physical realism of spectral-based turbulence models, a recent survey paper26 summarizes that \u201cthere are several other phenomena that are missing in current [spectral-based] inflow models that likely have a significant impact on design loads.\"\nIn contrast, large-eddy simulation (LES) codes model the atmosphere with higher physical consistency. Within wind energy research, LES is routinely used as \u201cground truth\" against which lower-fidelity models are calibrated 27,28. LES has been used in utility-scale turbine validation efforts, though only in studies that validate against time-averaged quantities of interest1,29. We note that while LES is likely more accurate than spectral-based atmospheric models at modeling the ABL, LES is still an imperfect model approach with documented inaccuracies 30,31, and it does not consistently validate better than simpler inflow models in wind energy studies 1,29. Limited validation of LES as well as large computational costs are major barriers to the adoption of this atmospheric model by the wind industry 32.\nOver the years, LES has improved in its ability to simulate ABLs that correspond to real-world conditions. Early wind energy LES studies for finite-length wind farms were relatively idealized. They derived their turbine inflows from precursor LES runs with steady, large-scale forcing and periodic boundary conditions 33,34. In recent years, wind LES studies have demonstrated the ability to simulate ABLs that better correspond to real-world ABLs by including unsteady large-scale information into inflow-outflow boundary conditions. To date, the time-varying forcing is driven by data that is relatively coarse for LES spatiotemporal scales. Data comes from either mesoscale models 35,36 (grid size O(1 km)) or vertical columns of observations available at 10-min intervals 37,38. In contrast, LES of the ABL is conducted at spatial resolutions of O(10 m) and temporal resolutions of O(1 s). Outside of the wind energy community, we note that the \u201cLASSO\u201d project39,40 is also making advances in observation-LES coupling in the ABL, though at coarser spatiotemporal timescales than we are interested in here.\nWhile LES codes have advanced over the years, they still have not been used as part of one-to-one turbine validation studies. Fundamentally, this issue stems from the challenge of reconciling turbulent LES fields (O(10 m, 1 s)) with second-by-second observations41. To be specific, given noisy, high-frequency, spatially limited observations, how does one generate initial conditions and boundary conditions (and possibly optional body forces) for an LES run that could be used to emulate a particular real-world ABL? And how does one do this in a probabilistic manner to account for the highly chaotic nature of the ABL? One proposed strategy is \u201cdata assimilation\u201d42, a technique deployed routinely by operational weather forecasting centers to fuse information from atmospheric observations and mesoscale simulations or synoptic-scale simulations. In recent years, data assimilation has also been applied to LES studies 43,44, including LES studies of wind energy45,46. However, LES-coupled data assimilation has not yet been demonstrated for a real-world fluid flow (e.g., in an experimental facility or in the ABL). While data assimilation produces an observation-informed estimate of the state of the interior of a simulation domain, it does not provide an estimate of boundary conditions. The lack of observation-informed boundary conditions is a major roadblock for LES of an ABL, as the common choice of periodic boundary conditions used for idealized LES simulations does not reflect a real-world ABL. Another strategy to blend observations and simulations of a highly turbulent fluid is \u201cnudging\u201d47. The mesoscale-microscale simulations described above use nudging techniques successfully to track flows on relatively coarse temporal scales. However, in a fluid mechanics study of turbulent flow around a cylinder, Zauner et al. (2022)48 found that nudging a flow with a coarse observation network (as would be found in an ABL field campaign) produces unphysical artifacts. In recent years, machine learning algorithms have shown promise in their ability to reconstruct the state of highly turbulent fluids from limited measurements, thereby potentially addressing some barriers for LES-based inflow reconstruction. Fluid mechanics studies have demonstrated machine learning-based flow reconstruction in both computational environments 49,50 and in experimental fluid mechanics facilities51,52. The weather community is also developing new techniques 53,54 that leverage machine learning to reconcile observations and atmospheric simulations on the mesoscale and synoptic scales. In earlier work 55,56, we studied the ability of one ne particular class of machine learning algorithm\u2014a diffusion model 57,58\u2014to reconstruct ensembles of three-dimensional turbulent states from a set of noise-free, spatially limited measurements in a computational analogue of a field campaign. We found that the diffusion models were able to generate plausible realizations of instantaneous atmospheric turbulence, even with relatively sparse measurements. The ensemble of realizations for each individual observation showed meaningful diversity, thereby providing a measure of uncertainty associated with the reconstruction. Crucially, we demonstrated that these reconstructions successfully interfaced with an LES code by treating them as initial conditions and conducting hundreds of numerically stable LES runs. While these studies demonstrated the potential of using diffusion models for real-world turbine inflow reconstruction, they had three fundamental limitations. First, they omitted all time history knowledge from observations, reconstructing an instantaneous box of fluid flow instead of time-varying information. Second, they used idealized, noise-free measurements. And third, they were tested in a \u201cbest-case scenario\" synthetic LES environment instead of in the real world.\nIn this paper, we develop, verify, and validate an approach to generate turbine inflow that is grounded in an LES model of the atmosphere and conditioned on second-by-second, real-world measurements. We generate ensembles of inflows by leveraging diffusion models. We verify the accuracy of our inflow generation technique by running three synthetic field campaigns in an LES run, enabling us to identify strengths and weaknesses of the algorithm in a best-case scenario. We then validate our technique in the real world by using measurements from three different time windows of the Rotor Aerodynamics Aeroelastics and Wake (RAAW) field campaign. While our new inflows enable us to conduct one-to-one validation of turbine models with LES, we limit our scope to the turbine inflow and omit validation of the turbine model. We stress that our reconstruction methodology also comes with limitations (detailed later in this manuscript), though an initial one-to-one turbine validation effort suggests that LES-based inflows have potential to improve upon inflows from kinematic models59. In Section 2, we discuss the RAAW field campaign and its observations of the atmosphere. In Section 3, we detail our inflow generation technique. In Section 4, we verify our technique in a synthetic field campaign. In Section 5, we validate against real-world measurements and also conduct"}, {"title": "THE RAAW FIELD CAMPAIGN", "content": "The RAAW campaign collected high-resolution and high-coverage atmospheric and turbine measurements in order to validate computational models of the aeroelastic, aerodynamic, and wake behavior of modern land-based wind turbines with flexible blades. The experiment took place in Lubbock, Texas, United States, between May and October 2023. The subject of the experiment was a 2.8-MW wind turbine manufactured and owned by GE Vernova, with a rotor diameter of D = 127 m and a hub height of 120 m. The absence of nearby wind turbines and the simple terrain simplifies the task of model validation, allowing us to focus on the detailed dynamics of the inflow and structural response to a single operating turbine without the added complexities of wind farm interactions and topography."}, {"title": "Instrumentation", "content": "The campaign deployed several measurement systems that we use in this study. We primarily reconstruct inflow with the use of a commercial nacelle-mounted scanning lidar (Halo Streamline XR) that faces upwind. Throughout this text, we use the nomenclature \u201clidar\u201d or \u201cinflow lidar\" to specifically refer to this lidar that is used for inflow reconstruction, whereas the SpinnerLidar (discussed more below) is always referred to by its full name. The inflow lidar conducts horizontal plan position indicator (PPI) scans between azimuth values of -15\u00b0 to 15\u00b0 at a resolution of 2\u00ba, sweeping parallel to the ground at hub height and measuring line-of-sight velocities. The scan was optimally designed to capture the most energetic spatiotemporal modes expected in the flow 60. The lidar scans at each azimuth for 1 s, and takes 2 s to reset to its initial azimuth after each sweep. As such, one two-dimensional scan takes 18 s to complete. The range gate length of the lidar is 12 m. During high thrust operation, the turbine tower bending induces a positive tilt of ~1\u00b0 on the lidar scanning plane, which translates into a vertical displacement of less than 6 m at 3D, and we neglect this effect in our inflow reconstruction process. As the inflow lidar is mounted on the nacelle and stares upwind, turbine blades sweep by during measurements, obstructing between a third and a quarter of measurements from this instrument.\nWhile the inflow lidar provides the second-by-second observations that we explicitly use for the inflow reconstruction, we use information from two additional instruments to implicitly condition our inflow planes. A meteorological mast sits ~390 m (~3D) away from the turbine, along the direction 185\u00b0 relative to north. The mast is instrumented with cup anemometers near the bottom of the rotor (~56 m), at hub height (120 m), and near the top of the rotor (~183 m). We use cup anemometer measurements to calculate time-averaged vertical profiles of wind speed and turbulence intensity. We also use a profiling radiometer at the site to estimate the height of the capping inversion.\nWe validate against measurements from an independent (i.e. not used in the reconstruction) inflow sensor. The hub-mounted SpinnerLidar61,62 measures line-of-sight winds following a rosette pattern in the SpinnerLidar frame of reference ~1D up-stream with a diameter approximately matching the rotor at 127 m and a maximum half-angle of 30\u00b0. The SpinnerLidar conducts high-frequency scans (approximately 977 points every 2 s). Importantly, the SpinnerLidar provides inflow measurements above and below hub-height that the inflow lidar has not seen. As such, we validate our reconstructions against these winds to test their accuracy in regions where the reconstructions did not have observational data."}, {"title": "Intensive observation periods", "content": "We select three 704-s windows during which our key instruments reported high-quality data. The atmospheric dynamics are relatively stationary and consistent across all three periods (Table 1). These periods start at 15:00:25 UTC, 15:30:25 UTC, and 16:00:25 UTC on July 24, 2023, and we refer to these periods as the 1500, 1530, and 1600 Periods, respectively. The measurements were collected during daytime on a clear-sky day (local time is UTC \u2013 5 hours). We select the window lengths to be slightly longer than 10-min periods so that we can discard data during a simulation spin-up transient and then have enough data to validate during the industry-standard, 10-min window. Between 15:00:00 UTC and 16:15:00 UTC, the average hub-height wind speed measured at the meteorological mast is 9.03 m s\u00af\u00b9 and the average surface heat flux is 0.184 K m s\u00af\u00b9. The vertical shear of wind speed is low for this period, as the time-averaged wind speed is 8.82 m s\u00af\u00b9 at 56.6 m and 8.96 m s\u00af\u00b9 at 183.5 m. The average hub-height wind direction is 224\u00b0 relative to north, which means that the meteorological mast and lidar systems are seeing similar but distinct second-by-second flow. The capping inversion height is approximately 800 m."}, {"title": "INFLOW RECONSTRUCTION METHODOLOGY", "content": "Before detailing the specifics of our inflow reconstruction methodology, we first provide a high-level overview of objectives, inputs, and the process. To distinguish our second-by-second reconstruction problem from the problem of model-observation blending via mesoscale-microscale coupling, we refer to the second-by-second reconstruction problem as \"large-eddy reconstruction\" (LER). We view the LER problem as a model-observation reconciliation problem, where the goal is to reconstruct large eddies, the kinds of which would be explicitly resolved by an LES code. The reconstructed turbulent flow field could correspond to an instantaneous volume, a time-varying plane, or a time-varying volume. In principle, this problem could be ad-dressed through the use of data assimilation techniques, nudging approaches, or through machine learning algorithms. In this paper, we demonstrate one approach to address the LER problem."}, {"title": "Overview and problem definition", "content": "Problem In this work, we seek to reconstruct second-by-second inflow 380 m (~3D) upwind of a turbine over the course of a 10-min window by blending information from second-by-second observations and an atmospheric model. We select this lo-cation to minimize slowdowns from turbine induction effects63 while maintaining acceptable inflow lidar measurement quality. Our second-by-second observations come from a nacelle-mounted lidar measuring at hub height. Our model of atmospheric winds, which will be used to reconstruct the unobserved inflow information, is based on LES data.\nInputs To generate the LES dataset that is used to train the LER networks, we require time-averaged meteorological mea-surements, namely, vertical profiles of wind speed profiles, vertical profiles of TI, and the height of the capping inversion. To generate the LES dataset, we also require knowledge of the inflow lidar sampling strategy. After the LES dataset has been cre-ated and the networks have been trained, we can then generate observation-informed inflows. To generate these inflows, we require line-of-sight measurements from a nacelle-mounted lidar.\nOutputs The LER pipeline generates an ensemble of Nens = 30 inflow fields, each with a width of Ly = 320 m, a height of L\u2082 = 240 m, and time length Ltime = 704 s at a time step of 1 s and a spatial resolution of 10 m. Therefore, each inflow plane is sized (Ntime, Ny, Nz) = (704,32, 24). The reconstruction area covers the entire cross-sectional area of the wind turbine footprint laterally and vertically, plus a buffer region. We reconstruct four correlated variables: three velocity components (u, v, w) and temperature (T). These inflow planes can be used in stand-alone aeroelastic turbine simulations (e.g., OpenFAST) or as boundary condition information in our LES code AMR-Wind64.\nProcess We convert these inputs into outputs through the use of a preprocessing step as well as two diffusion model architec-tures (Fig. 1). The first diffusion model reads in preprocessed, gridded u measurements sized Ltime by Ly,in = 200 m and outputs a two-dimensional plane of (u, v, w, T) data sized (Ltime, Ly). In the language of the computer vision literature, this network can be thought of as solving a style transfer problem or more broadly a generic image-to-image translation task, translating from noisy lidar measurements to the underlying LES fields. To use language more akin to the wind energy literature, we refer to this network as the \u201clidar denoising\" network, as it reads in noisy lidar measurements and outputs LES-style fields, though strictly speaking, this network conducts additional operations to noise removal. The second diffusion model architecture reads the two-dimensional output from the first network and vertically extrapolates to the ground and to a height of 240 m to pro-duce three-dimensional inflows sized (Ltime, Ly, Lz) for all Nchan = 4 variables of interest. In the computer vision literature, this process would be referred to as either an \u201cinpainting\u201d or \u201coutpainting\u201d task65,66, during which we fill in regions of missing (unobserved) data in a way that is consistent with our observed data. Correspondingly, we refer to this model as the inpainting model."}, {"title": "Preprocessing inflow lidar measurements", "content": "Instead of directly feeding inflow lidar measurements into the lidar denoising network, we first preprocess them so that the denoising task is simpler. The inflow lidar returns line-of-sight velocity measurements every 12 m along a beam that changes position every 1 s. The measurements from beams during a single left-to-right sweep can be concatenated to obtain a two-dimensional line-of-sight measurement in a sector of a circle at a frequency of 1/18 Hz. We de-project67 the line-of-sight velocities to estimate streamwise velocity, u, perpendicular to the nacelle heading. We follow the temporal upsampling algorithm of Beck and K\u00fchn (2019)68 to upsample two-dimensional sweeps of u to a temporal resolution of 1 Hz. We ad-just their algorithm to account for missing individual beams (due to blade passage) by using a nearest-neighbor interpolation algorithm to fill in missing data in each 1/18-Hz sweep prior to upsampling. After upsampling the sweeps, we use nearest-neighbor interpolation to go from the polar grid (i.e. velocities as a function of azimuth, radius and time) onto a Cartesian grid perpendicular to the rotor (i.e., velocities as a function of streamwise and spanwise spatial coordinates, and time). Only the in-terpolated measurements 380 m upwind of the nacelle are fed into the machine learning algorithms. Thus, after preprocessing the inflow lidar measurements, we have a rectangular grid of hub-height u measurements sized (Ly,in, Ltime)."}, {"title": "Generating a training dataset via a synthetic, LES analogue", "content": "After identifying our observational period of interest and the inflow lidar scanning strategy during those periods, we set up a synthetic analogue of the real-world field campaign using LES. This process of running a synthetic field campaign is sometimes referred to as an observing system simulation experiment (OSSE), which is the terminology we adopt here."}, {"title": "INFLOW VERIFICATION AGAINST SYNTHETIC FIELD CAMPAIGNS", "content": "While our ultimate goal is to demonstrate the accuracy of our LER approach against real-world measurements, we first assess its performance in an OSSE study that represents our best-case scenario for real-world reconstruction. We spin up a new LES ABL that has the same bulk forcing as the one used to generate training data (Section 3.3), except we initialize the atmosphere with a different perturbation. This change means that our OSSE produces similar turbulent structures that are observed in our"}, {"title": "OSSE configuration", "content": "training dataset, though the exact timing, location, and shape of those structures is different in the training data generation run. We allow this ABL to spin up for 3.5 h, as this timing places us in the middle of the training dataset generation period. Following a common procedure for running LES of turbines 33, we continue to simulate the atmosphere after spin-up for 15 min using the same periodic boundary conditions that were used during spin-up. During this precursor phase, we collect boundary condition information for the simulation domain.\nUsing this domain boundary condition data, we then run three separate inflow-outflow simulations for the same time window. In each of these, we run an OpenFAST model of the RAAW turbine. Each of the turbines has an x-coordinate of 7,680 m. The three turbines have y-coordinates of 3,840 m, 7,680, and 11,520 m, and we refer to these cases as OSSE1, OSSE2, and OSSE3, respectively. We collect nacelle-mounted synthetic lidar measurements akin to our real-world PPI scans for the last 704 s of the OSSES. We corrupt these perfect lidar measurements of the flow field by using our estimated real-world corruption procedures (Section 3.3). We also collect the ground-truth LES inflow planes 3D upwind for the same time window. In doing so, we can reconstruct ensembles of inflow planes using the synthetic noisy lidar measurements, and we can compare all four field variables to ground-truth inflow planes 3D upwind. This comparison is not feasible with the RAAW campaign measurements, where instead we can only compare to line-of-sight SpinnerLidar measurements 1D upwind. In addition to the nacelle-mounted lidar measurements on each turbine, we also collect synthetic SpinnerLidar measurements. These SpinnerLidar measurements are not used in this section (which is about inflows at 3D), but they are later used to give context to the real-world validation results (Section 5.4.2)"}, {"title": "Qualitative visualizations of the inflow planes from the OSSES", "content": "Do our reconstructed turbulence fields match the ground-truth fields \"well\"? Unfortunately, there is no single metric that can be used to satisfactorily answer this question, and often, the performance of an atmospheric model is assessed by simultaneously examining multiple quantities of interest (e.g., Taylor (2001)72, Chang and Hanna (2004)73). We use a combination of qualita-tive and quantitative assessments to provide responses to this question and suggest the usefulness of LER for utility-scale wind turbine inflow reconstruction. Due to space constraints within the manuscript, we only include a handful of visualizations here, and we include additional figures in the Supplementary Information (SI Section 1). There, we include figures for hub-height cross sections and time-height cross sections of all four variables. In this subsection, we limit the visualizations to the u field for OSSE3."}, {"title": "Quantitative assessment of the inflow planes from the OSSES", "content": "Next, we turn toward quantitative assessment techniques to demonstrate the capabilities of our LER algorithm. We begin by calculating the Pearson correlation coefficient74 through time between the true inflow and the reconstructed inflows for each matching grid cell, and then we average over the crosswind dimension (Fig. 7). This metric can be used to assess how well two time series track one another, where 1 denotes perfect correlation, 0 denotes no correlation, and -1 denotes perfect anticorrelation. The strongest correlation values are found for hub-height values of u, which is where there are observations. The ensemble spread is also narrow at this location, denoting high reconstruction confidence. When averaged across the crosswind dimension, the ensemble mean of the hub-height correlation value is approximately 0.85. If only looking at the profile at y = 0 m (not shown) instead of the horizontally averaged profile, that correlation value is 0.93; conversely, at the horizontal edge of the reconstruction, that correlation value is 0.65. The correlation values for u decay when moving vertically away from hub height, and the ensemble spread grows. Depending on the case study, ensemble mean u correlation values at the top and bottom of the inflow can be as large as 0.5 or as low as 0.2. The nonzero values denote that the diffusion model is able to learn non-negligible time correlations for u at unobserved heights. Similarly, while the diffusion model only receives observations of u, the Pearson correlation coefficient for v, w, and T takes on positive values depending on the height and case study. These consistently positive values denote that the diffusion model similarly learns correlations between u and the unobserved field variables.\nNext, we compare reconstructions of OSSE inflows using more traditional metrics, namely, horizontally averaged vertical profiles of the mean and variance of fields taken along the time dimension (Fig. 8). Due to space constraints, we visualize these quantities only for OSSE3 within the manuscript, and we share the similar plots for OSSE1 and OSSE2 in the Supplementary Information (SI Section 2). In general, the mean profiles (Fig. 8 a\u2013e) of the reconstructions match the shape of the ground-truth profiles, and the ensemble spread typically is wide enough to envelope the ground-truth profile. The reconstruction ensemble only fails to span the mean ground-truth values for horizontal wind speed and u. The largest two-dimensional wind speed deviations occur near rotor bottom. The deviations between the ground truth and the ensemble mean at these locations is no larger than 0.3 m s\u00af\u00b9 (or 3% relative error) across all three case studies. We believe these biases are driven by small differences between the atmosphere in the training dataset and the OSSE environment because of the presence of a turbine in each OSSE. Across all three OSSE case studies, the reconstructions slightly underpredict wind speed shear in the ground truth, the wind speed measurements at the rotor tip are ~0.6 m s\u00af\u00b9 stronger than they at the rotor bottom, whereas this difference is ~0.2 m s\u00af\u00b9 for the ensemble mean of the reconstructions. Put differently, the presence of the turbine appears to increase the shear 3D upwind of this turbine. This effect is counter to the findings of Forsting et al. (2018)75, which suggest that for low shear inflow, the presence of the turbine should not change the magnitude of the shear, although this study is conducted at the rotor disk instead of 3D upwind. We hypothesize that this slight underestimation in the reconstructed shear profile could simply be caused by random errors or possibly by small near-surface wind acceleration, as suggested by the discussion about TI below."}, {"title": "VALIDATION AND VERIFICATION AGAINST SPINNERLIDAR MEASUREMENTS", "content": "While the OSSE inflow study at 3D informs the accuracy of our LER approach under ideal conditions, to be useful for validat-ing real-world turbine models, we need to demonstrate that the LER technique can accurately reconstruct inflows that occurred in the real world. To do this, we generate inflows using real-world nacelle-mounted lidar measurements for three periods of the RAAW campaign (Section 2.2). We validate against real-world SpinnerLidar measurements for the coincident periods. How-ever, the reconstructed inflow planes at 3D are not directly comparable to the SpinnerLidar measurements at 1D-they are located at different upstream distances from the turbine, the SpinnerLidar winds are subject to stronger induction, and the Spin-nerLidar measures line-of-sight velocity along a spherical surface instead of providing (u, v, w) data in a plane. In this section, we first describe the use of \u201creconstruction simulations\u201d (Section 5.1) and SpinnerLidar data postprocessing (Section 5.2) that enable us to compare our reconstructed inflow to SpinnerLidar measurements. Then, we conduct qualitative (Section 5.3) and quantitative (Section 5.4.1) comparisons against the real-world SpinnerLidar measurements. In order to provide context to the real-world SpinnerLidar comparison results, we end this section by conducting additional SpinnerLidar analysis with the help of OSSES (Section 5.4.2). In this section, we discuss simple similarities and differences between the observed and reconstructed SpinnerLidar data without diving into the mechanisms behind these results. In Section 6, we hypothesize processes that could drive the differences, and we tie the real-world validation results back to the inflow verification analysis (Section 4)."}, {"title": "Configuration of the reconstruction simulations", "content": "To enable us to compare our reconstructed inflow to the SpinnerLidar measurements, we use our ensemble of inflows as inflow boundary conditions to drive an ensemble of LES runs. We dub these simulations \u201creconstruction simulations\". In these simulations, we situate the RAAW turbine 3D downwind of the inflow boundary, and we simulate a synthetic version of the SpinnerLidar. The simulated SpinnerLidar measurements are simplified approximations of the real-world SpinnerLidar measurements, for example, lacking sensor noise. The simulated SpinnerLidar matches the real-world scanning rate in time and space while accounting for probe volume averaging.\nThe reconstruction simulations are initialized with mean u and T profiles that match the observed profiles. Inspired by Troldborg et al. (2014)77, we embed our turbulent inflow with spatial dimensions (Ly, L\u2084) = (320 m, 240 m) within a laminar background flow that is sized (640 m, 1280 m). We make this decision because we need to prescribe lateral boundary conditions and the upper surface boundary condition. By using a laminar buffer, we are able to prescribe periodic boundary conditions for the lateral boundaries and a free-shear boundary for the upper boundary condition while minimally impacting the Spin-nerLidar region. As such, our reconstruction simulations are sized (1280 m, 640 m, 1280 m) using a 10-m grid resolution. Each simulation runs for 704 s, and we discard the first 104 s to mitigate transient behavior in the atmosphere and the turbine. To match possible dynamic induction effects that could impact inflow validation, our simulated turbines use a controller that synchronizes the modeled turbine's rotor position and blade pitch to the real-world turbine during the simulated time period. We note that all 90 of our reconstruction simulations that are driven by machine learning-generated turbulence (30 ensemble members across 3 cases) ran to completion without any obvious numerical instabilities, as suggested by the visual quality of SpinnerLidar reconstructions (Section 5.3).\nWhile our simulations of SpinnerLidar measurements enable us to validate our reconstructed inflows, these simulations come with a few important caveats. As a first caveat, during normal turbine operation, the rotor disk changes its yaw position to stay aligned with the direction of incoming wind. Our inflow reconstruction approach computes the inflow in the reference frame of the rotor disk instead of a global coordinate system that is relative to, e.g., the cardinal directions. In other words, we assume a fixed yaw position and we conduct our"}]}