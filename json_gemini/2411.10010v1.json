{"title": "DEEPMEDCAST: A DEEP LEARNING METHOD FOR GENERATING\nINTERMEDIATE WEATHER FORECASTS AMONG MULTIPLE NWP\nMODELS", "authors": ["Atsushi Kudo"], "abstract": "Numerical weather prediction (NWP) centers around the world operate a variety of NWP models, and\nrecent advances in AI-driven NWP models have increased the availability of diverse NWP outputs.\nWhile this expansion holds the potential to improve forecast accuracy, it also raises a critical challenge\nof identifying the most reliable predictions for specific forecast scenarios. Traditional approaches,\nsuch as ensemble or weighted averaging, combine multiple NWP outputs but often generate unrealistic\natmospheric fields, complicating the production of reliable and consistent forecasts in operational\nsettings.\nIn this study, we introduce DeepMedcast, a deep learning method that generates intermediate forecast,\nor \"medcast\", between two or more NWP outputs. Unlike ensemble averaging, DeepMedcast can\nprovide consistent and explainable medcast without distorting meteorological fields. This paper\ndetails the methodology and case studies of DeepMedcast, discussing its advantages and potential\ncontributions to operational forecasting.", "sections": [{"title": "1 Introduction", "content": "In recent decades, numerical weather predictions (NWPs) and their post-processing have played a central role in issuing\nweather forecasts, warnings, and advisories [WMO, 2013, Vannitsem el al., 2021]. NWP centers around the world have\ndeveloped and are operating a variety of NWP models for accurate weather predictions. For example, the European\nCentre for Medium-Range Weather Forecasts (ECMWF) operates the Integrated Forecasting System (IFS) and its\nensemble prediction system [ECMWF, 2024]; the UK Met Office operates the Unified Model and the Met Office\nGlobal and Regional Ensemble Prediction System [Brown et al., 2012, Hagelin et al., 2017, Inverarity et al., 2023].\nThe National Centers for Environmental Prediction (NCEP) at the National Oceanic and Atmospheric Administration\n(NOAA) operates the Global Forecast System [NCEP, 2016], the High-Resolution Rapid Refresh [Dowell et al., 2022],\nand the Hurricane Weather Research and Forecasting model [Gopalakrishnan et al., 2011]. The Japan Meteorological\nAgency (JMA) operates three deterministic NWP models and two ensemble prediction systems for short-range to\nweekly forecasts: the Global Spectrum Model (GSM), the Meso-Scale Model (MSM), the Local Forecast Model, the\nGlobal Ensemble Prediction System, and the Mesoscale Ensemble Prediction System [JMA, 2024]. These models cover\ndifferent areas with varying resolutions and processes.\nIn addition to traditional physics-based NWP models, recent advancements in artificial intelligence (AI) have introduced\nnew methods for producing weather predictions. AI-driven NWP models, such as FourCastNet [Pathak et al., 2022,\nBonev et al., 2023], GraphCast [Lam et al., 2022], Pangu-Weather [Bi et al., 2022, 2023], FengWu [Chen et al., 2023,\nHan et al., 2024], Aurora [Bodnar et al., 2024], GenCast [Price et al., 2023], and AIFS [Lang et al., 2024], have\ndemonstrated the ability to enhance both the speed and accuracy of weather predictions by leveraging deep learning\ntechniques to model complex atmospheric systems.\nAt present, forecasters are able to use multiple NWP models including AI-driven NWP models, which provide a range\nof possible atmospheric states, allowing them to select the most plausible prediction from available NWPs. However,\nthis raises a critical question: Which prediction is the most plausible? If the models have comparable accuracy, it is\nimpossible to determine in advance which one is the best. One practical and widely used solution is to average the results\nfrom multiple NWP models or their post-processed outputs [Vislocky and Fritsch, 1997, JMA, 2018]. The National\nHurricane Center and the Joint Typhoon Warning Center in the United States use consensus forecasts (e.g., Simon et al.\n[2018], Cangialosi et al. [2023]), which are weighted averages, extensively for both tropical cyclone (TC) track and\nintensity predictions. JMA employs consensus forecasting for TC track predictions by averaging multiple NWP outputs\nto improve forecast accuracy [Nishimura and Fukuda, 2019, JMA, 2022]. The UK Met Office operates the IMPROVER\nsystem [Roberts el al., 2023], which applies a weighted average of post-processing and nowcasts based on multiple\nNWP outputs. The National Weather Service (NWS) at NOAA operates the National Blend of Models (NBM), which\nprovides statistically post-processed multi-model ensemble guidance [Hamill et al., 2017]. The German Meteorological\nService uses MOSMIX and ModelMIX [Primo et al., 2024], which are weighted averages of post-processing based on\nIFS, their global model, and their regional ensemble model. Additionally, the World Area Forecast Centre, comprising\ncenters in London and Washington, operates harmonized forecasts, including mean, maximum, and minimum forecasts,\nfrom both NWP outputs for aviation hazards such as cumulonimbus clouds, turbulence, and in-flight icing [ICAO,\n2016].\nIt is straightforward to average the central position of TCs, extra tropical cyclones, or the location of fronts because\naveraging does not degrade their clarity. However, averaging atmospheric fields such as pressure or wind speed around\nthese systems is not appropriate. This is because averaging can smooth out or distort these fields, weakening the central\npressure or wind speeds around cyclones and fronts, resulting in predictions that are unrealistic, meteorologically\ninconsistent, and difficult to interpret. Forecasters must then choose between two options: using a single model that is\nexplainable but potentially less accurate or using an averaged prediction that is unexplainable and unrealistic but may\nbe more accurate.\nIn response to this dilemma, we propose DeepMedcast, a novel approach that uses deep learning to generate intermediate\nforecast-or \"medcast\"-between two or more NWP models. Unlike averaging, DeepMedcast can produce atmospheric\nfields around cyclones and fronts without smoothing out or disturbing their distributions. This capability is crucial\nin operational forecasts, where accurate and explainable predictions are needed for issuing reliable warnings and\nadvisories. To the best of the authors' knowledge, no existing method provides plausible intermediate forecasts by\ncombining multiple NWP model outputs.\nThis paper is structured as follows: Section 2 presents the methodology and data used for DeepMedcast, detailing the\ndeep learning architecture and training process. Section 3 discusses the results of applying DeepMedcast to multiple\nNWP models with case studies, and Section 4 offers a discussion of the advantages of DeepMedcast and its contributions\nto operational forecasting. Finally, Section 5 concludes with a summary of the findings and future research directions."}, {"title": "2 Method and data", "content": ""}, {"title": "2.1 The framework of DeepMedcast", "content": "The main idea behind DeepMedcast lies in its original approach to generating intermediate forecasts between two NWP\noutputs. Figure 1 illustrates the framework of DeepMedcast. During the training phase, instead of using two different\nNWP outputs intended for creating an intermediate forecast, DeepMedcast utilizes data at two forecast lead times (FT),\nFT = t - \u2206t and FT = t + \u2206t, from a single NWP model as input variables for the deep neural network (DNN) (Fig. 1a).\nThe output from the DNN is then compared to the forecast from the same NWP at the intermediate lead time (FT = t) to\ncalculate the loss for the backpropagation process. This approach enables the network to generate intermediate forecasts\nwithout blurriness, as the input variables are not inherently affected by forecast errors, and the predictions at FT = t\nare expected to lie between those at FT = t + At. During the inference phase, two different NWP outputs at the same\nforecast lead time are used to generate an intermediate forecast for the projection time (Fig. 1b).\nDeepMedcast is primarily designed to generate intermediate forecasts between two NWP models. However, the\nsame DNN model can be applied recursively to generate intermediate forecasts between more than two NWP models.\nFor instance, by taking intermediate forecasts between two pairs of NWP models, DeepMedcast can generate an\nintermediate result between four NWP models (Fig.2). This recursive approach could be extended further to create\nintermediate forecasts between 8, 16, or even more NWP models."}, {"title": "2.2 Data used for the study", "content": "The NWP model used for training is GSM, which is operated by JMA four times a day (at 00, 06, 12, and 18 UTC as\ninitial times). The training period spans nine years, from January 2013 to December 2021, while the validation period\ncovers one year, from January to December 2022. GSM had a horizontal resolution of approximately 20 km until March\n2023, after which it was upgraded to about 13 km [JMA, 2024]. The GSM data used in this study is stored at JMA,\nwhere it is trimmed and interpolated onto a 121 \u00d7 151 grid with a resolution of 0.25 degrees by 0.2 degrees around\nJapan (Fig. 3). Hereafter, we refer to this as the target grid domain.\nThe forecast variables include wind components (U, V), temperature (T), and relative humidity (RH) at both the surface\nand the 700 hPa level, and mean sea-level pressure at the surface (Psea). Each variable is used individually to train\nseparate networks, with each network dedicated to a single variable. That means, each DNN model always takes two\ninput channels (at FT = t - \u2206t and FT = t + \u2206t) and outputs one channel (at FT = t) for DeepMedcast. Both input channels\nare utilized by swapping their order, i.e., both FT = t - \u2206t and FT = t + \u2206t, as well as FT = t + \u2206t and FT = t - At,\nare employed to preserve symmetry. The networks trained with 700 hPa data are employed to generate intermediate\nforecasts for the upper atmosphere (e.g., 850 hPa, 700 hPa, and 500 hPa) to reduce computational costs. The forecast\nlead times used in this study are t = 9, 10, 11, 12, 13, and 14 hours, with At = \u00b13 and \u00b16 hours, corresponding to t and\nAt in Fig. 1, determined by taking both computational costs and accuracy into account.\nFor the case studies in Section 3, MSM, IFS, GraphCast, and Pangu-Weather are used along with GSM for inference.\nMSM is operated by JMA eight times a day (at 00, 03, and 21 UTC as initial times) with a 5 km horizontal resolution,"}, {"title": "2.3 DNN model architecture", "content": "In this study, a U-Net architecture [Ronneberger et al., 2015] is applied as the DNN model. The structure of the network\nis illustrated in Fig. 4. The encoder part of the U-Net utilizes a convolutional network with kernel size = 3, stride = 1,\nand padding = 1 for convolution operations. To progressively reduce the image size, MaxPooling layers with kernel\nsize = 2 and stride = 2 are employed. This downsampling process continues until the image size is reduced to 1/8 of\nthe original dimensions, at which point the channel count reaches 2048, starting from an initial 2 channels that are\nexpanded to 256 channels. In each downsampling stage, the image size is halved while the number of channels doubles.\nIn the decoder part, transposed convolutional layers with kernel size = 2 and stride = 2 are applied to upsample the\nfeature maps, restoring the image to its original size while reducing the channel count by half at each stage. By the final\nstage, the image is returned to its original dimensions with 256 channels, which are then reduced to 1 channel in the\noutput layer. The activation functions used in this network include rectified linear units (ReLU,[Nair and Hinton, 2010]\nfor all layers except the output layer, which uses a sigmoid function to ensure output values are scaled between 0 and 1.\nDuring the training phase, the two input channels and one ground truth channel, each consisting of 121 \u00d7 151 grids, are\nnormalized to a value range of 0 to 1 using the maximum and minimum values across all three channels. Specifically,\nfor T, RH, and Psea, the normalization is applied as:\n$x' = \\frac{x - x_{min}}{x_{max} - x_{min}}$"}, {"title": "3 Results", "content": "In this section, we demonstrate the capability of DeepMedcast through four case studies. The forecast data used here is\nfrom a period beginning in January 2023, which is independent of the DNN's training and validation periods. The case\nstudies compare the atmospheric fields generated by DeepMedcast with those obtained via arithmetic mean of the NWP\noutputs."}, {"title": "3.1 Case 1: Position discrepancy in a typhoon forecast between GSM and MSM", "content": "The first case study examines a typhoon forecast where there is a positional discrepancy between GSM and MSM.\nFigure 5 shows the predictions at FT = 51 hours based on the initial time of 12 UTC on 12 August 2023. This case\nfocuses on Typhoon LAN which was moving northwest over the ocean south of Japan. At FT = 51 hours, GSM\npredicted the typhoon's position at 33.3\u00b0N, 137.1\u00b0E, while MSM placed it southwest at 32.7\u00b0N, 135.7\u00b0E. Both models\npredicted a central pressure of 960 hPa, with the maximum wind speed of 79 kt (1 kt ~ 0.514 m s\u00af\u00b9) (GSM) and 68 kt\n(MSM) (Figs. 5a and 5b)."}, {"title": "3.2 Case 2: Discrepancy in a front position forecast between GSM and MSM", "content": "The second case study examines a forecast where there was a positional discrepancy in the predicted location of a front\nbetween GSM and MSM. Figure 6 shows the predictions at FT = 30 hours based on the initial time of 00 UTC on 17\nJune 2024. At the initial time, a stationary front was located south of Japan (not shown), and by FT = 30 hours, the\nfront was predicted to move northward toward Tokyo (indicated by the blue circles in the figure).\nGSM predicted the front to the south of Tokyo, indicated by the blue dashed line, with a clear wind direction and speed\nshear, which corresponds well with the 21\u00b0C isotherm around Tokyo (Fig. 6a). In contrast, MSM placed the front north\nof Tokyo (green dashed line), also with a clear wind direction and speed shear aligned with the 21\u00b0C isotherm (Fig.\n6b), resulting in a positional discrepancy between the two NWP models. Consequently, GSM predicted a northerly to\nnortheasterly wind and cooler temperatures around Tokyo, while MSM predicted southerly to southwesterly winds and\nwarmer temperatures, leading to significant differences in the forecast for Tokyo.\nThe arithmetic mean of the GSM and MSM predictions (Fig. 6c) results in a split structure for the front, with wind\nshear corresponding to the locations predicted by GSM and MSM (shown by the purple lines), while the 21\u00b0C isotherm\nis predicted between the two fronts. This demonstrates that when there is a discrepancy in the predicted front position,"}, {"title": "3.3 Case 3: Significant difference in low-pressure system position between GSM and MSM", "content": "The third case study highlights a situation where there was a large difference in the predicted position of a low-pressure\nsystem between GSM and MSM. Figure 7 shows surface wind and mean sea-level pressure, along with temperature\nand dew-point depression at 850 hPa, at FT = 75 hours based on the initial time of 12 UTC on 28 August 2024. At\nthe initial time, Typhoon SHANSHAN was located south of Kyushu at 30.6\u00b0N, 130.2\u00b0E, slowly moving northward\n(not shown). By 15 UTC on 31 August (FT = 75 hours), the system, which had either remained a tropical storm or\ntransitioned into a low-pressure system, was predicted by GSM to be south of the Kanto region at 35.4\u00b0N, 139.8\u00b0E (Fig.\n7a), while MSM placed it east of Hokkaido at 42.4\u00b0N, 147.3\u00b0E (Fig. 7b).\nThis case highlights a large positional difference of about 1000 km between the GSM and MSM predictions. When the\narithmetic mean of these is taken (Fig. 7c), it results in two distinct low-pressure systems at the positions predicted\nby each model, creating an unexplainable forecast. In contrast, DeepMedcast predicted a single low-pressure system\nlocated between the two forecasts, at 39.5\u00b0N, 143.0\u00b0E, off the coast of Sanriku (Fig. 7d). Additionally, when examining\nthe moisture area at 850 hPa (dew-point depression < 3\u00b0C), the arithmetic mean shows moist areas surrounding both\nthe GSM and MSM low-pressure systems, with a relatively dry region in between. On the other hand, DeepMedcast\nrepresents a moist area around its low-pressure system, consistent with the surface pressure field, providing a consistent\nand explainable forecast."}, {"title": "3.4 Case 4: Intermediate forecast between four NWP models for typhoon KHANUN", "content": "The fourth case study presents an intermediate forecast between four NWP models: GSM, IFS, GraphCast, and\nPangu-Weather. Figure 8 shows surface wind and mean sea-level pressure at FT = 108 hours, based on the initial time\nof 12 UTC on 2 August 2023. At the initial time, Typhoon KHANUN was located west of Okinawa at 26.2\u00b0N, 125.6\u00b0E,\nslowly moving westward (not shown). By 00 UTC on 7 August (FT = 108 hours), the central position was predicted by\nthe four models to be at 31.4\u00b0N, 131.1\u00b0E (GSM), 28.9\u00b0N, 133.0\u00b0E (IFS), 28.0\u00b0N, 131.2\u00b0E (GraphCast), and 28.8\u00b0N,\n130.7\u00b0E (Pangu-Weather). The central pressure and maximum wind speed for each model were as follows: 938 hPa and\n68 kt (GSM), 966 hPa and 51 kt (IFS), 977 hPa and 36 kt (GraphCast), and 975 hPa and 39 kt (Pangu-Weather) (Figs.\n8a-d).\nWhen the arithmetic mean of the four models is taken, the center splits into two, with a weakened central pressure of\n979 hPa and the maximum wind speed of 36 kt (Fig. 8e), both the same or weaker than the predictions of any individual\nmodel. In contrast, DeepMedcast predicted a single center at 29.3\u00b0N, 131.4\u00b0E, with the central pressure of 963 hPa\nand the maximum wind speed of 42 kt (Fig. 8f), representing an intermediate intensity forecast between the four\nNWP models. The average central pressure of the four NWP models was 964 hPa, closely matching DeepMedcast's\nprediction. The average maximum wind speed of the four models was 49 kt, meaning DeepMedcast's forecast was\nslightly weaker than the average."}, {"title": "4 Discussion", "content": "As demonstrated by the case studies in Section 3, DeepMedcast is capable of generating plausible and explainable\nintermediate forecast, or medcast. A notable feature of DeepMedcast is that, despite being trained solely on GSM data,\nit works effectively with other models such as MSM, IFS, GraphCast, and Pangu-Weather. This is significant because\nmost AI or machine learning (ML) methods in meteorology learn the relationship between input and target data, and\nwhen the characteristics of the input data change due to NWP model updates, retraining, fine-tuning, and/or online\nlearning are usually required. While this is an unavoidable task for most AI or ML methods in meteorology, it is a\ntime-consuming yet essential task that operational centers have traditionally managed. However, DeepMedcast can\ngenerate plausible medcasts without updating the DNN model since it is not designed to correct NWP model biases,\nwhich significantly reduces the maintenance costs for operational centers.\nAnother advantage of DeepMedcast is its flexibility in increasing the amount of training data. As mentioned in Section\n2, this study used t = 9\u201314 and At = \u00b13, \u00b16, and in our experience, increasing t and At leads to better forecast\nrepresentation. One common issue in training DNN models is a lack of sufficient training data (e.g., Deng et al. [2009],\nLeCun et al. [2015]). However, in the case of DeepMedcast, more training data can easily be generated by increasing t\nand At or by adding additional NWP models. It is important to note, though, that increasing t and At requires more\nmemory and computational time, which should be considered when expanding the dataset.\nA third benefit of DeepMedcast is its ability to provide predictions consistent with TC track forecasts. Currently, at\nJMA, TC track forecasts take precedence, and the forecasters responsible for general, marine, and aviation forecasts\nmust ensure that their forecasts are consistent with the TC track forecasts. However, up until now, there is no NWP\nmodel consistent with the TC track forecasts, forecasters need to adjust the existing NWP outputs in their minds to\nconstruct forecast scenarios that align with the TC track forecasts. DeepMedcast has a capability to provide NWP\noutputs that align with TC track forecasts, which could greatly improve the efficiency and standardization of tasks for\noperational forecasting.\nAdditionally, DeepMedcast can provide more accurate forecasts than the input models. By predicting the intermediate\nstate between multiple NWP models, DeepMedcast can reduce random errors inherent in each NWP model, similar to\nthe consensus forecasting used for typhoon tracks and other ensemble post-processing methods like IMPROVER, NBM,\nand MOSMIX. Numerical weather predictions and their post-processing are the foundation for issuing weather forecasts,\nwarnings, and advisories, therefore NWP centers are continually working to improve forecast accuracy. Recently,\nAI-driven NWP models have emerged with accuracy that partially surpass traditional physics-based NWP models."}, {"title": "5 Summary", "content": "In this paper, we introduced DeepMedcast, a novel approach for producing intermediate forecast, or \"medcast\", between\ntwo or more NWP models. DeepMedcast was developed to generate accurate and explainable medcast, bridging the\ngap between NWP model outputs.\nA key advantage of DeepMedcast is its applicability to any NWP outputs without the need for retraining or fine-tuning\nthe DNN. By providing reliable medcasts, DeepMedcast can significantly enhance the efficiency and standardization of\noperational forecasting tasks, including general, marine, and aviation forecasts.\nFurthermore, the introduction of the medcast concept offers a new form of prediction, standing alongside forecast,\nnowcast, and hindcast. Medcast not only generates intermediate forecasts but also provides a new approach to combining\nmultiple NWP outputs, making it a valuable tool in modern meteorology.\nAlthough DeepMedcast introduces some advancements, further research and development are needed to address\nseveral challenges. In this study, U-Net was employed as the DNN architecture; however, advanced methods such as\nTransformers [Vaswani et al., 2017, Dosovitskiy et al., 2020] and Diffusion models [Song and Ermon, 2019, Ho et al.,\n2020] may further enhance DeepMedcast's representational capabilities. As shown in the case study in Section 3.4, the\ncurrent method tends to slightly underestimate the maximum wind speed near TCs. Enhancing the DNN could help\nresolve this issue. Additionally, by developing post-processing methods that use DeepMedcast as input, it would be\npossible to provide even more accurate predictions with consistency. Lastly, this study did not address intermediate\nprecipitation forecasts. Since precipitation is one of the most critical variables in weather forecasting, future work will\nfocus on developing intermediate precipitation forecasts."}, {"title": "Data Availability Statement", "content": "The datasets used in this study are available from the following sources: The GSM and MSM data are operationally\nproduced by JMA and can be accessed through the Japan Meteorological Business Support Center (http://www.\njmbsc.or.jp/en/index-e.html). The IFS data are accessible to WMO members via the ECMWF website (https:\n//www.ecmwf.int/en/forecasts/datasets/wmo-additional). The GraphCast and Pangu-Weather source code\nand plugins are available under open-source licenses in the ECMWF GitHub repository (https://github.com/\necmwf-lab/ai-models). Pre-trained models of Pangu-Weather and GraphCast, used without modification to generate\nforecast data, are specifically accessible at https://github.com/ecmwf-lab/ai-models-panguweather and\nhttps://github.com/ecmwf-lab/ai-models-graphcast."}]}