{"title": "GPO-VAE: MODELING EXPLAINABLE GENE PERTURBATION\nRESPONSES UTILIZING GRN-ALIGNED PARAMETER\n\u039f\u03a1\u03a4\u0399\u039c\u0399\u0396ATION", "authors": ["Seungheun Baek", "Soyon Park", "Yan Ting Chok", "Mogan Gim", "Jaewoo Kang"], "abstract": "Motivation: Predicting cellular responses to genetic perturbations is essential for understanding\nbiological systems and developing targeted therapeutic strategies. While variational autoencoders\n(VAEs) have shown promise in modeling perturbation responses, their limited explainability poses\na significant challenge, as the learned features often lack clear biological meaning. Nevertheless,\nmodel explainability is one of the most important aspects in the realm of biological AI. One of\nthe most effective ways to achieve explainability is incorporating the concept of gene regulatory\nnetworks (GRNs) in designing deep learning models such as VAEs. GRNs elicit the underlying causal\nrelationships between genes and are capable of explaining the transcriptional responses caused by\ngenetic perturbation treatments.\nResults: We propose GPO-VAE, an explainable VAE enhanced by GRN-aligned Parameter\nOptimization that explicitly models gene regulatory networks in the latent space. Our key approach is\nto optimize the learnable parameters related to latent perturbation effects towards GRN-aligned ex-\nplainability. Experimental results on perturbation prediction show our model achieves state-of-the-art\nperformance in predicting transcriptional responses across multiple benchmark datasets. Furthermore,\nadditional results on evaluating the GRN inference task reveal our model's ability to generate mean-\ningful GRNs compared to other methods. According to qualitative analysis, GPO-VAE posseses the\nability to construct biologically explainable GRNs that align with experimentally validated regulatory\npathways.\nAvailability and Implementation: GPO-VAE is available at https://github.com/\ndmis-lab/GPO-VAE", "sections": [{"title": "1 Introduction", "content": "Predicting cellular responses is crucial for understanding biological systems and complex cellular behavior, enabling the\nrational manipulation of cells to develop targeted therapeutics and improve treatments for various diseases. To address\nthe task, many computational methods have been introduced in the realm of perturbation modeling [6]. Generative\nmodeling approaches have emerged as a key research focus in computational gene perturbation response prediction\ntasks [8, 10, 11]. In particular, variational autoencoders (VAEs) have become popular deep-learning model choices as\nthey can learn latent features underlying perturbation responses from observed perturbation data during their training\nprocess.\nHowever, the complex nature of perturbation experiments, including cell-specific contexts and technical variations,\npresents several challenges for improving the VAE's generalizability. Disentangled VAEs, with their ability to learn\ndisentangled representations despite these complexities, have become promising tools in perturbation modeling [8].\nThe main intuition is to enable VAEs to effectively disentangle and learn distinct latent subspaces such as those\ncorresponding to perturbation effects and cell basal states. Notable models that pioneered this design approach are\nSVAE+ [10] and SAMS-VAE [8], both of which demonstrated success in improving perturbation response predictions\nthrough disentanglement of latent subspaces. Recently, Baek et al. tackled the issue of technical artifacts that affect\nexperimental perturbation data quality and introduced CRADLE-VAE, a model that additionally learns a latent subspace\nrelated to artifacts utilizing counterfactual reasoning. This approach not only enhanced the prediction accuracy and\nrobustness of the model but also improved its generative quality.\nThe main key design element in these VAEs is the Sparse Mechanism Shift hypothesis [27]. This hypothesis assumes that\nwhen a gene perturbation treatment is applied to a cell, only a few proportion of biological causal mechanisms contribute\nto the overall transcriptional gene expression changes. Encouraging sparsity on the latent features corresponding to\ngene perturbation effects has demonstrated robustness in predicting perturbation responses.\nHowever, explainability remains a crucial element in biological and healthcare AI, particularly from medical, legal, and\nethical perspectives [29]. In fact, VAEs have limited explainability due to its learned latent representations lacking clear\nand direct associations with specific biological processes [28].\nOne promising approach to address these explainability issues is to incorporate the concepts of gene regulatory networks\n(GRNs) in the core design of VAES. GRNs provide a mechanistic framework for understanding and predicting how\ncells respond to genetic perturbations. By aligning the latent subspace related to gene-specific perturbation effects with\ngene-gene causal relationships, it is possible to retain the benefits of sparsity while enhancing model explainability.\nFurthermore, guiding the learning trajectories of VAEs towards formation of GRNs derived from perturbation dataset\nmay provide valuable insights related to cell-specific biological pathways.\nIn this work, we introduce GPO-VAE, a VAE that exploits the concepts of gene regulatory networks for enhanced\nexplainability. While retaining the Sparse Mechanism Shift hypothesis as a fundamental principle, we redesign the latent\nsubspace responsible for modeling gene perturbation effects so that it aligns with GRN topologies. Specifically, we\nimplemented GRN-Aligned Parameter Optimization, that guides the stochastic learning of prior parameters for sampling\nsparsity-inducing masks towards biologically explainable GRNs. While maintaining competitive performance in\npredicting transcriptional responses to perturbations, we demonstrate that the GRN constructed by GPO-VAE not only\nexplains the perturbation data but also effectively captures important regulatory pathways that align with experimentally\nvalidated biological pathways."}, {"title": "2 Materials and Methods", "content": "We prepared three Perturb-Seq datasets (Replogle K562 [20], Replogle RPE1 [20] and Adamson [2]). All three\ndatasets contain both observational (control) and interventional (post-perturbation) single-gene perturbation data\ninstances. The gene perturbation dataset containing N data instances is a tuple consisting of D = (X, P, A), where"}, {"title": "2.2 Model Architecture", "content": "GPO-VAE is a generative model that integrates the capabilities of gene perturbation response prediction and GRN\ninference-based explainability. It inherits the fundamental design principles from CRADLE-VAE including latent\ndisentanglement, sparsity assumption of perturbation effects and counterfactual reasoning. Similar to conventional\nVAES, GPO-VAE consists of an Encoder-Decoder architecture with its encoder module composed of three submodules\n- Latent Perturbation Encoder, Latent Artifact Encoder and Latent Basal State Encoder. These submodules construct\nlattent embeddings for gene perturbation treatment, artifacts effects, and cell basal states, respectively. We modified the\nstructure of latent features which determines the sparsity of the treatment effect so that the features represent GRNS"}, {"title": "2.2.1 Encoder", "content": "The Latent Perturbation Encoder aims to learn the distribution of perturbation effects, independent of biological variation\nand artifact effects in a cell. During training, a global sparse latent offset matrix, $M \\in {0,1}^{|G^o \\cup G^+|\\times |G^o \\cup G^+|}$, is first\nsampled from the respective Bernoulli distribution with trainable parameters $\\widehat{W} \\in \\mathbb{R}^{|G^o \\cup G^+|\\times |G^o \\cup G^+|}$. Then, the sam-\npled latent offsets are fed to parameterize the global latent gene-wise perturbation effect matrix, $E\\in \\mathbb{R}^{|G^o \\cup G^+|\\times |G^o \\cup G^+|}$,\nforming a Normal distribution, from which each latent perturbation effect is sampled. The latent gene perturbation\neffect embeddings, $Z_p$, for each data instance are constructed by combining E with M and indexing them by the gene\nperturbation treatment P.\nThe Latent Perturbation Encoder that takes the gene perturbation treatments of N data instances as input $P \\in\n{0,1}^{N \\times |G^o \\cup G^+|}$ is mathematically expressed as follows:\n$$M \\sim B(\\widehat{W})$$\n$$E \\sim \\mathcal{N}(f_{enc,p}(M))$$\n$$Z_p = P(E \\odot M)$$\nwhere $B(\\cdot)$ and $\\mathcal{N}(\\cdot)$ represents Bernoulli distribution and Normal distribution, respectively. $f_{enc,p}$ denotes a trainable\nneural network which parameterizes the distribution from which M is sampled.\nLeveraging counterfactual reasoning, we train the Latent Artifact Encoder to target quality issues through reinforcing\nthe disentanglement of latent variables associated with the presence of technical artifacts. The encoder takes one-hot QC\nlabels, $A \\in {0,1}^{N \\times 1}$, as input and models the distribution of technical artifacts independently of basal cell features\nand perturbations as a Normal distribution:\n$$Z_a = A \\cdot u, \\text{ where } u \\sim \\mathcal{N}(\\hat{u}, \\hat{\\sigma}),$$\nwhere $u$ represents the global latent artifact embedding sampled from a parameterized Normal distribution, and\n$Z_a \\in \\mathbb{R}^{N \\times d}$ denotes the latent artifact embedding matrix for $N$ data instances. As this is not the primary focus of our"}, {"title": "2.2.2 Decoder", "content": "In decoding, we integrate the distinct latent embedding matrices $Z_b$, $Z_p$, and $Z_a$, to reconstruct the input gene expression\nprofile X. The reconstruction output $\\widehat{X} \\in \\mathbb{R}^{N\\times |G|}$ is sampled from a neural network-equipped Gamma-Poisson\ndistribution. The decoding process is expressed as follows:\n$$\\Lambda \\sim \\Gamma(f_{dec} (Z_b, Z_p, Z_a)L, \\Theta)$$\n$$\\widehat{X} \\sim P(\\Lambda)$$\nwhere $\\Gamma(\\cdot)$ is the Gamma Distribution sampler, $f_{dec}$ denotes the decoder-specialized neural network, $P(\\cdot)$ is the Poisson\nDistribution sampler which is parameterized by $\\Lambda \\in \\mathbb{R}^{N\\times |G|}$, $L \\in \\mathbb{R}^{N\\times 1}$ and $\\Theta \\in \\mathbb{R}^{N\\times |G|}$ represent the total number\nof read counts in each cell and trainable parameters, respectively."}, {"title": "2.2.3 Variational Inference", "content": "Given the intractability of the data marginal likelihood $p(X|P, A)$, we introduce the correlated variational distribution\n$q(Z|X, P, A)$ as an approximation to the posterior distribution of the latent variables. This distribution is defined as:\n$$q(Z_b, M, E, U|X, P, A) = \\prod_{t=1}^{|G^o\\cup G^+|} \\bigg( \\prod_{n=1}^N q(Z_{b,n}|X_n, P_n, a_n, M, E, U; \\phi) \\bigg) \\bigg(\\prod_{t=1}^{|G^o\\cup G^+|} q(e_t|m_t;\\phi)q(m_t;\\phi) \\bigg) q(u; \\phi)$$\nTo approximate the posterior distribution $log \\, p(X|P, A)$, we apply stochastic variational inference. The learnable\nparameters $(\\theta, \\phi)$ of GPO-VAE are optimized by maximizing the evidence lower bound (ELBO), which is given by the\nfollowing expression:\n$$\\mathcal{T}_{rec}(\\theta, \\phi) = \\mathbb{E}_{Z_b, M, E, U \\sim q(\\cdot|X, P, A;\\phi)} \\bigg[ log \\, \\frac{p(X, Z_b, M, E, U|P, A; \\theta)}{q(Z_b, M, E, U|X, P, A; \\phi)} \\bigg]$$"}, {"title": "2.2.4 Generative Process", "content": "For generation process after training, GPO-VAE samples latent basal state $Z_b$ from a Normal distribution $\\mathcal{N}(0, I)$:\n$$Z_b \\sim \\mathcal{N}(0, I)$$\nIt is then concatenated with the latent artifact embedding $Z_a$, and latent gene perturbation effect embeddings $Z_p$\nsampled from their respective parameterized distributions. The sampling process of $Z_p$ is the same as (1), (2), and (3).\nNotably, unlike the training process, A is a zero matrix, representing the absence of artifacts to generate artifact-free\nsamples:\n$$Z_a = 0 \\cdot u, \\text{ where } u \\sim \\mathcal{N}(\\hat{u}, \\hat{\\sigma})$$\nFinally, the concatenated embedding is passed into the trained decoder to form a Gamma-Poisson distribution, from\nwhich the reconstructed gene expression profile matrix X is sampled.\n$$\\Lambda \\sim \\Gamma(f_{dec} (Z_b, Z_p, Z_a), \\Theta, L)$$\n$$\\widehat{X} \\sim P(\\Lambda)$$"}, {"title": "2.2.5 GRN-aligned Parameter Optimization", "content": "As our work's core idea is modeling explainable perturbation responses, we present several modifications implemented\nin GPO-VAE's Latent Perturbation Encoder. Recall that the Latent Perturbation Encoder randomly samples sparse\nlatent offsets using its inherent Bernoulli distribution sampler with trainable parameters $\\widehat{W}$. In CRADLE-VAE and\nSAMS-VAE, $\\widehat{W} \\in \\mathbb{R}^{|G|\\times d}$, where the row vectors of the parameter matrix correspond to individual gene perturbation\ntreatments. This design approach treats the sparse latent offsets as independent assumptions for each specific gene\nperturbation, enabling the model to account for distinct effects perturbation-wise.\nWe propose a redesigned approach for the Latent Perturbation Encoder. Specifically, we redefine $W_{ij}$ in $\\widehat{W}$ as the\ncausal probability from source $i$th gene to target $j$th gene. Under this modified assumption, we reshape the parameters\ninto a square matrix $\\widehat{W} \\in \\mathbb{R}^{(|G^o\\cup G^+|)\\times (|G^o \\cup G^+|)}$ including the extended gene subset. As illustrated in Figure 2, this\nadjustment naturally enables interpretation of $\\widehat{W}$ as a gene regulatory network represented as an adjacency graph\ncontaining directed edge weights (i.e. causal gene-to-gene probabilities) and self-loops (i.e. self-regulating feedback\nmechanisms).\nWe then introduce GRN-based Parameter Optimization (GPO), a method that adjusts the parameters in $\\widehat{W}$ towards\ninclusion of topology-based model explainability to the latent perturbation effects. The loss objective from this method\nis composed by three components which are described as below.\nFirst, we exploit the post-perturbational differential gene expression (DGE) values, which are calculated based on\nfold changes between control and perturbation gene expression profiles, as reference in adjusting the parameters. In\ndetail, given $\\widehat{W}_{i,:}$ denotes the causal probabilities from source $i$th gene to all genes, each perturbation gene expression\nprofile $\\mathbf{x}$ is paired with a control gene expression profile $\\mathbf{x'}$ to build a reference differential gene expression profile\n$\\Delta \\mathbf{x}_n$. For the pairing process, we employed the Optimal Transport (OT) algorithm [50]. The reference differential gene\nexpression profiles $\\Delta X \\in \\mathbb{R}^{N \\times |G^o \\cup G^+|}$ are used to guide the trainable parameters in $\\widehat{W}$ through a loss function, which\nis mathematically expressed as follows:\n$$\\mathcal{J}_{dge}(\\widehat{W}) = \\sum_P ||P \\widehat{W} - \\Delta X||_1$$\n$$\\Delta x_n =\\begin{cases}Pairing(x,x') & \\text{if } x \\ne 0\\\\0 & \\text{otherwise}\\end{cases}$$\nNote that $\\mathbf{x}$ being a zero vector indicates a control sample excluded from constructing reference differential profiles.\nImportantly, all reference profiles used in this optimization are derived solely from the training dataset. We denote this\ncomponent as DGE loss ($I_{dge}$).", "latex": ["M \\in {0,1}^{|G^o \\cup G^+|\\times |G^o \\cup G^+|}", "\\widehat{W} \\in \\mathbb{R}^{|G^o \\cup G^+|\\times |G^o \\cup G^+|}", "E\\in \\mathbb{R}^{|G^o \\cup G^+|\\times |G^o \\cup G^+|}", "P \\in {0,1}^{N \\times |G^o \\cup G^+|}", "M \\sim B(\\widehat{W})", "E \\sim \\mathcal{N}(f_{enc,p}(M))", "Z_p = P(E \\odot M)", "B(\\cdot)", "\\mathcal{N}(\\cdot)", "\\mathcal{N}(\\hat{u}, \\hat{\\sigma})", "\\mathbb{R}^{N \\times d}", "\\mathcal{J}_{dge}(\\widehat{W}) = \\sum_P ||P \\widehat{W} - \\Delta X||_1", "\\begin{cases}Pairing(x,x') & \\text{if } x \\ne 0\\\\0 & \\text{otherwise}\\end{cases}"]}, {"title": "", "content": "While the above loss objective adjusts the Latent Perturbation Encoder's parameter space for its Bernoulli distribution\nsampler, it does not take all latent gene perturbation effects into account. In other words, only the row vectors in $\\widehat{W}$\nwhich correspond to perturbation gene subset $G^o$ are influenced by the loss objective, leaving the other parameters\nrelated to extended gene perturbation treatments ($G^+$) not updated.\nOur key idea is to guide the optimization trajectories of GPO-VAE towards leveraging accumulated multi-hop causal\nrelationships. As $\\widehat{W}$ is treated as a weighted adjacency matrix describing GRN, we can say that $\\widehat{W}^k$ contains k-hop\ncausal relationships that explain the underlying biological mechanisms behind each gene perturbation. These k-hop\ncausal relationships, which include extended genes as intermediate nodes, may contribute to expansive formation of the\nGRN by incrementally accumulating gene-gene relationships across different numbers of hops."}, {"title": "", "content": "Given the reference differential gene expression profiles, we make the following modifications to $I_{dge}$ as,\n$$\\mathcal{J}_{dge}^K(\\widehat{W}) = \\sum_P ||T_K - \\Delta X||_1$$\n$$T_K = \\widehat{W} + \\sum_{k=2}^K \\frac{1}{|\\widehat{W}^k|} \\cdot \\widehat{W}^k$$\nWe denote this component as K-hop accumulation ($I_{dge}^K$) where K is equally set to 5 across all model configurations\nused in our experiments.\nHowever, the current loss objective may increase the overall magnitude of values within $T_K$ as the number of hops\nincreases. This may cause proliferation of high causal probability values, leading to higher number of predicted\ninteractions within the GRN that may be insignificant in terms of explainability.\nTo mitigate this issue, we penalize the parameters in $\\widehat{W}$ towards overall sparsity. Having adopted this approach from\nthe NOTEARS algorithm [14], we expect that only gene-gene interactions that are highly relevant with observed\nperturbation effects are retained, effectively reducing irrelevant ones. This refinement not only provides the model with\nmore accurate information but also enhances overall predictive accuracy and explainability [9].\nBy combining the abovementioned three components, our proposed GPO loss objective is mathematically expressed as\nfollows,\n$$\\mathcal{I}_{gpo}(\\widehat{W}) = I_{dge}^K + I_{sp}$$\n$$= \\sum_P ||P T_K - \\Delta X||_1 + ||\\widehat{W}||_1$$\nwhere $I_{sp}$ is the added component denoted as sparsity penalty. The total loss objective for training GPO-VAE com-\nprises maximization of the evidence lower bound (ELBO) ($\\mathcal{T}_{rec}$, reconstruction of gene expression profiles), minimiza-\ntion of artifact disentanglement loss ($\\mathcal{J}_{ade}$) and minimization of the newly proposed GPO loss objective ($\\mathcal{I}_{gpo}$). The\ntotal loss objective ($\\mathcal{I}$) is mathematically expressed as follows,\n$$\\mathcal{I}(\\phi, \\theta) = \\mathcal{T}_{rec}(\\theta, \\phi) + \\alpha \\mathcal{J}_{ade}(\\phi) + \\beta \\mathcal{I}_{gpo}(\\widehat{W})$$\nwhere $\\theta$ and $\\phi$ are the trainable parameters in GPO-VAE's Encoder and Decoder modules respectively. Note that\n$\\widehat{W} \\subset \\phi$ as the Bernoulli distribution sampler parameterized by $\\widehat{W}$ is the component of the Latent Perturbation Encoder."}, {"title": "3 Experiments", "content": "We conducted experiments to compare GPO-VAE's performance on the gene perturbation response prediction task\nwith other VAE-based models as baselines. The baseline VAEs used in the experiments are Conditional VAE [11],\nSVAE+ [10], SAMS-VAE [8], CPA-VAE [8] and CRADLE-VAE [5]. Table 2 summarizes the key characteristics of each\nVAE-variant including GPO-VAE and its ablations. Details on each baseline are available in Supplementary Material\nC.1.\nThe evaluation metrics used in the experiments are Average Treatment Effect Pearson Correlation (ATE-p), Average\nTreatment Effect R-Square Score (ATE-R2) [8], and Jaccard Similarity between top 50 model-predicted and true\ndifferentially expressed genes (Jaccard) [5]. The first two metrics compare differential expression values predicted\nby the model and the experimental data across all genes by calculating Pearson correlation coefficient and R-square\nrespectively. Jaccard Similarity shows whether the predicted set of DEGs actually match the true set. Details on the\nevaluation metrics are available in Supplementary D."}, {"title": "3.2 Evaluation on Gene Regulatory Network Inference", "content": "While GPO-VAE's primary role is predicting the transcriptional outcomes of gene perturbations, our work focuses on\naligning the optimization of $\\widehat{W}$ in its Latent Perturbation Encoder towards GRN-based explainability. To quantitatively\nevaluate the GRNs inferred by GPO-VAE based on its statistical explainability, we conducted additional experiments\non GRN inference baseline methods.\nThe evaluation procedures, metrics and baseline methods for these experiments were adopted from CausalBench, a\nbenchmark framework for evaluating GRN inference methods on single-cell gene perturbation datasets [4]. The baseline"}, {"title": "3.4 GRN Topology Analysis and Ablation Study", "content": "To analyze the impact of our GRN-aligned parameter optimization, we conducted an ablation study and visualized the\noptimized parameters representing the directed, weighted adjacency matrix for the GRN during training in Fig 3. Note\nthat the parameters were extracted from $\\widehat{W}$ within the Latent Perturbation Encoder's Bernoulli distribution sampler.\nUsing the Replogle RPE1 dataset, we randomly sampled 25 perturbation genes and 25 extended genes for this analysis.\nThe ablations for GPO-VAE, related to the components that comprise our GPO loss objective, are the following - only\nsparsity penalty ($\\mathcal{J}_{sp}$), only DGE loss without K-hop accumulation ($I_{dge}$) and only DGE loss with K-hop accumulation\n($I_{dge}^K$). We investigated the individual contributions of each component to the GRN-aligned optimization of $\\widehat{W}$.\nTable 5 shows the results on ablation experiment while Fig 3 illustrates the inferred GRN based on different ablation\nsettings using heatmaps. Ablation model GPO-VAE ($\\mathcal{J}_{sp}$) suffered from a huge reduction in overall statistical\nsignificance of predicted edges, leading to poor $\\mu$WD. Its inferred GRN exhibits edges exclusively originating from\nperturbation genes, with no edges involving extended genes. This outcome reflects the penalty's tendency to suppress\nconnections related to extended genes, as their parameters were never optimized.\nConversely, ablation model GPO-VAE ($I_{dge}$) constructed a GRN with relatively less sparsity and higher $\\mu$WD,\ncompared to the ablated model using only sparsity penalty. However, all inferred edges containing extended genes\nmaintained uniform weights of 0.5 throughout model training, indicating that these relationships were never been\naccounted during optimization.\nThe GRN optimized with $I_{dge}^K$ which has no sparsity regularization, demonstrates the involvement of both perturbed\nand extended genes in the optimization process. This suggests that extended genes contributing novel pathways to\nperturbation gene relationships were effectively optimized. However, its inferred GRN remains dense, particularly in\nthe edges involving extended genes, decreasing $\\mu$WD.\nFinally, the GRN inferred by our model using the GPO loss objective $\\mathcal{I}_{gpo}$ is both sparse and demonstrates well-\noptimized relationships involving extended genes, as shown in Fig 3. The balance between the effects of sparsity penalty"}, {"title": "3.5 Biological Implication of the Inferred GRN", "content": "To investigate the impact of involving the extended gene subset in GRN inference on establishing meaningful gene-\ngene causal relationships, we studied the extracted subnetworks from Replogle K562 dataset, both biologically and\nstatistically. We hypothesize that novel pathways created from the interaction of extended genes would provide\nbiologically relevant insights related to cancer progression or immune system disorders in K562 cells, derived from a\nchronic myelogenous leukemia patient. Subnetworks were selected based on two criteria: 1) paths with perturbed genes\nconnected via at least one extended gene, and 2) no directed edge between the selected perturbed genes in the GRN\ninferred by DCDI-G, the best baseline model. The newly formed 2- or 3-hop causal edges exhibit high WDs, indicating\nstrong causal effects. We then analyzed the gene sets within the subnetworks using DAVID Functional Annotation Tool.\nAs shown in Fig 4, analysis revealed that genes (or proteins) in the connected subnetworks interact with KRAS, MYC,\nand NTRK1, all of which are well-known cancer-associated genes (proteins), respectively. This finding highlights the\nconsistency between the GPO-VAE-inferred GRN and prior biological knowledge.\nIn the KRAS-related subnetwork shown in Fig 4 (a), all genes were experimentally confirmed to have a negative genetic\nrelationship with KRAS [38]. In this context, negative genetic interactions occur when mutations in individual genes\ncause minimal phenotypic effects, but their combined mutation in the same cell results in a severe fitness defect or\nlethality. Interestingly, although STRING\u2014a widely used biological network database-did not identify interactions\nbetween these genes, experimental evidence supports the validity of our subnetwork [21]. This suggests that the inferred\nsubnetwork could provide valuable insights for identifying new synthetic lethal gene pairs, potentially advancing target\ndiscovery efforts related to KRAS.\nIn Fig 4 (b), the genes in the subnetwork is found to exhibit protein-level interaction with MYC, identified through\nmass spectrometric methods [39, 40, 41]. Only interaction between MYC and NEDD8 is documented in STRING,\nhighlighting the advantage of our extended subnetwork. By including extended genes such as NEDD8, which were not\nutilized in other baseline GRN inference methods, our approach expands the search space, enabling the discovery of\nadditional pathways that align with prior biological networks. Moreover, leveraging the genotype-phenotype mapping\nderived from Replogle et al., we identified WDR12, NEDD8, and MRPL55 as genes associated with the ribosomal\nsubunit. On the other hand, subcellular localization data from UniProtKB/Swiss-Prot revealed that MYC, WDR12,\nNEDD8, and ACP1 are highly likely to localize in the cytosol, while MRPL55 is localized in the mitochondrion.\nNotably, the Replogle paper focused on mitochondrial genome stress responses, and prior research links MYC to\ncancer-related phenotypes, such as cell cycle regulation and MYC-dependent apoptosis, through mitochondrial targets.\nMRPL55, in particular, was reported as a nuclear-encoded mitochondrial gene downstream target in this context [44].\nThese findings suggest that the inferred MYC-related subnetwork reflects a MYC-driven pathway that transitions\nfrom the cytosol to the mitochondria, contributing to cancer-related phenotypes linked to cell cycle and mitochondrial\nbiogenesis.\nThe last subnetwork shown in Fig 4 (c) demonstrated protein-level interaction with NTRK1, an oncogenic driver\ndiscovered for leukemia studied in prior studies [45]. While STRING did not identify interactions among the genes in\nthis subnetwork, our model revealed that MED12, ATP1A1, ILF3, and POLR2B could also serve as potential target"}, {"title": "3.6 Case Study on Unseen Perturbation Treatments", "content": "We hypothesize that by leveraging the ability of the GPO loss to optimize the causal probabilities of edges formed\nwithin a k-hop neighborhood, GPO-VAE should be capable of predicting gene expression for unseen perturbation\ntreatments. To verify this, we excluded samples involving three distinct perturbation treatments from the training\ndataset and assessed the model's performance in accurately predicting gene expression. We calculated $\\mu$WD across all\nperturbed genes and identified the top three genes with the highest combined in-degree and out-degree, using a threshold\nof 0.3. These selected genes represent key hub genes within the network, as they both receive the most influence from\nother genes and exert the greatest influence on others.\nAs shown in Figure 5, GPO-VAE achieves competitive performance across all three excluded cases, with ATE-p of\n0.79, 0.88, and 0.91 and ATE-R2 scores of 0.57, 0.77, and 0.83. Additionally, the predicted distributions align closely\nwith the actual distributions, demonstrating the model's ability to approximate post-perturbation responses. These\nresults highlight GPO-VAE's ability to generalize to unseen perturbations, showcasing its robustness and scalability for\ngene expression prediction in practical applications."}, {"title": "4 Conclusion", "content": "In this work, we introduce GPO-VAE, a GRN-enhanced explainable VAE, that aligns the latent subspaces associated\nwith gene-specific perturbation effects with gene-gene causal relationship for improved post-perturbation expression\nprediction. This is achieved through GRN-aligned parameter optimization, which refines the causal gene-gene relation-\nships towards biologically meaningful GRN. Through evaluations on three benchmark datasets and case studies, we\ndemonstrate that GPO-VAE not only accurately predicts cellular responses to gene perturbations but also constructs\nstatistically robust and biologically relevant GRNs.\nOne limitation of GPO-VAE is that, unlike perturbation response prediction models such as CRADLE-VAE and\nSAMS-VAE, which have demonstrated their ability to predict responses to multi-gene perturbation treatments, our\nmodel has not yet been explicitly designed for such scenarios though the architecture itself does not inherently restrict\nits application to multi-gene perturbation settings.\nMoreover, we identified a misalignment between the two evaluation schemes\u2014biological and statistical\u2014introduced in\nCausalBench. Furthermore, the reference networks proposed in biological evaluation schemes are not cell-type specific\nand may introduce biases. This observation highlights the inherent challenge of evaluating GRN inference models, as\nthe absence of ground truth limits the comprehensiveness of existing evaluation methods.\nAs future work, we aim to extend GPO-VAE to incorporate multi-gene perturbation treatments and enable the model to\nleverage relationships such as synergy, inhibition, and synthetic lethality within gene regulatory networks for improved"}]}