{"title": "KPIs 2024 Challenge: Advancing Glomerular Segmentation from Patch- to Slide-Level", "authors": ["Ruining Deng", "Tianyuan Yao", "Yucheng Tang", "Junlin Guo", "Siqi Lu", "Juming Xiong", "Lining Yu", "Quan Huu Cap", "Pengzhou Cai", "Libin Lan", "Ze Zhao", "Adrian Galdran", "Amit Kumar", "Gunjan Deotalek", "Dev Kumar Das", "Inyoung Paik", "Joonho Lee", "Geongyu Lee", "Yujia Chen", "Wangkai Lim", "Zhaoyang Lim", "Xuege Hou", "Zeyuan Wu", "Shengjin Wang", "Maximilian Fischer", "Lars Kr\u00e4mer", "Anghong Du", "Le Zhang", "Maria S\u00e1nchez S\u00e1nchez", "Helena S\u00e1nchez Ulloa", "David Ribalta Heredia", "Carlos P\u00e9rez de Arenaza Garc\u00eda", "Shuoyu Xu", "Bingdou He", "Xinping Cheng", "Tao Wang", "No\u00e9mie Moreau", "Katarzyna Bozek", "Shubham Innani", "Ujjwal Baid", "Kaura Solomon Kefas", "Bennett A. Landman", "Yu Wang", "Shilin Zhao", "Mengmeng Yin", "Haichun Yang", "Yuankai Huo"], "abstract": "Chronic kidney disease (CKD) is a major global health issue, affecting over 10% of\nthe population and causing significant mortality. While kidney biopsy remains the gold\nstandard for CKD diagnosis and treatment, the lack of comprehensive benchmarks for\nkidney pathology segmentation hinders progress in the field. To address this, we or-\nganized the Kidney Pathology Image Segmentation (KPIs) Challenge, introducing a\ndataset that incorporates preclinical rodent models of CKD with over 10,000 annotated\nglomeruli from 60+ Periodic Acid Schiff (PAS)-stained whole slide images. The chal-\nlenge includes two tasks, patch-level segmentation and whole slide image segmentation\nand detection, evaluated using the Dice Similarity Coefficient (DSC) and F1-score. By\nencouraging innovative segmentation methods that adapt to diverse CKD models and\ntissue conditions, the KPIs Challenge aims to advance kidney pathology analysis, estab-\nlish new benchmarks, and enable precise, large-scale quantification for disease research\nand diagnosis.", "sections": [{"title": "1. Introduction", "content": "Chronic kidney disease (CKD) represents a significant global\nhealth challenge, causing more deaths annually than breast and\nprostate cancer combined (Cirillo et al., 2024; Iglesias et al.,\n2012). Affecting over 10% of the global population, CKD im-\npacts approximately 800 million individuals worldwide. Kid-\nney biopsy, through both open and percutaneous methods, re-\nmains the gold standard for diagnosing and guiding the treat-\nment of CKD (Hogan et al., 2016; Agarwal et al., 2013). In\npathological image analysis, especially within the context of\nkidney disease, tissue segmentation plays a pivotal role in en-\nabling large-scale, computer-assisted quantification in pathol-\nogy (Bengtsson et al., 2017; Marti-Aguado et al., 2021; Gomes\net al., 2021). This analysis provides clinical value for disease di-\nagnosis (Mounier-Vehier et al., 2002), severity assessment (Kel-\nlum, 2008), and treatment effectiveness evaluation (Jim\u00e9nez-\nHeffernan et al., 2006).\nThe advent of deep learning has revolutionized kidney pathol-\nogy image segmentation (Kumar et al., 2017; Ding et al., 2020;\nRen et al., 2017; Bel et al., 2018; Zeng et al., 2020), yet signif-\nicant challenges remain. Chief among these is the lack of com-\nprehensive benchmarks for developing and evaluating segmen-\ntation methods. Existing public datasets for kidney pathology\nsegmentation are limited, primarily containing samples from\nhealthy patients 12. This limitation arises because tissue sam-\nples are typically obtained through needle biopsies, yielding\nonly small samples. Consequently, there is a pressing need to\nestablish extensive kidney pathology datasets encompassing di-\nverse CKD models.\nTo address these limitations, we organized the Kidney Pathol-\nogy Image Segmentation (KPIs) Challenge, expanding the\ndataset by incorporating preclinical animal models, specifically\nwhole kidney sections from diseased rodents. This competi-\ntion aims to identify state-of-the-art segmentation methods for\nglomerular identification across various CKD models. Partic-\nipants are tasked with developing algorithms capable of accu-\nrately segmenting glomeruli at the pixel level, adapting to dif-\nferent CKD models and tissue conditions. This includes distin-\nguishing glomeruli from surrounding tissue components under\ndiverse preparation scenarios, showcasing both the versatility\nand precision of their approaches. Furthermore, the challenge\nencourages innovative solutions to address potential obstacles\nsuch as variations in glomeruli size, shape, and structural in-\nteg rity resulting from disease states or preparation techniques.\nTo comprehensively evaluate participants' models, the chal-\nlenge features two distinct tasks (as shown in Fig. 1) aimed at\nadvancing the field of kidney pathology image analysis:\n1. Patch-Level Segmentation: Segmentation of glomeruli\nwithin specific image patches.\n2. Whole Slide Image-Level Segmentation and Detection:\nSegmentation and detection of glomeruli across entire kid-\nney slide images.\nModel performance is assessed using the Dice Similarity Coef-\nficient (DSC) and F1-score on the testing dataset.\nThe KPIs Challenge encompasses a broad spectrum of kidney\ndisease models, including normal and multiple CKD-specific"}, {"title": "2. Related Works", "content": "2.1. Patch-Level Glomerular Segmentation\nPatch-level glomerular segmentation has been a focal point in\nrenal pathology, aiming to delineate glomeruli within small,\nmanageable regions of kidney histology images (Ginley et al.,\n2019). Early methodologies predominantly utilized classical\nimage processing techniques, including thresholding, edge de-\ntection, and morphological operations (Altini et al., 2020; Gin-\nley et al., 2017), to identify glomerular structures. While\nthese approaches established foundational workflows, they of-\nten encountered challenges due to the intricate morphology of\nglomeruli and variability in staining methods, leading to incon-\nsistent segmentation outcomes (Altini et al., 2020).\nThe advent of deep learning, particularly convolutional neu-\nral networks (CNNs), has significantly advanced the field of\nmedical image segmentation (Gallego et al., 2021). Architec-\ntures such as U-Net and its derivatives have been extensively\napplied to patch-level glomerular segmentation, demonstrating\nenhanced accuracy and efficiency by learning complex patterns\ninherent in kidney tissues (Singh Samant et al., 2023; Gallego\net al., 2021; Deng et al., 2023b). Despite these advancements,\nseveral challenges persist in patch-level segmentation. A pri-\nmary concern is the lack of global contextual information, as\nmodels trained on isolated patches may not effectively capture\nthe spatial relationships and broader tissue architecture present\nin whole slide images (WSIs) (Wu and Moeckel, 2023). This\nlimitation can lead to inaccuracies, particularly when glomeruli\nare located near the periphery of patches or exhibit atypical pre-\nsentations. Additionally, variability in image quality, staining\ntechniques, and the inherent complexity of glomerular struc-\ntures can adversely affect segmentation performance (Wu and\nMoeckel, 2023). To address these issues, recent research has\nexplored hybrid models that integrate CNNs with transformer-\nbased architectures to enhance both local feature extraction and\nglobal context understanding (Liu, 2024; Yin et al., 2024; Wu\nand Moeckel, 2023; Deng et al., 2024b,a, 2023a; Cui et al.).\nFor example, a hybrid CNN-TransXNet (Liu, 2024) approach\nhas been proposed to improve segmentation accuracy by com-\nbining the strengths of CNNs in capturing fine-grained local\nfeatures with the global contextual understanding provided by\ntransformers.\n2.2. Whole Slides Image-Level Glomerular Detection and Seg-\nmentation\nWSI glomerular detection and segmentation have become piv-\notal in computational kidnet pathology, enabling comprehen-\nsive analysis of kidney tissues at high resolution. Unlike patch-\nbased methods, WSI approaches consider the entire tissue con-\ntext, facilitating more accurate localization and characterization\nof glomeruli (Bueno et al., 2020; Tang et al., 2024)."}, {"title": "3. Challege description", "content": "3.1. Overview\nThe Kidney Pathology Image Segmentation challenge seeks\nto advance glomeruli segmentation in kidney pathology us-\ning deep learning techniques. Participants are tasked with\ndeveloping precise, pixel-level segmentation algorithms for\nglomeruli across diverse mouse models, including normal and\ndiseased conditions. The dataset includes whole slide images\nand patches from four mouse groups: normal, 5/6 nephrec-\ntomy (5/6Nx), diabetic nephropathy (DN), and NEP25 models,\nstained with Periodic acid Schiff (PAS). The challenge empha-\nsizes distinguishing glomeruli from surrounding tissue compo-\nnents under varied preparation scenarios, highlighting the algo-\nrithms' versatility and precision.\nThe competition is divided into two distinct tasks, each ad-\ndressing specific challenges and emphasizing different aspects\nof segmentation:\n\u2022 Patch-level Segmentation: This task focuses on the seg-\nmentation of glomeruli within specific image patches ex-\ntracted from the whole slide images. Participants must\nhandle high-resolution data and ensure precise delineation\nof glomeruli under constrained spatial contexts. This task\nis ideal for evaluating algorithms on local-level segmenta-\ntion challenges.\n\u2022 Whole Slide Image-Level Segmentation: This task in-\nvolves segmenting glomeruli across entire kidney slide im-\nages, which presents additional challenges such as han-\ndling large-scale data, maintaining computational effi-\nciency, and addressing variability across the entire tissue\nsection. It requires algorithms capable of performing ro-\nbust segmentation on a global scale, adapting to diverse\nmorphological and pathological variations."}, {"title": "3.3. Challenge Setup", "content": "The KPIs Challenge began with the release of the training\ndataset on March 30, 2024, hosted on the Synapse platform,\nwhich facilitates data sharing. The validation dataset was re-\nleased on May 1, 2024, allowing participants to evaluate their\nalgorithms locally.\nThe test dataset remained private, and participants were re-\nquired to submit Docker containers with their algorithms.\nThese containers were evaluated after the testing phase ended.\nThe evaluation was performed on an Ubuntu 20.04 desktop with\nthe following specifications:\n\u2022 CPU: Intel(R) Xeon(R) Gold 6230R CPU @ 2.10GHz (52\nthreads)\n\u2022 GPU: NVIDIA RTX A6000 with 64 GB memory\n\u2022 RAM: 64 GB\n\u2022 Driver Version: 535.183.01\n\u2022 CUDA Version: 12.2\n\u2022 Docker Version: 27.0.1\nThe challenge concluded with the announcement of winners on\nSeptember 15, 2024. Participants were invited to present their\nmethods at the MICCAI 2024 MOVI Workshop on October 10,\n2024, and encouraged to contribute to a joint manuscript for\ndissemination of the challenge outcomes."}, {"title": "3.4. Metrics and evaluation", "content": "3.4.1. Choice of metrics\nThe KPIs Challenge employs tailored metrics to address the\nspecific objectives of each task:\n\u2022 Task 1: Patch-level Glomeruli Segmentation The Dice\nSimilarity Coefficient (DSC) is used to evaluate the preci-\nsion of segmentation at the patch level. This metric ensures\naccurate pixel-level overlap between predicted and ground\ntruth masks, emphasizing the importance of precise seg-\nmentation in smaller, localized regions.\n\u2022 Task 2a: WSI-level Glomeruli Segmentation WSI seg-\nmentation is significantly more challenging than patch-\nlevel segmentation due to the large image size and com-\nplexity of WSIs compared to traditional segmentation\ntasks. These large-scale images often require models to\nmaintain computational efficiency while addressing the di-\nverse spatial and morphological variations of glomeruli.\nTo balance these challenges, the evaluation includes: -\nDSC: Measures the pixel-level accuracy of glomeruli seg-\nmentation, ensuring precise delineation. - F1 Score: Eval-\nuates the balance between precision and recall, promot-\ning comprehensive glomeruli detection. The final ranking\ncombines these metrics equally, referred to as \"Glo Detec-\ntion and Segmentation,\" to reflect both detection compre-\nhensiveness and segmentation precision.\n\u2022 Task 2b: WSI-level Glomeruli Detection For the detec-\ntion task, the F1 score is calculated independently. This\nmetric prioritizes models that achieve a balance between\nprecision and recall, ensuring accurate detection of as\nmany glomeruli as possible across the entirety of the WSI.\nThese metrics ensure a fair and comprehensive evaluation, ad-\ndressing the unique challenges posed by patch-level and WSI-\nlevel segmentation and detection tasks."}, {"title": "4. Participating methods", "content": "In this section", "1": "Patch-level Glomeruli Segmentation\nCapybara (1st place, Cap). The proposed glomerulus segmen-\ntation pipeline is based on patch-level model ensembling and\nstitching. A crop size of 768 \u00d7 768 was used during both model\ntraining and inference. To account for the various CKD in the\nchallenge data, the training data was stratified into three folds\nbased on disease model and WSI name. Three SegFormer-\nB5 (Xie et al., 2021) models were trained on the three folds\nand combined into one unified model. During inference, for\neach image patch of size 2,048 \u00d7 2,048, a window size of\n768 x 768 with a stride size of 576 (75% of the window size)\nwere used. Predictions from the three models are averaged.\nTo enhance detection coverage, the pipeline applies stitching\nto overlapping image patches based on information such as\ntheir coordinates and WSI names. Specifically, for overlapping\npatches, the raw prediction values in the intersecting areas are\nsummed. The stitched prediction map from all image patches\nof the same WSI is normalized using the softmax function.\nFinally, the results are cropped back to the original test size\n(2,048 \u00d7 2,048) for submission.\nagaldran (2nd place, Galdran et al.). The proposed method\nfocuses on segmenting glomeruli from smaller, predefined\npatch"}]}