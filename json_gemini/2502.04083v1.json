{"title": "Automatic quantification of breast cancer biomarkers from multiple 18F-FDG PET image segmentation", "authors": ["Tewele W Tareke", "Neree Payan", "Alexandre Cochet", "Laurent Arnould", "Beno\u00eet Presles", "Jean-Marc Vrigneaud", "Fabrice Meriaudeau", "Alain Lalande"], "abstract": "Neoadjuvant chemotherapy (NAC) has become a standard clinical practice for tumor downsizing in breast cancer with 18F-FDG Positron Emission Tomography (PET) being an essential tool in treatment monitoring. Our work aims to leverage PET imaging for the segmentation of breast lesions and the analysis of tumor metabolic response. The focus is on developing an automated system that accurately segments primary tumor regions and extracts key biomarkers from these areas to provide insights into the evolution of breast cancer following the first course of NAC.", "sections": [{"title": "1 Introduction", "content": "Breast cancer is one of the most widespread and concerning forms of cancer worldwide, particularly affecting women. Lichtenstein et al. have pinpointed specific genetic varia-tions linked to higher breast cancer risk, providing valuable insights into its causes. Neoadjuvant chemotherapy (NAC) was initially introduced as a treatment strategy for managing inflammatory or locally advanced breast cancers that are deemed inop-erable at diagnosis. This approach allows for the reduction of tumor size or stage before surgical intervention and improving overall treatment outcomes. Then NAC is the first-line treatment for patients with inoperable or locally advanced breast cancer. Minckwitz et al. have made the link between pathological complete response(PCR) and prognosis following NAC across various intrinsic breast cancer subtypes.Positron Emission Tomography (PET) imaging is commonly used for assessingdisease spread during diagnosis and treatment by examining the functional processes of cancerous cells within tissues. PET imaging is a crucial asset in the NAC frame-work, enabling early and precise assessment of treatment response in breast cancerpatients. Berriolo-Riedinger et al. assessed the predictive value of reduced 18F-FDG uptake in breast cancer patients undergoing NAC in relation to achieving aPCR. Cochet et al. evaluated the impact of 18F-FDG Positron Emission Tomog-raphy/Computed Tomography (PET/CT) on clinical management and its prognosticvalue in the initial staging of newly diagnosed large breast cancer. Another prospective study has evaluated the relationship between tumor blood flow, glucose metabolism(assessed by 18F-FDG PET), and proliferation and endothelial pathological markersin newly diagnosed breast cancer. Biomarkers such as maximum standardized uptake value (SUVmax), metabolic tumor volume (MTV), and total lesion glycoly-sis (TLG) derived from PET imaging are essential for providing insights into tumor metabolism and size. Humbert et al. analyzed the evolution of biomarkers, suchas SUVmax, to evaluate their predictive value in breast cancer treatment and theirimpact on clinical decision-making. Similarly, a prospective study by Schwarz-Doseet al. found that biomarker measurements were significant in predicting pathologicalresponse after the first treatment cycle. PETFu is a widely evaluated exam fordistinguishing metabolic responders from non-responders in interim or post-treatmentPET scans. This review evaluated treatment response by calculating the percent-age reduction in SUVmax observed on follow-up PET scans after NAC, compared tobaseline scans. This analysis was assessed both in SUVmax changes and the patho-logical complete response. Gallivanone et al. have demonstrated that biomarkerssuch as SUVmax, TLG, and textural features extracted from pre-treatment 18F-FDGPET and magnetic resonance imaging (MRI) are able to define patient prognosis andpredict the response to NAC in breast cancer.Accurate breast lesion segmentation on PET scans plays a vital role in improvingthe precision of biomarker analysis. By separating the tumor from surrounding tissues,segmentation enhances the reliability of predictive evaluations. This process supports personalized treatment planning and the monitoring of patient progress. However,segmenting functional volumes in PET images presents a significant challenge dueto several factors. Manual delineation, while an option, is subjective, laborious, andtime-consuming in medical imaging. This is particularly true for PET imaging, as wellas for modalities in 3D like Computed Tomography (CT) and MRI. Before 2007,the majority of breast cancer segmentation techniques consisted of using a binarythreshold from PET image intensities. This thresholding often relied on methodslike selecting a percentage of the SUVmax value, setting an absolute threshold formaximum concentration of the tracer within a region of interest, or employing adaptivethresholding techniques. In the work of Payan et al. , a contrast-based algorithm was employed to segment breast cancer tumors in baseline imagesacquired prior to the first course of NAC. However, this contrast-dependent approachhas been proven to be inadequate for images with low contrast, making it unsuitablefor accurately localizing tumors in images after NAC. Advanced image processing andcomputer-aided methods have emerged for processing breast cancer images. However, their effectiveness may still be limited by factors such as tumor heterogeneityand low signal intensity, such as those affected by NAC Our study focuses on 3D PET images obtained through a specific protocol forwomen undergoing treatment for breast cancer. In summary, a total of 243 PETscans at baseline and 180 scans at follow-up were included in our study. Baseline"}, {"title": "2 Material and Methods", "content": "The data were collected from 254 patients enrolled in a clinical trial called TRENprotocol (Recorded on ClinicalTrials.gov identifier: NCT02386709) . This proto-col aims to evaluate early metabolic and perfusion changes in invasive breast cancerpatients undergoing NAC, with the objective of identifying predictive markers oftumor response and prognostic factors for recurrence risk Successful identificationof these factors allows for early adaptation of chemotherapy regimens based on markerevaluation. An overview of the protocol is illustrated in Figure 1. This protocol involvesadministering treatment before the surgical resection, aiming to shrink tumors. Inclu-sion criteria involve women aged 18 or older with newly diagnosed breast cancer and atumor diameter larger than 2 cm, eligible for neoadjuvant treatment (stage II or III).Exclusion criteria cover inflammatory tumors, distant metastasis, contraindicationsto treatment or surgery, pregnancy, high blood glucose level (>9 mmol/l), psychiatricillness impairing study comprehension, and unwillingness for repeated imaging. Theprotocol is a single-center, prospective, observational, non-randomized study offeredto eligible patients who consent to participation [13]. The treatment protocol consistsof several courses of NAC (Figure 1). The PETBI scans refer to scans acquired beforethe start of NAC and the PETFU scans are obtained after the first course of NAC.Once the inclusion and exclusion criteria were applied to the registered patients, 243patients were retained for our study at the baseline level (Table 1). After the firstcourse of NAC, the number of patients decreases (missed appointment or issues duringthe PET scan planning). A total of 243 PETBI, and 180 PETFU scans were thereforeconsidered for our study. All scans were acquired using a Gemini TruFlight PET/CTscanner (Philips Medical Systems, Eindhoven, The Netherlands), with an axial fieldof view of 18 cm and a transaxial slice thickness of 4 mm. An automatic PET infu-sion system (Bayer Medical Care Inc., Indianola, PA, USA) was used to inject a bolusof 3MBq/kg of 18F-Fluorodeoxyglucose (FDG). The images were acquired in a prone"}, {"title": "2.2 Deep learning models and data annotation", "content": "Our research comprises two main phases. The first phase focuses on segmentationtasks using deep learning techniques applied to PETBI Scans, as depicted in Figure 3.In the second phase, the model is fine-tuned using PET Fu scans to segment lesions inthe PETFu scans. Our approach is grounded in the robust UNet architecture, widelyrecognized for image segmentation in medical imaging task [29, 32].A benchmark of classical deep learning architectures for medical image segmen-tation has been explored in this work, namely the 2D UNet [29], 3D UNet [30], andnnUNet [31]. The nnUNet architecture enhances the traditional UNet by introducinga flexible, user-friendly framework with automated hyperparameter tuning to improvesegmentation performance. Normalization and voxel space alignment of the volumeswere implemented for all volumes as pre-processing steps to ensure that the data fedinto the network is consistent and optimized for effective learning. Each 3D PET Blscan has dimensions of 144 x 144 pixels with a depth of 66 slices. We used PETBI scans to build our proposed deep learning model, considering these labels as the ground"}, {"title": "2.3 Loss functions", "content": "The sum of weighted loss functions, each weighted by a certain factor [33], was employed. This method helped the model to adapt well to the imbalanced nature of the dataset, thereby improving the overall performance of the segmentation task. The combined weighted Focal Tversky Loss (FTL) [34] and Binary Cross-Entropy (BCE) loss functions [35] was implemented, as it provides a more optimal solution compared to using BCE or FTL individually. The integration of FTL within the net-work effectively tackled challenges stemming from imbalanced and limited dataset. This is achieved by assigning higher weights to minority classes, thereby prioritizing the accurate classification of rare instances and mitigating the impact of skewed class"}, {"title": "Distributions", "content": "The Tversky Index (TI) is defined as:\n$TI = \\frac{TP}{TP + \\alpha FN + \\beta\\cdot FP}$\nwhere TP is the true positive rate, FP the false positive rate, FN the false negative rate, \u03b1 and \u03b2 control the magnitude of penalties for FPs and FNs, respectively. As TI increases, the Tversky loss function (1-TI) converges. The main difference between Tversky loss and FTL is the introduction of the focusing parameter y in the latter. This parameter allows the FTL to concentrate more on hard-to-classify cases (i.e. where there is hard-to-segment regions), whereas the standard Tversky loss treats all errors equally (depending on \u03b1 and \u03b2). The focal Tversky loss is defined as:\n$FTL = (1 - TI)^\\gamma$\nThe y parameter controls the level of focusing on hard-to-segment regions. In another hand, Binary Cross-Entropy (BCE) is a loss function used to measure the difference between predicted probabilities and actual binary labels in binary segmentation tasks. BCE loss treats each class equally in terms of penalization, meaning that it assigns the same weight to each class during optimization, regardless of the class distribution in the dataset. The combined loss functions is defined as:\n$LOSS_{weighed} = \\epsilon \\times LOSS_{FTL} + (1 - \\epsilon) \\times LOSS_{BCE} (Y, \\hat{y})$\nwhere:\nLOSSFTL is the FTL function, LOSSBCE is the BCE loss function with y the true value and (\\hat{y}) the predicted value, \\u20ac is the weight parameter representing the relative importance of the FTL compared to the BCE loss. It ranges between 0 and 1, where \\u20ac = 0 gives full weight to the BCE loss and \\u20ac = 1 gives full weight to the FTL."}, {"title": "2.4 Quality control", "content": "A quality control step was integrated into the pipeline to verify segmentation accuracyand identify potential outliers. Indeed, we observed a few outliers in the changes of SUVmax, TLG, and MTV parameters, likely due to unusually large tumor sizes. Anextreme outlier is defined as a data point that lies beyond a specified threshold valuewithin the dataset (example in Figure 5 for the MTV calculation). The purpose of thisquality control approach was to first identify outliers, perform manual segmentationby experts on the corresponding scans, and finally refine the model using these newcases. This quality control step was incorporated as an active learning mechanism toenhance model performance with less labeled examples, which is especially valuablein scenarios where labeling is costly or time-intensive. The quality control processconsisted of two steps. First, we assessed whether the segmented masks from PET BIand PET Fu scans for a specific patient were localized roughly in the same area. Thesegmented images from PETBI and PETFu are binarised, with pixel values of 0 forthe background and 1 for the cancer region. To objectively track whether the cancer"}, {"title": "2.5 Inter-observer variability", "content": "Inter-observer variability in image segmentation refers to the differences in results obtained when different individuals (observers or annotators) segment the same images. These discrepancies can arise due to variations in the observers' interpretations, expertise, or approaches. In this study, we aimed to assess the consistency and agreement between two experienced experts, both of whom have over five years of"}, {"title": "2.6 Evaluation metrics", "content": "The evaluation of our model's performance involves the use of several metrics. TheDice similarity coefficient (DSC) is used for evaluating the similarity between thepredicted and ground truth segmentation masks. It measures the overlap betweenthe two, providing a value between 0 and 1, where a higher value indicates betteragreement . The intersection over Union (IoU), also known as the Jaccard Index,measures the overlap between the predicted segmentation and the ground truth, rel-ative to their union . It ranges from 0 (no overlap) to 1 (perfect overlap). Thesensitivity (True Positive Rate) is used to identify positive instances. The values ofsensitivity range from 0 to 1, where 0 indicates that the model failed to identify anytrue positives, and 1 indicates that the model correctly identified all true positives.The hausdorff distance (HD) quantifies the maximum distance between the predictedand actual segmentation boundaries (the smaller the better) . To evaluate inter-observer variability, we compared the overlap between lesions manually segmented bythe two experts using the DSC and HD metrics.Three biomarkers (the SUVmax, the MTV, and the TLG) were automaticallyextracted from the fully-automated and the manual segmented regions at both base-line and follow-up stages from the 12 patients used to test the models. Moreover, thesemetrics were automatically calculated from the automatic segmentation for the 180cases with PETBI and PETFU. The SUVmax reveals the tumor's highest metabolicactivity for one voxel. Meanwhile, the MTV assesses the tumor's overall metabolic vol-ume, providing information on disease extent. The TLG combines metabolic activityand volume. The linear relationship between manually and automatically extractedbiomarkers using the Pearson correlation coefficient was measured . Paired t-testwas conducted to evaluate the differences in biomarkers between patients at two dif-ferent time points (baseline vs. follow-up) as our data follows a normal distribution. Ap-value of less than 0.05 was considered as significant. Box plots were used to depictthe distribution of biomarkers before and after one course of NAC. The whiskers onthe box plots represent the spread of data points outside the upper (third) and lower(first) quartiles."}, {"title": "3 Results", "content": null}, {"title": "3.1 Hyperparameter setting", "content": "All experiments were conducted and validated using the PETBI exams mentionedin the Table 1. The effect of varying epsilon values on the combined loss functionwas studied within the range [0,1]. During the hyperparameter tuning of epsilon, thevalues of \u03b1, \u03b2, and y were held constant throughout the experiments and fixed at 0.5,0.5, and 1.0, respectively. The Table 2 shows that assigning a weighting factor of 0.7to the FTL and 0.3 to the BCE loss yields optimal segmentation results. We haveconsidered different configurations of \u03b1, \u03b2, and y, along with \\u20ac, to find the optimalvalues and improve the segmentation result. The model performed best with \u03b1 = 0.7,\u03b2 = 0.3, and y = 1.5 (Table 3)."}, {"title": "3.2 Segmentation results", "content": "Among the three UNet-based deep learning architectures evaluated, the nnUNetmodel was chosen for its superior performance with an average DSC of 0.89\u00b10.04 forthe best configuration using PETBI dataset (Table 3). Figure 6 shows an example oflesion segmentation for two patients, each including PETBI and PETFu acquisition.The inter-observer variability study between experts for the manual segmentationshowed a DSC score of 0.92 \u00b1 0.02 and HD of 4.02 \u00b1 0.21 (Table 4). The automaticsegmentation achieved an average DSC of 0.89 \u00b1 0.04 and HD of 3.52 \u00b1 0.76 onthe same PETBI scans. These results indicates that the model's performance falls"}, {"title": "4 Discussion", "content": "The proposed deep learning-based method demonstrates highly promising outcomesin segmenting breast cancer lesions and extracting biomarkers from PET scans, withgood performance. The model shows robustness in generalizing the method to PETFuscan Deep learning models (UNet, 3D UNet, and nnUNet) were trained and validatedon 231 PET scans, and their performance was assessed using key metrics such as DSC,IOU, and HD. The nnUNet demonstrated the highest performance on the PET BIscans and reasonably good performance in segmenting breast cancer lesions in PETFuscan This difference in performance arises from the model being initially trained onthe PETBI dataset. Additionally, it is likely influenced by the nature of PET Fu scans,"}, {"title": "5 Conclusion", "content": "In conclusion, this study presents an approach for the automatic segmentation andbiomarker computation of breast cancer lesions from 18F-FDG PET scans. The pro-posed pipeline is based on deep learning architectures and a weighted sum of lossfunctions. It demonstrated very good performance in accurately segmenting tumorsfrom PET scans at both the baseline stage and follow-up level after one course ofNAC. Our pipeline has successfully employed fine-tuning processes and active learn-ing methods. Moreover, quality control measures were implemented to ensure theconsistency and validity of the segmentation results. This approach holds promise forimproving the efficiency of tracking disease progression, thereby enhancing personal-ized treatment planning and monitoring. Beyond the calculated biomarkers, clinicaldata and additional parameters could be considered to build a predictive model fortreatment response and survival rates. Our developed tool could be integrated intothe treatment pipeline for patients with breast cancer."}]}