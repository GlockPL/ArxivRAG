{"title": "YOLO-pdd: A Novel Multi-scale PCB Defect Detection\nMethod Using Deep Representations with Sequential Images", "authors": ["Bowen Liu", "Dongjie Chen", "Xiao Qi"], "abstract": "With the rapid growth of the PCB manufacturing industry, there is an increasing de-\nmand for computer vision inspection to detect defects during production. Improving the accuracy\nand generalization of PCB defect detection models remains a significant challenge. This paper pro-\nposes a high-precision, robust, and real-time end-to-end method for PCB defect detection based on\ndeep Convolutional Neural Networks (CNN). Traditional methods often suffer from low accuracy\nand limited applicability. We propose a novel approach combining YOLOv5 and multiscale modules\nfor hierarchical residual-like connections. In PCB defect detection, noise can confuse the background\nand small targets. The YOLOv5 model provides a strong foundation with its real-time processing\nand accurate object detection capabilities. The multi-scale module extends traditional approaches\nby incorporating hierarchical residual-like connections within a single block, enabling multiscale\nfeature extraction. This plug-and-play module significantly enhances performance by extracting\nfeatures at multiple scales and levels, which are useful for identifying defects of varying sizes and\ncomplexities. Our multi-scale architecture integrates feature extraction, defect localization, and\nclassification into a unified network. Experiments on a large-scale PCB dataset demonstrate sig-\nnificant improvements in precision, recall, and F1-score compared to existing methods. This work\nadvances computer vision inspection for PCB defect detection, providing a reliable solution for\nhigh-precision, robust, real-time, and domain-adaptive defect detection in the PCB manufacturing\nindustry.", "sections": [{"title": "1 Introduction", "content": "In modern electronic components, printed circuit boards (PCBs) represent a unique category character-\nized by trends toward intelligence, lightweight design, high density, and highly inclined equipment [1].\nGiven that PCB defects can compromise the functionality and safety of electronic devices, leading to\nreduced corporate yields, ensuring the quality and reliability of PCBs is crucial. This guarantee helps\nmaintain the performance and longevity of electronic products [3].\nDespite advances in automatic optical inspection (AOI) and the emergence of deep learning-based\ndetectors for PCB defect detection, several research gaps and challenges persist within this domain:\n(1) Robustness to Manufacturing Variability: Existing methods, including AOI and traditional deep\nlearning detectors, often struggle to maintain high detection accuracy in the face of manufacturing\nvariability, such as variations in PCB layout, component placement, and soldering conditions. Robust\ndefect detection techniques are needed that can handle these variations effectively.\n(2) Domain Adaptation and Generalization: Although deep learning-based detectors show promise in\ndetecting defects, they can struggle with domain adaptation when deployed in diverse manufac-\nturing environments or when confronted with new types of defects not seen during training. For\nexample, DeepPCB [36] uses black-and-white images, whereas HRIPCB [37] employs color image\nrepresentation. This difference in imaging methods and image representation impacts the compat-\nibility and usability of the datasets, thereby adversely affecting the training and performance of\ndetection models. Therefore, methods to enhance the generalizability of these models in different\nPCB configurations and manufacturing conditions are essential.\n(3) Real-time performance [1]: Real-time defect detection remains a challenge, particularly for complex\nPCBs with densely packed components. Methods that balance accuracy with real-time processing\nspeed are necessary for practical industrial applications.\n(4) Anomaly Detection and Sample Scarcity: Traditional defect detection methods often rely on super-\nvised learning with labeled datasets. However, labeled samples require significant resources. In the\nabsence of preexisting labels, how to leverage unsupervised learning [35], semisupervised learning [38],\nzero-shot learning [39], and transfer learning methods [40] to identify novel defects or anomalies\nand reduce the dependence on samples remains an unresolved issue. Therefore, developing methods\nfor anomaly detection using unsupervised learning, semi-supervised learning, etc. techniques are a\npromising area for future research. Fortunately, data-augmentation algorithms can be utilized to\naugment samples and reduce labeling costs. For example, virtual data sets can be created based on\nGenerative Adversarial Networks (GANs) [41] or using model-design software [42].\n(5) Integration of Multimodal Data: Current defect detection methods focus mainly on visual inspection.\nIntegrating other modalities such as thermal imaging or X-ray data [45]could provide complementary\ninformation for more accurate defect detection, especially in complex PCB designs.\nAddressing these research gaps will contribute significantly to the advancement of the state-of-the-art\nin PCB defect detection, ultimately improving product quality and reliability in the electronics man-\nufacturing industry. In the rapid development of electronic technology, there is a growing demand for\nefficient and accurate methods to detect PCB defects. Traditional inspection methods, such as manual vi-\nsual inspection, often exhibit lower detection accuracy, higher costs, and lower efficiency when faced with\nheavy inspection tasks and complex inspection environments. Meanwhile, automated optical inspection\n(AOI) is significantly influenced by optical conditions and tends to have a higher false detection rate [2].\nTherefore, there is an urgent need for innovative approaches capable of reliably identifying defects in\nvarious types and configurations of PCBs.\nGiven the aforementioned challenges, this paper aims to address the demands of the PCB manufactur-\ning industry for high precision, robustness, real-time performance, and domain adaptation by proposing\na PCB defect detection method based on deep convolutional neural networks (CNNs). This method aims\nto overcome the deficiencies of existing PCB defect detection methods and improve the accuracy and\ngeneralization performance of the model. To address this issue, the research team introduces a novel\napproach that uses deep CNNs and integrates feature extraction, defect localization, and classification\ninto a multistage network architecture. Extensive experiments on a large-scale PCB dataset demonstrate\nsignificant improvements in this method compared to existing approaches. Particularly noteworthy is its\nachievement of real-time performance, making it suitable for widespread industrial applications. Addi-\ntionally, the study addresses the challenge of domain adaptation in PCB defect detection by addressing\ndomain drift through feature alignment from data sources, and experimental validation confirms the\nmethod's robustness and adaptability across various manufacturing environments and conditions. Con-\nsequently, this research represents a significant breakthrough in computer vision technology for PCB\ndefect detection, providing the manufacturing industry with a reliable solution for defect detection.\nThe contributions of this paper are significant and can be summarized as follows:\n\u2022 A novel framework using a deep CNN-based, multi-stage network for PCB defect detection has been\nproposed, integrating feature extraction, defect localization, and classification into a unified system.\n\u2022 A high-performance CNN-based method that leverages both global and local features to significantly\nimprove PCB defect detection has been developed, achieving notable gains in precision, recall, and\nFl-score.\n\u2022 A temporal approach with domain adaptation for PCB defect detection has been proposed, inte-\ngrating YOLOv5 and Res2Net modules to ensure robustness under blurred or occluded conditions,\nsignificantly outperforming baseline methods."}, {"title": "2 Related works", "content": "In modern industrial scenarios, as the core component of electronic equipment, the printing circuit board\n(PCB) plays a vital role in ensuring the reliability and stability of the product [43]. However, in the\nentire manufacturing and application of PCB, various defects and problems are often encountered. In\norder to ensure the quality of PCB, the industry uses various methods to perform defect detection and\nelectricity testing."}, {"title": "2.1 Manual Defect Detection Methods", "content": "Defect detection has been a crucial aspect in the field of PCB manufacturing. Traditional manual visual\ninspection stands as one of the primary methods employed. This method relies heavily on operators\nthat use tools such as magnifying glasses or calibrated microscopes to inspect the quality of circuit\nboards, making judgments based on their skills and experience with respect to the need for rectification\n[19]. However, this visually dependent inspection method exhibits certain limitations, with subjective\nestimation being the most noticeable risk. Subjective judgments of the operator can lead to erroneous\ndetection results, affecting the quality and performance of the product, increasing the risk of industrial\naccidents such as fires caused by cable shorts or connection errors, and consequently reducing the safety of\nthe production line [8]. Moreover, this method highly depends on the skills and experience of operators,\nnecessitating factories to allocate substantial financial resources to recruit proficient personnel. Even\nthe most experienced experts may err due to subjective estimation, resulting in inaccurate detection\noutcomes [20]. Therefore, manual visual inspection methods are increasingly becoming unsuitable for\npractical production tasks [18]."}, {"title": "2.2 Automatic Optical Inspection", "content": "AOI based on machine vision (AOI) is a technology utilized for the detection of surface defects and\nabnormalities present on electronic components. It employs cameras and image processing algorithms\nto scan and analyze components and connection points on the printed circuit board (PCB), aiming to\nidentify potential defects such as short circuits, open circuits, poor soldering, incorrect soldering, etc.\n[23]. Specifically, the operational principle of AOI (Automatic Optical Inspection) is rooted in machine\nvision technology, employing red, green, and blue LED lights to illuminate PCB components [21]. It\nutilizes the principle of optical reflection to depict the soldering conditions of components on the PCB.\nSubsequently, it employs cameras or sensors to capture and analyze images of the printed circuit board\n(PCB) for the detection of defects within PCB components. Additionally, this method incorporates\nvarious innovative and improved techniques, such as automatic X-ray inspection (AXI), two-dimensional\nautomated optical inspection (2D AOI), and three-dimensional automated optical inspection (3D AOI),\nfor PCB defect recognition [1]. However, current automatic optical inspection (AOI) techniques are\nsusceptible to the effects of ambient light, leading to significant distortion in captured images and an\nincrease in misjudgment rates during the detection process [22]. In order to address this issue, although\nmany PCB manufacturers opt for manual reevaluation, this undoubtedly incurs additional labor costs,\nresulting in resource wastage."}, {"title": "Machine Learning-based Detectors", "content": "To overcome the time-consuming nature and reliance on a large\nnumber of reference images associated with traditional image processing methods, many researchers have\nturned to machine learning algorithms [32]. The current main research methods for PCB image defect\ndetection based on machine learning can be divided into supervised learning (BP neural network, SVM),\nunsupervised learning (PCA, clustering methods), and semi-supervised learning [24] [25] [26]. These\nalgorithms have become a focal point of research in the field of PCB defect detection, encompassing\nnumerous classical machine learning algorithms. Through these methods, the detection of solder joints\nand components can be performed more rapidly and accurately, offering new possibilities for quality\ncontrol in the PCB manufacturing process. Furthermore, despite the capability of image subtraction-\nbased methods to achieve high-precision detection of PCB defects, machine learning algorithms excel in\nenhancing efficiency and accuracy, making them a viable choice in certain circumstances [4]. A common\napproach, as explained by Yun et al. [9], utilizes a Support Vector Machine (SVM) in conjunction with a\ntiered circular illumination technique to inspect PCB solder joints. The researchers assembled a dataset\ncomprising 402 solder joints for training and testing the model, achieving defect detection rates of 96.\n07% and 98%, respectively. In particular, this performance exceeds that of alternative methods, including\nthe K-means classifier [10] and the back-propagation (BP) classifier [11]. However, it is imperative to\nacknowledge that this method encounters several challenges, such as the selection of hyperparameters C\nand kernel in SVM, alongside the necessity for a sophisticated three-color circular illumination system."}, {"title": "Deep Learning-based Detectors", "content": "Deep learning methods, especially convolutional neural networks\n(CNNs) including deep CNN (DCNN) [12], VGG neural network [31], [30] and ResNet neural network\n[11], [33], etc., have been widely applied in various fields such as image processing, classification, object\ndetection, and segmentation [27]. These methods automatically extract image features, simplifying the\nimage preprocessing process and effectively enhancing the accuracy and speed of detection. Compared to\ntraditional detection methods, CNN-based approaches demonstrate strong robustness to environmental\nfactors and noise. Across diverse datasets, CNN-based object detection algorithms exhibit excellent\nperformance, serving as the primary driving force in the advancement of object detection. Consequently,\ndeep learning algorithms have garnered the attention of researchers for PCB defect detection, achieving\ncommendable detection performance [4].\nIn general, PCB detection methods based on deep learning can be classified into two categories: two-\nstage and single-stage approaches. Among the most commonly used methods for detecting PCB defects\nare the two-stage target detection algorithms: Region-Based Convolutional Network (R-CNN) [47] and\none-stage target detection algorithms: You Only Look Once (YOLO) series [48], Single shot multi-box\ndetector (SSD) [49]. The important point to note is that Faster R-CNN [5] is an improved object detection\nmodel developed based on R-CNN [6] and Fast R-CNN [7]. Compared to the two-stage approach, the\nYOLO series, although relatively less precise, boasts a higher detection speed. Furthermore, due to its\nend-to-end architecture, the YOLO series is relatively simple to implement and is thus widely favored\nin the industrial domain. Ding et al. [12] introduced TDD-net, a novel micro-defect detection network\nbased on faster R-CNN. Inspired by YOLOv2 [13], the method autonomously determines anchor scales\nsuitable for PCB images. By employing various data augmentation techniques and the Feature Pyramid\nNetwork (FPN) [14], high detection accuracy (98.9% mAP) is achieved. However, TDD-net operates as\na two-stage framework, resulting in a large parameter count and a slower detection speed. The use of\nfully connected layers increases the complexity of the model, while Rol pooling may compromise the\ntranslational invariance of features. Despite its strong performance in defect detection, challenges remain\nin assessing real-time applicability and sensitivity to parameters. CFIL [9] proposes a frequency-domain\nfeature extraction module and feature interaction in the frequency domain to enhance salient features.\nMFC [11] proposes a frequency-domain filtering module to achieve dense target feature enhancement.\nAdibhatla et al. [16] utilized YOLOv5 [17] for PCB defect detection, improving accuracy through data\naugmentation and improved model backbone, with the largest model achieving a detection accuracy of\n99.74%. However, the method only distinguished between defective and non-defective targets without\nclassifying defect types and exhibited low defect confidence scores. Additionally, to reduce computational\ncosts, detection was performed only on small cropped images, potentially limiting real-time detection\nacross entire PCB images."}, {"title": "3 Methodology", "content": "The primary objective of this research is to develop an advanced PCB defect detection method using deep\nconvolutional neural networks (CNNs) to address the limitations of traditional inspection techniques.\nSpecifically, our research aims to achieve the following objectives: (1) High Precision and Robustness:\nDevelop a defect detection system that can achieve high precision and robustness, ensuring reliable\nidentification of various types of PCB defects with minimal false alarms. (2) Real-time performance:\nDesign the system to operate in real time, enabling rapid inspection and detection of defects during PCB\nmanufacturing processes. (3) Domain Generalization and Efficiency: Investigate and improve domain\nadaptation techniques for PCB defect detection to enhance the efficiency and generalization of the model\nin diverse manufacturing environments and conditions. This comprehensive methodology aims to develop\nan effective and efficient PCB defect detection system using state-of-the-art deep learning techniques,\ntailored for deployment in real-world manufacturing environments."}, {"title": "3.1 The proposed PCB defect detection framework", "content": "The proposed PCB defect detection framework leverages deep convolutional neural networks (CNNs) to\nachieve high precision, robustness, real-time performance, domain adaptation, generalization, and effi-\nciency. The framework consists of the following key components: input data handling, which includes\npre-processing of PCB images to enhance quality, address noise, and standardize input dimensions; CNN\narchitecture design, involving the development of a custom CNN architecture for PCB defect detection,\ncomprising feature extraction, defect localization, and classification layers; integration of domain adap-\ntation techniques to enable the model to generalize across different manufacturing environments and\nconditions; and optimization for real-time processing to ensure real-time performance during PCB in-\nspection processes. Data collection and pre-processing techniques for PCB images involve the acquisition\nof a diverse dataset of PCB images representing various types of defects and manufacturing conditions.\nSince most PCB defect visual inspection systems, particularly those based on machine learning and deep\nlearning techniques, are fundamentally data driven, addressing PCB defect data preprocessing constitutes\na crucial step in the process. Specifically, preprocessing techniques include image augmentation (gener-\nation of synthetic data to increase dataset diversity and robustness), normalization and standardization\n(rescaling and normalizing pixel values to facilitate model training), and noise reduction (application of\nfiltering and denoising techniques to enhance image clarity)."}, {"title": "3.2 Deep Representation Methods for PCB Defect Detection", "content": "Our work focuses on capturing discriminative information from PCB images using advanced feature\nextraction methods. We leverage pre-trained CNNs, such as ResNet and VGG, for automatic feature\nextraction from PCB images. We employ localization techniques, using region-based or sliding-window\napproaches, to pinpoint defects within PCB images.\nOur training strategies emphasize optimizing model performance and generalization. We select appro-\npriate loss functions, such as categorical cross-entropy, to train CNNs on imbalanced defect datasets. To\navoid overfitting, we apply regularization techniques such as dropout, batch normalization, and weight\nregularization. Additionally, we iteratively tuned model hyperparameters, including learning rate and\nbatch size, to optimize performance metrics.\nUnderstanding the importance of the loss function in machine learning and statistical modeling, we\nrecognize it as a mathematical function that maps the difference between the predicted output of our\nmodel and the true labels to a non-negative real number, representing the prediction error or risk level\nof the model. Our goal is to minimize this loss function to optimize our model, enabling it to make more\naccurate predictions on unseen data.\nFor the YOLOv5 series, the loss function that we use consists mainly of four components: localization\nerror, confidence error with object, confidence error without object, and classification error. By addressing\nthese components, we enhance the accuracy and reliability of our model in PCB defect detection. By\ncomprehensively considering the optimization of these four parts, we obtain the loss function of YOLOv5,\nwhich can be expressed as follows:\n$L_{YOLOV5} = \\lambda_{coord}\\sum_{i=0}^{S^2}\\sum_{j=0}^{B}obj_{ij}[(x_i-\\hat{x_i})^2 + (y_i - \\hat{y_i})^2]$\n$+ \\lambda_{coord} \\sum_{i=0}^{S^2} \\sum_{j=0}^{B} obj_{ij}[(\\sqrt{w_i} - \\sqrt{w_i})^2$\n$+ (\\sqrt{h_i} - \\sqrt{h_i})^2]$\n$+ \\sum_{i=0}^{S^2} \\sum_{j=0}^{B} (C_i - \\hat{C_i})^2$\n$+ \\lambda_{noobj} \\sum_{i=0}^{S^2} \\sum_{j=0}^{B} noobi (C_i - \\hat{C_i})^2$\n$+ \\sum_{i=0}^{S^2}\\sum_{ceclasses} (P_i(c) - \\hat{P_i(c)})^2$\nDuring the training process of the YOLOv5 model, the back-propagation (BP) algorithm is employed.\nThis widely used optimization algorithm calculates the gradients of the model parameters based on\nthe loss function and updates the parameters using optimization methods such as gradient descent to\nminimize the loss function. In the process of this algorithm, comparing the actual output (y) with the\nexpected output (r) yields an error signal. This error signal is propagated back through each layer of the\nneural network, propagating layer by layer, and computing the error signal for each layer. Subsequently,\nby adjusting the connection weights of each layer to minimize error, the performance of the neural\nnetwork is optimized."}, {"title": "3.3 YOLOv5 combined with Res2Net module", "content": "The Res2Net [44", "46": ".", "Splitting": "nThe input feature map is divided into several smaller segments. 2. Hierarchical Transformation:\nSegments are hierarchically transformed with increasing complexity. 3. Feature Aggregation: Trans-\nformed segments are concatenated", "Connection": "A residual\nconnection is added to stabilize the training and mitigate the vanishing gradient problem.\nshows", "de-\ntection": 1.0, "Extraction": "Res2Net's ability to capture a wide range of\nfeatures within a single block enhances the feature extraction capabilities of YOLOv5. This is particularly\nuseful for detecting defects of various sizes in PCBs. 2. Improved Detection Accuracy: The combi-\nnation improves the accuracy of defect detection, especially for small and intricate defects. Res2Net's\nmultiscale processing complements the robust detection framework of YOLOv5. 3. Real-time Process-"}]}