{"title": "DRIVING PATTERN INTERPRETATION BASED ON ACTION PHASES CLUSTERING", "authors": ["Xue Yao", "Simeon C. Calvert", "Serge P. Hoogendoorn"], "abstract": "Current approaches to identifying driving heterogeneity face challenges in comprehending funda-\nmental patterns from the perspective of underlying driving behavior mechanisms. The concept of\nAction phases was proposed in our previous work, capturing the diversity of driving characteristics\nwith physical meanings. This study presents a novel framework to further interpret driving pat-\nterns by classifying Action phases in an unsupervised manner. In this framework, a Resampling\nand Downsampling Method (RDM) is first applied to standardize the length of Action phases.\nThen the clustering calibration procedure including \u201cFeature Selection\u201d, \u201cClustering Analysis\",\n\u201cDifference/Similarity Evaluation\u201d, and \u201cAction phases Re-extraction\u201d is iteratively applied until\nall differences among clusters and similarities within clusters reach the pre-determined criteria.\nApplication of the framework using real-world datasets revealed six driving patterns in the 180\ndataset, labeled as \u201cCatch up\u201d, \u201cKeep away\u201d, and \u201cMaintain distance\u201d, with both \u201cStable\u201d and\n\"Unstable\" states. Notably, Unstable patterns are more numerous than Stable ones. \u201cMaintain\ndistance\" is the most common among Stable patterns. These observations align with the dynamic\nnature of driving. Two patterns \u201cStable keep away\u201d and \u201cUnstable catch up\" are missing in the\nUS101 dataset, which is in line with our expectations as this dataset was previously shown to have\nless heterogeneity. This demonstrates the potential of driving patterns in describing driving hetero-\ngeneity. The proposed framework promises advantages in addressing label scarcity in supervised\nlearning and enhancing tasks such as driving behavior modeling and driving trajectory prediction.", "sections": [{"title": "INTRODUCTION", "content": "Driving heterogeneity, recognized as the differences in driving behaviors exhibited by different\ndriver/vehicle combinations under similar conditions, is widely acknowledged (1). Studies have\nshown that heterogeneity in driving behavior can lead to a rise in traffic accidents, congestion,\nand emissions (2, 3). Further, user acceptance of autonomous vehicles (AVs) has been found to\nhinge on accurately comprehending and emulating driving heterogeneity of human-driven vehi-\ncles (HDVs), such as human drivers' preferred driving styles (4). Thus, understanding driving\nheterogeneity plays a significant role in enhancing traffic operations and enabling manufacturers\nto design safe and efficient automated vehicles at various levels.\nExisting studies have addressed driving heterogeneity by personalizing driving styles based\non driving behavior data such as vehicle kinematics variables (e.g., velocity and headway) and\nvehicle dynamics variables (e.g., braking and throttle opening), which enable categorizing drivers\ninto several groups (5). For instance, Wang et al. (6) classified drivers into two categories (i.e.,\nnormal, and aggressive) based on velocity and throttle opening data. In another study, overtaking\nmaneuvers were identified as low-medium-high risk levels based on speed and distance between\nvehicles (7). Other studies have utilized car-following model parameters to distinguish driving\nstyles (2). While this method captures drivers' static driving characteristics, it is not capable to\ndescribe the inherent traits of driving behavior. This is because driving behavior is a dynamic\ndecision-making process (5), drivers may exhibit heterogeneous driving styles in different traffic\nscenarios. Even under the same traffic scenario, the same driver's behaviors might vary at different\ntime intervals.\nSome studies found that driving heterogeneity can be derived by decomposing driving be-\nhavior into distinct driving patterns. As driving behavior displays certain characteristics during the\ntransition of driving maneuvers (8). As such, some researchers (9, 10) segmented driving behav-\nior data into primitives with unique characteristics. Typically, these primitives referred to distinct\ndriving patterns, specifically known as primitive driving patterns. By doing so, the characteris-\ntics of driving behavior can be accurately captured by corresponding the traffic environment and\ndriving maneuvers. Using supervised learning approaches, different patterns were extracted and\nassigned with semantic labels (e.g., rapidly closing in, falling behind) by learning sample features\nlike vehicle operating data (5). However, pre-labeling tasks are labor-intensive, limiting the imple-\nmentation of supervised learning technologies in driving pattern recognition (11). As a result, there\nis a growing interest in semantic analysis using unsupervised techniques. Higgs and Abbas (12)\nidentified a specific set of state-action clusters and employed them to characterize potential driving\npatterns of passenger car and truck drivers. Employing a hierarchical Dirichlet process-Hidden\nsemi-Markov Model (HDP-HSMM), Wang et al. (13) extracted 75 primitive driving patterns from\ntime series driving data. This method allows for the identification of a wider variability in driving\nbehavior by encompassing different driving characteristics. However, an excessive number of pat-\nterns, for example, 75, may limit the categorization's effectiveness due to reduced interpretability.\nThis expansive classification has limitations in fully clarifying fundamental driving behaviors and\nunderstanding driving heterogeneity. As a result, continued research in this field is required to\novercome these challenges.\nIn our previous research (14), the concept of Action phases was introduced to capture driv-\ning characteristics with physical meanings, aiming to pave the way for identifying driving hetero-\ngeneity. It expanded the scope of the \u201caction point\u201d (15) by incorporating additional variables to\nprovide more comprehensive information about driving behavior. The action trend space for each"}, {"title": "METHODOLOGY", "content": "In this section, we first give an overview of the framework for interpreting driving patterns. Then\nthe methods and techniques employed in each step are explained.\nOverall framework\nThe objective of the framework is to categorize Action phases into several driving patterns by\nutilizing an Action phase Library. These patterns consist of different Action phases that exhibit\ncommon traits. The Action phase Library for each dataset was built in our previous work, which\nis briefly shown as the Data Preprocessing step in Figure 1. Due to the limitations of the high-\ndimensional data used as input (2), Feature Selection is first conducted. If there is insufficient\ninformation regarding feature importance, particularly during the initial analysis phase, an un-\nsupervised feature extraction method is utilized. After the variable importance is evaluated, the\nfeatures are selected according to the weights of variable importance. The extracted features serve\nas input for the subsequent Cluster Analysis with an unknown cluster number k. The clustering\nresults are evaluated from both inter-class and intra-class perspectives, demonstrated in the Simi-\nlarity/Difference Evaluation step. In inter-class evaluation, the differences (df, indicating the dis-\ntance) among clusters are calculated. As for intra-class, the shape similarities of variables between\nAction phases within the same cluster are assessed using a dissimilarity index (dSI). Specifically,\nthe inter-class evaluation takes precedence over the intra-class, implying that only clusters with\nsubstantial differences from each other are subjected to internal similarity evaluation. If the dif-\nferences are less than a specific threshold 8, the clustering results are directly accepted for driving\npattern description. In the intra-class evaluation, Action phases that display a dSI greater than the\nthreshold & will be re-extracted and re-analysis in the next analysis round. The remaining Action\nphases, which do not exceed this threshold, are maintained within the current cluster, contributing"}, {"title": "Data preprocessing", "content": "The Action phases accommodated driving trajectory segments with varying lengths in order to\nprovide a more detailed representation of driving behavior characteristics. This refinement adds\na layer of complexity to subsequent analyses, as most algorithms necessitate input data of equal\nlength. Various methods have been suggested to mitigate this issue. One prevalent approach is\npadding, where sequences are extended with a specific value (commonly zero) to match the length\nof the longest sequence. Alternatively, truncation is utilized, wherein sequences are grouped into\n\u201cbuckets\u201d of similar lengths (for instance, 1-10, 11-20, 21-30, etc.), followed by padding within\neach bucket. There are also studies that employed variable-length Recurrent Neural Networks\n(RNNs) to convert sequences into fixed-length representations."}, {"title": "Feature Selection", "content": "In the initial stage of clustering, an unsupervised feature extraction approach is employed due to\nthe lack of clear information about the significance of variables. Principal Component Analysis\n(PCA) (17), Kernel PCA, t-SNE, among others, are frequently utilized methods for this purpose.\nUpon completion of the first analysis round within the framework, the importance of vari-\nables can be evaluated. Consequently, for the subsequent stages of clustering, feature extraction is\nguided by the variable importance score (IS) acquired from the preceding analysis round. Borda\nCount (18), a highly recognized example of weighted scoring rules, is commonly applied in multi-\ncandidate, single-winner electoral procedures. This method, which also provides the votes of each"}, {"title": "Clustering Analysis", "content": "The clustering analysis in our framework aims at finding typical driving patterns in a given dataset.\nVarious clustering approaches with inherent techniques have been proposed, this is due to the fact\nthat there is no such precise definition to the notion of \u201ccluster\u201d (19). According to Fraley and\nRaftery (20), the clustering approaches are divided into two different groups: hierarchical and\npartitioning techniques. Hierarchical clustering is chosen as the principal clustering method for\ntwo main reasons. The first is its capability to form a hierarchical depiction of the provided dataset,\nwhich in essence gives an outline of the distribution of driving patterns. The second advantage is\nthat hierarchical clustering offers reproducibility of the resulting clusters (21). This mitigates the\nsensitivity to random initializations commonly encountered by partitioning clustering techniques\nsuch as k-means.\nHierarchical clustering can function in two ways - agglomerative (bottom-up) and divisive\n(top-down) - both of which are intrinsic strategies for building a binary tree. An agglomerative\nstrategy is employed here, as it begins with each pattern as an individual cluster and inspects the\nconnections between patterns or intermediate clusters. The fundamental concept is to merge the\ntwo closest patterns or intermediate clusters into a new, larger cluster. The proximity between any\ntwo patterns is determined using the Manhattan distance, also known as the city block distance\n(22). When assessing the distance between two clusters, the average-link scheme is implemented,\nwhich measures the mean distance across all pairs of Action phases from those clusters (refer to\nEquation 3). This procedure is repeated until only a single cluster is left, indicating all Action\nphases have been grouped into the same cluster."}, {"title": "DTW-based Similarity Evaluation", "content": "The key to effective clustering is ensuring significant distances between clusters while also main-\ntaining high internal similarity. Each variable in the Action phases can be considered as a set of\ntime-series data. However, the challenge with comparing the similarity of two time-series data\npoints is that even if they share similar characteristics or trends, they might not align along the\ntime axis. For instance, two sets of velocities could demonstrate similar trends over time, but one\nmay occur at a faster or slower rate than the other. This is where Dynamic Time Warping (DTW)\nproves useful.\nThe main idea behind DTW is to compare the distances of two sequences under all pos-\nsible \"warpings\u201d, and then identify the optimal match among these warpings (23). Consider two\nsequences, $X = [x_1,x_2,...,x_n]$ and $Y = [y_1,y_2, \u2026\u2026\u2026, y_m]$ of lengths $|X|$ and $|Y|$ respectively. A warp\npath $W$ is then created, as shown in Equation 5.\n$W = w_1,w_2,...,w_K max(|X|,|Y| \\le K < |X| + |Y|)$ \n\nhere, $K$ signifies the length of the warp path, and the $k$-th element of the warp path is $w_k = (i, j)$,\nwhere $i$ and $j$ are indices of time series $X$ and $Y$, respectively. The warp path initiates at the\nbeginning of each time series at $w_1 = (1,1)$ and finishes at the end of both time series at $w_K =$\n$(|X|,|Y|)$. A constraint on the warp path mandates $i$ and $j$ to be monotonically increasing in the\nwarp path. Every index of both time series must be engaged. This constraint can be expressed\nmore formally as follows:\n$w_k = (i, j), w_{k+1} = (i', j') i \\le i' \\le i + 1, j \\le j' \\le j + 1$\nThe optimal warp path is the one with minimum distance, where the distance (or cost) of a\nwarp path $W$ is"}, {"title": "EVALUATION OF THE CLUSTERING CALIBRATION PROCESS", "content": "Evaluation of the clustering calibration process is designed and presented in this section. First,\ndata preparation including Action phases review and feature selection results is introduced. Then,\nhierarchical clustering is conducted, and the results are evaluated by using a qualitative measure for\ninter-class difference and a quantitative measure for intra-class similarity. Action phases demon-\nstrating low intra-class similarities are extracted, during which process the variables' importance\nis calculated."}, {"title": "Data and Feature Selection", "content": "As proposed in (14), driving behavior trajectories are segmented to yield Action phases, with each\ndriving variable in these phases displaying a single trend. For example, (D,L,L,I) indicates the\nvehicle's velocity (v) has a trend of decreasing, the acceleration (a) and distance (d) are keeping a\nlow value, and the speed difference (Av) is increasing. All the Action phases extracted from one\ndataset (representing a specific traffic flow condition) constitute the Action phase Library of this\ndataset, which is adopted as the initial data in this study. The total size of the Action phase Library\namounts to 1764 for the 180 dataset and 13564 for the US101 dataset.\nAction phases consist of trajectory information using four variables, making feature extrac-\ntion crucial for high-quality cluster analysis. This study employs Principal Component Analysis\n(PCA), an unsupervised feature selection method, to cohere variables and extract significant fea-"}, {"title": "Clustering Analysis", "content": "Determining a suitable validation strategy for an unsupervised learning problem is acknowledged\nto be a complex task. The literature generally offers two validation criteria: internal and exter-\nnal (24). The external criterion compares the clustering outcome with existing knowledge of the\ndataset's structure (commonly referred to as true labels), whereas such information is usually sub-\njective or unavailable. As a result, this study concentrates on the internal criterion, which assesses\nclustering results based on the inherent properties of the dataset. The evaluation undertaken in this\nstudy includes i) a qualitative measure for inter-class by visually observing the dendrogram to as-\ncertain the differences between clusters, and ii) a quantitative measure for intra-class by calculating\nthe similarity of Action phases within a cluster."}, {"title": "Qualitative evaluation", "content": "Clustering results are evaluated by examining different (intermediate) clusters, i.e., branches, demon-\nstrated by the two dendrograms shown in Figure 4. The metric is based on the similarities among\nthe Action phases within the same cluster. Focusing on the dendrogram for the I80 dataset depicted\nin Figure 4a, the first analysis involves the two highest sub-trees (or branches): The left sub-tree\ncomprises small, simple patterns of Action phases, as colored by orange; conversely, the right sub-\ntree displays a variety of patterns. Thus, further examination is conducted on the right sub-tree,\nrevealing that (i) the left sub-subtree contains small, straightforward patterns of Action phases; (ii)\ndespite the right sub-subtree demonstrates a diversity of patterns, they occur at close distances.\nFollowing this analysis, three clusters are identified in the I80 dataset (marked as Cluster 3, 2, and\n1), and two clusters are observed in the US101 dataset (marked as Cluster 2 and 1). As shown in\nFigure 4a and Figure 4b, the distance between clusters obtained from the two datasets exceeds 2,"}, {"title": "Quantitative Evaluation", "content": "FastDTW compares the shape similarity by calculating the minimum-distance warp path between\ntwo variable data sets. This minimum distance is used as a dissimilarity index (dSI) to provide\na quantitative assessment of the clustering results. A value closer to 0 implies higher similarity\nbetween the two variable sequences. Conversely, a larger dSI suggests less similarity in their\nshape. The similarity assessment of the I80 dataset is depicted in Figure 5. (a) - (c) represent the\nthree clusters obtained from hierarchical clustering, while 1 - 4 denotes the four variables v, a, d,\nand Av considered in this study. All figures use a uniform color bar as a reference, with darker\ncolors indicating greater distances or less similarity. As represented by the deeper blue lines,\nlarger dSI values are observed in both Cluster 2 and Cluster 3, suggesting these Action phases have\na relatively low similarity. In contrast, Cluster 1 generally has low dSI values, signifying a high\ndegree of similarity between Action phases in this cluster. The same analysis is also carried out on\nthe US101 dataset, as shown in Figure 6.\nTo improve the intra-class similarity, Action phases with a dSI index for variables exceeding\na threshold value & will be re-extracted for the next round of analysis. In this context, the threshold\n& is defined as the 99th percentile of all dSI values in a given dataset. Consequently, a total of 1054\nand 11342 Action phases are re-extracted from the I80 and US101 datasets, respectively. More\nspecifically, from the I80 dataset, 1089 Action phases are extracted from Cluster 1, while 126 and\n133 Action Phases are from Cluster 2 and Cluster 3 respectively. As for the US101 dataset, the\nnumbers are 9258 and 2084 for Cluster 1 and Cluster 2, respectively."}, {"title": "Variable Importance Evaluation", "content": "Figure 7(a) and Figure 8(a) display the count of each variable involved in the re-extraction process.\nThe variable v appears to be the most recurrent one used in Action phases re-extraction in both\ndatasets, succeeded by a, d, and Av, in that sequence. It is worth noting that an Action phase could\nbe selected due to the marked dissimilarity in one or multiple variables, as the statistical data shown\nin Figure 7(b) and Figure 8(b). In the I80 dataset, the selection of most Action phases relies on"}, {"title": "Analysis on Re-extracted Action phases", "content": "Different from the initial round of analysis where feature selection is based on an unsupervised\nlearning method, this round of analysis employs features selected based on the variable impor-\ntance score (SI) computed in the prior round. Hierarchical clustering is also executed, with results\ndepicted in Figure 9. An observation of the dendrograms reveals three clusters in the I80 dataset\nand two clusters in the US101 dataset (see the sub-trees with different colors). Notice that sub-trees\nin each cluster are with small distances, or df, significantly smaller than the threshold 8 = 1, indi-\ncating high similarity among Action phases within the cluster. Therefore, the results are directly"}, {"title": "DRIVING PATTERN INTERPRETATION", "content": "Driving patterns are represented by the final results of the clustering calibration process, and the\ninterpretation for each pattern is provided in this section. Based on a measurement to distinguish\ndifferent driving patterns, i.e., the slope, a general analysis of the results is first presented. Then\ndriving patterns obtained from I80 dataset and US101 dataset are analyzed, respectively."}, {"title": "General Analysis of Driving Patterns", "content": "The concept of \u201cTrend\u201d has consistently been a key of our Action phases analysis, and it forms\nthe basis for characterizing driving patterns. Trends are illustrated through the slope, symboliz-\ning the rate of change in a given variable. A positive slope portrays an increasing trend, such\nas an increase in velocity, while a negative slope implies a decreasing trend. The magnitude of\nthe slope reflects the rate of change. Especially, several adjacent gentle slopes form fluctuations,\nrepresenting a 'Keeping' trend of variables. Given that variables usually manifest identical trends\nin different ways, such as linear increase, convex/concave progression, or slightly fluctuating in-\ncrease, linear regression may struggle to precisely identify variable trends. To capture local trends\nwithin specified intervals in the dataset and retain overall trend accuracy, we employ a 'sliding\nwindow' method. This technique involves forming a \u2018window' of a particular size (e.g., 5 peri-\nods, 10 periods, etc.) which \u2018slides' over the data points in the series (25). A linear regression is\ncomputed at each window position and the slope of the regression line is recorded. The final slope\nof the variable data, which serves as the trend index for each variable, is derived by averaging the\nslopes of these windows.\nFigure 10 and Figure 11 use boxplots to illustrate the statistical data of the variable trend\nindex for both datasets, respectively. Each boxplot displays the upper quartile, lower quartile, and\nmedian of the trend indexes. The whiskers extend to the farthest data points not deemed outliers,\nwhile outliers (if present) are denoted by asterisks. As previously mentioned, velocity holds the\nhighest importance score when it comes to identifying dissimilarities within Action phases, thus it\nis prioritized during analyzing the characteristics of driving patterns. Given that the speed differ-\nence Av signifies the interaction between vehicles and their preceding vehicles, it is also taken into\naccount when describing driving patterns. Based on domain knowledge, if the velocity increases\nwhile the speed difference decreases, this represents the situation where the target vehicle is catch-\ning up with the vehicle in front. Conversely, a decrease in velocity accompanied by an increase\nin speed difference represents a situation of keeping away from the preceding vehicle. If both the\nvelocity and speed difference remain roughly constant, it indicates that the vehicle is maintaining\nits current state."}, {"title": "Driving Patterns in I80 dataset", "content": "Figure 10 displays the trend index of variables for each cluster using the I80 dataset, where each\nsub-figure corresponds to a driving pattern. Specifically, Figures 10(a)-(c) represent patterns de-\nrived from the first round of clustering, while Figures 10(d)-(f) represent those from the second\nround. Notably, in the cluster illustrated by Figure 10(c), the trend index of velocity for all Action\nphases exceeds 0, indicating an increasing trend. Concurrently, the speed difference demonstrates\na pronounced downward trend. Given the aforementioned domain knowledge, we label Action\nphases in this cluster as the \u201cCatch up\u201d pattern. Conversely, the cluster of Action phases depicted\nin Figure 10(b) exhibits a completely reverse trend, that is, a negative velocity trend index and a\npositive speed difference trend index, representing a driving pattern named \u201cKeep away\u201d. In Fig-"}, {"title": "Driving Patterns in US101 dataset", "content": "Corresponding driving patterns are also identified in the US101 dataset as illustrated in Figure 11.\nIn Figure 11(c), most of the Action phases display an increasing trend in velocities. Conversely, the\noverall speed difference exhibits a decreasing trend. Considering the limited outliers in both vari-\nables' indexes, this pattern is interpreted as a \"Stable catch up\" pattern. Figure 11(b) demonstrates\nan obvious downward trend in velocity and an upward trend in speed difference, coupled with nu-\nmerous outliers. Hence, this pattern is recognized as \u201cUnstable keep away\u201d. Both Figure 11(a) and"}, {"title": "CONCLUDING REMARKS", "content": "To capture representations of driving characteristics and facilitate a comprehensive understanding\nof driving behavior, this study proposed a framework to cluster Action phases and interpret those\nclusters as several driving patterns. This section presents a summary of the key findings and main\nconclusions derived from this study. Then discussion and outlook of the proposed framework are\nprovided to shed light on its implications and future directions."}, {"title": "Findings of the Study", "content": "As clustering algorithms need input data arrays of equal length, a Resampling and Downsam-\npling Method (RDM) was first adopted to standardize the various length of Action phases in this\nframework. Then, the clustering calibration process of \u201cFeature Selection\u201d, \u2018Clustering Analysis\u201d,\n\"Difference/Similarity Evaluation\u201d, and \u201cAction phases Re-extraction\" was iterated until all dif-\nferences among clusters and similarities within clusters meet the pre-determined criteria. Finally,\nsix clusters were observed in 180 dataset, indicating six driving patterns, which have been labeled"}, {"title": "Conclusions", "content": "The main conclusions of this study are summarized below:\n(i) Velocity v exhibits the highest importance score among the considered four variables,\nsuggesting that it reflects more characteristics of driving behavior.\n(ii) In general, Unstable patterns significantly outnumber Stable ones in terms of size.\nAmong the Stable patterns, \u201cMaintain distance\u201d exceeds the other two dynamic patterns in size.\nThis observation aligns with empirical knowledge: driving is a dynamic and stochastic process,\nand maintaining the status is the simplest way to achieve a Stable state.\n(iii) Comparable driving patterns have been detected in both the I80 and US101 datasets.\nNotably, the patterns \u201cStable keep away\u201d and \u201cUnstable catch up\" are missing from the US101\ndataset. As previously identified by Yao et al. (14), the traffic flow in US101 dataset displays less\nheterogeneity compared to the I80 dataset. This consistency indicates the prospective advantages\nof using driving pattern to illustrate the heterogeneity in driving behavior."}, {"title": "Discussion and Outlook", "content": "This framework introduces an unsupervised learning method to improve the manual categoriza-\ntion of heterogeneous driving behaviors, thereby addressing the pitfalls of depending solely on\nexperiential knowledge. By incorporating a wide array of driving behavior characteristics, such as\nstability and driving state, more accurate and justifiable labels result. This will help to alleviate the\nscarcity of labels in supervised learning and consequently bolster its performance in tasks such as\ndriving behavior modeling and driving trajectory prediction, among others. However, the frame-\nwork does have its limitations, which are the focus of our future research. First, the framework\nneeds further validation to strengthen the credibility of the derived driving patterns. Additionally,\nthe methods and techniques employed in each element of the framework could be further optimized\nand justified."}]}