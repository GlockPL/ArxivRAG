{"title": "DRIVING PATTERN INTERPRETATION BASED ON ACTION PHASES CLUSTERING", "authors": ["Xue Yao", "Simeon C. Calvert", "Serge P. Hoogendoorn"], "abstract": "Current approaches to identifying driving heterogeneity face challenges in comprehending fundamental patterns from the perspective of underlying driving behavior mechanisms. The concept of Action phases was proposed in our previous work, capturing the diversity of driving characteristics with physical meanings. This study presents a novel framework to further interpret driving patterns by classifying Action phases in an unsupervised manner. In this framework, a Resampling and Downsampling Method (RDM) is first applied to standardize the length of Action phases. Then the clustering calibration procedure including \u201cFeature Selection\u201d, \u201cClustering Analysis\", \u201cDifference/Similarity Evaluation\u201d, and \u201cAction phases Re-extraction\u201d is iteratively applied until all differences among clusters and similarities within clusters reach the pre-determined criteria. Application of the framework using real-world datasets revealed six driving patterns in the I80 dataset, labeled as \u201cCatch up\u201d, \u201cKeep away\u201d, and \u201cMaintain distance\u201d, with both \u201cStable\u201d and \"Unstable\" states. Notably, Unstable patterns are more numerous than Stable ones. \u201cMaintain distance\" is the most common among Stable patterns. These observations align with the dynamic nature of driving. Two patterns \u201cStable keep away\u201d and \u201cUnstable catch up\" are missing in the US101 dataset, which is in line with our expectations as this dataset was previously shown to have less heterogeneity. This demonstrates the potential of driving patterns in describing driving heterogeneity. The proposed framework promises advantages in addressing label scarcity in supervised learning and enhancing tasks such as driving behavior modeling and driving trajectory prediction.", "sections": [{"title": "INTRODUCTION", "content": "Driving heterogeneity, recognized as the differences in driving behaviors exhibited by different driver/vehicle combinations under similar conditions, is widely acknowledged (1). Studies have shown that heterogeneity in driving behavior can lead to a rise in traffic accidents, congestion, and emissions (2, 3). Further, user acceptance of autonomous vehicles (AVs) has been found to hinge on accurately comprehending and emulating driving heterogeneity of human-driven vehicles (HDVs), such as human drivers' preferred driving styles (4). Thus, understanding driving heterogeneity plays a significant role in enhancing traffic operations and enabling manufacturers to design safe and efficient automated vehicles at various levels.\nExisting studies have addressed driving heterogeneity by personalizing driving styles based on driving behavior data such as vehicle kinematics variables (e.g., velocity and headway) and vehicle dynamics variables (e.g., braking and throttle opening), which enable categorizing drivers into several groups (5). For instance, Wang et al. (6) classified drivers into two categories (i.e., normal, and aggressive) based on velocity and throttle opening data. In another study, overtaking maneuvers were identified as low-medium-high risk levels based on speed and distance between vehicles (7). Other studies have utilized car-following model parameters to distinguish driving styles (2). While this method captures drivers' static driving characteristics, it is not capable to describe the inherent traits of driving behavior. This is because driving behavior is a dynamic decision-making process (5), drivers may exhibit heterogeneous driving styles in different traffic scenarios. Even under the same traffic scenario, the same driver's behaviors might vary at different time intervals.\nSome studies found that driving heterogeneity can be derived by decomposing driving behavior into distinct driving patterns. As driving behavior displays certain characteristics during the transition of driving maneuvers (8). As such, some researchers (9, 10) segmented driving behavior data into primitives with unique characteristics. Typically, these primitives referred to distinct driving patterns, specifically known as primitive driving patterns. By doing so, the characteristics of driving behavior can be accurately captured by corresponding the traffic environment and driving maneuvers. Using supervised learning approaches, different patterns were extracted and assigned with semantic labels (e.g., rapidly closing in, falling behind) by learning sample features like vehicle operating data (5). However, pre-labeling tasks are labor-intensive, limiting the implementation of supervised learning technologies in driving pattern recognition (11). As a result, there is a growing interest in semantic analysis using unsupervised techniques. Higgs and Abbas (12) identified a specific set of state-action clusters and employed them to characterize potential driving patterns of passenger car and truck drivers. Employing a hierarchical Dirichlet process-Hidden semi-Markov Model (HDP-HSMM), Wang et al. (13) extracted 75 primitive driving patterns from time series driving data. This method allows for the identification of a wider variability in driving behavior by encompassing different driving characteristics. However, an excessive number of patterns, for example, 75, may limit the categorization's effectiveness due to reduced interpretability. This expansive classification has limitations in fully clarifying fundamental driving behaviors and understanding driving heterogeneity. As a result, continued research in this field is required to overcome these challenges.\nIn our previous research (14), the concept of Action phases was introduced to capture driving characteristics with physical meanings, aiming to pave the way for identifying driving heterogeneity. It expanded the scope of the \u201caction point\u201d (15) by incorporating additional variables to provide more comprehensive information about driving behavior. The action trend space for each"}, {"title": "METHODOLOGY", "content": "In this section, we first give an overview of the framework for interpreting driving patterns. Then the methods and techniques employed in each step are explained.\nThe objective of the framework is to categorize Action phases into several driving patterns by utilizing an Action phase Library. These patterns consist of different Action phases that exhibit common traits. The Action phase Library for each dataset was built in our previous work, which is briefly shown as the Data Preprocessing step in Figure 1. Due to the limitations of the high-dimensional data used as input (2), Feature Selection is first conducted. If there is insufficient information regarding feature importance, particularly during the initial analysis phase, an unsupervised feature extraction method is utilized. After the variable importance is evaluated, the features are selected according to the weights of variable importance. The extracted features serve as input for the subsequent Cluster Analysis with an unknown cluster number k. The clustering results are evaluated from both inter-class and intra-class perspectives, demonstrated in the Similarity/Difference Evaluation step. In inter-class evaluation, the differences (df, indicating the distance) among clusters are calculated. As for intra-class, the shape similarities of variables between Action phases within the same cluster are assessed using a dissimilarity index (dSI). Specifically, the inter-class evaluation takes precedence over the intra-class, implying that only clusters with substantial differences from each other are subjected to internal similarity evaluation. If the differences are less than a specific threshold 8, the clustering results are directly accepted for driving pattern description. In the intra-class evaluation, Action phases that display a dSI greater than the threshold & will be re-extracted and re-analysis in the next analysis round. The remaining Action phases, which do not exceed this threshold, are maintained within the current cluster, contributing"}, {"title": "Data preprocessing", "content": "The Action phases accommodated driving trajectory segments with varying lengths in order to provide a more detailed representation of driving behavior characteristics. This refinement adds a layer of complexity to subsequent analyses, as most algorithms necessitate input data of equal length. Various methods have been suggested to mitigate this issue. One prevalent approach is padding, where sequences are extended with a specific value (commonly zero) to match the length of the longest sequence. Alternatively, truncation is utilized, wherein sequences are grouped into \u201cbuckets\u201d of similar lengths (for instance, 1-10, 11-20, 21-30, etc.), followed by padding within each bucket. There are also studies that employed variable-length Recurrent Neural Networks (RNNs) to convert sequences into fixed-length representations."}, {"title": "Feature Selection", "content": "In the initial stage of clustering, an unsupervised feature extraction approach is employed due to the lack of clear information about the significance of variables. Principal Component Analysis (PCA) (17), Kernel PCA, t-SNE, among others, are frequently utilized methods for this purpose.\nUpon completion of the first analysis round within the framework, the importance of variables can be evaluated. Consequently, for the subsequent stages of clustering, feature extraction is guided by the variable importance score (IS) acquired from the preceding analysis round. Borda Count (18), a highly recognized example of weighted scoring rules, is commonly applied in multi-candidate, single-winner electoral procedures. This method, which also provides the votes of each"}, {"title": "Clustering Analysis", "content": "The clustering analysis in our framework aims at finding typical driving patterns in a given dataset. Various clustering approaches with inherent techniques have been proposed, this is due to the fact that there is no such precise definition to the notion of \u201ccluster\u201d (19). According to Fraley and Raftery (20), the clustering approaches are divided into two different groups: hierarchical and partitioning techniques. Hierarchical clustering is chosen as the principal clustering method for two main reasons. The first is its capability to form a hierarchical depiction of the provided dataset, which in essence gives an outline of the distribution of driving patterns. The second advantage is that hierarchical clustering offers reproducibility of the resulting clusters (21). This mitigates the sensitivity to random initializations commonly encountered by partitioning clustering techniques such as k-means.\nHierarchical clustering can function in two ways - agglomerative (bottom-up) and divisive (top-down) - both of which are intrinsic strategies for building a binary tree. An agglomerative strategy is employed here, as it begins with each pattern as an individual cluster and inspects the connections between patterns or intermediate clusters. The fundamental concept is to merge the two closest patterns or intermediate clusters into a new, larger cluster. The proximity between any two patterns is determined using the Manhattan distance, also known as the city block distance (22). When assessing the distance between two clusters, the average-link scheme is implemented, which measures the mean distance across all pairs of Action phases from those clusters (refer to Equation 3). This procedure is repeated until only a single cluster is left, indicating all Action phases have been grouped into the same cluster."}, {"title": "DTW-based Similarity Evaluation", "content": "The key to effective clustering is ensuring significant distances between clusters while also maintaining high internal similarity. Each variable in the Action phases can be considered as a set of time-series data. However, the challenge with comparing the similarity of two time-series data points is that even if they share similar characteristics or trends, they might not align along the time axis. For instance, two sets of velocities could demonstrate similar trends over time, but one may occur at a faster or slower rate than the other. This is where Dynamic Time Warping (DTW) proves useful.\nThe main idea behind DTW is to compare the distances of two sequences under all possible \"warpings\u201d, and then identify the optimal match among these warpings (23). Consider two sequences, $X = [x_1,x_2,...,x_n]$ and $Y = [y_1,y_2, \u2026\u2026\u2026, y_m]$ of lengths |X| and |Y| respectively. A warp path W is then created, as shown in Equation 5.\n$W = w_1,w_2,...,w_K \\max(|X|,|Y|) \u2264 K < |X| + |Y|$\nhere, K signifies the length of the warp path, and the k-th element of the warp path is $w_k = (i, j)$, where i and j are indices of time series X and Y, respectively. The warp path initiates at the beginning of each time series at $w_1 = (1,1)$ and finishes at the end of both time series at $w_K = (|X|,|Y|)$. A constraint on the warp path mandates i and j to be monotonically increasing in the warp path. Every index of both time series must be engaged. This constraint can be expressed more formally as follows:\n$w_k = (i, j), w_{k+1} = (i', j') i \u2264 i' \u2264 i + 1, j \u2264 j' \u2264 j + 1$\nThe optimal warp path is the one with minimum distance, where the distance (or cost) of a warp path W is"}, {"title": "EVALUATION OF THE CLUSTERING CALIBRATION PROCESS", "content": "Evaluation of the clustering calibration process is designed and presented in this section. First, data preparation including Action phases review and feature selection results is introduced. Then, hierarchical clustering is conducted, and the results are evaluated by using a qualitative measure for inter-class difference and a quantitative measure for intra-class similarity. Action phases demonstrating low intra-class similarities are extracted, during which process the variables' importance is calculated."}, {"title": "Data and Feature Selection", "content": "As proposed in (14), driving behavior trajectories are segmented to yield Action phases, with each driving variable in these phases displaying a single trend. For example, (D,L,L,I) indicates the vehicle's velocity (v) has a trend of decreasing, the acceleration (a) and distance (d) are keeping a low value, and the speed difference ($\\Delta$v) is increasing. All the Action phases extracted from one dataset (representing a specific traffic flow condition) constitute the Action phase Library of this dataset, which is adopted as the initial data in this study. The total size of the Action phase Library amounts to 1764 for the 180 dataset and 13564 for the US101 dataset.\nAction phases consist of trajectory information using four variables, making feature extraction crucial for high-quality cluster analysis. This study employs Principal Component Analysis (PCA), an unsupervised feature selection method, to cohere variables and extract significant fea-"}, {"title": "Clustering Analysis", "content": "Determining a suitable validation strategy for an unsupervised learning problem is acknowledged to be a complex task. The literature generally offers two validation criteria: internal and external (24). The external criterion compares the clustering outcome with existing knowledge of the dataset's structure (commonly referred to as true labels), whereas such information is usually subjective or unavailable. As a result, this study concentrates on the internal criterion, which assesses clustering results based on the inherent properties of the dataset. The evaluation undertaken in this study includes i) a qualitative measure for inter-class by visually observing the dendrogram to ascertain the differences between clusters, and ii) a quantitative measure for intra-class by calculating the similarity of Action phases within a cluster."}, {"title": "Qualitative evaluation", "content": "Clustering results are evaluated by examining different (intermediate) clusters, i.e., branches, demonstrated by the two dendrograms shown in Figure 4. The metric is based on the similarities among the Action phases within the same cluster. Focusing on the dendrogram for the I80 dataset depicted in Figure 4a, the first analysis involves the two highest sub-trees (or branches): The left sub-tree comprises small, simple patterns of Action phases, as colored by orange; conversely, the right sub-tree displays a variety of patterns. Thus, further examination is conducted on the right sub-tree, revealing that (i) the left sub-subtree contains small, straightforward patterns of Action phases; (ii) despite the right sub-subtree demonstrates a diversity of patterns, they occur at close distances. Following this analysis, three clusters are identified in the I80 dataset (marked as Cluster 3, 2, and 1), and two clusters are observed in the US101 dataset (marked as Cluster 2 and 1). As shown in Figure 4a and Figure 4b, the distance between clusters obtained from the two datasets exceeds 2,"}, {"title": "Quantitative Evaluation", "content": "FastDTW compares the shape similarity by calculating the minimum-distance warp path between two variable data sets. This minimum distance is used as a dissimilarity index (dSI) to provide a quantitative assessment of the clustering results. A value closer to 0 implies higher similarity between the two variable sequences. Conversely, a larger dSI suggests less similarity in their shape. The similarity assessment of the I80 dataset is depicted in Figure 5. (a) - (c) represent the three clusters obtained from hierarchical clustering, while 1 - 4 denotes the four variables v, a, d, and $\\Delta$v considered in this study. All figures use a uniform color bar as a reference, with darker colors indicating greater distances or less similarity. As represented by the deeper blue lines, larger dSI values are observed in both Cluster 2 and Cluster 3, suggesting these Action phases have a relatively low similarity. In contrast, Cluster 1 generally has low dSI values, signifying a high degree of similarity between Action phases in this cluster. The same analysis is also carried out on the US101 dataset, as shown in Figure 6.\nTo improve the intra-class similarity, Action phases with a dSI index for variables exceeding a threshold value & will be re-extracted for the next round of analysis. In this context, the threshold & is defined as the 99th percentile of all dSI values in a given dataset. Consequently, a total of 1054 and 11342 Action phases are re-extracted from the I80 and US101 datasets, respectively. More specifically, from the I80 dataset, 1089 Action phases are extracted from Cluster 1, while 126 and 133 Action Phases are from Cluster 2 and Cluster 3 respectively. As for the US101 dataset, the numbers are 9258 and 2084 for Cluster 1 and Cluster 2, respectively."}, {"title": "Variable Importance Evaluation", "content": "Figure 7(a) and Figure 8(a) display the count of each variable involved in the re-extraction process. The variable v appears to be the most recurrent one used in Action phases re-extraction in both datasets, succeeded by a, d, and $\\Delta$v, in that sequence. It is worth noting that an Action phase could be selected due to the marked dissimilarity in one or multiple variables, as the statistical data shown in Figure 7(b) and Figure 8(b). In the I80 dataset, the selection of most Action phases relies on"}, {"title": "Analysis on Re-extracted Action phases", "content": "Different from the initial round of analysis where feature selection is based on an unsupervised learning method, this round of analysis employs features selected based on the variable importance score (SI) computed in the prior round. Hierarchical clustering is also executed, with results depicted in Figure 9. An observation of the dendrograms reveals three clusters in the I80 dataset and two clusters in the US101 dataset (see the sub-trees with different colors). Notice that sub-trees in each cluster are with small distances, or df, significantly smaller than the threshold 8 = 1, indicating high similarity among Action phases within the cluster. Therefore, the results are directly"}, {"title": "DRIVING PATTERN INTERPRETATION", "content": "Driving patterns are represented by the final results of the clustering calibration process, and the interpretation for each pattern is provided in this section. Based on a measurement to distinguish different driving patterns, i.e., the slope, a general analysis of the results is first presented. Then driving patterns obtained from I80 dataset and US101 dataset are analyzed, respectively."}, {"title": "General Analysis of Driving Patterns", "content": "The concept of \u201cTrend\u201d has consistently been a key of our Action phases analysis, and it forms the basis for characterizing driving patterns. Trends are illustrated through the slope, symbolizing the rate of change in a given variable. A positive slope portrays an increasing trend, such as an increase in velocity, while a negative slope implies a decreasing trend. The magnitude of the slope reflects the rate of change. Especially, several adjacent gentle slopes form fluctuations, representing a 'Keeping' trend of variables. Given that variables usually manifest identical trends in different ways, such as linear increase, convex/concave progression, or slightly fluctuating increase, linear regression may struggle to precisely identify variable trends. To capture local trends within specified intervals in the dataset and retain overall trend accuracy, we employ a 'sliding window' method. This technique involves forming a \u2018window' of a particular size (e.g., 5 periods, 10 periods, etc.) which \u2018slides' over the data points in the series (25). A linear regression is computed at each window position and the slope of the regression line is recorded. The final slope of the variable data, which serves as the trend index for each variable, is derived by averaging the slopes of these windows.\nFigure 10 and Figure 11 use boxplots to illustrate the statistical data of the variable trend index for both datasets, respectively. Each boxplot displays the upper quartile, lower quartile, and median of the trend indexes. The whiskers extend to the farthest data points not deemed outliers, while outliers (if present) are denoted by asterisks. As previously mentioned, velocity holds the highest importance score when it comes to identifying dissimilarities within Action phases, thus it is prioritized during analyzing the characteristics of driving patterns. Given that the speed difference $\\Delta$v signifies the interaction between vehicles and their preceding vehicles, it is also taken into account when describing driving patterns. Based on domain knowledge, if the velocity increases while the speed difference decreases, this represents the situation where the target vehicle is catching up with the vehicle in front. Conversely, a decrease in velocity accompanied by an increase in speed difference represents a situation of keeping away from the preceding vehicle. If both the velocity and speed difference remain roughly constant, it indicates that the vehicle is maintaining its current state."}, {"title": "Driving Patterns in I80 dataset", "content": "Figure 10 displays the trend index of variables for each cluster using the I80 dataset, where each sub-figure corresponds to a driving pattern. Specifically, Figures 10(a)-(c) represent patterns derived from the first round of clustering, while Figures 10(d)-(f) represent those from the second round. Notably, in the cluster illustrated by Figure 10(c), the trend index of velocity for all Action phases exceeds 0, indicating an increasing trend. Concurrently, the speed difference demonstrates a pronounced downward trend. Given the aforementioned domain knowledge, we label Action phases in this cluster as the \u201cCatch up\u201d pattern. Conversely, the cluster of Action phases depicted in Figure 10(b) exhibits a completely reverse trend, that is, a negative velocity trend index and a positive speed difference trend index, representing a driving pattern named \u201cKeep away\u201d. In Fig-"}, {"title": "Driving Patterns in US101 dataset", "content": "Corresponding driving patterns are also identified in the US101 dataset as illustrated in Figure 11. In Figure 11(c), most of the Action phases display an increasing trend in velocities. Conversely, the overall speed difference exhibits a decreasing trend. Considering the limited outliers in both variables' indexes, this pattern is interpreted as a \"Stable catch up\" pattern. Figure 11(b) demonstrates an obvious downward trend in velocity and an upward trend in speed difference, coupled with numerous outliers. Hence, this pattern is recognized as \u201cUnstable keep away\u201d. Both Figure 11(a) and"}, {"title": "CONCLUDING REMARKS", "content": "To capture representations of driving characteristics and facilitate a comprehensive understanding of driving behavior, this study proposed a framework to cluster Action phases and interpret those clusters as several driving patterns. This section presents a summary of the key findings and main conclusions derived from this study. Then discussion and outlook of the proposed framework are provided to shed light on its implications and future directions."}, {"title": "Findings of the Study", "content": "As clustering algorithms need input data arrays of equal length, a Resampling and Downsampling Method (RDM) was first adopted to standardize the various length of Action phases in this framework. Then, the clustering calibration process of \u201cFeature Selection\u201d, \u2018Clustering Analysis\u201d, \"Difference/Similarity Evaluation\u201d, and \u201cAction phases Re-extraction\" was iterated until all differences among clusters and similarities within clusters meet the pre-determined criteria. Finally, six clusters were observed in I80 dataset, indicating six driving patterns, which have been labeled"}, {"title": "Conclusions", "content": "The main conclusions of this study are summarized below:\n(i) Velocity v exhibits the highest importance score among the considered four variables, suggesting that it reflects more characteristics of driving behavior.\n(ii) In general, Unstable patterns significantly outnumber Stable ones in terms of size. Among the Stable patterns, \u201cMaintain distance\u201d exceeds the other two dynamic patterns in size. This observation aligns with empirical knowledge: driving is a dynamic and stochastic process, and maintaining the status is the simplest way to achieve a Stable state.\n(iii) Comparable driving patterns have been detected in both the I80 and US101 datasets. Notably, the patterns \u201cStable keep away\u201d and \u201cUnstable catch up\" are missing from the US101 dataset. As previously identified by Yao et al. (14), the traffic flow in US101 dataset displays less heterogeneity compared to the I80 dataset. This consistency indicates the prospective advantages of using driving pattern to illustrate the heterogeneity in driving behavior."}, {"title": "Discussion and Outlook", "content": "This framework introduces an unsupervised learning method to improve the manual categorization of heterogeneous driving behaviors, thereby addressing the pitfalls of depending solely on experiential knowledge. By incorporating a wide array of driving behavior characteristics, such as stability and driving state, more accurate and justifiable labels result. This will help to alleviate the scarcity of labels in supervised learning and consequently bolster its performance in tasks such as driving behavior modeling and driving trajectory prediction, among others. However, the framework does have its limitations, which are the focus of our future research. First, the framework needs further validation to strengthen the credibility of the derived driving patterns. Additionally, the methods and techniques employed in each element of the framework could be further optimized and justified."}, {"title": "AUTHOR CONTRIBUTIONS", "content": "The authors confirm their contribution to the paper as follows: study conception and design: Xue Yao, Simeon C. Calvert, Serge P. Hoogendoorn; data collection: Xue Yao; analysis and interpretation of results: Xue Yao, Simeon C. Calvert; draft manuscript preparation: Xue Yao, Serge P. Hoogendoorn, Simeon C. Calvert. All authors reviewed the results and approved the final version of the manuscript."}]}