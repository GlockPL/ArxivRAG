{"title": "Improved Forecasts of Global Extreme Marine Heatwaves Through a Physics-guided Data-driven Approach", "authors": ["Ruiqi Shu", "Hao Wu", "Yuan Gao", "Fanghua Xu", "Ruijian Gou", "Xiaomeng Huang"], "abstract": "The unusually warm sea surface temperature events known as marine heatwaves (MHWs) have a profound impact on marine ecosystems. Accurate prediction of extreme MHWS has significant scientific and financial worth. However, existing methods still have certain limitations, especially in the most extreme MHWs. In this study, to address these issues, based on the physical nature of MHWs, we created a novel deep learning neural network that is capable of accurate 10-day MHW forecasting. Our framework significantly improves the forecast ability of extreme MHWs through two specially designed modules inspired by numerical models: a coupler and a probabilistic data argumentation. The coupler simulates the driving effect of atmosphere on MHWs while the probabilistic data argumentation approaches significantly boost the forecast ability of extreme MHWs based on the idea of ensemble forecast. Compared with traditional numerical prediction, our framework has significantly higher accuracy and requires fewer computational resources. What's more, explainable AI methods show that wind forcing is the primary driver of MHW evolution and reveal its relation with air-sea heat exchange. Overall, our model provides a framework for understanding MHWs' driving processes and operational forecasts in the future.", "sections": [{"title": "1 introduction", "content": "Marine heatwaves (MHWs) represent anomalous warm seawater events that have a profound impact on marine ecosystems (Oliver et al., 2021; Pearce et al., 2011). For example, MHWs, especially those most extreme ones, can cause coral bleaching (Hughes et al., 2017, 2018) and widespread mortality of marine organisms (Garrabou et al., 2009; Thomson et al., 2015). As a result, an accurate forecast of extreme MHWs has far-reaching scientific and economic value. For example, sub-seasonal MHWs forecasting can help sea food production and management planning, such as feed cycles, at 1-7 day timescales while seasonal forecasting can further support proactive decision-making for the blue economy (Hobday et al., 2016; Malick et al., 2020; Mills et al., 2017; Payne et al., 2022). In this study, we will mainly focus on the sub-seasonal forecast.\nTraditional forecasting methods for MHWs are often based on numerical models in which the primitive equations of the ocean are used to simulate the variation of MHWs. Such forecasts generally fall into two categories. The first is seasonal forecasting, the main purpose of which is to give a general pattern of onset, duration, and intensification of MHWs over a long timescale (Jacox et al., 2022; Brodie et al., 2023). The other type is sub-seasonal forecasting, which is mainly designed to measure the small-scale variations of MHWs. Such forecast is more accurate than seasonal forecasts, but the forecast lead time is much shorter (Benthuysen et al., 2021; Yu et al., 2024). Although physics-based numerical models achieve a satisfying forecast of MHWs, they require large amounts of"}, {"title": "2 Materials and Methods", "content": "In this study, we utilize two sets of reanalysis datasets of the ocean surface vari-ables: the daily 1/4\u00b0 eddy-permitting dataset and the 1/12\u00b0 eddy-resolving dataset (Lellouche et al., 2018). The former is used to generate global eddy-permitting forecast, while the latter is for regional eddy-resolving forecast. Based on the different SST datasets, we con-"}, {"title": "2.1 Data", "content": "In this study, we utilize two sets of reanalysis datasets of the ocean surface vari-ables: the daily 1/4\u00b0 eddy-permitting dataset and the 1/12\u00b0 eddy-resolving dataset (Lellouche et al., 2018). The former is used to generate global eddy-permitting forecast, while the latter is for regional eddy-resolving forecast. Based on the different SST datasets, we con-"}, {"title": "2.2 Deterministic Global MHWs Forecast Framework", "content": "As shown in Figure 1, our model can be separated into two modules: the determin-istic forecast module (Figure 1a) and the probabilistic data argumentation module (Fig-ure 1b). The problem of marine heatwave forecast is essentially predicting the future state of mixed layer SSTA $\\langle T_t \\rangle'$ based on the current state $\\langle T_0 \\rangle'$, here the brackets denote the average over the mixed layer and the prime is the deviation from the climatology mean. To be specific, we seek to approximate the evolution operator :\n$\\langle T_t \\rangle' = \\phi(\\langle T_0 \\rangle', A_{0:t})$\nIn all, our goal is to use a neural network $\\phi_\\theta$ to approximate $\\phi$ based on the existing data. The governing equation of $\\langle T \\rangle'$ can be written as (Bian et al., 2023):\n$\\frac{\\partial \\langle T\\rangle'}{\\partial t} = \\langle -\\nabla (uT)\\rangle' + \\frac{Q'_{sw} + Q'_{LW} + Q'_{sens} + Q'_{lat}}{\\rho C_p h} + \\langle MIX \\rangle'$\nwhere u represents the horizontal velocity, and $Q_{sw}$, $Q_{LW}$, $Q_{sens}$, $Q_{lat}$ is the shortwave radiation, longwave thermal radiation, sensible heat flux, and latent heat flux respectively. Integrate (3) we get\n$\\langle T_t \\rangle' - \\langle T_0 \\rangle' = \\int (\\langle -\\nabla (uT)\\rangle' + \\frac{Q'_{sw} + Q'_{LW} + Q'_{sens} + Q'_{lat}}{\\rho C_p h} dt + RES$\nGuided by this physical nature of SSTA, we first use train a neural network (called a \u2018cou-pler\u2019) to approximate heat flux $Q' = \\phi_1(A_{0:t}, \\langle T_0 \\rangle')$. Other effects, including advec-tion and mixing effects, are approximated by another neural network $\\langle T_t \\rangle' = \\phi_2(Q', \\langle T_0 \\rangle')$.\nIn all, our framework can be expressed as:\n$\\langle T_t \\rangle' = \\phi_2(\\phi_1(A_{0:t}, \\langle T_0 \\rangle'), \\langle T_0 \\rangle')$"}, {"title": "2.3 Probabilistic Approach for Most Extreme MHWs", "content": "As pointed out in previous sections, overly smoothed forecast results will forbid AI-based model's forecast ability on the most extreme MHW events. A key factor is that samples on extreme heatwaves are actually very scarce (less than 10% by the definition of MHWs). Therefore, we need to generate more training samples with more extreme MHWs that conform to physical laws based on existing datasets, so as to improve the forecast ability of AI models in extreme events (i.e., data argumentation).\nIn numerical models, more forecast results can be obtained by ensemble forecasts. To be specific, under more realistic circumstances, small perturbations will be added to"}, {"title": "2.4 Evaluation Metrics", "content": "In this study, to evaluate the performance of our model, we use three metrics: Root Mean Square Error (RMSE), Critical Success Index (CSI) and Symmetric Extremal De-pendence Index (SEDI). RMSE represents the overall performance of our SST anomaly forecast, which is calculated as:\n$\\textit{RMSE}(t) = \\sqrt{\\frac{1}{HW} \\sum_{i,j} (T_{i,j}(t) - \\hat{T}_{i,j}(t))^2}$\n$\\textit{CSI}(t) = \\frac{TP}{TP + FP + FN}$\n$\\textit{SEDI}(t) = \\frac{\\log(F) - \\log(H) - \\log(1 - F) + \\log(1 - H)}{\\log(F) + \\log(H) + \\log(1 - F) + \\log(1 - H)}$\nWhere TP (True Positive) denotes the number of cases that a MHWs event is accurately predicted. FP (False Positive), FN (False Negative), and TN (True Positive) follow a sim-ilar definition. $F = \\frac{FP}{FP+TP}$ is the false alarm rate while $H = \\frac{TP}{TP+FN}$ is the hit rate.\nIn this study, we also utilize explainable AI (XAI) method to evalute the relative importance of each input of our model $\\phi_\\theta$. To be specific, by removing the ith variables from our input, we can quantitatively measure the (unsigned) contribution of each vari-able on the heat flux (called 'contribution map') at grid point (m, n), which is calculated as:\n$AC^n_{ \\varphi}(m, n) = \\sqrt{ \\frac{ \\sum_{i \\in Y} [ \\varphi(\\textit{X}(m, n)) - \\varphi(\\textit{X}^j(m, n))] ^2 }{|Y|} }$\n$\\Delta C_{ \\varphi}^n(m, n) = \\frac{\\sum_{i \\in Y} \\varphi(\\textit{X}(m, n)) - \\varphi(\\textit{X}^j(m, n)) }{|Y|}$"}, {"title": "3 Results", "content": "Figure 2 illustrates the performance of our framework in the global 1/4\u00b0 dataset. Overall, our framework's forecasting ability for $\\langle T \\rangle'$ exceeds existing data-driven mod-els (Giamalaki et al., 2022; W. Sun et al., 2023), and the mean RMSE of 10-day fore-cast can be reduced by 30% to 40%. In addition, our framework has shown to be quite competitive compared to numerical models. Since there is a certain deviation of SST in different sources of observation or analysis data, in this study, we use GOFS's analysis field as the input initial condition of the model to ensure the fairness of the comparison. However, despite the unfavorable conditions for our framework, our model's 6-day fore-cast RMSE is still 20% to 30% lower than that of the numerical model. What's more, as shown in Figure 2a, the boundary condition $A_{0:t}$ plays an important role in the fore-casting of $\\langle T \\rangle'$. Under a realistic operational forecast condition, the $A_{0:t}$ is replaced by"}, {"title": "3.1 A Global Assessment of Our Frameworks' Performance", "content": "Figure 2 illustrates the performance of our framework in the global 1/4\u00b0 dataset. Overall, our framework's forecasting ability for $\\langle T \\rangle'$ exceeds existing data-driven mod-els (Giamalaki et al., 2022; W. Sun et al., 2023), and the mean RMSE of 10-day fore-cast can be reduced by 30% to 40%. In addition, our framework has shown to be quite competitive compared to numerical models. Since there is a certain deviation of SST in different sources of observation or analysis data, in this study, we use GOFS's analysis field as the input initial condition of the model to ensure the fairness of the comparison. However, despite the unfavorable conditions for our framework, our model's 6-day fore-cast RMSE is still 20% to 30% lower than that of the numerical model. What's more, as shown in Figure 2a, the boundary condition $A_{0:t}$ plays an important role in the fore-casting of $\\langle T \\rangle'$. Under a realistic operational forecast condition, the $A_{0:t}$ is replaced by"}, {"title": "3.2 Forecast Ability of the Extreme MHWs", "content": "Unlike numerical models or large-AI driven ocean model that treats the SST as a primitive variable, we are more concerned with capturing the extremes of the SST. In this study, we apply the probabilistic method in section 2.3 to our deterministic forecast-ing, which effectively improves the overall forecasting ability of the framework and ex-treme MHWs. To be more explicit, as demonstrated in Figures 3a-3b, after incorporat-ing the probabilistic module, all of the metrics steadily improve. Even in the most in-tense MHWs incidents (99th percentile), the CSI still increases by approximately 15%.\nHere we used the CNP-MHW in 2020 (as mentioned in section 3.1) to illustrate how our forecast ensembles improves the forecast ability of extreme events (we don't take 2021 CNP-MHW mainly because the backbone module can already generate satisfying result). Figure 3d shows a 10-day forecast of the CNP-MHW event initialized at 2020-08-14 and ending at 2020-08-24. The level of CNP-MHW gradually rose from moder-ate to extreme, broke the 99% threshold on 2020-08-19, and then steadily declined. Our deterministic forecasting framework can also capture the formation of CNP-MHW, but it is significantly underestimated in intensity. Using the probabilistic model mentioned in Section 2.3, we sampled k = 10 forecast ensembles from the conditional distribution $p(\\langle T_t \\rangle'|\\langle T_0 \\rangle', A_{0:t})$ and added them to the training samples. It can be found that most"}, {"title": "3.3 The Explainability of Our Model: Viewpoints from the Governing Equations", "content": "In this section, we are going to focus on the explainability of our framework. In other words, we want to determine the key factors that drive the small-scale variations (10-day) of MHWs through the signed and unsigned contribution map described in section 2.4. By averaging equations (17) and (18) over the decaying and intensifying phase of MHWs, we can quantify the role of each input variables in the life cycle of MHWs, as illustrated in Figure 5.\nFirst we examine the contribution map of each input variable on the SSTA vari-ations during intensifying/decaying phase of MHWs (i.e., the output of $\\phi_2(\\phi_1(A_{0:t}, \\langle T_0 \\rangle'))$. As shown in Figure 5a, the contribution of surface wind speed is the largest among each vari-able, which leads to a maximum about 0.3 K deviation of SSTA in both the intensify-ing and decaying phases. The surface temperature follows the wind speed and the con-tribution of SSTA is the smallest. The unsigned contribution of atmosphere and ocean variables is mainly concentrated in midlatitude and subarctic regions (e.g., Northeast Pacific and Western Boundary Currents). When considering the signed contribution, re-moving surface wind speed will generally lead to an underestimate in both intensifying and decaying phase of MHWs. This further emphasize the wind speed as a important predictor in the most extreme MHWs events."}, {"title": "4 Conclusions", "content": "In this study, by designing a data-driven framework, we evaluate the predictabil-ity of small-scale (10-day) variations of global MHWs, which partly address the limita-tion of existing methods in forecasting extreme MHWs. We believe that this technique can be directly applied to other AI-based weather forecasts, thereby improving the model's ability to predict extreme events including heatwaves, extreme precipitation, and drought (Wu et al., 2024). What's more, Through XAI methods, we draw the conclusion that wind forcing is the key factor that drives the small-scale variation of MHWs through im-pacting the air-sea latent heat flux. This understanding provides a foundational frame-work for future data-driven operational forecasts and research into the driving factors of MHWs.\nHowever, there are still some limitations of our study, which can be carried out in the future. First, as shown in Figure 2a, The role of atmospheric forcing is crucial, es-pecially in long-term MHW predictions. Improving the accuracy of subseasonal weather forecasts could significantly enhance the performance of our framework. Second, in our current framework, only surface data is used as input. Although our framework is able to parameterize some of these subsurface effects, by integrating the observation and re-analysis data from the subsurface layers, it is expected to further improve the explain-ability and forecast ability of our model. Third, it should be pointed out that the use of more physical variables based on the governing equations (3) can theoretically further enhance our forecasting. However, in order to ensure that our model is operational and lightweight as much as possible, we only used 8 intermediate variables (4 basic variables and 4 flux) in this study. Future work could revolve around the impact of various phys-ical variables on MHW forecasts. Nevertheless, considering the scale-dependent nature of MHWs, it would be meaningful to investigate the predictability of the small-scale MHWs, especially with the advent of the Surface Water and Ocean Topography (SWOT) pro-grams (Fu et al., 2024)."}]}