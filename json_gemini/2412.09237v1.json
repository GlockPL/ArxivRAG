{"title": "LMAgent: A Large-scale Multimodal Agents Society for Multi-user Simulation", "authors": ["Yijun Liu", "Wu Liu", "Xiaoyan Gu", "Xiaodong He", "Yong Rui", "Yongdong Zhang"], "abstract": "The believable simulation of multi-user behavior is crucial for understanding complex social systems. Recently, large language models (LLMs)-based AI agents have made significant progress, enabling them to achieve human-like intelligence across various tasks. However, real human societies are often dynamic and complex, involving numerous individuals engaging in multimodal interactions. In this paper, taking e-commerce scenarios as an example, we present LMAgent, a very large-scale and multimodal agents society based on multimodal LLMs. In LMAgent, besides freely chatting with friends, the agents can autonomously browse, purchase, and review products, even perform live streaming e-commerce. To simulate this complex system, we introduce a self-consistency prompting mechanism to augment agents' multimodal capabilities, resulting in significantly improved decision-making performance over the existing multi-agent system. Moreover, we propose a fast memory mechanism combined with the small-world model to enhance system efficiency, which supports more than 10,000 agent simulations in a society. Experiments on agents' behavior show that these agents achieve comparable performance to humans in behavioral indicators. Furthermore, compared with the existing LLMs-based multi-agent system, more different and valuable phenomena are exhibited, such as herd behavior, which demonstrates the potential of LMAgent in credible large-scale social behavior simulations.", "sections": [{"title": "I. INTRODUCTION", "content": "The believable simulation of multi-user behavior has long been a pivotal challenge in artificial intelligence (AI), with AI agents regarded as promising tools for achieving this pursuit. AI agents are artificial entities capable of perceiving the environment, making decisions, and taking action [1]. By endowing AI agents with knowledge bases, objectives, and"}, {"title": "II. RELATED WORK", "content": "The credible simulation of user behavior has always been the key to studying complex social systems [13]. The design of believable proxies creates an illusion of human behavior, allowing them to make decisions and take actions according to their will [2]. Over the past few decades, various methods [14]\u2013[16] have been proposed to create credible agents. Rule-based methods such as finite-state machines [17] and behavior trees [18] provide a direct approach to creating simple agents, which remains the primary method today for handling basic social interactions. Nevertheless, manually crafting response rules for all behaviors is unsustainable. Some scholars have proposed using reinforcement learning methods to automate decision-making [19]\u2013[21]. RecSim [22] uses reinforcement learning to simulate users' continuous behavior for interactive recommendations. AlphaStar [23] and DQN [14] enable agents to autonomously learn in unknown environments, allowing them to achieve impressive performance in some decision-making games. However, their success mainly stems from easily defined reward functions, which can be optimized by learning algorithms. In an open agents society, there is often no clear reward function for learning, and the decision-making process for agent behavior becomes highly complex.\nIn our work, we employ multimodal LLMs as central controllers to design multimodal agents. These agents possess human-like decision-making capabilities, enabling them to make rational decisions in complex and dynamic environments for simulating credible user behavior."}, {"title": "B. LLMs-based Agent System", "content": "LLMs contain a wealth of knowledge about the world and can generate human-like responses based on social contexts [3]. LLM-based agent systems refer to systems that utilize LLMs as engines to drive multiple agents to make various behavioral decisions [2]. In this system, each agent holds its own knowledge base, goals, and abilities. They can interact and collaborate to enhance the system's ability to handle complex tasks and dynamic environments [4], [10], [24]. Recently, there has been significant progress in LLM-based agent systems. [25] conducted preliminary tests and found that LLMs possess the ability to replicate some classic experiments in economics, psycholinguistics, and social psychology. [8] utilized LLMs-based agents to substitute human participants, endowing the agents with talents, backgrounds, and preferences, and prompting them to simulate economic behavior. The results with these LLM-empowered agents are similar in quality to those of human experiments. [13] simulated human opinion dynamics based on multi-agent systems, revealing a strong inherent bias in LLM agents towards producing accurate information. In addition, researchers have also employed LLMs to construct other agent systems for simulation or to improve work efficiency. For example, collaborative software development [5], [9], [26], social simulation [6], [7], [27] and game playing [28]\u2013[30].\nDifferent from the previous work, our work aims to construct a large-scale agents society for more realistic and"}, {"title": "III. METHOD", "content": "This section outlines the multimodal agent architecture and the sandbox environment within LMAgent. To concretize the behavior of agents, we instantiate agents as consumers in e-commerce scenarios. However, LMAgent is versatile. By expanding the types of agent behaviors, it can easily adapt to other scenarios."}, {"title": "A. Multimodal Agent Architecture", "content": "Sociologists believe that when analyzing individuals, two dimensions should be considered: external and internal behaviors [?]. The external dimension relates to the individual's observable actions, while the internal dimension involves personality, values, and emotions. As illustrated in Figure 2, LMAgent offers perspectives on both the internal and external behaviors of agents. These behaviors are all powered by multimodal LLMs\u00b9. Internally, each agent possesses distinct modules for persona and memory. The persona module shapes character traits for the agent, allowing for more personalized behavior. The memory module controls the writing and forgetting of the agent's memories. Externally, each agent can freely engage in social or shopping activities, which involve both vision and text-modal information. It's noteworthy that to improve the multimodal analysis ability of the agents, we propose a self-consistency prompting mechanism to dynamically construct prompts for external behaviors. To enhance system efficiency, we have designed a fast memory module for agents to increase their action speed. Next, we will elaborate on these behaviors in detail."}, {"title": "B. Internal Behavior", "content": "The persona is an important concept in social simulation. To endow each agent with distinct social backgrounds and personal characteristics, we have introduced a set of generic attributes to construct the agent's persona, including name, gender, age, occupation, personal traits, purchasing preferences and behavioral tendencies. The name, occupation, and personal traits are randomly assigned by LLM; age is randomly assigned and the population follows a truncated normal distribution; preferences and behavioral tendencies are inferred using LLM based on the above information.\nMemory mechanisms are integral to the agent's cognition of virtual environments and are key to the design of agents. In a large-scale and multimodal agents society, a slow and inefficient memory mechanism can significantly increase the economic and time costs of the system. To address this issue, we have designed a fast memory mechanism to enhance the system's efficiency. As illustrated in Fig 2, the design of fast memory is built on [6] and optimized specifically for large-scale and multimodal scenarios. It aligns with the advancements in cognitive neuroscience [31], encompassing sensor, short-term, and long-term memory. A memory bank is proposed to enhance the system's efficiency.\nSensor memory is used to process the currently observed information or in time $i$. It records all details of $o_i$ but then immediately forgets them, with key information being condensed into more informative, concise sentences, then stored in short-term memory, denoted as:\n$c_i = f_c(o_i),$\t (1)\nwhere $o_i$ can be text and/or images, $f_c$ is the prompt function to guide the LLMs in information compression. This process eliminates irrelevant and unimportant content while also compressing information to save space and enhance operational efficiency."}, {"title": "C. External Behavior", "content": "Shopping and social behaviors are the most critical behaviors in e-commerce scenarios. For shopping, we designed a comprehensive set of shopping actions, including: 1) Browsing: observing the products recommended by the shopping system; 2) Searching: searching for specified products; 3) Paging: viewing more recommended products; 4) Viewing Details: inquiring about detailed product information; 5) Purchasing: buying specified products. For social interactions, we also designed a set of common social actions, including: 1) Chatting: choose a friend for a conversation. 2) Posting: post message to all friends. 3) Live streaming: a few \"superstar\" agents can perform live streaming to introduce and recommend products, which is of great significance to studying the live commerce phenomenon in the real world. Notably, these behaviors involve multimodal interactions, allowing agents to directly convey visual information.\nDecision-making in e-commerce scenarios often requires consideration of multimodal information about users themselves and the environment, which is challenging for LLMs. Inspired by chain-of-thought [33], we divide the decision-making of these behaviors into two stages and dynamically construct self-consistent prompts to improve the decision-making ability of agents. For example, if we want to determine the agent's next shopping action $a$: 1) In the first stage, we focus on internal information, making summaries $P_1$ based on personal characteristics $C_i$ toward the last observation $o_i$ (such as: enter the shopping system):\n$P_1 = f_s(C_i, o_i)$,\t (4)\nwhere $f_s$ is the prompt function to guide the LLMs in making summaries. This emphasizes personal features to improve the self-consistency for the next action. 2) In the second stage, we incorporate $P_1$ and the multimodal environmental information $E$ (e.g. the product's images and description) to form the final prompts for inferring the agent's next action $a$.\n$a = f_e(P_1, E)$,\t (5)\nwhere $f_e$ is the prompt function to guide the LLMs in making decisions based on the environment $E$ and user characteristics $P_1$. By decoupling the task in this manner, LLMs need only focus on a portion of the decision-making process in each stage, thereby enhancing the credibility of the decision as well as its self-consistency."}, {"title": "D. Sandbox Environment", "content": "To improve communication efficiency between agents and construct large-scale social networks more aligned with the real world, we employed the small-world model [34] to initialize agents' social networks. As shown in Figure 3 (c), the small-world network has a higher clustering coefficient and a shorter average"}, {"title": "Algorithm 1 Small World Topology Network Construction", "content": "Input: Number of agents $N$, average number of friends for all agents $k$, rewiring probability $p$\nOutput: Small-world network graph $G = (V, A)$"}, {"title": "Algorithm 2 Multi-user Behavior Simulation", "content": "Input: $N$ agent $\\{a_i\\}_{i=1}^N$ with their personas $\\{C_i\\}_{i=1}^N$ and memories $\\{M_i = (M_S, M_L)\\}_{i=1}^N$, external behavior set $A$, time steps $T$, and the agents' relationship network $G$\nOutput: Multi-user simulation logs $L$"}, {"title": "IV. EXPERIMENTS", "content": "LMAgent is designed to construct a very large-scale and multimodal agents society for complex user behavior simulation. Since we use the e-commerce scenario as a concrete instance for LMAgent, our experiment mainly focuses on agents' shopping and social behaviors. Furthermore, we conducted large-scale consumer simulation to analyze the group behavior generated by LMAgent, validating its potential in large-scale social simulations."}, {"title": "B. User Purchase Behavior Evaluation", "content": "To quantitatively evaluate the agent behavior in dynamic and complex scenarios, we simulate user purchase behavior based on the sandbox environment of LMAgent. In this task, each agent needs to make decisions on future purchases based on their purchase history and the multimodal information of the products. Specifically, for each simulated user $u$, we initialize it using the real shopping history $H_u$ in the $D_a$. We retain the last $a$ items of $H_u$ as ground truth $T_u$ for evaluation, and utilize all other items to initialize the agent's persona. When shopping, we combined $T_u$ with $b$ random items from the product database to form a recommendation list $R_u$. We present the $R_u$ to the agent, and let it select $a$ items $S_u$ to compare with the $T_u$.\nTo facilitate comparisons with ex-isting works, we follow the metric $a@(a + b)$ proposed by [6] to evaluate the purchase accuracy of agents, where $a$ and $(a+b)$ are the quantity of ground truth and recommended list products, respectively. Specifically, for a user $u$, let $S_u$ indicate the predicted set of purchased products, and $T_u$ denotes the ground truth. We then employ the following metric to assess the performance of different models:\n$p = \\frac{\\sum_{u \\in U} |T_u \\cap S_u|}{\\sum_{u \\in U} |T_u|} \\times 100\\%$,\t (11)\nwhere $U$ is the set of all simulated users. and a larger $p$ indicates better performance. In our experiment, we set $a$ and $b$ to different values to provide a more comprehensive evaluation of our system. Intuitively, selecting fewer products from a larger number of candidate products should be more difficult. Moreover, due to the large scale of experiments and the independence of agents' actions, it inherently avoids randomness issues and can statistically significantly reflect the model's performance."}, {"title": "C. Agent Behavior Analysis", "content": "In this section, we broaden the scope of the evaluation, analyze the agent's behavior from different dimensions, and compare it with human behavior to verify the effectiveness of LMAgent in user behavior simulation.\nIn this experiment, we evaluate the logical coherence of agents by analyzing their behavior chain and behavior content. A behavior chain is a sequence of actions performed by the agent, such as: Accessing social media - Chatting with Mary Williams - Entering the shopping system. Behavioral content refers to the social outputs generated by agents, including posts and chat history. Data was collected from 1,000 agents running 10 rounds in LMAgent for analysis. Additionally, to benchmark human behavior, we gathered data from 50 volunteers who controlled 500 agents, allowing us to compare the agent behaviors against real-world human actions and validate LMAgent's simulation accuracy."}, {"title": "D. Ablation Study", "content": "To quantify the impact of the fast memory mechanism on system efficiency, we ran the system with and without the fast memory. We assessed the effect by measuring the token consumption of LMAgent as a proxy4. The experimental results show that the fast memory mechanism can significantly enhance system efficiency without causing a notable impact on performance. Specifically, we conducted 10 simulation epochs with a society of 100 agents and calculated total token consumption at the end of each round. This experiment was repeated five times for robustness results. Figure 4 shows the token consumption of LMAgent with and without fast memory, it indicates that systems with the fast memory mechanism consume significantly fewer tokens about 40% less compared to those without it. Additionally, it does not impact the distribution of token consumption. Moreover, as shown in Table V, the use of fast memory results in negligible performance impact compared to conventional memory methods, with the average purchase accuracy declining by only 0.28%. This demonstrates the effectiveness of the fast memory mechanism in enhancing system efficiency, which provides the potential for large-scale agents society simulation."}, {"title": "E. Large-scale Consumer Simulation Analysis", "content": "To validate the authenticity of the simulated user purchases, we compare it with real-world JD user behavior data. The result demonstrates a high degree of alignment in user co-purchase patterns.\nSpecifically, we conducted consumer simulation experiments with 10,000 agents and collected their product purchase data for analysis. Pointwise Mutual Information (PMI) [46] is used to measure product associations As shown in Fig 5(a) and 5(b), LMAgent demonstrated significant alignment with empirical co-purchase patterns, including:\nAdditionally, experiments with 10, 100, 1,000, and 10,1000 agents, as shown in Fig 5(c), reveal emergent behaviors at larger scales, with increased concentration on top-ranked products as the agent count grows. At a scale of 10,000 agents, the most purchased product (Top-1) accounts for nearly 30% of all purchases, approximately doubling its share compared to the scenario with just 10 agents. Such dynamics closely mirror the \"herd effect\" observed in real-world consumer behavior [47], as individual agents increasingly align their choices"}, {"title": "V. CONCLUSION", "content": "This paper introduces LMAgent, a very large-scale multimodal agents society based on multimodal LLMs. Taking e-commerce scenarios as an example, we simulate the multimodal social and shopping behaviors of up to 10,000 agents in a sandbox environment. The fast memory, small-world network, and self-consistency prompting are designed to enhance system efficiency and the agents' multimodal capabilities. Extensive experiments demonstrate that LMAgent produces highly realistic simulations of user behavior, aligning closely with real-world user purchasing patterns. Furthermore, when agents number up to 10,000, this virtual society can even exhibit emergent behaviors, which showcases the potential of LMAgent in credible large-scale social behavior simulations. This research marks a significant stride forward in believable large-scale user behavior simulation. With the development of LLMs, this work can create more realistic simulations in the future, offering substantial promise in the field of social science."}]}