{"title": "Deep Learning-Based CKM Construction with Image Super-Resolution", "authors": ["Shiyu Wang", "Xiaoli Xu", "Yong Zeng"], "abstract": "Abstract\u2014Channel knowledge map (CKM) is a novel technique\nfor achieving environment awareness, and thereby improving the\ncommunication and sensing performance for wireless systems. A\nfundamental problem associated with CKM is how to construct\na complete CKM that provides channel knowledge for a large\nnumber of locations based solely on sparse data measurements.\nThis problem bears similarities to the super-resolution (SR)\nproblem in image processing. In this letter, we propose an\neffective deep learning-based CKM construction method that\nleverages the image SR network known as SRResNet. Unlike most\nexisting studies, our approach does not require any additional\ninput beyond the sparsely measured data. In addition to the\nconventional path loss map construction, our approach can also\nbe applied to construct channel angle maps (CAMs), thanks to the\nuse of a new dataset called CKMImageNet. The numerical results\ndemonstrate that our method outperforms interpolation-based\nmethods such as nearest neighbour and bicubic interpolation, as\nwell as the SRGAN method in CKM construction. Furthermore,\nonly 1/16 of the locations need to be measured in order to achieve\na root mean square error (RMSE) of 1.1 dB in path loss.\n\nIndex Terms-Channel knowledge map (CKM), image super-\nresolution, deep learning, ResNet.", "sections": [{"title": "I. INTRODUCTION", "content": "FOR the sixth-generation (6G) mobile communication\nnetworks, the expansion of frequency bands, together\nwith the adoption of extremely large-scale multiple-input\nmultiple-output (MIMO), renders traditional methods for real-\ntime channel state information (CSI) acquisition more costly\nand time-consuming, prompting the pursuit of innovative\napproaches for CSI acquisition [1]. Channel knowledge map\n(CKM) [2] is a promising technique to address such chal-\nlenges. CKM provides location-specific channel knowledge\nthat is crucial for enhancing environment-awareness, and\nhence may significantly improve the communication and sens-\ning performance. For example, the authors in [3] proposed\nan environment-aware hybrid beamforming technique based\non CKM, which drastically reduces the real-time training\noverhead. By leveraging user location information, this method\nsignificantly improves the effective communication rate, even\nin the presence of moderate location errors. A training-\nfree beamforming scheme was proposed in [4], which de-\nsigns optimal active and passive beams based on the loca-\ntion and environmental information provided by CKM. Be-\nsides, CKM-enabled environment-aware networks can realize\ncommunication-aware trajectory planning to avoid blind spots\nfor network-connected ground or aerial robots.\n\nA fundamental challenge for CKM-enabled environment-\naware communication and sensing is developing effective\nmethods for CKM construction. In [5], the authors employed\nan analytical model to construct channel gain map (CGM),\nwhere channel modeling parameters were estimated from\nmeasured data, thereby allowing the full CGM to be generated\nthrough the model. In addition to model-based methods, the\nauthors of [6] proposed a data-driven approach for constructing\nCKM, employing Kriging interpolation to build the shadowing\nmap from a limited set of observations. Meanwhile, the\nrise of deep learning-based CKM construction methods has\nsparked a growing demand for specialized CKM datasets.\nThe dataset of path loss and time of arrival (ToA) radio\nmaps [7] encompasses simulated path loss/received signal\nstrength (RSS) and ToA radio maps. The CKMImageNet\ndataset [8] provides location-tagged numerical channel data\nalongside visual imagery, offering a comprehensive view of\nboth the channel and environment. This integration not only\nsupports the validation of various communication and sensing\nalgorithms but also enables CKM construction using advanced\ncomputer vision (CV) techniques.\n\nThe emergence of these specialized datasets has advanced\nresearchers' investigations into the aforementioned data-driven\nmethods. RadioUNet [9] leverages a physical simulation\ndataset to produce path loss estimations. In [10], the authors\ndevised a sophisticated network architecture grounded in con-\nditional generative adversarial networks (cGANs), engineered\nto synthesize detailed radio maps. The authors of [11] treat\nchannel knowledge as a 2-D image, framing the CKM esti-\nmation as an image-to-image (I2I) inpainting task that predicts\nchannel knowledge at a specific location. Although extensive\nresearch has explored data-driven CKM construction with\nneural networks, these approaches require physical maps or\nother supplementary information as input.\nSuper-resolution (SR) aims to convert a low-resolution (LR)\nimage into a corresponding high-resolution (HR) image with\nimproved visual quality [12]. Compared to LR images, HR im-\nages exhibit a higher pixel density and more detailed textures,\nresulting in greater reliability. Nowadays, deep learning has\nbecome the dominant method in the field of super-resolution.\nSRCNN [13], as one of the earliest models to apply deep\nlearning techniques to super-resolution, achieved peak signal-\nto-noise ratio (PSNR) that significantly surpassed traditional\nmethods. In addition to convolutional neural networks (CNNs),\nresearchers have also explored the potential of GANs [14] and\nresidual networks (ResNets) [15]. All of these approaches have"}, {"title": "II. SYSTEM MODEL", "content": "Consider a base station (BS) aiming to construct a CKM\nbased on the sparse measurements within its coverage area.\nDepending on the application requirements, various types of\nchannel knowledge may be included in the CKM, such as path\nloss, AoA and angle of departure (AoD), etc. Without loss of\ngenerality, we assume that the desired CKM contains $w \\times h$\nlocations each carrying $c$-dimensional channel knowledge.\nIn practical applications, dense and frequent channel mea-\nsurements are costly. We assume that only sparse measure-\nments are collected at $w' \\times h'$ uniformly distributed locations,\nwhich is much smaller than $w \\times h$. We define the expected HR\nCKM as a vector $x^* \\in \\mathbb{R}^{wh \\times c}$ and the measured sparse data\nas $y^* \\in \\mathbb{R}^{w'h' \\times c}$. Therefore, $y^*$ can be considered a uniform\nsampling of $x^*$. We use a diagonal matrix $H \\in [][\\mathbb{R}^{w'h' \\times wh}$ with\ndiagonal elements that are either 0 or 1 to denote the sampling\nprocess, i.e.,\n\n$y^* = Hx^*$.\n\nSince $w'h' << wh$, obtaining $x^*$ from $y^*$ constitutes an\nunderdetermined problem, making it impossible to find a\nunique solution without additional information. Fortunately, by\nutilizing the CKM dataset, we can employ a neural network\ntrained through supervised learning to reconstruct $x^*$ from $y^*$."}, {"title": "III. ARCHITECTURE AND METHODOLOGY", "content": "In this section, we discuss the details of the network\narchitecture and the methodology applied during the training\nprocess."}, {"title": "A. Network Architecture", "content": "We leverage the SRResNet [16] architecture, which contains\n1,549,462 parameters, as our model for performing image\nsuper-resolution. Although the SRGAN, proposed concur-\nrently, excels in generating realistic SR images, we opted\nfor SRResNet due to its superior performance in pixel-level\nrestoration, which aligns more closely with our goal.\n\nThe core of SRResNet consists of a sequence of five residual\nblocks, each meticulously designed with a uniform architec-\nture. These blocks feature two 3 \u00d7 3 convolutional layers\nwith 64 feature channels, complemented by two Batch Nor-\nmalization (BN) layers, and utilize ParametricReLU (PReLU)\nfunctions for activation. With LR images as input, the network\nexecutes a series of convolutional operations and ultimately\nintegrates two sub-pixel convolutional layers to upscale the\nimage resolution. This process results in the generation of SR\nimages with resolutions that are significantly higher than those\nof the input LR images."}, {"title": "B. Training Process", "content": "Our overarching objective is to train the SRResNet $G_{\\theta}(\\cdot)$,\nparametrized by $\\theta$, capable of constructing the corresponding\nHR counterpart $x_n$ for given LR input $y_n$, where $\\theta$\n$= \\{W_{1:L}; b_{1:L}\\}$ denotes the weights and biases of the $L$-layer\nSRResNet. Based on our training objective, we select MSE as\nthe loss function to optimize the parameters. Thus, for CKM\nimages $x_n$ of size $w \\times h$, $n = 1,..., D$, our objective is to\nsolve\n\n$\\theta = \\arg \\min_{\\theta} \\frac{1}{D} \\sum_{n=1}^D \\frac{1}{wh} (||G_{\\theta} (y_n) - x_n||)^2,$\n\nwhere both $x_n$ and the downscaling counterpart images $y_n$\nof size $w' \\times h'$, with $n = 1, . . ., D$, serve as the network input.\nThe training procedure of SRResNet is shown in Algo-\nrithm 1. We made several adjustments to the training procedure\nof the original SRResNet. The batch size is set to 32, the\nnumber of iterations is 100,000, the learning rate is 0.001.\nAdditionally, the image cropping operation has been removed\nto maximize the utility of the sparse measured data.\n\nThe number of pixels in image $x_n$ corresponds to the num-\nber of information-carrying locations in each CKM. Through\n$k \\times SR$, the number of locations in constructed CKMs is\n$k^2$ times that in sparse measurements. Thus, we have the\nfollowing equation\n\n$k = \\sqrt{\\frac{wh}{w'h'}}.$\n\nIn this letter, we set $k = 2,4,8$ and 16, which indicates\nthat the sparse data required to construct a HR CKM is only\n1/4, 1/16, 1/64 and 1/256 of the total data."}, {"title": "IV. NUMERICAL RESULTS", "content": "In this section, we describe the dataset used and present the\nnumerical results."}, {"title": "A. Simulation Setup", "content": "1) Datasets: We first utilize the RadioMapSeer\u00b9 dataset,\nfrom which we choose 21,000 path loss maps simulated\nthrough the dominant path model (DPM) for training and\ntesting. The training dataset consists of 20,000 randomly\nselected path loss maps, while the test dataset comprises the\nremaining 1,000 maps. We ensure that the BS locations in the\ntest dataset are not included in the training dataset, allowing\nus to evaluate the model's generalization capability.\n\nWe also train and test our model on the CKMImageNet\u00b2\ndataset. CKMImageNet provides both location-tagged numer-\nical channel data and visual images, offering a holistic view of\nthe channel and environment. Built using commercial ray trac-\ning software, CKMImageNet captures electromagnetic wave\npropagation in various scenarios, revealing the relationships\namong location, environment and channel knowledge [8]. The\ndataset encompasses a wide variety of channel parameters,\nincluding path loss, delay, AoA and AoD, etc. The vast ma-\njority of existing datasets focus solely on path loss, while the\nCKMImageNet dataset incorporates angle information such as\nAoA and AoD. We randomly select 11,064 path loss maps\nfrom CKMImageNet for the training set and 1,000 distinct\npath loss maps for the test set. Compared to path loss, angular\ninformation in the channel often exhibits a more complex dis-\ntribution, making it more challenging to construct. Therefore,\nwe employ AoA maps in CKMImageNet to evaluate whether\nSR algorithms can also be utilized to construct CAMs. The\nAoA map training set consists of 11,866 images, while the\ntest set includes an additional 1,000 distinct images. All the\nimages in the CKMImageNet dataset are of size 128 \u00d7 128.\n\n2) Pixel-data Correlation: Before delving into the numeri-\ncal results, it is essential to elucidate the relationship between\nthe image information and the channel knowledge contained"}, {"title": "B. Performance and Stability", "content": "1) Accuracy: Under the condition of $4\\times SR$, we compared\nthe performance of SRResNet with the NN interpolation,\nbicubic interpolation and the SRGAN. The PSNR, SSIM, and\nLPIPS values are shown in Table I and Table II, which demon-\nstrate the excellent performance of the proposed SRResNet-\nbased CKM image SR method. Moreover, the significant\nreduction in MSE and RMSE further indicates the great\npotential of SRResNet in CKM construction. Based on the\nnumerical results from the simulation on the RadioMapSeer\ndataset, only 1/16 of the locations need to be measured in\norder to achieve a RMSE of 1.1 dB in path loss.\n\nthe results of NN interpolation. It can be discerned that both\nSRGAN and SRResNet exhibit the ability to produce images\nthat are visually almost indistinguishable from the ground\ntruth, demonstrating a high degree of fidelity in their outputs.\n\n2) Performance under Different SR Factors: In image pro-\ncessing applications, $2\\times$, $4\\times$, and $8\\times$ are common SR factors\n[12], but higher factors may be required for channel data\nprediction. In Fig. 5, we compare the RMSE performance\nof different algorithms at various SR factors and find that\nSRResNet consistently outperforms other methods across all\nfactors. For example, a RMSE of approximately 9.6 dB in\npath loss was achieved with 1/256 expected data. Furthermore,\nSRResNet exhibits more stable performance compared to\nSRGAN. We also demonstrate the visualization results under\ndifferent SR factors in Fig. 6.\n\n3) Performance of AoA prediction: Fig. 7 illustrates the\nperformance of SRResNet method on constructing AoA maps,\ndemonstrating that SR techniques are also effective for CAM\nconstruction. Comparing the visual results in Fig. 6 and Fig. 7,\nwe observe that under the same SR factor, SRResNet performs\nbetter on path loss maps than on AoA maps. This discrepancy\narises because AoA maps, with their inherently more complex\nand nuanced features, present a greater challenge for construc-\ntion using CNN compared to path loss maps, when using the\nidentical training scheme."}, {"title": "C. Discussion", "content": "Through simulations on two different datasets, we demon-\nstrate that our method requires only sparse observation data as\ninput to construct CKM, and it outperforms traditional linear\ninterpolation algorithms in both visual quality metrics and\nchannel knowledge accuracy. Moreover, the SRResNet method\nis capable of constructing not only HR path loss maps but\nalso AoA maps. Conducting cross-dataset transfer learning\nand constructing more complex channel knowledge represent\nsignificant challenges and will be important areas for future\nwork."}, {"title": "V. CONCLUSION", "content": "In this letter, we propose a novel CKM construction ap-\nproach based on an image SR algorithm, namely SRResNet,\nwhich demonstrates superior performance in accurately and\nefficiently constructing complete CKMs directly from sparse\ndata. Through simulations, we demonstrate the excellent per-\nformance of SRResNet method compared to other methods\nacross different factors and CKM datasets. Furthermore, our\napproach can also be applied to the construction of HR CAMs,\nand the generalization to other types of channel knowledge\nis straightforward. In the future, we will consider the CKM\nconstruction with noisy and non-uniformly distributed channel\nmeasurements."}]}