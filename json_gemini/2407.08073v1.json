{"title": "NDST: Neural Driving Style Transfer for Human-Like Vision-Based Autonomous Driving", "authors": ["Donghyun Kim", "Aws Khalil", "Haewoon Nam", "Jaerock Kwon"], "abstract": "Autonomous Vehicles (AV) and Advanced Driver Assistant Systems (ADAS) prioritize safety over comfort. The intertwining factors of safety and comfort emerge as pivotal elements in ensuring the effectiveness of Autonomous Driving (AD). Users often experience discomfort when AV or ADAS drive the vehicle on their behalf. Providing a personalized human-like AD experience, tailored to match users' unique driving styles while adhering to safety prerequisites, presents a significant opportunity to boost the acceptance of AVs. This paper proposes a novel approach, Neural Driving Style Transfer (NDST), inspired by Neural Style Transfer (NST), to address this issue. NDST integrates a Personalized Block (PB) into the conventional Baseline Driving Model (BDM), allowing for the transfer of a user's unique driving style while adhering to safety parameters. The PB serves as a self-configuring system, learning and adapting to an individual's driving behavior without requiring modifications to the BDM. This approach enables the personalization of AV models, aligning the driving style more closely with user preferences while ensuring baseline safety critical actuation. Two contrasting driving styles (Style A and Style B) were used to validate the proposed NDST methodology, demonstrating its efficacy in transferring personal driving styles to the AV system. Our work highlights the potential of NDST to enhance user comfort in AVs by providing a personalized and familiar driving experience. The findings affirm the feasibility of integrating NDST into existing AV frameworks to bridge the gap between safety and individualized driving styles, promoting wider acceptance and improved user experiences.", "sections": [{"title": "I. INTRODUCTION", "content": "In the last decade, Autonomous Vehicles (AV) and Advanced Driver Assistant Systems (ADAS) have progressed significantly, moving closer to their goal of providing a safer and more regulated mode of transportation. However, the attainment of safety alone does not ensure the success of Autonomous Driving (AD) technology [1]. Persistent reservations and concerns among the public [2] highlight the critical need for AD technology to not only prioritize safety but also deliver a comfortable and stress-free user experience.\nThe intertwining factors of safety and comfort emerge as pivotal elements in ensuring the effectiveness of AD. Passenger discomfort arises when a driving style significantly differs from what individuals are accustomed to [3]. This driving style, including turning dynamics, speed modulation, acceleration, and braking, is a key factor influencing the overall user acceptance of AD technology. Therefore, adopting a human-like driving style is crucial for improving both comfort and safety in the AD experience [4].\nChandrayee Basu [6] delves into the investigation of preferred autonomous driving styles, further underscoring this imperative. Basu's research showed that even though the majority of drivers could not accurately identify their own driving style, there was a high correlation between the style they considered their own and the style they preferred, indicating a preference for styles similar to their own. These findings emphasize the need for a personalized human-like AD style. Providing a personalized human-like AD experience, tailored to match users' unique driving styles while adhering to safety prerequisites, presents a significant opportunity to boost the acceptance of AV [7] [8].\nTo achieve this, we propose a new method specifically designed for vision-based AD. While existing studies [9]-"}, {"title": "II. RELATED WORK", "content": "[16] typically adopt a standardized driving model based on specific applications (e.g., urban driving, racing, etc), our method, Neural Driving Style Transfer (NDST), acknowledges the diversity in drivers' habits influenced by factors like personality and environment [17]. Inspired by Neural Image Style Transfer (NST) [5] from deep neural networks-based computer vision communities, the proposed method, NDST, leverages the NST concepts to integrate a user's driving style with the vehicle's AD model, creating a personalized driving experience while maintaining standard safety baseline.\nThe two main components of NDST are the Baseline Driving Model (BDM) and the Personalized Block (PB). Fig. 1 illustrates the comparison between NST and NDST. The BDM, serving as the standard AD model, is comparable to the image content in NST, while the PB incorporates the user's driving style. This approach aims to bridge the gap between safety and personalization in AD.\nTo validate our methodology, we collected data from two drivers with distinct driving styles labeled as; A and B. Style B exhibited faster acceleration and deceleration compared to Style A. The main contributions of this paper are as follows:\n1) This paper proposes a novel learning method, NDST, designed to provide a human-like personalized AD experience that increases the acceptance of AV and enhances the user experience.\n2) The PB is designed to be a self-configuring system, which can be seamlessly integrated with the original AD system (i.e., the BDM) without requiring any modifications. The PB is dependent on the output of the BDM to ensure that any safety-related decisions made by the BDM will be reflected in the final output of the PB. This increases comfort while maintaining the required baseline safety.\n3) An extensive amount of simulations in various test tracks are performed to evaluate the performance of the proposed method. It is observed that the proposed network gives stable autonomous driving on the tracks with the driving style of choice by imitating the driver's acceleration and deceleration patterns.\nThe remainder of this paper is organized as follows. Section II introduces related research and Section III describes the proposed method. Section IV shows the experimental results in the simulation environment, and analyzes the results. Section V concludes the thesis and presents directions for future work.\nII. RELATED WORK\nVarious research efforts have been conducted with the aim to effectively extract and analyze driving styles from drivers' data.\nHironori Hiraishi [18] used the Neural Image Style Transfer (NST) method to learn the driving style after forming the driving data as an image in RGB format. However, research on how to decode the driving style image to control the vehicle has not been conducted. Qi et al. [19] analyzed the driving style based on the change of the temporal distance, which is the distance to the vehicle in front. Based on their analysis, they developed a structure to distinguish different driving styles and to build a connection between style and human driving behavior. However, in their analysis, they do not consider different factors, other than the temporal distance. Choi et al. [20] proposed a DSA-GAN that recognizes the driver's driving style and predicts the trajectory by reflecting the style. They used Recurrence Plot and CNN network to learn three driving styles, normal, aggressive, and careless, and predicted their trajectories. In a similar work, Kim et al. [21] conducted a work to improve prediction performance and create a personalized trajectory by recognizing and reflecting on various driving styles to predict the trajectory of an ego vehicle. Their proposed system uses a conditional variational autoencoder (CVAE) structure, and studies have been conducted to learn and predict the trajectory of three driving styles: normal, aggressive, and distracted. However, in these studies, the predicted trajectories were not used to drive the vehicle. This was presented as future work. Bingzhao Gao [22] proposed a personalized adaptive cruise control (ACC) system based on model predictive control (MPC). In this work, the driving style was defined as conservative, moderate, and aggressive, and the driving style of the driver was learned using the relative speed and headway of the vehicle in front. The work assumed a situation in which a leading vehicle exists, it did not discuss whether the autonomous vehicle continues to adapt its driving style in the absence of a leading vehicle. Xu et al. [23] proposed a technique for creating driver models that accommodate different driving styles by modeling actual human driving behavior. The authors used old machine learning techniques to examine the driving behaviors of participants who were driving on a closed circuit after collecting their data. The efficiency of the produced driver models was then assessed using a driving simulator. The driving style was represented by the throttle, brake, and vehicle speed data. In another work, Shi et al. [24] evaluated these driving styles to detect abnormal driving behavior. Similarly, Kuderer et al. [25] worked on learning the driving style from demonstration, in which they build an algorithm to learn the highway driving style using recorded human driving data. However, these studies were done based on driving data only without visual input as vision-based autonomous driving was not yet popular (imitation learning or behavioral cloning adopting a vision-based end-to-end technique did not acquire popularity until DAVE-2 was developed [11])."}, {"title": "III. PROPOSED METHOD", "content": "This section explains how to use the proposed method to transfer the driving style of a driver. The proposed method is based on building a network that learns the driving style of a driver and integrates it into the AV. The driving data used to work the driving style is the acceleration and deceleration data based on road type. However, other driving data can be added as well, such as steering angles, vehicle speed, and time.\nThe proposed method uses driving data from the user to learn the acceleration/deceleration patterns. To validate our approach, we conducted an experiment using data from two drivers with distinct driving styles, arbitrarily referred to as"}, {"title": "A. Neural Driving Style Transfer (NDST) Network Architecture", "content": "style A and style B. In practice, the method is designed to accommodate any number of unique driving styles. In our experimental setup, style B represents a driver who accelerates and decelerates more quickly compared to the driver characterized by style A.\nThe NDST network architecture is depicted in Fig. 2. The NDST architecture consists of two major blocks: a BDM block and a PB block. The reason behind choosing this design is to make the proposed system a self-configuring system, which makes it easy to integrate with the original vehicle system without the need to modify it. Therefore, the proposed system, NDST, allows the personalization feature to be easily enabled/disabled based on the user's preference.\n1) Baseline Driving Model (BDM): The baseline driving model is a generic AV driving model that can drive the vehicle. The BDM network architecture is based on the NVIDIA PilotNet structure [26], and is shown in blue in Fig. 2. However, the network is modified so that the image and current speed are used as inputs, and the steering angle, throttle, and brake values are defined as outputs. The network processes the first input (i.e., visual observation) using five convolutional layers, and then the output of the fifth is flattened to form an image feature vector. Then, the second input (current speed) is concatenated with the image feature vector. After that, the concatenated vectors are fed to three fully connected layers (Dense layers). The BDM block output is the output of its last fully connected layer and is the prediction of three actuation values (standard actuation in Fig. 2): Steering, Throttle, and Brake values.\n2) Personalized Block (PB): The PB is a neural network for personalizing the output value of the BDM based on the driving style of a particular driver, which is shown in Fig. 2 in red. It is seen that the PB has four inputs. The first input is the predicted action values of the BDM. The second input is the output of the third and last convolution layer of the BDM after being flattened, which gives an indication of the road conditions. The third input is the current speed data. The Fourth input is the difference between the target speed of the vehicle, which is defined by the user and the current speed. Each input goes into a fully connected layer to form a vector. Then, all four vectors are concatenated and fed to three fully connected layers. A dropout layer was needed after the first fully connected layer for generalization purposes. The output of the third layer is the final output of the PB which is a personalized predicted actuation based on the style of a particular driver and contains three values: steering angle, throttle, and brake."}, {"title": "B. Training Method for AV Personalization", "content": "The proposed method for the personalization of AVs is shown in Fig. 3. The structure of the proposed system consists of the following steps.\nStep 0: Learning the Baseline Driving Model\nThe proposed system essentially works under the presump- tion that the vehicle is equipped with a baseline autonomy model, called the baseline driving model (BDM), that is capable of driving the vehicle. The BDM does not represent the driving preferences of any one driver, thus it is not biased toward the unique driving style of one driver."}, {"title": "At can be defined as", "content": "At = {St, Tt, Bt},\n(3)\nwhere St, Tt, and Bt are the steering angle, throttle and brake at time t, respectively. Therefore, total input data I and action data A can be defined as\nN\nI = {It}=1, A = {At}=1\n(4)\n\u0100 = \u03c0BDM(I)\n(5)\nIn (5), \u03c0BDM represents the BDM policy, which takes I as an input, and provides \u0100 as an output, where \u0100 is the predicted actuation of the BDM. The BDM is trained to minimize the average prediction error as\nN\nw\u2217 = arg min \u2211 L(\u0100t, At),\n\u03c9\nt=1\n(6)\nwhere \u03c9\u2217 represents the parameters of the BDM, and L is the loss per sample.\nStep 1: Collecting driving data of a driver\nAfter building the BDM, we start collecting data from a driver whose driving style we want to transfer. This is illustrated in step 1 in Fig. 3, which can be expressed in the following as\nD = {In, An},\n(7)\nwhere n represents the driver's number. D is the entire dataset collected by driver n. In and An mean the I and A collected by driver n, respectively.\nStep 2: Training the Personalized Block (PB) for the driver\nFinally, PB is trained using the learned BDM and driving data obtained through Steps 0 and 1. One PB reflects one driver's style. In order to train PB only, the baseline driving model is frozen so that it is not trained. Input data are then fed to the BDM. The BDM estimates the 'action' after processing the input data, as shown in (5). Note that the estimated action is the result of a generic autonomous driving model (i.e., BDM), so non-specific driving style has been applied.\nTo modify the resulting action into an action that reflects driver n's style, as shown in step 2 in Fig. 3, the PB would get four inputs for training, that are depicted in Fig. 2. The first input (An) is the predicted action values of the BDM when fed the input data of driver n (In) is represented by\nAn = \u03c0BDM(In).\n(8)\nThe second input ($(On)) is obtained by combining the output of two convolution layers when On is input to BDM, which extracts features from observation data (On). This data is used to give the PB spatial information about the road. The third input is the current speed data collected by driver n in step 1 (vcn). The last input is the difference between the target speed of the vehicle (V\u03b8 ) which is defined by the user and the current speed vcn. The target speed is used by PB to determine acceleration and deceleration. The action obtained through driver n (An) is used as the ground truth for learning. The final"}, {"title": "D= {It,At}Nt=1", "content": "The dataset used to train such a model can be defined as\nD = {It, At}Nt=1,\n(1)\nwhere D is dataset, N is the total time steps, It is the input data at time t and At is the correlative action that controls the vehicle. The input data It can be defined as\nIt = {Ot, vcn},\n(2)\nwhere Ot is visual observation (e.g. images) and vcn is the vehicle's current speed. The action that controls the vehicle"}, {"title": "C. Simulation Environment", "content": "output of the trained PB is a personalized predicted actuation of driver n (An) and can be defined as\nAn = PB(An, \u03c6(On), (vcn)\u03b8, V\u03b8).\n(9)\nThe loss function used to learn PB can be defined as\n\u03c7\u2217 = arg min \u2211 L(An, An),\n\u03c7\nt=1\n(10)\nwhere \u03c7 represents parameters of the PB, and L is a loss per sample.\nThe proposed method for personalization is designed not to modify the original system but to add to it, by plugging the PB block into the vehicle system.\nTo implement the NDST, we used the OSCAR simulator [27] which was introduced in [15], for its simplicity as it was built using ROS (Robotic Operating System) [28] and Gazebo simulator [29] and because it was designed for vision-based autonomous driving.\n1) Track: Since the driving style we are trying to transfer is represented by the steering angle, throttle (acceleration), and brake (deceleration), the training track, shown in Fig. 4, was designed to cover three cases that reflect the driving style: acceleration/deceleration to reach the target speed, deceleration before entering the curved section, and acceleration after exiting the curved section. To test the NDST model after training, a test track was constructed to check the acceleration and deceleration of straight and curved sections, and the corresponding track is shown in Fig. 5.\n2) Dataset: Before training the NDST Network, the BDM should be trained to enable normal driving without reflecting a specific driving style. Therefore, in order to collect a dataset suitable for this purpose and eliminate any bias in the data, the BDM was trained using multiple datasets with various acceleration, deceleration, and speed data on the track. Afterward,"}, {"title": "IV. EXPERIMENTAL RESULTS", "content": "In our experiments, we used a variety of plots to validate the performance of the NDST method. These evaluations confirmed that self-configuring PB can effectively transfer a"}, {"title": "V. CONCLUSION", "content": "speed, the acceleration, and deceleration applied to reach that target speed are different. PB2 (style B) reached the target speed of 80m, while PB1 traveled 150m to reach the target speed. Fig. 11 shows the velocity and control values of each model when the target speed is set on the straight road section. Fig. 11a shows the driving data of the original dataset collected by driver 1 (top) and the PB1 (style A) driving data (bottom), and Fig. 11b shows the driving data of the original dataset collected by driver 2 (top) and the PB2 (style B) driving data (bottom). The PB1 (style A) took 2250m from the starting point to reach 30m/s, but the PB2 (style B) reached 30m/s in 500m, showing rapid acceleration and deceleration.\nThis paper introduces a novel approach called Neural Driving Style Transfer (NDST) that aims to personalize the driving experience of vision-based AV. NDST can transfer a driver's unique driving style to a vision-based AV, allowing the vehicle to drive in a way that is more similar to the driver's preferences by integrating a standardized driving model with a Personalized Block (PB) capable of acquiring causal associa- tions between acceleration and deceleration from each driver's unique data. The proposed system, NDST, was successfully validated through simulated driving results, underscoring its ability to adapt an AV system to individual driving styles."}]}