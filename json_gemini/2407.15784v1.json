{"title": "Diffusion Model Based Resource Allocation Strategy in Ultra-Reliable Wireless Networked Control Systems", "authors": ["Amirhassan Babazadeh Darabi", "Sinem Coleri"], "abstract": "Diffusion models are vastly used in generative AI, leveraging their capability to capture complex data distributions. However, their potential remains largely unexplored in the field of resource allocation in wireless networks. This paper introduces a novel diffusion model-based resource allocation strategy for Wireless Networked Control Systems (WNCSs) with the objective of minimizing total power consumption through the optimization of the sampling period in the control system, and blocklength and packet error probability in the finite blocklength regime of the communication system. The problem is first reduced to the optimization of blocklength only based on the derivation of the optimality conditions. Then, the optimization theory solution collects a dataset of channel gains and corresponding optimal blocklengths. Finally, the Denoising Diffusion Probabilistic Model (DDPM) uses this collected dataset to train the resource allocation algorithm that generates optimal blocklength values conditioned on the channel state information (CSI). Via extensive simulations, the proposed approach is shown to outperform previously proposed Deep Reinforcement Learning (DRL) based approaches with close to optimal performance regarding total power consumption. Moreover, an improvement of up to eighteen-fold in the reduction of critical constraint violations is observed, further underscoring the accuracy of the solution.", "sections": [{"title": "I. INTRODUCTION", "content": "WNCSs are control systems with control loops closed through a wireless communication network [1]. WNCSs play an important role in supporting emerging ap- plications in sixth-generation (6G) networks, such as remote driving [2] and cooperative robots (cobots) [3]. The joint optimization of the performance of the control and commu- nication systems is the main challenge in WNCSs due to the high complexity of modeling the interactions between these two systems, the stringent ultra-reliability requirements of control systems, and the non-ideal propagation characteristics of wireless communication systems.\nEarlier research on the joint design of control and com- munication systems for WNCSs focused on the usage of optimization theory-based solution strategies following the derivation of the right abstractions of these two systems [4], [5]. In joint optimization frameworks that uniquely abstract the performance of control and communication systems, an optimization problem is formulated with both the control and communication decision variables and solved using iterative or heuristic methods following the derivation of the optimality conditions. However, the high complexity of the proposed model-based methods may hinder their application in low- latency WNCS scenarios.\nIn order to solve the time complexity issue of the opti- mization theory-based solutions and additionally operate with incomplete CSI, DRL is introduced to allocate resources opti- mally through trial and error in a complex scenario [6]. In our previous work [7], we have proposed an optimization theory- based DRL approach, where first, the model is simplified based on the optimality conditions of the optimization problem. Then, the new simplified problem is fed to a Dueling Double Deep Q-network (D3QN) to output the optimal blocklength values. Although DRL methods use online interactions with the environment to learn, the amount of data needed to train the model is large. Moreover, DRL models may produce infeasible solutions that violate the constraints of the control and communication systems, which may have detrimental effects on critical safety applications.\nGenerative AI-based approaches are considered a solution to enhance the performance of 5G/6G networks. [8] introduces Generative Adversarial Networks (GANs) to be utilized along with a DRL model to enhance the model's training and adapt- ability to extreme conditions compared to the conventional DRL models. However, the GAN used in the proposed model is solely used to generate data to pre-train the DRL model and is not involved in the decision-making process. Additionally, GANs are known to be unstable in training time and cannot generate high-quality samples in the inference phase. To fix the instability and poor quality of the generated samples, DDPMs introduced in [9] are proposed to be utilized in [10] to enhance the performance of the wireless networks in constellation shaping problem. However, to this day, diffusion models are not directly applied to resource allocation problems in wireless networks.\nIn this paper, we propose a novel DDPM-based resource allocation scheme for the joint design of control and commu- nication systems in WNCSs for the first time in the literature. The DDPM is used to generate optimized blocklength values from an isotropic Gaussian distribution by using the CSI as conditional information."}, {"title": "II. SYSTEM MODEL", "content": "The WNCS consists of N sensor nodes with blocklength $m_i$, sampling period $h_i$, and packet error probability $p_i$ for $i \\in {1,2,...,N}$. Sensor nodes connected to a physical plant measure and send the plant's state to a controller via a wireless channel. Based on the recent state update information, the controller decides on a new control command and sends it to the actuator to be executed. The outdated packets are not retransmitted since old state information can harm time- critical control systems. The packet error is modeled as a Bernoulli random process to simplify the problem. The Time Division Multiple Access (TDMA) method is utilized for a deterministic access delay widely preferred in various automation applications [11]. We assume that the channel time is segmented into frames, and each frame is subdivided into time slots. The initial slot is allocated for the beacon frame, which the controller sends out periodically to disseminate synchronization and scheduling updates among the nodes within the WNCS. During the scheduling update, nodes are allocated time slots for their respective data transmissions and additional parameters, such as the optimal transmission power and blocklength. We assume that nodes within the network do not transmit simultaneously and that the network manager continuously monitors the packet error rate.\n\nA. Optimization of Control and Communication Systems\n\nThe joint optimization of control and communications sys- tems for ultra-reliable communication in the finite blocklength (FBL) regime is adopted from our previous paper [7] and is presented below.\n\n$\\displaystyle\\underset{h_{i},m_{i}, p_{i}}{minimize} \\sum_{i \\in[1, N]} C_{i1} C_2 \\exp\\left(\\frac{Q^{-1}(p_i)^2}{m_i} + \\sqrt{\\frac{V_i}{m_i}} \\ln 2L_i -1\\right) + \\frac{C_2 W m_i}{h_i}$   (1a)\n\nsubject to\n\n$\\Omega$\n$\\[ \\frac{\\Omega}{h_i} \\] \\ln p_i - \\ln \\left(1-\\delta \\right) \\leq 0, \\forall i \\in [1,N]$\t(1b)\n\n$0 < d_i(m_i) \\leq min \\left(\\Delta, h_i \\right), \\forall i \\in [1,N]$\t(1c)\n\n$0 < h_i < \\Omega, \\forall i \\in [1,N]$\t(1d)\n\n$0 < p_i \\leq 1, \\forall i \\in [1,N]$\t(1e)\n\n$m_i \\leq M_{th}, \\forall i \\in [1,N]$\t(1f)\n\n$C_{i1} \\exp\\left(\\frac{Q^{-1}(p_i)^2}{m_i} + \\sqrt{\\frac{V_i}{m_i}} \\ln 2L_i -1\\right) \\leq W_{tx,max}$\t(1g)\n\n$\\sum_{i=1}^{N} \\frac{d_i(m_i)}{h_i} \\leq \\beta,$\t(1h)\n\nwhere $C_{i1} = \\frac{\\sigma^2}{g_i}$ and $C_2 = \\frac{\\beta}{\\delta}$; $\\sigma^2$ denotes the noise power spectral density (PSD); $g_i$ denotes the channel gain of sensor node $i$; B is the bandwidth; $Q^{-1}(.)$ denotes the inverse of Q function; $L_i$ is the packet length, and $W_e$ is the circuit power for node $i$. The objective function (1a) is to minimize the total power consumption in the network considering both the transmit power and the circuit power of the nodes when sending packets. Constraints (1b) and (1c) represent stochastic MATI ($\\Omega$) defined as the probability of maximum allowed time interval between the reception of the state vector reports above MATI being greater than a predefined value $\\delta$ and MAD ($\\Delta$) defined as the maximum packet delay smaller than a maximum limit, respectively, used as an abstraction of the requirements to guarantee a certain control system performance. Constraints (1d) and (1e) give the lower and upper bounds of the sam- pling period and packet error probability. Equation (1f) states that plant state information is transmitted in small packets using a finite blocklength, which cannot exceed a threshold value $M_{th}$ because the transmission must finish before the maximum allowable channel uses is reached. Additionally, a maximum transmit power constraint in (1g) limits the nodes from exceeding a certain transmit power level due to the limited power source of the sensor nodes and government reg- ulations. Moreover, the schedulability constraint (1h) ensures that transmission times are assigned to multiple sensor nodes without any two nodes transmitting simultaneously. Each node i is allocated a fraction of the total schedule length, denoted as $\\frac{d_i}{h_i}$. Since no two nodes can transmit simultaneously, the sum of these terms represents the total time allocated to all nodes relative to the schedule length. The problem is a non- convex Mixed-Integer programming problem, so searching for a global optimum solution is difficult [12].\n\nB. Simplified Optimization Problem\n\nThe problem in (1) is not tractable and has to be simplified in order to reach sub-optimal results. As a result, the solution is grouped into multiple blocks based on the derivation of the optimality conditions, and the decision variables are reduced to consider blocklength only. Then, the other decision variables can be obtained through optimality conditions.\n\nThe optimality conditions are derived in [7] as\n\n$k_i = \\frac{\\Omega \\ln \\left(1-\\delta\\right)}{h_i \\ln p_i},$  (2)\n\nwhere $k_i$ is a positive integer. Next, the optimal value of $k_i$ is derived in terms of $m_i$ as\n\n$k_i(m_i) = max\\left\\{1, \\frac{\\ln \\left(\\frac{W_{tx,max}}{m_i C_{i1}} + 1\\right)}{\\frac{Q^{-1}(\\frac{\\Omega \\ln \\left(1-\\delta\\right)}{h_i})^2}{m_i} + \\sqrt{\\frac{V_i}{m_i}} \\ln (2) L_i -1}}\\right\\}$\t(3)\n\nThen, the problem (1) is simplified to reduce the decision variables and the constraints in the problem. The model is optimized using one decision variable of blocklength $m_i$ instead of three decision variables, and the other variables are derived using the optimality conditions described in (2) and (3). The modified joint optimization problem is formulated as"}, {"title": "III. DDPM-BASED ALLOCATION ALGORITHM", "content": "The proposed diffusion-based resource allocation algorithm is a centrally-trained-centrally-executed model consisting of two stages: optimization theory-based data collection and DDPM- based training and data generation, as depicted in Fig. 1. In the optimization theory-based data collection stage, various values of channel gains and the corresponding optimal block- length values are collected. The optimal blocklength values are determined by solving the optimization problem in (4). The resulting dataset is then the input to the the diffusion model. In the diffusion model stage, the collected dataset is used to train a diffusion model and learn the optimal parameters to choose an action for blocklength adaptation for given channel gains.\n\nThe model is implemented in the controller, where control commands are sent to each sensor node after execution. DDPM consists of input states and conditional information as provided below:\n\n\u2022\tInput States: The objective of the DDPM-based method is to generate outputs drawn from a similar distribution to the input states. In the training phase, the input states are the optimal blocklength values from the dataset. Batches of data are sampled from the dataset. They are input to the model to modify and update the parameters of the neural network so the model can learn the solution space distribution and generate desired outputs after the training phase. On the other hand, in the inference phase, the input states are drawn from an isotropic Gaussian distribution with mean zero and standard deviation one, and the outputs are generated through the denoising process of the diffusion models.\n\n\u2022\tConditional Information: The conditional information given to the network is the CSI of the links to condition the learning process on the environmental variables to ensure the model is trained to execute actions based on the current channel state. This is the most important part of the model since the environment directly affects the learning process. In the training time, in addition to the CSI, uniformly sampled time steps are given to the model to train the model to denoise the samples efficiently.\n\nThe proposed algorithm is summarized in Algorithm 1, which is comprised of three parts, namely, initialization and dataset"}, {"title": "IV. PERFORMANCE EVALUATION", "content": "In this section, the performance of the diffusion-based resource allocation technique is compared to the benchmark models, including the pure optimization theory-based model and the DRL-based models. The DRL benchmarks, Branching Deep Q-networks (BDQ), which are suitable to solve problems with multi-variable action space, are utilized to solve the optimiza- tion problem in (1) with decision variables of blocklength, sampling period, and packet error probability. The D3QN is used for the simplified optimization problem (4) with only blocklength decision variable. First, the simulation settings for the environment and the diffusion model are given in part IV-A, and then, performance comparison and analysis of the proposed and benchmark methods are presented in part IV-B.\n\nA. Simulation Setup\n\nSimulations are conducted for a network where the nodes are uniformly spread out within a circular area with a 50-meter radius, all communicating with a central controller. The path loss and shadowing effect result in large-scale fading, and it is modeled as $PL(d_i)[dB] = PL(d_0)[dB] + 10a \\log \\frac{d_i}{d_0} + Z$, where $d_i$ is the distance of node i from the central controller, $PL(d_i)$ is the path loss of node i at distance d in decibels, $PL(d_0) = 35.3$ dB is the path loss at the reference distance $d_0 = 1m$, path loss exponent $a = 3.76$, Z is a Gaussian random variable with zero mean and standard deviation equal to 4 dB corresponding to log-normal shadowing. For small- scale fading, Jake's model [7] is used, expressed as a first-order complex Gauss-Markov process. The simulation parameters are listed in Table I.\n\nThe neural network used for noise prediction has a modified UNet architecture. The grid search algorithm selects the opti-"}, {"title": "V. CONCLUSION", "content": "In this paper, we propose a novel diffusion-based resource allo- cation framework for the joint optimization of communication"}]}