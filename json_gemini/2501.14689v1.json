{"title": "APPROACH TO DESIGNING CV SYSTEMS FOR MEDICAL APPLICATIONS: DATA, ARCHITECTURE AND AI", "authors": ["Dmitry Ryabtsev", "Boris Vasilyev", "Sergey Shershakov"], "abstract": "This paper introduces an innovative software system for fundus image analysis that deliberately diverges from the conventional screening approach, opting not to predict specific diagnoses. Instead, our methodology mimics the diagnostic process by thoroughly analyzing both normal and pathological features of fundus structures, leaving the ultimate decision-making authority in the hands of healthcare professionals [1].\nOur initiative addresses the need for objective clinical analysis and seeks to automate and enhance the clinical workflow of fundus image examination. The system, from its overarching architecture to the modular analysis design powered by artificial intelligence (AI) models, aligns seamlessly with ophthalmological practices. Our unique approach utilizes a combination of state-of-the-art deep learning methods and traditional computer vision algorithms to provide a comprehensive and nuanced analysis of fundus structures.\nWe present a distinctive methodology for designing medical applications, using our system as an illustrative example. Comprehensive verification and validation results demonstrate the efficacy of our approach in revolutionizing fundus image analysis, with potential applications across various medical domains.", "sections": [{"title": "1 Introduction", "content": "Artificial intelligence (AI) has demonstrated immense potential in revolutionizing medical imaging diagnostics [2, 3], particularly through advancements in computer vision (CV). The ability of AI to analyze complex patterns in medical images-such as MRIs, X-rays, CT scans, and photographs\u2014has led to significant progress in disease detection and classification. However, despite these technological advancements, there remains a substantial disconnect between the design of AI systems and the practical needs of medical professionals. The relentless race for higher performance often overlooks critical factors such as interpretability, transparency [4, 5], and integration into clinical workflows, which are essential for real-world adoption in healthcare settings.\nOne of the major challenges for AI in medicine is data scarcity. Medical data is not only limited in quantity but often lacks the quality and relevance necessary for effective AI model training [6, 7]. The absence of standardized protocols for data anonymization, along with domain-specific data difficulties and interobserver variability, further complicates data collection and curation. Additionally, the current trend toward large, complex models amplifies issues of interpretability and transparency, as these models often function as \"black boxes,\" making it difficult for clinicians to understand and trust their outputs.\nAligning AI systems with clinical workflows is crucial to bridge this gap. In medical imaging, and particularly in ophthalmology, there is a significant opportunity to leverage CV for fundus image analysis. Fundus images provide valuable insights into ocular and systemic diseases, and effective analysis tools can greatly assist clinicians. However, for AI to be truly effective in this domain, it must be designed with the real needs of doctors in mind."}, {"title": "2 Related Work", "content": "Screening systems have become prevalent in fundus image analysis [8] due to opportunistic data acquisition, enabling binary classifications such as the presence or absence of disease [9]. While these systems leverage large datasets that are more readily available, they often lack the detailed annotations necessary for nuanced analyses. This approach faces significant limitations related to data scarcity, lack of standardization, and insufficient interpretability.\nData scarcity is a critical issue in medical imaging AI. The absence of universal standards for anonymizing medical images complicates data sharing and aggregation, hindering the accumulation of large, diverse datasets required for robust AI model development [9]. Additionally, there is a paucity of research on demographic differences, which is vital for ensuring that AI models perform effectively across diverse populations. Domain-specific challenges, such as variations in imaging equipment and protocols, further complicate data collection and model training [10]. Inter-observer variability\u2014the differences in interpretation among clinicians-impacts the consistency and reliability of annotated data, affecting model performance [11].\nSince data is the foundation of any AI system, the importance of data quality and curation cannot be overstated. Poor-quality data is not merely less useful; it is often not useful at all [12]. Effective curation requires collaboration between system designers and clinicians to ensure that both the output and intermediate data meet clinical needs. If custom outputs are necessary, systems must be designed to produce them, emphasizing the need for flexibility in AI system design.\nTransparency and interpretability are crucial for ensuring reliability and safety in medical AI applications. Designing evaluation metrics and validation strategies that the system can provide is essential for building trust among clinicians [13]. Intermediate data must be understandable to clinicians so they can discern which predictions are based on specific inputs, facilitating verification and fostering confidence in the system [14].\nSegmentation-based approaches offer an alternative to screening systems by providing detailed analyses of specific structures within fundus images [15]. These methods enhance interpretability and allow for outputs that can be directly integrated into clinical reports, aligning more closely with the diagnostic processes used by ophthalmologists. However, challenges in acquiring finely annotated data have limited the widespread adoption of segmentation approaches.\nA modular approach that mirrors clinical workflows remains a largely unexplored avenue in fundus image analysis. Such an approach allows for step-by-step verification, harnessing the potential of explainable AI and offering a compelling path toward enhanced clinical trust in AI decision-making [16]."}, {"title": "3 Requirements Analysis", "content": "Scope of Automation. The first step in the development of an AI-driven system for ophthalmology is to carefully delineate the aspects of the clinical workflow that can be effectively automated. We focus on analyzing fundus images and generating detailed, natural language descriptions of fundus structures. This capability allows the system to produce a draft of a medical report that closely aligns with the format used by ophthalmologists. By automating this specific component of the clinical workflow, the system aims to significantly enhance operational efficiency. The scope of automation is deliberately narrowed to ensure reliability and to avoid overextending the system's capabilities. This approach ensures that the system provides meaningful support to clinicians, helping them to streamline their documentation tasks without undermining the critical decision-making processes inherent in medical practice.\nData Quality and Curation. Data quality and curation are foundational to the success of any AI-based medical system. It is essential that the system is developed with data that meets the expectations and needs of its primary users-clinicians. To achieve this, we prioritize engaging with end users during the data curation process to ensure that the collected data is both relevant and user-friendly in a clinical context. The data collection process should adhere to established medical protocols, which are the closest available standards for ensuring data quality in medical applications. This process includes addressing domain-specific challenges such as class imbalances, where pathological"}, {"title": "4 Data Challenges and Strategies", "content": "Medical specialists must be actively involved in every stage of data collection and annotation. Focusing on specific features over general ones ensures that the data aligns with clinical reporting practices [12]. This specificity enhances the utility of the AI system in real-world clinical settings, as the outputs are directly translatable into actionable insights for patient care.\nIn addition to initial data annotation, medical professionals should be involved in designing and verifying intermediate data outputs. These outputs must be sufficient for diagnostic purposes and comprehensible enough for clinicians to verify without compromising necessary details [14]. There can be no compromise on the necessity of this data in the system's design; it must meet the exacting standards of clinical practice to be trustworthy and effective.\nMedical professionals also play a critical role in informing system designers about any present imbalances or specific difficulties within the data. Issues such as class imbalances\u2014where certain pathologies may be underrepresented-can significantly affect model performance [17]. Their insights are essential in guiding the data curation process to ensure that the dataset is both comprehensive and representative of the patient populations the AI system will serve.\nCollaborative involvement extends to the design of evaluation metrics and validation strategies. Traditional performance metrics may not adequately capture the nuances of clinical significance [11]. Medical experts can help define metrics that reflect the real-world importance of different types of errors, leading to more clinically relevant evaluations of model performance. This collaboration also influences the selection of loss functions during model training, aligning the optimization process with clinical priorities [18].\nAddressing data challenges requires proactive strategies:\n\u2022 Targeted Data Collection: Actively seeking out data for underrepresented classes to balance the dataset [9].\n\u2022 Data Augmentation: Using techniques such as rotation, scaling, and flipping to increase data diversity and mitigate overfitting [15].\n\u2022 Advanced Annotation Techniques: Employing methods like consensus labeling to reduce interobserver variability and improve annotation quality [12].\nBy closely involving medical professionals in these processes, the AI system is more likely to meet the stringent requirements of clinical application, ultimately leading to safer and more effective patient care. The collaboration ensures that the system not only performs well statistically but also provides outputs that are meaningful and trustworthy from a clinical perspective."}, {"title": "5 General Methodology and Approach", "content": "Our approach to developing the fundus image analysis system is a direct outcome of the requirements analysis, which identified the key areas where automation can be effective, data quality must be ensured, and system efficiency is paramount. The methodology outlined below reflects these priorities, emphasizing modular design, appropriate technology selection, interpretability, and seamless integration into both diagnostic and clinical workflows.\nModular Approach. The development of our system follows a modular approach, designed to enhance flexibility, scalability, and clarity. By breaking down the image analysis process into discrete tasks\u2014such as localization, segmentation, and classification-each module can be optimized individually, ensuring that the overall system remains efficient and effective. This modular design not only improves the interpretability of the system's outputs but also allows for easier updates and maintenance, enabling the system to adapt to evolving clinical needs and technological advancements.\nAppropriate Technology Selection. In line with our commitment to efficiency and practicality, we carefully select the most suitable technology for each task. This means using traditional computer vision algorithms when they are sufficient and opting for deep learning models only when the complexity of the task necessitates it. This approach avoids unnecessary complexity, ensuring that the system is not only effective but also accessible and interpretable for clinicians. By focusing on the right tool for the job, we strike a balance between performance and usability, ensuring that the system remains a practical and reliable tool in clinical settings.\nEmphasis on Interpretability. Interpretability is a cornerstone of our system's design, as it is crucial for gaining the trust of clinicians who will rely on the system in their daily practice. The system is designed to produce outputs that are easily interpretable by doctors, allowing them to quickly verify the results. In addition to the final outcomes, the system provides transparency in its intermediate results, offering insights into how conclusions are reached at each stage of the analysis. This transparency helps clinicians understand and trust the process, ensuring that they can confidently integrate the system into their diagnostic workflow, using it as a reliable aid rather than a black-box tool."}, {"title": "Diagnostic Workflow Integration", "content": "Our system is meticulously designed to integrate seamlessly with the diagnostic workflow of ophthalmologists. It mirrors the way doctors describe and analyze fundus images in practice, generating detailed descriptions that align with clinical protocols and practices. This approach ensures that the system's outputs are directly relevant and useful in a clinical context, providing doctors with actionable insights that are presented in a familiar format. The system's design prioritizes practical utility, making it a natural extension of the clinician's existing diagnostic processes.\nClinical Workflow Integration. Beyond diagnostic tasks, the system is engineered to fit smoothly into the broader clinical workflow. It is fully compatible with existing Electronic Medical Records (EMR) systems, ensuring that data can be easily integrated and accessed within the established healthcare infrastructure. The system also adheres to stringent security and anonymity standards, safeguarding patient data and ensuring compliance with healthcare regulations. By being EMR-ready and prioritizing security, the system supports a seamless and secure integration into the clinical environment, enabling its use across diverse healthcare settings without disrupting existing operations."}, {"title": "6 Details of Implementation", "content": ""}, {"title": "6.1 Architecture Design", "content": "The architecture of our fundus image analysis system (see Fig. 1) is carefully designed to ensure modularity, scalability, and seamless integration into clinical workflows. It follows a client-server model where the interaction between the web client and the backend services is managed through API Gateways. The first gateway handles the client interface, while the second is dedicated to optimizing the operations of the analysis microservices, which are responsible for specific aspects of fundus image analysis.\nAt the core of the system is the Report Service, which synthesizes analysis results from various microservices, each focused on distinct fundus structures such as the optic nerve head (ONH), macula, and retinal vessels. These microservices operate autonomously but are designed to communicate with each other, enabling cross-analysis. This means that the results of one parameter analysis can inform and enhance another, even when these analyses are conducted by different microservices. For example, the analysis of vessel characteristics can be influenced by findings from the macula or ONH analysis, ensuring a more comprehensive and integrated assessment of the fundus.\nOur architecture is closely aligned with the clinical decision-making process. Each microservice corresponds directly to the specific diagnostic decisions and descriptive elements that clinicians consider during fundus image assessment. The ONH microservice, for instance, focuses on features crucial for diagnosing conditions like glaucoma, while the macula and vessels microservices are tailored to their respective clinical tasks. This alignment ensures that the system's outputs are not only technically accurate but also clinically relevant, providing doctors with detailed and actionable insights that support their diagnostic process."}, {"title": "6.2 Analysis Pipeline", "content": "Our AI-based fundus analysis system employs a three-step modular pipeline (see Fig. 2) designed to enhance interpretability, promote model explainability, and optimize performance.\nLocalization We utilize an ensemble of OpenCV [19] methods for precise localization of the ONH and macula regions within the original ophthalmoscopy image. This includes image preprocessing for contrast enhancement, edge detection, and template matching for robust detection.\nSegmentation For ONH and Macula we employ state-of-the-art U-Net variants (e.g., Attention U-Net, R2U-Net [20, 21]) trained on a carefully curated subset of the public RIGA dataset, ensuring a representative training sample. Vessel system segmentation is performed by a pre-trained W-Net model [22] trained on HRF [23] and DRIVE [24] datasets, with a two-stage process for vessel identification and subsequent artery/vein differentiation.\nClassification We utilize various classification models, including transfer learning of ResNet and DenseNet [25, 26] architectures, showcasing our system's flexibility. These models analyze the precise masks generated during segmentation to classify an exhaustive range of clinically relevant characteristics such as optic disk shape, artery caliber, macular reflex.\nThis modular approach strategically decomposes fundus analysis. Initial focus on localization improves interpretability and downstream model performance. Advanced U-Net variants enhance segmentation accuracy for precise analysis of subtle characteristics. Our flexible classification step enables adaptation to diverse diagnostic tasks, aligning with key aspects of the clinical workflow to facilitate medical expert verification and promote trust in the AI's outputs."}, {"title": "7 Verification and Validation", "content": "To ensure the efficacy and reliability of our proposed analysis pipeline, we implemented comprehensive validation and verification tailored to each stage of our three-step processing.\nValidation During training, each model's performance was monitored using established machine learning metrics [27] carefully selected for their relevance to each step. For segmentation tasks, we prioritized precision and Intersection over Union (IoU) due to the small proportional area of segmentation regions. In classification tasks, we utilize standard accuracy, along with per-class accuracy analysis to ensure the model performs well for both normal and pathological cases.\nVerification Validation alone is not enough to guarantee seamless integration of AI into clinical practice. We complemented our quantitative validation with a verification step focused on ensuring that the outputs align with clinical expectations and workflows. Medical professionals provided detailed feedback on the system's outputs, which informed iterative refinements to the models and user interface. Their insights ensured that the system's results were clinically relevant and aligned with diagnostic expectations, enhancing both accuracy and usability."}, {"title": "7.1 Performance evaluation", "content": "Figure 3 exemplifies the impact of our pipeline on classification accuracy. Here, we compare four ResNet-based models, all with similar architectures but adapted for different input formats. Validation was performed on a 20% split of our ONH dataset.\nImage and Local ONH These models take the full fundus image and the localized optic disk image, respectively. Their sub-optimal performance suggests that relying solely on raw image information may not be sufficient for optimal classification."}, {"title": "8 Conclusion", "content": "The development and implementation of the EYAS fundus image analysis system exemplify our innovative, clinician-centric approach to designing medical applications. By aligning closely with ophthalmological workflows and prioritizing interpretability and data quality, our system addresses critical needs in automated fundus image analysis.\nOur modular architecture, leveraging both deep learning and traditional computer vision techniques, demonstrates flexibility, scalability, and seamless integration into existing clinical practices. Positive evaluations by medical experts validate not only the technical efficacy of our system but also its clinical utility, underscoring the importance of collaboration between technologists and healthcare professionals.\nBy providing detailed fundus structure descriptions rather than relying on traditional screening approaches, we empower clinicians with comprehensive, objective insights that enhance diagnostic accuracy. Our approach bridges the gap between advanced AI technologies and clinical expertise, setting the stage for future innovations in medical AI applications.\nLooking ahead, our methodology offers a blueprint for developing AI systems in other medical domains. Emphasizing collaboration, interpretability, and workflow integration, we aim to facilitate meaningful adoption of AI in healthcare, ultimately improving patient care across various specialties."}]}