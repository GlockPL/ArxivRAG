{"title": "Brain Ageing Prediction using Isolation Forest Technique\nand Residual Neural Network (ResNet)", "authors": ["Saadat Behzadi", "Danial Sharifrazi", "Roohallah Alizadehsani", "Mojtaba Lotfaliany", "Mohammadreza Mohebbi"], "abstract": "Brain aging is a complex and dynamic process, leading to functional and struc-\ntural changes in the brain. These changes could lead to the increased risk of neu-\nrodegenerative diseases and cognitive decline. Accurate brain-age estimation uti-\nlizing neuroimaging data has become necessary for detecting initial signs of neu-\nrodegeneration. Here, we propose a novel deep learning approach using the Re-\nsidual Neural Network 101 Version 2 (ResNet101V2) model to predict brain age\nfrom MRI scans. To train, validate and test our proposed model, we used a large\ndataset of 2102 images which were selected randomly from the International\nConsortium for Brain Mapping (ICBM). Next, we applied data preprocessing\ntechniques, including normalizing the images and using outlier detection via Iso-\nlation Forest method. Then, we evaluated various pre-trained approaches\n(namely: MobileNetV2, ResNet50V2, ResNet101V2, Xception). The results\ndemonstrated that the ResNet101V2 model has higher performance compared\nwith the other models, attaining MAEs of 0.9136 and 0.8242 years for before and\nafter using Isolation Forest process. Our method achieved a high accuracy in\nbrain age estimation in ICBM dataset and it provides a reliable brain age predic-\ntion.", "sections": [{"title": "Introduction", "content": "Brain Aging is an ongoing process defined by neuroanatomical and biological changes\noccurring over time, resulting in a progressive Deterioration in the physical and mental\nfunctionality of the brain. Such changes consist of structural alterations in the brain,\nincluding changes in specific brain regions, reduced brain volume, and loss of neural\nconnections [1,2]. While the changes related to brain aging are not necessarily"}, {"title": "Subjects (Dataset)", "content": "All neuroimaging data utilized in this study, consisting of T1-weighted MRI scans,\nwere gathered from International Consortium for Brain Mapping (ICBM,\nhttps://www.loni.usc.edu/ICBM/) database [21]. The dataset is collected from healthy\nindividuals, with a gender distribution of 673 males and 673 females (male/female rate:\n1/1 and total: 1346). The ages of the participants range from 18 to 80 years, with a mean\nage of 36.21 and standard deviation of 14.82. Figure 1 displays examples of the neu-\nroimaging data used in this study."}, {"title": "Proposed Methodology", "content": "In the proposed method, the ICBM dataset is used to estimate the brain age of people\nbased on their brain images. In the paper method, due to hardware limitations, we use\n2102 different images randomly to provide us with a suitable modelling of the entire\ndataset. In this dataset, images are stored in MNC, DCM formats. Firstly, all images\nwere converted to PNG format to be a processable format for the OpenCV package.\nAfter converting the images format to PNG, the size of the images will be 224\u00d7224\u00d73.\nTo use images with Transfer Learning methods, all images must be converted to this\nsize to input the model. Nibabel and Pydicom packages were used to convert images\nfrom MNC and DCM format to PNG, respectively [22].\nIn the next stage, all images are normalized between zero and one. In the proposed\nmethod, 5-fold Cross-Validation method is used to ensure the correctness of evaluation\nmetrics. It is used to divide the data into training and test data. The proposed method is\nexecuted 5 times, and the average errors are reported as the final error. Also, all data\nare used to divide the data into training and test data.\nNext, outlier data should be identified. Low quality images can have a significant\nimpact on training the final model. For this purpose, we use the Isolation Forest method.\nThe number of dataset images before outlier detection was 2102 images. This number\nreduced to 1988 images after using the outlier detection method. In this way, 114 non-\ntrainable images were detected for the proposed model. So, they were removed from\nthe dataset.\nThe ResNet101V2 method is used in the model training section. This model is a pre-\ntrained model that we can give our own images to. In the training section, other pre-\ntrained models were also used to identify the best model. In this regard, ResNet50V2,\nMobileNetV2 and Xception models were used as well.\nTo train the ResNet101V2 model, ImageNet weights were set to the model. Then we\nuse a Global Average Pooling layer to reduce the size of the output images. The next\nlayer is a fully connected layer (Dense layer) with 1024 neurons. Having an extra layer\nat the end of the model can level up the model training with new data.\nSince the output of the model is a number that is related to the age of individual's\nbrain, there is a one-neuron layer as the output layer in the proposed model. In this\nmethod, we set the initial layers of the model as \u201cTrainable=False\" and set the last 10\nlayers of the model as \"Trainable=True\" so that in addition to the fully connected layer\nat the end, the last 10 layers of the model can also be trained with new images. Other\nmodel parameters are shown in Table 1. Keras package with Tensorflow backend is\nused to implement the pre-trained models.\nFinally, the test data is given to the model and the model makes its prediction from\nthe brain age of the people. Then the evaluation metrics are calculated according to the\nactual age of the people and the age predicted by the models. The results of this research\nshow that the proposed method is able to predict the brain age with a very low error.\nThe implementation process of the proposed method is described step by step below.\nAlso, Figure 2 shows the proposed method in a brief and step-by-step manner.\n0. Start\n1. Convert images (format and size)\n2. Pre-process images (Normalization between 0 and 1)\n3. Outlier detection (Isolation Forest)\n4. Split the dataset (5-fold Cross-Validation)\n5. Trian the model with our dataset (ResNet101V2)\n6. Predict the ages (test phase)\n7. Calculate evaluation metrics\n8. End"}, {"title": "Experimental Results", "content": "As previously noted in the article, the proposed method demonstrated strong perfor-\nmance. Table 2 illustrates the evaluation metrics for the proposed method based on the\nmean of 5 folds before using Isolation Forest method for four different pretrained meth-\nods. Based on the results, the accuracies of ResNet50V2, ResNet101V2, and Xception\nmethods were better than that of MobileNetV2 with MAEs of 1.1438, 0.8242, and"}, {"title": "Discussion", "content": "This section highlights some other state-of-the-art methods to provide a clearer com-\nparison with the proposed method. It is worth mentioning that the other leading meth-\nods used different datasets, and none focused exclusively on ICBM dataset. So, other\nresearch papers are listed in the table to provide a better insight into recent trends in\nbrain age estimation using machine learning algorithms.\nFor a direct comparison, Peng et al. used a SFCNN to predict brain age. Their results\nshow that they obtained one of the highest accuracies of brain age prediction. Peng et\nal. used UK Biobank data with 14503 subjects and they obtained an MAE of 2.17 years.\nMoreover, Ganaie et al utilized a ITSVR model to predict brain age. To train their\nmodel, the used 976 subjects and their model obtained a high performance, with an\nMAE of 2.77 years. In comparison, our proposed methodology seems to attain better\nperformance related to these two methods, with an MAE of 0.8242 years after using the\nIsolation Forest method. However, it should be noted that the number of dataset images\nthat we used in our model was 2102 from ICBM, which was different from these two\nmentioned methods.\nQuite similar to the size of our dataset images, Liu et al worked with a sample of\n2,501 healthy individuals collected from several public databases. They utilized MFN\nfor brain age estimation. Their model achieved a MAE of 3.73 years. Cole et al. also\nconducted a study using a sample of 2001 individuals acquired from the Brain-Age\nNormative Control (BANC) dataset. They applied a CNN model, achieving an MAE\nof 4.16 years. In addition, Popescu et al. used brain MRI scans from 3,463 healthy\nindividuals to train a U-Net model. In this model, they recorded a median mean absolute\nerror of 9.5 years. Here also, the results of our proposed method demonstrate higher"}, {"title": "Conclusion", "content": "In this study, we have developed a proposed methodology based on neuroimaging data\nthat can estimate brain age with high accuracy. We trained, validated and tested our\nproposed method by using 2102 different images which were chosen randomly from\nthe ICBM dataset. Besides, to guarantee the accuracy of the evaluation metrics, we\nutilized the 5-fold Cross-Validation method. Our results revealed that our proposed ap-\nproach can provide efficient and reliable performance for estimating brain age. It can\nalso be used as a biomarker to assist in diagnosing neurocognitive disorders. In reality,\nthe link between brain age and chronological age is not straightforward. In the future,\nwe will examine some other deep learning and nonlinear models to achieve and provide\na more precise prediction of brain age."}]}