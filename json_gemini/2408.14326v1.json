{"title": "Streamline tractography of the fetal brain in utero with machine learning", "authors": ["Weide Liu", "Camilo Calixto", "Simon K. Warfield", "Davood Karimi"], "abstract": "Diffusion-weighted magnetic resonance imaging (dMRI) is the only non-invasive tool for studying white matter tracts and structural connectivity of the brain. These assessments rely heavily on tractography techniques, which reconstruct virtual streamlines representing white matter fibers. Much effort has been devoted to improving tractography methodology for adult brains, while tractography of the fetal brain has been largely neglected. Fetal tractography faces unique difficulties due to low dMRI signal quality, immature and rapidly developing brain structures, and paucity of reference data. To address these challenges, this work presents the first machine learning model, based on a deep neural network, for fetal tractography. The model input consists of five different sources of information: (1) Voxel-wise fiber orientation, inferred from a diffusion tensor fit to the dMRI signal; (2) Directions of recent propagation steps; (3) Global spatial information, encoded as normalized distances to keypoints in the brain cortex; (4) Tissue segmentation information; and (5) Prior information about the expected local fiber orientations supplied with an atlas. In order to mitigate the local tensor estimation error, a large spatial context around the current point in the diffusion tensor image is encoded using convolutional and attention neural network modules. Moreover, the diffusion tensor information at a hypothetical next point is included in the model input. Filtering rules based on anatomically constrained tractography are applied to prune implausible streamlines. We trained the model on manually-refined whole-brain fetal tractograms and validated the trained model on an independent set of 11 test scans with gestational ages between 23 and 36 weeks. Results show that our proposed method achieves superior performance across all evaluated tracts. The new method can significantly advance the capabilities of dMRI for studying normal and abnormal brain development in utero.", "sections": [{"title": "1 Introduction", "content": ""}, {"title": "1.1 Background and motivation", "content": "Medical imaging techniques have played an increasingly prominent role in understanding the development of human brain in utero [1,2]. Imaging modalities such as magnetic resonance imaging (MRI) are also becoming more popular in studying brain abnormalities prior to birth [3,4]. As a consequence, fetal MRI has become an indispensable tool in medicine and neuroscience. Because the fetal period represents the most dynamic and most vulnerable stage in brain development, the potential medical and scientific impacts of fetal brain imaging are enormous.\nAmong various medical imaging modalities, diffusion MRI (dMRI) has emerged as a unique method for studying the fetal brain [5,6]. It offers important insights into tissue microstructure and structural connectivity that no other imaging technique can provide. Research on adult brains has extensively documented that the microstructure of brain white matter tissue is a unique indicator of normal and abnormal brain development [7,8]. Moreover, structural connectivity of the brain can influence and be influenced by the progression of brain diseases [9, 10]. These findings suggest that dMRI can play a crucial role in studying the fetal brain in-utero, where it undergoes its most formative developments. With technical advancements in fetal imaging [11,12], an increasing number of studies have analyzed the normal and abnormal development of fetal brain via tract-specific assessment of white matter [13]. Moreover, there is growing interest in quantitative assessment of brain's structural connectome in the fetal period [14,15]. Recent evidence suggests that the structural connectivity of the brain in utero can be altered by environmental factors and diseases. For example, prenatal exposure to maternal stress [16], congenital heart disease (CHD) [17], and brain malformations [15] may disrupt the normal development of the structural connectome in utero.\nDespite these unique potentials, dMRI-based assessment of the fetal brain has progressed very slowly. This is in large part because of a lack of reliable computational methods to automate the image data analysis. For analyzing adult brain dMRI data, there exists a repertoire of reliable computational tools [18-20]. For the fetal brain, similar tools are almost entirely nonexistent. This gap in technology has seriously limited our ability to tap the potential of dMRI to study brain's earliest and most critical developments. As an example, the only study to assess the impact of CHD on fetal brain white matter relied on manual tract delineation [13]. Because of the time and expertise requirements, that study was limited to one single tract and only a handful of subjects at one single gestational age. Automatic computational methods specifically tailored to fetal brain data can drastically enhance our ability to analyze larger fetal cohorts across the gestational age. Such tools can also reduce the cost and time requirements of these studies, increase the accuracy, and improve the reproducibility compared with manual annotations.\nThe goal of this work, therefore, was to develop and validate a new method for tractography of the fetal brain. Given the recent success of machine learning for this application [21, 22], our proposed method is based on a deep learning model that is trained on manually refined tractography data. If successful, such a method can dramatically improve the accuracy and reproducibility of quantitative fetal brain assessment with dMRI. It can enable precise automatic delineation of specific white matter tracts. Moreover, it can be used to reconstruct the structural connectome and to quantify the structural connectivity metrics in the fetal period."}, {"title": "1.2 Related works", "content": "Bundle-specific and whole-brain tractography are widely used for delineating white matter tracts, for studying the white matter as a whole, and for reconstructing the structural connectome [23-25]. Early tractography algorithms relied on elementary models of the diffusion signal to compute the local fiber orientations and were primarily intended for qualitative or visual purposes [26]. Over the past two decades, more advanced tractography algorithms have been developed [27-30]. A representative example of these advancements is the class of global tractography algorithms [25,31,32], which treat tractography as a global inverse problem. Additional non-local information, such as anatomical context and history of streamline propagation, are often used by these advanced methods to improve the accuracy and reduce the false positive rates. There have been multiple efforts by the dMRI community to rigorously assess the capabilities and limitations of modern tractography algorithms [33,34]. Some of the persistent challenges in tractography include fiber crossings and bottlenecks, inherent limitation of the dMRI data for inferring the local white matter fiber orientations, and paucity of ground truth data to develop and validate these methods [24,35].\nMachine learning may hold the key to addressing some of the perennial issues in tractography. A primary advantage of machine learning methods is their ability to integrate diverse sources of informa-tion, such as spatial information and anatomical priors. Classical non-machine learning tractography techniques can also incorporate such auxiliary information. However, it would be highly challenging to design those methods such that they optimally leverage different inputs. For example, the utility of different inputs likely depends on the streamline being traced and the position along the streamline. Conventional tractography methods do not have the capacity to learn such complex relations. Modern machine learning models such as deep neural networks, on the other hand, can learn these relations from training data. They can optimize their prediction objective with respect to different inputs much more effectively in a unified framework. Consequently, recent years have witnessed a growing interest in using machine learning for tractography. Reviews of these works can be found in [21,36].\nCompared with adult brain studies, in utero fetal brain tractography has been much less utilized. This has been mainly because of the challenges of fetal dMRI acquisition and analysis. Compared with adult dMRI data, fetal brain dMRI measurements have overall inferior quality due to such factors as lower signal to noise ratio and motion effects. Moreover, different white matter tracts emerge and develop rapidly over a short span of time during the second and third trimesters. Due to these challenges, most prior works on fetal tractography have focused on one or a few selected tract bundles and, yet, have reported low reconstruction success rates and limited accuracy in reconstructing the tracts in their complete spatial extent [37-41]. Despite these limitations, prior works have also demonstrated that tractography has a great potential for studying normal and abnormal brain development in utero and for"}, {"title": "1.3 Summary of the contributions of this work", "content": "This work presents the development and validation of the first machine learning approach to streamline tractography of the fetal brain. Our proposed method follows design principles that make it well suited to the challenging nature of fetal dMRI data.\nWe compute the local orientation of white matter fibers using a diffusion tensor fit to the dMRI signal. This enables the method to be used with typical dMRI scans that may not be suitable for determining complex fiber configurations. We use a neural network model, consisting of convolution and attention modules, to encode a large spatial context around the current streamline tracing point in the diffusion tensor image. In addition to the current streamline tractography point, we will also include the diffusion tensor information at a hypothetical next point. We also encode the information about the position of the current streamline point in the brain mask in terms of the distance to selected keypoints in the brain cortex. Moreover, similar to several existing methods, our model input includes the directions of recent streamline propagation steps. The tissue segmentation map is also encoded and fed to the model. Finally, we precisely align a spatio-temporal atlas of major fixels to the subject's brain and use that as additional input to the model. Our model synergistically combines these information to predict the next propagation direction.\nWe train the model on a set of whole-brain tractograms that have been manually edited and verified by human experts. Subsequently, we test our proposed method on a set of independent fetal brain scans. Our quantitative evaluations and visual assessments by an expert show that the proposed method achieves better results than a standard method and a machine learning technique. A comparison of our results with prior studies that have attempted tractography of the fetal brain shows that our results are vastly superior in terms of the range of white matter tracts that can be reconstructed and in terms of tract coverage. Therefore, our method represents a significant stride in improving the capabilities of dMRI for studying the brain in utero. The code will be available at https://github.com/liuweide01/MLFT."}, {"title": "2 Methods", "content": ""}, {"title": "2.1 Image data acquisition and processing", "content": "This study used retrospective MRI data collected from fetuses scanned at Boston Children's Hospital. Structural and diffusion MRI scans were collected from each fetus. The dMRI data was acquired at a single b-value of 500 and included between 24 and 96 measurements for each fetus. The raw data were processed with a well-tested fetal-specific preprocessing framework [46] to correct for fetal/maternal motion and align all dMRI data into a standard space.\nWe fitted a diffusion tensor model to the data in each voxel. We then converted the diffusion tensor in each voxel to the diffusion orientation distribution representation [47] and expressed it in spherical harmonics of order 8. As a result, the fiber orientation information in each voxel was represented with a vector of length 45. The reason for conversion from the diffusion tensor to diffusion orientation distribution was to facilitate the interpolation during tractography and to avoid the interpolation errors that may arise when working with tensors [48].\nWe used multi-atlas segmentation techniques to generate tissue segmentation and gray matter par-cellation maps for each fetus. For tissue segmentation, we used a manually segmented fetal diffusion tensor atlas [49]. For each fetus, we registered the tensor atlas to the subject using a diffusion tensor-based registration method [48]. For gray matter parcellation, we used a T2-weighted atlas of the fetal brain [50]. We registered the atlas image to the mean diffusivity (MD) image of the subject. In both cases, we registered the three atlases that were closest in gestational age to the subject. Subsequently, we applied a probabilistic label fusion method [51] to compute the final tissue segmentation and gray matter parcellation maps for the fetal subject. The tissue segmentation process involves classifying brain tissues into white matter, cortical gray matter, subcortical gray matter, and cerebrospinal fluid (CSF). These segmentations are essential for initiating and constraining the tractography process, especially for identifying and reconstructing complex white matter tracts.\nAfterward, an expert visually inspected the diffusion maps (MD and FA), tensor glyphs (to ensure the accuracy of the principal eigenvector's direction), and tissue segmentation maps for each subject, removing any poor-quality data or incorrect segmentation maps. A total of 73 subjects were deemed to have acceptable data quality, with 62 subjects allocated to the training set and 11 subjects to the test set.\nTo generate reference streamlines for model training, we applied a method based on streamline propagation using the iFOD2 algorithm [52]. Using the tissue segmentation maps, rules of anatomi-cally constrained tractography [27] were applied to the iFOD2-generated results to remove implausible streamlines. The final results were reviewed by an expert to ensure they did not include gross errors. Finally, whole-brain tractograms were reviewed by an expert to ensure that all major tracts were present and that no gross errors were included."}, {"title": "2.2 Method design", "content": "Figure 1 shows maps of diffusion tensors and corresponding color fractional anisotropy images for four fetuses at 24, 28, 32, and 36 gestational weeks. These examples show that estimates of local fiber orien-tation can be very noisy and, on its own, not adequate for accurately guiding the streamline propagation.\nTo overcome this challenge, in this work we adopted several strategies. We briefly describe these strategies here and explain them in greater detail in the following subsections. First, we designed our method such that it leveraged the diffusion tensor information in a large spatial context around the current streamline propagation front. Second, we introduced additional local and non-local information to guide the streamline propagation. These information included recent propagation directions, local tissue segmentation map, and distance to standard keypoints in the brain cortex. Lastly, we used a spatio-temporal atlas of major fiber orientations, registered to the subject brain, to give the tractography algorithm the expected orientation of major fiber pathways. These strategies were meant to reduce the reliance on the estimate of local fiber orientation and enhance the robustness of the tractography results to the unavoidable errors in voxel-wise diffusion tensor fit."}, {"title": "2.2.1 Fiber orientation information", "content": "The largest computational unit in our method consists of an encoder-decoder deep neural network based on convolutions and transformer blocks that encode the fiber information from the input diffusion tensor image. The input to this unit is the entire $128^3$-voxel image of diffusion orientation distribution computed from the diffusion tensor in each voxel. The image is divided into a set of $8^3$ non-overlapping 3D patches. The patches are vectorized and projected into an embedding space. After positional encoding [53], the sequence of embedded patches is processed by a set of 4 transformer blocks, each consisting of three transformer units with standard multi-head attention [53] and multilayer perceptrons. The design of the transformer blocks largely follows the vision transformer [54]. Skip connections involving transposed convolution operations provide shortcut paths between the encoder and decoder sections of the network. The output of the decoder includes feature maps at three different scales: $F_1(H,W, D, C_1)$, $F_2(\\frac{H}{2},\\frac{W}{2}, \\frac{D}{2}, C_2)$, and $F_3(\\frac{H}{4}, \\frac{W}{4}, \\frac{D}{4}, C_3)$, where $C_1$, $C_2$, and $C_3$ denote the number of channel at each level. In this work, we set $C_1 = 64$, $C_2 = 128$, and $C_3 = 256$. The highest resolution feature maps, $F_1$, include features computed with a set of convolutional operations applied directly on the input diffusion orientation distribution image.\nThe feature maps thus computed provide a rich encoding of the diffusion orientation distribution image. Because of the deep and multi-scale design of the network, at each point in the image space the feature maps encode information about fiber orientation distribution from a large spatial extent around that point. For tractography, these feature maps need to be interpolated at the arbitrary location of the current streamline propagation point. We accomplish this via trilinear interpolation based on the voxels within a 3 \u00d7 3 \u00d7 3 grid around the current point. Additionally, we use the values of the features at the centers of voxels within a 3 \u00d7 3 \u00d7 3-grid around the current tractography point. To avoid a cluttered schematic, these last features are not shown in Figure 2.\nAdditionally, we extracted features computed from the diffusion orientation distribution image at a hypothetical next point. Specifically, let us denote the current point with $p_i$ and the direction of the last propagation with $u_{i-1}$. We compute the hypothetical next point as $p_{i+1} = p_i + du_{i-1}$, where $d$ is the look-ahead step size that we set to 0.5 voxels in all experiments. In essence, $p_{i+1}$ would be the next streamline point if the current propagation direction were to be the same as the last propagation direction, i.e., if we keep propagating in the same direction. Similar ideas have been advocated for in prior works. For example, Tournier et al. use a similar mechanism to obtain a look-ahead view of how the fiber orientation distribution looks like in front of the streamline being traced [52]. We interpolated the feature maps extracted from the diffusion orientation distribution image at $p_{i+1}$ in a manner similar to that explained above for the current tractography point.\nThe features thus extracted from the diffusion orientation distribution image are concatenated and reshaped into a 1-D vector that is subsequently used, along with other inputs described below, by a multilayer perceptron (MLP) to compute the next propagation direction."}, {"title": "2.2.2 Global location within the brain", "content": "Another piece of information that we feed to the model consists of an encoding of the position in the brain mask. This information can be useful because similar patterns of local fiber orientation may exist in different parts of the brain and correspond to different white matter tracts. Encoding the global position of the current tractography point should be helpful in resolving such ambiguities and improving the reconstruction of different white matter tracts that may locally have similar shapes. Since the fetal brain grows dramatically, the challenge is how to achieve a consistent encoding of the position across the gestational ages. To address this challenge, we relied on brain parcellation labels. As mentioned above, we used the same parcellation scheme based on an existing spatio-temporal fetal brain atlas that covered all gestational ages [50]. We selected five specific parcellation regions from this atlas: (1) Left orbital part of the middle frontal gyrus, (2) Right insula, (3) Right inferior occipital gyrus, (4) Right middle temporal gyrus, and (5) Left inferior temporal gyrus.\nAs shown in Figure 3, these regions were selected to be non-coplanar and far apart from each other in order to provide an unambiguous encoding of all positions within the brain mask. Let us denote the center of mass of each of these parcellation regions with ${c_k}_{k=1:5}$. We calculated the Euclidean distance from the current streamline position $p_i$ to $c_k$ as $r_k = |p_i - c_k|$ and form a normalized vector of these distances as the position encoding vector $r_i$.\n$r_i = \\frac{ \\begin{bmatrix} r_0 \\\\ ... \\\\ r_5 \\end{bmatrix} }{ \\sum_{k=0}^{5} r_k }$\nThis vector $r_i$ is passed directly to the final MLP."}, {"title": "2.2.3 Streamline propagation history", "content": "An intuitively useful piece of information to guide the tractography is the streamline propagation history. This information has been used in some classical tractography algorithms as well. For example, Malcolm et al. used an unscented Kalman filter to combine the streamline propagation history and the dMRI signal at the current streamline point to estimate the next propagation direction [55]. Lazar et al., on the other hand, proposed a tensor deflection method that changed the propagation direction of an incoming streamline based on the shape of the diffusion tensor in the current voxel [56]. Leveraging the propagation history is also a common fixture of most machine learning-based tractography techniques. Poulin et al. [57] and Jorgens et al. [58] directly incorporated the normalized vector of prior propagation directions as input to their model. Similarly, Neher et al. [22] used the dot product of the prior direction as a weight for computing the next propagation direction in order to encourage alignment with the previous orientation. We have found that encoding the immediate prior propagation directions alone would make the model training difficult. Since most streamlines are locally very smooth, the immediate prior directions are often very close to the next target direction, making it difficult for the model to learn the small changes in direction between successive propagation steps. Hence, in our proposed method we skip some of the immediate prior steps and, instead, include earlier directions. Specifically, the propagation history that is used as input to our model includes $[u_{i-1}, u_{i-3}, u_{i-5}, u_{i-7}, u_{i-9}, u_{i-11}]$."}, {"title": "2.2.4 Tissue segmentation map", "content": "Streamlines are expected to start from brain gray matter, go through the white matter, and end in other gray matter regions. Therefore, segmentation of the brain tissue is highly informative for accurate tractography. Tissue segmentation maps are commonly used to reject anatomically invalid streamlines, for example, streamlines that prematurely stop inside the white matter or streamlines that cross voxels with cerebrospinal fluid (CSF). However, we think the tissue segmentation can be more effectively used to improve the accuracy of computing the propagation direction, rather than only for rejecting anatomically implausible streamlines. To this end, we use the tissue segmentation information in a small neighborhood around the current tractography point as input to our model.\nWe used a multi-atlas approach based on an existing diffusion tensor atlas of the fetal brain [49] to compute a tissue segmentation map for each fetal brain. We encode this information via a set of three learnable convolutional layers that compute three feature maps at different resolutions as shown in Figure 2. We interpolate these feature maps at the position of the current streamline tractography point and pass the computed feature vectors to the final MLP."}, {"title": "2.2.5 Spatio-temporal fixel atlas", "content": "Due to the remarkable inter-subject similarity in brain structures, atlases are widely used to improve, constrain, and regularize the neuroimaging data analysis algorithms. They have also been used in a few prior studies on adult brain tractography. For example, Durantel et al. [59] reconstructed a fixel atlas and used it as a prior to enhance the voxel-wise estimation of fiber orientation distribution (FOD). In each voxel, they computed an \"enhanced FOD\" using a weighted combination of the FOD computed from the dMRI signal and the fixel prior, where voxel-wise metrics such as generalized fractional anisotropy were used to compute a heuristic weight. The enhanced FOD was then fed to a standard (non-machine learning) tractography method. A similar approach was followed by [60], where the atlas (prior) and subject FODs were simply multiplied in each voxel. However, by using the atlas value in the current voxel only, these methods fail to fully exploit the information in the atlas.\nIn our method, we first reconstructed a spatio-temporal atlas of major white matter orientations in each voxel (i.e., fixels). The atlas was computed by applying these operations on the training data. (1) We computed whole-brain tractograms for each fetus. (2) Diffeomorphic diffusion tensor-based registration was used to align the tractograms for all fetuses of the same age into a common space. (3) Clustering algorithms were used to detect the directions of major fixels in each voxel based on the streamline directions in that voxel. Details of the method are described in [61]. We found that only 2% of the voxels contained more than two fixels. Therefore, in this work we used the directions of the first two fixels as additional input to our machine learning-based tractography model.\nFor each fetus, we register the age-matched fixel atlas using deformable diffusion tensor-based regis-tration. As shown in Figure 2, unlike prior works that have used a simple voxel-wise weighting of fiber orientations based on the atlas, we include the atlas information along with other information in our ma-chine learning method. In other words, our proposed method computes the next streamline propagation direction by including the fixel atlas as one among many sources of information. We encode the fixel atlas information in a manner quite similar to the encoding of the tissue segmentation map. Specifically, we compute three sets of convolutional features at three different scales. We interpolate these feature maps at the location of the current tractography point and pass the computed feature maps directly to the final MLP for predicting the next propagation direction."}, {"title": "2.3 Training procedures", "content": "Our training dataset included a total of approximately 9 million streamlines from manually refined tractograms of 62 subjects. Although this is a notably large number, our preliminary experiments showed that a straightforward training on this dataset produced overly smooth streamlines at test time and did not allow the model to reconstruct the tracts with more varying curvatures. A simple data augmentation approach to increase the diversity of the target propagation direction resolved this issue. To apply this augmentation, we assumed the streamline direction $u$ followed a von Mises-Fisher (vMF) distribution $u \\sim p(u; \\mu, \\kappa) = C(\\kappa) exp(\\kappa \\mu^T u)$. Here, $\\mu$ and $\\kappa$, respectively, denote the mean direction and concentration parameter of the distribution and $C$ is the normalizing coefficient. This is a standard model for representing distributions on the sphere and has been used in prior tractography works as well [62].\nMinimizing the negative log likelihood of the observed direction gives rise to a simple loss function of the form $-\\kappa (u, \\hat{u}) - \\log C$, where $(...)$ denotes the inner product. This formulation encourages the closeness of the predicted orientation with the target orientation while allowing for learned weighting of data with high uncertainty via modulating the loss term with $\\kappa$. In other words, for data with higher uncertainty (larger $\\kappa$) the model is allowed to make larger prediction errors by paying a higher \u201cuncertainty penalty\".\nIn the second loss term, $C$ is a function of $\\kappa$ and penalizes high uncertainties. This prevents degenerate training where the model computes high uncertainty for all data samples to reduce the first loss term. While $\\kappa$ may also be predicted by the model via including it in the loss function as explained above, in this work we use a heuristic approach to setting its value. Specifically, we set $\\kappa$ to be proportional to the square of fractional anisotropy: $\\kappa = \\alpha \\cdot FA^2$. We empirically set $\\alpha$ to 1600. Most white matter voxels in our data had an FA value in the range [0.05, 0.25], resulting in $\\kappa \\in [4, 100]$. For voxels with FA>0.20, which mostly represent voxels that are on major white matter tracts with little partial volume effect, $\\kappa > 64$. With the concentration factor $\\kappa = 64$, the 90% confidence interval around the mean direction in the vMF distribution is a cone of approximately 12\u00b0. For a voxel with FA=0.10, which corresponds to smaller or less developed tracts or borders of major tracts with substantial partial volume effect, $\\kappa = 0.16$ and the cone of 90% confidence interval around the mean direction has an angle of approximately 24\u00b0. Regions with higher FA generally represent the location of the major tracts with a single dominant fiber orientation, where the streamline propagation direction is less ambiguous. Regions with lower FA, on the other hand, generally represent the voxels with low dMRI signal anisotropy due to significant partial volume effects or crossing fibers. Streamline propagation direction in these areas is less certain, which justifies increasing the value of $\\kappa$. Having fixed $\\kappa$ based on FA, we use the cosine similarity between the predicted and target propagation directions as the loss function."}, {"title": "2.4 Implementation details", "content": "The proposed method was implemented using PyTorch and trained on an NVIDIA A6000 GPU. We used a large batch size of 16,000 to improve the training stability. We used a Stochastic Gradient Descent optimizer with an initial learning rate of 1e-3. Training was stopped when the training loss plateaued or began to fluctuate. In our experiments in this work, this usually happened after approximately 100 training epochs."}, {"title": "2.5 Application of the trained model on a test scan", "content": "Once the model training is complete, it can be applied to compute the whole-brain tractogram on a test subject. We use the tissue segmentation map for both streamline seeding and for rejecting implausible streamlines. Valid streamlines should begin and end at the boundary between gray matter and white matter. As shown in Figure 5, given the tissue segmentation map, we consider every voxel in the cortical gray matter that has at least one neighboring white matter voxel. We consider the vector between the centers of the gray matter voxel and that of the neighboring white matter voxel as the initial streamline propagation direction and launch a streamline in that direction. In order to increase the number and diversity of streamlines, we augment the position and direction of the streamline launch. We jitter the position of the seed point in the x, y, and z directions, uniformly, by [-0.6, 0.6]mm. We consider the initial direction in the spherical coordinate system with polar angle $\\theta$ and azimuthal angle $\\phi$, and add random values uniformly sampled from [-30, 30] degrees independently to $\\theta$ and $\\phi$.\nIn order to enhance reconstruction of different tracts with varying shapes, we adopted a probabilistic tractography approach. Similar to the model training stage, we used a vMF distribution with the concentration factor modulated based on the local FA ($\\kappa = \\alpha \\cdot FA^2$). Given the model's prediction of the next propagation direction $\\mu$, we sample a random direction $\\mu' \\sim vMF(\\mu, \\kappa)$ and propagate the streamline along $\\mu'$ by one step size. We use a step size of 0.6 mm, which is equal to half the voxel spacing in our data, in all experiments. We found that no single value of $\\alpha$ resulted in optimal reconstruction results for all tracts. While the setting $\\alpha = 1600$ was quite adequate for reconstructing tracts with large maximum local curvature such as some sections of the corpus callosum, it was not the best setting for some other tracts with lower curvature such as the corticospinal tract. Therefore, on a test scan, we apply the method with three different values of $\\alpha \\in [1600, 3200, 6400]$, to improve the reconstruction of various tracts. The final whole-brain tractogram for a test fetus is formed by simply merging the streamlines obtained with these three settings.\nAfter propagating the streamline along $\\mu'$ by one step size, the model is applied again to compute the next propagation direction. This process is continued as long as the next streamline point is inside the white matter segmentation mask. The propagation is terminated once the predicted next point is not inside the white matter. If the next point is on a cortical or sub-cortical gray matter voxel, the computed streamline is considered correct and it is added to the tractogram. If the next point is on a CSF voxel or outside the intracranial mask, the streamline is considered as anatomically implausible and rejected. Additionally, streamlines that exceed a length of 130 mm are discarded, as they exceed the expected maximum streamline length for the fetal brain."}, {"title": "2.6 Experiments and evaluation criteria", "content": "Assessment and comparison of tractography algorithms is notoriously difficult. In this work, we used both quantitative metrics and qualitative assessment by a human expert to evaluate the proposed method"}, {"title": "3 Results and Discussion", "content": "Depending on the brain volume, approximately between 60,000 and 220,000 gray matter voxels with at least one neighboring white matter voxel existed for each brain. We launched five streamlines from each seed point, resulting in approximately between 300,000 and 1,100,000 streamlines per brain. Approximately 40% of the computed streamlines were anatomically plausible based on the criteria described above, while the rest violated those criteria and were thus rejected. The retention rate of 40% for our machine learning method is vastly higher than the retention rate of approximately 1% for standard methods such as FACT that we have explored in this work. This suggests that the proposed method learns to compute more anatomically plausible streamlines, which not only improves the tractography accuracy but also reduces the computational time, the size of the tractogram, and the burden of subsequent tractogram post-processing."}, {"title": "3.1 Quantitative assessments", "content": "Figure 6 shows the results of quantitative evaluations in terms of DSC, precision, and recall. The plots in this figure show the summary of these metrics across all 11 subjects and all 9 white matter tracts. Our method achieved substantially higher DSC, precision, and recall than FACT and the two RNN baselines. While the mean and standard deviation of the DSC for our method was 0.711 \u00b10.027, for FACT, RNN, and Modified-RNN, respectively, it was 0.048 \u00b1 0.028,0.190 \u00b1 0.039, and 0.206 \u00b1 0.045. Our method achieved a mean DSC of above 0.60 (across the 9 tracts) and a mean recall of above 0.80 for each of the 11 test fetuses that covered the gestational ages between 23 and 36 weeks.\nFigure 7 shows the reconstruction accuracy for our proposed method and the compared techniques in terms of DSC, separately for each of the tracts. For the bilateral tracts, we have shown the results separately for the left and right tracts. This figure shows that the proposed method can achieve a mean DSC of close to 0.50 or higher for all tracts, which is highly satisfactory given the challenging nature of fetal tractography. Although a direct comparison of our results with experiments on adult brains is not possible, our results compare very favorably with recent studies on adult brain tractography [68]. Nonetheless, the figure also shows significant variability in the reconstruction accuracy for different tracts. The proposed method has achieved mean DSC values of well above 0.70 for certain segments of the corpus callosum (CC1 and CC2), CST, and some of the association tracts such as ATR and ILF. For other tracts such as OR and the splenium of the corpus callosum (CC7), on the other hand, the mean DSC is close to or below 0.60.\nThe variability in the reconstruction performance of the proposed method on different tracts may be attributed to at least three factors. First and foremost, being a machine learning technique, the performance of the proposed method is ultimately restricted by the accuracy of the training data. Our experience shows that the ability of the proposed method to reconstruct a tract depends directly on the presence and completeness of that tract in the whole-brain tractograms that were used in model training. As an example, compared with CC1 and CC2, the optic radiations (OR) was much less consistent in our training data. This has very likely contributed to the lower reconstruction accuracy for OR as shown in Figure 7. As another example, the observed lateralization of tractography results in Figure 7 may be a manifestation of the impact of training data. We had noticed that the training tractograms used in this work were in general more accurate in the right hemisphere than in the left hemisphere. We speculated that this was almost certainly due to the lower accuracy in the left brain hemisphere of the tissue segmentation maps that were used in computing the whole-brain tractograms for the training data."}, {"title": "3.2 Qualitative assessments", "content": "Figure 8 shows the results of expert ratings based on the scoring system presented in Table 1. This figure shows the summary of the scores across all 11 test subjects and all 9 white matter tracts considered in the assessments. On nearly 75% of the cases, our method received the highest score (Excellent reconstruction). This means that in the great majority of the cases, the tract reconstructed by our method precisely matches the expected anatomy with optimal streamline density and almost no spurious streamlines. In most of the remaining cases, the"}]}