{"title": "NO LOCATION LEFT BEHIND: MEASURING AND IMPROVING THE FAIRNESS OF IMPLICIT REPRESENTATIONS FOR EARTH DATA", "authors": ["Daniel Cai", "Randall Balestriero"], "abstract": "Implicit neural representations (INRs) exhibit growing promise in addressing Earth representation challenges, ranging from emissions monitoring to climate modeling. However, existing methods disproportionately prioritize global average performance, whereas practitioners require fine-grained insights to understand biases and variations in these models. To bridge this gap, we introduce FAIR-EARTH: a first-of-its-kind dataset explicitly crafted to examine and challenge inequities in Earth representations. FAIR-EARTH comprises various high-resolution Earth signals and uniquely aggregates extensive metadata along stratifications like landmass size and population density to assess the fairness of models. Evaluating state-of-the-art INRs across the various modalities of FAIR-EARTH, we uncover striking performance disparities. Certain subgroups, especially those associated with high-frequency signals (e.g., islands, coastlines), are consistently poorly modeled by existing methods. In response, we propose spherical wavelet encodings, building on previous spatial encoding research. Leveraging the multi-resolution capabilities of wavelets, our encodings yield consistent performance over various scales and locations, offering more accurate and robust representations of the biased subgroups. These open-source contributions\u00b9 represent a crucial step towards the equitable assessment and deployment of Earth INRs.", "sections": [{"title": "1 INTRODUCTION", "content": "Implicit neural representations (INRs) have experienced a rapid surge in popularity since the groundbreaking work of Mildenhall et al. (2020) first demonstrated their effectiveness in mapping complex 3D scenes to continuous functions. Fundamentally, early INRs were formulated as a function $f_\\theta: X \\rightarrow Y$ with sinusoidal activation and weights $\\theta$, where X is typically a coordinate space and Y is the target space (Sitzmann et al., 2020). The key enabling feature of this representation was the continuous support of $f_\\theta$, yielding resolution-independent representations.\nIn recent years, the versatility and advantages of INRs have made them increasingly attractive across diverse fields (Molaei et al., 2023; Chen et al., 2023; Ru\u00dfwurm et al., 2024). Unlike traditional discrete methods, INRs are essentially infinite-resolution models, enabling them to effectively handle signal-processing tasks involving sharp discontinuities or high variance features (Xu et al., 2022). Furthermore, they naturally excel in scenarios requiring differentiable representations, facilitating tasks such as gradient-based optimization in physics-informed machine learning (Raissi et al., 2017). The compact and flexible parameterization of INRs also offers substantial memory savings compared to grid-based methods, a critical consideration for any practitioner working with resource constraints (Liu et al., 2024).\nMore recently, INRs have made notable strides in Earth science applications, with transformative potential for pressing tasks such as climate modeling and environmental monitoring (Ru\u00dfwurm et al., 2024; Grana et al., 2021). While existing methods span various techniques such as observation-based networks (Palecki et al., 2013), satellite-based remote sensing (Sorooshian et al., 2014), and more recently, computer-based climate simulations (Geneva & Foster, 2024), these methods suffer from some combination of discretization error, data inconsistency, and resource-intensive inference (Allen et al., 2002). In contrast, the ability of INRs to learn nonparametric models from arbitrarily high-resolution, multi-modal data presents an efficient and promising alternative. Specifically, the use of INRs to learn the underlying dynamics of explicitly geospatial data has rapidly garnered interest (Cole et al., 2023). These methods encode the generative process and representation of the data through an implicit function, typically a Deep Neural Network (DNN), that maps spatial coordinates to data realizations (Hillier et al., 2023).\nHowever, as INRs transition into these realms of Earth science application, it is imperative to thoroughly evaluate the fairness and potential biases of these models. Skewed or unfair models in this domain can have far-reaching consequences, potentially amplifying existing societal inequalities or misallocating resources in vulnerable communities (Munday & Washington, 2018; Flores et al., 2022). For instance, two concrete instances of modeling bias in the Earth science and INR domains underscore the critical importance of fairness considerations:\n\u2022 Federal Emergency Management Agency (FEMA) flood maps, which rely on an ensemble of machine learning models for risk assessment, have been shown to systematically underestimate flood risk in lower-income neighborhoods (Flores et al., 2022).\n\u2022 Global climate models, including those used in the Coupled Model Intercomparison Project (CMIP), exhibit systematic errors in simulating precipitation patterns over Africa, consistently overestimating precipitation in southern regions while underestimating it in central regions (Munday & Washington, 2018).\nWhile such fairness concerns should evidently be top-of-mind, as of writing, there exist no systematic datasets to target such biases for implicit Earth representations. Hence, we introduce the first-of-its-kind FAIR-EARTH (Fairness Assessment for Implicit Representations of Earth Data) dataset, a comprehensive framework for evaluating and mitigating biases of implicit Earth representations.\nContribution 1: FAIR-EARTH comprises a diverse set of benchmark datasets representing a wide spectrum of Earth science signals, from global precipitation to carbon emissions (Section 3.2). Uniquely, it also includes a suite of methodologies and metadata designed to quantify disparities in model performance across different stratifications, setting it apart from existing datasets (Table 9). In essence, FAIR-EARTH unifies disparate existing geospatial datasets under a consistent framework, enriched with extensive metadata spanning fields such as geographical features (e.g., islands, coastlines), demographic information (e.g., population density) and geopolitical boundaries (e.g., country divisions)."}, {"title": "2 BACKGROUND", "content": "Fairness of Implicit Neural Representations Recent work has shown that optimizing solely for average test performance can have detrimental effects on sub-group performance in natural image classification tasks (Balestriero et al., 2022; Kirichenko et al., 2023). These findings raise natural concerns about potential fairness issues in implicit neural representations (INRs), particularly in the context of Earth data. For example, algorithms fine-tuned to low-frequency global signals may"}, {"title": "3 FAIR-EARTH: ALL-IN-ONE EVALUATION LIBRARY FOR EARTH DATA", "content": "The introduction of FAIR-EARTH, the first-of-its-kind dataset to target per-group performance, is highly motivated by both the natural tendencies of geospatial data and the well-studied biases of existing INRs. We first examine the specific inadequacies of existing datasets, and then outline the main contributions of the FAIR-EARTH dataset."}, {"title": "3.1 THE NEED FOR A FAIRNESS DATASET", "content": "The current landscape of Earth system datasets is not well-suited for the nuanced analyses described earlier. Commonly used datasets and benchmarks suffer from inherent limitations that can introduce or exacerbate biases. We point to two concrete examples below.\nThe Shuttle Radar Topography Mission (SRTM) land elevation model, despite its widespread use, suffers significant data gaps and inconsistencies in areas with steep terrain or dense vegetation (NASA Shuttle Radar Topography Mission, 2013). These gaps can lead to skewed representations of topographical features, potentially affecting critical applications such as flood risk assessment or infrastructure planning in vulnerable areas.\nThe Visible Infrared Imaging Radiometer Suite (VIIRS) nighttime lights dataset, often employed as a proxy for economic activity and urbanization, has limitations in detecting low levels of light emissions (Murphy et al., 2006). This shortcoming may underestimate activity in rural or underdeveloped areas, reinforcing existing biases in policy decisions.\nThese examples underscore a critical gap in the field: while existing datasets and Earth system models are clearly at risk of exhibiting biases across different stratifications, there is no established framework specifically designed to quantify these biases."}, {"title": "3.2 PROPOSED EVALUATION DATASET", "content": "To mitigate the limitations of some data sources highlighted in Section 3.1, FAIR-EARTH is based around several clean, accessible, and interpretable data modalities. Additionally, we collect a comprehensive suite of metadata to assess biases that may arise from both the data and representation model; this metadata lays the crucial groundwork for our novel fairness assessment of implicit Earth representations.\nLand-Sea Boundaries. Based on NASA's Integrated Multi-satellitE Retrievals for GPM (IMERG) dataset (Huffman et al., 2014), this component contains (Fig. 8) coarse signals like continental landmasses while also providing high-resolution boundaries for fine-grained signals such as islands and coastlines.\nCO2 Emissions. Using data primarily from NASA's Orbiting Carbon Observatory-2 (OCO-2) satellite, this component provides ultra fine-grained and precise information into carbon emissions (OCO-2 Science Team/Michael Gunson, Annmarie Eldering, 2020; O'Dell et al., 2018; Taylor et al., 2023). OCO-2 is the second high-precision CO2 satellite, and inaccuracies due to reflectance or cloud cover are mitigated via data assimilation. This high-resolution emissions data (Fig. 14) is crucial for environmental justice applications, for instance enabling researchers to identify localized pollution hotspots, or investigate correlations between emissions patterns and health disparities."}, {"title": "3.3 FAIR-EARTH LIMITATIONS", "content": "While the design choices for FAIR-EARTH facilitate subgroup-level fairness evaluations, they also yield certain tradeoffs. In particular, temporal and polar biases may manifest from the gridded format of FAIR-EARTH data; we later discover (4.3) that this format indeed induces bias in the training data. Given the agile framework of FAIR-EARTH, we strongly encourage practitioners to evaluate and incorporate their own datasets when necessary, and to adopt best practices in sampling to mitigate such biases."}, {"title": "4 MEASURING AND IMPROVING THE (UN)FAIRNESS OF IMPLICIT NEURAL REPRESENTATIONS", "content": null}, {"title": "4.1 EVALUATION OF EXISTING REPRESENTATIONS", "content": "Global Performance is not Representative of Local Performance To properly understand the behavior of existing INRs, we depart from hyperparameter fine-tuning, and instead perform extensive training over a cross-product of each model's hyperparameter space. This allows us to move"}, {"title": "4.2 SPHERICAL WAVELETS FOR FAIR EARTH REPRESENTATIONS", "content": "As explored in Section 2, a major limitation of SPHERICAL HARMONIC was their global support, which struggled to reconcile localized signals with global ones. In particular, SH required a large amount of basis functions to properly represent localized signals, and this excessive parameterization resulted in aliasing in other regions. The ad-hoc solution involving re-weighting subgroups depends on extensive labels; moreover, the effect on global performance is unknown (Stone et al., 2024).\nTo this end, we are motivated to leverage the theoretical guarantees of wavelets, which allow for multi-scale resolution analysis of signals, efficiently representing signals at various scales and locations. To extend towards Earth data, we refer to past work in Demanet & Vandergheynst (2003) that introduces spherical wavelet basis functions. Similar to the formulation in Eq. (1), any function on the sphere can also be approximated by a discrete sum of wavelet basis functions, where coefficients are similarly learned via the INR mechanism.\nThe following sections briefly outline the construction of a novel encoding mechanism SPHERICAL WAVELET, and its seamless integration into the currently studied INR pipeline. We direct interested readers towards McEwen et al. (2007); Demanet & Vandergheynst (2003) for analysis on the correctness of the construction, and towards A.5 for evidence that SW encodings are surprisingly more efficient and stable than their SH counterparts.\nSpherical Morlet Wavelet via Inverse Projection A concise, computationally tractable construction for spherical wavelets arises from inverse stereographic projection of Euclidean wavelets (Demanet & Vandergheynst, 2003). We note that due to the nature of this projection, the SPHERICAL WAVELET is ill-defined at the poles.\nAs proven in Sanz et al. (2006), this inverse stereographic projection $\\Pi^{-1}$ of an admissible Euclidean wavelet yields an admissible spherical wavelet; that is, the projected wavelet $\\psi(\\theta, \\phi)$ satisfies the"}, {"title": "4.3 SPHERICAL WAVELET EXPERIMENTS", "content": "SPHERICAL WAVELET Corrects Localized Biases To examine the biases present, we begin by analyzing the trends in training and evaluation. In particular, we leverage FAIR-EARTH and deploy a large cross-product of parameters ($N = 984$) to cross-validate algorithm performance between local signals and global signals over various configurations. As a baseline, we compare to results to [SPHERICAL HARMONIC, THEORY, and GRID AND SPHERE] encodings trained under identical settings, therefore isolating the effects of the encodings.\nWe observe a sharp contrast between the local-global correlation of our encodings; that is, SPHERICAL WAVELET learns to efficiently represent islands even at coarser resolution, therefore inducing a positive trend between global (land) and localized (island) performance, whereas our baseline encodings exhibit a tradeoff between global/local performance even for finer resolutions Section 4.1.\nSpecifically, in contrast to SPHERICAL HARMONIC, where finer features are often blended together (Fig. 1), SPHERICAL WAVELET has a significantly higher resolvable resolution for similar parameter counts. Especially in localized areas such as islands, our encodings tend to produce sharper, more fine boundaries compared to spherical harmonic encodings (Fig. 7).\nSPHERICAL WAVELET is Competitive with Existing Methods While our correlation analysis showed performance of SPHERICAL WAVELET exhibited fair and stable trends, we also seek to show performance is competitive with existing methods. First, we re-examine the previous experiment and compare general global performance of SPHERICAL WAVELET and SPHERICAL HARMONIC across well-defined hyperparameter spaces.\nIn general, we observe that the learned representation is similar to that of spherical harmonics, as indicated by the visual similarities in their learned representations (Fig. 7). However, SW in fact exhibits competitive or superior performance over SH through various training resolutions: we maintain significantly superior average performance across all training resolutions (Table 4).\nThe degradation in performance for SPHERICAL WAVELET for higher resolutions may be attributed to the misspecifications of certain parameters in our model (e.g. wave number, scaling factors).\nTo this end, we also evaluate fine-tuned performance on the temperature and precipitation regression tasks, observing more consistent performance: when properly parameterized, SPHERICAL WAVELET performs roughly on par with SPherical HarMONIC encodings across all FAIR-EARTH tasks (Appendix A.4)."}, {"title": "5 CONCLUSION", "content": "Measuring the fairness of implicit Earth representations is pressing yet lacking field in both the Earth science and implicit representation fields. Our contributions in measuring and improving certain biases in state-of-the-art INRs represents a step forward in this important direction. By introducing FAIR-EARTH, a novel framework for high-resolution assessment of subgroup-level performance, we aim to develop and assess models pertinent to the needs of practitioners, informing of existing biases and limitations of Earth models. Leveraging this new framework, our comprehensive assessment uncovers striking biases against certain subgroups across state-of-the-art INRs. Based on these observed performance disparities, we propose SPHERICAL WAVELET, injecting localized location encodings that are naturally motivated. Against the many benchmarks of FAIR-EARTH, we resolve many of the biases evident in SPHERICAL HARMONIC, while maintaining competitive performance.\nWe invite iteration and updates on FAIR-EARTH to improve the coverage of subgroups and signals, and stay relevant with changes and trends within the community. Additionally, given the limitations of SPHERICAL WAVELET, we hope further research can develop heuristics or structural changes to address these shortcomings; in particular, we point to the integration of non-projection based SPHERICAL WAVELET constructions as a promising direction for future work Sanz et al. (2006)."}, {"title": "A APPENDIX", "content": null}, {"title": "A.1 FAIR-EARTH DETAILS", "content": null}, {"title": "A.1.1 DATASET FIGURES", "content": null}, {"title": "A.2 TRAINING SPECIFICATIONS", "content": "Land-Sea Binary Classification Training We conducted a comprehensive ablation study to examine model trends on the land-sea binary classification task. The study was performed using a grid-search, and relevant parameters are available in Table 6. Note that the parameter sizes for encodings were chosen to be similar, to control for any effects from simple increase in embedding space.\nTo initialize training, we set identical data generation seeds for each model. Validation data was sampled similar to Fig. 16, but with $N_{validation}$ = $0.2 * N_{training}$ and different initialization seeds.\nFor fine-tuning, we perform a similar grid search over a similar continuous range of variables. The specific parameters are shown in Table 7. Due to the extra parameterization of SPHERICAL WAVELET, we quadruple the number of trials to 120, compared to 30 for all other encodings (Fig. 21).\nPrecipitation and Temperature Training Training over these environmental signals was nearly identical to training on the land-sea binary classification task. We note a couple of minor discrepancies:\n\u2022 Mean-squared error loss was applied to a normalized version of the data, as opposed to binary cross-entropy.\n\u2022 For the sake of precision and brevity, all precipitation losses in the paper are increased by a magnitude of 10. We emphasize that this doesn't affect our analyses."}, {"title": "A.3 MISCELLANEOUS FIGURES", "content": null}, {"title": "A.5 WAVELET NOTES", "content": "Computational Analysis A comparison of the computational requirements for SPHERICAL WAVELET and SPHERICAL HARMONIC encodings reveals a discrepancy in computational cost. Starting from our previous formulation, we define a family of valid wavelets as:\n{\\psi_{\\alpha,\\rho} = R(\\rho)D(\\alpha)\\psi_{\\Mu}}\nwhere the dilation operator D(a) is defined as: $[D(a)s](\\omega) = [\\lambda(\\alpha,\\omega)]^{1/2}s(\\omega_{1/a})$, with $\\lambda$ being a scalar-valued operator.\nThe rotation operator R requires only a transformation into Euler space and three 3 \u00d7 3 matrix multiplications. Since the generation of rotation points is a one-time computation, this yields a computational complexity that scales linearly with encoding size.\nIn contrast, the closed-form Spherical HARMONIC encoding with L Legendre polynomials requires calculation of:\n\\sqrt{\\frac{2l + 1}{4\\pi} \\frac{(l - |m|)!}{(l + |m|)!}} P_l^m (\\cos x)\nfor all m < l < L. This higher computational burden makes SPHERICAL WAVELET comparatively efficient for larger encoding sizes. Additionally, computational and representational challenges of the factorials lead to instability at higher L values (18), thus we restrict our analyses to L = 30.\nNon-Gabor Filters We extended our investigation beyond Gabor wavelets to include preliminary experiments with spherical Butterfly and Mexican Hat wavelets, applying the same procedure with different mother wavelets. However, visualizing these wavelets' projections on the sphere suggests they are poorly suited for general Earth signals (Fig. 24). In our experiments on the FAIR-EARTH land-sea classification task, these alternatives performed worse than Gabor wavelets and even certain baseline encodings when controlling for all other parameters (Fig. 25). Future research directions could explore which signals these filters might be better suited for, and whether wavelet-related adjustments to INRs (Saragadam et al. (2023)) could address their current limitations."}]}