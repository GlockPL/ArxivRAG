{"title": "EGR-Net: A Novel Embedding Gramian Representation CNN for Intelligent Fault Diagnosis", "authors": ["Linshan Jia"], "abstract": "Feature extraction is crucial in intelligent fault diagnosis of rotating machinery. It is easier for convolutional neural networks(CNNs) to visually recognize and learn fault features by converting the complicated one-dimensional (1D) vibrational signals into two-dimensional (2D) images with simple textures. However, the existing representation methods for encoding 1D signals as images have two main problems, including complicated computation and low separability. Meanwhile, the existing 2D-CNN fault diagnosis methods taking 2D images as the only inputs still suffer from the inevitable information loss because of the conversion process. Considering the above issues, this paper proposes a new 1D-to-2D conversion method called Embedding Gramian Representation (EGR), which is easy to calculate and shows good separability. In EGR, 1D signals are projected in the embedding space and the intrinsic periodicity of vibrational signals is captured enabling the faulty characteristics contained in raw signals to be uncovered. Second, aiming at the information loss problem of existing CNN models with the single input of converted images, a double-branch EGR-based CNN, called EGR-Net, is proposed to learn faulty features from both raw signal feature maps and their corresponding EGRs. The bridge connection is designed to improve the feature learning interaction between the two branches. Widely used open domain gearbox dataset and bearing dataset are used to verify the effectiveness and efficiency of the proposed methods. EGR-Net is compared with traditional and state-of-the-art approaches, and the results show that the proposed method can deliver enhanced performance.", "sections": [{"title": "1. Introduction", "content": "Bearings and gearboxes are critical components of rotating machines[1].\nThese machines often operate under varying speeds, loads, material condi-\ntions, maintenance procedures, and environments. Thus, performing effec-\ntive fault diagnosis for the equipment through vibrational signal analysis is\nchallenging and has received significant attention[2].\nIntelligent fault diagnosis based on deep learning (DL) has demonstrated\nimproved performance on fault classification. Many DL models such as\nCNNs [3][4], generative adversarial networks(GANs) [5], Deep Belief Net-\nworks (DBNs) [6], and transformers [7] are applied in fault diagnosis with\npromising results. Among those DL-based methods, the CNN model is de-\nveloped to imitate the concept of visual human object recognition. CNN's\nfeature extraction performance has been verified in many applications, such\nas image recognition [8] and video analysis [9]. There are two main categories"}, {"title": null, "content": "of CNN methods used in fault diagnosis depending on the dimensionality of\nthe input data: two-dimensional CNN (2D-CNN) for processing 2D data\nlike images[10], and one-dimensional CNN (1D-CNN) for processing 1D data\nsuch as vibrational signals [11]. For the 1D-CNN method, the 1D time series\ncan be input into the model directly [12]. However, compared with 2D-CNN,\n1D-CNN has certain disadvantages when applied to fault diagnosis. First,\nraw 1D vibrational signals are usually low separable, and learning features\ndirectly from the 1D signal is relatively inefficient [13]. Existing 1D-to-2D\nconversion methods in 2D-CNN models can improve the data separability\nand reduce redundancy. Second, the design of 2D-CNN is mature, and many\nwell-established 2D-CNN models are available in many research literatures.\nMeanwhile, the input dimension of 2D-CNN is usually smaller than the 1D-\nCNN in fault diagnosis, making the 2D-CNN easier to be designed. Thus,\n2D-CNN is studied in this paper.\nFor the 2D-CNN, the 1D vibrational signal is required to be converted\ninto a 2D feature representation using various signal processing methods. The\nraw signal contains the richest faulty information, but irrelevant information\nin the raw signal often limits its separability. The function of the 1D-to-2D\nconversion is that it can be regarded as an initial feature extraction procedure\nthat helps to enhance the convergence of the CNN model [14]. The merits\nof the conversion processing include that the converted 2D features usually\ncontain simpler textures, which are more representative than the raw signals.\nFor example, Wen et al.[15] transformed a 1D raw vibrational signal into the\n2D signal matrix through the tensor reshaping method. The obtained signal\nmatrices are then fed into the LeNet-5 model for bearing fault diagnosis."}, {"title": null, "content": "Similar to [15], Zare et al.[16] proposed a signal-to-image conversion method\nfor the wind turbine fault diagnosis. Shao et al. [17] employed the continuous\nwavelet transform as the input of the VGG-16 model with the transfer learn-\ning strategy. In [18], the bispectrum of raw vibrational signals is used as the\ninput of transfer CNN to diagnose the planetary gearbox. In [19] the cyclic\nspectral coherence (CSC) connects with a LeNet model for bearing fault\ndiagnosis because of its ability to exploit the second-order cyclo-stationary\nbehavior of bearing vibration signals. Tang et al. [20] introduced Gramian\nangular field (GAF) as the 2D representation of the vibrational signals and\nthen a 5-layer CNN model was designed to classify GAFs for the low-speed\nbearing fault diagnosis. Xiong et al. [21] proposed a similar Gramian matrix\n(SGM) based on dimensionless indices as the 2D representation input of the\nCNN for bearing fault diagnosis. Other representations for encoding time\nseries as images, including synchro-extracting transform (SET)[13], Markov\ntransition field (MTF) [22], and kurtogram [23], are also reported for the\nrotating machinery fault diagnosis.\nAlthough the abovementioned 2D-CNN models have achieved promising\nresults in various fault diagnosis tasks, there are still several problems that\nare not well solved. First, the existing representation methods for encoding\n1D signals as images have two main problems, i.e., complicated computation\nand low separability. Specifically, the calculations of the existing 1D-to-2D\nconversion methods are usually complicated and inefficient. If the calculation\nof the conversion needs a complicated algorithm and consumes huge computa-\ntional resources, then the conversion process may be unnecessary. Moreover,\nthe complicated 1D-to-2D conversion calculation breaks the end-to-end na-"}, {"title": null, "content": "ture of 2D-CNN. Furthermore, the 2D representation with low separability\ncontributes little to the subsequent feature learning and fault recognition.\nSecond, for those 2D-CNN fault diagnosis methods taking the converted 2D\nimages as the only inputs, the information loss resulting from the conversion\nprocess is not well considered. Although the key feature in 2D representations\nmay become more significant than the raw signals, certain critical informa-\ntion may be lost during the conversion. It is intriguing and meaningful to\nimprove fault classification performance by reducing information loss.\nAiming at the above issues, this article first proposes a new 1D-to-2D\nconversion method called Embedding Gramian Representation (EGR), with\neasy computation and good separability. Unlike the existing Gramian-based\nmethod GAF [20] defined in the real space, our EGR conducts Gramian in\nthe embedding space. Compared with the recently proposed SGM [21], our\nEGR does not need to calculate various dimensionless indices and has a less\ncomputational burden. For a given time series in real space, it is first pro-\njected into a state vector sequence in the timeline in the embedding space.\nThen the temporal correlations between all pairs of state vectors in the vec-\ntor sequence are calculated via inner product operation. The EGR method\ncan be implemented in two simple steps: the construction of the raw signal\nmatrix (RSM) and the calculation of the Gramian of the RSM. It is com-\nputational efficiently because the only calculation of the EGR algorithm is\nmatrix multiplication. The generated features are separable well because the\nEGR only stores the temporal correlation information, and the information\nredundancy is reduced significantly. For the periodic vibrational signal, its\nEGR demonstrates stripe texture. The EGR has a clear physical meaning"}, {"title": null, "content": "and explicit theoretical basis, and it can be easily embedded into the CNN\nmodel.\nFor the information loss problem of the commonly used 2D-CNN tak-\ning the converted 2D representation as the only input, a new double-branch\n2D-CNN model called EGR-Net is designed to learn features from the RSM\nfeature maps and EGRs simultaneously. In the EGR-Net, the RSM and\nEGR of the raw vibrational signal are processed by convolutional layers in\nparallel. The RSM contains original value information, and its corresponding\nEGR provides initial features with good separability. The proposed EGR-\nNet can reduce the information loss in existing models with a single input\nin an end-to-end manner. For making full use of the EGR, the bridge con-\nnection is innovatively introduced to improve the interactions between the\ntwo branches. Via the bridge connection, the feature maps of intermediate\nlayers in the RSM branch are converted into EGRs, which are then concate-\nnated in the EGR branch. The bridge connection design can further reduce\ninformation loss and strength the feature learning ability of the CNN model.\nThe main contributions of this paper are as follows:\n(1) This paper proposes a new 1D-to-2D conversion method called EGR\nfor capturing fault characteristics in raw vibrational signals. The proposed\nEGR is easy to calculate but can generate compact features with good sep-\narability. The EGR can reflect the temporal correlation information of the\nsignal and unveil the fault-related characteristics. Meanwhile, the physical\nmeaning of the EGR texture and the theoretical principle of the EGR are\nprovided. The parameter selection rules are discussed.\n(2) A double-branch CNN model termed as EGR-Net is proposed for"}, {"title": null, "content": "reducing the information loss problem of the traditional CNNs with a single\ninput. The RSM and EGR of the raw vibrational signal are the inputs of\nthe two branches of the 2D-CNN model. Especially, the bridge connection\nis designed for converting the feature maps of the intermediate layers in the\nRSM branch into EGRs and feeding them into the EGR branch. It enhances\nthe model feature representation ability remarkably.\n(3) EGR-Net retains the end-to-end nature. Different from most existing\n2D-CNN models for fault diagnosis, the operations for RSM and EGR in\nEGR-Net are only tensor reshaping and matrix multiplication, which can be\nperformed inside the EGR-Net model. Thus, EGR-Net accepts inputs of 1D\nsignals and gives outputs of fault classification results.\nThe rest of the article is organized as follows. The EGR and EGR-Net\nare described in section 2. In section 3, the proposed ECG-Net is applied\nto two datasets for verifying the merits. Comparisons with other traditional\nand state-of-the-art methods are also given in this section. Finally, the paper\nis concluded in section 4."}, {"title": "2. Methodology", "content": "In this section, aiming at the complicated computation and low sepa-\nrability problems of existing 2D representation methods, a new 1D-to-2D\nconversion method called EGR is introduced. In order to solve the infor-\nmation loss issue of conventional CNN models, based on the EGR method,\na double-branch CNN model termed as EGR-Net is proposed, in which the\nRSM and EGR are inputs of the two branches of the 2D-CNN model. A\nbridge connection between the two branches is designed to further improve"}, {"title": null, "content": "the model. In the following, the EGR and EGR-Net model will be provided\nin detail.\n2.1. Embedding Gramian Representation\nA new 1D-to-2D conversion method based on Gramian called EGR is pro-\nposed for the fault diagnosis. Considering that the time series x = {x(i)}, i =\n1, 2, ..., N with the length of N = mn is the vibrational signal measured on a\nrotating machine. The signal x can be regarded as the scalar sequence in the\nreal space R. It is natural to map the scalar sequence x into a state vector\nsequence in the embedding space Rm. Because there are N = mn data points\nin x, the number of state vectors in the sequence should be n. According to\nthe phase space reconstruction theory [24], the state vector sequence would\nbe a discrete trajectory in embedding space [25], and it can represent how the\ndynamic system evolves in time. The i-th state vector of the vector sequence\nis defined as\n$x_i = [x(i), x(n + i), x(2n + i), ..., x((m - 1)n + i)]^T$\n(1)\nThe vector sequence in the timeline can form a matrix:\n$X = [x_1, x_2, ..., x_n]$\n$x(1)$\n$x(2)$\n$\\cdots$\n$x(n)$\n$x(n + 1)$\n$x(n+2)$\n$\\cdots$\n$x(2n)$\n=\n$x(2n + 1)$\n$\\vdots$\n$x(2n + 2)$\n$\\vdots$\n$\\cdots$\n$x(3\\eta)$\n(2)\n$\\vdots$\n$x(mn)$\n$x(mn - n + 1)$\n$x(mn - n + 2)$\n$\\cdots$\n$x(mn)$\nThe matrix X contains all the original datapoints of the signal x, and\nwe call the matrix X as the raw signal matrix (RSM). The construction of"}, {"title": null, "content": "matrix X is similar to [15]. Wang et al. [26] proposed a time series represen-\ntation method named Gramian angular field (GAF), in which the temporal\ncorrelation within different time intervals is identified. Inspired by this work,\nGramian is adopted to calculate the temporal correlation between all pairs of\nstate vectors in the RSM X. The obtained temporal correlation can reflect\nthe dynamic characteristics of the signal x, and the Gramian G\u2208 Rn\u00d7n is\nexpressed as\n$G = Gram(X) = X^TX$.\n(3)\nThe symmetric matrix G is actually the EGR of signal x. Therefore, as\nshown in Fig. 1, the proposed EGR contains two steps, i.e., construction of\nthe raw signal matrix and calculation of Gramian of column vectors of the raw\nsignal matrix. To the best of our knowledge, this paper is the first literature\nthat takes the Gramian of the state vectors as the 2D representation of the\nvibrational signals.\nWhen bearings become faulty, the high-frequency resonance is evoked by\nthe generated impulses, and the fault characteristics can be reflected in the\nperiodic impulses [27]. For gearbox fault, a faulty point will also excite struc-"}, {"title": null, "content": "tural resonances and show substantial periodic property [28]. One question\nconcerned about is what the EGR would demonstrate for periodic vibrational\nsignals. To answer this question, the first thing needed to clarify the physical\nmeaning of each element in G\u2208 Rn\u00d7n. The EGR consists of scalar products\nof all pairs of points on the trajectory in the embedding space, and it reflects\nthe intrinsic structure of the trajectory. The G is a symmetric matrix, and\neach of its diagonal describes the correlation between the two state vectors\nwith the same time interval. The k-th diagonal of G is calculated as the\ninner product of xi and xi+k, that is $x_i^Tx_{i+k}$. For the main diagonal, it\ncorresponds to k = 0 and it would be $x_i^Tx_i$.\nAfter the physical meaning of G is explicated, the texture of G for peri-\nodic vibrational signals is then discussed. If the time series x = {x(i)},i =\n1, 2, ..., N has the period of T in real space R, then x(i) = x(i+T) is derived.\nThrough downsampling, it can be easily derived that x(in) = x(in + T).\nThen, x(in + j) = x(in + j + T) is obtained. Therefore, the state vectors\nwould satisfy xj = xj+T. That is to say, if the time series x is periodic in R,\nthen its state vector sequence is also periodic in the timeline in embedding\nspace Rm. As mentioned before, the k-th diagonal of the EGR representation\nis $x_i^Tx_{i+k}$, the values on diagonals would be larger when k = T. Theoreti-\ncally, the texture of EGR of x would demonstrate the light and dark stripe\ntextures on the diagonals, as shown in Fig. 1. This kind of texture generally\nis simpler than the original raw signal. According to our experiments, the\ndominated periodic frequency in EGR is consistent with the frequency spec-\ntrum peak with the highest power. Thus, it can be said that the 2D feature\nrepresentation using EGR is to capture the periodic dynamic fluctuations in"}, {"title": null, "content": "signals.\nThe other question concerned is how to determine the embedding space\ndimension m and the number n of state vectors in the vector sequence. For a\ndiscrete signal with fixed length N = mn, obviously, there is a trade-off be-\ntween m and n. Actually, there is no specific rule for the two parameters, but\nsome guidance can be given to determine them qualitatively. For the space\ndimension m, if m is small, the degree of statistical independence between\nstate vectors in X would decrease. The drop in statistical independence\nwould lower the quality of the correlation information in ECG representa-\ntion. However, if m is too large, then the state number n would be very small,\nwhich would lead to little correlation information that can be extracted by\nEGR.\nAs for the determination of the state vector number n, it is highly re-\nlated to the vibrational signal itself. Let fs denote the sampling frequency\nof signal x. It has been discussed that the texture of EGR should be stripes\nwith period T on diagonals. Actually, the period T is limited by the EGR's\nshape, which is n\u00d7n. It can be directly seen that the effective range of\nperiodic frequencies that ECR can reflect is from fs/n to fs. The low pe-\nriodic frequency below fs/n would not be illustrated as stripe texture in\nEGR representation. The larger n can enlarge the EGR's frequency range.\nFortunately, for the vibrational signals in the real world, the key information\nrelated to the fault is located in the high-frequency band. On some special\noccasions, the sampling frequency may be very high; it can be solved by\ndownsampling the signal to ensure that there are enough stripes in the EGR.\nExperimentally, the data length N of the signal sample is suggested to select"}, {"title": null, "content": "the even integral power of an integral number ranging from 1000 to 10000,\ne.g., N = 642 = 4096. Then the m and n can be determined as the square\nroot of the data length, that is m = n = 64.\nThe proposed EGR has four main important properties. First, the algo-\nrithm of EGR is simple and can be understood easily. The only calculation\ninvolved in EGR is matrix multiplication, which is computationally cheap.\nSecond, the EGR can capture the intrinsic periodic fluctuation. The ex-\ntracted features are fault-related and would show good separability. Third,\ncompared with the raw signal, the information redundancy in the EGR is\nreduced significantly. It means that the feature would be compact. Finally,\nthe simple computation of EGR makes it easy to combine EGR with the\nCNN model without breaking its end-to-end nature.\n2.2. EGR-Net\nIn 2D-CNN fault diagnosis methods, the 1D time-series signal needs to\nbe transformed into a 2D feature map. Except for the special cases of RSM\n(i.e., [15]), most 1D-to-2D methods based on complicated signal processing\nalgorithms improve feature representative ability at the cost of inevitable\ninformation loss. The recognition accuracy of the CNN model with the single\ninput of 2D representation would decrease if the lost information contained\nthe effective fault features.\nTo address this issue, the EGR-Net is presented. The basic Gramian\nconvolutional block (GCB) of EGR-Net is shown in Fig. 2. The 1D signal\nx is first converted into RSM X and EGR G. Then, a convolutional layer\nis used to obtain the corresponding feature maps. To mitigate the gradient\ndiffusion and improve the generalization, batch normalization (BN) [29] is"}, {"title": null, "content": "adopted to reparametrize feature maps adaptively. The feature maps after\nBN cascade the activation layer. Rectified linear unit (ReLU) [30] is used\nto avoid saturation and gradient vanishing compared with other activation\nfunctions such as sigmoid and tanh. The output of the convolutional layer\ncan be expressed as\n$X_h = ReLU(BN(w * X + b))$\n$G_h = ReLU(BN(w * G + b)),$\n(4)\nwhere denotes the convolution operation, w represents the kernels, b is\nthe bias, BN is the batch normalization, and ReLU is the ReLU activation\nfunction.\nNext, the EGRs of feature maps Xh of RSM X are calculated and then\nnormalized using layer normalization (LN) [31], it can be written as\n$XG_h = LN(Gram(X_h)).$\n(5)\nThe XGh is then concatenated to the feature maps Gh of EGR G through\nchannels as the block output of the EGR branch. Meanwhile, the feature\nmaps Xh are the block output of the RSM branch. The outputs of the block\ncan be written as\n$X = X_h$\n$G_o = Concat([G_h, XG_h]).$\n(6)\nThe Eq. (5-6) describe the bridge connection between the two branches. The\nEGR-Net can learn features not only from the EGR of the raw signal, but\nalso from the feature maps of intermediate layers of the RSM branch."}, {"title": null, "content": "The EGR-Net can be obtained by stacking GCBs. Supposed that there\nare l GCBs in the network, and let the outputs of a GCB be\n${X_o, G_o} = GCB ({X, G}) .\n(7)\nThus, the outputs of the last GCB are written as\n${X_o', G_o'} = GCB (GCB...GCB ({X, G})).\n(8)\nThe learned feature maps (i.e., Xo' and Go') from the RSM branch and EGR\nbranch are concatenated into a united feature map set through channels, and\nit is expressed as\n$O = Concat([X_o', G_o']).$\n(9)\nIn order to mitigate overfitting and improve generalization [32], global\naverage pooling (GAP) is used for obtaining the final feature vector y, that\nis\n$y = GAP(O).$\n(10)\nFollowed by a fully connected layer with SoftMax as the classifier, the fault\nclassification results can be derived by finding the index with the maximum"}, {"title": null, "content": "probability. It is expressed as\n$Q_j = wy^j + b$\n$P_j = \\frac{exp(Q_j)}{\\sum exp(Q_i)},$\n(11)\nwhere w and b are the weight matrix and bias, respectively. y denotes feature\nvector of the jth class, Pj represents the possibility of the input x belonging\nto the class j. The cross-entropy (CE) loss between predicted values and\nground truth values in training data can be calculated as\n$Loss = - \\frac{1}{N} \\sum \\hat{P}_j \\log P_j$\n(12)\nwhere N is the number of samples, and Pj is the ground truth. The gradient\nof loss can be calculated and backpropagated to update the parameters in\nthe whole model.\nCompared with the existing CNN models, EGR-Net has the following\ncharacteristics. First, the double-branch structure ensures that the network\nlearns from the highly separable features without information loss. The first\nbranch is designed to extract original value information from RSM without\ninformation loss. The second branch is responsible for extracting effective\ninformation from the EGR. The EGR is more separable than RSM and can\nboost the convergence in the model training. Second, the bridge connection\nlinking the two branches ensures that all the EGRs of the RSM feature\nmaps in the intermediate layers can be used for feature extraction. The\nEGR feature maps and the generated EGRs from RSM branch enhance the\nfeature fusion."}, {"title": "2.3. The Structure of the EGR-Net", "content": "The detailed structure of the EGR-Net is provided in Table. 1. From\nthe table, it can be seen that there are a total of seven layers in the model,\nincluding five GCBs, one GAP for feature vector generation, and one SoftMax\nlayer as the classifier. For the GCB layer, the kernel size, channel, and stride\nof its convolutional operation are the main concerned hyperparameters. The\nkernel sizes are set as 5, and the channels are set as 32 in the first two GCB\nlayers. The reason why large kernel size and small kernel number are used\nis that firstly the feature map in the bottom layer usually has a larger size,\nwhich needs a larger local receptive field for the feature learning. Second,\na small kernel number will balance the increased computational complexity\ndue to the large kernel size. The third to fifth GCB layers adapt kernels\nwith the size of 3. The kernel numbers of the third and fourth convolutional\nlayers are 64, and the fifth is 128. It is because the feature maps become\nsmaller when the network goes deeper, and more kernels can ensure that\nmore valuable features can be extracted. It should be noted that the model\ntakes inputs of 1D signal in practical implementation. The reshaping and\nmatrix multiplication calculations of RSM and EGR are processed inside the\n2D-CNN model. Thus, the EGR-Net is an end-to-end model."}, {"title": "2.4. The Overall Framework of the Proposed Method", "content": "In this paper, an intelligent fault diagnosis method for rotating machinery\nis proposed. The flowchart of the proposed method is given in Fig. 3. The\nsteps of the framework are summarized as follows:\nStep 1: Data collection. Mount the accelerometer near the key compo-\nnents (i.e., bearings or gears) and record vibrational signals from the sensors"}, {"title": null, "content": "vibrational signal into a series of samples containing specific data points.\nDivide the signal samples into the training set and the test set.\nStep 3: Data conversion. Normalize the training samples and convert\nsamples into RSMS and EGRs successively.\nStep 4: Training the EGR-Net model offline. Feed the RSMs and EGRS\ninto the EGR-Net model for training. The CE loss between ground truth and\npredicted label is calculated and minimized by the gradient descent optimiza-\ntion method, and the model weights are updated by the backpropagation\nalgorithm.\nStep 5: Fault diagnosis online. The new vibrational signals from the\nmachine are processed the same as the samples during training. The output\nprobability distribution of the deployed trained model gives the health states\nof the monitored equipment."}, {"title": "3. Experimental Validation and Discussion", "content": "In this section, the experimental setting is first given, then a widely used\ngearbox dataset and a bearing dataset are used to verify the effectiveness\nand efficiency of the EGR and the EGR-Net model.\n3.1. Experimental Setup\nThe proposed EGR-Net is implemented using Python 3.6 based on Ten-\nsorFlow 2.4.1 platform. The training and testing processes of the model are\nrun on RedHat 4.8.5 operating system with GeForce RTX 2080Ti GPU. The\nraw signal matrix is normalized using the method proposed in [33], in which\nthe mean value is first subtracted from the raw signal, then the zero-mean\nresult is divided by the variance. The loss function in the training process is"}, {"title": null, "content": "cross-entropy. Adam algorithm [34] is selected as the optimizer. The batch\nsize is set as 32, and the model runs 50 epochs. In order to accelerate the con-\nvergence, a large learning rate is used in the beginning stage of the training,\nand then we reduce it. Here, the initial learning rate is set as 0.0001, then\nthe learning rate decrease to 0.1 times of the previous one every 15 epochs.\nWe will make the source code public for the convenience of reproducing our\nresults by other researchers.\nClassification accuracy is the commonly used indicator of reflecting the\nperformance of a model. In this paper, the accuracy is defined as\n$Accuracy = \\frac{TP+TN}{TP+TN + FN + FP} \u00d7 100%$,\n(13)\nwhere TP, TN, FN, and FP are the number of samples which are true\npositive, true negative, false negative and false positive, respectively[33].\nThe test rig can simulate the faulty characteristic of machines, but the\nvibrational signals collected from the real-world machines usually work in\nharsh environments on the strong noise background. Therefore, the white\nGaussian noises with different signal-to-noise ratios (SNRs) are added into\nthe raw vibrational signals to simulate the noise disturbance. The SNR (dB)\nis defined as\n$SNR = 10log_{10} (\\frac{P_{signal}}{P_{noise}})$\n(14)\nwhere Psignal and Pnoise are the power of the signal and the noise, respectively[33].\n3.2. Case Study 1: Fault Diagnosis of Sun Gear Unit\n3.2.1. Dataset Description\nThe gearbox fault dataset is provided by Tang et al. [35] from University\nof Connecticut (UCONN). This dataset has been adopted by many published"}, {"title": null, "content": "works for experimental verification [36] [37]. As shown in Fig. 4, nine fault\ntypes, including missing tooth, root crack, spalling, and chipping tip with\nfive damage degrees, were seeded in the input shaft pinion (tooth=32). The\ndifferent fault types of the dataset are summarized in Table. 2. The vibra-\ntional signals measured by the accelerometer are recorded under the sampling\nfrequency of 20kHz.\nIn this dataset, each health condition contains 104 signals with the length\nof 3600. The size of RSM is set as 60 \u00d7 60, and the size of EGR should there-\nfore be 60 \u00d7 60. There are 104 \u00d7 9 = 936 samples in total. Moreover, the\nfirst 50% of the samples (i.e., 52 samples for each health condition) are used\nfor training, and the rest 50% are used for testing. The raw signal matrices\nand EGRs of nine health conditions are illustrated in Fig. 5. The textures of\nRSMs are relatively irregular. However, after the EGR conversion, the differ-\nences between different fault types become clear. The light and dark stripe\ntextures also appear in the EGRs of gear vibrational signals. For different\nkinds of gear faults with Several severe degrees, the modulated frequencies\nand amplitudes in raw signals vary, which leads to different patterns in EGRs.\nCompared with the raw signal matrices, EGRs can provide simpler and more\nsignificant representations, which will raise the subsequent feature learning.\n3.2.2. Separability of EGR on Gear Fault Diagnosis\nIn order to evaluate the effectiveness of the EGR on fault diagnosis, the\nseparability of the EGR under background noise (SNR=0dB) is investigated.\nSix 1D-to-2D conversion methods adopted in recent fault diagnosis works,\nincluding kurtogram [23], bispectrum [18], cyclic spectral coherence (CSC)\n[19], Gramian Angular Summation Field (GASF), Gramian Angular Differ-"}, {"title": null, "content": "ence Field (GADF) [20], and Markov transition field (MTF) [22] are used for\nthe comparative analysis. The separability of the EGR is verified and visu-\nalized by t-SNE [38]. The raw vibrational signals (SNR=0dB) are converted\ninto 2D representation by the seven methods and then visualized by t-SNE\ndirectly.\nThe t-SNE visualizations of different 2D representations of the test set\nare shown in Fig. 6. The figure shows that the features of the introduced\nEGR are clustered with the best compactness, and the nine classes have the\nclearest boundaries in all seven 1D-to-2D conversion methods. However, the\nseparation of the kurtogram between the fault classes is not good because\ndifferent classes overlap severely. Meanwhile, bispectrum can discriminate\nclass 3, class 4, and class 5 from the nine classes, but other classes show\nrelatively dispersed. The CSC's separability is better than bispectrum and\nkurtogram, and it can distinguish most classes except class 1 (health con-\ndition). Nevertheless, the concentration degree of CSC is much lower than\nEGR. The GASF, GADF, and the MTF are proposed by Wang et al.[26].\nAlthough the GASF and the GADF are also based on Gramian, the Fig. 6\n(e) and (f) show that the generated features are inseparable at all. The clus-\ntering of MTF looks better than GASF and GADF, but it is still not as good"}, {"title": "3.2.3. Fault Diagnosis Results Analysis and Visualization", "content": "In order to assess the fault diagnosis performance of the proposed EGR-\nNet, experiments under four different SNRs (i.e., -6dB, -4dB, -2dB, and 0dB)\nare conducted. To reduce randomness from noise adding and model training,\nfive trials for each SNR situation are run, and detailed classification accuracy\n(%) results on the test set are shown in Table. 3. For each run, the accuracy\nof the classification is calculated as Eq. (13). The mean value and standard\\"}]}