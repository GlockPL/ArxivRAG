{"title": "Expanding the Medical Decathlon dataset: segmentation of colon and colorectal cancer from computed tomography images", "authors": ["I.M. Chernenkiy", "S.R. Mustakimova", "N.A. Ushakov", "Y.A. Drach", "V.V. Kazantseva", "S.K. Efetov", "M.V. Feldsherov"], "abstract": "Colorectal cancer is the third-most common cancer in the Western Hemisphere. The segmentation of colorectal and colorectal cancer by computed tomography is an urgent problem in medicine. Indeed, a system capable of solving this problem will enable the detection of colorectal cancer at early stages of the disease, facilitate the search for pathology by the radiologist, and significantly accelerate the process of diagnosing the disease. However, scientific publications on medical image processing mostly use closed, non-public data. This paper presents an extension of the Medical Decathlon dataset with colorectal markups in order to improve the quality of segmentation algorithms. An experienced radiologist validated the data, categorized it into subsets by quality, and published it in the public domain. Based on the obtained results, we trained neural network models of the UNet architecture with 5-part cross-validation and achieved a Dice metric quality of 0.6988 \u00b1 0.3. The published markups will improve the quality of colorectal cancer detection and simplify the radiologist's job for study description.", "sections": [{"title": "1 Introduction", "content": "Colorectal cancer (CRC) is the third most common cancer in the Western Hemisphere, and its incidence increases with age. Metastasis to regional lymph nodes is a defining characteristic of CRC. Up to 20% of patients have metastatic disease, with the most frequent localization of metastases in the liver [1]. In addition to population aging and dietary habits in high-income countries, unfavorable risk factors such as obesity, lack of physical activity, and smoking increase the risk of CRC. [2]. Prior to treatment, multislice computed tomography (MSCT) with intravenous contrast is employed to diagnose colorectal cancer and assess the stage of tumorigenesis. MSCT also enables the physician to conduct surgical planning. The degree of tumor process spreading is determined according to the TNM classification system, which categorizes tumors based on the number of layers they have grown into the intestinal wall (T), whether regional lymph nodes are affected by metastases (N), and whether the tumor process has spread to other organs and systems (M) [10]. Automatic segmentation of the colon and its neoplasms would improve the process of surgical planning."}, {"title": "2 Research review", "content": "Artificial intelligence (AI) applications have transformed numerous industries and are widely used in a variety of consumer products and services. In medicine, Al is mainly used for image classification and natural language processing, with the potential to impact image-related specialties such as radiology, pathology, and gastroenterology (GE) [3]. Currently, the diagnostic performance of colonoscopy remains unsatisfactory with unstable accuracy. The convolutional neural network system (CNNS) has demonstrated its potential to assist endoscopists in improving diagnostic accuracy. Colorectal cancer has a high incidence rate worldwide, yet early detection significantly improves survival rates. [4] However, there are a number of limitations to the CNN system and controversy over whether it provides better diagnostic performance compared to human endoscopists [2, 5].\nFor the automatic segmentation of radial imaging modalities, the UNet architecture is the most commonly utilized neural network system (CNNS) [11]. The authors of [8] collected 1131 marked 2D images of colon tumors with a resolution of 0.779x0.779x5mm\u00b3 from 158 multispiral computed tomography (MSCT) studies of patients. The UNet model was trained on these 2D slices, resulting in a Dice metric of 0.7089.\nTo consider the spatial location of an object, a three-dimensional image can be employed as input data. For instance, the authors of the paper [7] proposed the use of the Deep Colorectal Coordinate Transform (DeepCRC). Given that the colon has a single pathway and continuous structure extending between the blind colon and rectum anatomically, the authors suggest that a regression task could be employed as an additional training task. Each voxel of the colon is assigned a number between zero and one, with zero representing the location coordinate of the rectum and one representing the location coordinate of the blind colon. This transformation enabled the researchers to achieve a Dice metric value of 0.862 for the colon and 0.646 for colorectal cancer.\nMagnetic resonance imaging (MRI) may also be performed on a patient to detect colorectal cancer. The authors trained a neural network based on 450 MRI studies that segments colon cancer with a Dice metric of 0.55 [12].\nThe collection and verification of data for computer vision in medicine is a labor-intensive process. A comprehensive dataset with colorectal and colorectal cancer markups could not be identified in the public domain. One of the most widely used datasets is a collection of abdominal MSCT studies in NifTi format from the open-source medical dataset \"Medical Decathlon\" [6]. One of the tasks in this dataset involves the storage of 126 CT images with colorectal cancer markups. A larger dataset of 1204 CT images with markups of 104 anatomical structures is also available [13]. Of these, 842 images have fully labeled colorectal masks with a resolution of 1.5x1.5x1.5mm\u00b3, but lack labeling of colorectal pathologic changes. The objectives of this study are twofold: firstly, to create a dataset comprising colorectal and tumor markers, and secondly, to assess the efficacy of colorectal markers in the detection of colorectal cancer. Our contribution is to extend the Medical Decathlon dataset [6], which is available at the following link:\nhttps://gitflic.ru/project/sechenovntc/mde_colon_segmentation."}, {"title": "3 Materials and methods", "content": "A dataset of abdominal MSCT studies in NifTi format from the open-source medical data repository Medical Decathlon [6] was utilized. To expedite the partitioning process, the MONAILabel plugin of the MONAI framework within the 3D Slicer program was employed. A model from [13] was leveraged as a trained model for colon segmentation. All false positives were manually removed by the authors of the aforementioned paper. Subsequently, a radiologist with 15 years of experience conducted a validation process, wherein the boundaries of the colon markup were verified on each slice. The existing colorectal cancer markings in the dataset remained unaltered. Validation by a radiologist reduced the size of the validated dataset to 122 studies. In this case, the 122 studies were categorized into three subsets based on the quality of the data: The \"good\" subset comprises 100 studies, while the \"bad\" subset contains 17 cropped studies (in which the entire colon is not visible on the image). The \"bad\" subset comprises five studies. Two of these studies were of poor quality and could not identify the entire colon. Two further studies involved colon stomas following surgery, while one study involved a hernia. Four studies were excluded from the set due to broken images, with axial plane images duplicated or the slice order mixed. All subsets are publicly available. However, in the future, we will only use the \"good\" subset for model training. The \"bad\" subset can be used in the future to expand the training sample, but it is not recommended to validate colon segmentation. Only the \"good\" subset is suitable for validation, as it has all segments of the colon highlighted in it."}, {"title": "3.2 Method", "content": "The UNet neural network architecture was employed in this study. It was compiled using the Medical Open Network for AI (MONAI) library function.\nAs illustrated in Figure 1, the architecture is structured according to the principle of encoding and subsequent decoding of input data. Each level of encoder is associated with a specific set of convolutions, contingent upon the dimensions of the signal convolution kernel and the number of executed layer combinations.\nThe gray color indicates the principle of the residual signal, which is the original signal added to the signal transformed in the hidden layers of perceptron neurons.\nThe diagram also depicts a dropout layer, which randomly zeros out certain parts of the signal. This layer improves the generalization of the model by facilitating its transferability to data other than that on which it was trained.\nIn the context of medical data segmentation, where the objective is to identify a specific structure or region of interest within an image, the Dice loss function is employed to quantify the discrepancy between the predicted and true segmentation masks.\nTo enhance the quality, we employed the deep supervision approach [14]. Additionally, at each encoder level, we reduced the size of the original image mask to a smaller mask size. The proximity measure was performed with the reduced mask size to the required size at that level. Consequently, the loss function takes the form:\n$C(\\hat{y}, y) = L_{DCE}(y_0, y_0) + \\sum_{i=1}^{n} L_{DCE}(y_i, \\hat{y}_i)$ where $C_{DCE} (x, y) = L_D(x, y) + C_{CE}(x, y)$ - where $L_D$ \u2013 Dice loss function \u0438 $C_{CE}$ is the cross-entropy loss function, $y_i$ \u2013 true segmentation mask for i-th layer, $\\hat{y}_i$ \u2013 is the predicted mask for the i-th layer.\nIn this study, a stochastic gradient descent (SGD) optimizer with Nesterov's impulse method [15], weight reduction of 3e-5, and a training step of 0.001 were utilized, with a reduction in the training step by a factor of 10 occurring at 625 epochs. The number of epochs was set to 1250. During the training phase, a batch size of two was generated with a cut region of size [160, 160, 96] voxels from a randomly selected location in the image with a resolution of 1.5x1.5x1.5x3 mm\u00b3.\nThe PyTorch 1.13 framework and the MONAI 1.2.0 library were employed to train the model. The experiments were conducted on a machine with an NVIDIA Tesla V100 graphics card.\nPrior to uploading the MSCT images to the trained neural network, data preprocessing was conducted by normalizing the images. This involved calculating the mean, standard deviation, and percentiles of 0.5 and 99.5 across the entire dataset, based on the voxels belonging to each class. Subsequently, the intersentile values were clipped within the percentile interval, followed by subtraction of the mean value and division by the standard deviation. In the training phase, the following augmentation techniques were employed to enhance the model's generalizability:\n1) Mirroring. This operation mirrors one of the planes with a probability 0.5.\n2) Athenic transformation. With a probability 0.2, the transformation rotates and scales a tensor.\n3) Gaussian noise. With a probability 0.2, Gaussian noise is added to the tensor.\n4) Sharpness change. With a probability of 0.2, the image is sharpened.\n5) Intensity Scaling. With a probability of 0.15, the intensity of the tensor is modified within the range [0.75; 1.25].\n6) Contrast change. With a probability of 0.1, the contrast of the image is altered by a coefficient in the range [0.7; 1.5].\nFor purposes of comparison with other methods, we undertook an analysis of the work of Isensee et al. [16], which we refer to as nnU-Net. This method has gained considerable popularity in the academic community for its application to medical image processing. In addition, we have access to pre-trained models on colorectal cancer segmentation from the Medical Decathlon dataset [6], which will allow us to assess the impact of adding a new class on segmentation quality.\nA five-fold cross-validation procedure was employed on the \"good\" subset to obtain the results presented herein."}, {"title": "4 Results", "content": "The optimal mean value of the Dice metric was 0.6988 \u00b1 0.3.\nWe attempted to utilize blocks with residual connections, yet they yielded inferior outcomes relative to the simple Unet with classical block Convolution+Normalization+Activation. Additionally, LayerNorm [17] and GroupNorm [16] were employed in place of InstanceNorm [18]."}, {"title": "Case review", "content": "In this section, we aim to illustrate the efficacy of the proposed method through the presentation of a single case. We will provide metrics for both cases and formations. As metrics for demonstrating the case, we include metrics for comparing 3D regions. These include the Dice-Sorensen metric, the Hausdorff distance (which measures the largest distance between the boundaries of the true and predicted masks), and the average surface distance (which measures the average distance between the boundaries of the true and predicted masks)."}, {"title": "5 Conclusion", "content": "The Medical Decathlon dataset was augmented with colon markups based on publicly available data. Subsequently, experiments were conducted to train Unet-type architectures, resulting in an average Dice metric value of 0.6988\u00b10.3. This represents the first public dataset with colon tumor and colon MSCT images. The marker data and code are available for download at the following link:\nhttps://gitflic.ru/project/sechenovntc/mde_colon segmentation.\nConflict of interests. The authors declare that there is no conflict of interest.\nFinancial support. The study was not sponsored (it was funded by the authors' own resources)."}]}