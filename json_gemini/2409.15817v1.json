{"title": "SwiftDossier: Tailored Automatic Dossier for Drug Discovery with LLMs and Agents", "authors": ["Gabriele Fossi", "Youssef Boulaimena", "Leila Outemzabet", "Nathalie Jeanray", "St\u00e9phane Gerart", "S\u00e9bastien Vachenc", "Joanna Giemza", "Salvatore Raieli"], "abstract": "The advancement of artificial intelligence algorithms has expanded their application to several fields such as the biomedical domain. Artificial intelligence systems, including Large Language Models (LLMs), can be particularly advantageous in drug discovery, which is a very long and expensive process. However, LLMs by themselves lack in-depth knowledge about specific domains and can generate factually incorrect information. Moreover, they are not able to perform more complex actions that imply the usage of external tools. Our work is focused on these two issues. Firstly, we show how the implementation of an advanced RAG system can help the LLM to generate more accurate answers to drug-discovery-related questions. The results show that the answers generated by the LLM with the RAG system surpass in quality the answers produced by the model without RAG. Secondly, we show how to create an automatic target dossier using LLMs and incorporating them with external tools that they can use to execute more intricate tasks to gather data such as accessing databases and executing code. The result is a production-ready target dossier containing the acquired information summarized into a PDF and a PowerPoint presentation.", "sections": [{"title": "1. Introduction", "content": "Drug discovery is an expensive, lengthy, and high-risk pro-cess. The process can cost up to $ 1-2 billion and takes an av-erage of 10-15 years [19]. The failure rate of a drug candidatein clinical trials reaches 90 % (with a higher rate if preclinicalstages are also considered). Among the main causes that canbe identified are: lack of clinical efficacy, toxicity, and poorpharmacokinetic and pharmacodynamic properties [9, 8, 5]. Inrecent years, the development of new artificial intelligence al-gorithms has been extended to various fields, including biomed-ical science. The large availability of available data means thatthe pharmaceutical sector can be a perfect playground for AI[10, 17]. The development of these algorithms promises torevolutionize drug discovery and ameliorate the process froma target to a drug on the market. Drug discovery is a com-plex, multi-step process; AI looks promising in most steps [4,1, 18]. At the same time, a cautionary approach is requiredbecause the capabilities of an AI model depend heavily on thedata with which it is fed. For these promises to be fulfilled,AI approaches must be rigorous and based on quality data [30].Large Language Models (LLMs) have become the main direc-tion of artificial intelligence in recent years and have shownremarkable generalist skills. LLMs have also shown promisingcapabilities for different scientific tasks and also in the biomed-ical field [54, 25]. There has been considerable effort to adaptthese models to the needs of the medical and at the same timepharmaceutical fields [11, 50]. One of the main problems withthe use of LLMs in the pharmaceutical field (and more broadlyin the biomedical field) is the generation of hallucinations bymodels [32]. LLMs can generate outputs that are inaccurate orthat contain factually incorrect information. At the same time,they can generate extrinsic hallucinations (claims that cannotbe verified) such as quotes that cannot be verified. Anotherproblem that affects their use is that these models are generalistby nature and are not often adapted to the domain of interest[34]. In addition, the architecture of LLMs (transformer deriva-tive) does not easily and not expensively allow ingesting newknowledge (as well as making it difficult to correct previouslyacquired erroneous knowledge) [29, 27]. The first step in thetarget discovery process is generally target identification andselection. Once a target has been identified, the target dossier isone of the most widely used tools for evaluating the goodness-of-fit of a target [6, 20]. The target dossier comprehensivelypresents all the information that experts need in the decision-making process. A target dossier is an essential tool that mustpresent information about the target, its impact on the disease,pros and cons, therapeutic opportunities, and potential competi-tors. The dossier preparation process requires extensive time inresearching and analyzing different sources. Automating it willsave considerable time and help in standardization. For appro-priate decision-making, the target dossier must contain correct,up-to-date, and verifiable information. For this reason, it is notpossible today to use a classical LLM alone for this task.\nIn this technical report, we show how it is possible to use anLLM to create an automatic target dossier. Our system that em-ploys both Agents and retrieval augmented generation (RAG)allows us to overcome the limitations highlighted above. Thesystem, given a target (gene name) and a pathology of interest,automatically generates a target dossier (a summary PDF doc-ument) and a PowerPoint presentation. The system retrieves"}, {"title": "2. Related Work", "content": ""}, {"title": "2.1. LLM hallucinations", "content": "Hallucinations are considered among the most importantchallenges for LLM deployment in biomedical or drug dis-covery [54]. Hallucinations can occur when models producetexts that include details, facts, or claims that are either fic-tional or misleading [32]. In addition, LLMs are capable to-day of producing content that sounds plausible and based onscientific patterns they learned during training. In some cases,it has been seen that an LLM is capable of generating pseudo-citations that can further confuse the reader. Hallucinations area real problem, especially for those disciplines where a patternmust necessarily be factually correct (e.g. healthcare) [54]. Itis not easy to be able to correct this behavior because there aredifferent types of hallucinations each with probably a differentcause [41]. For this reason, several approaches have been de-veloped to mitigate hallucinations in the outputs produced byLLMs [51]. Some techniques are based on the idea of provid-ing the model with the necessary context to be able to answera question. Retrieval-augmented generation (RAG) allows theLLM to access authoritative, external information, especiallywhen the answer is not present in the parametric memory ofthe model [46, 43]. In contrast to other methods such as fine-tuning the computational cost is much lower and it is possibleto integrate new information easily [40]. However, naive RAGoften has limitations (pre-retrieval, retrieval, and post-retrievalissues) [43] so numerous add-ons have evolved [43]. At thesame time, finding an effective strategy to create an advancedpipeline of RAGs is an expensive and time-consuming process.One of the sore points of RAG is especially to make sure that allrelevant documents are found. In the biomedical field, the exactanswer can be directly found in specialized databases. For thisin recent times, Agents have been used where complex reason-ing is required, thus allowing LLMs to control different toolsand query different databases via API [53]. In this work, weuse both RAG and Agents to interact with databases."}, {"title": "2.2. Domain adaptation and continuous learning with LLMs", "content": "LLMs acquire most of their knowledge during pretraining.Once pretraining is over, it is difficult to ingest new knowledgewithin the model. This can be done by fine-tuning. However,this is an expensive and inefficient process that would have to berepeated every time the model update is to be conducted [37].In addition, LLM struggles to integrate this new knowledge.Recent studies show that fine-tuning increases the model's ten-dency to hallucinate [44]. Second, the LLM tends to forget theold knowledge, and there arises at the same time the discrep-ancy between the remaining old knowledge and the new knowl-edge with the risk of bias and unintended association [27]. RAGand Agents present a possible solution to these problems. It isnot necessary to conduct parameter editing of the LLM but thenew knowledge needed is found in real-time and provided incontext to the model. Moreover, in several databases the infor-mation is rigorously cataloged and annotated, allowing filteringof irrelevant information."}, {"title": "2.3. LLM for target dossier", "content": "To the best of our knowledge, there is currently no systemthat creates an automatic target dossier. LLMs have been pro-posed for various uses in drug discovery pipelines. For exam-ple for molecule optimization, drug-drug interaction, molecularproperty predictions [38, 28, 52]. On the other hand, in severalbiomedical tasks, generalist LLMs perform poorly [47]. Thereare, however, studies that show that it is effective to extend thecapabilities of models with the use of tools. ToolLLM and Hug-gingGPT are examples where an LLM is connected with differ-ent APIs or can call other models to perform different tasks [33,31]. GeneGPT connects an LLM with external APIs from theNational Center for Biotechnology Information (NCBI) [45].The system shows superior capabilities in GeneTuring bench-mark vs. other generalist or trained models on biomedical tasks.MedAgents is another framework that shows the superior capa-bilities of an agent-based system for medical tasks [35]. Thecapabilities of these systems show the goodness of an approachno longer based only on one LLM but with the integration ofother tools."}, {"title": "3. Materials and methods", "content": ""}, {"title": "3.1. Data", "content": "A target dossier includes a large variety of information, span-ning from insights about a specific target gene to details aboutthe disease, and includes sections in which reasoning is cru-cial. To this end, several data coming from different sourcesare needed, in order to have a comprehensive view of the targetand allow the LLM to perform high-level reasoning. The datasources and tools employed in this work are listed in Table 1.The specific sources used are specified in both the target dossierPDF and PowerPoint as well. We used reference citations to al-low us to track back which sources are used for each sectionand slide. For example, when the LLM is using the RAG, theidentifiers (Pubmed ID) of the article in the context are notedin the document. In the PowerPoint in the notes are stored the"}, {"title": "3.2. Models", "content": "We decided to use in this work open-source LLMs. Manyopen-source models differ in architecture and number of pa-rameters [39, 48]. Thus, different LLMs were compared(Mistral-7B-instruct, Qwen-1.5-7B-Chat, Orca 13B, Gemma-7B-instruct, Mistral-8x7B-instruct), focusing on the quality oftheir answers to a specific set of questions and their efficiencyin token generation. All the assessed models produced good answers, withMixtral-8x7B-Instruct excelling in this task. However, beinga big model, it was slower compared to the other ones. An opti-mal trade-off between effectiveness and efficiency was Mistral-7B-Instruct [21] which was picked and used in our work.\nLLMs contain a substantial amount of information but highlyrely on the data that has been used to train them [49]. To expandtheir internal knowledge by integrating retrieval-based mem-ories, it is possible to leverage Retrieval-Augmented Genera-tion (RAG) [13]. RAG is particularly useful in domain-specificapplications, especially in the biomedical domain as describedabove.\nOur RAG framework incorporates reranking and HybridSearch methodologies, with the embedding model fine-tunedto enhance search effectiveness. Specifically, we utilized bge-base-en [36] for this purpose. The model was fine-tuned usinga synthetic dataset about pancreatic cancer generated by Qwen7B [22]. Regarding the reranking model, mxbai-rerank-largewas selected. Both these models are relatively small, makingthem suitable to execute RAG dynamically.\nThe information that is used for RAG and is provided ascontext for Mistral 7B is gathered from two different sources:PubMed abstracts and PMC articles. The abstracts are short,"}, {"title": "3.3. System Description", "content": "The process begins with the user inputting a query that is re-lated to the generation of a target dossier. Both the target andpathology of interest need to be specified. In this work, we fo-cused on pancreatic cancer, which is a deadly disease that needstherapeutic options [26]. The query is directed to the Agentwhich has different tools at its disposal. These tools allow theAgent to connect to multiple databases and extract the relevantinformation. They enable the Agent to:\n\u2022 Execute Python code to connect to the APIs, process data,and generate plots,\n\u2022 Retrieve images from the databases,\n\u2022 Generate texts and summaries using the LLM integratedwith the RAG system described previously.\nOnce all the information has been retrieved, it is aggregatedand compiled into the target dossier, producing both a PDF anda PowerPoint presentation. The PDF is generated before thePowerPoint since the latter consists of an encapsulated versionof the PDF. The system is summarized in Figure 2."}, {"title": "3.4. Technical Requirements", "content": "This work revolves around three main plat-forms/applications: HuggingFace [12], LangChain [16]and Chroma DB [55]. HuggingFace is the platform that weused for model loading and usage since it provides a widevariety of pre-trained models that can be easily accessed.LangChain is the framework that we employed to developthe Agent starting from the LLM and for the creation of thetools. An advantage of using LangChain is that it allows aneasy integration with HuggingFace. Finally, as a database toimplement our RAG system, we used Chroma DB. It allows thestorage of the document embeddings and their retrieval duringthe RAG process. These tools were used through version3.11.5 of Python. The system was run on 8 Tesla V100 GPUs,each with 32GB of memory."}, {"title": "4. Results", "content": ""}, {"title": "4.1. RAG adaptation to drug discovery domain", "content": "To evaluate the effectiveness of RAG, the answers of threedifferent models were compared: the LLM without RAG, theLLM with the base RAG, and the LLM with our RAG systemillustrated in Section 3.2. The answers were evaluated by GPT-4 which was specifically prompted to assign a score to eachanswer according to 4 metrics (faithfulness, relevance, quality,completeness, and correctness). 75% of its scoresare equal to or greater than 4 for every metric. Moreover, itsmedian is 5 and is greater than the median of the other twomodels which is equal to 4.\nOne question and the models answers are illustrated in Ta-ble 2.\nThe answer of the model without RAG is entirely incorrectsince it fails to understand that pancreatic ductal adenocarci-noma (PDAC) is the subject of the question. Instead, it dis-"}, {"title": "4.2. Automatic Target Dossier", "content": "In this study, we focused on pancreatic cancer, one of the can-cers with the most dismal prognosis. To date, pancreatic cancerpresents few therapeutic opportunities and is in dire need of newdrugs for treatment [14]. To show the system's capabilities, wechose KRAS, one of the genes with the greatest impact on thedisease and of interest as a potential target [3, 2, 15, 7]. How-ever, the system is generalizable and can therefore be used withany gene and any pathology. Choosing another gene and an-other pathology, the system will search for the necessary infor-mation. The output of the system is the target dossier, generatedas two different files: a PDF and a PowerPoint presentation.It isdivided into four main sections. The first one (containing mostof the information) comprises details about the target of interestsuch as its characteristics, expression, and mutations. The sec-ond section is related to the cancer for which we are evaluating"}, {"title": "5. Conclusion", "content": "Our work demonstrates two key findings. Firstly, we showedhow the employment of RAG can help increase the quality ofthe answers in drug discovery applications. Indeed, the LLMwithout RAG lacks knowledge about the biomedical domainand can generate off-topic answers that are unrelated to the sub-ject of the question. Moreover, the exploitation of a more ad-vanced RAG system determines an additional enhancement inthe quality of the responses, due to an improved retrieval pro-cess. Regarding the generation of the automatic target dossier,we showed how it is possible to integrate the LLM with sometools that allow it to perform more complex actions such as ac-cessing databases, executing Python code, and compiling allthe retrieved information into a PDF and a PowerPoint presen-tation. We show a system capable of creating production-readydocuments and presentations and can have a valuable impact onthe work in drug discovery.\nToxicity and lack of clinical efficacy are among the maincauses of molecule failure. A detailed target dossier evisceratesthe role of a gene in pathology, and potential adversarial effectshelping in predicting these critical causes of failure. Indeed, inthe target dossier, there are sections devoted to both potentialtoxicity and the role the gene plays in disease physiology andpathogenicity, aiding in decision-making. So, our second find-ing is that an AI model can generate a consistent document and"}]}