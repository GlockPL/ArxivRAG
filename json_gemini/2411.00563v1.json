{"title": "Simulate and Optimise: A two-layer mortgage simulator for designing novel mortgage assistance products", "authors": ["Leo Ardon", "Benjamin Patrick Evans", "Deepeka Garg", "Annapoorani Lakshmi Narayanan", "Makada Henry-Nickie", "Sumitra Ganesh"], "abstract": "We develop a novel two-layer approach for optimising mortgage relief products through a simulated multi-agent mortgage environment. While the approach is generic, here the environment is calibrated to the US mortgage market based on publicly available census data and regulatory guidelines. Through the simulation layer, we assess the resilience of households to exogenous income shocks, while the optimisation layer explores strategies to improve the robustness of households to these shocks by making novel mortgage assistance products available to households. Households in the simulation are adaptive, learning to make mortgage-related decisions (such as product enrolment or strategic foreclosures) that maximize their utility, balancing their available liquidity and equity. We show how this novel two-layer simulation approach can successfully design novel mortgage assistance products to improve household resilience to exogenous shocks, and balance the costs of providing such products through post-hoc analysis. Previously, such analysis could only be conducted through expensive pilot studies involving real participants, demonstrating the benefit of the approach for designing and evaluating financial products.", "sections": [{"title": "1 INTRODUCTION", "content": "Designing financial products for assisting homeowners during mortgage related financial distress is a complex task due to the intricacies of the mortgage system. Traditionally, such development has relied on conducting human pilot studies to analyse the effectiveness and impact of such products in vivo. However, such pilot studies are typically expensive and as a result, are limited to small-scale analysis, restricting the exploratory capabilities. To address these issues, a way to conduct such analysis in vitro is needed.\nThis paper introduces a computational approach to optimise and evaluate novel mortgage assistance products using a two-layer reinforcement learning (RL) and simulation structure. In this approach, the outer (product) layer is responsible for optimising or selecting new product configurations, while the inner (simulation) layer employs agent-based simulation to assess the impact of these product configurations in a simulated mortgage environment. With this approach, we can conduct extensive large-scale analysis across a range of products in vitro. The benefits of the simulation are twofold: First, simulation enables the evaluation of a broader range of product configurations across different scenarios, at a significantly faster pace and substantially lower cost compared to traditional studies. Second, we can introduce and evaluate these products in a controlled setting, mitigating the risk of introducing potentially harmful financial products into the real market. The simulation serves as an exploratory platform before performing studies or introducing products in vivo.\nThe specific contributions of the paper are:\n\u2022 A novel two-layer approach for optimising products through multi-agent simulation\n\u2022 An extension of a mortgage servicing ABM ([11]) with a more robust representation able to perform counterfactual analysis through product conditioned policy learning\n\u2022 A generic parameterised financial product configuration compatible with the conditional policy learning\n\u2022 Analysis into the financial resilience of households and costs of providing cover under different product configurations\nThe remainder of the paper is organised as follows. Section 2 provides an overview of related work and background to the area. Section 3 introduces the novel two-layer approach. The impact of different mortgage assistance products is analysed in Section 4. Discussion and conclusions are presented in Section 5."}, {"title": "2 BACKGROUND AND RELATED WORK", "content": "Several agent-based models (ABMs) have been developed for analysing housing markets [2, 3, 7, 12, 18]; however, these models have fixed behaviour rules encoded through behavioural heuristics. To model the dynamic nature of household behaviour and the autocurricula that arise from changes to market conditions, [11] developed an ABM where households learn to adapt their behaviour in response to market conditions, recreating several stylised facts of the actual mortgage market. However, the authors focused solely on a fixed mortgage product (Mortgage Reserve Accounts [1]), providing no way to generalise across products and, more importantly, no way to optimise for new products. In this work, we significantly extend upon the simulator introduced by [11], allowing for automated product design in a two-layer framework.\nRecent work has investigated the application of a two-layer framework for economic policy design [25], and other work treating these two-layer frameworks as Stackelberg Equilibria [13], both highlighting the potential of such approaches. However, thus far, work in this space has been limited to relatively simple domains.\nDespite the existence of these simulators and recent develop-ments in automated policy design, existing mortgage assistance products tend to be manually crafted by domain experts. For example, one existing product in this domain is mortgage reserve accounts (MRA) [9, 14], which provide mortgage funds (for use during financial distress) without any cost to the household. An alternative formulation is matched MRA [1], requiring $x to be provided by the household, which is then matched by the product provider. During COVID, under the CARES act, a new special COVID forbearance product was introduced [4]. However, thus far, these products have not been automatically optimised in vitro, and instead deployed or explored through pilot studies in vivo. On the contrary, our approach advances upon these ideas by integrating an adaptive outer layer with a realistic agent-based simulator to design mortgage products to improve household resilience.\nTo the best of our knowledge, this work proposes the first realistic census-calibrated model for product design and analysis within the US mortgage market, offering a valuable tool for policy-makers. Although our model is calibrated for the US market, the underlying approach is applicable to general housing markets."}, {"title": "3 PROPOSED APPROACH", "content": "We develop a two-layer approach for mortgage product optimisation, illustrated in Fig. 1. This approach consists of a product design layer and a simulation layer. The product layer introduces novel mortgage assistance products, and the simulation layer models the impacts of these products on the mortgage ecosystem, with households dynamically adjusting their product uptake behaviour. The integration of both layers is essential for capturing the effect new products have on household behaviour and the overall mortgage ecosystem. The interaction between the two layers is illustrated in Fig. 1. The inner layer optimises the households' policy \u03c0, and the outer layer the product distribution parameters 0."}, {"title": "3.1 Simulation Layer: Mortgage Ecosystem", "content": "The simulation layer extends the model of [11], to account for household behavior conditioned on different product configurations. Notably, while households in [11] learned to adapt their behaviour, they lacked the ability to learn how specific products influenced their projected outcomes. This limitation stemmed from the fact that, during training, households could only be exposed to one product. As a result, learning product-specific behavior required retraining under every new scenario, significantly limiting the exploratory capabilities of their simulator. In contrast, our work introduces a novel approach for households to learn the impact of various products on their financial trajectories, enabling the analysis of novel mortgage products."}, {"title": "3.1.1 Agent types", "content": "There are four key agent types in the model: Borrowers, Servicers, Mortgage Owners, and the Economy agent. These agents are summarised below, and the overall interaction among these agents is demonstrated in Fig. 1. One timestep t in the simulation corresponds to 1 month in the real ecosystem, aligning with the standard mortgage payment schedule.\nBorrowers. Borrowers are households that hold mortgages. Borrowers are strategic, making decisions at each timestep that affect not only their own financial and home-ownership trajectories but can influence the overall dynamics of the broader ecosystem. Each borrower has a realistic financial profile including their income $I_t$, expenses $E_t$ (including mortgage expense $m), and amount of savings $A_t$, all sampled according to census and publicly available datasets (detailed in Table 1) at t = 0, as well as a random mortgage term remaining (from 0... 30 years), giving initial equity at t = 0.\nBorrowers are adaptive, learning policies \u03c0 (via proximal policy optimisation and generalized advantage estimation [20]) to maximise their expected lifetime utility U:\n$\\pi(\\alpha_{s_t}, \\phi) = \\max_\\pi \\mathbb{E} \\sum_{t=0}^8 \\gamma^t U_t(\\pi, \\phi)$", "latex": "\\pi(\\alpha_{s_t}, \\phi) = \\max_\\pi \\mathbb{E} \\sum_{t=0}^8 \\gamma^t U_t(\\pi, \\phi)$"}, {"title": "3.2 Optimisation layer: Product Design", "content": "We are interested in designing financial assistance products for borrowers. Successful products should meet several desiderata. The products should be D1.) Simple enough to understand, D2.) Relate to the existing available products, and D3.) Flexible to allow for novel extensions."}, {"title": "3.2.1 Parameterised Product", "content": "To achieve these desiderata, we propose a generic parameterised product to generalise across the product space. The product is represented as:\n$\\varphi (P_o, P_t, V,...)$", "latex": "\\varphi (P_o, P_t, V,...)$"}, {"title": "4 EXPERIMENTAL RESULTS AND ANALYSIS", "content": "The experiment details and results are outlined in this section. The goal is to see if through the two layer representation, we can effectively develop novel mortgage assistance products to improve the financial resilience and stability of borrowers in the mortgage ecosystem."}, {"title": "4.1 Configuration", "content": ""}, {"title": "4.1.1 Metrics of Interest", "content": "Delinquency rate. A borrower is considered delinquent when they miss a mortgage payment, e.g. mortgage payment made < $m. The delinquency rate 0 \u2264 r \u2264 1 is the proportion of delinquent borrowers. If a product is useful to borrowers, r will reduce, showing that borrowers' mortgage payments were able to withstand shocks. Conversely, if a product is harmful and misinformed borrowers opt for it, r will increase (e.g. if the product fees were more costly than the cover used). In cases where a product is harmful, but borrowers are strategic enough, they will learn to not take the product, resulting in an unchanged r.\nSocial index. To gain a more nuanced understanding of the delinquency rate across subgroups of the population, we utilise a social index -w based on the worst delinquency rate across the borrower groups. The goal is to reduce the delinquencies, increasing social welfare in the system. The following definition is used:\n$w(r) = \\max_{g\\in G} r_g$", "latex": "w(r) = \\max_{g\\in G} r_g$"}, {"title": "4.2 Baseline Results", "content": "The delinquency rate r and (negative) social index w(r) conditioned on s are illustrated in Fig. 2 for the baseline setting q\u00f8. The resulting (integrated) metrics across S are given in Table 3. The dummy product q\u00f8 does not incur a product cost, i.e. C = Cn = 0, so we have ommited these plots.\nFig. 2 helps to understand the stability and robustness of the two groups under negative income shocks. It is evident that the lower income group is significantly less robust to these relative shocks, having higher delinquencies, thus necessitating an increased focus on improving the mortgage stability of these borrowers, e.g., to improve investment and lending conditions, through more sustainable home-ownership. The long term sustainability for these low-income borrowers is of particular concern (only strengthened following the 2008 crisis) [24], therefore, developing products that help improve the robustness of borrowers among these groups is essential to foster home-ownership opportunities. In the next section, we therefore attempt to develop new products to improve this robustness (by reducing the delinquencies)."}, {"title": "4.3 Product Evaluation", "content": "To find what products best improve outcomes for these groups, products are evaluated across the two metrics F = {w(r), C}. These metrics are conflicting, as it is costly to provide the cover needed to optimise w(r)."}, {"title": "4.3.1 Fixed product layer", "content": "For the fixed product layer, we consider a multivariate uniform distribution across the product parameter space (from Section 3.2), sampling randomly from this space during training. A visualisation of how different sampled product configurations affect the metrics is given in Fig. 3, providing a clear overview of what regions of product configurations are beneficial for each metric. For example, for w(r) (Fig. 3a), the combination of high cover, low enrolment cost, and low monthly fees provides the best products. However, viewing Fig.3b we can see that these products generally come at the highest cost for the provider. Importantly however, profitable products for the provider are not only those with the lowest cover and higher costs, as these may not see uptake in the simulation, instead a balance is preferred, and providers can still see good profit from higher cover products, demonstrating one benefit of the simulation for modelling product uptake. The integrated metrics are presented in Table 3, demonstrating the outer layer successfully finds products which improve over the baseline under both metrics."}, {"title": "4.3.2 Adaptive product layer", "content": "The results above assume there is no a priori known trade-off among the metrics F. If there is a preference among these objectives, e.g.:\n$L: \\mathcal{P}(F) \\rightarrow \\mathbb{R}$", "latex": "L: \\mathcal{P}(F) \\rightarrow \\mathbb{R}$"}, {"title": "4.4 Non-dominated products", "content": "To understand the implications for the products generated through the optimization of the social index, in this section we evaluate the tradeoffs among the metrics. To do this, we consider Pareto dominance. A product Pareto dominates another product if:\n$\\varphi^i >_p \\varphi^j \\Leftrightarrow (\\forall f \\in F; f_{\\varphi^i} \\leq f_{\\varphi^j}) \\land (\\exists f \\in F; f_{\\varphi^i} < f_{\\varphi^j})$", "latex": "\\varphi^i >_p \\varphi^j \\Leftrightarrow (\\forall f \\in F; f_{\\varphi^i} \\leq f_{\\varphi^j}) \\land (\\exists f \\in F; f_{\\varphi^i} < f_{\\varphi^j})$"}, {"title": "4.5 Results summary", "content": "We first verified the social index following income shocks under the baseline setting, before then expanding to the integration of novel products to improve upon this social index. Under this setting, we evaluated our two-layer approach. We demonstrated how the outer layer can be used for analysis across a wide range of products, either through a fixed or adaptive setting, successfully improving the social index across the population. Under the fixed setting, no a priori preference towards objectives is required, and instead, such decisions can be made post hoc by analysing the resulting frontier. However, when information about the desired product outcome is known, the adaptive layer can dynamically find product configurations and regions of interest for best optimising these outcomes, narrowing and fine-tuning the space of products under consideration.\nThese results demonstrate the suitability and flexibility of the proposed approach for product optimisation, and how such a framework can be used for analysing complex scenarios such as the maximisation of a social index in the mortgage ecosystem. While here we validated with optimising for a single metric, this generally came at the expense of worsening other metrics, as identified by the frontier analysis. Future work could consider combinations of metrics, e.g. $L(C, w(r)) = \\mathbb{E}(r)$, to balance the cost of providing the product with the resulting social index, or consider multiobjective optimisation methods [16] for simulatenously improving both metrics, but this is beyond the scope of the current analysis."}, {"title": "5 CONCLUSION AND DISCUSSION", "content": "We developed a novel two-layer approach for automated financial product design, and demonstrated the use of this approach for designing mortgage products in a simulated mortgage ecosystem. Through optimising for a social index, we showed how we can improve the financial stability of households (by reducing delinquencies), which can lead to improved homeownership rates for even the most impacted groups of the population.\nThe proposed approach simulates product uptake and product impact within a census calibrated mortgage ecosystem, providing insights into the effectiveness of various product configurations for the US market. To analyze numerous product configurations efficiently, we introduced a generic parameterised product, and enabled borrowers to learn product-specific behaviour through conditioning decisions on these parameterizations. Borrowers learn decisions to best maximise their lifetime utility (balancing their equity and liquidity) through a policy gradient approach, collecting trajectories in the simulated mortgage environment based on different products, learning to generalize across product configurations with conditional policy learning.\nThe integration of this product conditioned policy learning combined with an outer parameterised product layer allowed for wide-scale analysis, a capability which was not possible with the existing simulation methods and instead, required retraining for every product, or expensive in vivo pilot studies. We hope that the proposed approach can assist policy-makers and product designers in developing the next generation of mortgage assistance products to best serve households through extensive in vitro analysis before deploying real pilot studies."}]}