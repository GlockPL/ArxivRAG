{"title": "WineGraph: A Graph Representation For Food-Wine Pairing", "authors": ["Zuzanna Gawrysiak", "Agata \u017bywot", "Agnieszka \u0141awrynowicz"], "abstract": "We present WineGraph, an extended version of FlavorGraph, a heterogeneous graph incorporating wine data into its structure. This integration enables food-wine pairing based on taste and sommelier-defined rules. Leveraging a food dataset comprising 500,000 reviews and a wine reviews dataset with over 130,000 entries, we computed taste descriptors for both food and wine. This information was then utilised to pair food items with wine and augment FlavorGraph with additional data. The results demonstrate the potential of heterogeneous graphs to acquire supplementary information, proving beneficial for wine pairing.", "sections": [{"title": "1 Introduction", "content": "The field of food and wine pairing has garnered significant attention in recent years, with various studies focusing on understanding the intricate relationships between flavours and aromas [8]. Despite the wealth of information available on food and wine individually, there is a noticeable gap in comprehensive datasets specifically dedicated to food-wine pairing [1]. In light of recent advancements in food recommendation and substitution using graphs, the primary objective of this research is to enhance the existing heterogeneous graph structure, FlavorGraph [12], by incorporating detailed information about wine.\nFlavorGraph is a large-scale graph network comprising food and chemical compound nodes. Recent advancements in graph-based embedding approaches, particularly utilizing node2vec [6] and metapath2vec [2] algorithms, have shown promise in constructing conceptual representations from network data. These methods generate random walks analogous to sentences in word2vec [10], lever- aging relations within the network. The application of these techniques to food pairing recommendations involves constructing representations of foods based on relationships between ingredients and chemical compounds.\nIn this work, we present WineGraph, an extended version of FlavorGraph, a heterogeneous graph incorporating wine data into its structure."}, {"title": "2 Preliminaries", "content": "Building upon graph-based embedding approaches, and resources: Recipe1M [9], FlavorDB [5], and HyperFoods [13]; FlavorGraph uses metapath2vec to gener- ate conceptual representations of food. By defining food-specific metapaths and considering both chemical and statistical aspects of food pairing, the model ad- dresses optimization challenges arising from the sparse availability of chemical information for food ingredients. Multiple food-specific metapaths were designed in this respect by Park at al. [12] to facilitate the transfer of scarce chemical infor- mation from the compound nodes to non-hub ingredient nodes via chemical-hub ingredients. These metapaths enable training on complex relations, including food-food and food-chemical compounds interactions.\nMore formally, following Dong et al. [2] we define heterogeneous network (Def- inition 1).\nDefinition 1. A heterogeneous network is defined as a graph G = (V, E,T) in which each node v and each link e are associated with their mapping functions \\varphi(\u03c5) : V \u2192 Tv and $(e) : E \u2192 TE, respectively. Tv and Te denote the sets of object and relation types, where |Tv|+|TE| > 2.\nSubsequently, by taking into account a heterogeneous network as our input, we formulate the task of heterogeneous network representation learning in the following manner.\nDefinition 2. Heterogeneous network representation learning: Given a hetero- geneous network G, the task is to learn the d-dimensional latent representations X \u2208 R|V|\u00d7d, d \u00ab |V| that are able to capture the structural and semantic rela- tions among them.\nPark at al. [12] extended metapath2vec model with an additional chemical structure learning layer."}, {"title": "3 Materials and Methods", "content": "To integrate wine pairing into FlavorGraph, we have performed four key steps: 1) pre-processing food and wine review datasets, 2) calculating aroma descriptors based on resulting phrases, 3) creating a list of food-wine pairings, 4) incorporat- ing the resulting data into FlavorGraph. The resulting WineGraph is visualized in Figure 1)."}, {"title": "3.1 Data Preparation", "content": "The first step involved utilising two datasets: Amazon Fine Food Reviews\u00b9 and Wine Reviews\u00b2. The text was first tokenized and normalized. Then the most fre- quent phrases which consisted of 1-3 tokens used together most frequently (i.e., n-grams) were extracted, obtaining flavour descriptors like fruit flavour, acid, black cherries etc. The second step involved mapping the phrases to aroma de- scriptors (wine only) using the UC Davis wine wheel\u00b3. This wheel is comprised of three tiers of aromas, ranging from specific to broad, facilitating the generaliza- tion of descriptors. An illustration of these levels would be raspberry -> berry -> fruit. In the third step, all preprocessed reviews were utilised to train the word2vec model. We also calculated TF-IDF embeddings. The result was 300- dimensional aroma vectors 7 non-aroma scalers for wines and 300-dimensional aroma vectors for food."}, {"title": "3.2 Pairing Procedure", "content": "The resulting embeddings are used to generate food-wine pairings based on pre- defined rules, encompassing attributes like sweetness and acidity, defined as numerical thresholds. In the rules, we use 7 types of numerical variables that correspond to the set {sweet, bitter, salty, acid, fatty, piquant, weight} whose values are normalized to be in the range from 0 to 1. The pairing procedure is: 1) calculate aroma and non-aroma descriptors with the use of the trained word2vec model, 2) eliminate wines that do not match the food item (predefined set of rules), 3) find congruent and contrasting wines (predefined set of rules), 4) sort by aroma similarity."}, {"title": "3.3 Incorporating Pairing Into Knowledge Graph", "content": "The obtained set of paired food and wine items was utilised to train the metap- ath2vec model, generating a graph incorporating wines by adding nodes of the wine type to already existing types of nodes in the FlavorGraph. Incorporating pairings into knowledge graph was performed in the following steps: 1) get top k pairings for each food item (k = 3), 2) incorporate wine data into FlavorGraph"}, {"title": "3.4 Experimental Results", "content": "The goal of the experiments was to determine whether wine can be added to the FlavorGraph without loss of quality and while maintaining correct pairings. We have evaluated our method with the use of Normalised Mutual Information (NMI) as the quality measure. In our experiments, we wanted to show that for the task of clustering by food category quality is not compromised (see: sample clusters in Figure 4). In other words, whether NMI is not lower than for the FlavorGraph without wine (see: Table 4). Figure 3 shows sample flavor profiles. Table 5 shows sample pairings. Table 5 shows the top 3 pairings for burrito, generated and as the closest nodes in the graph."}, {"title": "4 Conclusions", "content": "In this work, we have shown that Wines can be successfully represented in the form of a graph, enhancing food-wine pairing tasks. For this purpose, we have de- vised a neural-symbolic method comprised of the embeddings of a heterogeneous graph and rules.\nIn the future work, we aim to integrate more characteristics of food and wine, and devise novel embedding methods specifically suited for such data."}]}