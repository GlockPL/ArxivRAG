{"title": "Adaptive Cyber-Attack Detection in IIoT Using Attention-Based LSTM-CNN Models", "authors": ["Afrah Gueriani", "Hamza Kheddar", "Ahmed Cherif Mazari"], "abstract": "The rapid expansion of the industrial Internet of things (IIoT) has introduced new challenges in securing critical infrastructures against sophisticated cyberthreats. This study presents the development and evaluation of an advanced Intrusion detection (IDS) based on a hybrid LSTM-convolution neural network (CNN)-Attention architecture, specifically designed to detect and classify cyberattacks in IIoT environments. The research focuses on two key classification tasks: binary and multi-class classification. The proposed models was rigorously tested using the Edge-IIoTset dataset. To mitigate the class imbalance in the dataset, the synthetic minority over-sampling technique (SMOTE) was employed to generate synthetic samples for the underrepresented classes. This ensured that the model could learn effectively from all classes, thereby improving the overall classification performance. Through systematic experimentation, various deep learning (DL) models were compared, ultimately demonstrating that the LSTM-CNN-Attention model consistently outperformed others across key performance metrics. In binary classification, the model achieved near-perfect accuracy, while in multi-class classification, it maintained a high accuracy level (99.04%), effectively categorizing different attack types with a loss value of 0.0220%.", "sections": [{"title": "I. INTRODUCTION", "content": "The Internet of Things (IoT) has emerged as a transforma-tive technology, facilitating a vast network of interconnected devices that collect, exchange, and analyze data in real-time [1-4]. These devices communicate seamlessly, with end devices, often referred to as sensor nodes, continu-ously monitoring their environment and transmitting alert messages to other connected devices [5]. This technolog-ical revolution is reshaping industries, from smart homes and healthcare to agriculture and manufacturing, by driv-ing efficiency, innovation, and automation [6, 7]. Within this broader context, Industrial Internet of Things (IIoT) represents a specialized subset of IoT [8], focused on integrating advanced connectivity, machine learning (ML), and big data analytics into industrial processes. The IIoT enhances operational performance and enables predictive maintenance, energy optimization, and real-time monitoring, thereby creating smarter and more responsive industrial systems. However, the widespread adoption of IIoT has also introduced significant cybersecurity challenges [8]. The extensive inter-connectivity and the critical nature of industrial operations make IIoT environments attractive targets for cyber-attacks. Traditional cybersecurity measures, designed for more static and less interconnected systems, are often inadequate for the dynamic and complex nature of IIoT networks. These networks generate large volumes of heterogeneous data, exhibit temporal dependencies, and are often distributed across geographically dispersed locations. Such characteristics pose unique challenges for intrusion detection system (IDS) tasked with safeguarding these environments. This later is one of the solutions to limit these suspicious is IDS, which aims to identify potential security threats to a network [9, 10]. Artificial intelligence (AI) models especially DL methods have been used to properly solve malware infections and cybersecurity problems like in [11]. Among DL algorithms, the long short-term memory (LSTM), convolution neural network (CNN) [12], and At-tention mechanism [13] are employed in this paper. LSTM, a special class of recurrent neural network (RNN). CNN, on the other hand, excel at identifying spatial hierarchies and local patterns, which are crucial for detecting anomalous behaviors in network traffic and sensor data. The attention layer, a key component in transformers, enhances these ca-pabilities by enabling sequence-to-sequence mappings [14-16]. Attention-based LSTM-CNNs networks combine the temporal modeling strengths of LSTMs, the spatial feature extraction capabilities of CNNs, and the dynamic focus provided by attention mechanisms.\nThis research contributes to the development of robust and resilient security solutions for IIoT by presenting an attention mechanism-based LSTM-CNN model that ensures the protection and integrity of industrial systems in an increasingly connected world. The following steps outline the procedural flow and the contributions of this paper:\n\u2022 Propose a range of distinct models for detecting malware in IIoTs. Specifically, the proposed models include LSTM, CNN, and hybrid LSTM-CNN architectures, with and without attention layer.\n\u2022 Evaluate the proposed models by utilizing the Edge-IIoTset dataset and applying various metrics to determine the effectiveness of the architecture.\n\u2022 Select the most effective model (#10 LSTM-CNN-"}, {"title": "II. LITERATURE REVIEW", "content": "DL models have emerged as powerful tools with demon-strated effectiveness across diverse domains, including cy-bersecurity. Their superior performance over traditional ma-chine learning (ML) techniques underscores their utility in tackling complex challenges in this field. [17] leverages self-attention mechanisms integrated with deep convolutional neural networks (SA-CNNs) to enhance the detection ac-curacy of cyber-attacks. The self-attention layer helps the model focus on the most relevant features, improving its ability to identify malicious activities within complex IIoT environments. The performance of the SA-DCNN model is evaluated using both the IoTID20 and Edge-IIoTset datasets, with results showing significant improvements in detection performance, showcasing the potential of self-attention in IIoT security.\nMoving on, [18] presents a hybrid approach using CNN and LSTM models for intrusion detection in IIoT environ-ments. This model is designed to operate at the edge, ensur-ing data privacy while detecting attacks. By combining CNN for feature extraction and LSTM for temporal pattern recog-nition, the model effectively identifies complex intrusions using features exclusively from the transport and network layers. The approach improves detection accuracy while maintaining data confidentiality, demonstrating promising results in edge-based IIoT security applications.\nGueriani et al. [6] proposes an IDS specifically tailored for IoT environments, using a hybrid approach combining CNN and LSTM DL methods to accurately distinguish between normal and anomalous IoT traffic. The authors validate their approach using two benchmark datasets: the CICIoT2023 dataset (comprising two subsets) and the CICIDS2017 dataset. Results demonstrate that this approach significantly outperforms current state-of-the-art techniques in ML and DL in terms of accuracy and quality. Similarly, [19] proposes an IDS specifically designed to enhance the security of IoT networks, leveraging a hybrid approach combining CNN and LSTM DL methods to accurately distinguish between normal and anomalous IoT traffic. The authors validate their approach using the CICIoT2023 dataset (comprising two subsets) and the CICIDS2017 dataset. The results demonstrate that this approach significantly outperforms current state-of-the-art ML and DL techniques in terms of accuracy and quality. The study [20] introduces the MAGRU model, which combines multi-head attention mechanisms with gated recurrent units (GRUs) to effectively detect and classify cyber-attacks. The proposed model is evaluated on the Edge-IIoTset and MQTTset datasets, demonstrating superior per-formance in terms of accuracy and detection rate compared to traditional models, making it a promising solution for enhancing security in IIoT environments."}, {"title": "III. PROPOSED METHODOLOGY", "content": "The purpose of this section is to discuss the attention mechanism and describe our suggested model, an LSTM-CNN-Attention DL architecture. This approach is intended to identify and categorize hostile and benign activity in a real-environmental dataset. The following stages are in-cluded in the suggested plan:\n- Attention mechanism: An attention function can be under-stood as a mechanism that maps a query and a set of key-value pairs to an output, with the query, keys, values, and output all represented as vectors. The output is computed as a weighted sum of the values, where the weights are derived from a compatibility function that assesses the relationship between the query and each corresponding key [21]. For a detailed description of the attention mechanism, refer to Equation 1 in [22]:\nAttention(Q, K, V) = softmax (\\frac{Qx X K^T}{\\sqrt{dq}}) X V  (1)\nWhere, Q (Query) is the input that the model uses to compute attention scores. d_q is the length of Q. K (Key) is the set of possible matches against which the query is compared. V (Values) represent the information the model utilizes after calculating attention scores, based on the cor-responding keys.\nIn this paper, the attention mechanism improves cyber-attack detection by emphasizing relevant features, enhanc-ing temporal understanding, and isolating anomalies, out-performing conventional CNN-LSTM architectures in IIoT environments.\n- Data preprocessing: In the initial phase, the dataset, containing 60 features and 15 attack types, was structured into a two-dimensional format, with labels converted to binary for model compatibility.\n- Data splitting: The dataset was split 80% for training and 20% for testing, using class weights to address imbalance. The Adam optimization algorithm was employed for effi-cient convergence and optimal performance.\n- Data numerization: A numerization approach was used to make processing of non-numeric categorical data easier. In particular, non-numeric categories were transformed into numeric values using the \"LabelEncoder\" approach in com-bination with the \"fit_transform\" method, making the data suitable for further analysis and modeling."}, {"title": "IV. EXPERIMENTATION, RESULTS AND DISCUSSION", "content": "The effectiveness of our proposed workflow was evalu-ated using the Edge-IIoTset dataset, a realistic benchmark specifically designed to facilitate the development of secu-rity analytics applications for real-world IoT and industrial IoT operations. This dataset, widely employed in IDSS incorporating ML approaches, comprises a diverse range of attack scenarios, as illustrated in Figure 3. The dataset was generated using a heterogeneous array of IoT devices, including over ten different types, such as low-cost digital sensors for temperature and humidity, pH sensor meters, ultrasonic sensors, heart rate sensors, water-level detection sensors, soil moisture sensors, flame sensors, and others.\nAccuracy \nIn this subsection, we present the experimental results evaluating the performance of the proposed models. The evaluation was conducted using the Edge-IIoTset dataset and various performance metrics. Model training was performed on Google Colab using a GPU, with the Adam optimizer over the course of 19 epochs.\nModel selection strategy: Table I shows the performance of different model variants for multiclass classification before and after applying SMOTE technique. The model variants are compared based on their accuracy and loss, taking into account the results after balancing the dataset using the SMOTE technique.\n\u2022 The models that use attention mechanisms, such as LSTM-Attention (#3), generally have better accuracy and lower loss than the models that do not use attention (#1 and #2).\n\u2022 LSTM without and with attention mechanism (#2 and #3 respectively) and LSTM-CNN (#4 to #9) models perform much better than CNN (#1). This is likely because LSTMs are better at capturing temporal dependencies in the data, which can be important for attack detection.\n\u2022 Adding attention mechanisms to LSTM-CNN (#6 to #9) models can further improve performance. Attention mech-anisms allow the model to focus on the most important parts of the input, which can help to improve accuracy.\n\u2022 The best performing model is the LSTM-CNN-Attention model with a Dropout layer (#9). Dropout is a regulariza-tion technique that helps to prevent overfitting, which can improve generalization performance.\nAccuracy The following are the matching equations [27]:\nAcc = \\frac{TP + TN}{TP + FP+ TN + FN} (2)\nRc = \\frac{TP}{TP + FN} Pr = \\frac{TP}{TP + FP} (3)\nF1- Score = 2 \u00d7 \\frac{Precision \u00d7 Recall}{Precision + Recall} (4)\nFPR = \\frac{FP}{FP + TN} (5)\n Table I shows that LSTM-CNN models with attention and dropout are very effective for multi-class classification tasks, including attack detection.\n\u2022 Accuracy and loss graph: The graphs in Figure 3 shows the accuracy of binary and multiclass classification (a) and loss for binary and multiclass classification task (b). The binary accuracy of attack detection in (a) is very high, reaching 100% after the 2nd epoch and remaining there throughout the training. This indicates that the model quickly learned to distinguish between legitimate and malicious data, achieving near-perfect accuracy in the process. Con-cerning the multiclass classification accuracy, the model demonstrates stable validation accuracy, consistently reach-ing around 99.04%. The binary loss in Figure 3 (b) starts at a high value of 0.04 and drops drastically in the first two epochs before stabilizing at a very low value, around 1.99e-07. Additionally, the loss continues to decrease, with the validation loss stabilizing at 0.0220%. These results indicate a well-trained and robust model, exhibiting strong performance in the multiclass classification of attacks.\n\u2022 Classification report: The binary classification results indi-cate perfect accuracy, precision, recall, and F1-score for both attack and normal traffic, with no misclassifications. Table II presents the multiclass classification performance of the LSTM-CNN model with attention, showing high accuracy and F1-scores across all classes. The model achieves perfect scores for \"Normal traffic,\" \"Info. gathering,\" \"MITM,\u201d and \"Injection.\" Slightly lower performance is observed for \"DDoS\" and \"Malware,\u201d with F1-scores of 97%, suggesting minor challenges in classifying these classes. Overall, these high scores highlight the model's potential for real-world network security applications.\nThe FPR of binary classification achieved an excellent value of 0%. This means that the model correctly identified"}, {"title": "V. CONCLUSION", "content": "In this study, we developed and evaluated an advanced IDS for IIoT environments using a hybrid LSTM-CNN-Attention architecture. The model effectively detected and classified cyberattacks in both binary and multiclass tasks using the Edge-IIoTset dataset. We systematically com-pared various DL models to identify the most effective ap-proach for intrusion detection in complex and dynamic IIoT networks. The experimental results demonstrated that our proposed LSTM-CNN-Attention model significantly outper-formed other tested models across all evaluated metrics, achieving near-perfect detection rates.\nFuture research could overcome some limitations such as explore performance on more complex datasets, incorporate transfer learning to improve adaptability to new scarce attack patterns and explore optimizations such as lightweight archi-tectures, model compression, federated learning for privacy preserving [31], and hardware acceleration to mitigate these impacts while retaining detection accuracy."}]}