{"title": "Hybrid Data-Driven SSM for Interpretable and Label-Free mmWave Channel Prediction", "authors": ["Yiyong Sun", "Jiajun He", "Zhidi Lin", "Wenqiang Pu", "Feng Yin", "Hing Cheung So"], "abstract": "Accurate prediction of mmWave time-varying channels is essential for mitigating the issue of channel aging in complex scenarios owing to high user mobility. Existing channel prediction methods have limitations: classical model-based methods often struggle to track highly nonlinear channel dynamics due to limited expert knowledge, while emerging data-driven methods typically require substantial labeled data for effective training and often lack interpretability. To address these issues, this paper proposes a novel hybrid method that integrates a data-driven neural network into a conventional model-based workflow based on a state-space model (SSM), implicitly tracking complex channel dynamics from data without requiring precise expert knowledge. Additionally, a novel unsupervised learning strategy is developed to train the embedded neural network solely with unlabeled data. Theoretical analyses and ablation studies are conducted to interpret the enhanced benefits gained from the hybrid integration. Numerical simulations based on the 3GPP mmWave channel model corroborate the superior prediction accuracy of the proposed method, compared to state-of-the-art methods that are either purely model-based or data-driven. Furthermore, extensive experiments validate its robustness against various challenging factors, including among others severe channel variations and high noise levels.", "sections": [{"title": "I. INTRODUCTION", "content": "MASSIVE multiple-input multiple-output (MIMO) systems with millimeter-wave (mmWave) play a crucial role in fifth- and sixth-generation (5G/6G) wireless networks operating in complicated environments such as vehicle-to-everything (V2X) [1], intelligent factories [2], and air-to-ground communication [3]. These applications necessitate not only high throughput through effective beamforming [4], [5] but also ubiquitous sensing capabilities for precise localization [6], [7] and environment perception [8], [9]. To enable such emerging and smart applications, accurate and agile estimation of instantaneous channel state information (CSI) is in high demand [10]\u2013[12]."}, {"title": "A. Related Works", "content": "A promising solution to address rapid channel aging is to predict future CSI directly [18]-[20]. This can be achieved by leveraging its temporal correlation with historical channels without sacrificing additional communication overhead [21]. Channel prediction is usually formulated as a time series prediction task [21]-[23]. The main challenge lies in accurately capturing the complex temporal pattern (or dynamics) of time-varying channels [23]. In complex scenarios with high user velocity, there is limited expert knowledge available to explicitly characterize the underlying dynamic process due to the resulting high nonlinearity. Practical solution has been further complicated by the available data, which comprises only a sequence of noisy signals of limited length and without high-quality manual labeling. Existing techniques mainly focus on approximating the channel dynamics and can be broadly categorized into model-based and data-driven methods.\nModel-based methods assume that the channel dynamics follow certain analytical functions, such as linear extrapolation [24], sum-of-sinusoids [25], autoregressive (AR) models [18], and autoregressive moving average (ARMA) models [19]. Their limited expressiveness hinders these simplified approximations from accurately matching the actual channel dynamics [23], leading to unstable performance under high user mobility. Building on the approximated channel dynamics, recent works in [17], [19], [21] further integrates the signal model to construct a linear SSM, referred to as the model-based SSM, which facilitates a filter-then-predict (FTP) workflow based on the well-established Kalman filtering (KF) [26]. Specifically, in this model-based FTP workflow,"}, {"title": "II. TIME-VARYING CHANNEL PREDICTION", "content": "In this section, we first introduce the necessary background knowledge on the mmWave massive MIMO system in Section II-A, followed by our problem formulation for time-varying channel prediction in Section II-B."}, {"title": "A. Background", "content": "1) Channel Model: As shown in Fig. 1, we consider uplink time-varying CSI prediction in a massive MIMO system operating in time-division duplex (TDD) mode [32]. The BS serves a single UE in an urban macro-cell environment with various obstacles, such as mountains, trees, buildings, and moving vehicles. The UE, equipped with a uniform planar array (UPA) of M transmitter (Tx) elements, moves at a speed of v km/h, while the BS is equipped with a UPA of N receiver (Rx) elements."}, {"title": "2) Dynamic Condition:", "content": "For notational brevity, the duration of each time slot has been normalized to unity with respect to the pilot signal period $\\Delta t \\in \\mathbb{R_+}$. This normalization ensures the time index t an integer ($t \\in \\mathbb{N}$). The choice of $\\Delta t$ [ms] is determined by the following criterion:\n$\\Delta t \\lesssim k \\cdot T_c$,\nwhere $k \\in \\mathbb{R_+}$ is an adjustable dynamic condition that accounts for channel variations, and $T_c$ [ms] represents the channel coherence time, during which the channels can be reasonably considered time-invariant [37]:\n$T_c = \\frac{540}{v \\cdot f}$,\nwhich is inversely propotional to the UE speed v [km/h] and the carrier frequency f [GHz]."}, {"title": "3) Signal Model:", "content": "In TDD mode, the UE sends the length-$\\tau$ ($\\tau\\in \\mathbb{N_+}$) pilot matrix $Q_{pilot} \\in \\mathbb{C}^{M\\times\\tau}$ to the BS for the uplink CSI estimation. The following semi-unitary pilot matrix with the constraint M < $\\tau$ is adopted:\n$Q_{pilot}^H \\cdot Q_{pilot} = \\tau \\cdot I_M$,\nwhich forces the pilot signals assigned to different Tx elements to be orthogonal to each other, making the CSI estimation for each Tx element independent [27].\nThe received signals $Y_t \\in \\mathbb{C}^{N\\times\\tau}$ at the BS can then be written in the vectorized form as follows:\n$y_t = Q \\cdot h_t + v_t$,\nwhere $y_t = vec(Y_t) \\in \\mathbb{C}^{T N}$ and $h_t = vec(H_t) \\in \\mathbb{C}^{M N}$ are vectorized versions of the received signals and CSI matrix, respectively. The transformed pilot matrix for dimension alignment with the vectorized CSI matrix is given by:\n$Q = (\\sqrt{p}Q_{pilot} \\otimes I_N) \\in \\mathbb{C}^{T N\\times M N}$,\nwhere $p \\in \\mathbb{R_+}$ controls the Tx power for the desired signal-to-noise ratio (SNR). $v_t \\sim \\mathcal{C} \\mathcal{N}(0_{T N \\times 1}, \\Sigma_v)$ represents an independent and identically distributed (i.i.d.) zero-mean additive white Gaussian noise (AWGN) with covariance matrix $\\Sigma_v = \\sigma_v^2 \\cdot I_{TN}$, where $\\sigma_v^2 \\in \\mathbb{R_+}$ is the standard deviation. Note that the signal noise $v_{t'}$ ($t' \\neq t$) is not related, thus uncorrelated, to the channel $h_t$:\n$\\mathbb{E} \\{h_t v_t^H \\} = \\mathbb{E} \\{h_t\\} \\cdot \\mathbb{E} \\{v_t\\}^H = 0_{M N \\times T N}$"}, {"title": "B. Problem Formulation", "content": "In the channel prediction task, the BS predicts the uplink CSI vector $h_{t+1}$ based on previously received noisy signals $Y_{t-p+1:t} = [y_{t-p+1},...,y_{t}]^T$, where $p \\in \\mathbb{N_+}$ denotes the complexity order of the task [21]. Formally, the optimization problem can be formulated as:\n$\\min \\mathbb{E} \\{ \\lVert h_{t+1} - h_{t+1|t} \\rVert ^2 \\}$\ns. t. $h_{t+1|t} = s(y_{t-p+1:t})$,\nwhere $h_{t+1|t}$ is the predicted CSI vector given the received signals up to the time step t. The mapping function s(.) denotes an arbitrary prediction method, such as a model-based FTP workflow or a data-driven Transformer. Our objective is to integrate model-based and data-driven channel prediction methods in a principled manner to leverage their mutual benefits, as detailed in Section III.\nBased on the predicted CSI vector $h_{t+1|t}$, the achievable rate r $\\in \\mathbb{R_+}$ for downlink data transmission is computed under the assumption that Gaussian symbols are transmitted [37]:\n$r = \\mathbb{E} \\log_2 det(I_M + \\frac{p}{M \\cdot \\sigma_v^2} \\hat{H}_{t+1|t} P H P^H \\hat{H}_{t+1|t} ^H)$, where $h_{t+1|t} = vec(\\hat{H}_{t+1|t})$. The zero-forcing (ZF) precoder matrix $P \\in \\mathbb{C}^{M\\times N}$ adopted at the BS is calculated as:\n$P = \\hat{H}_{t+1|t}^H (\\hat{H}_{t+1|t} \\hat{H}_{t+1|t}^H)^{-1}$"}, {"title": "III. KALMAN PREDICTION INTEGRATED WITH NEURAL NETWORK", "content": "This section introduces KPIN, which replaces the deviated Kalman gain in the classical model-based FTP workflow with a data-driven weighting matrix, trained according to the maximum likelihood criterion without requiring labeled data. Section III-A outlines how to construct the model-based SSM. Section III-B analyzes the problems with the conventional model-based FTP workflow. Section III-C to III-E address the three fundamental questions raised in Section I, respectively."}, {"title": "A. Model-based SSM", "content": "The well-established SSM offers a principled framework for general dynamic processes, comprising a transition model and an observation model [29]. The transition model describes how the latent state evolves with time. The observation model maps the latent state to the observation. In the context of channel prediction, the CSI vector $h_t$ acts as the latent state, and the received noisy signal vector $y_t$ serves as the observation."}, {"title": "B. Problems with Model-based FTP Workflow", "content": "This subsection identifies critical issues in the conventional model-based FTP workflow, motivating the development of the proposed hybrid FTP workflow in Section III-C.\nThe conventional model-based FTP workflow involves a recursive process of filtering and prediction over time. At each time step t, the prior estimate $x_{t|t-1}$ represents the predicted value of $x_t$ given the received signals up to the time step (t - 1), while the posterior estimate $x_{t|t}$ denotes the filtered value of $x_t$ given the received signals up to the time step t. The details are as follows:"}, {"title": "1) Filter:", "content": "Based on the prior estimate $x_{t|t-1}$, its covariance matrix $P_{t|t-1} \\in \\mathbb{C}^{pMN\\times pMN}$, the predicted signal $\u0177_{t|t-1}$ and its covariance matrix $S_{t|t-1} \\in \\mathbb{C}^{TN \\times TN}$, KF is implemented to yield the posterior estimate $x_{t|t}$ and its covariance matrix $P_{t|t} \\in \\mathbb{C}^{pMN\\times pMN}$:\n$x_{t|t} = x_{t|t-1} + K_t \\cdot \\Delta y_t$,\n$P_{t|t} = P_{t|t-1} - K_t \\cdot S_{t|t-1} \\cdot K_t^H$,\nwhere $K_t \\in \\mathbb{C}^{pMN \\times TN}$ is the Kalman gain and $\\Delta y_t$ denotes the difference between the newly received signal $y_t$ and the predicted signal $\u0177_{t|t-1}$:"}, {"title": "2) Predict:", "content": "Next, the posterior estimate $x_{t|t}$ passes through the transition model for predicting $x_{t+1|t}$ and $P_{t+1|t}$:\n$x_{t+1|t} = A x_{t|t}$,\n$P_{t+1|t} = A \\cdot P_{t|t} \\cdot A^H + B \\cdot \\Sigma_u \\cdot B^H$"}, {"title": "C. KPIN-enabled Hybrid FTP Workflow", "content": "This subsection introduces a principled integration of the data-driven neural network into the model-based FTP workflow, resulting in the KPIN-enabled hybrid FTP workflow, to address the question Q1 raised in Section I.\nFig. 3 illustrates the information flows within the KPIN-enabled hybrid FTP workflow. This workflow follows a recursive process of filtering and prediction over time, akin to conventional methods. The key distinction is the integration of a data-driven weighting matrix, $K_t^{\\psi} \\in \\mathbb{C}^{pMN\\times TN}$, estimated by KPIN $g_{\\psi}(.)$\u2014a neural network parameterized by $\\psi$. For clarity, terms influenced by KPIN are denoted with a special superscript {$\u00b7^{\\psi}$}.\n1) Filter:\nBased on the prior estimate $x_{t|t-1}^{\\psi}$ and the predicted signal $\u0177_{t|t-1}^{\\psi}$, a KF-type filtering process is implemented to yield the posterior estimate $x_{t|t}^{\\psi}$ [28]:\n$x_{t|t}^{\\psi} = x_{t|t-1}^{\\psi} + K_t^{\\psi} \\cdot \\Delta y_t^{\\psi}$"}, {"title": "D. Low-complexity Unsupervised Learning", "content": "All previous data-driven channel prediction methods [20]-[23] train neural networks iteratively using gradient descent (GD) to optimize specific objective functions [43]. This often requires a significant amount of labeled CSI data, which is rarely available in practical scenarios.\nIn contrast, KPIN is trained by maximizing the following conditional likelihood of {$y_t$}$_{t=1}^{T}$, conditioned on the prior estimates influenced by $\\psi$. This introduces a novel unsupervised learning strategy [44], [45], requiring only a single sequence of historically received noisy signals, without the need for costly manual labeling of {$h_t$}$_{t=1}^{T}$. This effectively addresses Q2 raised in Section I:\n$\\mathop{\\arg \\max} \\limits_{\\psi} p(y_1,..., y_T | x_{0:T-1}^{\\psi})$, which is equivalent to minimizing the following negative log-likelihood function based on Proposition 3:\n$\\mathop{\\arg \\min} \\limits_{\\psi} \\sum\\limits_{t=0}^{T-1} \\lVert Y_{t+1} - Q \\cdot \\Phi \\cdot (x_{t|t-1}^{\\psi} + K_t^{\\psi} \\cdot \\Delta y_t^{\\psi}) \\rVert^2$, Under the linear Gaussian SSM (33) and the hybrid FTP workflow (39-43), the optimization problems in (44) and (45) share the same solution set."}, {"title": "IV. NUMERICAL RESULTS", "content": "The QuaDRiGa (QUAsi Deterministic RadIo channel Gen-erator) simulator [47], [48] is utilized for data synthesis owing to its compatibility with the 3GPP mmWave channel model, 3GPP_TR_38.901 [31]. This simulator can capture the intricate short-term time evolution of channel parameters, delivering an authentic portrayal of time-varying channels impacted by UE movement in realistic and complicated environments. In our implementation, we use QuaDRiGa to simulate the channels between the UE and BS based on the dynamic locations of the UE at different time steps t, effectively capturing the time-varying nature of the channels as experienced by the moving UE.\nIn pursuit of practical relevance, the carrier frequency f is selected to align with the frequency bands tentatively reserved for forthcoming commercial deployment, as reported by Qualcomm [49]. The parameter $\\rho$ is tuned to attain the desired SNR values. We set M = $\\tau$ and the pilot matrix as follows for simplicity [37]:\n$Q_{pilot} = \\sqrt{\\tau}I_M$"}, {"title": "B. Qualitative Analysis", "content": "The performance evaluation begins with a qualitative comparison of five methods in Fig. 5 under baseline conditions, while a comprehensive analysis across various scenario settings is provided in Section IV-D for quantitative comparison. The baseline conditions includes: BS antenna height of 25 meters, UE antenna height of 1.5 meters, N = 32, M = 2, $\\tau$ = 2, v = 60 km/h, f = 28 GHz, $k = \\frac{At}{Te}$ = 1, SNR= 20 dB, p = 4, T = 1000, L = 100, $T_s = 10, n_b = 50, and n_e = 100$. The learning rate is set as 5 \u00d7 10-5 while $\\beta = 1 \\times 10^{-5}$."}, {"title": "C. Ablation Studies", "content": "Two ablation studies are conducted to investigate the observed performance gains of KPIN in the qualitative analysis. These empirical results provide concrete evidence of the capability of KPIN to implicitly track channel dynamics, as discussed at the end of Section III-C, and highlight the mutual benefits of KPIN mentioned in Section III-E."}, {"title": "V. CONCLUSION", "content": "This paper introduces a novel high-accuracy method for predicting highly time-varying channels under large user mobility with limited expert knowledge. The proposed KPIN method integrates classical model-based and data-driven methods, effectively addressing issues arising from limited expert knowledge to enhance prediction accuracy. An innovative unsupervised learning strategy is developed to eliminate the need for manual labeling, significantly reducing barriers to practical deployment. The mutual benefits of KPIN are theoretically analyzed and empirically validated through ablation studies. Numerical experiments demonstrate substantial performance gain of KPIN over state-of-the-art channel prediction methods, both in terms of prediction errors and achievable rates. Comprehensive evaluations assess the robustness and adaptability of KPIN against various challenging factors, positioning it as a promising candidate for next-generation wireless communication, particularly in scenarios involving high user mobility, low SNR, and large antenna arrays."}]}