{"title": "A NEW DATASET, NOTATION SOFTWARE, AND REPRESENTATION FOR COMPUTATIONAL SCHENKERIAN ANALYSIS", "authors": ["Stephen Ni-Hahn", "Weihan Xu", "Simon Mak", "Jerry Yin", "Rico Zhu", "Cynthia Rudin"], "abstract": "Schenkerian Analysis (SchA) is a uniquely expressive method of music analysis, combining elements of melody, harmony, counterpoint, and form to describe the hierarchi-cal structure supporting a work of music. However, despite its powerful analytical utility and potential to improve mu-sic understanding and generation, SchA has rarely been utilized by the computer music community. This is in large part due to the paucity of available high-quality data in a computer-readable format. With a larger corpus of Schenkerian data, it may be possible to infuse machine learning models with a deeper understanding of musical structure, thus leading to more \"human\" results. To en-courage further research in Schenkerian analysis and its potential benefits for music informatics and generation, this paper presents three main contributions: 1) a new and growing dataset of SchAs, the largest in human- and computer-readable formats to date (>140 excerpts), 2) a novel software for visualization and collection of SchA data, and 3) a novel, flexible representation of SchA as a heterogeneous-edge graph data structure.", "sections": [{"title": "1. INTRODUCTION", "content": "With the continuously growing availability of \"big data,\" machine learning models and algorithms have made enor-mous strides in many fields, such as computer vision and language modeling. Recent approaches to music infor-mation retrieval (MIR) and music generation tasks are in-creasingly fueled by massive datasets as well, particularly when working with raw audio. For instance, for genera-tion tasks, Meta's MusicGen is trained on approximately 20,000 hours of licensed music [1], OpenAI's Jukebox on 1.2 million songs [2], and Google's Noise2Music on 340,000 hours of music [3]. Castellon et al. show how these large generation models produce useful representa-tions for downstream MIR tasks [4]. Won et al. perform multimodal metric learning for tag-based music retrieval using approximately 158,000 tracks [5].\nDespite this promising body of work, many areas of music research do not have access to such data and are therefore under-researched and underappreciated, particu-larly in the realm of symbolic music or Schenkarian Anal-ysis (SchA). By infusing an understanding of Schenke-rian musical structure, generative machine learning models may be able to learn more artistic, theoretically-informed structural features beyond simple form and metric features when making inference. Unfortunately, there is currently only one sizeable publicly available dataset for SchA in computer-readable format, and it is relatively small with 41 excerpts [6].\nSchenkerian analysis provides a powerful, flexible, and broadly-used analytical framework for understanding mu-sical melodic-harmonic structure in a sensitive, \"human\" way. Rather than viewing a piece of music as a series of vertical chunks or horizontal melodies, SchA instead ana-lyzes music as an artistic \u201cunfolding\u201d of harmony through time, taking into account elements of melody, harmony, form, and counterpoint. Schenker's theories have inspired numerous performers and composers [7\u20139], helping them to understand their own interpretations of musical struc-ture, which in turn may inform their own performance and/or composition. An understanding of Schenkerian structure helps performers determine what notes deserve emphasis and which may be more transient. A composer can learn to imitate and develop structures they have seen in other pieces of music they admire.\nBecause Schenkerian theory requires a significant amount of background knowledge in music theory and practice and has a difficult learning curve, it is often over-looked or misunderstood. For instance, SchA is often deemed too narrow due to its origins in repertoire of West-ern common practice tonal music. However, aspects of Schenkerian theory have shown strong analytical power in works of popular, rock, jazz, and even African folk mu-sic, Chinese opera, and 20th century western atonal mu-sic [10-13]. To be clear, we see SchA as a broad and evolv-ing field with various analytical tools that can be applied to a wide array of musical genres, not as a static theory solely designed for common practice tonality.\nIt is our belief that research in computational SchA can enable performers and composers to more easily an-alyze music and guide the process of understanding mu-sical structure. Computational SchA can also aid the ex-pert human analyst by offering several potential solutions,"}, {"title": "1.1 Hierarchical Music Analysis", "content": "Music is often composed and understood in terms of hi-erarchical structures such as phrase and rhythmic struc-ture [18, 19], form structure [20, 21], and linear/harmonic structure [22, 23]. In this paper, we focus on the Schenke-rian model of harmonic-melodic structure. As mentioned earlier, SchA aims to reveal how harmonies are \"unfolded\" through linear motion on various levels of structure. SchA has shown that similar harmonic and motivic fea-tures often exist on multiple levels of hierarchy, revealing music's \"fractal\" nature [24]. For instance, in Figure 1, the foreground melody within the first full measure (D4-C4-Bb3) can be seen as a parallelism of the deep level melody spanning the entire excerpt (C4-Bb3-A3); the two melodies have a similar motivic descending third in step-wise motion. One can also see the first full measure lead-ing into the second measure as a $V^b \\rightarrow I$ motion in the key of V, paralleling the deep level V $\\rightarrow$ I shown in the re-duction. While these examples are on a very small scale, one can see more complex harmonic and motivic structures unfolded through entire pieces. For instance, see Example 12 in [24] describing Schubert's Erlk\u00f6nig or Example 2 in [25] describing The Beatles' Something.\nBecause these same music-theoretical ideas and motifs permeate multiple levels of structure, the use of a carefully-designed machine learning model may reveal such struc-ture in a layered approach. With the rise of machine learn-ing in data science, this calls into importance the need for computer-readable SchA datasets for model training."}, {"title": "1.2 Previous Work and Data for Computational Schenkerian Analysis", "content": "The majority of past attempts at computational SchA [26-30] were based on heuristics and rule-based algorithms, and therefore did not require a true computer-readable dataset for SchA. To our knowledge, Marsden [31] was the first to venture towards a machine learning approach, using a humble corpus of six Mozart analyses. He developed a \"goodness metric\u201d based on these six analyses to find the best candidate analyses within a massive search space.\nMore recently, Kirlin designed a probabilistic model for SchA that understands SchAs as maximal outerplanar graphs (MOPs) and learns how likely certain notes prolong others using random forests [32, 33]. He defines prolon-gation as \"a situation where an analyst determines that a group of notes is elaborating a group of more structurally fundamental notes.\" For instance, the syntax follows the pattern X(Y)Z, where the note(s) of Y prolong the mo-tion from note X to note Z.\nOne potential drawback of Kirlin's model is that it al-ways considers one musical voice as one theoretical voice. Looking back at Figure 1, for example, we see there is clearly a deep level bass motion from E3 to F3, support-ing the upper voice, which follows the motion C4-Bb3-A3. The sixteenth notes of m. 2 act to fill the gap between the lower and upper theoretical voices. An MOP reduction of the melody would force all notes to be understood as a sin-gle theoretical voice, thus obscuring the underlying coun-terpoint of the passage. For this reason, we represent SchA as a more general graph data structure, described further in Section 3.\nFor his model, Kirlin released the first large-scale computer-readable dataset of symbolic music with cor-responding expert Schenkerian analyses, Schenker41 [6]. This collection consists of 41 excerpts from the common practice period of European art music, with analyses from three textbooks [23, 34-36] and an independent, anony-mous expert in Schenkerian analysis. Kirlin also created the first computer-readable format for Schenkerian analy-sis, which describes all prolongations present in an analy-sis. The text-based format can also encode linear progres-sions, omitted repetitions, and harmonic context.\nThe Schenker41 dataset is an important first step to-wards broader musical-hierarchical research in the MIR community; however, there are some limitations. First of all, the quality of the excerpts chosen are questionable. Kirlin and Jensen recruited three expert Schenkerian an-alysts to grade textbook analyses as well as their machine learning model's analyses in their 2015 paper . One would expect the textbook analyses to receive grades of \"A-\" or greater, allowing wiggle room for dif-ferences of opinion. However, many excerpts score lower marks; some were even given failing grades. Given the high proportion of dubious quality \"ground truth\" data, it is necessary to produce a greater quantity of quality data before successful, generalizable models can be trained.\nThere are also several Schenkerian symbols and con-cepts that are not currently represented in the text-based notation. For instance, unfoldings, voice exchanges, and other hierarchical harmonic function information are ig-nored. Concerning larger pieces, it is vital to understand the harmonic structure in several layers; an F major triad may stand as a local tonic \u201cI\u201d harmony in the foreground that serves to expand a deeper subdominant \"IV\" of the background, global key of C. Furthermore, more abstract concepts, such as motivic parallelisms, implied tones, and written commentary are eschewed for the sake of simplic-ity."}, {"title": "2. DATASET AND NOTATION SOFTWARE FOR SCHENKERIAN ANALYSIS", "content": "We thus introduce a new large-scale dataset of Schenke-rian analyses in human- and computer-readable formats. As of the writing of this paper, the dataset contains 145 analyses from four analysts for a broad range of com-posers including J.S. Bach, Mendelssohn, Brahms, Bart\u00f3k, Shostakovich, Gentle Giant, and more. The majority of analyses were created by the first author (Stephen Ni-Hahn) with consultation from one of the other analysts, who wishes to remain anonymous at this time. Ni-Hahn currently has nearly a decade of experience with SchA including a graduate degree in music theory. The other three analysts are veteran Schenkerian scholars with sev-eral decades of experience in the field. The dataset is not static and aims to grow over time. Please contact Stephen Ni-Hahn (stephen.hahn@duke.edu) for questions regard-ing, and access to the dataset and notation software de-scribed in this paper.\nCurrently, the vast majority of analyses in the dataset describe the hierarchical relationships within fugue sub-jects by Bach and Pachelbel. Fugue subjects are ideal for preliminary trials with machine learning models since sub-jects are generally brief, consist of a single instrumental line (which may consist of multiple theoretical voices), generally have clear functional relationships, and each have a definite sense of closure by their end.\nRather than writing out each prolongation explicitly, we produce prolongations as a by-product when assigning a hierarchical depth to each note. To retrieve the prolongations, we simply traverse the graph at each depth level (greater than 0), connecting consecutive notes that are at the same level or higher. Custom prolongations that do not occur within this system may be added in a similar fashion to Kirlin's text format by describing the voice and index of the start, middle, and end notes."}, {"title": "2.1 Data Collection Tool", "content": "To facilitate easy collection and visualization of Schenke-rian data, we introduce a new computer notation system for Schenkerian analyses . As of the writing of this paper, our software is capable of notating up to four voice structures of any length. Sim-ple commands allow the user to adjust the pitches, note depths, harmonic/scale-degree label, notes considered part of the Ursatz, etc. Slurs and beams of the outer theoretical voices are automatically generated based on the depths of the notes. We are currently working on ways to render cus-tom markings, such as voice exchanges, unfoldings, and linear progression beams.\nBehind the scenes, the Schenkerian analysis is a simple standardized object in JavaScript Object Notation (JSON), which is highly generalizable, lightweight, and simple to parse, and is capable of describing any obscurities within a particular analysis. Our JSON object contains metadata about the analysis, key information, and information on each of four theoretical voices. Metadata describes the an-alyst, composer, title, subtitle, and any associated written description of the analysis. Furthermore, each theoretical voice is encoded as a list of pitch names, depths, Ursatz in-dices, scale degree/Roman numerals, flagged note indices, sharp/flat/natural indices, and parenthetical indices. Ad-ditionally, the JSON object stores \"cross voice\" symbols such as voice exchange lines and lines indicating related tones across larger spans of time.\nNote that it is straightforward to translate between Kir-lin's OPC text notation and our JSON notation. To trans-late from text to JSON, the notes can be parsed from the musicxml and placed in their appropriate voice. Then note depths may be determined by the location and rela-tive length of their prolongation. Translating from JSON to text is simpler, as one can traverse each depth and re-trieve the prolongations.\nThe software is constructed using languages Javascript/Typescript and the Vue web framework. It is packaged using Electron Forge. Software access can be requested by emailing the first author."}, {"title": "3. SCHENKERIAN ANALYSIS AS A HETEROGENEOUS GRAPH DATA STRUCTURE", "content": "As mentioned in Section 1.2, Kirlin's model simplifies the difficult problem of performing SchA, using a lim-ited version of Yust's MOP representation for SchA. With a greater amount of data, less compromising representa-tions may be used for modeling. The following section describes how a musical score may be represented as a heterogeneous-edge directed graph data structure and how SchA may be conceptualized as a graph clustering prob-lem."}, {"title": "3.1 Graph Music Representation", "content": "In what follows, we represent music as a heterogeneous directed graph G, where each node describes a note, and various types of edges describe the relationships between notes. Concretely, G is represented as (A, X), where \u0391\u2208 {0,1}$^{h\u00d7n\u00d7n}$ describes the set of h adjacency matri-ces (one for each edge type) over n nodes, and X \u2208 R$^{n\u00d7d}$ is the node feature matrix with d as the number of features. These d features may be learned by a neural network, for instance, to correspond with categorical and numerical mu-sical features.\nWe adapt the encoding scheme proposed by Jeong et al. [38] for the purpose of Schenkerian analysis. Nodes may be encoded with any musical feature present in the score, such as pitch class, octave, absolute duration, posi-tion (absolute or relative), metric strength, etc. We suggest the use of five main edge types: (i) forward edges connect two consecutive notes within a voice, (ii) onset edges con-nect notes that begin at the same time, (iii) sustain edges connect notes that are played while the source note is held, (iv) rest edges are like forward edges, but imply a rest oc-curs between the two related notes, and (v) linear edges connect each note with the next notes that occur at specific intervals from the source."}, {"title": "3.2 Schenkerian Analysis as Hierarchical Clustering", "content": "With this graphical representation of music, the process of Schenkerian analysis may then be posed as a hierarchical graph clustering problem. The clustering between two subse-quent levels of Schenkerian analysis is expressed through a clustering matrix, S$^{(l)}$ \u2208 \u211d$^{n_{l}\u00d7n_{l+1}}$, where $n_l$ is the num-ber of nodes in clustering layer l and $n_{l+1} < m$ is the number of nodes after one iteration of clustering. We de-fine $n_0$ to be the total number of notes in the music.\nNote that we can understand a clustering between any two layers as a single matrix, denoted as S$^{(l_i)\\rightarrow(l_j)}$ \u2208 \u211d$^{n_{l_i} x n_{l_j}}$; i < j, where i and j are the index of the source and destination layers respectively. This single matrix is obtained by simply multiplying all sequential clustering matrices. For example, in Figure 5, to retrieve the matrix describing how all five nodes of the original score are clus-tered into the two nodes of the final middleground layer, we can multiply each clustering matrix together:\n$S^{(0)\\rightarrow(2)} = S^{(0)} . S^{(1)} . S^{(2)} = \\begin{bmatrix} 1 & 1 & 1 & 1 & 0\\\\ 0 & 0 & 0 & 0 & 1 \\end{bmatrix}$"}, {"title": "3.3 Converting Schenkerian Analyses from JSON to Matrix Notation", "content": "Schenkerian analysis JSON data (collected using our tool described in Section 2.1) requires extra processing to be represented as hierarchical clusters. Here, we provide an algorithm to convert our JSON data into a series of pro-gressively smaller clustering matrices.\nEssentially, we first traverse the outer voices of the JSON file, clustering notes of depth 0 into the closest note of higher depth to the left in the same voice. If that note does not exist, it defaults to the closest note of a higher depth to the right. For inner voices, if they do not de-scribe hierarchical depth (all 0 depth), they are clustered 50%-50% between the nearest bass and soprano below and above or left to right, in that order. If the inner voice has specified depth, it is treated similarly to the outer voices. All depths are then decremented and the process begins again for the next clustering matrix."}, {"title": "3.4 Implications of SchA Graph Clustering", "content": "The above formulation of SchA as a graph clustering prob-lem facilitates more generalizable analysis. Whereas Kir-lin's MOP-based model focuses on a single melody as one theoretical voice, a fuller graph representation allows for greater flexibility via any number of theoretical voices. There are, however, several drawbacks with this new ap-proach. Because the clustering works with the notes of the score, it is unclear how to handle cases where multiple the-oretical voices converge on a single note. This issue may also be present when handling inner voices of unspecified depth. In our algorithm, we suggest splitting unspecified inner voices 50%-50% between the outer voices, but other approaches may also be reasonable.\nAnother advantage that the proposed graph clustering representation has over the MOP representation is its abil-ity to cluster multiple notes into one in a single layer. This is particularly common when there are several repeated notes. In a MOP, repeated notes must be given detailed hi-erarchy, whereas a human expert would generally think of such repetitions as structurally redundant. There are also instances of prolongations that span more than one child, where having only one child would not properly reflect the music. For instance, if the melody over a C major tonic triad (CEG) quickly plays out the upper tetrachord of the scale, G-A-B-C, then the A and B are structurally equal; they both bridge the gap from G to C. On the other hand, allowing multiple children for every prolongation makes the search space for potential solutions orders of magni-tude larger.\nAs the amount of labeled SchA data grows and compu-tational power improves, there is great potential for learn-ing complex relationships via machine learning that may be unattainable in previous analyses. Deep learning has en-joyed considerable success on analyzing the Bach chorale dataset [39-41], thus we are optimistic that SchA can also be learned for broad datasets from different genres. The proposed dataset, notation software and graph representa-tion provides a promising step towards this goal."}, {"title": "4. CONCLUSION", "content": "In this paper, we introduce the largest corpus of Schenke-rian analyses in computer-readable format to date. This was largely made possible using our novel SchA notation software, which is natural, interpretable, and enables easy data collection and visualization. Finally, we describe and discuss a novel representation for SchA as a graph clus-tering problem that allows representation of any possible Schenkerian analysis, avoiding the limitations of MOPs. It is our hope that the growing amount of data and ease of its collection will enable broader research into SchA's appli-cations."}, {"title": "6. ETHICS STATEMENT", "content": "This particular work has no direct negative ethical impli-cations.\nWe acknowledge that Heinrich Schenker (the inventor of Schenkerian analysis) was racist and nationalist. His sociopolitical views are not condoned by authors of the present work. As originally designed, his style of anal-ysis did not extend far beyond German composers of the common practice era. As we address in Section 1, we do not see Schenkerian analysis as a static analysis defined by Schenker; rather, we see it as a growing and developing set of tools that may be applied to various musical genres, detached from Schenker's personal views."}]}