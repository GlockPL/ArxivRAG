{"title": "Time Makes Space: Emergence of Place Fields in Networks Encoding Temporally Continuous Sensory Experiences", "authors": ["Zhaoze Wang", "Ronald W. Di Tullio", "Spencer Rooke", "Vijay Balasubramanian"], "abstract": "The vertebrate hippocampus is believed to use recurrent connectivity in area CA3 to support episodic memory recall from partial cues. This brain area also contains place cells, whose location-selective firing fields implement maps supporting spatial memory. Here we show that place cells emerge in networks trained to remember temporally continuous sensory episodes. We model CA3 as a recurrent autoencoder that recalls and reconstructs sensory experiences from noisy and partially occluded observations by agents traversing simulated arenas. The agents move in realistic trajectories modeled from rodents and environments are modeled as continuously varying, high-dimensional, sensory experience maps (spatially smoothed Gaussian random fields). Training our autoencoder to accurately pattern-complete and reconstruct sensory experiences with a constraint on total activity causes spatially localized firing fields, i.e., place cells, to emerge in the encoding layer. The emergent place fields reproduce key aspects of hippocampal phenomenology: a) remapping (maintenance of and reversion to distinct learned maps in different environments), implemented via repositioning of experience manifolds in the network's hidden layer, b) orthogonality of spatial representations in different arenas, c) robust place field emergence in differently shaped rooms, with single units showing multiple place fields in large or complex spaces, and d) slow representational drift of place fields. We argue that these results arise because continuous traversal of space makes sensory experience temporally continuous. We make testable predictions: a) rapidly changing sensory context will disrupt place fields, b) place fields will form even if recurrent connections are blocked, but reversion to previously learned representations upon remapping will be abolished, c) the dimension of temporally smooth experience sets the dimensionality of place fields, including during virtual navigation of abstract spaces.", "sections": [{"title": "1 Introduction", "content": "The hippocampus is a brain region that plays a critical role in both spatial navigation [1, 2, 3] and episodic memory [4, 5, 6, 7, 8]. Researchers have therefore sought to understand the neural substrates of these forms of memory in the hippocampus, as well as the extent to which these roles are interrelated [9, 10, 11, 12]. A key role is played by place cells so named because they fire in specific spatial locations within an environment [13]. Place cells have spatially constrained firing fields, and \"remap\" firing patterns in response to significant contextual changes (especially in hippocampal subregion CA3) [14, 15, 16, 17, 18, 19], including motion to a new environment [20] and modified behavioral context or sensory cues [21, 22]. After remapping, they form almost orthogonal representations [21, 23]. These findings suggest that CA3 place cell network may play a"}, {"title": "2 Results", "content": ""}, {"title": "2.1 Episodic memory during spatial traversal", "content": "We first construct a framework for modeling episodic memory, then predict behavior during navigation. First, assume that the hippocampus continuously receives inputs from other cortical areas such as the entorhinal cortex, prefrontal cortex, and thalamus [43, 44, 7, 1], collectively constituting a high-dimensional experience vector (EV), a point in an abstract space of possible experiences E. An agent experiences this world through a temporal sequence of \u201cevents\u201d. Each event produces a short sequence of EVs a 'segment' of episodic memory. An single event of bounded duration should trace a brief, continuous trajectory in the experience space E. Formally, let $E = \\{e, e_1,..., e_T\\}$ represent the segment of episodic memory generated by a single event, where each $e_t \\in R^D$ (for $t = 0, 1, ..., T$) denotes an EV at time t, D is the dimension of the input experience space, and T is the duration of this epsiode in discrete time steps. We take each time step to represent 50 ms in real time. The sequence is continuous such that for any t and t + 1, where 0 < t < T, there exists a non-zero correlation coefficient, $p(e_t, e_{t+1})$. During spatial navigation, we expect the environment"}, {"title": "2.2 Emergence of place-like patterns in a Recurrent Autoencoder (RAE)", "content": "We then construct a simple network model of CA3 for recalling and pattern-completing arbitrary experience vectors. We train the network on EVs generated by an artificial agent exploring varied environments. We design the network following classical theories of CA3 for episodic memory storage, which suggest that recurrent collaterals of CA3 [45, 30, 31, 17, 28] develop attractor dynamics [46] enabling association of similar patterns and separation of dissimilar ones [36, 27, 28]. Accordingly, we model CA3 as a recurrent autoencoder (RAE). In view of previous research that observed emergence of grid-like patterns in recurrent neural networks (RNNs) trained for navigation [47, 48, 49], we implemented our RAE as a continuous-time RNN. Input projections denoted as $W_{in}$ represent pathways entering the hippocampus (Fig. 1b). The hidden layer units use a ReLU non-linearity and contain recurrent connections $W_{rc}$, emulating non-linear responses in CA3 neurons and their recurrent collaterals. The network then uses post-synaptic connections $W_{out}$ representing CA3's projection to other brain regions to decode hidden unit states. All weight matrices $W_{in}$, $W_{rc}$, and $W_{out}$ are initialized to a zero mean uniform distribution (Suppl. Sec. 1). In this formulation, both direct and disynaptic inhibition, the latter via interneurons, are represented as negative weights.\nDuring each trial, agents sampled from the unique set of WSM signals that defined that environment. (Fig. 1a.i & ii), while moving in trajectories that imitated rodents (random walks with low-probability changes of direction and speed, see Suppl. Sec. 1). We discretized each $T_{trial}$ into $dt$ timesteps during which agents received location-specific local EVs with elements randomly masked to imitate factors limiting observation like occlusion and partial attention. We concatenated timesteps sampled from a decaying distribution (Suppl. Sec. 1.2) of recent experiences (Fig. 1b) into 'episodic bouts' and trained the RAE on these bouts. We added pre- and post-activation noise to the hidden layer to simulate variability inherent to sensory processing. The use of episodic bouts serves to encourage"}, {"title": "2.3 Place field emergence reflects temporally continuous changes in sensory experiences", "content": "We describe environments through weakly spatially modulated (WSM) sensory experience profiles that translate physical locations to points in experience space, E. WSM signals are spatio-temporally continuous, so smooth motions between adjacent locations generate smooth motions in E. Thus an agent's exploration generates a set of trajectories in E that are unique to each environment and the agent's paths. The set of possible trajectories the agent could take together defines a surface in E, the experience manifold (EM) of an environment. This manifold has the dimension of the space of accessible sensory experiences. Thus, an agent in a 2D room generates a 2D experience manifold.\nFirst consider neurons without recurrent connections. Given $n$-dimensional inputs, each neuron's input projection and ReLU non-linear firing rate collectively define an activation boundary (AB), an $n - 1$ dimensional plane dividing the experience space E. This boundary occurs at input loci where the neuron transitions from inactive to active. More generally, the distance of an input e to a neuron's activation boundary determines the response firing rate, regardless of the activation function. For example, in Fig. 3b, two 1D EMs, E1 and E2, lie within a 2D experience space and are encoded by two neurons, N1 and N2, with the indicated ABs (solid blue for N1; solid orange for N2). As an agent moves along E1, it intersects N1's activation boundary. Thus, N1's firing rate will gradually increase then decrease. In contrast, since E1 is roughly perpendicular to N2's activation boundary, motion along E1 will change neuron N2's firing rate monotonically."}, {"title": "2.4 Place cell remapping as EM repositioning", "content": "We then tested whether our networks support place cell remapping across rooms and reversion within familiar rooms. To do so, we extended our experiment in Sec. 2.2 by simulating agents exploring two rooms over three sessions in a sequence R1-R2-R1, where R1 and R2 are rooms defined by unique WSM signals. After training in each room, we recorded hidden layer firing patterns. The results were labeled T1R1, T2R2, and T3R1, representing the Trial (T) and Room (R), respectively.\nWe selected active hidden units (mean firing threshold \u2265 0.1 Hz) across trials with SIC above 5 (more than 20x the SIC of the WSM signal) for comparison. T2R2 demonstrates significant remapping in hidden nodes as compared to T1R1 (upper row of Figs. 4a, 4b). Hidden nodes displayed both global and partial remapping with many nodes displaying global remapping including: in the given example, ceasing to fire (n=39), beginning to fire (n=94), or consistently firing in both rooms (n=130). We also observed place firing fields reverting to their original locations, upon returning to room 1 (T3R1) (Figs. 4a,4b, lower rows). These results mirror observations in rodent hippocampus CA3 [18, 20, 21]. To quantify, we calculated pairwise Pearson correlations of firing fields for the selected hidden layer units (Fig. 4b). The correlation matrix showed low spatial correlation in firing fields between T1R1 and T2R2. By contrast, the correlation matrix of T1R1 and T3R1 showed significantly higher diagonal values, indicating reversion of place fields in a familiar enclosure.\nWe then tested the mechanism of reversion. To do so, we calculated a reorganization score s of the input projections ($W_{in}$) and recurrent connections ($W_{rc}$) across trials (see Suppl. Sec. 2.2). Transitioning from T1R1 to T2R2, we observed a substantial reorganization of $W_{rc}$ (s = 0.564) but only minor alterations in input projections $W_{in}$ (s = 0.169). Between T2R2 and T3R1, $W_{in}$ also exhibits small changes (s= 0.141), whereas $W_{rc}$ continues to show a higher reorganization of s = 0.430. This observation is consistent with experimental results indicating that synapses between hippocampal neurons in the same region update at a much faster rate than synapses coming from neurons projecting to the hippocampus or across hippocampal regions [51], and confirms that in our model remapping and reversion are driven by reorganization of recurrent connections.\nIn our framework, different rooms might correspond to differently positioned experience manifolds (EMs) in E. We suppose the network has sufficient capacity to encode every EV in experience space E, and thus every volumetric region in E (small cubes in Fig. 4c) is encoded by some neurons, similar to what we described in Fig. 3b. Then, moving between rooms R1 and R2 (blue and orange planes"}, {"title": "2.5 Storage capacity and the orthogonality of spatial representations", "content": "Studies of episodic and spatial memory suggest that CA3 can memorize and discriminate a large number of experiences [18, 21]. Thus, we tested whether our network can also encode a large number of rooms in orthogonal representations. To do so, we expanded our training protocol to include 20 unique rooms. We call a complete visit of all 20 rooms a \"cycle\" and trained the RAE for 30 cycles, with the room sequence shuffled in each cycle. We reduced the time the agent spent in each room to 10 minutes (12000 timesteps) to avoid overfitting to a single room while training. This trial duration still exceeds the experience sampling window size of 5 minutes (see Fig. 1 caption), ensuring a period in which the RAE receives experiences exclusively from one room.\nAfter each trial, we replicated analyses in [21] to compare hidden layer population coding vectors in different rooms. For each room, we employed a 5 \u00d7 5 cm binning window to discretize each 100 \u00d7 100 cm firing rate map across all 1000 hidden units, resulting in a population vector with dimensions $N \u00d7 W \u00d7 H = 1000 \u00d7 20 \u00d7 20$. We compared the similarity between any two population vectors by their Pearson correlation coefficients (Suppl. Sec. 3.1).\nWe compared the correlation between rooms from cycle 2 and cycle 3, a scenario similar to the experiments in [21]. The mean correlation between different rooms is 0.164 \u00b1 0.029, and that of the same rooms is about 0.55 greater, 0.710 \u00b1 0.097. The corresponding experimental values reported in [21] are also different by about 0.57: 0.08 \u00b1 0.005 and 0.65 \u00b1 0.02, respectively. Note that we should not expect precisely the same values of the correlation because the precise setups of the environments and experiments are different. For example, we have many trial rooms in our in silico study, while there are only 2 rooms in [21]. Furthermore, our network contains 1000 units while Alme et al. recorded only 342 neurons [21]. Overall, we find that the population vectors of familiar rooms have significantly higher correlations as compared to different rooms, consistently with experiments [21, 18, 16, 19, 23]. We also observed that the correlation between population vectors from consecutive visits to the same room quickly stabilizes, exceeding 0.8 after the third cycle (Fig. 5a). These results combine to suggest that our network is capable of stably encoding a large number of rooms in orthogonal representations."}, {"title": "2.6 Robust emergence of place fields and multiple place fields in larger rooms.", "content": "While we primarily tested our network in 1m x 1m square rooms, we have confirmed that place fields robustly emerge in environments of various shapes (Suppl. Sec. 4). We also found that emergence of place fields is robust to the dimension of the experience vectors and the number of hidden units (Suppl. Sec. 4). There is experimental evidence that place cells can develop multiple place field centers in larger enclosures [53, 54]. We tested whether this phenomenon occurred within our RAE. To do so, we had our agent explore an environment that contained two rooms connected by a tunnel and trained our RAE on the resulting experiences (Fig. 6a). Mirroring experimental results, some units in the hidden layer of our RAE developed more than one firing center."}, {"title": "3 Predictions", "content": "Our theory generates several testable predictions. First, we predict that rapid changes to sensory and contextual experiences within an environment will disrupt and destabilize place fields. This prediction emerges from the results of Sec. 2.3, where we showed that neurons would orient their firing patterns to encode the most varying direction of experience vectors (EVs) at adjacent physical locations. If EVs at neighboring locations exhibit substantial variations over short durations of time, there is no consistent, most varying direction of the EVs. Accordingly, it is impossible for place cells"}, {"title": "4 Discussion", "content": "In our study, we tested how episodic and spatial memory, as implemented in the hippocampus, could be interrelated and complementary. To do so, we constructed a recurrent autoencoder (RAE) model of CA3 that received partial and noisy sensory inputs while an agent traversing an environment attempted to reconstruct the complete sensory experience at each location based on previous encounters. We demonstrated that networks concurrently minimizing average firing rate and reconstruction error naturally develop place-like responses. These responses create a continuous landscape of attractor basins (Suppl. Sec. 4.3), enabling robust recall of spatial experience at any location. We found that the emergent place-like units display remapping resembling experiments [21, 17, 18, 28], including cells that only fire in some environments while turning off in others, and other that change their firing location in novel environments while reverting in familiar arenas. Our network also generates orthogonal spatial representations for multiple rooms similarly to place cells in the brain.\nOur findings both reinforce and reframe previous theories of place cell generation, place cell remap-ping, and CA3 function. Previous works have discussed how sensory or contextual information could be multiplexed with purely spatial information [28, 23]. While both types of information can be encoded in the CA3 place cell network, our theory suggests a unified \u201csensory as spatial\u201d framework, which leverages the fact that particular combinations of sensory experiences tend to happen at partic-ular locations and that sensory experiences tend to change smoothly over time. Neurally, these facts are embodied in the numerous weakly spatially modulated cells seen as inputs to the hippocampus [66] and which we use as the input to our network. We accordingly propose that these inputs are the primary drivers of place cell generation.\nIn our model, neurons that capture more input variance contribute more to pattern completion, and reorganization of recurrent connections serves to maximize their role. This suggests that individual cells will remap to form unique representations for similar sensory experiences encountered in"}]}