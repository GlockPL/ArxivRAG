{"title": "LSST: Learned Single-Shot Trajectory and Reconstruction Network for MR Imaging", "authors": ["Hemant Kumar Aggarwal", "Sudhanya Chatterjee", "Uday Patil", "Dattesh Shanbhag", "K.V.S. Hari"], "abstract": "Single-shot magnetic resonance (MR) imaging acquires the entire k-space data in a single shot and it\nhas various applications in whole-body imaging. However, the long acquisition time for the entire k-space in\nsingle-shot fast spin echo (SSFSE) MR imaging poses a challenge, as it introduces T2-blur in the acquired\nimages. This study aims to enhance the reconstruction quality of SSFSE MR images by (a) optimizing the\ntrajectory for measuring the k-space, (b) acquiring fewer samples to speed up the acquisition process, and\n(c) reducing the impact of T2-blur. The proposed method adheres to physics constraints due to maximum\ngradient strength and slew-rate available while optimizing the trajectory within an end-to-end learning\nframework. Experiments were conducted on publicly available fastMRI multichannel dataset with 8-fold and\n16-fold acceleration factors. An experienced radiologist's evaluation on a five-point Likert scale indicates\nimprovements in the reconstruction quality as the ACL fibers are sharper than comparative methods.", "sections": [{"title": "1 Introduction", "content": "Magnetic Resonance (MR) Imaging is a non-invasive technique that offers superior soft-tissue contrast compared\nto other imaging modalities such as X-ray or CT. The quality of reconstructed images are influenced not only by\nthe number of samples acquired but also by the sampling scheme employed. Therefore, optimizing the sampling\npattern for acquisition is critical to further enhance the reconstruction quality [1, 2, 3, 4, 5, 6, 7, 8, 9].\nPrior work exist regarding sampling pattern optimization scheme independent of reconstruction algorithm [1,\n3, 4], active sensing techniques [10, 11] which optimizes sampling location after each TR, and methods that\nfocus on multi-shot fast spin echo (FSE) sequences such as T2-Shuffling [12]. This study focuses on jointly\noptimizing sampling pattern and reconstruction network for single-shot spin echo MR imaging sequences.\nThe process of undersampling k-space in two dimensions to expedite MR acquisition cannot be arbitrary\ndue to practical considerations such as system configuration of gradient and slew-rate. Random undersampling,\nwhich necessitates swift gradient switching, is often impractical as it results in high eddy current-related ar-\ntifacts [13]. When formulating a k-space trajectory, it's crucial to consider the relevant MR system hardware\nconstraints, specifically, the maximum gradient magnitude (Gmax) and maximum slew-rate (Smax). These con-\nstraints limit the maximum velocity (Umax = yGmax) and acceleration (amax = ySmax) of the trajectory, where\ny is the Gyromagnetic ratio [14].\nGiven the benefits of arbitrary single-shot trajectories, this work focuses on optimizing them for a MR system\nwith specific gradient and slew-rate specifications. This is achieved by determining the shortest path through a\nrandom initial set of points, akin to solving a Traveling Salesman Problem (TSP) [15]. A TSP trajectory might\nnot meet the gradient constraints but provides a good initialization for the trajectory in the joint optimization\nframework.\nOur approach improves upon the PILOT [16] study by eliminating the need for solving an explicit TSP\nduring joint optimization. Unlike PILOT, this work explicitly accounts T2-Blur in single-shot acquisition and\nenhances reconstruction quality by incorporating the Density Compensation Factor (DCF) during training,\nand initializing the network input with a model-based solution. Unlike the BJORK [17] study, which doesn't\naccount for T2-blur, which is relevant for single-shot MR imaging, our method account for it. We propose a\ndirect-inversion network to account for the unknown T2-Blur. Key contributions of this work include:\n\u2022 Proposing an approach to accelerate 2D spin echo (SE) MR imaging as single-shot fast spin echo imaging,\noffering an effective alternative to the 1D undersampling approach that produces considerable aliasing and\nblurring artifacts for high acceleration rates."}, {"title": "2 Proposed Generalized Framework", "content": "Figure 1 illustrates the training and inference pipeline of our proposed Learned Single-Shot Trajectory (LSST)\noptimization framework, which concurrently optimizes both the k-space trajectory and the reconstruction net-\nwork. Section 2.1 discusses trainable single-shot image acquisition model and section 2.2 discusses proposed\njoint optimization framework for trajectory optimization."}, {"title": "2.1 Trainable Single-shot Acquisition Model", "content": "Initially a random variable-density sampling mask for a given acceleration factor Ris generated, as depicted in\nFig. 2(a). An initial trajectory k is generated from these random points using a TSP solver, such that the k-space\ncenter is sampled as the first point. The trajectory defines the order in which k-space is traversed to acquire the\ndata in a single-shot. The network is initialized with this trajectory shown in Fig. 2(b). A direct TSP-based\ntrajectory is infeasible since it does not satisfy physics constraints based on system hardware. Additionally, this\ngeneric trajectory is not necessarily optimal for a given dataset/task. Therefore, optimization of the trajectory\nis based on a given dataset while enforcing the physics constraints. Thus, trajectory is treated as a trainable\nparameter k. After imposing these constraints, the learned trajectory has relatively smooth curvatures which\nare evident from Fig. 2(c)."}, {"title": "2.2 Proposed Image Reconstruction Pipeline", "content": "This section describes the proposed three-step reconstruction process that involves initial iterative Sensitivity\nEncoding (SENSE) based reconstruction followed by deep learning based reconstruction and artifact reduction\nstep."}, {"title": "2.2.1 Initial SENSE Reconstruction", "content": "Given that the trajectory densely samples the center of k-space and sparsely samples the periphery, it can\nintroduce a bias towards the lower frequencies, resulting in a blurred reconstruction from the k-space mea-\nsurements. Therefore, we explicitly account for density compensation prior to the reconstruction process. This\nwork utilizes a backpropagation compatible implementation of a density compensation algorithm [21] on blurred\nmeasurements, yb, to obtain an approximation of regridding reconstruction, \u2611 using conjugate of the acquisition\noperator as x = T (yb).\nThe occurrence of blur in single-shot acquisition presents additional challenges due to the pronounced un-\ndersampling artifacts and get exacerbated at higher acceleration factors. Additionally, an unknown modulation\nfunction contributes to the blur in the reconstructed images (compounding the aliasing artifacts). The den-\nsity compensated regridding reconstruction x, obtained from blurred measurements yb, can be improved by\nusing reconstruction algorithms such as Sensitivity Encoding (SENSE) that solves the following 12-regularized\noptimization problem\n$\\arg \\min_{X} || yb - Tk(x)||^2_3 + \\lambda||x||^2_3 .$\niteratively using Conjugate-Gradient algorithm, whose solution can be represented as\n$x0 = (T^T T_k + \\lambda I)^{-1}(x).$"}, {"title": "2.2.2 Direct-Inversion Network", "content": "Once we have an initial solution xo, we can reconstruct the final image using a CNN. Unlike BJORK [17], the\nsingle-short forward model (3) has unknown blur therefore a model-based deep learning approach is not directly\napplicable for the single-shot reconstruction and trajectory optimization. Therefore, in this work, we propose\nto reduce the artifacts present in xo using a direct-inversion network such UNet [22]. It is possible to utilize a\nfixed feasible trajectory such as [23] and obtain the reconstructed image from xo using deep learning methods\nas\n$\\hat{x} = D_{\\theta}(x_0)$\nHere, De is a CNN with trainable parameters \u03b8. This method only optimizes the network parameters once the\nsamples are acquired. However, the joint optimization of the sampling trajectory (k) and reconstruction network\nparameters (\u03b8) can further improve the reconstruction quality. The joint optimization can be represented as\n$\\hat{x} = D_{\\theta,k}(X),$"}, {"title": "3 Experiments and Results", "content": "We trained and tested our models on a subset of parallel imaging fastMRI knee dataset [25] consisting of 100\nvolumes for training, 50 volumes for validation, and 94 volumes for testing. We performed network training\non complex valued data at actual resolution without cropping. Images were cropped to center 320 \u00d7 320 only\nfor display purpose. For simulating the single-shot data, we assumed, echo time (TE) =100 ms, T2 for bone\nmarrow fat=80 ms, and sampling duration=1 \u03bcs. During loss function optimization, we set the value of gradient\nconstraints as Gmax = 40mT/m and Smax = 200mT/m/ms."}, {"title": "3.1 Improved Input to the Network", "content": "Figure 3 highlights the impact of performing SENSE reconstruction using (5) with and without (w/o) considering\nthe T2-Blur in the measurements. As we can see with a lower peak signal to noise ratio (PSNR) value of 19.36 dB\nin Fig. 3(d), the single-shot reconstruction problem becomes significantly challenging due to the presence of T2-\nblur. However, we note that the initial solution xo (Fig. 3(d)) has reduced artifacts compared to x (Fig. 3(c))\nand, therefore acts as a good initial input to the neural network."}, {"title": "3.2 Improved Reconstruction by the Network", "content": "We performed initial experiment using traditional compressed sensing algorithm [26] (1D undersampling) with\na total variation regularization (CSTV) without accounting for the T2-Blur at 8x accelerated data acquired\nusing uniform Cartesian sampling mask having 18 lines in the calibration region. In the second experiment, to"}, {"title": "4 Conclusions and Discussions", "content": "This study introduces a method for the joint optimization of the k-space trajectory and reconstruction network\nparameters for single-shot acquisition that accounts for T2-Blur while adhering to MR system constraints. The\nlearned trajectory meets gradient strength and slew-rate constraints and ensures practical trajectory estimation.\nInitial results and radiologist Likert scores affirm the method's utility."}, {"title": "5 Additional Results", "content": ""}]}