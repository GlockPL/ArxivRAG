{"title": "How DNNs break the Curse of Dimensionality: Compositionality and Symmetry Learning", "authors": ["Arthur Jacot", "Seok Hoan Choi", "Yuxiao Wen"], "abstract": "We show that deep neural networks (DNNs) can efficiently learn any composition\nof functions with bounded F\u2081-norm, which allows DNNs to break the curse of\ndimensionality in ways that shallow networks cannot. More specifically, we\nderive a generalization bound that combines a covering number argument for\ncompositionality, and the F\u2081-norm (or the related Barron norm) for large width\nadaptivity. We show that the global minimizer of the regularized loss of DNNs can\nfit for example the composition of two functions f* = hog from a small number\nof observations, assuming g is smooth/regular and reduces the dimensionality (e.g.\ng could be the modulo map of the symmetries of f*), so that h can be learned in\nspite of its low regularity. The measures of regularity we consider is the Sobolev\nnorm with different levels of differentiability, which is well adapted to the F\u2081 norm.\nWe compute scaling laws empirically and observe phase transitions depending on\nwhether g or h is harder to learn, as predicted by our theory.", "sections": [{"title": "1 Introduction", "content": "One of the fundamental features of DNNs is their ability to generalize even when the number of\nneurons (and of parameters) is so large that the network could fit almost any function [48]. Actually\nDNNs have been observed to generalize best when the number of neurons is infinite [8, 21, 20].\nThe now quite generally accepted explanation to this phenomenon is that DNNs have an implicit\nbias coming from the training dynamic where properties of the training algorithm lead to networks\nthat generalize well. This implicit bias is quite well understood in shallow networks [11, 37], in\nlinear networks [24, 30], or in the NTK regime [28], but it remains ill-understood in the general deep\nnonlinear case.\nIn both shallow networks and linear networks, one observes a bias towards small parameter norm\n(either implicit [12] or explicit in the presence of weight decay [44]). Thanks to tools such as the\nF\u2081-norm [5], or the related Barron norm [46], or more generally the representation cost [14], it is\npossible to describe the family of functions that can be represented by shallow networks or linear\nnetworks with a finite parameter norm. This was then leveraged to prove uniform generalization\nbounds (based on Rademacher complexity) over these sets [5], which depend only on the parameter\nnorm, but not on the number of neurons or parameters.\nSimilar bounds have been proposed for DNNs [7, 6, 40, 33, 25, 41], relying on different types of\nnorms on the parameters of the network. But it seems pretty clear that we have not yet identified\nthe 'right' complexity measure for deep networks, as there remains many issues: these bounds are\ntypically orders of magnitude too large [29, 23], and they tend to explode as the depth L grows [41]."}, {"title": "1.1 Contribution", "content": "We consider Accordion Networks (AccNets), which are the composition of multiple shallow networks\nfL:1 = fL\nf1, we prove a uniform generalization bound $\\mathcal{L}(f_{L:1}) - \\mathcal{L}_N(f_{L:1}) \\leq \\mathcal{R}(\\theta) \\log N \\sqrt{N}$ for a complexity measure\n$\\mathcal{R}(\\theta) = \\sum_{l=1}^{L} \\frac{||f_l||_{F_1}}{Lip(f_l)} \\sum_{l=1}^{L} \\frac{Lip(f_l)}{\\sqrt{d_l + d_{l-1}}}$\nthat depends on the F1-norms $||f_l||_{F_1}$ and Lipschitz constanst $Lip(f_l)$ of the subnetworks, and the\nintermediate dimensions $d_0, ..., d_L$. This use of the F\u2081-norms makes this bound independent of the\nwidths $w_1, ..., w_L$ of the subnetworks, though it does depend on the depth L (it typically grows\nlinearly in L which is still better than the exponential growth often observed).\nAny traditional DNN can be mapped to an AccNet (and vice versa), by spliting the middle weight\nmatrices $W_l$ with SVD $USV^T$ into two matrices $U\\sqrt{S}$ and $\\sqrt{S}V^T$ to obtain an AccNet with\ndimensions $d_l = Rank(W_l)$, so that the bound can be applied to traditional DNNs with bounded rank.\nWe then show an approximation result: any composition of Sobolev functions $f^* = f_L \\circ ... \\circ f_1$\ncan be approximated with a network with either a bounded complexity $\\mathcal{R}(\\theta)$ or a slowly growing one.\nThus under certain assumptions one can show that DNNs can learn general compositions of Sobolev\nfunctions. This ability can be interpreted as DNNs being able to learn symmetries, allowing them to\navoid the curse of dimensionality in settings where kernel methods or even shallow networks suffer\nheavily from it.\nEmpirically, we observe a good match between the scaling laws of learning and our theory, as well as\nqualitative features such as transitions between regimes depending on whether it is harder to learn the\nsymmetries of a task, or to learn the task given its symmetries."}, {"title": "2 Accordion Neural Networks and ResNets", "content": "Our analysis is most natural for a slight variation on the traditional fully-connected neural networks\n(FCNNs), which we call Accordion Networks, which we define here. Nevertheless, all of our results\ncan easily be adapted to FCNNs.\nAccordion Networks (AccNets) are simply the composition of L shallow networks, that is $f_{L:1} =$\n$f_L... \\circ f_1$ where $f_l(z) = W_l \\sigma(V_l z + b_l)$ for the nonlinearity $\\sigma : \\mathbb{R} \\rightarrow \\mathbb{R}$, the $d_l \\times w_l$ matrix\n$W_l$, $w_l \\times d_{l-1}$ matrix $V_l$, and $w_l$-dim. vector $b_l$, and for the widths $w_1, ..., w_L$ and dimensions\n$d_0, ..., d_L$. We will focus on the ReLU $\\sigma(x) = max\\{0, x\\}$ for the nonlinearity. The parameters $\\theta$ are\nmade up of the concatenation of all $(W_l, V_l, b_l)$. More generally, we denote $f_{l_2:l_1} = f_{l_2} \\circ ... \\circ f_{l_1}$\nfor any $1 \\leq l_1 \\leq l_2 < L$.\nWe will typically be interested in settings where the widths $w_l$ is large (or even infinitely large), while\nthe dimensions $d_l$ remain finite or much smaller in comparison, hence the name accordion.\nIf we add residual connections, i.e. $f^{res}_{L:1} = (f_L + id) \\circ ... \\circ (f_1 + id)$ for the same shallow nets\n$f_1,..., f_L$ we recover the typical ResNets."}, {"title": "2.1 Learning Setup", "content": "We consider a traditional learning setup, where we want to find a function $f : \\Omega \\subset \\mathbb{R}^{d_{in}} \\rightarrow \\mathbb{R}^{d_{out}}$\nthat minimizes the population loss $\\mathcal{L}(f) = \\mathbb{E}_{x \\sim \\pi}[l(x, f(x))]$ for an input distribution $\\pi$ and a\n$\\rho$-Lipschitz and $\\rho$-bounded loss function $l(x, y) \\in [0, B]$. Given a training set $x_1, ..., x_N$ of size N\nwe approximate the population loss by the empirical loss $\\mathcal{L}_N(f) = \\sum_{i=1}^N l(x_i, f(x_i))$ that can be\nminimized.\nTo ensure that the empirical loss remains representative of the population loss, we will prove high\nprobability bounds on the generalization gap $\\mathcal{L}_N(f) - \\mathcal{L}(f)$ uniformly over certain functions families\n$f \\in \\mathcal{F}$.\nFor regression tasks, we assume the existence of a true function $f^*$ and try to minimize the distance\n$l(x, y) = ||f^*(x) - y||^p$ for $p \\geq 1$. If we assume that $f^*(x)$ and y are uniformly bounded then one\ncan easily show that $l(x, y)$ is bounded and Lipschitz. We are particularly interested in the cases\n$p \\in \\{1, 2\\}$, with p = 2 representing the classical MSE, and p = 1 representing a L\u2081 distance. The\np = 2 case is amenable to 'fast rates' which take advantage of the fact that the loss increases very\nslowly around the optimal solution $f^*$, We do not prove such fast rates (even though it might be\npossible) so we focus on the p = 1 case.\nFor classification tasks on k classes, we assume the existence of a 'true class' function $f^* : \\Omega \\rightarrow$\n$\\mathbb{1}, ..., k\\}$ and want to learn a function $f : \\Omega \\rightarrow \\mathbb{R}^k$ such that the largest entry of f(x) is the $f^*(k)$-th\nentry. One can consider the hinge cost $l(x, y) = max\\{0, 1 - (y_{f^*(k)} - max_{i\\neq f^*(x)} y_i)\\}$, which is\nzero whenever the margin $y_{f^*(k)} - max_{i\\neq f^*(x)} y_i$ is larger than 1 and otherwise equals 1 minus the\nmargin. The hinge loss is Lipschitz and bounded if we assume bounded outputs y = f(x). The\ncross-entropy loss also fits our setup."}, {"title": "3 Generalization Bound for DNNS", "content": "The reason we focus on accordion networks is that there exists generalization bounds for shallow\nnetworks [5, 46], that are (to our knowledge) widely considered to be tight, which is in contrast to the\ndeep case, where many bounds exist but no clear optimal bound has been identified. Our strategy\nis to extend the results for shallow nets to the composition of multiple shallow nets, i.e. AccNets.\nRoughly speaking, we will show that the complexity of an AccNet $f_\\theta$ is bounded by the sum of the\ncomplexities of the shallow nets $f_1,..., f_L$ it is made of.\nWe will therefore first review (and slightly adapt) the existing generalization bounds for shallow\nnetworks in terms of their so-called F\u2081-norm [5], and then prove a generalization bound for deep\nAccNets."}, {"title": "3.1 Shallow Networks", "content": "The complexity of a shallow net $f(x) = W\\sigma(Vx + b)$, with weights $W \\in \\mathbb{R}^{w \\times d_{out}}$ and\n$V \\in \\mathbb{R}^{d_{in} \\times w}$, can be bounded in terms of the quantity $C = \\sum_{i=1}^w ||W_{i.}|| \\sqrt{||V_{i.}||^2 + b_i^2}$.\nFirst note that the rescaled function $\\frac{1}{C}f$ can be written as a convex combination $\\frac{1}{C}f(x) =$\n$\\sum_{i=1}^w \\frac{||W_{i.}|| \\sqrt{||V_{i.}||^2 + b_i^2}}{C} \\frac{W_{i.}}{||W_{i.}||} \\sigma(\\frac{V_{i.}}{||V_{i.}||}x + \\frac{b_i}{\\sqrt{||V_{i.}||^2 + b_i^2}})$ for $W_{i.} = \\frac{W_{i.}}{||W_{i.}||}, V_{i.} = \\frac{V_{i.}}{\\sqrt{||V_{i.}||^2 + b_i^2}}$, and $b_i = \\frac{b_i}{\\sqrt{||V_{i.}||^2 + b_i^2}}$,\nsince the coefficients $\\frac{||W_{i.}|| \\sqrt{||V_{i.}||^2 + b_i^2}}{C}$ are positive and sum up to 1. Thus f belongs to C times the\nconvex hull\n$\\mathcal{B}_{F_1} = Conv \\{x \\rightarrow w\\sigma(vx + b) : ||w||^2 = ||v||^2 + b^2 = 1\\} $."}, {"title": "3.2 Deep Networks", "content": "Since an AccNet is simply the composition of multiple shallow nets, the functions represented by an\nAccNet is included in the set of composition of F\u2081 balls. More precisely, if $||W_l||^2 + ||V_l||^2 + ||b_l||^2 <$\n$2R_l$ then $f_{L:1}$ belongs to the set $\\{g_L \\circ ... \\circ g_1 : g_l \\in \\mathcal{B}_{F_1}(0, R_l)\\}$ for some $R_l$, which is width\nagnostic.\nAs already noticed in [7], the covering number number is well-behaved under composition, this\nallows us to bound the complexity of AccNets in terms of the individual shallow nets it is made up of:\nTheorem 2. Consider an accordion net of depth L and widths $d_1, ..., d_0$, with corresponding set of\nfunctions $\\mathcal{F} = \\{f_{L:1} : ||f_l||_{F_1} < R_l, Lip(f_l) \\leq p_l\\}$. With probability 1 \u2013 \u03b4 over the sampling of the\ntraining set X from the distribution \u03c0 supported in B(0, b), we have for all $f \\in \\mathcal{F}$\n$\\mathcal{L}(f) - \\mathcal{L}_N(f) \\leq C p b \\mathcal{L}_{L:1} \\sum_{l=1}^{L} \\frac{R_l\\sqrt{d_l + d_{l-1}}}{p_l} \\frac{\\log N}{\\sqrt{N}}(1 + o(1)) + c_0\\sqrt{\\frac{2\\log 2/\\delta}{N}}$\nTheorem 2 can be extended to ResNets $(f_L + id) \\circ ... \\circ (f_1 + id)$ by simply replacing the Lipschitz\nconstant $Lip(f_l)$ by $Lip(f_l + id)$.\nThe Lipschitz constants $Lip(f_l)$ are difficult to compute exactly, so it is easiest to simply bound it\nby the product of the operator norms $Lip(f_l) \\leq ||W_l||_{op} ||V_l||_{op}$, but this bound can often be quite\nloose. The fact that our bound depends on the Lipschitz constants rather than the operator norms\n$||W_l||_{op}, ||V_l||_{op}$ is thus a significant advantage.\nThis bound can be applied to a FCNNs with weight matrices $M_1, ..., M_{L+1}$, by replacing the middle\n$M_l$ with SVD decomposition $USV^T$ in the middle by two matrices $W_{l-1} = \\sqrt{S}V^T$ and $V_l = U\\sqrt{S}$,\nso that the dimensions can be chosen as the rank $d_l = Rank(M_{l+1})$. The Frobenius norm of the new\nmatrices equal the nuclear norm of the original one $||W_{l-1}||_F = ||V_l||_F^2 = ||M_l||_*$. Some bounds"}, {"title": "4 Breaking the Curse of Dimensionality with Compositionality", "content": "In this section we study a large family of functions spaces, obtained by taking compositions of\nSobolev balls. We focus on this family of tasks because they are well adapted to the complexity\nmeasure we have identified, and because kernel methods and even shallow networks do suffer from\nthe curse of dimensionality on such tasks, whereas deep networks avoid it (e.g. Figure 1).\nMore precisely, we will show that these sets of functions can be approximated by a AccNets with\nbounded (or in some cases slowly growing) complexity measure\n$\\mathcal{R}(\\theta) = \\prod_{l=1}^{L} Lip(f_l) \\sum_{l=1}^{L} \\frac{||f_l||_{F_1}}{Lip(f_l)} \\sqrt{d_l + d_{l-1}}.$\nThis will then allow us show that AccNets can (assuming global convergence) avoid the curse of\ndimensionality, even in settings that should suffer from the curse of dimensionality, when the input\ndimension is large and the function is not very smooth (only a few times differentiable)."}, {"title": "4.1 Composition of Sobolev Balls", "content": "The family of Sobolev norms capture some notion of regularity of a function, as it measures the size\nof its derivatives. The Sobolev norm of a function $f : \\mathbb{R}^{d_{in}} \\rightarrow \\mathbb{R}$ is defined in terms of its derivatives\n$\\partial_{\\alpha} f|$ for some $d_{in}$-multi-index $\\alpha$, namely the $W^{v,p}(\\pi)$-Sobolev norm with integer v and p > 1 is\ndefined as\n$||f||_{W^{v,p}(\\pi)} = \\sum_{|\\alpha| \\leq v} ||D^\\alpha f||_{L^p(\\pi)} .$\nNote that the derivative $D^\\alpha f$ only needs to be defined in the 'weak' sense, which means that even\nnon-differentiable functions such as the ReLU functions can actually have finite Sobolev norm.\nThe Sobolev balls $\\mathcal{B}_{W^{v,p}(\\pi)}(0, R) = \\{f : ||f||_{W^{v,p}(\\pi)} \\leq R\\}$ are a family of function spaces with a\nrange of regularity (the larger v, the more regular). This regularity makes these spaces of functions\nlearnable purely from the fact that they enforce the function f to vary slowly as the input changes.\nIndeed we can prove the following generalization bound:\nProposition 3. Given a distribution $\\pi$ with support the L\u2082 ball with radius b, we have that with\nprobability 1 \u2013 \u03b4 for all functions $f \\in \\mathcal{F} = \\{f : ||f||_{W^{v,2}} \\leq R, ||f||_{\\infty} \\leq R\\}$\n$\\mathcal{L}(f) - \\mathcal{L}_N(f) \\leq 2 \\rho C_1 R \\mathbb{E}_{v/d}(N) + c_0 \\sqrt{\\frac{2 \\log 2/\\delta}{N}}$\nwhere $\\mathbb{E}_{r}(N) = N^{-\\frac{1}{2}}$ ifr > \u00bd, $\\mathbb{E}_{r}(N) = N^{-\\frac{1}{2}} \\log N$ if r = 1, and $\\mathbb{E}_{r}(N) = N^{-r}$ ifr < .\nBut this result also illustrates the curse of dimensionality: the differentiability v needs to scale with\nthe input dimension $d_{in}$ to obtain a reasonable rate. If instead v is constant and $d_{in}$ grows, then the\nnumber of datapoints N needed to guarantee a generalization gap of at most $\\epsilon$ scales exponentially in\n$d_{in}$, i.e. $N \\sim \\epsilon^{-d_{in}}$. One way to interpret this issue is that regularity becomes less and less useful the\nlarger the dimension: knowing that similar inputs have similar outputs is useless in high dimension\nwhere the closest training point $x_i$ to a test point x is typically very far away."}, {"title": "4.1.1 Breaking the Curse of Dimensionality with Compositionality", "content": "To break the curse of dimensionality, we need to assume some additional structure on the data or task\nwhich introduces an 'intrinsic dimension' that can be much lower than the input dimension $d_{in}$:"}, {"title": "4.2 Breaking the Curse of Dimensionality with AccNets", "content": "Now that we know that composition of Sobolev functions can be easily learnable, even in settings\nwhere the curse of dimensionality should make it hard to learn them, we need to find a model that can\nachieve those rates. Though many models are possible \u00b2, we focus on DNNs, in particular AccNets.\nAssuming convergence to a global minimum of the loss of sufficiently wide AccNets with two types\nof regularization, one can guarantee close to optimal rates:\nTheorem 4. Given a true function $f_L*:1 = f_L* \\circ \\cdot\\cdot\\cdot \\circ f_1$ going through the dimensions $d_0, ..., d^*$,\nalong with a continuous input distribution $\\pi_0$ supported in B(0, $b_0$), such that the distributions $\\pi_e$\nof $f_l(x)$ (for $x \\sim \\pi_0$) are continuous too and supported inside B(0, $b_e$) $\\subset \\mathbb{R}^{d_e}$. Further assume\nthat there are differentiabilities $v_l$ and radii $R_l$ such that $||f^*||_{W^{v_e, 2}(B(0, b_e))} \\leq R_e$, and $p_e$ such that\n$Lip(f^*) \\leq p_e$. For an infinite width AccNet with L > $L^*$ and dimensions $d_l \\geq d^*, ..., d^* - 1$, we\nhave for the ratios $r_l = \\frac{v_l}{d_l + 3}$:\n(1) At a global min $f_{L:1}$ of $L_N(f_{L:1}) + \\lambda R(\\theta)$, we have $L(f_{L:1}) = \\tilde{O}(N^{-min\\{\\frac{1}{2}, r_1, ..., r_{L*}\\}})$.\n(2) At a global min $f_{L:1}$ of $L_N(f_{L:1}) + \\lambda \\tilde{R}(\\theta)$, we have $L(f_{L:1}) = \\tilde{O}(N^{-\\frac{1}{2} + \\sum_{l=1}^L max\\{0, r_e - 1\\}})$."}, {"title": "5 Conclusion", "content": "We have given a generalization bound for Accordion Networks and as an extension Fully-Connected\nnetworks. It depends on F\u2081-norms and Lipschitz constants of its shallow subnetworks. This allows us\nto prove under certain assumptions that AccNets can learn general compositions of Sobolev functions\nefficiently, making them able to break the curse of dimensionality in certain settings, such as in the\npresence of unknown symmetries."}, {"title": "A Experimental Setup", "content": "In this section, we review our numerical experiments and their setup both on synthetic and real-world\ndatasets in order to address theoretical results more clearly and intuitively.\nThe code used for experiments is publicly available here."}, {"title": "A.1 Dataset", "content": "The Mat\u00e9rn kernel is considered a generalization of the radial basis function (RBF) kernel. It\ncontrols the differentiability, or smoothness, of the kernel through the parameter $\\nu$. As $\\nu \\rightarrow \\infty$, the\nMat\u00e9rn kernel converges to the RBF kernel, and as $\\nu \\rightarrow 0$, it converges to the Laplacian kernel, a\n0-differentiable kernel. In this study, we utilized the Mat\u00e9rn kernel to generate Gaussian Process (GP)\nsamples based on the composition of two Mat\u00e9rn kernels, $K_g$ and $K_h$, with varying differentiability\nin the range [0.5,10]\u00d7[0.5,10]. The input dimension ($d_{in}$) of the kernel, the bottleneck mid-dimension\n($d_{mid}$), and the output dimension ($d_{out}$) are 15, 3, and 20, respectively.\nThis outlines the general procedure of our sampling method for synthetic data:\n1. Sample the training dataset $X \\in \\mathbb{R}^{D \\times d_{in}}$\n2. From X, compute the D \u00d7 D kernel $K_g$ with given $\\nu_g$\n3. From $K_g$, sample $Z \\in \\mathbb{R}^{D \\times d_{mid}}$ with columns sampled from the Gaussian $\\mathcal{N}(0, K_g)$.\n4. From Z, compute $K_g$ with given $\\nu_h$\n5. From $K_h$, sample the test dataset $Y \\in \\mathbb{R}^{D \\times d_{out}}$ with columns sampled from the Gaussian\n$\\mathcal{N}(0, K_h)$.\nWe utilized four AMD Opteron 6136 processors (2.4 GHz, 32 cores) and 128 GB of RAM to generate\nour synthetic dataset. The maximum possible dataset size for 128 GB of RAM is approximately\n52,500; however, we opted for a synthetic dataset size of 22,000 due to the computational expense\nassociated with sampling the Mat\u00e9rn kernel. This decision was made considering the time complexity\nof $O(n^3)$ and the space complexity of $O(n^2)$ involved. Out of the 22,000 dataset points, 20,000 were\nallocated for training data, and 2,000 were used for the test dataset"}, {"title": "B AccNet Generalization Bounds", "content": "The proof of generalization for shallow networks (Theorem 1) is the special case L = 1 of the proof\nof Theorem 2, so we only prove the second:\nTheorem 5. Consider an accordion net of depth L and widths $d_1, ..., d_0$, with corresponding set\nof functions $\\mathcal{F} = \\{f_{L:1} : ||f_l||_{F_1} < R_l, Lip(f_l) \\leq p_l\\}$ with input space $\\Omega = B(0,r)$. For any\n$\\rho$-Lipschitz loss function $l(x, f(x))$ with $|l(x, y)| \\leq c_0$, we know that with probability 1 \u2013 \u03b4 over the\nsampling of the training set X from the distribution \u03c0, we have for all $f \\in \\mathcal{F}$\n$\\mathcal{L}(f) - \\hat{\\mathcal{L}}_N(f) \\leq C p \\mathcal{L}_{L:1} r \\sum_{l'=1}^{L} \\frac{R_{l'}}{\\rho_{l'}} \\sqrt{d_{l'} + d_{l'-1}} \\frac{\\log N}{\\sqrt{N}} (1 + o(1)) + c_0 \\sqrt{\\frac{2\\log 2/\\delta}{N}}$\nProof. The strategy is: (1) prove a covering number bound on $\\mathcal{F}$ (2) use it to obtain a Rademacher\ncomplexity bound, (3) use the Rademacher complexity to bound the generalization error."}, {"title": "C Composition of Sobolev Balls", "content": "Proposition 8 (Proposition 3 from the main.). Given a distribution \u03c0 with support in B(0,r), we\nhave that with probability 1 \u2013 \u03b4 for all functions $f \\in \\mathcal{F} = \\{f : ||f||_{W^{v,2}} \\leq R, ||f||_{\\infty} \\leq R\\}$\n$\\mathcal{L}(f) - \\hat{\\mathcal{L}}_N(f) \\leq 2 C_1 R \\mathbb{E}_{v/d}(N) + c_0\\sqrt{\\frac{2 \\log 2/\\delta}{N}}$\nwhere $\\mathbb{E}_{r}(N) = N^{-\\frac{1}{2}}$ ifr > \u00bd, $\\mathbb{E}_{r}(N) = N^{-\\frac{1}{2}} \\log N$ if r = 1, and $\\mathbb{E}_{r}(N) = N^{-r}$ ifr < ."}, {"title": "D Generalization at the Regularized Global Minimum", "content": "In this section, we first give the proof of Theorem 5 and then present detailed proofs of lemmas used\nin the proof. The lemmas are largely inspired by [5] and may be of independent interest."}, {"title": "D.1 Theorem 5 in Section 4.2", "content": "Theorem 9 (Theorem 5 in the main.). Given a true function $f_{L*}:1 = f_{L*^} \\circ ... \\circ f_{1}$ going through the\ndimensions $d^*,..., d^*$, along with a continuous input distribution $\\pi_0$ supported in B(0, b), such\nthat the distributions $\\pi_e$ of $f_l(x)$ (for $x \\sim \\pi_0$) are continuous too and supported inside B(0, b) $\\subset$\n$\\mathbb{R}^{d_e}$. Further assume that there are differentiabilities $v_l$ and radii R such that $||f^*||_{W^{v_e, 2}(B(0, b_e))} \\leq$\n$R_l$, and p such that Lip(f) $\\leq p_e$. For an infinite width AccNet with L > $L^*$ and dimensions\n$d_l \\geq d^*,..., d^* - 1$, we have for the ratios $r_l = \\frac{v_l}{d+3}$:\n(1) At a global min $f_{L:1}$ of $L_N(f_{L:1}) + \\lambda R(\\theta)$, we have $L(f_{L:1}) = \\tilde{O}(N^{-min\\{\\frac{1}{2}, r_1, ..., r_{L*}\\}})$.\n(2) At a global min $f_{L:1}$ of $L_N(f_{L:1}) + \\lambda \\tilde{R}(\\theta)$, we have $L(f_{L:1}) = \\tilde{O}(N^{-\\frac{1}{2} + \\sum_{l=1}^L max\\{0, r_e - 1\\}})$.\nProof. If $f* = f_{L*^} \\circ ... \\circ f_{1}$ with $L^* < L$, intermediate dimensions $d^*,..., d^*$, along with a\ncontinuous input distribution $\\pi_0$ supported in B(0, b), such that the distributions $\\pi_e$ of $f_l(x)$ (for\n$x \\sim \\pi_0$) are continuous too and supported inside B(0, b) $\\subset \\mathbb{R}^{d_e}$. Further assume that there are\ndifferentiabilities $v_l$ and radii R such that $||f^*||_{W^{v_e, 2}(B(0, b_e))} \\leq R_e$.\nWe first focus on the L = $L^*$ case and then extend to the L > $L^*$ case.\nEach $f_l$ can be approximated by another function $f_l$ with bounded F\u2081-norm and Lipschitz constant.\nActually if $2v \\geq \\frac{d-1}{2} + 3$ one can choose $f_l = f^l$ since $||f^l||_{F1} \\leq C_l R_l$ by Lemma 14, and by\nassumption Lip($f_l$) $\\leq p_e$. If $2v < \\frac{d-1}{2} + 3$, then by Lemma 13 we know that there is a $f_l$ with\n$||f_l|| \\leq C_l R_l \\epsilon \\frac{d+3-2v}{2}$ and Lip($f_l$) $ C_l$Lip($f_l$) and error\nTherefore the composition $f_{L:1}$ satisfies"}, {"title": "D.2 Lemmas on approximating Sobolev functions", "content": "Now we present the lemmas used in this proof above that concern the approximation errors and\nLipschitz constants of Sobolev functions and compositions of them. We will bound the F2-norm and\nnote that the F2-norm is larger than the F\u2081-norm, cf. [5, Section 3.1].\nLemma 10 (Approximation for Sobolev function with bounded error and Lipschitz constant).\nSuppose g: $\\mathbb{S}^d \\rightarrow \\mathbb{R}$ is an even function with bounded Sobolev norm $||g||_{W^{v,2}} < R$ with $2v < d + 2$,\nwith inputs on the unit d-dimensional sphere. Then for every $\\epsilon$ > 0, there is \u011d $\\in \\mathcal{G}_2$ with small\napproximation error ||g - \u011d||L2(Sa) = C(d,v)Re, bounded Lipschitzness Lip(\u011d) \u2264 C'(d)Lip(g),\nand bounded norm"}, {"title": "D.3 Lemma on approximating compositions of Sobolev functions", "content": "With the lemmas given above and the fact that the $\\mathcal{F"}, 2, "norm upper bounds the $\\mathcal{F}_1$-norm, we can find\ninfinite-width DNN approximations for compositions of Sobolev functions, which is also pointed out\nin the proof of Theorem 5.\nLemma 11. Assume the target function $f: \\Omega \\rightarrow \\mathbb{R}^{d_{out}}$, with $\\Omega \\subseteq B(0,b) \\subseteq \\mathbb{R}^{d_{in}}$, satisfies:\n\u2022  $f = g_k \\circ ... \\circ g_1$ a composition of k Sobolev functions $g_i: \\mathbb{R}^{d_i} \\rightarrow \\mathbb{R}^{d_{i+1}}$ with bounded\nnorms $||g_i||_{W^{v_i, 2}} < R$ for i = 1, ..., k, with $d_1 = d_{in}$;\n\u2022 f is Lipschitz, i.e."]}