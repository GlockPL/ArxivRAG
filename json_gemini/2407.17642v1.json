{"title": "SMA-Hyper: Spatiotemporal Multi-View Fusion Hypergraph Learning for Traffic Accident Prediction", "authors": ["Xiaowei Gao", "James Haworth", "Ilya Ilyankou", "Xianghui Zhang", "Tao Cheng", "Stephen Law", "Huanfa Chen"], "abstract": "Predicting traffic accidents is the key to sustainable city management, which requires effective address of the dynamic and complex spatiotemporal characteristics of cities. Current data-driven models often struggle with data sparsity and typically overlook the integration of diverse urban data sources and the high-order dependencies within them. Additionally, they frequently rely on predefined topologies or weights, limiting their adaptability in spatiotemporal predictions. To address these issues, we introduce the Spatiotemporal Multiview Adaptive HyperGraph Learning (SMA-Hyper) model, a dynamic deep learning framework designed for traffic accident prediction. Building on previous research, this innovative model incorporates dual adaptive spatiotemporal graph learning mechanisms that enable high-order cross-regional learning through hypergraphs and dynamic adaptation to evolv- ing urban data. It also utilises contrastive learning to enhance global and local data representations in sparse datasets and employs an advance attention mechanism to fuse multiple views of accident data and urban functional features, thereby enriching the contextual understanding of risk factors. Extensive testing on the London traffic accident dataset demonstrates that the SMA-Hyper model significantly outperforms baseline models across various temporal horizons and multistep outputs, af- firming the effectiveness of its multiview fusion and adaptive learning strategies. The interpretability of the results further underscores its potential to improve urban traffic management and safety by leveraging complex spatiotemporal urban data, offering a scalable framework adaptable to diverse urban environments.", "sections": [{"title": "1. Introduction", "content": "Urban traffic management is increasingly challenged by the rapid growth in vehicle numbers and the expansion of road networks, driven by urban economic development and changes in transportation systems. This surge in traffic activity increases the risk of exposure to road accidents, which remain a major public health concern. According to the latest report by the World Health Organisation (WHO), road traffic accidents result in approximately 1.19 million deaths annually worldwide, dispro- portionately affecting vulnerable road users (WHO, 2023). Furthermore, data from the Department for Transport in the UK reveal that despite reduced mobility during the COVID-19 pandemic, the pattern of road injuries from 2018 to 2022 has shown little variation, with such injuries costing nearly 1.5% of the annual GDP (DfT, 2023). These accidents not only compromise public safety but also af- fect the sustainability and efficiency of urban environments and transportation systems, underscoring the critical need for improved predictive methodologies to prevent such incidents (UNECE, 2019).\nThe increasing complexity of urban traffic management requires the development of precise models for predicting traffic accidents, crucial for implementing proactive measures that improve both safety and efficiency. Traditionally, accident prediction has predominantly employed time series methods such as Autoregressive Integrated Moving Average (ARIMA) (Ihueze and Onwurah, 2018), Gated Recurrent Unit (GRU) (Zhang et al., 2020), and Long Short-Term Memory (LSTM) networks (Ren et al., 2018; Yuan et al., 2018). Although effective in capturing temporal dynamics, these approaches often overlook significant geographical factors, thus restricting their ability to fully comprehend the intricacies required for accurate predictions. Recent advancements have shifted focus towards integrat- ing spatial relationships, with Graph Neural Networks (GNNs) proving particularly effective in urban settings. Urban environments, with their complex interconnected layouts, are naturally represented as graphs, where nodes signify geographic locations, and edges represent spatial relationships between them. This allows Graph Convolutional Networks (GCNs) (Trirat et al., 2023) and spatiotemporal graph neural networks (ST-GNNs) (Zhou et al., 2020a; Karim et al., 2022; Rahmani et al., 2023) to model intricate spatial relations essential for understanding traffic dynamics. ST-GNNs, renowned for their ability to uncover nonlinear spatiotemporal relationships, significantly improve the understand- ing of multiviews contributing to traffic accidents. Their ability to incorporate heterogeneous urban data dimensions further facilitates big data-driven modelling solutions (Zhang and Cheng, 2020).\nDespite these technological advances, the common issue in the prediction of traffic accidents is the sparsity in both spatial and temporal dimensions, with incidents that occur nonperiodically in a few locations at particular times. Advanced data enhancement strategies, such as Prior Knowledge- based Data Enhancement (PKDE) proposed by Zhou et al. (2020b), have proven to be a promising direction in enriching the data discrimination to better meet the model requirements for effective local neighbourhood information aggregation. Furthermore, the adoption of graph attention techniques uses attention scores to refine node aggregation processes, improving the detection of relationships among localised similar nodes (Zhou et al., 2020a; Yu et al., 2021). Nevertheless, despite the well-addressed sparsity, there are still several unresolved challenges in traffic accident prediction that necessitate further research to enhance the effectiveness of predictive models for urban traffic management:\n\u2022 Inadequacy of Conventional Pairwise Relations: Traditional graph models in urban ana- lytics primarily focus on pairwise interactions, limiting analyses to localised relationships between pairs of nodes. Geographic correlations from points of interest (POIs), as shown in Figure 1a,"}, {"title": "2. Literature Review", "content": "2.1. Deep Learning for traffic accident prediction\nEarly efforts in traffic accident prediction used mainly statistical models or traditional machine learning techniques, which often struggled with the complexity and heterogeneity of large datasets and overlooked crucial spatiotemporal correlations (Ali et al., 2024). With the advent of advanced artificial intelligence technologies, a shift toward deep learning methods has occurred, leveraging their capacity to unravel complex non-linear spatiotemporal relationships within traffic accident data.\nRecurrent Neural Networks (RNNs), especially Long Short-Term Memory (LSTM) networks, have been widely adopted for their efficacy in capturing temporal dynamics. In contrast, convolutional neural networks (CNNs) have been applied to spatial analysis. For instance, Ren et al. (2018) pioneered the use of LSTM to analyse temporal sequences of traffic accidents, but limited their spatial analysis to basic fully connected layers. Addressing this shortfall, Yuan et al. (2018) introduced the Heterogeneous Convolutional LSTM (Heter-ConvLSTM), integrating various urban and external characteristics to better delineate accident risks, albeit within constrained scenarios like their Iowa case study. Further developments led to Moosavi et al. (2019) integrating LSTM with a latent training representation of POI data and historical traffic event descriptions to capture spatial heterogeneities more effectively. Najjar et al. (2017) were pioneers in using CNNs to process spatial data derived from satellite imagery to pinpoint accident locations, though their model lacked temporal integration.\nDespite the progress, traditional CNNs and RNNs have limitations in capturing extensive spa- tiotemporal interactions, often restricting their effectiveness to local information learning without broader contextual understanding (Cui et al., 2024). Graph Neural Networks (GNNs) have subse- quently emerged as a robust solution, adept at encapsulating both localised and expansive spatiotem- poral dependencies through the inherent connectivity of urban frameworks. This comprehensive ap- proach enhances the understanding of traffic patterns and facilitates detailed city-wide predictions. For instance, Zhou et al. (2020a) utilised a Differential Time-varying Graph Neural Network (DTGN), complemented by a knowledge-based data enhancement strategy, to address zero-inflated data issues. They, along with Zhou et al. (2020b) and Wang et al. (2021), implemented multigranularity risk prediction models that define regions with varying grid sizes, proposing to simultaneously predict at different scales. However, this approach has raised feasibility concerns due to the complexity of man- aging predictions across multiple spatial resolutions effectively. Moreover, recent studies like those by Trirat et al. (2023) and Yu et al. (2021) have opted for single-grid size approaches. Yu et al. (2021) em- ployed spatial convolution layers combined with temporal convolution layers to achieve sophisticated spatiotemporal representations, whereas Trirat et al. (2023) leveraged a multiview fusion mechanism with attention mechanisms and a Transformer to learn temporal dependencies. Each approach high- lights distinct advantages and challenges in capturing urban dynamics but indicates that relying on a single grid size may offer more consistency in model performance across various urban configurations.\nHowever, all current GNN models are based on predefined matrices and manually selected grids, which is limited in adapting to the evolving urban environment and accurately predict traffic accidents in different contexts.\n2.2. HyperGraph Learning Methods in Urban Prediction\nTraditional graph-based models often rely on localised pairwise interactions between nodes, which can restrict the scope of information propagation and fail to capture complex multi-node relationships"}, {"title": "3. Methodology", "content": "3.1. Preliminary\n(i) Pairwise Urban Graph: Under this graph structure, the signals of nodes are transmitted through edges toward another node. As shown in Figure 2a, an undirected graph G(V,E) represents the spatial connectivity between urban regions, with the city divided into N subregions. Here, V\u2208 RN denotes the set of vertices, each corresponding to a subregion, and E \u2208 RN\u00d7N represents the set of edges, indicating connections between pairs of subregions. The adjacency matrix A\u2208 RN\u00d7N characterises the spatial relationships between subregions, defined as Ai,j = 1 if subregions i and j are connected, and Ai,j = 0 otherwise.\n(ii) Setwise Urban Hypergraph: Under this graph structure, the signals of nodes are propagated within hyperedges toward a cluster of nodes. As shown in Figure 2b, a hypergraph is defined as G(V, E, W), where V \u2208 RN represents the nodes (subregions), \u00ca \u2208 RNXI denotes the set of hyperedges capable of linking multiple nodes simultaneously, and W corresponds to the weights of these hyperedges. A hyperedge captures higher-order spatial dependencies, allowing advanced representations for the global relationships through hypergraph information propagations among each region and corresponding hyperedges.\n3.2. Problem Definition\nGiven the adaptive graph and also the adaptive hypergraph G\u2208 (G,\u011c) of the city, the input is the historical accident risk series Xt for t = 1,2,...,T, the output is to predict the accident risk score, resulting from yn,t, for each subregion in the next time intervals T. Formally, the problem can be formulated as finding a function Pe(\u00b7) such that:\nPe()\n[Xt; G] \u2192 [Yt+1,..., Yt+T] (1)\nwhere Pe() : RN\u00d7T \u2192 RN\u00d77 is the target function mapping from spatiotemporal features of the past T steps to the predicted accident risk in the next steps. O represents the learnable parameters and Yt \u2208 RN is the accident risk score metrics for all nodes in the time step t.\n3.3. Tackling Sparse Accident Data\nA significant challenge in the prediction of fine-grained traffic accidents is zero inflation. To address this, we use the PKDE method to augment zero-value data, which was proposed by Zhou et al. (2020b,a). This approach adjusts zero-value elements based on statistical accident information across different subregions, incorporating prior knowledge by assigning negative lower risk scores to nonaccident instances and positive higher scores to accident instances to improve the model's ability to discriminate accident risk levels. Specifically, we replace the risk of zero value for the subregion i in each time interval with the negative statistical intensity of the accident \u03c0i: \u03c0i = b\u2081 log2 \u20aci + b2. Here, i represents the statistical accident indicator that quantifies the accident risk of subregion i. The coefficients b\u2081 and b2 ensure that the range of \u03c0i reflects the situation of actual risk levels. The zero value elements are therefore adjusted based on the proportion of the total risk level of the subregion and assigned to the range [-1,0] through the logarithmic and linear transformations described above. Nonzero values are normalised to the interval [0, 1], thereby preserving the rank of actual accident risks. It enhances the distinction between positive and negative samples by making the accident intensity value negative and distinct.\n3.4. Spatiotemporal Multiview Adaptive HyperGraph Learning Framework\nIn this section, we describe the details of the proposed SMA-Hyper model, an adaptive framework for predicting traffic accidents, as illustrated in Figure 3, it is primarily composed of four main modules:\n1) Multiview adaptive graph and hypergraph construction: Graphs and hypergraphs are con- structed based on spatial relationships, urban features, and accident sequences, capturing low-order and high-order relationships between subregions, respectively. 2) Multiview spatiotemporal feature encoder: In the multiview context, the propagation of accident characteristics between pairwise edges and setwise hyperedges captures the complex spatiotemporal correlations of accident occurrences. 3) Temporal decoder: Integrating external characteristics, the spatiotemporal embedding vectors of each subregion are decoded through gated convolutions to generate predictions for future accident sequences. 4) Local-global contrastive learning: The contrastive learning between multiview graphs and hypergraphs offers additional self-supervisory signals to the model, mitigating the negative impact of data sparsity on model learning.\nDetailed information and calculation processes are outlined below."}, {"title": "3.4.1. Multiview AdaptiveGraph and Hypergraph Learning", "content": "Multiview Graph Embedding Traditional ST-GNN models often rely on predefined topologies based on spatial connections or interaction weights. This approach lacks comprehensive geographic relationships and depends on a single criterion, which limits its ability to generalize across scenarios involving both static and dynamic urban features (Wang et al., 2024; Xiong et al., 2023). Additionally, defining these criteria requires specific spatial knowledge, which is not always available or easily generalizable, especially when multiple types of views are considered. Inspired by Tobler's first law and the third law of geography, which suggest that closer spatial distances lead to similar target labels and that long-distance spatial interactions can occur with similar urban configurations, we propose adaptive conventional graph structure definitions to incorporate evolving configurations from multiple views rather than relying on a single criterion.\nTo be specific, for static urban features including POI and the complexity of the road network, we employ fully connected layers to achieve characteristic mapping and denote them as Us, s \u2208 {P, R}. Meanwhile, the similarity of historical accident sequences can also provide effective information for uncovering correlations between different sub-regions. Due to the dynamic nature of the sequences, we utilise a combination of stacked convolutional layers and fully connected layers to generate its embedding(Zhang et al., 2022), and denote it as UT.\nAfter embedding, the non-Euclidean spatiotemporal correlations between sub-regions are mapped through multiple views: accident spatial view, accident temporal view, POI view and road view, with each view is constructed by the pairwise graph As and the setwise hypergraph Hs, where s denotes different views.\nPairwise Graph Construction Accident spatial view reflects the impact of spatial proximity on accident prediction. According to Tobler's First Law of Geography, two adjacent regions tend to exhibit a closer spatiotemporal correlation. Therefore, we utilize the adjacency matrix A as the topology for this view and denote it as AS.\nFor the construction of the remaining three views based on adaptive manner, the extracted features mentioned above are used to establish connections between sub-regions based on the geography's third law (Zhu et al., 2018). For instance, two sub-regions with similar POI distribution or historical accident sequences may share similar accident patterns. Hence, the product of features is applied to measure the similarity, after which the activation function Tanh(\u00b7) and Relu(\u00b7) are used to scale the values to [-1,1] and eliminate unwarranted negative values:\nAs = Relu(Tanh(UUsT)), (2)\nwhere s here represents the accident temporal view, POI view and road view, respectively.\nFor each sub-region, aggregating information from thousands of other sub-regions may introduce a significant amount of noise, thereby reducing predictive performance. Therefore, we set a threshold k for the maximum number of edges related to each sub-region to control the sparsity of graph. Specifically, we first sort the values in each row of matrix As and retain only the top k values:\nindices\u2081 = topk(A[i, :]), i = 1, 2, ..., N (3)\nA\u00b3[i, :] = A[i, indicesi], i = 1, 2, ..., N (4)"}, {"title": "3.4.2. Multi-View Spatio-temporal Features Encoder", "content": "The extraction of complex spatiotemporal features based on learned multi-view graphs and hy- pergraghs presents the next challenge. Graph Convolutional Network (GCN) is a technique widely employed in the field of spatiotemporal data mining, which facilitates the learning of spatial depen- dencies by aggregating signals from adjacent nodes. In contrast, Heterogeneous Graph Convolutional Network (HGCN) operates based on high-order relationships within hypergraphs, contributing to the generation of a more robust spatial representation. In this context, we propose the multi-view spatio-temporal features encoder illustrated in Figure 3 (b), which encompasses both graph-based and hypergraph-based encoders. Each encoder module is composed of a \"sandwich\" structure compris- ing gated temporal convolution blocks and spatial convolution blocks. Lastly, the spatial features extracted by spatial convolution blocks are integrated through an attention based fusion block.\nAccident Embedding Firstly, an embedding layer is applied to the input X to generate the initial representation of the historical accident sequence. Specifically, each element in X is multiplied by a randomly initialized vector e to obtain its representation: En,t = Xn,t. e.\nGated Temporal Convolution Block The prediction of accident risks is inherently a time series forecasting problem. hence, we extract temporal features of accident sequences through a dedicated temporal learning block, names GTC (Gated Temporal Convolution) block. Specifically, the temporal learning block consists of two stacked temporal convolution modules, each of which models the contextual information of the sequence via a gating mechanism to enhance the expressiveness. The equation for each temporal convolution module is as follows:\ngt(Ein) = sigmoid(W1Ein + b1) (9)\nEout = (1 - gT(Ein)) \u00b7 Ein + gt(Ein) \u00b7 (W2Ein + b2) (10)\nwhere Eout represents the output of the time learning block in layer 1. gt(\u00b7) denotes the gating unit, which facilitates the fusion of residual connections and learned features. Lastly, W1, W2 and b1, b2 are the learnable parameters of the convolutional layers.\nGraph Convolution Block Extensive research in the past has demonstrated that Graph Convo- lutional Network (GCN) possesses remarkable capabilities in learning and aggregating spatial relation- ships. Based on the constructed multi-view topology, stacked graph convolutional blocks are capable of capturing spatial relationships ranging from one-hop to multi-hops. The spatial convolution block is defined as follows:\nEout = ReLU(AS Ein W3), (11)\nwhere As is the normalized adjacency matrix in view s, and Eout is the hidden representation obtained therefrom. W3 represents the weights of the corresponding convolutional kernels. It is worth noting that graph convolution block generates corresponding representations under the topology of 4 views respectively. Consequently, we can derive multi-view representations: E, s \u2208 {S,T, P, R}.\nHypergraph Convolution Block In previous works, the higher-order relationships between sub- regions have been overlooked. Hypergraph convolution can uncover the high-order spatial relationships between sub-regions, thereby achieving more advanced representations. Unlike graph convolution, hypergraph convolution calculates based on the incidence matrix and can be expressed as:\nEout = ReLU(DR-1/2 HST DE-1/2 ReLU(D\u00b0\u22121/2 Hs D\u00b0R-1/2 Ein W4)) (12)\nwhere DR and De denote diagonal degree matrices of H\u00ba,s \u2208 {S,T, P, R}. WH denotes the weights of the hypergraph convolution. Similarly, based on the incidence matrix Hs constructed under 4 views mentioned above, we can obtain the corresponding hypergraph representations \u00ca\u00ba, s \u2208 {S,T, P, R}.\nAttention-based Multi-View Features Fusion Block: For different accident sequence pat- terns, it is necessary to pay closer attention to specific views, where the multi-head attention mech- anism can assist in capturing the complex relationships among them. For adaptive pairwise graphs"}, {"title": "3.4.3. Temporal Decoder Incorporating External Features", "content": "Dynamic external features encompass weather and calendar information. Extremes in weather conditions, such as rain and snow, may result in a further increase in accident risk. Similarly, during specific time periods within a week, heavier traffic congestion may also increase the risk of accidents Hence, when decoding, dynamic external features should be incorporated as part of the input and fused with encoder outputs, and we can obtain the decoder outputs as follows:\nEdecoder = GTC([Fencoder, WM XM, WCXC]), (17)\nwhere GTC(\u00b7) indicates the gated temporal convolution block. [] refers to the concatenation option, in which XM, XC are matrices of external features, and WM, WC are learnable parameters of external features embedding. Following this, we can obtain the decoder outputs Edecoder and Edecoder, respectively, based on the outputs of the graph encoder and hypergraph encoder.\nFinally, incorporating urban features including POI and road statistical information is crucial for prediction as well. For instance, certain specific POIs such as supermarkets and hospitals, due to their surroundings with higher traffic density, may lead to a higher level of accident risk. Therefore, the last prediction layer can be modeled as:\nY = FC(ReLU(FC([Edecoder, WP XP, WRXR]))) (18)"}, {"title": "3.4.4. Local-Global Contrastive Learning", "content": "The local spatio-temporal encoder based on pairwise graph is capable of aggregating local infor- mation from multiple hops through multi-layer graph convolutions, while the global spatio-temporal encoder based on setwise hypergraph can facilitate higher-order cross-region information learning. To facilitate the alignment and integration of the information of local and global encoders, we employ cross-view contrastive learning. It promotes the collaborative supervision between the local and global encoders through self-supervised learning, thereby providing additional supervisory signals and miti- gating the impact of data sparsity. Moreover, the resultant more robust spatio-temporal embeddings can reduce the influence of input noise.\nSpecifically, in our cross-view contrastive learning module, embeddings based on pairwise graphs and embeddings based on setwise hypergraphs from the same view and the same sub-region are treated as positive samples, while those from different views or sub-regions are considered negative samples. Consequently, the loss function can be formulated as follows:\nLN\nL(C) = \u03a3\u03a3\u03a3 log exp(cos(Ens, En\u00b3))\nS l=1 n=1 \u03a3\u03b7' exp(cos(Ens, E)) (19)\nIn which s \u2208 {S,T, P, R} represents spatial accident view, temporal accident view, POI view and Road view, respectively, and L is a hyperparameter that denotes the number of stacked layers of multi-View spatio-temporal features encoder."}, {"title": "3.4.5. Model Optimisation", "content": "In the model optimisation process, we employ the Mean Squared Error (MSE) function to gauge the accuracy of the prediction results. Incorporating the aforementioned contrastive learning loss, the ultimate joint loss function obtained is as follows:\nL = \u2211(Y \u2212 \u0176)\u00b2 + 11L(C) + 12||O||2 (20)\nwhere Yt and Yt represent the actual and predicted accident risk scores, respectively. O denotes the learnable parameters, and a regularisation loss based on the L2 norm is applied to prevent overfitting. Lastly, A\u2081 and A2 are hyperparameters, representing the weights for contrastive learning loss and the regularisation loss, respectively."}, {"title": "4. Experiments", "content": "4.1. Dataset\nThe proposed SMA-Hyper model was evaluated using London traffic accident data from the STATS19 dataset\u00b9, officially published by the Department of Transport, UK. This dataset is collected from police reports, so incidents without injuries are not included. The dataset provides detailed in- formation about the vehicles and casualties involved, as well as the geographical location and time of each incident. The data were pre-processed and formatted using the R package 'stats19' by Lovelace et al. (2017).\nFor this study, we used a total of 23,096 accidents in London from 1 January to 31 December 2021. The breakdown of accident severity is as follows: slight accidents account for 19,624 incidents (84.97%), serious accidents for 3,399 incidents (14.72%), and fatal accidents for 73 incidents (0.31%).\nFor the spatial unit, we used Middle Super Output Areas (MSOAs), which are official census units with an average area of 19 square kilometers. Unlike manually divided grids, MSOAs offer several advantages for deep learning embeddings: (1) Consistency with Demographic Data: MSOAS are designed to be consistent with demographic data, providing a robust framework for integrating socio-economic variables into the model. This improves the model's ability to learn complex exposure patterns related to traffic accidents. (2) Population homogeneity: MSOAs contain populations that are relatively homogeneous in terms of socio-economic characteristics. This helps reduce variability within each unit, making the model's learning process more effective. (3) Administrative Relevance: Using MSOAS aligns the model with administrative boundaries, which is beneficial for policy-making and urban planning. Local authorities can directly use predictions made by the model for targeted interventions. (4) Geographic accuracy: MSOAs provide more accurate geographical representations compared to grid-based divisions. They account for natural and built environment features, which are crucial for accurately capturing the spatial dynamics of traffic accidents.\nTherefore, we spatially joined the traffic accident data points to a total of 1,002 MSOAs, with temporal prediction resolutions of 24 hours and 12 hours, respectively.\nFor multiview urban configuration, we used POI data and road network data from Ordnance Survey through the Digimap platform\u00b2. Meteorological data was obtained from the MIDAS platform\u00b3, providing hourly weather information. Calendar information was automatically generated using the Python package 'holidays'4."}, {"title": "4.2. Baselines", "content": "For a comprehensive comparison, we choose four major types of model with in total 9 models as the baselines and SOTA models. The details are listed below.\n\u2022 Traditional Models\nARIMA (Box et al., 1976): The Autoregressive Integrated Moving Average (ARIMA) is a classical model used for time series prediction. It predicts future accidents based on the average of historical accident risk as well as autoregressive patterns.\nSVR (Drucker et al., 1996): Support Vector Regression (SVR) is a variant of Sup- port Vector Machine (SVM) designed for regression tasks. It predicts future sequences by training an optimal regression curve and allows accident data points to deviate from the regression curve to enhance generalisation capabilities.\n\u2022 Spatial/Temporal Deep Learning Models\nHetero-Convlstm (Yuan et al., 2018): The Convolutional Long Short-Term Mem- ory (Hetero-ConvLSTM) network is the first model to address the spatial heterogeneity challenge in the large amount of accident data, while handling long-term dependencies.\nGRU (Cho et al., 2014): The Gated Recurrent Unit (GRU) is a variant of RNNs with fewer parameters and a simpler structure compared to the traditional LSTM. It uses two gates, the update gate and the reset gate, to manage the flow of information.\nGCN (Kipf and Welling, 2016): The Graph Convolutional Network (GCN) is a clas- sical spatial learning model capable of aggregating feature information from surrounding locations layer by layer.\n\u2022 Spatiotemporal Graph Models\nSTGCN (Yu et al., 2017): The Spatiotemporal Graph Convolutional Network (STGCN) leverages spatial convolutions to aggregate feature information from adjacent geographical locations and gated convolutions to enhance temporal feature extraction, making it popular for spatiotemporal data mining.\nDSTGCN (Yu et al., 2021): The Deep Spatio-Temporal Graph Convolutional Network (DSTGCN) integrates spatial learning layers and spatiotemporal learning layers to learn from static and dynamic data. Consider both the accident sequence and the influence of external factors, representing the state of the art in this category.\n\u2022 Spatiotemporal HyperGraph Models\nHyGCN (Wang and Zhu, 2024): The Hybrid Graph Convolutional Network (HyGCN) represents state-of-the-art work in hypergraphs-based urban computing. It captures higher- order relationships, achieving a spatial fusion of pairwise lower-order and higher-order re- lationship features in urban mobility flow predictions."}, {"title": "4.3. Results", "content": "4.3.1. Overall Performance\nTo comprehensively evaluate the effectiveness of the proposed SMA-Hyper model, we conducted experiments on two temporal scales of the London accident dataset: 12-hour and 24-hour intervals. For these experiments, the model uses 12 input steps to generate multi-step predictions over 6 output steps. The sparsity of the data is indicated by the ratio of non-zero instances within the tensor of each dataset, reflecting the inherent challenges of predicting rare events.\nMultiStep Overall Performance: Table 1 summarises the performance metrics of the models, averaged over the multiple time horizons. This provides a clear comparison of the overall predictive accuracy of each model across multiple time horizons. Our SMA-Hyper model consistently demon- strates superior average performance compared to both traditional and state-of-the-art baseline mod- els. Specifically, it achieves over 50% improvement in regression metrics such as RMSE and MAE, and approximately 13.79% and 13.96% improvements in accurately identifying scenarios where accidents occurred within the predicted high-risk regions. In particular, Table 1a shows that the SMA-Hyper model yields more accurate prediction results for the 12-hour interval compared to the 24-hour in- terval. However, the improvements are more pronounced in the 24-hour interval, which has a higher occurrence of accidents (6.01% non-zero instances) as indicated in Table 1b. The increased improve- ment in the 24-hour interval can be attributed to the higher volume of accidents, providing a richer accident scenario that allows the model to be sensitive to accident patterns.\nHowever, despite the greater improvements, the 24-hour interval data show less accuracy compared to the 12-hour data. This is likely due to the coarser temporal resolution of the 24-hour interval, which aggregates accident data over longer periods, potentially smoothing out finer details that could be crucial for precise predictions. The 12-hour interval, with its finer temporal granularity, retains more detailed encoding information about accident occurrences, leading to higher accuracy in predic- tions. In particular, the adaptive graph learning component and the contrastive fusion of multi-urban views in both setwise graph and pairwise Hypergraph modules enable our model to effectively learn spatial heterogeneities and overcome spatial-temporal oversmoothing issues associated with sparsity. This results in better recall scores for accident identification(around 40% in both temporal resolu- tion datasets), demonstrating the robustness and effectiveness of the SMA-Hyper model in handling complex urban traffic accident prediction tasks with multi-urban views.\nMoreover, in the baseline models, we observe an overall inferior performance with the 24-hour data compared to the corresponding 12-hour data, due to the fact that there are less data available for sufficient training with coarse-grained temporal levels. Despite this, the hypergraph-based models continue to lead the baselines in individual metrics. In particular, SST-DHL, the state-of-the-art hypergraph model for accident prediction, demonstrates a promising approach in predicting overall accident risk scores with lower errors in RMSE among all baselines. However, its performance is restricted by relying solely on self-supervised learning from historical accident data, lacking integration of urban configuration views (Cui et al., 2024).\nThe STGCN model shows the highest Recall performance compared to hypergraph-based baseline models. This superior Recall performance can be attributed to the effective use of spatial convolutions by STGCN, which aggregate feature information from adjacent geographical locations, and gated convolutions with enhanced temporal feature extraction. This dual approach allows STGCN to capture more relevant spatiotemporal patterns, making it more adept at identifying high-risk regions where"}, {"title": "4.3.3. Ablation Studies with Model Configurations", "content": "To evaluate the impact of various components within our framework, including PKDE for mitigat- ing imbalanced accident labels, contrastive learning, attention mechanisms, and hypergraph learning, an ablation study was conducted. This study aimed to evaluate the contributions of these components to the predictive precision of urban traffic accidents while integrating two urban configurations (POI and Roads) for comprehensive node representation. Each variable was individually added, while all other modules were kept constant, as shown in Figure 8.\nIn general, PKDE demonstrated the most significant positive impact on the improvement of the SMA-Hyper model, resulting in substantial reductions across all metrics, particularly with an increase in recall of more than 10%. It is important to note that the baseline models referred to in Table 1 were all tested without the PKDE strategy. However, even when this strategy is eliminated, the SMA-Hyper model consistently outperforms these baseline models.\nRegarding the ablation performance of cCL, hypergraph learning, and the attention mechanism, three key elements of our framework, the absence of hypergraph learning resulted in the most significant decrease in performance. Specifically, the reduction ratios ranged from 7.98% to 9.47% in RMSE, 155.59% to 87.00% in MAE and 7.1% to 7.7% in Recall. Furthermore, the 24-hour data set, with its limited training data, showed greater sensitivity to all framework modules, further underscoring the importance of these components in our model.\nFor the urban view, incorporating the POI and Road data resulted in improved performance, although the improvement was modest. However, the Road view played a more significant role in con- tributing to better results. In particular, the inclusion of road information results in an improvement in MAE, highlighting the importance of road characteristics in accurately predicting accident risks, which also corresponds to previous studies (Mannering and Bhat, 2014; Wang et al., 2021; Yang et al., 2022). This is likely due to the direct influence that the types, conditions, and infrastructure of roads have on traffic safety, making them critical factors in the predictive capabilities of the model."}, {"title": "5. Conclusion", "content": "The SMA-Hyper framework consistently demonstrates superior and robust performance in multi- step urban traffic accident prediction by effectively addressing the challenges posed by data sparsity and the need for precise identification of high-risk areas. It integrates adaptive graph learning and employs both setwise and pairwise contrastive graph representation learning techniques to dynami- cally capture spatial heterogeneities and homogeneities. Additionally, with the help of PKDE, the framework overcomes the limitations of traditional and state-of-the-art models. By leveraging hy- pergraph learning, the SMA-Hyper model effectively captures high-order spatiotemporal dynamics, offering a comprehensive understanding of the complex interactions between various urban factors. Incorporating diverse urban configurations, such as POI and road network data, the model achieves a more feasible and explainable representation of the urban environment. This multiview fusion ap- proach enables the model to adapt to the dynamic nature of urban traffic patterns, thereby improving predictive accuracy across different temporal scales.\nExtensive experiments on the London traffic accident dataset reveal that the SMA-Hyper model significantly improves key performance metrics, including RMSE, MAE, and Recall. The model's ability to maintain high performance under varying temporal conditions and data sparsity underscores its robustness and reliability for practical applications in urban traffic management.\nDespite its strengths, the SMA-Hyper model has some limitations. The complexity of the model increases computational requirements, which may be a constraint in real-time applications. Further-"}, {"title": "6. CRediT authorship contribution statement", "content": ""}, {"title": "7. Declaration of Competing Interest", "content": "The authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper."}, {"title": "8. Data availability", "content": "Data could be downloaded publicly."}]}