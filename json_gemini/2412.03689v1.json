{"title": "Predicting Pedestrian Crossing Behavior in Germany and Japan: Insights into Model Transferability", "authors": ["Chi Zhang", "Janis Sprenger", "Zhongjun Ni", "Christian Berger"], "abstract": "Abstract-Predicting pedestrian crossing behavior is important for intelligent traffic systems to avoid pedestrian-vehicle collisions. Most existing pedestrian crossing behavior models are trained and evaluated on datasets collected from a single country, overlooking differences between countries. To address this gap, we compared pedestrian road-crossing behavior at unsignalized crossings in Germany and Japan. We presented four types of machine learning models to predict gap selection behavior, zebra crossing usage, and their trajectories using simulator data collected from both countries. When comparing the differences between countries, pedestrians from the study conducted in Japan are more cautious, selecting larger gaps compared to those in Germany. We evaluate and analyze model transferability. Our results show that neural networks outperform other machine learning models in predicting gap selection and zebra crossing usage, while random forest models perform best on trajectory prediction tasks, demonstrating strong performance and transferability. We develop a transferable model using an unsupervised clustering method, which improves prediction accuracy for gap selection and trajectory prediction. These findings provide a deeper understanding of pedestrian crossing behaviors in different countries and offer valuable insights into model transferability.", "sections": [{"title": "I. INTRODUCTION", "content": "Intelligent driving systems and smart traffic infrastructures are developed to enable safer and smarter travel. As pedestrians are vulnerable, understanding and predicting their behavior is crucial, especially at unsignalized crossings without traffic lights, where pedestrians constantly interact with traffic due to the ambiguity of the right-of-way. Predicting pedestrian behavior is challenging, as many factors influence pedestrian behavior [1], [2]. Previous research studies focused on tasks including crossing intention prediction [3]\u2013[8] and trajectory prediction [9]\u2013[14], but many of them did not explicitly consider pedestrian-vehicle interactions.\nWhen pedestrians interact with vehicles at unsignalized crossings, intelligent traffic systems should be able to predict their behavior, such as the time gap they will choose to cross, whether they will use zebra crossings, and their crossing trajectories. Zhang et al. [15] has predicted and analyzed pedestrian gap selection and zebra crossing usage using data collected by a simulator study conducted in Germany. Their study provides insights into the key factors that influence pedestrian behavior when interacting with multiple vehicles.\nHowever, Zhang et al.'s study [15] and most other existing models only focused on single datasets, neglecting the differ-ences between countries. An intelligent traffic system should be functional and safe in different countries. In other words, the model trained in one country should be transferable to other countries. Therefore, in this study, we investigate and compare the differences between Germany and Japan, providing insights for bridging differences between countries and improving model transferability.\nSimulator studies have been widely used by researchers (e.g., [15]\u2013[17]) to investigate pedestrian-vehicle interactions, as it is safe and avoids real pedestrian-vehicle conflicts in near-crash events. In this context, the term \"pedestrian-vehicle interactions\" refers to the exchange of actions and reactions between pedestrians and vehicles that influence each other's behavior during encounters. These interactions can be explicitly represented and modeled by measurable variables such as time to arrival (TTA) or time gap, pedestrian waiting time, pedestrian walking speed, and vehicle speed. In this study, we use simulator data collected in a virtual reality (VR) simulator by Sprenger et al. [17] from both Germany and Japan. The head-mounted VR systems ensure a consistent and controlled environment across different countries, reducing the impact of irrelevant factors and allowing us to focus on behavioral differences between the two countries.\nThis study extends Zhang et al.'s research [15], which explored scenarios where pedestrians interact with multiple vehicles in traffic flow using machine learning models. Compared to their research that only focused on data collected from Germany, we investigate the differences between data collected from Germany and Japan, and explore the transferability of these models. Furthermore, we expand the scope to include pedestrian crossing trajectories in addition to predicting gap selection behavior and zebra crossing usage. Particularly, for each prediction task, our research questions are:\nRQ1 What are the similarities and differences in pedestrian crossing behavior observed between studies conducted in Germany and Japan?"}, {"title": "II. RELATED WORK", "content": "In this section, we review related studies, focusing on three key areas: pedestrian crossing behavior prediction, analysis of pedestrian crossing behavior, and differences in pedestrian behavior between countries."}, {"title": "A. Pedestrian Crossing Behavior Prediction", "content": "Studies such as [5], [9]\u2013[14] focused on pedestrian trajectory prediction, using past spatial and temporal information to predict future movements. These methods typically use a 3.2 s time window for observation and output a 4.8 s prediction. However, they only rely on pedestrians' past trajectories and do not explicitly consider pedestrian-vehicle interaction factors, failing to capture the complexities of crossing decisions that can extend beyond 8 s. To bridge this gap, this study considers interaction factors to predict pedestrians' crossing paths without relying on their past trajectories.\nSome studies focused on pedestrian crossing intentions and applied deep learning on naturalistic data to determine whether a pedestrian intends to cross. Studies such as [3], [4], [6], [8] mainly considered only pedestrian-related fea-tures, including pedestrian appearance, their surroundings, and pedestrian skeleton information. Other studies implicitly considered pedestrian-vehicle interactions by using relative pedestrian-vehicle distances [7] or their trajectories [5] as inputs to deep learning networks, or by modeling interactions through graph convolutional networks [18], [19]. However, these approaches rely on implicit interaction models, which lack explainability. An explicitly defined, interpretable model of pedestrian-vehicle interactions is often missing due to the complexity of controlling the environment in naturalistic data and the difficulty in collecting near-crash scenarios for safety reasons.\nStudies [16], [20]\u2013[22] investigated pedestrian-vehicle in-teraction, focusing on scenarios where pedestrians interact with a single vehicle, considering factors such as time to arrival, position, velocity, pedestrian waiting time, and personal traits. These studies neglected the complex situations where pedestrians interact with multiple vehicles, which is common in real-world environments. Simulator studies provide a con-trolled environment to ensure pedestrian safety and collect detailed interaction information, avoiding real-world near-crash scenarios and are utilized by many researchers. Jayaraman et al. [23] analyzed and predicted gap acceptance behavior at zebra crossings, considering variables like waiting time and vehicle speed. Zhang et al. [15] used gap-related information to predict which gaps pedestrians would select for crossing and whether they would use zebra crossings.\nHowever, existing models are typically trained and tested on single datasets, disregarding differences between countries, and lacking consideration for their transferability to new scenarios and countries. Our study aims to fill these gaps by evaluating model transferability that considers differences between coun-tries and using cluster methods to build transferable models."}, {"title": "B. Analysis of Pedestrian Crossing Behavior", "content": "Pedestrian crossing behavior is influenced by various fac-tors [1], [2]. Pedestrian-related factors such as age, gender, and personality traits are explored in studies [2], [24]\u2013[29]. Vehicle-related factors, such as vehicle speed, have also been considered in studies [21], [30], [31]. Additionally, pedestrian-vehicle interaction plays a crucial role, as discussed in studies [16], [27]\u2013[30]. The time gap, an important factor for crossing decisions, has been explored in several studies [16], [27]\u2013[30]. Pedestrian waiting time has also been investigated [16], [29]\u2013[31]. However, these studies often modeled the relationship between these factors and crossing decisions without predicting specific outcomes. For example, Velasco et al. [28] found that pedestrians are more likely to cross at larger gaps, while Gorrini et al. [27] calculated accepted gaps from a statistical perspective. Yannis et al. [31] modeled traffic gaps and crossing decisions at mid-block crossings, considering factors such as waiting time, vehicle speed, and group behavior, but their approach was limited to linear relationships and did not propose predictive models. Few studies focus on predicting the specific time gap a pedestrian would select and accept for crossing or whether a pedestrian would use the zebra crossings.\nTo address these research gaps, we consider pedestrians' interactions with multiple vehicles and predict interaction outcomes. For non-zebra crossing scenarios, we predict the time gap pedestrians select and accept when interacting with multiple vehicles, analyzing factors such as waiting time, pedestrian walking speed, and missed car gaps. For zebra crossings, we predict if pedestrians use the zebra crossing and analyze the factors influencing their choices."}, {"title": "C. Pedestrian Behavior Differences between Countries", "content": "Existing cross-country studies have explored behavioral differences. Hell et al. [32] provided a literature review on behavioral differences in risk avoidance, compliance, gap acceptance, and walking velocity between Germany and Japan. Following this, Sprenger et al. [17] statistically compared pedestrian crossing velocity, gap sizes, following behavior, and zebra crossing usage in both countries based on a virtual reality simulator study conducted in both countries. Solmazer et al. [33] compared behaviors across Estonia, Greece, Kosovo, Russia, and Turkey, revealing that context or country-specific factors influence pedestrian behavior. Pele et al. [34], [35] analyzed pedestrian behavior differences between France and Japan, using agent-based modeling to uncover cognitive mechanisms and behavioral differences. Kaminka et al. [36] explicitly modeled cultural information in their simulation of pedestrian behaviors in Iraq, Israel, England, Canada, and France, highlighting movement differences and proposing mixed-country scenarios.\nHowever, previous studies mainly compared behaviors across countries without building predictive models [17], [32], [34]. Those that built models focused on specific factors [33], [35], [36] without developing transferable models, and few utilized machine learning methods.\nTo bridge this gap, our research compares differences between countries in predicting pedestrian crossing behavior and investigates the transferability of models trained on data from different countries. After comparing the differences between countries, we also used cluster methods to improve the performance and transferability.\nWe summarize research directions, main contributions, and research gaps of related studies in predicting and analyzing pedestrian crossing behavior in Table I."}, {"title": "III. METHODOLOGY", "content": "We utilize data captured in the virtual reality study by Sprenger et al. [17]. This dataset was collected in controlled experiments in Saarbr\u00fccken, Germany, and Tokyo, Japan, using a virtual street environment with two lanes and bi-directional traffic. Using an untethered, head-mounted virtual reality headset and motion capture equipment, participants could move freely in a 9 m \u00d7 8 m space. Within this space, participants could make explicit route choices in different conditions, containing zebra crossings and other virtual pedestrians, and physically navigate the virtual road by walking or running to a designated goal. An overview of the experimental setup is illustrated in Fig. 1.\nData from 60 participants in each country was collected with equally distributed genders in Sprenger et al.'s study [17], after obtaining approval from the ethical review committee (registration numbers in Japan: H2022-1166-B; and in Germany: 21-08-06). Each participant completed 60 trials, including 15 trials without crossing facilities, 15 trials with a zebra crossing, and 30 trials featuring different combinations of virtual pedestrian avatars crossing on risky and safe gaps and no dedicated crossing facilities. Vehicles in the trials drove at a constant speed of 30 km/h, stopping only at the zebra crossing if the participant was nearby. The time gaps between cars were uniformly sampled from 2.5 to 8.5 s.\nThe experiment recordings allowed for the computation of various parameters describing pedestrian behavior, such as average crossing velocity and selected gap duration, as well as gap-related measures, as listed in Table II."}, {"title": "B. Prediction Targets and Input Features", "content": "Using observable information about pedestrian-vehicle inter-actions before road crossing as inputs, we predict pedestrian behavior at both non-zebra and zebra crossings, as described in Sec. III-A. In non-zebra crossing scenarios, we investigate pedestrian gap selection behavior, predicting the time gap between cars from both lanes that pedestrians will choose to cross. In zebra crossing scenarios, we analyze pedestrians' decisions regarding the use of zebra crossings and their crossing trajectories.\nWe mainly use vehicle-gap-related information to predict gap selection and zebra crossing utilization as input features, detailed in Table II (a). The computation of gaps in two lanes with opposing traffic is not well defined. For single-lane observations, gaps between vehicles are straightforward to compute by calculating the temporal distance between two vehicles (car gap near, car gap far). As participants could move laterally to the street, the effective gap is influenced by the ego-movement. This effective gap (near, far) is measured using an automated virtual stopwatch to record the time between the lead car passing and the following car arriving at the participant's respective spatio-temporal position. As the traffic approaches from both directions, the gaps can be additionally computed for both lanes together. Again, this synchronized gap can be either computed between cars or as the effective gap, including the ego-movement of the participant. For the synchronized car gaps, we always consider the largest gap between vehicles. For example, a new gap opens up for the pedestrian, and a vehicle approaches on the near lane from the left, with a distance of 7 s, while another vehicle approaches from the right, with a distance of 5 s. The synchronized gap, including both lanes, is 5 s. If the pedestrian moves to the left, the effective near-lane gap decreases, while the effective far-lane and synchronized gaps increase, giving the participant more time to cross. A visualization of these gaps can be found in Fig. 1a.\nFor crossing trajectory prediction, we also consider additional input features when the pedestrian enters the road, as listed in Table II (b). Unlike existing trajectory prediction algorithms that use past trajectories as input, our study uses only these interaction features without previous position information. This approach allows us to focus on the dynamics of pedestrian-vehicle interactions rather than spatial patterns."}, {"title": "C. Predictive Models for Comparing Differences between Countries", "content": "Previous studies have indicated significant differences in pedestrian behavior between the data collected in Germany and Japan from a statistical perspective [17]. To compare the ground truth pedestrian behavior, we use scipy.stats for statistical tests. Non-parametric tests are utilized, as they are more conservative and robust, and not all assumptions for parametric tests (e.g., t-test, ANOVA) are fulfilled. In particular, the Kruskal-Wallis H test (H test) is used instead of a one-way ANOVA to compare differences between different groups, and the Mann-Whitney U test (U test) was used to confirm and further analyze the differences of individual pairs of groups. The acceptance rate was adjusted using Bonferroni correction for multiple comparisons when applicable.\nTo investigate the similarities and differences in pedestrian road crossing behavior of data collected in Germany and Japan (RQ1), we conduct a comparative analysis using machine learning models to predict behaviors in each country. We develop separate models for the data collected in Germany and Japan, training and evaluating them independently. Our investigation focuses on comparing the predictability of both models, identifying the most important features used in these models, and understanding the influence of these features on pedestrian behavior.\nIn comparing differences between countries, we adhere to the methodology outlined by Zhang et al. [15], randomly dividing training and test sets based on trials to ensure no overlaps between training and test sets. Predicting the accepted gap and crossing trajectories are regression tasks, while predicting zebra crossing usage is a classification task. We utilize the following machine learning models for these regression and classification tasks:\na) Linear Models: Linear regression is used for regression as a baseline, considering the linear dependencies between input and output variables. Logistic regression is used for classification as a baseline, predicting the probability of an event by modeling the log-odds for the event as a linear combination of independent input variables.\nb) Support Vector Machine (SVM): SVM identifies a hyperplane within the feature space for classification tasks. We use a linear kernel in this work.\nc) Random Forest (RF): RF is an ensemble learning method consisting of a large number of regression or decision trees. For regression, it outputs the average predicted results; for classification, it outputs the most selected label. To avoid overfitting, we use 100 estimators with a maximum depth of five.\nd) Neural Networks (NNs): NNs, based on a collection of artificial neurons, are used for both regression and classification."}, {"title": "D. Model Transferability", "content": "We explore the transferability of predictive models trained on datasets collected in each country (RQ2). To evaluate model transferability, we train models on data collected from one country and evaluate their performance on data from the other country. To compare the transferability of models, we use two methods for dividing the training and test sets:\na) Randomly division by trials: Following Zhang et al.'s method [15], we randomly divide the data by trials, ensuring no trial overlap between training and test sets.\nb) Randomly division by participant ID: We randomly divide the data by participant ID, ensuring no participant overlap between training and test sets. This approach makes prediction more challenging due to the lack of prior participant information compared to the division by trials."}, {"title": "E. Using Cluster Information to Improve Model Transferability", "content": "After exploring the differences between countries as de-scribed in Sec. III-C, we observed that models trained on datasets from different countries demonstrate different per-formances, as detailed in Sec. IV-A1, IV-B1, and IV-C1. These differences within the training sets can decrease model transferability across datasets. Transfer learning [37] is a technique that enhances transferability by enabling models to transfer knowledge from one or several source tasks to new, related target tasks. One possible approach is to increase the similarity between modeling tasks. To address this, we utilize clustering methods, a type of unsupervised learning, to cluster the training data and reduce intra-dataset differences. We explore their potential in improving model performance and transferability (RQ3).\nTo build models that perform well on datasets collected from both countries, we use unsupervised learning to cluster the input data and consider the cluster information during training. For gap selection and zebra crossing usage, we directly cluster based on the input features. For crossing trajectory prediction, we first cluster the trajectories into groups in the training set and then use this cluster information to train a classifier and a trajectory prediction model. For the test data, we first classify the cluster and then predict the trajectories. The Agglomerative Clustering [38] is used in this work. This clustering method is compared with three other strategies:\na) Separate Models: We build two separate models, one for each country. For test data collected from Germany, we use the model trained on data from Germany, and for test data collected from Japan, we use the model trained on data from Japan.\nb) Joint Training: We merge the data collected from both countries and build a single model using the same features as in the separate models. This model is used for predicting on data from both countries.\nc) Country Information as a Feature: We merge the data and build a single model, incorporating country information as a feature in addition to the original input features.\nWhen we have data from both Germany and Japan, we aim to develop a model that performs well in both countries. Considering the practical situation where the same pedestrians are not encountered again, in this section, we divide the training and test sets by participant ID. This ensures the model does not contain any prior information about the same participants in the test set, not even other trials of the same pedestrian."}, {"title": "F. Evaluation Metrics", "content": "To reduce the sensitivity to outliers, we evaluate the performance of gap selection regression models using the mean absolute error (MAE) as defined in Eq. 1, following the evaluation metric employed in Zhang et al.'s study [15]. \u03a4\u03bf evaluate the performance relative to the scale of the target variables, we employ the mean absolute percentage error (MAPE) as defined in 2. The ground truth for the $i^{th}$ trial is denoted by $y_i$, the corresponding prediction is denoted by $\\hat{y}_i$, the number of trials is denoted by $n$, and the average value of y over n trials is denoted by $\\bar{y}$.\n$\\text{MAE} = \\frac{\\sum_{i=1}^{n}|y_i - \\hat{y}_i|}{n}$ (1)\n$\\text{MAPE}(\\text{%}) = \\frac{\\text{MAE}}{\\bar{y}} \\times 100$ (2)\nWe evaluate the zebra crossing usage classification models with prediction accuracy (ACC) and F1 score as defined in Eqs. 3 and 4, where TP, TN, FP, and FN are the numbers of true positives, true negatives, false positives, and false negatives, respectively. These two metrics are widely employed for evaluating the classification of pedestrian intention, as used in studies [4], [5], [8], [15], [16].\n$\\text{ACC} = \\frac{\\text{TP}+\\text{TN}}{\\text{TP}+\\text{FP}+\\text{TN}+\\text{FN}}$ (3)\n$\\text{F1} = \\frac{2\\text{TP}}{2\\text{TP}+\\text{FP}+\\text{FN}}$ (4)\nTo evaluate trajectory prediction error, we use the Average Displacement Error (ADE), which is widely employed for evaluating pedestrian trajectory prediction, as used in studies [9]\u2013[14]. ADE is defined as the average distance between the ground truth and predicted trajectories over all sampled points. It is given by the following equation, where $\\vec{Y}$ is the prediction at the $j^{th}$ sampled point in the $i^{th}$ trial, n is the total number of trials, and m is the total number of sampled points for each trial:\n$\\text{ADE} = \\frac{\\sum_{i=1}^n \\sum_{j=1}^m || \\vec{Y}_i - \\vec{\\hat{Y}}_i ||_2}{n \\times m}$ (5)"}, {"title": "IV. RESULTS AND DISCUSSIONS", "content": "The best-performing models for predicting accepted gaps at non-zebra crossings are the NN model for Germany and the linear regression model for Japan. As shown in Table III, the NN model trained on German data achieves the best performance with an MAE of 1.075 s and a MAPE of 18.1%, while the linear regression shows the largest error with an MAE of 1.095 s and a MAPE of 18.4%. In comparison, the linear regression model trained on Japanese data achieved the best results with an MAE of 1.030 s and a MAPE of 16.9%. This indicates the more non-linear nature of the data from Germany.\nThe NN's predictions are more dispersed and align more closely with the pattern of ground truth, while the prediction results of the linear regression and RF models are concentrated. As demonstrated in Fig. 2, the ground truth for the accepted gap in Germany has a median of 6.5 s and an Interquartile Range (IQR) of 3.0 s. The NN's predictions have a median of 6.3 s with an IQR of 1.5 s, while the linear regression's predictions have a median of 6.1 s with an IQR of 0.8 s, and the RF has a median of 6.2 s with an IQR of 0.7 s. This shows that the NN's predictions are closer to the actual ground truth. Similar patterns are observed in the data from Japan.\nData from Germany shows a more dispersed pattern com-pared to data from Japan. As illustrated in Fig. 2, the ground truth for the accepted gap in data from Japan has a median of 6.5 s which is the same with data from Germany. However,"}, {"title": "A. Gap Selection Prediction", "content": "Significant differences are found in the number of unused car gaps between Germany and Japan (Mann-Whitney U-test, p < .001). The median number of unused car gaps for data collected from Germany is 4.0 with an Interquartile Range (IQR) of 3.0 s, and the median for data from Japan is 4.0 with an IQR of 2.0 s.\nPedestrians in the study conducted in Japan missed more car gaps when crossing compared to those from Germany. Fig. 3a illustrates the normalized distributions of the number of unused car gaps for both lanes ($N_{cb}$). The distribution peaks at three missed gaps for participants in Germany and four for those in Japan. When the number of missed car gaps is fewer than or equal to five, participants from Germany show a higher proportion, but when the number exceeds six, participants from Japan show a higher proportion. Overall, this suggests that pedestrians in Japan are more cautious when crossing the road, as they tend to miss more gaps.\nPedestrians from the study conducted in Japan selected and accepted larger gaps than those in Germany. Fig. 3b illustrates the relationship between mean accepted gaps and the number of unused car gaps for both lanes. As shown in the figure, the accepted gap for participants in Japan is consistently larger than those in Germany, showing their cautious behavior.\nAs the number of unused car gaps increases, the size of accepted gaps tends to decrease for data from both countries. As shown in Fig. 3b, for example, the mean accepted gap for participants in Germany decreases from 6.2 s to 5.5 s when the number of unused car gaps for both lanes increases from two to five. This trend suggests that pedestrians are inclined to make riskier choices and accept shorter gaps after missing more gaps.\nHowever, when the number of missed gaps exceeds five, the size of accepted gaps stabilizes. Specifically, for participants in Germany, accepted gaps stabilize between 5.4 and 5.8 s, and for Japan, they stabilize between 5.8 and 6.2 s. This observation implies the existence of a safety threshold for accepted gaps. Pedestrians tend to cross when the gap is larger than this threshold, as they perceive it to be safe. Conversely, if a gap falls below this threshold, people may perceive it as unsafe, leading people to avoid crossing."}, {"title": "Largest missed car gap:", "content": "When pedestrians miss larger gaps, they tend to choose smaller gaps for crossing. As illustrated in Fig. 4, data from both countries show that when the largest missed gap increases, there is an obvious decreasing trend of the accepted gap. This indicates a tendency for pedestrians to make riskier choices after missing crossing chances with larger gaps. Besides, the larger accepted gaps observed for participants in Japan suggest that they are more cautious when crossing the road compared to those in Germany."}, {"title": "Pedestrian waiting time:", "content": "Significant differences are observed in waiting time between the data from Germany and Japan (Mann-Whitney U-test, p < .001). The median waiting time for participants in Germany is 9.52 s (IQR = 5.25 s), whereas for Japan, it is 12.7 s (IQR = 10.11 s).\nPedestrians in the study conducted in Japan tend to wait longer compared to those in Germany. Fig. 5a shows that when the waiting time is shorter than 12 s, participants from Germany show a higher proportion, while when the waiting time exceeds 12 s, participants from Japan show a higher proportion. This pattern indicates a more cautious manner of participants in Japan when crossing the road.\nPedestrians tend to select slightly larger gaps when waiting longer. Fig. 5b shows that for data from Germany, the accepted gap increases from 5.9 s to 6.2 s as the waiting time rises from 5 s to 25 s. Similarly, for data from Japan, the accepted gap increases from 6.1 s to 6.4 s over the same waiting time range. This trend contrasts with the tendency to make riskier choices after missing more and larger gaps, indicating that increased waiting time is related to more cautious behavior. This finding is consistent with the results from Yannis et al. [31], which suggests that as pedestrians wait longer to cross the street, the probability of crossing decreases. Although this might seem"}, {"title": "Average walking speed:", "content": "There are significant differ-ences in the walking speeds between the data from Germany and Japan (Mann-Whitney U-test, p < .001). The median walking speed of participants in Germany is 1.43 m/s (IQR = 0.29 m/s), while in Japan, it is 1.48 m/s (IQR = 0.28 m/s). The statistics and Fig. 6a indicate that participants in the study conducted in Japan walked slightly faster than those in Germany.\nPedestrians with faster walking speeds tend to choose shorter gaps for crossing. As shown in Fig. 6b, participants in Germany who walked at an average speed of 0.75 m/s selected a gap of 6.2 s, whereas those walking at 2 m/s selected a gap of 5.2 s. This finding is consistent with the study by Wan and Rouphail [39], who proposed the critical gap formula for pedestrian crossing behavior, as defined in Eq. 6:\n$\\text{Gap} = L/S + F$ (6)\nwhere L is the crosswalk length, S is the pedestrian's average walking speed, and F is a safety margin (in seconds) reflecting pedestrian's risk acceptance. The equation shows that as walk-ing speed increases, the critical gap decreases. An alternative interpretation of this relationship is that individuals in a hurry often prefer shorter gaps, leading to a faster walking speed. Interestingly, pedestrians from the study conducted in Japan walk slightly faster but still select larger gaps to cross compared to pedestrians from Germany. This behavior could be related to factors such as risk aversion and safety considerations. Although capable of crossing smaller gaps, they choose larger gaps to reduce the risk of accidents or conflicts with vehicles. This preference for larger gaps suggests a safety-conscious behavior. Another reason for this preference might be to reduce disruptions to traffic flow and show consideration for other road users. By waiting for larger gaps and walking faster, participants from Japan can efficiently cross the road while respecting the movement of vehicles."}, {"title": "Group behavior:", "content": "We analyze and compare the distri-bution of accepted gaps of participants in Germany and Japan under different scenarios (crossing alone, crossing with safe agents, crossing with risky agents). In the 30 trials of the virtual reality study, groups of one to three virtual pedestrian agents cross alongside the participant, showing two types of behavior: the leading pedestrian agent crosses on a risky gap (4 s gap) or on a safe gap (6.5 s gap). The accepted participant gap distribution is shown in Fig. 7 with an enhanced box plot. The main box displays the interquartile range (25th to 75th percentile), with finer percentiles indicated by additional step boxes.\nBoth German and Japanese participants show significant differences in the accepted gap among the three groups (German: Kruskal-Wallis H Test, H(2) = 162.7, p < .001; Japanese: Kruskal-Wallis H Test, H(2) = 17.7, p < .001). Specifically, for participants in Germany, the median accepted gap is 6.5 s (IQR = 3.0 s) for the crossing alone group, 5.5 s (IQR = 3.0 s) for the risky group, and 6.5 s (IQR = 0.0 s) for"}, {"title": "Other way of dividing the dataset:", "content": "These experiments were conducted by dividing the training and test sets randomly by trials. We repeated the experiments by sampling participants into the same age range and dividing the samples randomly by participant ID, obtaining similar results. This consistency indicates that the observed behaviors are influenced by cultural factors rather than age or individual differences."}, {"title": "Model Transferability:", "content": "NN models consistently demon-strated the best transferability. Table IV shows the results of model transferability evaluated by dividing the dataset by trials and by participant ID. Dividing by participant ID makes prediction more challenging due to the lack of prior knowledge about the pedestrians in the test set, resulting in larger errors compared to dividing by trials. NN models achieved the highest accuracy when tested on the other country's dataset, regardless of how the dataset was divided. As noted earlier, the top three important features were the same for NN models in both countries. This consistency suggests that NN models rely on the same variables for decision-making, contributing to their better transferability.\nInterestingly, the error decreased when the NN model trained on data from Germany was applied to data from Japan. This implies that the behavior patterns of participants in Germany are more varied and harder to predict, while the behavior patterns of participants in Japan are more consistent and easier to predict."}, {"title": "Using Clustering to Improve Performance and Transfer-ability:", "content": "Using clustering information helps to capture shared patterns of pedestrian behavior across different countries, resulting in improved model performance. We compare our proposed model, which uses clustering information to separate models, joint training models, and the model using country information as a feature. The dataset is divided into training and test sets randomly by participant ID. As shown in Table V,"}, {"title": "B. Zebra Crossing Usage Prediction", "content": "NNs outperform other models in predicting whether pedestrians use the zebra cross-ings. The accuracy and F1 score of the prediction results are presented in Table VI. NNs outperform logistic regression, SVM, and RF for data from both countries, achieving an accuracy rate of 94.27% in data from Germany and 94.26% in data from Japan, showing their effectiveness in capturing behavior patterns.\nLinear and non-linear-based models rely on different key features as shown in Table VI. Specifically, linear-based models, including logistic regression and SVM, identify the number of unused effective gaps in the near lane ($N_{en}$) as the most important feature for data from both countries. In contrast, non-linear models, including RF and NN, prioritize pedestrian waiting time ($T_{w}$) as the most critical feature for modeling data from both countries. Therefore, we investigate the impact of these two factors ($N_{en}$ and $T_{w}$) on prediction accuracy.\nNumber of unused effective gaps: As the number of unused effective gaps at the near lane increases, prediction accuracy decreases for data from both countries. Fig. 8 shows that for data in Germany, the accuracy of the NN model drops from 95.4% to 88.4% as the number of unused effective gaps at the near lane rises from one to three. Similarly, logistic regression accuracy decreases from 92.9% to 72.1%. Similar trends are observed for data in Japan. This indicates the"}, {"title": "Pedestrian waiting time:", "content": "Significant differences are observed in waiting time between the data from Germany and Japan (Mann-Whitney U-test, p < .001). Overall, pedestrians from data collected in Japan exhibit longer waiting times (median = 10.3 s, IQR = 5.6 s) compared to those from Germany (median = 7.3 s, IQR = 4.9 s), indicating a higher level of caution. The distributions of pedestrian waiting time for zebra crossing cases are illustrated in Fig. 9a. The upper section corresponds to cases where pedestrians used zebra crossings, while the lower section represents cases where pedestrians did not use zebra crossings. For both groups, participants in Japan show longer waiting times.\nWith increasing waiting time, the predictability of zebra crossing usage decreases for both countries. Fig. 9b shows that for data in Germany, the prediction accuracy of the NN model decreases from 97.4% to 88.0% when the waiting time increases from 5.0 s to 15.0 s. Similarly, the accuracy of the logistic regression model decreases from 93.2% to 78.0%. This suggests that as pedestrians wait longer, their decisions become more influenced by implicit factors, making them harder to predict. Neural networks consistently exhibit better results than linear models, showing their capability to handle nonlinearity."}, {"title": "Accepted gaps:", "content": "Pedestrians who use the zebra crossing generally accept smaller gaps than those who do not in both countries. Fig. 10 compares the distribution of accepted gaps between Germany and Japan, along with pedestrians' zebra crossing usage. As shown in Fig. 10, participants in Germany who used zebra crossings had a median waiting time of 4.5 s, compared to 5.5 s for those who did not use them. In Japan, the median waiting time was 5.5 s for those using zebra crossings and 6."}]}