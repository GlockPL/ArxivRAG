{"title": "High-Precision, Fair University Course Scheduling During a Pandemic", "authors": ["Matthew E. H. Petering", "Marshall Khamechian"], "abstract": "Problem definition: Scheduling university courses is extra challenging when classroom capacities are reduced because of social distancing requirements that are implemented in response to a pandemic such as COVID-19. Methodology: In this work, we propose an expanded taxonomy of course delivery modes, present an integer program, and develop a course scheduling algorithm to enable all course sections\u2014 even the largest\u2014to have a significant classroom learning component during a pandemic. Our approach is fair by ensuring that a certain fraction of the instruction in every course section occurs in the classroom. Unlike previous studies, we do not allow rotating attendance and instead require simultaneous attendance in which all students in a section meet in 1-5 rooms at the same time but less often than in a normal semester. These mass meetings, which create opportunities for in-person midterm exams and group activities, are scheduled at high precision across all days of the semester rather than a single, repeating week. A fast heuristic algorithm makes the schedule in an hour. Results: We consider the 1834 in-person course sections, 172 classrooms, and 96 days in the fall 2022 semester at [UniversityXYZ]. If average classroom capacity is reduced by 75% due to a pandemic, our approach still allows at least 25% of the instruction in every section, and more than 49% of all instruction across the entire campus, to be in the classroom. Our method also produces excellent results for regular classroom assignment. Managerial implications: An algorithm based on the principles of fairness and simultaneous attendance can significantly improve university course schedules during a pandemic and in normal times. High-precision schedules that prepare a campus for various pandemic possibilities can be created with minimal administrative effort and activated at a moment's notice before or during a semester if an outbreak occurs.", "sections": [{"title": "1. Introduction", "content": "In the early 2020s, learning at the world's 25,000 colleges and universities was in jeopardy as SARS-CoV-2 (i.e., COVID-19) spread across the globe. As of May 10, 2023, COVID-19 had infected more than 765 million people and killed 6.9 million (WHO, 2023). Although many experts believe the worst of the pandemic is over, the disruption it has caused to businesses, governments, healthcare systems, and the cognitive development of young people under the age of 25 will likely be felt for decades (Schady et al., 2023). Moreover, there is still the possibility of a future pandemic.\nFor universities, a pandemic such as COVID-19 creates a dilemma of education versus health which requires them to rethink how their courses are delivered. If education is the priority, courses should be delivered in person (i.e., taught in a classroom) to improve learning outcomes (Freeman et al.,"}, {"title": "", "content": "2014). On the other hand, if health is the only consideration, courses should be delivered online (i.e., remotely) to minimize the risk of infection.\nOne option for addressing this dilemma is to socially distance, i.e., to require students to remain at least six feet apart when sitting in classrooms to comply with recommendations made by the U.S. Centers for Disease Control and Prevention. Although social distancing is an obvious solution, it creates a major problem: classroom capacities are reduced by about 70% (Reeves, 2020). This in turn creates a new task for the university to allocate scarce classroom space to hundreds of courses whose total demand for space exceeds the supply.\nSince the onset of COVID-19, many ideas have been proposed for managing and scheduling university instruction if social distancing is required in the classroom. The most common idea is to deliver courses in hybrid mode with rotating attendance. In such a course, students are divided into cohorts with the number of students in each cohort no greater than the pandemic capacity (i.e., socially distanced capacity) of the classroom. Each time the course meets, one cohort attends in the classroom and the other cohorts attend online, and the in-person attendance rotates among the cohorts. Another idea is to change the rooms assigned to courses so more courses can be taught in person. Here, the general idea is to move large courses online so large classrooms can be used to teach medium-sized courses in person. This in turn frees up medium-sized classrooms for teaching small courses in person.\nHowever, the above strategies have some disadvantages. A hybrid delivery mode with rotating attendance does not provide opportunities for in-person midterm exams in which all students are simultaneously in a classroom. There is also a nonuniform student experience because of mixed attendance at each lecture; some students receive the lecture in a classroom while others receive it online. The delivery of mixed-attendance lectures may also create more work and stress for instructors as they simultaneously attempt to connect with students in two different environments. Furthermore, moving large courses online for the benefit of smaller courses could be perceived as unfair. Why should the courses with the highest enrollments\u2014the most successful courses by some metrics\u2014be sacrificed for the sake of smaller courses? In this study, we propose an alternate framework for delivering and scheduling university courses which addresses these issues. Our framework enables all course sections\u2014even the largest to have a significant classroom learning component during a pandemic."}, {"title": "1.1. The course scheduling process", "content": "Before discussing our approach in detail, we first place it in the context of the overall course scheduling process. The tasks involved in scheduling a semester of courses at a major U.S. university are shown in the left column of Figure 1. First, faculty members identify the subjects they will teach. This"}, {"title": "1.2. Simultaneous attendance", "content": "In this study, we propose a university course scheduling framework that enables all course sections\u2014even the largest\u2014to have a significant classroom learning component during a pandemic. Our approach does not allow rotating attendance and instead uses the idea of simultaneous attendance in which all students in a course section meet in multiple rooms at the same time, but less often than in a normal semester. At each mass meeting, students socially distance in each room. The instructor teaches in one room, and an image of the instructor is displayed in the other rooms simultaneously. Mass meetings provide opportunities for group work and in-person midterm exams that would not otherwise exist.\nFigure 2 illustrates the idea of simultaneous attendance for a simple example with 8 course sections, 4 classrooms, and a 2-week semester. The top portion shows the schedule in normal times without social distancing. Four sections (A, B, C, D) meet from 10-11:30 on Monday and Wednesday, and four sections (E, F, G, H) meet from 11:30-1:00 on Monday and Wednesday. The classroom where each section meets is also shown. The bottom of the figure shows a schedule with simultaneous attendance that might be used during a pandemic if classroom capacities shrink by a factor of four. Here, each section occupies four times as many rooms, one-fourth as often. For example, Section A has one mass meeting in rooms 1-4 from 10-11:30 on Monday in week 1 and three online meetings at the other times when it normally meets. Other sections are analogous. In the pandemic schedule, all students attend each meeting for every section either in a classroom (as shown) or online (not shown).\nSimultaneous attendance offers several benefits including opportunities for in-person midterm exams, but it requires a more complex scheduling approach than rotating attendance. With rotating attendance, no decision is made regarding when a course section occupies a room; it occupies a room as in a normal semester. Usually, no decision is made about where the section meets; it generally remains in the room initially assigned to it by the registrar. For example, the schedule at the top of Figure 2 can still be used during a pandemic if every course section is taught in hybrid mode with rotating attendance.\nWith simultaneous attendance during a pandemic, the scheduling is more complex. Each course"}, {"title": "1.3. High-precision course scheduling", "content": "Whereas most course scheduling methods create a repeating, weekly schedule, we take a different approach: we create a high-precision, nonrepeating schedule that explicitly considers each day of the semester. We do so for three reasons. First, some course sections have only a few in-person meetings a semester. In the case study described in Section 7, there are 52 irregular course sections, most of which meet in person less than once per week during a normal semester. The only way to schedule in-person meetings for these sections without wasting large amounts of space is to abandon a repeating weekly schedule. Second, many course sections meet once per week. If we require simultaneous attendance"}, {"title": "1.4. Contributions", "content": "In this paper, we present a novel approach to university course scheduling that enables all course sections-even the largest to have a significant classroom learning component during a pandemic. Our approach is guided by the principles of fairness and simultaneous attendance which have received little attention in the pandemic-driven course scheduling literature. Fairness is achieved by ensuring that a basic fraction (e.g., 25%) of the pre-pandemic, in-person instruction in every course section remains in a classroom during a pandemic. Unlike previous studies, we do not allow rotating attendance and instead require simultaneous attendance in which all students in a section meet in 1-5 rooms at the same time, but less often than in a normal semester. Simultaneous attendance provides opportunities for group work and in-person midterm exams that would not otherwise exist. Instead of a weekly timetable, we create a high- precision schedule that considers each day of the semester. This allows us to handle all exceptions at [StateXYZ]'s second largest university including pre-scheduled, irregular midterm exams; sections with irregular in-person meetings; and temporary room closures for medical/vaccination activities.\nWe call the problem we address the high-precision university course scheduling problem (HP- UCSP). The word \"pandemic\u201d is not in the name because our approach also handles room assignment in normal times. We model this problem as an integer program and develop a fast heuristic algorithm that generates solutions to large problem instances in an hour.\nOur ability to quickly tackle a large, real problem shows that our approach is practical and scalable. It is flexible by considering seven optimality criteria that are weighted according to user preferences. Our approach is also general as it performs three different tasks shown in Figure 1: regular room assignment (task 4 in Fig. 1); course scheduling during a pandemic without room restrictions (task 4A); and course scheduling during a pandemic with room restrictions (task 6). Finally, our approach is friendly to administrators because it places minimal demands on their time. High-precision schedules that"}, {"title": "2. Literature review", "content": "Education has been a focal point of operations research for quite some time. According to Johnes (2015), operations research has been used in an educational context since the 1960s. Areas of application include planning and resource allocation for the educational sector, efficiency and performance measurement, routing, and scheduling. Of particular concern here is the literature on scheduling.\nResearch on educational scheduling includes two areas: school timetabling\u2014which concerns primary and secondary schools and university course scheduling. Pillay (2014) reviews the work on the school timetabling problem (STP). Teacher schedules and workloads play a central role in this problem.\nUniversity course scheduling generally considers more courses, rooms, students, instructors, and timeslots than school timetabling. The instructor of each course is fixed a-priori, and the main goal is to maximize student satisfaction. Most studies on university course scheduling address one of six problems: curriculum-based course timetabling (CB-CTT), post-enrollment course timetabling (PE-CTT), examination timetabling (ETT), strategic scheduling, timetabling by itself, and room assignment by itself.\nMuch of the research on CB-CTT, PE-CTT, and ETT originated with the Second International Timetabling Competition in August 2007 and its predecessor in 2002 (McCollum et al., 2010). An overview of CB-CTT research is provided by Bettinelli et al. (2015). In CB-CTT, tasks 3-4 in Figure 1 are done simultaneously: the university decides a weekly assignment of courses to rooms and time periods before students enroll in courses. The timetable must ensure that courses are only taught when instructors are available and courses belonging to the same curriculum (e.g., year 3 physics) or taught by the same instructor are not scheduled at the same time. There are also several soft constraints.\nIn PE-CTT, the university decides a weekly assignment of courses to rooms and time periods after students enroll in courses. Conflicts in PE-CTT are determined by students who individually enroll"}, {"title": "", "content": "in particular courses, not by the curricula published by the university. In this approach, tasks 1-5 in Figure 1 are performed in the order 1-2-5-3-4 with tasks 3-4 performed simultaneously. Rudov\u00e1 et al. (2011) describe a method for performing PE-CTT at Purdue University that considers the large lecture courses, small lecture courses, and laboratory courses in sequential fashion.\nExamination timetabling (ETT) resembles PE-CTT but allows exams to share rooms. Each exam needs to be assigned to a single room and period, and there are a variety of exam-specific considerations. For example, giving one exam later than another may be a requirement (McCollum et al., 2012).\nStrategic scheduling is a broad area that includes relatively few papers. Some studies in this area consider how many classrooms and time periods\u2014and which rooms and periods\u2014are necessary (Lindahl et al., 2018). Other studies consider term planning (Khamechian and Petering, 2022).\nAnother approach to course timetabling and room assignment is to deal with them separately. This is a less student-focused approach than CB-CTT and PE-CTT as it does not consider distances that students travel between lectures. This approach may be used at large universities where courses are plentiful and elective courses form a major part of the curriculum. For example, Phillips et al. (2015) consider a large, practical room assignment problem at the University of Auckland.\nResearch on course scheduling during a pandemic began only recently. Barnhart et al. (2022) present math models and solution approaches for two problems faced by the Massachusetts Institute of Technology (MIT) as it prepared for the fall 2020 semester during the early stages of the COVID-19 pandemic. The first is a strategic term planning problem that helped decide (a) whether MIT should move from a two-semester to a three-semester calendar and (b) which courses should be offered in each term in each case. The second is a pandemic-driven, combined course timetabling, room assignment, and course modality selection problem with the goal of allowing students to attend lectures in person as much as possible despite reduced classroom capacities. In addressing the second problem, the authors introduce the ideas of teaching in multiple rooms and rotating attendance. They produce a weekly schedule using hierarchical optimization that was used in fall 2020 by the Sloan School of Management that allowed 68% of Sloan students to have in-person learning in at least half of their courses.\nJohnson and Wilson (2022) consider a combined room assignment and course modality selection problem faced in Spears School of Business at Oklahoma State University prior to fall 2020. Course times are not changed, and the main goal is to maximize the number of courses delivered in person or in hybrid mode (with social distancing). The authors also introduce the idea of rotating attendance and use hierarchical optimization and an Excel-based solver to make a weekly schedule that was used in fall 2020.\nNavabi-Shirazi et al. (2022) develop a math model and solution approach for a combined room assignment and course modality selection problem faced by Georgia Tech (GT) as it prepared for fall"}, {"title": "", "content": "2020. They consider a large problem with 2249 course sections and introduce a hybrid touch point delivery mode with rotating attendance in which each student attends in person less than once a week. Objectives include maximizing the satisfaction of modality preferences and previous room assignments and maximizing student-hours in the classroom (with social distancing). Hierarchical optimization is used to create a campus-wide schedule for GT in which 87% of course mode preferences are satisfied and 15.5% more student-hours are in a classroom than if no rooms are reassigned. Additional analyses show how (a) centralized versus decentralized planning, (b) the COVID-19 room capacity reduction percentage, and (b) the number of touch points needed for hybrid touch point mode affect the results.\nGore et al. (2022) develop two math models\u2014a three-cohort model (3CM) and once-a-week model (OWM)\u2014used by Clemson University to prepare for fall 2020. Assuming all courses are hybrid with rotating attendance, the models minimize the (a) number of unique students the average student shares a classroom with during the semester and (b) number of days an average student is on campus each week. The 3CM divides the entire student body into three cohorts which specify the three cohorts used for rotating attendance in each course. The OWM assumes each student attends a course once per week in person and the number of cohorts for a course equals the number of times it meets per week. The OWM decides which students are in each cohort in each course, and it was implemented in fall 2020.\nMoug et al. (2022) develop two math models to help universities prepare for, and respond to, a pandemic. The first uses a conflict matrix to determine a classroom's capacity with social distancing requirements. The second model decides new room assignments and course modalities in the event of a mid-semester pandemic. It is solved via hierarchical optimization and used to create a weekly schedule of 1190 engineering courses at the University of Michigan in fall 2021. Results show that, under a 3-foot social distancing requirement, the model increases the fraction of lectures that students attend in person from 62% to 85% and the fraction of courses delivered in one room in person from 23% to 76%.\nIn this paper we propose an approach for scheduling university courses during a pandemic that differs from the preceding research in several ways. First, we do not allow rotating attendance and instead require all classroom attendance to consist of mass meetings in which all students in a course section meet in 1-5 rooms at the same in a socially distanced manner. Second, we ensure that a certain fraction of the instruction in every course section occurs in the classroom. Third, we schedule across all days of the semester instead of a single, repeating week. This allows us to accommodate pre-scheduled midterm exams and course sections with irregular in-person meetings. Fourth, we do not use hierarchical optimization and instead use a weighted objective function. Our approach handles all exceptions at [StateXYZ]'s second largest university and allows at least 25% of the instruction in every section, and more than 49% of all instruction across the entire campus, to be in a classroom."}, {"title": "3. Expanded taxonomy of course delivery modes", "content": "In this section, we propose an expanded taxonomy of course delivery modes which includes the concepts proposed thus far and new ideas for future research. The taxonomy is shown in Table 1.\nCourse delivery refers to how students receive oral instruction from the instructor of a particular course section. A course section (i.e., section) is either part of a course or equivalent to a course. For example, a large course with 2 lecture sections, 17 discussion sections, and 15 lab sections translates to 34 sections. A small course with 1 lecture section and no discussion or lab sections translates to 1 section.\nCourse delivery can be broadly categorized into three modes\u2014in person (IP), online (OL), and hybrid (HY). We propose that these modes be defined as follows. In mode IP, all students attend all lectures for the course section\u2014which we call meetings\u2014in a classroom. In mode OL, all students attend all meetings online. In mode HY, some attendance during the semester is in person and some is online.\nNote that our definition of mode IP does not state that all students attend all lectures in the same room. Indeed, it is possible for students to be split across multiple rooms (Barnhart et al., 2022). Hence, we propose that the delivery mode for an in-person section be specified using the abbreviation IP-r where r indicates how many rooms are used.\nMode HY can be delivered in at least three formats with fixed (-F), rotating (-R), or simultaneous (-S) attendance. These formats are indicated using the abbreviations HY-F, HY-R, and HY- S. In mode HY-F, each meeting has a classroom audience and a remote audience, and the method of attendance is fixed for each student. Some students attend all meetings in person; all other students attend all meetings remotely. As Navabi-Shirazi et al. (2022) have shown, a hybrid section may have rotating"}, {"title": "4. Formal problem description", "content": "Our problem is called the high-precision university course scheduling problem (HP-UCSP).\nConsider a university that has completed tasks 1-5 of the course scheduling process for an upcoming semester (Fig. 1). There is no pandemic, and the university plans to offer S course sections, including sections to be delivered in person and in hybrid mode but not online. Let $E_s$ be the number of students enrolled in, or expected to be enrolled in, section s.\nThe semester has W weeks and D academic days. If instruction occurs five (six) days a week, D = 5W (6W). Let $N_{sw}$ be the number of in-person meetings for section s that take place in week w and $CN_{sw}$ be the number of such meetings that take place in weeks 1 to w combined. These values account for holidays and hybrid sections. For example, if section s meets in person three times per week, $N_{sw}$ = 3 for all w except possibly weeks with holidays and the first/last weeks of the semester. If hybrid section s meets once a week but only every fourth week in person, $N_{sw}$ = 1 every fourth week and 0 otherwise.\nThe academic week is divided into T timeslots of equal duration, and the instruction of any section on any day fits into an integral number of consecutive timeslots. If all sections' meetings start at :00 or :30 after the hour, each timeslot lasts 30 minutes. If there is more variety in meeting start times, each timeslot is shorter. The value of T depends on the timeslot duration, number of days of instruction each week, and earliest start and latest finish time of any meeting on any day. If each timeslot is 30 minutes and if instruction occurs 6 days per week during an 8:00-21:00 window, T = 156 (= 6*26).\nInstruction occurs during M weekly meeting times. Each meeting time is an uninterrupted period during the week when the instruction for one or more sections occurs. For example, three sections that meet MWF from 9-10, MW from 9-10, and MW from 9-10:30 use five unique meeting times: M 9-10, W 9-10, F 9-10, M 9-10:30, and W 9-10:30. Binary parameter $I_{sm}$ equals 1 if section s has an in-person meeting during meeting time m in any week and 0 otherwise. Binary parameter $O_{mt}$ equals 1 if meeting time m includes timeslot t and 0 otherwise.\nSections with irregular in-person meetings are modeled using binary parameter $K_{sd}$ which equals 1 (0) if section s does not have (does have) an in-person meeting on day d. For example, if hybrid section s meets twice in person during the semester, then $K_{sd}$ = 1 for all d except the two days of the in-person meetings. The days and times of all in-person meetings for section s are given by $I_{sm}$ and $K_{sd}$ combined.\nThere are R classrooms (i.e., rooms) on campus, and binary parameter $InitRoom_{rs}$ equals 1 if room r has been assigned to section s and 0 otherwise. If rooms have not been assigned, $InitRoom_{rs}$ equals 0 for all r and s. If a room has been assigned to every section, S of these parameters equal 1.\nThe HP-UCSP is particularly relevant if a pandemic occurs and classroom capacities suddenly decrease because social distancing is required in the classroom. Given this crisis, the university replans"}, {"title": "", "content": "the semester as follows. Going forward, each section will have a limited number of mass meetings during the semester when all students in the section meet in one or more rooms at the same time, with all other meetings online. The times of the mass meetings will be a subset of the times when the section normally meets, and the rooms assigned to the section will include the room already assigned to it (if any).\nDue to irregularities already built into the schedule, mass meetings will not occur in repeating fashion (e.g., weekly or biweekly). Instead, they will be scheduled across all W weeks and D days of the semester. The university will not allow any section to go fully online. In pursuit of fairness, it declares that at least $MinFraction_s$ of the in-person meetings that were planned for section s prior to the pandemic will still be in person during the pandemic (0 < $MinFraction_s$ \u2264 1 for all s).\nThe replanning effort considers the following information. First, $C_r$ is the adjusted capacity of room r with social distancing requirements. Binary parameter $J_{rs}$ equals 1 if the equipment in room r is compatible with section s and 0 otherwise. Some rooms may not be available on some days due to construction, flooding, or medical/vaccination activities, so binary parameter $NAvail_{rd}$ equals 1 (0) if room r is not (is) available on day d.\nThe university's overall task is to create a new schedule for each section during the pandemic that specifies the room(s) where, and (meeting time, week) pairs when, its mass meetings take place. The rooms where each section's mass meetings occur must remain fixed for the entire semester.\nThe pandemic schedule for each section is judged according to seven criteria. (1) The number of rooms used for the section should be minimized. (2) The distance between the rooms used for the section should be minimized. (3) The rooms used for the section should be in buildings that are preferred by the organization (i.e., department) that teaches it. (4) The number of wasted (i.e., unutilized) seats in the section's room assignment should be minimized. (5) The number of mass meetings for the section should be maximized. (6) The mass meetings should be spread throughout the semester, not packed into just a few weeks' time. (7) The fraction of the in-person meetings that were planned for section s prior to the pandemic and will still be in person during the pandemic should be at least $MinFraction_s$. Finally, because less experienced students need more in-person contact than more experienced students, there should be a preference for better schedules in lower-level (e.g., first year) courses than higher-level courses.\nNote that the HP-UCSP applies to the creation of a schedule before, or during, a semester. It also applies to room assignment in normal times (task 4 in Figure 1) if exactly one room is assigned to each section; all $InitRoom_{rs}$ = 0; $C_r$ is the normal (i.e., non-pandemic) capacity of room r; and $MinFraction_s$ = 1.0 for all s. With this in mind, we now introduce an integer programming formulation of the problem."}, {"title": "5. Mathematical model", "content": "Our mathematical model, model HP-UCSP, is shown in Tables 3-6 and equations 1-37. Table 3 shows the indices, and Table 4 shows the input data used in the model. Table 5 shows the decision variables and their domains. Table 6 shows the model's adjustable parameters. These can be changed by the user to pursue different objectives. Equation 1 is the objective function, and equations 2-37 are the constraints. The items in Tables 3-6 are generally sequenced in order of their appearance in equations 1- 37 and are explained as we discuss the objective function and constraints on the following pages.\nThe model is an integer program with three main decision variables shown at the top of Table 5. The first, $X_{smw}$, equals 1 if a mass meeting for section s is scheduled during meeting time m in week w and 0 otherwise. The second, $Y_{rs}$, equals 1 if room r is assigned to section s and 0 otherwise. The third, $Z_{rsmw}$, combines the information in the X and Y variables; it equals 1 if room r hosts a mass meeting for section s during meeting time m in week w and 0 otherwise.\nTwenty auxiliary decision variables, shown at the bottom of Table 5, help to enforce constraints and translate the values of the main decision variables into objective penalties. The first eight of these appear in the objective function; the last twelve do not.\nThe objective (1) is to minimize a sum of seven objective components, each weighted by a different factor $a_1$ to $a_7$. Components 1-4 (5-7) are impacted by where (when) each section meets. Each component is a sum of penalties for the S sections, with the penalty for section s weighted by a factor that depends on its importance ($Importance_s$) as determined by its course level, its enrollment ($E_5$), the number of in-person meetings it has during a normal semester ($CN_{sw}$) (note the capital W), and the duration of its meetings ($Duration_s$). The term $E_5*CN_{sw}*Duration_s$, the number of student-timeslots of in-person attendance in section s during a normal semester, appears in five objective components.\nPenalty 1 equals the number of rooms assigned to section s ($NumRooms_s$) minus 1. Penalty 2 is $DistPenalty_s$, an aggregate measure of the distance between rooms assigned to section s. It equals 0 if"}, {"title": "", "content": "Minimize:\n(\u03b11) * \u03a3=1[Importances * Es * CN5w * Durations * (NumRoomss \u2013 1)] +\n(a2) * =1[Importances * Es * CNsw * Durations * DistPenaltys] +\n(\u03b13) * \u03a3=1[Importances * Es * CNsw * Durations * PrefPenaltys] +\n(\u03b14) * \u03a3\u00a7=1[CNsw * Durations * WastedSeats5] +\n(\u03b15) * \u03a3=1[Importances * Es * CNsw * Durations * ((CNsw \u2013 CNPsw)/CNsw)ExP] +\n(\u03b16) * \u03a3=1[Importances * Es * Durations * TimingPenaltys] +\n(\u03b17) * =1[Importances * Es * CNsw * Durations * (1 \u2013 Us)]\nWe discuss the constraints in groups. Constraints 2a, 2b, and 2c ensure the consistency of $X_{smw}$, $Y_{rs}$, and $Z_{rsmw}$. Constraints 2a and 2b ensure that $Z_{rsmw}$ is no greater than 1 and is 0 if $X_{smw}$ or $Y_{rs}$ are 0. On the other hand, (2c) requires $Z_{rsmw}$ to be 1 if $X_{smw}$ and $Y_{rs}$ are both 1. These three constraints allow $Z_{rsmw}$ to be a real variable whose value is either 0 or 1 depending on the values of the binary variables $X_{smw}$ and $Y_{rs}$.\n$Z_{rsmw}$ \u2264 $X_{smw}$ for all r, s, m, and w\n$Z_{rsmw}$ \u2264 $Y_{rs}$ for all r, s, m, and w\n$Z_{rsmw}$ \u2265 $X_{smw}$ + $Y_{rs}$ - 1 for all r, s, m, and w\nConstraints 3-5 impose restrictions on $X_{smw}$. Constraint 3 ensures that a section's mass meetings"}, {"title": "", "content": "during a pandemic occur during its normal meeting times. Constraint 4 handles sections that have irregular in-person meetings in normal times, and (5) ensures there is no instruction on holidays.\n$X_{smw}$ \u2264 $I_{sm}$ for all s, m, and w\n$X_{smw}$ * $Q_{mwd}$* $K_{sd}$ = 0 for all s, m, w, and d\n$X_{smw}$ * $Q_{mwd}$ * $H_d$ = 0 for all s, m, w, and d\nConstraints 6-10 impose restrictions on $Y_{rs}$. Constraint 6 ensures that the rooms assigned to a section have sufficient capacity to accommodate it. Constraint 7 ensures that only suitable rooms are assigned to each section. Constraint 8 requires room r to be assigned to section s if the registrar already assigned it to the section. Constraints 9-10 compute the number of rooms assigned to a section and ensure that it does not exceed $MaxRooms$.\n$\u03a3_{r=1}^R$ $C_r$ * $Y_{rs}$ \u2265 $E_s$ for all s\n$Y_{rs}$ \u2264 $J_{rs}$ for all r and s\n$Y_{rs}$ \u2265 $InitRoom_{rs}$ for all r and s\n$NumRooms_s$ = $\u03a3_{r=1}^R$ $Y_{rs}$ for all s\n$NumRooms_s$ < $MaxRooms$ for all s\nConstraints 11-12 impose restrictions on $Z_{rsmw}$. Constraint 11 ensures that at most one section uses a room at any time, and (12) ensures that no instruction occurs in room r on day d if $NAvail_{rd}$ = 1.\n$\u03a3_{m=1}^M$$Z_{rsmw}$ * $O_{mt}$ \u2264 1 for all r, t, and w\n$Z_{rsmw}$ * $Q_{mwd}$ * $NAvail_{rd}$ = 0 for all r, s, m, w, and d\nConstraints 13-26 quantify the distance between rooms assigned to a section. Constraint 13 shows that $DistPenalty_s$, the second objective penalty, is a weighted sum of five terms. The first, $MaxBldgDist_s$, is the maximum distance in meters between buildings where section s is taught. This is zero if section s is taught in one building. The second, $(NumBldg_s$ - 1), is the number of extra buildings used for section s beyond the first. The third, $FloorDist_s$, is the total distance between floors where section s is taught, summed over each building where it is taught. For example, if section s uses four rooms that are located on floors 1, 2, and 6 of building A and floor 1 of building B, $FloorDist_s$ equals 5 (= 6 \u2013 1). The fourth"}, {"title": "", "content": "term, $NumExtraFloor_s$, is the number of extra floors, beyond one per building, used for section s. In the previous example, this is 2 for the two extra floors used in building A. The fifth term, $RoomNonadj_s$, is the number of nonadjacent room pairs in section s's room assignment. Two rooms are considered adjacent if they are on the same floor and either (i) share a wall and have doors in the same hallway or (ii) have doors directly across from each other. For example, if a section is taught in four rooms on four different floors, this is 6 = (4 nCr 2). If it is taught in four rooms in a row along the same side of a hallway, this is 3. If it is taught in four rooms whose doors are clustered at one location in a hallway, this is 0.\nConstraint 14 ensures that $DistPenalty_s does not exceed a given limit (possibly \u221e). Constraint 15 uses $Y_{rs}$ to compute $BU_{bs}$, which indicates if building b is used for section s. Constraint 16 uses $BU_{bs}$ and parameter $Dist_{bc}$ to compute $MaxBldgDist_s$. Constraint 17 uses $BU_{bs}$ to compute $NumBldg_s$. Constraint 18 uses $Y_{rs}$ to compute $FU_{fbs}$, which indicates if floor f in building b is used for section s. Constraints 19- 22 use $FU_{fbs}$ to compute $HighFloor_{bs}$ and $LowFloor_{bs}$, the highest and lowest floors in building b where section s is taught, which are then used to compute $FloorDist_s$. Constraint 23 uses $FU_{fbs}$ to compute $NumFloor_s$, and (24) computes $NumExtraFloor_s$. The values of $BU_{bs}$, $MaxBldgDist_s$, $NumBldg_s$, $FU_{fbs}$, $FloorDist_s$, $NumFloor_s$, and $NumExtraFloor_s$ are not accurate at all feasible solutions, but they are correct at every optimal solution due to their contribution to an objective function that is minimized. Constraints 25a, 25b, and 25c ensure the consistency of variables $YY_{qrs}$, $Y_{qs}$, and $Y_{rs}$. They allow $YY_{qrs}$, which indicates if rooms q and r are both used for section s, to be real instead of binary. Constraint 26 uses $YY_{qrs}$ and parameter $NAdj_{qr}$ to compute $RoomNonadj_s$. A detailed inspection of building floor plans is needed to determine the value of $NAdj_{qr}$ which equals 1 (0) if rooms q and r are not (are) adjacent.\n$DistPenalty_s$ = ($\u03b1_{21}$)(MaxBldgDists) +\n($\u03b1_{22}$)(NumBldgss \u2013 1) +\n($\u03b1_{23}$)(FloorDists) +\n($\u03b1_{24}$)(NumExtraFloorss) +\n($\u03b1_{25}$)(RoomNonadjs) for all s\n$DistPenalty_s$ < $MaxDistPenalty_s$ for all s\n$BU_{bs}$ * $MaxRooms$ \u2265 $\u03a3_{r=1}^R$$IBrb$ * $Yrs$ for all b and s\n$MaxBldgDists > Distbc \u2013 ($BigM$)*(2 \u2013 $BU_{bs}$ \u2013 $BU_{cs}$) for all (b, c) s.t. b < c and all s\n$NumBldgss = \u03a3_{b=1}^B$$BU_{bs}$ for all s\n$FU_{fbs}$ * $MaxRooms$ \u2265 $\u03a3_{r=1}^R$$IFrf$ * $IBrb$ * $Yrs$ for all f, b, and s\n$HighFloor_{bs}$ \u2265 f \u2013 (F)*(1 \u2013 $FU_{fbs}$) for all f, b, and s"}, {"title": "", "content": "$LowFloor_{bs}$ \u2264 f + (F)*(1 \u2013 $FU_{fbs}$) for all f, b, and s\n$HighFloor_{bs}$ > $LowFloor_{bs}$ for all b and s\n$FloorDists = \u03a3_{b=1}^B$(HighFloorbs \u2013 LowFloorbs) for all s\n$NumFloor_s = \u03a3_{f=0}^F\u03a3_{b=1}^B$$FU_{fbs}$ for all s\n$NumExtraFloor_s = NumFloor_s \u2013 NumBldg_s for all s\n$YY_{qrs}$ \u2264 $Y_{qs}$ for all q, r, and s\n$YY_{qrs}$ \u2264 $Y_{rs}$ for all q, r, and s\n$YY_{qrs}$ \u2265 $Y_{qs}$ + $Y_{rs}$ \u2013 1 for all q, r, and s\n$RoomNonadj_s$ = $\u03a3_{r=1}^R\u03a3_{q=r+1}^R$$NAdj_{qr}$ * $YY_{qrs}$ for all s\nConstraints 27-28 compute $PrefPenalty_s$, the third penalty term, and ensure it does not exceed a given limit (possibly \u221e). On the right side of (27), $G_s$ is the organization that teaches section s, $B_r$ is room r's building, and $P_{gb}$ is organization g's level of undesirability for teaching in building b. This is higher for buildings that are farther from organization g's office. Constraint 27 ensures that, at an optimal solution, $PrefPenalty_s$ equals the building preference penalty of the worst building used for section s.\n$PrefPenalty_s$ \u2265 $PG_{s,Br}$ \u2212 ($BigM$)*(1 \u2013 $Y_{rs}$) for all r and s\n$PrefPenalty_s$ < $MaxPrefPenalty_s$ for all s\nConstraints 29-30 compute $WastedSeat_s$, the fourth penalty term, and ensure it does not exceed a user-defined limit (possibly \u221e). Wasted seats are a system-wide loss, not a loss for the section that wastes them, so the factors $Importance_s$ and $E_s$ are omitted from objective component 4 (see Eq. 1).\n$WastedSeats_s = \u03a3_{r=1}^R ( C_r * Y_{rs}) \u2013 E_s$ for all s\n$WastedSeats_s < MaxWastedSeat_s for all s\nConstraints 31-32 compute $CNP_{sw}$, the number of mass meetings for section s in weeks 1 to w combined, which is used in penalty 5. Constraint 33, which is optional, requires at least $MinFraction_s$ of section s's meetings to be in person (note the capital W)."}, {"title": "", "content": "$NP_{sw} = \u03a3_{m=1}^M$$X_{smw}$ for all s and w\n$CNP_{sw} = \u03a3_{k=1}^W$$NP_{sk}$ for all s and w\n$CNP_{sw}$ \u2265 $MinFraction_s$ * $CN_{sW}$ for all s (optional)\nConstraints 34-36 relate to penalty 6. Constraints 34-35 use $CNP_{sw}$ to compute $Diff_{sw}$ which is summed in (36) to give $TimingPenalty_s$, a measure of the irregularity in the timing of section s's mass meetings. The right sides of (34-35) are opposites, and $Diff_{sw}$ must exceed both, so the minimization of $TimingPenalty_s$ in (1) means that $Diff_{sw}$ equals the absolute value of the difference between the terms on the right of (34) at an optimal solution. Term 1 on the right of (34) is the actual number of mass meetings for section s in weeks 1 to w combined ($CNP_{sw}$), and term 2 is the prorated number of such meetings. For example, consider a section that normally meets once a week during an 8-week semester but has only four mass meetings in weeks 5, 6, 7, and 8 during a pandemic. In this case, $CNP_{sw}$ is (0, 0, 0, 0, 1, 2, 3, 4) and the prorated number of meetings is (0.5, 1, 1.5, 2, 2.5, 3, 3.5, 4) in weeks 1 to 8 respectively. The absolute value of the difference is (0.5, 1, 1.5, 2, 1.5, 1, 0.5, 0), and these terms sum to 8 = $TimingPenalty_s$. This high penalty indicates the meetings are poorly distributed. If the mass meetings occur in weeks 2, 4, 6, and 8, $CNP_{sw}$ is (0, 1, 1, 2, 2, 3, 3, 4), and the absolute value of the difference between it and the prorated number of meetings is (0.5, 0, 0.5, 0, 0.5, 0, 0.5, 0) which sums to 2. This low penalty indicates the meetings are well distributed. The expected value of $TimingPenalty_s$ grows linearly in the number of mass meetings for section s, so the factor $CN_{sw}$ is omitted from objective component 6 (see Eq. 1).\n$Diff_{sw}$ \u2265 $CNP_{sw}$ - $\\frac{w - FirstW_s + 1}{LastW_s - FirstW_s + 1}$$CNP_{sW}$ for all s and all w from $FirstW_s$ to $LastW_s$\n$Diff_{sw}$ \u2265 $\\frac{w - FirstW_s + 1}{LastW_s - FirstW_s + 1}$$CNP_{sW}$ - $CNP_{sw}$ for all s and all w from $FirstW_s$ to $LastW_s$\n$TimingPenalty_s = \u03a3_{w=Firstw}^{LastW_s}$$Diff_{sw}$ for all s\nConstraint 37 relates to objective penalty 7. It forces $U_s$ to be 0 if $CNP_{sw}$ < ($MinFraction_s$ * $CN_{sW}$), i.e., if less than $MinFraction_s$ of section s's meetings are in person (note the capital W).\n$CNP_{sw}$ > $U_s$ * ($MinFraction_s$ * $CN_{sW}$) for all s"}, {"title": "6. OFFICE algorithm", "content": "The math model is prohibitively large for real problem instances. For example, our case study has 172 rooms, 1834 sections, 590 weekly meeting times, and 16 weeks. This amounts to approximately"}, {"title": "", "content": "3 billion (=172*1834*590*16) $Z_{rsmw}$ variables. Preliminary experiments with IBM ILOG CPLEX 12.9 and only 18 course sections crashed our computer on 100% of occasions due to a lack of memory. This motivated the development of a heuristic algorithm for the HP-UCSP.\nOur heuristic algorithm is called OFFICE (Optimized Face-to-Face Interaction for Commerce and Education). It is designed to generate excellent course schedules that balance the seven competing objectives in (1). Nevertheless, the algorithm has priorities. Roughly speaking, the algorithm prioritizes objective components 1-7 in the following order: 7, 2, 3, 1, 4, 5, 6. Fairness is paramount in our approach, so the algorithm's main goal is to allow a basic fraction of meetings for every course section to be in person (objective 7). However, room assignment possibilities are limited a-priori to ensure good results for objectives 1-4. Once objective component 7 is zeroed out, OFFICE tries to maximize total student-hours in a classroom across the entire campus (objective 5). Built into its core scheduling engine is a preference to schedule meetings in weeks that are spread throughout the semester (objective 6).\nThe OFFICE algorithm follows the seven-step procedure shown in Table 7. In step 1, we create an exhaustive list of possible room assignments (PRAs) for each sections. Each PRA is a unique set of"}, {"title": "7. Case study: [UniversityXYZ] campus in Fall 2022", "content": "Our first two consultations with the [UniversityXYZ] Registrar's Office took place in late February and early March 2020, just weeks before the COVID-19 outbreak. Back then we were interested in regular classroom assignment, but our interests later expanded to include pandemic preparedness and response. In this section, we describe our work to develop schedules for the fall 2022 semester at [UniversityXYZ]. We discuss our dataset, describe our experimental setup, and present the results of two experiments that consider course scheduling (i) in normal times and (ii) during a pandemic."}, {"title": "7.1. Data collection", "content": "[UniversityXYZ] is [StateXYZ]'s second largest university with 23,000 students, 206 academic programs, and a 104-acre campus. It is one of two \u201cR1\u201d universities in the state. Highly competent staff members in the registrar's office gave us data for the fall 2022 semester one week before it began."}, {"title": "7.2. General experimental setup", "content": "Data received from the registrar was translated into text files, and the OFFICE algorithm was coded into MS Visual C++ 2010. All experiments were run on a desktop PC with the Windows 7 Enterprise operating system, an Intel core i7-4770 (3.40 GHz) processor, and 16 GB of RAM.\nWe set up the OFFICE algorithm with V = 5 waves. Wave 1 has all meetings for each of the ten sections representing midterm exams for large chemistry courses (Section 7.1). ($MinFraction_s$ = 1.0 for these special sections.) Wave 2 has $MinFraction_s$ of the meetings for each of the (42 other) sections with irregular in-person meetings. Most of these sections have infrequent in-person meetings, so opportunities for mass meetings are scarce. Wave 3 (4) has $MinFraction_s$ of the meetings for each regular section that has an enrollment of at least (below) ENR, and wave 5 has all other meetings."}, {"title": "7.3. Experiment 1: Regular classroom assignment", "content": "Table 12 shows the results of six independent, one-hour runs of the OFFICE algorithm for regular classroom assignment (task 4 in Figure 1). The second column shows the performance of the registrar's room assignments that were used in fall 2022. Column 3 shows the performance of OFFICE's room assignments, averaged over the six runs. Column 4 shows the results for OFFICE in the best of the six runs. Objective values (in thousands) are at the top, and other results are at the bottom. The values of objective components 5 and 7 are 0 in all cases, indicating that 100% of all sections' meetings are feasibly scheduled. Components 1-2 are 0 because every section meets in one room, and component 6 is nonzero owing to the discrete, imperfect way of computing $TimingPenalty_s$. Regarding objective component 3, the average value achieved by OFFICE (238,730) is less than half the value achieved in the registrar's assignment (484,832). Overall, OFFICE finds significantly better room assignments than the registrar's software program."}, {"title": "7.4. Experiment 2: Pandemic preparedness and response", "content": "We now consider pandemic preparedness and response in two scenarios: (R) if each section's room assignment must include the room initially assigned to it by the registrar (task 6 in Fig. 1) and (NR) if not (task 4A in Fig. 1). For each scenario, we explore six values of $MinFraction_s$ (for the course sections in waves 2-4)\u20140.05, 0.1, 0.15, 0.2, 0.25, and 0.3\u2014and we run OFFICE six times for each value, yielding 72 (1-hour) runs altogether. In all runs, $MinFraction_s$ is 1.0 for all course sections in wave 1.\nThe main result of this experiment is that, in all runs with $MinFraction_s$ \u2264 0.25, OFFICE was able to schedule at least $MinFraction_s$ of all sections' meetings in person. Figure 3 shows the average objective value (in thousands) of the solutions identified by OFFICE in these runs. Here, performance improves as the decision maker faces fewer restrictions. For example, OFFICE finds better solutions in scenario NR (gray line with round points) than R (black line with square points). Also, the objective value improves as $MinFraction_s$ decreases, i.e., as the conditions for zeroing out objective 7 are relaxed.\nThe results when $MinFraction_s$ = 0.3 are not shown in Figure 3 because no such runs resulted in"}, {"title": "8. Conclusion", "content": "Scheduling university courses is especially difficult when social distancing requirements reduce the useful capacity of classrooms during a pandemic. In this work, we introduce a new framework for university course scheduling that is based on three principles which have received little attention in the literature: fairness, simultaneous attendance, and high-precision scheduling. Our approach is fair by ensuring that a certain fraction (e.g., 25%) of the instruction in every course section occurs in the classroom during a pandemic. Our focus on simultaneous attendance, in which all students in a section meet at the same time in one or more nearby rooms, creates opportunities for in-person midterm exams and group activities that are not available with rotating attendance. As discussed earlier, the best way to achieve fairness with simultaneous attendance is to schedule at high precision across all days of a semester rather than a single, repeating week. These ideas led to the development of the OFFICE algorithm and its testing on a real case with 1834 in-person course sections, 172 classrooms, and 96 days. Results show the algorithm is an effective course scheduling tool in both normal and pandemic times.\nFuture work might apply the OFFICE algorithm to other institutions or to event/space"}]}