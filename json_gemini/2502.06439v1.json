{"title": "Testing software for non-discrimination: an updated and extended audit in the Italian car insurance domain", "authors": ["Marco Rondina", "Antonio Vetr\u00f2", "Riccardo Coppola", "Oumaima Regragrui", "Alessandro Fabris", "Gianmaria Silvello", "Gian Antonio Susto", "Juan Carlos De Martin"], "abstract": "Context. As software systems become more integrated into society's infrastructure, the responsibility of software professionals to ensure compliance with various non-functional requirements increases. These requirements include security, safety, privacy, and, increasingly, non-discrimination.\nMotivation. Fairness in pricing algorithms grants equitable access to basic services without discriminating on the basis of protected attributes.\nMethod. We replicate a previous empirical study that used black box testing to audit pricing algorithms used by Italian car insurance companies, accessible through a popular online system. With respect to the previous study, we enlarged the number of tests and the number of demographic variables under analysis.\nResults. Our work confirms and extends previous findings, highlighting the problematic permanence of discrimination across time: demographic variables significantly impact pricing to this day, with birthplace remaining the main discriminatory factor against individuals not born in Italian cities. We also found that driver profiles can determine the number of quotes available to the user, denying equal opportunities to all.\nConclusion. The study underscores the importance of testing for non-discrimination in software systems that affect people's everyday lives. Performing algorithmic audits over time makes it possible to evaluate the evolution of such algorithms. It also demonstrates the role that empirical software engineering can play in making software systems more accountable.", "sections": [{"title": "1 Introduction and Motivation", "content": "As the level of integration of software systems into the infrastructure of society rapidly increases, so does the responsibility of software professionals [1]. They must ensure that the software they deploy meets a wide range of non-functional requirements such as security, safety, privacy, and, increasingly, non-discrimination. Addressing issues of unfairness in different application domains has become a critical and urgent task: recent studies have identified algorithmic discriminations in areas that are crucial for maintaining equal opportunities for all in society, such as education [2], healthcare [22], employment [19], justice [21] and commerce [12]. In the context of the software engineering discipline, testing software for non-discrimination is a form of non-functional testing [11,3], since biased and unfair decisions have a serious impact on software quality of use, where societal and ethical risks have been recognised in recent standards developments [16,17] and scientific proposals [29]. In addition, the introduction of the AI Act includes proof of non-discrimination for high-risk systems [6].\nThis study is an audit of an online software system in the Italian car insurance industry: it is ethically and legally imperative to ensure that the software automates and differentiates pricing equitably. We update and extend an original paper by Fabris et al. [9], which quantified the impact of gender and birthplace on insurance pricing in an online system. We extend the original study by including additional demographic attributes, which results in a larger and more nuanced test protocol. This research highlights the importance of testing for non-discrimination in automated pricing algorithms and, more broadly, in software systems that as the ACM Code of Ethics and Professional Conduct recognises are \"integrated with everyday activities such as commerce, travel, government, healthcare and education\" [1] (Article 3.7).\nThe remainder of the paper is organized as follows: in Section 2, we frame the regulations for the domain of interest, and we describe related work in the field; in Section 3, we describe the research questions and experiment design; we report on results in Section 4 and discuss them in Section 5; in Section 6, we discuss the potential threats to validity; finally, in Section 7, we summarize the findings and explore future research directions."}, {"title": "2 Background and related work", "content": "The Italian car insurance market is regulated by the Italian Insurance Supervisory Authority (IVASS), which collaborates with international organizations like the International Association of Insurance Supervisors (IAIS) and the European Insurance and Occupational Pensions Authority (EIOPA) to ensure market stability and compliance with international standards. This framework prioritizes consumer protection and prohibits discriminatory practices in premium calculations based on personal characteristics. As a matter of fact, following a 2011 ruling by the European Court of Justice [7], insurers cannot use gender when setting rates. The Article 16 of the European Directive 2021/2118 [5] stipulates that no premium surcharges may be applied on the basis of nationality."}, {"title": "3 Methodology", "content": "This section outlines the research methodology used in this study: firstly we illustrate the research questions, then we report on the experiment design. Finally, we describe the data collection process."}, {"title": "3.1 Goal and research questions", "content": "The goal of the research is defined with the GQM (Goal-Question-Metric [25]) template as follows: test pricing algorithms for the purpose of auditing an online software system with respect to non-discrimination from the point of view of the users in the context of the Italian car insurance industry. Two research questions stem from this goal.\nRQ1: Do protected attributes (gender, birthplace, age) and socio-demographic attributes (city, marital status, education, profession) directly influence quoted premiums? This question would determine whether protected attributes and socio-demographic attributes are related to the insurance quotes provided to the users. This question aims at investigating whether prices vary for similar profiles that differ in only one attribute.\nRQ2: Do protected attributes (gender, birthplace, age), socio-de-mographic attributes (city, marital status, education, profession) and driving attributes (car, km driven, class) influence the number of quotes presented to the user? This question focuses on how often car insurance companies appear in search results for different driver profiles. The rationale is to investigate whether profile characteristics expose users to fewer offers, suggesting discrimination when it comes to the availability of quotes among insurance options for them."}, {"title": "3.2 Analysis method", "content": "We performed a preliminary exploratory analysis by analysing the prices' distribution for each attribute value. As an example, we assessed the spread between the average premium for male and female drivers. The preliminary exploratory analysis is presented in Section A of the Supplementary materials.\nDiscrimination Analysis (RQ1) To investigate whether protected attributes directly influence quoted premiums, we analysed the distribution of the price differences $\\delta$ for pairs of profiles that differ only in one attribute. The statistical reliability of the median was checked using a sign test with $\\mu_0$ = 0 and considering significant p-values below the 0.05 threshold. We analysed the top1 and the top5 quotes. The top1 analysis concentrates exclusively on the most affordable"}, {"title": "4 Results", "content": "The data collected from the queries include six different companies that were offering up to four insurance products for each query. The insurance companies"}, {"title": "4.1 Discrimination Analysis (RQ1)", "content": "Tables 3 and 4 presents the results of the discrimination analysis. Negative values indicate that profiles with the test value obtained lower prices; positive values indicate that they obtained higher quotes compared to those obtained by the baseline. We observe that:\nGender, confronting females and males profiles, on one hand shows a median equal to zero in both top1 and top5. On the other hand, the difference between $\\eta$.95($\\delta$) and $\\eta$.05($\\delta$) raises from 20 \u20ac in top1 to 189 \u20ac in top5 (0 \u20ac in control pairs), while Ties5 drop from 89% to 78% (98% in control pairs).\nBirthplace, is used to the advantage of drivers born in Milan. Drivers born outside Italy were the most highly rated: on average, drivers born in Morocco are charged 200 \u20ac more than otherwise identical drivers born in Milan.\nAge shows a median difference of 64 \u20ac in the analysis of the cheapest offer, this value increases to 211 \u20ac when looking at the average of the five cheaper offers."}, {"title": "4.2 Output Variability (RQ2)", "content": "Figure 1 provides an overview of the percentage of quotes presented by each company, for each value of the attributes. Companies C1 and C5 are not represented, as they submitted at least one offer for all profiles, i.e. they reached 100% for each class of all attributes. Regarding the other companies: C2 appeared for about a third of the profiles, C3 for about a quarter of the profiles, C6 offered an insurance only for a small subset of records and C4 was present in about 60% of the queries. It is possible to see a few relevant differences for different profiles, but these differences are company-specific with no general trends:\nThe company C2 submitted fewer quotes for profiles with birthplace setted to Morocco. At the same time, it submitted quotes for about 75% of profiles with the car type Old, Large Engine, Diesel (OLED), while no quotes appeared for New, Small Engine, Petrol (NSEP).\nThe company C3 was rather balanced in all characteristics, except for risk class: it was present in almost all profiles with the highest risk class (18), but was absent for the others.\nThe company C4 presents significantly more quotes for NSEP cars than for OLED cars. It also presents a non-uniform distribution of quotes per risk class.\nThe company C6 presents fewer quotes, so it is more difficult to draw relevant conclusions. However, it is possible to notice that it only presented quotes for the riskier driving class and for profiles living in Milan, and that there are no quotes for OLED cars."}, {"title": "5 Discussion", "content": "RQ1: Do protected attributes (gender, birthplace, age) and socio-demographic attributes (city, marital status, education, profession) directly influence quoted premiums? The original study looked at price discrimination based on birthplace and gender. With regard to the first one, we confirm that the birthplace has a direct impact on the premium offered: people born in Naples systematically receive higher prices. This type of discrimination is even more pronounced when we look at the profiles with an Italian birthplace compared to the profiles with a foreign birthplace (in our case, Moroccan and Chinese). With regard to gender, as in the original study, there is no systematic advantage in one direction (male or female). Age is used to systematically discriminate against younger people: this is expected as on average - the youngest have a higher risk class, however, this is not systematic as the risk class in Italy can be inherited from a family member. Further investigations looking at the intersection of age and risk class are needed. City of residence is the attribute that reveals the greater systematic discrimination: residents in Milan pay, on average, 128\u20ac less than residents in Naples. On the one hand, it seems that insurance companies consider driving in Naples to be riskier than driving in Milan. On the other hand, the Italian National Statistics Institute, in its latest report on road accidents (2022), showed that the absolute number of road accidents and the fatality rate per 100,000 inhabitants were higher in Milan than in Naples [18]. Marital status and profession show a slight discrimination against married, widowed and unemployed profiles. In terms of education, those with no qualifications are paying way much more than those with a Master's degree (in the top5 analysis). We can hypothesise that these attributes play the role of a proxy variable for the age attribute, since younger people are considered to be more at risk of car accidents [13]. However, further multivariate distribution analysis should be performed to confirm this hypothesis. Nevertheless, the magnitude of the differences confirms that all the protected characteristics analysed play a relevant role in the pricing algorithms.\nRQ2: Do protected attributes (gender, birthplace, age), socio-demographic attributes (city, marital status, education, profession) and driving attributes (car, km driven, class) influence the number of quotes presented to the user? The original study showed that younger people, residents of Naples and drivers with the worst risk class received fewer offers. With regard to age, we do not observe any significant differences between 25 and 32, but it should be noted that we did not test the age of 18 (as described in Section 3.3), which seemed to be the least desirable for insurance companies. Observing the influence of the city of residence, only one company confirms the pattern of imbalance between Milan and Naples in terms of the number of offers. As for the claims' history (class), the results are controversial. On the one hand, company C4 confirms the pattern shown in the original study, i.e. the fact that the riskier profiles receive fewer quotes. On the other hand, companies C3 and C6 appear only for the highest risk class. We can hypothesise that some companies are attracted by the possibility of obtaining higher revenues."}, {"title": "6 Threats to Validity", "content": "In this section, we report the main threats to the validity of the study according to classifications available in the literature [10]. The main external validity threat of our study is that the examination has been conducted on only one comparator website. Future studies shall expand the scope to include multiple systems to provide a more comprehensive understanding of the issues. It is not ensured as well whether our results can be applied to other countries or other domains. As internal validity threats are concerned, the major ones lie in the selection of the variables that were analysed. Additional variables among those collected by the algorithms could be in fact investigated, including further proxies of socio-economic conditions and intersectional attributes."}, {"title": "7 Conclusions and future work", "content": "This study is an extended and updated audit of pricing algorithms used in an online system comparing car insurance prices in Italy. The analysis confirms and extends the findings of the original study: several demographic variables had a significant impact on pricing, with place of birth emerging as a discriminatory factor, especially for those not born in Italian cities. In terms of non-equal opportunities, driver profiles (e.g., car type) determine the options available to users, and for two companies this was based on protected attributes.\nThese results not only demonstrate the importance of verifying fairness in algorithmic pricing mechanisms and, more generally, of continuously testing software services for non-discrimination, but they also show that empirical methods especially in relation to experiment design in conjunction with testing techniques are well suited to such goals. As a result, our work is an example of the potential role that empirical software engineering can play in the emerging field of testing algorithms for non-discrimination. With this vision in mind, future work in this domain will be devoted to increasing the level of test automation, switching features - including intersectional attributes- and tracking prices over time. More generally, we hope that this vision lead to future experiments in the other areas identified by Art. 3.7 of the ACM Code of Ethics and Professional Conduct, where non-discrimination is paramount."}]}