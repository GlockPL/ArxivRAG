{"title": "CVaR-Based Variational Quantum Optimization\nfor User Association in Handoff-Aware\nVehicular Networks", "authors": ["Zijiang Yan", "Hao Zhou", "Jianhua Pei", "Aryan Kaushik", "Hina Tabassum", "Ping Wang"], "abstract": "Efficient resource allocation is essential for opti-\nmizing various tasks in wireless networks, which are usually\nformulated as generalized assignment problems (GAP). GAP, \nas a generalized version of the linear sum assignment problem, \ninvolves both equality and inequality constraints that add compu-\ntational challenges. In this work, we present a novel Conditional \nValue at Risk (CVaR)-based Variational Quantum Eigensolver \n(VQE) framework to address GAP in vehicular networks (VNets). \nOur approach leverages a hybrid quantum-classical structure, \nintegrating a tailored cost function that balances both objective \nand constraint-specific penalties to improve solution quality and \nstability. Using the CVaR-VQE model, we handle the GAP \nefficiently by focusing optimization on the lower tail of the \nsolution space, enhancing both convergence and resilience on \nnoisy intermediate-scale quantum (NISQ) devices. We apply this \nframework to a user-association problem in VNets, where our \nmethod achieves 23.5% improvement compared to the deep \nneural network (DNN) approach.", "sections": [{"title": "I. INTRODUCTION", "content": "Resource allocation is a fundamental and crucial problem\nin wireless networks, which can be usually formulated as\ngeneralized assignment problems (GAP) and known as NP-\nhard [1]. Allocation problems appear in various contexts,\nincluding computation offloading in edge computing systems,\nsub-channel assignment [2], user scheduling and load bal-\nancing [3], and antenna selection [4]. Traditional approaches\nto solving GAP in wireless networks often rely on clas-\nsical optimization methods, which become computationally\nprohibitive as network complexity increases, particularly in\nemerging 5G/6G networks where channel coherence time is\nsignificantly shorter at higher frequencies such as mm-wave\nand THz bands. Moreover, machine learning techniques have\nbeen introduced to optimize the GAP problem through various\napproaches, including deep reinforcement learning (DRL) for\nvehicular communication optimization [2], [5], [6], deep neu-\nral network (DNN)-based optimization for user-to-base station\n(BS) associations [7], and over-the-air federated learning for\nantenna selection in massive MIMO systems [4].\nThe emergence of quantum computing has opened new\nfrontiers in solving complex optimization problems across\nvarious domains. Compared to classical machine learning ap-\nproaches, the quantum algorithm operates within the quantum\ncomputational paradigm, offering potential advantages in accu-\nracy and efficiency by directly leveraging quantum mechanical\nprinciples. The potential advantages of quantum algorithms\nhave been demonstrated in many existing studies [8], [9].\nAmong quantum algorithms, variational quantum eigensolver\n(VQE) [9] has gained significant attention due to its hybrid\nquantum-classical nature, making it particularly suitable for\nimplementation on noisy intermediate-scale quantum (NISQ)\ndevices [10]. While VQE was initially designed for quantum\nchemistry applications, its potential for solving optimization\nproblems has sparked interest across different fields.\nThe application of VQE to the GAP problem in vehicular\nnetworks (VNet) presents a promising approach for several\nreasons. (1) VQE's hybrid nature enables the exploitation\nof quantum advantages while mitigating hardware limitations\nthrough classical post-processing. Specifically, the quantum\nprocessor handles quantum state preparation, while the classi-\ncal VQE network optimizes the parameters [9]. In this work,\nwe consider vehicle-to-BS associations are binary, making\nthem suitable for mapping to a quadratic unconstrained bi-\nnary optimization (QUBO) problem that aligns well with\nthe quantum operators in VQE's framework. (2) Compared\nto purely quantum algorithms, VQE demonstrates greater\nresilience to noise. Its variational approach allows the quantum\nsystem to achieve a low-energy state without requiring perfect\noperations, making it practical for NISQ devices [11]. (3)\nVQE employs variational quantum circuits with relatively\nshallow depths, which reduces the number of quantum gates\nrequired. [12]. This design minimizes decoherence, making\nVQE feasible on current quantum hardware. Moreover, VQE\nallows for flexible ansatz customization, enabling adjustments\nacross various vehicle-to-BS association scenarios.\nMotivated by the advantages of VQE techniques, this work"}, {"title": "II. VEHICULAR NETWORK SYSTEM MODEL", "content": "This section presents the vehicular network model and the\nproblem formulations employed in this study. Illustrated in \nFigure 1, the model considers a downlink network environ-\nment comprising NR RF base stations (RBSs) and NT THz\nbase stations (TBSs) interacting with multiple autonomous\nvehicles. We denote the set of autonomous vehicle users by\n$I = \\{1, ..., I\\}$ and base stations by $J = \\{1, ..., J\\}$. Our\ngoal, from a Vehicle-to-Infrastructure (V2I) communication\nperspective, is twofold: to maximize the V2I data rate and\nto minimize handovers.\nWe assume that $M_1$ autonomous vehicles (AVs) receive data\nfrom roadside BSs [2], with each AV linked to a single BS,\neither RBS or TBS. These AVs use onboard units to collect\nreal-time data from the vehicular network, including the speed,\nacceleration, and lane position of nearby vehicles.\nThe Signal-to-interference-plus-noise ratio (SINR) for the\nj-th AV from BS i is given by [2]:\n$SINR_{ij}^{RF} = \\frac{P_RG_t^iG_r^j(c/f_R)^2H_i}{(\\frac{4\\pi}{c})^2r_{ij}^\\rho(\\sigma^2 + I_{R_j})}$,\nwhere $P_R$, $G_t^i$, $G_r^j$, $c$, $f_R$, and $\\rho$ represent the RBS transmit\npower, transmitting and receiving antenna gains, the speed\nof light, RF carrier frequency, and the path-loss exponent,\nrespectively. Here, $r_{ij} = (d_{ij}^2 + h^2)^{1/2}$, where $d_{ij}$ is the 2D\ndistance between AV j and BS i, and $h_{ij}$ is the antenna height.\nAlso, $H_i$ is the channel gain from RBS i, $\\sigma^2$ is the receiver\nnoise power, and $I_{R_j}$ is the cumulative interference from other\nRBSs. For TBSs, the SINR for AV j is modeled as [13]:\n$SINR_{THz} = \\frac{G_t^iG_r^jP(\\frac{c}{f_T})^2 exp(-K_a(f_T)r_{ij})}{((\\frac{4\\pi}{c})^2r_{ij}^\\rho)(N_{T_j} + I_{T_j})}$,\nwhere $G_t^i$, $G_r^j$, $P$, $f_T$, $K_a(f_T)$, $N_{T_j}$, and $I_{T_j}$ represent\nthe TBS transmit and receive antenna gains, transmit power,\nTHz carrier frequency, the medium's molecular absorption\ncoefficient, the cumulative interference between AV j and\nthe interfering TBS i, molecular and thermal cumulative\nabsorption noise, respectively [6].\nEach AV, equipped with a single antenna, relies on beam\nalignment to ensure its receiving beam aligns with the TBS's\ntransmitting beam. The likelihood of main lobe alignment for\nboth the user and interfering TBS is denoted by probability\nq, with interference calculated accordingly [13]. The available\nbandwidths for RBS and TBS are $W_R$ and $W_T$, respectively,\nand the AV-BS link data rate is given by:\n$R_{ij} = W_i log_2(1 + SINR_{ij})$.\nEach RBS and TBS can support a maximum of $Q_R$ and\n$Q_T$ AVs, respectively [6]. For a connection to be acceptable,\n$SINR_{ij}$ must exceed a threshold $\\Upsilon_{th}$. As AVs travel, they switch\nto different BSs when $SINR_{ij}$ drops below $\\Upsilon_{th}$. Frequent\nhandovers (HOs) lead to reduced data rates due to latency, so\nwe introduce a HO penalty $\\mu$, with TBSs incurring a higher\npenalty than RBSs. The weighted data rate between BS i and\nAV j is defined as:\n$WR_{ij} = \\frac{R_{ij}}{min(Q_i, n_i)}(1 - \\mu)$,"}, {"title": "III. QUADRATIC UNCONSTRAINT BINARY OPTIMIZATION", "content": "In this study, we aim to optimize the BS-User association\nmatrix. Since $U_{ij}$ in (5) represents a binary variable, this binary\nnature aligns with the Quadratic Unconstraint Binary Opti-\nmization (QUBO) problem [14]. Both the objective function\nand constraints in (5) can be expressed as quadratic functions\nof binary variables. Since conventional quantum optimization\nmethods, such as fully separable variational states [15], impair\nquantum encoding performance and affect training efficiency,\nwe apply QUBO to reformulate the problem outlined in (5).\nThis section will introduce QUBO, a framework closely\nrelated to our problem formulation in equation (6). Assuming\na cost function $f(x)$ includes products of boolean variable\n$x_i \\in \\{0,1\\}$. An matrix $Q \\in R^{nxn}$ is N-by-N square\nsymmetric matrix of coefficients, we would like to minimize\noverall system cost function as [15],\n$E(x) = \\sum_{ij} x_iQ_{ij} x_j$,\nwhere is an binary N-dimensional vector. x is a vector\nrepresenting the binary assignment vector for BS i. Note that\n$x_ix_i = x_i$ for binary variables.\nConsidering the system model presented in Section II, a\nQUBO problem can be mapped to an Ising spin model [10].\nTherefore, the optimization of the system cost function in\n(7) can be derived to find minimum energy state of an Ising\nHamiltonian for an N-qubit system. Each qubit represents the\nvehicle-BS association. We can apply the change of variable\n$x_i \\rightarrow \\frac{1}{2}(1+\\sigma_i^z)$, where $\\sigma_i^z$ is the Pauli-Z matrix acting on the\ni-th qubit. We convert this expression to an Ising Hamiltonian\nform by changing variables from binary variables $x_i$ to spin\nvariables $\\sigma_i$ as\n$E(x) = \\sum_{ij} Q_{ij}(\\frac{1 + \\sigma_i^z}{2})(\\frac{1 + \\sigma_j^z}{2}) = \\frac{1}{4}(\\sum_{ij}Q_{ij} + \\sum_iQ_{ii}\\sigma_i^z + \\sum_jQ_{jj}\\sigma_j^z + \\sum_{ij}Q_{ij}\\sigma_i^z\\sigma_j^z) = \\frac{1}{4}(\\sum_{ij}Q_{ij} + \\sum_iQ_{ii}\\sigma_i^z + \\sum_{i \\neq j}Q_{ij}\\sigma_i^z\\sigma_j^z) = \\frac{1}{4}(\\sum_{ij}Q_{ij} + \\sum_iQ_{ii}\\sigma_i^z + \\sum_{i<j}Q_{ij}\\sigma_i^z\\sigma_j^z + \\sum_{i>j}Q_{ij}\\sigma_i^z\\sigma_j^z) = \\frac{1}{4}\\sum_{ij}Q_{ij} + \\frac{1}{4}\\sum_iQ_{ii}\\sigma_i^z + \\frac{1}{2}\\sum_{i<j}Q_{ij}\\sigma_i^z\\sigma_j^z = \\frac{1}{4}\\sum_{ij}Q_{ij} - H$,\nwhere $H$ is the Ising Hamiltonian [10]. Since $Q_{ij}$ contains\nboth positive and negative coefficients, so the optimization is\nchallenging. The equation (7) can be rewritten as\n$f(\\sigma^z) = \\frac{1}{4}\\sum_{ij}Q_{ij} - H$,\nwhere\n$H = \\sum_i\\frac{-Q_{ii}}{4}\\sigma_i^z - \\frac{1}{2}\\sum_{i<j} Q_{ij}\\sigma_i^z\\sigma_j^z$.\nRegarding equation (5) and [14], the final QUBO problem\ncan be formulated as:\n$H_{QUBO} = \\sum_{i=1}^I\\sum_{j=1}^J(-WR_{ij}u_{ij}) + \\lambda_1\\sum_{i=1}^I(\\sum_{j=1}^J u_{ij} - 1)^2 + \\lambda_2\\sum_{j=1}^J(\\sum_{i=1}^I u_{ij} - Q_i)^+$,\nwhere $(x)^+ = max(0,x)$, ensuring the penalty applies only\nwhen $n_i$ exceeds $Q_i$. $\\lambda_1$ and $\\lambda_2$ are the balancing factor on\nC1 and C2 in (5) ."}, {"title": "IV. PROPOSED CVAR BASED VQE APPROACH", "content": "This section introduces our proposed CVaR-VQE method,\ndesigned to address the QUBO problem presented in the\nprevious section. Compared to existing approaches, the CVaR-\nVQE method achieves accurate results with fewer samples and\noffers enhanced management of decoherence and operational\nerrors. Specifically, this section first introduces quantum neural\nnetworks (QNNs), which serve as the practical architecture\nfor executing quantum algorithms with parameterized gates.\nThen, we present variational quantum eigensolver (VQE),\nwhich is a key application of variational quantum circuits\nand is specifically designed to find the ground state energies\nof quantum systems. VQE combines quantum and classical\ncomputing in a hybrid approach, where the quantum circuit\nperforms state preparation and measurement, while classical\noptimization adjusts the circuit parameters. As an enhancement\nto standard VQE, we further introduce the Conditional Value at\nRisk-Variational Quantum Eigensolver (CVaR-VQE) to focus\non outlier examples to improve the training and evaluation\nefficiency under uncertainty."}, {"title": "A. Parametrized Quantum Operations and Variational Quantum Algorithms", "content": "The basic structure of a quantum neural network (QNN)\nused in this study is illustrated in Fig. 2 [8]. The system\ninitiates by transforming the input vector $\u3121 \\in R^{S_{input}}$ into\nan S-qubit quantum state within the Hilbert space through the\napplication of a feature mapping operation $|\u03c8_x\u27e9 := U_x|0\u27e9^{\u2297S}$.\nSubsequently, this quantum state undergoes evolution via a pa-\nrameterized variational circuit, denoted as $|\u03c8_\u03b8(x)\u27e9 := G_\u03b8 |\u03c8_x\u27e9$,\nwherein the parameters $\u03b8 \u2208 \u0398$ are optimized to minimize a\nspecified loss function. The process culminates in a quantum\nmeasurement, yielding a classical bit string $z = (z_1,..., z_s)$,\nwhich is then processed through a classical function $f$ to\nproduce the final output BS-user assignment $u := f(z)$.\nThis approach can be described through a general param-\neterized quantum operation, where the quantum state $|\\Psi(\\theta)\\rangle$\nis produced by sequentially applying layers of parameterized\nquantum gates:\n$|\u03a8(\u03b8)) = U_L (\u03b8_L) ... U_1 (\u03b8_1) |\u03a8_0)$"}, {"title": "B. Variational Quantum Eigensolver Algorithm", "content": "Variational quantum eigensolver (VQE) aims to find the\nminimum eigenvalue $\u03bb_{min}$ and corresponding Hamiltonian H\nto solve the corresponding QUBO problem [15] in terms of\nparametrized quantum operations in Section IV-A.\n$\u03bb_{min} \u2264 E(\u03b8) = \u27e8\u03a8(\u03b8)|H|\u03a8(\u03b8)\u27e9$,\nThus, we can find the approximate optimal $\u03b8_*$ to approximate\n$E(\u03b8)$ to $\u03bb_{min}$ by $\u03b8_*$ = $argmin_\u03b8 E(\u03b8)$. VQE processes the wave\nfunction $|\u03c8(\u03b8)\u27e9$ in quantum machine, cost measured by energy\ncost $E(\u03b8^{(k)})$ defined in (7). Moreover, Quantum machine\nstill relies on classical optimization approach to create an\noptimized sequence of parameters{$\u03b8^{(k)}$} to minimize $E(\u03b8)$.\nVQE is an effective method for QUBO problems, where\nthe energy function in (8) consists of commuting observables.\nFor a QUBO problem with N vehicle-BS associations, the\nalgorithm uses N qubits initialized in a parameterized state\n$|\u03c8(\u03b8)\u27e9$. The system energy is estimated by measuring all qubits\nin the Pauli-z basis, producing values string {$s_i \u2208 \\{\u22121, 1\\}$} \nthat convert to a bit string $x_i$ and corresponding QUBO cost\n$E_k$ by (7). The energy expectation value is approximated\nthrough K samples in [15] as,\n$E_K(\u03b8) := \\frac{1}{K} \\sum_{k=1}^K E_k(\u03b8) \\xrightarrow{K \\rightarrow \\infty} E(\u03b8)$"}, {"title": "C. Conditional Value at Risk-Variatiational Quantum Eigensolver (CVaR-VQE)", "content": "The VQE algorithm faces a limitation in treating all samples\nwith equal weight. The inclusion of outliers can significantly\nimpair training efficiency and convergence. Denoting $P(E;\u03b8)$\nas the energy distribution associated with quantum states, we\ncan reformulate the cost function of VQE from (12) to:\n$E_K(\u03b8) \u223c E[E(\u03b8)] = \u27e8\u03a8(\u03b8)|H|\u03a8(\u03b8)\u27e9 = \\int_{-\u221e}^\u221e P(E; \u03b8) EdE$,\nAuthors in [10] proposed CVaR-VQE that modifies the cost\nfunction in (14) to address the outlier issue. This approach\nfocuses on the lowest \u03b1 bit-strings of quantum samples,\nrather than utilizing all samples, by sorting and selecting them\naccording to their energy values. Specifically, given sorted\nsampled energies {$E_1 < E_2 < \u00b7 \u00b7 \u00b7 < E_K$\\} and taking a\nproportion \u03b1 of the lowest energy outcomes, we can express:\n$CVaR_\u03b1(E(\u03b8)) \u2248 \\frac{1}{[\u03b1K]} \\sum_{k=1}^{[\u03b1]} E_k$,\nAs the number of samples increases, the CVaR-VQE estimator\n[15] converges to:\n$CVaR_\u03b1(E(\u03b8)) = E[E(\u03b8)|E < F_E^{-1}(\u03b1)] = \\frac{1}{\u03b1} \\int_{-\u221e}^{E_\u03b1(\u03b8)} P(E; \u03b8) dE$,"}, {"title": "where $F_E$ denotes the cumulative density function of E, and $E_\u03b1(\u03b8)$ satisfies:", "content": "$E_\u03b1 (\u03b8) \\int_{-\u221e}^{E_\u03b1 (\u03b8)} P(E; \u03b8) dE = \u03b1$.\nThe key insight behind this methodology is that optimizing the\nperformance of the most promising samples (those with lowest\nenergies) can be more effective than improving the overall\naverage [15]. This approach effectively concentrates the wave\nfunction's probability distribution toward the lowest-energy\nstates, potentially leading to more efficient optimization."}, {"title": "V. CASE STUDY: BS-USER ASSOCIATION IN VNET", "content": "This section begins by outlining the simulation parame-\nters and hyper-parameter configurations of the VNet and the\nproposed CVaR-VQE. Next, we provide a description of the\nbenchmark DNN algorithm under consideration. Lastly, we\npresent our primary results along with a detailed discussion\non CVaR-VQE. The DNN model was trained and evaluated in\nPython using the PyTorch framework, while the CVaR-VQE\nmodel was trained and tested in Python using IBM's Qiskit\nlibrary.\nIn our setup, AV users are assumed to be random distributed\non the 1000m single direction 4 lanes highway. The molecular\nabsorption coefficient, $k_a$, is defined as 0.05 $m^{-1}$ with a\nwater vapor concentration of 1%. This absorption coefficient\nis selected based on realistic database values, corresponding\nto a central frequency of 1.0 THz [13]. For generalization, we\nnormalize the sum rate by the transmission bandwidth. The RF\ntransmission frequency is fixed at 2.1 GHz, with a path loss\nexponent $\\rho$ of 2.5. The antenna gains for THz transmission\nand reception, $G_t^r$ and $G_r^r$, are set to 25 dB, while the RF\ntransmitter and receiver antenna gains are set to 0 dB. The\ntransmit power for all base stations is standardized at 1 W,\nand the noise power is set at -70 dBm."}, {"title": "B. DNN Benchmark", "content": "In the benchmark scheme, the DNN generates a user asso-\nciation profile with continuous values, where each association\nis represented as 0 < $U_{ij} \u2264 1, \u2200i \u2208 Z, \u2200j \u2208 J$. The\nperformance of the proposed CVaR-VQE approach is eval-\nuated by comparison with this benchmark, where problem\nP is solved to optimality. DNN benchmark consists of a\nfive-layer architecture designed specifically for the vehicle\nBS association problem. The arhitecture includes an input\nlayer accepting 16-dimensional flattened SINR matrices, 3\nhidden layers with dimensions of 64, 128, and 256 neurons\nrespectively, and a decoder layer reducing back to 64 neurons.\nThe NN employs ReLU activation functions in the hidden\nlayers, followed by a softmax operation on the output layer.\nUnless specified otherwise, the number of epochs, the batch\nsize, and the learning rate for the benchmark DNN approach\nwith 4 AVs and 4 base stations are set to 100, 128, and 0.0001,\nrespectively. The objective function is based on the summation\ndata rate, as defined in (5)."}, {"title": "C. Proposed CVaR-VQE Framework", "content": "The performance evaluation of our proposed CVaR-VQE\nframework was conducted through extensive experiments com-\nparing it against conventional DNN and optimal approaches.\nOur analysis encompasses three key dimensions: (1) number\nof qubits, (2) number of base stations (BSs), and (3) circuit\ndepth p. The experiments were conducted with different CVaR\nconfidence levels (\u03b1 \u2208 {0.25, 0.50, 1.00}).\n1) Convergence Analysis: The training is based on 4 BSs\nand 4 AVs. Fig. 4(a-c) corresponds to different variation\nquantum circuit depth p = 1,2,3, respectively. We observe\nseveral key patterns in the convergence behavior: The CVaR-\nVQE approach with \u03b1 = 1.00 demonstrates the fastest initial\nconvergence, reaching near-optimal performance within the\nfirst 20 epochs. However, it shows some instability in the later\nepochs. With \u03b1 = 0.50, we observe a more stable convergence\npattern, though it takes approximately 40-50 epochs to reach\ncomparable performance to the optimal solution. The setting of\n\u03b1 = 0.25 exhibits the most conservative convergence behavior,\nwith a slower but more stable approach toward the optimal\nvalue. Overall, our CVaR-VQE framework achieves $O(\\frac{1}{K})$\nvariance based on K samples input.\nFig. 4(a-c) indicates that results for \u03b1 = 0.25 and \u03b1 = 0.5\nare practically similar. However, taking \u03b1 = 1.00, the prob-\nability of choosing an initial ground state increases to 5%\non average, after which it drops almost to zero even though\nthe objective function continues to improve. The CVaR-VQE\napproach is primarily concerned with identifying the optimal\nperformance-energy efficiency trade-off, with a particular em-\nphasis on the lowest \u03b1 examples.\n2) Evaluation based on different number of qubits: As illus-\ntrated in Fig. 4(d), increasing the number of qubits from 2 to 6\nleads to a consistent degradation in average data rate across all\napproaches. The conventional DNN experiences the steepest\ndecline in performance. CVaR-VQE with \u03b1 = 0.25 maintains\nthe closest proximity to the optimal solution. The CVaR-VQE\napproach remains consistently high data rate across different\nqubit inputs. A greater number of qubits makes the quantum\nmachine more complex, which reduces performance.\n3) Evaluation based on different number of BSs: Fig. 4(e)\ndemonstrates the impact of increasing the number of BSs.\nPerformance degradation becomes more pronounced after 4\nBSs since producing more handover switch penalty on con-\nnecting new BS. Additionally, the gap between optimal and\nCVaR-VQE solutions widens with an increased number of\nBSs. Increasing the number of BSs also increases the chance\nof handovers, as AVs are encouraged to connect to new, vacant,\nand available BSs.\n4) Evaluation based on VQE circuit depth p: In this case,\nwe add multiple layers of Convolutional Neural Networks in\nthe DNN benchmark. The effect of varying depth parameters\n(Fig. 4(f)) reveals that optimal performance is achieved at\np = 1. Performance degradation is observed if p > 2,\nas excessive layers in variational quantum circuits impair\ntraining performance by increasing quantum entanglement and\ninteraction among qubits."}, {"title": "VI. CONCLUSION", "content": "Quantum computing holds transformative potential for next\ngeneration wireless networks. This study proposed a CVaR-\nVQE framework tailored to address user association challenges\nwithin vehicular networks. By leveraging a hybrid quantum-\nclassical approach, our solution delivers a substantial perfor-\nmance improvement, surpassing conventional DNN methods\nby 23.5%. This demonstrates the unique capacity of CVaR-\nenhanced VQE to handle the dynamic nature of vehicular\nnetworks and optimize BS-User assignment under uncertainty.\nFuture research could extend this framework to more varied\nvehicular network scenarios, integrating additional parameters\nlike network load balancing and user mobility dynamics."}]}