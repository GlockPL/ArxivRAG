{"title": "Anchor-Controlled Generative Adversarial Network for High-Fidelity Electromagnetic and Structurally Diverse Metasurface Design", "authors": ["Yunhui Zeng", "Hongkun Cao", "Xin Jin"], "abstract": "In optoelectronics, designing free-form metasurfaces presents significant challenges, particularly in achieving high electromagnetic response fidelity due to the complex relationship between physical structures and electromagnetic behaviors. A key difficulty arises from the one-to-many mapping dilemma, where multiple distinct physical structures can yield similar electromagnetic responses, complicating the design process. This paper introduces a novel generative framework, the Anchor-controlled Generative Adversarial Network (AcGAN), which prioritizes electromagnetic fidelity while effectively navigating the one-to-many challenge to create structurally diverse metasurfaces. Unlike existing methods that mainly replicate physical appearances, AcGAN excels in generating a variety of structures that, despite their differences in physical attributes, exhibit similar electromagnetic responses, thereby accommodating fabrication constraints and tolerances. We introduce the Spectral Overlap Coefficient (SOC) as a precise metric to measure the spectral fidelity between generated designs and their targets. Additionally, a cluster-guided controller refines input processing, ensuring multi-level spectral integration and enhancing electromagnetic fidelity. The integration of AnchorNet into our loss function facilitates a nuanced assessment of electromagnetic qualities, supported by a dynamic loss weighting strategy that optimizes spectral alignment. Collectively, these innovations represent a transformative stride in metasurface inverse design, advancing electromagnetic response-oriented engineering and overcoming the complexities of the one-to-many mapping dilemma. Empirical evidence underscores AcGAN's effectiveness in streamlining the design process, achieving superior electromagnetic precision, and fostering a broad spectrum of design possibilities.", "sections": [{"title": "INTRODUCTION", "content": "Metasurfaces constructed of two-dimensional artificial material structures at subwavelength scales have garnered significant attention for their unparalleled ability to manipulate intrinsic properties of light, including spectrum 1,2, amplitude3,4, phase5,6, polarization78, wavefront9,10, and so on. The core innovation in the development of metasurfaces lies in the spatial and material configuration of meta-atoms, which offer vast degrees of freedom for designing spatial inhomogeneities across optically thin surfaces. This unique arrangement and material property of meta-atoms enables the achievement of functionalities far beyond the capabilities of natural materials, providing a transformative platform for diverse optoelectronic applications. Recent advancements in metasurface design have led to the realization of novel functionalities such as light field imaging\u00b9\u00b9, holographic display12, perfect absorption13, vortex beam generation14, and optical encryption15, showcasing the potential of metasurfaces to revolutionize optical technologies.\nEven though modern numerical methods allow for the accurate calculation of the electromagnetic (EM) response of complex structures and diverse materials, the design of metasurfaces is still a challenging task owing to the nonintuitive and nonunique relationship between physical structures, material properties, and their EM responses16. At present, the design process of metasurface mostly relies on physics-inspired methods, resorting to human knowledge such as physical insights revealed by simplified analytical modeling, similar experience transferred from previous practice, and intuition obtained by scientific reasoning. For instance, techniques such as resonant phase control17, propagation phase control18, and geometric phase control19, whether used independently or collectively20,21, are pivotal for precise phase response tailoring.\nHowever, this reliance not only restricts the design space, limiting innovation by confining explorations to conventional meta-atom configurations but also highlights a parallel shortcoming: the fundamental theory underpinning metasurfaces is not well-established22. As design complexity increases, the traditional expert-knowledge-based paradigm becomes less effective, even though it offers inherent flexibility23. The prevalent method of creating libraries of meta-atoms through trial-and-error, combined with extensive scanning, faces significant constraints due to its inherently limited optimization space and the time-consuming process of solving Maxwell's equations, which greatly hampers both efficiency and scalability24. Advanced methods such as topology optimization extend the design parameter space and enhances computational flexibility for metasurface applications25. However, these methods heavily rely on gradient descent techniques for iterative improvements, which are critically dependent on accurate initial guesses of metasurface parameters. Meta-heuristic algorithms such as genetic algorithms26, ant colony optimization27 and particle swarm optimization algorithms28, due to their inherent randomness, face limitations in scalability and precision as the complexity and size of the problems increase.\nBoth topology optimization and meta-heuristic algorithms employ numerical methods like finite-difference-time-domain (FDTD), rigorous coupled-wave analysis (RCWA), or finite element method (FEM) for iteratively solving Maxwell's equations, leading to substantial computational demand. Moreover, these methods often converge to local optima, which limits their effectiveness in free-form metasurface design and underscores the need for more advanced design techniques.\nWith the rise of artificial intelligence (AI), deep learning (DL), a subset of machine learning, has revolutionized metasurface design by enabling sophisticated pattern recognition and computational optimization. DL models effectively map the complex relationships between metasurface parameters and EM properties. These models streamline the design process by directly generating metasurface parameters, reducing reliance on time-consuming simulations and accelerating the development of advanced structures. DL-driven metasurface design can be categorized into forward and inverse design strategies29. Forward design predicts the EM behavior of metasurfaces from predetermined parameters, a direct computational task where the output is unequivocally determined by the input design. Inverse design, conversely, aims to deduce the requisite metasurface configuration to achieve the desired EM function, presenting a more complex challenge due to the potentially one-to-many dilemma inherent in the solution space. Inverse design holds distinct advantages, particularly in its ability to navigate vast design spaces to identify novel configurations that meet specific EM responses. Within the domain of inverse design, methodologies can be bifurcated into supervised and unsupervised learning approaches. Supervised learning involves training models on labeled datasets, where the ground truth output is provided for each input, allowing the model to learn the mapping from input to output. In contrast, unsupervised learning algorithms uncover hidden patterns or intrinsic structures within the data without the guidance of labeled outcomes, often identifying unforeseen correlations and clusters within the design parameters. Supervised learning employs Deep Neural Networks (DNNs)30,31 and Convolutional Neural Networks (CNNs)32,33, harnessing their capacity for pattern recognition and feature extraction to approximate the mapping from EM specifications to structural designs. DNNs are particularly useful for their layered architecture that abstracts data at various levels, facilitating a deeper understanding of EM behaviors, while CNNs are chosen for their proficiency in handling grid-like data, such as images of metasurface patterns. Unsupervised learning, predominantly through generative methods such as Variational Autoencoders (VAEs)34,35 and Generative Adversarial Networks (GANs) 29,30, offers a different paradigm. VAEs and GANs excel in synthesizing new designs by learning the distribution of existing data without explicit labels, enabling the exploration of unconventional and uncharted design territories. VAEs are renowned for their ability to encode data into a compressed latent space and then decode it to generate new instances, preserving the statistical properties of the original data, which is vital for modeling metasurface designs that are not explicitly labeled. GANs generate new data from learned distributions via a competitive process between the generator and discriminator, yet they often generate outputs that only statistically resemble training data without precise control. Conditional Generative Adversarial Networks (CGANs)38 address this by conditioning the generator on specific labels, enabling the creation of designs that meet predefined EM characteristics. These generative models have proven particularly adept at tackling the metasurface inverse design problem, generating feasible designs by effectively navigating the complex landscape of metasurface parameters and their corresponding EM responses39.\nDespite the significant progress in DL-based metasurface design, DL models have several critical challenges to address. i) One-to-Many Dilemma: While conventional CGANs incorporate spectral data as conditional inputs to guide the generation process, they often overlook the intricate relationships between EM characteristics and structural configurations. This oversight fails to address the one-to-many dilemma of metasurface design, where multiple structures can yield similar EM responses. ii) Limited EM fidelity: Current methods heavily rely on image-based DL models that excel in replicating the visual attributes of training datasets. However, these models frequently fall short of ensuring the EM response fidelity of the generated metasurface structures. The gap between visual resemblance and actual functional performance highlights a critical need for methodologies that extend beyond mere aesthetic replication to meet practical EM requirements. Moreover, a recurring limitation of these models is their tendency to produce structures that are statistically similar to the training data, but not necessarily functionally accurate, further highlighting the need for advanced approaches that prioritize functional performance over visual similarity."}, {"title": "METHODS", "content": "In this study, we concentrate on the intricate task of designing metasurface filters for spectral response control, as illustrated in Figure 1. By encoding key metasurface parameters such as refractive indices, plasma frequencies, layer thicknesses, resonator geometries, and metasurface classes into the discrete \u201cRGB\u201d channels of color images, we capture a broad design space for metasurface engineering. This encoding strategy poses a challenging inverse design problem that necessitates a nuanced consideration of both material and structural parameters. We validate the effectiveness of our proposed Anchor-controlled Generative Adversarial Network (AcGAN) algorithm in this demanding context, demonstrating its ability to generate metasurface designs that precisely align with spectral response requirements. AcGAN's performance is assessed through the Spectral Overlap Coefficient (SOC), a metric we introduced to evaluate spectral response alignment with higher precision than the existing methods. This improvement in spectral similarity assessment is pivotal for functional metasurface applications. Furthermore, the integration of AnchorNet, a forward-predictive model within the generative framework, ensures that the generated designs meet strict EM specifications, surpassing traditional visual-based generative methods. The dynamic loss weighting strategy employed in our model further refines the learning process by shifting the focus from structural resemblance to spectral fidelity, thereby significantly enhancing EM response fidelity. Collectively, these advancements represent a significant leap forward in metasurface design, effectively bridging the gap between visual and EM performance. Our approach not only enhances the precision, versatility, and efficiency of metasurface designs but also holds promise for broader applications in EM response designs beyond spectral control, marking a transformative advancement in the field of metasurface design.\nIn our inverse design framework, two types of metasurfaces are scrutinized, each tailored for specific photonic functionalities. The first category comprises metal-insulator-metal (MIM) constructs characterized by broad Lorentzian absorption spectra arising from plasmonic resonances at the metal-dielectric interface40. These spectra are pivotal for applications demanding robust thermal emissivity and efficient photothermal energy conversion. The second category explores hybrid dielectric metasurfaces, wherein sub-wavelength cavity resonances yield Fano-resonant profiles, offering sharply defined spectral features optimal for discerning optical sensor technologies41. This bifurcation presents a complex challenge, necessitating a modeling approach capable of accommodating the significant spectral divergences inherent to each metasurface type.\nIn the realm of metasurface design, we seek to navigate a design space $M \\in \\mathbb{R}^d$ to engineer parameters that produce a metasurface whose spectral response in space $S \\in \\mathbb{R}^m$ closely aligns with a specified target spectrum. Employing EM simulation tools such as Lumerical FDTD for forward mapping $F:M \\rightarrow S$, we obtain reliable predictions of spectral responses for given metasurface configurations. The crux of the inverse design problem is to determine an optimal set of design parameters $m^*$ that minimizes the discrepancy between the generated spectrum $S_g$ and the desired target spectrum $S_t$, represented by the optimization problem:\n$m^* = \\underset{M \\in M}{\\operatorname{argmin}} Loss(S_t, S_g)$,\nwhere s = F(m), and Loss quantifies the distance between s* and s. In existing works, the Mean Squared Error (MSE), which is defined as $MSE (S_t, S_g) = \\frac{1}{n} \\sum_{i=1}^{n} (s_{t_i} - s_{g_i})^2$, and Mean Absolute Error (MAE), which is defined as $MAE (S_t, S_g) = \\frac{1}{n} \\sum_{i=1}^{n} |s_{t_i} - s_{g_i}|$, are the prevalent metrics for the distance function D. These two metrics are widely adopted in DL-based metasurface design due to their straightforward computational properties and robust performance across various applications, as detailed in the Section S1 (Supporting Information). However, these two metrics may fall short in capturing nuances of metasurface spectral features, such as resonance peaks or specific absorption bands, which are critical yet may constitute only a fraction of the overall spectrum. This limitation often results in deceptively favorable evaluations when those minute but crucial details are overlooked. To address this, we advocate for novel metrics tailored to nanophotonic design intricacies, which can accommodate expert knowledge of spectral properties for more mathematically sound model training. In this paper, we introduce a novel spectral similarity metric named Spectral Overlap Coefficient (SOC), defined as follows:\n$SOC = 1 - \\frac{\\sum min(s_t, s_g)}{\\sum max(s_t, s_g)}$\nThis formula quantitatively measures the extent of spectral overlap, providing a direct assessment of similarity. A SOC value nearing zero signifies high similarity, which offers a direct and adaptable measure for spectral congruence, making it invaluable for evaluating and optimizing metasurface designs across diverse spectroscopic applications.\nUpon establishing the design objectives for metasurface applications, the initial step utilizing DL techniques for metasurface design involves encoding design parameters and targeted EM responses into the input and output format compatible with DL models. Referring to Yeung's work37 on encoding method and dataset, we encode MIM metasurfaces and hybrid dielectric metasurfaces into 3 \u00d7 64 \u00d7 64 pixel RGB images, where each pixel represents 50 nm \u00d7 50 nm (MIM)and 120 nm \u00d7 120 nm (hybrid) units cells respectively. For MIM structures, the red channel encodes the plasma frequency wp of metal resonators, the blue channel denotes the dielectric layer's thickness (d) in nanometers, and the green channel is unused and set to zero. Conversely, for hybrid dielectric structures, the green channel represents the real refractive index (n) of dielectric resonators, the blue channel continues to denote layer thickness (d) and the red channel is unused and set to zero. This encoding approach standardizes the representation of diverse metasurface types into a unified RGB format, streamlining the application of DL for optimizing and assessing metasurface optical properties. Additionally, the spectral range from 4-12 \u00b5m is discretized into 800 discrete points, defining the spectral response s. This discretization aids in the systematic representation of EM responses within our optimization framework, ensuring that the set of design parameters M is efficiently processed in the image-based DL format. The detailed encoding and decoding processes are provided in the Section S2 (Supporting Information).\nintelligent hub of the framework, orchestrating spectral data flow and preprocessing through an advanced clustering strategy. Within our controller framework, spectral data segmentation is a critical pre-processing step to ensure precise spectral response prediction. We apply the K-means clustering algorithm42 to the training spectral dataset S = {S1, S2, ..., Sn} where each s\u012f represents a unique spectral data point in Rm. The algorithm partitions S into k distinct clusters, optimizing the following objective:\n$min \\sum_{i=1}^{k} \\sum_{s \\in C_i} ||s - c_i||^2$\nwhere C = {C1, C2, ..., Ck} represents the set of clusters, and c\u012f is the centroid or cluster center of Ci, embodying the average spectral profile of the cluster. These centroids are then used as reference points to compute the SOC for given spectral input, resulting in ak-dimensional vector v = [SOC(s, C\u2081), SOC(s, c\u2082), ..., SOC(s, ck)]. This vector quantitatively describes the input's alignment with pre-identified spectral categories, enriching the input representation with both detailed and contextual spectral information. The resultant vector v is then concatenated with the original spectral data s to form a comprehensive control vector u = [s; v]. This vector, which integrates both granular and aggregated spectral data, is fed into the generator and discriminator, ensuring that the generated designs are both contextually aware and intricately aligned with the desired spectral responses. By strategically manipulating spectral data through this dual-layered approach, the controller enhances the generative model's ability to navigate complex design spaces, guiding it toward regions that promise optimal alignment with specified spectrum. This approach prevents the model from misinterpreting small spectral variations as larger discrepancies, which is crucial for designing metasurfaces for precise spectral alignment.\nAnchorNet, a pivotal component of our AcGAN architecture as depicted in Figure 3(c), incorporates a tailored BottleNeckResNet43 architecture designed to predict the spectral responses of metasurface designs precisely. This module is finely tuned to minimize $SOC(\\hat{S}, s)$, where \u015d is the spectrum predicted by the AnchorNet, and s is the ground truth spectrum obtained from EM simulations. An early stopping mechanism is integrated into the training protocol to halt the learning process after a predetermined number of epochs without improvement in training loss, ensuring computational efficiency and preventing overfitting. This approach not only optimizes model performance but also enhances its generalizability across different metasurface designs. Integral to the AcGAN architecture, AnchorNet revolutionizes metasurface design evaluation by providing rapid spectral response prediction capabilities. Specifically tailored to assess the EM performance of structures generated by AcGAN, it transcends the conventional visual assessment criteria used in CGANs. AnchorNet focuses is dedicated to aligning EM responses, enabling the design of metasurfaces optimized for specific EM functionalities, independent of visual similarity to referenced designs.\nIn our methodology, the generator receives a control vector u and a latent vector z as inputs, as depicted in Figure 3(a). The latent vector, drawn from a uniform distribution, introduces variability, enabling the generator to explore a wide design space and facilitate the one-to-many mapping essential for custom metasurface designs. The generator uses a series of deconvolutional layers to transform spectral data and clustering labels into spatial patterns, capturing the intricate EM properties required for specific applications. This process, augmented by a noise vector to introduce randomness, encourages the exploration of novel and diverse metasurface designs. Up-sampling techniques are employed to incrementally refine the spatial resolution, ensuring the preservation of essential spectral features. The generator's effectiveness is quantified by a loss function LG, comprising three pivotal components:\n$L_G = \\gamma L_{adv} + \\alpha L_{spectral} + \\beta L_{structural}$\nwhere $L_{adv} = -\\mathbb{E}_{z\\sim p_z(z), u\\sim p_y(u)}[log D(G(z,u),u)]$ assesses how well the generator can fool the discriminator, which evaluates the authenticity of the generated metasurfaces. $L_{spectral} = SOC (S_g, S_t)$ measures the spectral similarity, ensuring the generated metasurface aligns with the target spectrum in terms of spectral\u00b7 response. The structural loss $L_{structural}$ is calculated using the Structural Similarity Index (SSIM) between the generated and referenced samples: $L_{structural} = SSIM(M_g, M_r)$. This metric evaluates the structural integrity of the metasurface by comparing the generated metasurface with referenced samples. Parameters a and \u1e9e balance the spectral and structural components within the loss function, which is crucial for tailoring the designs to meet specific operational requirements. This comprehensive approach not only ensures that the generated designs are indistinguishable from referenced samples by the discriminator but also that they meet stringent application-specific EM specifications.\nThe discriminator evaluates the EM fidelity of the metasurface designs proposed by the generator, as depicted in Figure 3(b). It employs a cascading array of convolutional layers to meticulously analyze the generated structures, ensuring they meet the spectral responses required by the design objectives. This module assesses the quality of the synthesized designs using both learned features and heuristics from the training phase. It acts as the critical feedback component, interfacing directly with AnchorNet's output to assess spectral congruence, thus guiding the generative process toward the production of metasurfaces with enhanced practical applicability. The discriminator's functionality is meticulously evaluated through a composite loss function $L_D$:\n$L_D = \\gamma(L_{adv} + L_{mismatch}) + \\alpha L_{spectral}$\nwhere\n$L_{adv} = \\mathbb{E}_{(M_r,S_t)\\sim P_{data}(M_r,S_t)}[log D(M_r, S_t)] - \\mathbb{E}_{z\\sim p_z(z),u\\sim p_y(u)} [log (1 - D(G(z,u)))]$\nrepresents the adversarial loss, combining the logs of the probabilities assigned by the discriminator to referenced and generated metasurfaces, thus enhancing its capability to differentiate between the two. The mismatch loss, $L_{mismatch}$, enhances the discriminator's ability to detect inconsistencies between the referenced and generated metasurface, which is computed as:\n$L_{mismatch} = -\\mathbb{E}_{z\\sim p_z(z),u'\\sim p_u(u')} [log(1 - D(G(z, u'),u))]$\nIn this formulation, u' represents a control vector that mismatches the intended input conditions for z, compelling the discriminator to reject generated metasurfaces that do not align with the required specifications.\nOur AcGAN framework integrates the controller, generator, discriminator, and AnchorNet to design metasurfaces with high electromagnetic fidelity and structural diversity. The process starts with the pre-trained AnchorNet predicting spectral properties, laying the groundwork for adversarial training. Initially, the discriminator is fine-tuned using precomputed control vectors that replace raw spectral data with structured inputs, streamlining the evaluation process. These inputs allow the discriminator to accurately assess the authenticity and spectral fidelity of the designs, ensuring they align with predefined criteria. Once the discriminator effectively distinguishes between real and generated designs, the training focus shifts to the generator. The generator is trained using a composite adversarial loss function, enhancing its ability to create realistic and structurally diverse metasurfaces that meet specific spectral requirements. The training process is iterative: the generator and discriminator are continuously refined in alternating cycles until the generated metasurfaces are indistinguishable from real samples and precisely match the desired spectral characteristics. Detailed pseudocode for this process is provided in the Section S3 (Supporting Information). The overall loss of the AcGAN is defined as:\n$L = minmaxL(D, G) = \\gamma(L_{adv} + L_{mismatch}) + \\alpha L_{spectral} + \\beta L_{structural}$\n$\\mathbb{E}_{(M_r,S_t)\\sim P_{data}(M_r,S_t), u\\sim p_y(u)} [log D (M_r, S_t, u)] +`$\\newline$= \\gamma -\\mathbb{E}_{z\\sim p_z(z),u\\sim p_y(u)} [log(1 - D(G(z, u), u))] \u2013$\\newline$\\mathbb{E}_{z\\sim p_z(z),u'\\sim p_u(u')} [log(1 - D(G(z, u'),u))]$\\newline$+ \\alpha SOC(s_g, S_t) + \\beta SSIM(M_g, M_r)$\nThis formulation ensures that each generated design meets stringent spectral criteria while achieving structural diversity, validated through comprehensive numerical simulations and material property analyses. AcGAN generates key parameters such as wp, d and n, facilitating the exploration of new materials and structures beyond traditional limitations, ultimately enhancing the efficiency and customization of metasurface designs."}, {"title": "RESULTS AND DISCUSSION", "content": "training, and the remaining 10% served as the test set; the detailed hyperparameter setting of AnchorNet is shown in the Section S4 (Supporting Information). As illustrated in Figure 4(a), SOC losses decreased progressively over 342 epochs, with training ceasing upon reaching an early stopping threshold of 30 consecutive epochs without validation loss improvement. The training consumed 136 minutes, with final SOC losses for training and testing converging to 0.0405 and 0.0807, respectively. After training, AnchorNet could predict the spectrum of metasurface in an average time of 3.6 \u00d7 10\u22124 seconds per sample, reducing computation time to approximately 1/1,600,000th of the 560.48 seconds required by comparable FDTD simulations. This dramatic reduction in computational demand significantly accelerates the evaluation process for metasurface inverse design, enabling faster iterations and enhancements.\nThe assessment of AnchorNet across the dataset revealed differences between the hybrid and MIM categories, as detailed in Figure 4 (b) to 4(i). The SOC distribution in Figure 4 (b) and 4(c) indicates that hybrid structures predominantly appear in lower SOC intervals, suggesting AnchorNet more accurately predicts their complex spectral features. Figure 4 (d) to 4(i) explicitly demonstrate AnchorNet's spectral prediction capabilities by presenting instances with the minimum, mean (close to the average SOC), and maximum SOC metrics. Specifically, Figure 4 (d) to 4(f) for hybrid structures and Figure 4 (g) to 4(i) for MIM structures illustrate the accuracy of spectral predictions through comparative plots that juxtapose predicted spectra with ground truth spectra. The improved accuracy for MIM structures is due to their simpler Lorentzian profiles, which are smoother and more predictable than the complex, asymmetric Fano resonances of hybrid structures. These Fano resonances, with sharp variations from quantum interference, present significant predictive challenges. Additionally, the spectral comparison in Figure 4 (e) and 4(h) highlights a key discrepancy: despite a higher MSE in Figure 4 (h), the spectral alignment closely matches the ground truth, particularly around peak regions. In contrast, Figure 4 (e) shows significant deviations at peak intensities and across broader spectral regions, highlighting MSE's limitations as a reliable metric. SOC, by providing a more accurate measure of spectral similarity, proves superior to MSE in evaluating spectral fidelity. Inspird by Metric Learning44, we evaluated MSE and SOC for spectral data dimensionality reduction. As detailed in Section S5 (Supporting Information), our analysis using Principal Component Analysis (PCA), Locally Linear Embedding (LLE), t-Distributed Stochastic Neighbor Embedding (t-SNE), and Autoencoders (AE) revealed MSE's limitations in distinguishing classes. In contrast, SOC significantly improved class separability, as shown in Figure S3, demonstrating its effectiveness in preserving intrinsic spectral properties crucial for advanced optical applications.\nDetailed hyperparameter settings and analysis for AcGAN are provided in the Section S6 (Supporting Information). The hyperparameter settings for comparative methods were adopted from their original papers, and all methods were tested on the same dataset. The results are based on a random selection of 100 spectral data points from the test set. For each data point, corresponding metasurface structures were generated and then simulated using Lumerical FDTD to obtain what can be considered the ground truth spectrum of the designed structures. Significantly, to explore the variability in design accuracy, 256 different latent vectors were generated for each target spectrum using AcGAN. Thanks to CUDA's parallel computing capabilities, generating 256 metasurfaces takes nearly the same time as generating a single one. The design with the lowest SOC relative to the target spectrum is selected as the final design. This meticulous verification process ensures the precision of our approach. Traditional physics-inspired methods, in contrast, demonstrate significant inefficiencies as they often require days to months to design a single metasurface and do not support one-time training. Heuristic algorithms like GA, PSO, and DE, though faster, achieve only moderate SOC and MSE, indicating less optimal spectral matching. Machine learning techniques, such as DNN, VAE, and CGAN, drastically cut prediction latencies to milliseconds and enhance both SOC and MSE, signifying substantial advancements in computational efficiency and spectral fidelity. Among these, AcGAN stands out by achieving a generation time of only 4.2 * 10\u20134 seconds, markedly faster than other methods, and attaining the lowest MSE (1.120 * 10\u22123) and SOC (0.139), thus demonstrating unparalleled precision and efficiency. Furthermore, the one-time training capability of machine learning methods offers substantial benefits over more iterative and resource-intensive traditional and heuristic approaches.\nFigure S4 in Section S7 (Supporting Information) presents 9 cases from the test dataset, selecting the design with the lowest SOC relative to the target spectrum. The spectra from FDTD simulations of metasurfaces designed by AcGAN closely align with the target spectra, demonstrating AcGAN's efficiency and accuracy in generating metasurfaces tailored to specific spectral requirements. The comparison between spectra from referenced metasurface structures and the predicted target spectra by AnchorNet highlights AnchorNet's strong predictive capability. Notably, AcGAN accurately designed metal-insulator-metal (MIM) structures for Lorentzian spectra and hybrid structures for Fano spectra without confusion during training. This indicates AcGAN's effectiveness in differentiating between distinct metasurface types and their corresponding absorption spectra, showcasing its proficiency not only in design accuracy but also in understanding and applying different physical mechanisms.\ndesigns beyond traditional visual constraints. In particular, Figure 5 (b) highlights that design1's thickness is reduced by 26.7% compared to the referenced metasurface, simplifying the manufacturing process. Despite these variations, the average SSIM between the generated and referenced metasurfaces is 0.727, indicating substantial structural differences while maintaining functional integrity, as shown in Figure 5 (b) and (c).\nTo further assess the innovative design diversity of AcGAN, near-field electric distribution was evaluated, with detailed outcomes available in the Section S8 (Supporting Information). The results confirm that AcGAN not only achieves the desired spectral response but also introduces enhanced flexibility in metasurface design. This adaptability is particularly beneficial in applications like biomedical imaging systems, where it is crucial to maintain high absorption at specific wavelengths, such as the infrared spectrum, for improved image contrast. This multifunctionality allows a single imaging system to perform both standard and polarimetric imaging, enhancing cellular or tissue structure visualization for more precise medical diagnostics. This dual capability significantly extends the utility and operational range of imaging systems, promoting efficiency and broadening the scope of potential applications without the need for interchangeable optical components."}, {"title": "CONCLUSION", "content": "The AcGAN has fundamentally advanced the inverse design of metasurfaces by achieving high electromagnetic fidelity and structural diversity. AcGAN consistently delivers precise spectral alignment, evidenced by a mean MSE of 1.120 * 10\u22123 and a SOC of 0.139. Unlike traditional physics-inspired models that require extensive computational time, often extending from days to months for single predictions, and stochastic optimization techniques like GA, PSO, and DE that offer quicker predictions but lack the consistency and ease of use provided by deep learning approaches, AcGAN excels by facilitating rapid, effective design iterations post a singular, comprehensive training period. Looking ahead, future enhancements to AcGAN will focus on several critical areas: 1. Optimizing AnchorNet: Enhancing its predictive accuracy, particularly for hybrid structures with complex Fano resonance profiles, which currently present significant challenges. 2. Enhancing encoding techniques: Expanding the range of design variables to include more intricate and functional metasurface configurations, thereby broadening the scope of metasurface applications. 3. Expanding dataset diversity: Incorporating a broader array of metasurface structures, especially free-form designs, to improve the model's generalization capabilities and robustness. AcGAN represents not only a methodological breakthrough but also a scalable and robust framework that significantly accelerates the design process in nanophotonic applications. This makes AcGAN a pivotal tool for advancing operational metasurfaces, meeting the evolving demands of optoelectronics and related industries."}]}