{"title": "Anchor-Controlled Generative Adversarial Network\nfor High-Fidelity Electromagnetic and Structurally\nDiverse Metasurface Design", "authors": ["Yunhui Zeng", "Hongkun Cao", "Xin Jin"], "abstract": "In optoelectronics, designing free-form metasurfaces presents significant\nchallenges, particularly in achieving high electromagnetic response fidelity due to the complex\nrelationship between physical structures and electromagnetic behaviors. A key difficulty arises\nfrom the one-to-many mapping dilemma, where multiple distinct physical structures can yield\nsimilar electromagnetic responses, complicating the design process. This paper introduces a novel\ngenerative framework, the Anchor-controlled Generative Adversarial Network (AcGAN), which\nprioritizes electromagnetic fidelity while effectively navigating the one-to-many challenge to\ncreate structurally diverse metasurfaces. Unlike existing methods that mainly replicate physical\nappearances, AcGAN excels in generating a variety of structures that, despite their differences in\nphysical attributes, exhibit similar electromagnetic responses, thereby accommodating fabrication\nconstraints and tolerances. We introduce the Spectral Overlap Coefficient (SOC) as a precise\nmetric to measure the spectral fidelity between generated designs and their targets. Additionally,\na cluster-guided controller refines input processing, ensuring multi-level spectral integration and\nenhancing electromagnetic fidelity. The integration of AnchorNet into our loss function facilitates\na nuanced assessment of electromagnetic qualities, supported by a dynamic loss weighting strategy\nthat optimizes spectral alignment. Collectively, these innovations represent a transformative stride\nin metasurface inverse design, advancing electromagnetic response-oriented engineering and\novercoming the complexities of the one-to-many mapping dilemma. Empirical evidence\nunderscores AcGAN's effectiveness in streamlining the design process, achieving superior\nelectromagnetic precision, and fostering a broad spectrum of design possibilities.", "sections": [{"title": "INTRODUCTION", "content": "Metasurfaces constructed of two-dimensional artificial material structures at subwavelength\nscales have garnered significant attention for their unparalleled ability to manipulate intrinsic\nproperties of light, including spectrum 1,2, amplitude3,4, phase5,6, polarization78, wavefront9,10, and\nso on. The core innovation in the development of metasurfaces lies in the spatial and material\nconfiguration of meta-atoms, which offer vast degrees of freedom for designing spatial\ninhomogeneities across optically thin surfaces. This unique arrangement and material property of\nmeta-atoms enables the achievement of functionalities far beyond the capabilities of natural\nmaterials, providing a transformative platform for diverse optoelectronic applications. Recent\nadvancements in metasurface design have led to the realization of novel functionalities such as\nlight field imaging\u00b9\u00b9, holographic display12, perfect absorption13, vortex beam generation14, and\noptical encryption15, showcasing the potential of metasurfaces to revolutionize optical\ntechnologies.\nEven though modern numerical methods allow for the accurate calculation of the\nelectromagnetic (EM) response of complex structures and diverse materials, the design of\nmetasurfaces is still a challenging task owing to the nonintuitive and nonunique relationship\nbetween physical structures, material properties, and their EM responses16. At present, the design\nprocess of metasurface mostly relies on physics-inspired methods, resorting to human knowledge\nsuch as physical insights revealed by simplified analytical modeling, similar experience transferred\nfrom previous practice, and intuition obtained by scientific reasoning. For instance, techniques\nsuch as resonant phase control17, propagation phase control18, and geometric phase control19,\nwhether used independently or collectively20,21, are pivotal for precise phase response tailoring.\nHowever, this reliance not only restricts the design space, limiting innovation by confining\nexplorations to conventional meta-atom configurations but also highlights a parallel shortcoming:\nthe fundamental theory underpinning metasurfaces is not well-established22. As design complexity\nincreases, the traditional expert-knowledge-based paradigm becomes less effective, even though\nit offers inherent flexibility23. The prevalent method of creating libraries of meta-atoms through\ntrial-and-error, combined with extensive scanning, faces significant constraints due to its\ninherently limited optimization space and the time-consuming process of solving Maxwell's\nequations, which greatly hampers both efficiency and scalability24. Advanced methods such as\ntopology optimization extend the design parameter space and enhances computational flexibility\nfor metasurface applications25. However, these methods heavily rely on gradient descent\ntechniques for iterative improvements, which are critically dependent on accurate initial guesses\nof metasurface parameters. Meta-heuristic algorithms such as genetic algorithms26, ant colony\noptimization27 and particle swarm optimization algorithms28, due to their inherent randomness,\nface limitations in scalability and precision as the complexity and size of the problems increase.\nBoth topology optimization and meta-heuristic algorithms employ numerical methods like finite-\ndifference-time-domain (FDTD), rigorous coupled-wave analysis (RCWA), or finite element\nmethod (FEM) for iteratively solving Maxwell's equations, leading to substantial computational\ndemand. Moreover, these methods often converge to local optima, which limits their effectiveness\nin free-form metasurface design and underscores the need for more advanced design techniques.\nWith the rise of artificial intelligence (AI), deep learning (DL), a subset of machine learning,\nhas revolutionized metasurface design by enabling sophisticated pattern recognition and\ncomputational optimization. DL models effectively map the complex relationships between\nmetasurface parameters and EM properties. These models streamline the design process by directly\ngenerating metasurface parameters, reducing reliance on time-consuming simulations and\naccelerating the development of advanced structures. DL-driven metasurface design can be\ncategorized into forward and inverse design strategies29. Forward design predicts the EM behavior\nof metasurfaces from predetermined parameters, a direct computational task where the output is\nunequivocally determined by the input design. Inverse design, conversely, aims to deduce the\nrequisite metasurface configuration to achieve the desired EM function, presenting a more\ncomplex challenge due to the potentially one-to-many dilemma inherent in the solution space.\nInverse design holds distinct advantages, particularly in its ability to navigate vast design spaces\nto identify novel configurations that meet specific EM responses. Within the domain of inverse\ndesign, methodologies can be bifurcated into supervised and unsupervised learning approaches.\nSupervised learning involves training models on labeled datasets, where the ground truth output is\nprovided for each input, allowing the model to learn the mapping from input to output. In contrast,\nunsupervised learning algorithms uncover hidden patterns or intrinsic structures within the data\nwithout the guidance of labeled outcomes, often identifying unforeseen correlations and clusters\nwithin the design parameters. Supervised learning employs Deep Neural Networks (DNNs)30,31\nand Convolutional Neural Networks (CNNs)32,33, harnessing their capacity for pattern recognition\nand feature extraction to approximate the mapping from EM specifications to structural designs.\nDNNs are particularly useful for their layered architecture that abstracts data at various levels,\nfacilitating a deeper understanding of EM behaviors, while CNNs are chosen for their proficiency\nin handling grid-like data, such as images of metasurface patterns. Unsupervised learning,\npredominantly through generative methods such as Variational Autoencoders (VAEs)34,35 and\nGenerative Adversarial Networks (GANs) 29,30, offers a different paradigm. VAEs and GANs excel\nin synthesizing new designs by learning the distribution of existing data without explicit labels,\nenabling the exploration of unconventional and uncharted design territories. VAEs are renowned\nfor their ability to encode data into a compressed latent space and then decode it to generate new\ninstances, preserving the statistical properties of the original data, which is vital for modeling\nmetasurface designs that are not explicitly labeled. GANs generate new data from learned\ndistributions via a competitive process between the generator and discriminator, yet they often\ngenerate outputs that only statistically resemble training data without precise control. Conditional\nGenerative Adversarial Networks (CGANs)38 address this by conditioning the generator on\nspecific labels, enabling the creation of designs that meet predefined EM characteristics. These\ngenerative models have proven particularly adept at tackling the metasurface inverse design\nproblem, generating feasible designs by effectively navigating the complex landscape of\nmetasurface parameters and their corresponding EM responses39.\nDespite the significant progress in DL-based metasurface design, DL models have several\ncritical challenges to address. i) One-to-Many Dilemma: While conventional CGANs incorporate\nspectral data as conditional inputs to guide the generation process, they often overlook the intricate\nrelationships between EM characteristics and structural configurations. This oversight fails to\naddress the one-to-many dilemma of metasurface design, where multiple structures can yield\nsimilar EM responses. ii) Limited EM fidelity: Current methods heavily rely on image-based DL\nmodels that excel in replicating the visual attributes of training datasets. However, these models\nfrequently fall short of ensuring the EM response fidelity of the generated metasurface structures.\nThe gap between visual resemblance and actual functional performance highlights a critical need\nfor methodologies that extend beyond mere aesthetic replication to meet practical EM\nrequirements. Moreover, a recurring limitation of these models is their tendency to produce\nstructures that are statistically similar to the training data, but not necessarily functionally accurate,\nfurther highlighting the need for advanced approaches that prioritize functional performance over\nvisual similarity.\nIn this study, we concentrate on the intricate task of designing metasurface filters for spectral\nresponse control, as illustrated in Figure 1. By encoding key metasurface parameters such as\nrefractive indices, plasma frequencies, layer thicknesses, resonator geometries, and metasurface\nclasses into the discrete \u201cRGB\u201d channels of color images, we capture a broad design space for\nmetasurface engineering. This encoding strategy poses a challenging inverse design problem that\nnecessitates a nuanced consideration of both material and structural parameters. We validate the\neffectiveness of our proposed Anchor-controlled Generative Adversarial Network (AcGAN)\nalgorithm in this demanding context, demonstrating its ability to generate metasurface designs that\nprecisely align with spectral response requirements. AcGAN's performance is assessed through\nthe Spectral Overlap Coefficient (SOC), a metric we introduced to evaluate spectral response\nalignment with higher precision than the existing methods. This improvement in spectral similarity\nassessment is pivotal for functional metasurface applications. Furthermore, the integration of\nAnchorNet, a forward-predictive model within the generative framework, ensures that the\ngenerated designs meet strict EM specifications, surpassing traditional visual-based generative\nmethods. The dynamic loss weighting strategy employed in our model further refines the learning\nprocess by shifting the focus from structural resemblance to spectral fidelity, thereby significantly\nenhancing EM response fidelity. Collectively, these advancements represent a significant leap\nforward in metasurface design, effectively bridging the gap between visual and EM performance.\nOur approach not only enhances the precision, versatility, and efficiency of metasurface designs\nbut also holds promise for broader applications in EM response designs beyond spectral control,\nmarking a transformative advancement in the field of metasurface design."}, {"title": "METHODS", "content": "In our inverse design framework, two types of metasurfaces are scrutinized, each tailored for\nspecific photonic functionalities. The first category comprises metal-insulator-metal (MIM)\nconstructs characterized by broad Lorentzian absorption spectra arising from plasmonic\nresonances at the metal-dielectric interface40. These spectra are pivotal for applications demanding\nrobust thermal emissivity and efficient photothermal energy conversion. The second category\nexplores hybrid dielectric metasurfaces, wherein sub-wavelength cavity resonances yield Fano-\nresonant profiles, offering sharply defined spectral features optimal for discerning optical sensor\ntechnologies41. This bifurcation presents a complex challenge, necessitating a modeling approach\ncapable of accommodating the significant spectral divergences inherent to each metasurface type.\nIn the realm of metasurface design, we seek to navigate a design space $M \\in \\mathbb{R}^{d}$ to engineer\nparameters that produce a metasurface whose spectral response in space $S \\in \\mathbb{R}^{m}$ closely aligns\nwith a specified target spectrum. Employing EM simulation tools such as Lumerical FDTD for\nforward mapping $F:M \\rightarrow S$, we obtain reliable predictions of spectral responses for given\nmetasurface configurations. The crux of the inverse design problem is to determine an optimal set\nof design parameters $m^*$ that minimizes the discrepancy between the generated spectrum $S_g$ and\nthe desired target spectrum $S_t$, represented by the optimization problem:\n$m^* = \\underset{M \\in M}{argmin} Loss(S_t, S_g)$,\nwhere s = F(m), and Loss quantifies the distance between s* and s. In existing works, the Mean\nSquared Error (MSE), which is defined as $MSE (S_t, S_g) = \\frac{1}{n} \\sum_{i=1}^{n} (s_t - s_g)^2$, and Mean Absolute\nError (MAE), which is defined as $MAE (S_t, S_g) = \\frac{1}{n} \\sum_{i=1}^{n} |S_t - S_g|$, are the prevalent metrics for\nthe distance function D. These two metrics are widely adopted in DL-based metasurface design\ndue to their straightforward computational properties and robust performance across various\napplications, as detailed in the Section S1 (Supporting Information). However, these two metrics\nmay fall short in capturing nuances of metasurface spectral features, such as resonance peaks or\nspecific absorption bands, which are critical yet may constitute only a fraction of the overall\nspectrum. This limitation often results in deceptively favorable evaluations when those minute but\ncrucial details are overlooked. To address this, we advocate for novel metrics tailored to\nnanophotonic design intricacies, which can accommodate expert knowledge of spectral properties\nfor more mathematically sound model training. In this paper, we introduce a novel spectral\nsimilarity metric named Spectral Overlap Coefficient (SOC), defined as follows:\n$SOC = 1 - \\frac{\\sum min(S_t, S_g)}{\\sum max(S_t, S_g)}$         (1)\nThis formula quantitatively measures the extent of spectral overlap, providing a direct\nassessment of similarity. A SOC value nearing zero signifies high similarity, which offers a direct\nand adaptable measure for spectral congruence, making it invaluable for evaluating and optimizing\nmetasurface designs across diverse spectroscopic applications.\nUpon establishing the design objectives for metasurface applications, the initial step utilizing\nDL techniques for metasurface design involves encoding design parameters and targeted EM\nresponses into the input and output format compatible with DL models. Referring to Yeung's\nwork37 on encoding method and dataset, we encode MIM metasurfaces and hybrid dielectric\nmetasurfaces into 3 \u00d7 64 \u00d7 64 pixel RGB images, where each pixel represents 50 nm \u00d7\n50 nm (MIM)and 120 nm \u00d7 120 nm (hybrid) units cells respectively. For MIM structures, the\nred channel encodes the plasma frequency wp of metal resonators, the blue channel denotes the\ndielectric layer's thickness (d) in nanometers, and the green channel is unused and set to zero.\nConversely, for hybrid dielectric structures, the green channel represents the real refractive index\n(n) of dielectric resonators, the blue channel continues to denote layer thickness (d) and the red\nchannel is unused and set to zero. This encoding approach standardizes the representation of\ndiverse metasurface types into a unified RGB format, streamlining the application of DL for\noptimizing and assessing metasurface optical properties. Additionally, the spectral range from 4-\n12 \u00b5m is discretized into 800 discrete points, defining the spectral response s. This discretization\naids in the systematic representation of EM responses within our optimization framework, ensuring\nthat the set of design parameters M is efficiently processed in the image-based DL format. The\ndetailed encoding and decoding processes are provided in the Section S2 (Supporting Information).\nintelligent hub of the framework, orchestrating spectral data flow and preprocessing through an\nadvanced clustering strategy. Within our controller framework, spectral data segmentation is a\ncritical pre-processing step to ensure precise spectral response prediction. We apply the K-means\nclustering algorithm42 to the training spectral dataset S = {S1, S2, ..., Sn} where each s\u012f represents\na unique spectral data point in Rm. The algorithm partitions S into k distinct clusters, optimizing\nthe following objective:\n$\\min \\sum_{i=1}^{k} \\sum_{s \\in C_i} ||s - c_i||^2$       (2)\nwhere C = {C1, C2, ..., Ck} represents the set of clusters, and c\u012f is the centroid or cluster center of\nCi, embodying the average spectral profile of the cluster. These centroids are then used as reference\npoints to compute the SOC for given spectral input, resulting in ak-dimensional vector v =\n[SOC(s, C\u2081), SOC(s, c\u2082), ..., SOC(s, ck)]. This vector quantitatively describes the input's alignment\nwith pre-identified spectral categories, enriching the input representation with both detailed and\ncontextual spectral information. The resultant vector v is then concatenated with the original\nspectral data s to form a comprehensive control vector u = [s; v]. This vector, which integrates\nboth granular and aggregated spectral data, is fed into the generator and discriminator, ensuring\nthat the generated designs are both contextually aware and intricately aligned with the desired\nspectral responses. By strategically manipulating spectral data through this dual-layered approach,\nthe controller enhances the generative model's ability to navigate complex design spaces, guiding\nit toward regions that promise optimal alignment with specified spectrum. This approach prevents\nthe model from misinterpreting small spectral variations as larger discrepancies, which is crucial\nfor designing metasurfaces for precise spectral alignment.\nAnchorNet, a pivotal component of our AcGAN architecture as depicted in Figure 3(c),\nincorporates a tailored BottleNeckResNet43 architecture designed to predict the spectral responses\nof metasurface designs precisely. This module is finely tuned to minimize SOC(\u015c, s), where \u015d is\nthe spectrum predicted by the AnchorNet, and s is the ground truth spectrum obtained from EM\nsimulations. An early stopping mechanism is integrated into the training protocol to halt the\nlearning process after a predetermined number of epochs without improvement in training loss,\nensuring computational efficiency and preventing overfitting. This approach not only optimizes\nmodel performance but also enhances its generalizability across different metasurface designs.\nIntegral to the AcGAN architecture, AnchorNet revolutionizes metasurface design evaluation by\nproviding rapid spectral response prediction capabilities. Specifically tailored to assess the EM\nperformance of structures generated by AcGAN, it transcends the conventional visual assessment\ncriteria used in CGANs. AnchorNet focuses is dedicated to aligning EM responses, enabling the\ndesign of metasurfaces optimized for specific EM functionalities, independent of visual similarity\nto referenced designs.\nIn our methodology, the generator receives a control vector u and a latent vector z as inputs, as\ndepicted in Figure 3(a). The latent vector, drawn from a uniform distribution, introduces\nvariability, enabling the generator to explore a wide design space and facilitate the one-to-many\nmapping essential for custom metasurface designs. The generator uses a series of deconvolutional\nlayers to transform spectral data and clustering labels into spatial patterns, capturing the intricate\nEM properties required for specific applications. This process, augmented by a noise vector to\nintroduce randomness, encourages the exploration of novel and diverse metasurface designs. Up-\nsampling techniques are employed to incrementally refine the spatial resolution, ensuring the\npreservation of essential spectral features. The generator's effectiveness is quantified by a loss\nfunction LG, comprising three pivotal components:\n$LG = \\gamma L_{adv} + \\alpha L_{spectral} + \\beta L_{structural}$                                       (3)\nwhere $L_{adv} = -E_{z\\sim pz(z),u\\sim py(u)}[log D(G(z,u),u)]$ assesses how well the generator can fool the\ndiscriminator, which evaluates the authenticity of the generated metasurfaces. $L_{spectral} =$\nSOC (Sg, St) measures the spectral similarity, ensuring the generated metasurface aligns with the\ntarget spectrum in terms of spectral\u00b7 response. The structural loss $L_{structural}$ is calculated using the\nStructural Similarity Index (SSIM) between the generated and referenced samples: $L_{structural} =$\nSSIM(Mg, Mr). This metric evaluates the structural integrity of the metasurface by comparing the\ngenerated metasurface with referenced samples. Parameters a and \u1e9e balance the spectral and\nstructural components within the loss function, which is crucial for tailoring the designs to meet\nspecific operational requirements. This comprehensive approach not only ensures that the\ngenerated designs are indistinguishable from referenced samples by the discriminator but also that\nthey meet stringent application-specific EM specifications.\nThe discriminator evaluates the EM fidelity of the metasurface designs proposed by the\ngenerator, as depicted in Figure 3(b). It employs a cascading array of convolutional layers to\nmeticulously analyze the generated structures, ensuring they meet the spectral responses required\nby the design objectives. This module assesses the quality of the synthesized designs using both\nlearned features and heuristics from the training phase. It acts as the critical feedback component,\ninterfacing directly with AnchorNet's output to assess spectral congruence, thus guiding the\ngenerative process toward the production of metasurfaces with enhanced practical applicability.\nThe discriminator's functionality is meticulously evaluated through a composite loss function L\u0189:\n$LD = \\gamma (L_{adv} + L_{mismatch}) + \\alpha L_{spectral}$                                             (4)\nwhere   $L_{adv} = E_{(Mr,St)\\sim Pdata(Mr,St)} [log D(Mr, St)] - E_{z\\sim pz(z),u\\sim py(u)} [log (1 \u2013 D(G(z,u)))]$\nrepresents the adversarial loss, combining the logs of the probabilities assigned by the\ndiscriminator to referenced and generated metasurfaces, thus enhancing its capability to\ndifferentiate between the two. The mismatch loss, $L_{mismatch}$, enhances the discriminator's ability to\ndetect inconsistencies between the referenced and generated metasurface, which is computed as:\n$L_{mismatch} = -E_{z\\sim pz(z),u'\\sim pu(u')} [log(1 \u2013 D(G(z, u'),u))]$\nIn this formulation, u' represents a control vector that mismatches the intended input conditions\nfor z, compelling the discriminator to reject generated metasurfaces that do not align with the\nrequired specifications.\nOur AcGAN framework integrates the controller, generator, discriminator, and AnchorNet to\ndesign metasurfaces with high electromagnetic fidelity and structural diversity. The process starts\nwith the pre-trained AnchorNet predicting spectral properties, laying the groundwork for\nadversarial training. Initially, the discriminator is fine-tuned using precomputed control vectors\nthat replace raw spectral data with structured inputs, streamlining the evaluation process. These\ninputs allow the discriminator to accurately assess the authenticity and spectral fidelity of the\ndesigns, ensuring they align with predefined criteria. Once the discriminator effectively\ndistinguishes between real and generated designs, the training focus shifts to the generator. The\ngenerator is trained using a composite adversarial loss function, enhancing its ability to create\nrealistic and structurally diverse metasurfaces that meet specific spectral requirements. The\ntraining process is iterative: the generator and discriminator are continuously refined in alternating\ncycles until the generated metasurfaces are indistinguishable from real samples and precisely\nmatch the desired spectral characteristics. Detailed pseudocode for this process is provided in the\nSection S3 (Supporting Information). The overall loss of the AcGAN is defined as:\n$\\underset{G}{D} L = \\min \\underset{G}{max}L(D, G) = \\gamma (L_{adv} + L_{mismatch}) + \\alpha L_{spectral} + \\beta L_{structural}$                                                                                    \n$\n= \\underset{G}{D} E_{(Mr.St)\\sim Pdata(Mr,St), u\\sim py(u)} [log D (Mr, St, u)] +\\` \\\\ \n\\gamma E_{zpz(z),upy(u)} [log(1 \u2013 D(G(z, u), u))] \u2013 \nE_{zpz(z),upu(u')} [log(1 \u2013 D(G(z, u'),u))]  \\\\\n+\\alpha SOC(sg, St) + \\beta SSIM(Mg, M_\\dagger) \n$\nThis formulation ensures that each generated design meets stringent spectral criteria while\nachieving structural diversity, validated through comprehensive numerical simulations and\nmaterial property analyses. AcGAN generates key parameters such as wp, d and n, facilitating the\nexploration of new materials and structures beyond traditional limitations, ultimately enhancing\nthe efficiency and customization of metasurface designs."}, {"title": "RESULTS AND DISCUSSION", "content": "AcGAN demonstrates a notable capacity to design metasurfaces that closely match target\nspectra while significantly diverging in structural dimensions, material properties, and dielectric\nthickness, as shown in Figure S4 and Figure 5. Analysis of the three metasurfaces with the lowest\nSOC reveals that, although their absorption spectra closely match the target, their physical\nconfigurations vary significantly. For instance, material properties deviate by an average of 12.9%,\nand dielectric thicknesses vary by 20.0%, highlighting the model's ability to achieve diverse\ndesigns beyond traditional visual constraints. In particular, Figure 5 (b) highlights that design1's\nthickness is reduced by 26.7% compared to the referenced metasurface, simplifying the\nmanufacturing process. Despite these variations, the average SSIM between the generated and\nreferenced metasurfaces is 0.727, indicating substantial structural differences while maintaining\nfunctional integrity, as shown in Figure 5 (b) and (c).\nTo further assess the innovative design diversity of AcGAN, near-field electric distribution was\nevaluated, with detailed outcomes available in the Section S8 (Supporting Information). The\nresults confirm that AcGAN not only achieves the desired spectral response but also introduces\nenhanced flexibility in metasurface design. This adaptability is particularly beneficial in\napplications like biomedical imaging systems, where it is crucial to maintain high absorption at\nspecific wavelengths, such as the infrared spectrum, for improved image contrast. This\nmultifunctionality allows a single imaging system to perform both standard and polarimetric\nimaging, enhancing cellular or tissue structure visualization for more precise medical diagnostics.\nThis dual capability significantly extends the utility and operational range of imaging systems,\npromoting efficiency and broadening the scope of potential applications without the need for\ninterchangeable optical components.\nand quantifying them with SOC and MSE values. The results show that while AcGAN closely\napproximates the true spectral characteristics for Fano and Lorentzian resonances (Figure 6(a-d)),\nit exhibits deviations in Gate and Gaussian profiles, particularly at the spectral tails (Figure 6(e-\nh)). This variance suggests AcGAN's robust performance on spectra present in the database but\nhighlights the need for better model generalization to accommodate theoretically defined but\nunrepresented spectral types in the training set.\nTo further analyze the performance of AcGAN for a variety of spectral designs and their relation\nto the training dataset, we propose a \"weighted distance\" metric. Defined as $D_w(s) =$\n$\\sum_{i=1}^{k} (\\frac{n_i}{N} SOC (s, c_i))$, this metric quantifies the deviation of a spectrum s from the cluster\ncentroids {C1, C2, ..., Ck} based on the training data. Here, ni is the number of spectra in the i-th\ncluster, and N is the total number of spectra across all clusters. For empirical analysis, we\ngenerated 1,000 spectra for each of the four spectral types and calculated their respective Dw. Each\nspectrum was categorized into intervals of 0.05 in weighted distance, with ten spectra sampled per\ninterval to ensure uniform coverage. This structured sampling addresses potential gaps in naturally\noccurring spectra, as some intervals, particularly at higher distances, may not contain naturally\noccurring examples. Figure 7 illustrates the correlation between SOC and weighted distance, with\nellipses highlighting the general distribution of SOC against weighted distance for each type.\nNotably, spectra with lower weighted distances typically achieved lower SOC, indicating closer\napproximation to the target spectral characteristics. This trend was especially pronounced for\nLorentzian and Fano spectra. Conversely, the Gate and Gaussian spectra demonstrated lower SOC,\nunderscoring potential challenges in generating these spectra types due to their underrepresentation\nin the training data. The observed variance in AcGAN's performance across spectral types\nhighlights the critical importance of training dataset diversity for model generalization. Expanding\nthe dataset to include a broader spectrum of metasurface configurations could enhance the model's\ncapability to accurately generate designs for a wider array of spectral responses. Future research\nwill focus on augmenting the dataset and refining model algorithms to improve performance across\nless represented spectra, thereby broadening the practical applications of the AcGAN framework\nin metasurface design.\nTo thoroughly evaluate the AcGAN's robustness and adaptability to varying configurations, we\nexecuted a series of ablation studies, the detailed results of which are presented in the Section S10\n(Supporting Information). Our ablation analyses underscored the pivotal roles of the cluster\ncontroller and AnchorNet's integration within both the generator and discriminator. The presence\nof the cluster controller led to a notable decrease in MSE and SOC, indicating higher fidelity EM\ndesign. Similarly, enabling AnchorNet in both model components significantly enhanced the\nfidelity of generated metasurface designs. Adjustments in the adversarial training dynamics,\nparticularly variations in the k-value, defined as the number of generator updates per discriminator\nupdate, revealed that a balanced approach is crucial for stable training and optimal model\nperformance. The studies highlighted that a k-value of 2 was optimal, significantly reducing MSE\nand increasing SOC compared to other configurations. Moreover, the impact of initial spectral loss\nweighting, represented by the parameter a, was profound. Surprisingly, a lower weight (a = 0.1)\nunexpectedly yielded better performance, suggesting that an excessive initial emphasis on spectral\nfidelity might hinder the model's ability to generalize across a broader design space. This finding\npoints to the need for a balanced loss function that adequately emphasizes both spectral fidelity\nand adversarial robustness. Investigations into the effects of latent space dimensions and batch\nsizes further refined our understanding of model behavior. Optimal latent dimensions and smaller\nbatch sizes tended to improve the model's precision and stability, indicating that finer granularity\nin the generation process aids in capturing the nuances of metasurface designs. Collectively, these\nfindings underscore the intricate interdependencies within the AcGAN architecture and highlight\nthe need for careful calibration to maximize performance. These insights are crucial for refining\nthe AcGAN framework to enhance its practical applicability across diverse metasurface design\nscenarios, thereby extending the capabilities of current computational photonic design methods."}, {"title": "CONCLUSION", "content": "The AcGAN has fundamentally advanced the inverse design of metasurfaces by achieving high\nelectromagnetic fidelity and structural diversity. AcGAN consistently delivers precise spectral\nalignment, evidenced by a mean MSE of 1.120 * 10\u22123 and a SOC of 0.139. Unlike traditional\nphysics-inspired models that require extensive computational time, often extending from days to\nmonths for single predictions, and stochastic optimization techniques like GA, PSO, and DE that\noffer quicker predictions but lack the consistency and ease of use provided by deep learning\napproaches, AcGAN excels by facilitating rapid, effective design iterations post a singular,\ncomprehensive training period. Looking ahead, future enhancements to AcGAN will focus on\nseveral critical areas: 1. Optimizing AnchorNet: Enhancing its predictive accuracy, particularly for\nhybrid structures with complex Fano resonance profiles, which currently present significant\nchallenges. 2. Enhancing encoding techniques: Expanding the range of design variables to include\nmore intricate and functional metasurface configurations, thereby broadening the scope of\nmetasurface applications. 3. Expanding dataset diversity: Incorporating a broader array of\nmetasurface structures, especially free-form designs, to improve the model's generalization\ncapabilities and robustness. AcGAN represents not only a methodological breakthrough but also a\nscalable and robust framework that significantly accelerates the design process in nanophotonic\napplications. This makes AcGAN a pivotal tool for advancing operational metasurfaces, meeting\nthe evolving demands of optoelectronics and related industries."}]}