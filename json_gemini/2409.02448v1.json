{"title": "Detecting Korean Food Using Image using Hierarchical Model", "authors": ["Hoang Khanh Lam", "Kahandakanaththage Maduni Pramuditha Perera"], "abstract": "A solution was made available for Korean Food lovers who have dietary restrictions to identify the Korean food before consuming. Just by uploading a clear photo of the dish, people can get to know what they are eating. Image processing techniques together with machine learning helped to come up with this solution.", "sections": [{"title": "I. INTRODUCTION", "content": "With the immense popularity towards Korean culture, Korean food has gained huge recognition and popularity throughout the world. Most of the foreign tourists come to South Korea to enjoy the Korean food culture. On the other hand, since most of them do not speak or understand the Korean language, selecting food items suitable for them has become a crisis.\nAlso nowadays, health problems related to eating and food in general are increasing in both quantity and danger. Especially, most of the foreigners living in South Korea have dietary restrictions due to religion, health-related issues or personal preferences. Besides, being allergic to accidentally eating unfamiliar ingredients in new dishes, especially when traveling, can easily lead to unpredictable consequences. Food Image Recognition involves the utilization of visual data to determine food name/label. It has the potential to contribute to various applications, such as dietary assessment, food inspection, food recognition, and food recommendation."}, {"title": "II. CHALLENGES", "content": "Obtaining a suitable data-set was the very first challenge faced. After obtaining a proper data-set the model training phase was initiated. Similarity among different types of Korean Food made the training phase more of a challenge. Differentiating food with similar color and texture was difficult. At the same time dealing with poorly taken pictures and incomplete pictures was also an obstacle. Since most of the Korean dishes come with several side dishes, detecting multiple foods at the same time was also an added difficulty."}, {"title": "III. RELATED WORK", "content": "Research in the field of computer vision and food image recognition, including the identification of specific cuisines such as Korean food, is continuously evolving. Back in 2019, Korea Food Research Institute, Wanju conducted a research on \"The development of food image detection and recognition model of Korean food for mobile dietary management\". According to the results of this study, higher accuracy level of 91.3% was obtained with a 0.4ms recognition time. In this study, they have collected food images by taking pictures or by searching web images and built an image dataset for use in training a complex recognition model for Korean food. Augmentation techniques were performed in order to increase the dataset size [1]\nOn October 2022, group of researches from Department of Computer Science and Engineering, University of Seoul have conducted a study on \"Development of Korean Food Image Classification Model Using Public Food Image Dataset and Deep Learning Methods\". Their model can be used in a system that automatically classifies the type of food that the user has consumed. This work will benefit the community of users and researchers using trained models. It also benefits users of systems that automatically classify and record the types of food they take. Users can classify images of similar Korean food into 150 classes using the model and record what they eat. The key contribution of this study to the research community is that they created a pre-processed dataset for training a Korean food image classification model. Also, they have used several pre-trained deep neural networks to train models that classify Korean food images into 150 classes and evaluated the classification accuracy and time required for model training [2]."}, {"title": "IV. DATASET", "content": "The data uploaded for detection have to be very clear. At the same time, the photos should be taken from a mobile phone as the images used for training and deploying the system were also obtained through the camera of the mobile phone. Since mobile phones are portable, it is easy for users to"}, {"title": "A. Public Data", "content": "Once done with the background research, obtaining a proper dataset was a huge crisis. Several options as aihub, Roboflow were considered. Though there were several suitable datasets on aihub, obtaining such data was difficult for foreigners. After revising many datasets, one suitable for our system was obtained from Roboflow."}, {"title": "B. Data-set Construction", "content": "As a basic approach, categorizing food based on visual aspects was initiated. A mechanism to group food based on color, texture, contrast, size, shape, arrangement, temperature, layering and theme was taken into account. Korean food were divided into four main categories namely, Main Dish, Rice, Soup and Side Dish. Each category was divided further into sub categories accordingly. After completing the Background Research, application of a hierarchical model to group data was considered."}, {"title": "C. Hierarchical Dataset", "content": "A hierarchical model is a structure that organizes elements into levels or layers, where each level represents a specific degree of abstraction or detail. The arrangement of elements reflects their hierarchical relationships and dependencies. Hierarchical models are often represented as trees, where the topmost level is the root, and subsequent levels branch out like the limbs of a tree. This visual representation makes it easy to understand the relationships and navigate through the structure.\nA hierarchical model could be structured based on ingredients, allowing for the categorization of dishes according to shared components. For example, dishes made with similar base ingredients like kimchi, red chili paste, or rice could be grouped together. Also can provide a user-friendly interface, allowing users to navigate through categories and subcategories easily. In the context of designing a menu, a hierarchical model can assist in creating a well-structured and visually appealing layout. Dishes can be grouped logically, making it easier for customers to navigate and choose their preferences."}, {"title": "V. OUR METHOD", "content": "In this part, we present a system for categorizing food products. The approach attempts to address two main problems: the dataset's class imbalance and the absence of obvious visual relationships between various food products. In order to overcome these difficulties, we establish a tier of hierarchy between \"food types\" and \"food items\u201d. This is achieved in the training phase by updating the Convolution Neural Network (CNN) model by multi-stage transfer learning and clustering visually related food items iteratively. The trained model in the multi-stage transfer learning step is used directly for food image classification during the validation and testing stages. Besides, to prove the effectiveness of the hierarchical model, we also train the flat classification model as a baseline model."}, {"title": "A. Flat Classification", "content": "This research proposes a YOLOv8-based method for smart city food image detection. The suggested methodology aims to mitigate some constraints of prior research and offer enhanced precision, instantaneous identification, adaptability, diminished false alerts, and economical viability.\nThe YOLO collection of algorithms has gained interest in computer vision. Because it maintains a high level of accuracy while maintaining a small model size, YOLO is quite popular. YOLO models may be trained on a single GPU, making them accessible to a broad range of developers. It may be reasonably installed by machine learning specialists on edge hardware or in the cloud. YOLOv8, the most advanced and recent YOLO technique, can be used for segmentation, object recognition,"}, {"title": "B. Hierarchical Classification", "content": "We use multi-stage hierarchical transfer learning to take advantage of the hierarchical structure that has been built and to address the problem of class imbalance in food products. By using this method, we can move knowledge from the top level-food types to the lower level-food items. The pipeline of our multi-stage hierarchical transfer learning approach is depicted in. Our training procedure is iterative and consists of two stages.\n\u2022 First stage: We use a CNN model (Yolov8) that has been pre-trained on ImageNet for the first iteration [8]. Next, using food kinds as labels, this model is connected to a fully connected layer with a size of T = 4. We keep the parameters in the core of the CNN model that was trained in the previous iteration for use in later iterations. Using food kinds as labels, a new CNN model is built from scratch and connected to a fully connected layer with a size of T = 4.\n\u2022 Second stage: We build a new CNN model by leveraging the parameters from the foundation of the CNN model trained in the second stage. This model is trained with food items as labels and is linked to a fully connected layer with a size of N=32.\nWe use the cross-entropy loss, which is expressed as follows, as our loss function at each training phase:\n$$L = -\\sum_{i=1}^{N} y_{s,i}log(p_{s,i})$$  (1)\nHere, s denotes the stage at which the model is being trained. $y_{s,i}$ represents the ground truth label i at stages, and indicates the confidence score for predicting label i at stage s.\nThe CNN model is then used in the food item merging process to produce new merging results after being improved through this multi-stage hierarchical transfer learning process. The next iteration of the multi-stage hierarchical transfer learning process is then started by transferring the parameters from the model's core. This loop keeps on until either the risk of over fitting is mitigated by reaching a maximum of 5 iterations, or the validation loss on food item classification stops decreasing in subsequent rounds. Ultimately, predictions about food items are retrieved using the CNN model that was trained in the last iteration of the second stage. The preserved model from the first iteration's stage is utilized to forecast food categories for experimental comparison with related research."}, {"title": "VI. EXPERIMENT", "content": "We evaluate our proposed method based on average classification accuracy of predicting food items. We divide the Food Image dataset using a 8:1:1 ratio into training, validation, and testing sets in order to train the CNN model. The validation set is used to evaluate whether the trained model should be saved for further testing, whereas the training set is used to train the model. The testing set is set aside for the last assessment of the model. The CNN architecture of our suggested solution is based on the Yolov8. We employ the Adam optimizer for optimization, starting with a 0.001 learning rate. The multi-stage hierarchical transfer learning process is taught over 100 epochs for each stage. If the loss does not decrease after each iteration, we cut the initial learning rate by a factor of 0.03."}, {"title": "VII. CONCLUSION", "content": "In this work, we took advantage of a Korean food image dataset, which assigns related food item to each food image. Within the dataset, we treat food items as subclasses of food kinds, creating a hierarchical structure. We can obtain the relevant nutritional composition data by predicting food items, which advances the objective of image-based dietary evaluation. We used a multi-stage hierarchical transfer learning approach to update the CNN model for extracting image features iteratively during the training phase in order to create visual relations among food items. This approach can also address the problem of class imbalance across food items.\nAlthough these efforts, there exist additional plausible approaches that may enhance the precision of food item classification even further. Our goal is to use concepts from multi-modal learning to our future work to improve the way we classify food products and, consequently, the way food image categorization on food items is refined."}]}