{"title": "Adversarial Contrastive Learning Based Physics-Informed Temporal Networks for Cuffless Blood Pressure Estimation", "authors": ["Rui Wang", "Mengshi Qi", "Yingxia Shao", "Anfu Zhou", "Huadong Ma"], "abstract": "Time series data mining is immensely important in extensive applications, such as traffic, medical, and e-commerce. In this paper, we focus on medical temporal variation modeling, i.e., cuffless blood pressure (BP) monitoring which has great value in cardiovascular healthcare. Although providing a comfortable user experience, such methods are suffering from the demand for a significant amount of realistic data to train an individual model for each subject, especially considering the invasive or obtrusive BP ground-truth measurements. To tackle this challenge, we introduce a novel physics-informed temporal network (PITN) with adversarial contrastive learning to enable precise BP estimation with very limited data. Specifically, we first enhance the physics-informed neural network (PINN) with the temporal block for investigating BP dynamics' multi-periodicity for personal cardiovascular cycle modeling and temporal variation. We then employ adversarial training to generate extra physiological time series data, improving PITN's robustness in the face of sparse subject-specific training data. Furthermore, we utilize contrastive learning to capture the discriminative variations of cardiovascular physiologic phenomena. This approach aggregates physiological signals with similar blood pressure values in latent space while separating clusters of samples with dissimilar blood pressure values. Experiments on three widely-adopted datasets with different modailties (i.e., bioimpedance, PPG, millimeter-wave) demonstrate the superiority and effectiveness of the proposed methods over previous state-of-the-art approaches. The code is available at https://github.com/Zest86/ACL-PITN.", "sections": [{"title": "I. INTRODUCTION", "content": "Time series analysis is an important yet challenging task in the field of data mining [1], in which, medical temporal data analysis has great value in continuous health monitoring. To be specific, blood pressure (BP) is one of the most crucial indicators of cardiovascular health [2]. Two common irregularities in BP are hypertension (high blood pressure) and hypotension (low blood pressure) which can easily be overlooked despite indicating certain cardiovascular diseases such as stroke or chronic kidney issues. Therefore, accurate blood pressure estimation holds significant importance in monitoring everyday human health. To enable continuous monitoring of BP values, various wearable devices have been integrated [3] to mine valuable information for health analysis, such as graphene electronic tattoos and multiple sensors. These devices enable precise BP estimation using diverse multimodal signals, including bioimpedance, millimeter-wave, and photoplethysmography (PPG). This casts a problem of how these time series data should be analyzed to predict the subject's health information. They significantly enhance user experience and contribute to the advancement of digital health.\nTraditionally, blood pressure is measured using a cuff to compress the arm, which causes an unpleasant user experience [5]. As a result, cuffless BP estimation has gained significant development in recent years to improve user comfort. A lot of ambulatory BP monitoring platforms provide multiple solutions for continuous cuffless BP estimation in non-clinical (ambulatory) settings using wearable devices like bioimpedance [6]\u2013[8] or millimeter wave sensor [4]. Considering that these electrical signals are frequently a multi-variable measurement utilized to predict physiological states, recent developments in AI algorithms, especially deep learning models, can provide great opportunities for cuffless BP estimation. This involves inferring BP using data from cuffless wearable devices (e.g., Blumio sensor, graphene electronic tattoos), by modeling the complex inherent input-output temporal relationships in physiological systems. However, these methods usually require collecting significant amounts of training data as well as ground truth labels for each subject to train a powerful model. In fact, invasive or obtrusive medical-grade measurement systems (e.g., arterial lines or cuff-based (auscultatory or oscillometric) sphygmomanometers for peripheral blood pressure monitoring), are cumbersome and impractical in certain contexts. To address these challenges, there is a pressing need to develop advanced models for time series data that can achieve accurate BP estimation with reduced reliance on ground truth data."}, {"title": "II. RELATED WORKS", "content": "This section discusses the related work, including blood pressure monitoring, adversarial training, and contrastive learning methods.\nBlood Pressure (BP) is a significant cardiovascular parameter frequently used by clinicians to assess cardiac and circulatory health [25]. Traditionally, BP is measured by cuff-based (auscultatory or oscillometric) digital BP devices, which compresses the user's arm and thus causes an unpleasant\nSo far, extensive efforts [6], [7], [9]\u2013[12] have been devoted to cuffless BP estimation, which utilizes various methods for modeling, such as Finite Element Analysis (FEA) [6], Bidirectional Long Short Term Memory (BiLSTM)-based Hybrid Neural Network (HNN) [9] and Autoencoder [10], etc. These models work in a pure data-driven framework, without utilizing domain knowledge in biological systems, which makes them effective in numerous training data situations but fail in personalized modeling. In this paper, we focus on improving the personal modeling ability of previous beat-to-beat BP estimation models and data augmentation methods which provide more training examples. Furthermore, the emerging physics-informed neural networks (PINNs) [13] which leverage underlying physics laws structured by generalized partial differential equations (PDEs), have proven their superiority in related fields such as fluid mechanics [11] and power systems [12]. Compared with the above-mentioned pure data-driven BP estimation approaches, PINN utilizes physiological prior to formalizing additional physics residual for constraint on model training, which enhances BP estimation with reduced labels for training [7].\nVanilla PINNs take coordinates as input, which ignores the potential temporal relation between input time series data [14]. However, beat-to-beat BP estimation is a continuous time series data mining task, where input time series waveform contains rich temporal information. Furthermore, there are some Transformer-based methods that utilize the long-term modeling ability for cuffless blood pressure estimation [15]. Specifically, Transformer-based models adopt the attention mechanism or its variants to capture the pair-wise temporal dependencies among time points [16], [17]. However, it is still challenging for the attention mechanism to directly identify reliable dependencies from scattered time points, as these temporal dependencies can be deeply obscured by intricate temporal patterns [18], [19]. To bridge the gap between PINN and temporal modeling, we propose a novel Physics-Informed Temporal Network (PITN) for cuffless blood pressure estimation, which enhances PINN's ability in temporal data mining through a novel temporal block for personal cardiovascular cycle modeling as shown in Fig. 1. The proposed temporal block enables temporal variation modeling through transformation of 1D time series to 2D space and is suitable for personalized cardiovascular cycle modeling.\nFor data scarcity, one promising way is adversarial training, which is used to improve the model's robustness. Several recent works show that adversarial examples can be used to improve model performance in computer vision (CV) [20], natural language processing [21], and other domains. These previous works make it promising to use adversarial samples for data augmentation in time series analysis. Unfortunately, limited work adopts such a similar adversarial training strategy in medical time series data, which is our main focus of data augmentation methods in this work.\nIn addition, contrastive representation learning has been shown as a promising manner to mitigate data scarcity [22]. However, extending contrastive learning paradigms to time series presents significant challenges, especially in the health domain with unique characteristics (e.g., low frequency, and high sensitivity [23]). Although, some previous work adopt self-supervised contrastive learning to mitigate the challenge of label scarcity in medical time series [22], [24]. These self-supervised methods require a large amount of data for pre-training, which is an emergent weakness. Besides, Sel et al. [7] point out that for deep learning-based BP estimation models, as the training data increases, personalized correlation fluctuates.\nFor this part, to the best of our knowledge, there is no related work focusing on improving this insufficiency. In this work, we utilize contrastive learning to address this problem by adding soft constrain on latent embedding, to enable the deep model to learn from physiological signals with similar BP values. Through using generated adversarial examples, our proposed method can offer extra alternatives for the deep model to capture the discriminative variations of cardiovascular physiologic phenomena.\nThe main advantages of our proposed framework are threefold. First, PITN extends vanilla PINN models's ability in time series modeling by capturing intraperiodic temporal features. Second, we further enhance the PITN by incorporating adversarial training which generates extra adversarial samples to ensure sufficient robustness. These perturbed samples also serve as data augmentation to boost model training. Last but not least, the proposed contrastive learning leverages adversarial samples to better capture the discriminative BP dynamics. Our contributions can be summarized as follows:\nWe propose an end-to-end Physics-Informed Temporal Network (PITN) for cuffless blood pressure estimation by enhancing the PINN with the newly designed temporal blocks, which model precise personal temporal characteristics and address the scarcity of realistic healthy data.\nWe propose a novel adversarial training method to augment physiological time series data for cuffless blood pressure estimation, which leverages physiological priors during the generation.\nWe design a contrastive learning approach incorporated with adversarial training to capture blood pressure discriminative variations.\nExtensive experiments are carried out on graphene-HGCPT, ring-CPT, and blumio datasets, and the results show our methods' superiority in different modal physiological time series modeling using minimal ground truth data."}, {"title": "III. PRELIMINARIES", "content": "In this section, we start with the problem definition and then introduce the physics-informed neural networks to beat-to-beat BP estimation.\nGiven the input time series signal $X \\in \\mathbb{R}^{N \\times T \\times C'}$, the goal of cuffless blood pressure is to estimate blood pressure value $y$ (e.g., systolic BP (SBP) or diastolic BP (DBP)). Let $X = [X_1, X_2, ..., X_N]$ be the continuous bioimpedance (BioZ) signal with N segments, length-T and C channels, for each segment $x_i \\in \\mathbb{R}^{T \\times C}$, we extract physiological feature $u_i \\in \\mathbb{R}^M$ denoted as the M dimensional vector. The neural network can be formulated as $\\hat{y} = f(x, u, \\theta)$ with input $x, u$, parameter $\\theta$, and the predicted blood pressure $\\hat{y}$.\nIn this part, we review the formal definition of Physics-Informed Neural Networks (PINNs) [13]. PINNs are trained to solve regular supervised tasks while adopting several given laws of physics described by partial differential equations (PDEs) as the network residual. However, the relationships that connect wearable measurements to cardiovascular parameters are not well-defined in the form of generalized PDEs. Following [7], we adopt the idea of building physics constraints with Taylor's approximation for certain gradually changing cardiovascular phenomena (e.g., establishing the relationship between physiological features extracted from bioimpedance sensor measurements and BP). Here we can define a polynomial with Taylor's approximation around i-th segment as the following:\n$\\displaystyle f_i(x, u, \\theta) = f(x_i, u_i, \\theta) + \\nabla_{u_i} f (x_i, u_i, \\theta)^T (u - u_i),$\\nwhere $f(x, u, \\theta)$ represents the above Talyor polynomial approximated based on i-th segment. The first-order Jacobin matrix can be calculated discretely as $\\frac{\\partial f}{\\partial u} = \\frac{1}{k}\\sum_{k=1}^M (u_k)$. A residual result from the difference between the neural network prediction and the Taylor polynomial evaluated at the $(i+1)$-th segment as shown in Eq. (2):\n$\\displaystyle h_i (x_{i+1}, u_{i+1}, \\theta) = f_i(x_{i+1}u_{i+1}, \\theta) - \\hat{f} (x_{i+1}, u_{i+1},\\theta),$\nwhere $h_i (x_{i+1}, u_{i+1},\\theta)$ denotes the residual value evaluated at $(i+1)$-th segment using Taylor's approximation around i-th segment. The value of h represents a physics-based loss for the neural network. Given that h is calculated in an unsupervised way (i.e., labels of output are not used), we can calculate h for any given input sequence. We evaluate the value of h for all consecutive input segments and use the mean squared sum of"}, {"title": "IV. PROPOSED APPROACH", "content": "We give an overview of our proposed framework in Section IV-A. We explain each component of our framework including the PITN model with temporal blocks in Section IV-B, the adversarial examples generation in Section IV-C, the contrastive learning in Section IV-D. lastly, we discuss the training and inference process in Section IV-E.\nAs illustrated in Fig. 2, our framework comprises three key components: 1) Physics-Informed Temporal Network (PITN), 2) adversarial training, and 3) contrastive learning. In the PITN, newly designed temporal blocks are employed to extract personal physiological features, and Projected Gradient Descent (PGD) is tailed to generate adversarial samples for model training augmentation. These adversarial samples, along with clean samples, are disentangled using distinct layer normalization (LN) layers. Additionally, we adopt the contrastive learning loss by comparing clean and adversarial samples, based on their true blood pressure (BP) values.\nThe whole process is as follows. We first pre-process different modal signals (e.g. bioimpedance signal) to obtain clean input x. Then adversarial sample $\\tilde{x}$ is generated using Project Gradient Descent (PGD). Both clean and adversarial inputs are fed through the temporal block for feature extraction and the output estimated BPs are denoted as $\\hat{y}$ and $\\tilde{y}$, respectively.\nPhysics-Informed Neural Networks (PINNs) traditionally use coordinates as input while overlooking potential temporal relationships among these inputs. This omission disregards the crucial inherent temporal dependencies present in practical physical systems, leading to a failure in globally propagating initial condition constraints and capturing accurate solutions across diverse scenarios [14]. In this paper, we introduce a novel temporal modeling block to enhance the capability of PINNs in modeling time-series medical data, by extracting complex temporal variations from transformed 2D tensors using a multi-scale Inception block.\nAs illustrated in Fig. 3, we organize the temporal block in a residual way [56]. Specifically, for the length-T 1D input"}]}