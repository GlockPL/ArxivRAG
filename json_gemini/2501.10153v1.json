{"title": "Region-wise stacking ensembles for estimating brain-age using MRI", "authors": ["Georgios Antonopoulos", "Shammi More", "Simon B. Eickhoff", "Federico Raimondo", "Kaustubh R. Patil"], "abstract": "Predictive modeling using structural magnetic resonance imaging (MRI) data is a prominent approach to study brain-aging. Machine learning algorithms and feature extraction methods have been employed to improve predictions and explore healthy and accelerated aging e.g. neurodegenerative and psychiatric disorders. The high-dimensional MRI data pose challenges to building generalizable and interpretable models as well as for data privacy. Common practices are resampling or averaging voxels within predefined parcels, which reduces anatomical specificity and biological interpretability as voxels within a region may differently relate to aging. Effectively, naive fusion by averaging can result in information loss and reduced accuracy.\nWe present a conceptually novel two-level stacking ensemble (SE) approach. The first level comprises regional models for predicting individuals' age based on voxel-wise information, fused by a second-level model yielding final predictions. Eight data fusion scenarios were explored using as input Gray matter volume (GMV) estimates from four datasets covering the adult lifespan. Performance, measured using mean absolute error (MAE), R2, correlation and prediction bias, showed that SE outperformed the region-wise averages. The best performance was obtained when first-level regional predictions were obtained as out-of-sample predictions on the application site with second-level models trained on independent and site-specific data (MAE=4.75 vs baseline regional mean GMV MAE=5.68). Performance improved as more datasets were used for training. First-level predictions showed improved and more robust aging signal providing new biological insights and enhanced data privacy. Overall, the SE improves accuracy compared to the baseline while preserving or enhancing data privacy.", "sections": [{"title": "Introduction", "content": "The process of aging in humans is complex and it inevitably influences the brain, with negative consequences such as neurodegeneration which can lead to dementia and also is a mortality risk [1], [2]. The structural changes in the brain can be measured non-invasively via Magnetic Resonance Imaging (MRI) scans which capture the brain in volumetric form, comprising smaller volume elements called voxels. Each scan consists of hundreds of thousands of voxels. Following appropriate processing, it is possible to quantify the amount of specific brain tissues such as gray matter volume (GMV) at each voxel. This in turn permits in-depth study of distinct brain structures in relation to various cognitive, pathological and other physiological processes such as aging. Structural differences in the GMV have been reported between younger and older healthy individuals [3], [4], [5] along with continuous, widespread reduction in GMV observed from middle age onwards [6], [7], [8]. Additionally, an accelerated loss of both global and local GMV has been documented in neurodegenerative disorders [7], [9], [10], [11], [12], [13] such as the Alzheimer's disease (AD) and mild cognitive impairment (MCI) compared to normal aging.\nLeveraging machine learning models to predict chronological age in healthy individuals using GMV aims to estimate the trajectory of healthy brain aging and through it unravel the links to neurodegenerative, psychiatric, and other disorders. Such MRI-derived age-prediction has been shown to be a reliable proxy for overall health [10], [14], [11]. An elevated brain age stands as an important risk factor for various neurodegenerative and psychiatric disorders [12], [13], [15], [16], [17]. Thus, age prediction models can facilitate early detection of health risk and facilitate effective prevention and treatment strategies. The success of this approach hinges on accurate and biologically meaningful models. Furthermore, sharing MRI data or even its derivatives can lead to privacy issues [18]. Hence it is important that new brain age estimation methods respect individuals' privacy. Furthermore, generalizing across data from multiple scanners remains challenging due to systematic biases. To this end, various machine learning algorithms and GMV-derived features have been tested aiming at providing more accurate predictions as well as insights into healthy brain aging. For instance, Relevance Vector Regression (RVR) outperformed Support Vector Regression (SVR) when trained on downsampled voxels -with and without feature selection, yielding MAE=5 years in healthy subjects and MAE=10 years in AD [19]. Gaussian Process Regression using structural MRIs was efficient in estimating mortality via brain age [1] and outperformed RVR, Kernel Ridge Regression and LASSO [6]. Additionally, various deep neural network models have been proposed such as convolutional neural networks [13], [19], [20], DenseNet [21], lightweight deep learning model, Simple Fully Convolutional Network (SFCN) [22] and other variations [23], [25].\nIn terms of GMV features, previous studies have used voxel-wise GMV [1], [2], [26], [27], feature reduction methods such as principal component analysis and non-negative matrix factorization [25], [26] as well as regional mean values [30], [31]. The voxel-based approach is encumbered by the \"curse of dimensionality\", high computational demands due to the high number of voxels and high intersubject variability. On the other hand, the use of regional mean GMV is more conducive for machine learning. This simple and efficient type of information fusion can enhance robustness and statistical power mitigating the impact of noise or variability within individual voxels. Additionally, use of a meaningful parcellation scheme increases sensitivity for detecting regional changes, yielding results that are easier to interpret from a neuroanatomical perspective and can provide critical priors for studying brain basis of behavior and disease [32]. Effectively, calculating regional mean of GMV as a form of information fusion might be too naive"}, {"title": "Material and methods", "content": "We used T1-weighted MRI scans of healthy individuals (total N=2926, covering the whole adult lifespan (18-88 years), coming from 4 open datasets: the Cambridge Center for Ageing and Neuroscience (CamCAN, N=650, mean age=54\u00b118.6, min-max=18-88) [43], Information eXtraction from Images (IXI, N=562, mean age=48.7\u00b116.45, min-max=20-86) (https://brain-development.org/ixi-dataset/), the enhanced Nathan Kline Institute-Rockland Sample (eNKI, N=597, mean age=48.2\u00b118.5, min-max=18-85) [44] and the 1000 brains study (1000Brains, N=1117, mean age=61.8\u00b112.4, min-max=21-85) [45].\nWe processed the T1 scans to extract modulated GMV in the MNI space for each subject, using Computational Anatomy Toolbox (CAT) version 12.8 [23]. To ensure accurate normalization and segmentation, initial affine registration of T1w images was done with higher than default accuracy (accstr=0.8). After bias field correction and tissue class segmentation, optimized Geodesic Shooting [46] was used for normalization (regstr=1). We used 1.5 mm Geodesic Shooting templates and outputted 1.5 mm isotropic images. The normalized GM segments were then modulated for linear and non-linear transformations yielding estimated GMV for each voxel (N=399184 voxels in total)."}, {"title": "The SE model training", "content": "In this study we implemented SE with two levels, denoted as L0 and L1. For both levels, we utilized GLMnet (elastic net) [47] due its ability to handle multicollinearity in data, such as the voxels of structural MRI, efficiently. Elastic net regression combines ridge regression (L2 regularization) and LASSO (L1 regularization), which facilitates dealing with multicollinearity by penalizing large coefficients and promoting simpler models. We used the glmnet package in R (version R-4.1.0) that incorporates an internal process for hyperparameter tuning. By default it optimizes the regularization parameter lambda ($\\lambda$) along with the mixing parameter alpha ($\\alpha$) using 'adaptive resampling'. Features with near-zero variance were identified and removed. The remaining features underwent centering -removing the mean-, and scaling -dividing with the standard deviation."}, {"title": "Data split and training setups", "content": "In our experiments, we estimated models' performance using Leave-One-Site-Out (LOSO) validation. The LOSO set up mimics the scenario when the models are applied to data from a new scanner not available during training, thus it provides a more accurate estimation of model's ability to generalize across different scanners or sites. When using multiple datasets for training, the training data or models can be combined in various ways. Data from different sites can be either pooled and used as if they are coming from one source for training L0 and L1 models. Alternatively, data from each site can be used separately to train both in L0 and L1 models creating site-specific SE models and the predictions of L1 models can be then averaged to obtain the final prediction. In-between set ups are also possible, for instance L0 predictions can be pooled or averaged prior to training a L1 model. We implemented 8 such set-ups as presented in Table 1. We also examined the impact of training with one or multiple different sites, always testing in an unseen site.\nAdditionally, beyond the aforementioned set-ups, we tested the scenario where a center or a clinic cannot share raw data from patients. Thus, L0 regional predictions could be estimated directly in the test site (from the test set), using a k-fold CV scheme to get out-of-sample (OOS) predictions and pass these predictions to L1 models, trained either in pooled or site-specific data. Note that the L1 models did not include data from the test site for training. We tested this scenario, using a 3-fold CV to get L0 predictions from the test set.\nTo benchmark against the conventional standard, we computed the mean of GMV for each region and trained a GLMnet model to predict age. This is equivalent to replacing each of the 873 first level models with an averaging function. We implemented both pooling as well as different set ups of data/model fusion for the GMV mean data. In order to have a fair comparison with the set-up where we use the test set in a 3-fold scheme in L0, we also implemented an"}, {"title": "Results", "content": "The performance of different set ups was evaluated using leave-one-site-out (LOSO) scheme. We calculated MAE, R2, Pearson's correlation between predicted and real values and prediction bias. Overall, SE frameworks showed better performance. Specifically, the highest performances were observed for the setups where L0 predictions were obtained from the test site: OOSPred\uff61L1p (average MAE=4.75), closely followed by OOSPred\uff61L15 (MAE=4.9). Setups using pooled L0 predictions to train a single L1 model, independently of how L0 was trained, i.e. PredL0L1, and PredL0L1p, showed MAE=5.1. When using mean region-wise GMV, the model trained using the training data sets together with the 2 training folds from the test site, GMVpL1pext, showed MAE=5.7. Performance was worse for the other two region-wise mean GMV models trained in three datasets, with the L1p setup (pooled predictions from L0 to train L1) being slightly better compared to L1s (train L1 models from different sites), MAE=6.2 and MAE=6.7 respectively. The performance ranking was the same for R\u00b2, slightly changed in Pearson's r, where the best model was the one where both LO and L1 models were trained on pooled data. The performance of the models regarding age bias was rather different. The lowest bias was found for GMVpL1p followed by PredL0L1p and OOSPred\u015cL1p (b= -0.41, b=-0.43 and b=-0.44, respectively). Detailed results can be found in Supplementary material Table 3."}, {"title": "Data privacy", "content": "To assess how SE compares to conventional methods in data anonymity and privacy, we conducted a multiclass classification task to predict the dataset of origin. Identifying the datasets is a step closer to identifying the subject itself and thus this task serves as a proxy for gauging the potential for privacy violation. For this task, we employed L0 regional age predictions as features and juxtaposed the dataset prediction performance with that achieved using regional mean gray matter volume (GMV). We performed model selection with hyperparameter tuning for both sets of features. The tested models included logistic regression, linear Support Vector Machine (SVM), SVM with radial basis function kernel, Random Forest (RF). The exact hyperparameter space is presented in the Supplementary Table 1. The accuracy of the optimal model serves as a metric, where higher accuracy indicates better preservation of dataset-specific information in the corresponding feature space. Conversely, lower accuracy in the dataset prediction task suggests a higher level of privacy. This analysis permits to directly compare how SE preserves data anonymity in contrast to regional GMV."}, {"title": "Biological insights", "content": "Correlation values between mean regional GMVs and chronological age across subjects is commonly used for identifying aging-related brain regions. Similar insights from SE models can be derived using the regional age-predictions provided by the L0 models. The results showed that regional predictions of the LO models exhibit a stronger alignment to age (Figure 4). Correlation coefficients' mean (mean of absolute values) for L0 predictions-age was $r_{mean}$=0.6 and $r_{mean}$=0.32 respectively for GMV-age, yielding significant difference (p<<0.01e13). Frontal and cerebellar areas were highlighted in both methods, notably stronger though in SE models. Remarkably, subcortical areas which exhibited positive mean GMV-age correlation, demonstrated a more pronounced and positive association in SE models. Specifically, four regions had positive GMV-age correlation for all datasets, with the mean across datasets ranging from r=0.12 to r=0.29. In comparison, the corresponding L0 predicted-age to real-age correlations were notably higher, ranging from r=0.62 to r=0.8."}, {"title": "Stability across datasets", "content": "To mitigate the possibility that the associations between subjects' age and L0 predictions or GMV, are driven by datasets' idiosyncratic properties, we computed the correlation values separately for each dataset. The results (Figure 6) consistently exhibited the same pattern across datasets, affirming the overall stronger association of L0 (mean=0.86 ranging from 0.79 to 0.91) regional age predictions with age compared to mean regional GMV (mean=0.81 ranging from 0.75 to 0.9)."}, {"title": "Discussion", "content": "Understanding and modelling healthy brain aging is crucial for developing individualized precision methods for various neurodegenerative and pathological brain disorders. Previous work has shown that advanced MRI-derived brain-age, i.e. a higher predicted age than actual age, is associated with neurodegenerative, psychiatric and other diseases [12], [13], [15], [16], [17]. Nevertheless, several important aspects need to be refined prior to integrating brain-age prediction into clinical practice: 1) improved performance and robustness, 2) interpretability and biological insights from prediction models, and 3) improved data privacy. In this context, we propose a two-level stacking model for MRI-based age-prediction. This novel approach performs voxel-based age predictions for each predefined brain region in its first level, which are then fused by a second-level model. Compared to the oftused baseline approach of averaging regional voxels' GMV, our approach offers a more sophisticated data fusion. Contrary to models using regional mean GMV, SE models make better use of the voxel-wise information. Our numerical experiments using large datasets with a wide age range suggest that the proposed SE model provides more reliable and accurate results."}, {"title": "Acknowledgements", "content": "This study was partly supported by the Helmholtz-Al project BrainAge4AD (ZT-I-PF-5-163), and the Helmholtz Portfolio Theme \u201cSupercomputing and Modelling for the Human Brain\u201d."}, {"title": "Ethics statement", "content": "Ethical approval and informed consent were obtained locally for each study covering both participation and subsequent data sharing. The ethics proposals for the use and retrospective analyses of the datasets were approved by the Ethics Committee of the Medical Faculty at the Heinrich-Heine-University D\u00fcsseldorf."}, {"title": "Data/code availability statement", "content": "The codes used for preprocessing, feature extraction and model training are available at https://github.com/juaml/stacking_ensemble_paper"}, {"title": "Conflict of interest", "content": "KRP has a pending patent application pertaining to the SE methodology."}]}