{"title": "MotifGPL: Motif-Enhanced Graph Prototype Learning for Deciphering Urban Social Segregation", "authors": ["Tengfei He", "Xiao Zhou"], "abstract": "Social segregation in cities, spanning racial, residential, and income dimensions, is becoming increasingly diverse and severe. As urban spaces and social relations grow more complex, residents in metropolitan areas experience varying levels of social segregation. If not promptly addressed, this could lead to an increase in crime rates, heightened social tensions, and other serious social issues. Effectively quantifying and analyzing the structures within urban spaces and resident interactions has become crucial for addressing these segregation issues. Previous studies have mainly focused on surface-level indicators of urban segregation, lacking comprehensive analyses from the perspectives of urban structure and mobility. This limitation fails to capture the full complexity of current segregation phenomena. To address this gap, we propose a framework named Motif-Enhanced Graph Prototype Learning (MotifGPL). The MotifGPL framework comprises three key modules: prototype-based graph structure extraction, motif distribution discovery, and urban graph structure reconstruction. Specifically, we use graph structure prototype learning to extract significant prototypes from both the urban spatial graph and the origin-destination graph, incorporating key urban attributes such as points of interest, street view images, and flow indices. To enhance interpretability, the motif distribution discovery module innovatively matches each prototype with similar motifs, which represent simpler graph structures reflecting local patterns. Finally, we use the motif distribution results to guide the reconstruction of the two graphs. This model facilitates a detailed exploration of urban spatial structures and resident mobility patterns, allowing us to identify and analyze the key motif patterns that influence urban social segregation, guiding the reconstruction of urban graph structures for lower segregation. Extensive experimental results demonstrate that MotifGPL can effectively reveal the key motif patterns influencing urban social segregation and provide robust guidance for mitigating this phenomenon.", "sections": [{"title": "Introduction", "content": "Segregation refers to the differentiation of individuals from different population groups in either spatial or social dimensions, a phenomenon influenced by complex social contexts of environments (Oka and Wong 2019). Residential segregation is a common phenomenon in global urban development. Previous studies have suggested a strong connection between residential segregation and issues such as disparities in educational distribution (Quillian 2014; Owens and Rich 2023), unequal employment opportunities (Bursell and Bygren 2023), and the uneven allocation of public infrastructure, including healthcare services (White, Haas, and Williams 2012; Seewaldt and Winn 2023). These imbalances caused by residential segregation can exacerbate tensions between residents, potentially leading to collective conflicts and regional unrest.\nAs urbanization advances, the growing complexity and diversity of urban areas are expanding social segregation beyond residential areas, leading to new forms of separation in social and economic realms (Lens and Monkkonen 2016). Currently, income segregation is emerging as a significant issue in metropolises, restricting interactions among different groups. As Florida (2017) points out, rising income segregation strengthens social boundaries, reducing interactions between social classes and deepening societal divides. These different forms of segregation reinforce each other, creating multi-layered segregation within cities. Without effective policy interventions, these patterns of segregation may reinforce themselves, preventing sustainable development. Therefore, a better understanding of social segregation and the implementation of effective solutions are crucial for promoting urban development.\nTo explore and understand urban social segregation, sociologists have traditionally relied on static socioeconomic data to develop comprehensive indicators reflecting segregation levels. Massey and Denton (1988) initially categorized urban segregation into five primary dimensions, which Brown and Chung (2006) later distilled into two main dimensions: concentration-evenness and clustering-exposure. Building on this, Kwan (2013) introduced an additional accessibility indicator, utilizing these three metrics to assess segregation levels. The advent of digitalization in urban environments has enriched the datasets available for segregation studies, offering a more dynamic perspective. Researchers have begun employing mobility data to track individual movement patterns within cities and to examine spatial accessibility (Chen et al. 2018). Furthermore, Moro et al. (2021) demonstrated that severe income segregation can per-"}, {"title": "Related Work", "content": "Social Segregation Assessment The concept of segregation, originally derived from sociological studies on racial segregation in cities, has had a profound impact on urban economies. For instance, segregation in the United States led to considerable economic disparities, including a $3 billion loss for Black residents in Chicago, alongside skewed public resource allocation (Wang et al. 2018). As urban dynamics have evolved, segregation now spans racial, residential, and income dimensions, intensifying as critical urban development challenges (Gottdiener, Hohle, and King 2019).\nAddressing urban segregation requires robust quantification of the issue. Massey and Denton (1988) initially categorized social segregation into five indicators: evenness, exposure, concentration, centralization and clustering. Later, Brown and Chung (2006) simplified these to concentration and exposure for a more effective assessment. However, as urban functions and mobility patterns grow increasingly complex, these traditional indicators often fall short. Kwan (2013) introduced accessibility as an additional dimension, providing a more comprehensive framework to assess segregation from both spatial and individual perspectives.\nExisting methods typically assign a degree indicator to each block to reflect one aspect of segregation. While these methods provide a straightforward reflection of segregation distribution, they fail to uncover the structural information related to social segregation within urban spatial structures and population mobility.\nGraph Learning in Social Computing Modeling cities as graphs that incorporate edge information, rather than merely calculating statistical features of urban blocks, provides a richer representation of the city. Graph neural networks (Scarselli et al. 2008) are effective for embedding and predicting features in urban graph networks. Researchers (Huang et al. 2023b; Jin et al. 2023; Zou et al. 2024) use graph learning to analyze urban characteristics, dividing tasks into urban graph embedding (Li et al. 2024; Yan et al. 2024) and graph representation learning (Li et al. 2023; Khoshraftar and An 2024). These tasks facilitate"}, {"title": "Preliminaries", "content": "In this section, we introduce the urban graph structure, regional attribute data types, and the calculation of social segregation indices, outlining how these elements are integrated to effectively analyze urban social segregation.\nUrban Graph Cities consist of distinct blocks, each with unique geographical locations, traffic patterns, and commercial structures, which together form the city's fundamental geographic structure. Within this space, the movement of residents and the exchange of information between blocks create an urban OD graph. Thus, a city is represented by a graph $G = (G_s, G_o)$, where $G_s = (V, E_s)$ is the geographic spatial graph and $G_o = (V, E_o)$ denotes the residents' OD graph. Here, $V$ represents the city blocks, $E_s$ the set of geographic proximity edges, and $E_o$ the flow edges depicting resident movements. The adjacency matrices $A_s = (a_{ij} \\in {0, 1}), \\forall i, j \\in [1, ||V||]$ and $A_o = (a'_{ij} \\in {0, 1}), \\forall i, j \\in [1, ||V||]$ correspond to $G_s$ and $G_o$, respectively.\nRegion Attributes Regional attributes encompass both the geographical and social characteristics of city blocks. Street view data capture the geographical features of a block, the regional pedestrian flow index highlights its importance within the urban mobility framework, and POIs data reflect a block's role in the urban functional layout. Socioeconomic indicators represent the social characteristics of residents and measure the degree of social segregation. For each block $v_i \\in V$, we define $X^{SV}$ as the street view data, $X^{FL}$ as the pedestrian flow index, $X^{POI}$ as the count of various POIs, and $X^{SE}$ as the socioeconomic indicators. The metrics $X^{SV}, X^{FL}, X^{POI}$, and $X^{SE}$ collectively represent these attributes for the entire block set $V$.\nNetwork Motifs Network motifs are recurrent local connection patterns in complex network structures, serving as fundamental components that encapsulate the network's architecture. In prototype learning, each prototype $p_i$ in the matrix $P$ is associated with a motif pattern distribution $m_i$, derived from the local graph structure most similar to $p_i$. This distribution $m_i$ reflects the local structural information of the node subset $V_i$ that closely resembles the prototype.\nSocial Segregation Index We collected aggregated socioeconomic indicators for each block, including average income levels, average education levels, and the average age of residents. Following Moro et al. (2021), we used the segregation index to calculate social segregation within each block, defined as follows:\n$S_i = \\frac{1}{2(c-1)} \\sum_{j=1}^c \\sum_{k=1}^c |T_{ci} - T_{cj}|$\nwhere $c$ is the economic distribution (e.g., income, education, and age) and $i,j,k$ are dimensions.\nThis segregation index quantifies differences in segregation levels across blocks and categorizes them into two classes based on quantiles to identify blocks with social segregation, providing a foundation for analyzing how urban networks influence segregation."}, {"title": "Problem Statement", "content": "Given an urban geographic spatial graph $G_s = (V, E_s)$ and an OD graph $G_o = (V, E_o)$ with their corresponding adjacency matrices $A_s$ and $A_o$, and node attributes $X = (X^{SV} || X^{FL} || X^{POI})$, we aim to use the degree of social segregation $d^{SEG}$, derived from socioeconomic indicators $X^{SE}$ as a supervisory signal to learn prototypes $P$ related to urban social segregation and their corresponding motif distribution $M$. The learning task is formalized as follows:\n$F: D \\rightarrow M \\in \\mathbb{R}^{q \\times d}$"}, {"title": "Methodology", "content": "Framework Overview\nFigure 1 illustrates our framework for identifying local structures associated with social segregation from spatial and OD graphs. The model comprises three main components: the prototype-based graph structure extraction module, the motif distribution discovery module, and the urban graph structure reconstruction module.\nThe prototype-based graph structure extraction module involves encoding multi-attribute and graph structure information, followed by prototype learning guided by social segregation degree indicators. The motif distribution discovery module then projects these prototypes onto the spatial and OD graphs to identify local node structures and extract motif distributions. Finally, the urban graph structure reconstruction module utilizes these motif distributions to optimize the urban spatial graph structure, with the goal of alleviating social segregation in cities.\nPrototype-based Graph Structure Extraction\nGraph Encoder The urban spatial graph $G_s$ considers the connectivity of urban areas based on geographical proximity. Following Tobler's first law of geography, we use the spatial graph to simplify inter-regional connections within cities, focusing on links between neighboring areas within a specified threshold. Conversely, the OD graph $G_o$ represents connections based on population mobility.\nOur model employs two feature extractors to independently encode $G_s$ and $G_o$ using adjacency matrices $A_s$ and $A_o$ and node attributes $X$. We utilize Graph Neural Networks (GNNs) as encoders to integrate graph structural information through a multi-layer message passing mechanism. The message passing formula is defined as follows:\n$H_m^{(l+1)} = \\sigma (\\tilde{D}_m^{-\\frac{1}{2}} \\tilde{A}_m \\tilde{D}_m^{-\\frac{1}{2}} H_m^{(l)} W_m^{(l)})$\nwhere $m = {s, o}$ specifies encoders for $G_s$ or $G_o$. $\\tilde{A}_m = A_m + I_N$ includes self-loops, $\\tilde{D}_m$ is the degree matrix, $W_m^{(l)}$ is the layer-specific weight matrix, and $\\sigma$ typically refers to the ReLU activation function. $H_m^{(0)} = X$ represents the initial node attributes. To fully leverage the structural information from both graphs, we concatenate the outputs from each layer of the GNN encoders, resulting in a node latent space representation that blends features from both $G_s$ and $G_o$.\nFollowing the encoding, the node attributes and graph structure are transformed into a latent space representation, denoted as $H$. In the prototype learning layer, we maintain a fixed number ($N_{proto}$) of prototypes per class, capturing essential local structures. Similarity scores $s_{ij}$ between each node's latent representation $h_i$ and prototype $p_j$ are calculated as follows:\n$s_{ij} = -log(\\frac{|| h_i - p_j ||_2^2}{|| h_i - p_j ||_2^2 + \\epsilon})$\nwhere $\\epsilon$ is a small constant for numerical stability. The similarity scores inform a fully connected layer with softmax activation to classify nodes.\nMotif Distribution Discovery\nPrototype Projection Though prototype vectors are continuously optimized during training, they often lack intuitive interpretability. To address this, we developed a module that projects prototype vector $p_i$ onto local subgraphs $G_{sub}$ of"}, {"title": "Urban Graph Structure Reconstruction", "content": "The motif distribution derived from prototype vectors enables a thorough analysis of the spatial and mobility mechanisms influencing social segregation in cities. We use this distribution to guide the reconstruction of the urban graph. After establishing the motif distribution $M$, we assign the corresponding motif distribution $m_i$ to each node, based on its local network structure $G_{sub}$. With a reconstruction threshold $\\alpha$, we incrementally adjust the adjacency matrix $A$ for nodes in a specific category. The steps are as follows:\n$G_m \\leftarrow arg \\max_{M_k \\in M} Sim(Motif(G_{sub}), m_k)$,\n$A[i] = (1 - \\alpha KL)A[i] + (\\alpha KL)A[tar]$,\n$KL = KL(m, m_{tar})$,\n$A_{ij}^{new} = {\\begin{cases} 1 & \\text{if } A_{ij} > \\beta \\\\ 0 & \\text{if } A_{ij} \\leq \\beta \\end{cases}}$\nwhere $G_{sub}^i$ denotes the subgraph of $G$ with node $i$ and $A[i]$ denotes the $i$-th row of adjacency matrix. $KL(\\cdot, \\cdot)$ signifies the KL divergence, $\\alpha$ represents the reconstruction weight factor, and $\\beta$ stands for the edge creation threshold.\nOptimization\nDuring training, our objective is to understand the network structure underlying urban social segregation, using the social segregation index $d^{SEG}$ as the ground truth. We enhance model's accuracy in predicting social segregation levels by minimizing the cross-entropy loss function $L_{CrsEtp}$. In the prototype learning layer, we improve prototype interpretability by imposing constraints that refine their ability to capture key local structures. Following Zhang et al. (2022b), we incorporate a cluster loss $L_{Clst}$, encouraging nodes to align more closely with their respective prototype vectors, and a separation loss $L_{Sprt}$, which distances nodes from non-category prototypes. Additionally, in the motif detection module, we apply an encoding loss $L_{Enc}$ to ensure the local subgraph encoder learns the optimal representation from subgraphs to prototype vectors. In summary, the loss functions we aim to optimize are as follows:\n$L_{CrsEtp} = -\\frac{1}{N} \\sum_{i=1}^N \\sum_{c=1}^C y_{ic} log(g_p(h_i))$\n$L_{Clst} = \\frac{1}{N} \\sum_{i=1}^N \\min_{p_j : P_j \\in P_{y_i}} || g_p(h_i) - p_j ||_2^2$\n$L_{Sprt} = \\frac{1}{N} \\sum_{i=1}^N \\min_{p_j : P_j \\notin P_{y_i}} || g_p(h_i) - p_j ||_2^2$"}, {"title": "Experiments", "content": "Datasets Beijing has evolved unique residential spatial distribution and mobility patterns during urban expansion, making it an ideal city for studying urban social segregation. We selected Beijing as the study city and divided it into 2104 blocks based on geographical divisions. To focus on social segregation in the urban core, we sampled 842 blocks within a 10-kilometer radius of the city center. The dataset includes a spatial graph $G_s (||V|| = 842, ||E|| = 6132)$ and an OD graph $G_o (||V|| = 842, ||E|| = 36334)$. Each block contains data on 21 categories of POIs, hourly pedestrian flow indices, and 20 street view images for both summer and winter, obtained through uniform sampling within the block boundaries.\nBaselines In the experiments, we select GNN variants such as GCN (Kipf and Welling 2016), GAT (Veli\u010dkovi\u0107 et al. 2017), and GIN (Xu et al. 2018), along with interpretable models like ProtGNN(Zhang et al. 2022b) and PGIB(Seo, Kim, and Park 2024). To better evaluate the improvements brought by graph prototype learning to GNN models, we also include GAT and GIN models augmented with the prototype framework. Through comparative analyses, we assess the effectiveness of our model in accurately predicting social segregation levels.\nExperiment Settings In the social segregation levels prediction task, we split the data into training, validation, and test sets with proportions of 0.6, 0.2, and 0.2, respectively. The social segregation index serves as the training label for the prototype network. A pre-trained ResNet50 (He et al. 2016) is used to encode street view images, which are then combined with POIs and flow indices to generate 256-dimensional node attributes. These node attributes are subsequently mapped into a 128-dimensional latent space using a GNN module. The learning parameters are set as follows: a learning rate of 0.001, a maximum of 3000 epochs, and a prototype projection interval of 50 epochs. The hyperparameters for the objective function are $\\lambda_1 = 0.4, \\lambda_2 = 0.2, \\lambda_3 = 2$. A crucial hyperparameter is the number of prototype vectors per class ($N_{proto}$), which is set to 5 based on preliminary experiments. These experiments show that five prototypes optimize both efficiency and interpretability. Using more prototypes increases training time, while fewer prototypes reduces motif discovery. Additionally, to ensure robustness, each experiment is repeated five times."}, {"title": "Conclusion", "content": "This paper presents a framework called Motif-Enhanced Graph Prototype Learning (MotifGPL), which integrates motif discovery with graph prototype learning to uncover insights related to social segregation within urban spatial structures and population movement patterns. We explore motif patterns associated with social segregation, providing a new perspective for addressing segregation issues in urban environments. Our experimental results demonstrate that the motif patterns identified by the model have strong interpretability in real-world scenarios. This not only provides a novel methodological approach for investigating urban segregation but also offers substantial support for urban planning and development practices."}, {"title": "Appendix", "content": "Datasets\nStudy Area We select Beijing as the research area and subdivide the entire city into 2104 blocks based on the natural urban block planning, as detailed in Figure 5a. Given the limited interaction between suburban residents and those in central Beijing, along with the difficulty in collecting data from suburban blocks, we focus primarily on the central urban districts of Beijing. The decision to focus on the central urban districts is driven by several key considerations: Firstly, this area has a high density of residential and commercial activities, providing a rich volume of data conducive to more comprehensive analysis. Secondly, as the core of political, economic, and cultural activities, the central urban districts play an important role in demonstrating and guiding the city's development patterns and urban planning. In the preliminary selection process, blocks with scarce data are systematically excluded to ensure that the study focused on areas where comprehensive and reliable data could be gathered. Ultimately, 842 blocks in the central urban districts are identified as the main study area, with their specific geographical locations shown in Figure 5b.\nStreet View To comprehensively exhibit the environmental characteristics of each urban block, we randomly collect 20 summer street view images and 20 winter street view images per block. To ensure that the collected street view data are broadly representative and thoroughly covered, distance constraints are implemented during the sampling process to ensure a uniform distribution of street view points and to avoid overlaps. Figure 6 shows the specific locations of street view sampling points selected across some certain urban blocks in detail. Due to access restrictions in certain areas, it is not possible to directly obtain specific street view images from some internal parts of the blocks; hence, we choose few images from adjacent streets as substitutes. Street view images located on streets are assigned to the nearest urban block based on proximity. Figure 7 displays the summer and winter street view images from different positions within the same block, illustrating not only the impact of seasonal changes on the visual environment of the blocks but also revealing the environmental diversity of urban landscapes within different positions of the area.\nExperiments\nMotif Distribution Discovery Figure 8a shows the most similar motif patterns in each block within the motif distribution discovery module, where orange represents blocks with lower income segregation and green indicates higher income segregation. Figure 8b shows local subgraph structures in Gs that closely match specific motifs. Observations reveal that lower income segregation blocks typically show a band-like distribution, whereas higher income segregation blocks exhibit centralized clustering. These patterns are confirmed by the motif analysis in Figure 4 of the main text."}]}