{"title": "Parsing altered brain connectivity in neurodevelopmental disorders by integrating graph-based normative modeling and deep generative networks", "authors": ["Rui Sherry Shen", "Yusuf Osmanl\u0131o\u011flu", "Drew Parker", "Darien Aunapu", "Benjamin E. Yerys", "Birkan Tun\u00e7", "Ragini Verma"], "abstract": "Many neurodevelopmental disorders can be understood as divergent patterns of neural interactions during brain development. Advances in neuroimaging have illuminated these patterns by modeling the brain as a network structure using diffution MRI tractography. However, characterizing and quantifying individual heterogeneity in neurodevelopmental disorders within these highly complex brain networks remains a significant challenge. In this paper, we present for the first time, a framework that integrates deep generative models with graph-based normative modeling to characterize brain network development in the neurotypical population, which can then be used to quantify the individual-level neurodivergence associated with disorders. Our deep generative model incorporates bio-inspired wiring constraints to effectively capture the developmental trajectories of neurotypical brain networks. Neurodivergence is quantified by comparing individuals to this neurotypical trajectory, enabling the creation of region-wise divergence maps that reveal latent developmental differences at each brain regions, along with overall neurodivergence scores based on predicted brain age gaps. We demonstrate the clinical utility of this framework by applying it to a large sample of children with autism spectrum disorders, showing that the individualized region-wise maps help parse the heterogeneity in autism, and the neurodivergence scores correlate with clinical assessments. Together, we provide powerful tools for quantifying neurodevelopmental divergence in brain networks, paying the way for developing imaging markers that will support disorder stratification, monitor progression, and evaluate therapeutic effectiveness.", "sections": [{"title": "1 Introduction", "content": "The human brain can be viewed as a network with complex connections between regions, which undergoes radical transformations to support increasingly sophisticated cognitive, social, and motor skills, all while maintaining relatively low metabolic costs. Many neurodevelopmental disorders, including autism spectrum disorder (ASD), attention deficit hyperactivity disorder (ADHD), and schizophrenia, have long been linked to divergent patterns in brain networks manifesting as a variety of cognitive and behavioral symptoms. Facilitating the quantification of individual-level neurodivergence in brain networks is expected to transform clinical decision-making and parse heterogeneity in neurodevelopmental disorders, thereby making targeted therapeutics a reality.\nAdvances in neuroimaging, especially diffusion MRI (dMRI) tractography, have enabled in vivo reconstruction of the brain's structural connectivity networks, with nodes representing brain regions and edges denoting white matter connections. This progress has led to a surge of studies investigating structural network patterns in neurodevelopmental disorders, predominantly utilizing a case-control paradigm that focuses on group average differences between neurodivergent cohorts and matched neurotypicals. While these studies have provided considerable insights into network changes associated with symptoms of neurodivergent disorders and have strengthened the hypothesis that brain networks are affected, their design inherently overlooks individual differences, treating them as mere noise. Consequently, for the purposes of precision medicine, this approach is inadequate as most neurodevelopmental disorders exhibit high heterogeneity in various developmental stages, diverse clinical presentations and underlying mechanisms As a result, group-based approaches often yield inconclusive findings, such as reports of both hypo- and hyper-connectivity in ASD. In this work, we focus on creating individual-level markers of neurodivergence.\nA major roadblock in creating individualized markers is that the heterogeneity of neurotypical development needs to be comprehensively captured, such that the degree of divergence can be quantified robustly. Normative modeling approaches have emerged to facilitate the characterization of the neurotypical trajectory and provide statistical inference at the individual level. Much like growth charts in pediatric medicine, which compare a child's body measurements to typical age-specific variability, a normative model of brain development characterizes neurodivergent individuals"}, {"title": "2 Results", "content": "In this study, we address two primary questions: Firstly, can the BRIDGE model effectively characterize the transformations of structural brain networks during neurotypical development? Secondly, how does divergence from the neurotypical trajectory relate to neurodevelopmental disorders, such as autism? We use two datasets to investigate these hypotheses: the Philadelphia Neurodevelopmental Cohort (PNC) that includes 968 typically developing children (TDCs), and the Center for Autism Research (CAR) cohort which contains 196 TDCs and 229 children with diagnoses of autism spectrum disorders (ASDs)."}, {"title": "2.1 Overview of BRIDGE framework", "content": "As shown in Fig. 1, the structural network is represented by a connectivity matrix, where nodes correspond to 100 brain regions defined by the Schaefer atlas and connectivity strength is derived from the number of streamlines connecting each pair of regions, obtained through dMRI tractography. The details of data processing and network definition are described see the Methods section. The core architecture of BRIDGE is a variational graph autoencoder , which takes vectorized structural networks (the upper triangular part of the matrix) as inputs, encodes them into lower-dimensional latent features, and outputs both the predicted brain age and the generated brain networks corresponding to that age from the latent features.\nTo guide the generation of brain networks, we incorporate two wiring principles from neuroscience domain knowledge into the decoder: the cost minimization rule and the Hebbian learning rule. The cost minimization rule, considered as one of the fundamental driving factors during the development of brain networks, posits that the probability of forming connections between node $v_i$ and node $v_j$ decreases exponentially with the length of the connection $D_{v_i,v_j}$, with the strength of this effect controlled by a learnable parameter $\u03b7$. The Hebbian learning rule , as evidenced in both synaptic and myelinated connections , dictates that nodes sharing similar firing configurations are more likely to be connected, which can be formulated using a inner product < $X_{v_i}$, $X_{v_j}$ > with the latent nodal configuration $x_{v_i}$ and $x_{v_i}$ inferred by GCN. The overall probability $P_{v_i,v_j}$ of forming connections between node $v_i$ and node $v_j$ can be formulated as\n$P_{v_i,v_j} \\propto e^{-\\eta D_{v_i,v_j}} \\sigma(<X_{v_i}, X_{v_j}>) $\nwhere $\u03c3(\u00b7)$ represents a non-linear sigmoid function for positive probability values.\nThe above wiring rules encourage the adaptation of network topology to support various brain capabilities while being constrained by the material and metabolic costs"}, {"title": "2.2 Developmental features are most effectively captured through BRIDGE' brain age predictor", "content": "The latent features $z_i$ of BRIDGE encode age-related changes in brain networks in a relatively low-dimensional space, which can be then used for brain age prediction given any structural network $A_i$. Fig.2 shows a two-dimensional visualization of the posterior mean of latent features $z_i|A_i$ using t-SNE for each participant in the PNC and CAR datasets, with the color of dots indicating chronological age. For illustration, we average $z_i$ across TDCs in each age group to create the average trajectory for that age, represented by black dashed lines. The encoded latent features reveal a clear age-related trend in both datasets, suggesting that age-related characteristics are well captured."}, {"title": "2.3 Network-based patterns are most successfully characterized via BRIDGE's brain network generation", "content": "We then investigate whether the latent features successfully encode network-based patterns, enabling the generative models to produce brain networks that share similar properties with the observed networks. To evaluate this, we use an energy function (Eq.3 in the Methods section) that commonly adopted in previous studies to measure the dissimilarity between the generated and observed brain networks . Lower energy values indicate that the generative models better fit the observed network data. For each subject in the testing set, we first generate 100 brain networks using the various generative models described in the Methods. The average energy across these 100 generated networks is then calculated for each model.\nAs shown in Fig.4, BRIDGE achieves the lowest energy in both datasets irrespective of diagnostic status, followed by GCN-VAE and the matching index model. We perform a one-way repeated measures ANOVA comparing these top three models. BRIDGE demonstrates significant improvement in fitting structural brain networks for both PNC (F(2,1934) = 2628.7572, p < 0.001) and CAR (TDC: F(2,390) = 648.3380, p < 0.001, ASD:F(2,456) = 403.7301, p < 0.001) cohorts. We repeat the"}, {"title": "2.4 Individualized region-wise neurodivergence maps capture heterogeneity in autism", "content": "Autistic children exhibit divergent developmental patterns in their brain networks. Figure 5A illustrates how the brain networks of TDC and ASD individuals are encoded in the latent features of BRIDGE. Blue dots represent TDC samples, while red 'X' marks indicate ASD samples. We fitted a Gaussian process regression using the TDC samples to create the neurotypical trajectory across various chronological ages, as visualized by the blue line, which is enveloped by a shaded area representing the 95% confidence interval. Our results show that neurogypicals predominantly fall within this"}, {"title": "2.5 Neurodivergence scores of structural networks are correlated with autistic traits", "content": "Given that these latent features predict brain age, divergence from the neurotypical trajectory can lead to a gap between the predicted brain age and the chronological age. In this section, we investigate how the gap between predicted brain age and"}, {"title": "3 Discussion", "content": "This study presents a pioneering BRIDGE framework that combines normative modeling with bio-inspired deep generative models 1) to characterize the variability in neurotypical brain network development, making it the first normative modeling framework that encodes brain networks, thereby 2) to quantify individual-level developmental differences from the neurotypical trajectory, providing a set of network-based markers for neurodivergence."}, {"title": "3.1 Characterization of structural brain networks in neurotypical development", "content": "Structural brain networks are graph-structured and exhibit highly complex interdependent topological properties in their connections. This complexity necessitates encoding structural networks into lower-dimensional latent features, enabling normative modeling to more effectively capture the neurotypical variability of brain network development in the latent space. We conduct two experiments to determine if the latent features accurately characterize structural networks in neurotypical development. The first experiment involves predicting brain age to assess whether these features preserve essential biological information related to development. The second experiment focuses on generating brain networks from the latent space to ensure that network-based patterns are retained.\nThe brain age prediction results presented in Section 2.2 demonstrate that deep learning-based models can capture intricate patterns in brain networks in a data-driven manner, yielding improved performance compared to traditional regression models. Among all the models tested, BRIDGE exhibits the best performance by uniquely integrating three components: a variational autoencoder (VAE) framework, graph convolutional layers, and bio-inspired wiring constraints. Our ablation study, which removes each component from BRIDGE, underscores the significant contributions of"}, {"title": "3.2 Quantifying individual-level neurodivergence in structural brain networks", "content": "Most studies on structural brain networks adopt a case-control paradigm, focusing on identifying group-level statistical differences between controls and clinical groups or performing binary classification using machine learning and deep learning models. While this approach may be suitable for homogenous clinical groups, it is inadequate for neurodevelopmental disorders such as ASD, where striking heterogeneity has been observed . Accurate stratification while capitalizing on individual-level variability is at the heart of developing targeted interventions for precision medicine. Normative modeling is suitable for this purpose, where biological variations in structural brain networks are characterized with a large neurotypical cohort, and individual-wise markers can be captured by their divergences from the established neurotypical range.\nWe create subject-specific maps in Section 2.4 to quantify region-wise neurodevelopmental divergence. In line with previous discoveries , autistic children"}, {"title": "3.3 Other potential applications", "content": "In addition to the applications highlighted in this study, BRIDGE can serve as a tool for data augmentation, particularly when addressing issues like limited sample sizes or imbalances in samples across different ages. While data augmentation is widely adopted to bolster the robustness and generalization of deep learning models , there are only a handful of studies that augment brain network data . The BRIDGE model, grounded in well-recognized wiring principles, presents an innovative approach to generating brain networks that closely resemble the observed structural networks and match desired age distributions, ensuring that the augmented data retains biological relevance. Furthermore, with minor modifications to its predictor, the BRIDGE"}, {"title": "3.4 Limitation and future steps", "content": "This study has several limitations. First, the current BRIDGE model only utilizes connectivity information from dMRI. Incorporating additional features, such as white matter integrity from dMRI, anatomical features from structural MRI, or genetic factors at the nodal or edgewise levels, would be beneficial. This would enable the model to encompass multiple modalities and derive latent features from a broader spectrum of characteristics relevant to the development of brain networks. Second, given substantial differences in brain networks across demographics such as sex, ethnicity, and socioeconomic status , separate normative models may be necessary for different population groups. While this would require considerably more data, it would enhance the diversity and inclusiveness in medical research, ultimately promoting health equity.\nAdditionally, despite employing pre-training techniques in this study, it is important to acknowledge that our model's training and fine-tuning processes are limited by the use of single-site data. As a result, the derived measures may exhibit site-specific biases. Recent advancements in harmonization and domain adaptation algorithms indicate the promising avenue for mitigating site-related variations in neuroimaging data. These advancements could facilitate the development of generative and normative models with enhanced generalizability through data integration."}, {"title": "4 Methods", "content": ""}, {"title": "4.1 Datasets", "content": ""}, {"title": "4.1.1 PNC dataset", "content": "The Philadelphia Neurodevelopmental Cohort (PNC) contains 968 TDCs (425 males, 543 females) aged 8-22 years (mean=15.32, SD=3.45) at enrollment. DTI data are acquired on a single 3T Siemens TIM Trio whole-body scanner using a twice-refocused spin-echo (TRSE) single-shot EPI sequence. The sequence consists of 64 gradient directions with a b-value of 1000 s/mm\u00b2 and 7 scans with a b-value of 0 s/mm\u00b2. Quality assurance (QA) of the images is performed manually and the ones with poor quality are removed."}, {"title": "4.1.2 CAR dataset", "content": "Participants from the Center for Autism Research (CAR) cohort are recruited at the Children's Hospital of Philadelphia (CHOP). A total of 229 ASDs (190 males, 39 females) and 196 TDCs (158 males, 38 females) are included in this study. Ages of both groups range from 6 to 19 years, with mean $\u03bc = 12.46$ and standard deviation $\u03c3 = 2.72$ in the ASD group, $\u03bc = 12.37$ and $\u03c3 = 2.96$ in the TDC group. The two groups do not significantly differ in age. The diagnostic labels are confirmed"}, {"title": "4.1.3 Construction of brain networks", "content": "We first preprocess high-resolution T1-weighted structural images using the FreeSurfer and diffusion-weighted MRI using the MRtrix3 pipeline . White matter integrity such as fractional anisotropy (FA) is calculated for each subject. The T1-weighted images are registered to the FA maps of each subject using rigid followed by deformable SyN registration in ANTs with the deformation constrained to the anterior-posterior direction to correct for the EPI distortions in the diffusion-weighted MRI. We parcellate the brain into 100 regions of interest (ROIs) from the Schaefer atlas. Probabilistic fiber tracking is performed in MRtrix3 using the iFOD2 algorithm with 250 seeds placed at random inside each voxel of the grey-matter white-matter interface (GMWMI). We use an angle curvature threshold of 60\u00b0, step size of 1 mm, and minimum and maximum length thresholds of 25 mm and 250 mm, respectively.\nWe create structural connectivity matrix $A = (a_{mn}) \u2208 R^{100\u00d7100}$ using the number of streamlines intersecting pairwise combinations of brain ROIs. The connectivity strength is then normalized by dividing the number of streamlines by the total GMWMI volume of each subject. Self-connections are removed. Meanwhile, we estimate the geometric distance between each pair of nodes using the mean streamline length of that connection and average across all TDCs in the dataset, which is used to define the cost matrix of each connection."}, {"title": "4.2 Generative network modeling", "content": ""}, {"title": "4.2.1 Classic generative models", "content": "Generative network modeling provides a statistical framework for generating brain connectivity from a set of parameterized wiring rules, with model parameters optimized to minimize the discrepancy between generated and observed data. Starting with a sparse seed network consisting of 35 bi-directional edges that consistently present across all brain networks, the probability of each connection being formed is calculated and new connections are added one at each iteration until the generated network reaches the same density level as the observed network. The wiring probability of each connection has the general form $P_{v_i,v_j} \u221d D_{v_i,v_j}^{\u03b7} K_{v_i,v_j}^{\u03b3}$. In this expression, $D_{v_i,v_j}$ represents the average streamline length (cost) between node $v_i$ and $v_j$, parameterized by $\u03b7$ which controls how much the spatial cost penalizes the probability of forming a"}, {"title": "4.2.2 Deep generative models", "content": "The variational autoencoder (VAE) is a deep generative model that learns a lower-dimensional latent representation of brain connectivity A, allowing it to generate new samples from p(A) without explicit parameterization of the underlying stochastic process. VAE leverages the computational power of neural networks and implicitly learn the complex brain organization in a data-driven fashion, in contrast to classic generative network models that pre-specify features explicitly. In this work, we evaluate 3 VAE-based deep generative models for brain networks, including the VAE with fully connected layers (FC-VAE), the VAE with graph convolutional layers (GCN-VAE), and the proposed BRIDGE model. We utilized the Adam optimizer with a learning rate of 5 \u00d7 10-4, weight decay of 10-4, 200 epochs, and batch size of 64.\nFC-VAE. For each individual, the connectivity matrix A \u2208 RVXV is first represented using its upper triangular elements, denoted by a vector U(A) = (A1,2, A1,3, ..., A1, V, A2,3, ... A2,v, ...Av\u22121,v), where V = 100 ROIs in this work. The encoder e maps the vectorized connectivity matrix to a latent space representation"}, {"title": "4.2.3 Brain age prediction", "content": "To assess whether BRIDGE effectively captures age-related characteristics during development, we compare it with several competitors. In addition to the above-mentioned deep generative models, we also construct brain age predictors using LR-PCA, SVR-PCA, MLP, and 13 linear regressors based on the parameters of each classic generative model. LR-PCA and SVR-PCA first reduce the dimensionality of vectorized brain networks using PCA and then utilize linear or support vector regression, respectively, to estimate brain age from principal components. MLP utilizes a multilayer perceptron with 3 hidden layers to extract features from vectorized brain networks and estimate age, similar to FC-VAE but without reconstructing brain networks. We employ three common metrics to evaluate these brain age predictors, including mean absolute error (MAE), root mean square error (RMSE), and Pearson's correlation (R).\nFor each dataset, we randomly split TDC samples by 3:1:1 for the training, validation, and testing sets. 5-fold cross-validation is conducted to evaluate the performance of brain age estimation. Due to the relatively small sample size in CAR, we utilize the pre-trained model from the PNC cohort and fine-tune it on the CAR cohort to enhance the performance. We report the performance through 5-fold cross-validation for both scenarios, with and without pre-training."}, {"title": "4.2.4 Measurements of model fitness", "content": "To quantify the discrepancy between the generated and observed networks, we adopt an energy function that has been widely used in previous work :\n$E = max (KS_k, KS_c, KS_b, KS_e)$\nwhere each term is a Kolmogorov-Smirnov (KS) statistic that measures network dissimilarity in terms of degree (k), clustering coefficient (c), betweenness centrality (b), and edge length (e) distributions.\nFor the above 13 classic generative models, we utilize the classical Monte Carlo method to solve for the free parameters \u03b7 and \u03b3 for each individual's brain network so that the models can constantly produce synthetic networks with near-minimal"}, {"title": "4.3 Normative modeling", "content": "We first train the generative model with only TDC samples and infer the latent representation for each subject. For each subject, we can derive a normative probability map (NPM) pinpointing region-wise neurodivergence, and an overall neurodivergence score based on the predicted brain age gap."}, {"title": "4.3.1 Normative probability map", "content": "The normative probability map (NPM) quantifies the individual's deviation from the normative range at each brain region. To derive this, we first translate the latent features z into node-wise representation (z' \u2208 RV\u00d71) using the trained generative model. By employing Gaussian process regression , we establish the relationship between chronological age and the typical range of each dimension of the nodal state z' amongst TDC samples. This enables us to predict the expected normative developmental trajectory and the associated predictive uncertainty for any age. For subject s, the NPM is defined as a Z score that quantifies the deviation from the normative trajectory at each region v, formulated as:\n$Z_s = \\frac{z_{vs} - \\bar{z}_{vn}}{\\sqrt{\\sigma_{vs}^2 + \\sigma_{vn}^2}} $\nwhere the deviation in nodal states is normalized by the predictive variance of the test point (\u03c32vs) and the variance of normative data (\u03c32vn) to accommodate the model uncertainty at different brain regions and ages. As the nodal state of that subject $z_{vs} = w_{r_v}z + b_v$ is linearly mapped from latent features z, its predictive variance can be calculated by $\u03c3_{vs}^2 = w_{rv}^T \u03a3w_{rv}$, where $w_{rv}$ and $b_v$ are weights and bias terms, and $\u03a3$ is the estimated variance of latent features obtained from the VAE. The variance of normative data $\u03c3_{vn}^2$ can be obtained directly from Gaussian process regression. We use these subject-specific NPMs to examine how much each subject differs from the typical"}, {"title": "4.3.2 Brain age gap", "content": "As latent features of the brain networks predict the brain age, the deviation from normative trajectory can lead to a gap between the brain age predicted from BRIDGE and the chronological age. We use this predicted brain age gap as the proxy for the overall brain neurodivergence in each individual. We expect that ASD samples show higher brain age gap compared with TDC samples due to atypical development. To evaluate the clinical relevance of the brain age gap captured by our models, we correlate it with IQ and ADOS scores in the ASD population. Due to the sample size imbalance and inconsistency of noise distribution across age groups, an age-related bias is usually observed in predicting brain age, which may lead to overestimation in younger subjects and underestimation in older subjects . To overcome this issue, we apply a simple general linear model to adjust the bias in predicted brain age ."}]}