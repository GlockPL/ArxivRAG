{"title": "Environment-Centric Active Inference", "authors": ["Kanako Esaki", "Tadayuki Matsumura", "Takeshi Kato", "Shunsuke Minusa", "Yang Shao", "Hiroyuki Mizuno"], "abstract": "To handle unintended changes in the environment by agents, we propose an environment-centric active inference EC-AIF in which the Markov Blanket of active inference is defined starting from the environment. In normal active inference, the Markov Blanket is defined starting from the agent. That is, first the agent was defined as the entity that performs the \"action\" such as a robot or a person, then the environment was defined as other people or objects that are directly affected by the agent's \"action,\" and the boundary between the agent and the environment was defined as the Markov Blanket. This agent-centric definition does not allow the agent to respond to unintended changes in the environment caused by factors outside of the defined environment. In the proposed EC-AIF, there is no entity corresponding to an agent. The environment includes all observable things, including people and things conventionally considered to be the environment, as well as entities that perform \"actions\" such as robots and people. Accordingly, all states, including robots and people, are included in inference targets, eliminating unintended changes in the environment. The EC-AIF was applied to a robot arm and validated with an object transport task by the robot arm. The results showed that the robot arm successfully transported objects while responding to changes in the target position of the object and to changes in the orientation of another robot arm.", "sections": [{"title": "1 Introduction", "content": "Active inference, which explains the intelligence of living organisms, has increased the intelligence of various agents. According to the free energy principle, which is the basis of active inference, living organisms minimize their free energy by either changing their actions for sampling the environment or by changing their perceptions for inferring environmental states [7,4,14]. The unique feature of this principle is that changing action, i.e., active inference, is also explained in a unified manner [6,18]. This sensorimotor contingency, in which perception and action are treated in a unified manner, is compatible with agents such as robots because it eliminates actions that are unrelated to perception. Thus, active inference has been implemented in various agents and has contributed to generate intelligent actions [25,3,8,10,12,15,20,23,24,1,2]."}, {"title": "2 Method", "content": ""}, {"title": "2.1 Free Energy Principle and Active Inference", "content": "Living organisms are said to follow the Free Energy Principle (FEP). Living organisms repeat a process of perception and action. Perception is the process of acquiring an observation o from the environment and inferring a hidden state s of the environment. Action is the process of inferring the appropriate policy \u03c0"}, {"title": "2.2 Markov Blanket", "content": "Living organisms are considered to adaptively select their Markov Blankets. The Markov Blanket commonly imagined is the boundary between the living organism's body and its surroundings. However, this is not the only Markov Blanket of a living organism. Living organisms have Markov Blankets as hierarchical structures, such as the boundary between organs and their surroundings, and between cells and their surroundings [5,11,17,19]. Depending on the goal, the appropriate Markov Blanket is selected from among them.\nTo construct an active inference model for the interpretation of intelligent actions of living organisms or the generation of intelligent actions of artifacts, the researcher is required to design a Markov Blanket. For example, in the T-maze problem [6], which is typical of active inference, an active inference model is constructed from a rat, which is an agent with actions (movement in the maze). Observation variables are designed for the two modalities of the rat's exteroception (the rat's position in the maze) and interoception (attraction or"}, {"title": "2.3 Environment-Centric Active Inference EC-AIF", "content": "We propose an environment-centric active inference, EC-AIF, which designs Markov Blankets starting from the environment. Fig. 2 shows the decision process of observation variables o, hidden state variables s, and policy variables in EC-AIF. In EC-AIF, the what and where that guide modality selection in normal active inference [18] are applied to the environment. First, where is defined by considering the environment as the entire observable space. For example, the observable space is simply divided into a grid, and each grid point is defined as where1, where2, and so on. Then, what is enumerated from the observable space, in which where is independently changing. The what includes $what_c$, which is connected to a controller like a robot, and $what_{nc}$, which is not connected to a controller like a ball but the where changes due to robot operations. For $what_c$, those that are connected to a controller are enumerated for each controller. For $what_{nc}$, objects whose where changes with robot manipulation are considered partially independent and thus included. Consequently, a ball that is glued to the robot and whose where always changes with the robot is not included in $what_{nc}$. Observation variables o are then defined by the possible combinations of what and where:"}, {"title": "3 Results and Discussion", "content": ""}, {"title": "3.1 Experimental Setup", "content": "The experiments were conducted with a scene of object transport by a robot. The object is mainly transferred by Universal Robots' 6-axis robot arm UR5e and Robotiq's adaptive gripper 2F-140 attached to the end of the UR5e shown in Fig. 3(a). In this scene, the world is composed of the robot arm UR5e and"}, {"title": "3.2 Change in Target Position for Object Transport", "content": "When the target position is within the reach of UR5e, the path of object transport to the target position by UR5e was obtained in both cases where normal AIF was applied and where EC-AIF was applied. Fig. 5 shows the transition of the selected action when the target position is within the reach of UR5e. In both cases, in timestep 1, an action to move UR5e to P7, where the object was placed, was selected, and then in timestep 2, an action to place the object at the target position, P12 by UR5e, was selected. Fig. 6 also shows the total number of observations of the object when the target position is within the reach of UR5e. In both cases, where normal AIF was applied and where EC-AIF was applied, the values of the object's starting position (P7) and P12 were relatively higher than the other positions, and a route was chosen to transport the object directly from P7 to P12."}, {"title": "3.3 Change in Another Robot's Orientation", "content": "The EC-AIF allowed the object transport route to be adjusted to the direction in which COBOTTA was facing. Fig. 9 shows the motion sequences and the object transport routes when COBOTTA is facing in a different direction from the target position and when it is facing in the direction of the target position."}, {"title": "4 Conclusion", "content": "To handle unintended changes in the environment by agents, we proposed an environment-centered active inference EC-AIF that defines the Markov Blanket of active inference from the environment. In ordinary active inference, the environment is defined from the starting point of an agent that performs \"actions,\" such as a robot or a person, and the agent cannot respond to unintended changes in the environment caused by factors other than the defined environment. In the proposed EC-AIF, the environment is defined as the starting point, and there is no entity equivalent to an agent. Therefore, all states, including robots and people, are included in the inference target and unintended changes in the environment can be eliminated EC-AIF was applied to a robot arm and verified in an object transport task by a robot arm. The results showed that the robot arm successfully transported objects while responding to changes in the target position of the object and changes in the posture of other robot arms. In future work, the design of the generative model will be further refined by considering the mechanism by which each robot's preferences are transferred between robots by extending the change in the robot's trajectory due to another robot's orientation."}]}