{"title": "DRExplainer: Quantifiable Interpretability in Drug Response Prediction with Directed Graph Convolutional Network", "authors": ["Haoyuan Shi", "Tao Xu", "Xiaodi Li", "Qian Gao", "Junfeng Xia", "Zhenyu Yue"], "abstract": "Predicting the response of a cancer cell line to a therapeutic drug is pivotal for personalized medicine. Despite numerous deep learning methods that have been developed for drug response prediction, integrating diverse information about biological entities and predicting the directional response remain major challenges. Here, we propose a novel interpretable predictive model, DRExplainer, which leverages a directed graph convolutional network to enhance the prediction in a directed bipartite network framework. DRExplainer constructs a directed bipartite network integrating multi-omics profiles of cell lines, the chemical structure of drugs and known drug response to achieve directed prediction. Then, DRExplainer identifies the most relevant subgraph to each prediction in this directed bipartite network by learning a mask, facilitating critical medical decision-making. Additionally, we introduce a quantifiable method for model interpretability that leverages a ground truth benchmark dataset curated from biological features. In computational experiments, DRExplainer outperforms state-of-the-art predictive methods and another graph-based explanation method under the same experimental setting. Finally, the case studies further validate the interpretability and the effectiveness of DRExplainer in predictive novel drug response. Our code is available at: https://github.com/vshy-dream/DRExplainer.", "sections": [{"title": "1. Introduction", "content": "The success of drug development significantly influences advancements in modern medicine [1]. However, substantial inter-individual variability in drug responses has led to uncertainties in therapeutic outcomes across clinical settings. In modern medical practice, accurately predicting an individual's specific response while minimizing adverse reactions has become one of the key challenges in achieving personalized medicine and enhancing therapeutic efficacy [2]. Nevertheless, the field of drug response prediction encounters multifaceted challenges. The interplay of genetic diversity and the variation of environmental influences bring uncertainty to drug response prediction [3]. The metamorphosis of drug metabolism and the spectrum of mechanisms of action across individuals generate diverse effects from uniform drug doses, unraveling a series of responses. Coalesced with these genetic traits are the dynamic layers of gene expressions, whose complexity shapes the variability of drug responses.\nParallel with these complexities, traditional prediction methodologies struggle with saving resources, often expensive and time-consuming. In recent years, notable progress in pharmacogenomics has yielded a wealth of genomic data, including gene mutations, copy number variations, gene expression profiles, and extensive datasets on drug sensitivity and resistance across different cancer cell lines [4, 5, 6]. These datasets facilitate the development of computational models that can utilize multi-omics for drug response prediction. Within this condition, the integration of bioinformatics and machine learning opens up fresh research directions for drug response prediction. Previous studies have developed a range of models, including ridge regression [7], support vector machine [8], and transfer learning [9], to leverage available data for quantifying responses based on half-maximal inhibitory concentration (IC50) values. Lower IC50 value indicates drug for sensitivity could confer a significant response to the specific targeted cell line [10]. Conversely, higher IC50 value indicates a lack of significant drug response relationship. While these approaches have demonstrated encouraging performance, they often lack comprehensive incorporation of biological knowledge, constructing predictive models solely reliant on cell line gene expression data. Due to the wealth of available data recently, an increasing number of models are taking into cell line multi-omics along with drug chemical structure features [11, 12, 49].\nThe field of graph-based learning has witnessed rapid-developed interest among researchers, leading to its rapid-developed application in the realm of bioinformatics [13, 14, 50]. Notably, these techniques have demonstrated remarkable utility in understanding complex biological systems. While graph-based learning methodologies have burgeoned across various domains [15, 16], the majority of approaches in drug response prediction have primarily operated within the confines of undirected bipartite networks. For example, Liu et al. utilized a hybrid graph convolutional network and multiple subnetworks for accurate prediction of cancer drug response [17], Liu et al. constructed a graph neural network with contrastive learning to enhance the generalization ability of drug response prediction [18], Zhu et al. proposed a framework consists of twin graph neural network and a similarity augmentation for drug response prediction [19]. Typically, a thorough investigation of drug response demands a separate analysis of sensitivity and resistance. Thus, the necessity to advance algorithms for directed bipartite networks becomes apparent.\nFurthermore, model interpretability has emerged as a critical concern. In clinical practice, stakeholders, including physicians and patients, require not only accurate predictions but also a clear understanding of how and why a model arrives at a specific prediction. Many high-performing deep learning models, such as deep neural networks, are often regarded as \"black boxes\", impeding their interpretability [20]. Recently, several approaches have been proposed to explain the predictions based on graphs since graph neural networks have become increasingly popular [21, 22]. This interpretability improves their adoption and trustworthiness in critical medical decision-making. Current efforts to enhance the interpretability of drug response prediction models predominantly rely on algorithms designed for homogeneous networks [23]. For example, researchers explored methodologies for identifying and ranking the most influential features or nodes within homogeneous networks. Huang et al. designed a nonlinear model to explain the node in the subgraph, computing the k most representative features [24]. Vu et al. proposed a probabilistic graphical model to identify the crucial nodes and the dependencies of explained features in the form of conditional probabilities [25]. There are also explanation methods that identify exiting links in the network to explain the predicted links based on gradient or mutual information, such as GNNExplainer [26] and ExplaiNE [27]. Some studies delved into the identification of significant pathways and modules within homogeneous networks. However, there is a significant absence of interpretability methods tailored for directed bipartite networks. Additionally, the absence of standardized approaches that can evaluate the level of interpretability across various methodologies hampers the rigorous assessment of interpretability.\nEvaluation of interpretability algorithms, a crucial task, aims to ensure that the predictions generated by the model are fully comprehensible to both the scientific community and clinical practitioners. However, the current evaluation of interpretability algorithms faces certain limitations and challenges. Existing evaluation methods primarily focus on qualitative assessment [28], lacking a universal set of quantitative metrics to measure the quality and effectiveness of interpretability [29]. In this regard, constructing a reliable ground truth is crucial. By establishing a truthful and credible ground truth, we can evaluate the accuracy and rationality of the interpretability algorithms concerning the model predictions. This construction process necessitates the integration of extensive domain knowledge and empirical evidence [30]. This integration enables an objective assessment of explainable algorithms' strengths and weaknesses [31]. For example, taking into account the pathogenic mechanisms of cancer and cancer genes within the biomedical domain serves to promote their practical applications. In the realm of drug response prediction, considering interpretability algorithms that incorporate insights into prior knowledge and domain knowledge is particularly vital. Such consideration not only rationalizes the prediction outcomes but also enhances the applicability of interpretability algorithms in clinical practice.\nIn this study, we have delved into a novel drug response prediction approach that addresses the pressing challenges in the field of current drug response prediction. Our main contributions are summarized as follows:"}, {"title": "2. Materials and Methods", "content": "Our study leveraged a combination of diverse data sources, carefully curated to ensure the comprehensiveness and accuracy of the information used in our research. This study mainly involves two databases, Genomics of Drug Sensitivity in Cancer (GDSC) [32] and Cancer Cell Line Encyclopedia (CCLE) [4]. CCLE stands as a rich repository of diverse cell lines' multi-omics data, including genomics, transcriptomics, proteomics, and epigenomics. However, it's essential to note that the CCLE dataset is relatively limited in terms of drug response data. In contrast, GDSC primarily focuses on capturing drug response information, offering a valuable collection of drug sensitivity and resistance profiles across a diverse spectrum of cancer cell lines. So, we harnessed the multi-omics profiles, which encompass gene expression, gene mutation, and copy number variation, from the CCLE dataset. Simultaneously, we collected response scores of IC50 values (natural log-transformed) from the GDSC dataset. In subsequent experiments, we used IC50 values as a measure of sensitivity.\nFollowing meticulous data collection, we obtained 986 cell lines, 358 drugs and a total of 295992 drug response data. During the sequencing and data collection of cell lines, it is common to encounter missing values. To optimize data richness, our focus was on including cell lines that possessed the three omics data types (i.e., gene expression, gene mutation and copy number variation). In order to thoroughly investigate the cancer-related mechanisms within drug response, we conducted preprocessing of the cell line omics data. Specifically, we retained the gene of cell line omics data mentioned in the COSMIC Cancer Gene Census [33]. And the three omics data types were ultimately represented as vectors with dimensions of 674, 689 and 480, respectively. Regarding drug data, we downloaded the SMILES strings of related drugs from PubChem [33] and DrugBank [34] datasets. It is crucial to acknowledge that not all drugs are encompassed within these two databases. After the collection of 157 drugs, we employed the ConvMolFeaturizer method in the DeepChem library [35] to compile each drug's SMILES string into a molecular graph. In this representation, nodes and edges correspond to chemical atoms and bonds, respectively. This systematic conversion enables a structured and graph-based representation of each drug's molecular composition.\nAfter rigorous preprocessing and data alignment, our experiment involved a curated dataset encompassing 477 cancer cell lines and 157 drugs. As mentioned above, we utilized IC50 values to measure the response between cell lines and drugs in this study. To categorize drug responses, we implemented two threshold values based on the IC50 values. Instances with IC50 values < -3 were classified as sensitive responses, whereas those with IC50 value > 3 were regarded as resistant. In a subsequent phase of our study, we compiled an expansive dataset featuring 17,071 drug responses, comprising 1,000 instances classified as sensitive and 16,071 as resistant. Specifically, we conducted the intricate drug response relationships within a directed graph framework, employing two adjacency matrices for representation. One adjacency matrix denoted sensitivity, where a value of 1 indicated a sensitive response, while the other matrix denoted resistance, with a value of 1 signifying a resistant response."}, {"title": "2.2. Predicting drug response", "content": "As depicted in Figure 1, our method, denoted as DRExplainer, is structured into three following modules: (A) the predictor, (B) the explainer, and (C) the evaluator. And module (A) predictor consisted of three main parts. Firstly, integrate the multi-omics profiles of cancer cell lines via deep neural network (DNN) layers and extract drug characteristics from the molecular graphs via graph neural network (GNN) layers. Subsequent to the integration, a directed bipartite network was constructed, synthesizing information from cell line similarity network, drug similarity network and cell line-drug directed network.\nExploiting the directed graph neural network, we updated the node representation within this network, aggregating both neighborhood information and multi-relational information. In the last period, we made predictions by DistMult decoder [36] using the updated embeddings. Next, on the basis of the prediction, we devised an explainer to explain the prediction, aiming to understand the prediction, which was useful and vital in clinical research scenarios. Thereafter, a specific evaluator was adopted to assess whether the explanation was reasonable by comparing it with the pre-established ground truth benchmark dataset. The details of the explainer and evaluator will be described in Section \"Explaining the prediction\" and Section \"Constructing ground truth and Evaluating\".\nInspired by the research of [17], we employed omics-specific neural network layers to integrate multi-omics data, aiming to achieve distinctive representation for each cancer cell line. A full depiction of a cancer cell line's multi-omics data including gene expression, gene mutation and copy number variant feature vectors denoted by ce, cm, cn. These vectors were subsequently transformed into an F-dimensional vectorial embedding, as formulated in the equation:\nc = gc {[ge (ce) ||gm (cm)|| gn (cn)]},                                                                                               (1)\nwhere c\u2208 RF denoted the representation of a cancer cell line, || standed for the vector concatenation operator. The term {gc, ge, gm, gn} represents various neural network layers designed for feature transformation. Considering a set of cancer cell lines C = {c}1, where Nc indicated the number of cell lines, all cancer cell line representations were ultimately obtained as C \u2208 RNc\u00d7F to be used in subsequent modeling.\nAs described above, drugs were treated as molecular graphs, with nodes representing atoms and edges denoting the chemical bonds between them. The molecular graph of a specific drug was represented as Ga = (Xa, Ad), where Xd \u2208 RNa\u00d7Fd was the node attribute matrix representing atomic vectors (Fa = 75), and Ad \u2208 RNa\u00d7Na was an adjacency matrix mapping chemical bonds between atoms. Here, Na signified the count of atoms within the molecular graph of drug d. In this study, we leveraged a graph neural network (GNN) encoder, symbolized as 4, to capture the latent representation of atom nodes. Given a set of drugs D = {di}, where No denoted the total number of drugs, we engaged the GNN encoder & to extract a comprehensive representation D\u2208 RNDXF of all drugs for the following modeling.\nBuilding on the premise that cell lines with similar properties exhibit comparable drug sensitivities [37, 38], we regarded the similarity between cell lines and drugs as attributes of the cell lines and the drugs to infer drug sensitivity. Hence, we computed the similarity among cell lines and drugs, relying on the representations acquired in the section \"Node representation module\". These similarities were quantified using cosine similarity, which performed pairwise global alignment among cell lines or drugs. The cell line-cell line similarity and the drug-drug similarity network were denoted by the matrices S = [S] \u2208 RexNe and Sd = [S4] \u2208 RNaNa, respectively. Here, S and S. quantified the pairwise similarities between cell lines ci and cj, and between drugs di and di. The total number of cell lines and drugs were denoted by N, and Nf. In this investigation, we employed cosine similarity to measure the similarity among cell lines or drugs, with the similarity score represented as cos sij, which evaluates the degree of similarity between cell lines ci and ci or drugs di and dj. The cosine similarity was calculated as follows:\nCOS Sij\n=\nCOS (Xi, Xj\n(Xi, Xj\n=\nXiXj\nXiXj\n(2)\nwhere xi and xi represented the feature vectors of entity i and j, respectively. To reduce the negative effect arising from apparent similarity data, we introduced a threshold, denoted by y, to constrain the distribution of the similarity data. Specifically, we retained only similarity values where \u03c6 > 0.9 for cell lines and 4 > 0.88 for drugs, thereby focusing on the most significant relationships. Hence, the similarity matrix can be obtained as follows:\nSij = {1, if cos sij \u2265 \u03c60, otherwise,        (3)\nThe directed bipartite network contained diverse types of relationships between distinct nodes. To more effectively integrate neighborhood information and capture the network structure, drawing inspiration from Schlichtkrull et al."}, {"title": "2.2.3. Directed graph convolutional neural netwrok", "content": "[39], we proposed the directed graph convolutional neural network for the enhancement of node representations. Within this framework, we leveraged the directed edges for the propagation and aggregation of information, respecting the directional flow inherent in biological and chemical entities. Our model iteratively updated node representations within the directed multi-graphs as G = (V, E, R), where V represented the set of vertices, & consisted the set of edges and R signified the set of relations. As mentioned in the previous section, the directed heterogeneous network encompassed cell line-cell line similarity, drug-drug similarity, cell line-drug sensitive interaction, and drug-cell line resistant interaction. Consequently, the directed multi-graphs were characterized by four distinct types of edges. Then, G can be further expressed by a set of adjacency matrices A = {A} and node attributes X \u2208 [R|v|\u00d7F, where A\u2081 and A2 corresponded to the sensitivity and resistance matrices discussed in the Section \"Materials\", A3 and A4 equate to S and Sd mentioned in the Section \u201cCell line and drug similarity\", respectively, and X =\nCD\n\u2208 R(Nc+ND)\u00d7F (i.e., the previously learned representations of cell line, C, and drugs D, were combined as X).\nIn this paper, we utilized triples (subject, relation, object) to represent the drug response facts. Employing the directed graph convolutional neural network as an encoder, we updated the feature representation of the subject and object nodes. Motivated by the architecture [39], we formulated the subsequent straightforward layer-wise propagation model to facilitate the computation of the forward-pass update for a node denoted by v; within the directed multi-graphs:\n\u03c3(l+1)vi = \u03c3(\u03a3r\u2208R1NrvicrW(l)r X(l)vj+W(l)0X(l)vi)                (4)\nwhere X \u2208 RF represented the feature matrix of node vi at the l-th layer with F(1) being the dimensionality of the layer, N designated the set of neighbor indices for node v\u2081 that were associated through relation r \u2208 R,W and W were trainable weight matrices at the l-th layer, and o refered to the sigmoid activation function. According to formula (4), the feature representation of each node within the graph can be updated in parallel. Thus, we implemented a two-layer DGCN model to update the node representation. Subsequently, we introduced a decoder (scoring function) f(s, r, o), which assigns scores to assess to evaluate how likely the edges (s, r, o) being factual in the following section."}, {"title": "2.2.4. DistMult decoder", "content": "Taking the final cell line and drug embedding learned by the encoder as input, we introduced DistMult factorization [36] as a decoder to work out the link prediction. By processing triples of the form (subject, relation, object), DGCN captured the inherent structure and relational context of the graph, thus providing a robust foundation for the subsequent decoding process.\nThe DistMult model operated on the assumption that the probability of a factual relationship between entities can be estimated through a simple bilinear form. In this model, each relation type r was associated with a trainable diagonal matrix N, \u2208 Rd\u00d7d, effectively reducing the number of relation parameters. For a given triple (s, r, o), the DistMult decoder calculated a score representing the probability of this triple being factual. The score is computed as follows:\nf(s, r, 0) = \u03c3 (XNs, Xo),                                                      (5)\nRegarding the model's overall architecture, DRExplainer can be characterized as I learning a conditional distribution Po(r | A, X). As in previous work on factorization [40], we trained the model with negative samples. The positive samples in the training set were often randomly corrupted to generate negative samples. This approach will result in the generated negative sample being consistent or paradoxical with the positive sample. Inspired by Rossi et al. [41], we generated negative triples by treating the unutilized data in the data space as negative samples. To enhance model performance, we employed cross-entropy loss optimization, aiming to encourage the model to assign higher scores to observable triples compared to negative ones. The loss function was mathematically expressed as:\nL = \u22121T\u2211(s,r,o,y)\u2208T(ylogl(f(s,r,o))+(1\u2212y)log(1\u2212l(f(s,r,o)))),                                          (6)\nwhere T represented the training set comprising both real and artificially generated negative triples, and l denoted the logistic sigmoid function. Additionally, y served as a binary indicator where y = 1 corresponded to positive triples and y = 0 to negative ones."}, {"title": "2.3. Explaining the prediction", "content": "Currently, investigating the interpretability of models using graph convolutional architectures has received increasing attention in graph representation learning [23]. Drawing inspiration from Ying et al. [26], we developed DRExplainer to generate explanations for drug response prediction in the bipartite network. DRExplainer can explain prediction by seamlessly integrating both graph structure and node feature information. Initially, we meticulously generated ground truths data for individual drug response pairs, leveraging biological prior knowledge. The methodology for constructing ground truths was detailed in the Section \"Constructing ground truths and Evaluating\". Our analysis prioritized explanations based on linked pairs, as opposed to unlinked pairs. We posited that such positive explanations yield greater insight, particularly in the context of biological networks, compared to negative explanations.\nDRExplainer concentrated on the identification of the most relevant subgraphs within the directed bipartite network by learning a mask over the input adjacency matrix. The method involved minimizing the cross-entropy between the predicted label using the original input adjacency matrix and the predicted label derived from the adjacency matrix after applying the mask. This approach enhanced the comprehension of influential substructures within the network. The objective function minimized by DRExplainer was as follows:\nminM\u2212\u2211Ri=11[r=i]logP\u03b8(r|Ai\u2299\u03c3(M),X),                                                                   (7)\nwhere M was the mask to be learned, 1 denoted the indicator function and \u2299 symbolized the element-wise multiplication applied to \u03c3(M) and the adjacency matrix A\u2081. Subsequently, we applied a threshold to the product to filter out the low-value elements. This process complicated the extraction of the explanatory subgraph Gs."}, {"title": "2.4. Constructing ground truths and evaluating", "content": "While increasing research focuses on interpretability evaluation [42, 43], an evaluation framework for explaining bipartite network interactions remained underdeveloped. We were advancing a quantifiable paradigm for interpretability and devising a corresponding evaluation algorithm. To establish a robust framework for evaluation, our efforts concentrated on creating a definitive ground truth dataset.\nThe construction of a reliable ground truth for drug response relationships was a fundamental step in developing predictive models for personalized medicine. Our proposed method was built on the premise that cell lines with similar characteristics exhibit comparable drug sensitivities [37, 44]. We leveraged the interactions between entity similarity within the directed bipartite graph network to model the evaluation framework, as illustrated in Figure 2.Figure 2 depicts three robust strategies to establish ground truths for the interaction between a specific drug (node 6) and a target cell line (node 1). Line segments in Figure 2 represented entity similarities as defined in the Section \u201cCell line and drug similarity\", while directed arrows indicated the directional drug response. For clarity, our methodology differentiated cell lines and drugs using circular and triangular nodes, respectively. The details of our methodologies are described below:"}, {"title": "3. Results", "content": "Our study advanced the field of drug response prediction by introducing a model capable of distinguishing the directionality of responses, including sensitivity, resistance and non-significant interaction. To underscore the robustness and generalizability of our model, we meticulously designed a data separation strategy, as summarized in Table 2. The table outlined four distinct tasks, each with a unique distribution of drugs and cell lines within the test dataset. TaskA was the conventional experimental setting, predicting the novel responses with a test dataset composed of known drugs and cell lines. TaskB and TaskC evaluated the model's capacity with novel cell lines and drugs, respectively. TaskD represented the most stringent test, where both drugs and cell lines in the test dataset are new to the model.\nEach task was rigorously tested using a 5-fold cross-validation to ensure the robustness and reliability of our findings. And Schlichtkrull et al. [39] have proved that incorporating inverse relation pairs is an effective solution for improving the model performance. Thus, we augmented our dataset by extending each triplet pair with corresponding inverse edges after data separation. This procedure ensured the absolute segregation of the training and test datasets, maintaining the fairness of our model evaluation.\nFigure 3 delineated a comparative assessment of our model's inductive capability across four distinct experimental tasks, which were designed to rigorously test the model's predictive accuracy in various scenarios. Each task's performance was illustrated via the Receiver Operating Characteristic (ROC) curve, providing insight into the model's performance. TaskA adopted a traditional experimental setting, utilizing a test dataset composed of known drugs and cell lines to predict novel responses. And TaskA achieved the highest Area Under the Curve (AUC), indicating robust predictive ability within known entities. This setup served as a benchmark for the model's performance under familiar conditions. In the analysis of inductive capability concerning cell lines and drugs, depicted in Task B and Task C, the performance of DRExplainer for cell lines exhibited a modest decline compared to drugs. This discrepancy may stem from the truth that cell lines share similar genetic information while chemical structures of drugs can be diversified. TaskD, while presenting the most challenging conditions, still showcased considerable predictive performance, albeit lower than the other tasks. Together, the AUC results across all tasks underscored the model's robust inductive capability, highlighting its potential utility in real-world clinical settings."}, {"title": "3.1. Experimental design", "content": "To verify the effectiveness of our model DRExplainer, we conducted comparative analyses against several established machine learning algorithms, including support vector machine (SVM), random forest (RF), and XGBoost. In order to illustrate the superiority of our model proposed in this study, we also benchmarked against three state-of-the-art (SOTA) algorithms: MOFGCN [11], DrugCell [31], and TGSA [19], and the latter two of which were extensively discussed in the literature [14]. Each algorithm underwent a five-fold cross-validation experiment on our dataset for a comprehensive performance assessment.\nFigure 4 presented the comparative results of machine learning approaches, focusing on the Area Under the Precision-Recall Curve (AUPR) and the Area Under the Receiver Operating Characteristic Curve (AUC). To elucidate the findings in the figure, we reported the results of the best performing fold. The outcomes demonstrated that our model consistently surpassed the comparative algorithms, achieving the highest scores in both AUPR and AUC metrics. The performance analysis revealed that conventional machine learning algorithms frequently encountered difficulties when processing a large amount of data and complex associations [45], which contributed to their suboptimal performance relative to our model. To rigorously assess the efficacy of our model, we compared our method with the following SOTA methods.\n\u2022 MOFGCN employsed multi-scale network integration to model the complex interactions between drugs and cell lines, leveraging the chemical properties of drugs and genetic attributes of cell lines for informed analysis."}, {"title": "3.2. Predicting method comparison", "content": "Conversely, our model exhibited sensitivity to learning rate as depicted in subgraph (B) of Figure 6. A sharp decline in performance at both high and low learning rates signifies that the learning rate was a critical parameter that"}, {"title": "3.3. Parameter sensitivity analysis", "content": "In this section, we conducted a thorough parameter sensitivity analysis to further study the influence of parameters on our model performance. Through grid search methodology, DRExplainer achieved the best results with batch size of 256, learning rate of 0.001, embedding dimension of 64 and the training epoch of 5000. Therefore, we used these optimal hyperparameters as the default configuration for subsequent sensitivity analysis of individual hyperparameter. This experiment was rigorously validated by a five-fold cross-validation framework, leveraging AUC and AUPR as the principal performance metrics. The comprehensive sensitivity analysis of our model was illustrated in Figure 6.\nSpecifically, subgraphs (A), (C), and (D) of Figure 6 showed marginal variations in AUPR and AUC in terms of batch size, embedding dimension and epoch. This suggested that the model's generalization ability was not substantially dependent on these parameters. Such stability was indicative of our model's ability to maintain good performance, even varying in batch sizes, feature representation complexity, and training epochs."}, {"title": "3.4. Evaluating the explanation", "content": "Interpretability is crucial in predictive modeling, especially in predicting drug responses, where comprehension of the underlying mechanism is as vital as the prediction itself. To further assess the interpretability of our DRExplainer, we conducted comparative experiments with another graph-based method, ExplaiNE. These evaluations were conducted on our curated ground truth benchmark dataset, providing a rigorous basis for testing the explanatory power of each model.\nExplaiNE was employed to evaluate the impact of small alterations in the adjacency matrix on the scoring function, by computing the gradients of the model's scoring function concerning the adjacency matrix. The gradient computation allowed for the identification of critical edges in the network that significantly influenced the model's prediction. Specifically, consider a scenario involving pairs of nodes (i, r, j) for potential prediction and pairs (k, r, l) for candidate explanation. Within this framework, a specific score was allocated to the node pair (k, r, l) as follows:\ndf(i,r,j)(A)dakl=\u2207X\u2217f(i,r,j)(X\u2217)\u22c5Xdakl(A),(11)\nwhere X* was the optimal embedding for adjacency matrix A, and ak\u0131 denoted an element of the adjacency matrix A. Kang et al. [27] elucidated that the most plausible explanation for a predicted link (i, r, i) involving a node i is often a link (k, r, l) that connected to node i (i.e., where l = i or k = i). This was attributed to the fact that links neighboring node i had a direct influence on the link probability f(i, r, j) through their impact on the node embedding X. Consequently, our analysis focused on the immediate, first-order connections adjacent to the two nodes constituting the interpreted edge. To ensure an equitable comparison, we only consider the first-order neighbors of the nodes of the triple in the subgraph for DRExplainer.\nAccording to Table 3, DRExplainer significantly outperforms ExplaiNE across all metrics, including recall@k, precision@k and f1 @k. The superior performance demonstrates the ability of DRExplainer to capture relevant graph information that contributes to model predictions. The efficacy of DRExplainer can be attributed to its more effective mechanism for identifying and interpreting the complex interactions with the graph data, thereby providing clearer insights into the decision-making processes of graph neural networks. In clinical practice, where the stakes of predictive accuracy and understanding are high, the employment of DRExplainer could be particularly advantageous in elucidating drug response mechanisms in a more comprehensive and precise manner."}, {"title": "3.5. Case study", "content": "In this section, we presented two case studies to verify the effectiveness and interoperability of DRExplainer in drug response.\nIn Case Study 1, We trained DRExplainer with the known cell line-drug responses in the training set, and then assessed its predictions in the test set, which were prioritized by scores. The top 10 sensitive and resistant responses predicted by DRExplainer are illustrated in Table 4. As shown in Table 4, most results can be verified based on the existing literature in PubMed. Here, we took two typical responses for analysis. Notably, OCIAML2 cell line is derived from acute myeloid leukemia and 5-Fluorouracil (5-FU) is a drug that inhibits thymidylate synthase and blocks DNA synthesis, leading to cell growth arrest and death [46]. We predicted that OCIAML2 cell line is sensitive to 5-Fluorouracil drug (5-FU), aligning with findings by Falzacappa et al. that showed significant sensitivity (EC50=3\u00b5umol/L) [48]. Additionally, for human tumor cell lines OCILY19, which was predicted to have a resistant response with the drug Etoposide. This finding is consistent with the study by Gifford et al [47].\nIn case study 2, we employed DRExplainer and ExplaiNE to analyze the top five sensitive and resistant interactions according to the value of f1@k. We compared their outputs with our ground truth dataset to evaluate accuracy and relevance. The explanations, structured as triplets of cell lines, responses, and drugs, were assessed for their alignment with the ground truth. The results in Table 5 indicated that both DRExplainer and ExplaiNE exhibit competent explanatory power for resistant drug response. However, ExplaiNE showed limitations in explaining sensitive responses. For example, while DRExplainer consistently provided credible explanations for the sensitivity of the SKOV3 cell line to 5-FU, ExplainNE failed to find any consistent explanation.\nTherefore, the two case studies demonstrate that DRExplainer could help find out the novel drug response and reveal its inner mechanism."}, {"title": "4. Conclusion", "content": "Nowadays, the heterogeneous graphs encompassing drugs and cell lines have emerged as a powerful tool for drug response prediction. The great potential of the GNN model based on a directed bipartite network has not been fully exploited. For precision medicine, stakeholders demand not only precise predictions but also comprehensive insights into the models' decision-making processes. In this work, we propose DRExplainer, an interpretable directed graph convolutional network for drug response prediction. DRExplainer leverages multi-source bio-entity information to boost model performance. Additionally, we curate a ground truth benchmark dataset specifically to assess the interpretability of the model. The experimental results and case studies demonstrate that DRExplainer is superior to existing state-of-the-art methods in identifying and explaining novel drug responses.\nIn future work, we provide two directions to enhance interpretable drug response prediction: (i) Collect single-cell omics data and apply them to predict drug responses. Single-cell omics offer an unparalleled resolution, enabling the exploration of cellular heterogeneity that often remains concealed with bulk omics techniques. Leveraging these insights, future studies will aim to integrate single-cell data into our directed graph convolutional network model, enhancing its predictive accuracy and interoperability. (ii) Enrich our model by incorporating extensive domain knowledge into constructing ground truth datasets. By integrating comprehensive insights from biological research, such as pathways, gene regulation mechanisms, and cellular interactions, we can significantly improve the fidelity of our predictive models to actual biological processes. This enriched ground truth framework will facilitate the development of a paradigm model in biological issue prediction, establishing benchmarks that blend high predictive accuracy with deep biological understanding. Such advancements are expected to set new standards in the field, propelling forward the capabilities of computational tools in precision medicine and beyond."}]}