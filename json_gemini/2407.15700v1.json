{"title": "A Life-long Learning Intrusion Detection System for 6G-Enabled IoV", "authors": ["Abdelaziz Amara korba", "Souad Sebaa", "Malik Mabrouki", "Yacine Ghamri-Doudane", "Karima Benatchba"], "abstract": "The introduction of 6G technology into the Internet of Vehicles (IoV) promises to revolutionize connectivity with ultra-high data rates and seamless network coverage. However, this technological leap also brings significant challenges, particularly for the dynamic and diverse IoV landscape, which must meet the rigorous reliability and security requirements of 6G networks. Furthermore, integrating 6G will likely increase the IoV's susceptibility to a spectrum of emerging cyber threats. Therefore, it is crucial for security mechanisms to dynamically adapt and learn new attack patterns, keeping pace with the rapid evolution and diversification of these threats - a capability currently lacking in existing systems. This paper presents a novel intrusion detection system leveraging the paradigm of life-long (or continual) learning. Our methodology combines class-incremental learning with federated learning, an approach ideally suited to the distributed nature of the IoV. This strategy effectively harnesses the collective intelligence of Connected and Automated Vehicles (CAVs) and edge computing capabilities to train the detection system. To the best of our knowledge, this study is the first to synergize class-incremental learning with federated learning specifically for cyber attack detection. Through comprehensive experiments on a recent network traffic dataset, our system has exhibited a robust adaptability in learning new cyber attack patterns, while effectively retaining knowledge of previously encountered ones. Additionally, it has proven to maintain high accuracy and a low false positive rate.", "sections": [{"title": "I. INTRODUCTION", "content": "As we enter the 6G era, the landscape of digital communications and interactions is undergoing a profound transformation. This evolution is particularly evident in the Internet of Vehicles (IoV) ecosystem, where the convergence of 6G technology with Connected and Automated Vehicles (CAVs) promises to significantly enhance efficiency, convenience, and user experience. However, this technological advancement is not without its risks. The adoption of 6G in the IoV potentially increases the vulnerability of CAVs to a multitude of emerging cyber threats, making security a major concern for this promising technology [1].\nIn the complex landscape of cybersecurity, Intrusion Detection Systems (IDS) hold a critical role. The transition from traditional signature-based IDS to anomaly-based systems, capitalizing on advancements in artificial intelligence (AI), represents a significant leap forward. This evolution has led to the development of IDS that can detect a wide array of cyber attacks with remarkable precision [2]\u2013[4]. Predominantly, these recent AI-driven IDS rely on deep learning techniques [3], [5], however an inherent limitation of DL: the challenge of incremental learning from continuously evolving data streams, often described as catastrophic forgetting [6]. This challenge is particularly relevant when the system must differentiate between classes that are not observed concurrently. In essence, the IDS must be capable of dynamically adapting to new types of attacks or variations in data patterns that were absent in its initial training dataset. This capability for dynamic learning and adaptability is a critical component for IDS to remain effective in the constantly changing landscape of cyber threats.\nContinual Learning, also known as life-long learning, focuses on acquiring knowledge from a continuous stream of data, aiming to expand this knowledge base without the need for retraining from scratch [6]. This area of ML has grown due to its practical benefits, such as improving medical diagnoses, advancing autonomous driving, and accurately predicting financial trends. Its growth highlights its potential to enhance AI adaptability in diverse real-world situations [6]. However, few studies [7], [8] have investigated the application of continual learning for attack detection, the proposed solutions are not fully suited to the distributed and dynamic nature of the IoV. They rely on a centralized learning model that requires data collection, which raises privacy concerns.\nThis study aims to propose an adaptive IDS capable of learning new attack patterns while retaining those previously learned. We introduce a detection system that combines class-incremental learning (CIL) with federated learning (FL), ensuring adaptability and suitability for the distributed and dynamic environment of the IoV. To enable evolving detection of emerging cyber attacks, our approach integrates the Continual Learning with Experience And Replay (CLEAR) [9] method into our detection model. CLEAR effectively combines direct learning from recent data, ensuring the system remains adaptable, with indirect learning from historical data, enhancing its stability. We train this detection model using FL across local datasets from participating CAVs. In this setup, Multi-access edge computing (MEC) servers play a pivotal role in coordinating the training process by acting as parameter servers for aggregating FL model updates. The effectiveness of the proposed solution is evaluated using the 5G-NIDD [10] dataset, which contains real-world 5G network traffic traces."}, {"title": "II. RELATED WORK", "content": "Recent studies have increasingly focused on enhancing security within Internet of Vehicles (IoV) networks. Abdelwahab et al. [11] conducted a comprehensive study on cybersecurity challenges within the 5G Vehicle-to-Everything (5G-V2X) networks, addressing issues across 5G infrastructure and specific use cases, among other security concerns. Osorio et al. [1] provided a thorough analysis of security and privacy in the 6G-enabled IoV. They explored how key technological en-ablers such as network softwarization, blockchain, and AI/ML enhance secure communication.\nConsidering Artificial Intelligence's role, several studies have harnessed ML/DL to detect and mitigate cyber threats in IoV networks. Rahal et al. [12] delved into botnet threats within IoV networks. They simulated botnet traffic to generate a dataset, subsequently applying various machine learning techniques to detect and analyze botnet traffic. To address the challenges associated with zero-day attack detection in IoV networks, in our previous work [3], we proposed a federated learning (FL)-based Intrusion Detection System (IDS) utilizing a deep autoencoder. To overcome the limitations of N-day attack recognition and the constraints associated with centralized FL, we extended this work [4] by leveraging the paradigm of open-set learning with blockchain-enabled FL.\nTo address the challenges associated with deploying machine learning in 6G-enabled IoV, Hoang et al. [5] proposed a secure and reliable integration of Transfer Learning into the 6G-enabled IoV framework. Addressing security threats in 6G IoV networks, Sedjlmaci et al. [2] developed a collaborative cybersecurity framework based on a multi-level FL algorithm and Stackelberg security games. In a similar vein, Zhang et al. [13] designed a sophisticated weight-based ensemble ML algorithm, optimized with many-objective techniques, for identifying anomalies in vehicular Controller Area Network (CAN) bus systems, thereby aligning with the high security demands of 6G networks. However, while these studies propose IDS solutions suitable for 6G-enabled IoV, they do not fully address the adaptability challenges in a such dynamic and constantly evolving environments where cyber threats are in continuous flux, with new ones emerging. A notable limitation of DL-based IDS is their struggle with incremental learning from continuously evolving data streams, a problem often termed as catastrophic forgetting [6].\nTo tackle the challenge of adapting IDS to new attack patterns and addressing catastrophic forgetting in DL-based IDS, the study by Prasath et al. [8] examines the effectiveness of continual learning models for the incremental learning of novel attack patterns. This research involved both experimental and analytical studies, focusing on three key continual learn-ing methods: learning without forgetting, experience replay, and dark experience replay. Additionally, another significant effort in employing continual learning is the work by Ejaz et al. [7], which investigates the use of continual learning techniques for consistent phishing detection over time. This study trained a vanilla neural network (VNN) model with deep feature embedding of HTML content in a continual learning setup. The results indicate that continual learning algorithms effectively maintain accuracy over time, albeit with slight performance decline. However, these solutions predominantly utilize centralized learning models, which may not align with the specific demands of the IoV environment. These models often require high bandwidth and result in increased latency. Moreover, there are privacy concerns, as sensitive data might be compromised during transmission to central locations.\nTo align with the specific demands of the IoV environment, recent studies [14], [15] have proposed Federated Learning (FL)-based IDS for misbehavior detection in 5G and 6G-enabled IoV. Our solution uniquely combines FL and Contin-ual Learning (CL) to ensure both adaptability and suitability within the distributed and dynamic environment of the IoV."}, {"title": "III. PROPOSED SOLUTION", "content": "The proposed Intrusion Detection System (IDS) is specifically designed for deployment in Connected and Automated Vehicles (CAVs), where it actively monitors network traffic. Our detection model uses class-incremental learning to adapt to evolving attack patterns. Additionally, federated learning is employed to facilitate distributed and privacy-preserving training. In our system architecture, the Multi-access Edge Computing (MEC) server functions as the parameter server, with the CAVs acting as client nodes, as depicted in Figure 1. We detail the development process of the IDS in the following sections."}, {"title": "A. Network Traffic Processing", "content": "The traffic collector module of the IDS converts raw captured packets into flows, thereby enhancing the understanding of traffic patterns. To characterize each flow, a set of features is calculated based on packet header analysis, which includes data from both the network and transport layers of the network architecture. These network features can be categorized into four main types: Packet-Based features focus on metrics such as packet counts and transmission rates, providing insights into traffic volume and flow patterns. Byte-Based features analyze the volume of transmitted data to assess network load and bandwidth usage. Time-Based features capture the temporal characteristics of traffic, including flow durations and intervals between transmissions, aiding in the identification of activity timing and anomaly detection. Protocol-Based features"}, {"title": "B. Federated Attack Incremental Learning", "content": "To enable continual learning of the detection model, we use the Continual Learning with Experience And Replay (CLEAR) [9] method for our detection model. This methods fuses direct learning from new experiences to preserve the system's adaptability with indirect learning from past experiences to bolster stability. Moreover, CLEAR strengthens the system's consistency by incorporating behavioral cloning, aligning the current operational guidelines with prior iterations. CLEAR is underpinned by an actor-critic training regime that leverages both fresh and historical experiences. Formally, the network parameters are denoted by \u03b8, with $\u03c0_\u03b8$ indicating the network's current policy over actions a, and $h_s$ representing the hidden state of the network at time s. The policy generating the observed experience is represented by \u00b5. The V-Trace target $v_s$ for this method is defined as follows [9]:\n$v_s := \\sum_{t=s}^{s+n-1} \\prod_{i=s}^{t-1} c_i \\delta V_t + V(h_{s+n})$\nwhere $\u03b4V_t := p_t (r_t + V(h_{t+1}) \u2212 V(h_t))$ for truncated importance sampling weights $c_i := min(\u03c1, \\frac{\u03c0_\u03b8(a_i|h_i)}{\u00b5(a|h_s)})$, and $\u03c1_t := min(\u03c1, \\frac{\u03c0_\u03b8(a_i|h_i)}{\u00b5(a|h_s)})$ (with $\u03c1$ and $c$ constants). The policy gradient loss is:\n$L_{policy-gradient} := \u2212p_s log \u03c0_\u03b8(a_s|h_s)(r_s + \u03b3v_{s+1} \u2212 V(h_s))$.\nThe loss functions $L_{policy-gradient}$, $L_{value}$, and $L_{entropy}$ are utilized for both new and replay experiences. Additionally, $L_{policy-cloning}$ and $L_{value-cloning}$ are incorporated exclusively for replay experiences.\nIn replay experiences, additional loss terms are incorporated to enable behavioral cloning between the network's current state and its historical counterparts. This is aimed at preventing deviations in the network's output on replayed tasks during the learning of new tasks. The methodology includes penalizing (1) the Kullback-Leibler (KL) divergence, which assesses the disparity between the historical and present policy distributions, and (2) the L2 norm, reflecting the variance between historical and current value functions. Technically, this leads to the integration of specific loss functions [9]:\n$L_{policy-cloning} := \\sum_a \u00b5(a|h_s)log\\frac{\u00b5(a|h_s)}{\u03c0_\u03b8(a|h_s)}$,\n$L_{value-cloning} := ||V(\u03b8|h_s) \u2212 V_{replay}(h_s)||^2$.\nThe MEC nodes orchestrate the federated training process of the detection model by playing the role of parameters servers for model updates aggregation. First, the MEC server initial-izes the learning parameters of the detection model (number of"}, {"title": "IV. PERFORMANCE EVALUATION", "content": "We evaluated our system using the 5G Network-Intrusion Detection and Defense (5G-NIDD) [10] dataset. This dataset was selected for its recency, the variety of attack types it includes, and particularly because it contains real 5G network traffic. Ideally, we would have preferred to use a dataset with 6G traffic, but to our knowledge, such a dataset is not yet available. The dataset includes examples of Denial of Service (DoS) attacks, such as ICMP Flood, UDP Flood, SYN Flood, HTTP Flood, and Slowrate DoS, as well as port scans, including SYN Scan, TCP Connect Scan, and UDP Scan. Following a comprehensive data preprocessing that involved cleaning, normalization, and feature engineering, the final dataset was refined to include 81 features.\nWe first assess our detection model's performance within a centralized training setup. Subsequently, we proceed to evaluate its accuracy in a federated training setup. To ensure a validation as realistic and closely aligned with real-world scenarios as possible, we begin by training the model on a dataset that includes only one type of attack along with benign traffic. Subsequently, we sequentially introduce samples of different attack types, each time integrating a new type. The order of the attacks' introduction is completely random. The model evaluation was based on the three metrics detailed below:\n\u2022 Accuracy: the proportion of correctly identified samples (both true positives and true negatives) to the total number of observations.\n$Accuracy = \\frac{TP+TN}{TP+TN+FP+FN}$\n\u2022 Recall: measures the proportion of actual positives that are correctly identified.\n$Recall = \\frac{TP}{TP+FN}$\n\u2022 FPR (False Positive Rate): Measures the proportion of actual negatives that are incorrectly identified as positives.\n$FPR= \\frac{FP}{FP+TN}$\n\u2022 F1-Score: The harmonic mean of Precision and Recall.\n$F1_Score = 2 \\times \\frac{Precision \\times Recall}{Precision + Recall}$\nTP, TN, FP, and FN denote true positive, true negative, false positive, and false negative, respectively.\nIn our initial setup, we considered 10 clients and conducted training over 10 rounds. We experimented with varying numbers of local iterations to assess the model's convergence. The quick convergence and stable high accuracy across all client configurations demonstrate the system's robustness and effectiveness in a distributed learning context. demonstrates that the detection model maintains stable and high performance in both multiclass and binary classifications across varying numbers of clients. The model achieves high accuracy and precision, indicating its robustness. While the macro recall indicates a slightly lower performance in identifying less frequent attack types, the high F1-scores across all client groups suggest a well-balanced model. The consistent performance, regardless of the number of clients, affirms the model's scalability and effectiveness."}, {"title": "V. CONCLUSION", "content": "This study introduced a new adaptive IDS designed for the constantly evolving IoV security environment, in anticipation of the upcoming 6G technology shift. By integrating class-incremental and federated learning, which suited the IoV's distributed structure, the system achieved high accuracy and a low false positive rate, as demonstrated in our tests using a recent dataset. These results emphasized the system's flexibil-ity and marked a step forward in AI-driven cybersecurity for vehicular networks. Our efforts provided a foundational step for enhancing IoV security against the new wave of cyber threats expected with 6G advancements."}]}