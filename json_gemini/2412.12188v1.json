{"title": "PREDICTING INTERNET CONNECTIVITY IN SCHOOLS: A FEASIBILITY STUDY LEVERAGING MULTI-MODAL DATA AND LOCATION ENCODERS IN LOW-RESOURCE SETTINGS", "authors": ["Kelsey Doerksen", "Casper Fibaek", "Rochelle Schneider", "Do-Hyung Kim", "Isabelle Tingzon"], "abstract": "Internet connectivity in schools is critical to provide students with the digital literary skills neces- sary to compete in modern economies. In order for governments to effectively implement digital infrastructure development in schools, accurate internet connectivity information is required. How- ever, traditional survey-based methods can exceed the financial and capacity limits of governments. Open-source Earth Observation (EO) datasets have unlocked our ability to observe and understand socio-economic conditions on Earth from space, and in combination with Machine Learning (ML), can provide the tools to circumvent costly ground-based survey methods to support infrastructure development. In this paper, we present our work on school internet connectivity prediction using EO and ML. We detail the creation of our multi-modal, freely-available satellite imagery and survey information dataset, leverage the latest geographically-aware location encoders, and introduce the first results of using the new European Space Agency -lab geographically-aware foundational model to predict internet connectivity in Botswana and Rwanda. We find that ML with EO and ground-based auxiliary data yields the best performance in both countries, for accuracy, F1 score, and False Positive rates, and highlight the challenges of internet connectivity prediction from space with a case study in Kigali, Rwanda. Our work showcases a practical approach to support data-driven digital infrastructure development in low-resource settings, leveraging freely available information, and provide cleaned and labelled datasets for future studies to the community through a unique collaboration between UNICEF and the European Space Agency -lab.", "sections": [{"title": "Introduction", "content": "In December 2020, the United Nations Children's Fund (UNICEF) and the International Telecommunication Union (ITU) reported that two-thirds (or 1.3 billion) of the world's school-age children do not have an internet connection in their homes [UNICEF Europe and Central Asia, 2020]. To combat this, the Giga initiative was created, aiming to connect every school to the internet and every young person to information, opportunity and choice [UNICEF, 2023a]. Worldwide, schools provide critical online learning infrastructure to communities, and the digital divide between lower-income countries and more developed nations exacerbates already existing inequalities, causing children to fall even further behind. Our work targets the United Nations' Sustainable Development Goal (SDG) 4 of Quality Education: Ensuring inclusive and equitable quality education and promote lifelong learning opportunities for all. The digital divide refers to the disparity between countries, regions, and people and their access to digital services [Van Dijk, 2019]. In 2023, 60% of the African population is unconnected to the global digital society [Internet World"}, {"title": "Related Work", "content": "Machine Learning for Social Good with Earth Observation: Over the past decade, the theme of AI for Social Good has grown rapidly, whereby researchers aim at developing AI methods and tools to address problems at the societal level and improve the well-being of the society [Shi et al., 2020]. Inferring socio-economic indicators with ML and space-based datasets has been investigated, with numerous works focused on poverty mapping [Tingzon et al., 2019, Pettersson et al., 2023, Yeh et al., 2020]. Mapping infrastructure with EO and ML is another popular area of research, with studies focused on identifying informal settlements, slums, and deprived areas in [Fallatah et al., 2020, Wurm et al., 2019, Wang et al., 2019, Fisher et al., 2022], but there has been relatively little attention in the domain of connectivity mapping. The World Bank has created an openly-available composite map of the global power system with ML [Arderne et al., 2020], and there has been published work on policy evaluation in data-sparse environments to assess the livelihood impact of electricity access in Uganda using satellite imagery and ML [atledge et al., 2022], but there have been no studies focused on internet connectivity mapping. Our work builds on the previous work of socio-economic infrastructure mapping to provide an analysis of the feasability and limitations of ML for estimating internet connectivity in schools with freely-available satellite data, and tests the capability of global, general-purpose location embeddings from CLIP-based models to support our use case.\nGeographically-Aware Neural Networks: Incorporating spatial context within AI models using satellite imagery can improve model generalization and overall performance, and growing interest in developing geographically-aware embeddings from geospatial datasets has been explored in the development of the Satellite Contrastive Location-Image Pretraining (SatCLIP), GeoCLIP, Contrastive Spatial Pre-Training (CSP), and GPS2Vec models [Klemmer et al., 2023,"}, {"title": "Data", "content": "Satellite Imagery Features: We derived a rich set of tabularized features from publicly available mid-resolution satellite data from Google Earth Engine (GEE). Taking each location with connectivity information in our dataset as the center point, we extract a 1,000m radius extent of satellite data from GEE including MODIS landcover, VIIRS Nightlight, Global Human Modification, Gridded Population of the World, and Global Human Settlement Layer data products using the airPy\u00b9 data processing package Sulla-Menashe and Friedl [2023], Elvidge et al. [2017], Kennedy et al. [2019], CIESIN [2018], M. and Panagiotis [2023], which represents the land use and extent of urbanization surrounding the schools. We relate our work to poverty mapping, with the assumption that regions suffering from greater levels of poverty are less developed and therefore less likely to have internet access. Land-use data has been used in previous poverty mapping studies by [Tian et al., 2022] which highlighted the relationship between cropland ratio and poverty mapping, and nighttime light intensity and building distribution data has been used by [Putri et al., 2023] with ML for poverty mapping in East Java, Indonesia, providing support for our data selection choices. We selected the geospatial buffer extent for feature creation by first performing a comparative analysis of ML classifier connectivity prediction performance using only geospatial features for 300m, 500m, 750m, 1,000m, and 5,000m buffers extents and found that 1,000m yielded the best results for test set F1 score and accuracy. Further details on feature generation, datasets, and buffer selection are found in Supplementary Materials."}, {"title": "Engineered Features", "content": "Satellite Imagery Features: We derived a rich set of tabularized features from publicly available mid-resolution satellite data from Google Earth Engine (GEE). Taking each location with connectivity information in our dataset as the center point, we extract a 1,000m radius extent of satellite data from GEE including MODIS landcover, VIIRS Nightlight, Global Human Modification, Gridded Population of the World, and Global Human Settlement Layer data products using the airPy\u00b9 data processing package Sulla-Menashe and Friedl [2023], Elvidge et al. [2017], Kennedy et al. [2019], CIESIN [2018], M. and Panagiotis [2023], which represents the land use and extent of urbanization surrounding the schools. We relate our work to poverty mapping, with the assumption that regions suffering from greater levels of poverty are less developed and therefore less likely to have internet access. Land-use data has been used in previous poverty mapping studies by [Tian et al., 2022] which highlighted the relationship between cropland ratio and poverty mapping, and nighttime light intensity and building distribution data has been used by [Putri et al., 2023] with ML for poverty mapping in East Java, Indonesia, providing support for our data selection choices. Table 1 summarizes the engineered feature space. We selected the geospatial buffer extent for feature creation by first performing a comparative analysis of ML classifier connectivity prediction performance using only geospatial features for 300m, 500m, 750m, 1,000m, and 5,000m buffers extents and found that 1,000m yielded the best results for test set F1 score and accuracy. Further details on feature generation, datasets, and buffer selection are found in Supplementary Materials."}, {"title": "Ground-based Infrastructure Features", "content": "To integrate power grid information, the distance from each school to the nearest transmission line is calculated and added as a feature using electrical power grid information from the World Bank Group [Arderne et al., 2020]. To incorporate mobile and fixed device speed test data, we calculate the distance of each school to the nearest mobile and fixed broadband Ookla tile and include relevant information about download and upload speeds from devices recorded in that tile, with data provided by the Ookla for good initiative from October 2023 [Ookla LLC., 2023]."}, {"title": "Data Pre-processing", "content": "We perform min-max scaling of the feature space to improve performance as implemented in scikit-learn. Using the pearson standard correlation coefficient, we compute the pairwise correlation of feature columns and remove those with a score of greater than 0.9."}, {"title": "Labels", "content": "Location and connectivity status information per institution is provided from government partners through Project Connect, which provides the longitude, latitude and binary connectivity label for each school in the dataset"}, {"title": "Satellite Imagery to Feature Embeddings", "content": "Problem Formulation: School Connectivity Prediction: We model connectivity prediction as a binary classification task, wherein we classify each sample (school) represented by a feature vector of engineered features, location encoder model embeddings, or a combination based on its internet connectivity status. We have a dataset $D$ which contains $(X_i, Y_i)_i$ where $x_i$ in $X$ is a vector of features representing a combination of information extracted from satellite imagery (e.g. land cover, nightlight), survey and ground-based measurements (e.g. Ookla Speedtest, global transmission line network) and/or embeddings from location encoder models about a school $I$ and $y_i$ in $Y$ is the internet connectivity status (i.e. 1 connected, 0 not connected) we aim to predict. Figure 2 depicts a overview of the methodological workflow of feature generation and connectivity classification.\nWe explore the use of vector embeddings extracted from the location encoders of three pre-existing models as inputs into our ML classifiers for connectivity prediction, namely SatCLIP, GeoCLIP and CSP [Klemmer et al., 2023, Vivanco Cepeda et al., 2023, Mai et al., 2023], and our newly developed PhilEO Very High Resolution (VHR) Pre-cursor model with embedding sizes of 256, 512, 256, and 1024, respectively. Vector embeddings extracted from images can be thought of as extremely small summaries of those images which claim to capture the ground conditions including population density, housing infrastructure, sun exposure, and more [Klemmer et al., 2023]. Each location encoder used in our study is trained with a different dataset to explore performance differences between imagery sources. CSP was selected for its pre-training on the Functional Map of the World (FMoW) datatset, which was developed to predict the functional purpose of buildings and land use from satellite images and complementary metadata features [Christie et al., 2017]. Categories in FMoW are grouped according to their purpose, and it is proposed that there is potential to delineating connectivity status from buildings (in our case schools), by leveraging the embeddings from a pre-trained model on this dataset. The CSP model is also available in its pre-trained form on the iNaturalist dataset [Van Horn et al., 2017], however this was not pursued as the dataset is not appropriate for our use case. SatCLIP was selected because of its superior performance to other location encoder techniques (including CSP) for the downstream tasks of air temperature, median household income, elevation and population prediction shown in their work in [Klemmer et al., 2023], which highlights the model's ability to be utilized in diverse downstream tasks. We included GeoCLIP for its performance achieved in their work in limited-data settings using the MediaEval Placing Tasks 2016 dataset [Larson et al., 2017, Vivanco Cepeda et al., 2023]; in the context of our work, we have a relatively small dataset of schools."}, {"title": "Methodology", "content": "ML Classifiers: We leverage shallow ML classifier architectures including Random Forest (RF), Gradient Boosting (GB), Support Vector Machines (SVM), Logistic Regression (LR), Extreme Gradient Boosting (XGB) and the Multi- Layer Perception (MLP) neural network. We selected these models over more complex deep learning architecture due to the small size of our dataset and the history of superiority of tree-based models on tabular data over deep learning [Grinsztajn et al., 2022].\nESA PhilEO VHR: The ESA \u222e-lab PhilEO VHR Pre-cursor model is a deep learning architecture and semi-supervised pre-training methodology for training large-scale geographical aware deep learning models [Fibaek et al., 2024]. The setup consists of a U-Net with learned skip-connection, where each block is penalized for transferring information of depending on spatial resolution of the connection. During training most of the skip connection are replaced with Gaussian noise of the same mean and standard deviation as the original as well as masking. Besides autoencoder features, the embedding space is used to attach a series of heads, which predict global features and coordinates of: Sinusoidal Encoded Coordinates [Fibaek et al., 2024], Ground Sampling Distance, Climate Zones [Beck et al., 2018], Land Cover [Zanaga et al., 2022], Water Presence [Melchiorri and Kemper, 2023], and Building Presence [Melchiorri and Kemper, 2023]. A cosine-similarity based contrastive loss is applied on the embeddings versus embeddings of augmented images of the same location [Wojke and Bewley, 2018]. Owing to the global and large-scale dataset, the batch order can be flipped and the images used as negative sample pairs, although with less weight applied to negative samples. The sampling of the model is 50,000 global locations with settled areas being over sampled at twice the likelihood as other places, shown in Figure 3. Each city with at least 50,000 inhabitants is sampled at least once. Each location is sampled multiple times at different spatial resolution.\nExperimental Setup: We investigate four feature space setups for our prediction task:\n\u2022 Hand-crafted EO engineered features: features derived from GEE, power grid, and speedtest data.\n\u2022 Feature embeddings: vector outputs from location encoder models.\n\u2022 Combined: combined engineered and PhilEO VHR Pre-cursor model embeddings.\n\u2022 Engineered features + auxiliary school data: GEE, power grid, speedtest and ground-based survey data."}, {"title": "Results and Discussion", "content": "Connectivity Prediction Model Performance: For both Botswana and Rwanda, models trained with the engineered feature space out-perform the location-encoded feature spaces. In Botswana, the GB model trained with the PhilEO VHR Pre-cursor and engineered features slightly out-performs all other configurations, which suggests that our hypothesis that information learned from the location embeddings can be complementary to the engineered features, however we do not see these same results in Rwanda, with further discussions on the limitations of our methodology below. Tables 3-4 summarize the F1 score and accuracy per classifier architecture and feature space. Overall, though feature embeddings have been claimed in the literature to sufficiently summarize complex socio-economic ground conditions from satellite imagery, summary statistics and metrics extracted using domain expert insight in our engineered feature space show greater performance, though not perfect, to our task of internet connectivity prediction. This is a particularly important takeaway when considering low-resource settings. It is unreasonable to assume a developing nation will have access to proprietary, high-resolution satellite imagery for infrastructure development; freely available data can act as a sufficient starting point for these socio-economic applications."}, {"title": "Feature Importance", "content": "Information from Global Human Settlement Layer (GHSL) strongly influenced the RF model's predictions and was present in four of the top ten features for Botswana and Rwanda. GHSL describes the inner characteristics of human settlements in terms of the functional and height-related components of the built environment. Intuitively, it is expected that the relative distance of a school to the power grid transmission line network would have a direct correlation to its electricity connection and therefore its internet connectivity. We see this claim supported in Rwanda in Figure 4 where the distance to transmission line network is ranked 5th of the top ten features. Nighttime light features are also present in the top ten features for both countries. If we consider that internet connectivity prediction is related to poverty prediction (i.e., poor regions are less likely to be connected than higher-income regions), this result is consistent with the literature, whereby night-time light is used a proxy for poverty in numerous studies with ML for poverty prediction [Noor et al., 2008, Xu et al., 2021, Jean et al., 2016]."}, {"title": "Case Study: Kigali, Rwanda:", "content": "To further investigate model performance, we take the case study of Kigali, Rwanda. We note that consistently, models using engineered features and location encoder-generated features struggle to perform greater than 62% accuracy and 0.72 F1 score in the country, with the best performing models in terms of F1 score (SVM with engineered features) having an average False Positive (FP) rate of 63%, True Positive (TP) rate of 87%, False Negative (FN) rate of 13%, and True Negative (TN) rate of 36%. FPs are the most detrimental to real-world operationalization of our methodology, because this means that we are incorrectly identifying a school as connected, and would thereby be incorrectly diverting resources for improving digital infrastructure for these schools. To look further into why the FP rate is so high, we explore the ground truth conditions in the capital city of Kigali. We plot the connectivity ground truth and RF model"}, {"title": "Incorporating Auxiliary School Information", "content": "Across all model architectures and feature spaces, the models struggle with connectivity prediction accuracy, particularly over Rwanda. We therefore investigated incorporating additional auxiliary information about the schools in Experiment 4 using the UNICEF database, geoBoundaries\u00b2 regional indicators, and Gridded Sex-Disaggregated School-Age Population [Bondarenko et al., 2022] into our feature space. From UNICEF, we added school education level, school distance to nearest Long-Term Evolution station, distance to nearest Universal Mobile Telecommunications System station, and distance to nearest Global System for Mobile communication station. We add regional indicators by treating the administrative boundaries of the country as categories and employ one-hot encoding on the categorical level-2 administrative zones of the country information to add as features. For edge-cases where the schools were slightly outside of a country's boundary (due to label noise), the administrative boundary that was closest to the school was taken as school's region. We incorporate the sum, mean, min, max, and variance of primary and secondary school age male and female students within a 1,000m radius of each school, with further details in Supplementary Materials. Results of our experiment are summarized in Table 5. The accuracy, F1 score and FP rate all noticeably improve when incorporating auxiliary school information. FP rates drop from 48% to 19% in Botswana and 64% to 26% in Rwanda, and accuracy scores reach 80% and 73% respectively."}, {"title": "Limitations and Future Directions", "content": "Globally Generalizable, Geographically-aware Models: Our results show that classifier performance using the pre-trained location encoders as feature extractors is consistently limited across the four location encoder models. This is likely due to the complexity of our use-case, and relatively low spatial resolution of the data used to train the location encoders, and highlights the limitations of \"globally-generalizable\" location encoders for the downstream task of internet connectivity prediction.\nLabel Quality: A distinct limitation of this work is the overall quality of the dataset and the validity of the ground truth connectivity labels. As schools are connected by government partners, there is an undefined latency between connection and updated record of the connection shared, which could mean that there are schools whose connectivity status does not accurately represent its reality. To combat this, continued communication with country stakeholders is critical to"}, {"title": "Conclusion", "content": "Our work investigates Machine Learning for internet connectivity prediction in schools in Botswana and Rwanda, providing a new, multi-modal geospatial dataset and feature generation pipeline openly-available to the community, which can easily extend this study to other countries. We highlight the performance differences using hand-crafted features compared to geographically-aware location encoders, and show that incorporating auxiliary school information greatly improves predictive capabilities, achieving our highest accuracy, F1 scores of 80%, 0.81 in Botswana and 73%, 0.74 in Rwanda."}, {"title": "Technical Appendix", "content": null}, {"title": "Code and Data Availability", "content": "We provide the entire project code with the documentation needed to generate the feature space, train, test and validate our models with links to the pre-processed and cleaned data to re-run experiments at: https://github.com/kelsdoerksen/giga-connectivity"}, {"title": "School Connectivity Dataset Creation", "content": "Geospatial Data Preprocessing. To generate our geospatial features, we treat each school location (latitude, longitude point) with connectivity information as the center point for which we extract geospatial data surrounding the area of interest. To do so, we leverage the open-source datasets from Google Earth Engine (GEE), and specify a radius extent ranging from 300m, 500m, 750m, 1000m and 5000m, respectively. Using the airPy\u00b3 data processing package, we modified the package to include support for the Global Human Settlement Layer (GHSL) and Global Human Modification (GHM) datasets, and extract GHSL, GHM, MODIS, VIIRS Nighttime Lights, and Gridded Population of the World data for each point in the varying array size respectively. We then calculate summary statistics from the image arrays including mode, mean, maximum, minimum, variance, and percent of land cover class where appropriate, to create our tabular dataset of geospatial features per school."}, {"title": "Spatial Distribution of Samples", "content": "The spatial distribution of connected and unconnected schools in Botswana and Rwanda is shown in Figure 8. We can see that in Botswana, the density of schools is far lower than exhibited in Rwanda."}, {"title": "Location Encoders", "content": "To obtain the location embeddings for our school connectivity dataset from the pretrained models, we provide each school latitude, longitude coordinate to the location encoders during the model.eval() stage and extract the corresponding embedding. Notebooks for the SatCLIP, GeoCLIP and CSP embedding generation are included in our shared git repository."}]}