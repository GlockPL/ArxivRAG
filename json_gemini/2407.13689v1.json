{"title": "Shaded Route Planning Using Active Segmentation and Identification of Satellite Images", "authors": ["Longchao Da", "Rohan Chhibba", "Rushabh Jaiswal", "Ariane Middel", "Hua Wei"], "abstract": "Heatwaves pose significant health risks, particularly due to prolonged exposure to high summer temperatures. Vulnerable groups, especially pedestrians and cyclists on sun-exposed sidewalks, motivate the development of a route planning method that incorporates somatosensory temperature effects through shade ratio consideration. This paper is the first to introduce a pipeline that utilizes segmentation foundation models to extract shaded areas from high-resolution satellite images. These areas are then integrated into a multi-layered road map, enabling users to customize routes based on a balance between distance and shade exposure, thereby enhancing comfort and health during outdoor activities. Specifically, we construct a graph-based representation of the road map, where links indicate connectivity and are updated with shade ratio data for dynamic route planning. This system is already implemented online, with a video demonstration, and will be specifically adapted to assist travelers during the 2024 Olympic Games in Paris.", "sections": [{"title": "1 INTRODUCTION", "content": "The impact of global warming is increasingly evident worldwide. In some regions, the number of deaths related to high temperatures is alarming. A study by [17] reports that, from 2000 to 2019, an average of 178,700 deaths annually were attributed to high temperatures, with the number continuing to rise yearly. The escalating severity and frequency of heatwaves, exacerbated by climate change, represent a significant public health threat. A more accessible, comfortable, and safe route planning method aligns as a key priority with both the European Union's Green Deal [6] and the United Nations Sustainable Development Goals [3].\nThere are some literature that conducted preliminary research on the possibility of planning under shaded areas. Such as [5] proposes to use BOTworld to find and visualize optimal thermal comfort paths in squares, parks, and small neighborhoods, such an agent-based model acts with ENVImet microclimate [13] simulations. [20] investigated thermal walks in two European pedestrian routes using questionnaires and field measurements to improve models of dynamic thermal comfort perception. In the study of [19], researchers propose a novel way to detect optimal pedestrian shaded paths using UMEP [11] in QGIS [18], however, this solution relies on accurate terrain maps, and real-time building heights are not well-considered. Besides, [15], proposes a method to conduct shaded navigation using a cross-source of OpenStreetMap [2] and LiDAR point cloud data that resolves both treetop canopy and bare ground elevation problems, however, this relies on well-collected LiDAR data [12] and is hard to apply directly to arbitrary cities.\nIn this paper, we formally present ShadeRouter, a novel shaded route planning method, and provide a demo to showcase its real-time planning ability. This paper contributes in the following aspects: First, this paper introduces a complete pipeline leveraging the advanced foundation model to extract shaded information from satellite images, which can be directly applied to any city with available satellite information. Second, the paper proposes a shaded ratio calculation algorithm, which takes the satellite image and OpenStreetMap as input, and derives the percentage of shade-covered length to the whole route length. Such shaded ratios will be adopted to create an information graph that will be jointly considered with a distance graph when providing routing plans. Third, we provide an online demo for route planning employing a variant of the Dijkstra algorithm and release the source-code, dataset, and corresponding derived shaded ratios for other researchers' convenience."}, {"title": "2 APPROACH", "content": "In this section, we will introduce the proposed planning method ShadeRouter. The detailed pipeline includes three components: Shade Ratio Derivation, Multi-layer Road Graph Construction, and Route Planning Interface. Previous studies have attempted to utilize LiDAR data [1, 10, 21] to simulate shade and enhance route planning [4, 19]. However, these methods often struggle with localization issues and data sparsity for places without LiDAR data, limiting their applicability to certain regions. Our approach leverages widely available satellite imagery to derive shade information globally. This data source provides detailed environmental features, such as vegetation and buildings, ensuring our shade-based navigation planning is both versatile and reliable."}, {"title": "2.1 Shade Ratio Derivation", "content": "This step utilizes satellite imagery to derive information about shaded areas on maps, as illustrated in the first module of Fig. 1. The process begins with the segmentation of raw satellite images using the foundation model, SegmentAnything [7-9], which employs contrastive learning to identify and delineate each object within the image. Once segmented, the image components are analyzed for color hue and brightness to determine shaded areas. This is achieved through chromatics analysis, which identifies darker areas as shaded. In our empirical study, the best threshold value for selecting RGB masks is 75 (mask keeps iff RGB(mask) >= 75).\nSubsequently, these shaded areas are aligned with road data from OpenStreetMap [2]. By overlaying the shade map onto valid path coordinates, as shown in Fig. 1, we can determine the shade ratio, i.e., the percentage of each road covered by shade, facilitating the identification of walkable shaded lanes.\nThe Fig. 2 shows another example of shaded ratio calculation in a walkable network, in this yellow color masked satellite image (such mask implies the shaded area), the red line is a valid pedestrian route extracted from the OSM files [14], as shown in the image, the total pixel L = 400, by image processing, we calculate the overlap between valid pedestrian route and the actual shaded area is S = 67% \u00d7 L. in our setting, each image is downloaded with a zoomed-in level as 20, result in the range of 49.84m x 49.84m. Given this information, we could calculate the shaded ratio for the above example in Fig. 2 which is 49.84 \u00d7 67% \u2248 33.39m.\nAnother challenge in the shade ratio derivation is, the dataset of a place contains multiple images, and the same route may appear multiple times in different images. In order to deal with this, we take the road name as the key (K), assume we already have partially detected shaded length as $L_{shaded}$, accumulated length as $L_{Acc}$, and now we conduct query Q(imgi, K) in each un-visited dataset image, if Q(imgi, K) = True, indicating a positive query, the $L_{shaded} = L_{Shaded} + L_{shaded}'$ and $L_{Acc} = L_{Acc} + L_{K}$. The final shaded ratio for route K is $r(K) = \\frac{L_{Shaded}}{L_{Acc}}$. If we traverse all interested routes, we could derive a pre-processed shaded ratio map."}, {"title": "2.2 Multi-layer Road Graph Construction", "content": "Following the derivation of shade ratio data, we employ this data in the construction of a Shaded Ratio Map, as part of our Multi-layer Road Graph Construction shown in Fig. 1. This construction comprises two primary layers: the upper layer represents the shade"}, {"title": "2.3 Route Planning and User Interface", "content": "Equipped with the road graph and shaded ratio graph, our system can now offer customizable routing recommendations through a modified version of the Dijkstra [16] algorithm. Users can input a query in the format Query(O, D, Type), where O and D represent the coordinates of the starting points and destinations, respectively, denoted as (x, y) and (x', y'). The Type parameter specifies the mode of transportation, either walk or bike. Depending on the selected type, different graphs are utilized: Twalk uses {Gwalk, Gu}, and Tbike employs {Gbike, Gu}. This system allows for route planning that is tailored to the user's specific preferences and needs. Let a be the preference for a more shaded route a \u2208 [0, 1], and 1 a would be the preference weight for the distance. Thus, for any edge with connectivity, the value of the edge will be updated by the equation:\n$W_{joint}(u, v) = aV_{shade} + (1 \u2212 a)V_{distance}$\nwhere the $V_{shade}$ can be represented as r(u, v), given the two point of interests u and v, and r() as the shade ratio calculation function. In the algorithm 1, the V is the set of interested points from the OSM-filtered bikeable or walkable graph network, and E is the set of accessible lanes (edges), and after the calculation, the returned P contains the Path of the suggested plan, which is a list of POIs and can be used for planning and navigation. Alternatively, one can easily modify the above algorithm and output the top k suggested paths based on their different preference a reflecting on a balance of shaded areas and distance."}, {"title": "3 DATASET CONSTRUCTION", "content": "While conducting route planning tasks, in this paper, we get rid of the localized specially collected LiDAR data, instead, we propose to adopt a more accessible resource - satellite image as base data, and we query the Google Map API 1 for the satellite images of a specific city in the demo. We use the 20x zoomed pile image data for processing, the resolution at the equator is 0.1246 meters per pixel (there are 400 pixels in total, so the range in equator is 400 \u00d7 0.1246 = 49.84 m). To a general latitude, the resolution Res is:\n$Res = 49.84 x Cosin(lat)$\nwhere the lat is the latitude in degrees."}, {"title": "4 DEMO PRESENTATION", "content": "In this section, we introduce the demo program, the recorded demo video 3 and provide an introduction to the ShadeRouter.\nIn the implemented program, the user interface incorporates 4 text boxes, two buttons, and one travel mode selector, with a map viewing area at the bottom. Corresponding to the user input, the user would be required to input the source point and destination point, the extra two boxes are for the Google map API and the number of suggested users intend to receive. Once two valid places are searched, the system will show up top k marked routes and pop up a legend explaining each color's meaning. The two images shown in Fig. 3. are from two results, the shortest path, and the most shaded path, we could notice that the orange line gives the fastest itinerary with high exposure to sunshine, and the green one prefers alley that is more shaded and thermally comfortable. This enables users to find the most preferred plans that improve the travel experience. Despite the demo, for more interaction, please"}, {"title": "5 CONCLUSION", "content": "In this work, we propose a prototype method of ShadeRouter, which leverages the satellite image to mine the shaded ratio. By doing so, it provides the route planning suggestions for pedestrians and cyclists considering the shades on the road. It is feasible to extend the demo to a worldwide map using the formally designed pipeline based on the publicly accessible satellite image data.\nThis demonstration can be further improved by temporal information such as the time or seasonal shade situation. We hope this project will benefit the citizens' health by reducing the heatwave exposure probability and providing a more comfortable outdoor activity plan.\nFuture developments include adapting the current method to a more dynamic shade simulation that captures the real-time shadow changes in cities, and optimizes the planning speed to enhance the users' experience. If equipped with more sensible data, or more outdoor choices, the algorithm could even include wind strength and extreme weather conditions in the planning, and provide e-scooters and shared bikes as alternatives, and these will definitely provide richer activity choices for city-travelers."}]}