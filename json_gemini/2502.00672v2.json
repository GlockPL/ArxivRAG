{"title": "Biogeochemistry-Informed Neural Network (BINN) for Improving Accuracy of Model\nPrediction and Scientific Understanding of Soil Organic Carbon", "authors": ["Haodi Xu", "Joshua Fan", "Feng Tao", "Lifen Jiang", "Fengqi You", "Benjamin Houlton", "Ying Sun", "Carla Gomes", "Yiqi Luo"], "abstract": "Big data and the rapid development of artificial intelligence (AI) provide unprecedented\nopportunities to enhance our understanding of the global carbon cycle and other biogeochemical\nprocesses. However, retrieving mechanistic knowledge from big data remains a challenge. Here,\nwe develop a Biogeochemistry-Informed Neural Network (BINN) that seamlessly integrates a\nvectorized process-based soil carbon cycle model (i.e., Community Land Model version 5,\nCLM5) into a neural network (NN) structure to examine mechanisms governing soil organic\ncarbon (SOC) storage from big data. BINN demonstrates high accuracy in retrieving\nbiogeochemical parameter values from synthetic data in a parameter recovery experiment. We\nuse BINN to predict six major processes regulating the soil carbon cycle (or components in\nprocess-based models) from 25,925 observed SOC profiles across the conterminous US and\ncompared them with the same processes previously retrieved by a Bayesian inference-based\nPROcess-guided deep learning and Data-driven modeling (PRODA) approach 1,2. The high\nagreement between the spatial patterns of the retrieved processes using the two approaches with\nan average correlation coefficient of 0.81 confirms BINN's ability in retrieving mechanistic\nknowledge from big data. Additionally, the integration of neural networks and process-based\nmodels in BINN improves computational efficiency by more than 50 times over PRODA. We\nconclude that BINN is a transformative tool that harnesses the power of both AI and process-\nbased modeling, facilitating new scientific discoveries while improving interpretability and\naccuracy of Earth system models.", "sections": [{"title": "1 Introduction", "content": "Artificial intelligence (AI) has revolutionized our ability to leverage big data to uncover\nrelationships in complex systems such as the Earth system 3. Methods such as machine learning\nand deep learning have shown power in discovering key patterns from data in biogeochemistry,\nsuch as representing soil organic carbon concentrations 4,5, predicting aboveground carbon\naccumulation rates in naturally regenerating forests 6, and estimating soil respiration 7. However,\nmost AI-based approaches primarily learn black-box statistical correlations from the data rather\nthan causality, making it challenging to translate the learned relationships and patterns into\nmechanisms and controls on processes. This lack of mechanistic insight is an inherent weakness\nof Al-based models 8.\nTo address this challenge, various hybrid approaches have emerged, aiming to integrate\nscientific knowledge and reasoning with standard machine learning methods. This powerful\ncombination leverages the strengths of data-driven techniques along with scientific theories and\nreasoning to enhance the mechanistic understanding of the Earth system through big data 9. By\nintroducing physical or knowledge-based constraints and reasoning, such as mass or energy\nconservation 10-12, thermodynamic rules, interpretable latent spaces, and entropy-based reasoning\nconstraints 13,14, Bragg's law for X-ray diffraction 15, empirical functional relationships 16,17, , or\npartial differential equations 18, into standard ML approaches such as a neural networks, AI-\nbased predictions can be further constrained by scientific knowledge in addition to being driven\nby observational data. More importantly, unlike the uninterpretable weights and biases in a\nconventional neural network, the latent physical parameters embedded in the knowledge-based\nconstraints explicitly represent physical and biological processes, providing mechanistic\ninterpretability to the neural network's predictions. However, previous efforts mostly used"}, {"title": null, "content": "limited constraints in a system (e.g., a few empirical relationships in photosynthesis 19) or\nsimplified models that comprise latent variables and conservation principles 12. It remains\nchallenging to integrate dozens of partial or ordinary differential equations with numerous free\nparameters into a neural network to study the dynamics of a complex system, such as soil\norganic carbon (SOC) dynamics.\nA recently-developed approach, PROcess-guided deep learning and DAta driven\nmodeling (PRODA), leverages a deep learning model to learn the site-by-site optimized\nbiogeochemical parameters by Bayesian inference-based data assimilation, to improve our\nunderstanding of the global soil carbon cycle 1,2,20,21. This approach successfully harnesses the\nstrengths of both process-based modeling and deep learning methods to improve SOC\nsimulations with spatially varying biogeochemical parameters. However, the Bayesian inference-\nbased, site-level data assimilation embedded in the PRODA approach requires vast\ncomputational resources, making the method time- and energy- inefficient and difficult to apply\nbroadly.\nIn this study, we integrate a matrix form of a process-based model that describes SOC\ndynamics into a neural network, thus developing a Biogeochemistry-Informed Neural Network\n(BINN). BINN is a novel framework that combines data-driven machine learning with process-\nbased modeling to enable interpretability of biogeochemical dynamics, such as SOC dynamics in\nthis study (Figure 1). Herein, we first introduce the structure of BINN (Figure 1a), followed by a\ndemonstration of BINN's ability to recover biogeochemical parameters with high accuracy\nthrough a parameter recovery experiment (Figure 2) and estimation of model components from\nreal-world SOC observations (Figure 1b). Our predicted biogeochemical parameters accurately\nsimulate real SOC observations, and are similar to those produced by PRODA, while being much"}, {"title": null, "content": "faster to estimate computationally. By combining data-driven learning with reasoning about\nexisting geoscientific knowledge, BINN can accurately and quickly infer underlying physical\nprocesses from only SOC observations."}, {"title": "2 Biogeochemistry-Informed Neural Network (BINN)", "content": "BINN incorporates a process-based model into a neural network to infer SOC concentrations and\nunderlying processes from observational data (Figure 1a). First, a neural network learns the\nrelationships between environmental covariates and biogeochemical parameters, which quantify\nthe strength of important processes in the soil carbon cycle. We pass these parameters to a\nprocess-based model to simulate SOC storage, and compare with field observations."}, {"title": "2.1 Neural Network", "content": "We employ a fully-connected neural network to learn the relationship between environmental\ncovariates (Table S1) and biogeochemical parameters over space. The neural network uses\nembedding layers to encode categorical covariates, and a spatial positional encoder to compute a\nvector embedding for each location. We combine these embeddings with the numeric covariates\ninto a vector e, and pass this through a 4-layer neural network $fnn$ (Equation 1) with learnable\nweights/biases w, which outputs a vector z with 21 values (one for each parameter in the\nprocess-based model):\n$z = fnn (e; w)$"}, {"title": null, "content": "(1)"}, {"title": null, "content": "Because we have prior knowledge about the plausible range of values for each biogeochemical\nparameter, z is further processed by element-wise sigmoid functions \u03c3 (Equation 2) into\npredicted parameters p. This ensures each parameter p\u012f stays within these prior ranges:\n$Pi = \u03c3(yi, \u03b3, \u03b8i,max, \u03b8i,min) = \\frac{1}{1+exp^{\\frac{-z_i}{\\gamma}}}* (\u0472\u0456,\u0442\u0430\u0445 \u2014 \u0472\u0456,min) + \u03b8i,min$"}, {"title": null, "content": "(2)\nwhere zi is the i-th output of the neural network, \u03b8i,max and \u03b8i,min are plausible limits for each\nbiogeochemical parameter i, taken from previous literature 2, and y is a learnable parameter that\ncontrols how fast the predictions converge to \u03b8i,min or \u03b8i,max. Thus, the final output of the neural\nnetwork is p, a vector of 21 biogeochemical parameters for each location, where each parameter\np\u2081 is constrained to be in its prior range (\u03b8i,min, \u03b8i,max). We used a grid search to select\nhyperparameters; additional details about hyperparameters and model architecture can be found\nin Appendix 1."}, {"title": "2.2 Process-based Model", "content": "In this study, we used the soil carbon module of the Community Land Model version 5 (hereafter\nreferred to as CLM5) to represent our knowledge of SOC dynamics (Figure S1). The CLM5\nmodel has been continuously developed and refined over the past decade for simulating SOC\ndynamics 22; it mathematically represents our knowledge of SOC dynamics with 140 partial\ndifferential equations. We chose CLM5 to enable direct comparison with PRODA, which uses\nthe same model.\nCLM5 simulates SOC dynamics across 20 soil layers to 8 m. Each layer contains 7\ncarbon pools, including one coarse woody debris pool, three litter pools corresponding to\nmetabolic, cellulose, and lignin materials, and three SOC pools classified by different turnover"}, {"title": null, "content": "times into fast, slow, and passive pools. This structure results in a total of 140 carbon pools (7\npools \u00d7 20 layers).\nA key innovation of our approach is that we incorporate into our neural network\nframework a differentiable CLM5 model, whose structure can be represented in a matrix form\n23,24\nas:\n$\\frac{dX(t)}{dt} = B(t)I(t) \u2212 \u0391\u03be(t)KX(t) \u2212 V(t)X(t)$"}, {"title": null, "content": "(3)\nwhere I(t) is the total carbon input from vegetation at time t, B(t) (140\u00d71) is the allocation of\ncarbon input to different pools: A (140\u00d7140) is the carbon transfer matrix, quantifying horizontal\ncarbon movement between pools in the same layer; K (140\u00d7140) is the intrinsic decomposition\nrate of each carbon pool, which is the same for each pool across 20 layers; \u03be(t) (140\u00d7140)\ncaptures how the environment modifies the intrinsic decomposition rate in the K matrix by\ntemperature (\u0160T), water (\u0123w), oxygen (o), and depth (D) scalars, V(t) (140\u00d7140) defines how\nSOC enters and leaves each layer; and X(t) is carbon pool size. The term B(t)I(t) represents the\nvegetation carbon input, A\u03be(t)KX(t) describes the SOC movements among the 7 pools within\neach layer, and V(t)X(t) indicates vertical SOC movements along the soil profile. The t in\nparentheses means that the corresponding process changes with time.\nIn this study, we assumed steady-state SOC dynamics for computational efficiency\n(Appendix 2), which is justified by previous research showing that recent disequilibrium effects\nfrom climate change and human activities are relatively minor compared to the SOC storage that\nhas developed over thousands of years 2,25.\nEquation (3) contains 21 biogeochemical parameters (Table S2) that quantify the strength\nand reflect properties of different processes (e.g., transformation and stabilization of SOC,\ntemperature sensitivity of soil respiration, and substrate quality) in the soil carbon cycle. Because"}, {"title": null, "content": "those processes are highly variable depending on different climate conditions or soil properties,\nthe values quantifying their strength or properties (i.e., the parameter values) should differ with\nchanging environments 26. Thus, in this study, the neural network embedded in BINN (Section\n2.1) predicts these biogeochemical parameter values from environmental covariates. The\npredicted values of the 21 biogeochemical parameters and the environmental forcings (Table S3)\nare used in Equation (3) to estimate steady-state SOC storage at sites across the continental US."}, {"title": "2.3 Loss Function", "content": "Because we are interested in accurately simulating SOC, our primary loss quantifies the\ndiscrepancy between simulated and observed SOC values. Specifically, we use a smooth L1 loss\nfunction, which transitions from quadratic behavior near zero to linear behavior beyond a\nspecified threshold \u1e9e.\nSmooth L1 Loss(\u0177profile, yprofile)\n$=\\{\n-\\frac{0.5(\\hat{y}_{profile} - y_{profile})^2}{\\beta} \\qquad if | \\hat{y}_{profile} - y_{profile} |< \u03b2$\n $| \\hat{y}_{profile} - y_{profile} | - 0.5 \u00d7 \u03b2 \\qquad 0.W.$\n$"}, {"title": null, "content": "(4)\nwhere \u0177profile represents the simulated SOC profile at all observation depths for a single site by\nCLM5, Yprofile denotes the corresponding observed SOC profile at the same site, and \u1e9e is a\nthreshold hyperparameter that determines the transition point between quadratic and linear\nbehaviors of the loss function. The smooth L1 loss function's linear asymptotic behavior makes it\nmore robust to outliers compared to conventional loss functions 27.\nWe also add an additional hyperbolic cosine loss (cosh) term that acts as a regulator,\nencouraging the neural network to predict biogeochemical parameters within reasonable bounds."}, {"title": null, "content": "Specifically, it penalizes parameter values that deviate substantially from the center of the prior\ndistribution, thereby discouraging biogeochemically implausible extreme values. Eventually, the\ntotal loss is a linear combination of the two losses (Equation 5):\n$L_{batch} = \\sum_{\\text{profile}=1}^{\\text{batch size}} {Smooth L1 Loss(\\hat{y}_{profile}, y_{profile}) + w \\sum_{j=1}^{21} cosh [\u03c4(p_j \u2013 0.5)]}$"}, {"title": null, "content": "(5)\nwhere batch size is a hyperparameter describing the number of soil profiles processed in each\ntraining iteration before performing one backpropagation, w is a weighting hyperparameter that\nbalances the two loss components, pj represents the predicted biogeochemical parameter from\nthe neural network, and t is a scaling factor that controls the strength of regularization by the\nhyperbolic cosine function. From the hyperparameter grid search, we set beta to 1 and\nbiogeochemical-parameter-loss weight to 100.\nWhile CLM5 simulates SOC dynamics at 20 specific depths, SOC data collected from the\nfield were not necessarily measured at the depth nodes set in CLM5 simulation. Thus, in\ncalculating the loss function value, for observations at depths equaling CLM5 nodes, the\nsimulated values were directly from CLM5 outputs. When observations occur at depths between\ntwo CLM5 nodes, we employed linear interpolation to estimate simulated SOC values at the\nobservation depths. In cases where observations extend beyond 8 meters (i.e., the deepest node in\nCLM5 simulations), we used the values at 8 meters as simulated SOC as SOC concentration in\ndeeper layers no longer changes much."}, {"title": "2.4 Backpropagation to Optimize Neural Network Parameters", "content": "During training, BINN computes the loss function based on the current predicted SOC and\nparameters; the loss quantifies how poorly its current predictions match the SOC observations\nand prior knowledge. Through backpropagation, the loss signals propagate backwards through\nthe entire BINN structural chain: first through the CLM5 matrix equations that generate modeled\nSOC, then through the biogeochemical parameters, and finally to the neural network that predicts\nthese biogeochemical parameters. At each step, PyTorch uses the chain rule to automatically\ncompute the gradient of the loss function with respect to each learnable NN component (e.g. w in\nEquation 1 and y in Equation 2). These gradients indicate how each component can be adjusted\nto increase or decrease the loss. The NN components are adjusted slightly in the direction that\ndecreases the loss, and then the above process is repeated. The differentiability of the process-\nbased model (CLM5 in this case) enables this continuous gradient flow and thus allows the\nneural network to learn parameter values that produce better SOC predictions."}, {"title": "3 Recovering Biogeochemical Parameters from Synthetic Data", "content": "We evaluated BINN's capability to recover the biogeochemical parameters of CLM5 from\nsynthetic SOC data using a 10-fold cross-validation experiment (Appendix 5) 28. Unlike real-\nworld observations that contain measurement uncertainties and potentially unresolved processes,\nsynthetic SOC data across multiple depths was generated by running CLM5 with prescribed\nspatially-varying parameter values (obtained from previous work\u00b9), providing a controlled\nenvironment where true parameter values are known (Figure 2). This synthetic dataset allows us\nto quantitatively assess BINN's parameter recovery accuracy by comparing predicted parameters\nwith the known values used in data generation.\nTo decide which biogeochemical parameters to modify in this experiment, we conduct a\nsensitivity analysis of CLM5 to identify the biogeochemical parameters that have the greatest"}, {"title": null, "content": "influence on simulated SOC values (Appendix 4). We selected the four most sensitive\nparameters from this sensitivity test: the parameter \"w-scaling\" represents the influence of soil\nwater on modifying SOC decomposition; the parameter \"tau4s3\" represents the decomposability\nof the passive SOC pool; the parameter \"fs1s3\" indicates the efficiency of carbon transforming\nfrom active SOC to passive SOC; and the parameter \"efolding\" quantifies the impacts of soil\ndepth in SOC decomposition. While equifinality, by which different combinations of\nbiogeochemical parameter values can lead to similar simulations, remains a challenge even with\nthis reduced parameter set, focusing on these highly sensitive parameters allows us to evaluate\nBINN's parameter recovery capabilities with greater confidence. This approach minimizes\nconfounding effects from less influential parameters while targeting the parameters that most\nstrongly influence SOC dynamics in CLM5.\nTo test the recovery efficiency of the biogeochemical parameters with BINN, we\nmodified the final layers of the neural network by reducing the number of neurons from 21 to 4\nto predict these 4 biogeochemical parameters. Combining the 4 biogeochemical parameters\npredicted by BINN and the remaining 17 biogeochemical parameters from the prescribed\nparameter values, BINN was able to simulate SOC values and update itself through\nbackpropagation. After training BINN with the synthetic SOC dataset, we compared the 4\nparameters predicted by BINN with the prescribed parameter values in the testing dataset to\nevaluate the accuracy of BINN in retrieving the prescribed biogeochemical parameters.\nWhen BINN predicted the top 4 most sensitive biogeochemical parameters, the recovered\nparameter values exhibited strong consistency with the prescribed biogeochemical parameters\nused during synthetic data generation, achieving an average correlation coefficient of 0.73 across\n10 cross-validation iterations (Figure 4f). BINN achieved an average Nash-Sutcliffe modelling"}, {"title": null, "content": "efficiency coefficient (NSE) of 0.67 (Supplementary 6) on the test dataset when comparing\nsimulated SOC with synthetic SOC (Figure 4f). In one of the cross-validation iterations with the\nmedian NSE of simulated SOC, the parameter \u201cefolding\u201d recovered by BINN, representing the\ndepth scalar, had a correlation coefficient of 0.76 in comparison with the prescribed parameter\nvalues (Figure 4a). The parameter \"tau4s3,\" representing the baseline turnover time of passive\nSOC pools, showed a correlation coefficient of 0.78 (Figure 4b). The \"fs1s3\" parameter,\nindicating the transfer fraction from fast SOC pool to passive SOC pool, achieved a correlation\ncoefficient of 0.71 (Figure 4c). Lastly, \"w-scaling,\" representing the scaling factor of soil water\nscalar, had a correlation coefficient of 0.70 (Figure 4d)."}, {"title": "4. BINN performance with real-world SOC Observations", "content": "We then evaluated the performance of BINN by comparing BINN's SOC predictions with\nobserved SOC across the Conterminous United States (a total of 25,925 profiles) (Figure 1b)."}, {"title": "4.1 Data Preparation", "content": "We processed SOC observations from the World Soil Information Service (WoSIS) following\nTao et al. 1,2. Each profile (site) may have SOC observations at multiple depths. Only profiles\nwith at least three observations were kept, yielding 25,925 profiles (169,104 SOC measurements)\nacross the conterminous US. We used 60 environmental covariates at each site from Tao et al. 2\nas input to BINN (Table S1). To achieve better training effectiveness, we normalized all the\nenvironmental covariates to the interval [0, 1] according to their maximum and minimum values.\nWe applied eight types of forcing data to drive the simulations of SOC using CLM5,\nwhich are the mean annual net primary productivity (NPP), active soil layer depth from last year\nand current year, soil layer number that reaches the bedrock, soil oxygen scalar for"}, {"title": null, "content": "decomposition, soil nitrogen scalar for decomposition, soil temperature, and soil water potential.\nThese forcings are from 20 years of monthly CLM5 simulations at the steady state using a\npreindustrial forcing (that is, I1850Clm50Bgc) at 0.5\u00b0 resolution.\nThe 10-fold cross-validation divided the whole dataset randomly into 10 folds, and we\ntook one-fold (i.e., 10%) data as the testing dataset in each iteration. The remaining data were\nfurther split into training (8/9) and validation (1/9) sets."}, {"title": "4.2 Real-world SOC Observations Analysis", "content": "After BINN optimization, we used its predicted biogeochemical parameters to calculate six\nmodel components that indicate different properties in soil carbon cycle over the US continent:\ncarbon transfer efficiency, baseline decomposition, environmental modifier, carbon input\nallocation, vertical transport rate, and plant carbon inputs. The BINN-retrieved components were\ncompared with the results generated from PRODA (Figure 5). We assessed the spatial patterns of\nsix model components that emerged from both approaches. The plant carbon input component\nwas identical between BINN and PRODA, due to the use of the same NPP forcing data (Figure\n5p, 5q, 5r). Spatial distributions of the other five components were similar between BINN and\nPRODA with an average correlation of 0.81.\nThe carbon transfer efficiency predicted by BINN, which quantifies the weighted average\nratio of decomposed carbon being transferred from one carbon pool to another relative to the\ntotal carbon decomposition, exhibited more spatial variation than PRODA's prediction. While\nboth methods indicated higher carbon transfer efficiency in the northwestern region and lower\nefficiency in the middle west (Figure 5a, 5b), BINN predicted higher values in the northeastern\nand southeastern parts of the Conterminous United States compared to PRODA, resulting in a"}, {"title": null, "content": "relatively high average value. Even so, the correlation coefficient between the two approaches\nstill reaches 0.86 (Figure 5c).\nBoth BINN and PRODA predicted the baseline decomposition, which describes the\nsubstrate decomposability of each soil pool, with similar spatial patterns across the\nConterminous United States, showing higher values in the northwestern and eastern areas\n(Figure 5d, 5e). The average baseline decomposition values from BINN were relatively higher\nthan those by PRODA (Figure 5f).\nThe environmental modifier predicted by BINN achieved a correlation coefficient of 0.82\nwith PRODA's results (Figure 5i). Their spatial patterns were nearly identical across the\nConterminous United States, with lower values in the northwestern part and gradually increasing\nto the highest values in the southeastern part (Figure 5g, 5h).\nThe carbon input allocation predicted by both methods also displayed similar spatial\npatterns across the Conterminous United States with a correlation coefficient of 0.74 (Figure 51).\nBoth the methods predicted low carbon input allocation rates in the eastern and western US but\nhigh rates in the mid US (Figure 5j, 5k), though BINN predicted higher rates of carbon input\nallocation in the mid US than the PRODA's predictions.\nBINN and PRODA predicted the vertical transport rate with nearly identical spatial\ndistributions across the Conterminous United States (Figure 5m, 5n), with a high correlation\ncoefficient of 0.91 (Figure 50).\nBINN demonstrated better accuracy than PRODA in predicting SOC across the\nConterminous US as well (Figure 6) \u00b9. Fewer geographical biases were observed when\ncomparing BINN's SOC predictions with observed SOC from the testing dataset (Figure 6a). The\npredicted and observed SOC values were highly correlated, with a NSE value of 0.66 (Figure"}, {"title": null, "content": "6b). The training and validation NSE values recorded throughout model training at each epoch\nshowed the validation NSE reaching as high as 0.63 (Figure S3)."}, {"title": "5. Computational Efficiency", "content": "We compared BINN's computational efficiency with PRODA using 2,000 soil profiles on a\npersonal computer with two BINN versions: one using the original matrix equation of CLM5 and\nthe other using the vectorized matrix equation by removing for-loops (Appendix 2). Both BINN\nimplementations were trained for 300 epochs to ensure that BINN has finished learning from the\nsoil profiles.\nPRODA is a two-step approach that combines Bayesian-inference approaches with neural\nnetworks. Its computational bottleneck lies in its first step: site-level Markov Chain Monte Carlo\n(MCMC) optimization of CLM5 parameters. To quantify this, we measured MCMC runtime for\n10 profiles (20,000 test iterations and 50,000 formal iterations per site) and extrapolated to 2,000\nprofiles. PRODA's second step, which uses a neural network to learn relationships between\nenvironmental covariates and MCMC-optimized parameters, required 6,000 epochs of training.\nOn a single CPU, BINN with for-loops required 52.5 hours (Figure 8), whereas the\nvectorized version took 10.5 hours (5\u00d7 faster). In contrast, MCMC alone took 574.69 hours,\nleading to 577.69 hours for PRODA. Thus, BINN is 57 times faster than PRODA and can be\nfurther accelerated via PyTorch's Distributed Data Parallel (DDP), enabling parallel training\nacross multiple CPUs. While both approaches achieve parameter interpretability (Section 4.2),\nBINN does so more efficiently by directly integrating the process-based model into the neural\nnetwork architecture, eliminating the need for computationally intensive site-by-site MCMC\noptimization."}, {"title": "6. Determination of SOC over the conterminous US", "content": "To further demonstrate how BINN helps understand processes governing SOC dynamics, we\nconducted a traceability analysis 29. The traceability analysis separates BINN-predicted SOC\nstorage from section 4.2 into carbon influx and ecosystem residence time, with the latter being\ncalculated by dividing carbon storage by carbon influx. The ecosystem residence time is jointly\ndetermined by baseline residence time and the environmental modifier. The decomposition at\neach grid was then averaged across different biomes and visualized in a scatter plot for\ncomparison among the biomes. Biome types were assigned to each grid based on the dominant\necological region within the grid, utilizing the Level 1 Ecological Regions of North America\nmap provided by the US Environmental Protection Agency 30.\nThe traceability analysis revealed that ecosystems with similar average carbon storage,\nwhich is illustrated by the close proximity of the dots to the contour line, can result from distinct\nunderlying processes in different biomes (Figure 7a). For instance, North American Deserts and\nMediterranean California exhibited similar carbon storage, despite contrasting underlying\nmechanisms, with North American Deserts having longer ecosystem carbon residence times\ncoupled with smaller carbon inputs than Mediterranean California. Additionally, Mediterranean\nCalifornia and Northwestern Forested Mountains showed similar SOC residence time (Figure\n7b), which is attributed to similar baseline carbon residence times and environmental scalars."}, {"title": "7. Discussion", "content": "This paper introduces BINN, a novel approach for retrieving model parameters from big data and\npredicting their spatial distributions over the globe, accelerating computational efficiency, and\nfacilitating process understanding."}, {"title": "7.1. BINN's ability to retrieve and predict biogeochemical parameters", "content": "In this study, BINN's ability of retrieving biogeochemical parameters was first validated through\na parameter recovery experiment, which used synthetic SOC data generated by CLM5 with\nprescribed parameter values across the Conterminous US. To minimize the effects of\nequifinality, we performed a sensitivity analysis to select the four most sensitive biogeochemical\nparameters to be retrieved and predicted by BINN. These highly sensitive parameters are often\nwell-constrained in the Bayesian-inference approach. Therefore, we expected BINN to perform\nsimilarly to the Bayesian approach in retrieving these parameters. The retrieval results showed\nthat BINN could accurately recover the prescribed values using only environmental data and\nsynthetic SOC data at each site without the Bayesian method.\nHigh correlations between BINN-retrieved and prescribed biogeochemical parameter\nvalues in a controlled parameter recovery experiment demonstrate BINN's ability to recover\ncausal relationships between covariates and SOC dynamics. Faithful retrieval of biogeochemical\nparameters from data substantially reduces uncertainty in SOC model predictions 26,31.\nWe further tested BINN with real-world SOC observations across the Conterminous US\nand quantified the six model components of CLM5. BINN-predicted model components, which\nare calculated from estimated parameters, showed good agreement with those generated by\nPRODA. Since Bayesian optimization as used in PRODA is widely accepted in earth system\nmodeling for parameter estimation through data assimilation, the agreement between BINN and\nPRODA predictions suggests that BINN can effectively capture spatial variations in critical\nmodel components while maintaining physical interpretability. This enables BINN to evaluate\nthe relative importance of different processes controlling SOC storage, similar to PRODA, while\noffering computational advantages through its integrated neural network architecture."}, {"title": "7.2. BINN's Computational Efficiency", "content": "BINN shows significant improvement in computational efficiency compared to PRODA while\nperforming similar functionality in terms of retrieving parameters and predicting spatial\ndistributions of SOC storage and their components from big data. Compared to PRODA, BINN\nreduces computational time by more than 50-fold in a test with 2,000 profiles. PRODA requires\nrunning a Bayesian optimization algorithm for each site independently; it does not use gradients\nto optimize parameter values but only perturbs parameters randomly and checks if the accuracy\nimproved. By contrast, BINN reimplements the CLM5 process-based model in a differentiable\nway using PyTorch, and leverages this differentiability to rapidly find parameters (for all sites\nsimultaneously) that accurately simulate SOC observations (Table S4). Additionally, we used\nvectorized functions to replace for-loops in the old CLM5 model, which further enhances\ncomputational efficiency. Finally, BINN can utilize PyTorch's Distributed Data Parallel (DDP)\nto parallelize computations, saving real physical time and allowing researchers to iterate more\nquickly on improving the model. High computational efficiency is also more environmentally-\nfriendly, saving energy when dealing with large datasets."}, {"title": "7.3. BINN's facilitation of mechanistic understanding", "content": "BINN's aim is to integrate machine learning and process-based modeling to assist in identifying\ncontrols over biogeochemical systems by leveraging the power of big data. A process-based\nmodel is an abstraction of a real-world system and represents processes that govern the system,\nyet such model-based predictions generally fit poorly with empirical observations 31. This\ndiscrepancy arises because complex systems, such as the terrestrial ecosystems, contain"}, {"title": null, "content": "numerous mechanisms regulating carbon cycling; although some of these mechanisms are well-\nunderstood, many remain unresolved. Process-based models may explicitly represent the well-\nunderstood processes in its structure while using parameters to represent unresolved processes\nWithout taking advantage of the extensive information present in observations, model parameters\nare usually not well constrained.\n26\nWhen these parameters are properly constrained by empirical data, they can more\naccurately reflect the unresolved biogeochemical processes, enabling models to better simulate\necosystem behavior. For example, Liu et al. 32 demonstrated that optimized parameters\nrepresenting xylem water potential in an eco-hydraulic model aligned well with measured values\nfor dominant species across different sites. To effectively learn about unresolved processes\nthrough parameter optimization, model simulations must closely match real-world observations.\nBINN achieves this by optimizing the relationships between environmental covariates and model\nparameters through its neural network component. This optimization process enables BINN-\ntrained CLM5 to simulate soil carbon dynamics more accurately and efficiently than the original\nCLM5, thereby allowing parameters to better represent unresolved processes.\nWhile optimized parameters can represent unresolved biogeochemical processes in well-\nperforming models, deeper scientific analysis is needed to fully understand these processes and\ntheir roles in ecosystems. As demonstrated by traceability analysis, process-based models after\nparameters are constrained can be used to examine how various processes influence SOC storage\nacross space, revealing spatial patterns in mechanisms like carbon residence time as shown in the\nstudy by Tao et al. 2. Furthermore, such a model can help evaluate how newly incorporated\nmechanisms affect existing processes, as demonstrated by Xia et al. 29 in their study of nitrogen\nprocesses' impact on carbon storage capacity."}]}