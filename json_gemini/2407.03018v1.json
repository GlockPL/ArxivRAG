{"title": "An Organism Starts with a Single Pix-Cell:\nA Neural Cellular Diffusion for High-Resolution\nImage Synthesis", "authors": ["Marawan Elbatel", "Konstantinos Kamnitsas", "Xiaomeng Li"], "abstract": "Generative modeling seeks to approximate the statistical\nproperties of real data, enabling synthesis of new data that closely resem-\nbles the original distribution. Generative Adversarial Networks (GANs)\nand Denoising Diffusion Probabilistic Models (DDPMs) represent sig-\nnificant advancements in generative modeling, drawing inspiration from\ngame theory and thermodynamics, respectively. Nevertheless, the explo-\nration of generative modeling through the lens of biological evolution\nremains largely untapped. In this paper, we introduce a novel family\nof models termed Generative Cellular Automata (GeCA), inspired by\nthe evolution of an organism from a single cell. GeCAs are evaluated as\nan effective augmentation tool for retinal disease classification across\ntwo imaging modalities: Fundus and Optical Coherence Tomography\n(OCT). In the context of OCT imaging, where data is scarce and the\ndistribution of classes is inherently skewed, GeCA significantly boosts\nthe performance of 11 different ophthalmological conditions, achieving\na 12% increase in the average F1 score compared to conventional base-\nlines. GeCAs outperform both diffusion methods that incorporate UNet\nor state-of-the art variants with transformer-based denoising models, un-\nder similar parameter constraints.", "sections": [{"title": "1 Introduction", "content": "Retinal diseases rank among the leading causes of vision disabilities and blind-\nness if they remain untreated. Medical imaging modalities such as fundus pho-"}, {"title": "2 Generative Cellular Automata", "content": ""}, {"title": "2.1 An Organism Starts With a Single Pix-Cell", "content": "NCA [18] model an input image with height \u0397 and width W as a grid comprising\nH\u00d7 W entities, which we refer to as pix-cells in our methodology. Each pix-\ncell represents a time-dependent state space representation, facilitating dynamic\nevolution akin to cellular processes in an organism, i.e., image. We parameterize\nthe state of each pix-cell at step mas a vector of scalars, defined as:\n\npix-cellm = {Cin, CV,Cout, Ch},\n\nwhere Cin denotes the input values of the image (e.g., one scalar for grayscale\nand three for RGB input images), CV represents a positional encoding, defined\nby a continuous and smooth sinusoidal function facilitating spatial awareness\nwithin the grid [5,29], Cout refers to the output values indicating a pix-cells's\ntargeted state (equivalent to Cin in dimension), and Ch represents the hidden\nstate variables reflecting the pix-cell's internal state during evolution.\nTo evolve a single pix-cell to a more complex organism\u2014an image, we follow\ntraditional NCA conventional that adopts a stochastic rule [18]. This means a\npix-cell is updated at step m randomly with a probability p, reflecting the non-\nsimultaneous nature of cellular updates in self-organizing organisms. The update\nof a pix-cell focuses on updating only Ch and Cout, given that Cin and Cy are\nconstant. This process, illustrated as GeCA step in Fig. 2, is defined as:\n\npix-cellm+1 = \u0398(pix-cellm, Neighborhoods) + {0,0, Cout, Ch}\n\nDeparting from the hierarchical modeling with M layers in the SOTA Dif-\nfusion Transformer (DiT), we parameterize as a single DiT block featuring\na localized self-attention mechanism, specifically computed across the 8 closest\nneighboring pix-cells. The localized attention strategy, implemented similarly to\nthose in localized transformer-based methods [33,2,27], allows each pix-cell to\ngrow independently by applying Eq. (2) for M times, using the same \u0398. GeCA's\napproach shifts the focus in image generation towards local spatial interactions,\nmoving away from the global context reliance observed in traditional models\nsuch as UNet [25] and standard transformers [29]. Nevertheless, GeCA achieves\nglobal coherence by accumulating long-term state-space representation via Ch,\naligning with the foundational concepts documented in NCA [18,26,27,11,13,21],\nMamba [7], universal transformers [4], and MLP-mixers [28]."}, {"title": "2.2 Cellular Diffusion: Evolving Cells into Organisms", "content": "To train our model parameters, we utilize the well-established diffusion process\nfirst introduced in [8] with specific modifications in the forward and reverse steps.\nDuring the forward diffusion process, we initialize Cout and Ch with zeros, except\nfor a single pix-cell located at the center of the H x W grid, which is initialized\nwith random scalars to serve as the starting point for the cellular process. Cr"}, {"title": "2.3 Improved Reverse Sampling via Gene Heredity", "content": "Representing an input image with pix-cells, a time-dependent state space rep-\nresentation, GeCA preserves long-term information within its internal hidden\nstates, Ch, analogous to genetic material. Thus, we propose leveraging Ch at\ntime t +1 to guide the reverse generation of time t, mirroring the inheritance of\ngenetic traits. Specifically, we modify each step in the reverse process to initiate\nthe pix-cell hidden states, Ch, as:\n\nC =\n[\u20ac~N(0, I) if t = T and grid-center pix-cell,\nC+1\notherwise.\n\nSimultaneously, Cout, for the grid-center pix-cell at each timestep is defined as:\n\nCout ~N(0,I)\n\nOur proposed process, termed Gene Heredity Guidance (GHG), sets the stage\nfor denoising Cin and refining Ch from a plausible starting point. Following\nGHG, the denoising process to sample a synthetic pix-cell, Cin, adheres to tra-\nditional diffusion steps till t \u2192 0 as:\n\nC=\nC1\n\u221a\n\u221a1-at-1\n(-).\n\nNote that without our proposed GHG, the application of NCA in generative\nmodeling is suboptimal (See Fig. 5)."}, {"title": "2.4 Retinal Disease Classification", "content": "Classifying retinal disease from OCT images presents significant challenges\ndue to data scarcity and skewed class distributions. In light of these challenges,\nwe leverage generative modeling to augment the dataset effectively, a strategy\nproven to significantly enhance downstream classification tasks compared to con-\nventional augmentation techniques [6,35].\nFollowing [35], we synthesize a training set expanded five-fold, mirroring the\noriginal training set's distribution. Given the original dataset's class distribution\nPorig(y), with y representing the dataset labels and Norig as the original dataset\nsize, the objective is to expand the dataset five-fold to Naug = 5 \u00d7 Norig, while\npreserving Porig(y). This is achieved by ensuring that the count of each label y\nin the augmented dataset, Countaug (y), is five times its original count as:\n\nPaug(y) = Porig(y), where Countaug(y) = 5 \u00d7 Countorig(y)\n\nBy preserving the original label distribution Porig(y) in the augmented dataset,\nwe maintain the dataset's inherent distribution to avoid any potential bias."}, {"title": "3 Experiments", "content": "Datasets. We evaluate our model using two different datasets: OCT and Fun-\ndus. The multi-label OCT dataset, OCT-ML, is an in-house dataset consisting\nof 1435 samples from 369 eyes of 203 patients considering multiple diseases in-\ncluding normal, dry age-related macular degeneration (dAMD), wet age-related\nmacular degeneration (wAMD), diabetic retinopathy (DR), central serous chori-\noretinopathy (CSC), pigment epithelial detachment (PED), macular epiretinal\nmembrane (MEM), fluid (FLD), exudation (EXU), choroid neovascularization\n(CNV), and retinal vascular occlusion (RVO). Additionally, we provide the code\nnecessary for both the generation process and the classification task, applied to\nDeepDRID [16], a publicly available fundus imaging dataset encompassing five"}, {"title": "4 Conclusion", "content": "We present GeCA, an innovative model outperforming current image genera-\ntion benchmarks through neural cellular automata, demonstrated on challeng-\ning multi-label OCT classification. Future directions include broadening GeCA's\nvalidation across various domains and exploiting its unique capabilities, such as\nchannel dimension selective sampling and temporal scheduling of its updates."}]}