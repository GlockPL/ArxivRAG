{"title": "Symmetry Adapted Residual Neural Network Diabatization: Conical\nIntersections in Aniline Photodissociation", "authors": ["Yifan Shen", "David R. Yarkony"], "abstract": "We present a symmetry adapted residual neural network (SAResNet)\ndiabatization method to construct quasi-diabatic Hamiltonians that accurately represent ab initio\nadiabatic energies, energy gradients, and nonadiabatic couplings for moderate sized systems. Our\nsymmetry adapted neural network inherits from the pioneering symmetry adapted polynomial\nand fundamental invariant neural network diabatization methods to exploit the power of neural\nnetwork along with the transparent symmetry adaptation of polynomial for both symmetric and\nasymmetric irreducible representations. In addition, our symmetry adaptation provides a unified\nframework for symmetry adapted polynomial and symmetry adapted neural network, enabling\nthe adoption of the residual neural network architecture, which is a powerful descendant of the\npioneering feedforward neural network. Our SAResNet is applied to construct the full 36-\ndimensional coupled diabatic potential energy surfaces for aniline N-H bond photodissociation,\nwith 2,269 data points and 32,640 trainable parameters and 190 cm\u00af\u00b9 root mean square deviation\nin energy. In addition to the experimentally observed \u03c0\u03c0* and Rydberg/\u03c0\u03c3* states, a higher state\n(HOMO - 1 \u03c0 to Rydberg/o* excitation) is found to introduce an induced geometric phase effect\nthus indirectly participate in the photodissociation process.", "sections": [{"title": "I. INTRODUCTION", "content": "When conical intersections1-4 are involved in a nonadiabatic process5-8, a quasi-diabatic9,10\nHamiltonian (Hd) can greatly facilitate a reliable simulation. A variety of diabatizations have\nbeen reported in the literature, based on: smooth molecular properties, 11\u201316 ansatz of diabatic\nstates, 17-20 configuration uniformity, 21-27 and nonadiabatic couplings.28\u201331 When accuracy is the\nprimary concern, it would be safest for diabatizations to employ multireference electronic\nstructure methods which provide nonadiabatic couplings explicitly and analytically, such as\nmulti-configurational self-consistent field32\u201335 (MCSCF), extended multistate multireference\nsecond-order perturbation theory36,37 (XMS-MRPT2), quasi-degenerate N-electron valence state\nsecond-order perturbation theory38 (QD-NEVPT2), and multireference configuration\ninteraction39,40 (MRCI).\nThe focus of this work is the nonadiabatic-coupling-based regression method which\naccurately fits Hd to energies, energy gradients, and nonadiabatic couplings obtained from ab\ninitio electronic wave functions.41\u201355 To exclude the distraction from external degrees of\nfreedom, the regression is performed in internal rather than Cartesian coordinates. This internal\ncoordinate system is not limited to bond lengths and angles and 3N - 6 degree of freedoms;\ninstead, it can take any functional form and be redundant, so it is more appropriate to be\nconsidered as a feature extraction"}, {"title": "II. THEORY", "content": null}, {"title": "II.A Symmetry adapted neural network", "content": "Let us start with the mathematical form of NN. A standard N-layer feedforward NN is a\nsequence of N linear and non-linear transformations operated on the input vector x\u00ba to obtain the\nN+1\noutput vector y\n\ny^{n} = W^{n}x^{n-1} + b^{n}, 1 \u2264 n \u2264 N + 1\n\nx^{n} = A(y^{n}), 1 \u2264 n \u2264 N\n\nWhere n is the layer index (0 is the input layer, N+1 is the output layer, 1 to N are the hidden\nlayers), x is the neuron value vector, W is the linear combination weight matrix, b is the linear\ncombination bias vector, y is the linearly transformed neuron value vector, A is the non-linear\nactivation function.\nTo adapt to symmetry, we utilize SAP as x\u00ba, i.e., each vector element of x is an SAP term.\nFor abelian groups, under symmetry operation \u00d4 (e.g., in CNPI group symmetry, can be the\npermutation of identical nuclei or the inversion of the entire molecule), x\u00ba would preserve its\nabsolute value, but its sign may or may not\n\n\u00d4x\n= \nx\u00ba, symmetric\n(-x\u00ba, asymmetric\n{"}, {"title": null, "content": "Non-abelian groups are beyond the scope of this paper. Although \u00d4 is defined to operate on x\u00ba,\nit also operates on the consecutive xs and ys since they are derived from x\u00ba. W and b and A have\nno dependence on x\u00ba, so \u00d4 has no effect on them and they commute with \u00d4.\nIf we constrain x\u00ba to be totally symmetric xs, i.e., \u00d4xs = xs for all possible \u00d4, then we\narrive at FINN\n\n\u00d4y_{s}^{1} = W_{s}^{1}\u00d4x_{s}^{0} + b_{s}^{1} = W_{s}^{1}x_{s}^{0} + b_{s}^{1} = y_{s}^{1}\n\n\u00d4x_{s}^{1} = A(\u00d4y_{s}^{1}) = A(y_{s}^{1}) = x_{s}^{1}\n\n\u00d4y_{s}^{N+1} = W_{s}^{N+1}\u00d4x_{s}^{N} + b_{s}^{N+1} = ... = y_{s}^{N+1}\n\nWhere subscript s is short for symmetric. What if we demand asymmetric xa? In another word,\nthere exists at least one \u00d4 such that \u00d4x = -x\n\n\u00d4y_{a}^{1} = W_{a}^{1}\u00d4x_{a}^{0} + b_{a}^{1} = \u2212W_{a}^{1}x_{a}^{0} + b_{a}^{1}\n\n\u00d4x_{a}^{1} = A(\u00d4y_{a}^{1})\n\nWhere subscript a is short for asymmetric. As we can see from Equation (4a), \u00d4y does not\nnecessarily equal to -ya, unless b = 0\n\ny_{a}^{1} = W_{a}^{1}x_{a}^{0} + b_{a}^{1} = W_{a}^{1}x_{a}^{0}\n\n\u00d4y_{a}^{1} = W_{a}^{1}\u00d4x_{a}^{0} = -W_{a}^{1}x_{a}^{0} = -y_{a}^{1}\n\nPlug Equation (5) into Equation (4b)"}, {"title": null, "content": "\n\u00d4x_{a}^{1} = A(\u00d4y_{a}^{1}) = A(-y_{a}^{1})\n\nEquation (6) indicates that to have \u00d4x = -x, A must be an odd function\n\n\u00d4x_{a}^{1} = A_{odd}(-y_{a}^{1}) = - A_{odd}(y_{a}^{1}) = -x_{a}^{1}\n\nBy induction, now the sign flip gets carried all the way down to the output layer as we wish\n\n\u00d4y_{a}^{N+1} = W_{a}^{N+1}\u00d4x_{a}^{N} = \u2026 = \u2212y_{a}^{N+1}\n\nIn summary, the mathematical form of symmetry adapted neural networks (SANN) for the\nasymmetric irreducibles is\n\ny_{a}^{n} = W_{a}^{n}x_{a}^{n-1}, 1 \u2264 n \u2264 N + 1\n\nx_{a}^{n} = A_{odd} (y_{a}^{n}), 1 \u2264 n \u2264 N\n\nAmong the conventional activation functions, the hyperbolic tangent (tanh) is an odd function, so\nwe would stick to Aodd = tanh in this work. For the totally symmetric irreducible, SANN does not\nhave to be different from FINN\n\ny_{s}^{n} = W_{s}^{n}x_{s}^{n-1} + b_{s}^{n}, 1 \u2264 n \u2264 N + 1\n\nx_{s}^{n} = A(y_{s}^{n}), 1 \u2264 n \u2264 N\n\nAlthough we possess the flexibility to adopt arbitrary activation function, since tanh is still a\nlegitimate choice, we would also stick to A = tanh in this work. Xavier initialization67 is then\napplied in accordance with tanh."}, {"title": "II.B Residual connection", "content": "One desirable property of SANN is that SANN regression is a natural extension of SAP\nregression, which can now be considered as a 0-layer SANN regressor.\n\ny_{s}^{1} = W_{s}^{1}x_{s}^{0}\n\ny_{s}^{1} = W_{s}^{1}x_{s}^{0} + b_{s}^{1}\n\nThis unification of SAP and SANN allows us to benefit from the success of both polynomial and\nneural network diabatizations by combining the SAP and the SANN outputs together\n\ny_{a}^{n} = W_{a}^{n}x_{a}^{n-1}, 1 \u2264 n \u2264 N\n\nx_{a}^{n} = A_{odd}(y_{a}^{n}), 1 \u2264 n \u2264 N\n\ny_{a}^{N+1} = W_{a}^{N+1}x_{a}^{N} + W_{res}^{N+1}x_{res}^{0}\n\ny_{s}^{n} = W_{s}^{n}x_{s}^{n-1} + b_{s}^{n}, 1 \u2264 n \u2264 N\n\nx_{s}^{n} = A(y_{s}^{n}), 1 \u2264 n \u2264 N\n\ny_{s}^{N+1} = W_{s}^{N+1}x_{s}^{N} + b_{s}^{N+1} + W_{res}^{N+1}x_{res}^{0}\n\nComputer scientifically, this combination of the SAP and the SANN outputs is a residual\nconnection, which upgrades the simple feedforward NN to the ResNet, so our SANN also gets\nupgraded to SAResNet. ResNet offers many benefits, including the avoidance of vanishing\ngradients, the mitigation of degradation, etc. Chemically, SAResNet reflects the idea of utilizing\nlow-order polynomial for qualitative correctness and complicated functions (such as NN) for\nquantitative correction. One illustrative scenario is the bound coordinates. Consider a bound"}, {"title": "II.C Diabatization protocol", "content": "The complete Hd model includes:\n1. Feature extraction from Cartesian coordinate: convert Cartesian coordinates to CNPI\ngroup symmetry adapted internal coordinates.\n2. Polynomial features: multiply CNPI group symmetry adapted internal coordinates to\nobtain SAPs.\n3. SAResNet: instantiate one SAResNet for each Hd matrix element, then according to the\nHd matrix element irreducible use the same-irreducible SAP as the input layer, finally\nprocess the input SAP with Equations (12a) to (12c) if asymmetric or (12d) to (12f) if\nsymmetric.\n4. Hd matrix: collect all SAResNet outputs into one real symmetric matrix."}, {"title": "III. RESULTS AND DISCUSSION", "content": "Aromatic amines are present in many biological molecules such as the DNA bases, so their\nspectroscopy and photochemistry are of great interest to understand and treat UV-induced\nmutagenesis and carcinogenesis. 72,73 As the prototypical aromatic amine, aniline (C6H5NH2)\nserves as a steppingstone to greater understanding of the photodynamics of more complex\naromatic amines. The lowest-energy photodissociation channel in aniline is the N-H bond\nbreaking:\n\nC6H5NH2 + hu \u2192 C6H5NH + H\n\nThe other dissociation channels, e.g. the C-N bond breaking, are at least 2 eV higher,74\nconsuming at least 50% more energy than the N-H bond breaking, so they are beyond the scope\nof this paper.\nBased on experiments74\u201379 and computations, 80-83 for the lowest and fastest dissociation\nthere are 3 singlet states involved: the closed-shell ground state (So), a \u03c0\u03c0* state (S1), and a\n\u03c0Rydberg/\u03c0\u03c3* state (S2). Since the highest possible point group aniline can possess is C2v, we\nmake symmetry arguments with the G4 subgroup of the CNPI group, which is isomorphic to C2v.\nTherefore, we can label these states of interest more clearly by G4 irreducibles: So is \u00b9A1, S2 is\n\u00b9B1, S1 is 'B2. A \u00b9A2 state (HOMO - 1 \u03c0 to Rydberg/\u03c3* excitation) is additionally computed since\nwith 'B2 it forms a conical intersection, which is then found to introduce an induced geometric\nphase effect."}, {"title": "III.A Electronic structure", "content": "We collect ab initio electronic structure data from a multireference configuration interaction\nwith single and double excitation (MRCISD) description, with 18 frozen core orbitals and a 14-\nelectron 14-orbital restricted active space up to double excitation. The active space consists of\nthe 7 I orbitals, a 3s Rydberg orbital, the 2 N-\u0397 \u03c3 and \u03c3* pairs, and the C-N \u03c3 and \u03c3* pair. The\n2-external excitations from the lowest two active orbitals are excluded. This MRCISD is\ncomprised of 158,587,185 configuration state functions.\nA standard atomic orbital basis set (cc-pVTZ84 for the nitrogen and the carbons, cc-pVDZ84\nfor the hydrogens) is sufficient to describe the valence orbitals, but the 3s Rydberg orbital\nrequires a special diffuse function. To generate it, following Roos et al.85 we place a set of\ndiffusive Gaussian functions on the nitrogen, run complete active space self-consistent field on\nthe self-consistent field optimized \u00b9B1 state minimum, then take the linear combination\ncoefficients. In addition, due to the linear-dependency issue, we shrink the outmost p orbital of\nnitrogen and s orbital of carbon by a factor of 3. The customized atomic orbital basis set and\nother details are reported in supporting information. All electronic structure computations are\nperformed using the COLUMBUS39,40,86\u201392 suite of programs."}, {"title": "III.B Construction of Hd", "content": "Although G4 is enough to interpret the electronic structure data, it misses out the amino\n(NH2) group rotation, which requires a G8 group to capture. The fact that all interesting"}, {"title": "III.C Photodissociation mechanism", "content": "Starting from equilibrium, ultraviolet photon vertically and diabatically excites aniline from\n1A1 to \u00b9B2, since the transition dipole moment from \u00b9A1 to \u00b9B2 is 20 times larger than the one\nfrom A1 to B1. Through internal conversion facilitated by the \u00b9B1-\u00b9B2 conical intersection, the\nelectronic wave function propagates from B2 to B1, which would then lead to dissociation. The\nB\u2081 state is initially bound but would turn dissociative after a saddle point, due to the character\nswitch from Rydberg to \u039d-\u0397 \u03c3*. \u0391 \u00b9A1-\u00b9B\u2081 conical intersection sits between the saddle point and\nthe dissociation limit, branching the wave packet into a fast direct B\u2081 dissociation and a \u00b9A1\nrebound back to the bound region. Although not observed in experiment since not directly\ninvolved in the dissociation dynamics, a 'B2-\u00b9A2 conical intersection exists between the saddle\npoint and the 'A1-\u00b9B1 conical intersection.\nAn ensemble of nonadiabatic trajectories say the photodissociation mechanism best. We run\nfewest switches surface hopping based on our constructed Hd and illustrate a representative\ntrajectory in Figure 3. As we can see from Figure 3, the trajectory starts at min-\u00b9A1, with an\nultraviolet photon electronically exciting aniline from A1 to \u00b9B2. Following the potential energy\ncurvature, aniline goes from min-1A1 to mex-\u00b9B1-B2, where it circles around the dual mex-\u00b9B1-\n\u00b9B2 for 40 fs to transfer electronic population from 'B2 to \u00b9B1. After the 'B2 to \u00b9B\u2081 transition,\naniline would stay close to mex-\u00b9B1-B2 for another 200 fs to accumulate kinetic energy along\nthe N-H stretching. Finally, with ample kinetic energy, aniline breaks through sad-\u00b9B1 and\nmarches toward the dissociation limit. In this trajectory, aniline would stay on the B\u2081 state when\npassing through mex-\u00b9A1-\u00b9B\u2081 and reach the dissociation limit, which only takes 20 fs from sad-\nB\u2081 to the asymptote. In other trajectories, aniline may undergo another internal conversion to\n1\nfall back to the A\u2081 state, which is a bound state and would bring aniline back to the bound\nregion."}, {"title": "IV. CONCLUSION", "content": "We have presented a SAResNet diabatization method to construct Hd that accurately represents\nab initio adiabatic energies, energy gradients, and nonadiabatic couplings for moderate sized\nsystems. Our SANN inherits from the pioneering SAP and FINN diabatization methods to\nexploit the power of NN along with the transparent symmetry adaptation of polynomial for both\nsymmetric and asymmetric irreducible representations. In addition, our symmetry adaptation\nprovides a unified framework for SAP and SANN, enabling the adoption of ResNet architecture,\nwhich is a powerful descendant of the pioneering feedforward NN. Our SAResNet is applied to\nconstruct the full 36-dimensional coupled diabatic potential energy surfaces for aniline N-H bond\nphotodissociation, with 2,269 data points and 32,640 trainable parameters and 190 cm\u00af\u00b9 root\nmean square deviation in energy. In addition to the experimentally observed 'B\u2081 and B2 states, a\nhigher \u00b9A2 state is found to introduce an induced geometric phase effect thus indirectly\nparticipate in the photodissociation process. The photodissociation dynamics of aniline will be\ndetermined employing the constructed Hd in future work. Intersystem crossings in aniline98\u2013100\nwill also be investigated in future work."}]}