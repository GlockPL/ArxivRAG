{"title": "ST-Mamba: Spatial-Temporal Mamba for Traffic\nFlow Estimation Recovery using Limited Data", "authors": ["Doncheng Yuan", "Jianzhe Xue", "Jinshan Su", "Wenchao Xu", "Haibo Zhou"], "abstract": "Traffic flow estimation (TFE) is crucial for urban\nintelligent traffic systems. While traditional on-road detectors are\nhindered by limited coverage and high costs, cloud computing\nand data mining of vehicular network data, such as driving\nspeeds and GPS coordinates, present a promising and cost-\neffective alternative. Furthermore, minimizing data collection can\nsignificantly reduce overhead. However, limited data can lead to\ninaccuracies and instability in TFE. To address this, we introduce\nthe spatial-temporal Mamba (ST-Mamba), a deep learning model\ncombining a convolutional neural network (CNN) with a Mamba\nframework. ST-Mamba is designed to enhance TFE accuracy and\nstability by effectively capturing the spatial-temporal patterns\nwithin traffic flow. Our model aims to achieve results comparable\nto those from extensive data sets while only utilizing minimal\ndata. Simulations using real-world datasets have validated our\nmodel's ability to deliver precise and stable TFE across an urban\nlandscape based on limited data, establishing a cost-efficient\nsolution for TFE.", "sections": [{"title": "I. INTRODUCTION", "content": "Traffic flow estimation (TFE) assumes paramount impor-\ntance in the operation of traffic systems, particularly in light of\nthe escalating volume of vehicles and the expansion of trans-\nportation networks [1] [2]. The conventional methods of TFE,\nemploying on-road detectors like cameras and inductive loops,\nexhibit limited coverage and substantial expenses associated\nwith infrastructure installation and maintenance [3]. Utilizing\ndata from vehicular network can expand the scope of TFE,\nwhile the collection and transmission of massive data also\nencounter technical and economic challenges. Considering the\nconstraints of existing methods, it is cost-effective to utilize\nlimited data from vehicular network to obtain real-time TFE by\ncloud computing [4] [5]. However, when the amount of traffic\ndata decreases, the resulting TFE tends to be inaccurate and\nunstable [6]. With the advancement of artificial intelligence,\nemploying deep learning methods to recover TFE from limited\ndata emerges as a feasible and promising approach.\nLately, deep learning methods have been developed to ex--\nplore features of traffic flow [7] [8]. The convolutional neural\nnetwork (CNN) is proficient in extracting spatial features\nof input through convolutional operations [9]. The recurrent\nneural network (RNN) and its variants such as long short-\nterm memory (LSTM) are designed to capture sequential or\ntemporal features of input by utilizing recurrent connections\n[10]. Mamba, an advanced neural network based on state space\nmodel (SSM), is effective at processing sequential data and\nmodeling temporal correlation via selection mechanism [11].\nMoreover, some methods combine the functions of CNN and\nRNN. For instance, the Conv-LSTM module is proposed to\nforecast short-term traffic flow via learning spatial-temporal\ndependencies [12]. However, existing works primarily focus on\ntraffic flow prediction rather than estimating real-time traffic\nflow, and are provided with sufficient data instead of limited\ndata. To enhance estimation accuracy with limited data, there\nis a need to design a specialized spatial-temporal model for\ntraffic flow estimation recovery.\nIn this paper, we investigate the TFE utilizing limited\ndata and propose a spatial-temporal deep learning method to\nrecover both the accuracy and stability of TFE. The framework\nof TFE with limited vehicular network data is illustrated in\nFig. 1. We divide the city map evenly into grids, each of which\nrepresent a specific region in the city. The data limitation in our\nscheme refers to the practice of randomly sampling a subset of\nvehicles across the city with equal probability of recruitment\nat each time interval [6]. Following the collection of limited\ndata, the traffic information comprising vehicle speeds and\nGPS coordinates are matched to corresponding grids. The\ncondition of traffic flow within each grid is represented by\nthe average speed of vehicles over a defined period. For the\nrecovery of TFE, we propose a novel deep learning model,\nnamed as spatial-temporal Mamba (ST-Mamba), to generate\nstable and accurate TFE via effectively leveraging the spatial-\ntemporal features of traffic flow. Specifically, we employ the\nCNN to capture the local spatial correlation of traffic flow,\nand utilize the Mamba to model the temporal correlation of\neach grid in the map. The main contributions of this paper are\nlisted as the following:\n\u2022 We present a novel approach for cost-effective TFE,\nutilizing only a small fraction of vehicular network data\nto alleviate the burden on network communication and\nmitigate the expenses of traffic systems.\n\u2022 We design a spatial-temporal deep learning model named\nas ST-Mamba, consisting of CNN and Mamba, to recover\nthe TFE with limited vehicular network data."}, {"title": "II. FRAMEWORK AND PROBLEM ANALYSIS", "content": "This section consists of two parts. First, the framework\nfor TFE with limited network data is delineated. Then, the\nproblem of recovering estimation from limited network data\nis formulated.\nA. Framework for TFE with Limited Data\nThe process of recovering TFE from limited data is il-\nlustrated in Fig. 1. First, we divide the city map evenly\ninto grids. Meanwhile, the limited data of vehicle mobility\ninformation is gathered from vehicular network by traffic\ndata collector. Instead of removing data from some specific\nregions, we acquire the limited data by randomly selecting a\nsmall fraction of vehicles as data sources uniformly distributed\nacross the city, with equal probability of recruitment for each\nvehicle. Following the limited data collection, we design a\nmatching process between the data and the grid-structured city\nmap. Then, the original estimation is acquired via computing\nthe average speeds of vehicles in each grid to construct the\ntraffic flow image. Lastly, the recovery algorithm is applied to\ngenerate precise TFE based on the limited data.\nAs to the specific scheme of our work, we first obtain\nthe city map consisting of grids with equal size and number\nof H*W. Corresponding to reality, each grid in the map\nrepresents a particular region of the city. We construct the\ngrid-structured city map as,\n$$M =\n\\begin{bmatrix}\nm_{1,1} & \\cdots & m_{1,W} \\\\\n\\vdots & m_{h,w} & \\vdots \\\\\nm_{H,1} & \\cdots & m_{H,W}\n\\end{bmatrix}$$\nwhere $m_{h,w}$ indicates the grid of map which is located at\n$(h,w)$, H and W can be viewed as the height and width of\nthe map.\nWith the construction of grid-structured city map, the ve-\nhicular network data are matched to respective grids based on\nthe GPS coordinates of vehicles. We first obtain the vehicle\nmobility dataset $V_t$ with sufficient data, which is collected at\ntime slot $t$ under ideal circumstances. Subsequently, with the\ngrid matching outcomes of $V_t$ and M, the ideal estimation of\ntraffic flow is calculated as,\n$$z_{h,w}^t = Mean(v_{h,w} | v_{h,w} \\in V_t),$$\n$$Z_t =\n\\begin{bmatrix}\nz_{1,1}^t & \\cdots & z_{1,W}^t \\\\\n\\vdots & z_{h,w}^t & \\vdots \\\\\nz_{H,1}^t & \\cdots & z_{H,W}^t\n\\end{bmatrix}$$\nwhere the mobility information of vehicles in the grid located\nat $(h, w)$ is described as $v_{h,w}$, $z_{h,w}^t$ is the average speed of\nvehicles obtained from sufficient data in the grid located at\n$(h, w)$ at time slot $t$, $Z_t$ represents the ideal estimation of\ntraffic flow at time slot $t$.\nThen, the acquisition of TFE from limited data is conducted\nas follows. We denote the limited vehicle mobility information\ngathered at time slot $t$ as $V_t'$, which is obtained through\nrandom sampling from the sufficient dataset $V_t$, i.e., $V_t' \\subseteq V_t$.\nThis sampling approach assigns equal selection probability to\neach piece of vehicle mobility information. With a similar\ncalculating and matching process, the original estimation of\ntraffic flow at time slot $t$ is denoted as,\n$$x_{h,w}^t = Mean(v_{h,w} | v_{h,w} \\in V_t'),$$\n$$X_t =\n\\begin{bmatrix}\nx_{1,1}^t & \\cdots & x_{1,W}^t \\\\\n\\vdots & x_{h,w}^t & \\vdots \\\\\nx_{H,1}^t & \\cdots & x_{H,W}^t\n\\end{bmatrix}$$\nwhere $x_{h,w}^t$ is the average speed of vehicles obtained from\nlimited data in the grid located at $(h, w)$ at time slot $t$, $X_t$\nrepresents the city-wide original estimation of traffic flow at\ntime slot $t$. Note that both $X_t$ and $Z_t$ can be perceived as\nimages with a resolution of H * W and four channels, where\nthe amount of channels is decided by the types of driving\ndirections defined in our work, i.e., east, south, west, and north.\nFinally, we apply the specifically designed deep learning\nmodel to recover the original estimation $X_t$. The ideal es-\ntimation $Z_t$ not only serves as the ground truth label for the\nlearning of the model, but also is the target data that the model\nexpects to output. Following the training and inference of the\nmodel, we obtain the recovered TFE from limited data, which\nis reliable and cost-effective."}, {"title": "B. Problem of Traffic Flow Estimation", "content": "Based on the limited data, we can obtain the original\nestimation of traffic flow approximating the ideal one. How-\never, the original estimation exhibits a considerable degree\nof inaccuracy and instability regardless of the similarity. In\nother words, we found that there exits abundant noise in each\ngrid of original TFE $X_t$, which fails to serve as the definitive\nestimation for the applications of urban transportation systems.\nTherefore, the task of real-time TFE with limited network data\nis conceptualized as a grid-structured data recovery problem.\nWe set the input of the recovery model to be the historical\nand current estimations of traffic flow derived from limited\ndata, represented as $[X_{t-L+1}, ..., X_{t-1}, X_t]$. The objective\nis to reform an estimation of current traffic flow with high\naccuracy and stability, mirroring the ideal estimation $Z_t$\nderived from sufficient data. Therefore, the crux of the TFE\nproblem lies in ascertaining the mapping function $F(\\cdot)$,\n$$Z_t = F([X_{t-L+1}, ..., X_{t-1}, X_t]),$$\nwhich aims to fully explore the spatial-temporal dependencies\nof traffic flow, mitigate the noise resulting from the data\nlimitation, and transform the original TFE derived from limited\ndata into a precise estimation of current traffic flow."}, {"title": "III. ST-MAMBA FOR TRAFFIC FLOW RECOVERY", "content": "In this section, we present the ST-Mamba designed to\nrecover accurate and stable TFE from limited network data\nby exploring and aggregating the features of traffic flow. The\nnetwork structures employed for capturing the spatial and\ntemporal correlations by the CNN and Mamba are discussed.\nSubsequently, we provide an overview of the architecture\nbelonging to the ST-Mamba.\nA. Spatial Correlation Modeling\nIn our framework, the estimation of traffic flow can be\nviewed as an image with a resolution of H * W and four\nchannels. The spatial correlation of traffic flow is inherent\nin the grid structure. Given that the condition of traffic\nflow in one region is impacted by those in adjacent regions\nwhile the influence wanes with increasing spatial distance, the\naggregation of spatial information from neighboring regions\nis imperative for accurate TFE. CNN is a classic and concise\nneural network suitable for processing grid-structured data,\nthe principle of which is convolving input data with learnable\nfilters to detect local patterns [9]. In recognition of the features\nof traffic flow, we employ CNN for capturing local spatial\ncorrelation of traffic flow from the entire traffic flow image.\nWe first conduct convolutional operations by CNN sepa-\nrately on four channels of the image, capturing spatial corre-\nlation of each driving direction. The working process of the\nCNN in our model can be denoted as,\n$$X_n' = CNN_e(X_n),$$\nwhere subscript $n$ ranges from $t - L + 1$ to $t$, $X_n \\in \\mathbb{R}^{4 \\times H \\times W}$\nis the original TFE derived from limited data at time slot $n$,\n$X_n' \\in \\mathbb{R}^{4 \\times H \\times W}$ contains the spatial correlation captured by\nCNN. Then, we utilize a fully connected (FC) layer to lift\ndata dimension and integrate spatial correlations of different\ndriving directions. The FC layer is operated as,\n$$X_n'' = FC(X_n'),$$\nwhere $X_n'' \\in \\mathbb{R}^{K \\times H \\times W}$ is the high-dimensional feature rep-\nresentation of $X_n'$ in latent space. Subsequently, one reshape\nlayer is constructed to serialize the format of traffic data. The\nsequential traffic data of each grid can be obtained as,\n$$I_{h,w} = Concat(x_{h,w}'' | n = t - L + 1, ... t - 1, t),$$\nwhere $Concat(\\cdot)$ is the concatenating operation, $I_{h,w}$ is the\nspatial feature representation in one grid of $X_n''$, $I \\in \\mathbb{R}^{K \\times L}$\nis the sequence comprising spatial correlation of traffic flow\nin one grid of $X_n$.\nB. Temporal Correlation Modeling\nThe temporal correlation of traffic flow is hidden in the\nsequential structure. The original TFE at time slot t, combined\nwith those at preceding (L - 1) time slots, are utilized to\nconstruct sequential traffic data for recovering TFE at current\ntime slot t. Mamba is an advanced neural network especially\neffective at processing sequential data and modeling temporal\ncorrelation. Integrating the selection mechanism which asso-\nciates the parameters of SSM with the input, Mamba is able to\nfocus on relevant inputs and ignore irrelevant ones, executing\nlinear-time processing of sequences while maintaining high\nperformance [13]. It is appropriate to employ Mamba for\nlearning the complex temporal correlation of traffic flow."}, {"title": "IV. SIMULATION AND RESULTS", "content": "In this section, we assess our method utilizing the real traffic\ndata from Beijing. We begin by the experimental settings\ncomprising the dataset, baselines, and evaluation metrics.\nThen, we present and analyze the estimation performance.\nA. Experimental Setting\nThe simulation utilizes the real traffic data sourced from the\nFourth Ring Road in Beijing. Our dataset includes 6 days in\n2012, and the time period for TFE spans from 7:30 AM to\n10:30 PM [6]. The resolution of TFE image is 100\u00d7100. The\nlimited data is obtained by random sampling from sufficient\ndata, where the limitation degree indicates the proportion of\nsampled data. Our approach is compared with the following\nfour baselines:\n\u2022 Original: The original estimation derived from limited\ndata, and the input of deep learning models.\n\u2022 CNN: A convolutional neural network designed to cap-\nture spatial correlation by convolutional operations [9].\n\u2022 PredRNN: A recurrent neural network proposed to cap-\nture spatial-temporal dependencies for coherent future\nframe forecasting [14].\n\u2022 SimVP: A simple yet powerful architecture for video\nprediction, which makes the most of CNN and its variants\nto explore spatial-temporal correlations [15].\nMeanwhile, we select three metrics to evaluate the per-\nformance of models. Root mean squared error (RMSE) as-\nsesses the recovery accuracy by penalizing larger errors more\nheavily. Improved percentage (IP) demonstrates the recovery"}, {"title": "V. CONCLUSION", "content": "In this paper, we studied the framework for TFE utilizing\nlimited data from the vehicular network. We analyzed the TFE\nrecovery problem caused by the limitation of traffic data avail-\nability. To address this issue, we designed a spatial-temporal\ndeep learning model named as ST-Mamba to improve the\nestimation accuracy and stability. Comprehensive simulation\nresults based on the real-world dataset have validated the effec-\ntiveness of ST-Mamba in processing sequential grid-structured\ndata. Our approach provides a cost-effective solution for TFE\nin scenarios with limited data. For future work, we intend to\nexplore the traffic flow prediction based on limited data."}]}