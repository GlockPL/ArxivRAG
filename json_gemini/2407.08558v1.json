{"title": "ST-Mamba: Spatial-Temporal Mamba for Traffic Flow Estimation Recovery using Limited Data", "authors": ["Doncheng Yuan", "Jianzhe Xue", "Jinshan Su", "Wenchao Xu", "Haibo Zhou"], "abstract": "Traffic flow estimation (TFE) is crucial for urban intelligent traffic systems. While traditional on-road detectors are hindered by limited coverage and high costs, cloud computing and data mining of vehicular network data, such as driving speeds and GPS coordinates, present a promising and cost-effective alternative. Furthermore, minimizing data collection can significantly reduce overhead. However, limited data can lead to inaccuracies and instability in TFE. To address this, we introduce the spatial-temporal Mamba (ST-Mamba), a deep learning model combining a convolutional neural network (CNN) with a Mamba framework. ST-Mamba is designed to enhance TFE accuracy and stability by effectively capturing the spatial-temporal patterns within traffic flow. Our model aims to achieve results comparable to those from extensive data sets while only utilizing minimal data. Simulations using real-world datasets have validated our model's ability to deliver precise and stable TFE across an urban landscape based on limited data, establishing a cost-efficient solution for TFE.", "sections": [{"title": "I. INTRODUCTION", "content": "Traffic flow estimation (TFE) assumes paramount importance in the operation of traffic systems, particularly in light of the escalating volume of vehicles and the expansion of transportation networks [1] [2]. The conventional methods of TFE, employing on-road detectors like cameras and inductive loops, exhibit limited coverage and substantial expenses associated with infrastructure installation and maintenance [3]. Utilizing data from vehicular network can expand the scope of TFE, while the collection and transmission of massive data also encounter technical and economic challenges. Considering the constraints of existing methods, it is cost-effective to utilize limited data from vehicular network to obtain real-time TFE by cloud computing [4] [5]. However, when the amount of traffic data decreases, the resulting TFE tends to be inaccurate and unstable [6]. With the advancement of artificial intelligence, employing deep learning methods to recover TFE from limited data emerges as a feasible and promising approach.\nLately, deep learning methods have been developed to explore features of traffic flow [7] [8]. The convolutional neural network (CNN) is proficient in extracting spatial features of input through convolutional operations [9]. The recurrent neural network (RNN) and its variants such as long short-term memory (LSTM) are designed to capture sequential or temporal features of input by utilizing recurrent connections [10]. Mamba, an advanced neural network based on state space model (SSM), is effective at processing sequential data and modeling temporal correlation via selection mechanism [11]. Moreover, some methods combine the functions of CNN and RNN. For instance, the Conv-LSTM module is proposed to forecast short-term traffic flow via learning spatial-temporal dependencies [12]. However, existing works primarily focus on traffic flow prediction rather than estimating real-time traffic flow, and are provided with sufficient data instead of limited data. To enhance estimation accuracy with limited data, there is a need to design a specialized spatial-temporal model for traffic flow estimation recovery.\nIn this paper, we investigate the TFE utilizing limited data and propose a spatial-temporal deep learning method to recover both the accuracy and stability of TFE. The framework of TFE with limited vehicular network data is illustrated in Fig. 1. We divide the city map evenly into grids, each of which represent a specific region in the city. The data limitation in our scheme refers to the practice of randomly sampling a subset of vehicles across the city with equal probability of recruitment at each time interval [6]. Following the collection of limited data, the traffic information comprising vehicle speeds and GPS coordinates are matched to corresponding grids. The condition of traffic flow within each grid is represented by the average speed of vehicles over a defined period. For the recovery of TFE, we propose a novel deep learning model, named as spatial-temporal Mamba (ST-Mamba), to generate stable and accurate TFE via effectively leveraging the spatial-temporal features of traffic flow. Specifically, we employ the CNN to capture the local spatial correlation of traffic flow, and utilize the Mamba to model the temporal correlation of each grid in the map. The main contributions of this paper are listed as the following:\n\u2022 We present a novel approach for cost-effective TFE, utilizing only a small fraction of vehicular network data to alleviate the burden on network communication and mitigate the expenses of traffic systems.\n\u2022 We design a spatial-temporal deep learning model named as ST-Mamba, consisting of CNN and Mamba, to recover the TFE with limited vehicular network data."}, {"title": "II. FRAMEWORK AND PROBLEM ANALYSIS", "content": "This section consists of two parts. First, the framework for TFE with limited network data is delineated. Then, the problem of recovering estimation from limited data is formulated.\nFramework for TFE with Limited Data\nThe process of recovering TFE from limited data is illustrated in Fig. 1. First, we divide the city map evenly into grids. Meanwhile, the limited data of vehicle mobility information is gathered from vehicular network by traffic data collector. Instead of removing data from some specific regions, we acquire the limited data by randomly selecting a small fraction of vehicles as data sources uniformly distributed across the city, with equal probability of recruitment for each vehicle. Following the limited data collection, we design a matching process between the data and the grid-structured city map. Then, the original estimation is acquired via computing the average speeds of vehicles in each grid to construct the traffic flow image. Lastly, the recovery algorithm is applied to generate precise TFE based on the limited data.\nAs to the specific scheme of our work, we first obtain the city map consisting of grids with equal size and number of $H * W$. Corresponding to reality, each grid in the map represents a particular region of the city. We construct the grid-structured city map as,\n$M = \\begin{bmatrix}\nm_{1,1} & ... & m_{1,W} \\\\\nvdots & m_{h,w} & vdots \\\\\nm_{H,1} & ... & m_{H,W}\n\\end{bmatrix}$, (1)\nwhere $m_{h,w}$ indicates the grid of map which is located at $(h,w)$, $H$ and $W$ can be viewed as the height and width of the map.\nWith the construction of grid-structured city map, the vehicular network data are matched to respective grids based on the GPS coordinates of vehicles. We first obtain the vehicle mobility dataset $V_t$ with sufficient data, which is collected at time slot $t$ under ideal circumstances. Subsequently, with the grid matching outcomes of $V_t$ and $M$, the ideal estimation of traffic flow is calculated as,\n$z_{h,w}^t = Mean(v_{h,w} | v_{h,w} \\in V_t)$, (2)\n$Z_t = \\begin{bmatrix}\nz_{1,1}^t & ... & z_{1,W}^t \\\\\nvdots & z_{h,w}^t & vdots \\\\\nz_{H,1}^t & ... & z_{H,W}^t\n\\end{bmatrix}$, (3)\nwhere the mobility information of vehicles in the grid located at $(h, w)$ is described as $v_{h,w}$, $z_{h,w}^t$ is the average speed of vehicles obtained from sufficient data in the grid located at $(h, w)$ at time slot $t$, $Z_t$ represents the ideal estimation of traffic flow at time slot $t$.\nThen, the acquisition of TFE from limited data is conducted as follows. We denote the limited vehicle mobility information gathered at time slot $t$ as $V_t^*$, which is obtained through random sampling from the sufficient dataset $V_t$, i.e., $V_t^* \\subseteq V_t$. This sampling approach assigns equal selection probability to each piece of vehicle mobility information. With a similar calculating and matching process, the original estimation of traffic flow at time slot $t$ is denoted as,\n$x_{h,w}^t = Mean(v_{h,w} | v_{h,w} \\in V_t^*)$, (4)\n$X_t = \\begin{bmatrix}\nx_{1,1}^t & ... & x_{1,W}^t \\\\\nvdots & x_{h,w}^t & vdots \\\\\nx_{H,1}^t & ... & x_{H,W}^t\n\\end{bmatrix}$, (5)\nwhere $x_{h,w}^t$ is the average speed of vehicles obtained from limited data in the grid located at $(h, w)$ at time slot $t$, $X_t$ represents the city-wide original estimation of traffic flow at time slot $t$. Note that both $X_t$ and $Z_t$ can be perceived as images with a resolution of $H * W$ and four channels, where the amount of channels is decided by the types of driving directions defined in our work, i.e., east, south, west, and north.\nFinally, we apply the specifically designed deep learning model to recover the original estimation $X_t$. The ideal estimation $Z_t$ not only serves as the ground truth label for the learning of the model, but also is the target data that the model expects to output. Following the training and inference of the model, we obtain the recovered TFE from limited data, which is reliable and cost-effective."}, {"title": "B. Problem of Traffic Flow Estimation", "content": "Based on the limited data, we can obtain the original estimation of traffic flow approximating the ideal one. However, the original estimation exhibits a considerable degree of inaccuracy and instability regardless of the similarity. In other words, we found that there exits abundant noise in each grid of original TFE $X_t$, which fails to serve as the definitive estimation for the applications of urban transportation systems. Therefore, the task of real-time TFE with limited network data is conceptualized as a grid-structured data recovery problem.\nWe set the input of the recovery model to be the historical and current estimations of traffic flow derived from limited data, represented as $[X_{t-L+1}, ..., X_{t-1}, X_t]$. The objective is to reform an estimation of current traffic flow with high accuracy and stability, mirroring the ideal estimation $Z_t$ derived from sufficient data. Therefore, the crux of the TFE problem lies in ascertaining the mapping function $\\mathcal{F}(\u00b7)$,\n$Z_t = \\mathcal{F}([X_{t-L+1}, ..., X_{t-1}, X_t])$, (6)\nwhich aims to fully explore the spatial-temporal dependencies of traffic flow, mitigate the noise resulting from the data limitation, and transform the original TFE derived from limited data into a precise estimation of current traffic flow."}, {"title": "III. ST-MAMBA FOR TRAFFIC FLOW RECOVERY", "content": "In this section, we present the ST-Mamba designed to recover accurate and stable TFE from limited network data by exploring and aggregating the features of traffic flow. The network structures employed for capturing the spatial and temporal correlations by the CNN and Mamba are discussed. Subsequently, we provide an overview of the architecture belonging to the ST-Mamba.\nSpatial Correlation Modeling\nIn our framework, the estimation of traffic flow can be viewed as an image with a resolution of $H * W$ and four channels. The spatial correlation of traffic flow is inherent in the grid structure. Given that the condition of traffic flow in one region is impacted by those in adjacent regions while the influence wanes with increasing spatial distance, the aggregation of spatial information from neighboring regions is imperative for accurate TFE. CNN is a classic and concise neural network suitable for processing grid-structured data, the principle of which is convolving input data with learnable filters to detect local patterns [9]. In recognition of the features of traffic flow, we employ CNN for capturing local spatial correlation of traffic flow from the entire traffic flow image.\nWe first conduct convolutional operations by CNN separately on four channels of the image, capturing spatial correlation of each driving direction. The working process of the CNN in our model can be denoted as,\n$X_n' = CNN_e(X_n)$, (7)\nwhere subscript $n$ ranges from $t-L+1$ to $t$, $X_n \\in \\mathbb{R}^{4\\times H \\times W}$ is the original TFE derived from limited data at time slot $n$, $X_n' \\in \\mathbb{R}^{4\\times H \\times W}$ contains the spatial correlation captured by CNN. Then, we utilize a fully connected (FC) layer to lift data dimension and integrate spatial correlations of different driving directions. The FC layer is operated as,\n$X_n'' = FC(X_n')$, (8)\nwhere $X_n'' \\in \\mathbb{R}^{K\\times H \\times W}$ is the high-dimensional feature representation of $X_n'$ in latent space. Subsequently, one reshape layer is constructed to serialize the format of traffic data. The sequential traffic data of each grid can be obtained as,\n$I_{h,w} = Concat(x_{h,w}^n | n = t - L + 1, ...t - 1, t)$, (9)\nwhere $Concat(\u00b7)$ is the concatenating operation, $I_{h,w}$ is the spatial feature representation in one grid of $X_n''$, $I \\in \\mathbb{R}^{K \\times L}$ is the sequence comprising spatial correlation of traffic flow in one grid of $X_n$.\nTemporal Correlation Modeling\nThe temporal correlation of traffic flow is hidden in the sequential structure. The original TFE at time slot $t$, combined with those at preceding $(L - 1)$ time slots, are utilized to construct sequential traffic data for recovering TFE at current time slot $t$. Mamba is an advanced neural network especially effective at processing sequential data and modeling temporal correlation. Integrating the selection mechanism which associates the parameters of SSM with the input, Mamba is able to focus on relevant inputs and ignore irrelevant ones, executing linear-time processing of sequences while maintaining high performance [13]. It is appropriate to employ Mamba for learning the complex temporal correlation of traffic flow."}, {"title": "C. Outcome Decoding", "content": "The final outcome is decoded from the output of Mamba. The decoder block consists of one FC layer and one CNN layer. In the FC layer, we combine the sequential traffic data O to form an image format with dimension $\\mathbb{R}^{(K \\times L) \\times H \\times W}$. Meanwhile, we reduce data dimension to aggregate spatial-temporal correlations previously modeled. The FC layer in decoder block is operated as,\n$G = FC_d(O)$, (19)\nwhere $G \\in \\mathbb{R}^{4 \\times H \\times W}$ can be viewed as the image of TFE containing spatial and temporal correlations of traffic flow. Then, we conduct convolutional operations in the CNN layer to decode the outcome as,\n$Y = CNN_d(G)$, (20)\nwhere $Y \\in \\mathbb{R}^{4 \\times H \\times W}$ is the final outcome of the model and can be perceived as the recovered TFE approximating the ideal estimation $Z_t$.\nST-Mamba Model\nThe main architecture of ST-Mamba model is illustrated in Fig. 2. We specifically design three parts for ST-Mamba, which are the encoder block, the Mamba block, and the decoder block, respectively.\nIn specific, the encoder block consists of one CNN layer and one FC layer in turn. Given that vehicles driving in different directions have minimal influence on each other, four CNNs with identical parameters are employed in the CNN layer to independently perform convolutional operations in each channel of input, extracting spatial correlation of traffic flow under four distinct driving directions. Then, we utilize one FC layer to lift the dimension of input data to explore much more detailed information and exchange spatial features of different driving directions. For the Mamba block, we stack one reshape layer before the Mamba layer, serializing the input so that Mamba can process the limited data of traffic flow effectively. Then, the generated sequences are fed into the Mamba layer in parallel to explore the temporal correlation in each gird of the original traffic flow estimations. For the decoder block which is similar to encoder one, the role of the FC layer is to aggregate spatial-temporal correlations captured previously and project the processed data into the image format. Then, convolutional operations are done by the CNN layer to decode the final outcome while form a formal symmetry of the model. Finally, ST-Mamba exports the recovered traffic flow estimation at time slot t from limited data, with high accuracy and stability which can meet the demands of traffic transportation systems."}, {"title": "IV. SIMULATION AND RESULTS", "content": "In this section, we assess our method utilizing the real traffic data from Beijing. We begin by the experimental settings comprising the dataset, baselines, and evaluation metrics. Then, we present and analyze the estimation performance.\nExperimental Setting\nThe simulation utilizes the real traffic data sourced from the Fourth Ring Road in Beijing. Our dataset includes 6 days in 2012, and the time period for TFE spans from 7:30 AM to 10:30 PM [6]. The resolution of TFE image is 100\u00d7100. The limited data is obtained by random sampling from sufficient data, where the limitation degree indicates the proportion of sampled data. Our approach is compared with the following four baselines:\n\u2022 Original: The original estimation derived from limited data, and the input of deep learning models.\n\u2022 CNN: A convolutional neural network designed to capture spatial correlation by convolutional operations [9].\n\u2022 PredRNN: A recurrent neural network proposed to capture spatial-temporal dependencies for coherent future frame forecasting [14].\n\u2022 SimVP: A simple yet powerful architecture for video prediction, which makes the most of CNN and its variants to explore spatial-temporal correlations [15].\nMeanwhile, we select three metrics to evaluate the performance of models. Root mean squared error (RMSE) assesses the recovery accuracy by penalizing larger errors more heavily. Improved percentage (IP) demonstrates the recovery"}, {"title": "V. CONCLUSION", "content": "In this paper, we studied the framework for TFE utilizing limited data from the vehicular network. We analyzed the TFE recovery problem caused by the limitation of traffic data availability. To address this issue, we designed a spatial-temporal deep learning model named as ST-Mamba to improve the estimation accuracy and stability. Comprehensive simulation results based on the real-world dataset have validated the effectiveness of ST-Mamba in processing sequential grid-structured data. Our approach provides a cost-effective solution for TFE in scenarios with limited data. For future work, we intend to explore the traffic flow prediction based on limited data."}]}