{"title": "DINO-LG: A TASK-SPECIFIC DINO MODEL FOR CORONARY\nCALCIUM SCORING", "authors": ["Mahmut S. Gokmen", "Cody Bumgardner", "Caner Ozcan"], "abstract": "Coronary artery disease (CAD), one of the most common cause of mortality in the world. Coronary\nartery calcium (CAC) scoring using computed tomography (CT) is key for risk assessment to prevent\ncoronary disease. Previous studies on risk assessment and calcification detection in CT scans primarily\nuse approaches based on UNET architecture, frequently implemented on pre-built models. However,\nthese models are limited by the availability of annotated CT scans containing CAC and suffering\nfrom imbalanced dataset, decreasing performance of CAC segmentation and scoring. In this study,\nwe extend this approach by incorporating the self-supervised learning (SSL) technique of DINO (self-\ndistillation with no labels) to eliminate limitations of scarce annotated data in CT scans. The DINO\nmodel's ability to train without requiring CAC area annotations enhances its robustness in generating\ndistinct features. The DINO model is trained on to focus specifically on calcified areas by using labels,\naiming to generate features that effectively capture and highlight key characteristics. The label-guided\nDINO (DINO-LG) enhances classification by distinguishing CT slices that contain calcification from\nthose that do not, performing 57% better than the standard DINO model in this task. CAC scoring\nand segmentation tasks are performed by a basic U-NET architecture, fed specifically with CT slices\ncontaining calcified areas as identified by the DINO-LG model. This targeted identification performed\nby DINO-LG model improves CAC segmentation performance by approximately 10% and significant\nincrease in CAC scoring accuracy.", "sections": [{"title": "1 Introduction", "content": "Cardiovascular disease (CVD) is the leading cause of death globally, responsible for approximately 17.9 million\nfatalities in 2019, which constitutes 32% of all deaths worldwide Organization [2021]. Coronary artery disease (CAD),\na major cardiovascular disease affecting the blood vessels that feed the heart muscle, caused 371,506 deaths in the\nUnited States in 2022 for Health Statistics [2024]. According to the most recent heart disease and stroke statistics report,\napproximately 5% of adults over the age of 20 have CAD in the United States Tsao et al. [2023]. Early detection of\nCAD allows for timely interventions that can prevent progression of the disease and reduce the risk of life-threatening\nheart attacks. It can also lead to a wider range of treatment options, including lifestyle changes, medications or surgical\nprocedures. The earlier CAD is detected, the more effective these treatments can be. Furthermore, overall treatment\ncosts can be reduced by preventing more serious complications requiring intensive care or extensive procedures.\nCoronary artery calcium (CAC) scoring is considered a reliable tool for assessing cardiovascular disease tool and is\ngenerally recommended for use by various guidelines Knuuti et al. [2020]. CAC scoring helps identify the presence\nand extent of calcified plaque in the coronary arteries, which is strongly associated with the risk of CAD and future\ncardiovascular events. The test is non-invasive and relatively simple, using computer tomography (CT) scans to measure\ncalcium deposits without the need for invasive procedures. The risk categorized calcium scores reflect different risk"}, {"title": "2 Related Work", "content": "Recent reviews has highlighted notable advances in CAC scoring and segmentation facilitated by artificial intelligence\n(AI) techniques Aromiwura and Kalra [2024], Gennari et al. [2024], Groen et al. [2024], Abdelrahman et al. [2024],\nParsa et al. [2024]. The integration of AI in quantifying CAC on CT scans presents a transformative approach to\ncardiovascular risk assessment. An FDA-approved deep learning (DL) algorithm (NANOX AI) in a single-center\nretrospective study to measure CAC on non-contrast ECG-non-gated chest CT is used Kerndt et al. [2023b]. As a\nresult of the analysis of 527 patient data, the interpretation by cardiologists showed an 88.76% agreement with the AI\nclassification. On non-gated images, DL-based CAC scoring software reported using chest CT scans Choi et al. [2022].\nWhen assessing the agreement of scores based on CAC groups all intraclass correlation coefficients (ICCs) were good\nenough. Sartoretti et al. Sartoretti et al. [2023] evaluated CAC scoring by a fully automated DL-based tool (AVIEW\nCAC, Coreline Soft). The similarity between the CAC ground truth values and the results obtained from the DL model\nwas 0.986. in the studies performed on the CT data obtained for 56 patients included in the analysis. In another study\nby Assen et al. van Assen et al. [2021], the coronary calcium volume on non-contrast cardiac CT was obtained using a\nDL based algorithm (AI-Rad Companion Chest CT, Siemens Healthineers, Forchheim, Germany). The Agatston score\nobtained as a result of the studies and the calcium volume determined by AI show a high correlation with a correlation\ncoefficient of 0.921. These studies, performed using software produced by specialized companies, have shown that\nrapid and precise assessment of CAC can facilitate the practical application in routine CT data, providing an important\ncontribution on how patients with different risks should be treated.\nA novel DL model is developed by Eng et al. Eng et al. [2021b] to automate CAC scoring, demonstrating high accuracy\nand speed on both dedicated gated coronary CTs and non-gated chest CTs. For detecting CAC, the algorithm provided\na sensitivity of 71% to 94% and a positive predictive value of 88% to 100% across four different datasets. Velzen et\nal. van Velzen et al. [2020] evaluated the effectiveness of a deep learning method for CAC scoring across different\ntypes of CT examinations to see if the algorithm result well when trained with representative images from different\nCT protocols. At baseline, the DL algorithm achieved intraclass correlation coefficients (ICCs) of 0.79-0.97 for CAC,\nwhich improved to 0.85-0.99 with combined training. Later, Zeleznik et al. Zeleznik et al. [2021b] introduced a deep\nlearning system capable of accurately predicting cardiovascular events by quantifying coronary calcium, validated in a\ndiverse population of 20,084 individuals on various routine cardiac-gated and non-gated CT. The study found a very\nhigh correlation of 0.92 (P < 0.0001) and substantial agreement between the automated and manual calculations of\ncalcium risk groups. These studies highlight the increasing role of DL in improving clinical decision making in CAC\ndetection. Peng et al. Peng et al. [2023] used a DL algorithm to quantify CAC on non-gated CT for association with\ncardiovascular outcomes. After adjusting for various demographic and clinical factors, individuals with DL-CAC scores\nof 100 or more showed a notably increased risk of all-cause mortality, as well as higher risks for composite outcomes\ninvolving myocardial infarction and stroke.\nActive multitask learning with uncertainty-weighted loss is proposed by F\u00f6llmer et al. ? for CAC scoring in ECG-gated\nCT. The proposed model was tested on a total of 1,275 patient data consisting of a combination of three different\ndatasets, and the results obtained showed a strong agreement with clinical outcomes ranging from 0.80 to 0.97. A 3D\ndeep convolutional neural network (CNN) model is trained for Agatston scores using a database of 5973 non-contrast\nnon-ECG gated chest CT without a prior segmentation of the CACs Gonz\u00e1lez et al. [2018]. This model achieved\na Pearson correlation coefficient of r = 0.93; p < 0.0001 when compared with ground truth data. In another study,\nIhdayhid et al. Ihdayhid et al. [2023] proposed fully automated DL model to detect and measure CAC scores on\nECG-gated CTs. The CAC score results from the automated model showed a strong correlation with the reference\nstandard, indicated by a Spearman's correlation of r=0.90 and an ICC of 0.98. An automatic deep learning approach\nIhdayhid et al. [2023] on 365 patients was developed to quantify CAC scores. The designed model was tested on an\nunseen cohort of 240 patients, and the results indicate that the model can effectively quantify CAC and classify risk\nin CT angiography. One of the studies using the public Coronary Calcium and chest CT's (COCA) dataset proposed\na novel semantic-prompt scoring siamese network Li et al. [2023], while the other study proposed a lightweight 3D"}, {"title": "3 Methodology", "content": "The proposed architecture for CAC scoring is presented in Fig. 1. The overall architecture for coronary calcium\ndetection and scoring combines self-supervised learning (via the DINO model) with segmentation techniques to\nprecisely identify calcified regions in CT scan slices. The process begins with a complete CT scan, which is divided into\nsmaller patches. These patches are fed into a Vision Transformer (ViT) backbone as part of the DINO model, where"}, {"title": "3.1 Overall Architecture", "content": "each patch undergoes linear projection to extract meaningful features. Length and size of the features are generated by\nDINO model may vary depending on the number of heads utilized in multi-head attention. The embedded features,\nintroduced by the DINO model incorporate distinguishable characteristics for each CT slice, depending on whether it\ncontains calcification or not.\nSecond step, the extracted features from DINO model are fed into to a transformers-based binary classification model\nto classify CT slices as either containing calcification areas or not. CT slices with a high probability of calcification\nare sent to a pre-trained U-Net model to segment the calcified regions, calculating the total CAC score for the case\nin the final step. This combined approach allows for both classification and detailed segmentation of calcified areas,\nfacilitating more accurate coronary calcium detection and quantification."}, {"title": "3.2 Label-Guided Data Augmentation and DINO Training", "content": "Data Augmentation. Data augmentation techniques are key components for self-supervised learning to enhance\nmodel's robustness and improve generalizable representations by identifying the underlying features. The most well\nknown augmentation techniques include random cropping, random flipping, random rotating and color jittering. While\nthese options are appropriate to utilize on three channel 8bit RGB images, they are not comprehensive for medical\nimages, especially when it is considered medical images have 16bits color space within a single channel.\nRecent studies, especially those using medical images, do not utilize data augmentation techniques like solarization and\ncolor jitter, as these are not suitable for processing medical images. Instead, alternative data augmentation techniques\nare utilized like additional noise and brightness chancing. The table 1 represents the most common data augmentation\ntechniques are used for medical images and compares with the augmentation techniques are utilized in traditional DINO\nmodel. In our approach, we apply the medical data augmentation techniques as outlined in the table.\nLabel Guided Data Augmentation. At the same time, randomness of applied data augmentation functions during\ntraining decreases linear evaluation performance and limits generalization of the model Moutakanni et al. [2024].\nAdditionally, training a model with the purpose of generalization requires more resources than a model trained for a\nspecific task. To address this, we propose a label-guided augmentation technique that aims to enhance feature extraction\nby emphasizing key features while maintaining the model's generalization capability. This approach ensures that the\nmodel's capacity extends beyond the targeted areas, providing the potential for it to be utilized in a wider range of tasks.\nAdditionally, our proposed approach contributes a flexibility to the model for real world problems.\nLabel guided augmentation is effective for the data has only labels or prompt points. During the training phase, CT\nslices have annotations or labels are randomly augmented regardless of having labels. Addition on that random\naugmentation, it is applied an augmentation which centers the center of annotated areas chosen randomly from labels.\nThis point specific augmentation helps model to emphasize on that labelled areas more than other randomly chosen and\ncropped areas. The point specific data augmentation or label guided data augmentation has been applied for local"}, {"title": "3.3 Binary Classification of DINO Features", "content": "The features are generated by DINO model is extracted from the last layer of multi-head self attention modules. The size\nof extracted feature's length is equal to the size of embedded dimensions which depends on the chosen ViT model. In\nthis study, we focused on generating a diverse set of features to capture small details, such as calcified areas in CT slices.\nThese features are differentiable by using a discriminative method, such as classifiers. To achieve accurate classification\nof CT slices that contain calcified areas, we utilize a linear classification model which have trained generated features\nby DINO model."}, {"title": "3.4 Segmentation and Calcium Scoring", "content": "The following step after classification task is segmentation of chosen CT slices as calcified. As it mentioned in recent\nstudies, segmentation of calcified areas has a high accuracy rate in a case of CT slices are known as having calcification.\nIf it is considered that CNN based architectures have lack of focusing on global features and require improvements to\nenhance their distinctive capabilities, it is understandable why recent studies do not include uncategorized cases in their\nown study.\nDespite this, even though our segmentation task yields results comparable to recent studies, our proposed architecture\nmakes it possible to work it with unrelated cases and images."}, {"title": "4 Experiments and Results", "content": "Experimental setup consist of three steps of model training; starting with DINO model training, followed by classification\nmodel, and finally training a U-NET for segmentation and CAC scoring. All experiments are conducted on a single\nnode with 8 H100 GPUs.\nDataset. In this study, we utilized the COCA- Coronary Calcium and Chest CT dataset, collected by Stanford Hospital\nand Clinics, to assess calcium deposition in the coronary arteries, which can be accessed at AIMI [2021]. This dataset\ncomprises images from computed tomography (CT) scans used for evaluating coronary calcium scores. It includes\ngated coronary CTs with corresponding segmentation scores and paired gated and non-gated routine chest CTs. Gated\nscans are less frequently employed in clinical practice since they are typically dedicated to specific tasks like detecting\ncalcification, whereas non-gated scans are more versatile and serve multiple diagnostic purposes.\nA total of 789 patients underwent retrospective gated coronary CT scans, resulting in 789 scans. These gated scans\ninclude masked segmentations for the entire 3D volume. In addition, 214 patients had retrospective non-gated coronary"}, {"title": "4.1 Experimental Setup", "content": null}, {"title": "4.2 Performance Analysis of DINO and Segmentation Models", "content": "Comparison of DINO-LG and DINO model via Classification. The comparison is conducted on two different models\ntrained with our label-guided approach and standard DINO model. Confusion matrix for both models are represented in\nFigure 6 and includes TP (True-Positive), TN (True-Negative), FP (False-Positive) and FN (False-Negative) predictions.\nLinear classification model is trained 10 epoch, because of experiencing increase in FN predictions. FN predictions\nindicate that the predicted slices containing calcified areas were incorrectly classified as unannotated or lacking\ncalcification. Thus, it is crucial keeping FN predictions in low weighted in among other predictions.\nThe other important prediction type, FP predictions indicate that the slices annotated as non-calcified areas were\nincorrectly classified as containing calcified areas. Although FP predictions are significantly higher than FN predictions\naccross predicted slices, it should be noted that segmentation models will not consider FP slices if they do not contain\nmissed or unnoticeable calcified areas. The remaining prediction types of TP and TN represent the slices correctly\npredicted as containing calcified areas and non-calcified areas. The confusion matrix provided for both models reveals\nthat DINO-LG model has significant improvement on predictions of TN and FN. This also demonstrates that the DINO\nmodel can be effectively trained for specific tasks.\nSegmentation Experiments Segmentation models were tested on the same dataset used in the classification experiments,\nindependently of the classification model. Before integrating the segmentation model with DINO features, this section\nevaluates U-NET-based architectures to determine their suitability for combination with the DINO model in the main\nstructure. The performance of U-NET-based models is presented in Table 5. As shown in the table, the basic U-NET\nand Attention U-NET architectures achieved significantly higher scores across all coronary artery classes: RCA (Right\nCoronary Artery), LAD (Left Anterior Descending), LCA (Left Coronary Artery), and LCX (Left Circumflex).\nThe U-NET architecture performs well in identifying high-risk calcification areas but encounters challenges with\nsmaller calcified regions in CT slices. The lack of annotations for many CT slices often leads the model to incorrectly\nsegment unannotated areas, significantly impacting F1 scores due to potential mislabeling. The CAC scoring results\nproduced by the U-NET architecture are shown in Figure 7a, while Figure 7b illustrates CAC classification outcomes"}, {"title": "4.3 Performance Results of the Integrated System", "content": "The integrated system, combining DINO-LG based feature extraction, classification and U-NET segmentation,\ndemonstrates significant improvement in identifying and scoring coronary artery calcification. In classification part, the\nDINO-LG model efficiently distinguishes CT slices whether having calcified areas or not, ensuring that only relevant\nimages are forwarded to the segmentation model. Identifying CT slices containing calcified areas has a crucial role to\nleverage segmentation task as it represented in Figure 7."}, {"title": "5 Discussion and Conclusion", "content": "In this paper we propose a novel approach to train DINO, vision foundational model, with guadience of existing labels\nor annotations. The proposed label guided training approach encourages the model highlighting and paying more\nattention to the annotated areas. We show effectiveness of this approach on coronary calcium detection and scoring, by\nintegrating a classification head and segmentation model to DINO-LG model. Experiments reveal that, DINO-LG\nmodel is able to identify calcified areas on CT slices when guided to focus on annotated regions during training.\nThe training method we propose for the DINO model is not limited to a specific application, such as coronary artery\ncalcium detection. This approach can be applied to various datasets with annotations for lungs, liver, tumors, and\nother regions, especially considering that foundational vision models can focus on multiple features simultaneously.\nAdditionally, training a foundational model across multiple fields can enhance its ability to capture a wider range of\ndistinctive features."}]}