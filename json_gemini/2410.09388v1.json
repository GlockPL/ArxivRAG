{"title": "3-D Magnetotelluric Deep Learning Inversion Guided by Pseudo-Physical Information", "authors": ["Peifan Jiang", "Xuben Wang", "Shuang Wang", "Fei Deng", "Kunpeng Wang", "Bin Wang", "Yuhan Yang", "Islam Fadel"], "abstract": "Magnetotelluric deep learning (DL) inversion methods based on joint data-driven and physics-driven have become a hot topic in recent years. When mapping observation data (or forward modeling data) to the resistivity model using neural networks (NNs), incorporating the error (loss) term of the inversion resistivity's forward modeling response\u2014which introduces physical information about electromagnetic field propagation-can significantly enhance the inversion accuracy. To efficiently achieve data-physical dual-driven MT deep learning inversion for large-scale 3-D MT data, we propose using DL forward modeling networks to compute this portion of the loss. This approach introduces pseudo-physical information through the forward modeling of NN simulation, further guiding the inversion network fitting. Specifically, we first pre-train the forward modeling networks as fixed forward modeling operators, then transfer and integrate them into the inversion network training, and finally optimize the inversion network by minimizing the multinomial loss. Theoretical experimental results indicate that despite some simulation errors in DL forward modeling, the introduced pseudo-physical information still enhances inversion accuracy and significantly mitigates the overfitting problem during training. Additionally, we propose a new input mode that involves masking and adding noise to the data, simulating the field data environment of 3-D MT inversion, thereby making the method more flexible and effective for practical applications.", "sections": [{"title": "I. INTRODUCTION", "content": "HE Magnetotelluric (MT) method is a crucial technology in geophysical exploration. The technique is widely applied in engineering fields like mineral exploration [1] [2], geothermal exploration [3] [4], and oil and gas [5] [6] extraction by receiving and analyzing natural electromagnetic field signals to inversion and image subsurface structures. Moreover, the MT method is an essential observational tool for deep Earth science research and the analysis of plate tectonic dynamics [7] [8] [9].\nTraditional MT inversion algorithms are mainly classified into two categories: locally optimized deterministic inversion and stochastic inversion with global optimization capabilities. Locally optimized inversion methods include the nonlinear conjugate gradient (NLCG) [10], Occam inversion [11] [12], Gauss-Newton [13] and limited-memory quasi-Newton [14] methods. These methods rely on the initial model and often converge to local optimization solutions, which can result in overfitting. On the other hand, stochastic inversion includes simulated annealing algorithm [15], genetic algorithm [16], particle swarm optimization [17], and Bayesian approach [18]. Although these methods can effectively achieve global optimization, but their application in large-scale 3D MT inversion is still challenging due to the high demand of computational resources and relatively low efficiency. MT inversion requires iterative invocation of forward modeling. By continuously updating the subsurface resistivity model, the forward modeling response is gradually approximated to the observed data, thereby enabling the imaging of subsurface structures. MT forward modeling is based on Maxwell's electromagnetic equations and is typically implemented using numerical computation methods such as the finite element method (FEM) [19], finite difference method (FDM) [20], finite volume method (FVM) [21], and integral equation method [22]. Different forward modeling algorithms have distinct advantages and disadvantages, which are applicable to different geological conditions and computational needs.\nWith the booming development of artificial intelligence (AI) in various fields, deep learning (DL) methods using neural networks (NNs) to simulate the forward and inverse numerical computations of conventional electromagnetic fields have garnered significant attention [23] [24] [25]. For DL forward modeling, Shan et al. approached 2-D MT forward modeling as a multi-task learning problem, synchronizing the prediction of apparent resistivity and phase using NNs [26]. Deng et al. similarly implemented 2-D MT forward modeling by multiple NNs and expanded the dataset by traditional iterative inversion to improve the forward modeling accuracy and generalization [27] [28]. Additionally, Wang et al. utilized NNs for 3-DMT DL forward modeling, achieving accurate forward modeling response predictions of multimorphic anomalies in 3-D space [29]. For DL inversion, most researchers employed NNs to directly establish the nonlinear mapping relationship from observed data to geoelectric model, exploring new inversion paradigm. Among them, Liu et al. proposed using convolutional neural network (CNN) for end-to-end electrical resistivity inversion [30]. To address the inherent vertical variation in apparent resistivity data, they incorporated additional layer feature mapping to include depth information, achieving improved inversion results. Ling et al. proposed using ResNet1D for audio MT inversion, enhancing network performance by adding shortcut connections, and achieving robust end-to-end inversion [31]. Liao et al. proposed a fully convolutional network (FCN) -based MT inversion method to directly establish the mapping of apparent resistivity and phase to resistivity anomaly models, and discussed the ability of the network can be trained in a single anomaly model dataset and generalized to multiple anomaly models due to the weight-sharing mechanism present in FCN [32]. Addressing the multi-scale characteristics of MT forward modeling response data, Pan et al. proposed MT2DInv-Unet [33], a deformable convolution-based 2-D MT inversion network that outperforms both FCN and U-Net in MT inversion. Xu et al. introduced the self-attention mechanism to enhance the feature acquisition capabilities of traditional CNNs and designed more representative training samples to improve inversion effectiveness [34].\nThe above DL methods focus solely on the mapping error between observed data and subsurface resistivity during training, neglecting forward modeling calculations and the underlying physical relationships. As a result, significant effective information is lost, limiting the accuracy and generalization of the inversion. In recent years, the integration of physical information and guidance with physics-driven inversion methods has garnered significant attention. Alyousuf et al. employed an adaptive physical embedding approach to combine DL inversion and deterministic inversion, introducing the loss of the geoelectric model term via NN inversion during the iterative process of the deterministic inversion to achieve 2-D MT inversion [35]. Other researchers used forward modeling algorithm as an additional constraint for NN training, incorporating the physical information of electromagnetic field propagation into DL inversion training through forward modeling. Liu et al. employed traditional forward modeling method to compute the forward response of the predicted resistivity of the network based on the construction of a nonlinear mapping from apparent resistivity to resistivity [36]. They incorporated physical information by using the difference between the forward modeling response and the input apparent resistivity as part of the loss function. Similarly, Liu et al. and Ling et al. embedded traditional forward modeling algorithms into 1-D and 3-D MT DL inversion training, reducing the network's overdependence on the training set and enhancing the stability and accuracy of inversion [37] [38]. These studies demonstrate that incorporating physical information (forward modeling computation) into network training effectively improves inversion accuracy, but the challenges are also obvious. In general, achieving DL inversion with stronger generalization ability and accuracy still requires training on large-scale datasets, even when guided by physical information. Therefore, when applying this method to train large-scale 3-D MT data, involving tens or even hundreds of thousands of grids, the time cost of traditional forward modeling computations becomes prohibitive during network training, severely limiting the method's applicability.\nTo address the above issues, we combine 3-D DL forward modeling with 3-D DL inversion, and introduce pseudo-physical information into the inversion network training through NN-based forward simulation, so as to propose a 3-D MT DL inversion method guided by pseudo-physical information. The main research is as follows:\n1): Incorporate pseudo-physical information into 3-D MT DL inversion training. We utilize pre-trained DL forward modeling sub-networks as fixed forward modeling operators to rapidly compute the 3-D MT forward modeling response. During DL inversion training, the forward modeling sub-networks compute the forward response error of the inversion resistivity, which further guides network updates. Experimental results indicate that, compared with the direct training inversion (DirectInv), which does not consider forward modeling response errors, the P-PhysInv method improves the inversion accuracy and significantly reduces network overfitting.\n2): Construct a 3-D MT deep learning theoretical dataset with layered structures. By interpolating surfaces of random points in 3-D space, we generate formation surfaces with multimorphic layered structures and fill the random resistivity between adjacent surfaces. Meanwhile, we add several regular anomalies within the layers to construct a complex geoelectric model that reflects actual subsurface structures more accurately. Finally, we use ModEM to perform forward modeling computation via FDM, generating sample datasets for training the forward modeling and inversion networks.\n3): Propose a data input mode with more practical application potential. During the training process, we performed missing (i.e., the mask process) and adding noise to the input data (forward modeling data) to simulate a sparse and noisy real data environment. This mode not only enables the network to better learn the features of each apparent parameters, but also enhances the method's flexibility for application to field data. Experiments show that for theoretical data, the network can effectively generalize to data with higher noise and mask levels after training at relatively low noise and mask levels. For field data, we explore the effectiveness of this mode for end-to-end 3-D MT DL inversion in sparse data conditions, and discuss the possible further enhancement effect of using the inversion results as an initial model for traditional inversion."}, {"title": "II. METHODOLOGICAL", "content": "The target function It of the traditional deterministic 3-D MT inversion method mainly consists of Data Misfit Term Idm and Model Regularization Term Imr, defined as:\n$\\Phi_\\tau = I_{dm} + \\lambda I_{mr}$\nwhere X is a weighting factor to balance the data fitting term and the model constraint term. dm, \u0424mr are defined as:\n$I_{dm} = (J_m - d_{obs})^T W_d W_d (J_m - d_{obs}) = ||W_d (J_m - d_{obs})||^2$\n$I_{mr} = (m - m_{ref})^T W_m W_m (m - m_{ref}) = ||W_m (m - m_{ref})||^2$\nwhere dobs denotes observed data; Jm denotes predicted observed data, derived by solving the Jacobian matrix J for the target geoelectric model m; mref denotes the reference model in the model regularization term; and Wa and Wm denote the weight matrices of the different terms, respectively.\nAccording to Equation (1), (2), (3), traditional deterministic inversion methods primarily focus on minimizing the data fitting term, typically involving the solution of the Jacobian matrix to derive the forward modeling response of the target geoelectric model. In an optimized inversion framework,"}, {"title": "A. Traditional deterministic inversion", "content": "$\\Phi_\\tau = I_{dm} + \\lambda I_{mr}$"}, {"title": "B. DL inversion and forward modeling", "content": "The difference with traditional methods is that common DL inversion methods directly map the data to the model, i.e., establish a mapping relationship between dt (observed data / forward modeling data) and mi (predicted geoelectric model). The nonlinear relationship between the two is represented using a neural network as:\n$m_i = f_T [d_t; \\theta]$\nwhere e denotes the hyperparameters of the network (including weights, biases, etc.); fT is a pseudoinverse operator parameterized by 0 [39]. Thereafter, the exact mapping from de to mi will be achieved by minimizing the objective function (loss function) Linv, to narrow the gap between the predicted geoelectric model m\u2081 and the target geoelectric model mt. The process can be expressed as:\n$L_{inv} = min ||m_i - m_t||^2 = min ||f_T [d_t; \\theta] - m_t||^2$\nSimilarly, the nonlinear relationship of MT DL forward modeling using NNs can be expressed as:\n$d_i = f_T [m_t; \\theta]$\nwhere if d is denoted as different observed data or forward modeling data (apparent resistivity and phase for different polarization directions), we can then make the network predict the correct forward modeling results by minimizing multiple loss functions Lfm as follows:\n$\\sum L_{fm} = \\sum min ||d_{m{i\\theta}} - d_t||^2 = \\sum min ||f_T [m_t; \\theta] - d_t||^2$"}, {"title": "C. DL inversion combined with DL forward modeling", "content": "Therefore, if we consider the pretrained forward modeling network model as a fixed forward operator, it can be used to calculate the forward response of the subsurface resistivity predicted by the inversion network, and thus to calculate the model-to-data error. According to Equation (5) and (7), the objective function of DL inversion combined with DL forward modeling can be expressed as:\n$L_{obt}(m, \\theta) = \\alpha L_{inv} + \\beta \\sum L_{fm}$\nwhere a and B are the weights of different terms. Different from previous studies, the construction of this objective function is based on NNs in the whole process, and we construct the data-to-model mapping A and the model-to-data mapping B through NN, respectively. Among them, Linv corresponding to mapping A serves as the main fitting target aiming at realizing the inversion, and Lfm corresponding to mapping B can be regarded as constraints and guide terms to provide forward modeling information with physical meanings for the network. Compared with using traditional forward modeling algorithms, DL forward modeling greatly improves the efficiency and allows us to incorporate physical information into large-scale 3-D MT inversion training.\nTo achieve this goal, we use a multi-stage training approach. We first pretrain multiple forward modeling sub-networks and consider them as fixed forward modules, and then combine these forward modeling modules to train inversion sub-network. Specifically, in the first stage, we follow the forward modeling network training strategy in the literature [1] and use multiple forward modeling sub-networks to train the forward modeling process for different forward response data"}, {"title": "D. Network Architecture and Loss Functions", "content": "The network used for the experiments in this paper is SwinUNETR [40] [41], which has been modified based on the characteristics of 3-D MT data [29]. Due to its excellent performance in 3-D MT DL forward modeling, we consider it a representative network for application in the methodology proposed in this paper. As shown in Figure 2, the network uses a 3-D Swin Transformer [42] as its core feature extraction module, incorporating a multi-level U-shaped encoding and decoding structure with skip connections to enhance contextual information interaction. During the encoding process, the number of feature map channels is initially increased through 3-D Linear Embedding to capture more abstract features. The network then sequentially passes through four down sampling stages, each containing two consecutive Swin Transformer modules and one 3-D Patch Merging module. The Swin Transformer module acts as the primary feature extraction component. Two consecutive Swin Transformer modules sequentially perform Window Multi-head Self-Attention (W-MSA) and Shifted Window Multi-head Self-Attention (SW-MSA) computations. MSA is based on Scaled Dot-Product Attention [43], which can efficiently extract the feature weights from the data itself, and its calculation formula is as follows:\n$Attention(Q, K, V) = SoftMax(\\frac{QK^T}{\\sqrt{d}})V$\nwhere Q, K, and V represent matrices composed of query, key, and value vectors of sequential features, respectively; d represents the dimension of the key vectors. The window-based MSA is designed to enable self-attention computation on 2-D and higher-dimensional data, while the shifted window mechanism facilitates interaction between windows, thereby enhancing the network's receptive field. The 3-D Patch Merging module functions similarly to a pooling operation, reducing the size of the feature map while increasing the number of channels. Multi-stage down sampling allows the network to learn deep, abstract features from the data.\nThe decoding part of the network gradually restores the dimensions of the data to map them to the target output using the up sampling module. In the up sampling module, the deep feature maps are first enlarged using transposed convolution to match the size of the feature maps from the skip connections. These feature maps are then concatenated along the channel dimensions, followed by a convolution with a residual operation, before being passed to the subsequent up sampling module. Since the input data is normalized, the network applies a Sigmoid function to produce the final output. The number of input and output channels in the figure is determined by the specific task, with n = m = 1 for the forward modeling sub-network and n = 4, m = 1 for the inversion sub-network.\nWe use Mean Squared Error (MSE) as the loss function to guide network optimization during the training of each forward modeling sub-network and the overall network (training the inversion sub-network). For DL forward modeling, we trained separate forward modeling sub-networks for different forward responses with varying apparent parameters. The corresponding losses can be specified according to Equation (7) as follows:\n$L_{fm}(d,d')= \\frac{1}{n} \\sum_{i=1}^{n} (d_i - d'_i)^2$\nwhere n denotes the total number of data points, d denotes the true value, and d' denotes the network prediction result."}, {"title": "III. EXPERIMENTATION", "content": "In order to explore the validity of the method and to make the network have the possibility of effective inversion of the field data, the resistivity distribution of the theoretical geoelectric model in the dataset of this paper simulates different morphologies of layers and regular anomalies at the same time, so as to make it close to the real subsurface tectonics. In the default Cartesian coordinate system, x and y denote the maximum distance in the horizontal direction of the geoelectric model, and z denotes the maximum depth in the vertical direction, respectively. Each layer is generated by surface interpolation of a number of random 3-D spatial points, including four fixed points in the horizontal direction: (0, 0, z'), (x, 0, z'), (0, y, z'), and (x, y, z'), and several random coordinates (P1,P2, z'), where p\u2081 \u2208 (0,x), p2 \u2208 (0,y). The depth z' of the spatial coordinates of each layer takes values between (0, z), with interleaving allowed for different layers.\nAs shown in Figure 3-a, the first layer 11 is constructed and populated with random resistivity by the above method; then as shown in Figure 3-b, we generate the second layer 12, and when 12 is deeper somewhere compared to l\u2081, the resistivity between the layers will be updated by the new random value, and vice versa will not be. Subsequently, from Figure 3-c to Figure 3-d, we gradually constructed a four-layer layered geoelectric model, which can simulate very diverse and complex subsurface formations because the layer surfaces formed by each random interpolation are allowed to overlap. In the second step, regular anomalies with random numbers, sizes and resistivities are added, mainly focusing on the shallow part, as shown in Figure 3-e and Figure 3-f, and finally a highly diversified theoretical geoelectric model including random layers and anomalies is obtained. Figure 3-g through Figure 3-i illustrate some of the geoelectric models in the training set.\nSpecifically, the resistivity of this dataset is randomly populated to take the range of (1, 1000) \u03a9m. All geoelectric models are horizontally oriented at a distance of 8 km in x and y, uniformly divided into 32 \u00d7 32 equally spaced grids. The depth z is 4 km, with the first layer being 20m thick, divided into 32 grids using an isometric downward expansion factor of 1.1. The geoelectric model is forward modeling by FDM using ModEM [45], the simulated measurement points are uniformly distributed in the horizontal direction of the ground surface according to 32 \u00d7 32 with a spacing of 250m, and the simulated detection frequency is 1000Hz 0.1Hz, including 32 frequency points. Finally, the dimensions of the geoelectric model and its forward modeling response data with any apparent parameters are all 32 x 32 x 32.\nNote that the model needs to be flared (5 grids in both horizontal and depth directions) due to forward modeling using ModEM. Therefore, we will actually generate a 3-D geoelectric model with a grid size of 42 \u00d7 42 \u00d7 37 for ModEM calculation of forward modeling data by the method described above, and dig down the first layer of its center to create a 3-D geoelectric model with a grid size of 32 x 32 x 32 for deep learning training, to avoid possible incorrect results of forward modeling calculations after simply filling the background field resistivity. We constructed 28,000 pairs of samples according to the above settings, which is a challenging dataset for both traditional inversion methods and DL inversion methods. Subsequently, they are randomly divided into training set, validation set, and test set according to 8:1:1, which are synchronously applied to the training of the forward modeling and inversion sub-networks."}, {"title": "A. Dataset Construction", "content": "In order to explore the validity of the method and to make the network have the possibility of effective inversion of the field data, the resistivity distribution of the theoretical geoelectric model in the dataset of this paper simulates different morphologies of layers and regular anomalies at the same time, so as to make it close to the real subsurface tectonics. In the default Cartesian coordinate system, x and y denote the maximum distance in the horizontal direction of the geoelectric model, and z denotes the maximum depth in the vertical direction, respectively. Each layer is generated by surface interpolation of a number of random 3-D spatial points, including four fixed points in the horizontal direction: (0, 0, z'), (x, 0, z'), (0, y, z'), and (x, y, z'), and several random coordinates (P1,P2, z'), where p\u2081 \u2208 (0,x), p2 \u2208 (0,y). The depth z' of the spatial coordinates of each layer takes values between (0, z), with interleaving allowed for different layers.\nAs shown in Figure 3-a, the first layer 11 is constructed and populated with random resistivity by the above method; then as shown in Figure 3-b, we generate the second layer 12, and when 12 is deeper somewhere compared to l\u2081, the resistivity between the layers will be updated by the new random value, and vice versa will not be. Subsequently, from Figure 3-c to Figure 3-d, we gradually constructed a four-layer layered geoelectric model, which can simulate very diverse and complex subsurface formations because the layer surfaces formed by each random interpolation are allowed to overlap. In the second step, regular anomalies with random numbers, sizes and resistivities are added, mainly focusing on the shallow part, as shown in Figure 3-e and Figure 3-f, and finally a highly diversified theoretical geoelectric model including random layers and anomalies is obtained. Figure 3-g through Figure 3-i illustrate some of the geoelectric models in the training set.\nSpecifically, the resistivity of this dataset is randomly populated to take the range of (1, 1000) \u03a9m. All geoelectric models are horizontally oriented at a distance of 8 km in x and y, uniformly divided into 32 \u00d7 32 equally spaced grids. The depth z is 4 km, with the first layer being 20m thick, divided into 32 grids using an isometric downward expansion factor of 1.1. The geoelectric model is forward modeling by FDM using ModEM [45], the simulated measurement points are uniformly distributed in the horizontal direction of the ground surface according to 32 \u00d7 32 with a spacing of 250m, and the simulated detection frequency is 1000Hz 0.1Hz, including 32 frequency points. Finally, the dimensions of the geoelectric model and its forward modeling response data with any apparent parameters are all 32 x 32 x 32.\nNote that the model needs to be flared (5 grids in both horizontal and depth directions) due to forward modeling using ModEM. Therefore, we will actually generate a 3-D geoelectric model with a grid size of 42 \u00d7 42 \u00d7 37 for ModEM calculation of forward modeling data by the method described above, and dig down the first layer of its center to create a 3-D geoelectric model with a grid size of 32 x 32 x 32 for deep learning training, to avoid possible incorrect results of forward modeling calculations after simply filling the background field resistivity. We constructed 28,000 pairs of samples according to the above settings, which is a challenging dataset for both traditional inversion methods and DL inversion methods. Subsequently, they are randomly divided into training set, validation set, and test set according to 8:1:1, which are"}, {"title": "B. Data preprocessing", "content": "To help the network learn the data features and to speed up the network fitting, we first normalize the data to reduce the differences in the range of values. Both the geoelectric modeling and forward modeling response data were mapped to between (0, 1). The normalization formula is as follows:\n$m'_i = \\frac{log_{10}(m_i) - min(log_{10}(m))}{max(log_{10}(m)) \u2013 min(log_{10}(m))}, i = 1,..., N$\n$d'_i = \\frac{log_{10}(d^p_i) - min(log_{10}(d^p))}{max(log_{10}(d^p)) -\u2013 min(log_{10}(d^p))}, i = 1, ..., N$\n$d'_i = \\frac{d^o_i}{90}, i = 1,..., N$\nwhere mi, d, do and denote each pre-normalized geoelectric model, apparent resistivity and phase, respectively. mi', d' and do denote the post-normalization results, respectively. N denotes the total number of datasets."}, {"title": "C. Experimental environment and parameter settings", "content": "The hardware environment for the experiment includes an INTEL i7-14700KF processor and an NVIDIA RTX 4090 D GPU, utilizing the Pytorch training framework and the RAdam optimizer. The batch size for forward modeling sub-network training is set to 24, with an initial learning rate of 2e-4 and a maximum of 100 training epochs. The batch size for overall training of the inversion sub-network is set to 8, with an initial learning rate of 2e-4 and a maximum of 65 training epochs. During training, if the validation set metrics do not improve for 5 consecutive epochs, the learning rate is reduced to half of its original value. If there is no improvement for 8 consecutive epochs, the early stopping mechanism is activated. We quantitatively measure the accuracy of NN forward modeling and inversion by structural similarity (SSIM), mean absolute error (MAE) and mean mean square error (RMSE). Structural similarity (SSIM) focuses on the structural similarity of the data [46], which can reflect the local structural variations as well as the overall feature similarity of the data as follows:\n$SSIM(x,y) = \\frac{(2\\mu_x\\mu_y + C_1)(2\\sigma_{xy} + C_2)}{(\\mu_x^2 + \\mu_y^2 + C_1) (\\sigma_x^2 + \\sigma_y^2 + C_2)}$\n$C_1=(K_1L)^2, C_2=(K_2L)^2$\nHere, x denotes the true value; y denotes the network predicted value; \u03bc\u03b1 and \u00b5y denote the mean luminance; \u03c3\u03b5 and \u03c3\u03c5 represent the luminance variance. oxy denotes the luminance covariance between the true value and the predicted value. C\u2081 and C2 are constants used for stabilize the calculation and avoid division by 0. The variable L in C represents the range of variation of the data, for apparent resistivity and geoelectric modeling, L is the range of values after taking logarithms, for phase, L is 90. K\u2081 and K2 are adjustment parameters used to control contrast and luminance, typically set to 0.01 and 0.03, respectively.\nThe MAE quantifies the overall deviation of the predicted values by calculating the mean of the absolute error between the predicted and actual values, as follows:\n$MAE(x,y) = \\sum_{i=1}^{n} (|Y_i \u2212 x_i|)$\nwhere n denotes the total number of data points in the data; Yi denotes the predicted value of the network for the i-th data point; and xi denotes the actual value of the i-th data point. The RMSE is more sensitive to larger errors and is used to identify the presence of extreme biases in the results, as follows:\n$RMSE(x,y) = \\sqrt{\\frac{1}{n} \\sum_{i=1}^{n} (Y_i - X_i)^2}$\nThe parameters in Equation (15) have the same meanings as those in Equation (16). Additionally, we will assess the overall network inversion performance using 3-D data visualization."}, {"title": "D. Forward modeling network training", "content": "We initially train \u03c1\u03c7y, \u03a6\u03a7\u03a5,\u03c1\u04afx and \u03a6\u04afx in the 3-D MT forward modeling response using four separate forward modeling subnetworks. In this process, pxy and xy are fully trained first, and the resulting models are then used to train \u0420\u0443\u0445 and \u0444\u04af\u0445, respectively, using a transfer learning strategy to reduce the overall forward modeling training time. The variation curves of each metric in the training and validation"}, {"title": "IV. DISCUSSION", "content": "We analyze the inversion results of different methods using 3-D visualizations. Figure 8 and Figure 9 display the inversion results of two randomly selected geoelectric models from the test set. In particular, Case 1, shown in Figure 8, exhibits an overall low-high-low resistivity distribution, with a more complex distribution of multiple high resistivity layers in the center, necessitating higher inversion accuracy for the global structure. In terms of visualization, P-PhysInv provides more accurate inversion details and consistently outperforms Direct-Inv across various noise and masking levels. Particularly in the case of 8% Gaussian noise with 80% random masking, at the edge of the model (y = 0 km, x = 0 km to 8km), the DirectInv inversion performs poorly, making it nearly impossible to accurately reconstruct this portion of the high resistivity layer. Although the P-PhysInv method introduces some errors in the morphological details, it ensures that the overall structure is accurately represented. The resistivity variation curves shown in Figure 8-f further demonstrate that the P-PhysInv method is more accurate in predicting the localization and resistivity values of different layers. Case 2, shown in Figure 9, exhibits a high-low-high-low resistivity distribution near x = 0 km and y = 0 km, with a locally layered structure that requires precise portrayal of layer positions in the inversion results. The visualization results indicate that DirectInv performs poorly in resolving the interface between low and high resistivity from 1 km to 2 km; the layer interface appears blurred, and the depiction of layer orientation is inferior to that of the P-PhysInv results. The P-PhysInv method clearly outperforms DirectInv in multilayer geoelectric modeling with abrupt re-sistivity variations, particularly in accurately delineating the interfaces of high resistivity layers and the overall portrayal of irregular anomalies.\nIn summary, the DL inversion method effectively achieves high-precision and high-resolution inversion. For the more complex layered geoelectric model designed in this paper, the method demonstrates strong horizontal and vertical resolution, a capability that is difficult to achieve with traditional methods. In particular, compared to the DirectInv DL method, the P-PhysInv method, which incorporates pseudo-physical information, achieves better inversion accuracy across various noise and masking levels. This improvement is mainly observed in the more distinct inversion of layer interfaces and more accurate resistivity values. Additionally, we present test results at higher noise and masking levels compared to the training set, where the rule masks tested were not present during training, yet the method still proved effective. This demonstrates that the method is generalizable and has the potential for application to field data."}, {"title": "A. Visualization comparison of different DL inversion methods", "content": "We analyze the inversion results of different methods using 3-D visualizations. Figure 8 and Figure 9 display the inversion results of two randomly selected geoelectric models from the test set. In particular, Case 1, shown in Figure 8, exhibits an overall low-high-low resistivity distribution, with a more complex distribution of multiple high resistivity layers in the center, necessitating higher inversion accuracy for the global structure. In terms of visualization, P-PhysInv provides more accurate inversion details and consistently outperforms Direct-Inv across various noise and masking levels. Particularly in the case of 8% Gaussian noise with 80% random masking, at the edge of the model (y = 0 km, x = 0 km to 8km), the DirectInv inversion performs poorly, making it nearly impossible to accurately reconstruct this portion of the high resistivity layer. Although the P-PhysInv method introduces some errors in the morphological details, it ensures that the overall structure is accurately represented. The resistivity variation curves shown in Figure 8-f further demonstrate that the P-PhysInv method is more accurate in predicting the localization and resistivity values of different layers. Case 2, shown in Figure 9, exhibits a high-low-high-low resistivity distribution near x = 0 km and y = 0 km, with a locally layered structure that requires precise portrayal of layer positions in the inversion results. The visualization results indicate that DirectInv performs poorly in resolving the interface between low and high resistivity from 1 km to 2 km; the layer interface appears blurred, and the depiction of layer orientation is inferior to that of the P-PhysInv results. The P-PhysInv method clearly outperforms DirectInv in multilayer geoelectric modeling with abrupt re-sistivity variations, particularly in accurately delineating the interfaces of high resistivity layers and the overall portrayal of irregular anomalies.\nIn summary, the DL inversion method effectively achieves high-precision and high-resolution inversion. For the more complex layered geoelectric model designed in this paper, the method demonstrates strong horizontal and vertical resolution, a capability that is difficult to achieve with traditional methods. In particular, compared to the DirectInv DL method, the P-PhysInv method, which incorporates pseudo-physical information, achieves better inversion accuracy across various noise and masking levels. This improvement is mainly observed in the more distinct inversion of layer interfaces and more accurate resistivity values. Additionally, we present test results at higher noise and masking levels compared to the training set, where the rule masks tested were not present during training, yet the method still proved effective. This demonstrates that the method is generalizable and has the potential for application to field data."}, {"title": "B. Field data application", "content": "By masking and adding noise to the data during training, this new input data mode simulates 3-D MT inversion under sparse data conditions, providing the flexibility to apply the method to 3-D MT field data. To evaluate the validity of the methods proposed in this paper on field data, we applied the P-PhysInv method to invert the 3-D MT data obtained from actual observations. As shown in Figure 10, the work area is located in Xinjiang, China, where 112 measurement points are evenly distributed in 8 rows and 14 columns, with spacing between neighboring points ranging from 480m to 510m. The inversion is conducted using data from frequencies ranging between 320 Hz and 0.0094 Hz. Due to the differences between the observed frequency points and the simulated frequency points in the theoretical dataset, the single-point observed data were first interpolated to 32 frequency points. The interval between each measurement point is larger than the simulated measurement point distance in the theoretical dataset. To maintain consistency in measurement point spacing, we uniformly embed the data into the 3D data structure, as shown in Figure 10-c (blue dots). The non-data regions are set to -1 (considered as a masking operation, consistent with the theoretical model training), and the resulting 32 x 32 x 32 3-D data structure is input into the inversion network. For"}, {"title": "V. CONCLUSION", "content": "In this study, we propose a pseudo-physical information-guided 3-D geo-electromagnetic (MT) deep learning (DL) inversion (P-PhysInv) method"}]}