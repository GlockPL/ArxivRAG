{"title": "TCKIN: A Novel Integrated Network Model for Predicting Mortality Risk in Sepsis Patients", "authors": ["Fanglin Dong"], "abstract": "Sepsis poses a major global health threat, accounting for millions of deaths annually and significant economic costs. Accurate predictions of mortality risk in sepsis patients facilitate the efficient allocation of medical resources, thereby enhancing patient survival and quality of life. Through precise risk assessments, healthcare facilities can effectively distribute intensive care beds, medical equipment, and staff, ensuring high-risk patients receive timely and appropriate care. Early identification and intervention significantly decrease mortality rates and improve patient outcomes. Current methods typically utilize only one type of data\u2014either constant, temporal, or ICD codes. This study introduces the Time-Constant KAN Integrated Network (TCKIN), an innovative model that enhances the accuracy of sepsis mortality risk pre- dictions by integrating both temporal and constant data from electronic health records and ICD codes. Validated against the MIMIC-III and MIMIC- IV datasets, TCKIN surpasses existing machine learning and deep learning methods in accuracy, sensitivity, and specificity. Notably, TCKIN achieved AUCs of 87.76% and 88.07%, demonstrating superior capability in identify- ing high-risk patients. Additionally, TCKIN effectively combats the preva- lent issue of data imbalance in clinical settings, improving the detection of patients at elevated risk of mortality and facilitating timely interventions. These results confirm the model's effectiveness and its potential to transform patient management and treatment optimization in clinical practice. With this advanced risk assessment tool, healthcare providers can devise more tai- lored treatment plans, optimize resource utilization, and ultimately enhance survival rates and quality of life for sepsis patients.", "sections": [{"title": "Introduction", "content": "Sepsis, a systemic inflammatory response syndrome triggered by infection [1], can lead to multi-organ dysfunction or failure in severe cases [2]. As a significant global health challenge, sepsis affects millions annually, resulting in substantial medical costs and high mortality rates [3]. According to the World Health Organization, approximately 49 million cases occur worldwide each year, with about 11 million fatalities [4]. The economic impact is pro- found; for instance, in the United States, the annual cost of treating sepsis exceeds $24 billion, representing one of the healthcare system's largest expen- ditures [5]. Given the high mortality associated with sepsis [6] and its eco- nomic repercussions, accurately predicting mortality risk in sepsis patients is crucial. This enables more rational allocation of medical resources, enhancing patient survival rates and quality of life [7]. Through precise mortality risk assessments, medical institutions can more effectively distribute resources like intensive care beds and medical staff, ensuring high-risk patients receive timely care. Accurate predictions also allow for the development of person- alized treatment plans, optimizing treatment strategies to improve efficacy, reduce hospital stays, and lower costs [8]. Most critically, early identification and intervention for high-risk patients can significantly decrease mortality rates, thereby improving outcomes and quality of life.\nWith the advent of Electronic Health Records (EHR) systems [9], there has been a significant increase in the availability of medical data, enriching the resources for mortality risk prediction in sepsis. Data typically used for this purpose includes physiological metrics from the prior 24 hours, labora- tory results, and demographic and diagnostic information, which are pivotal for developing high-accuracy predictive models.\nIn current clinical practice, several scoring tools are widely utilized to assess sepsis severity, including the Sequential Organ Failure Assessment (SOFA) [10], Acute Physiology and Chronic Health Evaluation II (APACHE II) [11], Simplified Acute Physiology Score II (SAPS II) [12], and the Sepsis Severity Score (SSS) [13]. However, these tools exhibit notable limitations. They are predominantly based on specific populations and clinical settings from their time of development, leading to reduced predictive accuracy as de- mographics and practices evolve. Studies indicate that SOFA, APACHE II, and SAPS II are less effective in predicting ICU sepsis patient mortality due to their reliance on a limited set of static physiological parameters, which do not fully capture dynamic patient condition changes [14, 15]. Furthermore,"}, {"title": "Methods", "content": "This study utilizes the MIMIC-III[19] and MIMIC-IV[35] datasets, both derived from the Intensive Care Units (ICU) at Beth Israel Deaconess Med- ical Center, USA. These datasets were collaboratively created by the Mas- sachusetts Institute of Technology's Computer Science and Artificial Intelli- gence Laboratory (MIT CSAIL) and the medical center. MIMIC-III, publicly available, encompasses detailed health records of approximately 60,000 pa- tients from 2001 to 2012, encompassing patient demographics, vital signs, laboratory test results, medication records, nursing notes, radiology reports, and discharge summaries. This database supports clinical research and the development of machine learning and artificial intelligence algorithms. MIMIC- IV, an enhancement of MIMIC-III, includes ICU data from 2012 to 2019, featuring improved data quality and expanded clinical data types over a longer record span. These enhancements facilitate complex medical research and sophisticated data analysis. This study leverages these rich datasets to deeply analyze diagnostic information, temporal changes in vital signs, and other pertinent clinical features of sepsis patients. Authorization to use the MIMIC databases was obtained, and data extraction was conducted. Eth- ical approval was granted by the Institutional Review Board of Beth Israel Deaconess Medical Center. Compliance with HIPAA regulations ensured de-identification of all Protected Health Information (PHI), eliminating the need for patient consent and maintaining strict ethical and privacy standards to protect patient privacy effectively."}, {"title": "Data Preprocessing", "content": "Based on the Sepsis-3 definition[36], we selected sepsis patients from the MIMIC-III and MIMIC-IV datasets who had a SOFA score of 2 or higher, as illustrated in Figure 2. Initially, we excluded patients under the age of 16 and those with corrupted data. We also eliminated patients with suspected infections occurring more than 24 hours before or after ICU admission, due to the ambiguous timing of their infection diagnoses, which could compro- mise the study's accuracy. Furthermore, we excluded patients with ICU stays shorter than 24 hours, as their incomplete clinical data insufficiently support the model. Additionally, patients who underwent cardiac, thoracic, or vascu- lar surgery were omitted because their unique surgical treatments and care requirements could adversely affect the model's generalizability. For sepsis patients with multiple hospital admissions, we used data from their initial admission.\nUsing these criteria, we extracted patients' constant and temporal data,"}, {"title": "The Architecture of TCKIN", "content": "In our study, the proposed network architecture comprises three primary components. Initially, temporal data are processed via the GRU-D (Gated Recurrent Unit with Decay) model, which generates hidden representations of these data. The second component utilizes an attention mechanism to an- alyze the patient's ICD diagnostic codes and CCS codes, capturing complex relationships and semantic information, thereby enriching diagnostic feature representations. The third component processes constant data through the Kolmogorov-Arnold Networks (KAN). This network efficiently leverages con- stant feature information to extract high-level features via a multi-layer neu- ral network. Subsequently, the hidden features from these three components are concatenated to form an integrated feature vector. This vector is fur- ther processed through a final KAN network to predict the patient's sepsis mortality risk.\nIn our methodology, temporal data D is defined as\n$D = (D_1, D_2, . . ., D_t, ..., D_T) \\in \\mathbb{R}^{T\\times N}$ (2)\nwhere T denotes a 24-hour time interval, and N represents the number of features. To address missing values, we introduce a mask matrix I and time intervals \u2206, facilitating effective management of these gaps. The mask $I \\in \\mathbb{R}^{T\\times N}$ indicates data presence, where a value of 0 shows absence, and 1 shows presence of data at a time step. The time interval $\\Delta_t \\in \\mathbb{R}$ measures the time elapsed since the last observed data point, calculated by:\n$\\Delta_t = \\begin{cases}1 + \\Delta_t^{n-1}, & \\text{if } t > 1 \\text{ and } I_t^{n-1} = 0,\\\\ 1, & \\text{if } t > 1 \\text{ and } I_t^{n-1} = 1,\\\\ 0, & \\text{if } t = 1.\\end{cases}$\nThis data is processed through the GRU-D (Gated Recurrent Unit with Decay) model. The GRU-D network effectively manages missing values by utilizing the mask I and time intervals \u0394. The decay mechanism dynamically adjusts imputation values based on these intervals, thereby mitigating the impact of missing data during state updates. Through this approach, the GRU-D model generates reliable hidden feature representations $h_t$. Figure 4 illustrates the GRU-D network, detailing the operations as follows:\nDecay factor calculation:\n$\\gamma_t = \\exp(-\\max(0, W_{\\Delta}\\Delta_t + b_{\\Delta}))$\nInput gate:\n$Z_t = \\sigma (W_z(D_t \\odot I_t) + U_z(\\gamma_t \\odot h_{t-1}) + b_z)$"}, {"title": "Implementation", "content": "In our research, we implemented and trained our model using the Tensor- Flow framework. We utilized the Adam optimizer to update model parame- ters and employed a learning rate decay strategy to dynamically adjust the learning rate, enhancing the model's convergence stability. To address the significant imbalance between positive and negative samples, we applied over- sampling techniques to maintain a consistent ratio of these samples across training, validation, and test sets. This method effectively mitigated model bias toward the majority class, thereby enhancing its generalization capabili- ties on imbalanced datasets. Moreover, we adopted five-fold cross-validation to validate the model's stability and generalizability. By dividing the dataset into five mutually exclusive subsets, using one for validation and the remain- ing four for training\u2014and repeating this process five times\u2014we ensured the model's consistent performance across various data splits. To prevent over- fitting, we incorporated Dropout layers and monitored the validation set per- formance using early stopping techniques, halting training when no further reduction in validation loss was observed."}, {"title": "Results", "content": "In this section, we describe the metrics employed to assess the TCKIN model's performance. These metrics are vital for gauging the model's accu- racy in predicting mortality risk among ICU sepsis patients. The principal evaluation metrics include sensitivity, specificity, area under the receiver op- erating characteristic curve (AUROC), area under the precision-recall curve (AUPRC), and the Brier Score (BS). Each metric offers a unique perspec- tive on the model's performance, enabling a thorough analysis. The specific formulas for these metrics are as follows:\n$Sensitivity = \\frac{TP}{TP+FN}$\n$Specificity = \\frac{TN}{TN+FP}$\n$Precision = \\frac{TP}{TP+FP}$\n$BS = \\frac{1}{N}\\sum_{i=1}^N(f_i - a_i)^2$\nwhere TP is true positive, FN is false negative, TN is true negative, FP is false positive, N is the number of samples, $f_i$ is the predicted probability for the $i^{th}$ sample, and $a_i$ is the actual label (0 or 1) for the $i^{th}$ sample."}, {"title": "Model Performance", "content": "We evaluated the TCKIN model's performance on the MIMIC-III and MIMIC-IV datasets by comparing it with seven established baseline mod- els: Xgboost [38], SVM, Random Forest (RF)[39], LGBM[22], LSTM[31], IseeU[40], and and Che et al.'s model GRU-D[33]. This comparison across various metrics such as sensitivity, specificity, AUROC, AUPRC, and Brier score allowed us to thoroughly assess the strengths and weaknesses of each model. Figure 6 illustrates the comparative performance, demonstrating that the TCKIN model generally outperforms the baseline models. Notably, on the MIMIC-IV dataset, the TCKIN model achieved AUROC and AUPRC values of 0.8807 and 0.5470, respectively, significantly surpassing its com- petitors. This indicates its superior accuracy and stability in distinguishing between positive and negative cases and handling imbalanced datasets. Ad- ditionally, the TCKIN model's balanced performance in sensitivity (0.7875) and specificity (0.8153) underscores its effectiveness in identifying patients at different levels of risk. A lower Brier score of 0.0696 reflects the model's precision in probability predictions. Figure 7, showing the ROC curves, fur- ther highlights the TCKIN model's enhanced ability to differentiate between outcomes, with its curve closer to the top-left corner, symbolizing higher prediction accuracy across various thresholds.\nTo further evaluate the robustness of the TCKIN model, we conducted pa- rameter sensitivity experiments focusing on the learning rate (LR) and batch size, two crucial hyperparameters that influence model performance. We sys- tematically varied these parameters, setting the learning rate at 0.0001, 0.001, 0.01, and 0.1, and the batch size at 16, 32, 64, and 128, to observe their effects on model performance under various combinations. Figure 8 illustrates these performance changes through a three-dimensional graph that plots AUROC values against variations in learning rate and batch size. The results indicate that the TCKIN model achieves optimal performance with a learning rate"}, {"title": "Ablation Study", "content": "To further validate the effectiveness and importance of the components of the TCKIN model, we conducted ablation experiments. These experi- ments involved removing or replacing key modules to assess their impact on the overall model performance. In the first ablation study, we substituted the GRU-D (Gated Recurrent Unit with Decay) module, which is tailored to manage irregular time series data more effectively, with a standard GRU module. This change allowed us to directly compare the performance en- hancements offered by GRU-D. Results, as shown in Table 4, indicate a"}, {"title": "Discussion", "content": "In this study, we conducted an in-depth analysis of various data features to determine their significance in a model predicting the mortality risk of sepsis patients. Our comprehensive evaluation revealed several key features that significantly influence the model's predictive accuracy.\nFor the temporal data, Figure 9 highlights the top ten features with the highest feature weights and their contributions, including pH value, alanine aminotransferase, red blood cell count, monocyte count, urine output, pro- thrombin time, calcium levels, bilirubin, anion gap, and mean corpuscular hemoglobin concentration. These indicators not only reflect the patient's current physiological state but also detect subtle shifts in their condition, enhancing the accuracy of mortality predictions. For instance, variations in pH value can signal shifts in acid-base balance, alterations in urine output may indicate changes in renal function, and levels of alanine aminotransferase and bilirubin provide insights into liver health. Additional data such as red blood cell and monocyte counts, along with mean corpuscular hemoglobin concentration, are crucial for assessing blood health and immune response, while prothrombin time and anion gap offer insights into coagulation and metabolic status.\nFigure 10 presents the top five features by feature weight within the constant data, including age, race, weight, and type of admission. These attributes provide essential health and demographic information about the patient. Notably, age is a crucial factor because older patients often have a higher risk of mortality. Additionally, weight serves as a significant health indicator that can affect the severity of diseases and the efficacy of treat- ments, thereby influencing the overall prognosis. The nature of admission (emergency, urgent, or elective) informs the urgency of the patient's condi- tion upon hospitalization.\nOur analysis of patient ICD codes revealed that certain codes, especially those related to severe conditions like diabetes and specific malignancies, are strongly associated with increased mortality risk. Codes for secondary di- abetes, certain skin disorders, diseases of the middle ear and mastoid, and malignant neoplasms of the retina, for instance, highlight underlying severe health issues that can complicate the patient's recovery process. Addition- ally, ICD codes for benign tumors of the colon, malignant neoplasms of the cervix, spirochaetal jaundice, neuroendocrine tumors, trigeminal neuralgia, and Pneumocystis jirovecii pneumonia were also identified as significantly influencing mortality rates, underscoring their importance in patient man- agement and treatment focus.\nDespite the achievements of this study, it has several limitations. First, the datasets used, primarily MIMIC-III and MIMIC-IV, originate from a sin- gle medical center and may not adequately represent patient conditions in other regions or healthcare facilities. Second, while the model's predictive performance surpasses existing methods, opportunities for enhancement re- main, particularly in processing specific types of patient data. For instance, certain features may exhibit variable performance across different popula- tions, necessitating further validation of the model's applicability. Addition- ally, the feature selection and preprocessing methods employed may not cap-"}, {"title": "Conclusion", "content": "The Temporal-Constant KAN Integrated Network (TCKIN) model intro- duced in this study has demonstrated considerable superiority in predicting the mortality risk of ICU sepsis patients. By integrating constant and tem- poral data along with patient diagnostic ICD codes and medical ontology CCS codes, the TCKIN model achieves greater accuracy in mortality risk prediction. Experimental results show that the TCKIN model surpasses ex- isting models on evaluation metrics such as AUROC, AUPRC, sensitivity, and specificity, underscoring its effectiveness in managing complex medical data and enhancing predictive precision. Furthermore, these results high- light the substantial benefits of the GRU-D and KAN modules in processing irregular temporal data and capturing intricate features.\nThis study not only confirms the effectiveness of the TCKIN model in integrating multi-source heterogeneous data but also underscores the signif- icance of key features in prediction accuracy. These insights provide strong support for future clinical decision-making, facilitating the early identifica- tion and timely intervention for high-risk patients, thereby potentially reduc- ing sepsis mortality rates and improving outcomes. The findings also serve as valuable references for ongoing research. By continuing to refine and expand the model, its applicability and accuracy across various clinical environments and patient demographics can be further improved. Future studies could in- clude additional types of feature data, such as genetic and imaging data, to provide a more comprehensive assessment of patients' health conditions and enhance the model's predictive capabilities."}]}