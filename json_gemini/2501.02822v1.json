{"title": "RDD4D: 4D Attention-Guided Road Damage Detection And Classification", "authors": ["Asma Alkalbani", "Muhammad Saqib", "Ahmed Salim Alrawahi", "Abbas Anwar", "Chandarnath Adak", "Saeed Anwar"], "abstract": "Abstract\u2014Road damage detection and assessment are crucial components of infrastructure maintenance. However, current methods often struggle with detecting multiple types of road damage in a single image, particularly at varying scales. This is due to the lack of road datasets with various damage types having varying scales. To overcome this deficiency, first, we present a novel dataset called Diverse Road Damage Dataset (DRDD) for road damage detection that captures the diverse road damage types in individual images, addressing a crucial gap in existing datasets. Then, we provide our model, RDD4D, that exploits Attention4D blocks, enabling better feature refinement across multiple scales. The Attention4D module processes feature maps through an attention mechanism combining positional encoding and \"Talking Head\" components to capture local and global contextual information. In our comprehensive experimental analysis comparing various state-of-the-art models on our proposed, our enhanced model demonstrated superior performance in detecting large-sized road cracks with an Average Precision (AP) of 0.458 and maintained competitive performance with an overall AP of 0.445. Moreover, we also provide results on the CrackTinyNet dataset; our model achieved around a 0.21 increase in performance. The code, model weights, dataset, and our results are available on https://github.com/msaqib17/Road_Damage_Detection.", "sections": [{"title": "I. INTRODUCTION", "content": "INFRASTRUCTURE and public facilities, such as roads, play an essential role in the country's economy, particularly in modern-day cities. During periods of rapid economic growth in any country, the focus is heavily on building roads, bridges, and roads. However, many of these infrastructures, such as roads, have aged due to multiple factors, for example, rain, weather, vehicles, and the number of years that have passed, causing various road damages [1].\nRoad damage seriously impacts drivers' safety, vehicles' value, and efficiency. Moreover, the number of roads inspected in the next few decades will increase drastically; hence, each country requires a sizeable budget for repair, restoration, rehabilitation, and maintenance [2]. According to the Federal Highway Administration, the road network in the United States was 4.17 million miles in 2020, an increase from 3.87 million miles in 1990 [3]. Moreover, to construct new roads and maintain the existing ones, the US government spends more than 30 billion dollars each year [4]. In Europe, 50 million people are wounded annually in crashes [5]. At the same time, the American Automobile Association documents that actual road damages cost drivers in the United States around $15 billion over five years, averaging $3 billion annually [4]. The primary reason for these statistics is the poor condition of the roads.\nThe expert engineers identify the affected infrastructure, relying on their knowledge, experience, and background. Due to the increase in infrastructure inspection requirements, nu- merous cities and municipalities utilize a variety of sensors, such as laser scanners, road profilers, multiple cameras, and 3D sensors, to inspect roads around the world. These sensors capture images of road assets, pavements, and longitudinal and transverse views. Concerning the above-mentioned adverse trend in infrastructure road maintenance and management, efficient, reliable, and sophisticated techniques are urgently required for monitoring. A direct approach is the human visual assessment; regardless, it is laborious, expensive, time-consuming, and prone to human error.\nTo tackle the issue of manual inspection, many researchers have opted for automatic road inspection techniques to study the road conditions, which can be broadly classified into three categories: 1) laser scanning [6] methods, which provide accu- rate information about the status of the road but are expensive and require a road closure, 2) vibration-based [7] methods are restricted to the touched road elements, and 3) vision- based [8]\u2013[10] techniques are inexpensive but lack accuracy. Despite the shortcomings of image-based methods, recent progress in vision-based approaches is yielding exceptional results and thus extending their benefit for diverse applications such as road sign detection [11], traffic analysis [12], crowd counting [13], object detection [14], etc.\nIt should also be noted that specialized vehicles with differ- ent sensors, including laser scanners, road profilers, multiple cameras, and 3D sensors, are employed to inspect roads by capturing images of road assets, pavement images, and longitudinal and transverse image profiles [15]. Although these vehicles are inexpensive and more efficient than the traditional human visual surveying approach, they can still reach millions of dollars per vehicle, depending on the sensors acquired to build the system to be mounted on the vehicle [16]. Mean-"}, {"title": "II. RELATED WORKS", "content": "The maintenance of road infrastructure is essential to en- suring safe and efficient transportation. One of the most significant challenges in road maintenance is detecting and monitoring cracks in the road surface. Cracks in the road surface can cause accidents and lead to costly repairs if not de- tected and addressed promptly. Machine learning techniques, particularly CNN, are widely applied for automated road crack detection. These techniques have shown promise in improving road crack detection, classification accuracy, and efficiency. However, there has been a limited evaluation of these methods in real-world data and large datasets, which is critical for practical applications. In this section, we analyze recent studies on road crack detection using machine learning techniques, highlighting their objectives, contributions, and limitations. This review aims to provide an overview of state-of-the-art crack detection using machine learning, as well as identify prospective research directions to improve the accuracy and robustness of these approaches."}, {"title": "A. Traditional Methods", "content": "Road damage detection is studied using traditional image processing algorithms, which mainly rely on background subtraction, thresholding, segmentation, and feature extrac- tion. For example, gray-scale histograms with OTSU thresh- olds [18], gray-level co-occurrence matrix [19], modified median filter and morphological filter [20], support vector machine algorithms [21], a library of machine learning mod- els [22], and edge detectors [23] are used to detect pavement cracks and different types of road damages. However, these al- gorithms have limitations and shortcomings, such as sensitivity to lighting and background changes, reliance on handcrafted features, sensitivity to noise, complex backgrounds, and the inability to generalize to various roads and their types, which reduces road damage detection accuracy."}, {"title": "B. Deep Learning Methods", "content": "Recent research [24], [25] has utilized deep convolutional neural networks for automated road assessments and damage identification. Zhang et al. [26] trained the supervised deep CNN to classify smartphone pavement images for road damage detection, aiming to find the presence of damage. Similarly, the VGG-based network [27] detects cracks on concrete surfaces. Additionally, Crack-pot [28] employs a camera-based GPU board to identify road cracks and potholes, which enables smooth journeys for self-driving vehicles and robots. Similarly, Fan et al. [29] trained a simple CNN to recognize pavement conditions, demonstrating its ability to manage various pave- ment characteristics effectively. Furthermore, the deep neural networks outperform the edge-detection methods in identifying pavement fractures, as shown by [30].\nRecently, Karaaslan et al. [31] analyzed cracks and spalls in a semi-supervised deep learning-based method using attention guidance, where the detected boundary box gets verified by the human, and then the pixel-level segmentation is applied, hence significantly reducing the computational cost of the segmentation. Integrating stereo vision with deep learning, Guan et al. [32] performed segmentation-based analysis for cracks and potholes by creating datasets composed of 2D, 3D, and enhanced 3D images. Furthermore, for faster segmenta- tion, the authors used a modified U-net based on depth-wise"}, {"title": "C. Smartphone-Based Methods", "content": "Due to various sensors, high-resolution multiple cameras, significant storage memory, and effective processors, handheld devices such as smartphones have recently become standard for road inspection. Moreover, handheld devices are efficient and cost-effective for inspecting large road networks. For example, SmartPatrolling [34] collects the data employing the smartphone's built-in sensors with dynamic time warp- ing for road surface conditions, performing more efficiently than traditional algorithms. Similarly, Mertz et al. [35] detect road damage using an onboard smartphone installed on daily working vehicles, e.g., general passenger cars, buses, and garbage trucks, and connected to a laptop for processing them. Casas-Avellaneda and Lopez-Parra' [36] used smartphones to visualize potholes on a map. Maeda et al. [37] designed a real-time application on a smartphone for collecting and detecting roadway deficiencies."}, {"title": "D. Datasets for Road Damage Detection", "content": "Maeda et al. [37] composed RDD-2018, which is publicly available and is collected through a smartphone application. Several municipalities are using this application to monitor road conditions faster. Consequently, researchers worldwide have shown interest in the data, methods, and models. Fol- lowing [37], researchers have either added more images to the dataset or used the software to collect a novel dataset. For example, the authors of [38] expanded the dataset by including images from Italy and Mexico, increasing the number to above 18k. Similarly, [39] incorporated 7k images of road damage from Italy, utilizing the software from [37]. The model is trained on the new dataset, taking into account the identified road damage severity. The authors in [40] use an industrial high-resolution camera to collect a dataset of over 45k road images from Shanghai and use the YOLO model to detect and classify pavement damages, using an industrial high-resolution camera to compile a dataset exceeding 45k road photos and utilizing the YOLO to detect and classify pavement problems.\nOn the other hand, Google Street View pictures of pave- ment, which are easily and freely accessible, are used by [41], which include top and wide angles characterizing and cal- culating the density. The study demonstrates that the Faster R-CNN lags behind the YOLO-v2 model. Moreover, [42] employed limited Google API images for CNN-based de- tection of potholes. Despite the accessibility and cost-free nature of Google Street View photographs, annotating them remains demanding, laborious, and time-intensive. Recently, RDD [43] has been proposed for detecting and classifying road damage, which has many images. However, most photos only feature single damage, and the damages themselves are not particularly complex. On the other hand, the damages in our collected dataset are more complicated and typically occur"}, {"title": "E. Types of Road cracks", "content": "As a last step, we would like to introduce the types of damage in the road. The damage types can be categorized into Alligator Cracks, Block Cracks, Longitudinal Cracks, Pothole Cracks, and Transverse Cracks. These are the most prominent ones and are usually found on most roads across the globe.\n1) Potholes: Potholes are holes in the road surface caused by water seeping into the road and eroding the ground un- derneath. Moreover, the heavy traffic and worn-out surface layer exacerbate the damage by causing the asphalt to break away, forming a pothole. Initially small, these potholes can rapidly expand due to ongoing vehicle traffic that erodes the asphalt further and water from rain or floods that washes away additional material. Proper maintenance and repair of road cracks can help prolong the life of a road and improve safety for drivers. Repair methods can include sealing the cracks, patching the affected areas, and, in more severe cases, repaving the entire road surface.\n2) Longitudinal Cracks: These cracks run along the length of the road and can be caused by expansion and contraction of the ground, poor drainage, or the settling of the subgrade. They are often caused by the natural movement of the ground and can be found on both the shoulder and the centerline of the road. Longitudinal cracks can also be caused by shrinkage of the asphalt surface due to exposure to the sun and heat.\n3) Transverse Cracks: These cracks run across the road and are typically caused by temperature changes and heavy traffic. They occur when the road expands and contracts with changes in temperature, causing the asphalt surface to crack. These types of cracks are often found in the wheel path and are typically caused by reflective cracking in the underlying layers\n4) Alligator or Fatigue Cracks: These are a series of interconnected cracks that resemble the skin of an alligator. They are caused by a failure in the asphalt surface and heavy traffic loads. They occur when the asphalt surface can no longer support the weight of the traffic and begins to fatigue and deform. These cracks are also known as \"fatigue cracking\" and can be found on both the shoulder and the wheel path.\n5) Block Cracks: These are large rectangle cracks that break the surface into chunks or blocks. It forms when the asphalt surface is too thick and the top layer contracts at a different rate than the bottom, causing the surface to crack."}, {"title": "IV. METHODOLOGY", "content": "Due to its superior performance on the COCO dataset and its compatibility with edge computing devices, we chose the Real-Time Model Detection (RTMDet) lightweight object detection model as our baseline. This model is the latest addition to the one-stage real-time object detection family, and it has achieved outstanding performance in object detection and instance segmentation tasks. As illustrated in Figure 3(a), the RTMDet architecture comprises three main blocks: the backbone, neck, and head. Recent studies typically adopted CSPDarkNet [55] as a backbone architecture in the RTMDet; however, we have employed CSPNeXt, an architecture that combines the ResNeXt Network and the Cross Stage Partial Network (CSP), as our backbone network [56] as the archi- tecture utilizes large-kernel, depth-wise separable convolutions in the base modules. Our choice is based on the observation that the model quickly learns the global context by making the network deeper and wider.\nThe backbone model is available in two options. The first choice is the smaller architecture, denoted as P5, while the second version, P6, is the larger variant. We have opted for the former version, which produces five feature map scales, denoted as $C_1$, $C_2$, $C_3$, $C_4$, and $C_5$, after downsampling by factors of $2^k$, where $k \\in \\{1,2,\\dots,5\\}$. The Neck module per- forms feature fusion using the final three feature map scales of \u04213 (i.e., 8, 256, 80, 80), C4 (i.e., 8, 512, 40, 40), and C5 (i.e., 8, 1024, 20, 20). Moreover, the neck module further incorporates a multiscale feature pyramid network (CSPNeXtPAFPN) using the three feature maps from the backbone with both top-down and bottom-up feature propagation [57], [58] for enhancing the features before passing it into the head for detection and classification.\nIt should be noted that the CSPNeXtPAFPN architecture's top-down and bottom-up pathways, though effective, may only partially exploit the probable relations between features at different scales, potentially leading to a loss of fine-grained details. The neck part of RTMDet is responsible for fusing and refining multiscale features from the backbone. Hence, we propose and integrate Attention4D blocks. By exploiting this, the mentioned model can more effectively capture and utilize local and global contextual information across different scales. Eventually, the feature map of each scale is then employed by the detection head to anticipate object-bounding boxes and their categories. This architecture works well for general and rotated objects. It can also be extended for segmentation by adding kernel and mask feature generation heads [59].\nAttention4D Module: The core innovation in our model is the Attention4D block, depicted in Figure 3(b). This block processes input feature maps through a series of operations. A 1\u00d71 convolution is followed by batch normalization to adjust the channel dimension. The output is split into three branches: Value (V), Transposed Key KT, and Query (Q). The Key and Query branches undergo element-wise multiplication. The result combines positional encoding (PosE) and a \u201cTalking Head\u201d input. A softmax operation normalizes the attention weights. The softmax output is multiplied element-wise by the value branch and another \"Talking Head\" input. Finally, the result passes through another 1\u00d71 convolution and batch normalization. This Attention4D block allows the network to capture local and global contextual information, potentially improving the model's understanding of complex scenes. The Attention4D blocks are strategically integrated at crucial points"}, {"title": "V. EXPERIMENTS", "content": "Datasets. The road crack dataset videos were recorded using a GoPro camera mounted on the front of a car and aimed at the road surface. As the vehicle traversed various roads, it recorded multiple types of cracks under varying lighting condi- tions, comprehensively representing different road conditions. A civil engineer carefully reviewed and validated each road condition to accurately identify and confirm the presence of various types of cracks. We recorded 30 video segments in MP4 format, each with a resolution of 1920\u00d71440 pixels and a frame rate of 30fps. Most video segments lasted between 20 to 30 minutes. These videos were then converted into frames, with blurry images due to car speeds discarded to maintain quality. We have used the Computer Vision Annotations Tool to annotate images in Pascal-VOC and COCO formats. From the video footage, we annotated a total of 1,500 images. Evaluation Metrics. To evaluate the performance of our ob- ject detectors, we have used the COCO evaluation metrics, a standard metric for assessing both object detection and segmentation models. The COCO evaluation framework pro- vides a detailed analysis of model performance across various Intersection over Union (IoU) thresholds and categorizes ob- ject detection results based on different object sizes-small, medium, and large."}, {"title": "A. Settings", "content": "Training Details. During training, we used a batch size of four in our experiments. We set the weight decay at 0.9, suggesting a considerable regularization impact to counteract overfitting, although this number is more significant than usual. Compared to regular values, which typically range between 0.8 and 0.99, we set the momentum at 5e-4. We train the model for 300 epochs to ensure complete performance optimization."}, {"title": "B. Ablation Studies", "content": "The ablation study on Attention4D block placement strate- gies, as shown in Table VII, reveals that utilizing blocks in the top-down path yields superior performance (mAP=0.446, AP50=0.687, AP75=0.451) compared to bottom-up path (mAP=0.412) or single block placement (mAP=0.398). While implementing blocks in both paths marginally improves per- formance (mAP=0.455), it comes at the cost of reduced infer- ence speed (25.1 FPS vs 26.8 FPS) and increased parameter count (40.2M vs 38.5M). This suggests that the top-down path placement provides the optimal balance between detection accuracy and computational efficiency. Further analysis of the number of Attention4D blocks in Table VIII demonstrates a clear performance trend. While a single block shows modest results (mAP=0.425), implementing two blocks achieves sig- nificantly better performance (mAP=0.446) with a reasonable parameter increase of 1.3M. Although adding three or four blocks marginally improves accuracy (mAP=0.449 and 0.451 respectively), the computational overhead becomes substan- tial, reducing the FPS to 25.3 and 23.7 respectively, while increasing the parameter count to 39.8M and 41.1M. These"}, {"title": "VI. COMPARISONS", "content": "Precision and recall are essential metrics used to evaluate the performance of a model. Precision measures the accuracy of the detections, which is the proportion of predicted positive identifications that were actually correct. A high precision rate indicates that the model made few mistakes in its identifi- cations, making it reliable when it predicts that an object is present. On the other hand, recall assesses the model's ability to capture all actual positive detections within the dataset. It reflects the proportion of true positive detections made by the model relative to the total number of positives that actually exist in the data. High recall indicates that the model leaves few actual positives undetected, maximizing the chances that if an object is present, the model will recognize it. A balanced performance in both metrics is crucial for reliable road damage detection systems. We evaluate the per- formance of various deep learning models, i.e., YOLOv8 [74], YOLOv7 [68], YOLOV6 [75] PPYOLOE [69], YOLOX [65], and RTMDet [66], in detecting small, medium, and large road cracks using the metrics of Average Precision (AP) and Average Recall (AR) as shown in Table IV."}, {"title": "A. Comparisons on our proposed DRDD dataset", "content": "The AP and AR scores of -1.000 for small-sized damages (APs and ARs) across all models indicates the absence of small damages in the dataset, rather than poor detection performance. This observation confirms that the majority of road damages in our dataset belong to the large category. For medium-sized damages, YOLOv7 achieved the highest AP of 0.127, followed by RTMDET with 0.123. In the large damage category, where most of our dataset's instances are concentrated, our RDD4D method significantly outperformed others with an AP of 0.458, while RTMDET showed the second-best performance with 0.280.\nIn terms of recall performance, YOLOV6 demonstrated strong capability in detecting medium-sized damages with the highest AR of 0.460, followed by PPYOLOE with 0.388. For large damages, which constitute the majority of our dataset, our method achieved the best AR of 0.690, with RTMDET fol- lowing at 0.623. Overall, our proposed method demonstrates superior performance with the highest AP (0.446), AP50 (0.687), and AP75 (0.451) scores across all models, showing significant improvements over the second-best performer RT- MDET (AP=0.268, AP50=0.527, AP75=0.229). These results validate the effectiveness of our approach, particularly in detecting the predominant large-sized road damages.\nRegarding recall, all models struggled with small objects, scoring an AR of -1.000. This is due to the absence of small cracks in the dataset. PPYOLOE recorded the highest AR of 0.388 for medium-sized objects, indicating its effectiveness in recognizing the presence of medium-sized cracks more"}, {"title": "VII. CONCLUSION", "content": "In this paper, we addressed the challenging task of detect- ing multiple types of road damage types by introducing an enhanced architecture with an integrated Attention4D mecha- nism. We collected a novel dataset that captures diverse road damage types, with most of the images containing different damage types., serving as a valuable resource for future research in this field. We have proven that our approach outper- forms both our proposed dataset and the CrackTinyNet dataset in terms of overall performance. Our model performs well because the 4D attention module effectively processes both local and global contextual information. This work establishes a strong foundation for future developments in automated road damage detection systems, which are crucial for efficient infrastructure maintenance."}]}