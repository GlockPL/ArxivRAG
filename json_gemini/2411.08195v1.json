{"title": "AN EXPLAINABLE MACHINE LEARNING APPROACH FOR AGE\nAND GENDER ESTIMATION IN LIVING INDIVIDUALS USING\nDENTAL BIOMETRICS", "authors": ["Mohsin Ali", "Haider Raza", "John Q Gan", "Ariel Pokhojaev", "Matanel Katz", "Esra Kosan", "Dian Agustin Wahjuningrum", "Omnina Saleh", "Rachel Sarig", "Akhilanada Chaurasia"], "abstract": "Objectives: Age and gender estimation is crucial for various applications, including forensic investi-\ngations and anthropological studies. This research aims to develop a predictive system for age and\ngender estimation in living individuals, leveraging dental measurements such as Coronal Height (CH),\nCoronal Pulp Cavity Height (CPCH), and Tooth Coronal Index (TCI).\nMethods: Machine learning models were employed in our study, including Cat Boost Classifier\n(Catboost), Gradient Boosting Machine (GBM), Ada Boost Classifier (AdaBoost), Random Forest\n(RF), eXtreme Gradient Boosting (XGB), Light Gradient Boosting Machine (LGB), and Extra Trees\nClassifier (ETC), to analyze dental data from 862 living individuals (459 males and 403 females).\nSpecifically, periapical radiographs from six teeth per individual were utilized, including premolars\nand molars from both maxillary and mandibular. A novel ensemble learning technique was developed,\nwhich uses multiple models each tailored to distinct dental metrics, to estimate age and gender\naccurately. Furthermore, an explainable AI model has been created utilizing SHAP, enabling dental\nexperts to make judicious decisions based on comprehensible insight.\nResults: The RF and XGB models were particularly effective, yielding the highest F1 score for\nage and gender estimation. Notably, the XGB model showed a slightly better performance in age\nestimation, achieving an F1 score of 73.26%. A similar trend for the RF model was also observed in\ngender estimation, achieving a F1 score of 77.53%.\nConclusions: This study marks a significant advancement in dental forensic methods, showcasing\nthe potential of machine learning to automate age and gender estimation processes with improved\naccuracy.\nClinical Significance: Accurate age and gender predictions hold importance across diverse domains,\nincluding forensic investigations involving both living and deceased individuals. Moreover, beyond", "sections": [{"title": "1 Introduction", "content": "Accurate age and gender estimation using dental features are crucial across various fields, including forensic science\nand clinical dentistry [2]. Dental structures, known for their resistance to external factors, are a reliable source for age\nestimation [8]. Key dental measurements, such as Coronal Height (CH), Coronal Pulp Cavity Height (CPCH), and Tooth\nCoronal Index (TCI), are closely linked to ageing due to the reduction in dental pulp volume over time [25]. Traditional\nmethods of age estimation in forensic sciences using dentition are commonly applied to identify unknown corpses or\nhuman remains [26]. However, these traditional methods sometimes lack precision and reliability. Since much of the\nresearch is focused on human remains, these methods typically require the extraction of teeth. Consequently, they are\noften deemed time-consuming and ethically unsuitable, thereby facing reluctance to adopt. Some recent advancements\nsuggest the use of dental radiographs to measure dental pulp for age and gender determination in the living [18].\nA widely employed non-destructive approach for age and gender estimation, utilized by both dentists and forensic\nexperts, involves analyzing radiographs of the upper and lower jaw to assess the pulp area [24]. Although this method\ndoes not involve physical alteration of the teeth, it requires the expertise of experienced dental professionals for\nprecise predictions. This study explores a range of machine learning (ML) techniques, which offer a promising\napproach for age and gender determination in living individuals based on dental pulp measurements due to its\nability to handle complex patterns and large datasets. Several ML models, such as Cat Boost Classifier (Catboost)\n[19], Gradient Boosting Machine (GBM) [17], Ada Boost Classifier (AdaBoost) [14], Random Forest (RF) [5],\neXtreme Gradient Boosting (XGB) [6], Light Gradient Boosting Machine (LGB)[11], and Extra Trees Classifier\n(ETC) [22], were explored in this study, which provide diverse capability of capturing nuanced relationships between\nfeatures and target variables. Additionally, data balancing techniques were adopted to mitigate biases and enhance\naccuracy. Furthermore, the ML models enable continual refinement through iterative learning, potentially improving\naccuracy and reliability over traditional methods. This interdisciplinary approach harnesses computational power\nto advance dental diagnostics, offering a non-invasive and potentially more accurate means of age and gender estimation.\nMoreover, ensemble learning methods combined with non-trainable combiners were investigated in this study. This\napproach leverages multiple models' strengths, addressing individual model limitations to enhance overall predictive\nperformance. The primary goals of this study are two-fold: 1) to examine the effectiveness of CH, CPCH, and TCI in\nestimating age and gender; and 2) to evaluate the performance of ensemble ML models in improving the accuracy\nand reliability of age and gender estimation. By integrating diverse models, we aim to create a robust and versatile\nframework for age and gender estimation using dental biometrics. Furthermore, to address the issue of non-interpretable\nresults in ensemble models, eXplainable Artificial Intelligence (XAI) techniques, specifically SHAP (SHapley Additive\nexPlanations), were adopted in our study, which aims to enhance the interpretability of predictions from the proposed\nmodel, empowering dental experts to make more informed decisions by gaining insights into the underlying factors\ninfluencing the predictions.\nThe remainder of this paper is organized as follows: Section II presents related work, highlighting existing methods\nand their limitations. Section III details the proposed methods, including those for data collection, feature extraction,\nmachine learning and ensemble learning for age and gender estimation, and explainable AI (XAI). Section IV provides\nexperimental results and discussions, and finally, Section V concludes the paper, summarizing key findings and outlining\navenues for future research."}, {"title": "2 Related Work", "content": "The estimation of chronological age and gender using dental features has long been a focal point in research, particularly\nin forensic and anthropological studies. A significant contribution in this area was made by Drusini et al. [10], who\ninvestigated the correlation between pulp cavity size and individual age. Their method involved measuring the Coronal\nHeight (CH) and Coronal Pulp Cavity Height (CPCH) in molars and premolars of both living individuals and skeletal\nremains. The method of using the Tooth Coronal Index (TCI) for age estimation, as developed by Drusini et al. [9],\ninvolves calculating TCI from dental measurements to establish a correlation with the individuals' ages. This innovative\napproach has proven to be effective for age estimation, demonstrating its applicability to both living individuals and"}, {"title": "3 Methods", "content": "An overview of the adopted approach in this study is shown in Figure 1.\n3.1 Data Collection\nThis study adhered to the ethical guidelines of the Helsinki Declaration and received approval from the Uni-\nversity of Airlangga, Faculty of Dental Medicine Health Research (Ethical Clearance Certificate Number:\n860/HRECC.FODM/X1/2022). Informed consent was obtained from all participants. For this study, we selectively\nused 862 bitewing radiographs (459 males and 403 females) aged 11 to 70 years (average age 30, median age 27) from\nthe radiology clinic's digital archives. Inclusion criteria were strict: only bitewing radiographs displaying a complete\nset of maxillary (upper jaw) and mandibular (lower jaw) premolars and molars were selected. Excluded from the study\nwere radiographs showing incomplete teeth sets, distortions, missing teeth, or dental caries. The radiographs were\ncaptured using the Planmeca Intraoral Periapical Radiography machine, set at 60Kvp with a 10Amp tube current, and\nan exposure time of 0.5 seconds. The measurement of pulp length and area was conducted using Image J software [21],\nan open-source platform developed at the National Institute of Mental Health in Bethesda, Maryland, USA.\nFor gender estimation, participants were categorized into male and female groups, as shown in Figure 2. For age\nestimation, participants were divided into five age groups: Young (0-20 years), Early Adult (21-30 years), Mid Adult\n(31-40 years), Mature Adult (41-50 years), and Senior (51+ years), as shown in Figure 3. We allocated 80% of the\ndataset for training models, and the remaining 20% as a test set to evaluate the models' generalization performance for\nboth age and gender estimation.\n3.1.1 Dental Linear Measurements\nStandard adult size 2 (41x31 mm) bitewing radiograph images underwent processing with ImageJ software (version\n1.54f; https://imagej.net/) to convert them into 8-bit grayscale. This conversion reduced the color depth to 256 shades\nof gray, ranging from 0 (black) to 255 (white) for standardization. Using the film's known dimensions, the images'\nscale was accurately set within the software. To improve visibility without compromising detail, contrast and brightness\nadjustments were applied to allow for a slight pixel saturation of 0.35%. Subsequently, pixels with intensity values\nbelow 50 and above 255 were altered to black and white, respectively, which significantly enhanced the visibility of the\nenamel-dentine junction. Data collection focused on each molar (teeth 6-8), premolar (4-5), and canine (3) visible in\nthe radiographic images from both the upper and lower jaws of each subject. Only teeth free from cavities, excessive\nwear, diseases, or non-previously treated were included. Measurements of Coronal Height (CH) and Coronal Pulp\nChamber Height (CPCH) were obtained using ImageJ by marking four specific points on each tooth: the distal and\nmesial Cementoenamel Junction (CEJ) as points 1 and 2, the highest point of the pulp horn as point 3, and the tip of the\nmesio-buccal cusp as point 4 (Figure 6). A line connecting points 1 and 2 was drawn, and the linear distances from this\nCEJ line to points 3 and 4 were measured to calculate the CH and CPCH (Figure 6). The Tooth Coronal Index (TCI)\nwas then calculated as the ratio of CPCH to CH, multiplied by 100, using the formula:\n$TCI = \\frac{CPCH \\times 100}{CH}$\n3.2 Data Cleaning and Pre-processing\nIn the process of preparing data for analysis, data cleaning and pre-processing are crucial steps to ensure the integrity\nand quality of the results. Initially, we collected the raw dataset, where each row represents a single tooth from an\nindividual, detailing the tooth's position (maxilla or mandibular), tooth number, and measurements of CH, CPCH and\nTCI. For this study, we initially considered a range of teeth, including the Canine, First Pre-molar, Second Pre-molar,\nFirst Molar, Second Molar, and Third Molar teeth from both mandibular and maxillary sets in the bitewing radiographs\nprovided. However, not all individuals had all these teeth present in the radiographs. Specifically, the Canine, First\nPre-molar, and Third Molar teeth were frequently missing, which could introduce bias or inaccuracies in the age and\ngender estimation models."}, {"title": "3.3 Machine Learning Methods for Age and Gender Estimation", "content": "To estimate the age and gender of the individual using radiographic dental features as shown in Table 1, we used several\nmachine learning models including Catboost, GBM, AdaBoost, RF, XGB, LGB, and ETC. These models were selected"}, {"title": "3.4 Ensemble Learning", "content": "Ensemble learning [15] is a concept of training multiple models and combining their predictions to increase the\nperformance of the model. In this study, a novel approach was taken to enhance the robustness and performance of\nthe predictive models. Instead of aiming to improve the average results across the folds in K-fold cross-validation,\nwe focused on training distinct models for different teeth, specifically the 5th, 6th, and 7th teeth. Each tooth's unique\nmeasurements were utilized to train a separate model, recognizing that different teeth might provide varying levels of"}, {"title": "3.4.1 Non-Trainable Combiners", "content": "Beyond the majority voting that uses the hard output or labels. Non-trainable combiners use the soft output or\nprobabilistic predictions of different architectures. These combiners take advantage of the nuanced probabilities\nprovided by individual classifiers, rather than relying solely on their hard decisions. A Decision Profile Matrix (DPM)\nis a matrix representation of the probabilistic predictions made by each model in an ensemble for a given test instance.\nFor a classification problem with C classes and an ensemble of N models, the DPM for a test instance T is a N\u00d7C\nmatrix. Each element $d_{i,j}(T)$ in the matrix represents the probability assigned by the $i^{th}$ model to the $j^{th}$ class for the\ntest instance T. The DPM encapsulates the ensemble's collective knowledge and forms the basis for the operations of\nnon-trainable combiners. In this study, we employed several combiners to determine the best strategy for the given\nsample data:\n\u2022 Mean Combiner: Calculates the average confidence of the predictions for each class across all models.\n$\\delta_{Mean} = \\frac{1}{N} \\sum_{i=1}^{N} P_{i}$\n\u2022 Median Combiner: Uses the median to determine the central tendency of the predictions, providing robustness\nagainst outliers.\n$\\delta_{Median} = \\begin{cases}\nP_{(\\frac{N+1}{2})}, if N is odd \\\\\n\\frac{P_{(\\frac{N}{2})} + P_{(\\frac{N}{2}+1)}}{2}, if N is even\n\\end{cases}$"}, {"title": "3.5 Explainable AI (XAI)", "content": "The inherent lack of transparency in complex machine learning models is recognized as a significant limitation,\nparticularly in applications requiring clear understanding and trust in model outputs. To address this challenge, the field\nof XAI [13, 7, 1] offers tools and methods to interpret and explain the decision-making processes of these complex ML\nmodels. In this section, we employ XAI techniques, specifically focusing on SHAP [16], to analyze the ML models\nused in this study. As observed in our experiments, RF models demonstrated robust and stable performance in both\ngender and age estimation tasks. Here, we leverage SHAP to examine the influence of individual dental features on the\npredictions made by RF models. This exploration through SHAP aims to shed light on how different dental features\ncontribute to the models' decision-making processes in estimating age and gender. Employing SHAP in our analysis\nnot only enhances the interpretability of the ML models but also provides dental experts with deeper insights into the\nrationale behind each prediction. This added layer of transparency is crucial, particularly in critical fields like healthcare\nand forensic science, where understanding the 'why' behind model predictions is as important as the accuracy of the\npredictions themselves. The ability to interpret and validate model decisions is a key step towards wider acceptance and\nreliance on ML models in these sensitive domains."}, {"title": "4 Results and Discussion", "content": "This section provides a comprehensive evaluation of the performance of various machine learning models in the context\nof gender and age estimation. Our approach involved analyzing a range of models, i.e., GBM, Ada Boost, CatBoost,\nXGB, LGB, RF, and ETC, individually and then collectively through ensemble techniques. The efficacy of these models\nwas measured using two main metrics: F1 score and Area Under the Receiver Operating Characteristic curve (AUC),\nwhich offer insights into accuracy and predictive quality."}, {"title": "4.1 Performance Evaluation of Machine Learning Models", "content": "Initially to produce the baseline performance described in Table 2, we initially trained machine learning models using\nall available dental features: canine, first pre-molar, second pre-molar, first molar, second molar, and third molar\nteeth features. Notably, in gender classification, the Gradient Boosting Classifier achieved the highest F1 score of\n63.47, suggesting its effectiveness in discerning gender-based features. In contrast, for age classification, the CatBoost"}, {"title": "4.2 Explainable AI (XAI)", "content": "Figure 7 shows the top 10 important features for gender classification, indicating that feature \"CEJ to cusp tip (mm)\nSecond Premolar Maxilla\" significantly influences the model, with \"Tooth-coronal index Second Premolar Maxilla\"\nfollowing closely behind. These findings highlight a significant association between these features and the model's\nability to estimate gender. The analysis further indicates a dominant role of maxillary dental features over mandibular"}, {"title": "4.3 Discussion", "content": "The disparity in model performances between the two tasks, gender and age estimation, underscores the unique\nchallenges inherent in each. Gender estimation, being a binary classification task, often appears less complex, allowing\nmodels like Random Forest (RF) and eXtreme Gradient Boosting (XGB) to excel, There appears to be certain features\nor even dental growth patterns that might align with gender. Other studies simply suggest that sexual dimorphism\nmanifests in different size and shape of the clinical crown [4] with relatively higher accuracy. Conversely, age estimation,\ntypically treated as a multiclass problem, presents a more intricate challenge, possibly demanding richer feature sets or\nmore advanced modelling techniques, Also as described, one of the most relevant features influencing the performance\nof the models seems to be the crown height which aligns with clinical observations such as bruxism and overall\nloss of enamel/dentin structure throughout human lifetime to accurately capture the gradual changes associated with\nageing. The consistent improvement in model performance with ensemble methods [20] is a key finding of this\nstudy, emphasizing the utility of these methods in enhancing predictive accuracy. This improvement is particularly\nsignificant in the context of age estimation, where the intricacy of age-related changes requires robust and nuanced\nmodel predictions. The use of ensemble methods aligns with the growing trend in machine learning towards leveraging\ncollective model insights. These methods prove to be a powerful tool in complex tasks like age and gender estimation,\ncompensating for the limitations of individual models and providing a more reliable and robust predictive framework.\nMoreover, the enhanced performance of ensemble models with the introduction of non-trainable combiners, such as\nMean, Median, Maximum, and Minimum, indicates their potential to create a harmonious blend of predictions. This\napproach ensures that the final output is not overly dependent on any single model's biases or weaknesses. Non-trainable\ncombiners, by integrating the strengths of multiple models without additional training, effectively increase the robustness\nand reliability of the predictions, making them a valuable addition to the ensemble strategies."}, {"title": "5 Conclusion and Future Work", "content": "In this study, we explored the application of advanced machine learning techniques to the field of forensic science,\nparticularly focusing on age and gender estimation using dental features. Dental characteristics such as CH, CPCH and\nTCI, which are largely shielded from external environmental effects, were employed as key features for identifying\nliving individuals. This approach marks a significant shift from traditional methods, predominantly used in post-mortem\nidentification, to a more dynamic, living individual-focused analysis which does not require any tooth extraction. This\nstudy uses ML models to analyze these dental features representing a substantial advancement, and reducing the reliance\non extensive expert analysis and subjective interpretation. Moreover, using dental records which usually include X-rays\nof some sort, would prove easier and more cost-effective than invasive measures needing laboratory work. Our study\neffectively utilizes CH, CPCH, and TCI to employ machine learning models in dentistry for estimating an individual's"}]}