{"title": "Understanding complex crowd dynamics with generative neural simulators", "authors": ["Koen Minartz", "Fleur Hendriks", "Simon Martinus Koop", "Alessandro Corbetta", "Vlado Menkovski"], "abstract": "Understanding the dynamics of pedestrian crowds is an outstanding challenge crucial for designing efficient urban infrastructure and ensuring safe crowd management. To this end, both small-scale laboratory and large-scale real-world measurements have been used. However, these approaches respectively lack statistical resolution and parametric controllability, both essential to discovering physical relationships underlying the complex stochastic dynamics of crowds. Here, we establish an investigation paradigm that offers laboratory-like controllability, while ensuring the statistical resolution of large-scale real-world datasets. Using our data-driven neural crowd simulator (NeCS), which we train on large- scale data and validate against key statistical features of crowd dynamics, we show that we can perform effective surrogate crowd dynamics experiments with- out training on specific scenarios. We not only reproduce known experimental results on pairwise avoidance, but also uncover the vision-guided and topologic nature of N-body interactions. These findings show how virtual experiments based on neural simulation enable data-driven scientific discovery.", "sections": [{"title": "1 Introduction", "content": "Establishing a physical understanding of pedestrian crowd dynamics is not only a fundamental challenge in active matter physics [1], but also key in societal applications, ranging from infrastructural design to large-scale crowd management [2, 3]. From a physics perspective, crowds constitute an active matter system [4] with nonlinear N- body interactions [5] in which physical and psychological factors interplay at different spatiotemporal scales [6]. Unsurprisingly, crowd dynamics show strong fluctuations from statistical averages, even in terms of velocities or distances [7-9]. In aggre- gate, however, trajectories exhibit distinct and reproducible statistics [9, 10]. Models considering pedestrian dynamics at the individual level must therefore reflect this probabilistic nature. Treating pedestrians as inertial agents [11], this entails modeling the time-dependent probability p of the instantaneous acceleration of each individual:\n\\(x_i(t) \\sim p_\\theta(\\cdot| \\{x_j(\\tau), \\tau \\leq t, j = 1,..., N\\}) \\quad i = 1, ..., N,\\)\nwhere \\(x_i = x_i(t)\\) is the spatial position at time t of the i-th individual in a crowd of N, \\(\\theta\\) denotes the model parameters, and the conditioning variables emphasize dependencies on neighbors and past trajectories.\nOver the years, the social force paradigm [12] has become one of the most diffused yet criticized [13, 14] models for Eq. 1. It adopts a Langevin-like perspective where individual accelerations are governed by fluctuating forces:\n\\(x_i = f(x_i, \\dot{x_i}, \\theta_i) + \\sum_{i \\neq j} g(x_j \u2013 x_i, \\theta_{ij}) + \\epsilon,\\)\nwhere f represents individual propulsion in dependence of position, velocity, and pedestrian-specific parameters \\(\\theta_i\\), g models the interaction between two pedestrians, modulated by their relative position and interaction-specific parameters, \\(\\theta_{ij}\\), and a \\(\\delta\\)-correlated white noise \\(\\epsilon\\) mimics stochastic fluctuations. Eq. 2 shows remarkable statistical agreement with experimental data for prototypical scenarios like individ- ual fluctuations, pairwise avoidance or dynamics of small social groups [7, 9, 10], and qualitatively explains emergent phenomena like lane formation, intermittency, and jamming [12, 15]. Nevertheless, our limited understanding of crowd dynamics is reflected by oversimplifying assumptions like pairwise additivity of the interactions and linearly superimposed stochasticity, which are certainly false for more general and complex settings [1].\nTo improve our understanding, the community has relied on either laboratory experiments [16, 17], or on large-scale real-world measurements [7, 18-20]. Although laboratory experiments offer full control over experimental scenarios, they hardly pro- duce sufficient data to characterize stochastic behavior due to unavoidably limited repetitions [1]. In contrast, real-world measurements enable large-scale data collec- tion, but yield observations consisting of multiple intertwined scenarios that appear randomly [7] and where all physical processes at play are entangled. Additionally, despite their scale, real-world measurements still provide only a sparse coverage of the virtually infinite set of scenarios that are admissible in reality. As a result, isolating physical effects from real world data has required labor-intensive, tailor-made analyses even for prototypical cases [7, 9], and is likely infeasible for more complex, yet crucial, N-body interaction scenarios. Consequently, efficiently extracting physical interaction relationships from large-scale measurements remains an outstanding challenge, and a central bottleneck towards an improved understanding of Eq. 1."}, {"title": "2 Measurements and data", "content": "We consider high-fidelity crowd tracking measurements collected in April and May 2022 on a platform at Eindhoven Centraal train station (the Netherlands). These crowd dynamics, driven by a repeating train timetable, are recurrent and reproducible, and have been recorded via overhead sensors at 10 Hz temporal resolution [19, 20].\nWe specifically focus on the flow of pedestrians moving towards the platform exit, depicted on the left side of Fig. 1A. These individuals, typically alighting from trains, maintain a sustained velocity over large spatial scales in short timeframes. This allows us to analyze consistent dynamics while capturing the complex interaction physics at various densities, from diluted conditions up to 1 ped/m\u00b2.\nWe preprocess the tracking data in [20] by segmenting it into one-minute intervals. We keep only segments with: I) at least 10 and at most 100 distinct pedestrians; II) an average velocity at least 0.25m/s in the direction of the exit; and III) at least 70% of the individuals moving towards the exit. Pedestrians moving at least 15 m towards the exit are classified as part of the flow in that direction, and are the target of NeCS's simulations. The remaining pedestrians serve as fixed inputs to condition Eq. 1, enabling us to study their influence on pedestrians moving towards the exit.\nOverall, this procedure yields 55 hours of measurements, with between 0 and 90 people present at any given time in a segment. We employ 80% of the data for training, 10% for validation, and 10% for testing. Finally, we consider a 1:10 temporal subsam- pling to remove small-scale fluctuations such as swaying [41], while retaining all key features such as avoidance."}, {"title": "3 Model formulation and statistical validation", "content": "Model formulation\nTo approximate the distribution over the accelerations \\(\\ddot{x}(t)\\) of each pedestrian i (Eq. 1), we condition the model on the current state as well as on the history of past states:\n\\(p_\\theta(\\ddot{x}_i(t) | s(t), h(t)) = p_\\theta(\\ddot{x}_i(t) | s_i(t), h_i(t), \\{s_j(t), h_j(t) | j \\in N(i)\\}),\\)\n\\(s_i(t) = [x_i(t), \\dot{x}_i(t)] \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad (state),\\)\n\\(h_i(t) = \\{s_i(\\tau) | \\tau < t\\} \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\quad (history),\\)\n\\(N(i) = \\{j | j \\text{ and } i \\text{ are neighbors}\\} \\quad \\quad \\quad \\quad \\quad (neighborhood).\\)\nIn words, we consider \\(p_\\theta\\) depending on the state and history of pedestrian i as well as their neighbors. Eq. 3 is parameterized with a conditional Variational Autoencoder [39, 40], which autoregressively defines a probabilistic model over full trajectories. After training, we explore the trade-off between trajectory diversity and fidelity via a temperature parameter T, analogous to autoregressive large language models [42]. T scales the standard deviation of the model's decoder during sampling. We consider two variants with temperature values \\(T = T^* > 0\\) (\\(T^* = 0.1\\)) and \\(T = T^\\circ = 0\\), respectively. Further details on the architecture, generative modeling approach and simulation procedure are in Section 6.\nStatistical model validation\nWe evaluate model accuracy along three components of crowd dynamics: (1) ensem- ble statistics, assessing the model's capability to reproduce probability distributions over individual features; (2) interaction structure, capturing the social interactions in crowds; and (3) Lagrangian properties, characterizing pedestrian behavior over time. These components collectively ensure accuracy along fundamental physical aspects of crowds: probabilistic dynamics (1) with N-body interactions (2) that evolve the system over time (3)."}, {"title": "4 Understanding pedestrian interactions with virtual surrogate experiments", "content": "We leverage NeCS to simulate prototypical scenarios in which we can investigate the structure of N-body interactions in pedestrian crowds. These simulations serve as virtual surrogate experiments and provide the same controllability of laboratory con- ditions, while allowing for virtually infinite repeated trials. Such surrogate experiments are meaningful only if the investigated scenarios are in-distribution, that is, if similar scenarios are present in the training data. We therefore accompany each experiment with plots reporting frequencies with which such similar cases are observed in the training set.\nWe consider two classes of virtual experiments, sketched in Figure 3A. First, we consider a diluted regime in which interactions are limited to two pedestrians, and"}, {"title": "4.1 Diluted interactions", "content": "Similar to Corbetta et al. [7], we consider two pedestrians that walk in opposite direc- tion. To avoid bias of the geometry, the pedestrians are initialized in random position within the domain. Moreover, since NeCS is trained to simulate pedestrians moving leftwards, we model the pedestrian moving rightwards with point-symmetric percep- tion and dynamics. In Figure 3B, we report the average lateral distance when the two pedestrians are closest, \\(\\Delta y_s\\), as a function of their lateral distance when they first appeared, \\(\\Delta y_i\\), following [7].\nSimilar to the findings in [7], head-on collisions (\\(|\\Delta y_i| \\approx 0\\)) yield an average off- set of \\(\\Delta y_s \\approx 75 cm\\). Additionally, our results recover the correct, interaction-free, asymptotic behavior (\\(|\\Delta y_s| \\approx |\\Delta y_i|\\)) when \\(|\\Delta y_i|\\) is large. This marks a difference with respect to the saturating trend in [7] resulting from the finite size of their considered domain. Figure 3A-1 shows a histogram of lateral distances of pairs walking in oppo- site directions in the training data, filtered for those cases where there is only a single neighbor within a radius of r = 7.5 m. This demonstrates that pairwise avoidance is in-distribution, as a compatible range of values for \\(|\\Delta y|\\) are observed in the training data.\nAs we model accelerations (Eq. 1), we can further investigate the avoidance inter- action structure. Since the overall acceleration may include a desired velocity effect, analogous to f in social force (Eq. 2), we distill the mean interaction on a pedestrian i as follows:\n\\(g(i | N(i)) = E_{\\ddot{x}_i \\sim p_\\theta, \\ddot{x}* \\sim p_\\theta}[\\ddot{x}_i - \\ddot{x}^*],\\)\nwhere both \\(\\ddot{x}_i\\) and \\(\\ddot{x}^*\\) are distributed according to \\(p_\\theta\\) in Eq. 3, and for \\(\\ddot{x}^*\\) we query the model with the same scenario as \\(\\ddot{x}_i\\) but without any neighbors (N(i) = 0). Note that the same procedure for a classical social force model (Eq. 2) would discount the self-propulsion term f and thus measure the cumulative interaction.\nFigures 3C and 3D show the lateral attraction and repulsion of a pedestrian i relative to a neighbor j as a function of j's relative position (\\(\\Delta x\\), \\(\\Delta y\\)), respectively for i and j walking in parallel and in opposite direction. In the opposite case (Figure 3C), we observe a strong repulsive force which acts at long ranges. Notably, the force vanishes to 0 when \\(\\Delta y \\approx 0\\), due to neural networks modeling continuous functions and the avoidance force being an odd function, which prevents a nonzero force from emerging at \\(\\Delta y \\approx 0\\). A long-range lateral force with similar structure has also been proposed in [7]. At 20\u00b0, the angle inducing a cone-shaped field-of-view proposed in [7] is remarkably similar to an angle that aligns well with the contours of our results (26.6\u00b0), although at shorter ranges, the trumpet-shaped contours deviate from any cone, aligning with a personal space of nonzero width.\nWhen the neighbor j walks in the same direction (Fig. 3D), the interaction force includes a short-range repulsion and a long-range attraction. Overall, the interaction"}, {"title": "4.2 N-body interactions", "content": "We focus on the simplest N-body interaction case: a pedestrian facing a crowd of static individuals in a random configuration. We consider three randomized crowd configu- rations, sketched in the right panel of Fig. 3A: (1) crowds in which the pedestrians are located at random sites of a lattice, with a spacing of 0.5 m and a width of 2 m; (2) crowds in which the pedestrians' locations are sampled from a Gaussian distri- bution; and (3) crowds of a fixed size of 18 individuals, organized in a lattice with a total width of 3 m, and an additional randomized spacing between between the center columns of the lattice.\nExperiments are again repeated across many random positions in the domain, and any acceleration resulting from self-propulsion is discounted as in Eq. 4. The histogram in Figure 3A-3 shows the frequency with which a pedestrian has a certain amount of neighbors within a 5 m radius in the training data, counting only those neighbors that are in front of the pedestrian. The histogram demonstrates coverage over the range of crowd sizes considered in these experiments in the training data distribution.\nFigures 1E and 3E report the mean acceleration as a function of the crowd size. In all cases, the acceleration saturates as the opposing crowds overcomes a critical size of N* \u2248 12 pedestrians. Although a classical social force model scales linearly in the crowd size due to the summation of pairwise interactions (Fig. 1E), we observe that a variant which takes only the top-k (k = 12) strongest forces into account recovers the saturation accurately, regardless of the randomization strategy, as shown in Fig. 3E. Figure 3F considers interactions between a pedestrian and crowds with varying spacing between the center columns. Here, both classical and top-k social force models fails to recover the force measured in our experiments. However, Fig. 3C revealed an anisotropic interaction structure resulting from an avoidance force only within a limited field-of-view of approximately 2 \u00d7 26.6\u00b0. After equipping the top-k social force model with such a field-of-view constraint, the force qualitatively aligns with the measured interactions, dropping rapidly as the path before the pedestrian clears up with increasing spacing in the center of the crowd.\nAs a whole, our investigation reveals that the crowd dynamics in the station are compatible with a force that is primarily driven by long-range interactions within a constrained field-of-view. Moreover, these interactions scale in a top-k-like fashion and start to saturate around k \u2248 12 neighbors."}, {"title": "5 Discussion", "content": "Improving our understanding of crowd dynamics has long relied on two paradigms: laboratory studies and real-world measurement campaigns. Although laboratory experiments offer full parametric control, their measurements are limited in statisti- cal resolution. In contrast, real-world measurements allow for virtually unlimited data acquisition, but the lack of parametric control leads to an entanglement of interplaying factors, hindering the isolation of individual effects. Moreover, despite their large scale, the observations provide only sparse coverage of the large space of all possible situa- tions. Consequently, analyzing real-world data has typically required labor-intensive, tailored procedures to aggregate measurements and to discount external confounding effects.\nHere, we have proposed an approach that combines the strengths of both the lab- oratory and real-world paradigms. Its backbone is a neural simulator, NeCS, trained on a large real-world dataset. NeCS represents crowds as dynamic graphs and lever- ages state of the art developments in generative AI and geometric deep learning to model individual pedestrian movement. Our rigorous validation against key statistical features of crowds confirmed NeCS's ability to perform accurate simulations of crowd dynamics.\nWe used NeCS to investigate interactions in crowds through virtual surrogate experiments, which provide the controllability of lab experiments while maintaining scalability. We first validated this novel approach by examining the prototypical case of pairs of pedestrians in mutual avoidance. While not trained specifically on this scenario, we found that NeCS's simulations are in strong agreement with previously reported experimental findings based on thousands of real-world measurements, recov- ering both short-range and asymptotic avoidance trends. Additionally, we found that interactions are strongest within a narrow field-of-view, in line with a bottom-up model for pairwise avoidance.\nWe then extended our investigation to more complex and long sought for N-body interactions. Our results demonstrate that the interaction strength saturates as the crowd size grows and exceeds N* \u2248 12 neighbors, and that a vision-constrained top- k social force model leads to interactions that are in remarkable agreement with this result. Overall, our findings emphasize the visual nature of pedestrian interactions and are compatible with a topological interaction structure, as opposed to a distance-based structure. Prior work has shown that such topological interactions are crucial in the dynamics of flocks of birds [47]. In this light, our results provide further evidence for topological interaction in dynamical systems of active agents.\nCrowds are an excellent example of real-world dynamics with entangled, hetero- geneous physical effects and measurements that are sparse in the set of all possible scenarios. Collective traffic and animal behavior are other systems of interacting agents that exhibit similar characteristics, and more broadly opinion dynamics, financial mar- kets, and smart energy grids all exhibit stochastic dynamics with complex N-body interactions. This work not only demonstrates how neural simulators can be used to uncover the physics behind crowd dynamics, but also establishes their potential as a technology for data-driven scientific discovery in a variety of societally relevant domains."}, {"title": "6 Methods", "content": "6.1 Generative model\nTo model Eq. 1, we start from the traditional social force model, in which the dis- tribution over accelerations of each pedestrian i is conditioned on the current positions and velocities of the all pedestrians:\n\\(p_\\theta(\\ddot{x}_i(t) | s(t)) = p_\\theta(\\ddot{x}_i(t) | x_i(t), \\dot{x}_i(t), \\{x_j(t), \\dot{x}_j(t) | j \\neq i\\}).\\)\nTo derive an informative representation of the current state s(t), we first process it with an embedding network fe, such that \\(e = f_e (s(t))\\). Then, we choose to model Eq. 5 with a conditional VAE, following state-of-the-art methods for probabilistic trajectory modeling like trajectron++ [32] and EPNS [48]:\n\\(p_\\theta(\\ddot{x}_i(t) | e(t)) = \\int p_\\theta(\\ddot{x}_i(t) | e(t), z) p_\\theta(z | e(t)) dz.\\)\nHere, both the decoder and the conditional prior are multivariate Gaussian distribu- tions parameterized by the neural network architecture. Although the formulation of Eq. 6 allows for the modeling of expressive distributions, it is incapable of expressing non-Markovian dynamics. Consequently, to extend Equation 6 to account for non- Markovian effects, the VAE's decoder is also conditioned on a representation of all histories \\(h(t) = \\{h(t)\\} i=1 ^N\\) via a recurrent unit, following state-of-the-art approaches like [32]. This yields the following generative model:\n\\(p_\\theta(\\ddot{x}(t) | s(t), h(t)) = \\int p_\\theta(\\ddot{x}(t) | e(t), h(t), z) p_\\theta(z | e(t)) dz.\\)\nTo sample from the distribution specified in Eq. 7, in principle we should use ances- tral sampling and first draw a realization of the latent variables z, and then draw a"}, {"title": "6.2 Model architecture and simulation procedure", "content": "Figure 5 shows a schematic overview of the key architectural components. A mes- sage passing GNN serves as backbone architecture. Generally, the Ith message passing layer is defined as follows [37]:\n\\(h_i^{l+1} = \\psi^l(h_i^l, \\bigcup_{j \\in N(i)} \\varphi^l(h_j^l)),\\)\nwhere h\u00b2 is the representation of node i at layer 1, N(i) is the set of neighbors of i, and \\(\\psi^l, \\varphi^l\\) are multi-layer perceptrons, and \\(\\bigcup\\) is a permutation-invariant aggregation function.\nBased on the message passing layers defined in Eq. 8, we need to decide how to design \\(\\psi^l, \\varphi^l, \\bigcup\\), and N(i). For simplicity, and similar to existing work [49], we"}, {"title": "6.3 Training procedure", "content": "To train the model, we make use of the Evidence Lower Bound (ELBO) of the con- ditional Variational Autoencoder as optimization objective for stochastic gradient descent. Given the model in Eq. 7 and the mapping from accelerations to velocities and positions as laid out in Eq. 9 and 10, the ELBO is formulated as follows:\n\\(ELBO(s(t + \\Delta t)) = E_{z \\sim q_{\\phi}(z | s(t), s(t+\\Delta t))} [log (p_\\theta(s(t + \\Delta t) | s(t), h(t), z))]\\newline \\quad \\quad \\quad \\quad \\text{reconstruction loss}\n- KL [q_{\\phi}(z | s(t), s(t + \\Delta t)) || p_\\theta(z|s(t))],\\newline \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\text{KL regularization of latent space}\\)\nwhere \\(q_\\phi\\) is the encoder distribution used during training to approximate the true but intractable posterior \\(p_\\theta(z | s(t),s(t + \\Delta t))\\), also parameterized by a GNN, and \\(p_\\theta(s(t + \\Delta t) | s(t), h(t), z)\\) is constructed as explained in Eq. 9 and 10. However, it is well known that autoregressive latent variable models suffer from latent variable collapse issues during training, as noted in for example [36, 48, 51, 52]. To mitigate this problem, we modify the ELBO using both the free bits trick [51] and KL annealing [52] as follows:\n\\(ELBO(s(t + \\Delta t)) = E_{z \\sim q_{\\phi}(z | s(t), s(t+\\Delta t))} [log (p_\\theta(s(t + \\Delta t) | s(t), h(t), z))]\\newline - \\beta \\cdot \\sum_{k=1}^{|Z|} max \\{\\Lambda, KL [q_{\\phi}(z_k | s(t), s(t + \\Delta t)) || p_\\theta(z_k|s(t))\\}\\},\\)\nwhere \\(\\beta\\) is the KL annealing parameter and \\(\\Lambda\\) is the free bits parameter. However, despite applying these strategies, we could not fully prevent posterior collapse from"}, {"title": "7 Data and code availability", "content": "All pedestrian tracking measurements used for the training, validation, and testing of the model are published with [19]. We are working towards publishing all code for data preprocessing, model training, model validation, and running the experiments"}, {"title": "Appendix A Supplemental material", "content": "A.1 Experimental details\nIn this section, we explain details behind the quantities of the statistical evaluation and behind the virtual surrogate experiments setup.\nA.1.1 Statistical validation.\nFor all results related to the statistical model validation, we generate a 60 second sim- ulation starting from the initial conditions in the test set. For pedestrians that enter the system at some point during the observed 60 seconds, we introduce them in the simulation loop at the same moment with the appropriate initial conditions. For pedes- trians that leave the system during the 60 second interval, we remove the pedestrian from the simulation loop at the same moment as in the observations. All quantities are then calculated once for the observed test data, and once for the simulated data, and only for those pedestrians that are part of the flow of pedestrians towards the exit, as per the definition in Section 2.\nVelocity PDFs - Fig. 1C. We calculate the pedestrian velocities over time using finite differencing on the simulated trajectory positions. We then plot the observed and simulated empirical probability distribution functions over the velocities, aggregated over all simulation runs, all snapshots in each run, and all pedestrians in each snapshot.\nFundamental diagram - Fig. 1D. As the fundamental diagram shows the relation- ship between velocities and densities, we need to have both the velocity and density for each pedestrian in all snapshots. The velocity is determined in the same way as in Fig. 1C see the above paragraph. To calculate the density, we base ourselves on the Voronoi method of [53], but with the added restriction that each pedestrian's cell is cut off to be within the valid domain, i.e. not inside the convenience store and not outside the platform. Subsequently, calculating the reciprocal of the area of a Voronoi cell gives us the local density of the corresponding pedestrian. We then bin the den- sity values into equi-width bins of width 0.1, and calculate the mean and standard deviation of the corresponding velocities. Note that for the density calculation, pedes- trians not part of the flow towards the exit are taken into account to calculate the local densities, but only values of pedestrians in the flow are used for the plot.\nVelocity mean and covariance field \u2013 Fig. 2A. We divide the observations into a grid of 6 \u00d7 20 cells, corresponding to the number of vertical equi-width intervals by the number of horizontal equi-width intervals. Then, we only consider those cells which have at least 200 observations in total over all trajectories. Then, we calculate the mean and covariance of the velocity vector observations for each cell. We then visualzie the mean velocity vector field as a streamplot, while the covariance matrices are plotted at each cell's location as a confidence ellipse.\nPosition PDFs \u2013 Fig. 2B. The probability distribution functions over vertical posi- tions are generated by filtering all observations on their horizontal position, grouping them in 20 equi-width bins of width 4m, and plotting the probability distribution function over the vertical coordinate for the three bins as indicated in the plot."}, {"title": "A.1.2 Physical interpretation of the learned dynamics", "content": "Interaction force scaling \u2013 Fig. 1E. We sample the crowd size uniformly at random between 1 and 25 people, and place the crowd at random locations in a regular lattice spaced 0.5 m apart. The width and depth of the lattice is 2.5 meters, corresponding to a lattice with 5 \u00d7 5 locations. The distance of the pedestrian to the crowd is sampled uniformly at random between 2 m and 2.5 m, and the pedestrian is positioned exactly facing the center of the lattice. The result is a sampled crowd configuration of size N, as well as the relative positioning and velocity of a pedestrian walking towards the middle of the possible locations of the individuals in the crowd. We now place this configuration at a random location to the right of the convenience store and discard those samples where more than 5% of the individuals are sampled inside the store. We then calculate the net acceleration the pedestrian experiences from the crowd according to the model as in Eq. 4.\nThis procedure is repeated for 10 different values of the velocity with which the pedestrian walks towards the crowd, sampled between 0.7 m/s and 1.15 m/s. For each velocity value, we repeat the experiment for 300 locations. Finally, for each combina- tion of velocity and location, we sample 10 different crowd configurations. The results are then grouped by crowd size to calculate the mean interaction strength."}, {"title": "", "content": "For the linear and top-k social force, we use the exact same procedure as described above, but now the accelerations are predicted by a social forcing model. The linear social force model is a simple isotropic social force model with pairwise interaction g:\n\\(\n\\begin{aligned}\nr_{ij} &= x_i - x_j, \\\\\nU(||r_{ij} ||) &= U^\\circ e^{-||r_{ij}||/R},\\\\\ng(r_{ij}) &= -U'(||\\tilde{r}_{ij} ||).\n\\end{aligned}\n\\)\nThe top-k variant sums only the top-k strongest pairwise interactions to get the total social force on the pedestrian, and discards the others. The parameters of both the linear and top-k model are \\(U^\\circ = 0.3 m^2/s^2\\) and \\(R = 2m\\), which were chosen such that the linear social force model's slope approximately aligns with NeCS in the small-N regime.\nCounterflow transfer function \u2013 Fig. 3B. The pairwise avoidance experiment is set up to be comparable to the procedure behind the empirical results of Corbetta et al. [7]. First, we initialize the the pedestrian and the neighbor with a longitudinal distance of 8m, and sample the initial lateral displacement \\(\\Delta y_i\\) of the neighbor uniformly at random between -2m and 2m. The velocity of both the pedestrian and the neighbor is initialized at v = 0.5m/s, with opposing horizontal directions. We then start a simulation using NeCS for 11 seconds. Note that, since the model is trained to model the flow of pedestrians towards the exit, we assume point-symmetric accelerations for the neighbor moving in the opposite direction. After the simulation, we find the time tmin when the horizontal distance between the two pedestrians is minimal, and measure the lateral distance \\(\\Delta y_s\\) at the time of passing tmin. This procedure is repeated for 100 different locations on the map, for 300 repetitions per location.\nPairwise avoidance force field \u2013 Fig. 3C. To measure the lateral forcing corre- sponding to avoidance behavior, we initialize a pedestrian with a velocity of v = 1 m/s walking leftwards at random locations on the map. We then randomly sample a neigh- bor with relative displacement \\(\\Delta x \\in [-3m,0m]\\), \\(\\Delta y \\in [-3m, 3m]\\), walking with the same velocity in opposite direction. This procedure is repeated for 300 locations evenly spaced on the map, with 100 repetitions per location.\nWe calculate the acceleration as in Eq. 4 on the pedestrian, multiply it by two to reflect the point-symmetry assumption, and take the lateral component, denoted as \\(f_y\\), to reflect avoidance forcing. We then multiply \\(f_y\\) with the sign of \\(\\Delta y\\) such that the sign of the resulting quantity is positive if the forcing is repulsive, and negative if it is attractive.\nParallel walking force field \u2013 Fig. 3D. In the case of the neighbor walking in par- allel direction, we initialize a pedestrian and neighbor with a velocity of v = 1.34 m/s walking leftwards at random locations. The relative displacement of the neighbor \\(((\\Delta x), (\\Delta y))\\) is randomly sampled from \\([-3m, 3m]^2\\). This procedure is repeated for 300 locations evenly spaced on the map, with 50 repetitions per location.\nAfter calculating the average acceleration as in Eq. 4 for a neighbor located at a specific (\\(\\Delta x, \\Delta y\\)), we subtract the acceleration of a neighbor located at \\((-\\Delta x, -\\Delta y)\\) to reflect the relative acceleration under the assumption of point-symmetric dynamics."}, {"title": "", "content": "We again take the lateral component of the interaction \\(f_y\\) and multiply it with the sign of \\(\\Delta y\\) such that positive quantities reflect repulsion and negative quantities reflect attraction.\n\nN-body scaling with different crowd configurations \u2013 Fig. 3E. The lattice- based crowd configurations are taken as in Figure 1E. For the Gaussian crowd configuration", "2.0": "and all units are in meters. The parameters of the comparable top-k social force model are \\(U^o = 0.21m^2/s^2\\) (compared to \\(0.3m^2/s^2\\) in the lattice case) and R = 2.0 m (identical to the lattice case).\nAnisotropic N-body interactions \u2013 Fig. 3F. We start from the lattice-based crowd configuration as explained in figure 1E", "changes": 1, "54": "."}]}