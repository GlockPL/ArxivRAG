{"title": "ECTIL: Label-efficient Computational Tumour Infiltrating Lymphocyte (TIL) assessment in breast cancer: Multicentre validation in 2,340 patients with breast cancer", "authors": ["Yoni Schirris", "Rosie Voorthuis", "Mark Opdam", "Marte Liefaard", "Gabe S Sonke", "Gwen Dackus", "Vincent de jong", "Yuwei Wang", "Annelot Van Rossum", "Tessa G Steenbruggen", "Lars C Steggink", "Liesbeth G.E. de Vries", "Marc van de Vijver", "Roberto Salgado", "Efstratios Gavves", "Paul J van Diest", "Sabine C Linn", "Jonas Teuwen", "Renee Menezes", "Marleen Kok", "Hugo Horlings"], "abstract": "The level of tumour-infiltrating lymphocytes (TILs) is a prognostic factor for patients with breast cancer and reflects their immune response, particularly in triple-negative breast cancer (TNBC). Computational TIL assessment (CTA) has the potential to assist pathologists in this labour-intensive task, since it can be quick and reproducible. However, current CTA models still rely heavily on detailed annotations, and use complex deep learning pipelines which pose challenges for model iterations and clinical deployment. Here, we propose and validate a fundamentally simpler deep learning based CTA that is trained in only ten minutes on hundredfold fewer pathologist annotations.\nWe collected whole slide images (WSIs) with TILs scores and clinical data of n=2,340 patients with breast cancer, including n=902 TNBC, from six cohorts including three randomised clinical trials. Morphological features were extracted from whole slide images (WSIs) using a pathology foundation model. Our label-efficient Computational stromal TIL assessment model (ECTIL) directly regresses the WSI TILs score from these features.\nECTIL trained on only a few hundred samples (ECTIL-TCGA) showed concordance with the pathologist over five heterogeneous external cohorts (r=0.54-0-74, AUROC=0-80-0-94). Training on TNBC slides only from four cohorts (ECTIL-TNBC) or all slides of five cohorts (ECTIL-combined) improved results, with ECTIL-combined achieving the highest concordance on an external test set (r=0.69, AUROC=0\u00b785). Multivariable Cox regression analyses indicated that every 10% increase of ECTIL-combined TILs scores was associated with improved overall survival (OS) independent of clinicopathological variables (hazard ratio, 0-86 [0-78-0-94], p<0.01), similar to the pathologist score (hazard ratio 0-87 [0-82-0-92, p<0.001).\nIn conclusion, our study demonstrates that our proposed label-efficient ECTIL scores TILs on H&E FFPE WSI in a single step shows high concordance with an expert pathologist. Without using deep learning based segmentation and detection pipelines, ECTIL reached similar hazard ratios in an OS analysis independent of clinicopathological variables. In the future, such a CTA may be used to pre-screen patients for, e.g., prospective de-escalation trials or immunotherapy clinical trial inclusion or can be used as a tool to assist pathologists and clinicians in the diagnostic work-up of patients with breast cancer. Furthermore, our model is available online under an open source licence, allowing translational researchers to validate and use ECTIL in future studies in breast or other cancers.", "sections": [{"title": "Introduction", "content": "Breast cancer is the second-leading cause of cancer-related mortality in women worldwide.\u00b9 Research on tumour immune interactions has identified tumour infiltrating lymphocytes (TILs) as a key prognostic and predictive biomarker across all breast cancer subtypes.\u00b2 In triple-negative breast cancer (TNBC), TIL levels correlate with pathological complete response, disease-free-, and overall survival (OS).2\u20134 Moreover, high TIL levels (>50% in patients >40 years of age and >=75% in patients <40 years of age) at baseline may indicate an excellent OS in stage 1 TNBC without (neo) adjuvant chemotherapy.5,6\nTILs are determined through visual assessment of pathologists by dividing the ratio of TILs by the total stromal tumour area on hematoxylin- and eosin-stained (H&E), formalin-fixed paraffin-embedded (FFPE) whole-slide images (WSIs) following the guideline of the International Immuno-Oncology Biomarker Working Group on Breast Cancer (TILs-WG).\u2077 While the scoring process and additional training have enhanced reproducibility among pathologists, inter- and intra-observer variability persists as a challenge, partly due to intra-tumour heterogeneity, as shown by Kos et al. with intraclass correlation coefficients ranging from 0-77-0-94 over three study groups.8\nRecent advancements in Artificial Intelligence (AI) and deep learning (DL), coupled with digitalisation to WSIs, have driven the development of Computational TILs assessment (CTA) methods. Furthermore, the TIL-WG has introduced computational guidelines to address the full complexity of the scoring process, aiding the development of useful CTA that may be adopted for clinical use.\u2079 Moreover, Al-assisted TILs assessment could potentially offer some solutions to the challenges faced by pathologists, including diminishing the burden on pathologists and pathology departments.\nCurrent models typically offer explicit pixel-level segmentations and cell detection and classifications.10\u201313 While these models demonstrate high concordance with the pathologists' TILs score and are associated with improved survival, independently of other known prognostic factors, they still face numerous pitfalls and challenges as described by Thagaard et al.\u00b9\u2074 Existing CTAs generally encounter difficulties due to various technical slide issues, and adhering to the pathologist scoring guidelines remains challenging. Moreover, they demand significant amounts of labelled data for training, which is costly and time-consuming. As these models become more complex to provide pixel-level information, continuous validation of all submodules in clinical practice may become increasingly difficult. Despite providing pixel-level segmentation and cell locations while explicitly implementing scoring guidelines, these models still encounter discordant cases due to, e.g., inclusion of incorrect tissue areas or cells.\nIn this study, we present an Al-based CTA that requires two orders of magnitude (hundredfold) fewer annotations than existing methods. By utilising only a few hundred WSI-level TILs scores as training data, we develop a model that regresses the TILs score in a single step from the WSI without post-processing, and we validate this model in the largest CTA validation study to date. We extend an existing DL-based WSI-level TILs regression method with an improved foundational model, gated attention mechanism, and additional feature learning.\u00b9\u2075 ECTIL (Efficient Computational stromal TIL assessment, pronounced \"Easy-TIL\") is a straightforward, easy-to-train tool for accurately identifying and quantifying TILs on H&E-stained WSIs of either biopsies or full resections of patients with breast cancer across molecular and morphological subtypes. The model directly regresses the TILs score from the WSI without explicit implementation of the TILs-WG scoring guideline. Even when ECTIL is trained on only a few hundred samples from The Cancer Genome Atlas Breast Cancer cohort (TCGA), which finishes training in only 10 minutes on a commodity graphics processing unit, ECTIL demonstrates concordance with pathologists' TILs scores over five external cohorts, indicating strong generalisation capabilities. Additionally, the ECTIL score provides prognostic value independent of clinicopathological variables on a single external cohort. ECTIL significantly reduces the label requirements by more than hundredfold compared to models trained on, e.g., the TIGER grand challenge, which utilise 30,000 lymphocyte and plasma cell annotations and 300 densely annotated regions with pixel-level tissue information. ECTIL has the potential to streamline and automate the TILs scoring process in breast cancer, facilitate the use of TILs scores as a biomarker in translational research and ultimately enhance its integration into clinical practice. Furthermore, ECTIL will be integrated in a prospective de-escalation phase III clinical trial in patients with low stage TNBC."}, {"title": "Methods", "content": "Study design and cohorts\nIndividual clinical and histopathological data including WSI from primary tumour material with an available pathologist TILs score was collected from six cohorts of patients with early breast cancer. Our ethical considerations are stated in supplementary section S1. Two cohorts consist of publicly available data. The Cancer Genome Atlas (TCGA) is a large cancer genomics dataset that has molecularly characterised primary cancer samples of different cancer types, including breast cancer (n=1,134). The clinical variables were exported from the Genomic Data Commons repository. The second open source cohort consists of data acquired through the Breast Cancer Somatic Genetics Study (BASIS, n=560) as published by Zainal et al.16 Three cohorts consist of patients treated in randomised clinical trials (N4+ n=855, MATADOR n=664, TRAIN II n=438). As WSI were only included when a TILs score by an expert pathologist was already available, some patients were not included in this current study. The inclusion flow diagram is depicted in supplementary figure S1. A detailed description of each trial design is stated in supplementary section S2.\nThe PARADIGM cohort, which was used as external test set only, consists of clinical data and primary tumour material collected retrospectively from 481 young (<40 years), any T-stage, node-negative (NO), metastasis free (MO), systemic therapy naive patients with TNBC treated between 1989 and 2000 in The Netherlands collected as part of the PARADIGM initiative.17\nClinicopathological characteristics\nClinicopathological data was received directly from the principal investigator of the study. Tumour grade (according to the Bloom-Richardson classification)\u00b9\u2078, presence of lymphovascular invasion, breast cancer histology and subtype (hormone and HER2 receptor status) were assessed locally according to national guidelines,\u00b9\u2079 or centrally, according to the study protocol.\nTILS\nTILs were scored on H&E FFPE WSIs according to previously published recommendations by the TILs-WG.7,20 All TILs scores were collected retrospectively. If an independent TILs score was available from two or more pathologists for one slide, the mean of the scores was used for training, validation, and analysis. There are cases where two WSIs and only one TILs score was available for a patient; in TCGA, both slides were included with the same label while for all other cohorts the WSI with the highest quality was used. TILs were scored on primary tumours that were removed during surgery prior to any neoadjuvant systemic therapy, except for the TRAIN II cohort where TILs were scored on the diagnostic biopsy.\nPatient and WSI selection workflow\nWSI were collected from the studies in which a TILs score by the pathologist was already available, and there was compatible clinical data which in some cohorts reduced the number of patients that could be included in this current study (supplementary figure S1). No further patient or WSI selection was made. WSI were scanned by different scanners (Aperio, Hamamatsu C9600-12 or 3DHistech P1000). For the TCGA cohort 14 patients had two representative WSI which were both included in the ECTIL models. The WSI selection workflow is depicted in the supplementary material (figure S1). In short, we collected 5799 WSI over six cohorts. Pathologist's TILs scores were provided for 2480 patients. Sufficient clinical variables were available for 2340 patients with 2354 slides to perform concordance analyses. For the survival analyses in PARADIGM, six patients had insufficient survival data. Hence, 390 patients were included in the concordance analysis, while 384 patients were used in the survival analysis.\nDeep Learning Model: ECTIL\nAll steps of ECTIL are visualised in figure 1, and described in detail below."}, {"title": "Tissue selection", "content": "Background is discarded using the Foreground Extraction from Structure Information (FESI) method as presented by Bug et al. (2015), as implemented in the Deep Learning Utilities for Pathology (DLUP, v0.3.22) library developed in-house in the Netherlands Cancer Institute.21,22 We remove any tile with 0 foreground pixels. Qualitative results of samples from each dataset are shown in figure S5-S7."}, {"title": "Feature extraction", "content": "We use RetCCL, a convolutional neural network that is pre-trained using self-supervised learning on pathology slides by Wang et al. to extract a 2048-dimensional feature vector from 512x512px patches at 0.5 microns per pixel with no overlap after normalisation using imagenet statistics.\u00b2\u00b3 RetCCL was chosen due to its superior performance shown by Niehaus et al.\u00b2\u2074"}, {"title": "Model", "content": "We use a gated attention-based multiple instance learning (ABMIL) model to regress the TILs score from the extracted features of WSI patches directly based on previous work.15,25 We add a non-linear layer with a rectified linear unit layer after the extracted feature vectors to generate a new task-specific tile encoding and a sigmoid layer to map the model output to [0,1]. The hyperparameter search and final parameter set is described in supplementary section S3, and they are used to train all models."}, {"title": "Model training and evaluation", "content": "ECTIL-TCGA is trained using five-fold cross validation split by medical centre of the TCGA cohort (n=356 slides). The model is trained on three folds, validated during training on one fold, and internally tested on the remaining fold. Finally, the model is externally tested on all other cohorts. ECTIL-combined is trained on all cohorts except PARADIGM (n=1964 slides) with a five-fold leave-one-cohort-out data split leaving one cohort for validation during training in each fold, and is tested only on PARADIGM. ECTIL-TNBC is trained on only TNBC samples from the TCGA, BASIS, N4+ and MATADOR (n=400 slides) with a four-fold leave-one-cohort-out data split leaving one cohort for internal validation, and is tested only on PARADIGM. For external testing of each ECTIL model, we pick the model with the highest Pearson's r on the validation set of each fold, using the ensemble of models for the test set."}, {"title": "Statistical analysis", "content": "We perform concordance analyses by computing the mean squared error (MSE), Pearson's-, Spearman-, and concordance correlation coefficient in Python using torchmetrics.\u00b2\u2076 To analyse the model's capacity to identify high vs low TILs we split the pathologist score into TILs-low (< 30%) and TILs-high (\u2265 30%). Using these binary ground-truth labels and the model's predicted TILs score, we compute the area under the receiver operating characteristic curve (AUROC). In the supplementary materials we additionally provide the average precision (AP) and AUROC for varying cutoff points (10%, 50%, 75%). We visualise model predictions over datasets and slides using scatter plots, calibration curves, and score- and attention heatmaps.\nWe reproduce the OS analysis as reported in de Jong et al. in R using the survival package on the PARADIGM cohort. To test the impact of the pathologist's and ECTIL TILS score on OS we calculate hazard ratios (HR) and concordance indexes (CI) using uni- and multivariable Cox proportional models, with adjustment for other clinicopathological characteristics (including T stage, tumour grade, lymphovascular invasion and local treatment) in the PARADIGM cohort. The ECTIL score is normalised to the minimum and maximum of the training dataset. We produce Kaplan Meier plots for the pathologist's score with previously defined cutoffs (30%, 75%). \u03a4\u03bf compare the survival split of the pathologist to ECTIL, we split both scores by their median. The Schoenfeld residuals are used to test the proportionality of hazards assumption over time."}, {"title": "Results", "content": "Study population\nThe baseline characteristics of all collected cohorts are set out in table 1, with a total of 2,340 patients with high quality WSI and complete clinical data. Since the PARADIGM cohort consists of a very specific patient population, and it is used for prognostic analyses, this cohort is described separately. The median age over the cohorts excluding PARADIGM (table S1, ECTIL-Combined column) is 49 (min-max = 22-90) years. The majority of patients are female (98.9%). Most patients had stage II (42.9%) or III (44.1%) disease at time of diagnosis or study entry. Ten patients (0.5%) had known stage IV disease at study entry. Most tumours were categorised as breast cancer of no special type (BC NST, 66.6%) with either tumour grade II (33.4%) or III (34.4%). Presence or absence of lymphovascular invasion was unknown for the majority of tumours (88.7%). Most tumours were ER+/HER2- (59.8%), 11.7% of the tumours were ER+/HER2+, 6.3% ER-/HER2+ and 20.4% were TNBC. The median pathologist TILs score was 10% (min-max: 0-92-5).\nFor the PARADIGM cohort, the median age was 35 years (min-max = 22-39). All patients were female and premenopausal. Stage I disease was most prevalent (59.5%), followed by stage II (40.3%). All patients were node negative at diagnosis, with no known distant metastasis. The majority of tumours were BC NST (85.4%). Twenty (5.1%) patients had metaplastic carcinoma. The majority of tumours were grade 3 (86.2%), followed by grade 2 tumours (13.3%). Lymphovascular invasion was present in 10.3% of the tumours. All tumours in PARADIGM were TNBC. The median TILs score was 20% (min-max:1%-95%).\nAn overview of the baseline characteristics of the ECTIL-TNBC and ECTIL-combined cohorts, which are used for training ECTIL-TNBC and ECTIL-combined models, are shown in table S1.\nECTIL-TCGA is concordant with the pathologist in external cohorts\nFirst, we compared the predictions of ECTIL-TCGA to the pathologist scores in the TCGA internal test set, BASIS, N4+, TRAIN II, MATADOR, and PARADIGM cohorts. When evaluated on the internal test set of the TCGA cohort, ECTIL-TCGA achieved a Pearson's r of 0.61 and AUROC of 0.84 (table S2). In figure 2 we see that ECTIL-TCGA achieves, across external test cohorts, a Pearson's r of 0.54-0-74 and an AUROC of 0-80-0-94. ECTIL achieved the highest concordance on MATADOR (r=0.74, AUROC=0.94), and the lowest on PARADIGM (r=0.58, AUROC=0\u00b780) or N4+ (r=0\u00b754, AUROC=0-82) depending on the metric of interest. Additional metrics, and the AUROC for varying pathologist score cutoffs can be found in table S2, and case-level predictions are presented through scatter plots in figure S2.\nTraining ECTIL on multiple cohorts improves external validation performance on PARADIGM\nSecond, we evaluated ECTIL-TNBC and ECTIL-combined on the PARADIGM cohort. ECTIL-TNBC,, reaches a higher performance (r=0.64, AUROC=0-83) on the PARADIGM cohort compared to ECTIL-TCGA (r=0.58, AUROC=0-80) (figure 2). ECTIL-combined, which includes all slides from all cohorts except PARADIGM (n=1,964), reached a Pearson's r of 0-69 and an AUROC of 0.85 (figure 2). Additional metrics and the AUROC for varying pathologist score cutoffs can be found in table S3.\nTo further investigate the predictions of ECTIL-combined on the PARADIGM cohort we constructed a calibration plot in figure 3 (for ECTIL-TCGA in figure S3, and for ECTIL-TNBC in figure S4). We plotted the pathologist score distribution (y-axis) conditioned on the predicted scores of ECTIL-combined in bins of size 0.05 (x-axis). The distribution of ECTIL-combined scores was smaller (0-0-7), compared to the pathologist score (0-1-0-95). Moreover, ECTIL-combined tended to overpredict the samples with a low (< 0-2) pathologist score, and underpredicts samples with a higher (> 0.3) pathologist score. Additionally, it became clear that there are discordant cases. For each sample with a pathologist score of 0.9, ECTIL may predict these to have a value of 0-2-0-7. Samples that were predicted to have a value of 0-2-0-5 may contain a sample that is originally scored by a pathologist to have, e.g., a TILs score of 0 or 0.9."}, {"title": "Discordant case analysis highlights model limitations", "content": "Next, we qualitatively analysed samples that received highly different scores from ECTIL compared to the pathologist to understand ECTIL's limitations. For each cohort and for two groups (pathologist TILs score < 30 and > 50, which we term pTIL-l and pTIL-h respectively) we randomly choose one sample from the top ten samples with the largest differences between the predicted score and the pathologist score. For these samples, we visualise the heatmap of ECTIL-predicted scores and attention weights for each patch, which were analysed by a board-certified pathologist. These samples are presented in figure S5-S7-2. The first limitation was on samples from invasive lobular carcinoma where tumour cells were scored as TILs. Additionally, patches that contain lymphovascular invasion, other immune hotspots, fibrotic area, and lymphocytes at the tumour boundary received a high TILs score and attention score, while a pathologist would not include these lymphocytes. Cases with large WSI and small tumour beds may receive a different score due to the accumulated attention weight of the large number of patches with low attention. In the aggregated results of the subset analysis presented in table S4, we find that ECTIL-TCGA indeed performed quantitatively worse on patients with invasive lobular carcinoma (r=0.36, AUROC=0-64) across datasets compared to, e.g., breast cancer of no special type (BC NST) (r=0.58, AUROC=0-73).\nThe ECTIL score is prognostic independent of other known prognostic clinicopathological variables\nFinally, we determined whether the predicted TILs scores by ECTIL-TCGA, ECTIL-TNBC and ECTIL-combined are independently associated with OS. In the univariable Cox regression analysis with TILs in 10% increments, all three ECTIL TILs scoring models yield statistically significant HR (0.87 [0-79-0.96], p<0.01 for ECTIL-TCGA, HR 0.86 [0-78-0-94], p<0.01 for ECTIL-combined, HR 0.85 [0-77-0-94], p<0.01 ECTIL-TNBC), similar to the pathologist TILs score (HR 0.87 [0-82-0-92], p<0.001), as outlined in table 2. In the multivariable Cox regression the HR of 10% TILs increments of all ECTIL models (HR 0.87 [0-79-0-95], p<0.01 for ECTIL-TCGA, HR 0.85 [0-77-0.93], p<0.001 for ECTIL-combined, HR 0.84 [0-76-0.93], p<0.001 for ECTIL-TNBC) remain significant, independent of all other clinical characteristics, similar to the pathologist score (HR 0.86 [0-81-0-92], p<0.001), outlined in table 2.\nWe generated Kaplan-Meier curves for the PARADIGM cohort using various scoring methods, with pathologist TILs score cutoffs previously used in the literature (TILs scores of <30, 30-75, \u226575), pathologist scores with median cutoffs (TILs score of \u2265 20 vs. <20), and ECTIL-combined scores split by the median (TILs score of \u2265 27 vs. <27) (Supplementary figure S8, S9, S10 respectively). The analysis revealed significant differences in OS between the groups (pathologist TILs score of \u226575%, 30-74% and <30% have a 100%, 88.9% and 80.6% 3-years OS respectively; pathologist TILs score of \u226520% (median), 94% versus 80% 3-years OS; ECTIL-combined TILs score \u226527 (median), 90% versus 83% 3-years OS), highlighting the clinical value of both ECTIL and pathologist scores when split by the median in patients with systemic treatment naive low stage, NO, TNBC < 40 years of age. The HRs for these groups further supported these findings, indicating the validity of these scoring methods in predicting OS (Figure S8-S10 and table 2)."}, {"title": "Discussion", "content": "In this study, we present ECTIL, a label-efficient CTA that regresses the TILs score from extracted features of WSI patches directly. To our knowledge, this is the largest retrospective validation study of a CTA thus far, including 2,340 patients with available WSIs of their breast carcinoma, TILs scores, and relevant clinical data. We demonstrated that ECTIL, when trained on a limited dataset of only 200 WSIs with a single pathologist annotation (% of TILs score), can produce scores that are highly concordant with a pathologist's assessments across multiple external test cohorts. This concordance is reflected in performance metrics, including Pearson's correlation and AUROC values, which indicate strong agreement with pathologist evaluation. Additionally, ECTIL-generated TILs scores show a significant association with OS, independent of other clinicopathological variables, suggesting that ECTIL can provide prognostic value comparable to that of pathologists. Our findings also reveal that expanding the training dataset to include larger and more heterogeneous cohorts enhances ECTIL's concordance with pathologist assessments. This improvement underscores the importance of training on diverse data sets to maximise model performance. Conversely, restricting the training data to a narrower subset, such as only patients with TNBC, diminishes ECTIL's effectiveness, further highlighting the benefit of diverse training data over homogeneity.\nIn contrast to existing models that generally use a detection-segmentation pipeline involving multiple models and postprocessing steps, ECTIL is a single model trained on two orders of magnitude fewer annotations which finishes training from scratch in only 10 minutes on a commodity graphics processing unit (NVIDIA GeForce RTX 2080 Ti).\u00b90\u201313 Despite this fundamentally simple design, ECTIL reaches a concordance with the pathologist that is highly comparable to existing methods. For example, Bai et al.\u00b9\u00b9 obtain a Spearman's r of 0.61 and 0.63 on two TNBC cohorts, whereas we reach a Spearman's r of 0.47 to 0.72 across five cohorts with varying molecular subtype distributions, and 0.61 for our TNBC cohort. When representing the TILs score as a fraction (from 0 to 1), Sun et al.\u00b9\u2070 report a root mean squared error (RMSE) of 0.15 to 0-22 across three models and two TNBC datasets in their supplementary materials, and ECTIL obtains a RMSE of 0-14 to 0.28 over more heterogeneous cohorts. Thagaard et al.\u00b9\u2074 present the results of commercial software with a Spearman correlation of 0.79, a much higher score than other published scores. It must be noted, however, that this model was developed using immunohistochemistry-guided annotations on slides that were picked as a held-out training set from the cohort collected at their institution. Hence the generalizability to external cohorts cannot be compared easily. Finally, Choi et al.\u00b9\u00b3 present the results of commercial software reaching a concordance correlation coefficient of 0-71 and 0-75 on two TNBC datasets, which is higher than most coefficients achieved by ECTIL. These impressive results can only be achieved with a model trained on a staggering amount of training data, however - 2,712 WSI from multiple cancer types with a total of 2,334 mm\u00b2 dense tissue type annotations with 558,225 explicit cell annotations were utilised. This insight is particularly relevant given that many existing computational tumour analysis models have traditionally relied on more homogeneous training sets. Our study advocates for the inclusion of diverse data in training regimens to enhance model performance and predictive accuracy. These results suggest that ECTIL is able to generalise and perform well across different cohorts and may be more suitable for implementation into daily clinical practice. Although a perfect comparison is not feasible, only commercial CTA methods with extensive annotations appear to outperform ECTIL. Given that ECTIL is trained on substantially fewer annotations, it effectively addresses the main challenge highlighted by Thagaard et al, which is the costly collection of annotations across diverse data distributions to develop generalizable algorithms.\nDespite not explicitly following TILs-WG guidelines, ECTIL learns to predict TILs scores through supervised training with guideline-based scores, suggesting that direct translation of these guidelines into computational frameworks may not be absolutely necessary. ECTIL's validation across numerous cohorts with diverse patient characteristics, technical preparations, scanners, and extraction strategies demonstrates its generalizability. Through qualitative analysis of highly discordant cases by a board-certified pathologist who is trained to score TILs, we identified the limitations of ECTIL. Interestingly, the patch-level TILs scores match the pathologist's idea of the number of stromal lymphocytes, and the attention heatmaps often show a clear focus on mostly relevant tissue. The majority of discordant cases are caused by erroneously included areas like lymphocytic hotspots, lymphocytes at the tumour border, lymphocytes in necrotic areas, and lymphocytes in lymphovascular invasion. These issues are exacerbated when the tumour area is small relative to the WSI, since there is more incorrect tissue to include. Interestingly, however, the TRAIN II cohort, which only includes biopsies that have a low tumour-to-tissue ratio, does not lead to a significantly lower performance than ECTIL achieves on resections. Another clear challenge is scoring invasive lobular carcinomas (ILC) - which is a difficult task even for pathologists since the tumour cells have a similar morphology to lymphocytes and are potentially scored as such. Interestingly, these pitfalls (ILC, erroneous tissue inclusion) are highly similar to those in previous works as described by Thagaard et al., while our model design is fundamentally different.\u00b9\u2074 ECTIL correctly identifies pen markings and air bubbles, which receive low attention and were not the cause of discordance in the discordant cases we analysed. A limitation that is unique to the architecture of ECTIL, however, is the dilution of scores in large WSIs with a small tumour bed. Due to the cumulative effect of a large number of tiles with a low attention score, the scores of these tiles may still contribute 50% of the total weight. This dilution is the main reason our model predicts a maximum score of 70%, which may only be solved using tumour bed annotations or using a context-aware model architecture.\nWhile promising, ECTIL requires further refinement. Since it only needs WSI-level labels, training datasets can be easily enriched with additional labelled data. For example, in our cohorts only 5% of samples are ILC, contributing to lower performance in this subtype. Additionally, employing more recent foundation models like Phikon by Filiot et al. can enhance representation of the underlying morphology.\u00b2\u2077 One of ECTIL's architectural limitations is that it treats patches independently"}, {"title": "", "content": "and lacks context-awareness. As we know that context matters, future improvements could involve using context-aware models, such as vision transformers, which effectively handle WSIs. This architecture captures spatial information and enables it to better learn to follow TILS-WG scoring guidelines.\nBefore a CTA like ECTIL can ever be implemented in the clinic, however, it is required to utilise a separate model to perform quality control since even an image of only a glass slide with no tissue would be given a score, similar to existing models. Additionally, it is the responsibility of a pathologist and clinician to interpret the model's score and decide on the clinical impact for the patient. Before implementing ECTIL as a direct pre-screening tool or tool to assist the pathologist, prospective validation studies are required. In the near future, ECTIL will be incorporated in a prospective de-escalation phase III clinical trial in patients with low-stage TNBC.\nIn conclusion, ECTIL scores TILs on H&E FFPE WSI in a single step without using DL-based segmentation and detection pipelines. ECTIL is data-efficient and scores TILs highly similar to an expert pathologist. It also reaches a similar hazard ratio in an overall survival analysis independent of clinicopathological variables. In the future, such a CTA may be used to pre-screen patients for, e.g., prospective de-escalation trials or immunotherapy clinical trial inclusion or to be used as a tool to assist pathologists and clinicians in clinical decision-making."}, {"title": "Research in context", "content": "Evidence before this study\nWe searched Google Scholar and PubMed on 01 November 2023 for the search terms (\"Deep Learning\" OR \"Artificial Intelligence\") AND \"Pathology\" AND (\"lymphocytes\" OR \"stromal tumour infiltrating lymphocytes\" OR \"TILs\") AND \"breast cancer\", and reviewed the first 30 results. We included papers that validated deep learning applications to quantify stromal tumour infiltrating lymphocytes (TILs) in invasive breast cancer samples from haematoxylin and eosin (H&E) whole slide images (WSIs) (n = 11), and reviews thereof (n=1). The reviewed methods quantify the TILs to match pathologist scores or design novel lymphocyte-based metrics to optimise for prognostic or predictive performance. The published methods are concordant with pathologists (Spearman correlations ranging from 0.57 to 0.79 over studies and cohorts) and proved to have prognostic value independent of other clinicopathological variables. At the same time, their prognostic performance remains lower than that of a pathologist. All externally validated methods are pipelines of multiple steps that perform segmentation and detection to combine pixel-level information into the final biomarker, trained on very large numbers of costly tissue-level and cell-level annotations by expert pathologists.\nAdded value of this study\nThis is the first study that externally validates a model with a fundamentally different design without detection and segmentation deep learning pipelines. Our model is trained solely on WSIs level TILs scores, in contrast to models trained using pixel-level semantic segmentations and cell annotations. Our model requires only a few hundred pathologist annotations to be trained; a reduction by two orders of magnitude compared to published methods using tens of thousands of annotations. Despite its few training labels, simplicity, and lack of any deep-learning-based segmentation mask or cell detections, the model reaches similar concordance (as measured by Spearman correlations ranging from 0-47-0-72 across other cohorts) and prognostic value independent of other clinicopathological variables in a cohort of node-negative, (neo)adjuvant chemotherapy-naive patients <40 years of age with TNBC. This is the largest retrospective validation study (n=2,340 over five cohorts) of any computational TILs assessment method. Our model performs well across various demographics, morphological and molecular subtypes, and medical centres, in both biopsies and resections.\nImplications of all the available evidence\nThis paper shows that our simple model is very data-efficient while showing high concordance with the pathologist, as well as prognostic value independent of other known prognostic clinicopathological variables. Both concordance and prognostic value are similar to existing methods that utilise multi-step segmentation-detection pipelines, while our model reduces annotation requirements by hundredfold. This provides evidence that data-hungry detection and segmentation pipelines may not be necessary for computational TIL assessment. Some, but not all, failure cases of existing methods are solved by our model. But compared to other complex, multi-step, detection segmentation pipelines, solving these known failure cases only requires a few additional labels and simple architectural changes. Our model will be prospectively validated in a de-escalation"}]}