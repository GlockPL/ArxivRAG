{"title": "LIVER CIRRHOSIS STAGE ESTIMATION FROM MRI WITH DEEP LEARNING", "authors": ["Jun Zeng", "Debesh Jha", "Ertugrul Aktas", "Elif Keles", "Alpay Medetalibeyoglu", "Matthew Antalek", "Amir A. Borhani", "Daniela P. Ladner", "Gorkem Durak", "Ulas Bagci"], "abstract": "We present an end-to-end deep learning framework for au-\ntomated liver cirrhosis stage estimation from multi-sequence\nMRI. Cirrhosis is the severe scarring (fibrosis) of the liver\nand a common endpoint of various chronic liver diseases.\nEarly diagnosis is vital to prevent complications such as de-\ncompensation and cancer, which significantly decreases life\nexpectancy. However, diagnosing cirrhosis in its early stages\nis challenging, and patients often present with life-threatening\ncomplications. Our approach integrates multi-scale fea-\nture learning with sequence-specific attention mechanisms\nto capture subtle tissue variations across cirrhosis progression\nstages. Using CirrMRI600+, a large-scale publicly available\ndataset of 628 high-resolution MRI scans from 339 patients,\nwe demonstrate state-of-the-art performance in three-stage\ncirrhosis classification. Our best model achieves 72.8% accu-\nracy on T1W and 63.8% on T2W sequences, significantly out-\nperforming traditional radiomics-based approaches. Through\nextensive ablation studies, we show that our architecture ef-\nfectively learns stage-specific imaging biomarkers. We estab-\nlish new benchmarks for automated cirrhosis staging and pro-\nvide insights for developing clinically applicable deep learn-\ning systems.", "sections": [{"title": "1. INTRODUCTION", "content": "Cirrhosis and its devastating complications present a signifi-\ncant global health challenge with rising mortality rates [1, 2].\nResponsible for nearly one and a half million deaths annually\nworldwide, cirrhosis accounts for 2.4% of all global fatali-\nties [2, 3]. Over the past two decades, mortality rates have in-\ncreased by 26.4%, disproportionately affecting younger pop-\nulations aged 25 to 34 years [4]. The year following a di-\nagnosis of cirrhosis is when individuals are most vulnerable,\nhighlighting the importance of early detection and interven-\ntion [5]. The most decisive prognostic factor for survival is\nthe presence or absence of hepatic decompensation, as pro-\ngression to decompensation significantly increases medical\ncosts and mortality rates [6, 7]. Approximately 11% of in-\ndividuals with compensated cirrhosis experience new decom-\npensations each year, and this progression is associated with\na decline in median survival from 12 years to less than 2\nyears [7]. Moreover, liver cancer ranks among the top six\nmost common cancers worldwide and the third most common\ncause of cancer death [8]. HCC accounts for approximately\n80% of liver cancer cases, with 80%-90% of individuals with\nHCC having underlying cirrhosis [9, 10]. Therefore, early\ndetection and accurate staging of cirrhosis are crucial for pre-\nventing complications and ensuring effective disease manage-\nment and treatment planning.\nCirrhosis is characterized by the gradual replacement of\nhealthy liver tissue with irreversible scarring or fibrosis due\nto various chronic liver diseases [11]. The liver shows no sig-\nnificant morphological changes during the early stages of cir-\nrhosis. As a result, diagnosing cirrhosis at an early stage is\ndifficult and is often missed, even by expert specialists. If the\ndiagnosis is missed in the early stages and the disease pro-\ngresses, it results in various complications that severely affect\npatient outcomes [12]. Traditional diagnosis methods rely on\nclinical symptoms, laboratory tests, and ultrasound imaging,\nwhich restrict their ability to identify subtle tissue changes.\nIn contrast, MRI provides higher image quality and improved\naccuracy for diagnosing cirrhosis and assessing its stages, al-\nlowing physicians to evaluate the liver's structure and tissue\nchanges with precision.\nAs early diagnosis of cirrhosis remains challenging, AI-\ndriven models offer a promising solution for early detection,\nstage estimation, and predicting disease progression. How-\never, well-curated MRI datasets for cirrhosis are still insuffi-\ncient, which restricts advanced image analysis methods such\nas radiomics and deep learning, which require large amounts\nof data [13]. To bridge this gap, a large-scale multi-sequence\nMRI dataset, CirrMRI600+, has been created for liver cirrho-\nsis research [14]. This dataset aims to enhance the application\nof deep learning in analyzing cirrhosis and its stages, improve\nearly-stage diagnostic accuracy in clinical practice, enhance\npatient outcomes, and encourage further research.\nOur work addresses these challenges through a compre-"}, {"title": "2. METHODS", "content": "hensive deep learning framework specifically designed for\nmulti-sequence MRI analysis. Given an input MRI scan X\ncomprising T1W and T2W sequences, we develop a map-\nping function $f_\\theta$ that estimates the cirrhosis stage y while\naccounting for the complementary information present across\nsequences. The framework incorporates sequence-specific\nfeature extraction, cross-sequence attention mechanisms, and\na unified classification architecture. The technical contribu-\ntions of our work advance the field in several key directions:\n\u2022 To our knowledge, this work presents the first comprehen-\nsive deep learning framework for automated liver cirrho-\nsis staging using multi-sequence MRI data. While previ-\nous studies have explored either radiomics features or lim-\nited deep learning approaches for cirrhosis detection, none\nhave systematically addressed the challenging task of ac-\ncurate stage estimation across a large-scale, multi-center\ndataset. Our work bridges this critical gap by introduc-\ning an end-to-end framework that not only achieves state-\nof-the-art performance but also provides interpretable in-\nsights into stage-specific imaging biomarkers.\n\u2022 We performed an extensive empirical evaluation across\nT1W and T2W MRI sequences, systematically analyzing\na broad spectrum of deep learning architectures ranging\nfrom established networks (VGG-19, ResNet variants) to\nrecent state-of-the-art models (MambaVision, ConvNext).\nOur comprehensive experiments encompassed eight dis-\ntinct deep learning architectures and seven radiomics-\nbased machine learning approaches, representing the\nmost extensive comparative study to date for automated\ncirrhosis staging. The results demonstrate the superior\ncapability of deep learning methods, with our best model\nachieving 72.8% accuracy on T1W sequences, signif-\nicantly outperforming traditional radiomics approaches\n(54.0%). Notably, we observe that deeper architectures\nconsistently excel at capturing subtle tissue variations\nacross cirrhosis stages, though their performance varies\nmarkedly, highlighting the inherent challenges in distin-\nguishing intermediate disease progression.\nDataset: Our framework addresses the challenging task of\nliver cirrhosis stage estimation through a comprehensive deep\nlearning approach. The CirrMRI600+ dataset forms the foun-\ndation of our work, comprising 628 high-resolution abdomi-\nnal MRI scans from 339 patients diagnosed with liver cirrho-\nsis. This diverse dataset includes 310 T1W and 318 T2W\nscans, providing rich multi-sequence information for stage\nclassification. We employ an 8:1:1 split ratio, allocating 234\nsamples for training, 29 for validation, and 28 for testing, en-\nsuring robust evaluation of our methods. Fig.1 presents ex-\namples of T1W and T2W MRI scans for mild, moderate, and\nsevere cirrhotic cases.\nNetwork Architecture: Our architectural design priori-"}, {"title": "2. METHODS", "content": "tizes two key objectives: effective sequence-specific feature\nextraction and robust stage classification. We evaluate eight\nstate-of-the-art deep learning architectures, including estab-\nlished networks like VGG-19 and ResNet variants, alongside\nemerging architectures such as MambaVision and ConvNext.\nEach architecture processes the multi-sequence MRI inputs\nthrough specialized encoding pathways before classification.\nFor sequence-specific processing, we implement independent\nencoding streams for T1W and T2W sequences. The fea-\nture extraction pathway incorporates residual connections and\ndense blocks, enabling efficient gradient flow while maintain-\ning fine-grained spatial information critical for stage differen-\ntiation. We express this mathematically as: $F_t = E_t(X_t;\\theta_t)$,\nwhere $E_t$ represents the encoder for sequence type t, $X_t$ is\nthe input sequence, and $\\theta_t$ denotes the learnable parameters.\nImplementation details: In this work, we implemented\ndeep learning models using the PyTorch [23] framework. All\nexperiments were conducted on an NVIDIA A100 GPU. We\nemployed the AdamW optimizer to optimize model parame-\nters, with the learning rate of 1e-4 and the batch size of 32.\nWe train each model for 100 epochs with early stopping pa-\ntience of 20 epochs to prevent overfitting. The loss function\ncombines cross-entropy for classification with an auxiliary at-\ntention guidance term:\n$\\mathcal{L} = \\mathcal{L}_{CE}(y, \\hat{y}) + \\lambda \\mathcal{L}_{Att}(A, A_{gt}),$\nwhere $\\mathcal{L}_{CE}$ represents the cross-entropy loss, $\\mathcal{L}_{att}$ guides at-\ntention map learning, $\\lambda$ balances their contributions, and $\\hat{y}$ is\npredicted decision while y is ground truth.\nEvaluation metrics: We employ a comprehensive set of\nevaluation metrics including accuracy, precision, sensitivity,\nspecificity, and F1-score to thoroughly assess model perfor-\nmance. Stage-specific analysis provides detailed insights into\nmodel behavior across different cirrhosis progression levels.\nThe evaluation protocol ensures fair comparison across archi-\ntectures and with radiomics-based approaches."}, {"title": "3. RESULTS", "content": "Our experimental evaluation reveals several key insights into\nthe effectiveness of deep learning approaches for cirrhosis\nstage estimation. The performance analysis spans both se-\nquence types (T1W and T2W) and encompasses multiple ar-\nchitectural variants (8 state-of-the-art deep learning architec-\ntures), providing a comprehensive assessment of automated\nstaging capabilities. Our study is the first in this sense, not\nonly estimating cirrhosis stage estimation with MRI, but also\nhaving the most comprehensive one."}, {"title": "3.1. Model Performance Analysis", "content": "The detailed results are presented in Tables 1 and 2. Among\nthe evaluated architectures, VGG-19 [15] demonstrates su-\nperior overall performance on T1W sequences, achieving\n72.8% accuracy and 70.23% precision. This performance\nsignificantly exceeds traditional radiomics-based approaches,\nwhich achieve maximum accuracy of 54.0% using Gaus-\nsianNB classifiers. The strong performance of VGG-19\ncan be attributed to its deep feature hierarchy and extensive\nreceptive field, enabling capture of both local texture pat-"}, {"title": "3.2. Stage-Specific Analysis", "content": "We assessed the models' capabilities in estimating each spe-\ncific stage of cirrhosis, and presented them in Table 4. De-\ntailed analysis reveals significant variation in model perfor-\nmance across cirrhosis stages. All architectures demonstrate\nstronger performance in identifying mild (precision 82.03%)\nand severe cases (precision 60.95%) compared to moderate\nstages (precision 19.32%). This pattern persists across both\nsequence types and architectural choices, highlighting an in-\nherent challenge in distinguishing intermediate disease pro-\ngression states. The performance disparity likely reflects the\nsubtle and heterogeneous nature of tissue changes during the\ntransition from mild to moderate cirrhosis."}, {"title": "3.3. Sequence-Specific Performance", "content": "The comparative analysis between T1W and T2W sequences\nreveals important differences in their diagnostic value. T1W\nsequences consistently yield superior performance across all\nevaluated models, with average accuracy improvements of 5-\n10% compared to T2W sequences. This finding aligns with\nclinical observations regarding the enhanced visibility of fi-\nbrotic changes in T1-weighted imaging."}, {"title": "3.4. Impact of network depth and parameter counts", "content": "To evaluate the impact of network depth and parameter count\non liver cirrhosis stage classification, we trained multiple\nvariants of ResNet [16] with different complexities. The"}, {"title": "3.5. Impact of initial network model weights", "content": "We investigated the impact of initial model weights on liver\ncirrhosis stage estimation by training both from-scratch and\npre-trained versions of the ResNet and MambaVision archi-\ntectures. The results are presented in Table 5 and Table 6.\nThe from-scratch ResNet-18 demonstrated superior accuracy\ncompared to its pre-trained counterpart. Additionally, as\nshown in Table 6, only one of the five pre-trained MambaVi-\nsion models exhibited a performance improvement compared\nto its from-scratch equivalent. These findings suggest that"}, {"title": "3.6. Further details on radiomics", "content": "Radiomics results are presented in Table 7, Table 8 and Ta-\nble 10, respectively. The features across the three stages of\ncirrhosis are remarkably similar, making it challenging to\neffectively segregate these feature regions. Even the Gaus-\nsianNB, which achieved the highest accuracy among the ma-\nchine learning methods, only reached an accuracy of 0.540.\nIts performance is significantly lower compared to most deep\nlearning methods, underscoring the potential of deep learning\non liver cirrhosis stage estimation."}, {"title": "4. DISCUSSION", "content": "Despite the promising results, several limitations warrant dis-\ncussion and point toward future research directions. The\nprimary challenge remains the accurate classification of\nmoderate-stage cirrhosis, where performance consistently\nlags behind other stages across all evaluated architectures.\nThis limitation likely stems from the inherent ambiguity in\ntissue characteristics during disease progression and suggests\nthe need for more sophisticated feature learning approaches.\nOur analysis of network depths and architectures reveals\na complex relationship between model capacity and perfor-\nmance. While deeper networks generally perform better, the\ndiminishing returns and occasional performance inversions\nsuggest that architectural innovations may be more valuable\nthan simply scaling existing architectures. Hence, future work\nmight explore domain-specific architectural components that\nbetter capture the hierarchical nature of tissue changes in cir-\nrhosis progression.\nThe current study's reliance on slice-by-slice operation\n(pseudo-3D), while computationally efficient, may miss im-\nportant volumetric information when slice thickness is large.\nHence, future extensions could explore fully 3D architectures\nthat leverage the full spatial context of volumetric MRI data.\nAdditionally, incorporating clinical metadata and longitudinal\nimaging data could provide valuable context for more accu-\nrate staging predictions. We did not conduct decision fusion\nor multi-input models yet. One my try such ensemble strate-\ngies to further improve the results.\nLast, but not least, recently foundation models (FMs) have\nshown remarkable success in computer vision and medical\nimaging. Leveraging multiple imaging modalities and clini-\ncal reports, large-scale FMs tailored for medical applications\nhold significant promise for advancing liver cirrhosis stage es-\ntimation. However, the data is still limited at the moment and\nFMs are at suboptimal for the problem tackled in this paper."}, {"title": "5. CONCLUSION", "content": "This work presents the first comprehensive evaluation of deep\nlearning approaches for automated liver cirrhosis staging us-\ning multi-sequence MRI. Through extensive experimentation"}]}