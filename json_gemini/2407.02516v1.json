{"title": "EditFollower: Tunable Car Following Models for Customizable Adaptive Cruise Control Systems", "authors": ["Xianda Chen", "Xu Han", "Meixin Zhu", "Xiaowen Chu", "PakHin Tiu", "Xinhu Zheng", "Yinhai Wang"], "abstract": "Abstract-In the realm of driving technologies, fully au- tonomous vehicles have not been widely adopted yet, making advanced driver assistance systems (ADAS) crucial for enhancing driving experiences. Adaptive Cruise Control (ACC) emerges as a pivotal component of ADAS. However, current ACC systems often employ fixed settings, failing to intuitively capture drivers' social preferences and leading to potential function disengagement. To overcome these limitations, we propose the Editable Behavior Generation (EBG) model, a data-driven car-following model that allows for adjusting driving discourtesy levels. The framework integrates diverse courtesy calculation methods into long short- term memory (LSTM) and Transformer architectures, offering a comprehensive approach to capture nuanced driving dynamics. By integrating various discourtesy values during the training process, our model generates realistic agent trajectories with dif- ferent levels of courtesy in car-following behavior. Experimental results on the HighD and Waymo datasets showcase a reduction in Mean Squared Error (MSE) of spacing and MSE of speed compared to baselines, establishing style controllability. To the best of our knowledge, this work represents the first data-driven car-following model capable of dynamically adjusting discourtesy levels. Our model provides valuable insights for the development of ACC systems that take into account drivers' social preferences.", "sections": [{"title": "I. INTRODUCTION", "content": "N the current landscape of driving technologies, fully\nautonomous vehicles are yet to become ubiquitous. Ad- vanced driver assistance systems (ADAS), consequently, still play an important role in driving experience enhancement. Among these, Adaptive Cruise Control (ACC) stands out as a cornerstone, serving as the most crucial and prevalent component of ADAS.\nAccurately modeling car-following behavior is paramount for micro-level traffic simulation and plays a pivotal role in ACC systems. Researchers have shown a keen interest in developing car-following models over the years to simulate and comprehend the dynamic nature of car-following behavior [1]\u2013[6].\nHowever, existing ACC systems often utilize fixed settings like predetermined distances or time headways [7]. These standardized approaches fall short of satisfying the heteroge- neous social preferences of drivers. Recognizing that drivers have distinct driving styles [8], [9], the inability to cater to these preferences may lead to disengagement with ACC systems [10], [11], limiting their effectiveness in optimizing driving experiences. The development of an ACC system that allows for adjustable driving styles could significantly enhance acceptance and user experience.\nMoreover, despite the promise of deep learning methods for replicating real-world driving behavior [12]\u2013[14], these approaches remain confined to mimicking the training data's distribution. This hinders their ability to control or deviate from observed patterns, impeding the exploration of diverse and potentially safer driving strategies.\nTo address these limitations and better simulate car- following behaviors in various interactive traffic scenarios, we propose a comprehensive approach. We first integrate diverse discourtesy calculation methods into state-of-the-art data-driven car-following models, including long short-term memory (LSTM) and Transformer architectures. Inspired by previous work [15]\u2013[18], we then introduce the Editable Behavior Generation (EBG) model. This model represents the first data-driven car-following approach that allows for the adjustment of driving discourtesy level, as shown in Fig. 1. Specifically, we utilize real-world car-following data with discourtesy labels to train the EBG model. This model syn- thesizes a simulated following vehicle's future trajectory based on an input discourtesy value, allowing for the generation of realistic car-following behaviors. We present diverse frame- works to label the discourtesy value during training and design a courtesy loss that matches the discourtesy values of the generated trajectories with the input values. The effectiveness of our model is validated using the HighD and Waymo datasets. Results demonstrate that our proposed method is effective in generating desired driving behaviors. Additionally, it captures different driving styles, leading to a reduction in the Mean Squared Error (MSE) of spacing and the MSE of speed. Furthermore, our findings offer valuable insights for the devel-"}, {"title": "II. RELATED WORK", "content": "Since the first car-following model, the Pipes model, was proposed in 1953 [19], researchers have devoted over seven decades to studying car-following models. Five main cate- gories of traditional car-following models have been identi- fied: stimulus-response models, safe distance models, psycho- physiological models, optimal velocity models, and desired goal models [5], [20], [21].\nStimulus-response models rely solely on relative informa- tion (distance or speed) to predict FV acceleration. Built upon the principle of direct response to speed difference, the Gazis-Herman-Rothery (GHR) model [22] assumes a vehicle's acceleration as directly proportional to the speed difference between itself and the lead vehicle, neatly capturing its basic acceleration/deceleration dynamics.\nDifferent from stimulus-response models, Kometani et al. [23] introduced the safety distance model, acknowledging the inherent unpredictability of lead vehicles. This \"conflict avoidance\" model prioritizes maintaining a minimum safe distance from the lead vehicle, setting a new standard for car- following behavior.\nThe psycho-physiological model, built on Michaels' work [24], supposes that drivers react primarily to changes in rela- tive LV-FV motion. VISSIM, a microscopic traffic simulator, leverages this concept through the Wiedemann model [2].\nWhile the Optimal Velocity Model (OVM) of Bando et al. [25] effectively explains diverse traffic flow phenomena, its potential for unrealistic acceleration/deceleration prompted the development of the Generalized Force Model (GFM) by Helbing et al. [26]. This model augments the OVM by incor- porating the influence of negative speed differences, leading to more realistic driving behaviors.\nDriver-centric desired goal models, assuming specific goals like desired speed and headway, have become popularized by models like the Intelligent Driver Model (IDM) [1]. This stands out as the most widely used traditional car-following model which offers a simpler and more effective approach to modeling driver behavior.\nHowever, it is important to note that these rule-based models generally focus on factors such as relative distance, speed dif- ference, and safety distance, they do not explicitly incorporate the concept of courtesy into their frameworks. Courtesy, which refers to the willingness of drivers to accommodate and show consideration for others, plays a crucial role in shaping driver behavior and overall traffic flow."}, {"title": "B. Data-driven car-following models", "content": "In the field of car-following models, there are two main categories: traditional models and data-driven models. Data- driven car-following models transcend traditional rule-based approaches by embracing the power of Artificial Intelligence. From nonparametric regression's flexibility to the intricate learning capabilities of neural networks and reinforcement learning, these models are trained from rich datasets, unravel- ing the intricate tapestry of factors influencing driver behavior. For example, in 2015, a simple k-nearest neighbor-based nonparametric car-following model was introduced to pre- dict driving behavior [27]. Another nonparametric data-driven model is the Loess model, which relies on locally weighted regression [28].\nA 4-layer neural network structure with two hidden lay- ers, as adopted by Hongfei et al. [29], demonstrates the effectiveness of neural network-based approaches in captur- ing the complex relationships between gap distance, relative velocity, desired velocity, and FV speed. Reactive agent-based models employing ANNs, such as backpropagation and fuzzy ARTMAP [30], have emerged as promising approaches in car- following research due to their ability to learn complex traffic dynamics and adapt to diverse driving scenarios. Additionally,"}, {"title": "C. Controllable driving behavior", "content": "Extensive research has been conducted on the development of Adaptive Cruise Control systems that mimic human driving behavior, followed by a substantial body of work in the field of controllable driving behavior. Zhu et al. [42] introduced a data-driven approach to create a Personalized Adaptive Cruise Control system capable (PACC) of adapting to different driv- ing styles. This method involves gathering real-world driving data, categorizing drivers based on their unique characteris- tics, and then constructing a personalized PACC architecture. Similarly, Lu et al. [43] proposed a personalized behavior learning system (PBLS) using neural reinforcement learning. By mimicking the nuanced adjustments of experienced drivers, the PBLS transcends the limitations of conventional motion planners, unlocking a new era of human-centric longitudinal control in diverse driving scenarios. In addition, Wei et al. [44] used simulator data to fine-tune a car-following model that imitates human driving behavior and developed a Model Pre- dictive Control controller. This controller allows autonomous vehicles to smoothly follow natural trajectories in various situations. However, accurately replicating the entire spectrum of human driving behaviors presents a significant challenge with these methods due to their reliance on large-scale real- world driving data.\nAchieving a thorough emulation of human driving behavior entails capturing not only the diverse range of driving styles and scenarios but also detecting the nuanced decision-making processes and situational awareness that human drivers pos- sess. Therefore, it is important to enhance the adaptability and responsiveness of these systems across a wider range of driving conditions and individual driving preferences. Chang et al. [17] proposed an innovative strategy called Socially- Controllable Behavior Generation (SCBG). This strategy in- troduces a new parameter, namely the courtesy level \\(\\psi\\), to specifically address how courteously Vehicle B behaves to- wards Vehicle A in a simulated interactive traffic scenario. The SCBG model proved its mettle on the Waymo Open Motion Dataset. Not only did it generate realistic driving behaviors with adjustable courtesy levels, but it also demonstrated the remarkable ability to adapt courteous actions to the specific demands of each scenario. Therefore, the concept of courtesy level is applied to generate various car-following behaviors in our research, modeling the diverse following behaviors arising from different driver profiles, from aggressive tailgating to cautious distance-keeping, specifically for simulation agents under different levels of aggressiveness."}, {"title": "III. EDITABLE BEHAVIOR GENERATION MODEL", "content": "The Editable Behavior Generation (EBG) Model comprises several key components aimed at simulating the future behav- ior of a following vehicle based on input courtesy features and historical driving context. The overall methodology can be divided into the following parts:"}, {"title": "A. Problem formulation", "content": "We define the problem by outlining the input features and output variables of the model. The five dimensions of the input feature are the speed of LV (\\(v_{t}^{LV}\\)), the speed of FV (\\(v_{t}^{FV}\\)), the relative spacing (\\(\\Delta d_{t}\\)), the relative speed (\\(\\Delta v_{t}\\)), and FV's discourtesy level (denoted as \\(\\psi\\)). The model's output is the speed of FV in the next time step. The composition of the input features and output variables is listed below.\n\nInput = \\(X_{t} = [\\Delta d_{t}, v_{t}^{LV}, v_{t}^{FV}, \\Delta v_{t}, \\psi] \\) (\\(\\psi \\in \\Psi\\))\n\nOutput = \\(\\hat{y}_{t} = [v_{t+1}^{FV}]\\)\nwhere \\(\\hat{y}_{t}\\) represents the speed prediction of FV at the next time step."}, {"title": "B. Driving discourtesy level", "content": "To capture diverse driving behaviors, three discourtesy level calculation methods are explored: acceleration-based courtesy, jerk-based courtesy, and speed-based courtesy. Each method provides a metric that influences how the model adjusts its predictions based on the driving context.\n1) Acceleration-based courtesy: Acceleration measures the rate of change of a vehicle's velocity and serves as a key indicator of how actively a driver is adjusting their speed. The formula for calculating the discourtesy level based on acceleration metrics is given by:\n\nDiscourtesy Level = \\(\\frac{acc\\_std}{acc\\_mean}\\)\nwhere,\n\u2022 acc_std: standard deviation of the acceleration values,\n\u2022 acc_mean: mean of the acceleration values."}, {"title": "C. Model architecture", "content": "Our study explores the different combinations of three main- stream car-following models with the three aforementioned discourtesy level calculation methods. Below is the overview of the architecture of each car-following model.\n1) LSTM model: The LSTM model is designed with an encoder-decoder structure. The encoder utilizes an LSTM layer to process the input sequence, and the decoder employs another LSTM layer to generate the output sequence. The linear layer maps the hidden states to the final output, which is then scaled and transformed to represent the predicted speed for the future time steps. This model is particularly effective in capturing temporal dependencies in the input data.\n2) LSTM_IDM model: The LSTM_IDM model extends the LSTM architecture to IDM parameters. In addition to the encoder-decoder structure, this model includes a linear layer that outputs IDM parameters such as desired speed \\(\\tilde{v}\\), desired time headway \\(T\\), maximum acceleration \\(a_{0}\\), comfort accel- eration \\(b\\), beta \\(\\Delta\\), and jam spacing \\(S_{0}\\). The IDM parameters are then used to simulate the car-following behavior using IDM equations, yielding predictions for the speed of the FV over time. The overall structure and information flow of the LSTM_IDM model is shown in Fig. 2.\n3) Transformer model: The Transformer model [49] fea- tures a self-attention mechanism to capture global dependen- cies in the input sequence. The Transformer's multi-layered architecture, consisting of an encoder and decoder, facilitates parallel processing and scalability for car-following behavior modeling.\n\u2022 Encoder: Through multi-head self-attention, the encoder condenses historical driving data into a contextual rep- resentation. The input features, including the relative distance (\\(\\Delta d_{t}\\)), speed (\\(v_{t}\\)), relative speed (\\(\\Delta v_{t}\\)), and discourtesy level(\\( \\psi\\)), are embedded using linear layers. Positional encoding is added to capture temporal infor- mation. The resulting encoded input is then fed into the Transformer encoder.\n\u2022 Decoder: The decoder generates predictions for the future FV speed based on the speed of the LV and the dis- courtesy level (\\(\\psi\\)). Similar to the encoder, input features undergo embedding and positional encoding before being fed into the Transformer decoder. The output of the Transformer decoder is passed through a linear layer to produce the final predicted FV speed."}, {"title": "D. Loss function", "content": "In the realm of car-following dynamics, the formulation of an effective loss function is paramount for model training and optimization. Given the initial state of the car-following scenario, characterized by the velocity profiles of the LV and the FV, the prediction of the spacing between these vehicles is a critical aspect and is facilitated through the application of system update equations according to Zhu et al. [36].\nThe evolution of the system over discrete time intervals \\(\\Delta T\\) is encapsulated by the following equations:\n\n\\(\\Delta V(t + 1) = V_{LV}(t + 1) - V_{FV}(t+1)\\)\n\\(S(t + 1) = S(t) + \\frac{\\Delta V(t) + \\Delta V(t + 1)}{2} * \\Delta T\\)\nwhere \\(\\Delta T\\) represents the simulation time interval, S denotes the spacing between the two vehicles, and \\(V_{FV}\\) and \\(V_{LV}\\) represent the velocities of the following vehicle and lead vehicle, respectively. The loss function for the EBG model is composed of three distinct components, aimed at capturing speed prediction accuracy, spacing accuracy, and courtesy alignment.\n1) Speed loss (\\(L_{speed}\\)): Measures the similarity between the predicted speed \\(V_{pred}\\) and the ground truth speed of FV \\(V_{label}\\).\n\n\\(L_{speed} = criterion(V_{pred}, V_{label})\\)"}, {"title": "IV. EXPERIMENTS AND RESULTS", "content": "The experimental evaluation of the proposed EditFollower framework is conducted on the HighD and Waymo datasets."}, {"title": "A. HighD dataset", "content": "HighD dataset [50] is proposed by the Institute of Au- tomotive Engineering at RWTH Aachen University in Ger- many, and offers a comprehensive collection of high-precision driving data. This dataset provides in-depth data on vehicle positions and speeds, obtained from bird's-eye view videos of six distinct roads in the Cologne area. Data acquisition was performed using a high-resolution 4K camera mounted on an aerial drone, guaranteeing positional accuracy within 10 cm, as depicted in Fig. 3. The dataset employs advanced computer vision techniques to enhance data quality, utilizing Bayesian smoothing to eliminate noise and achieve smooth motion data. It encompasses more than 110,500 vehicles recorded from six distinct locations, providing automatic extraction of vehicle trajectory, size, type, and maneuvers."}, {"title": "B. Waymo dataset", "content": "Waymo, a self-driving car company under Alphabet, has introduced the Waymo Open Dataset [51], a comprehensive collection of high-resolution sensor data, illustrated in Fig. 4. This dataset encompasses lidar and camera data, delivering accurate 3D vehicle poses and annotated object information. With 1950 scenes, each lasting 20 seconds, the Waymo dataset captures diverse driving scenarios, including expressways and urban streets."}, {"title": "C. Car-following event extraction", "content": "Building upon our established car-following benchmark [5], we extracted car-following events pertinent to this study. The specific criteria are outlined below:\n\u2022 The identification number of the lead vehicle should remain constant, indicating that the following vehicle is consistently following the same lead vehicle.\n\u2022 The duration of the car-following event should be longer than 15 seconds, guaranteeing that there is enough data to be analyzed for each event.\nOver 13,980 car-following events (12,540 from HighD and 1,440 from Waymo) were analyzed for this research. To assess model performance under realistic driving conditions, the data was allocated 70/15/15 for training, validation, and testing."}, {"title": "D. Evaluation metrics", "content": "To comprehensively assess the performance of the proposed EditFollower framework, we employ 4 key evaluation metrics. The chosen metrics include Spacing Mean Squared Error (Spacing MSE), Speed Mean Squared Error (Speed MSE), Courtesy Mean Squared Error (Courtesy MSE), and Courtesy Metric Correlation.\n\u2022 Spacing MSE: Measures the mean squared error between predicted and ground truth spacing values. It quantifies the accuracy of spacing predictions.\n\u2022 Speed MSE: Quantifies the mean squared error between predicted and actual speeds. This metric assesses the precision of speed predictions.\n\u2022 Courtesy MSE: Evaluates the mean squared error be- tween predicted and target discourtesy levels. It gauges the accuracy of discourtesy level predictions.\n\u2022 Courtesy Metric Correlation: Examines the correlation between predicted discourtesy levels and labeled discour- tesy levels."}, {"title": "V. MODEL PERFORMANCE", "content": "The experiment results of various car-following models on both the HighD and Waymo datasets are presented in Tables I and II, respectively. These models are evaluated based on the above four metrics. Specifically, models denoted as \"LSTM_IDM,\" \"LSTM,\" and \"Transformer,\" represent car- following models without the integration of discourtesy levels, serving as baselines for comparison. Therefore, \"Courtesy MSE\" and \"Courtesy Metric Correlation\" are denoted as \"/\" for these models. We highlight the best-performing model results (indicated in bold)."}, {"title": "A. HighD dataset performance", "content": "In speed-based courtesy, The Edit_LSTM_IDM model stands out with the lowest Spacing MSE (6.070), Speed MSE (0.283), and Courtesy MSE (0.0003). It achieves a remarkably high Courtesy Metric Correlation of 0.972, indicating strong alignment with desired discourtesy levels."}, {"title": "B. Waymo dataset performance", "content": "In acceleration-based courtesy, The Edit_LSTM_IDM model again demonstrates outstanding performance with the lowest Spacing MSE (7.283), Speed MSE (0.568), and Cour- tesy MSE (0.068). It maintains a high Courtesy Metric Corre- lation of 0.846, showcasing effective alignment with desired discourtesy levels."}, {"title": "C. Overall insights", "content": "Through analyzing the results presented in the tables, a comparative assessment of different models highlights the effectiveness of our proposed method. The key observations include:\n\u2022 Models incorporating discourtesy levels consistently out- perform baseline models across datasets and courtesy calculation methods.\n\u2022 For the HighD dataset, Speed-based courtesy models, particularly Edit_LSTM_IDM, demonstrate strong per- formance in reducing MSE for spacing and speed, as well as effective courtesy alignment. For the Waymo dataset, Acceleration-based courtesy models, Edit_LSTM_IDM also exhibit competitive performance.\n\u2022 The Courtesy MSE is minimal, and the Courtesy Metric Correlation is high, demonstrating effective alignment with desired discourtesy levels.\nThese results underscore the effectiveness of the proposed editable behavior generation model in generating realistic car- following behaviors with desired discourtesy levels. The model not only reduces errors in spacing and speed prediction but also ensures a strong correlation between predicted and desired discourtesy levels. The ability to tailor car-following behaviors based on discourtesy levels adds a valuable dimension to the modeling process, contributing to improved accuracy and realism in simulations."}, {"title": "VI. CONTROLLABILITY OF DRIVING BEHAVIOR IN EBG", "content": "Given the competitive performance of the Edit_LSTM_IDM model in terms of Spacing MSE, Speed MSE, and Courtesy MSE on the HighD dataset. The controllability is examined through a series of experiments conducted on this dataset."}, {"title": "A. Adjusting discourtesy level", "content": "1) Adjusting discourtesy values to 50% and 150% of the original, as shown in Fig. 5, we observe distinct characteristics in the time gap distribution. Specifically, the 150% discourtesy values exhibit an overall left- skewed distribution, with a higher concentration around 1.4 seconds, indicating more aggressive car-following behavior [52].\n2) Comparative analysis of different input discourtesy val- ues over the entire test set reveals a positive correlation between input discourtesy levels and the corresponding output, as shown in Fig. 6, this suggests that the model effectively adjusts car-following behavior based on the input courtesy, achieving the desired discourtesy levels."}, {"title": "B. Insights for adaptive cruise control development", "content": "Current ACC systems often employ fixed following dis- tances, providing drivers with limited options, such as se- lecting long, medium, or short following distances. However, drivers have their own preferences, and maintaining a fixed distance may lead to challenges such as cut-ins when following too closely. Introducing a continuous and adjustable discour- tesy level in ACC systems would enhance user experience and increase system penetration. Drivers could customize their driving preferences, leading to improved ACC adoption and overall driving satisfaction."}, {"title": "VII. CONCLUSION", "content": "In this study, we introduced the Editable Behavior Gener- ation (EBG) model, the first data-driven car-following model capable of adjusting driving discourtesy levels. Our model, leveraging diverse discourtesy calculation methods and in- tegrating them into state-of-the-art data-driven car-following models, demonstrated competitive performance in terms of"}, {"title": "VIII. FUTURE WORK", "content": "Future research endeavors may focus on several key aspects. Firstly, exploring additional courtesy calculation methods and their impact on driving behavior could further enhance the model's adaptability. Additionally, extending the evaluation to diverse datasets and driving scenarios would contribute to a more comprehensive understanding of the model's gen- eralizability. Furthermore, conducting user studies to gather preferences and feedback on driving discourtesy levels from human drivers would facilitate the development of more so- cially aware models."}, {"title": "IX. APPENDIX", "content": "Demonstration of car-following behavior under various dis- courtesy levels, please refer to the following video link:\nhttps://www.youtube.com/watch?v=UWsF6lJE8jY."}]}