{"title": "EditFollower: Tunable Car Following Models for Customizable Adaptive Cruise Control Systems", "authors": ["Xianda Chen", "Xu Han", "Meixin Zhu", "Xiaowen Chu", "PakHin Tiu", "Xinhu Zheng", "Yinhai Wang", "Fellow, IEEE"], "abstract": "Abstract-In the realm of driving technologies, fully au- tonomous vehicles have not been widely adopted yet, making advanced driver assistance systems (ADAS) crucial for enhancing driving experiences. Adaptive Cruise Control (ACC) emerges as a pivotal component of ADAS. However, current ACC systems often employ fixed settings, failing to intuitively capture drivers' social preferences and leading to potential function disengagement. To overcome these limitations, we propose the Editable Behavior Generation (EBG) model, a data-driven car-following model that allows for adjusting driving discourtesy levels. The framework integrates diverse courtesy calculation methods into long short- term memory (LSTM) and Transformer architectures, offering a comprehensive approach to capture nuanced driving dynamics. By integrating various discourtesy values during the training process, our model generates realistic agent trajectories with dif- ferent levels of courtesy in car-following behavior. Experimental results on the HighD and Waymo datasets showcase a reduction in Mean Squared Error (MSE) of spacing and MSE of speed compared to baselines, establishing style controllability. To the best of our knowledge, this work represents the first data-driven car-following model capable of dynamically adjusting discourtesy levels. Our model provides valuable insights for the development of ACC systems that take into account drivers' social preferences. Index Terms-Autonomous Vehicles, Advanced Driver Assis- tance Systems, Adaptive Cruise Control, Car-Following.", "sections": [{"title": "I. INTRODUCTION", "content": "Iau N the current landscape of driving technologies, fully autonomous vehicles are yet to become ubiquitous. Ad- vanced driver assistance systems (ADAS), consequently, still play an important role in driving experience enhancement. Among these, Adaptive Cruise Control (ACC) stands out as a cornerstone, serving as the most crucial and prevalent component of ADAS.\nAccurately modeling car-following behavior is paramount for micro-level traffic simulation and plays a pivotal role in ACC systems. Researchers have shown a keen interest in developing car-following models over the years to simulate and comprehend the dynamic nature of car-following behavior [1]\u2013[6].\nHowever, existing ACC systems often utilize fixed settings like predetermined distances or time headways [7]. These standardized approaches fall short of satisfying the heteroge- neous social preferences of drivers. Recognizing that drivers have distinct driving styles [8], [9], the inability to cater to these preferences may lead to disengagement with ACC systems [10], [11], limiting their effectiveness in optimizing driving experiences. The development of an ACC system that allows for adjustable driving styles could significantly enhance acceptance and user experience.\nMoreover, despite the promise of deep learning methods for replicating real-world driving behavior [12]\u2013[14], these approaches remain confined to mimicking the training data's distribution. This hinders their ability to control or deviate from observed patterns, impeding the exploration of diverse and potentially safer driving strategies.\nTo address these limitations and better simulate car- following behaviors in various interactive traffic scenarios, we propose a comprehensive approach. We first integrate diverse discourtesy calculation methods into state-of-the-art data-driven car-following models, including long short-term memory (LSTM) and Transformer architectures. Inspired by previous work [15]\u2013[18], we then introduce the Editable Behavior Generation (EBG) model. This model represents the first data-driven car-following approach that allows for the adjustment of driving discourtesy level, as shown in Fig. 1. Specifically, we utilize real-world car-following data with discourtesy labels to train the EBG model. This model syn- thesizes a simulated following vehicle's future trajectory based on an input discourtesy value, allowing for the generation of realistic car-following behaviors. We present diverse frame- works to label the discourtesy value during training and design a courtesy loss that matches the discourtesy values of the generated trajectories with the input values. The effectiveness of our model is validated using the HighD and Waymo datasets. Results demonstrate that our proposed method is effective in generating desired driving behaviors. Additionally, it captures different driving styles, leading to a reduction in the Mean Squared Error (MSE) of spacing and the MSE of speed. Furthermore, our findings offer valuable insights for the devel-"}, {"title": "II. RELATED WORK", "content": "A. Rule-based car-following models\nSince the first car-following model, the Pipes model, was proposed in 1953 [19], researchers have devoted over seven decades to studying car-following models. Five main cate- gories of traditional car-following models have been identi- fied: stimulus-response models, safe distance models, psycho- physiological models, optimal velocity models, and desired goal models [5], [20], [21].\nStimulus-response models rely solely on relative informa- tion (distance or speed) to predict FV acceleration. Built upon the principle of direct response to speed difference, the Gazis-Herman-Rothery (GHR) model [22] assumes a vehicle's acceleration as directly proportional to the speed difference between itself and the lead vehicle, neatly capturing its basic acceleration/deceleration dynamics.\nDifferent from stimulus-response models, Kometani et al. [23] introduced the safety distance model, acknowledging the inherent unpredictability of lead vehicles. This \"conflict avoidance\" model prioritizes maintaining a minimum safe distance from the lead vehicle, setting a new standard for car- following behavior.\nThe psycho-physiological model, built on Michaels' work [24], supposes that drivers react primarily to changes in rela- tive LV-FV motion. VISSIM, a microscopic traffic simulator, leverages this concept through the Wiedemann model [2].\n@ While the Optimal Velocity Model (OVM) of Bando et al. [25] effectively explains diverse traffic flow phenomena, its potential for unrealistic acceleration/deceleration prompted the development of the Generalized Force Model (GFM) by Helbing et al. [26]. This model augments the OVM by incor- porating the influence of negative speed differences, leading to more realistic driving behaviors.\nDriver-centric desired goal models, assuming specific goals like desired speed and headway, have become popularized by models like the Intelligent Driver Model (IDM) [1]. This stands out as the most widely used traditional car-following model which offers a simpler and more effective approach to modeling driver behavior.\nHowever, it is important to note that these rule-based models generally focus on factors such as relative distance, speed dif- ference, and safety distance, they do not explicitly incorporate the concept of courtesy into their frameworks. Courtesy, which refers to the willingness of drivers to accommodate and show consideration for others, plays a crucial role in shaping driver behavior and overall traffic flow.\nB. Data-driven car-following models\nIn the field of car-following models, there are two main categories: traditional models and data-driven models. Data- driven car-following models transcend traditional rule-based approaches by embracing the power of Artificial Intelligence. From nonparametric regression's flexibility to the intricate learning capabilities of neural networks and reinforcement learning, these models are trained from rich datasets, unravel- ing the intricate tapestry of factors influencing driver behavior. For example, in 2015, a simple k-nearest neighbor-based nonparametric car-following model was introduced to pre- dict driving behavior [27]. Another nonparametric data-driven model is the Loess model, which relies on locally weighted regression [28].\nA 4-layer neural network structure with two hidden lay- ers, as adopted by Hongfei et al. [29], demonstrates the effectiveness of neural network-based approaches in captur- ing the complex relationships between gap distance, relative velocity, desired velocity, and FV speed. Reactive agent-based models employing ANNs, such as backpropagation and fuzzy ARTMAP [30], have emerged as promising approaches in car- following research due to their ability to learn complex traffic dynamics and adapt to diverse driving scenarios. Additionally,"}, {"title": "C. Controllable driving behavior", "content": "Extensive research has been conducted on the development of Adaptive Cruise Control systems that mimic human driving behavior, followed by a substantial body of work in the field of controllable driving behavior. Zhu et al. [42] introduced a data-driven approach to create a Personalized Adaptive Cruise Control system capable (PACC) of adapting to different driv- ing styles. This method involves gathering real-world driving data, categorizing drivers based on their unique characteris- tics, and then constructing a personalized PACC architecture. Similarly, Lu et al. [43] proposed a personalized behavior learning system (PBLS) using neural reinforcement learning. By mimicking the nuanced adjustments of experienced drivers, the PBLS transcends the limitations of conventional motion planners, unlocking a new era of human-centric longitudinal control in diverse driving scenarios. In addition, Wei et al. [44] used simulator data to fine-tune a car-following model that imitates human driving behavior and developed a Model Pre- dictive Control controller. This controller allows autonomous vehicles to smoothly follow natural trajectories in various situations. However, accurately replicating the entire spectrum of human driving behaviors presents a significant challenge with these methods due to their reliance on large-scale real- world driving data.\nAchieving a thorough emulation of human driving behavior entails capturing not only the diverse range of driving styles and scenarios but also detecting the nuanced decision-making processes and situational awareness that human drivers pos- sess. Therefore, it is important to enhance the adaptability and responsiveness of these systems across a wider range of driving conditions and individual driving preferences. Chang et al. [17] proposed an innovative strategy called Socially- Controllable Behavior Generation (SCBG). This strategy in- troduces a new parameter, namely the courtesy level 4, to specifically address how courteously Vehicle B behaves to- wards Vehicle A in a simulated interactive traffic scenario. The SCBG model proved its mettle on the Waymo Open Motion Dataset. Not only did it generate realistic driving behaviors with adjustable courtesy levels, but it also demonstrated the remarkable ability to adapt courteous actions to the specific demands of each scenario. Therefore, the concept of courtesy level is applied to generate various car-following behaviors in our research, modeling the diverse following behaviors arising from different driver profiles, from aggressive tailgating to cautious distance-keeping, specifically for simulation agents under different levels of aggressiveness."}, {"title": "III. EDITABLE BEHAVIOR GENERATION MODEL", "content": "The Editable Behavior Generation (EBG) Model comprises several key components aimed at simulating the future behav- ior of a following vehicle based on input courtesy features and historical driving context. The overall methodology can be divided into the following parts:\nA. Problem formulation\nWe define the problem by outlining the input features and output variables of the model. The five dimensions of the input feature are the speed of LV ($v_{t}^{LV}$), the speed of FV ($v_{t}^{FV}$), the relative spacing ($\\Delta d_{t}$), the relative speed ($\\Delta v_{t}$), and FV's discourtesy level (denoted as $\\psi$). The model's output is the speed of FV in the next time step. The composition of the input features and output variables is listed below.\nInput = $X_{t}$ = [$\\Delta d_{t}, v_{t}^{LV}, v_{t}^{FV}, \\Delta v_{t}, \\psi$] ($\\psi\\in\\Psi$) (1)\nOutput = $\\hat{y}_{t}$ = [$v_{t+1}$] (2)\nwhere $\\hat{y}_{t}$ represents the speed prediction of FV at the next time step.\nB. Driving discourtesy level\nTo capture diverse driving behaviors, three discourtesy level calculation methods are explored: acceleration-based courtesy, jerk-based courtesy, and speed-based courtesy. Each method provides a metric that influences how the model adjusts its predictions based on the driving context.\n1) Acceleration-based courtesy: Acceleration measures the rate of change of a vehicle's velocity and serves as a key indicator of how actively a driver is adjusting their speed. The formula for calculating the discourtesy level based on acceleration metrics is given by:\nDiscourtesy Level = $\\frac{acc\\_std}{acc\\_mean}$\nwhere,\n\u2022 acc_std: standard deviation of the acceleration values,\n\u2022 acc_mean: mean of the acceleration values."}, {"title": "D. Loss function", "content": "In the realm of car-following dynamics, the formulation of an effective loss function is paramount for model training and optimization. Given the initial state of the car-following scenario, characterized by the velocity profiles of the LV and the FV, the prediction of the spacing between these vehicles is a critical aspect and is facilitated through the application of system update equations according to Zhu et al. [36].\nThe evolution of the system over discrete time intervals $\\Delta T$ is encapsulated by the following equations:\n$\\Delta v(t + 1) = v_{LV}(t + 1) - v_{FV}(t+1)$\n$S(t + 1) = S(t) + \\frac{\\Delta v(t) + \\Delta v(t + 1)}{2} * \\Delta T$ (3)\nwhere $\\Delta T$ represents the simulation time interval, $S$ denotes the spacing between the two vehicles, and $v_{FV}$ and $v_{LV}$ represent the velocities of the following vehicle and lead vehicle, respectively. The loss function for the EBG model is composed of three distinct components, aimed at capturing speed prediction accuracy, spacing accuracy, and courtesy alignment.\n1) Speed loss ($L_{speed}$): Measures the similarity between the predicted speed $v_{pred}$ and the ground truth speed of FV $v_{label}$.\n$L_{speed} = criterion(v_{pred}, v_{label})$"}, {"title": "IV. EXPERIMENTS AND RESULTS", "content": "The experimental evaluation of the proposed EditFollower framework is conducted on the HighD and Waymo datasets.\nA. HighD dataset\nHighD dataset [50] is proposed by the Institute of Au- tomotive Engineering at RWTH Aachen University in Ger- many, and offers a comprehensive collection of high-precision"}, {"title": "V. MODEL PERFORMANCE", "content": "The experiment results of various car-following models on both the HighD and Waymo datasets are presented in Tables I and II, respectively. These models are evaluated based on the above four metrics. Specifically, models denoted as \"LSTM_IDM,\" \"LSTM,\" and \"Transformer,\" represent car- following models without the integration of discourtesy levels, serving as baselines for comparison. Therefore, \"Courtesy MSE\" and \"Courtesy Metric Correlation\" are denoted as \"/\" for these models. We highlight the best-performing model results (indicated in bold).\nA. HighD dataset performance\nIn speed-based courtesy, The Edit_LSTM_IDM model stands out with the lowest Spacing MSE (6.070), Speed MSE (0.283), and Courtesy MSE (0.0003). It achieves a remarkably high Courtesy Metric Correlation of 0.972, indicating strong alignment with desired discourtesy levels."}, {"title": "VI. CONTROLLABILITY OF DRIVING BEHAVIOR IN EBG", "content": "Given the competitive performance of the Edit_LSTM_IDM model in terms of Spacing MSE, Speed MSE, and Courtesy MSE on the HighD dataset. The controllability is examined through a series of experiments conducted on this dataset.\nA. Adjusting discourtesy level\n1) Adjusting discourtesy values to 50% and 150% of the original, as shown in Fig. 5, we observe distinct characteristics in the time gap distribution. Specifically, the 150% discourtesy values exhibit an overall left- skewed distribution, with a higher concentration around 1.4 seconds, indicating more aggressive car-following behavior [52]."}, {"title": "VII. CONCLUSION", "content": "In this study, we introduced the Editable Behavior Gener- ation (EBG) model, the first data-driven car-following model capable of adjusting driving discourtesy levels. Our model, leveraging diverse discourtesy calculation methods and in- tegrating them into state-of-the-art data-driven car-following models, demonstrated competitive performance in terms of"}, {"title": "VIII. FUTURE WORK", "content": "Future research endeavors may focus on several key aspects. Firstly, exploring additional courtesy calculation methods and their impact on driving behavior could further enhance the model's adaptability. Additionally, extending the evaluation to diverse datasets and driving scenarios would contribute to a more comprehensive understanding of the model's gen- eralizability. Furthermore, conducting user studies to gather preferences and feedback on driving discourtesy levels from human drivers would facilitate the development of more so- cially aware models."}, {"title": "IX. APPENDIX", "content": "Demonstration of car-following behavior under various dis- courtesy levels, please refer to the following video link:\nhttps://www.youtube.com/watch?v=UWsF6lJE8jY."}]}