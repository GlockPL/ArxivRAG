{"title": "A generalizable framework for unlocking missing reactions in genome-scale metabolic networks using deep learning", "authors": ["Xiaoyi Liu", "Hongpeng Yang", "Chengwei Ai", "Ruihan Dong", "Yijie Ding", "Qianqian Yuan", "Jijun Tang", "Fei Guo"], "abstract": "Incomplete knowledge of metabolic processes hinders the accuracy of Genome-scale Metabolic models (GEMs), which in turn impedes advancements in systems biology and metabolic engineering. Existing gap-filling methods typically rely on phenotypic data to minimize the disparity between computational predictions and experimental results. However, there is still a lack of an automatic and precise gap-filling method for initial state GEMS before experimental data and annotated genomes become available. In this study, we introduce CLOSEgaps, a deep learning-driven tool that addresses the gap-filling issue by modeling it as a hyperedge prediction problem within GEMs. Specifically, CLOSEgaps maps metabolic networks as hypergraphs and learns their hyper-topology features to identify missing reactions and gaps by leveraging hypothetical reactions. This innovative approach allows for the characterization and curation of both known and hypothetical reactions within metabolic networks. Extensive results demonstrate that CLOSEgaps accurately gap-filling over 96% of artificially introduced gaps for various GEMs. Furthermore, CLOSEgaps enhances phenotypic predictions for 24 GEMs and also finds a notable improvement in producing four crucial metabolites (Lactate, Ethanol, Propionate, and Succinate) in two organisms. As a broadly applicable solution for any GEM, CLOSEgaps represents a promising model to automate the gap-filling process and uncover missing connections between reactions and observed metabolic phenotypes.", "sections": [{"title": "Significance Statement", "content": "Genome-scale Metabolic Models (GEMs) provide a comprehensive understanding of gene-reaction- metabolite interactions and are widely used as a powerful tool in bioengineering applications, partic- ularly in microbial product man- ufacturing. However, even the most highly-curated GEMs remain gaps due to limited knowledge of metabolic processes. Traditional methods are resource-intensive and restricted to known pathways. To address this issue, we introduce CLOSEgaps, a model-free, data- driven deep learning framework that integrates hypergraph Convolu- tional Network and attention mech- anism to predict metabolic gaps. By combining the robust CLOSEgaps framework with a simulation work- flow, we have automated the gap- filling process, offering the potential to expedite the completion of GEMs and facilitate more effective bioengi- neering efforts."}, {"title": "Introduction", "content": "Integrating a comprehensive understanding of biology at the systems level is essential for advancing bioengineering, drug targeting, and medical therapies (1-3). In this pursuit, metabolic networks and annotated genomes are leveraged to gain a holistic view of cellular functions. Despite these efforts, gaps still exist in our knowledge of cellular metabolic capabilities. Thus, systematically uncovering these unknown metabolic processes has the potential to catalyze a wide range of medical and biotechnological applications (4). As a mathematical representation of an organism's metabolism, GEnome-scale Metabolic models (GEMs) offer comprehensive gene-reaction-metabolite connectivity through stoichiometric and reaction-gene matrices. These models have emerged as a powerful tool for systematically analyzing cellular metabolic functions (5-11). With extensive use in the study of model organisms, these models are commonly evaluated through simulation techniques such as Flux Balance Analysis (FBA) (12), which assumes a balanced flux of metabolites in the metabolic network via linear optimization (7, 13). Recently, the availability of whole-genome sequencing data (14) and automatic reconstruction pipelines (15, 16) have opened up new avenues for constructing draft GEMs. However, incomplete knowledge of metabolic processes and incomplete genomic and functional annotations results in incomplete draft GEMs, characterized by missing reactions (4, 5, 16). This presents an opportunity for completing GEMS through the gap-filling process, aimed at minimizing the number of missing reactions by adding reactions to the model (17, 18). Hence, effective and robust gap-filling algorithms are essential for metabolic network reconstructions (19, 20).\nRecently, various classic gap-filling algorithms have been developed and reviewed, including constraint-based modeling, GrowMatch, and comparative genomics methods (21). However, these traditional gap-filling methods rely on phenotypic data and extensive manual curation to address knowledge gaps in draft GEMs, impacting the time, accuracy, and effectiveness of the GEM models in biomedical applications (18, 21-23). These methods are also limited by their reliance on experimental data, which is often unavailable for non-model or \"uncultivable\" organisms, and"}, {"title": "Results", "content": "A Workflow of CLOSEgaps for Metabolic Network Recon- struction. CLOSEgaps is used in the workflow to predict missing reactions in GEMs. As shown in Fig. 1a, it involves five key steps: mapping GEM to hypergraph, negative reaction sampling, feature initialization, feature refinement, and prediction or ranking. In the first step (Fig. 1b), we mathematically map the GEM to an unweighted hypergraph (see \"Material and Methods\" and \"Data Collection and Pre- processing in SI Appendix\") The second step uses a metabolic network and the ChEBI database (30) to sample negative reactions. The third step maps metabolites to hypernode features and reactions to hyperedge features and applies a fully connected layer for feature initialization (Fig. 1c.1). The fourth step (Fig. 1c.2) refines the metabolic network structure\nand properties with hypergraph convolution and attention.\nIn the final step (Fig. 1c.3 and d), the hyperedge feature is\nupdated and multiplied by the transposed incidence matrix,\nand then each reaction's feature vector is fed into a neural\nnetwork to determine its confidence level.\nMetabolic Network Reconstruction.\nAssessment of Robustness on Artificially Introduced Gaps. The\nautomated reconstruction of GEMs hinges upon the accuracy\nof the prediction model for missing reactions. Therefore, it\nis imperative to attain a dependable prediction of missing\nreactions for GEMs. The goal of this validation is to test\nthe ability of CLOSEgaps to recover artificially introduced\ngaps (i.e., artificially removing existing reactions in metabolic\nnetworks). Thus, to examine the generalizability performance\nof CLOSEgaps, we tested CLOESgaps with CHESHIRE (24),\nGraphSAGE (27), NHP (28), GCN and Node2Vector (25, 31),\nRGNN (26, 32) and HGNN (33) on five high-quality BiGG\nGEMs and two organic chemistry datasets as summarized in\nTable 1.\nBelow we conducted two types of validation based on\nartificially introduced gaps. For both types, CLOSEgaps\nrequires a complete training process for each specific GEM it\nis applied to, ensuring that the model is fully tailored to the\nspecific metabolic network being analyzed. For each GEM,\nnegative (fake) reactions were sampled at 1:1 ratio to all\npositive reactions, by replacing 50% of the metabolites in\neach reaction with randomly selected metabolites from the\nCHEBI database (see \"Hypergraph and negative sampling in\nMaterials and Methods\"). Accordingly, after combining the\npositive and negative reactions for each GEM, we randomly\nselected 60% of the data for the training, 20% for validation,\nand 20% for testing, with the testing set treated as missing\nreactions. This process was repeated over 10 independent\nMonte Carlo runs (see \"CLOSEgaps Model in Materials and\nMethods\"). Furthermore, we conducted extensive experiments\nwith various negative sampling strategies (detailed results\navailable in SI Appendix), such as 50%, 20%, and 80%\nmetabolite replacement, and spanning 1:1, 1:2, and 1:3\nnegative-to-positive reaction ratios (see SI Appendix, Fig. S2).\nAnd an optimal atom-balanced negative reaction sampling\nstrategy, by preserving the atomic count consistency between\nreactants and products (see SI Appendix, Table S2-S3).\nTo perform the first type validation, we tested CLOSEgaps\non five high-quality BiGG GEMs with 60% training and 40%\nvalidation and testing. Following the previous missing reac-\ntion prediction works (24, 28, 29), CLOSEgaps achieves the\nbest performance in four classical classification performance\nmetrics: the F1 score, the area under the receiver operating\ncharacteristic curve (AUC), the area under the precision-\nrecall (AUPR), and precision and recall. A threshold score\nof 0.5 was used to determine whether a test reaction is true\nor false.\nAs illustrated in Fig. 2 and Fig. 3, CLOSEgaps exhibited\nsuperior performance, achieving the highest average over\n97% AUC and AUPR. A Saccharomyces cerevisiae yeast8.5\nmetabolic network dataset from Lu et al. (34) was used\nfor evaluation. CLOSEgaps attains an F1 score of 96%,\nAUC of 99%, AUPR of 99%, Precision of 95%, and Recall\nof 96%. CLOSEgaps outperformed Node2Vector (25) by\napproximately 25% and exceeded other graph embedding"}, {"title": "Fermentation Process Improvement.", "content": "Predicting Fermentation Products in Anaerobic GEMs. To gap- filling GEMs with CLOSEgaps, we employed a missing- reaction inference workflow that integrates CLOSEgaps to gap-filling draft GEMs. The primary motivation behind the reconstruction of GEMs is their potential to furnish theoretical forecasts of the respective metabolic phenotypes (23, 36). Since CLOSEgaps is a deep learning-based model, which is not limited by the availability of high-quality metabolic pathways and reaction measurements (16). CLOSEgaps was utilized to identify and fill metabolic gaps between the silico phenotypes and available experimental data. This was achieved through the simulation of anaerobic growth conditions and the capturing of false-positive phenotypes. To fill these gaps, we targeted reactions that were crucial for growth in the draft GEM with specific phenotypes, but are currently unexplored. Thus, we conducted biologically mean- ingful experiments via metabolic fermentation products for 24 draft GEMs grown in anaerobic conditions. The draft GEMs"}, {"title": "Discussion", "content": "In this study, we introduce a new and innovative metabolic network reconstruction workflow and machine learning model, NICEgame and CLOSEgaps, which is aimed at predicting missing reactions. CLOSEgaps is a fully data-driven model that is built on the foundation of curated GEMs and hypothetical reaction data. The comprehensive evaluations of both internal and external test sets reveal that our method effectively curates GEMs, leading to improved predictions of missing metabolic reactions and functions that can later be verified through experimentation. Our"}, {"title": "Materials and methods", "content": "Universal Bacterial Models and Biochemistry database. The workflow of CLOSEgaps includes four databases (see Fig. 1A): GEM of the organism, Metabolites reference SMILES dataset, Metabolites database, and BiGG candidate reactions database. Specifically, the draft GEM models were downloaded from the BiGG database (http://BiGG.ucsd.edu) in August 2022 (51). To represent metabolites and reactions in the SMILES string format, each GEM includes a crafting"}, {"title": "Problem Description.", "content": "CLOSEgaps primarily utilizes deep learning-based algorithms to represent GEMs as hypergraphs and gap-filling GEMs through hypergraph learning. This process involves predicting missing reactions through hy- perlink prediction. Gap-filling via CLOSEgaps relies on topology information, which aids in identifying gaps and uncovering the missing reactions even for highly incomplete GEMs. To describe the problem with a given GEM, we define the hypergraph as H = {V,E}, where V = {U1, U2, ..., Un} is the node (metabolite) set and hyperedges E = {e1, C2, ..., em}, Ce CV,\u20ac = 1,2,..., m for the metabolic network. In general, the hypergraph H can be represented by its incidence matrix Hp \u2208 Rnxm, each row corresponds to a metabolite and each column to a reaction. An entry of 1 indicates the participation of a metabolite in a reaction, while 0"}, {"title": "CLOSEgaps Model.", "content": "As shown in Fig. la, the architecture of CLOSEgaps consists of five modules: database construction, negative reaction sampling, feature initialization, feature refinement, and ranking hypothetical reactions. Furthermore, a generalized workflow for automated metabolic network reconstruction comprises three stages (Fig. 1d). The first stage maps metabolites to SMILES (52) using the public database of Biochemistry (see SI Appendix, Fig. S1). The second stage uses CLOSEgaps to rank and add top N reactions to the draft GEMs to create gap-filled GEMs (N reactions with the highest confidence scores). Specifically, CLOSEgaps is trained on the full reaction set of the draft GEM, while candidate reactions from a reaction pool (e.g., the BiGG database) are ranked based on confidence scores. The third stage applies flux simulation to predict metabolic phenotypes. CLOSEgaps tries to match the predictions of the draft model with the observed phenotype by adding reactions. Suppose there is a discrepancy between the gap-filled and draft GEMs. In that case, it indicates unexplored pathways, which are addressed in the workflow using Mixed Integer Linear Programming (MILP) (7, 13) to infer the reactions causing the gaps.\nTo improve the ability of the deep-learning model to predict missing reactions, we incorporated negative sampling by generating non-existent reactions (see Fig. 1b and SI Appendix, Negative sampling strategies) (29, 53). This involves substituting percentages of metabolites from a positive hyperlink with those from the ChEBI database, expanding our hypergraph to include these negative samples, making H = [Hp|Hn] \u2208 Rn\u00d72m. The positive and negative reactions for each GEM were combined and randomly and randomly split into training, validation, and testing sets over 10 Monte Carlo runs (60% as the training set, 20% for validation, and 20% for testing. The process was repeated 10 times).\nTo initialize the hypernode feature (see Fig. 1c) represented as X(0). The hyperedge feature denoted Xe, we used a fully connected layer based on three matrices: the GEM hyper- graph matrix Hp, the initial hypergraph matrix H combined with negative reactions, and the metabolite similarity matrix S. The similarity matrix S\u2208 Rnxn was constructed using"}, {"title": "Training Algorithm.", "content": "We leverage the exceptional efficiency of the Adam optimization algorithm (56) to train CLOSEgaps with the following cross-entropy loss function as Equation (5):\n$Loss = \\frac{1}{2m} \\Big( \\Sigma_{e_i \\epsilon E_p} log(y_i) +  \\Sigma_{e_i \\epsilon E_n} log(1 \u2013 y_i)\\Big),$ [5]\nwhere Ep is the set of positive hyperlinks, En is the set of negative hyperlinks. In the training phase, CLOSEgaps learns the weights of the deep neural network by minimizing the loss function via maximizing the scores for positive hyperlinks. Throughout the evaluation phase, CLOSEgaps utilizes the learned weights to compute a probability score for an unseen hyperlink originating from either a testing set or a comprehensive candidates reaction pool dataset."}, {"title": "Data, Materials, and Software Availability.", "content": "All study data are included in the article and/or supporting information. The raw data is collected from ChEBI (https://www.ebi.ac.uk/), and BiGG (http://bigg.ucsd.edu/). The code and model have been provided in Github [https://github.com/guofei-tju/CLOSEgaps]"}]}