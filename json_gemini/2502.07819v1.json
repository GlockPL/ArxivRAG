{"title": "Enhancing kidney transplantation through multi-agent kidney exchange programs: A comprehensive review and optimization models", "authors": ["Shayan Sharifi"], "abstract": "This paper presents a comprehensive review of the last two decades of research on Kidney Exchange Programs (KEPs), systematically categorizing and classifying key contributions to provide readers with a structured understanding of advancements in the field. The review highlights the evolution of KEP methodologies and lays the foundation for our contribution. We propose three mathematical models aimed at improving both the quantity and quality of kidney transplants. Model 1 maximizes the number of transplants by focusing on compatibility based on blood type and PRA, without additional constraints. Model 2 introduces a minimum Human Leukocyte Antigen (HLA) compatibility threshold to enhance transplant quality, though this leads to fewer matches. Model 3 extends the problem to a Multi-Agent Kidney Exchange Program (MKEP), pooling incompatible donor-recipient pairs across multiple agents, resulting in a higher number of successful transplants while ensuring fairness across agents. Sensitivity analyses demonstrate trade-offs between transplant quantity and quality, with Model 3 striking the optimal balance by leveraging multi-agent collaboration to improve both the number and quality of transplants. These findings underscore the potential benefits of more integrated kidney exchange systems.", "sections": [{"title": "1. Introduction", "content": "Kidney transplantation is one of the most effective treatments for kidney failure, involving the transfer of a kidney from a living or deceased donor to a patient in need (Li et al., 2016; Bay & Hebert, 1987). Historically, deceased donors were the primary source for transplants, but this approach only partially addressed the growing demand. Over time, the practice of using living donors has become increasingly prevalent, with innovations such as kidney division increasing the organ supply and saving more lives (Horvat et al., 2009). Additionally, research has shown that transplants from living donors are generally twice as successful as those from deceased donors, emphasizing the importance of expanding living donor programs. However, a significant barrier remains ensuring compatibility between donor and recipient (Dharia et al., 2022; Glorie et al., 2014).\nIn the United States, organ donation and transplantation have reached notable milestones. In 2023, over 46,000 organ transplants were performed, including more than 16,000 from deceased donors and nearly 7,000 from living donors. This marks a steady annual increase, with an average of 127 transplants occurring daily. Despite these achievements, over 103,000 individuals remain on the transplant waiting list, and tragically, 17 people die each day while waiting for an organ (\"Organ Procurement and Transplantation Network,\u201d 2023). On a global scale, the disparity between the number of available organs and the demand remains acute. For example, in 2022, there were 102,090 kidney transplants and 37,436 liver transplants performed worldwide, with deceased donors accounting for approximately 41,792 transplants. Living donors, however, continue to play a pivotal role, particularly in countries with well-established programs (\u201cUnited Network for Organ Sharing,\u201d 2023). Although the U.S. leads in both deceased and living organ donation, the shortage of organs remains a critical challenge worldwide."}, {"title": "2", "content": "A key issue in kidney transplantation is donor-recipient incompatibility, which occurs when a donor's kidney is unsuitable for the recipient due to blood or tissue mismatches. This poses a significant barrier to successful transplants. Paired kidney exchanges offer a solution to this problem, where two incompatible patient-donor pairs exchange kidneys with one another, thereby creating compatible matches. In cases where a perfect match cannot be found, the KEP allows for kidney exchanges between donor-recipient pairs with some degree of incompatibility, expanding transplant opportunities (Constantino et al., 2013). The goal of such programs is to maximize successful transplants through optimal compatibility matching. These exchanges can involve multiple pairs, with the simplest case involving two pairs where each donor is compatible with the other pair's recipient (Yuh et al., 2017). Rapaport (1986) was pioneer in developing the principles of paired kidney donation, envisioning two incompatible patient-donor pairs exchanging compatible kidneys. In this method, once two incompatible pairs are identified, they exchange kidneys, ensuring both patients receive compatible organs from the other pair's donor. This foundational concept of paired kidney exchange is at the core of our research.\nDespite the success of KEPs, they face limitations in achieving optimal matches and managing logistical complexities. To address these issues, the concept of MKEPs has emerged as a promising alternative. While KEPs have been implemented at national and regional levels in many countries, recent initiatives in Europe seek to create international pools for MKEPs. This collaborative effort aims to increase the likelihood of finding compatible matches by combining the resources and donor pools of multiple nations (Ashlagi & Rot, 2014; Benedek et al., 2021; Mincu et al., 2021). By utilizing collaborative networks and advanced algorithms, MKEPs have the potential to transform the organ allocation process in the United States.\nOne of the key contributions of this paper is our focus on HLA compatibility to enhance transplant quality, particularly in cases where compatible matches are difficult to find. Initially, we implemented the general model in KEP. Then, by introducing minimum HLA compatibility requirements, we demonstrate that the number of transplants decreases. Consequently, we propose a final model that incorporates MKEP, taking HLA into account by considering fairness, ensuring all agents can receive at least the number of transplants they would obtain if acting independently. Our results show that with a larger pool of incompatible pairs, it is possible to simultaneously increase both the number and the quality of transplants. Further details are provided in the model and numerical example sections.\nIn this paper, we explore the potential benefits and feasibility of implementing MKEPs through a detailed numerical example. Our goal is to address critical gaps in transplant accessibility and efficiency, ultimately improving outcomes for patients in need of kidney transplants. Expanding the U.S. kidney exchange program through MKEPs could increase the number of transplants by 30 to 63 percent. However, current research highlights significant inefficiencies in the existing system, as most transplants are coordinated by individual hospitals rather than national platforms. This fragmentation leads to suboptimal outcomes, as hospitals often fail to fully consider the broader benefits of participating in exchanges, and existing platforms lack sufficient incentives for hospitals to submit patients and donors. Solving this problem requires a combination of new mechanisms, reforms, and reimbursement strategies (Agarwal et al., 2019).\nThis research addresses two key issues in kidney transplantation: the shortage of available organs and the quality of transplants. A major concern is the mortality rate among patients who die while waiting for transplants due to long waiting times. Another critical factor is the level of HLA compatibility between the patient and donor, which significantly influences the quality of the transplant. A higher HLA compatibility rate increases the likelihood of organ acceptance by the recipient, reducing the risk of rejection (Clark & Unsworth, 2010). Moreover, patients who receive high-quality transplants experience better long-term health outcomes. Thus, improving kidney transplantation processes not only addresses the organ shortage but also enhances the quality of life for transplant recipients.\nAdditionally, this paper presents a comprehensive review of the last two decades of research on KEPs, providing readers with a detailed and informed perspective on the evolution of kidney exchange practices. To the best of our knowledge, this extensive review offers a valuable foundation for understanding the future potential of KEPs and MKEPs in improving transplant outcomes globally."}, {"title": "2. Literature review", "content": "The body of research surrounding KEPs has expanded significantly, addressing key challenges such as maximizing the number of transplants, incorporating failure probabilities, optimizing logistics, and balancing costs. This section reviews contributions to the field, focusing on common themes that have shaped the development of KEP methodologies and solutions."}, {"title": "2.1 Maximizing Transplant Opportunities", "content": "One of the primary goals in KEP research is maximizing the number of successful transplants, particularly within pools of incompatible patient-donor pairs. Alvelos et al. (2019) proposed an integer programming model that accounts for the probability of failure during matching. They later relaxed this model into a linear programming (LP) framework to maximize the number of transplants possible in incompatible sets (Alvelos et al., 2015). In a follow-up study, expanded their approach by incorporating various types of cycles and chains, employing branch-and-price methods to further optimize transplant opportunities in failure-prone scenarios (Alvelos et al., 2019).\nSimilarly, Dickerson et al. (2016) introduced scalable KEP formulations, combining two innovative approaches to handle large-scale kidney exchanges. Their model addressed issues of mismatches, including age and weight differences, and resolved compatibility challenges through simulations using real-world data. Klimentova et al. (2014) also proposed a cycle decomposition model with dual objectives of maximizing transplant numbers while minimizing costs, offering an efficient solution for large-scale exchanges.\nYuh et al. (2017) strengthened these efforts by employing the Reformulation Linearization Technique (RLT) to develop a new integer programming model. This model systematically improved upon earlier methods by enhancing lower bounds and optimizing matching quality. Abraham et al. (2007) contributed scalable algorithms for national KEP markets, focusing on maximizing social welfare while addressing incompatibility on a large scale.\nLi et al. (2014) introduced two integer programming (IP) formulations aimed at optimizing kidney exchange organizations. They proposed a novel approach for maximizing kidney allocation, considering the specific needs of recipient groups on the waiting list. Their work also introduced random characteristics into the management of KEP programs, enhancing the flexibility and applicability of the model."}, {"title": "2.2 Addressing Uncertainty and Failure", "content": "Another key challenge in KEPs involves handling uncertainty and potential failures in the matching process. Ahmadvand and Pishvaee (2018) pioneered a model based on Data Envelopment Analysis (DEA) that evaluates patient-donor efficiency under uncertain conditions. This approach incorporated both medical and non-medical factors, introducing fuzzy programming to make allocation decisions more flexible in dynamic healthcare environments. Ahmadvand and Pishvaee (2018) developed a two-phase stochastic programming (SP) model to address node and arc failures in kidney exchanges. Their model improves robustness by mitigating system breakdowns prior to implementation (Lee et al., 2018). Zheng et al. (2015) similarly introduced a Stochastic Minimum Cost Flow (SMCF) model to handle uncertain arc failures. Their method ensured that alternative paths were available for rerouting, increasing the reliability of the exchange process.\nIn their efforts to optimize kidney exchanges without limiting chain lengths, Anderson developed an algorithm that closely replicates real-world KEP scenarios. Their solution, designed for practical applications, maximized the number of transplants while optimizing logistical constraint (Anderson et al., 2015)."}, {"title": "2.3 Enhancing Efficiency and Reducing Costs", "content": "Several researchers have focused on improving the efficiency of KEPs by reducing logistical and operational costs. Caruso and Daniele (2018) presented a network-based model designed to minimize total costs associated with transplantation, including hospital, surgery, and transportation expenses. By using non-linear formulations, their model ensured optimal resource distribution within national healthcare systems (Caruso & Daniele, 2018). Kutlu-Gundogdu et al. (2018) addressed the kidney transplant problem in Turkey with an Integer Programming (IP) approach, considering the demographic impact of age and gender on transplant outcomes. They demonstrated that demographic factors can play a significant role in optimizing the allocation process and improving efficiency.\nZahiri et al. (2014) introduced a robust probabilistic model for organ allocation, focusing on minimizing costs and waiting time while enhancing network performance. Their later work expanded this approach to include a dynamic location-allocation problem, ensuring that organs were allocated efficiently within transplant centers while keeping costs and waiting times low. Savaser et al. (2019) also emphasized operational efficiency by reducing transportation time between donor and recipient cities. By improving the logistics of organ transfer, their model enhanced surgical performance and increased the probability of successful transplants.\nCaurso and Daniele (2018) presented a network-based mathematical model designed to minimize the total costs associated with organ transplantation, including expenses related to hospitals, surgeries, transportation, medical teams, and disposal. Their model aimed to optimize healthcare services by developing a diverse formula that accounts for unpredictable changes, providing solutions for cost reduction and operational efficiency. The study demonstrated that this model effectively minimized total costs while maintaining balance and efficiency across the healthcare system.\nZahiri et al. (2014) introduced a dynamic location-allocation problem for organ allocation under uncertainty for transplant centers (TC) units. Their model used a mixed-integer mathematical programming approach with dual objectives: optimizing the prioritization of organs and minimizing both costs and total waiting times for transplant surgeries. The model ensured that organs were allocated efficiently and in a timely manner, addressing both operational and logistical challenges in organ transplantation."}, {"title": "2.4 Methodological Innovations and Multi-Criteria Appro", "content": "Several contributions have advanced the methodological foundations of KEP research, with a focus on incorporating multi-criteria decision-making and innovative algorithms. Constantino et al. (2013) introduced two formulas-Lagrangian relaxation and strong compatibility limits that have been widely adopted for handling compatibility constraints in complex kidney exchanges. Their approach relaxed traditional compatibility constraints, allowing for more flexible matching (Constantino et al., 2013).\nPansart et al. (2018) developed a column generation approach to overcome the NP-hard nature of pricing problems in KEPs. Their methods ensured high-quality solutions within short timeframes, enhancing the overall logistics of transplant allocation.\nGlorie et al. (2012) made significant contributions by demonstrating how large, multi-criteria kidney exchanges can be optimized using scalable algorithms. Their multi-stage hierarchical approach effectively smoothed large cycles and chains, improving the efficiency of resource allocation and fairness in the matching process (Glorie et al., 2012, 2014).\nDickerson expanded on these innovations by introducing new formulations with limited cycle lengths and linear programming relaxations. Their work, based on real-world data from the U.S. and U.K., outperformed existing models in managing long kidney exchange chains (Dickerson et al., 2016).\nLi et al. (2019) conducted two significant studies on matching compatible pairs in exchanges. Their work introduced the Living Kidney Donor Profile Index (LKDPI) to evaluate donor profiles, and they developed a simulation model that allowed for the joint evaluation of compatibility and quality. This innovative approach improved the allocation of compatible and incompatible pairs in real-world transplant centers (Li et al., 2019)."}, {"title": "3. Model", "content": "In this section, we present the mathematical formulations for addressing the kidney transplant assignment problem, structured into three distinct models. Each model builds on the previous one to improve transplant outcomes by introducing new objectives and constraints.\n\u2022 Model 1 represents the general version of the KEP, aimed at maximizing the number of transplantations while considering blood type and PRA compatibility between patients and donors.\n\u2022 Model 2 builds on the previous formulation by introducing a minimum HLA compatibility threshold to ensure that all assigned transplants meet a high standard of quality. This model evaluates the impact of enforcing stricter HLA requirements on the transplantation outcomes.\n\u2022 Model 3 extends the problem to MKEP, where multiple agents (e.g., hospitals or regions) collaborate. This model demonstrates that, by combining the pools of incompatible pairs across agents, not only can the number of successful transplantations increase, but the quality of the transplants, as measured by HLA compatibility, can also be improved. Additionally, this model guarantees that each agent receives at least as many transplants as it would have achieved independently in Model 1.\nThe primary objective across all models is to maximize the total compatibility score between patients and donors, accounting for key factors like HLA compatibility, blood type, and PRA type. Below, we define the common variables and constraints for all models, followed by the additional constraints specific to each model.\nSet:\nI: index for each pair which includes an incompatible patient and donor\nA: index for each agent which we assume can be {1, 2, 3, 4}\n$N_A$: the set of patient-donor pairs for agent A\nParameters:\n$HLA_{ij}$: HLA score between patient i and donor j\n$HLA_{ji}$: HLA score between patient i and donor j, as well as patient j and donor i.\n$HLA_{ij} = HLA_{ij}^P + HLA_{ji}^D$ (1)\n$L_{HLA}$: Minimum requirement for HLA score for a high-quality transplant\n$C_{ij}$: 1, if patient i and donor j and patient j and donor i are compatible in terms of body tissue and blood type\nDecision Variables:\n$x_{ij}$: 1, if patient i receives kidney from donor j, and patient j receives kidney from donor i\n$p_{ij}$: 1, if patient i and donor j satisfy the minimum HLA requirement, $L_{HLA}$\nModel 1:\nThis model aims to maximize the number of transplants by considering blood type and PRA compatibility.\nmax $\\sum_{i \\in N_A} \\sum_{j \\in N_A, j>i} x_{ij}$ (2)\n$x_{ij} \\leq C_{ij}$  $\\forall i \\in N_A, j \\in N_A, i \\neq j$ (3)\n$x_{ij} = x_{ji}$ $\\forall i, j \\in I$ (4)\n$\\sum_{j=1,j\\neq i}^{N_A} x_{min(i,j),max(i,j)} \\leq 1$ $\\forall i \\in N_A$ (5)\n$x_{ij} \\in \\{0,1\\}$ (6)\nThe objective function (Eq. 1) maximizes the total number of matched pairs across all incompatible patient-donor pairs in the set $N_A$, ensuring that each pair is counted once. The compatibility between patient i and donor j is governed by the parameter $C_{ij}$, which is calculated based on blood type and PRA compatibility (Eq. 3). A match can only occur if both conditions are satisfied, meaning that $c_{ij} = 1$, otherwise xij must be 0. The symmetry constraint (Eq. 4) ensures that if a match between patient i and donor j is made, the reciprocal match is also valid, enforcing consistency in the matching process. Each patient can only receive one kidney, which is ensured by limiting the sum of assigned pairs for each patient to at most one (Eq. 5). Finally, the decision variable xij is binary, ensuring that a match is either made or not made (Eq. 6). Together, this formulation creates a structure where the model prioritizes maximizing the number of transplants while ensuring that all matches are biologically feasible, and that no patient receives more than one kidney."}, {"title": null, "content": "The parameter $c_{ij}$ represents the compatibility between patient iii and donor j based on two key biological factors: blood type compatibility and PRA compatibility. Here's how cij is calculated:\n\u2022 Blood Type Compatibility: For a transplant to be successful, the donor and recipient must have compatible blood types. Compatibility is determined based on the following rules:\n\u039f Type O can donate to any blood type (universal donor).\n\u039f Type A can donate to A and AB.\n\u039f Type B can donate to B and AB.\n\u039f Type AB can donate only to AB.\n\u2022 PRA (Panel Reactive Antibody) Compatibility: PRA measures the level of antibodies in the patient's blood that could react against the donor's tissue. A high PRA indicates that the patient is more likely to reject the kidney. Compatibility is generally easier if the patient has a lower PRA score or if the donor has a low antigen profile that is less likely to provoke an immune response.\nTherefore, cij is calculated as:\n\u2022 $c_{ij}$ = 1 if both blood type and PRA compatibility are satisfied between patient i and donor j.\n\u2022 $c_{ij}$ = 0 if either the blood type or PRA compatibility condition is violated.\nThe matrix $c_{ij}$ is precomputed before solving the model and used to determine which pairs can be considered for transplantation.\nAn important consideration is the level of compatibility between the patient and donor, particularly in terms of HLA matching, which plays a critical role in determining the success of the transplant. Higher HLA compatibility between the patient and donor reduces the likelihood of organ rejection, as the recipient's body is more likely to accept the transplant. Moreover, patients who undergo transplants with higher compatibility rates generally experience improved health outcomes and enhanced post-transplant quality of life. For this reason, in Model 2, we introduce the concept of HLA matching into the objective function and establish a minimum HLA requirement to ensure that all kidney transplants meet a certain standard of quality. By adding this criterion, we aim to not only maximize the number of transplants but also improve the overall quality of life for transplant recipients by reducing the risk of rejection and increasing the long-term success rate of the transplant.\nModel 2:\nModel 2 builds on Model 1 by introducing a minimum HLA score requirement to improve transplant quality. The goal is to maximize the number of transplants while ensuring each match meets the HLA compatibility threshold.\nmax $\\sum_{i \\in N_A} \\sum_{j \\in N_A, j>i} HLA_{ij} x_{ij}$ (7)\n$x_{ij} \\leq C_{ij}$  $\\forall i \\in N_A, j \\in N_A, i \\neq j$ (8)\n$HLA_{ij} \\geq L_{HLA}p_{ij}$ $\\forall i \\in N_A, j \\in N_A, i \\neq j$ (9)\n$x_{ij} \\leq p_{ij}$ $\\forall i \\in N_A, j \\in N_A, i \\neq j$ (10)\n$x_{ij} = x_{ji}$ $\\forall i, j \\in I$ (11)\n$\\sum_{j=1,j\\neq i}^{N_A} x_{min(i,j),max(i,j)} \\leq 1$ $\\forall i \\in N_A$ (12)\n$x_{ij}, p_{ij} \\in \\{0,1\\}$ (13)\nIn Model 2, two new elements are introduced to ensure a minimum level of HLA compatibility for each transplant. The first new constraint (Eq. 9) ensures that the HLA compatibility score between patient i and donor j, represented by HLAij, must meet or exceed a predefined threshold $L_{HLA}$ for the match to be considered viable. To enforce this, the binary variable pij is introduced, which equals 1 if the HLA compatibility requirement is satisfied, i.e., if $HLA_{ij} > L_{HLA}$. The second new constraint"}, {"title": null, "content": "(Eq. 10) ensures that a match xij can only occur if the minimum HLA requirement is met, meaning $x_{ij} \\leq p_{ij}$. In other words, the match can only proceed if pij = 1, guaranteeing that the match satisfies the required level of HLA compatibility. These additions ensure that the model not only maximizes the number of transplants but also improves the quality of each transplant by focusing on high HLA compatibility.\nModel 3:\nThe new version of MKEP model (Model 3) aims to address two primary challenges in kidney transplantation: the shortage of transplants and the quality of transplants. By combining kidney pools across multiple agents (e.g., hospitals or regions), the MKEP model significantly increases the number of potential transplants, as more incompatible donor-recipient pairs can be matched. Additionally, by incorporating HLA compatibility into the model, we ensure that not only is the quantity of transplants maximized, but also the quality, thereby improving post-transplantation outcomes and reducing the risk of rejection. This approach is essential to enhance the long-term quality of life for transplant recipients by ensuring better matching.\nIn Model 3, we extend the framework to a multi-agent setting, where several agents (such as hospitals or countries) contribute their incompatible donor-recipient pairs to a shared pool. The model guarantees that each agent will receive at least the number of transplants they would have obtained individually, while maximizing the overall number and quality of transplants. We need to modify the sets, parameters, and variables of the previous model and provide the mathematical model based on the new changes.\nSets and Indices:\n\u2022 A: Set of agents (e.g., hospitals, regions).\n\u2022 NA: Set of incompatible pairs for agent a, where a \u2208 A.\n\u2022 i, j: Indices of incompatible donor-recipient pairs within agent a.\n\u2022 n: Total number of pairs across all agents.\nDecision Variables:\n\u2022 $x_{ij}^{st}$: A binary decision variable that equals 1 if patient i from agent s is matched with donor j from agent t (either within or between agents), and 0 otherwise.\n\u2022 $p_{ij}^{st}$: A binary variable that equals 1 if the match between patient i from agent s and donor j from agent t meets the HLA compatibility threshold.\nmax $\\sum_{s \\in A} \\sum_{t \\in A} \\sum_{i \\in N_A} \\sum_{j \\in N_A,} HLA_{ij}^{st} x_{ij}^{st}$ (14)\n$x_{ij}^{st} \\leq c_{ij}^{st}$ $\\forall i, j \\in N_i, s, t \\in A, s \\neq t$ (15)\n$x_{ij}^{st} \\leq c_{ij}^{st}$ $\\forall i, j \\in N_A, s, t \\in A, s = t, i \\neq j$ (16)\n$HLA_{ij}^{st} \\geq L_{HLA}p_{ij}^{st}$ $\\forall i, j \\in N_i, s, t \\in A, s \\neq t$ (17)\n$HLA_{ij}^{st} \\geq L_{HLA}p_{ij}^{st}$ $\\forall i, j \\in N_A, s, t \\in A, s = t, i \\neq j$ (18)\n$x_{ij}^{st} \\leq p_{ij}^{st}$ $\\forall i, j \\in N_i, s, t \\in A, s \\neq t$ (19)\n$x_{ij}^{st} \\leq p_{ij}^{st}$ $\\forall i, j \\in N_A, s, t \\in A, s = t, i \\neq j$ (20)\n$x_{ij}^{st} = x_{ij}^{ts}$ $\\forall i, j \\in N, s, t \\in A$ (21)\n$\\sum_{j=1,j\\neq i}^{N_A} \\sum_{t \\in A} x_{min(i,j),i}^{st} \\leq 1$ $\\forall i \\in N_A, s \\in A$ (22)\n$\\sum_{i \\in N_A} \\sum_{j \\in N_A,j>i} x_{ij}^{ss} + \\sum_{t \\in A, t\\neq s} \\sum_{i \\in N_A} \\sum_{j \\in N_A,} x_{ij}^{st} \\geq M_a$ $\\forall s \\in A$ (23)\n$x_{ij}^{st}, p_{ij}^{st} \\in \\{0,1\\}$ (24)"}, {"title": null, "content": "The objective function (Eq. 14) maximizes the total HLA compatibility score for all matched pairs between agents. Equations (15) and (16) ensure that a match between patient i and donor j, either between agents (cross-agent) or within the same agent (intra-agent), is only allowed if they are compatible based on blood type and PRA, represented by cif. Equations (17) and (18) introduce a minimum HLA compatibility threshold, where HLA must be greater than or equal to the predefined threshold $L_{HLA}$. The binary variable pi is used to enforce this condition, where p = 1 if the HLA compatibility score meets the requirement. Furthermore, constraints (19) and (20) ensure that a match xij between patient i from agent s and donor j from agent t can only occur if the HLA compatibility requirement is satisfied, meaning x \u2264 pij. To maintain the consistency of matching, Eq. (21) enforces symmetry, ensuring that if patient i from agent s is matched with donor j from agent t, the reciprocal match xif is also valid. Each patient can be matched with only one donor, either within the same agent or across agents, as ensured by Eq. (22). Finally, Eq. (23) guarantees that each agent receives at least as many transplants as it would have achieved independently, maintaining fairness in the collaborative multi-agent system. The binary decision variables xi and pi (Eq. 24) ensure that the model respects both the matching and HLA compatibility conditions. Through this multi-agent framework, the model not only increases the number of transplants but also improves their quality by focusing on HLA compatibility between patients and donors.\n\u2022 The model ensures that both intra-agent and cross-agent matches maximize HLA compatibility, while respecting compatibility constraints based on blood type and PRA, so it guarantees the transplants quality.\n\u2022 It guarantees fairness, as each agent is assured a minimum number of transplants, equivalent to what they would achieve independently.\n\u2022 The binary variables xand p\u00e5 control the feasibility of matches and ensure that HLA compatibility is met for all transplants.\n\u2022 By considering all the above points, this model provides more transplants for all agents with a better quality as compared to the scenario that each agent run its own pool, which you can see the detail comparisons and analysis in the next section."}, {"title": "4. Discussion", "content": "To evaluate the effectiveness of our kidney transplantation models, we conducted a numerical example using simulated data for incompatible donor-recipient pairs. This example simulates a MKEP, where multiple agents, such as hospitals or states, contribute their own pools of incompatible donor-recipient pairs to a shared exchange pool. We explored three distinct cases to demonstrate the impact of both the number of transplants and the quality of matches when considering HLA compatibility thresholds, while also ensuring fairness for all agents. Initially, we intended to work on a real case study in the US. However, due to the unavailability of data from at least four states to simulate the problem based on real-world conditions, we generated data using Python tools."}, {"title": "4.1 Numerical example", "content": "In this example, four agents contributed n incompatible pairs to the kidney exchange pool. Each agent's pool of incompatible pairs was characterized by blood type, PRA compatibility, and HLA compatibility scores between donor-recipient pairs. The primary goal of this numerical example was to examine how incorporating HLA compatibility thresholds affects both the number and quality of transplants, and how introducing a multi-agent system increases the overall efficiency of kidney exchanges. The simulation followed these key steps:\n1. Random Data Generation: Compatibility data for blood type, PRA, and HLA scores were randomly generated for each pair within the n pairs contributed by each agent. Blood type and PRA compatibility were represented by binary values, where 1 indicated compatibility and 0 indicated incompatibility. HLA scores were randomly drawn from a predefined set of values, reflecting various levels of compatibility between donors and recipients.\n2. HLA Compatibility Threshold: For scenarios where HLA compatibility was considered, a minimum threshold value $L_{HLA}$ was set to ensure that only high-quality transplants were allowed. Pairs with HLA compatibility scores below this threshold were deemed incompatible for transplantation.\nCase 1: Maximizing the Number of Transplants without HLA Compatibility\nIn the first case, we aimed to maximize the number of transplants within each agent's pool without considering HLA compatibility. The matching was based solely on blood type and PRA compatibility. The following constraints were applied:\n\u2022 Matches were only allowed if pairs were compatible with respect to blood type and PRA.\n\u2022 Each patient could receive only one transplant.\n\u2022 The objective was to maximize the number of successful transplants for each individual agent.\nThis case served as the baseline, prioritizing the quantity of transplants without regard for match quality in terms of HLA compatibility.\nCase 2: Adding Minimum HLA Compatibility Requirement\nIn the second case, we introduced a minimum HLA compatibility threshold $L_{HLA}$ for each agent's kidney exchange pool. The model incorporated this threshold into the matching process, ensuring that only high-quality transplants, meeting the minimum HLA score, were allowed. Key changes in this case included:\n\u2022 A constraint that required the HLA compatibility score between patient iii and donor j to exceed the threshold $L_{HLA}$.\n\u2022 The blood type and PRA compatibility constraints from Case 1 were retained.\n\u2022 The objective was to maximize both the number and quality of transplants, ensuring that all matches met the minimum HLA compatibility requirement.\nCase 3: Multi-Agent Kidney Exchange with HLA Compatibility\nIn the third case, the incompatible pairs from all four agents were combined into a shared pool, creating a multi-agent kidney exchange model. This allowed for cross-agent matching, which leveraged the larger pool of donor-recipient pairs to increase the number of transplants. The primary aspects of this case were:\n\u2022 Each agent's pool of $n_s$ pairs was combined into a single pool of $\\sum_{s=\\{1,...,4\\}} n_s$ incompatible pairs.\n\u2022 Both intra-agent and cross-agent matches were allowed, increasing the potential for successful transplants.\n\u2022 The minimum HLA compatibility requirement was applied to all transplants to ensure quality.\n\u2022 A fairness constraint was added to guarantee that each agent received at least as many transplants as they would have received independently (as in Case 1).\nAfter reviewing the results of each case, we conducted a sensitivity analysis on the two main parameters of the problem: the number of pairs ns and the HLA compatibility threshold $L_{HLA}$. This analysis provides further insight into how these parameters affect both the quantity and quality of transplants in multi-agent kidney exchanges.\nInput Parameters\nFor the base scenario, we consider the following key input parameters for the kidney exchange optimization problem:\n\u2022 Number of Pairs per Agent: We assume that each agent has 5 patient-donor pairs.\n\u2022 Number of Agents: The model considers 4 agents (hospitals or regions), each managing their own patient-donor pairs.\n\u2022 $L_{HLA}$: This threshold value determines the minimum required HLA score for high-quality transplants. In the base scenario, we set $L_{HLA}$ = 210.\n\u2022 Compatibility Constraints (Cij): Compatibility between a patient and donor is governed by two biological factors:\n\u039f Blood Type Compatibility: The donor and recipient must have compatible blood types. Type O can donate to anyone, while Type AB can only donate to another AB.\n\u039f PRA Compatibility: PRA measures the likelihood of the recipient rejecting the donor kidney. Lower PRA indicates higher compatibility.\nFor each patient-donor pair, we randomly generated HLA scores based on a predefined set of possible values: [55, 110, 150, 160, 205, 210, 255, 300, 305, 310, 350, 355, 360]. These values reflect different levels of compatibility, with higher values indicating greater compatibility between the donor and recipient (Kutlu-G\u00fcndo\u011fdu et al., 2018). For the base case, where the Number of Pairs per Agent = 5 and $L_{HLA}$ = 210, the outcomes across the three models are summarized below."}, {"title": "4.2 Analysis", "content": "In kidney exchange programs, the success of matching patients with compatible donors heavily depends on two key factors: the biological compatibility between patient-donor pairs and the size of the available patient-donor pool. Understanding the influence of these factors is crucial for optimizing both the number and quality of successful transplants.\n4.2.1 Sensitivity Analysis on LHLA\nThe HLA score plays a vital role in determining the success of a transplant. A higher HLA compatibility score between a patient and donor significantly reduces the likelihood of organ rejection, leading to better post-transplant outcomes. To ensure transplant quality, many kidney exchange programs enforce a minimum HLA threshold ($L_{HLA}$), which sets the acceptable HLA score for matching patient-donor pairs.\nWhile a higher $L_{HLA}$ threshold improves transplant quality, it also reduces the number of compatible matches. This creates a trade-off between maximizing the quantity of transplants and ensuring transplant quality. Conducting a sensitivity analysis on $L_{HLA}$ helps us evaluate how varying the HLA threshold affects the overall number of successful transplants. By exploring different $L_{HLA}$ values, we can determine the optimal threshold that balances transplant quality and quantity, particularly when dealing with diverse or limited pools of patient-donor pairs."}, {"title": null}]}