{"title": "Identifying Key Drivers of Heatwaves: A Novel Spatio-Temporal Framework for Extreme Event Detection", "authors": ["J. P\u00e9rez-Aracil", "C. Pel\u00e1ez-Rodr\u00edguez", "Ronan McAdam", "Antonello Squintu", "Cosmin M. Marina", "Eugenio Lorente-Ramos", "Niklas Luther", "Ver\u00f3nica Torralba", "Enrico Scoccimarro", "Leone Cavicchia", "Matteo Giuliani", "Eduardo Zorita", "Felicitas Hansen", "David Barriopedro", "Ricardo Garc\u00eda-Herrera", "Pedro A. Guti\u00e9rrez", "J\u00fcrg Luterbacher", "Elena Xoplaki", "Andrea Castelletti", "S. Salcedo-Sanz"], "abstract": "Heatwaves (HWs) are extreme atmospheric events that produce significant societal and environmental impacts. Predicting these extreme events remains challenging, as their complex interactions with large-scale atmospheric and climatic variables are difficult to capture with traditional statistical and dynamical models. This work presents a general method for driver identification in extreme climate events. A novel framework (STCO-FS) is proposed to identify key immediate (short-term) HW drivers by combining clustering algorithms with an ensemble evolutionary algorithm. The framework analyzes spatio-temporal data, reduces dimensionality by grouping similar geographical nodes for each variable, and develops driver selection in spatial and temporal domains, identifying the best time lags between predictive variables and HW occurrences. The proposed method has been applied to analyze HWs in the Adda river basin in Italy. The approach effectively identifies significant variables influencing HWs in this region. This research can potentially enhance our understanding of HW drivers and predictability.", "sections": [{"title": "1. Introduction", "content": "The occurrence of heatwaves (HWs), characterized by prolonged periods of abnormally high temperatures exceeding typical local conditions, has become a pressing concern in recent years due to their severe societal and environmental impacts [1, 2]. Since 1950, extensive regions worldwide have witnessed numerous prolonged and intense HWs, resulting in significant consequences for human mortality, regional economies, and natural ecosystems [3, 4, 5, 6, 7]. In agriculture, heat stress on crops can significantly reduce yields, leading to food insecurity. In addition, increased demand for electricity for cooling during HWs substantially strains power grids. The escalation in the frequency of HWs has been documented in various parts of the globe in recent years and is at least partly attributed to the temperature increases driven by anthropogenic warming [8, 9].\nNumerous studies [10, 11, 12] have consistently highlighted that the ongoing increase in global surface temperatures will lead to significant alterations in the frequency and intensity of HWs across Europe by the end of this century. This trend is not confined to Europe; globally, there is also a growing prevalence of heat extremes, with projections indicating that these events will continue to increase in the coming decades [13, 14, 15]. Regional differences can be encountered in HW projections. Hence, this leads to diverse drivers and climate forcings on regional scales. The identification of these drivers plays a key role in understanding regional variations and in developing effective mitigation and adaptation strategies, as different regions may experience distinct climate impacts due to a combination of local factors and global climate forces. Moreover, understanding these drivers is crucial for improving forecasts on sub-seasonal scales, allowing for more accurate predictions of HWs and other extreme events.\nWhen tackling the challenge of HW detection or prediction, it is necessary to understand the mechanisms responsible for these extreme events. Although the underlying processes remain not entirely understood [1], an increasing number of studies have delved into these mechanisms and physical drivers that contribute to the formation and prediction of HWs [16, 17]. HWs are the product of intricate interactions between large- and small-scale processes that operate across diverse temporal scales. These events are highly influenced by atmospheric circulation, often regarded as a fast-acting driver, as well as anomalous conditions in slowly changing climate components, which can serve as proximate factors (e.g., land surface) or remote factors (e.g., upper ocean temperature, or sea ice) affecting HWs occurrence [18, 19, 20]. In the extratropics, atmospheric circulation patterns that influence HWs include quasi-stationary synoptic-scale high-pressure systems (anticyclones) [21, 22], whose predictability at a seasonal scale is low due to the influence of the chaotic variability of the atmosphere [23]. Finally, long-term trends in frequency, duration, and intensity of HWs are primarily driven by anthropogenic forcings, including global factors such as greenhouse gas concentrations and regional factors like land-use/land-cover changes and aerosol emissions [24]. However, these are out of the scope of this paper.\nIn close relation to the previous discussion, and considering the vast volume of available spatial and temporal data, employing data-driven methodologies becomes indispensable for uncovering potential HW drivers. A limited body of literature addresses this subject using ML and feature selection and dimensionality-reduction approaches. Some works [25, 26, 27] employed Principal Components Analysis (PCA) to reduce and optimize the number of highly correlated variables, using them as inputs in some ML algorithms. In [28], authors aimed to identify the role of the individual drivers for five HWs in the recent decade through factorial experiments, which force the model toward observations for one or several key components at a time, allowing to identify how much of the observed temperature anomaly of each event can be attributed to each driver. Other feature selection approaches have been used for different weather problems in searching for optimal input variables. In [29], an extreme gradient boosting feature selection algorithm was applied with ML models in a problem of short-term relative humidity prediction. In [30], a nested loop of roughly pruned random forests was used for identifying significant drivers of daily streamflow from large-scale atmospheric circulation in Norway. In [31], a clustering method was applied to divide Morocco into regions that are spatially consistent in terms of extreme precipitation and to identify its drivers by analyzing atmospheric circulation anomalies during the occurrence of regional events. In [32], ML regression-based algorithms were used to identify the drivers of drought dynamics in the Free State Province. [33] shows the influence of different drivers to understand the causal mechanism of HWs over South-West India. For that purpose, climate model simulations and long-term observational data were proposed.\nThis study proposes a general framework for HW driver identification, which can be applied to other extreme events in the context of detection and event short-term prediction. The framework is illustrated here to detect HWs in a European location. Specifically, the framework proposed in this work follows a two-phase methodology to obtain robust HW driver identification. In the first phase, a clustering algorithm is applied to variables identified as potential drivers, extracted from the ERA5 reanalysis dataset [34], and presented as time series. This clustering step reduces the dimensionality of the spatial domain by grouping nodes with similar time series patterns. In the second phase, a wrapper feature selection approach based on a multi-method ensemble evolutionary algorithm (PCRO-SL) [35] is employed to identify the most skilful drivers and periods for HW forecast over short-term (days to weeks) and seasonal horizons. The optimization algorithm's fitness function performs a driver selection by evaluating the performance of an ML model for HW classification based on a subset of clustered drivers.\nThe proposed framework is applied to the agricultural districts in the Adda river basin, located downstream of Lake Como, in the Lombardy region, Northern Italy. These districts are part of the Po Valley, one of the most productive European agricultural areas, which provides one-third of the national agricultural production [36]. Understanding the crop risks associated with extreme temperatures is becoming increasingly crucial to planning effective climate change adaptation strategies.\nThe manuscript is organized as follows. First, a description of the data, including potential drivers and target variables used for developing the experiments, is provided in Section 2. Then, the spatio-temporal feature selection methodology is presented and detailed in Section 3. Subsequently, the experimental work and the results obtained are further described in Section 4. Finally, in Section 5, there is a discussion on the potential uses of the framework in wider-scale driver detection and on implications for forecasting."}, {"title": "2. Data description", "content": "This section provides a detailed description of the data used for the experiments and the construction of the target. First, regarding HW definition, this issue has been widely discussed in the literature [17]. This work follows the widely-used HW definition given in [9] based on cumulative normalized daily maximum temperature (TX) exceedances. Next, we will provide details on the potential drivers considered and the target variables considered."}, {"title": "2.1. Potential drivers and target", "content": "The variables considered as potential drivers to perform the HW prediction may be categorized into three groups: 1) meteorological variables, local or remote, 2) climate indices, 3) other variables.\nThe first group consists of atmospheric, ocean and other variables which influence climate on various timescales: mean sea level pressure (MSLP), outgoing longwave radiation (OLR), total precipitation (TP), height of the 500 hPa geopotential (Z500), 2m temperature (T2M), as well as sea surface temperature (SST), sea ice concentration (SIC) and volumetric soil moisture in the upper 7cm (SM).\nThe second group, climate indices, are included because long-term indices are linked to large-scale atmospheric patterns that influence temperature over extended periods [37]. In addition, long-term indices help distinguish between climate change variability and natural variability. However, the role of large-scale drivers and teleconnections in the Adda river basin, as for much of Europe, is still unclear [38]. First, the NINO3.4 index (area-averaged SST anomaly in the region 5\u00b0S-5\u00b0N, 120\u00b0W-170\u00b0W) is used to represent the El Nino Southern Oscillation (ENSO), which is strongly linked with the occurrence of extreme heat in northern continents [39, 40, 41]. The Indian Ocean Dipole (IOD), whose association with HWs has been investigated in recent years [42, 33], is calculated as the difference of area-averaged SST anomaly between the western tropical Indian Ocean (50\u00b0E-70\u00b0E, 10\u00b0N-10\u00b0S) and the southeastern tropical Indian Ocean (90\u00b0E-110\u00b0E, O\u00b0N-10\u00b0S). Lastly, the North Atlantic Oscillation (NAO), whose impact on European heatwaves has been previously studied in [43, 44, 45], is derived from the first principal component of Z500 in the North Atlantic domain.\nThe third group covers miscellaneous variables such as mean atmospheric CO2 levels [46] and the specific calendar day of the year (DOY) [47].\nTable 1 describes the geographical domain considered for each meteorological variable. Some have been studied in two domains to account for their varying influence in various geographical scales. Also, land variables available over the local region under study are considered as independent potential drivers (MSLP, OLR, SM, T2M, TP and Z500)."}, {"title": "2.2. Data extraction and preparation", "content": "The detection of HWs presented in this paper is performed based on physical variables data extracted from ERA5 reanalysis [34]. ERA5 provides hourly information on a broad set of variables, such as temperature, pressure, precipitation, and snowfall, with a resolution of 0.25 degrees in both longitude and latitude. Daily average values were considered in this case, with a horizontal resolution of 0.5 degrees. The 72-year ERA5 database, based on data from 1950 to 2022, has been considered for both target and predictive variables. These data have been divided into a training period from 1950 to 2010 and a test period from 2010 to 2022. For the training split, the positive cases (HW occurrence) represent 5.1% of the cases, while for the test split, the positive cases represent 15.1% of the cases.\nThe climatology is computed for each calendar day using the 1981-2010 period, and a rolling average of 30 days is applied to smooth this annual cycle. The local seasonal cycle is removed for each candidate driver to provide a time series of anomalies."}, {"title": "3. Spatio-Temporal Cluster-Optimized Feature Selection (STCO-FS)", "content": "This section presents the proposed framework to identify optimal HW drivers in spatial and temporal domains. Figure 1 illustrates the methodology flow, where it is worthwhile to distinguish between the data treatment of potential predictor variables and the target variable. The possible drivers have been defined in Section 2.1. The proposed framework has two steps (plus a preprocessing stage), as shown in Figure 1. The first step consists of clustering the drivers to reduce the spatial dimension. The area-weighted spatial average time series of clusters are then merged with the local variables and climate indices. In the second step, a wrapper feature selection method is applied using an evolutionary optimization algorithm and a ML method for selecting the optimal time frames of each potential driver.\nOnce the input and target variables have been processed, they are used to feed supervised ML classification algorithms, which conduct the detection of the HW occurrence over the Adda river basin in the considered period. The framework steps are described in the subsequent sections."}, {"title": "3.1. Dimensionality Reduction through Clustering", "content": "The clusters represent geographic areas in which the temporal variability is most similar. Previous studies dictate the use of different domains for certain variables. SM and precipitation are considered local-scale influences on European HWs [48]. European temperatures are indirectly linked to Arctic SIC [49] [50] through impacts on atmospheric circulation, but we assume no link to Antarctic SIC. North Atlantic SSTs affect the European climate, particularly in winter [51], but there is some evidence to suggest a lagged influence on summer heatwaves [52, 53]. Meanwhile, global modes of climate variability, which influence distant continents via teleconnections, are represented by global SST patterns. For an explicit consideration of atmospheric dynamics and teleconnections, z500 and MSLP are used locally and globally. Extreme heat is often linked to regional scale circulation anomalies [22], which can be excited and/or amplified remotely via atmospheric teleconnections [17].\nThe classic K-means clustering algorithm has been employed to reduce the spatial dimensionality of the predictive data. Initially introduced by MacQueen [54], K-means has become one of the most widely used and extensively studied clustering algorithms. The key input parameter in the K-means approach is the number of clusters, denoted by k. The algorithm then partitions the data into k clusters by following defined steps. It is important to note that the proposed methodology allows other possible clustering algorithms (different from K-means) to cluster the input data.\nThe proposed method allows the inclusion of any other clustering method that better fits the problem under study. It is important to note that, at this stage of the process, the critical point is to reduce the dimensionality of the problem, particularly in the spatial domain.\nThis study implements the clustering algorithm for the 12 predictors outlined in Table 1. Next, the area-weighted spatial average for each cluster is computed. Consequently, a time series is generated for each cluster under consideration. A value of k = 5 clusters has been considered for each predictor field, giving a total of 60 clusters involved in the prediction (5 clusters \u00d7 12 variables = 60 potential drivers). Clustering was applied considering the training data (from 1950 to 2010) of daily time series anomalies relative to 1981-2010. For each variable, five clusters are obtained, displayed in Figure 3. For T2M, values over land are only considered. For SIC, areas historically free of sea ice have been masked out.\nAlthough the number of clusters is arbitrary, it is essential to note that this work aims to present the methodology but not its best configuration, which may depend on the location of the study and the different variables considered.\nThe proposed method allows the introduction of unclustered variables as potential drivers of the problem. Thus, those variables that do not need to be spatially grouped can be selected, and their time series are included in the analysis. This study considers 11 additional features included as potential drivers, including the climate indexes, the local meteorological variables (MSLP, OLR, SM, T2M, TP and Z500 taken over the Adda river basin) and the other variables defined in Section 2.1. Thus, these results in a database of predictor variables comprising 71 variables arranged as a time series."}, {"title": "3.2. Candidate Selection: the optimization problem", "content": "After reducing the dimensionality of the problem in the spatial domain, our focus shifts to the temporal dimension. Here, the objective is to identify periods and lags exhibiting the highest predictive skill for each potential driver. First, the prediction time-horizon is defined, determining how far in advance predictor data should be considered. This work sets the time horizon to zero since it is configured as a detection problem. Based on the prediction horizon, the time lag and sequence length values are searched for each potential driver under study using evolutionary computation. They represent the lead time and the window length considered for each variable, which enables us to distinguish between short-term (low time lag) and long-term (high time lag) predictors. An illustration is shown in Figure 2. In this work, the maximum time lag is set as 180 days, and the maximum window length is set as 60 days. Therefore, the evolutionary search could account for a lead time of up to 8 months for each of the variables.\nThe process of determining the time lag and the sequence length has been conducted using a robust and well-established optimization algorithm: the Probabilistic Coral Reef Optimization Algorithm with Substrate Layers (PCRO-SL) [55, 35]. It is a low-level ensemble for optimization [56], based on evolutionary computation. It was first proposed as an advanced version of the original CRO algorithm [57], which was an evolutionary-type meta-heuristic, proposed as a class of hybrid between Evolutionary Algorithms [58] and Simulated Annealing [59]."}, {"title": "3.3. Machine Learning classifiers", "content": "Although a fast-training ML algorithm such as LR is used during the optimization process, a variety of more sophisticated models are subsequently implemented to evaluate the optimal solution the PCRO-SL algorithm provides. These models include: Light Gradient Boosting Machine (LGBM) [61], Support Vector Classifier (SVC) [62], Decision Trees (DTs) [63], Random Forest (RF) [64], Gaussian Naive Bayes (GNB) [65], K-Nearest Neighbours (KNN) [66], Adaptive Boosting (AB) [67], Multi-Layer Perceptron (MLP) [68], Gradient Boost (GB) [69] and Extreme Learning Machine (ELM) [70].\nThese methods are implemented in Python using the following libraries: sklearn, skelm and lightgbm. The hyperparameters of these classifiers are determined using a random hyperparameter search with the values considered in Table 2. A CV with five folds was performed."}, {"title": "4. Experimental work and results", "content": "This section describes the experimental work, the results obtained, and the corresponding discussion. First, Section 4.1 details the drivers the optimization algorithm selects. Second, Section 4.2 shows the results provided by the ML models in the detection task. In all experiments, the training period spans from 1951 to 2009, while the test period covers 2010 to 2020, comprising 18% of the total data. The training dataset identifies optimal drivers and model training, whereas the test dataset is reserved exclusively for evaluating model performance."}, {"title": "4.1. The selected variables", "content": "The optimization algorithm is initialized once the potential predictors are made up, including clusters, unclustered variables, and the local and climate indices. The clustered variables are shown in Figure 3.\nThe solution provided by the proposed method is a vector of length 3 \u00d7 number of variables. It represents the time lag, sequence length and a binary variable with the time steps for which the variable is selected. In this case, the forecast horizon has been set to 0 since the goal is to validate the methodology for unveiling potential drivers before attempting a more complex forecasting problem.\nThe PCRO-SL optimization algorithm is executed in ten independent runs to prevent false positives caused by the inherent randomness in this optimization problem. Figure 4 shows a potential solution the algorithm provides, corresponding to the best solution of all the runs, in terms of CV error. Here, in the x-axis, the 71 potential drivers are listed. The y-axis shows the temporal scale (in days relative to the HW occurrence). This plot highlights in blue the time steps the optimization algorithm selects for each predictor in the case of this specific example. The red square means that the algorithm has discarded the specific potential driver.\nFigure 4 helps the user to interpret, visually and intuitively, the different variables that are being chosen, as well as distinguish between variables that have a sort term influence (in this case, T2M in the European domain over the cluster 1, SM in the European domain, cluster 3, and TP in the European domain over the cluster 3 (see Figure 3), and the T2M and Z500 at the local node of Lake Como); and others variable with a delayed impact that influence with a delay of up to 170 days (e.g. OLR over the North Atlantic domain in cluster 1)."}, {"title": "4.2. Results for different Machine Learning models", "content": "Finally, the optimum combination of drivers, corresponding to a threshold equal to 0.85, is used to train a pool of ML classifiers (Section 3.3). The test error metrics for these methods are shown in Table 4. The predictive results provided by the best-performing model, GB (an F1-score of 0.7906), are further"}, {"title": "5. Conclusions and further research", "content": "Understanding the drivers behind the formation of Heatwaves (HWs) is vital to enhance our ability to anticipate, forecast and mitigate the impacts of these extreme events, ultimately reducing the risks to human health, economies, and ecosystems. Researchers can develop more sophisticated models that improve predictive capabilities by recognizing the complex interactions between atmospheric conditions, oceanic patterns, and terrestrial processes. This enhanced understanding also informs the development of effective adaptation and mitigation strategies, ensuring societies are better equipped to handle the increasing frequency and severity of HWs driven by climate change.\nThis study proposes a comprehensive framework to investigate the interactions between HWs and potential physical drivers across multiple spatio-temporal scales (STCO-FS). The proposed methodology follows a two-phase approach: initially, a clustering algorithm is applied to reduce spatial dimensionality by grouping similar time series data from the ERA5 reanalysis database. Additional variables, such as climate indices and local meteorological factors, are then incorporated into the database. In the second phase, a multi-method ensemble evolutionary algorithm (PCRO-SL) identifies significant periods and clusters relevant to HW occurrences. This approach determines which variables are crucial for HW prediction and the specific time frames in which they are most influential, distinguishing between short-term and long-term drivers.\nThe framework has been successfully applied to an agriculturally intensive region in North Italy, demonstrating its ability to detect key HW drivers effectively. A standard definition of HW has been considered. Regarding the potential drivers considered, 8 variables covering different geographic domains, together with three climate indexes (ENSO, NAO and IOD) and local meteorological conditions, have been incorporated into the study. The results indicate strong HW detection capabilities, with nowcasting error metrics of 0.8363.\nFor the specific drivers identified in each case, relationships have been established between the occurrence of heat waves and various variables across different spatio-temporal scales. The key selected predictors for the Adda River basin are regional-scale temperature and atmospheric circulation in the 20 days before the event and ENSO, IOD and NAO on sub-seasonal to seasonal timescales. While some of these connections have been suggested in previous work, this study indicates the locations and time frames in which specific mechanisms can be studied and is thus a powerful tool and first step in understanding processes and predictability.\nThe proposed method offers a series of advantages that are outlined as follows: (1) It enables the discovery of new potential drivers in both temporal and spatial domains simultaneously; (2) By grouping meteorological variables into clusters, the dimensionality of the problem is significantly reduced, and the level of granularity can be adjusted as a parameter of the algorithm; (3) Encoding the problem by establishing lag time and the length of the selected window for each predictor variable reduces the dimensionality in the time domain, thereby simplifying the evolutionary process; (4) The use of a robust evolutionary algorithm (PCRO-SL), along with a fast, efficient, and deterministic classifier, allows the resolution of a complex optimization problem within a short period.\nFuture lines of research will focus on several key areas. Firstly, the framework will be extended to predict HWs with a longer prediction horizon (i.e., S2S) and to tackle predicting the number of HWs on a seasonal scale. Additionally, future research will examine how the selected drivers vary depending on the region under investigation and the data they are applied to (e.g., historical or future climate simulations). This continued research will further enhance the predictive power and applicability of the framework, contributing to more effective HW management and mitigation strategies. Moreover, given the flexibility and modularity of the framework, both predictors and target data can be changed, meaning it can be applied to other extremes with ease. How the clusters are created can also be analysed. Unconnected clusters often arise from variability unrelated to the seasonal cycle. (i.e. not removed when calculating the anomaly). A new way to avoid this is being under study."}]}