{"title": "EVOLUTIONARY MORPHOLOGY TOWARDS OVERCONSTRAINED LOCOMOTION VIA LARGE-SCALE, MULTI-TERRAIN DEEP REINFORCEMENT LEARNING", "authors": ["Yenan Chen", "Chuye Zhang", "Pengxi Gu", "Jianuo Qiu", "Jiayi Yin", "Nuofan Qiu", "Guojing Huang", "Bangchao Huang", "Zishang Zhang", "Hui Deng", "Wei Zhang", "Fang Wan", "Chaoyang Song"], "abstract": "While the animals' Fin-to-Limb evolution has been well-researched in biology, such morphological transformation remains under-adopted in the modern design of advanced robotic limbs. This paper investigates a novel class of overconstrained locomotion from a design and learning perspective inspired by evolutionary morphology, aiming to integrate the concept of 'intelligent design under constraints' - hereafter referred to as constraint-driven design intelligence - in developing modern robotic limbs with superior energy efficiency. We propose a 3D-printable design of robotic limbs parametrically reconfigurable as a classical planar 4-bar linkage, an overconstrained Bennett linkage, and a spherical 4-bar linkage. These limbs adopt a co-axial actuation, identical to the modern legged robot platforms, with the added capability of upgrading into a wheel-legged system. Then, we implemented a large-scale, multi-terrain deep reinforcement learning framework to train these reconfigurable limbs for a comparative analysis of overconstrained locomotion in energy efficiency. Results show that the overconstrained limbs exhibit more efficient locomotion than planar limbs during forward and sideways walking over different terrains, including floors, slopes, and stairs, with or without random noises, by saving at least 22% mechanical energy in completing the traverse task, with the spherical limbs being the least efficient. It also achieves the highest average speed of 0.85m/s on flat terrain, which is 20% faster than the planar limbs. This study paves the path for an exciting direction for future research in overconstrained robotics leveraging evolutionary morphology and reconfigurable mechanism intelligence when combined with state-of-the-art methods in deep reinforcement learning. (Project GitHub: https://github.com/ancorasir/BennettWheelLegRL)", "sections": [{"title": "1 Introduction", "content": "Evidence from paleontology [1], developmental biology [1], and genetic research [2] show a rich body of literature and research on the fin-to-limb evolution that explains how fish evolved into four-limbed vertebrates [1, 2]. While animals evolve in biological morphology in adaptation to environmental changes for survival, engineers are inversely posed with the challenge of searching for an optimal solution. By analogy to the genetic expression of DNA to biological structures, the loop closure formulation holds the key to the precise design of rigid-bodied mechanisms [3]. It is the engineer's choice in design guided by the application needs that lead to the realization of different linkages, where planar linkages and their variations historically play a dominant role in legged, armed, and fingered systems [4]. However, when tracing back to the kinematic origins of a planar linkage with four revolute joints (4R), which is derived from a loop-closure formulation, one would quickly realize that there are alternative solutions beyond the planar case [5]. These alternatives are not widely utilized in modern robotic limb designs.\nThe loop closure equation for a 4R linkage suggests three possible solutions [6], including the overconstrained 4R (or the Bennett linkage with skewed joint axes and non-zero-length links), a planar 4R (with all parallel joint axes and non-zero length links), and a spherical 4R (with all intersecting joint axes and zero-length links). The overconstrained case could be considered a more generalized solution concerning the parametric specification order in geometric conditions. By specifying all twist angles or link lengths as zeros, the Bennett linkage effectively degenerates into a planar or spherical one, respectively. However, it should be noted that one can further generalize the corresponding planar or spherical design by relaxing the equal link lengths or twist angles in the opposite link-pairs, formulating extended design variations of 4R linkages in planar and spherical cases.\nWhile distributed actuation directly attached to each joint in a kinematic open-chain is straightforward in engineering [7], limitations in power density and cost constraints usually prefer the adoption of linkages for power and motion transmission [8], where the actuators could be placed closer to the robot's main body for a much-reduced inertia [9]. The design of robotic limbs, including robotic arms, legs, and fingers, involves extensive examples utilizing such design principles. For example, the Ghost Robotics Minitaur [10] and Stanford Doggo [11] adopt co-axially arranged dual actuators on the robot's body frame to power a planar 4R linkage in a diamond shape as robotic legs. Recently, a more compact design has been widely adopted by adding another motor orthogonally arranged to two co-axial motors to provide spatial motions, where the leg designs are optimized within a tight form factor using a very slender planar 4R linkage for power transmission [12], or using belt [13] or chain [14] transmission to achieve variational designs of planar 4R transmission similarly. Hydraulic actuation is also a possible design, which is kinematically equivalent to a variational design of planar 4R transmission [15, 16]. The parallel mechanism is also a possible design with much increased load-bearing capability but requires significantly more components in assembly [9, 12, 17]. Emerging designs also leverage material softness to develop novel soft lower limbs but generally suffer from dynamic agility in action [18].\nExtensively studied among theoretical kinematicians, mechanism designers, and robotics researchers, overconstrained linkages exhibit rich and complex geometrical foundations in developing advanced mathematical tools for mechanical and robotic systems yet under-adopted in modern applications [19, 20, 21, 22, 23, 24]. Recent research shows that the overconstrained linkages could also be adopted for developing novel robotic limbs with reconfigurable capabilities, where the overconstrained geometry enables a workspace in 3D surfaces that could be applied for legged locomotion actuated by only two motors per limb [25]. The theoretical foundation and engineering implementation of overconstrained linkages in 4R, 5R, and 6R formulations have been systematically established for the application as robotic limbs in legged locomotion with proven superiority in omnidirectional walking, especially when walking sideways or turning-on-the-spot [26]. Recently, the researchers proposed a computational optimization framework to co-design the overconstrained robotic limb while considering the efficiency in quadrupedal locomotion, where the overconstrained limbs are found to be the most efficient in mechanical energy in general [6]. As a result, a novel class of overconstrained locomotion is emerging, which originates from the incorporation of overconstrained linkages as the robotic limbs for power and motion transmission, which is found to be energy efficient using model-based methods when walking on flat terrains in simple tasks.\nAdvanced control methods are required for dynamic walking on challenging terrains, where model-based and learning- based methods are widely adopted [27, 28, 29, 30]. Model-based methods use detailed, pre-set mathematical models to understand the robot's movement and surroundings [27, 29]. They work well in austere, predictable environments but can struggle in more complicated or changing landscapes [31]. On the other hand, learning-based methods, especially reinforcement learning, give a policy guiding robots to adjust and learn from their experiences [31, 32]. This added more flexibility, as pre-defined models do not limit them and can adapt to various and variant terrains and obstacles [31]. For example, using reinforcement learning, cross-skill generalization of overconstrained robotic limbs between manipulation and locomotion was recently found to be an effective method with a co-training framework [33]. Recently, a large-scale,"}, {"title": "multi-terrain reinforcement learning method has been proposed and deployed successfully in robotic hardware over challenging terrains in the wild [34].\nIn this paper, we propose a design and learning method to verify the capabilities of overconstrained locomotion in challenging terrains using large-scale, multi-terrain reinforcement learning against the parametric reconfiguration of evolutionary morphology. The resultant design of the overconstrained robotic limb can be parametrically reconfigured to mimic the mammal-inspired and reptile-inspired foothold during walking, representing two major classes of tetrapod limb morphology. Comparative analysis has been found difficult in previous work due to the different robot designs, which becomes possible in this study using limbs with parametrically reconfigurable designs attached to the same robot body. Instead of previous work tested using model-based methods in simple walking tasks on the floor, this research delves further into dynamic walking over a series of challenging terrains, including flat floors, slopes, and stairs, with or without noises in upward or downward directions, all trained via data-driven method using reinforcement learning. The main contributions of this paper are listed as the following:\n\u2022 Achieved dynamic walking over a series of challenging terrains by training overconstrained locomotion via large-scale, multi-terrain deep reinforcement learning;\n\u2022 Discovered the superior energy efficiency of overconstrained locomotion over the widely adopted planar limbs and novel spherical limbs in dynamic quadrupedal locomotion via a learning-based approach.\n\u2022 Further trained a wheel-legged overconstrained locomotion to verify the versatile capabilities of overcon- strained robotic limbs in modern legged robots.", "content": "The rest of this paper is organized as follows. Section 2 presents our additive design of overconstrained robotic limbs, the evolutionary morphology of overconstrained quadruped, and our proposed reinforcement learning framework and the simulation setup. Section 3 depicts simulation results. Discussions are included in section 4, with limitations and future works in the final section."}, {"title": "2 Method", "content": "This section introduces an additive design of the overconstrained robotic limbs proposed in this study, which can be conveniently reconfigured parametrically into planar and spherical linkages for comparative analysis, which shares an evolutionary morphology transforming between reptile- and mammal-inspired legged robots. Then, we present the deep reinforcement learning framework adopted for training overconstrained locomotion in large-scale, multi-terrain scenarios with massively parallel deployment of overconstrained robots in simulations."}, {"title": "2.1 Additive Design of Overconstrained Robotic Limbs", "content": "Show in Fig. 1A is the overconstrained robotic limb designed for additive manufacturing. All links are designed as the alternative form following the geometric conditions defined by the Bennett linkage. A snap-clutch connector is attached to the first servo motor (DYNAMIXEL Model XM430-W270) with its axis aligned along the body frame, enabling a detachable design of the whole limb to the main body. Two servo motors of the same model are arranged next to each other, where a belt transmission is used to enable a co-axial output connecting two driving links of the Bennett linkage, respectively. Each link is designed by sweeping along the link axis offset by the link's thickness to enable a scissor design for minimum collision during motion. The links will contact each other when they are close, providing a physical limit to its movable range. A ball bearing is fitted inside the joint so that a shoulder bolt can be inserted as the shaft. Each link is 3D-printed using PA-12 (or Nylon 12). Note that to provide enhanced friction to the ground, one of the bottom links is added with an extra extrusion capped with a small piece of rubber at the tip of the toe. When four limbs of the same design are snap-fitted to the body frame, the robot can be assembled quickly, as shown in Fig. 1B.\nShown in Fig. 1C(i) is a planar case of the 3D printable design, which can be parametrically modified by changing all twist angles to zeros from a Bennett linkage design shown in Fig. 1C(ii), and then sent for 3D printing and assembly following the same procedure explained above. Alternatively, one can modify the link design so that all joint axes intersect, as shown in Fig. 1C(iii), resulting in a novel robotic limb of spherical linkage. The key advantages of the proposed design are the possibility of rapid reconfiguration in design parameters within the same design for additive manufacturing in 3D printing and direct testing without building a new robot.\nShown in Fig. 1D(i) is an enhanced version of the overconstrained quadruped built. Following the same principle, the motors in this design are upgraded to water-proof servo motors (DYNAMIXEL XW540-T140) to provide large torques with amphibious capabilities between on-land and underwater walking. The more robust motors used in this design also enable us to attach a driving wheel to the tip joint of each limb, resulting in a wheel-legged design as shown in Fig. 1D(ii). If two of the linkages are removed, as shown in Fig. 1D(iii), the limb becomes equivalent to the widely"}, {"title": "adopted design in a pseudo-open-chain, which can be realized using belt or chain transmission for a more compact form factor in design.\nIt should be noted that while such differences may seem trivial in design, the simulation of a closed-loop linkage remains challenging in many modern simulation environments or physics engines. For example, a classical problem with the widely adopted robot modeling language URDF (Universal Robot Description Format) is the lack of support for simulating closed-loop linkages. The historical discussion of this challenge is out of the scope of this paper. We have custom-developed and open-sourced a toolbox for this study to address this issue [35], enabling seamless conversion of closed-loop linkage designs in CAD software with modern learning-based simulation environments such as PyBullet, DeepMind's MuJoCo, and NVidia's Issac Sim. However, it should be noted that the adaptation for NVidia's Isaac Gym remains an unresolved issue.", "content": null}, {"title": "2.2 Evolutionary Morphology of Overconstrained Quadruped", "content": "The resultant quadrupeds achieved based on the reconfigurable overconstrained robotic limbs shown in Fig. 1C provides an interesting perspective into the morphological evolution of tetrapods, especially between mammals and reptiles. During the biological evolution of the limbs, the reptiles were among the first evolved morphology of the tetrapods [1],"}, {"title": "where the footholds, or the width of the spread between a pair of lower limbs, are usually much wider than the body width. While mammalian evolution has many characteristics, the mammal's footholds are usually comparable to its shoulder width.\nSuch morphonological evolution could also be observed from the kinematics perspective by reconfiguring the 4R linkages as the robotic limbs. For example, the overconstrained 4R limb shown in Fig. 1C(ii) would result in quadruped locomotion where the footholds are much more comprehensive than the body width, which are similar to the reptiles during walking. Classical examples such as frogs, ants, spiders, and lizards exhibit similar morphology during walking. However, when fixing all twist angles to zeros, the resultant planar limbs shown in Fig. 1C(i) exhibit a closer resemblance to the mammal, where the footholds are expected to be comparable to the body width. For example, the width of the spread of the two human feet, or the foothold, is roughly comparable to the width of the shoulder. One would be diagnosed as physically impaired if the foothold is too narrow, resulting in in-toeing behaviors, or when the foothold is too broad, resulting in splayfoot symptoms. This is also widely observed in other mammals, such as cheetahs, elephants, etc.\nMammals such as cheetahs are usually faster but cannot sustain long-distance locomotion like the reptiles such as lizards. When building quadrupedal robots, a balancing choice of design is critically important to develop legged systems that are more agile in speed or more energy-efficient over challenging terrains. Addressing this research question would require building a reconfigurable quadrupedal system that can be conveniently switched between different footholds based on a comparable kinematic architecture, making the proposed system shown in Fig. 1 an effective solution for further investigation. Furthermore, instead of pursuing a model-based control, which may result in hand-engineered differences in parameter selection, a learning-based approach shows promising effectiveness in finding optimal locomotion despite the morphological differences via a data-driven approach, which will be addressed next.", "content": null}, {"title": "2.3 Reinforcement Learning of Overconstrained Locomotion", "content": null}, {"title": "2.3.1 Simulation Setup for Legged Locomotion", "content": "We adopted the setup by Isaac Sim to train overconstrained locomotion via massively parallel deep reinforcement learning on a single workstation GPU [34]. The goal is to train the robot to navigate rugged terrain with a practical curriculum-based approach that is well-suited for simultaneous simulations with thousands of robots. The simulation environment setup is shown in Fig. 2A, a large scene with 20-by-5 grids surrounded by flat floors extended to the edge of the scene. Each grid is a terrain type of 8-by-8m square. Horizontally, there are 20 terrain blocks of different types, including smooth slope, rough slope, stairs up, stairs down, and discrete, and the proportions of each terrain type are 0.1, 0.1, 0.35, 0.25, 0.2. Vertically, there are terrains of the same type with increasing difficulties when changing the corresponding terrain parameters. The simulation process is like a game, with 2048 robots evenly divided into groups deployed randomly at the center of the most manageable level of terrain blocks. Each robot is given command of random linear velocity and heading direction $[v_x, v_y, \\theta_h]$ between -1 and 1 m/s to learn how to walk out of each grid onto the next. We adopted similar reward terms as in [34] but excluded the joint torques penalty to best use the servo motors' relatively limited torque output."}, {"title": "2.3.2 Simulation Setup for Wheel-Legged Locomotion", "content": "We adopted the same massively parallel deep reinforcement learning to train the wheel-legged locomotion. We prioritize key reward terms for learning locomotion policies. Each term, weighted to emphasize velocity tracking, joint motion minimization, and collision avoidance, is detailed in the provided appendix. We initially trained a pre-trained model on a flat floor in our Legged Gym pipeline. After selecting the optimal pre-trained policy, we further train the model on diverse terrains. If the outcomes fall short of expectations, we adjust the robot's initial posture and return to the flag. In the experiment, we trained a policy for our design with over-constrained wheel legs, sequentially progressing from flat floors to more challenging terrains.\nSince the Isaac Gym does not support closed-loop linkage simulation, we transfer the overconstrained leg into a pseudo-open chain, as shown in Fig. 1D(ii). In planar 4-bar closed chains, symmetry determines the entire chain's state once the left or right two linkages' states are known. When emphasizing the shoulder-to-foot position constraint, other constraints become negligible. This concept can be extended into the spatial 4R linkages, such as the Bennett mechanism."}, {"title": "3 Results", "content": "This section starts by presenting the reinforcement learning results for overconstrained locomotion in comparison against planar and spherical limbs. Then, we present the simulated testing results measured in various metrics, paying particular attention to the Cost-of-Transport analysis. Finally, we report the reinforcement learning results for overconstrained wheel-legged locomotion."}, {"title": "3.1 Overconstrained Legged Locomotion over Multi-Terrains", "content": "We begin by conducting large-scale, multi-terrain deep reinforcement learning of overconstrained locomotion using the setup illustrated in Fig. 2. Figs. 3A-D are the screenshots of the trained robot in overconstrained locomotion in various terrains. The rewards are shown in Fig. 3E, where the quadruped with Bennett limbs in red lines indicate that the overconstrained locomotion is successfully trained within about 3,000 steps and saturated with little increase when trained to 6,000 steps and beyond. Using the identical setup, we also trained the quadruped with planar and spherical limbs, plotted in the light and dark blue lines in Fig. 3E, respectively.\nInterestingly, the Bennett limbs exhibit the best training result in reinforcement learning, indicating the superior performance of overconstrained locomotion over dynamic walking with planar or spherical limbs. While also being a rather unconventional design in legged robots that is yet to be explored in literature, the spherical limbs exhibit only a slight decrease in dynamic walking performance compared to the planar limbs, as indicated in our simulation results. The spherical linkages are widely adopted in surgical robots but have yet to be applied in legged robots, which may provide further benefits by leveraging its remote center of workspace, which is outside the scope of this study."}, {"title": "3.2 Comparing Limb Morphology in Locomotion Efficiency", "content": "We benchmarked the performance of the three trained locomotion policies for Bennett, planar, and spherical limbs. The goal of the task is to let the quadruped traverse across a series of two flat, one slope, and one rough slope terrains, as shown in Fig. 4A.\nEach terrain block is 6 meters in distance, uniform along the x-axis, and varies along the y-axis. The sloping terrain has a rate of 0.25 and a plateau of 2 meters. The rough terrain increases the task difficulty by adding a randomly uneven surface and a higher plateau at 0.625 meters. For each limb design, thirty quadrupeds were initiated with the same pose at the starting point and commanded to walk forward or sideways toward the y-axis at the speed of 1 m/s. The actual forward and sideways trajectories are shown in Fig. 4C and D. All robots with Bennett or planar limbs completed the traverse task by walking forward and sideways. However, all robots with spherical limbs completed the traverse task by walking forward but failed to climb the sloping terrain.\nFig. 4E shows the horizontal linear velocity averaged over 30 quadrupeds over different terrains. Quadruped with Bennett limbs is the fastest on all test terrains, especially on the flat terrain where Bennett one achieves an average forward speed of 0.85 m/s, making a 20% increase compared to the planar one's at 0.71 m/s. The average time to complete the task by walking forward is 35.45, 38.28, and 44.91 s for Bennett, planar, and spherical limbs. We also investigate the Cost-of-Transport (COT) defined by $P/mgv$ for each limb design. The Bennett limb has the lowest COT"}, {"title": "over all tested terrains in forward and sideways walking, indicating the highest energy efficiency. The accumulated mechanical energy used to complete the task is reduced by 22.4% and 30.6% compared to the planar limb in forward and sideways walking, respectively.", "content": null}, {"title": "3.3 Learning Wheel-Legged Overconstrained Locomotion", "content": "Quadrupeds equipped with the overconstrained Bennett wheel legs undergo comprehensive training across diverse terrains, focusing on assessing their performance on flat floors. The findings are presented in Fig. 5, providing a comprehensive understanding of the quadrupeds' locomotive capabilities. We have verified that reinforcement learning"}, {"title": "4 Discussions and Conclusion", "content": null}, {"title": "4.1 Learning Superior COT in Overconstrained Locomotion", "content": "This study presents the first learning-based investigation of overconstrained locomotion over challenging terrains, providing data-driven evidence that supports the superior energy efficiency of overconstrained robotic limbs over the widely adopted planar limbs and another novel class of spherical limbs. Previous research adopted a model-based approach to computationally co-design the overconstrained robotic limb for the most mechanical efficiency in omnidirectional walking on the floor. This study successfully implemented dynamic walking with overconstrained robotic limbs over a wide range of challenging terrains, including floors, slopes, and stairs, with or without random noises, where the overconstrained limbs exhibit consistent superior performance by saving at least 22% mechanical energy in both forward and sideways traverse tasks. It also achieves the highest average speed of 0.85m/s on flat terrain, which is 20% faster than the planar limbs. This work indicates the exciting potential of overconstrained linkages in designing modern robotic limbs in dynamic locomotion, which may also apply to dexterous manipulation, as reported in recent literature [33]. This study paves the path for an exciting direction for future research in overconstrained robotics leveraging evolutionary morphology and reconfigurable mechanism intelligence when combined with state-of-the-art methods in deep reinforcement learning."}, {"title": "4.2 Data-driven Mechanism Intelligence Supporting Evolutionary Morphology with Overconstrained Robotic Limbs", "content": "Combining reconfigurable intelligence from mechanism science and learning-based behavior training can provide novel solutions for developing evolutionary-inspired robot design methods and reconfigurable systems. Quadrupedal systems are highly integrated, requiring systematic engineering involving multiple aspects, making it challenging to compare"}, {"title": "robotic limbs with different power and motion transmission mechanisms. In this study, we adopted a reconfigurable method to design the robotic limbs for additive manufacturing, which can be parametrically re-engineered to achieve all three types of 4R linkages in planar, overconstrained and spherical cases within a single robot system. In addition, our results found that the mechanism intelligence demonstrated in the generalized geometry of overconstrained linkages over planar and spherical ones shows a similar pattern observed in the morphological evolution of Fin-to-Limb transformation among the animal limbs. The overconstrained limbs resemble the reptile tetrapods with more energy-efficient walking over challenging terrains. At the same time, the existing literature shows that planar limbs originating from mammal tetrapods are generally suited for agile locomotion. Furthermore, our learning-based results indicate that reptile-inspired locomotion with a broader foothold could also be agile in both forward and sideways locomotion at high speed while maintaining a lower Cost-of-Transport compared to the mammal-inspired planar limbs, as demonstrated in the results shown in Figs. 4E&F.", "content": null}, {"title": "4.3 Learning Wheel-Legged Overconstrained Locomotion", "content": "Using a similar reinforcement learning framework, we also achieved a novel overconstrained wheel-legged locomotion in simulation, holding the potential for future applications in multi-modal, reconfigurable locomotion in an amphibious environment. While results in this study already established the energy efficiency in overconstrained locomotion, further enhancement could be achieved by introducing a wheel-legged design to the Bennett limb. For traversing tasks on terrains with continuous roughness, wheel-based designs are more efficient for high-speed movement, which can be combined with the legged system for an integrated design. However, our results also indicate that the wheel-legged system is more challenging to implement in reinforcement learning, requiring further research and system design. The added weight of the extra motors and wheels could pose further challenges to the motor selection of the robotic limb. Nevertheless, our simulation results further establish the possibility of refining overconstrained robotic limbs with the state-of-the-art wheel-legged system design for developing advanced, agile, and energy-efficient legged systems."}, {"title": "5 Limitations and Future Works", "content": "We acknowledge several limitations of our study. Verification through hardware implementation must be conducted to consolidate the results reported in this study, as this study is mainly conducted through simulation. The Sim-to-Real gap could pose a significant challenge to effectively deploying the learned skills presented in this study. The current development of learning-based simulation environments is still mainly suited for robotic limbs with open chains, which requires further development so that closed-loop mechanisms can be more effectively and efficiently simulated in large-scale, multi-terrain reinforcement learning. Considering that the prototype is mainly driven by servo motors with limited torque density and control bandwidth, actual performance in energy efficiency requires further experimentation and testing. Also, in the wheel-legged simulation, even with a more powerful servo motor attached, we had to increase the torque output by 50% to train the overconstrained wheel-legged locomotion. This suggests that a systematic re-selection of the motors might be necessary to build such a dynamic system to ensure sufficient torque reserve for dynamic walking and terrain traverse tasks. We have already built another full-sized prototype of the overconstrained quadruped using water-proofed quasi-direct drives with much-enhanced torque output, which we plan to develop further to test the results obtained in this study. A trade-off of this study by adopting a reconfigurable limb design suggests that there is still room for further enhancement in optimizing the overconstrained robotic limb if used for a singular purpose without considering reconfiguration into other linkage topologies. Future research of this study will focus on developing an overconstrained quadruped for cross-limb, cross-terrain, and cross-skill in an amphibious environment with autonomous morphological reconfiguration."}]}